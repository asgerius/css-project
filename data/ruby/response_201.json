[{"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542257887, "post_id": 53310249, "comment_id": 93505789, "body": "It&#39;s true that <code>3 || 2 - 1 #=&gt; 3</code>, but readers of your code you appreciate  parentheses: <code>3 || (2 - 1)</code>. When you report an error in a SO question please indicate the line of code where it occurred as well as the message. Note that your method would never be written that way as <code>results</code> and <code>top_scoring</code> are both local variables that have no purpose and whose values are lost when the method is exited."}], "answers": [{"tags": [], "owner": {"reputation": 1692, "user_id": 5879740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8gQJ4.jpg?s=128&g=1", "display_name": "Constantin Guidon", "link": "https://stackoverflow.com/users/5879740/constantin-guidon"}, "is_accepted": false, "score": 1, "last_activity_date": 1542238435, "last_edit_date": 1542238435, "creation_date": 1542238128, "answer_id": 53310311, "question_id": 53310249, "link": "https://stackoverflow.com/questions/53310249/ruby-option-within-parameter/53310311#53310311", "title": "Ruby - Option within parameter", "body": "<p>you should pass instead to <code>most_frequent_kmers</code> a hash like that:</p>\n\n<pre><code># depends on the ruby version you are using\n# {str: \"hey\"} and {:str =&gt; \"hey\"} work also\nmost_frequent_kmers(str: \"hey\")  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 1, "last_activity_date": 1542239899, "creation_date": 1542239899, "answer_id": 53310551, "question_id": 53310249, "link": "https://stackoverflow.com/questions/53310249/ruby-option-within-parameter/53310551#53310551", "title": "Ruby - Option within parameter", "body": "<p><code>opts</code> means you can pass an \"unlimited\" number of arguments when calling the function, but all of them should be named, as you can see in the method's body:</p>\n\n<pre><code>str            = opt[:str]\nmin_chunk_size = opt[:min_chunk_size] || 1\nmax_chunk_size = opt[:max_chunk_size] || str.length - 1\nmin_occurences = opt[:min_occurences] || 1\n...\n</code></pre>\n\n<p>It's assigning the value of the parameter str within the opt one, min_chunk_size, and so on. But in the case of str, this is the only one that doesn't have a \"default\" value, but even so, this way <code>max_chunk_size</code> depends on this, when that value as argument isn't provided (since the str.length - 1 assignment).</p>\n\n<p>For making use <code>most_frequent_kmers</code> you need to provided a String object, as the str argument (really I think it should be a String, as per the name - str). So this way the logic inside is able to keep working, all other local variables in it have default values if they're not provided.</p>\n\n<p>If you want to pass <code>str</code> as argument, you can just do <code>most_frequent_kmers(str: 'Some String')</code>, if you don't then it'll return a <code>NoMethodError</code>, since <code>opt[:str]</code> will be <code>nil</code>, and the \"fallback\" value for when that happens will try to invoke the <code>length</code> method on <code>nil</code>.</p>\n\n<p>And tl;dr;, since you're just passing an Integer as argument, Ruby tries to invoke <code>[]</code> on the opts argument, raising the TypeError for trying an implicit conversion since <a href=\"https://ruby-doc.org/core-2.5.1/Integer.html#method-i-5B-5D\" rel=\"nofollow noreferrer\"><code>Integer#[]</code></a> expects to receive an Integer as argument, and you're passing a symbol.</p>\n"}], "owner": {"reputation": 49, "user_id": 6702160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a001c3e665a9e43936a9f43b7c38c8fc?s=128&d=identicon&r=PG&f=1", "display_name": "dpopo", "link": "https://stackoverflow.com/users/6702160/dpopo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542239899, "creation_date": 1542237718, "question_id": 53310249, "link": "https://stackoverflow.com/questions/53310249/ruby-option-within-parameter", "title": "Ruby - Option within parameter", "body": "<p>I am having trouble understand options with ruby.</p>\n\n<pre><code>def most_frequent_kmers(opt={})\n   str            = opt[:str]\n   min_chunk_size = opt[:min_chunk_size] || 1\n   max_chunk_size = opt[:max_chunk_size] || str.length - 1\n   min_occurences = opt[:min_occurences] || 1\n   results        = {}\n   top_scoring    = {}\nend\nmost_frequent_kmers(1)\n</code></pre>\n\n<p>which gives me an error of</p>\n\n<pre><code> `[]': no implicit conversion of Symbol into Integer (TypeError)\n</code></pre>\n\n<p>I am not sure what to do to solve this.</p>\n"}, {"tags": ["ruby", "jekyll", "github-pages"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1542261557, "post_id": 53309750, "comment_id": 93506892, "body": "&quot;where external plugins are not supported.&quot;: That is why I recommended recently Hugo: <a href=\"https://stackoverflow.com/a/53244761/6309\">stackoverflow.com/a/53244761/6309</a>"}, {"owner": {"reputation": 7274, "user_id": 2065796, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/myEf4.jpg?s=128&g=1", "display_name": "Sasha Shpota", "link": "https://stackoverflow.com/users/2065796/sasha-shpota"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1542274835, "post_id": 53309750, "comment_id": 93513050, "body": "@VonC thank you, but as I mentioned before it is not an option for me. First, I&#39;d need to rework my project. Second, I&#39;d need to change hosting as Hugo is not supported on GitHub pages (I would need to commit precompiled html files which I don&#39;t want). And finally, quick googling shown up that there is no built in solution for <code>height</code> and <code>width</code> calculation so I&#39;d need to figure out that myself. I can&#39;t understand how can I benefit from using Hugo. Please explain if I&#39;m missing something."}, {"owner": {"reputation": 9244, "user_id": 2397550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAb8N.jpg?s=128&g=1", "display_name": "JoostS", "link": "https://stackoverflow.com/users/2397550/joosts"}, "edited": false, "score": 0, "creation_date": 1542275493, "post_id": 53309750, "comment_id": 93513431, "body": "Why do you need width and height calculations. I have never needed them. Am I missing something?"}, {"owner": {"reputation": 7274, "user_id": 2065796, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/myEf4.jpg?s=128&g=1", "display_name": "Sasha Shpota", "link": "https://stackoverflow.com/users/2065796/sasha-shpota"}, "reply_to_user": {"reputation": 9244, "user_id": 2397550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAb8N.jpg?s=128&g=1", "display_name": "JoostS", "link": "https://stackoverflow.com/users/2397550/joosts"}, "edited": false, "score": 0, "creation_date": 1542275785, "post_id": 53309750, "comment_id": 93513609, "body": "@JoostS updated the question"}, {"owner": {"reputation": 9244, "user_id": 2397550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAb8N.jpg?s=128&g=1", "display_name": "JoostS", "link": "https://stackoverflow.com/users/2397550/joosts"}, "edited": false, "score": 1, "creation_date": 1542276487, "post_id": 53309750, "comment_id": 93514029, "body": "Still unclear to me what your goal is... prevent reflow? And what has that to do with SEO?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1542281655, "post_id": 53309750, "comment_id": 93517043, "body": "@OleksandrShpota Sorry, I did not realize you were the one asking the previous question I reference here."}, {"owner": {"reputation": 3409, "user_id": 924021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8d995624014ad789fc5065eaab7ebe2d?s=128&d=identicon&r=PG", "display_name": "Henrik", "link": "https://stackoverflow.com/users/924021/henrik"}, "edited": false, "score": 3, "creation_date": 1587626257, "post_id": 53309750, "comment_id": 108585814, "body": "Height and width makes initial layout faster (the image does not need to be loaded to render it) and it makes scaling images with CSS easier."}], "answers": [{"comments": [{"owner": {"reputation": 9244, "user_id": 2397550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAb8N.jpg?s=128&g=1", "display_name": "JoostS", "link": "https://stackoverflow.com/users/2397550/joosts"}, "edited": false, "score": 0, "creation_date": 1542282324, "post_id": 53318621, "comment_id": 93517448, "body": "Yes yes... alt attribute is missing... but that is done on purpose for brevity."}], "tags": [], "owner": {"reputation": 9244, "user_id": 2397550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAb8N.jpg?s=128&g=1", "display_name": "JoostS", "link": "https://stackoverflow.com/users/2397550/joosts"}, "is_accepted": false, "score": 0, "last_activity_date": 1542282988, "last_edit_date": 1542282988, "creation_date": 1542281836, "answer_id": 53318621, "question_id": 53309750, "link": "https://stackoverflow.com/questions/53309750/jekyll-get-width-height-of-an-image-without-using-an-external-plugin/53318621#53318621", "title": "Jekyll: Get width/height of an image without using an external plugin", "body": "<p><em>This question seems to apply to content images in markdown files. These images have no width or height set by default.</em></p>\n\n<hr>\n\n<p><strong>The short answer</strong></p>\n\n<p>You can just set the width and height directly in HTML in your markdown, like this:</p>\n\n<pre><code># Markdown title\n\nparagraph\n\n&lt;img src=\"/path/to/image.jpg\" width=\"400\" height=\"300\" /&gt;\n</code></pre>\n\n<hr>\n\n<p><strong>The long answer</strong></p>\n\n<p>You cannot retreive the width and height of the image programmatically without a plugin, so when you use (pure) markdown you get an image without a width and height property. The question is WHY you wanted to add a width and a height in the first place. Setting the width and height prevents reflow, but it leaves a big gaping hole while loading. Is that truly better? It certainly does not look nice. Progressive JPG's are a very nice solution for this problem, but I do not prefer to set the width and height on them, as 'no image' looks good, and a progressive JPG also always looks good. </p>\n\n<p>You say you want it for SEO reasons, but I cannot think of any.</p>\n\n<p>If your website is so slow you actually want to interact with content below the image before the reflow, the logical solution is to make your website load faster. </p>\n\n<p>However, if you have users with a really slow connection, you might want to manually add the image to the markdown in HTML. See the short answer for a code example.</p>\n"}, {"tags": [], "owner": {"reputation": 1956, "user_id": 1988326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d14f54e3f4b2a7015934faf1534e1c?s=128&d=identicon&r=PG", "display_name": "mark.monteiro", "link": "https://stackoverflow.com/users/1988326/mark-monteiro"}, "is_accepted": false, "score": 1, "last_activity_date": 1603223789, "creation_date": 1603223789, "answer_id": 64452457, "question_id": 53309750, "link": "https://stackoverflow.com/questions/53309750/jekyll-get-width-height-of-an-image-without-using-an-external-plugin/64452457#64452457", "title": "Jekyll: Get width/height of an image without using an external plugin", "body": "<p>Writing an internal filter to do this using the <a href=\"https://github.com/sdsykes/fastimage\" rel=\"nofollow noreferrer\">fastimage gem</a> is fairly simple. You can define your filter in the <code>_plugins</code> directory of your project (this is outlined in the <a href=\"https://jekyllrb.com/docs/plugins/installation/\" rel=\"nofollow noreferrer\">Jekyll documentation</a>)</p>\n<p>As a very rough example, you could do something like this:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>require 'fastimage'\n\nmodule ImageSizeFilter\n  def image_size(source, dimension)\n    # Get the image dimensions, throw an error on failure\n    # NOTE: You may want to sanitize the input string provided here\n    # see: https://github.com/sdsykes/fastimage#security\n    size = FastImage.size(source, raise_on_failure: true)\n\n    # Return the requested dimension, or both dimensions if nothing was specified\n    return size[0] if dimension == 'w'\n    return size[1] if dimension == 'h'\n    return size unless dimension\n\n    # Fail if the requested dimension is invalid\n    raise 'Invalid image size dimension requested: ' + dimension\n  end\nend\n\nLiquid::Template.register_filter(ImageSizeFilter)\n</code></pre>\n<p>Which would be used like so:</p>\n<pre class=\"lang-html prettyprint-override\"><code>&lt;img src={{source}}\n     width=&quot;{{source | image_size: 'w'}}&quot;\n     height=&quot;{{source | image_size: 'h'}}&quot;/&gt;\n</code></pre>\n<p>Of course this still won't work with GitHub pages directly because custom plugins are not supported. To use custom plugins in general, one solution is to <a href=\"https://stackoverflow.com/a/28252200/1988326\">build the site locally and include it in the repository</a>.</p>\n"}], "owner": {"reputation": 7274, "user_id": 2065796, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/myEf4.jpg?s=128&g=1", "display_name": "Sasha Shpota", "link": "https://stackoverflow.com/users/2065796/sasha-shpota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 2, "answer_count": 2, "score": 4, "last_activity_date": 1603223789, "creation_date": 1542234864, "last_edit_date": 1587648943, "question_id": 53309750, "link": "https://stackoverflow.com/questions/53309750/jekyll-get-width-height-of-an-image-without-using-an-external-plugin", "title": "Jekyll: Get width/height of an image without using an external plugin", "body": "<p>I want to automatically add <code>height</code> and <code>width</code> attributes to all my images. It is perfectly done via <a href=\"https://github.com/envygeeks/jekyll-assets\" rel=\"nofollow noreferrer\">this nice plugin</a>, but I host my site on GitHub Pages where external plugins are not supported.</p>\n\n<p><strong>Question:</strong> How to prefill height/width attributes of an image without using a plugin?</p>\n\n<p><strong>Why do I need this?</strong></p>\n\n<p><a href=\"http://sashashpota.com/\" rel=\"nofollow noreferrer\">My site</a> works well even without <code>height</code> and <code>width</code> but I want to specify them because it is important from SEO point of view (you can find some details on its importance <a href=\"https://mobiforge.com/design-development/fixit-specify-image-sizes\" rel=\"nofollow noreferrer\">here</a>).  </p>\n"}, {"tags": ["ruby", "formatting"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10583554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19a7b36a831eb2f370ea48f9ab2c9112?s=128&d=identicon&r=PG&f=1", "display_name": "Tobyrrr00", "link": "https://stackoverflow.com/users/10583554/tobyrrr00"}, "edited": false, "score": 0, "creation_date": 1542246058, "post_id": 53310458, "comment_id": 93503355, "body": "Ay that worked, You&#39;re a saint. I was breaking my head on that for a solid 30 minutes."}], "tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": false, "score": 1, "last_activity_date": 1542239231, "creation_date": 1542239231, "answer_id": 53310458, "question_id": 53309536, "link": "https://stackoverflow.com/questions/53309536/ruby-align-output-to-right-and-left-at-the-same-time/53310458#53310458", "title": "Ruby. Align Output to right AND left at the same time", "body": "<p>Your <code>b.each do |c,d|</code> loop is actually yielding each item in the array and attempting to destructure what isn't there, so you get:</p>\n\n<pre><code>\"%8s %5s\" % [\"shoes\", nil]\n\"%8s %5s\" % [\"59.55\", nil]\n</code></pre>\n\n<p>etc.</p>\n\n<p>You just need to omit your inner loop:</p>\n\n<pre><code>itemHash.each do |a,b|\n  print \" #{a}     \"\n  print \"%-8s %5s\" % b\n  puts\nend\n</code></pre>\n\n<p>Or more simply:</p>\n\n<pre><code>itemHash.each {|a, b| puts format(\" %-8s%-8s%5s\", a, *b) }\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10583554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19a7b36a831eb2f370ea48f9ab2c9112?s=128&d=identicon&r=PG&f=1", "display_name": "Tobyrrr00", "link": "https://stackoverflow.com/users/10583554/tobyrrr00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542239231, "creation_date": 1542233668, "question_id": 53309536, "link": "https://stackoverflow.com/questions/53309536/ruby-align-output-to-right-and-left-at-the-same-time", "title": "Ruby. Align Output to right AND left at the same time", "body": "<p>I have this Hash</p>\n\n<pre><code>itemHash = {\"124\"=&gt;[\"shoes\", \"59.99\"],\n            \"456\"=&gt;[\"pants\", \"49.50\"], \n            \"352\"=&gt;[\"socks\", \"3.99\"]}\n</code></pre>\n\n<p>I need to diplay it like this, with Description aligned to the left and Price to the right</p>\n\n<pre><code>Item    Description     Price\n-----   --------------  -----\n124     shoes           59.99\n352     socks            3.99\n456     pants           19.50\n</code></pre>\n\n<p>but when I try this code </p>\n\n<pre><code>itemHash.each do |a,b|\n  print \" #{a}     \"\n  b.each do |c,d|\n    print (\"%8s %5s\" % [c,d])\n  end\n  puts\nend\n</code></pre>\n\n<p>I get this </p>\n\n<pre><code> Item    Description      Price\n ----    -----------      -----\n\n 124        shoes         59.99\n 456        pants         49.50\n 352        socks          3.99\n</code></pre>\n\n<p>I've tried \"print (\"%8s %5-s\" % [c,d])\" and \"print (\"%-8s %5s\" % [c,d])\" but neither does it right. For some reason when I align the description (c) it automatically applies it to the price (d). Anything I'm missing here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "erb"], "answers": [{"tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 1, "last_activity_date": 1542246010, "creation_date": 1542246010, "answer_id": 53311258, "question_id": 53309423, "link": "https://stackoverflow.com/questions/53309423/rails-submit-check-box-with-matching-select/53311258#53311258", "title": "rails submit check box with matching select", "body": "<p>You have to group the field names by something. try this:</p>\n\n<p>First, use <code>each_with_index</code> to have some index to group them:</p>\n\n<pre><code>[\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"].each_with_indexx do |day, idx|\n</code></pre>\n\n<p>Now you can write something like this:</p>\n\n<pre><code>&lt;%= ff.check_box \"availabilities[#{idx}][day]\", .... %&gt;\n&lt;%= ff.select \"availabilitlies[#{idx}][start_time]\", .... %&gt;\n&lt;%= ff.select \"availabilitlies[#{idx}][end_time]\", .... %&gt;\n</code></pre>\n\n<p>Params will be a little different, instead of an array of objects you'll have this:</p>\n\n<pre><code>availabilities =&gt; {'0' =&gt; {'day' =&gt; 'Sunday', \"start_time\" =&gt; .., \"end_time\" =&gt; ...}, '1' =&gt; {'day' =&gt; 'Monday', .... }}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10657155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c98bea7256ac0ec54e1191a445f5ebb?s=128&d=identicon&r=PG&f=1", "display_name": "M. Sofiya", "link": "https://stackoverflow.com/users/10657155/m-sofiya"}, "is_accepted": false, "score": 1, "last_activity_date": 1542284199, "creation_date": 1542284199, "answer_id": 53319329, "question_id": 53309423, "link": "https://stackoverflow.com/questions/53309423/rails-submit-check-box-with-matching-select/53319329#53319329", "title": "rails submit check box with matching select", "body": "<p>Try this code:</p>\n\n<pre><code>  &lt;%= f.fields_for :availabilities do |ff| %&gt;     \n  &lt;div class=\"row\"&gt;\n  &lt;div class=\"col-md-4\"&gt;\n    &lt;div class=\"ck-button\"&gt;\n      &lt;label&gt;\n      &lt;% days = ['Mon', 'Tue', 'Wen', 'Thu', 'Fri', 'Sat', 'Sun'] %&gt;\n      &lt;% days.map do |day| %&gt;          \n      &lt;%= ff.check_box :count,{multiple: false},day,nil %&gt;\n      &lt;%= ff.label day %&gt;\n      &lt;%end%&gt;\n      &lt;/label&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"col-md-4\"&gt;\n    &lt;div class=\"answer\"&gt;\n      &lt;%= ff.select \"start_time\", [\"1 AM\", \"2 AM\", \"3 AM\", \"4 AM\", \"5 AM\", \"6 AM\", \"7 AM\", \"8 AM\", \"9 AM\", \"10 AM\", \"11 AM\", \"12 PM\", \"1 PM\", \"2 PM\", \"3 PM\", \"4 PM\", \"5 PM\", \"6 PM\", \"7 PM\", \"8 PM\", \"9 PM\", \"10 PM\", \"11 PM\"], {:selected =&gt; (@therapist.available_times.key?(day) ? @therapist.available_times[day][:start] : '7' )} %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"col-md-4\"&gt;\n    &lt;div class=\"answer\"&gt;\n      &lt;%= ff.select \"end_time\", [\"1 AM\", \"2 AM\", \"3 AM\", \"4 AM\", \"5 AM\", \"6 AM\", \"7 AM\", \"8 AM\", \"9 AM\", \"10 AM\", \"11 AM\", \"12 PM\", \"1 PM\", \"2 PM\", \"3 PM\", \"4 PM\", \"5 PM\", \"6 PM\", \"7 PM\", \"8 PM\", \"9 PM\", \"10 PM\", \"11 PM\"], {:selected =&gt; (@therapist.available_times.key?(day) ? @therapist.available_times[day][:end] : '17' )} %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;  &lt;% end %&gt; \n</code></pre>\n"}], "owner": {"reputation": 879, "user_id": 2260362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5152ad032e9e8b4f461aca8516954ff2?s=128&d=identicon&r=PG", "display_name": "Jamil Seaidoun", "link": "https://stackoverflow.com/users/2260362/jamil-seaidoun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1542284199, "creation_date": 1542233123, "last_edit_date": 1542234178, "question_id": 53309423, "link": "https://stackoverflow.com/questions/53309423/rails-submit-check-box-with-matching-select", "title": "rails submit check box with matching select", "body": "<p>I have a form that is displaying dates and times like so <a href=\"https://i.stack.imgur.com/6A6NN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6A6NN.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code for it looks like this:</p>\n\n<pre><code> &lt;%= f.fields_for :availabilities do |ff| %&gt;\n&lt;% [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"].each do |day| %&gt;\n    &lt;div class=\"row\"&gt;\n      &lt;div class=\"col-md-4\"&gt;\n        &lt;div class=\"ck-button\"&gt;\n          &lt;label&gt;\n            &lt;%= ff.check_box \"day\", {multiple: true, checked: @therapist.available_times.key?(day)}, day, false %&gt;\n            &lt;span&gt;&lt;%= day %&gt;&lt;/span&gt;\n          &lt;/label&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=\"col-md-4\"&gt;\n        &lt;div class=\"answer\"&gt;\n          &lt;%= ff.select \"start_time\", [\"1 AM\", \"2 AM\", \"3 AM\", \"4 AM\", \"5 AM\", \"6 AM\", \"7 AM\", \"8 AM\", \"9 AM\", \"10 AM\", \"11 AM\", \"12 PM\", \"1 PM\", \"2 PM\", \"3 PM\", \"4 PM\", \"5 PM\", \"6 PM\", \"7 PM\", \"8 PM\", \"9 PM\", \"10 PM\", \"11 PM\"], {:selected =&gt; (@therapist.available_times.key?(day) ? @therapist.available_times[day][:start] : '7' )} %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=\"col-md-4\"&gt;\n        &lt;div class=\"answer\"&gt;\n          &lt;%= ff.select \"end_time\", [\"1 AM\", \"2 AM\", \"3 AM\", \"4 AM\", \"5 AM\", \"6 AM\", \"7 AM\", \"8 AM\", \"9 AM\", \"10 AM\", \"11 AM\", \"12 PM\", \"1 PM\", \"2 PM\", \"3 PM\", \"4 PM\", \"5 PM\", \"6 PM\", \"7 PM\", \"8 PM\", \"9 PM\", \"10 PM\", \"11 PM\"], {:selected =&gt; (@therapist.available_times.key?(day) ? @therapist.available_times[day][:end] : '17' )} %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>When I submit this however, the data sent to my controller looks like this:</p>\n\n<pre><code>\"availabilities\"=&gt;{\"start_time\"=&gt;\"1 AM\", \"end_time\"=&gt;\"1 AM\", \"day\"=&gt;[\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\"]}\n</code></pre>\n\n<p>What I really want is to get:</p>\n\n<pre><code>\"availabilities\"=&gt;[{\"start_time\"=&gt; \"1 AM\", \"end_time\"=&gt;\"1 AM\", \"day\" =&gt; \"Monday\"},{\"start_time\"=&gt; ...},...]\n</code></pre>\n\n<p>only for the days that are selected.</p>\n\n<p>From the controller side, I have the permit looking as:</p>\n\n<pre><code>:availabilities =&gt; [:day, :start_time, :end_time],\n</code></pre>\n\n<p>EDIT:\nI changed the <code>multiple</code> to <code>false</code> and now my availabilities has the form I want but I only get the last checked, not an array of all the checked fields and their associated times</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rubygems", "instance-variables"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10205244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-53lQIBmIdrI/AAAAAAAAAAI/AAAAAAAAA68/0TuxXeDwmlw/photo.jpg?sz=128", "display_name": "Taariq", "link": "https://stackoverflow.com/users/10205244/taariq"}, "edited": false, "score": 0, "creation_date": 1542226250, "post_id": 53307671, "comment_id": 93496723, "body": "Hmm. I get an error            <code>the ClientGem::Model class does not implement the instance method: alias</code>"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "reply_to_user": {"reputation": 41, "user_id": 10205244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-53lQIBmIdrI/AAAAAAAAAAI/AAAAAAAAA68/0TuxXeDwmlw/photo.jpg?sz=128", "display_name": "Taariq", "link": "https://stackoverflow.com/users/10205244/taariq"}, "edited": false, "score": 0, "creation_date": 1542229294, "post_id": 53307671, "comment_id": 93498049, "body": "you&#39;re calling <code>model.alias</code> in your code so I assume the class returned from <code>ClienGem.find(id)</code> is something else"}, {"owner": {"reputation": 41, "user_id": 10205244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-53lQIBmIdrI/AAAAAAAAAAI/AAAAAAAAA68/0TuxXeDwmlw/photo.jpg?sz=128", "display_name": "Taariq", "link": "https://stackoverflow.com/users/10205244/taariq"}, "edited": false, "score": 0, "creation_date": 1542233377, "post_id": 53307671, "comment_id": 93499765, "body": "<code>.find(id)</code> returns a bunch of instance variables, one of which I can access with <code>.alias</code>"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "reply_to_user": {"reputation": 41, "user_id": 10205244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-53lQIBmIdrI/AAAAAAAAAAI/AAAAAAAAA68/0TuxXeDwmlw/photo.jpg?sz=128", "display_name": "Taariq", "link": "https://stackoverflow.com/users/10205244/taariq"}, "edited": false, "score": 0, "creation_date": 1542294236, "post_id": 53307671, "comment_id": 93524744, "body": "What you&#39;re saying doesn&#39;t make sense, no function call returns instance variables, they return objects.  What object is returned from <code>ClientGem.find(id)</code>?  If you do <code>ClientGem.find(id).class</code>, what is returned?"}, {"owner": {"reputation": 41, "user_id": 10205244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-53lQIBmIdrI/AAAAAAAAAAI/AAAAAAAAA68/0TuxXeDwmlw/photo.jpg?sz=128", "display_name": "Taariq", "link": "https://stackoverflow.com/users/10205244/taariq"}, "edited": false, "score": 0, "creation_date": 1542383434, "post_id": 53307671, "comment_id": 93561305, "body": "Ah thank you. The documentation for the gem is confusing. They use <code>.class</code> to return the objects but they have instance variables in the documentation.  &#175;_(\u30c4)_/&#175;"}], "tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 0, "last_activity_date": 1542224529, "creation_date": 1542224529, "answer_id": 53307671, "question_id": 53307612, "link": "https://stackoverflow.com/questions/53307612/how-can-i-mock-an-instance-variable-returned-from-a-client-in-rspec/53307671#53307671", "title": "How can I mock an instance variable returned from a Client in rspec", "body": "<p>Simply stub out the object itself.</p>\n\n<pre><code>model = instance_double(ClientGemReturnedKlass, alias: 'Test Alias')\nallow(ClientGem).to receive(:find).and_return(model)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10205244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-53lQIBmIdrI/AAAAAAAAAAI/AAAAAAAAA68/0TuxXeDwmlw/photo.jpg?sz=128", "display_name": "Taariq", "link": "https://stackoverflow.com/users/10205244/taariq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 53307671, "answer_count": 1, "score": 1, "last_activity_date": 1542224529, "creation_date": 1542224263, "question_id": 53307612, "link": "https://stackoverflow.com/questions/53307612/how-can-i-mock-an-instance-variable-returned-from-a-client-in-rspec", "title": "How can I mock an instance variable returned from a Client in rspec", "body": "<p>I have a service client that I call which returns a bunch of instance variables. I call this in a method which is called inside another method to return a response</p>\n\n<p>I want my method to return a specific one like so</p>\n\n<pre><code>def returnsAlias\n  model = ClientGem.find(id) #finds a bunch of instance variables by id\n  model.alias #returns @alias\nend\n</code></pre>\n\n<p>In my spec I have</p>\n\n<pre><code>allow(ClientGem).to receive(:find).and_return('Test Alias')\n</code></pre>\n\n<p>I'm not sure what to replace 'Test Alias' with. I tried @alias and using</p>\n\n<pre><code>@alias.instance_variable_set(:@alias, 'Test Alias')\n</code></pre>\n\n<p>But this returns this error</p>\n\n<pre><code>FrozenError:\n   can't modify frozen NilClass\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1542228237, "post_id": 53307360, "comment_id": 93497619, "body": "This indentation is really anarchy. Can you clean that up? It helps us understand what you&#39;re trying to do."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1542228300, "post_id": 53307360, "comment_id": 93497638, "body": "A good <a href=\"https://regex101.com\" rel=\"nofollow noreferrer\">regular expression explainer</a> can help illuminate what that regular expression is doing. Barring that, <a href=\"http://shop.oreilly.com/product/9780596528126.do\" rel=\"nofollow noreferrer\">a good primer book</a> is a good way to go."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571895027, "post_id": 53307360, "comment_id": 103392291, "body": "If any of the answers were helpful please consider selecting one."}], "answers": [{"comments": [{"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1542260719, "post_id": 53313097, "comment_id": 93506621, "body": "Really Impressive"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1542269712, "last_edit_date": 1542269712, "creation_date": 1542260432, "answer_id": 53313097, "question_id": 53307360, "link": "https://stackoverflow.com/questions/53307360/beginner-in-regular-expression/53313097#53313097", "title": "Beginner in regular expression", "body": "<p>The regular expression being passed as an argument (which I'll write in \"free-spacing\" mode, to make it self-documenting), is as follows:</p>\n\n<pre><code>r = /\n    (      # start capture group 1\n    [\"']   # match a double or single parenthesis (a \"character class\")\n    )      # end capture group 1\n    .*     # match zero or more (`*`) characters (any characters)\n    ?      # make the foregoing match (.*) lazy\n    \\1     # match the contents of capture group 1\n    /x     # free-spacing regex definition mode\n\nstr = 'He said \"Hello\"'\n  #=&gt; \"He said \\\"Hello\\\"\"\nstr =~ r\n  #=&gt; 8 (we have a match beginning at str[8])\n</code></pre>\n\n<p>As <code>str =~ r</code> is \"truthy\", we evaluate</p>\n\n<pre><code>\"#{$`}&lt;&lt;#{$&amp;}&gt;&gt;#{$'}\"\n   =&gt; \"He said &lt;&lt;\\\"Hello\\\"&gt;&gt;\"\n</code></pre>\n\n<p>The key here is that there are <em>three</em> global variables in this expression:</p>\n\n<pre><code>$` #=&gt; \"He said \"\n$&amp; #=&gt; \"\\\"Hello\\\"\"\n$' #=&gt; \"\"\n</code></pre>\n\n<p>The meanings of these variables are given in <a href=\"http://ruby-doc.org/core-2.5.1/doc/globals_rdoc.html\" rel=\"nofollow noreferrer\">this doc</a>. You will see that:</p>\n\n<ul>\n<li>$`  contains the string to the left of the last successful match;</li>\n<li>$&amp; contains the string matched by the last successful match; and</li>\n<li>$' contains the string to the right of the last successful match.</li>\n</ul>\n\n<p>So we have (and return)</p>\n\n<pre><code>\"#{\"He said \"}&lt;&lt;#{\"\\\"Hello\\\"\"}&gt;&gt;#{\"\"}\"\n  #=&gt; =&gt; \"He said &lt;&lt;\\\"Hello\\\"&gt;&gt;\"\n</code></pre>\n\n<p>We could alternatively use the class method <a href=\"http://ruby-doc.org/core-2.5.1/Regexp.html#method-c-last_match\" rel=\"nofollow noreferrer\">Regexp::last_match</a>:</p>\n\n<pre><code>last_match = Regexp.last_match\n  #=&gt; #&lt;MatchData \"\\\"Hello\\\"\" 1:\"\\\"\"&gt;\n</code></pre>\n\n<p><code>last_match</code> is an instance of the class <a href=\"https://ruby-doc.org/core-2.5.1/MatchData.html\" rel=\"nofollow noreferrer\">MatchData</a>. That class contains many useful methods, including ones that return the values of the three global variables mentioned above:</p>\n\n<pre><code>last_match.pre_match  #=&gt; \"He said \"\nlast_match[0]         #=&gt; \"\\\"Hello\\\"\"\nlast_match.post_match #=&gt; \"\"\n</code></pre>\n\n<p>I cannot say why the match <code>.*</code> in the regular expression was made <em>lazy</em> (by making it <code>.*?</code>).</p>\n"}], "owner": {"reputation": 65, "user_id": 6732684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H3Az6.png?s=128&g=1", "display_name": "Lawleyenda", "link": "https://stackoverflow.com/users/6732684/lawleyenda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1542269712, "creation_date": 1542223162, "last_edit_date": 1542258849, "question_id": 53307360, "link": "https://stackoverflow.com/questions/53307360/beginner-in-regular-expression", "title": "Beginner in regular expression", "body": "<pre><code>def showRE(a,re)\n  if a =~ re\n    \"#{$`}&lt;&lt;#{$&amp;}&gt;&gt;#{$'}\"\n  else\n    \"no match\"\n  end\nend\n\nshowRE('He said \"Hello\"', /([\"']).*?\\1/)\n  #=&gt; \"He said &lt;&lt;\\\"Hello\\\"&gt;&gt;\"\n</code></pre>\n\n<p>Can someone please explain why this function returns \"Hello\". More specifically, the purpose of *?\\ and how that results in function returning what it does. I know [\"'] finds either '/\"' or '/'' and \\1 refers to the match of the first group. However shouldn't that return -> 'He said Hello\"' since '/'' is the first line of the string that represents what is in the brackets? </p>\n"}, {"tags": ["javascript", "php", "html", "asp.net", "ruby"], "comments": [{"owner": {"reputation": 733, "user_id": 10270771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b48913d514a65468fd8f43a386c823d?s=128&d=identicon&r=PG&f=1", "display_name": "Chad", "link": "https://stackoverflow.com/users/10270771/chad"}, "edited": false, "score": 1, "creation_date": 1542222005, "post_id": 53306985, "comment_id": 93494812, "body": "Just use a space instead of %20 inside of the attribute."}, {"owner": {"reputation": 1, "user_id": 10653788, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pQa67hU4Y6k/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDt18BB7GKmu0BeMu0onfsZPvUKhA/mo/photo.jpg?sz=128", "display_name": "jack me", "link": "https://stackoverflow.com/users/10653788/jack-me"}, "reply_to_user": {"reputation": 733, "user_id": 10270771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b48913d514a65468fd8f43a386c823d?s=128&d=identicon&r=PG&f=1", "display_name": "Chad", "link": "https://stackoverflow.com/users/10270771/chad"}, "edited": false, "score": 0, "creation_date": 1542222155, "post_id": 53306985, "comment_id": 93494897, "body": "@luminoslty i know space = %20 but i need to know how can i send an post request without encoding % to %25"}, {"owner": {"reputation": 733, "user_id": 10270771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b48913d514a65468fd8f43a386c823d?s=128&d=identicon&r=PG&f=1", "display_name": "Chad", "link": "https://stackoverflow.com/users/10270771/chad"}, "edited": false, "score": 0, "creation_date": 1542222323, "post_id": 53306985, "comment_id": 93494978, "body": "instead of using %20 use a space, or +, or use javascript to submit your form so you can url decode &amp; url encode before you send your request."}, {"owner": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 2, "creation_date": 1542222370, "post_id": 53306985, "comment_id": 93495000, "body": "You can&#39;t. The post will form encode the data and server should be decoding it"}, {"owner": {"reputation": 1, "user_id": 10653788, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pQa67hU4Y6k/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDt18BB7GKmu0BeMu0onfsZPvUKhA/mo/photo.jpg?sz=128", "display_name": "jack me", "link": "https://stackoverflow.com/users/10653788/jack-me"}, "edited": false, "score": 0, "creation_date": 1542222469, "post_id": 53306985, "comment_id": 93495050, "body": "i want to send this %E5%98%8A but it&#39;s changing to %25E5%2598%258A"}, {"owner": {"reputation": 1, "user_id": 10653788, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pQa67hU4Y6k/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDt18BB7GKmu0BeMu0onfsZPvUKhA/mo/photo.jpg?sz=128", "display_name": "jack me", "link": "https://stackoverflow.com/users/10653788/jack-me"}, "reply_to_user": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 0, "creation_date": 1542222560, "post_id": 53306985, "comment_id": 93495088, "body": "@charlietfl why i can&#39;t"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542224350, "post_id": 53306985, "comment_id": 93495871, "body": "So you are looking to send \u560a for <a href=\"https://hackerone.com/reports/52042\" rel=\"nofollow noreferrer\">CRLF injection</a> purposes I assume? When you say submit this and encoding it, where is that occurring exactly?"}, {"owner": {"reputation": 1, "user_id": 10653788, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pQa67hU4Y6k/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDt18BB7GKmu0BeMu0onfsZPvUKhA/mo/photo.jpg?sz=128", "display_name": "jack me", "link": "https://stackoverflow.com/users/10653788/jack-me"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542224755, "post_id": 53306985, "comment_id": 93496047, "body": "@engineersmnky yes, can you bypass it?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1542224970, "post_id": 53306985, "comment_id": 93496131, "body": "You have provided nothing showing that this occurs, where it occurs, how it occurs. So at this point in time no I cannot but if you were to provide some evidence as to what you are actually experiencing then probably. Right now the assumption is that you wish to submit the literal &quot;%E5%98%8A&quot; which needs to have the % encoded properly.Thus &quot;%25&quot;"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1542228618, "post_id": 53306985, "comment_id": 93497771, "body": "Form-encoding will always encode <code>%</code>, you can&#39;t avoid this, so if you want to send literal <code>%</code> let it do its thing. On the receiving end this gets automatically decoded."}, {"owner": {"reputation": 7007, "user_id": 10195153, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VnLka.jpg?s=128&g=1", "display_name": "danblack", "link": "https://stackoverflow.com/users/10195153/danblack"}, "edited": false, "score": 0, "creation_date": 1542237427, "post_id": 53306985, "comment_id": 93501155, "body": "Stop being recalcitrant. You can&#39;t change the browser behaviour."}], "owner": {"reputation": 1, "user_id": 10653788, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pQa67hU4Y6k/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDt18BB7GKmu0BeMu0onfsZPvUKhA/mo/photo.jpg?sz=128", "display_name": "jack me", "link": "https://stackoverflow.com/users/10653788/jack-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1542221664, "creation_date": 1542221664, "question_id": 53306985, "link": "https://stackoverflow.com/questions/53306985/how-can-i-decoding-post-method-url", "title": "How can i decoding post method url?", "body": "<p>i want to send an post method request without enconding anything, \nFor example when i am submit this form the browser encoding the % to %25 so how can i fix it.</p>\n\n<pre><code>&lt;form action=\"https://e.target.com/i\" method=\"POST\" &gt;\n  &lt;input type=\"hidden\" name=\"redirect\" value=\"https://m.ex.com/?t=%20\" /&gt;\n  &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n&lt;/form&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1542219390, "post_id": 53306379, "comment_id": 93493581, "body": "Riddle me this. How can one have a <code>transaction</code> with a <code>number_of_stocks</code> in excess of their <code>number_of_stocks</code>? This seems like a simple validation <code>validates :number_of_stocks, numericality: {greater_than_or_equal_to: 0}</code> or if transaction is linked to the share holder than validate the number of stocks in the transaction prior"}, {"owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1542225547, "post_id": 53306379, "comment_id": 93496398, "body": "You are correct, I do not allow shareholders to sell more stocks than they own - and that is controlled in the view already, but what I was looking for here for some more assurance/safety on the back end - which now I&#39;ve added via your model validation suggestion - thanks! :)"}, {"owner": {"reputation": 3910, "user_id": 1522214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/083FS.png?s=128&g=1", "display_name": "Eric Norcross", "link": "https://stackoverflow.com/users/1522214/eric-norcross"}, "edited": false, "score": 1, "creation_date": 1542226717, "post_id": 53306379, "comment_id": 93496937, "body": "On a side note, try to avoid using operators like <code>+=</code> or <code>-=</code> because they aren&#39;t <a href=\"https://stackoverflow.com/a/15184752/1522214\">thread-safe</a>"}, {"owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "edited": false, "score": 0, "creation_date": 1542309442, "post_id": 53306379, "comment_id": 93533356, "body": "Thanks, makes sense!"}], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "edited": false, "score": 0, "creation_date": 1542220895, "post_id": 53306742, "comment_id": 93494283, "body": "Will go with the validation and logic in the model solution - thanks!"}, {"owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "edited": false, "score": 0, "creation_date": 1542296767, "post_id": 53306742, "comment_id": 93526534, "body": "Much better answer. So much so that I&#39;m deleting mine!"}], "tags": [], "owner": {"reputation": 428, "user_id": 2183615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518cc79aa30503ef2af8214f8060ff66?s=128&d=identicon&r=PG", "display_name": "Sophie D&#233;ziel", "link": "https://stackoverflow.com/users/2183615/sophie-d%c3%a9ziel"}, "is_accepted": true, "score": 4, "last_activity_date": 1542220595, "creation_date": 1542220595, "answer_id": 53306742, "question_id": 53306379, "link": "https://stackoverflow.com/questions/53306379/having-a-decrement-function-stop-at-0-in-ruby/53306742#53306742", "title": "Having a decrement (-=) function stop at 0 in Ruby", "body": "<p>I would suggest creating a method in your model called something like <code>#decrement_stock</code> that would handle that logic. You can set all kind of behaviors that should be expected, like raising exceptions. That approach follows the \"<a href=\"https://martinfowler.com/bliki/TellDontAsk.html\" rel=\"nofollow noreferrer\">tell don't ask</a>\" principle. It is also a simple unit of work performing a single task, making it easy to test with your favorite unit testing framework.</p>\n\n<p>As engineersmnky suggested, simply adding validation on the model is also a good solution if you want the controller to handle errors.</p>\n"}], "owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 53306742, "answer_count": 1, "score": 1, "last_activity_date": 1542220595, "creation_date": 1542218966, "question_id": 53306379, "link": "https://stackoverflow.com/questions/53306379/having-a-decrement-function-stop-at-0-in-ruby", "title": "Having a decrement (-=) function stop at 0 in Ruby", "body": "<p>I have the following line of code which very simply decrements a Shareholders number of stocks (integer in the DB) when they sell them to someone else. This works well and as expected.</p>\n\n<pre><code>@selling_shareholder.update_attribute(:number_of_stocks, @selling_shareholder.number_of_stocks -= @transaction.number_of_stocks)\n</code></pre>\n\n<p>Very simply what I'd like to do is have the decrement function stop when the <code>number_of_stocks</code> hits 0 i.e. having a negative number should not be possible. </p>\n\n<p>I guess I could use a simple <code>unless @selling_shareholder.number_of_stocks &gt; 0</code> at the end of the line, but I'm wondering if that will actually work without using a loop? </p>\n"}, {"tags": ["node.js", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1542308406, "post_id": 53309506, "comment_id": 93532875, "body": "All though this seems to be a working solution I ended up not having to use it. Still I can verify that this works."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 1, "creation_date": 1542308568, "post_id": 53309506, "comment_id": 93532954, "body": "@PabloJomer I honestly would not recommend using it simply for the fact that it can not be converted back unless all characters are less than 8 bits and not 127"}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1542308666, "post_id": 53309506, "comment_id": 93532995, "body": "I understood that. The reason we needed it was because we needed to compare this string that was generated by a system that was not under our control. But it turned out that we could use another method where this was not necessary."}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1542308690, "post_id": 53309506, "comment_id": 93533003, "body": "Thanks for the help I bet it will help some one in the future."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 2, "last_activity_date": 1542289156, "last_edit_date": 1542289156, "creation_date": 1542233465, "answer_id": 53309506, "question_id": 53306350, "link": "https://stackoverflow.com/questions/53306350/ruby-equivalent-of-node-tostringascii/53309506#53309506", "title": "Ruby equivalent of Node .toString(&#39;ascii&#39;)", "body": "<p>Okay well I am not that familiar with Node.js but you can get fairly close with some basic understandings: </p>\n\n<p>Node states:</p>\n\n<blockquote>\n  <p>'ascii' - For 7-bit ASCII data only. This encoding is fast and will strip the high bit if set.</p>\n</blockquote>\n\n<p><strong>Update</strong> After rereading the nod.js description I think it just means it will drop 127 and only focus on the first 7 bits so this can be simplified to: </p>\n\n<pre><code>def node_js_ascii(bytes) \n  bytes.map {|b| b % 128 }\n    .reject(&amp;127.method(:==))\n    .pack('C*')\n    .encode(Encoding::UTF_8)\nend\nnode_js_ascii(a)\n#=&gt;  #=&gt; \"5qx9\\bpR\\\"Ho\\u0004.\\u0012R&gt;\\u0005XPa:\\vj|v\\u0013?T\\u001E~xL\"\n</code></pre>\n\n<p>Now the only differences are that node.js uses \"\\u000b\" to represent a vertical tab and ruby uses \"\\v\" and that ruby uses uppercase characters for unicode rather than lowercase (\"\\u001E\" vs \"\\u001e\") (you could handle this if you so chose)</p>\n\n<p><strong>Please note</strong> This form of encoding is not reversible due to the fact that you have characters that are greater than 8 bits in your byte array. </p>\n\n<p><strong>TL;DR</strong> (previous explanation and solution only works up to 8 bits)</p>\n\n<p>Okay so we know the max supported decimal is 127 (<code>\"1111111\".to_i(2)</code>) and that node will strip the high bit if set meaning [I am assuming] 241 (an 8 bit number will become 113 if we strip the high bit)</p>\n\n<p>With that understanding we can use:</p>\n\n<pre><code>a = [53, 127, 241, 120, 57, 136, 112, 210, 162, 200, 111, 132, 46, 146, 210, 62, 133, 88, 80, 97, 58, 139, 234, 252, 246, 19, 191, 84, 30, 126, 248, 76].map do |b| \n    b &lt; 128 ? b : b - 128\nend.pack('C*')\n#=&gt; \"5\\x7Fqx9\\bpR\\\"Ho\\x04.\\x12R&gt;\\x05XPa:\\vj|v\\x13?T\\x1E~xL\"\n</code></pre>\n\n<p>Then we can encode that as <code>UTF-8</code> like so: </p>\n\n<pre><code>a.encode(Encoding::UTF_8)\n#=&gt; \"5\\u007Fqx9\\bpR\\\"Ho\\u0004.\\u0012R&gt;\\u0005XPa:\\vj|v\\u0013?T\\u001E~xL\"\n</code></pre>\n\n<p>but there is still is still an issue here. </p>\n\n<p>It seems Node.js also ignores the Delete (127) when it converts to 'ascii' (I mean the high bit is set but if we strip it then it is 63 (\"?\") which doesn't match the output) so we can fix that too </p>\n\n<pre><code> a = [53, 127, 241, 120, 57, 136, 112, 210, 162, 200, 111, 132, 46, 146, 210, 62, 133, 88, 80, 97, 58, 139, 234, 252, 246, 19, 191, 84, 30, 126, 248, 76].map do |b| \n    b &lt; 127 ? b : b - 128\nend.pack('C*')\n#=&gt; \"5\\xFFqx9\\bpR\\\"Ho\\x04.\\x12R&gt;\\x05XPa:\\vj|v\\x13?T\\x1E~xL\"\na.encode(Encoding::UTF_8, undef: :replace, replace: '')\n#=&gt; \"5qx9\\bpR\\\"Ho\\u0004.\\u0012R&gt;\\u0005XPa:\\vj|v\\u0013?T\\u001E~xL\"\n</code></pre>\n\n<p>Now since 127 - 128 = -1  (negative signed bit) becomes \"\\xFF\"   an undefined character in UTF-8 so we add <code>undef: :replace</code> what to do when the character is undefined use replace and we add <code>replace: ''</code> to replace with nothing.  </p>\n"}], "owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 53309506, "answer_count": 1, "score": 1, "last_activity_date": 1542289156, "creation_date": 1542218839, "last_edit_date": 1542220100, "question_id": 53306350, "link": "https://stackoverflow.com/questions/53306350/ruby-equivalent-of-node-tostringascii", "title": "Ruby equivalent of Node .toString(&#39;ascii&#39;)", "body": "<p>I am struggling with converting a Node application to Ruby. I have a Buffer of integers that I need to encode as an ASCII string.</p>\n\n<p>In Node this is done like this:</p>\n\n<pre><code>const a = Buffer([53, 127, 241, 120, 57, 136, 112, 210, 162, 200, 111, 132, 46, 146, 210, 62, 133, 88, 80, 97, 58, 139, 234, 252, 246, 19, 191, 84, 30, 126, 248, 76])\nconst b = a.toString('hex')\n// b = \"357ff178398870d2a2c86f842e92d23e855850613a8beafcf613bf541e7ef84c\"\nconst c = a.toString('ascii') \n// c = '5qx9\\bpR\"Ho\\u0004.\\u0012R&gt;\\u0005XPa:\\u000bj|v\\u0013?T\\u001e~xL'\n</code></pre>\n\n<p>I want to get the same output in Ruby but I don't know how to convert <code>a</code> to <code>c</code>. I used <code>b</code> to validate that <code>a</code> is parsed the same in Ruby and Node and it looks like it's working.</p>\n\n<pre><code>a = [53, 127, 241, 120, 57, 136, 112, 210, 162, 200, 111, 132, 46, 146, 210, 62, 133, 88, 80, 97, 58, 139, 234, 252, 246, 19, 191, 84, 30, 126, 248, 76].pack('C*')\nb = a.unpack('H*') \n# [\"357ff178398870d2a2c86f842e92d23e855850613a8beafcf613bf541e7ef84c\"]\n# c = ???\n</code></pre>\n\n<p>I have tried serveral things, virtually all of the unpack options, and I also tried using the encode function but I lack the understanding of what the problem is here.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1542217220, "post_id": 53305735, "comment_id": 93492651, "body": "What happens if 7 of the top 10 books are non-fiction? Also to satisfy this requirement you are not truly sampling and should probably partition the dataset"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1542218158, "post_id": 53305735, "comment_id": 93493053, "body": "These requirements don&#39;t really make sense for the above mentioned edge case. I would suggest changing them to something like: &quot;Show one of the top 3 non-fiction books, and 4 of the top 10 fiction books&quot;. Or maybe some other variation like: &quot;Show one the top 10 overall books that&#39;s non-fiction (if it exists), and 4-5 of the top 10 fiction books (but not necessarily top 10 overall books), depending on whether that first book was found&quot;"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1542218184, "post_id": 53305735, "comment_id": 93493070, "body": "...In which case, you could just perform two queries and merge the result. Nothing too fancy."}], "answers": [{"tags": [], "owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "is_accepted": true, "score": 1, "last_activity_date": 1542221643, "creation_date": 1542221643, "answer_id": 53306975, "question_id": 53305735, "link": "https://stackoverflow.com/questions/53305735/control-contents-of-an-array-sample/53306975#53306975", "title": "Control contents of an array sample", "body": "<p>If you want to do complicated results, sometimes it's best not to do it all in one query. It can be much harder to maintain than simple logic. However, there is definitely a balance to maintainability, scalability, and performance.</p>\n\n<p>I would suggest doing something like this:</p>\n\n<pre><code>def top_books(limited_genres: [])\n  non_limited_books = Book.where.not(genre: limited_genres).order('units_sold DESC').first(10).sample(5)\n  limited_books = Book.where(genre: limited_genres).order('units_sold DESC').first(5).sample(1) # rename to limited_book if sample is kept to 1\n  (top_books + limited_books).sort_by(:units_sold)[0..5]\nend\n\n@top_selling_books = top_books(limited_genres: ['non-fiction'])\n</code></pre>\n\n<p>This is non tested code. It's just to give you an idea on how to accomplish your goals.</p>\n"}], "owner": {"reputation": 731, "user_id": 6649450, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9845257fa0e0700eb7097ebfd418fe32?s=128&d=identicon&r=PG&f=1", "display_name": "B B", "link": "https://stackoverflow.com/users/6649450/b-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 53306975, "answer_count": 1, "score": 1, "last_activity_date": 1542221643, "creation_date": 1542216485, "question_id": 53305735, "link": "https://stackoverflow.com/questions/53305735/control-contents-of-an-array-sample", "title": "Control contents of an array sample", "body": "<p>I have a collection of <code>books</code>. In my view I want to show a random sample of 5 books from the top 10 bestselling books in my DB. However, I only want a maximum of ONE non-fiction title (<code>book.genre</code>) showing in that sample. It's ok if no non-fiction books are sampled.</p>\n\n<p>Controller:</p>\n\n<pre><code>def index \n  @top_selling_books = Book.all.order('units_sold DESC').first(10).sample(5)\nend\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>&lt;% @top_selling_books.each.with_index(1) do |book, index| %&gt;\n  &lt;div&gt;\n    &lt;%= render \"books/top_sellers\", book: book, index: index %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "rake-task", "dbmigrate"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1542215546, "post_id": 53305367, "comment_id": 93491780, "body": "The first line of the error explains what to do"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10583700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0nroM.jpg?s=128&g=1", "display_name": "V\u01b0\u1ee3ng", "link": "https://stackoverflow.com/users/10583700/v%c6%b0%e1%bb%a3ng"}, "edited": false, "score": 0, "creation_date": 1542253877, "post_id": 53305382, "comment_id": 93504948, "body": "Hi kevcha, Can I edit by command below ? grep -rl &quot;ActiveRecord::Migration$&quot; db | xargs sed -i &#39;s/ActiveRecord::Migration/ActiveRecord::Migration[5.2]/g&#39;"}], "tags": [], "owner": {"reputation": 842, "user_id": 1386619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HOcXi.png?s=128&g=1", "display_name": "kevcha", "link": "https://stackoverflow.com/users/1386619/kevcha"}, "is_accepted": true, "score": 2, "last_activity_date": 1542215114, "creation_date": 1542215114, "answer_id": 53305382, "question_id": 53305367, "link": "https://stackoverflow.com/questions/53305367/error-when-use-rake-dbmigrate-on-ubuntu-16-04-5-lts/53305382#53305382", "title": "error when use &quot;rake db:migrate&quot; on Ubuntu 16.04.5 LTS", "body": "<p>Your migrations in <code>db/migrate</code> directory should all inherit from <code>ActiveRecord::Migration[5.2]</code>, not <code>ActiveRecord::Migration</code></p>\n"}], "owner": {"reputation": 3, "user_id": 10583700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0nroM.jpg?s=128&g=1", "display_name": "V\u01b0\u1ee3ng", "link": "https://stackoverflow.com/users/10583700/v%c6%b0%e1%bb%a3ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 53305382, "answer_count": 1, "score": 0, "last_activity_date": 1542218656, "creation_date": 1542215063, "last_edit_date": 1542218656, "question_id": 53305367, "link": "https://stackoverflow.com/questions/53305367/error-when-use-rake-dbmigrate-on-ubuntu-16-04-5-lts", "title": "error when use &quot;rake db:migrate&quot; on Ubuntu 16.04.5 LTS", "body": "<p>I'm use \"rake db:migrate\" and getting this error message:\nPls help me to fix that:</p>\n\n<pre><code># rake db:migrate rake aborted! \nStandardError: An error has occurred, this and all later migrations canceled:\nDirectly inheriting from ActiveRecord::Migration is not supported. Please specify the Rails release the migration was written for:\n  class CreateUsers &lt; ActiveRecord::Migration[4.2] \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:528:in `inherited' \n/root/genieacs-gui/db/migrate/20160202145722_create_users.rb:1:in `&lt;top (required)&gt;' \n/var/lib/gems/2.3.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `require' \n/var/lib/gems/2.3.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `block in require' \n/var/lib/gems/2.3.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:253:in `load_dependency' \n/var/lib/gems/2.3.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `require' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:986:in `load_migration' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:982:in `migration' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:977:in `disable_ddl_transaction' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:1350:in `use_transaction?' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:1342:in `ddl_transaction' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:1291:in `execute_migration_in_transaction' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:1263:in `block in migrate_without_lock' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:1262:in `each' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:1262:in `migrate_without_lock' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:1212:in `migrate' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:1036:in `up' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/migration.rb:1011:in `migrate' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/tasks/database_tasks.rb:172:in `migrate' \n/var/lib/gems/2.3.0/gems/activerecord-5.2.1/lib/active_record/railties/databases.rake:60:in `block (2 levels) in &lt;top (required)&gt;' \n/var/lib/gems/2.3.0/gems/rake-12.3.1/exe/rake:27:in `&lt;top (required)&gt;'\n#...\nTasks: TOP =&gt; db:migrate\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 670, "user_id": 7753036, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-xzanDakZBsU/AAAAAAAAAAI/AAAAAAAAAE0/t7hgUGyGIc0/photo.jpg?sz=128", "display_name": "mkrl", "link": "https://stackoverflow.com/users/7753036/mkrl"}, "edited": false, "score": 2, "creation_date": 1542214466, "post_id": 53305033, "comment_id": 93491168, "body": "Fork, rewrite it and point gem to your new repo <code>gem &#39;query_reviewer &#39;, :git =&gt; &#39;git:&#47;&#47;github.com&#47;username&#47;repo.git&#39;</code>:)"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1542216139, "post_id": 53305033, "comment_id": 93492079, "body": "This is unfortunately the only solution if you want to use Rails 5.x with a gem not designed for it - and it&#39;s easier than it sounds!"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542216578, "post_id": 53305033, "comment_id": 93492309, "body": "Especially in this case since it should be as simple as using <code>Module#prepend</code> <a href=\"https://www.justinweiss.com/articles/rails-5-module-number-prepend-and-the-end-of-alias-method-chain/\" rel=\"nofollow noreferrer\">This Article might help</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9149410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ccdbdbd678f35c60bd1f851ef7f8ec?s=128&d=identicon&r=PG&f=1", "display_name": "Rabendra Sharma", "link": "https://stackoverflow.com/users/9149410/rabendra-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1556024966, "creation_date": 1556024966, "answer_id": 55812012, "question_id": 53305033, "link": "https://stackoverflow.com/questions/53305033/upgrade-to-rails-5-1-gem-query-reviewer-and-deprecated-method-alias-method-c/55812012#55812012", "title": "Upgrade to Rails 5.1, gem `query_reviewer` and deprecated method `alias_method_chain`", "body": "<p>In rails 5+ alias_method_chain has removed, so in place of this we can use alias_method like below</p>\n\n<pre><code>  base.alias_method :select_without_review, :select\n  base.alias_method :select, :select_with_review\n  base.alias_method :update_without_review, :update\n  base.alias_method :update, :update_with_review\n  base.alias_method :insert_without_review, :insert\n  base.alias_method :insert, :insert_with_review\n  base.alias_method :delete_without_review, :delete\n  base.alias_method :delete, :delete_with_review \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9636518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c8ecc604249dce409689055524f7af?s=128&d=identicon&r=PG&f=1", "display_name": "Polo M2B", "link": "https://stackoverflow.com/users/9636518/polo-m2b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556024966, "creation_date": 1542213896, "question_id": 53305033, "link": "https://stackoverflow.com/questions/53305033/upgrade-to-rails-5-1-gem-query-reviewer-and-deprecated-method-alias-method-c", "title": "Upgrade to Rails 5.1, gem `query_reviewer` and deprecated method `alias_method_chain`", "body": "<p>Rails community!</p>\n\n<p>I'm having an issue about upgrading on Rails project from Rails 4.2 to Rails 5.2, issue related to the step from Rails 5.0 to 5.1</p>\n\n<pre><code>/gems/query_reviewer-0.2.2/lib/query_reviewer/mysql_adapter_extensions.rb:4:in `included': undefined method `alias_method_chain' for ActiveRecord::ConnectionAdapters::Mysql2Adapter:Class (NoMethodError)\n</code></pre>\n\n<p>I've  read a lot of related questions here, and I understood that method <code>alias_method_chains</code> is deprecated with Rails 5.1... </p>\n\n<p>However, here, issue comes from a gem, especially gem <code>query_reviewer</code> (<a href=\"https://github.com/nesquena/query_reviewer\" rel=\"nofollow noreferrer\">github</a>, <a href=\"https://rubygems.org/gems/query_reviewer\" rel=\"nofollow noreferrer\">rubygems</a>):\nLast version of this gem is 0.2.2 (septembre 16, 2013) and includes the deprecated method:</p>\n\n<pre><code>module QueryReviewer\n  module MysqlAdapterExtensions\n    def self.included(base)\n      base.alias_method_chain :select, :review\n      base.alias_method_chain :update, :review\n      base.alias_method_chain :insert, :review\n      base.alias_method_chain :delete, :review\n    end\n</code></pre>\n\n<p>Obviously, this gem is not available with Rails 5.1, and obvious but painful option would be to look for an other gem... But, maybe, someone had the same issue and found a better way to answer to this 1st question as StackOverflow user ;) ?</p>\n\n<p>Thanks by advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1542213071, "post_id": 53304777, "comment_id": 93490385, "body": "<code>ActiveRecord::Base#find</code> raises an exception if the record cannot be found, does not it?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1542213308, "post_id": 53304777, "comment_id": 93490526, "body": "@AlekseiMatiushkin Afaik understand the question the page exists, but <code>page.url</code> might be blank. I am not sure how <code>ActiveRecord::Base#find</code> raising an exception might help in this case."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1542213435, "post_id": 53304777, "comment_id": 93490618, "body": "I agree, there is a lack of understanding what problem OP actually experiences, but If the page exists, <code>&lt;% if @post.url == nil %&gt;</code> would work. <code>blank?</code> might be the solution then, yes."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542218034, "post_id": 53304777, "comment_id": 93492995, "body": "&quot;empty string&quot; according to <code>String</code> is <code>&quot;&quot;</code> but a <code>blank?</code> string is an <code>empty?</code> <code>String</code> or purely whitespace <code>&quot;   &quot;</code> or <code>&quot;\\r\\n\\t&quot;</code> using <code>empty? || (&#47;\\A[[:space:]]*\\z&#47; === self)</code> (with some omitted error handling)"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1542213199, "last_edit_date": 1542213199, "creation_date": 1542213043, "answer_id": 53304777, "question_id": 53304724, "link": "https://stackoverflow.com/questions/53304724/how-to-check-if-controller-action-variable-is-empty/53304777#53304777", "title": "How to check if controller action variable is empty", "body": "<p>I would just go with </p>\n\n<pre><code>if @post.url.nil? \n</code></pre>\n\n<p>which returns <code>true</code> when <code>@post.url</code> is <code>nil</code> but <code>false</code> when <code>@post.url</code> is an empty string.</p>\n\n<p>Alternatively, you can use</p>\n\n<pre><code>if @post.url.blank?\n</code></pre>\n\n<p>which returns <code>true</code> in both cases when <code>@post.url</code> is <code>nil</code> or an empty string.</p>\n"}, {"tags": [], "owner": {"reputation": 100, "user_id": 10463251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff958d5dc3d428d04f1cce2f80433712?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin W.", "link": "https://stackoverflow.com/users/10463251/kevin-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1542213663, "creation_date": 1542213663, "answer_id": 53304963, "question_id": 53304724, "link": "https://stackoverflow.com/questions/53304724/how-to-check-if-controller-action-variable-is-empty/53304963#53304963", "title": "How to check if controller action variable is empty", "body": "<p>The following answer to a similar question seems to be what you are after:</p>\n\n<pre><code>if my_string.to_s.empty?\n  # It's nil or empty\nend\n</code></pre>\n\n<p>see: <a href=\"https://stackoverflow.com/questions/247948/is-there-a-better-way-of-checking-nil-or-length-0-of-a-string-in-ruby\">Is There a Better Way of Checking Nil or Length == 0 of a String in Ruby?</a></p>\n\n<p>If you need something more sophisticated than checking for nil or empty then you might want a URL validation method.</p>\n"}], "owner": {"reputation": 55, "user_id": 10598322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zMUwVZRjxbg/AAAAAAAAAAI/AAAAAAAAABM/qPUt_NxbUi4/photo.jpg?sz=128", "display_name": "kubet", "link": "https://stackoverflow.com/users/10598322/kubet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 53304777, "answer_count": 2, "score": 0, "last_activity_date": 1542213663, "creation_date": 1542212882, "last_edit_date": 1542213144, "question_id": 53304724, "link": "https://stackoverflow.com/questions/53304724/how-to-check-if-controller-action-variable-is-empty", "title": "How to check if controller action variable is empty", "body": "<p>I tried this in my views</p>\n\n<pre><code>&lt;% if @post.url == nil %&gt;\n&lt;h1&gt;File not found!&lt;/h1&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>in post controller I have</p>\n\n<pre><code>def show\n  @post = Post.find(params[:id])\nend\n</code></pre>\n\n<p>how to check if <code>@post.url</code> is empty?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1542206952, "post_id": 53302806, "comment_id": 93486439, "body": "What is <code>subject</code> of the test examples? What does <code>#perform</code> method? Does it save any records? What is <code>lab_inclusion_labs</code>?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1542207826, "post_id": 53302806, "comment_id": 93487060, "body": "Have edited the question. The perform method is functioning as intended, I think I am testing it the wrong way."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1542208350, "post_id": 53302806, "comment_id": 93487435, "body": "Have you tried <code>populated_lab_collection.labs(true)</code>?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1542208740, "post_id": 53302806, "comment_id": 93487646, "body": "I hadn&#39;t, but getting an invalid arguments error 1 for 0"}], "answers": [{"comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1542207539, "post_id": 53303043, "comment_id": 93486855, "body": "No joy unfortunately"}, {"owner": {"reputation": 111, "user_id": 4275302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b495db33ec776c3e6a7dfd347f80a4ae?s=128&d=identicon&r=PG&f=1", "display_name": "A_rayB", "link": "https://stackoverflow.com/users/4275302/a-rayb"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1542211502, "post_id": 53303043, "comment_id": 93489401, "body": "Have you tried without the <code>-&gt; { published }</code> in the has_many? Just to see if that is affecting it  <code>has_many :labs, through: :lab_collection_labs</code>"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1542211887, "post_id": 53303043, "comment_id": 93489626, "body": "Dear God I wish you knew how much time I&#39;ve spent on this.... you&#39;re right - they were being filtered out as I&#39;d not set the published attribute - A thousand thankyous"}, {"owner": {"reputation": 111, "user_id": 4275302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b495db33ec776c3e6a7dfd347f80a4ae?s=128&d=identicon&r=PG&f=1", "display_name": "A_rayB", "link": "https://stackoverflow.com/users/4275302/a-rayb"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1542211985, "post_id": 53303043, "comment_id": 93489682, "body": "No worries, wish I&#39;d mentioned it sooner!"}], "tags": [], "owner": {"reputation": 111, "user_id": 4275302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b495db33ec776c3e6a7dfd347f80a4ae?s=128&d=identicon&r=PG&f=1", "display_name": "A_rayB", "link": "https://stackoverflow.com/users/4275302/a-rayb"}, "is_accepted": true, "score": 2, "last_activity_date": 1542207393, "creation_date": 1542207393, "answer_id": 53303043, "question_id": 53302806, "link": "https://stackoverflow.com/questions/53302806/rspec-refreshing-associations/53303043#53303043", "title": "RSpec - refreshing associations", "body": "<p>If you create an instance in a before hook or in a spec and then perform some database related work on it the instance you have will no longer reference the up to date information.</p>\n\n<p>Try reloading the populated_lab_collection before asserting.</p>\n\n<pre><code>expect(populated_lab_collection.reload.labs).not_to eq labs\n</code></pre>\n"}], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 53303043, "answer_count": 1, "score": 0, "last_activity_date": 1542207799, "creation_date": 1542206641, "last_edit_date": 1542207799, "question_id": 53302806, "link": "https://stackoverflow.com/questions/53302806/rspec-refreshing-associations", "title": "RSpec - refreshing associations", "body": "<p>I have a LabCollection:</p>\n\n<pre><code>class LabCollection &lt; ApplicationRecord\n  # Relationships\n  belongs_to :lab_container, polymorphic: true, optional: true\n  has_many :lab_collection_labs\n  has_many :labs, -&gt; { published }, through: :lab_collection_labs\n  has_many :lab_collection_inclusions, dependent: :destroy\nend\n</code></pre>\n\n<p>It has many LabCollectionLabs:</p>\n\n<pre><code>class LabCollectionLab &lt; ApplicationRecord\n  acts_as_list scope: :lab_collection_id, add_new_at: :bottom\n  belongs_to :lab_collection\n  belongs_to :lab\nend\n</code></pre>\n\n<p>Which has a lab ID and belongs to a lab.</p>\n\n<p>I have a spec which tests how new associations are created, and it's failling at the following point:</p>\n\n<pre><code>context 'when the lab container has labs already present' do\n        it 'removes the present labs and adds the new ones' do\n          subject = RawLabAdder\n          expect(populated_lab_collection.labs).to eq labs\n          subject.new(populated_lab_collection, [lab4.id, lab5.id]).perform\n          expect(populated_lab_collection.labs).not_to eq labs\n          binding.pry\n          expect(populated_lab_collection.labs).to eq [lab4, lab5]\n        end\n      end\n</code></pre>\n\n<p>If you need to see the internal working of the code let me know, however the issue seems to be with RSpec and refreshing associations. When I hit the binding.pry point and call populated_lab_collection.lab_collection_labs</p>\n\n<pre><code>populated_lab_collection.lab_collection_labs\n=&gt;\n[lab_collection_lab_4, lab_collection_lab_5]\n</code></pre>\n\n<p>However when I call .labs instead:</p>\n\n<pre><code>populated_lab_collection.labs\n=&gt;\n[]\n</code></pre>\n\n<p>Inspecting the lab_collection_labs, I can see that they each have a lab_id and that a lab exists for those ID's. I believe my problem is that I'm not refreshing the records correctly, however I've tried:</p>\n\n<pre><code>      # populated_lab_collection.reload\n      # populated_lab_collection.lab_collection_labs.reload\n      # populated_lab_collection.lab_collection_labs.each do |x|\n      #   x.lab.reload\n      # end\n      # populated_lab_collection.labs.reload\n</code></pre>\n\n<p>Any advice on how I can get RSpec to correctly read in a records nested associations is greatly appreciated. As I say when I inspect the record, it has 2 lab_inclusion_labs, which each have a lab, however the parent record apparently has no labs.</p>\n\n<p>EDIT: RawLabAdder class:</p>\n\n<pre><code>module LabCollections\n  class RawLabAdder\n\n    def initialize(incoming_lab_collection, lab_ids = [])\n      @lab_ids = lab_ids\n      @lab_collection = incoming_lab_collection\n    end\n\n    def perform\n      remove_associated_labs\n      add_labs\n    end\n\n    private\n\n    def add_labs\n      @lab_ids.each do |x|\n        lab = Lab.find(x)\n        LabCollectionInclusionAdder.new(@lab_collection, lab).perform\n      end\n    end\n\n    def remove_associated_labs\n      @lab_collection.lab_collection_inclusions.map(&amp;:destroy)\n      @lab_collection.lab_collection_labs.map(&amp;:destroy)\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "edited": false, "score": 0, "creation_date": 1542207083, "post_id": 53302307, "comment_id": 93486536, "body": "Just to be clear, you want to delete the person from the file via keyword?"}, {"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "edited": false, "score": 0, "creation_date": 1542207119, "post_id": 53302307, "comment_id": 93486559, "body": "<code>I was trying to delete the supplied keyword from the array</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6398538"}, "reply_to_user": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "edited": false, "score": 0, "creation_date": 1542207254, "post_id": 53302307, "comment_id": 93486644, "body": "@GavinMiller: correct delete it from the text file. and then when the List command was executed it must not appear anymore on the list."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6398538"}, "edited": false, "score": 0, "creation_date": 1542207207, "post_id": 53302821, "comment_id": 93486616, "body": "For some reason it doesn&#39;t delete the item on the text file."}, {"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "edited": false, "score": 0, "creation_date": 1542207239, "post_id": 53302821, "comment_id": 93486635, "body": "You did not ask to delete the item from the text file :) <code>I was trying to delete the supplied keyword from the array</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6398538"}, "edited": false, "score": 0, "creation_date": 1542207286, "post_id": 53302821, "comment_id": 93486670, "body": "yes. By default i&#39;ll get an array which was read from a text file."}, {"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "edited": false, "score": 0, "creation_date": 1542207360, "post_id": 53302821, "comment_id": 93486725, "body": "My code is updating the array called <code>person</code>. This array was initially loaded from a file but it has nothing to do with file afterwards. Any changes in the array won&#39;t affect the file!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6398538"}, "edited": false, "score": 0, "creation_date": 1542207367, "post_id": 53302821, "comment_id": 93486729, "body": "Updated the description sorry for misunderstanding."}, {"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "edited": false, "score": 0, "creation_date": 1542207439, "post_id": 53302821, "comment_id": 93486776, "body": "Rewrite your <code>person</code> array to the file and you should be good?"}, {"owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "edited": false, "score": 0, "creation_date": 1542207983, "post_id": 53302821, "comment_id": 93487169, "body": "Plus 1 for answering the original question &amp; the edit on my answer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6398538"}, "edited": false, "score": 0, "creation_date": 1542208102, "post_id": 53302821, "comment_id": 93487247, "body": "I already have a writing (adding) function. I just want to delete the item based on keyword supplied. <a href=\"https://repl.it/repls/VastWildFact\" rel=\"nofollow noreferrer\">repl.it/repls/VastWildFact</a>"}], "tags": [], "owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "is_accepted": false, "score": 1, "last_activity_date": 1542207073, "last_edit_date": 1592644375, "creation_date": 1542206685, "answer_id": 53302821, "question_id": 53302307, "link": "https://stackoverflow.com/questions/53302307/delete-an-array-from-a-class-in-ruby/53302821#53302821", "title": "Delete an array from a class in ruby", "body": "<p>Change</p>\n<pre><code>person.delete(found)\n</code></pre>\n<p>to</p>\n<pre><code>person -= found # Equivalent to person = person - found\n</code></pre>\n<p>It should work as per <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-2D\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.0/Array.html#method-i-2D</a></p>\n<blockquote>\n<p><code>ary - other_ary \u2192 new_ary</code></p>\n<p>Returns a new array that is a copy of the original array, removing any items that also appear in other_ary. The order is preserved from the original array.</p>\n<p>It compares elements using their hash and eql? methods for efficiency.</p>\n<p>Example: [ 1, 1, 2, 2, 3, 3, 4, 5 ] - [ 1, 2, 4 ]  #=&gt;  [ 3, 3, 5 ]</p>\n</blockquote>\n<hr />\n<p>Another solution is to use <code>reject</code> as follows:</p>\n<pre><code>person.reject! do |pip|\n  pip.name.downcase.include?(keyword.downcase) ||\n    pip.age.downcase.include?(keyword.downcase) ||\n    pip.country.downcase.include?(keyword.downcase)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6398538"}, "edited": false, "score": 0, "creation_date": 1542208107, "post_id": 53303120, "comment_id": 93487252, "body": "I already have a writing (adding) function. I just want to delete the item based on keyword supplied."}, {"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "edited": false, "score": 0, "creation_date": 1542208462, "post_id": 53303120, "comment_id": 93487495, "body": "@MarcSolva before you save delete the old file :) If the old file has 3 people and you deleted one of them then your array has 2 people. You need to delete the content of the original file (the 3 people) and then write the only remaining 2! otherwise you will end up appending the remaining 2 to the original 3."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6398538"}, "edited": false, "score": 0, "creation_date": 1542208604, "post_id": 53303120, "comment_id": 93487567, "body": "Hmm. sorry I am a beginner I am not still following would you be so kind and show me an updated version on how to execute the codes?"}, {"owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "edited": false, "score": 0, "creation_date": 1542211032, "post_id": 53303120, "comment_id": 93489108, "body": "@MarcSolva you have a <code>save</code> method in your code, but it&#39;s only saving single people, not an array of people. In order to save the array of people, you have to re-write the file with only the people you want saved. Your code will be roughly: <code>load all people -&gt; find by keyword -&gt; delete found -&gt; write all people to file</code>. Taking you much further than this without you learning how to do it on your own won&#39;t help you in the long run ;)"}], "tags": [], "owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "is_accepted": false, "score": 1, "last_activity_date": 1542207789, "last_edit_date": 1542207789, "creation_date": 1542207655, "answer_id": 53303120, "question_id": 53302307, "link": "https://stackoverflow.com/questions/53302307/delete-an-array-from-a-class-in-ruby/53303120#53303120", "title": "Delete an array from a class in ruby", "body": "<p>Basically you're going to want an <code>export_people</code> and <code>write_people</code> method that'll look something like this:</p>\n\n<pre><code>def self.export_people(people)\n  people.map do |person|\n    [person.name, person.age, person.country].join(\"\\t\")\n  end\nend\n\ndef self.write_people(people)\n  File.new(@@filepath, 'w') do |f|\n    f.write(export_people(people))\n  end\nend\n\n# Usage:\nPerson.write_people(array_of_people)\n</code></pre>\n\n<p>With the above code, you'd call the <a href=\"https://stackoverflow.com/a/53302821/33226\">modified <code>delete</code> method as detailed in Tarek's answer</a>, and then <code>Person.write_people(array_of_people)</code> to write back to the file.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6398538"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542207789, "creation_date": 1542205046, "last_edit_date": 1542207746, "question_id": 53302307, "link": "https://stackoverflow.com/questions/53302307/delete-an-array-from-a-class-in-ruby", "title": "Delete an array from a class in ruby", "body": "<p>So I am creating a class in ruby where in I will be able to insert my data on a text file and then read, find from it but I am stuck on delete as well update/edit.</p>\n\n<p>Basically I created a method called \"find\" and I made it as a reference on my \"delete\" method.</p>\n\n<pre><code>def find(keyword=\"\")\n  if keyword\n    person = People.read_people\n    found = person.select do |pip|\n      pip.name.downcase.include?(keyword.downcase) ||\n        pip.age.downcase.include?(keyword.downcase) ||\n        pip.country.downcase.include?(keyword.downcase)\n    end\n    found.each do |person|\n      puts person.name + \" | \" + person.age + \" | \" + person.country\n    end\n  else\n    puts \"find using a key phrase eg. 'find sam' \\n\\n\"\n  end\nend\n\n\ndef list\n  puts \"\\nListing People \\n\\n\".upcase\n  people = People.read_people\n  people.each do |person|\n    puts person.name + \" | \" + person.age + \" | \" + person.country\n  end\nend\n\n\ndef delete(keyword=\"\")\n  if keyword\n    person = People.read_people\n    found = person.select do |pip|\n      pip.name.downcase.include?(keyword.downcase) ||\n        pip.age.downcase.include?(keyword.downcase) ||\n        pip.country.downcase.include?(keyword.downcase)\n    end\n    person.delete(found)\n  else\n    puts \"find using a key phrase eg. 'find josh' \\n\\n\"\n  end\nend\n</code></pre>\n\n<p>As you can see I was trying to delete the supplied keyword from the array (w/c was save on a text file) via class method called read_people. Here's how it looks like:</p>\n\n<pre><code>def self.read_people\n  # read the people file\n  # return instances of people\n  people = []\n  if file_usable?\n    file = File.new(@@filepath, 'r')\n    file.each_line do |line|\n      people &lt;&lt; People.new.import_line(line.chomp)\n    end\n    file.close\n  end\n  return people\nend\n\ndef import_line(line)\n  line_array = line.split(\"\\t\")\n  @name, @age, @country = line_array\n  return self\nend\n</code></pre>\n\n<p>How can I fix this and delete the found item via keyword?</p>\n\n<p>See the actual codes here: <a href=\"https://repl.it/repls/VastWildFact\" rel=\"nofollow noreferrer\">https://repl.it/repls/VastWildFact</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "has-many"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1542205640, "last_edit_date": 1542205640, "creation_date": 1542204692, "answer_id": 53302199, "question_id": 53301803, "link": "https://stackoverflow.com/questions/53301803/rails-5-optional-has-many-associations/53302199#53302199", "title": "Rails 5 optional has_many associations", "body": "<p>You can use <code>reject_if</code> option:</p>\n\n<pre><code>accepts_nested_attributes_for :donor_relationships, \n  allow_destroy: true,\n  reject_if: proc { |attributes| attributes['important_field'].blank? }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 1, "last_activity_date": 1542205625, "last_edit_date": 1542205625, "creation_date": 1542204700, "answer_id": 53302204, "question_id": 53301803, "link": "https://stackoverflow.com/questions/53301803/rails-5-optional-has-many-associations/53302204#53302204", "title": "Rails 5 optional has_many associations", "body": "<p><a href=\"https://stackoverflow.com/questions/4963769/accepts-nested-attributes-for-ignore-blank-values\">accepts_nested_attributes_for ignore blank values</a></p>\n\n<p>You can add a <code>reject_if</code> conditional to the <code>accepts_nested_attributes</code> method. Assuming your donor_relationship has an attribute of name (you can go with relationship_id or whatever attribute makes sense):</p>\n\n<pre><code>accepts_nested_attributes_for :donor_relationships,\n                              :allow_destroy =&gt; true,\n                              :reject_if =&gt; lambda { |c| c[:name].blank? }`\n</code></pre>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "accepted_answer_id": 53302204, "answer_count": 2, "score": 0, "last_activity_date": 1542205677, "creation_date": 1542203443, "last_edit_date": 1542205677, "question_id": 53301803, "link": "https://stackoverflow.com/questions/53301803/rails-5-optional-has-many-associations", "title": "Rails 5 optional has_many associations", "body": "<p>app/models/donor.rb</p>\n\n<pre><code>has_many :donor_relationships\naccepts_nested_attributes_for :donor_relationships, :allow_destroy =&gt; true\n</code></pre>\n\n<p>app/models/donor_relationship.rb</p>\n\n<pre><code>belongs_to :donor, optional: true\n</code></pre>\n\n<p>I am using <code>f.fields_for</code> in donor form and creating <code>donor</code> and <code>donor_relationships</code> both.</p>\n\n<p><code>donor_relationships</code> is not required must. Issue I face is that when if I not add any donor_relationships then empty record of <code>donor_relationship</code> is created with donor id. In rails 4 not like this happen.</p>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["ruby", "math"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 3, "last_activity_date": 1542203234, "creation_date": 1542203234, "answer_id": 53301735, "question_id": 53301695, "link": "https://stackoverflow.com/questions/53301695/ruby-find-exponent-of-10/53301735#53301735", "title": "Ruby: Find exponent of 10", "body": "<p>It's logarithmic function:</p>\n\n<pre><code>&gt; Math.log(100, 10)\n=&gt; 2.0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": true, "score": 5, "last_activity_date": 1542203240, "creation_date": 1542203240, "answer_id": 53301736, "question_id": 53301695, "link": "https://stackoverflow.com/questions/53301695/ruby-find-exponent-of-10/53301736#53301736", "title": "Ruby: Find exponent of 10", "body": "<p>The inverse of exponentiation is called the <a href=\"https://en.wikipedia.org/wiki/Logarithm\" rel=\"noreferrer\"><em>logarithm</em></a>. In Ruby, the base-10 logarithm (i.e. <code>x == 10</code>) is implemented as <code>Math.log10(z)</code>:</p>\n\n<pre><code>irb(main):005:0&gt; Math.log10(100)\n=&gt; 2.0\n</code></pre>\n\n<p>If you need it for different values of <code>x</code>, use <code>Math.log(z, x)</code>:</p>\n\n<pre><code>irb(main):006:0&gt; Math.log(100, 10)\n=&gt; 2.0\n</code></pre>\n"}], "owner": {"reputation": 6838, "user_id": 680001, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7a1ec53845532ff7ab726ea809cffa74?s=128&d=identicon&r=PG", "display_name": "Sayuj", "link": "https://stackoverflow.com/users/680001/sayuj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 53301736, "answer_count": 2, "score": 0, "last_activity_date": 1542203240, "creation_date": 1542203131, "question_id": 53301695, "link": "https://stackoverflow.com/questions/53301695/ruby-find-exponent-of-10", "title": "Ruby: Find exponent of 10", "body": "<p><code>x ^ y = z</code> I have value for <code>x</code> and <code>z</code>. I want to find out value of <code>y</code> using Ruby.</p>\n\n<p>For example:</p>\n\n<pre><code>x = 10\nz = 100\n# 10 ^ 2 =&gt; 100\n</code></pre>\n\n<p>My expected result is <code>2</code>. Is there any inbuilt method in Ruby language to figure out this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1542201528, "post_id": 53301133, "comment_id": 93482810, "body": "You need to leave the post_params method in as it permits the parameters. Can you posy what error message occurs when you try and update please?"}, {"owner": {"reputation": 316, "user_id": 7558674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qp50wBg6IhU/AAAAAAAAAAI/AAAAAAAAAD0/YNvxuQYnz6A/photo.jpg?sz=128", "display_name": "Pietro Allievi", "link": "https://stackoverflow.com/users/7558674/pietro-allievi"}, "edited": false, "score": 0, "creation_date": 1542208552, "post_id": 53301133, "comment_id": 93487540, "body": "I&#39;m not sure, but it looks like your header&#39;s params are send as body. How do you call update method? Ajax async call? Html/Rails form? could you update your answer?"}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1542208846, "post_id": 53301133, "comment_id": 93487702, "body": "Hi @Mark , I don&#39;t get any error but the data doesn&#39;t get saved in db"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1542208898, "post_id": 53301133, "comment_id": 93487724, "body": "@MallelaSriPrakash replace if(@metric.update_attributes(post_params)) with if(@metric.update_attributes!(post_params)) please, the server will then throw an error and explain what is going wrong"}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1542210305, "post_id": 53301133, "comment_id": 93488617, "body": "@Mark As you have said, I have replaced it. But still I don&#39;t get any error while updating. But, when I changed the text as this if(@metric.update_attributes(!post_params)) then I get this error:  <b>When assigning attributes, you must pass a hash as an argument.</b>"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1542210355, "post_id": 53301133, "comment_id": 93488650, "body": "The exclamation mark goes before the brackets:"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1542210366, "post_id": 53301133, "comment_id": 93488654, "body": "if(@metric.update_attributes!(post_params))"}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542210687, "post_id": 53301133, "comment_id": 93488872, "body": "Yes @Mike, that&#39;s what I said in my earlier post. Using this, if(@metric.update_attributes!(post_params)) I don&#39;t get any error."}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1542210788, "post_id": 53301133, "comment_id": 93488942, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/183645/discussion-between-mallela-sriprakash-and-mark\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1161, "user_id": 2056117, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/93f3bba48b2683a41e9a2625934e6148?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/2056117/dan"}, "edited": false, "score": 0, "creation_date": 1542210360, "post_id": 53301326, "comment_id": 93488651, "body": "I agree that the first step is to get the naming conventions fixed in this code. Hopefully whatever is calling this update method is not passing the params as CamelCase. If so that should be fixed as well. This is the second question I&#39;ve seen this week where not following Rails&#39; naming convention has caused an app to not work."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 1161, "user_id": 2056117, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/93f3bba48b2683a41e9a2625934e6148?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/2056117/dan"}, "edited": false, "score": 1, "creation_date": 1542211370, "post_id": 53301326, "comment_id": 93489327, "body": "@Dan <i>&quot;Hopefully whatever is calling this update method is not passing the params as CamelCase&quot;</i> -- It looks like it is, though! From the OP&#39;s console log: <code>&quot;metrics_controller&quot;=&gt;{&quot;IsValid&quot;=&gt;&quot;False&quot;, &quot;Comments&quot;=&gt;&quot;1&quot;}</code>."}, {"owner": {"reputation": 1161, "user_id": 2056117, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/93f3bba48b2683a41e9a2625934e6148?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/2056117/dan"}, "edited": false, "score": 0, "creation_date": 1542213860, "post_id": 53301326, "comment_id": 93490850, "body": "yikes, I see that now. It would be nice to see the schema to see how far reaching this unconventional naming is. It&#39;s possible the DB fields <b>are</b> camel case. Ultimately, the OP just needs to be consistent across all parts of his app. It&#39;s possible he is and case isn&#39;t the issue..."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 1, "last_activity_date": 1542201964, "creation_date": 1542201964, "answer_id": 53301326, "question_id": 53301133, "link": "https://stackoverflow.com/questions/53301133/unable-to-save-update-the-record-into-db-in-rails/53301326#53301326", "title": "Unable to save/update the record into db in rails", "body": "<p>By convention in ruby, and rails, you should almost always use <code>snake_case</code> for methods and variables; not <code>CamelCase</code>.</p>\n\n<p>You haven't quite provided enough information for me to say this with 100% certainty (in particular, what is the database schema for the <code>metrics</code> table?), but that is almost certainly the cause of the problem here.</p>\n\n<p>Your <code>Metric</code> class likely has attributes such as <code>value</code>, <code>score</code>, <code>is_valid</code>, etc. But you are trying to update attributes named <code>Comments</code> and <code>IsValid</code>. These attributes do not exist, so nothing gets updated.</p>\n\n<hr>\n\n<p>Change your view to use <code>snake_case</code>, and permit variables in <code>snake_case</code>; then it should work. It would be <em>possible</em> to make it work using <code>CamelCase</code> like you've done here, but that's against conventions - so would require more effort.</p>\n"}, {"tags": [], "owner": {"reputation": 1161, "user_id": 2056117, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/93f3bba48b2683a41e9a2625934e6148?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/2056117/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1542210882, "creation_date": 1542210882, "answer_id": 53304126, "question_id": 53301133, "link": "https://stackoverflow.com/questions/53301133/unable-to-save-update-the-record-into-db-in-rails/53304126#53304126", "title": "Unable to save/update the record into db in rails", "body": "<p>As @Tom Lord mentioned, the case of your parameters looks suspicious and might be causing your problem. If you could provide your schema for the <code>metrics</code> table that will help us help you.</p>\n\n<p>Rails will always work at its best when you follow the naming conventions. This most importantly includes using the correct case and singular/plural names.</p>\n\n<p>This is how I'd expect your code to look if it were written the Rails way:</p>\n\n<pre><code>def update\n  @metric = Metric.find(params[:id])\n  if @metric.update(post_params)\n    redirect_to metrics_path\n  else\n    render 'edit'\n  end\nend\n\nprivate \n\ndef post_params\n  params.permit(:metric, :wi, :value, :ut, :score, :is_valid, :user_name, :comments)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 842, "user_id": 1386619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HOcXi.png?s=128&g=1", "display_name": "kevcha", "link": "https://stackoverflow.com/users/1386619/kevcha"}, "is_accepted": true, "score": 1, "last_activity_date": 1542295496, "last_edit_date": 1542295496, "creation_date": 1542215894, "answer_id": 53305579, "question_id": 53301133, "link": "https://stackoverflow.com/questions/53301133/unable-to-save-update-the-record-into-db-in-rails/53305579#53305579", "title": "Unable to save/update the record into db in rails", "body": "<p>The params that are coming from the request (from the logs) are : </p>\n\n<pre><code>{\n  \"utf8\"=&gt;\"\u00e2\u0153\u201c\",\n  \"authenticity_token\"=&gt;\"1oC/1UdAaTPUepy1zIjO1x6n67Th..\",\n  \"metrics_controller\"=&gt; {\n    \"IsValid\"=&gt;\"False\",\n    \"Comments\"=&gt;\"1\"\n  },\n  \"commit\"=&gt;\"Save\",\n  \"id\"=&gt;\"1\"\n}\n</code></pre>\n\n<p>So the key <code>isValid</code> is under  the key <code>metrics_controller</code>.\nThen, with this kind of coming data, in your controller, you should call</p>\n\n<pre><code>params\n  .require(:metrics_controller)\n  .permit(:IsValid, :Comments, :id)\n</code></pre>\n\n<p>You should take care of the naming convention (snake_case instead of CamelCase), but the most important thing is that the form that is responsible of this request should name inputs accordingly to what's your controller expect.</p>\n\n<p>Then, you should name form elements with something like (according to your screenshot)</p>\n\n<pre><code>&lt;select name=\"metric[is_valid]\"&gt;\n  &lt;option value=\"1\"&gt;Yes&lt;/option&gt;\n  &lt;option value=\"0\"&gt;No&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>With that kind of naming, data will be scoped in key <code>metric</code> instead of <code>metric_controller</code>, and it'll go through strong params.</p>\n"}], "owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 53305579, "answer_count": 3, "score": 0, "last_activity_date": 1542295496, "creation_date": 1542201365, "question_id": 53301133, "link": "https://stackoverflow.com/questions/53301133/unable-to-save-update-the-record-into-db-in-rails", "title": "Unable to save/update the record into db in rails", "body": "<p>I am trying the update the record for the columns IsValid and Comments in rails, but doesn't get updated in backend or any error:</p>\n\n<p><strong>Below is my parameters result:</strong></p>\n\n<pre><code>Started PATCH \"/metrics/1\" for \nProcessing by MetricsController#update as HTML\n  Parameters: {\"utf8\"=&gt;\"\u00e2\u0153\u201c\", \"authenticity_token\"=&gt;\"1oC/1UdAaTPUepy1zIjO1x6n67Th/pdcnvYJH95cB63tZts9d135JIK4MzQD2/pdPoRKnUKXIc0ZI9MQZkjfNQ==\", \n  \"metrics_controller\"=&gt;{\"IsValid\"=&gt;\"False\", \"Comments\"=&gt;\"1\"}, \"commit\"=&gt;\"Save\", \"id\"=&gt;\"1\"}\n  Metric Load (75.1ms)  SELECT  `Threshold`.* FROM `Threshold` WHERE `Threshold`.`ID` = 1 LIMIT 1\nUnpermitted parameters: utf8, _method, authenticity_token, metrics_controller, commit, id\n   (75.7ms)  BEGIN\n   (75.1ms)  COMMIT\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/hIih6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hIih6.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>update method in controller:</strong></p>\n\n<pre><code> def update\n        @metric = Metric.find(params[:id])\n        #if(@metric.update(post_params))\n        if(@metric.update_attributes(post_params))\n          redirect_to metrics_path\n        else\n          render 'edit'\n        end\n      end\n       private def post_params\n    params.permit(:Metric, :WI, :Value, :UT, :Score, :IsValid, :UserName, :Comments)\n  end\n</code></pre>\n\n<p><strong>If I update post_params method with the below code it is throwing error:</strong></p>\n\n<pre><code>private def post_params\n    params.require(:metric).permit(:Metric, :WI, :Value, :UT, :Score, :IsValid, :UserName, :Comments)\n  end\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 9413016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MXyHUIVEmt8/AAAAAAAAAAI/AAAAAAAAAAc/C31jaItXCGU/photo.jpg?sz=128", "display_name": "Sanjay Salunkhe", "link": "https://stackoverflow.com/users/9413016/sanjay-salunkhe"}, "edited": false, "score": 0, "creation_date": 1542199115, "post_id": 53300373, "comment_id": 93481394, "body": "why do we need super keyword /"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "reply_to_user": {"reputation": 95, "user_id": 9413016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MXyHUIVEmt8/AAAAAAAAAAI/AAAAAAAAAAc/C31jaItXCGU/photo.jpg?sz=128", "display_name": "Sanjay Salunkhe", "link": "https://stackoverflow.com/users/9413016/sanjay-salunkhe"}, "edited": false, "score": 0, "creation_date": 1542199214, "post_id": 53300373, "comment_id": 93481450, "body": "Because otherwise the object won&#39;t be extended."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1542202351, "post_id": 53300373, "comment_id": 93483337, "body": "so its not <code>before_extended</code> - it&#39;s <i>the</i> method doing extension. If you override it without calling <code>super</code> you&#39;ll be unable to extend."}], "tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 3, "last_activity_date": 1542202768, "last_edit_date": 1542202768, "creation_date": 1542198846, "answer_id": 53300373, "question_id": 53300220, "link": "https://stackoverflow.com/questions/53300220/what-is-difference-between-extended-and-extend-object-hook/53300373#53300373", "title": "what is difference between extended and extend_object hook", "body": "<p>In essence, <code>extend_object</code> is the method that does the extending. You can override it to for example create a typecheck before extend happens:</p>\n\n<pre><code>module Foo\n  def self.extend_object(obj)\n    raise(TypeError, \"No strings!\") if obj.is_a?(String)\n    super # need to call super or object\n          # won't be extended\n  end\n\n  def self.extended(obj)\n    puts \"#{obj.inspect} was extended with #{self}\"\n  end\nend\n\n1.extend(Foo)\n\"1\".extend(Foo) # raises TypeError: No strings!\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 9413016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MXyHUIVEmt8/AAAAAAAAAAI/AAAAAAAAAAc/C31jaItXCGU/photo.jpg?sz=128", "display_name": "Sanjay Salunkhe", "link": "https://stackoverflow.com/users/9413016/sanjay-salunkhe"}, "edited": false, "score": 0, "creation_date": 1542199013, "post_id": 53300383, "comment_id": 93481347, "body": "extend_object and extended both are hooks and are called automatically whenever i extend module in my class , so what is the need of extend_object ?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 95, "user_id": 9413016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MXyHUIVEmt8/AAAAAAAAAAI/AAAAAAAAAAc/C31jaItXCGU/photo.jpg?sz=128", "display_name": "Sanjay Salunkhe", "link": "https://stackoverflow.com/users/9413016/sanjay-salunkhe"}, "edited": false, "score": 0, "creation_date": 1542199111, "post_id": 53300383, "comment_id": 93481393, "body": "As the docs says - it extends an object using the module - it does the job. You probably don&#39;t have to touch it."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1542198876, "creation_date": 1542198876, "answer_id": 53300383, "question_id": 53300220, "link": "https://stackoverflow.com/questions/53300220/what-is-difference-between-extended-and-extend-object-hook/53300383#53300383", "title": "what is difference between extended and extend_object hook", "body": "<p><code>extend_object</code> is a private API method used by <code>extend</code> and it adds module constants and methods</p>\n\n<blockquote>\n  <p><code>extend_object(p1) private</code></p>\n  \n  <p>Extends the specified object by adding this module\u2019s constants and methods (which are added as singleton methods). This is the callback method used by <code>Object#extend</code>.</p>\n</blockquote>\n\n<p><a href=\"https://apidock.com/ruby/Module/extend_object\" rel=\"nofollow noreferrer\">https://apidock.com/ruby/Module/extend_object</a></p>\n\n<p><code>extended</code> is just a callback that can be used by a developer to run specific code when a module is being extended.\n<a href=\"https://ruby-doc.org/core-2.2.0/Module.html#method-i-extended\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.0/Module.html#method-i-extended</a></p>\n"}], "owner": {"reputation": 95, "user_id": 9413016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MXyHUIVEmt8/AAAAAAAAAAI/AAAAAAAAAAc/C31jaItXCGU/photo.jpg?sz=128", "display_name": "Sanjay Salunkhe", "link": "https://stackoverflow.com/users/9413016/sanjay-salunkhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 53300373, "answer_count": 2, "score": 1, "last_activity_date": 1542202768, "creation_date": 1542198357, "question_id": 53300220, "link": "https://stackoverflow.com/questions/53300220/what-is-difference-between-extended-and-extend-object-hook", "title": "what is difference between extended and extend_object hook", "body": "<p>can someone explain the difference between extended and extend_object hook. There is no proper documentation on the internet for this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "rspec", "environment-variables"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542206559, "post_id": 53300013, "comment_id": 93486168, "body": "<code>force_ssl</code> is already a rails method with a (slightly) different meaning: <a href=\"https://api.rubyonrails.org/classes/ActionController/ForceSSL/ClassMethods.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActionController/ForceSSL/&hellip;</a> -- Your solution seems to be slightly reinventing the wheel, and conflicts with a built-in implementation."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542206637, "post_id": 53300013, "comment_id": 93486223, "body": "Like your v1 implementation, the built-in rails <code>force_ssl</code> defines a <code>before_action</code> callback: <a href=\"https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/actionpack/lib/action_controller/metal/force_ssl.rb#L67-L69\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/&hellip;</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542206816, "post_id": 53300013, "comment_id": 93486353, "body": "However, I think in answer to your question, your v1 implementation invokes the method call <i>before</i> the test runs. Therefore, it checks the <code>ENV</code> before the stub is set up."}, {"owner": {"reputation": 31, "user_id": 3383269, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001399490979/picture?type=large", "display_name": "Natthakit Iewprasert", "link": "https://stackoverflow.com/users/3383269/natthakit-iewprasert"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542216519, "post_id": 53300013, "comment_id": 93492272, "body": "I have used built-in <code>force_ssl</code> with <code>Rails.env.in?</code> for switching logic at the first place. But with <code>Rails.env.in?</code> we need to config nginx for the implementation. So, we decide to implement the simple https redirect instead."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542217347, "post_id": 53300013, "comment_id": 93492711, "body": "Oh, you&#39;re using nginx? Then why not perform the redirect there, rather than inside the application? This is the standard way of doing it."}], "owner": {"reputation": 31, "user_id": 3383269, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001399490979/picture?type=large", "display_name": "Natthakit Iewprasert", "link": "https://stackoverflow.com/users/3383269/natthakit-iewprasert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542197672, "creation_date": 1542197672, "question_id": 53300013, "link": "https://stackoverflow.com/questions/53300013/stub-env-doesnt-work-for-rspec-cottroller-test", "title": "Stub ENV doesn&#39;t work for Rspec cottroller test", "body": "<p>I come into the task for implementing https redirect for my app.\nAfter discuss with team, we should to go with simple redirect way.</p>\n\n<p>And this is the the code in controller:</p>\n\n<p>application_controller.rb (version 1)</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  ...\n\n    def self.force_ssl(options = {})\n      return unless ENV[\"FORCE_SSL\"].present?\n      host = options.delete(:host)\n      before_filter(options) do\n        if !request.ssl? &amp;&amp; params[:controller] != \"health_check\"\n          redirect_to request.url.gsub(\"http://\", \"https://\")\n        end\n      end\n    end\n\n    force_ssl\n\n  ...\nend\n</code></pre>\n\n<p>The problem is when I stub the ENV['FORCE_SSL'] in controller test. It not work. ENV is correctly stub when run <code>pry.binding</code> in test suite but when I run <code>pry.binding</code> in force_ssl method when test is running, ENV['FORCE_SSL'] is <code>nil</code>.</p>\n\n<p>Code in spec file:</p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe ApplicationController, type: :controller do\n\n  controller do\n    def index\n      redirect_to root_path\n    end\n  end\n\n  it \"redirect to https when request in http\" do\n    allow(ENV).to receive(:[]).with('FORCE_SSL').and_return('true')\n\n    get 'index', protocal: :http\n    expect(response).to redirect_to %r(\\Ahttps://)\n  end\nend\n</code></pre>\n\n<p>After that, when I change <code>force_ssl</code> to instance method gracefully.</p>\n\n<p>application_controller.rb (version 2)</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n ...\n\n  before_action :force_ssl\n\n  private\n\n    def force_ssl\n      return unless ENV[\"FORCE_SSL\"].present?\n\n      if !request.ssl? &amp;&amp; params[:controller] != \"health_check\"\n        redirect_to request.url.gsub(\"http://\", \"https://\")\n      end\n    end\n...\nend\n</code></pre>\n\n<p>Just want to know the reason why this happen and are there any way to stub the ENV for test with version 1 controller code ? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "solid-principles", "open-closed-principle"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1542196584, "post_id": 53299533, "comment_id": 93479931, "body": "Is this method not called by all clients?"}, {"owner": {"reputation": 1, "user_id": 9934909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5a9854ef0734245046117594c91ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Giorgi Nikolaishvili", "link": "https://stackoverflow.com/users/9934909/giorgi-nikolaishvili"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1542197210, "post_id": 53299533, "comment_id": 93480289, "body": "Yes, but parts of this method are not needed for every client. For example, Exception type objects use the first part while others use the second. Interface Segregation states that all clients should call the method the same way."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1542197302, "post_id": 53299533, "comment_id": 93480338, "body": "Maaaaaahbe this question is a better fit for <a href=\"https://softwareengineering.stackexchange.com/\">programmers.se</a>"}], "owner": {"reputation": 1, "user_id": 9934909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5a9854ef0734245046117594c91ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Giorgi Nikolaishvili", "link": "https://stackoverflow.com/users/9934909/giorgi-nikolaishvili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542206895, "creation_date": 1542196066, "last_edit_date": 1542206895, "question_id": 53299533, "link": "https://stackoverflow.com/questions/53299533/solid-open-closed-interface-segregation-principles", "title": "SOLID Open/Closed - Interface Segregation Principles", "body": "<p>I have applied the Open/Closed principle on the code I am currently working on. The example is given here: </p>\n\n<pre><code>def error_response(object)\n      return { errs: object.to_s, status_code: :internal_server_error,\n      has_error: true } if object.is_a?(Exception)\n      { errs: object.errors.full_messages.as_json, \n      status_code: :internal_server_error, has_error: true }\n end\n</code></pre>\n\n<p>The code is used in several places by several types of objects. The Interface Segregation principle states that the class should not have methods that are not called by <strong>all</strong> clients. </p>\n\n<ul>\n<li>How can I use these two principles together for the given example?</li>\n<li>Is Open/Closed principle dependant on Interface Segregation principle, or vice versa?</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "gps", "haversine"], "comments": [{"owner": {"reputation": 1156, "user_id": 4955546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ypcYA0ACXs/AAAAAAAAAAI/AAAAAAAABgY/gcCpBwKBymI/photo.jpg?sz=128", "display_name": "Sikandar Tariq", "link": "https://stackoverflow.com/users/4955546/sikandar-tariq"}, "edited": false, "score": 0, "creation_date": 1542195119, "post_id": 53299110, "comment_id": 93479091, "body": "in which unit you&#39;re are getting the distance right now?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "reply_to_user": {"reputation": 1156, "user_id": 4955546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ypcYA0ACXs/AAAAAAAAAAI/AAAAAAAABgY/gcCpBwKBymI/photo.jpg?sz=128", "display_name": "Sikandar Tariq", "link": "https://stackoverflow.com/users/4955546/sikandar-tariq"}, "edited": false, "score": 0, "creation_date": 1542195784, "post_id": 53299110, "comment_id": 93479442, "body": "it&#39;s Haversine::Distance unit"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1542196256, "post_id": 53299110, "comment_id": 93479729, "body": "how is it not working for you? What&#39;s it doing instead? Can you show how you tried calling it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1542196346, "post_id": 53299110, "comment_id": 93479785, "body": "hi @SimpleLime : like that :       distance = Haversine.distance(site.address.latitude, site.address.longitude, store.address.latitude, store.address.longitude).to_kilometers"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "edited": false, "score": 1, "creation_date": 1542196481, "post_id": 53299110, "comment_id": 93479869, "body": "the distance variable should be Haversine::Distance as class type , but when checked it it&#39;s on Float &lt; Numeric !"}, {"owner": {"reputation": 1156, "user_id": 4955546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ypcYA0ACXs/AAAAAAAAAAI/AAAAAAAABgY/gcCpBwKBymI/photo.jpg?sz=128", "display_name": "Sikandar Tariq", "link": "https://stackoverflow.com/users/4955546/sikandar-tariq"}, "edited": false, "score": 0, "creation_date": 1542198092, "post_id": 53299110, "comment_id": 93480776, "body": "and from float, you can convert to any distance unit you want easily."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "edited": false, "score": 0, "creation_date": 1542202543, "post_id": 53299110, "comment_id": 93483484, "body": "how that ? because i don&#39;t know this float returned in which unit it is !"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "edited": false, "score": 0, "creation_date": 1542202885, "post_id": 53300643, "comment_id": 93483721, "body": "in the gem documentation i found .to_kilometers method exist but that not work, it show an undefined method error"}, {"owner": {"reputation": 3953, "user_id": 334314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23216bf53e7a0633188c067d8a1ae31d?s=128&d=identicon&r=PG", "display_name": "eikes", "link": "https://stackoverflow.com/users/334314/eikes"}, "edited": false, "score": 0, "creation_date": 1542211538, "post_id": 53300643, "comment_id": 93489419, "body": "Have you forgotten to <code>require &#39;haversine&#39;</code>?"}], "tags": [], "owner": {"reputation": 3953, "user_id": 334314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23216bf53e7a0633188c067d8a1ae31d?s=128&d=identicon&r=PG", "display_name": "eikes", "link": "https://stackoverflow.com/users/334314/eikes"}, "is_accepted": false, "score": 0, "last_activity_date": 1542200144, "last_edit_date": 1542200144, "creation_date": 1542199762, "answer_id": 53300643, "question_id": 53299110, "link": "https://stackoverflow.com/questions/53299110/ruby-on-rails-haversine-gem-convert-calculated-distance-to-km/53300643#53300643", "title": "Ruby on rails Haversine gem : convert calculated distance to km", "body": "<p>You probably need to call the <code>to_kilometers</code> method on the resulting <code>Haversine::Distance</code> otherwise its <code>to_s</code> method will be used:</p>\n\n<pre><code>def distances\n  site = Site.find params[ :id ]\n\n  distances = Store.current.map do |store|\n    {\n      name: store.name,\n      value: Haversine.distance(\n               site.address.latitude,\n               site.address.longitude,\n               store.address.latitude,\n               store.address.longitude\n             ).to_kilometers\n    }\n  end\n\n  render json: {\n    distances: distances\n  }\nend\n</code></pre>\n\n<p>What you'll really want to do though is add a <code>distance_in_km</code> to your <code>Address</code> class...</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542200144, "creation_date": 1542194717, "question_id": 53299110, "link": "https://stackoverflow.com/questions/53299110/ruby-on-rails-haversine-gem-convert-calculated-distance-to-km", "title": "Ruby on rails Haversine gem : convert calculated distance to km", "body": "<p>I'm working on a task that calculate the distance between two gps points and I want to convert the distance to KM  :</p>\n\n<pre><code>def distances\n    site     = Site.find params[ :id ]\n    stores   = Store.current\n    distances = []\n\n    stores.map do |store|\n      distance = Haversine.distance(site.address.latitude, site.address.longitude, store.address.latitude, store.address.longitude)\n      distances &lt;&lt; {\n        name: store.name,\n        value: distance\n      }\n    end\n\n    render json: {\n      distances: distances.to_json\n    }\n\n  end\n</code></pre>\n\n<p>example of calculated item : </p>\n\n<blockquote>\n  <p>store2 : 5527.654499076738</p>\n</blockquote>\n\n<p>in the doc of haversine gem there is a method to convert : distance.to_kilometers but it doesn't work for me ! any help ?</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 210, "user_id": 7684247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/En7gm.jpg?s=128&g=1", "display_name": "L. O. van Ingen", "link": "https://stackoverflow.com/users/7684247/l-o-van-ingen"}, "edited": false, "score": 4, "creation_date": 1542194895, "post_id": 53298982, "comment_id": 93478983, "body": "What is stopping you? What have you tried so far? Show us your code..."}], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 0, "last_activity_date": 1542198372, "creation_date": 1542198372, "answer_id": 53300229, "question_id": 53298982, "link": "https://stackoverflow.com/questions/53298982/substrings-and-splitting/53300229#53300229", "title": "Substrings and splitting", "body": "<pre><code>message = \"42[\\\"message\\\",\\\"base64:QWZ0ZXIgQnVuZGxlciBpbnN0YWxscyB0aGUgZ2VtcyBpbiB5b3VyIEdlbWZpbGUsIHlvdSBjYW4gcHJvY2VlZCB0byByZWZlcmVuY2UgdGhlbSBpbiA0eTQ0NG91ciBjb2RlIGp1c3QgYXMgaWYgeW914oCZZCBpbnN0YWxsZWQgdGhlbSB5b3Vyc2VsZi4=\\\"]\"\nbase64 = message[/base64:(.+?)\"/, 1]\nputs(Base64.decode64(base64)) unless base64.nil?\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9812489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e9f795a15bea30aa33909b29fb5a82?s=128&d=identicon&r=PG", "display_name": "William Mansell", "link": "https://stackoverflow.com/users/9812489/william-mansell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 53300229, "answer_count": 1, "score": -2, "last_activity_date": 1542596396, "creation_date": 1542194305, "last_edit_date": 1542596396, "question_id": 53298982, "link": "https://stackoverflow.com/questions/53298982/substrings-and-splitting", "title": "Substrings and splitting", "body": "<p>I have a lot of messages formatted like this</p>\n\n<pre><code>\"42[\\\"message\\\",\\\"base64:QWZ0ZXIgQnVuZGxlciBpbnN0YWxscyB0aGUgZ2VtcyBpbiB5b3VyIEdlbWZpbGUsIHlvdSBjYW4gcHJvY2VlZCB0byByZWZlcmVuY2UgdGhlbSBpbiA0eTQ0NG91ciBjb2RlIGp1c3QgYXMgaWYgeW914oCZZCBpbnN0YWxsZWQgdGhlbSB5b3Vyc2VsZi4=\\\"]\"\n</code></pre>\n\n<p>What I want to do is if the message contains base64: then extract the substring after the colon and before the next quote mark.</p>\n\n<p>edit: this works but is probably horrible.</p>\n\n<pre><code>if event.data.include? 'base64:'\n    new_string = event.data[event.data.rindex(\"base64:\") + \"base64:\".length..-3]\n    puts new_string\nend\n</code></pre>\n"}, {"tags": ["ruby", "capistrano"], "comments": [{"owner": {"reputation": 730, "user_id": 4950215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0XR70.jpg?s=128&g=1", "display_name": "thefolenangel", "link": "https://stackoverflow.com/users/4950215/thefolenangel"}, "edited": false, "score": 0, "creation_date": 1542191921, "post_id": 53298044, "comment_id": 93477216, "body": "It would be beneficial if you provide information about the cloud provider, that you use for the deployment?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1542194018, "post_id": 53298044, "comment_id": 93478494, "body": "Can you add to your post the output of <code>gem env</code> and perhaps anything relevant in Capfile"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542209014, "post_id": 53298044, "comment_id": 93487786, "body": "Try <code>bundle exec cap production deploy</code> this will execute in the context of bundler"}, {"owner": {"reputation": 11, "user_id": 8682361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d5053fb9a1e8a1bae4a7bdd4129200?s=128&d=identicon&r=PG&f=1", "display_name": "lyrium", "link": "https://stackoverflow.com/users/8682361/lyrium"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1542257002, "post_id": 53298044, "comment_id": 93505592, "body": "@lacostenycoder added to the post. There&#39;s nothing relevant in capfile except <code>require &quot;capistrano&#47;rvm&quot;</code>."}, {"owner": {"reputation": 11, "user_id": 8682361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d5053fb9a1e8a1bae4a7bdd4129200?s=128&d=identicon&r=PG&f=1", "display_name": "lyrium", "link": "https://stackoverflow.com/users/8682361/lyrium"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542257040, "post_id": 53298044, "comment_id": 93505600, "body": "@engineersmnky Should&#39;ve added it to the post, but <code>bundle exec cap production deploy</code> throws the same error."}], "owner": {"reputation": 11, "user_id": 8682361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d5053fb9a1e8a1bae4a7bdd4129200?s=128&d=identicon&r=PG&f=1", "display_name": "lyrium", "link": "https://stackoverflow.com/users/8682361/lyrium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542256961, "creation_date": 1542191432, "last_edit_date": 1542256961, "question_id": 53298044, "link": "https://stackoverflow.com/questions/53298044/cap-deploy-throws-ruby-version-is-2-2-5-but-your-gemfile-specified-2-5-3-exc", "title": "cap deploy throws &quot;Ruby version is 2.2.5, but your Gemfile specified 2.5.3&quot;, except my Ruby version is 2.5.3", "body": "<p>Out of absolutely nowhere (not an exaggeration: I deployed two hours before this exception started happening), <code>cap production deploy</code> stopped working and is throwing this error: </p>\n\n<pre><code>Your Ruby version is 2.2.5, but your Gemfile specified 2.5.3\nbundle stderr: Nothing written\n</code></pre>\n\n<p>Except I'm using 2.5.3, as specified in both <code>gemfile</code> and in <code>.ruby-version</code>.</p>\n\n<p>This is what's in my gemfile: </p>\n\n<pre><code>source 'https://rubygems.org'\n\nruby '2.5.3'\n</code></pre>\n\n<p>I'm using rvm. <code>ruby -v</code> returns <code>ruby 2.5.3p105 (2018-10-18 revision 65156) [x86_64-darwin18]</code>, and ruby is set to global. I've tried running <code>gem update bundler</code>, <code>gem install bundler</code> followed by <code>bundle install</code>, <code>bundle</code>, and deleted <code>gemfile.lock</code>. </p>\n\n<pre><code>$ bundle env\nBundler           1.17.1\nPlatforms         ruby, x86_64-darwin-18\nRuby              2.5.3p105 (2018-10-18 revision 65156) [x86_64-darwin18]\nFull Path         /Users/mirai/.rvm/rubies/ruby-2.5.3/bin/ruby\nConfig Dir        /Users/mirai/.rvm/rubies/ruby-2.5.3/etc\nRubyGems          2.7.8\nGem Home          /Users/mirai/.rvm/gems/ruby-2.5.3@greentea-b2b\nGem Path          /Users/mirai/.rvm/gems/ruby-2.5.3@greentea- \nb2b:/Users/mirai/.rvm/gems/ruby-2.5.3@global\nUser Path         /Users/mirai/.gem/ruby/2.5.0\nBin Dir           /Users/mirai/.rvm/gems/ruby-2.5.3@greentea-b2b/bin\n\n$ which -a bundle\n/Users/mirai/.rvm/rubies/ruby-2.5.3/bin/bundle\n/usr/local/bin/bundle\n</code></pre>\n\n<p>Edit: Output of <code>$ gem env</code>:</p>\n\n<pre><code>RubyGems Environment:\n- RUBYGEMS VERSION: 2.7.8\n- RUBY VERSION: 2.5.3 (2018-10-18 patchlevel 105) [x86_64-darwin18]\n- INSTALLATION DIRECTORY: /Users/mirai/.rvm/gems/ruby-2.5.3@mirai-b2b\n- USER INSTALLATION DIRECTORY: /Users/mirai/.gem/ruby/2.5.0\n- RUBY EXECUTABLE: /Users/mirai/.rvm/rubies/ruby-2.5.3/bin/ruby\n- EXECUTABLE DIRECTORY: /Users/mirai/.rvm/gems/ruby-2.5.3@greentea-b2b/bin\n- SPEC CACHE DIRECTORY: /Users/mirai/.gem/specs\n- SYSTEM CONFIGURATION DIRECTORY: /Users/mirai/.rvm/rubies/ruby-2.5.3/etc\n- RUBYGEMS PLATFORMS:\n- ruby\n- x86_64-darwin-18\n- GEM PATHS:\n - /Users/mirai/.rvm/gems/ruby-2.5.3@greentea-b2b\n - /Users/mirai/.rvm/gems/ruby-2.5.3@global\n- GEM CONFIGURATION:\n - :update_sources =&gt; true\n - :verbose =&gt; true\n - :backtrace =&gt; false\n - :bulk_threshold =&gt; 1000\n - :sources =&gt; [\"http://gems.rubyforge.org/\"]\n - \"update\" =&gt; \"--env-shebang\"\n - \"benchmark\" =&gt; false\n - \"install\" =&gt; \"--env-shebang\"\n - \"gem\" =&gt; \"-n/usr/local/bin\"\n- REMOTE SOURCES:\n - http://gems.rubyforge.org/\n- SHELL PATH:\n - /Users/mirai/.rvm/gems/ruby-2.5.3@greentea-b2b/bin\n - /Users/mirai/.rvm/gems/ruby-2.5.3@global/bin\n - /Users/mirai/.rvm/rubies/ruby-2.5.3/bin\n - /Users/mirai/.rvm/bin\n - /usr/local/opt/openssl/bin\n - /usr/local/bin\n - /usr/bin\n - /bin\n - /usr/sbin\n - /sbin\n - /opt/local/bin\n - /opt/local/sbin\n - /usr/local/MacGPG2/bin\n - /opt/X11/bin\n</code></pre>\n\n<p>I'm using AWS. <code>bundle exec cap production deploy</code> throws the same error.</p>\n"}, {"tags": ["ruby", "hash", "block"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 5, "creation_date": 1542190656, "post_id": 53297664, "comment_id": 93476403, "body": "Why would you need this anyway if you assigning <code>value</code> on next line?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1542193263, "post_id": 53297664, "comment_id": 93478011, "body": "Are we to assume a &quot;collection&quot; here is an array of hashes? Where will this data be provided from?"}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 1, "creation_date": 1542194032, "post_id": 53297664, "comment_id": 93478500, "body": "can you please add output of <code>collection_of_hashes</code> variable? is it array of hashes?"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542203494, "post_id": 53297878, "comment_id": 93484145, "body": "Although as mentioned by Interdictor in his answer. This default <code>Hash</code> is a single reference so <code>my_hash[&#39;no_existing_key&#39;].merge!({name: &#39;Nope&#39;})</code> means that <code>my_hash[&#39;another_no_existing_key&#39;] #=&gt; {name: &#39;Nope&#39;}</code> because this default value in this case is acting almost like an accumulator and <code>my_hash[&#39;no_existing_key&#39;]</code> still not have a actual value and <code>my_hash.key?(&#39;no_existing_key&#39;) #=&gt; false</code>. Where as the original implementation is akin to <code>Hash.new { |h,k| h[k] = {} }</code> where each non existing key gets its own new <code>Hash</code> and becomes part of the original <code>Hash</code>"}], "tags": [], "owner": {"reputation": 703, "user_id": 3275627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sFsXG.jpg?s=128&g=1", "display_name": "Jonathan Duarte", "link": "https://stackoverflow.com/users/3275627/jonathan-duarte"}, "is_accepted": false, "score": 1, "last_activity_date": 1542190913, "creation_date": 1542190913, "answer_id": 53297878, "question_id": 53297664, "link": "https://stackoverflow.com/questions/53297664/what-is-an-elegant-ruby-way-to-have-a-condition-of-nil/53297878#53297878", "title": "What is an elegant Ruby way to have a condition of &#39;nil&#39;?", "body": "<p>I guess what you want is to initialise your <code>my_hash</code> with a default value, so then you don't need to check if it's nil or not.</p>\n\n<p>That can be done using the <code>Hash.new</code> constructor, compare:</p>\n\n<pre><code>my_hash = {}\nputs my_hash['no_existing_key'] #=&gt; nil\n\nmy_hash = Hash.new({})\nputs my_hash['no_existing_key'] #=&gt; {}\n</code></pre>\n\n<p>You then can reduce your code to:</p>\n\n<pre><code>def create_a_hash_from_a_collection\n  my_hash = Hash.new({})\n\n  collection_of_hashes.each do |key, value|\n    my_hash[key] = value\n  end\n\n  my_hash\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1542193643, "last_edit_date": 1542193643, "creation_date": 1542191043, "answer_id": 53297920, "question_id": 53297664, "link": "https://stackoverflow.com/questions/53297664/what-is-an-elegant-ruby-way-to-have-a-condition-of-nil/53297920#53297920", "title": "What is an elegant Ruby way to have a condition of &#39;nil&#39;?", "body": "<p>You can use <code>||=</code> operator which does exactly what you want</p>\n\n<pre><code>my_hash[key] ||= {} \n</code></pre>\n\n<p>The rest of my answer here is because I'm not sure what a \"collection of hashes\" is, so my best guess is that it would be an array of hashes.  If I'm wrong, let me know and disregard the rest of this answer.</p>\n\n<p>It seems that the rest of your method may not do what it sounds like you're trying to do.  Consider:</p>\n\n<pre><code>@collection_of_hashes = [{foo: 'bar'}, {baz: 'qux'}]\n\ndef create_a_hash_from_a_collection\n   my_hash = {}\n   @collection_of_hashes.each do |key, value|\n     # this is not actually doing anything here and returns same with or\n     # without the following line\n     # my_hash[key] ||= {}\n     my_hash[key] = value\n   end\n\n   my_hash\n end\n#=&gt; {{:foo=&gt;\"bar\"}=&gt;nil, {:baz=&gt;\"qux\"}=&gt;nil}\n</code></pre>\n\n<p>But what you probably want is</p>\n\n<pre><code>def create_a_hash_from_a_collection\n  my_hash = {}\n  @collection_of_hashes.each do |hash|\n    hash.keys.each do |k|\n      my_hash[k] = hash[k]\n    end\n  end\n  my_hash\nend\n#=&gt; {:foo=&gt;\"bar\", :baz=&gt;\"qux\"}\n</code></pre>\n\n<p>But also keep in mind, if any of your \"collection of hashes\" which we would tend to assume would be an array of hashes, contain the same key, which one wins? This code, it would be the last item in the array's key value. What is the actual goal of your method?</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6630488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d94e64c8923922912d76f811e50cdb?s=128&d=identicon&r=PG", "display_name": "Interdictor", "link": "https://stackoverflow.com/users/6630488/interdictor"}, "is_accepted": false, "score": 2, "last_activity_date": 1542194365, "creation_date": 1542194365, "answer_id": 53299010, "question_id": 53297664, "link": "https://stackoverflow.com/questions/53297664/what-is-an-elegant-ruby-way-to-have-a-condition-of-nil/53299010#53299010", "title": "What is an elegant Ruby way to have a condition of &#39;nil&#39;?", "body": "<p>If you want to have a brand new hash for each key in your initial hash you need to initialise it with a block:</p>\n\n<pre><code>hash = Hash.new { |hash, key| hash[key] = {} }\n\nhash[:foo].object_id == hash[:bar].object_id #=&gt; false\n</code></pre>\n\n<p>Otherwise, if you do this, It will be always the same default hash</p>\n\n<pre><code>hash = Hash.new({})\nhash[:foo].object_id == hash[:bar].object_id #=&gt; true\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542218340, "post_id": 53304857, "comment_id": 93493135, "body": "This seems like the most logical solution however it has a different result than the current code"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542310340, "post_id": 53304857, "comment_id": 93533786, "body": "@engineersmnky is it actually clear what the OP is trying to achieve?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542312805, "post_id": 53304857, "comment_id": 93534878, "body": "Not at all. Thus no answer from me :)"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1542213301, "creation_date": 1542213301, "answer_id": 53304857, "question_id": 53297664, "link": "https://stackoverflow.com/questions/53297664/what-is-an-elegant-ruby-way-to-have-a-condition-of-nil/53304857#53304857", "title": "What is an elegant Ruby way to have a condition of &#39;nil&#39;?", "body": "<p>Since you are assigning value anyway, maybe you could use <code>my_hash[key] = value || {}</code>?</p>\n\n<p>So, if <code>value</code> to assign is <code>nil</code>, the value of that key becomes <code>{}</code>.</p>\n"}], "owner": {"reputation": 508, "user_id": 2476604, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/HZVR2.png?s=128&g=1", "display_name": "clockworkpc", "link": "https://stackoverflow.com/users/2476604/clockworkpc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 53297920, "answer_count": 4, "score": 1, "last_activity_date": 1542213301, "creation_date": 1542190243, "question_id": 53297664, "link": "https://stackoverflow.com/questions/53297664/what-is-an-elegant-ruby-way-to-have-a-condition-of-nil", "title": "What is an elegant Ruby way to have a condition of &#39;nil&#39;?", "body": "<p>Is there a more elegant way to write this code?</p>\n\n<pre><code>    def create_a_hash_from_a_collection\n      my_hash = {}\n\n      collection_of_hashes.each do |key, value|\n        my_hash[key] = {} if my_hash[key].nil?\n        my_hash[key] = value\n      end\n\n      my_hash\n    end\n</code></pre>\n\n<p>The line that seems clumsy to me is this:</p>\n\n<p><code>my_hash[key] = {} if my_hash[key].nil?</code></p>\n\n<p>Is there a shorthand way of expressing it?</p>\n"}, {"tags": ["ruby", "sqlite", "sinatra"], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 5288430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71954555e677638ac79d3e9dca60d215?s=128&d=identicon&r=PG&f=1", "display_name": "A.Leshed", "link": "https://stackoverflow.com/users/5288430/a-leshed"}, "is_accepted": false, "score": 1, "last_activity_date": 1542189389, "creation_date": 1542189389, "answer_id": 53297382, "question_id": 53297217, "link": "https://stackoverflow.com/questions/53297217/ruby-sqlite3-sinatra-cant-do-dbmigrate/53297382#53297382", "title": "ruby sqlite3 sinatra cant do db:Migrate", "body": "<p>Try removing <code>sqlite3_native</code> from your <code>rakefile.rb</code> and just require <code>sqlite3</code></p>\n"}], "owner": {"reputation": 21, "user_id": 9127992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81766b5deeab1b3fdfddb28111ceda0?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Macavilca", "link": "https://stackoverflow.com/users/9127992/frank-macavilca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542189637, "creation_date": 1542188930, "last_edit_date": 1542189637, "question_id": 53297217, "link": "https://stackoverflow.com/questions/53297217/ruby-sqlite3-sinatra-cant-do-dbmigrate", "title": "ruby sqlite3 sinatra cant do db:Migrate", "body": "<p>Im working on w10 64bits </p>\n\n<h1>app.rb</h1>\n\n<pre><code>require 'rubygems'\nrequire 'sinatra'\nrequire \"sinatra/activerecord\"\nrequire 'sqlite3/sqlite3_native'\n\n\nclass App &lt; Sinatra::Base\n  #configuraciones\n  set :root, File.dirname(__FILE__)\n  set :session_secret, 'super secret'\n  set :public_folder, File.dirname(__FILE__) + '/public'\n  set :layout, 'views/layouts'\n  ActiveRecord::Base.establish_connection(\n    :adapter =&gt; 'sqlite3',\n    :database =&gt;  'data.db'\n  )\n  enable :sessions\n  #before all requests\n  before do\n    headers['server'] = 'Ruby, Ubuntu'\n  end\n\nend\n</code></pre>\n\n<h1>rakefile.rb</h1>\n\n<pre><code>require \"sinatra/activerecord/rake\"\nrequire 'sqlite3/sqlite3_native'\nrequire 'sinatra'\nrequire './app'\n</code></pre>\n\n<h1>gemfile</h1>\n\n<pre><code>source \"https://rubygems.org\"\n\ngem \"sinatra\"\ngem \"json\"\ngem 'sinatra-activerecord', '~&gt; 2.0', '&gt;= 2.0.9'\ngem 'rake'\ngem 'sqlite3'\n</code></pre>\n\n<p>so when i try to do db:migrate i cant do it, sqlite3 version 1.3.13\nexecute command</p>\n\n<pre><code>bundle exec rake db:migrate\nrake aborted!\nLoadError: cannot load such file -- sqlite3/sqlite3_native\nC:/ruby/sinatra/Rakefile.rb:2:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>so i dont know what is exactly the problem need help </p>\n\n<h1>UPDATE</h1>\n\n<p>I change in rakefile.rb for only require 'sqlite3'\nbut know i get other error</p>\n\n<pre><code>rake aborted!\nLoadError: cannot load such file -- sqlite3/sqlite3_native\nC:/ruby/sinatra/Rakefile.rb:2:in `&lt;top (required)&gt;'\n\nCaused by:\nLoadError: cannot load such file -- sqlite3/2.5/sqlite3_native\nC:/ruby/sinatra/Rakefile.rb:2:in `&lt;top (required)&gt;'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rack"], "answers": [{"tags": [], "owner": {"reputation": 703, "user_id": 3275627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sFsXG.jpg?s=128&g=1", "display_name": "Jonathan Duarte", "link": "https://stackoverflow.com/users/3275627/jonathan-duarte"}, "is_accepted": false, "score": 0, "last_activity_date": 1542191330, "creation_date": 1542191330, "answer_id": 53298007, "question_id": 53296797, "link": "https://stackoverflow.com/questions/53296797/how-to-rewrite-to-a-different-domain-and-same-url-by-using-rack-rewrite/53298007#53298007", "title": "How to rewrite to a different domain and same URL by using rack-rewrite?", "body": "<p>You should change your DNS configuration. The easiest way would be to create a CNAME record: <a href=\"https://en.wikipedia.org/wiki/CNAME_record\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/CNAME_record</a></p>\n"}], "owner": {"reputation": 331, "user_id": 5222803, "user_type": "registered", "profile_image": "https://graph.facebook.com/956920641045754/picture?type=large", "display_name": "Kei Maejima", "link": "https://stackoverflow.com/users/5222803/kei-maejima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542191330, "creation_date": 1542187545, "question_id": 53296797, "link": "https://stackoverflow.com/questions/53296797/how-to-rewrite-to-a-different-domain-and-same-url-by-using-rack-rewrite", "title": "How to rewrite to a different domain and same URL by using rack-rewrite?", "body": "<p>I want to make a rewrite to another domain and URL browser will show not be changed.</p>\n\n<pre><code>config.middleware.insert_before(Rack::Runtime, Rack::Rewrite) do\n    r301 %r{/example(.*)}, 'https://example.com$1'\nend\n</code></pre>\n\n<p>Now I write above and URL browser show is changed.\nHow can I resolve this? Thanks.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 176, "user_id": 8540055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d4c940ad6c96e49b919ffc37bd85c14?s=128&d=identicon&r=PG&f=1", "display_name": "adarsh", "link": "https://stackoverflow.com/users/8540055/adarsh"}, "edited": false, "score": 0, "creation_date": 1542198288, "post_id": 53296141, "comment_id": 93480886, "body": "i am getting close but still i dnt get ans pls need help ==      users = request.headers[&quot;authentication_token&quot;].present?            User.find_by(authentication_token: request.headers[&quot;authentication_token&quot;])              render json: users"}], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 8540055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d4c940ad6c96e49b919ffc37bd85c14?s=128&d=identicon&r=PG&f=1", "display_name": "adarsh", "link": "https://stackoverflow.com/users/8540055/adarsh"}, "edited": false, "score": 0, "creation_date": 1542188120, "post_id": 53296602, "comment_id": 93474802, "body": "it show in postman like this  = {     &quot;status&quot;: &quot;load&quot;,     &quot;message&quot;: &quot;load&quot;,     &quot;user&quot;: &quot;user&quot; }    it not show user object"}, {"owner": {"reputation": 176, "user_id": 8540055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d4c940ad6c96e49b919ffc37bd85c14?s=128&d=identicon&r=PG&f=1", "display_name": "adarsh", "link": "https://stackoverflow.com/users/8540055/adarsh"}, "edited": false, "score": 0, "creation_date": 1542198177, "post_id": 53296602, "comment_id": 93480824, "body": "i am getting close but still i dnt get ans pls need help //                                         users = request.headers[&quot;authentication_token&quot;].present?            User.find_by(authentication_token: request.headers[&quot;authentication_token&quot;])              render json: users"}], "tags": [], "owner": {"reputation": 633, "user_id": 926450, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d1a1261c915ba4b14e6ac382385de0f4?s=128&d=identicon&r=PG", "display_name": "sharipov_ru", "link": "https://stackoverflow.com/users/926450/sharipov-ru"}, "is_accepted": false, "score": 0, "last_activity_date": 1542186914, "creation_date": 1542186914, "answer_id": 53296602, "question_id": 53296141, "link": "https://stackoverflow.com/questions/53296141/how-can-i-show-user-object-data-by-passing-user-authentication-token-in-rails-5/53296602#53296602", "title": "how can i show user object data by passing user authentication_token in rails 5 restful json api?", "body": "<p>In successful case, you respond with the following json:</p>\n\n<p><code>{status: 'load', message:'load'}</code></p>\n\n<p>so everything is working as you described in controller. If you want to return user object, then change it to something like:</p>\n\n<p><code>render json: { status: 'load', message:'load', user: 'user' }, status: :ok</code></p>\n"}, {"comments": [{"owner": {"reputation": 176, "user_id": 8540055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d4c940ad6c96e49b919ffc37bd85c14?s=128&d=identicon&r=PG&f=1", "display_name": "adarsh", "link": "https://stackoverflow.com/users/8540055/adarsh"}, "edited": false, "score": 0, "creation_date": 1542198057, "post_id": 53297615, "comment_id": 93480747, "body": "users = request.headers[&quot;authentication_token&quot;].present?            User.find_by(authentication_token: request.headers[&quot;authentication_token&quot;])              render json: users   i am getting close but still i dnt get  ans pls need help"}], "tags": [], "owner": {"reputation": 111, "user_id": 4275302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b495db33ec776c3e6a7dfd347f80a4ae?s=128&d=identicon&r=PG&f=1", "display_name": "A_rayB", "link": "https://stackoverflow.com/users/4275302/a-rayb"}, "is_accepted": true, "score": 0, "last_activity_date": 1542206936, "last_edit_date": 1542206936, "creation_date": 1542190072, "answer_id": 53297615, "question_id": 53296141, "link": "https://stackoverflow.com/questions/53296141/how-can-i-show-user-object-data-by-passing-user-authentication-token-in-rails-5/53297615#53297615", "title": "how can i show user object data by passing user authentication_token in rails 5 restful json api?", "body": "<p>You are passing <code>'user'</code> as a string to your json. So it will just send that string.\nYou could try doing something like:</p>\n\n<pre><code>render json: {status: 'load', message:'load', user: user.to_json},status: :ok\n</code></pre>\n\n<p>Or even:</p>\n\n<pre><code>render json: user\n</code></pre>\n\n<p>That will get rid of the status and message json attributes, but you could argue the status should be shown by the HTTP response code and you shouldn't need the message if you are passing the user as the response.</p>\n\n<p><em>edit</em></p>\n\n<p>OK, from your comment I think you probably need something along the lines of:</p>\n\n<pre><code>def index\n  if request.headers[\"authentication_token\"].present?\n    user = User.find_by(authentication_token: request.headers[\"authentication_token\"])     \n    render json: user\n  else\n    render json: { .... whatever you want to render if not authorised }\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 176, "user_id": 8540055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d4c940ad6c96e49b919ffc37bd85c14?s=128&d=identicon&r=PG&f=1", "display_name": "adarsh", "link": "https://stackoverflow.com/users/8540055/adarsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 53297615, "answer_count": 2, "score": 0, "last_activity_date": 1542206936, "creation_date": 1542185301, "last_edit_date": 1542188583, "question_id": 53296141, "link": "https://stackoverflow.com/questions/53296141/how-can-i-show-user-object-data-by-passing-user-authentication-token-in-rails-5", "title": "how can i show user object data by passing user authentication_token in rails 5 restful json api?", "body": "<p>in v1/controller</p>\n\n<p>class V1::ProfilesController &lt; ApplicationController</p>\n\n<pre><code>def index\n\n if user = User.authentication_keys.present?\n\n    user = User.all\n\n    render json: {status: 'load', message:'load', user: 'user'},status: :ok\n\n    else\n\n    render json: {status: 'error', message:'error', user: 'user'},status: :ok\n\n    end\n  end\n</code></pre>\n\n<p>in routes</p>\n\n<pre><code>namespace :v1 do\nresources :profiles\nend\n</code></pre>\n\n<p>i am checking data in postman by passing authentication_token but it not show user object <a href=\"https://i.stack.imgur.com/WZd6q.png\" rel=\"nofollow noreferrer\">postman image</a>]<a href=\"https://i.stack.imgur.com/WZd6q.png\" rel=\"nofollow noreferrer\">1</a></p>\n\n<p>my user data in rails console</p>\n\n<p>User id: 1, email: \"adarsh1454@codekyt.com\", created_at: \"2018-11-14 07:35:59\", updated_at: \"2018-11-14 07:35:59\", authentication_token: \"tYHzjLm-6xxCeM4RXyEe\"</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 1, "creation_date": 1542184257, "post_id": 53295692, "comment_id": 93472595, "body": "This question would be a lot easier on the eyes if the numbers were changed to 1-2 digits."}, {"owner": {"reputation": 23, "user_id": 10650600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f800c0162b7d73400cab003601db33?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Rodriguez", "link": "https://stackoverflow.com/users/10650600/alejandro-rodriguez"}, "reply_to_user": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1542184596, "post_id": 53295692, "comment_id": 93472736, "body": "You&#39;re absolutely right, but I&#39;m in college and the data they will give us is that long"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 1, "creation_date": 1542185577, "post_id": 53295692, "comment_id": 93473259, "body": "You could edit it for us."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1542186316, "post_id": 53295692, "comment_id": 93473691, "body": "<i>&quot;we stop here and keep this in a counter can be&quot;</i> \u2013 what does that mean? How does your expected result look like?"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1542202975, "post_id": 53295692, "comment_id": 93483783, "body": "From where 8349314533 is coming? And 15329460 and 15329462?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542204089, "post_id": 53295692, "comment_id": 93484527, "body": "So many questions: &quot;I need to compare, the keys with the rest of the keys&quot; How many keys? When do we stop do we try key[n] against all other keys first before progressing on to the fallback logic or is it just <code>key[n]</code> vs <code>key[n+1]</code> and then <code>value[n][i]</code> vs <code>value[n+1][i]</code>. I guess sorting the <code>Hash</code> could simplify this greatly. Also is this consecutive or can a key value pair be reused e.g. what is the expected result for say <code>{200 =&gt; [200, 200], 301 =&gt; [400,201], 315 =&gt; [400,0]}</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542204399, "post_id": 53295692, "comment_id": 93484750, "body": "Also what happens if 2 keys meet the original condition <code>{200 =&gt;[1,1], 205 =&gt; [2,2], 106 =&gt; [3,3]}</code> in this case <code>key[1]</code> and <code>key[2]</code> are both within 100 of <code>key[0]</code> and within 100 of each other how should this be handled when each one has 2 possible matches that meet the criteria should this result in <code>[[5,94],[5,99],[94,99]]</code> where those numbers are the absolute distance between the keys in this order?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542209418, "post_id": 53295692, "comment_id": 93488031, "body": "Sidenote: Why 2 accounts <a href=\"https://stackoverflow.com/users/10598651/alejandro-rodriguez\">Alejandro</a> and why 2 <a href=\"https://stackoverflow.com/questions/53292598/compare-keys-of-array-in-ruby\">Questions</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1542230338, "creation_date": 1542230338, "answer_id": 53308876, "question_id": 53295692, "link": "https://stackoverflow.com/questions/53295692/compared-elementes-of-hash-subtraction-ruby/53308876#53308876", "title": "Compared elementes of hash (subtraction) RUBY", "body": "<p>Does this make sense?</p>\n\n<pre><code>x = [8349310431, 8349314513]\ny = [667984788, 667987788]\nz = [15329460, 15329462]\n\n[x, y, z].detect { |a, b| (a-b).abs &lt; 100 } # =&gt; [15329460, 15329462]\n</code></pre>\n\n<p>Just in case, why build a hash?</p>\n"}], "owner": {"reputation": 23, "user_id": 10650600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f800c0162b7d73400cab003601db33?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Rodriguez", "link": "https://stackoverflow.com/users/10650600/alejandro-rodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542230338, "creation_date": 1542183514, "last_edit_date": 1542186254, "question_id": 53295692, "link": "https://stackoverflow.com/questions/53295692/compared-elementes-of-hash-subtraction-ruby", "title": "Compared elementes of hash (subtraction) RUBY", "body": "<p>I have this structure </p>\n\n<pre><code>x = [8349310431, 8349314513]\ny = [667984788, 667987788]\nz = [148507632380, 153294624079]\n\nmap = Hash[x.zip([y, z].transpose).sort]\n#=&gt; {\n#     8349310431=&gt;[667984788, 148507632380],\n#     8349314533=&gt;[667987788, 153294624079]\n#   }\n</code></pre>\n\n<p>and I need to compare, the keys with the rest of the keys, but if the subtraction of the keys is less than 100, you have to compare the first elements to which the key points and if this subtraction of elements is less than 100 the procedure is repeated with the second element that the key points to</p>\n\n<p>example </p>\n\n<pre><code> key[0] - key[1] = 8349310431\u22128349314533 = 4102 (with value absolute)\n</code></pre>\n\n<p>so now we subtract the first elements that the key points to, because it is greater than 100 the subtraction</p>\n\n<pre><code>element1Key1 - element1Key2 = 667984788 - 667987788 = 3000 (with value absolute)\n</code></pre>\n\n<p>as the subtraction is greater than 100 we repeat this with the second elements</p>\n\n<pre><code> element2Key1 - element2Key2 = 15329460 - 15329462 = 2 (with value absolute)\n</code></pre>\n\n<p>as it is less than 100 we stop here and keep this in a counter can be</p>\n\n<p>if the subtraction is less than 100 since the operation with the keys, it can not be stopped there, it is necessary to do it until the second element to which the key points.</p>\n\n<p>but how do I do it</p>\n\n<p>Sorry for my English, but I don't speak it, I hope you understand, and thanks</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1542184846, "post_id": 53295561, "comment_id": 93472862, "body": "What is the <code>today</code> in <code>[today]</code> \u2013 a string? Then it should be <code>[&quot;today&quot;]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1542184946, "post_id": 53295573, "comment_id": 93472915, "body": "You can just call <code>join</code>, the empty string argument isn&#39;t needed."}, {"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1542220447, "post_id": 53295573, "comment_id": 93494070, "body": "@Stefan is right and it should be called without an argument when an array is being joined without a separator"}], "tags": [], "owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "is_accepted": false, "score": 3, "last_activity_date": 1542183320, "last_edit_date": 1542183320, "creation_date": 1542182968, "answer_id": 53295573, "question_id": 53295561, "link": "https://stackoverflow.com/questions/53295561/how-to-concatenate-strings-in-array-using-ruby/53295573#53295573", "title": "How to Concatenate strings in Array using Ruby", "body": "<p>You will want to use the <code>#join(separator)</code> method.</p>\n\n<p>See the official ruby docs for <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-join\" rel=\"nofollow noreferrer\">Array#join</a></p>\n\n<p>Example:</p>\n\n<pre><code>['h', 'e', 'l', 'l', 'o'].join('')\n=&gt; \"hello\"\n</code></pre>\n\n<p>A good place to start learning the basics of Ruby is at <a href=\"https://www.codecademy.com/learn/learn-ruby\" rel=\"nofollow noreferrer\">Code Academy</a>.</p>\n\n<p>I also recommend <a href=\"https://kapeli.com/dash\" rel=\"nofollow noreferrer\">dash</a> for browsing documentation offline!</p>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 1, "last_activity_date": 1542188425, "creation_date": 1542188425, "answer_id": 53297061, "question_id": 53295561, "link": "https://stackoverflow.com/questions/53295561/how-to-concatenate-strings-in-array-using-ruby/53297061#53297061", "title": "How to Concatenate strings in Array using Ruby", "body": "<p>For final your output,</p>\n\n<pre><code>[x, y, z].map(&amp;:join).join(' ')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "is_accepted": false, "score": 0, "last_activity_date": 1543786594, "last_edit_date": 1543786594, "creation_date": 1543786184, "answer_id": 53584801, "question_id": 53295561, "link": "https://stackoverflow.com/questions/53295561/how-to-concatenate-strings-in-array-using-ruby/53584801#53584801", "title": "How to Concatenate strings in Array using Ruby", "body": "<p>You can use the <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-join\" rel=\"nofollow noreferrer\">.join()</a> method like this:</p>\n\n<pre><code>x = [\"t\", \"o\", \"d\", \"a\", \"y\"]\ny = [\"i\", \"s\"] \nz = [\"s\", \"u\", \"n\", \"d\", \"a\", \"y\"]\n\nx.join()\n=&gt; \"today\"\ny.join()\n=&gt; \"is\"\nz.join()\n=&gt; \"sunday\"\n</code></pre>\n\n<p>Then do this:</p>\n\n<pre><code>x.join + y.join + z.join()\n=&gt; \"todayissunday\"\n</code></pre>\n\n<p>Or combine <code>x</code>, <code>y</code>, <code>z</code> into one array and call join on it, like this:</p>\n\n<pre><code>Array(x + y + z).join\n=&gt; \"todayissunday\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9317773, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-W3kRl1gLy5g/AAAAAAAAAAI/AAAAAAAAEWc/AfB1I8syBWc/photo.jpg?sz=128", "display_name": "Sadik Sikder", "link": "https://stackoverflow.com/users/9317773/sadik-sikder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1132, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1543786594, "creation_date": 1542182906, "question_id": 53295561, "link": "https://stackoverflow.com/questions/53295561/how-to-concatenate-strings-in-array-using-ruby", "title": "How to Concatenate strings in Array using Ruby", "body": "<p>I have following sveral arrays which each of them consists into a String. </p>\n\n<pre><code>x = [\"t\", \"o\", \"d\", \"a\", \"y\"]\ny = [\"i\", \"s\"] \nz = [\"s\", \"u\", \"n\", \"d\", \"a\", \"y\"]\n</code></pre>\n\n<p>my output should be like following:</p>\n\n<pre><code>x = [today]\ny = [is] \nZ = [sunday]\n</code></pre>\n\n<p>in together: today is sunday</p>\n\n<p>How can i get expected array using ruby?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 537, "user_id": 4635580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/O8FQs.jpg?s=128&g=1", "display_name": "Isaac To", "link": "https://stackoverflow.com/users/4635580/isaac-to"}, "edited": false, "score": 0, "creation_date": 1542181126, "post_id": 53294842, "comment_id": 93471230, "body": "@TomLord I think you misinterpreted my intent. I am not trying to use a local <code>n</code> in another method, <code>set_local_n</code>, to define the <code>n</code> in <code>using_field_reader_to_set_local_n</code>. I intend the <code>n</code> in the right side of <code>n = n + 1000</code> in <code>using_field_reader_to_set_local_n</code> to be the field reader of <code>@n</code>. Although I didn&#39;t use <code>attr_accessor :n</code>, I used <code>attr_reader :n</code> to make <code>n</code> an field reader. Only because <code>n</code> is field reader, running <code>using_field_reader_locally</code> is possible. I put up <code>set_local_n</code> merely to illustrate that <code>n</code> can be set as a local variable."}], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 4635580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/O8FQs.jpg?s=128&g=1", "display_name": "Isaac To", "link": "https://stackoverflow.com/users/4635580/isaac-to"}, "edited": false, "score": 0, "creation_date": 1542182861, "post_id": 53295242, "comment_id": 93471916, "body": "To me, you post seems to be be right answer. However, the interpretation of <code>n</code> on the right side the equal sign in <code>n = n + 1000</code> seems to be a bit strange to be. What you are saying is that the interpretation of <code>n</code> in <code>n + 1000</code> is determined by <code>n</code> being in the left side of the equal sign. This way of interpreting is different than the way used in other languages I encountered. Can you elaborate in the rules for this kind of interpretation? Can you find documentation for these rules?"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 537, "user_id": 4635580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/O8FQs.jpg?s=128&g=1", "display_name": "Isaac To", "link": "https://stackoverflow.com/users/4635580/isaac-to"}, "edited": false, "score": 1, "creation_date": 1542183560, "post_id": 53295242, "comment_id": 93472242, "body": "@IsaacTo within the same scope, the same identifier has to refer to the same thing, unless you explicitly change what it&#39;s referring to. And as evaluation is top to bottom and left to right, the attempt at assignment is encountered first. At that point the decision of what <code>n</code> is has to be made. Can you give me an example of a language where the same identifier used in the same scope refers to different things?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 4, "creation_date": 1542184175, "post_id": 53295242, "comment_id": 93472553, "body": "A bare reference like <code>foo</code> could either be a receiverless argumentless message-send (e.g. equivalent to <code>self.foo()</code>) or a local variable dereference. Since you can easily tell Ruby that it is a message-send (by either adding a receiver like <code>self.foo</code> or adding an argument list like <code>foo()</code>), if there is an ambiguity, Ruby always prefers to interpret it as a local variable dereference. So, what is a local variable? A local variable is created when an assignment to a bare identifier is <i>parsed</i>: <code>if false then foo = 42 end; foo #=&gt; nil</code>. <code>foo</code> is defined as local variable, but not initialized"}, {"owner": {"reputation": 537, "user_id": 4635580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/O8FQs.jpg?s=128&g=1", "display_name": "Isaac To", "link": "https://stackoverflow.com/users/4635580/isaac-to"}, "edited": false, "score": 1, "creation_date": 1545274537, "post_id": 53295242, "comment_id": 94571704, "body": "@ndnenkov No, I can&#39;t give you an example. My understanding of this particular aspect of a computer language was incorrect. I tried similar code in C, and the behavior was similar. Thanks for answer and explanation."}], "tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": true, "score": 8, "last_activity_date": 1542181773, "last_edit_date": 1542181773, "creation_date": 1542181413, "answer_id": 53295242, "question_id": 53294842, "link": "https://stackoverflow.com/questions/53294842/why-ruby-doesnt-allow-setting-a-local-variable-using-an-expression-containing-a/53295242#53295242", "title": "Why Ruby doesn&#39;t allow setting a local variable using an expression containing a field reader with the same name as the local variable?", "body": "<p>If you look closely, the <code>NoMethodError</code> isn't about there being no method <code>n</code>, but method <code>+</code> for <code>NilClass</code>.</p>\n\n<p>In this statement:</p>\n\n<pre><code>n = n + 1000\n</code></pre>\n\n<p>Ruby has to decide what <code>n</code> is. As you are assigning something to it (<code>n =</code>) it's not a method. If you wanted to call the <code>n=</code> method, you had to specify an explicit receiver (<code>self.n =</code>).</p>\n\n<p>So it has to be a variable. In this case local variable.</p>\n\n<hr>\n\n<p>Now to make sense of something like:</p>\n\n<pre><code>n = n\n</code></pre>\n\n<p>Ruby ends up assigning <code>nil</code> to <code>n</code>. This has to do with the internals having to put a placeholder for a variable name that is being assigned.</p>\n\n<hr>\n\n<p>So when you do:</p>\n\n<pre><code>n = n + 1000\n</code></pre>\n\n<p>What happens is:</p>\n\n<ol>\n<li>Create a new local variable <code>n</code> with placeholder value (<code>nil</code>).</li>\n<li>Attempt to assign to it whatever is on the right.</li>\n<li>Calculate what is on the right - <code>nil + 1000</code>.</li>\n<li><code>nil</code> doesn't have a <code>+</code> method so an error is raised.</li>\n</ol>\n\n<hr>\n\n<p>To do what you wanted to do, you have to explicitly reference the instance variable for its value:</p>\n\n<pre><code>n = @n + 1000\n</code></pre>\n\n<p>Or explicitly call the attribute reader:</p>\n\n<pre><code>n = self.n + 1000\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 4635580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/O8FQs.jpg?s=128&g=1", "display_name": "Isaac To", "link": "https://stackoverflow.com/users/4635580/isaac-to"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 53295242, "answer_count": 1, "score": 1, "last_activity_date": 1542181773, "creation_date": 1542179501, "last_edit_date": 1542181749, "question_id": 53294842, "link": "https://stackoverflow.com/questions/53294842/why-ruby-doesnt-allow-setting-a-local-variable-using-an-expression-containing-a", "title": "Why Ruby doesn&#39;t allow setting a local variable using an expression containing a field reader with the same name as the local variable?", "body": "<p>Consider the following code.</p>\n\n<pre><code>class A\n  attr_reader :n\n\n  def initialize\n    @n = 1\n  end\n\n  def set_local_n\n    n = 10\n  end\n\n  def using_field_reader_locally\n    n + 100\n  end\n\n  def using_field_reader_to_set_local_x\n    x = n + 1000\n  end\n\n  def using_field_reader_to_set_local_n\n    n = n + 1000  # This line raises a NoMethodError. Why?\n  end\nend\n</code></pre>\n\n<p>Why would the commented line produce an error? Why Ruby doesn't allow setting a local variable, <code>n</code> in this case, using an expression containing a field reader with the same name as the local variable? Why would all other instance methods run without any problem but <code>using_field_reader_to_set_local_n</code> produce an error.</p>\n\n<p>Please note that I am NOT intending to define <code>n</code> locally in <code>using_field_reader_to_set_local_n</code> with an expression involving the locally defined <code>n</code> in <code>set_local_n</code>. I am intending to define <code>n</code> locally in <code>using_field_reader_to_set_local_n</code> with an expressing involving the field reader of <code>@n</code>. The definition of <code>set_local_n</code> is for showing that <code>n</code> can be defined locally while a field reader named <code>n</code> exists.</p>\n"}, {"tags": ["ruby", "twilio", "webhooks"], "comments": [{"owner": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 0, "creation_date": 1542172962, "post_id": 53293589, "comment_id": 93468400, "body": "Why don&#39;t you simply acknowledge the POST with a <code>200</code> response and be done with it?"}, {"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "reply_to_user": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 0, "creation_date": 1542173005, "post_id": 53293589, "comment_id": 93468412, "body": "Because it&#39;s POSTing to slack, not a server that I&#39;m controlling or have access to. I don&#39;t think slack allows you to provide responses to incoming webhooks, unless I&#39;m msising something."}, {"owner": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 0, "creation_date": 1542173115, "post_id": 53293589, "comment_id": 93468436, "body": "It&#39;s somewhat bizarre to be accepting HTTP requests without returning a response\u2026 But oh well, I have no idea about Slack, so I&#39;ll leave you to it\u2026"}, {"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "reply_to_user": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 0, "creation_date": 1542173180, "post_id": 53293589, "comment_id": 93468462, "body": "Yeah that&#39;s pretty much how Twilio works with its webhooks. Once it receives a message, it just sends the details to a webhook and waits on a response. Just need to figure out if I can turn off this waiting process."}], "answers": [{"comments": [{"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1542335025, "post_id": 53294710, "comment_id": 93541185, "body": "Thanks! I&#39;m using a Twilio function to send to slack, just as mentioned in that article, but that&#39;s what&#39;s generating the error. I guess I need to figure out how to make more changes to the function."}, {"owner": {"reputation": 53136, "user_id": 28376, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ec1383b240b5ba15ffb9743fceb3c0e?s=128&d=identicon&r=PG", "display_name": "philnash", "link": "https://stackoverflow.com/users/28376/philnash"}, "reply_to_user": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1542338399, "post_id": 53294710, "comment_id": 93541789, "body": "Hmm, can you share the code you&#39;re using in your function. I reckon there might be something there that&#39;s not behaving."}, {"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1542338487, "post_id": 53294710, "comment_id": 93541809, "body": "absolutely. Updated the original post to reflect the function."}, {"owner": {"reputation": 53136, "user_id": 28376, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ec1383b240b5ba15ffb9743fceb3c0e?s=128&d=identicon&r=PG", "display_name": "philnash", "link": "https://stackoverflow.com/users/28376/philnash"}, "reply_to_user": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1542343039, "post_id": 53294710, "comment_id": 93542778, "body": "Think I found what was going on, I updated my answer."}], "tags": [], "owner": {"reputation": 53136, "user_id": 28376, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ec1383b240b5ba15ffb9743fceb3c0e?s=128&d=identicon&r=PG", "display_name": "philnash", "link": "https://stackoverflow.com/users/28376/philnash"}, "is_accepted": true, "score": 2, "last_activity_date": 1542343026, "last_edit_date": 1542343026, "creation_date": 1542178933, "answer_id": 53294710, "question_id": 53293589, "link": "https://stackoverflow.com/questions/53293589/twilio-awaits-response-i-dont-want-server-to-respond/53294710#53294710", "title": "Twilio awaits response, I don&#39;t want server to respond", "body": "<p>Twilio developer evangelist here.</p>\n\n<p>Twilio is always going to expect at least a 200 response or will timeout at 15 seconds for incoming message webhooks.</p>\n\n<p>You could avoid the error messages by using something in between Twilio and Slack, like Zapier (example in <a href=\"https://www.twilio.com/blog/2017/09/connecting-sms-to-slack-with-twilio-and-zapier.html\" rel=\"nofollow noreferrer\">this blog post</a>) or using a Twilio Function (as <a href=\"https://medium.com/@emilong/how-to-receive-sms-in-slack-using-twilio-functions-4d65f0edc670\" rel=\"nofollow noreferrer\">described here</a>) or with Twilio Studio (from the <a href=\"https://www.twilio.com/docs/studio/tutorials/how-to-post-sms-to-slack\" rel=\"nofollow noreferrer\">documentation here</a>).</p>\n\n<p>Hope one of those ideas helps!</p>\n\n<p><strong>Update</strong></p>\n\n<p>Further to my earlier answer, and given the code you used to make the call, I have an update.</p>\n\n<p>When making a request using Node's built in <code>https</code> module <a href=\"https://nodejs.org/api/stream.html#stream_class_stream_readable\" rel=\"nofollow noreferrer\">you will not get the <code>end</code> event until you have read the data</a>. This is what is causing the timeout between Twilio and the Twilio Function, you are never responding to it because you don't consume the data from the request.</p>\n\n<p>In a quick test I found that just listening for the <code>data</code> event meant that the <code>end</code> event did fire. So update your function to:</p>\n\n<pre><code>  const post = https.request(options, res =&gt; {\n    // only respond once we're done, or Twilio's functions\n    // may kill our execution before we finish.\n    res.on(\"data\", () =&gt; {});\n    res.on(\"end\", () =&gt; {\n      // respond with an empty message\n      callback(null, new Twilio.twiml.MessagingResponse());\n    });\n  });\n</code></pre>\n\n<p>And it should work.</p>\n"}], "owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53294710, "answer_count": 1, "score": 0, "last_activity_date": 1542343026, "creation_date": 1542172565, "last_edit_date": 1542338471, "question_id": 53293589, "link": "https://stackoverflow.com/questions/53293589/twilio-awaits-response-i-dont-want-server-to-respond", "title": "Twilio awaits response, I don&#39;t want server to respond", "body": "<p>I am using a Slack webhook to process incoming SMS messages from Twilio. However, the way I have it set up, It seems that Twilio is expecting the web server (slack) to respond to it. This causes errors to be generated in Twilio, and I obviously don't want errors because I'll be getting emails.</p>\n\n<p>I am using the <code>twilio-ruby</code> gem in Ruby to send out the SMS messages, and using the <code>slack-ruby-client</code> to monitor incoming messages from Slack.</p>\n\n<p>How do I stop Twilio from trying to expect a response from the web server when it POSTS to the Slack webhook? Is that even possible or do I have this all configured incorrectly?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Here's the function that I have which sends the forwarded SMS to Slack:</p>\n\n<pre><code>const https = require(\"https\");\n\n// Make sure to declare SLACK_WEBHOOK_PATH in your Environment\n// variables at\n// https://www.twilio.com/console/runtime/functions/configure\n\nexports.handler = (context, event, callback) =&gt; {\n  // Extract the bits of the message we want\n  const { To, From, Body } = event;\n\n  // Construct a payload for slack's incoming webhooks\n  const slackBody = JSON.stringify({\n        text: `!asi SMS\\nFrom: ${From}\\nMessage: ${Body}`\n  });\n\n  // Form our request specification\n  const options = {\n    host: \"hooks.slack.com\",\n    port: 443,\n    path: context.SLACK_WEBHOOK_PATH,\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Content-Length\": slackBody.length\n    }\n  };\n\n  // send the request\n  const post = https.request(options, res =&gt; {\n    // only respond once we're done, or Twilio's functions\n    // may kill our execution before we finish.\n    res.on(\"end\", () =&gt; {\n      // respond with an empty message\n      callback(null, new Twilio.twiml.MessagingResponse());\n    });\n  });\n  post.write(slackBody);\n  post.end();\n};\n</code></pre>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 5, "creation_date": 1542164971, "post_id": 53292598, "comment_id": 93466648, "body": "Don&#39;t use <code>$</code> for variables, provide correct arrays (currently they&#39;re empty), provide correct output (it&#39;s currently an array in hash, which just doesn&#39;t work)."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1542166166, "post_id": 53292598, "comment_id": 93466883, "body": "Your <code>$range_map</code> is an Array, not a Hash. It is still very unclear what you expect the output to be. If you provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable Example</a>, you will receive a proper answer."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1542174282, "post_id": 53292598, "comment_id": 93468754, "body": "Please don\u2019t add unnecessary commentary in your question titles. If you really feel the need to apologize for the title then you haven\u2019t spent enough time being thoughtful and should slow down before submitting your question. Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> for more information on effective titles."}], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 0, "last_activity_date": 1542173429, "creation_date": 1542173429, "answer_id": 53293726, "question_id": 53292598, "link": "https://stackoverflow.com/questions/53292598/compare-keys-of-array-in-ruby/53293726#53293726", "title": "Compare keys of array in RUBY", "body": "<p>I corrected your code also as per your need, and solved further,</p>\n\n<pre><code>$ArrayX = [8349310431,8349314513]\n$ArrayY = [667984788,667987788]\n$ArrayZ = [148507632380,153294624079]\n\n$range_map = $ArrayX.zip([$ArrayY.map(&amp;:to_i), $ArrayZ.map(&amp;:to_i)].transpose).sort\n\n$ArrayX = [8349310431,8349314513]\n =&gt; [8349310431, 8349314513]\n$ArrayY = [667984788,667987788]\n =&gt; [667984788, 667987788]\n$ArrayZ = [148507632380,153294624079]\n =&gt; [148507632380, 153294624079] \n\n$range_map = Hash[$ArrayX.zip([$ArrayY.map(&amp;:to_i), $ArrayZ.map(&amp;:to_i)].transpose).sort]\n =&gt; {8349310431=&gt;[667984788, 148507632380], 8349314513=&gt;[667987788, 153294624079]}\n\nkeys = $range_map.keys\nvalid_keys = keys.select { |k| keys.detect { |x| (x-k).abs &gt; 100 } }\n$range_map.slice(*valid_keys)\n</code></pre>\n\n<p>If particular key is having difference more than 100 with one of rest of keys then it will be valid for filtering.</p>\n"}], "owner": {"reputation": 9, "user_id": 10598651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/peUOq.jpg?s=128&g=1", "display_name": "Alejandro Rodriguez", "link": "https://stackoverflow.com/users/10598651/alejandro-rodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53293726, "answer_count": 1, "score": -5, "last_activity_date": 1542174040, "creation_date": 1542164666, "last_edit_date": 1542174040, "question_id": 53292598, "link": "https://stackoverflow.com/questions/53292598/compare-keys-of-array-in-ruby", "title": "Compare keys of array in RUBY", "body": "<p>I have this structure:</p>\n\n<pre><code>$ArrayX = [8349310431,8349314513,......]\n$ArrayY = [667984788,667987788,......]\n$ArrayZ = [148507632380,153294624079,.....]\n\n$range_map = $ArrayX.zip([$ArrayY.map(&amp;:to_i), \n             $ArrayZ.map(&amp;:to_i)].transpose).sort\n\nputs $range_map ={[8349310431=&gt;[667984788, 148507632380],  \n                 8349314513=&gt;[667987788, 153294624079]}\n</code></pre>\n\n<p>I need the key to be compared with the rest of the keys and if the subtraction between keys is lower than 100, that key to print</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "geolocation", "geocoding", "rails-geocoder"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1542158929, "post_id": 53291134, "comment_id": 93465305, "body": "rather than location by ip address, you should use HTML5 geolocation in the browser and pass that info to the server, it&#39;s more dependable."}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1542203260, "post_id": 53291134, "comment_id": 93483976, "body": "Thanks, I&#39;ll look into this"}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1542204710, "post_id": 53291134, "comment_id": 93484969, "body": "@maxpleaner Do you know how accurate HTML5 geolocation is? Would I be able to get lat long data to within a few meters?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1542228463, "post_id": 53291134, "comment_id": 93497713, "body": "yeah, it is pretty accurate. If you&#39;ve ever seen a website that prompts you &quot;allow this website to know your location&quot; and then it plots your exact location on a map ... that&#39;s how it&#39;s done. Lat/lng coords is exactly what HTML5 geolocation gives you, in fact."}], "owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542152920, "creation_date": 1542152920, "question_id": 53291134, "link": "https://stackoverflow.com/questions/53291134/is-it-possible-to-create-a-button-in-rails-with-the-geocoder-gem-that-fetches-a", "title": "Is it possible to create a button in Rails with the geocoder gem that fetches a user&#39;s current location?", "body": "<p>I'd like to create a simple app where locations can be saved from a user's current location and distances can be calculated between these locations. Can this be done with the following code:</p>\n\n<pre><code>geocoded_by :ip_address,\n  :latitude =&gt; :lat, :longitude =&gt; :lon\nafter_validation :geocode\n</code></pre>\n"}, {"tags": ["ruby", "activerecord", "acts-as-audited"], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 2484674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c290f54fc22cb113ebc52a60df8729?s=128&d=identicon&r=PG", "display_name": "Norm", "link": "https://stackoverflow.com/users/2484674/norm"}, "is_accepted": false, "score": 0, "last_activity_date": 1542173134, "creation_date": 1542173134, "answer_id": 53293683, "question_id": 53290442, "link": "https://stackoverflow.com/questions/53290442/creating-a-draft-version-of-an-object-using-audited-gem/53293683#53293683", "title": "Creating a draft version of an object using Audited Gem", "body": "<p>I didn't use the Audited gem to deliver \"draft\" mode.  Instead, I added a boolean named <strong>active</strong> to the model, and declared</p>\n\n<pre><code> default_scope { where(active: true) }\n scope :active, -&gt; { where(active: true )  }\n scope :draft,  -&gt; { where(active: false)  }\n</code></pre>\n\n<p>Then, in the controller, a method for administrators to see the draft items:</p>\n\n<pre><code>def in_draft\n  # Admins can see all items in draft status.\n  # Sellers can see only their own items in draft status.\n  # Buyers can't get here at all because of the authorizations\n  if current_tuser.role == \"Themadmin\"\n    @seller_listings = Listing.unscoped.draft\n  end\nend\n</code></pre>\n\n<p>Last, a method in the controller to publish the item:</p>\n\n<pre><code>80   def publish\n 81     @listing = Listing.unscoped.find(params[:id])\n 82     @listing.active = true\n 83     respond_to do |format|\n 84       if @listing.save!\n 85         format.html {redirect_to @listing, notice: 'Listing changed from draft to published.'}\n 86       else\n 87         format.html {redirect_to @listing, notice: 'Something went wrong'}\n 88       end\n 89     end\n 90   end\n</code></pre>\n"}], "owner": {"reputation": 6933, "user_id": 26604, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e94ddf54b3d31c6eda0e1c76a58c3e74?s=128&d=identicon&r=PG", "display_name": "Kyle Heironimus", "link": "https://stackoverflow.com/users/26604/kyle-heironimus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542173134, "creation_date": 1542147922, "question_id": 53290442, "link": "https://stackoverflow.com/questions/53290442/creating-a-draft-version-of-an-object-using-audited-gem", "title": "Creating a draft version of an object using Audited Gem", "body": "<p>Audited is made to work with the current version and previous versions. What I want is to have one more version, a future version, AKA a draft.</p>\n\n<h3>Desired Scenario</h3>\n\n<p>The current version of an object is used everywhere. However, in the admin screen, you can access and edit a future/draft version of the object. This allows you to make modifications that are not yet visible to others. When the draft is ready, you publish it, making it the current version used everywhere.</p>\n\n<p>I don't see any support for this.</p>\n\n<ol>\n<li>Am I missing something? Is this supported?</li>\n<li>Is there some kind of Audited hack that can support this, even in an ugly way?</li>\n<li>If no to the above, does this seem like something that could be done reasonably with the Audited gem or am I better off using a different method?</li>\n</ol>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "activerecord", "sql-order-by"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1542148090, "post_id": 53289886, "comment_id": 93462690, "body": "I don&#39;t see how that ORDER BY would produce incorrect results, there could be confusing results if NULLs were involved but nothing like the example. Could you show us some real data? Even just the release dates?"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1542179738, "post_id": 53289886, "comment_id": 93470659, "body": "Try to change <code>includes</code> for <code>joins</code>. When you still have wrong order, it indicates the issues is in your data. Because provided &quot;Example&quot; is not reproducible and does not correspond to &quot;Backtraces with real data&quot;."}, {"owner": {"reputation": 763, "user_id": 2679301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b83c0e9fed62d90353b411bc48b0e0f?s=128&d=identicon&r=PG", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/2679301/guillaume"}, "reply_to_user": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1542184869, "post_id": 53289886, "comment_id": 93472873, "body": "@PavelMikhailyuk it returns the same thing with <code>joins</code>. If I show you the result of the query you will only see returned movies and not the movie_countries (who has the <code>release_date</code> column)"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 1, "creation_date": 1542187401, "post_id": 53289886, "comment_id": 93474366, "body": "Anyway, your &quot;Example&quot; is wrong: it returns right result on empty DB with 3 Movie and 3 corresponding MovieCountry. So, the issue is your data and no one can help you without it. I can just guess, that you have more than 1 MovieCountry per Movie with different <code>release_date</code>s."}, {"owner": {"reputation": 763, "user_id": 2679301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b83c0e9fed62d90353b411bc48b0e0f?s=128&d=identicon&r=PG", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/2679301/guillaume"}, "reply_to_user": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1542188092, "post_id": 53289886, "comment_id": 93474788, "body": "@PavelMikhailyuk you&#39;re right. The issue is that the movie had 2 movie_countries... 1 from France with an old <code>release_date</code>, and another one with a <code>release_date</code> for December. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1542150451, "post_id": 53290747, "comment_id": 93463339, "body": "Keep in mind that calling <code>.reverse</code> will change your ActiveRecord association into an Array. This may or may not be what you intend."}, {"owner": {"reputation": 763, "user_id": 2679301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b83c0e9fed62d90353b411bc48b0e0f?s=128&d=identicon&r=PG", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/2679301/guillaume"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1542153587, "post_id": 53290747, "comment_id": 93464070, "body": "You are right... And <code>reverse_order</code> doesn&#39;t work properly :/"}, {"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 0, "creation_date": 1542164456, "post_id": 53290747, "comment_id": 93466537, "body": "How about <code>includes(:movie_countries).order(&#39;movie_countries.release_da&zwnj;&#8203;te DESC&#39;)</code>"}, {"owner": {"reputation": 763, "user_id": 2679301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b83c0e9fed62d90353b411bc48b0e0f?s=128&d=identicon&r=PG", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/2679301/guillaume"}, "reply_to_user": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 0, "creation_date": 1542179793, "post_id": 53290747, "comment_id": 93470689, "body": "@Dbz This is what my original <code>recent</code> scope does :)"}, {"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 0, "creation_date": 1542183841, "post_id": 53290747, "comment_id": 93472372, "body": "@Guillaume not quite. My suggestion returns an <code>ActiveRecord_Relation</code> and the <code>recent</code> scope returns an <code>Array</code>. This may end up being very important, and at the very least the expected behavior should be consistent if not well documented"}, {"owner": {"reputation": 763, "user_id": 2679301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b83c0e9fed62d90353b411bc48b0e0f?s=128&d=identicon&r=PG", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/2679301/guillaume"}, "reply_to_user": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 0, "creation_date": 1542184704, "post_id": 53290747, "comment_id": 93472792, "body": "@Dbz my original scope is this one <code>scope :recent,    -&gt; { includes(:movie_countries).order(&#39;movie_countries.release_da&zwnj;&#8203;te DESC&#39;) }</code>"}], "tags": [], "owner": {"reputation": 763, "user_id": 2679301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b83c0e9fed62d90353b411bc48b0e0f?s=128&d=identicon&r=PG", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/2679301/guillaume"}, "is_accepted": true, "score": 0, "last_activity_date": 1542189432, "last_edit_date": 1542189432, "creation_date": 1542149782, "answer_id": 53290747, "question_id": 53289886, "link": "https://stackoverflow.com/questions/53289886/rails-order-based-on-association-doesnt-work-properly/53290747#53290747", "title": "Rails order based on association doesn&#39;t work properly", "body": "<p>I found an alternative to fix this issue :</p>\n\n<pre><code># Movie.rb\nscope :old,       -&gt; {includes(:movie_countries).order('movie_countries.release_date ASC') }\nscope :recent,    -&gt; { old.reverse }\n</code></pre>\n\n<h2>SOLUTION</h2>\n\n<p>Thanks to<a href=\"https://stackoverflow.com/questions/53289886/rails-order-based-on-association-doesnt-work-properly?noredirect=1#comment93474366_53289886\">@PavelMikhailyuk 's answer</a> I found the solution</p>\n\n<pre><code># Movie.rb\nscope :recent,    -&gt; (iso_code = 'FR') { includes(:movie_countries).where(movie_countries: {iso_code: iso_code}).order('movie_countries.release_date DESC') }\n</code></pre>\n\n<p>The problem was that my movie had 2 <code>movie_countries</code>.</p>\n\n<pre><code>[#&lt;MovieCountry id: 8, country_id: 2, movie_id: 5, release_date: \"2018-12-10\", iso_code: \"GB\", created_at: \"2018-10-23 15:23:09\", updated_at: \"2018-10-23 15:23:09\"&gt;, \n #&lt;MovieCountry id: 7, country_id: 1, movie_id: 5, release_date: \"2018-10-24\", iso_code: \"FR\", created_at: \"2018-10-23 15:23:09\", updated_at: \"2018-10-23 15:23:09\"&gt;]\n</code></pre>\n\n<p>I must search the <code>movie_countries</code> for a specific country AND THEN sort them.</p>\n"}], "owner": {"reputation": 763, "user_id": 2679301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b83c0e9fed62d90353b411bc48b0e0f?s=128&d=identicon&r=PG", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/2679301/guillaume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53290747, "answer_count": 1, "score": 0, "last_activity_date": 1542189432, "creation_date": 1542145087, "question_id": 53289886, "link": "https://stackoverflow.com/questions/53289886/rails-order-based-on-association-doesnt-work-properly", "title": "Rails order based on association doesn&#39;t work properly", "body": "<p>I\u2019m trying to sort movies by release_date but it doesn\u2019t work properly</p>\n\n<pre><code>@movies = Movie.where(id: movie_ids).recent\n</code></pre>\n\n<p>If I use the opposite scope (:old) it\u2019s working but not with (:recent)</p>\n\n<pre><code># Movie.rb\n\n# Associations  \nhas_many :movie_countries, dependent: :destroy\nhas_many :countries, through: :movie_countries\n\n# Scopes\nscope :recent,    -&gt; { includes(:movie_countries).order('movie_countries.release_date DESC') }\nscope :old,       -&gt; { includes(:movie_countries).order('movie_countries.release_date ASC') }\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>MovieCountry id: 1, movie_id: 1, release_date: '2018-01-01'\nMovieCountry id: 2, movie_id: 2, release_date: '2019-01-01'\nMovieCountry id: 3, movie_id: 3, release_date: '2020-01-01'\n\nmovies = Movie.recent\nmovies =&gt; [movie id: 1, movie id: 3, movie id: 2]\n\nmovies = Movie.old\nmovies =&gt; [movie id: 1, movie id: 2, movie id: 3]\n</code></pre>\n\n<p>As you can see, the :old scope works properly but not :recent</p>\n\n<p>Backtraces with real data:</p>\n\n<ul>\n<li><p>Recent: </p>\n\n<p>SELECT \"movies\".\"id\" AS t0_r0, \"movies\".\"external_id\" AS t0_r1, \"movies\".\"original_title\" AS t0_r2, \"movies\".\"original_language\" AS t0_r3, \"movies\".\"imdb_id\" AS t0_r4, \"movies\".\"tmdb_id\" AS t0_r5, \"movies\".\"rentrak_film_id\" AS t0_r6, \"movies\".\"running_time\" AS t0_r7, \"movies\".\"status\" AS t0_r8, \"movies\".\"website\" AS t0_r9, \"movies\".\"backdrop_url\" AS t0_r10, \"movies\".\"created_at\" AS t0_r11, \"movies\".\"updated_at\" AS t0_r12, \"movie_countries\".\"id\" AS t1_r0, \"movie_countries\".\"country_id\" AS t1_r1, \"movie_countries\".\"movie_id\" AS t1_r2, \"movie_countries\".\"release_date\" AS t1_r3, \"movie_countries\".\"iso_code\" AS t1_r4, \"movie_countries\".\"created_at\" AS t1_r5, \"movie_countries\".\"updated_at\" AS t1_r6 FROM \"movies\" LEFT OUTER JOIN \"movie_countries\" ON \"movie_countries\".\"movie_id\" = \"movies\".\"id\" WHERE \"movies\".\"id\" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62, $63, $64, $65, $66, $67, $68, $69, $70, $71, $72, $73, $74, $75, $76, $77, $78, $79, $80, $81, $82, $83, $84, $85, $86, $87, $88, $89, $90, $91, $92, $93, $94, $95, $96, $97, $98, $99, $100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $110, $111, $112, $113, $114, $115, $116, $117, $118, $119, $120, $121, $122, $123, $124, $125, $126, $127, $128, $129, $130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155, $156, $157, $158, $159, $160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $170, $171, $172, $173, $174, $175, $176, $177, $178, $179, $180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $201, $202, $203, $204, $205, $206, $207, $208, $209, $210, $211, $212, $213, $214, $215, $216, $217, $218, $219, $220, $221, $222, $223, $224, $225, $226, $227, $228, $229, $230, $231, $232, $233, $234, $235, $236, $237, $238, $239, $240, $241) ORDER BY movie_countries.release_date DESC</p></li>\n<li><p>Old :</p>\n\n<p>SELECT \"movies\".\"id\" AS t0_r0, \"movies\".\"external_id\" AS t0_r1, \"movies\".\"original_title\" AS t0_r2, \"movies\".\"original_language\" AS t0_r3, \"movies\".\"imdb_id\" AS t0_r4, \"movies\".\"tmdb_id\" AS t0_r5, \"movies\".\"rentrak_film_id\" AS t0_r6, \"movies\".\"running_time\" AS t0_r7, \"movies\".\"status\" AS t0_r8, \"movies\".\"website\" AS t0_r9, \"movies\".\"backdrop_url\" AS t0_r10, \"movies\".\"created_at\" AS t0_r11, \"movies\".\"updated_at\" AS t0_r12, \"movie_countries\".\"id\" AS t1_r0, \"movie_countries\".\"country_id\" AS t1_r1, \"movie_countries\".\"movie_id\" AS t1_r2, \"movie_countries\".\"release_date\" AS t1_r3, \"movie_countries\".\"iso_code\" AS t1_r4, \"movie_countries\".\"created_at\" AS t1_r5, \"movie_countries\".\"updated_at\" AS t1_r6 FROM \"movies\" LEFT OUTER JOIN \"movie_countries\" ON \"movie_countries\".\"movie_id\" = \"movies\".\"id\" WHERE \"movies\".\"id\" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62, $63, $64, $65, $66, $67, $68, $69, $70, $71, $72, $73, $74, $75, $76, $77, $78, $79, $80, $81, $82, $83, $84, $85, $86, $87, $88, $89, $90, $91, $92, $93, $94, $95, $96, $97, $98, $99, $100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $110, $111, $112, $113, $114, $115, $116, $117, $118, $119, $120, $121, $122, $123, $124, $125, $126, $127, $128, $129, $130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155, $156, $157, $158, $159, $160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $170, $171, $172, $173, $174, $175, $176, $177, $178, $179, $180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $201, $202, $203, $204, $205, $206, $207, $208, $209, $210, $211, $212, $213, $214, $215, $216, $217, $218, $219, $220, $221, $222, $223, $224, $225, $226, $227, $228, $229, $230, $231, $232, $233, $234, $235, $236, $237, $238, $239, $240, $241) ORDER BY movie_countries.release_date ASC</p></li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "match", "filtering"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 1, "creation_date": 1542145065, "post_id": 53289847, "comment_id": 93461492, "body": "It&#39;s hard to understand your schema and relations. It would be helpful if you could post your User, Content, and Profile models and the rest of the relevant code."}, {"owner": {"reputation": 2663, "user_id": 46682, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8d4bc05db03a745368281dc3ce1deac?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/46682/dom"}, "edited": false, "score": 0, "creation_date": 1542155800, "post_id": 53289847, "comment_id": 93464624, "body": "Does the content need to match all or some or the profile filters?"}, {"owner": {"reputation": 11, "user_id": 7141222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wFUJnCCDmNo/AAAAAAAAAAI/AAAAAAAAAMA/ZLcEGRkwPHQ/photo.jpg?sz=128", "display_name": "mihra&#231; cerraho\u011flu", "link": "https://stackoverflow.com/users/7141222/mihra%c3%a7-cerraho%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1542189694, "post_id": 53289847, "comment_id": 93475806, "body": "Yes. May be content will be available for all genders or all countries."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7141222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wFUJnCCDmNo/AAAAAAAAAAI/AAAAAAAAAMA/ZLcEGRkwPHQ/photo.jpg?sz=128", "display_name": "mihra&#231; cerraho\u011flu", "link": "https://stackoverflow.com/users/7141222/mihra%c3%a7-cerraho%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1542195710, "post_id": 53292527, "comment_id": 93479406, "body": "Thanks Jurgen! I will try and comment the result in there. only question beafore start, if we are making <code>profilable</code> in polymorphic, why you permitting params direct under content params? shouldn&#39;t be like <code>...(:content).(:title,profile_attirbutes: [:gender, :city, :etc] </code>?"}, {"owner": {"reputation": 2663, "user_id": 46682, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8d4bc05db03a745368281dc3ce1deac?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/46682/dom"}, "reply_to_user": {"reputation": 11, "user_id": 7141222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wFUJnCCDmNo/AAAAAAAAAAI/AAAAAAAAAMA/ZLcEGRkwPHQ/photo.jpg?sz=128", "display_name": "mihra&#231; cerraho\u011flu", "link": "https://stackoverflow.com/users/7141222/mihra%c3%a7-cerraho%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1542196989, "post_id": 53292527, "comment_id": 93480170, "body": "Yes that&#39;s correct, if you want to pass nested attributes through params to the controller, you will need to add them as permitted params. The attrs you saw were artifacts from scaffolding the app out before I created a polymorphic Profile model. The controllers weren&#39;t necessary to show example worked because I used a seed file to add data to the database, and the console to query it. I&#39;ve updated the github project to show the changes necessary in the controllers and in the models. The forms also need updating to include fields_for, this is something I haven&#39;t done. I can help if you want."}, {"owner": {"reputation": 11, "user_id": 7141222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wFUJnCCDmNo/AAAAAAAAAAI/AAAAAAAAAMA/ZLcEGRkwPHQ/photo.jpg?sz=128", "display_name": "mihra&#231; cerraho\u011flu", "link": "https://stackoverflow.com/users/7141222/mihra%c3%a7-cerraho%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1542197940, "post_id": 53292527, "comment_id": 93480676, "body": "Thanks Jurgen. You have spent more time for my question. I will try to make it as way that you said. I know that can contact you if i couldn&#39;t achieve it. Thanks again."}, {"owner": {"reputation": 2663, "user_id": 46682, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8d4bc05db03a745368281dc3ce1deac?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/46682/dom"}, "reply_to_user": {"reputation": 11, "user_id": 7141222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wFUJnCCDmNo/AAAAAAAAAAI/AAAAAAAAAMA/ZLcEGRkwPHQ/photo.jpg?sz=128", "display_name": "mihra&#231; cerraho\u011flu", "link": "https://stackoverflow.com/users/7141222/mihra%c3%a7-cerraho%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1542201639, "post_id": 53292527, "comment_id": 93482883, "body": "I&#39;m feeling generous today! I&#39;ve updated the repo to include views, updated routes, and added delegates for profile in the User model. It demonstrates how you can read the profile values directly from the user instance, rather than having to go through the profile. The content model shows the traditional way of not using a delegate. All the views work including displaying and updating records. Just clone the latest version and run rails server and go to root url at localhost:3000."}, {"owner": {"reputation": 2663, "user_id": 46682, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8d4bc05db03a745368281dc3ce1deac?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/46682/dom"}, "reply_to_user": {"reputation": 11, "user_id": 7141222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wFUJnCCDmNo/AAAAAAAAAAI/AAAAAAAAAMA/ZLcEGRkwPHQ/photo.jpg?sz=128", "display_name": "mihra&#231; cerraho\u011flu", "link": "https://stackoverflow.com/users/7141222/mihra%c3%a7-cerraho%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1542202777, "post_id": 53292527, "comment_id": 93483643, "body": "I added a seed and the #all_matching_content list to the users show view to demonstrate how you can restrict content matching to all matching profile attributes instead of any matching attribute. Hope this helps you. If you find this example answers your question, please mark it as accepted."}, {"owner": {"reputation": 11, "user_id": 7141222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wFUJnCCDmNo/AAAAAAAAAAI/AAAAAAAAAMA/ZLcEGRkwPHQ/photo.jpg?sz=128", "display_name": "mihra&#231; cerraho\u011flu", "link": "https://stackoverflow.com/users/7141222/mihra%c3%a7-cerraho%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1542559245, "post_id": 53292527, "comment_id": 93602906, "body": "Hi jurgen, It is exactly this answer is what i need. Your answer will be marked as &quot;accepted&quot; I have just litle bit question but big important; ` what if content creator want to filter by age as &quot; between 18 and 55 years old OR all ages&quot; ? ` do you have any idea?"}, {"owner": {"reputation": 2663, "user_id": 46682, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8d4bc05db03a745368281dc3ce1deac?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/46682/dom"}, "reply_to_user": {"reputation": 11, "user_id": 7141222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wFUJnCCDmNo/AAAAAAAAAAI/AAAAAAAAAMA/ZLcEGRkwPHQ/photo.jpg?sz=128", "display_name": "mihra&#231; cerraho\u011flu", "link": "https://stackoverflow.com/users/7141222/mihra%c3%a7-cerraho%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1542634529, "post_id": 53292527, "comment_id": 93627162, "body": "@mihra&#231;cerraho\u011flu I&#39;ve added (to the github project) minimum and maximum age fields to the profile with scopes for restricting content returned. In order to remove age restrictions and allow any age, simply do not fill the age fields in the profile so they remain NULL in the database for that content. If you have any other questions please feel free to contact me on <a href=\"https://www.linkedin.com/in/jurgenjocubeit\" rel=\"nofollow noreferrer\">linkedin.com/in/jurgenjocubeit</a>, or raise an issue at <a href=\"https://github.com/JurgenJocubeit/so-53289847/issues\" rel=\"nofollow noreferrer\">github.com/JurgenJocubeit/so-53289847/issues</a>. I&#39;m happy to help any time."}], "tags": [], "owner": {"reputation": 2663, "user_id": 46682, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8d4bc05db03a745368281dc3ce1deac?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/46682/dom"}, "is_accepted": true, "score": 0, "last_activity_date": 1542164104, "creation_date": 1542164104, "answer_id": 53292527, "question_id": 53289847, "link": "https://stackoverflow.com/questions/53289847/rails-filter-by-comparing-between-two-models/53292527#53292527", "title": "Rails: Filter by comparing between two models", "body": "<p>I'm going to assume you mean any matching content but I'm providing a solution for both ALL or ANY matching profile filters.</p>\n\n<p>Here's one quick solution on how you can achieve what you want.</p>\n\n<p>Given the following models:</p>\n\n<pre><code># app/models/user.rb\nclass User &lt; ApplicationRecord\n  has_one :profile, as: :profilable\n\n  def all_matching_content\n    profile: Profile.where(\n      \"? &gt;= age\", profile.age).\n      where(\n        gender: profile.gender,\n        city: profile.city,\n        license: profile.license).\n      where(profilable_type: \"Content\"))\n  end\n\n  def any_matching_content\n    Content.where(\n      profile: Profile.where(\"? &gt;= age\", profile.age).\n        or(Profile.where(gender: profile.gender)).\n        or(Profile.where(city: profile.city)).\n        or(Profile.where(license: profile.license)).\n      where(profilable_type: \"Content\"))\n    end\n  end\nend\n\n# app/models/profile.rb\nclass Profile &lt; ApplicationRecord\n  belongs_to :profilable, polymorphic: true, optional: true\nend\n\n# app/models/content.rb\nclass Content &lt; ApplicationRecord\n  has_one :profile, as: :profilable\nend\n</code></pre>\n\n<p>And the following migrations:</p>\n\n<pre><code># db/migrate/20181114004031_create_users.rb\nclass CreateUsers &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :users do |t|\n      t.string :name, index: true\n      t.timestamps\n    end\n  end\nend\n\n# db/migrate/20181114004134_create_profiles.rb\nclass CreateProfiles &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :profiles do |t|\n      t.references :profilable, polymorphic: true, null: true\n      t.boolean :license, index: true\n      t.string :city, index: true\n      t.string :gender, index: true\n      t.integer :age, index: true\n      t.timestamps\n      t.index [:license, :city, :gender, :age], name: \"profile_composite_index\"\n    end\n  end\nend\n\n# db/migrate/20181114004307_create_contents.rb\nclass CreateContents &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :contents do |t|\n      t.string :title, index: true\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>And the following seeds:</p>\n\n<pre><code># db/seeds.rb\nUser.create!(\n  name: \"John\",\n  profile: Profile.create!(\n    license: true,\n    city: \"London\",\n    gender: \"Male\",\n    age: 19\n  )\n)\n\nUser.create!(\n  name: \"Jane\",\n  profile: Profile.create!(\n    license: false,\n    city: \"London\",\n    gender: \"Female\",\n    age: 17\n  )\n)\n\nUser.create!(\n  name: \"Rose\",\n  profile: Profile.create!(\n    license: true,\n    city: \"Edinburgh\",\n    gender: \"Female\",\n    age: 21\n  )\n)\n\nUser.create!(\n  name: \"Hans\",\n  profile: Profile.create!(\n    license: true,\n    city: \"Berlin\",\n    gender: \"Male\",\n    age: 24\n  )\n)\n\nContent.create!(\n  title: \"London introduces new tax\",\n  profile: Profile.create!(\n    city: \"London\"\n  )\n)\n\nContent.create!(\n  title: \"New license requirements in Berlin\",\n  profile: Profile.create!(\n    city: \"Berlin\",\n    license: true\n  )\n)\n\nContent.create!(\n  title: \"Women should get new immunization\",\n  profile: Profile.create!(\n    gender: \"Female\"\n  )\n)\n\nContent.create!(\n  title: \"Adults only expo opens Wednesday\",\n  profile: Profile.create!(\n    age: 18\n  )\n)\n</code></pre>\n\n<p>You'll be able to do the following:</p>\n\n<pre><code>&gt; john = User.find_by(name: \"John\")\n&gt; john.all_matching_content\n=&gt; #&lt;ActiveRecord::Relation []&gt;\n\n&gt; john.any_matching_content.map(&amp;:title)\n=&gt; [\"London introduces new tax\", \"New license requirements in Berlin\", \"Adults only expo opens Wednesday\"]\n\n&gt; jane = User.find_by(name: \"Jane\")\n&gt; jane.any_matching_content.map(&amp;:title)\n=&gt; [\"London introduces new tax\", \"Women should get new immunization\"]\n\n&gt; rose = User.find_by(name: \"Rose\")\n&gt; rose.any_matching_content.map(&amp;:title)\n=&gt; [\"New license requirements in Berlin\", \"Women should get new immunization\", \"Adults only expo opens Wednesday\"]\n\n&gt; hans = User.find_by(name: \"Hans\")\n&gt; hans.any_matching_content.map(&amp;:title)\n=&gt; [\"New license requirements in Berlin\", \"Adults only expo opens Wednesday\"]\n</code></pre>\n\n<p>The solution works by sharing a polymorphic <code>Profile</code> model with <code>User</code> and <code>Content</code>. It then matches <code>Content</code> with the <code>User</code> instance by passing the user's <code>Profile</code> attributes to a query for matching profiles that belong to <code>Content</code> types.</p>\n\n<p>Note that the <code>#all_matching_content</code> method requires that all profile attributes match, basically it means all conditons in the query are \"AND\"ed. The <code>#any_matching_content</code> method uses \"OR\" conditions instead.</p>\n\n<p>I have uploaded a quick project to GitHub with this example already coded:</p>\n\n<p><a href=\"https://github.com/JurgenJocubeit/so-53289847\" rel=\"nofollow noreferrer\">https://github.com/JurgenJocubeit/so-53289847</a></p>\n"}], "owner": {"reputation": 11, "user_id": 7141222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wFUJnCCDmNo/AAAAAAAAAAI/AAAAAAAAAMA/ZLcEGRkwPHQ/photo.jpg?sz=128", "display_name": "mihra&#231; cerraho\u011flu", "link": "https://stackoverflow.com/users/7141222/mihra%c3%a7-cerraho%c4%9flu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 53292527, "answer_count": 1, "score": 0, "last_activity_date": 1542164104, "creation_date": 1542144898, "last_edit_date": 1542145277, "question_id": 53289847, "link": "https://stackoverflow.com/questions/53289847/rails-filter-by-comparing-between-two-models", "title": "Rails: Filter by comparing between two models", "body": "<p>I confused about matching between two models. I have researched on stackoverflow and google until 2 days but no way...\nThere is more questions and answer about matching and filtering but it is about one way searching, listing. May be I couldn\u2019t understand I\u2019m not sure.\nFor example:\nI have contents and users in my app.\nI shared contents and I don\u2019t want to make visible, likeable for all users.\nUsers should see who;</p>\n\n<ul>\n<li>Bigger than 18 years old and less than 70. </li>\n<li>must live at England and\nLondon city. (It can be changeable)</li>\n<li>they must have a drive license</li>\n<li>gender: man bla bla etc.</li>\n</ul>\n\n<p>My first idea was create profile for users and take information from them.\nAlso create profile filter for <code>Content</code> model and fill the form like belov.</p>\n\n<p>But problem is at final step;\n\u201cHow i compare them for only users can see and like who has true attributes same as <code>Content</code> filter attributes.</p>\n\n<p>Models;</p>\n\n<p><code>User</code> and <code>Content</code></p>\n\n<p><code>Profile</code> belongs_to <code>user</code></p>\n\n<p><code>Contentfilter</code> belongs_to <code>Content</code></p>\n\n<p>Than;\nShow contens if current_user profile attributes same as Content filter.</p>\n\n<p>Do you have any suggestion?\nThanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8575751"}, "edited": false, "score": 0, "creation_date": 1542147576, "post_id": 53290261, "comment_id": 93462476, "body": "Thanks for the help, how would I go about displaying this in my contacts view?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1542147687, "post_id": 53290261, "comment_id": 93462529, "body": "It returns an ActiveRecord::Relation that you can iterate through just like any other collection. I think you can figure it out on your own."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1542147035, "creation_date": 1542147035, "answer_id": 53290261, "question_id": 53289766, "link": "https://stackoverflow.com/questions/53289766/how-can-i-list-all-users-that-are-part-of-same-teams-as-current-user/53290261#53290261", "title": "How can I list all users that are part of same teams as current user", "body": "<p>You can solve this by joining the memberships table and applying a where clause to the join table:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_many :memberships\n  has_many :groups, through: :memberships\n\n  def users_with_same_groups\n    User.joins(:memberships)\n        .where(memberships: { group: self.groups })\n        .where.not(id: self.id)\n  end\nend\n</code></pre>\n\n<p>SQL:</p>\n\n<pre><code>SELECT \"users\".*\nFROM   \"users\"\n       INNER JOIN \"memberships\"\n               ON \"memberships\".\"user_id\" = \"users\".\"id\"\nWHERE  \"memberships\".\"group_id\" IN (SELECT \"groups\".\"id\"\n                                    FROM   \"groups\"\n                                           INNER JOIN \"memberships\"\n                                                   ON \"groups\".\"id\" =\n                                                      \"memberships\".\"group_id\"\n                                    WHERE  \"memberships\".\"user_id\" = $1)\nLIMIT  $2 \n</code></pre>\n\n<p>Since it produces an inner join only records with a match in joined table will be included. Meaning that result set will only include users with at least one group in common.</p>\n\n<p><code>.where.not(id: self.id)</code> excludes <em>self</em> from the results.</p>\n"}, {"tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 0, "last_activity_date": 1542148974, "creation_date": 1542148974, "answer_id": 53290619, "question_id": 53289766, "link": "https://stackoverflow.com/questions/53289766/how-can-i-list-all-users-that-are-part-of-same-teams-as-current-user/53290619#53290619", "title": "How can I list all users that are part of same teams as current user", "body": "<p>I would keep the logic outside of your views, and instead put it in a controller (or, as @max suggests, in the User model):</p>\n\n<pre><code>#current_user_controller.rb\n\nclass CurrentUserController &lt; ApplicationController    \n  def contacts\n    @contacts = User.joins(:groups)\n                    .where(groups: {id: current_user.groups})\n                    .where.not(id: current_user).uniq\n  end\nend\n</code></pre>\n\n<p>Now you can iterate over <code>@contacts</code> in your <code>current_user/contacts</code> view.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8575751"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 53290261, "answer_count": 2, "score": 1, "last_activity_date": 1543239713, "creation_date": 1542144549, "last_edit_date": 1543239713, "question_id": 53289766, "link": "https://stackoverflow.com/questions/53289766/how-can-i-list-all-users-that-are-part-of-same-teams-as-current-user", "title": "How can I list all users that are part of same teams as current user", "body": "<p>I've got a messaging site where any user can send messages to each other, but now is there a way to only show users that are in the same teams as the current user?</p>\n\n<p>My user.rb model:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_many :memberships\n  has_many :teams, through: :memberships\n  devise :database_authenticatable, :registerable, :confirmable,\n         :recoverable, :rememberable, :validatable\n\nend\n</code></pre>\n\n<p>My team.rb model:</p>\n\n<pre><code>class Team &lt; ApplicationRecord\n  has_many :memberships\n  has_many :users, through: :memberships\n  validates_uniqueness_of :name\nend\n</code></pre>\n\n<p>My membership.rb model:</p>\n\n<pre><code>class Membership &lt; ApplicationRecord\n  belongs_to :user\n  belongs_to :team\nend\n</code></pre>\n\n<p>My \"Contacts\" view:</p>\n\n<pre><code>&lt;li&gt;\n  &lt;% @user = User.find(current_user.id) %&gt;\n  &lt;% @all_teams = @user.teams %&gt;\n\n  &lt;% @all_teams.users.each do |user| %&gt;\n    &lt;%= user.name %&gt; \n  &lt;% end %&gt;\n&lt;/li&gt;\n</code></pre>\n"}, {"tags": ["android", "ruby-on-rails", "ruby", "firebase", "firebase-cloud-messaging"], "owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1542142722, "creation_date": 1542142722, "question_id": 53289406, "link": "https://stackoverflow.com/questions/53289406/fastest-way-to-send-non-broadcast-push-with-fcm", "title": "Fastest way to send non-broadcast push with FCM?", "body": "<p>I need to send a large number of web push notifications via FCM, all which are personalized (so I can't use broadcast messages. It's 1 push per token). Let's say the number of subscribers is 500K-2M, so that means 500K-2M API requests I think?</p>\n\n<p>I've read several articles about the topic, such as how <a href=\"https://blog.discordapp.com/how-discord-handles-push-request-bursts-of-over-a-million-per-minute-with-elixirs-genstage-8f899f0221b4\" rel=\"nofollow noreferrer\">discord does it</a>. They use the XMPP API which I would love to use, but currently I'm doing this in ruby and I don't think any of the current libraries support what's discussed in that article (100 requests at a time, connection draining, etc), and I don't want to build something from scratch.</p>\n\n<p>So I think I'm stuck with the HTTP API for now.</p>\n\n<p>The thing I'm having difficulty with is how to actually run the requests asynchronously... I've tried using Typhoeus gem with 2000 connections at once, and many of the connections timed out.</p>\n\n<p>I've tried researching FCM docs for HTTP API rate limits and connection limits but can't find anything...</p>\n\n<p>What is the fastest strategy to send 1M non-broadcast FCM messages using the HTTP API?</p>\n"}, {"tags": ["json", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542145531, "post_id": 53288831, "comment_id": 93461696, "body": "If you really want a float then <code>Time#to_f</code> will return a float for you. or even <code>BigDecimal.new(Time.at(1000.123456).to_r,24).to_s(&#39;24F&#39;).to_&zwnj;&#8203;json</code> if the yoctosecond precision is really important"}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 1449987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6dcbe30d2b08278917ba59d5b22ab4?s=128&d=identicon&r=PG", "display_name": "jessebs", "link": "https://stackoverflow.com/users/1449987/jessebs"}, "edited": false, "score": 0, "creation_date": 1542141773, "post_id": 53289174, "comment_id": 93460194, "body": "Thanks.  Great point and iso8601 is probably a good way for me to go.  That&#39;s still modifying the Time class, though.  Any thoughts on avoiding that?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 511, "user_id": 1449987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6dcbe30d2b08278917ba59d5b22ab4?s=128&d=identicon&r=PG", "display_name": "jessebs", "link": "https://stackoverflow.com/users/1449987/jessebs"}, "edited": false, "score": 0, "creation_date": 1542144488, "post_id": 53289174, "comment_id": 93461235, "body": "@jessebs You need to monkey patch for it to work on Time objects embedded in other objects. You could use <a href=\"https://ruby-doc.org/core/doc/syntax/refinements_rdoc.html\" rel=\"nofollow noreferrer\">refinements</a> but they&#39;re lexical in scope and so <a href=\"https://gist.github.com/schwern/e1f87090b7d5928e75a41a7dbc59e2f3\" rel=\"nofollow noreferrer\">don&#39;t recurse into <code>obj.to_json</code></a>. The alternative is to implement <code>around</code> to only monkey patch for a certain block of code. I&#39;ve updated the answer to demonstrate."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 511, "user_id": 1449987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6dcbe30d2b08278917ba59d5b22ab4?s=128&d=identicon&r=PG", "display_name": "jessebs", "link": "https://stackoverflow.com/users/1449987/jessebs"}, "edited": false, "score": 0, "creation_date": 1542144708, "post_id": 53289174, "comment_id": 93461341, "body": "@jessebs it is really not an issue in this case. The <code>Time</code> class does not have a specific <code>to_json</code> method so it falls back to <code>Object#to_json</code> which is just the <code>to_s</code> representation as shown <a href=\"https://github.com/flori/json/blob/master/ext/json/ext/generator/generator.c#L502\" rel=\"nofollow noreferrer\">Here</a> so patching it in really has no specific impact although the signature should probably be <code>to_json(*)</code> to remain consistent with all other implementations. However you could just use <code>Time.at(1000.123456).strftime(&quot;%Y-%m-%dT%H:%M:%S.%6N%z&quot;).to_&zwnj;&#8203;json</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542320389, "post_id": 53289174, "comment_id": 93537843, "body": "Very interesting. You may wish to make <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/date/rdoc/DateTime.html#method-i-iso8601\" rel=\"nofollow noreferrer\">DateTime#iso8601</a>&#39;s argument equal to <code>9</code>, to get full precision on numbers of nanoseconds without inspecting numbers of significant digits. When I execute <code>Time.now.nsec</code> I get <code>7</code> significant digits (Bash on Ubuntu on Windows 10).  You can shorten <code>return self.iso8601(6).to_json</code> to <code>iso8601(6).to_json</code>. (I&#39;m sure you know that. I&#39;m guessing you probably spend most of your time these days working with a language other than Ruby.)"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542320859, "post_id": 53289174, "comment_id": 93537966, "body": "@CarySwoveland Thanks for the notes. I spend most of my time in Ruby now. I largely left the particular details of <code>Time#to_json</code> to the OP (microseconds seemed safe) and focused on making it work transparently and recursively without a global monkey patch. I do occasionally get bit by <code>foo</code> not being equivalent to <code>self.foo</code>, possibly variable/method ambiguities, so sometimes I&#39;m conservative. I&#39;m quite happy with the <code>around</code> implementation and might generalize it and turn it into a library."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 3, "last_activity_date": 1542144457, "last_edit_date": 1542144457, "creation_date": 1542141658, "answer_id": 53289174, "question_id": 53288831, "link": "https://stackoverflow.com/questions/53288831/ruby-timeto-json-as-a-float/53289174#53289174", "title": "Ruby Time#to_json as a float", "body": "<blockquote>\n  <p><em>A straightforward approach is to monkey patch Time, although I'm not fond of doing that, especially to core classes</em></p>\n</blockquote>\n\n<p>There's no JSON format for dates, as far as JSON cares they're just strings. Most languages understand <a href=\"https://github.com/ruby/ruby/blob/4444025d16ae1a586eee6a0ac9bdd09e33833f3c/ext/json/lib/json/add/time.rb\" rel=\"nofollow noreferrer\">ISO 8601</a>, and that's what <code>Time#to_json</code> produces. So long as <code>Time#to_json</code> continues to produce an ISO 8601 datetime you'll remain backwards compatible.</p>\n\n<pre><code>require 'json'\nrequire 'time'  # for Time#iso8601 and Time.parse\n\nclass Time\n  def to_json\n    return self.iso8601(6).to_json\n  end\nend\n\ntime = Time.at(1000.123456)\nputs \"Before: #{time.iso8601(6)}\"\n\njson_time = Time.at(1000.123456).to_json\nputs \"As JSON: #{json_time}\"\n\n# Demonstrate round tripping.\nputs \"Round trip: #{Time.parse(JSON.parse(json_time)).iso8601(6)}\"\n</code></pre>\n\n\n\n<pre><code>Before: 1969-12-31T16:16:40.123456-08:00\nAs JSON: \"1969-12-31T16:16:40.123456-08:00\"\nRound trip: 1969-12-31T16:16:40.123456-08:00\n</code></pre>\n\n<hr>\n\n<p>If you're not comfortable with monkey patching globally, you can monkey patch in isolation by implementing <code>around</code>.</p>\n\n<pre><code>class Time\n  require 'time'\n  require 'json'\n\n  def precise_to_json(*args)\n    return iso8601(6).to_json(*args)\n  end\n\n  alias_method :original_to_json, :to_json\nend\n\nmodule PreciseJson\n  def self.around\n    # Swap in our precise_to_json as Time#to_json\n    Time.class_eval {\n      alias_method :to_json, :precise_to_json\n    }\n\n    # This block will use Time#precise_to_json as Time#to_json\n    yield\n\n  # Always put the original Time#to_json back.\n  ensure\n    Time.class_eval {\n      alias_method :to_json, :original_to_json\n    }\n  end\nend\n\nobj = { \n  time: Time.at(1000.123456),\n  string: \"Basset Hounds Got Long Ears\"\n}\n\nputs \"Before: #{obj.to_json}\"\n\nPreciseJson.around {\n  puts \"Around: #{obj.to_json}\"\n}\n\nputs \"After: #{obj.to_json}\"\n\nbegin\n  PreciseJson.around {\n    raise Exception\n  }\nrescue Exception\nend\n\nputs \"After exception: #{obj.to_json}\"\n</code></pre>\n\n\n\n<pre><code>Before: {\"time\":\"1969-12-31 16:16:40 -0800\",\"string\":\"Basset Hounds Got Long Ears\"}\nAround: {\"time\":\"1969-12-31T16:16:40.123456-08:00\",\"string\":\"Basset Hounds Got Long Ears\"}\nAfter: {\"time\":\"1969-12-31 16:16:40 -0800\",\"string\":\"Basset Hounds Got Long Ears\"}\nAfter exception: {\"time\":\"1969-12-31 16:16:40 -0800\",\"string\":\"Basset Hounds Got Long Ears\"}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1542146772, "post_id": 53289786, "comment_id": 93462167, "body": "<code>require &#39;json&#47;add&#47;time&#39;</code> then <code>Time.now.to_json #=&gt; &quot;{\\&quot;json_class\\&quot;:\\&quot;Time\\&quot;,\\&quot;s\\&quot;:1542145917,\\&quot;n\\&quot;:74844000}&quot;</code> where <code>s</code> is seconds and <code>n</code> is nanoseconds"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1542148598, "post_id": 53289786, "comment_id": 93462844, "body": "It also adds <code>Time::json_create</code> so <code>th= JSON.parse(Time.now.to_json); t= Object.const_get(th.delete(&quot;json_class&quot;)).json_create(th)</code>"}, {"owner": {"reputation": 511, "user_id": 1449987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6dcbe30d2b08278917ba59d5b22ab4?s=128&d=identicon&r=PG", "display_name": "jessebs", "link": "https://stackoverflow.com/users/1449987/jessebs"}, "edited": false, "score": 0, "creation_date": 1542317302, "post_id": 53289786, "comment_id": 93536648, "body": "I mentioned wanting to avoid <code>json&#47;add&#47;time</code> in the original question.  It makes json parsing between languages more difficult"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542318338, "post_id": 53289786, "comment_id": 93537069, "body": "jessebs, I missed that, so rolled back to my original answer."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1542318244, "last_edit_date": 1542318244, "creation_date": 1542144603, "answer_id": 53289786, "question_id": 53288831, "link": "https://stackoverflow.com/questions/53288831/ruby-timeto-json-as-a-float/53289786#53289786", "title": "Ruby Time#to_json as a float", "body": "<p>You could save the number of nanoseconds since the Epoch.</p>\n\n<pre><code>require 'time'\nrequire 'json'\n\nt = Time.now\n  #=&gt; 2018-11-13 13:23:32 -0800\njson = [t.to_i, t.nsec].to_json\n  #=&gt; \"[1542144212,883611300]\"\n\nsecs, nsecs = JSON.parse(json)\n  #=&gt; [1542144212, 883611300]\nr = secs + 10**-9 * nsecs\n  #=&gt; (15421442128836113/10000000)\ntt = Time.at r\n  #=&gt; 2018-11-13 13:23:32 -0800\n\nt == tt\n  #=&gt; true\n</code></pre>\n\n<p>Note <code>(10**-9).class #=&gt; Rational</code>.</p>\n"}], "owner": {"reputation": 511, "user_id": 1449987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6dcbe30d2b08278917ba59d5b22ab4?s=128&d=identicon&r=PG", "display_name": "jessebs", "link": "https://stackoverflow.com/users/1449987/jessebs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 53289174, "answer_count": 2, "score": 0, "last_activity_date": 1542318244, "creation_date": 1542140153, "question_id": 53288831, "link": "https://stackoverflow.com/questions/53288831/ruby-timeto-json-as-a-float", "title": "Ruby Time#to_json as a float", "body": "<p>Ruby's json library defaults to converting Time objects to Strings</p>\n\n<pre><code>require 'json'\nTime.at(1000).utc.to_json # =&gt; \"\\\"1970-01-01 00:16:40 UTC\\\"\" \n</code></pre>\n\n<p>The problem with this is that we lose precision.  I'd like to_json to produce a float instead.</p>\n\n<p>I also know there are some workarounds using <code>oj</code> or requiring <code>json/add/time</code>, but both of these add excess data to the output and aren't the most portable.</p>\n\n<p>A straightforward approach is to monkey patch Time, although I'm not fond of doing that, especially to core classes</p>\n\n<pre><code>class Time\n  def to_json(*a)\n    self.to_f.to_json(*a)\n  end\nend\n</code></pre>\n\n<p>Are there any better approaches?</p>\n"}, {"tags": ["ruby", "linux", "chef-infra"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1542140203, "post_id": 53288658, "comment_id": 93459636, "body": "&quot;can&#39;t seem to get it to work&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}, {"owner": {"reputation": 187, "user_id": 5880560, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/XT7TH.png?s=128&g=1", "display_name": "Devon", "link": "https://stackoverflow.com/users/5880560/devon"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1542141656, "post_id": 53288658, "comment_id": 93460153, "body": "Sorry, I have multiple variable blocks for a template. I&#39;m trying to apply data to the file on the server, according to the chef role. Role1 should have a certain set of users, role2 should have another set of users. So when I run chef, its not applying the set of users per that server role. Hope that makes better sense."}], "answers": [{"tags": [], "owner": {"reputation": 19821, "user_id": 170230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cNDYy.png?s=128&g=1", "display_name": "Draco Ater", "link": "https://stackoverflow.com/users/170230/draco-ater"}, "is_accepted": true, "score": 1, "last_activity_date": 1542185441, "creation_date": 1542185441, "answer_id": 53296184, "question_id": 53288658, "link": "https://stackoverflow.com/questions/53288658/have-a-question-about-chef-variables-cant-seem-to-get-the-variables-to-work/53296184#53296184", "title": "Have a question about Chef variables, can&#39;t seem to get the variables to work", "body": "<p>Chef client run is divided into 2 parts: compile and converge. In the first stage Chef creates a collection of resources that should be applied on the node and in the second stage it applies the changes. More on it <a href=\"https://docs.chef.io/chef_client_overview.html\" rel=\"nofollow noreferrer\">on the Chef docs</a></p>\n\n<p>You are assigning <code>node.normal['mainrole']</code> in converge state, but you check the values (<code>node['mainrole'] == \"role1\"</code>) in compile stage, which is before that.</p>\n\n<p>You need to either move assigning to compile state or move checks into converge state.\nOne of the examples how to move checks into converge state is to use <code>not_if</code> or <code>only_if</code>. You will need 2 template resources in this case:</p>\n\n<pre><code>template \"/etc/ssh/sshd_config for 1,2,3\" do\n  path \"/etc/ssh/sshd_config\"\n  source \"ssh/sshd_config.erb\"\n  owner \"root\"\n  group \"root\"\n  mode \"0600\"\n  action :create\n  variables(:allowed_users_team1 =&gt; \"AllowUsers user1 user2 user3\")\n  only_if { node['mainrole'] == \"role1\" }\n  notifies :restart, \"service[sshd]\", :immediately\nend\n\ntemplate \"/etc/ssh/sshd_config for 4,5,6\" do\n  path \"/etc/ssh/sshd_config\"\n  source \"ssh/sshd_config.erb\"\n  owner \"root\"\n  group \"root\"\n  mode \"0600\"\n  action :create\n  variables(:allowed_users_team2 =&gt; \"AllowUsers user4 user5 user6\")\n  only_if { %w[role2 role3 role4].include? node['mainrole'] }\n  notifies :restart, \"service[sshd]\", :immediately\nend\n</code></pre>\n\n<p>Another way is to move the logic inside the template itself and pass 2 different variables:</p>\n\n<pre><code>  variables(:allowed_users_team2 =&gt; \"AllowUsers user4 user5 user6\",\n    :allowed_users_team1 =&gt; \"AllowUsers user1 user2 user3\",\n    :mainrole =&gt; node['mainrole'])\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 5880560, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/XT7TH.png?s=128&g=1", "display_name": "Devon", "link": "https://stackoverflow.com/users/5880560/devon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 53296184, "answer_count": 1, "score": -2, "last_activity_date": 1542185441, "creation_date": 1542139402, "last_edit_date": 1542142349, "question_id": 53288658, "link": "https://stackoverflow.com/questions/53288658/have-a-question-about-chef-variables-cant-seem-to-get-the-variables-to-work", "title": "Have a question about Chef variables, can&#39;t seem to get the variables to work", "body": "<p>I'm trying to use server roles to add data into a template. I tried a couple of methods and can't seem to get it to work. </p>\n\n<p>Here is the role code block. </p>\n\n<pre><code>ruby_block 'get_main_role_attr' do\nblock do\n  require 'mixlib/shellout'\n  rolecmd = Mixlib::ShellOut.new(\"cat /var/chef/role | cut -d',' -f 1 | cut -c2-\")\n  rolecmd.run_command\n  rolecmd.error!\n  node.normal['mainrole'] = rolecmd.stdout\n end\nend\n\ntemplate \"/etc/ssh/sshd_config\" do\n  source \"ssh/sshd_config.erb\"\n  owner \"root\"\n  group \"root\"\n  mode \"0600\"\n  action :create\n  variables(\n    :allowed_users_team1 =&gt; \"AllowUsers user1 user2 user3\",\n    ) if node['mainrole'] == \"role1\"\n  notifies :restart, \"service[sshd]\", :immediately\n  variables(\n    :allowed_users_team2 =&gt; \"AllowUsers user4 user5 user6\",\n    ) if node['mainrole'] == \"role2\" || node['mainrole'] ==  \"role3\" || node['mainrole'] == \"role4\"\n  notifies :restart, \"service[sshd]\", :immediately\nend\n</code></pre>\n\n<p>Method 1</p>\n\n<pre><code>variables(\n    :allowed_users =&gt; \"AllowUsers user1 user2\",\n    ) if node['mainrole'] == \"role1\" || node['mainrole'] ==  \"role2\" ||    node['mainrole'] == \"role3\"\nnotifies :restart, \"service[sshd]\", :immediately\n</code></pre>\n\n<p>Method 2</p>\n\n<pre><code>variables(\n   :allowed_users =&gt; \"AllowUsers user1 user2\",\n   ) if node['mainrole'] == \"role1\" || \"role2\" || \"role3\"\nnotifies :restart, \"service[sshd]\", :immediately\n</code></pre>\n\n<p>Method 3</p>\n\n<pre><code>variables(\n   :allowed_users_bidder =&gt; \"AllowUsers user1 user2\",\n) if node['roles'].any? {|r| %w{role1 role2 role3}.include?(r)}\nnotifies :restart, \"service[sshd]\", :immediately\n</code></pre>\n\n<p>Let me knwo what I'm doign wrong please.. Thank you for the help</p>\n\n<p>Thx</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 676, "user_id": 5394713, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-EWDgGVCHSi0/AAAAAAAAAAI/AAAAAAAAFzQ/CiRFZRXaPDg/photo.jpg?sz=128", "display_name": "Mateus Luiz", "link": "https://stackoverflow.com/users/5394713/mateus-luiz"}, "edited": false, "score": 0, "creation_date": 1542138611, "post_id": 53288462, "comment_id": 93458935, "body": "Yup, this will work, but I wanna know why the rails needs to remove the has_one referenced record to update by its own."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 676, "user_id": 5394713, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-EWDgGVCHSi0/AAAAAAAAAAI/AAAAAAAAFzQ/CiRFZRXaPDg/photo.jpg?sz=128", "display_name": "Mateus Luiz", "link": "https://stackoverflow.com/users/5394713/mateus-luiz"}, "edited": false, "score": 1, "creation_date": 1542138680, "post_id": 53288462, "comment_id": 93458970, "body": "@MateusLuiz: how about <code>object.child = new_child</code> Maybe followed by <code>object.save</code> and/or <code>new_child.save</code>. I&#39;m pretty sure this will work too."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 676, "user_id": 5394713, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-EWDgGVCHSi0/AAAAAAAAAAI/AAAAAAAAFzQ/CiRFZRXaPDg/photo.jpg?sz=128", "display_name": "Mateus Luiz", "link": "https://stackoverflow.com/users/5394713/mateus-luiz"}, "edited": false, "score": 0, "creation_date": 1542139014, "post_id": 53288462, "comment_id": 93459105, "body": "@MateusLuiz: as to why the code from the question doesn&#39;t work like you expect it to, I don&#39;t know. Need a repro and some time for stepping through AR code."}, {"owner": {"reputation": 676, "user_id": 5394713, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-EWDgGVCHSi0/AAAAAAAAAAI/AAAAAAAAFzQ/CiRFZRXaPDg/photo.jpg?sz=128", "display_name": "Mateus Luiz", "link": "https://stackoverflow.com/users/5394713/mateus-luiz"}, "edited": false, "score": 0, "creation_date": 1542139260, "post_id": 53288462, "comment_id": 93459222, "body": "The other solution will work too (you can consult the <code>Child.where(object_class: object_class)</code> and the child will be returned), but doesn&#39;t update the <code>has_one</code> referenced record either :/ , but thanks for the answer!!"}, {"owner": {"reputation": 676, "user_id": 5394713, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-EWDgGVCHSi0/AAAAAAAAAAI/AAAAAAAAFzQ/CiRFZRXaPDg/photo.jpg?sz=128", "display_name": "Mateus Luiz", "link": "https://stackoverflow.com/users/5394713/mateus-luiz"}, "edited": false, "score": 0, "creation_date": 1542139364, "post_id": 53288462, "comment_id": 93459278, "body": "But this can be fixed changing the has_one to has_many (I&#39;m having an database modelation problem too), this question is more like a curiosity"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 0, "last_activity_date": 1542138470, "creation_date": 1542138470, "answer_id": 53288462, "question_id": 53288421, "link": "https://stackoverflow.com/questions/53288421/why-rails-doesnt-update-the-has-one-reference/53288462#53288462", "title": "Why rails doesn&#39;t update the &quot;has_one&quot; reference?", "body": "<p>Do this from the other end.</p>\n\n<pre><code>new_child.update(object_class_id: object.id)\n</code></pre>\n"}], "owner": {"reputation": 676, "user_id": 5394713, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-EWDgGVCHSi0/AAAAAAAAAAI/AAAAAAAAFzQ/CiRFZRXaPDg/photo.jpg?sz=128", "display_name": "Mateus Luiz", "link": "https://stackoverflow.com/users/5394713/mateus-luiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542138470, "creation_date": 1542138321, "question_id": 53288421, "link": "https://stackoverflow.com/questions/53288421/why-rails-doesnt-update-the-has-one-reference", "title": "Why rails doesn&#39;t update the &quot;has_one&quot; reference?", "body": "<p>I was trying to update a <code>has_one</code> reference but without deleting/destroying the old referenced record, but when I do this the reference to the new object isn't updated.</p>\n\n<p>Example:</p>\n\n<p>Classes:</p>\n\n<pre><code>ObjectClass\n  has_one :child\nend\n\nChild\n  belongs_to :object_class\nend\n</code></pre>\n\n<p>Update:</p>\n\n<pre><code>object.update(child: new_child)\n</code></pre>\n\n<p>When I consulted the object after the update with <code>ObjectClass.last.child</code> the old child is returned, not the <code>new_child</code>. This only works if I run <code>object.child.destroy</code> before the update above.\n`</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "fastjsonapi"], "answers": [{"tags": [], "owner": {"reputation": 671, "user_id": 3445936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cd8z6.jpg?s=128&g=1", "display_name": "Rohit Lingayat", "link": "https://stackoverflow.com/users/3445936/rohit-lingayat"}, "is_accepted": true, "score": 0, "last_activity_date": 1542192848, "creation_date": 1542192848, "answer_id": 53298521, "question_id": 53287872, "link": "https://stackoverflow.com/questions/53287872/how-do-i-serialize-habtm-relationships-in-ruby-on-rails-with-fast-jsonapi/53298521#53298521", "title": "How do I serialize habtm relationships in Ruby on Rails with fast_jsonapi", "body": "<p>you need to do changes in your <code>CandidateSerializer</code> and <code>DegreeSerializer</code>.</p>\n\n<p>Instead of writing the separate HABTM relation in serializer you can directly right in <code>attributes</code></p>\n\n<p>e.g</p>\n\n<pre><code>class CandidateSerializer\n  include FastJsonapi::ObjectSerializer\n  attributes :place, :zip_code,:degrees\nend\n</code></pre>\n\n<p><strong>response</strong></p>\n\n<pre><code>{\n  :data=&gt;\n    {:id=&gt;\"\",\n     :type=&gt;:candidate,\n     :attributes=&gt; {   \n       degrees: {}\n     }\n }\n</code></pre>\n\n<p>same for <code>DegreeSerializer</code></p>\n\n<pre><code>  class DegreeSerializer\n    include FastJsonapi::ObjectSerializer\n    attributes :candidates\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13715363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6931c3105705f88d1ae177b7b498778?s=128&d=identicon&r=PG&f=1", "display_name": "V&#237;tor Ribas Bandeira", "link": "https://stackoverflow.com/users/13715363/v%c3%adtor-ribas-bandeira"}, "is_accepted": false, "score": 1, "last_activity_date": 1602013782, "creation_date": 1602013782, "answer_id": 64232875, "question_id": 53287872, "link": "https://stackoverflow.com/questions/53287872/how-do-i-serialize-habtm-relationships-in-ruby-on-rails-with-fast-jsonapi/64232875#64232875", "title": "How do I serialize habtm relationships in Ruby on Rails with fast_jsonapi", "body": "<p>You can do this:</p>\n<pre><code>class CandidateSerializer\n  include FastJsonapi::ObjectSerializer\n  attributes :place, :zip_code,...\n  has_many :degrees, if: Proc.new { |record| record.association(:dregrees).loaded? }\nend\n</code></pre>\n<pre><code>class DegreeSerializer\n  include FastJsonapi::ObjectSerializer\n  has_many :candidates, if: Proc.new { |record| record.association(:candidates).loaded? }\nend\n</code></pre>\n<p>And in your API action (here for example with show route):</p>\n<pre><code>def show\n  @candidate.degrees.load\n  render json: CandidateSerializer.new(@candidate, options).serialized_json if stale?(@candidate)\nend\n\nprivate\n\ndef set_candidate\n  @candidate = Candidate.find_by(id: params[:id])\nend\n\ndef options\n  { include: [:degrees] }\nend\n</code></pre>\n<p><strong>Result</strong>:</p>\n<pre><code>{\n    &quot;data&quot;: {\n        &quot;id&quot;: &quot;20&quot;,\n        &quot;type&quot;: &quot;candidate&quot;,\n        &quot;attributes&quot;: {\n            &quot;id&quot;: 20,\n            ...\n        },\n        &quot;relationships&quot;: {\n            &quot;degrees&quot;: {\n                &quot;data&quot;: [\n                    {\n                        &quot;id&quot;: &quot;713&quot;,\n                        &quot;type&quot;: &quot;degree&quot;\n                    }\n                ]\n            }\n        }\n    },\n    &quot;included&quot;: [\n        {\n            &quot;id&quot;: &quot;713&quot;,\n            &quot;type&quot;: &quot;degree&quot;,\n            &quot;attributes&quot;: {\n                &quot;id&quot;: 713,\n                ...\n            },\n            &quot;relationships&quot;: {}\n        }\n    ]\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9051106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92219080195332845f4a95b7fead2b00?s=128&d=identicon&r=PG&f=1", "display_name": "mroe", "link": "https://stackoverflow.com/users/9051106/mroe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 1, "accepted_answer_id": 53298521, "answer_count": 2, "score": 0, "last_activity_date": 1602013782, "creation_date": 1542135820, "question_id": 53287872, "link": "https://stackoverflow.com/questions/53287872/how-do-i-serialize-habtm-relationships-in-ruby-on-rails-with-fast-jsonapi", "title": "How do I serialize habtm relationships in Ruby on Rails with fast_jsonapi", "body": "<p>I created a Ruby on Rails API application where I wanted to implement a JSON api with <a href=\"https://github.com/Netflix/fast_jsonapi\" rel=\"nofollow noreferrer\">fast_jsonapi</a>. Now I'm struggling with the relationships, which aren't shown. What do I have to change?</p>\n\n<p>This is my schema.db:</p>\n\n<pre><code>create_table \"candidates\", force: :cascade do |t|\n  t.string \"place\"\n  t.string \"zip_code\"\n  t.string \"address\"\n  t.string \"date_of_birth\"\n  t.string \"title\"\n  t.string \"profile_picture\"\n  t.string \"first_name\"\n  t.string \"last_name\"\n  t.string \"email_address\"\n  t.boolean \"confirm_terms_and_conditions\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n\ncreate_table \"candidates_degrees\", id: false, force: :cascade do |t|\n  t.bigint \"candidate_id\"\n  t.bigint \"degree_id\"\n  t.index [\"candidate_id\"], name: \"index_candidates_degrees_on_candidate_id\"\n  t.index [\"degree_id\"], name: \"index_candidates_degrees_on_degree_id\"\nend\n\ncreate_table \"degrees\", force: :cascade do |t|\n  t.string \"degree\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n</code></pre>\n\n<p>And these are my models:</p>\n\n<pre><code>class Candidate &lt; ApplicationRecord\n  has_and_belongs_to_many :degrees, dependent: :nullify\nend\n\nclass Degree &lt; ApplicationRecord\n  has_and_belongs_to_many :candidates, dependent: :nullify\nend\n</code></pre>\n\n<p>These are my serializers:</p>\n\n<pre><code>class CandidateSerializer\n  include FastJsonapi::ObjectSerializer\n  attributes :place, :zip_code, ...\n  has_many :degrees\nend\n\nclass DegreeSerializer\n  include FastJsonapi::ObjectSerializer\n  attributes :degree\n  has_many :candidates\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542136559, "post_id": 53287869, "comment_id": 93458061, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/53285855/change-the-facing-with-a-turn-left-method-in-ruby\">Change the facing with a turn_left method in Ruby</a>"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1542138356, "post_id": 53287869, "comment_id": 93458857, "body": "What&#39;s the difference from <a href=\"https://stackoverflow.com/questions/53285855/change-the-facing-with-a-turn-left-method-in-ruby\" title=\"change the facing with a turn left method in ruby\">stackoverflow.com/questions/53285855/&hellip;</a>?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1542139515, "post_id": 53287869, "comment_id": 93459339, "body": "This is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1542142243, "post_id": 53287869, "comment_id": 93460383, "body": "It looks like SO has been tasked with writing a robot game from scratch?"}, {"owner": {"reputation": 93, "user_id": 8067836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIY38.jpg?s=128&g=1", "display_name": "Andrea Baz&#225;n", "link": "https://stackoverflow.com/users/8067836/andrea-baz%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1542144812, "post_id": 53287869, "comment_id": 93461392, "body": "Thank u guys!! Im implementing a game into a platform to teach kids to code and I had some issues with that but I already finished! :)"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 8067836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIY38.jpg?s=128&g=1", "display_name": "Andrea Baz&#225;n", "link": "https://stackoverflow.com/users/8067836/andrea-baz%c3%a1n"}, "edited": false, "score": 1, "creation_date": 1542144835, "post_id": 53288647, "comment_id": 93461402, "body": "Thank you so much @Schwern!!"}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 1, "last_activity_date": 1542139876, "last_edit_date": 1542139876, "creation_date": 1542139364, "answer_id": 53288647, "question_id": 53287869, "link": "https://stackoverflow.com/questions/53287869/change-position-according-to-facing-in-ruby/53288647#53288647", "title": "Change position according to facing in Ruby", "body": "<p>Add <code>MOVES</code> which says how to move based on how you're facing.</p>\n\n<pre><code>MOVES = {\n  north: [0, 1],\n  south: [0, -1],\n  east:  [1, 0],\n  west:  [-1,0]\n}\n\ndef move\n  move = MOVES.fetch(@facing)\n  @position[0] += move[0]\n  @position[1] += move[1]\nend\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core/Hash.html#method-i-fetch\" rel=\"nofollow noreferrer\"><code>MOVES.fetch(@facing)</code></a> is used instead of <code>MOVES[@facing]</code> so an error will be raised if there is no move for that facing.</p>\n\n<p>You could also do this with a <code>case</code> statement, but this keeps <code>move</code> simple and data driven. You can add more directions like <code>northeast: [1,1]</code>. And if you make this an instance variable, you can customize how individual robots move.</p>\n\n<pre><code># Define `moves` and `moves=` to get and set `@moves`\nattr_accessor :moves\n\ndef initialize(attr = {})\n  ...\n  # Initialize `moves` with either Robot.new(moves: {...})\n  # or the default MOVES\n  @moves ||= attr[:moves] || MOVES\n  ...\nend\n\ndef move\n  move = moves.fetch(@facing)\n  @position[0] += move[0]\n  @position[1] += move[1]\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1542140190, "creation_date": 1542140190, "answer_id": 53288836, "question_id": 53287869, "link": "https://stackoverflow.com/questions/53287869/change-position-according-to-facing-in-ruby/53288836#53288836", "title": "Change position according to facing in Ruby", "body": "<pre><code>DIRECTION_NUMBER = { :north=&gt;0, :east=&gt;1, :south=&gt;2, :west=&gt;3 }\n\n@left = { :north=&gt;:west, :west=&gt;:south, :south=&gt;:east, :east=&gt;:north }\n@right = @left.invert\n  #=&gt; {:west=&gt;:north, :south=&gt;:west, :east=&gt;:south, :north=&gt;:east}\n\ndef turn_left\n  @facing = @left[@facing]\nend\n\ndef turn_right\n  @facing = @right[@facing]\nend\n\ndef move(direction)\n  x, y = @location\n  @location =\n  case direction\n  when :north\n    [x,y+1]\n  when :east\n    [x+1,y]\n  when :south\n    [x,y-1]\n  else\n    [x-1,y]\n  end\n  update_facing(direction)\nend\n</code></pre>\n\n<p></p>\n\n<pre><code>private\n\ndef update_facing(direction)\n  change = (DIRECTION_NUMBER[direction] - DIRECTION_NUMBER[@facing]) % 4\n  case change\n  when 1\n    turn_right\n  when 2\n    turn_right; turn_right\n  when 3\n    turn_left\n  end\nend\n</code></pre>\n\n<p></p> \n\n<pre><code>@location = [3, 3]    \n@facing = :east\n\nmove(:south)\n@location   #=&gt; [3, 2]\n@facing     #=&gt; :south\n\nmove(:north)\n@location   #=&gt; [3, 3]\n@facing     #=&gt; :north\n\nmove(:west)\n@location   #=&gt; [2, 3]\n@facing     #=&gt; :west\n\nmove(:east)\n@location   #=&gt; [3, 3]\n@facing     #=&gt; :east\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10652551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1660b872c199114b7d47a80b5978ea16?s=128&d=identicon&r=PG", "display_name": "\u308d\u306f\u3093", "link": "https://stackoverflow.com/users/10652551/%e3%82%8d%e3%81%af%e3%82%93"}, "is_accepted": false, "score": 1, "last_activity_date": 1542205780, "creation_date": 1542205780, "answer_id": 53302547, "question_id": 53287869, "link": "https://stackoverflow.com/questions/53287869/change-position-according-to-facing-in-ruby/53302547#53302547", "title": "Change position according to facing in Ruby", "body": "<p>FACINGS enum example.</p>\n\n<pre><code>module FACINGS\n  NORTH = [0, 1]\n  SOURTH = [0, -1]\n  EAST =  [1, 0]\n  WEST =  [-1,0]\nend\n\nclass Robot\n  attr_reader :position\n\n  def initialize(attr = {})\n    @position = attr[:position] || [1, 1]\n  end\n\n  def move(facings)\n    @position[0] += facings[0]\n    @position[1] += facings[1]\n  end\nend\n\nr = Robot.new\nr.move(FACINGS::NORTH)\nr.move(FACINGS::SOURTH)\nr.move(FACINGS::WEST)\nr.move(FACINGS::EAST)\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 8067836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIY38.jpg?s=128&g=1", "display_name": "Andrea Baz&#225;n", "link": "https://stackoverflow.com/users/8067836/andrea-baz%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 53288836, "answer_count": 3, "score": 0, "last_activity_date": 1542205780, "creation_date": 1542135799, "last_edit_date": 1542136935, "question_id": 53287869, "link": "https://stackoverflow.com/questions/53287869/change-position-according-to-facing-in-ruby", "title": "Change position according to facing in Ruby", "body": "<p>I need to implement a move method that change position according to facing, position is a [x,y] and I thinking that if move to south is y+1, to north y-1, to east x-1 and to west x+1. this movements are into a matrix. \nThis is my code. Thank you so much for your help!</p>\n\n<pre><code># Models the Robot behavior for the game\nclass Robot\n FACINGS = [:south, :east, :north, :west]\n\n def initialize(attr = {})\n  @position = attr[:position] || [1, 1]\n  # @move = attr[:move]\n  @facing_index = facing_index(attr[:facing]) || 0 # south\n  @facing = facing\n  # @errors =\n end\n\n def position\n  @position\n end\n\n def move\n\n end\n\n def facing\n  @facing = FACINGS[@facing_index]\n end\n\n def errors\n end\n\n private\n\n def facing_index(facing)\n  facing if facing.is_a? Integer\n  FACINGS.index(facing&amp;.to_sym)\n end\nend\n</code></pre>\n"}, {"tags": ["ruby", "redis", "zlib"], "answers": [{"comments": [{"owner": {"reputation": 612, "user_id": 1534613, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/00a51235367d75deed81061f0928438e?s=128&d=identicon&r=PG", "display_name": "barath", "link": "https://stackoverflow.com/users/1534613/barath"}, "edited": false, "score": 0, "creation_date": 1542413739, "post_id": 53288024, "comment_id": 93572811, "body": "<code>rpm -qa | grep zlib -&gt; zlib-1.2.7-17.el7.x86_64  zlib-devel-1.2.7-17.el7.x86_64</code>"}, {"owner": {"reputation": 612, "user_id": 1534613, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/00a51235367d75deed81061f0928438e?s=128&d=identicon&r=PG", "display_name": "barath", "link": "https://stackoverflow.com/users/1534613/barath"}, "edited": false, "score": 0, "creation_date": 1542414056, "post_id": 53288024, "comment_id": 93572882, "body": "zlib-devel exists."}, {"owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "reply_to_user": {"reputation": 612, "user_id": 1534613, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/00a51235367d75deed81061f0928438e?s=128&d=identicon&r=PG", "display_name": "barath", "link": "https://stackoverflow.com/users/1534613/barath"}, "edited": false, "score": 0, "creation_date": 1542559271, "post_id": 53288024, "comment_id": 93602914, "body": "@barath can you do a <code>gem install redis --verbose</code> and add the full output to your question?"}], "tags": [], "owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "is_accepted": false, "score": 1, "last_activity_date": 1542136881, "last_edit_date": 1542136881, "creation_date": 1542136469, "answer_id": 53288024, "question_id": 53287757, "link": "https://stackoverflow.com/questions/53287757/zlib-not-detected-by-gem-install-redis/53288024#53288024", "title": "zlib not detected by `gem install redis`", "body": "<p>I suspect you're missing the <code>devel</code> package for zlib. <code>rpm -qa | grep zlib</code> should produce output like the following:</p>\n\n<pre><code># rpm -qa | grep zlib\nzlib-devel-1.2.7-15.el7.x86_64\nzlib-1.2.7-15.el7.x86_64\n</code></pre>\n\n<p>You'll want to include <code>zlib-devel</code> and then try re-installing the redis gem. If this doesn't solve your issue, please include the output of <code>gem install redis --verbose</code> in your question.</p>\n"}], "owner": {"reputation": 612, "user_id": 1534613, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/00a51235367d75deed81061f0928438e?s=128&d=identicon&r=PG", "display_name": "barath", "link": "https://stackoverflow.com/users/1534613/barath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542136881, "creation_date": 1542135280, "question_id": 53287757, "link": "https://stackoverflow.com/questions/53287757/zlib-not-detected-by-gem-install-redis", "title": "zlib not detected by `gem install redis`", "body": "<p>Having issue with making gem install to detect zlib.</p>\n\n<p>I'm trying to install redis api for ruby. This needs zlib. Installed zlib through yum - <code>sudo yum install zlib</code>. Installation is successful (as below).</p>\n\n<pre><code>[~]$ sudo yum install zlib\nLoaded plugins: fastestmirror, langpacks, versionlock\nLoading mirror speeds from cached hostfile\n * base: server&gt;.com\n * epel: server&gt;.com\n * extras: &lt;server&gt;.com\n * hp: server&gt;.com\n * updates: server&gt;.com\nPackage zlib-1.2.7-17.el7.x86_64 already installed and latest version\nNothing to do\n</code></pre>\n\n<p>But, <code>gem install redis</code> couldn't detect zlib. I get below error when installing redis api.</p>\n\n<pre><code>[~]$ sudo gem install redis\nERROR:  Loading command: install (LoadError)\n    cannot load such file -- zlib\nERROR:  While executing gem ... (NoMethodError)\n    undefined method `invoke_with_build_args' for nil:NilClass\n</code></pre>\n\n<p><strong>Any reason why gem install couldn't detect the zlib?</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542167685, "post_id": 53288194, "comment_id": 93467153, "body": "still having the same issue"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542180525, "post_id": 53288194, "comment_id": 93470990, "body": "@MallelaSriPrakash above must work , please what error report you for above changes or controller action goes in processing."}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542184620, "post_id": 53288194, "comment_id": 93472753, "body": "I am still able to see save button for all the records. And upon saving the record, I get the following error:  ActionController::ParameterMissing in MetricsController#update param is missing or the value is empty: metric  Parameters:  {&quot;utf8&quot;=&gt;&quot;\u2713&quot;,  &quot;_method&quot;=&gt;&quot;patch&quot;,  &quot;authenticity_token&quot;=&gt;&quot;iF1pEruUPuX9uRSv5ubNpvBRXNOrbfcV+E9ia&zwnj;&#8203;dp7JmPYjIQpfV955E3Nx&zwnj;&#8203;3TMMtFvNLH2SUVUwcseZ&zwnj;&#8203;nsylbeuaw==&quot;,  &quot;metrics_controller&quot;=&gt;{&quot;IsValid&quot;=&gt;&quot;&quot;, &quot;Comments&quot;=&gt;&quot;Valid&quot;},  &quot;commit&quot;=&gt;&quot;Save&quot;,  &quot;id&quot;=&gt;&quot;Metric1&quot;}"}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542193971, "post_id": 53288194, "comment_id": 93478473, "body": "Able to sort it out. I was iterating on all the records instead of a specific record. Updated the code to show the data only for a single record and the issue is now resolved."}], "tags": [], "owner": {"reputation": 2492, "user_id": 5085788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bWlXI.jpg?s=128&g=1", "display_name": "luisenrike", "link": "https://stackoverflow.com/users/5085788/luisenrike"}, "is_accepted": false, "score": 1, "last_activity_date": 1542137221, "creation_date": 1542137221, "answer_id": 53288194, "question_id": 53287654, "link": "https://stackoverflow.com/questions/53287654/how-to-show-edit-button-only-for-a-record-and-save-data-to-database-from-edit-fo/53288194#53288194", "title": "How to show edit button only for a record and save data to database from edit form in rails", "body": "<p>You need to have a <code>form</code> for each <code>metric</code>:</p>\n\n<pre><code>&lt;table id=\"metrics\"&gt;\n  &lt;thead&gt;\n  &lt;tr id=\"AllMetricColumnNames\"&gt;\n    &lt;th id=\"Metric\"&gt;&lt;div&gt;Metric&lt;/th&gt;\n    &lt;th id=\"WI\"&gt;WI&lt;/th&gt;\n    &lt;th id=\"Value\"&gt;Value&lt;/th&gt;\n    &lt;th id=\"UT\"&gt;UT&lt;/th&gt;\n    &lt;th id=\"Score\"&gt;Score&lt;/th&gt;\n    &lt;th id=\"IsValid\"&gt;IsValid&lt;/th&gt;\n    &lt;th id=\"UserName\"&gt;UserName&lt;/th&gt;\n    &lt;th id=\"Comments\"&gt;Comments&lt;/th&gt;\n    &lt;th id=\"EditColumn\"&gt;Edit&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;/thead&gt;\n  &lt;% @metricAll.each do |data| %&gt;\n    &lt;%= form_for :metrics_controller, url: metric_path(data), method: :patch do |f| %&gt;\n      &lt;tr id=\"AllMetricValues\"&gt;\n        &lt;td id=\"Value\"&gt;&lt;%= data.Metric %&gt;&lt;/td&gt;\n        &lt;td id=\"WI\"&gt;&lt;%= data.WI %&gt;&lt;/td&gt;\n        &lt;td id=\"Value\"&gt;&lt;%= data.Value %&gt;&lt;/td&gt;\n        &lt;td id=\"UT\"&gt;&lt;%= data.UT %&gt;&lt;/td&gt;\n        &lt;td id=\"Score\"&gt;&lt;%= data.Score %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= f.select :IsValid, options_for_select(['True', 'False']), :include_blank =&gt; true, :class =&gt; 'chosen-select', :required =&gt; true, value: data.IsValid  %&gt;&lt;/td&gt;\n        &lt;td id=\"UserName\"&gt;&lt;%= data.UserName %&gt;&lt;/td&gt;\n        &lt;td id=\"Comments\"&gt;&lt;%= f.text_field :Comments, value: data.Comments %&gt;&lt;/td&gt;\n        &lt;td id=\"SaveButton\"&gt;&lt;%= f.submit \"Save\" %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542137221, "creation_date": 1542134852, "question_id": 53287654, "link": "https://stackoverflow.com/questions/53287654/how-to-show-edit-button-only-for-a-record-and-save-data-to-database-from-edit-fo", "title": "How to show edit button only for a record and save data to database from edit form in rails", "body": "<p>I am displaying all the records from db in the form of HTML table along with edit button. On, click of edit button it redirects to edit view which will display the additional columns.</p>\n\n<p>Here, I was showing save button in edit form for all the rows/records. Is there a way to prevent so that I can just show to the one I selected in index form.</p>\n\n<p>Also, after updating the fields how do I save the record and redirect to index view.</p>\n\n<p>Please find the code snippets below:</p>\n\n<p><strong>metrics_controller.rb:</strong></p>\n\n<pre><code>class MetricsController &lt; ApplicationController\n  def index\n    @metricAll = Metric.all\n  end\n\n  def show\n    @metric = Metric.find(params[:id])\n  end\n\n  def edit\n    @metric = Metric.find(params[:id])\n    @metricAll = Metric.all\n  end\n\n  def create\n    @metric = Metric.new(post_params)\n    if(@metric.save)\n      redirect_to @metric\n    else\n      render 'new'\n    end\n  end\n\n  def update\n    @metric = Metric.find(params[:id])\n    if(@metric.update_attributes(post_params))\n      redirect_to @metric\n    else\n      render 'edit'\n    end\n  end\n\n  private def post_params\n    params.require(:metric).permit(:Metric, :WI, :Value, :UT, :Score, :IsValid, :UserName, :Comments)\n  end\nend\n</code></pre>\n\n<p><strong>edit.html.rb:</strong></p>\n\n<pre><code>&lt;%= form_for :metrics_controller, url: metric_path(@metric), method: :patch do |f| %&gt;\n  &lt;table id=\"metrics\"&gt;\n    &lt;thead&gt;\n    &lt;tr id=\"AllMetricColumnNames\"&gt;\n      &lt;th id=\"Metric\"&gt;&lt;div&gt;Metric&lt;/th&gt;\n      &lt;th id=\"WI\"&gt;WI&lt;/th&gt;\n      &lt;th id=\"Value\"&gt;Value&lt;/th&gt;\n      &lt;th id=\"UT\"&gt;UT&lt;/th&gt;\n      &lt;th id=\"Score\"&gt;Score&lt;/th&gt;\n      &lt;th id=\"IsValid\"&gt;IsValid&lt;/th&gt;\n      &lt;th id=\"UserName\"&gt;UserName&lt;/th&gt;\n      &lt;th id=\"Comments\"&gt;Comments&lt;/th&gt;\n      &lt;th id=\"EditColumn\"&gt;Edit&lt;/th&gt;\n    &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;% @metricAll.each do |data| %&gt;\n      &lt;tr id=\"AllMetricValues\"&gt;\n        &lt;td id=\"Value\"&gt;&lt;%= data.Metric %&gt;&lt;/td&gt;\n        &lt;td id=\"WI\"&gt;&lt;%= data.WI %&gt;&lt;/td&gt;\n        &lt;td id=\"Value\"&gt;&lt;%= data.Value %&gt;&lt;/td&gt;\n        &lt;td id=\"UT\"&gt;&lt;%= data.UT %&gt;&lt;/td&gt;\n        &lt;td id=\"Score\"&gt;&lt;%= data.Score %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= f.select :IsValid, options_for_select(['True', 'False']), :include_blank =&gt; true, :class =&gt; 'chosen-select', :required =&gt; true, value: data.IsValid  %&gt;&lt;/td&gt;\n        &lt;td id=\"UserName\"&gt;&lt;%= data.UserName %&gt;&lt;/td&gt;\n        &lt;td id=\"Comments\"&gt;&lt;%= f.text_field :Comments, value: data.Comments %&gt;&lt;/td&gt;\n        &lt;td id=\"SaveButton\"&gt;&lt;%= f.submit \"Save\" %&gt;&lt;/td&gt;\n    &lt;% end %&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Screenshot:</strong>\n<a href=\"https://i.stack.imgur.com/UQH93.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UQH93.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["javascript", "ruby", "html"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 8067836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIY38.jpg?s=128&g=1", "display_name": "Andrea Baz&#225;n", "link": "https://stackoverflow.com/users/8067836/andrea-baz%c3%a1n"}, "is_accepted": false, "score": 0, "last_activity_date": 1542131740, "creation_date": 1542131740, "answer_id": 53286910, "question_id": 53286314, "link": "https://stackoverflow.com/questions/53286314/adding-filter-search-inside-of-a-form-so-it-can-post-data/53286910#53286910", "title": "adding filter search inside of a form so it can post data", "body": "<p>Im learning too, but this is how I implemented a search bar into my navbar. maybe helps. This code is a partial html.erb that I render into my navbar.html.</p>\n\n<pre><code>&lt;div class=\"advanced_search_container\"&gt;\n&lt;div class=\"input-group\" id=\"adv-search\"&gt;\n  &lt;%= form_tag(dresses_path, {class: 'search form-inline my-2 my-lg-0', method: 'get'}) do %&gt;\n    &lt;%= text_field_tag :search, '', class: \" mr-sm-2\", placeholder: \"Find The Dress\" %&gt;\n    &lt;%= select_tag :size, options_for_select(Dress::SIZES), :prompt =&gt; \"size\", class: \"select\", style: \"border-bottom:0px solid !important; margin-left:5px;width: 70px;\"%&gt;\n    &lt;%= select_tag :category, options_for_select(Dress::CATEGORIES), :prompt =&gt; \"category\" , class: \"select\", style: \"border-bottom:0px solid !important; margin-left:5px;width: 70px;\" %&gt;\n    &lt;%= submit_tag 'Search', class: \" search btn btn-outline-success my-2 my-sm-0 \"%&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n"}], "owner": {"reputation": 73, "user_id": 5785905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd01dc6dd5786a658bba043310d8f57?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/5785905/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542131740, "creation_date": 1542129226, "last_edit_date": 1542131381, "question_id": 53286314, "link": "https://stackoverflow.com/questions/53286314/adding-filter-search-inside-of-a-form-so-it-can-post-data", "title": "adding filter search inside of a form so it can post data", "body": "<p>I am currently learning ruby and am trying to add a filter/search bar like this one <a href=\"https://www.w3schools.com/howto/howto_js_filter_lists.asp\" rel=\"nofollow noreferrer\">https://www.w3schools.com/howto/howto_js_filter_lists.asp</a>. Inside of a form. so in theory I could get one of the params from the filter search and other params from user input. </p>\n\n<pre><code>&lt;h1&gt;Add a new coin to your Coinfolio&lt;/h1&gt;\n&lt;form id = \"post-form\" method = \"post\" action = \"/coins\"&gt;\n\n\n&lt;input type=\"text\" id=\"coin-search-bar\" onkeyup=\"myFunction()\" placeholder=\"Search for coins..\"&gt;\n\n&lt;ul id=\"available-coin-list\"&gt;\n  &lt;% @available_coins.each_with_index do |coin, index| %&gt;\n  &lt;li&gt;\n    &lt;a&gt;\n      &lt;%= coin.name %&gt;  price = $ &lt;%= coin.current_price  %&gt;\n      &lt;input type = \"text\" name = \"price_paid\" placeholder=\"price paid:\"/&gt;\n      &lt;input type = \"hidden\" name = \"coin_id\" value = \"&lt;%= coin.id %&gt;\"&gt;\n      &lt;input type = \"submit\"&gt;\n    &lt;/a&gt;\n  &lt;/li&gt;\n\n  &lt;% end %&gt;\n&lt;/ul&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>this is what I have so far however im not getting any values in the params hash who clicking submit. also would rather be able to have only one search button and input field. Any ideas how i can accomplish this.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93, "user_id": 8067836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIY38.jpg?s=128&g=1", "display_name": "Andrea Baz&#225;n", "link": "https://stackoverflow.com/users/8067836/andrea-baz%c3%a1n"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542129409, "post_id": 53285855, "comment_id": 93454673, "body": "oh Im kinda new here I thought that I should select one if works but yea you are right! :)"}, {"owner": {"reputation": 93, "user_id": 8067836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIY38.jpg?s=128&g=1", "display_name": "Andrea Baz&#225;n", "link": "https://stackoverflow.com/users/8067836/andrea-baz%c3%a1n"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542130542, "post_id": 53285855, "comment_id": 93455288, "body": "Got it! was because my whole platform is building in Rails but yea, this part is just Ruby."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1542139503, "post_id": 53285855, "comment_id": 93459332, "body": "This is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}], "answers": [{"comments": [{"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1542129088, "post_id": 53286117, "comment_id": 93454490, "body": "Just wanted to answer it this way, and refreshed to see answers xD"}, {"owner": {"reputation": 93, "user_id": 8067836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIY38.jpg?s=128&g=1", "display_name": "Andrea Baz&#225;n", "link": "https://stackoverflow.com/users/8067836/andrea-baz%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1542129205, "post_id": 53286117, "comment_id": 93454556, "body": "Yea. Its is because I need to change position according to facing and assigns no errors if it moves succesfully."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 5, "last_activity_date": 1542128616, "creation_date": 1542128616, "answer_id": 53286117, "question_id": 53285855, "link": "https://stackoverflow.com/questions/53285855/change-the-facing-with-a-turn-left-method-in-ruby/53286117#53286117", "title": "Change the facing with a turn_left method in Ruby", "body": "<p>How about something like this:</p>\n\n<pre><code>class Robot\n  FACINGS = [:south, :east, :north, :west]\n\n  def initialize(attr = {})\n    @facing_index = 0 # south\n  end\n\n  def facing\n    FACINGS[@facing_index]\n  end\n\n  def turn_left\n    @facing_index += 1\n    @facing_index %= 4\n  end\n\n  def turn_right\n    @facing_index -= 1\n    @facing_index %= 4\n  end\nend\n</code></pre>\n\n<p>The <code>%= 4</code> (or, if you really want to generalise this further, <code>%= FACINGS.length</code>) performs modulo arithmetic to \"wrap\" the current index back into the range 0-3.</p>\n\n<p>Therefore by incrementing/decrementing this number, you can toggle between the four directions.</p>\n\n<hr>\n\n<p>I don't know how you intent to implement <code>position</code>, <code>move</code> and <code>errors</code>, but I presume that's beyond the scope of your question.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542136927, "post_id": 53286219, "comment_id": 93458208, "body": "As you know, and probably considered, an alternative is <code>@right = [:N, :E, :S, :W].cycle; def turn_right; @facing = @right.next; end; def turn_left; 3.times { turn_right }; end; attr_reader :facing</code>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542182049, "post_id": 53286219, "comment_id": 93471578, "body": "@CarySwoveland if only there were &quot;two-way&quot; enumerators with both, <code>next</code> and <code>prev</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542183952, "post_id": 53286219, "comment_id": 93472434, "body": "Yes, that would be handy."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 4, "last_activity_date": 1542129022, "last_edit_date": 1542129022, "creation_date": 1542128907, "answer_id": 53286219, "question_id": 53285855, "link": "https://stackoverflow.com/questions/53285855/change-the-facing-with-a-turn-left-method-in-ruby/53286219#53286219", "title": "Change the facing with a turn_left method in Ruby", "body": "<p>You could store the directions in an array:</p>\n\n<pre><code>def initialize\n  @dirs = [:S, :W, :N, :E]\nend\n</code></pre>\n\n<p>With the <a href=\"http://ruby-doc.org/core-2.5.3/Array.html#method-i-first\" rel=\"nofollow noreferrer\"><code>first</code></a> entry being the facing direction:</p>\n\n<pre><code>def facing\n  @dirs.first\nend\n</code></pre>\n\n<p>When the robot turns left, you <a href=\"http://ruby-doc.org/core-2.5.3/Array.html#method-i-rotate-21\" rel=\"nofollow noreferrer\"><code>rotate!</code></a> the array counter clockwise:</p>\n\n<pre><code>def turn_left\n  @dirs.rotate! -1\nend\n</code></pre>\n\n<p>Or clockwise when turning right: (the <code>1</code> could be omitted here)</p>\n\n<pre><code>def turn_right\n  @dirs.rotate! 1\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1542129896, "post_id": 53286310, "comment_id": 93454959, "body": "For this use case, I like the &quot;old&quot; <code>:n=&gt;:w</code> syntax much more ;-)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1542130323, "post_id": 53286310, "comment_id": 93455184, "body": "Your wish is my command, @Stefan. I agree. (Readers: I formerly had <code>n: :w</code>, etc.)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542130760, "post_id": 53286310, "comment_id": 93455386, "body": "A downside to this approach is that it&#39;s quite limited to one action (&quot;turn left&quot;) and its inverse (&quot;turn right&quot;). Implementing something else, like &quot;turn around&quot; or turn by a different amount (if there were more than 4 directions) breaks the otherwise quite elegant design pattern."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542130860, "post_id": 53286310, "comment_id": 93455417, "body": "I mean, of course you can still achieve it - e.g. <code>left[left[pos]]</code> to turn around. It just loses its elegance."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542135375, "post_id": 53286310, "comment_id": 93457484, "body": "@Tom, that&#39;s true, but we could also define <code>turn_around = { :n=&gt;:s, :s=&gt;:n, :e=&gt;:w, :w=&gt;:e }</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542140205, "post_id": 53286310, "comment_id": 93459641, "body": "Yes, you could - but that&#39;s not very DRY. And the problem would become more apparent, as i said, if there were more than 4 directions. (NW, SW, SE, NE?)"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 4, "last_activity_date": 1542130298, "last_edit_date": 1542130298, "creation_date": 1542129212, "answer_id": 53286310, "question_id": 53285855, "link": "https://stackoverflow.com/questions/53285855/change-the-facing-with-a-turn-left-method-in-ruby/53286310#53286310", "title": "Change the facing with a turn_left method in Ruby", "body": "<pre><code>left = {:n=&gt;:w, :w=&gt;:s, :s=&gt;:e, :e=&gt;:n}\nright = left.invert\n  #=&gt; {:w=&gt;:n, :s=&gt;:w, :e=&gt;:s, :n=&gt;:e}\n\npos = :s\n\npos = left[pos]\n  #=&gt; :e\npos = right[pos]\n  #=&gt; :w\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542140786, "post_id": 53286951, "comment_id": 93459858, "body": "<code>rotate!</code> can just be <code>self.facing = (self.facing + degrees) % 360</code>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1542144700, "post_id": 53286951, "comment_id": 93461336, "body": "Thanks @engineersmnky, I knew there had to be a smarter way using modulus."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 2, "last_activity_date": 1542144706, "last_edit_date": 1542144706, "creation_date": 1542131951, "answer_id": 53286951, "question_id": 53285855, "link": "https://stackoverflow.com/questions/53285855/change-the-facing-with-a-turn-left-method-in-ruby/53286951#53286951", "title": "Change the facing with a turn_left method in Ruby", "body": "<p>I would go with degrees instead of an enumeration. That way you can manipulate the facing by adding/subtracting <em>n</em> degrees from the current facing.</p>\n\n<pre><code>class Robot\n  attr_accessor :facing\n\n  def initialize(**attrs)\n    self.facing = attrs[:facing] || 180 # south\n  end\n\n  def rotate!(degrees)\n    self.facing = (self.facing + degrees) % 360\n  end\n\n  def rotate_left!\n    rotate!(-90)\n  end\n\n  def rotate_right!\n    rotate!(90)\n  end\nend\n</code></pre>\n\n<p>You can then use a relatively simple method to convert degrees to cardinal (compass points):</p>\n\n<pre><code>class Robot\n  COMPASS_POINTS = %w[N E S W]\n\n  # ...\n\n  def compass_point\n    seg_size = 360 / COMPASS_POINTS.size\n    COMPASS_POINTS[((facing + (seg_size / 2)) % 360) / seg_size]\n  end\nend\n</code></pre>\n\n<p>This one is taken from the <a href=\"https://github.com/alexreisner/geocoder/blob/22051b907e3b6f18d5c9c82011aa080b890cd03d/lib/geocoder/calculations.rb\" rel=\"nofollow noreferrer\">geocoder gem</a>.</p>\n\n<p>This might seem a bit more complicated but lets you store executed commands as <code>rotate: 90</code> or <code>rotate: -90</code> if you want to keep track of it. It also lets you rotate the robot a full (stepless) 360 degrees if wanted.</p>\n"}], "owner": {"reputation": 93, "user_id": 8067836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIY38.jpg?s=128&g=1", "display_name": "Andrea Baz&#225;n", "link": "https://stackoverflow.com/users/8067836/andrea-baz%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 53286117, "answer_count": 4, "score": 3, "last_activity_date": 1542144706, "creation_date": 1542127802, "last_edit_date": 1542130499, "question_id": 53285855, "link": "https://stackoverflow.com/questions/53285855/change-the-facing-with-a-turn-left-method-in-ruby", "title": "Change the facing with a turn_left method in Ruby", "body": "<p>I need to create a method turn_left who changes the facing, facing always start in :south (Im implementing a robot who moves into a board) so if i call method turn_left should change the facing to East and then to North and to West and then return to south. Im thinking in something like this:</p>\n\n<pre><code>    {\n     0: S\n     1: E\n     2: N\n     3: W\n    }\n</code></pre>\n\n<p>this is my code</p>\n\n<pre><code># Models the Robor behavior for the game\nclass Robot\n\n def initialize(attr = {})\n # @position = attr[:position]\n # @move = attr[:move]\n   @facing = :south\n # @turn_left =\n # @turn_right =\n # @errors =\n end\n\n def position\n end\n\n def move\n end\n\n def facing\n  @facing\n end\n\n def turn_left\n\n end\n\n def turn_right\n end\n\n def errors\n end\nend\n</code></pre>\n\n<p>Thank you so much!!!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1325, "user_id": 10431118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cEMkN.jpg?s=128&g=1", "display_name": "pvy4917", "link": "https://stackoverflow.com/users/10431118/pvy4917"}, "edited": false, "score": 0, "creation_date": 1542126775, "post_id": 53285277, "comment_id": 93453009, "body": "<a href=\"https://ryanbigg.com/2011/01/why-you-should-run-bundle-update\" rel=\"nofollow noreferrer\">ryanbigg.com/2011/01/why-you-should-run-bundle-update</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1542127716, "post_id": 53285277, "comment_id": 93453616, "body": "Sure downgrade <code>rails</code> to a version supported by <code>trix</code> or remove <code>trix</code>. The error is telling you the exact problem, which is you want <code>rails</code> version &gt;= 5.2.1 but <code>trix</code> only works with <code>rails</code> &gt; 4.1 and &lt; 5.2. So this cannot work since <code>rails</code> cannot be greater than <code>5.2</code> and also less than <code>5.2</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 1325, "user_id": 10431118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cEMkN.jpg?s=128&g=1", "display_name": "pvy4917", "link": "https://stackoverflow.com/users/10431118/pvy4917"}, "edited": false, "score": 0, "creation_date": 1542128156, "post_id": 53285277, "comment_id": 93453901, "body": "@karma4917 that does not really help since the issue is <code>trix</code> and the latest version is <code>0.11.1</code> so this would be left alone by bundle update while bundler would try and load some <code>5.2.x</code> version of <code>rails</code> and the error would still occur"}, {"owner": {"reputation": 1325, "user_id": 10431118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cEMkN.jpg?s=128&g=1", "display_name": "pvy4917", "link": "https://stackoverflow.com/users/10431118/pvy4917"}, "edited": false, "score": 0, "creation_date": 1542128222, "post_id": 53285277, "comment_id": 93453944, "body": "Thanks for your feedback."}], "owner": {"reputation": 33, "user_id": 10123016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb6617d0696c4725fad370e5f70d345?s=128&d=identicon&r=PG&f=1", "display_name": "slope", "link": "https://stackoverflow.com/users/10123016/slope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 426, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1542126105, "creation_date": 1542126105, "question_id": 53285277, "link": "https://stackoverflow.com/questions/53285277/gem-error-bundler-could-not-find-compatible-versions-for-gem-rails", "title": "GEM ERROR - Bundler could not find compatible versions for gem &quot;rails&quot; -", "body": "<p>Getting a funky error when trying to run my Rails server. </p>\n\n<pre><code>Bundler could not find compatible versions for gem \"rails\":\n  In Gemfile:\n    rails (~&gt; 5.2, &gt;= 5.2.1)\n\n    trix (~&gt; 0.11.1) was resolved to 0.11.1, which depends on\n      rails (&gt; 4.1, &lt; 5.2)\n</code></pre>\n\n<p>I tried checking if it was an issue with the version in my Gemfile and make sure it's the latest, but this didn't help. Also tried installing trix by itself, and updating my version of Ruby, but no luck. Any tips on how to move from here? </p>\n\n<p>This is my Gemfile: </p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.5.1'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.2', '&gt;= 5.2.1'\n# Use sqlite3 as the database for Active Record\ngem 'sqlite3'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.11'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'mini_racer', platforms: :ruby\n\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.2'\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 4.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use ActiveStorage variant\n# gem 'mini_magick', '~&gt; 4.8'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\n# Reduces boot times through caching; required in config/boot.rb\ngem 'bootsnap', '&gt;= 1.1.0', require: false\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\nend\n\ngroup :development do\n  # Access an interactive console on exception pages or by calling 'console' anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\ngroup :test do\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '&gt;= 2.15'\n  gem 'selenium-webdriver'\n  # Easy installation and use of chromedriver to run system tests with Chrome\n  gem 'chromedriver-helper'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n\ngem 'devise'\ngem 'bulma-rails'\ngem 'simple_form'\ngem 'sidekiq'\ngem 'carrierwave', '~&gt; 1.0'\ngem 'mini_magick', '~&gt; 4.8'\ngem 'stripe', '~&gt; 3.11'\ngem 'trix', '~&gt; 0.11.1'\ngroup :development, :test do\n  gem 'better_errors'\n  gem 'guard'\n  gem 'guard-livereload'\nend\n</code></pre>\n\n<p>Appreciate any help. Thanks! </p>\n"}, {"tags": ["ruby", "api", "http", "timeout"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1542132086, "post_id": 53285264, "comment_id": 93455988, "body": "How long does it actually take to query and receive all data from the API? Did you check that?"}, {"owner": {"reputation": 63, "user_id": 7143750, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207256876247285/picture?type=large", "display_name": "Dorian Gaensslen", "link": "https://stackoverflow.com/users/7143750/dorian-gaensslen"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1542180271, "post_id": 53285264, "comment_id": 93470894, "body": "It takes around 10 minutes. But with 15 minutes my setting should be safe."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1542188124, "post_id": 53285264, "comment_id": 93474805, "body": "When do you get the timeout? After around 15 minutes or earlier \u2013 for example after 90 seconds?"}, {"owner": {"reputation": 63, "user_id": 7143750, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207256876247285/picture?type=large", "display_name": "Dorian Gaensslen", "link": "https://stackoverflow.com/users/7143750/dorian-gaensslen"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543410739, "post_id": 53285264, "comment_id": 93909085, "body": "@spickermann I underestimated the duration. The script takes almost 16 minutes. after I&#39;ve observed that, I altered the timeout again to 30 Minutes. I don&#39;t get the error anymore, but now the next <i>each</i> statement fails 18 Minutes after start, because it has no return values <i>undefined method `each_value&#39; for nil:NilClass (NoMethodError)</i>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543410915, "post_id": 53285264, "comment_id": 93909201, "body": "There is no <code>each_value</code> in your question. You will need to add the relevant code to your question. What do you want to do your application instead when it runs into the timeout? Do nothing? Raise an error? Use a fallback?"}], "owner": {"reputation": 63, "user_id": 7143750, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207256876247285/picture?type=large", "display_name": "Dorian Gaensslen", "link": "https://stackoverflow.com/users/7143750/dorian-gaensslen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542126088, "creation_date": 1542126088, "question_id": 53285264, "link": "https://stackoverflow.com/questions/53285264/ruby-hitting-read-timeout-even-when-changed", "title": "Ruby: hitting read_timeout even when changed", "body": "<p>From my Ruby code il make a call to a API.\nOn the testsystem with few data it works without a flaw. \nOn the Productive System it works too, but only if not much data is transmitted. If its too much data il get: </p>\n\n<blockquote>\n  <p>/usr/lib/ruby/2.3.0/net/protocol.rb:158:in <code>rbuf_fill': Net::ReadTimeout (Net::ReadTimeout)\n      from /usr/lib/ruby/2.3.0/net/protocol.rb:136:in</code>readuntil'\n      from /usr/lib/ruby/2.3.0/net/protocol.rb:146:in <code>readline'\n      from /usr/lib/ruby/2.3.0/net/http/response.rb:40:in</code>read_status_line'\n      from /usr/lib/ruby/2.3.0/net/http/response.rb:29:in <code>read_new'\n      from /usr/lib/ruby/2.3.0/net/http.rb:1437:in</code>block in transport_request'\n      from /usr/lib/ruby/2.3.0/net/http.rb:1434:in <code>catch'\n      from /usr/lib/ruby/2.3.0/net/http.rb:1434:in</code>transport_request'\n      from /usr/lib/ruby/2.3.0/net/http.rb:1407:in `request'</p>\n</blockquote>\n\n<p>the relevant part in the code seems to be:</p>\n\n<pre><code>http = Net::HTTP.start(uri.host, uri.port, :use_ssl =&gt; uri.scheme == 'https', :verify_mode =&gt; OpenSSL::SSL::VERIFY_NONE, :read_timeout =&gt; @timeout)\n</code></pre>\n\n<p>i bumped the <strong>@timeout</strong> to 900 and id didnt work eater.</p>\n\n<p>Any ideas how i can get that to work or how i can debug that issue?</p>\n"}, {"tags": ["ruby", "rspec", "carrierwave", "factory-bot"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1542131739, "post_id": 53285233, "comment_id": 93455808, "body": "Where exactly does that error occur? Please provide the command you ran and the error message including the stacktrace."}, {"owner": {"reputation": 31, "user_id": 10574191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b689ee65aa5c5cb4c0da0e9a849d3b?s=128&d=identicon&r=PG&f=1", "display_name": "JackFurby", "link": "https://stackoverflow.com/users/10574191/jackfurby"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1542188017, "post_id": 53285233, "comment_id": 93474744, "body": "The command I ran was <code>rspec</code>. This called on a rake file which is included above. The point that error occurred was <code>company.save!</code>. I have added the stacktrace above"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10574191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b689ee65aa5c5cb4c0da0e9a849d3b?s=128&d=identicon&r=PG&f=1", "display_name": "JackFurby", "link": "https://stackoverflow.com/users/10574191/jackfurby"}, "edited": false, "score": 0, "creation_date": 1542129436, "post_id": 53285298, "comment_id": 93454688, "body": "Thank you for replying. Unfortunately, I think this will not work in my situation (I tried it and it just caused the same error when creating the company). One requirement in the model is for a logo to be present. If there is no fix I have tried to remove this requirement which words but ideally fixing the issue is preferred."}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1542126175, "creation_date": 1542126175, "answer_id": 53285298, "question_id": 53285233, "link": "https://stackoverflow.com/questions/53285233/validation-failed-logo-cant-be-blank-when-logo-uploaded-using-rspec/53285298#53285298", "title": "Validation failed: Logo can&#39;t be blank when logo uploaded using rspec", "body": "<p><a href=\"https://stackoverflow.com/questions/47583883/how-to-properly-do-model-testing-with-activestorage-in-rails\">How to properly do model testing with ActiveStorage in rails?</a></p>\n\n<p>Using the info from there and adapting to your specifics, try the following factory:</p>\n\n<p><code>FactoryBot.define do\n  factory :company do\n    name { 'Name' }\n    b_day { Date.today }\n    age { 1 }\n    after(:build) do |company|\n      company.logo.attach(io: File.open(Rails.root.join('spec', 'support', 'logo.jpeg')), filename: 'logo.jpeg', content_type: 'image/jpeg')\n    end\n  end\nend</code></p>\n\n<p>EDIT:</p>\n\n<p>You may also need to add this to your config/environments/test.rb file:</p>\n\n<p><code>config.active_storage.service = :test</code></p>\n"}], "owner": {"reputation": 31, "user_id": 10574191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b689ee65aa5c5cb4c0da0e9a849d3b?s=128&d=identicon&r=PG&f=1", "display_name": "JackFurby", "link": "https://stackoverflow.com/users/10574191/jackfurby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1542188247, "creation_date": 1542125991, "last_edit_date": 1542188247, "question_id": 53285233, "link": "https://stackoverflow.com/questions/53285233/validation-failed-logo-cant-be-blank-when-logo-uploaded-using-rspec", "title": "Validation failed: Logo can&#39;t be blank when logo uploaded using rspec", "body": "<p>I am creating automated tests for my rails app using rspec and factoryBot. In my case I am creating a company with a requirement of having a logo. Creating a company in the test is not a problem but if I try and modify the company outside of the test file I am getting an error message of </p>\n\n<pre><code>ActiveRecord::RecordInvalid:\n   Validation failed: Logo can't be blank\n</code></pre>\n\n<p>I have tried alternative upload methods but with no luck. Below is the factory for the company and the process I am using to create a company. This is not the exact code in my implementation as I am unable to share that but I have replicated it as much as I could.</p>\n\n<p>If I manually test the code it works fine. It is only when running the code with rspec the error occurs.</p>\n\n<p>factories.rb</p>\n\n<pre><code>FactoryBot.define do\n  factory :company do\n    name { 'Name' }\n    b_day { Date.today }\n    age { 1 }\n    logo { Rack::Test::UploadedFile.new(File.open(File.join(Rails.root, '/spec/support/logo.png')), 'image/png') }\n  end\nend\n</code></pre>\n\n<p>companies_rake_spec.rb</p>\n\n<pre><code>describe \"Company b_day today\" do\n  it \"Add 1 to company age\" do\n    company1 = create(:company)\n    Rake::Task['companies:update_age'].invoke\n\n    company1_refresh = Company.where(id: company1.id).first\n    expect(company1_refresh.age).to eq(company1.age + 1)\n  end\nend\n</code></pre>\n\n<p>company.rake</p>\n\n<pre><code>namespace :companies do\n  desc \"TODO\"\n    task update_age: :environment do\n       Company.find_each do | company |\n          if (company.b_day.day == Date.today.day) &amp;&amp; (company.b_day.month == Date.today.month)\n            company.age += 1\n            puts company.inspect\n            company.save!\n          end\n       end\n    end\n  end\nend\n</code></pre>\n\n<p>console</p>\n\n<pre><code>#&lt;Company id: 34, name: \"Name\", b_day: 2018-11-13, age: 2, logo: \"1cbeef36f13a8a88db0c37fa30da6ffd.png\"&gt;\n\nActiveRecord::RecordInvalid:\n   Validation failed: Logo can't be blank\n</code></pre>\n\n<p>stacktrace </p>\n\n<pre><code>Failures:\n\n1) companies:update_age age + 1\n Failure/Error: company.save!\n\n ActiveRecord::RecordInvalid:\n   Validation failed: Logo can't be blank\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/validations.rb:78:in `raise_validation_error'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/validations.rb:50:in `save!'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/attribute_methods/dirty.rb:30:in `save!'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/transactions.rb:324:in `block in save!'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/transactions.rb:395:in `block in with_transaction_returning_status'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/connection_adapters/abstract/database_statements.rb:232:in `block in transaction'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/connection_adapters/abstract/transaction.rb:189:in `within_new_transaction'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/connection_adapters/abstract/database_statements.rb:232:in `transaction'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/transactions.rb:211:in `transaction'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/transactions.rb:392:in `with_transaction_returning_status'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/transactions.rb:324:in `save!'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/suppressor.rb:45:in `save!'\n # ./lib/tasks/companies.rake:54:in `block (3 levels) in &lt;top (required)&gt;'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/relation/batches.rb:59:in `block (2 levels) in find_each'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/relation/batches.rb:59:in `each'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/relation/batches.rb:59:in `block in find_each'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/relation/batches.rb:121:in `block in find_in_batches'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/relation/batches.rb:214:in `block in in_batches'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/relation/batches.rb:198:in `loop'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/relation/batches.rb:198:in `in_batches'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/relation/batches.rb:120:in `find_in_batches'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/relation/batches.rb:58:in `find_each'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/activerecord-5.0.7/lib/active_record/querying.rb:9:in `find_each'\n # ./lib/tasks/companies.rake:8:in `block (2 levels) in &lt;top (required)&gt;'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rake-12.3.1/lib/rake/task.rb:271:in `block in execute'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rake-12.3.1/lib/rake/task.rb:271:in `each'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rake-12.3.1/lib/rake/task.rb:271:in `execute'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rake-12.3.1/lib/rake/task.rb:213:in `block in invoke_with_call_chain'\n # /Users/mac/.rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/monitor.rb:226:in `mon_synchronize'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rake-12.3.1/lib/rake/task.rb:193:in `invoke_with_call_chain'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rake-12.3.1/lib/rake/task.rb:182:in `invoke'\n # ./spec/lib/tasks/companies_rake_spec.rb:122:in `block (3 levels) in &lt;top (required)&gt;'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:254:in `instance_exec'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:254:in `block in run'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:500:in `block in with_around_and_singleton_context_hooks'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:457:in `block in with_around_example_hooks'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:464:in `block in run'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:604:in `block in run_around_example_hooks_for'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:342:in `call'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-rails-3.8.0/lib/rspec/rails/adapters.rb:127:in `block (2 levels) in &lt;module:MinitestLifecycleAdapter&gt;'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:447:in `instance_exec'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:447:in `instance_exec'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:373:in `execute_with'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:606:in `block (2 levels) in run_around_example_hooks_for'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:342:in `call'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:607:in `run_around_example_hooks_for'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:464:in `run'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:457:in `with_around_example_hooks'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:500:in `with_around_and_singleton_context_hooks'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:251:in `run'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:629:in `block in run_examples'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:625:in `map'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:625:in `run_examples'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:591:in `run'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:592:in `block in run'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:592:in `map'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:592:in `run'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:116:in `block (3 levels) in run_specs'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:116:in `map'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:116:in `block (2 levels) in run_specs'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/configuration.rb:1989:in `with_suite_hooks'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:111:in `block in run_specs'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/reporter.rb:74:in `report'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:110:in `run_specs'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:87:in `run'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:71:in `run'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:45:in `invoke'\n # /Users/mac/.rvm/gems/ruby-2.5.1/gems/rspec-core-3.8.0/exe/rspec:4:in `&lt;top (required)&gt;'\n # /Users/mac/.rvm/gems/ruby-2.5.1/bin/rspec:23:in `load'\n # /Users/mac/.rvm/gems/ruby-2.5.1/bin/rspec:23:in `&lt;main&gt;'\n # /Users/mac/.rvm/gems/ruby-2.5.1/bin/ruby_executable_hooks:15:in `eval'\n # /Users/mac/.rvm/gems/ruby-2.5.1/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["html", "ruby", "pagination", "blogs", "middleman"], "comments": [{"owner": {"reputation": 2917, "user_id": 187519, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nzv7O.jpg?s=128&g=1", "display_name": "Hassan Voyeau", "link": "https://stackoverflow.com/users/187519/hassan-voyeau"}, "edited": false, "score": 0, "creation_date": 1547054051, "post_id": 53284568, "comment_id": 95063210, "body": "Did you get this sorted?"}], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 7298790, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b3f79673c4aae407dcf4ac30c6e559ca?s=128&d=identicon&r=PG&f=1", "display_name": "nicodo", "link": "https://stackoverflow.com/users/7298790/nicodo"}, "is_accepted": false, "score": 1, "last_activity_date": 1543318154, "creation_date": 1543318154, "answer_id": 53498677, "question_id": 53284568, "link": "https://stackoverflow.com/questions/53284568/middleman-blog-pagination-shows-all-articles/53498677#53498677", "title": "Middleman Blog Pagination shows all articles", "body": "<p>Is that not because you use blog.articles.each and should use page_articles instead?\nI think you have to change blog.articles.each (the total number of articles) and use something like <code>&lt;% page_articles.each do |article| %&gt;</code> to get the number of articles you want on your page. </p>\n"}], "owner": {"reputation": 1, "user_id": 10236669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd6bb32d794d62be78c826d8fbd92dc6?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Schraven", "link": "https://stackoverflow.com/users/10236669/paul-schraven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1543318154, "creation_date": 1542123793, "question_id": 53284568, "link": "https://stackoverflow.com/questions/53284568/middleman-blog-pagination-shows-all-articles", "title": "Middleman Blog Pagination shows all articles", "body": "<p>I have been trying to activate Pagination for my Middleman Blog, but for some reason, even though pagination itself seems to work (as signified by the buttons at the bottom, leading me until page three), all articles are shown on each individual page, instead of just ten</p>\n\n<p>section in config.rb</p>\n\n<pre><code>activate :blog do |blog|\n  blog.name = \"en\"\n  blog.prefix = \"blog\"\n  blog.permalink = \"/{year}/{month}/{day}/{title}.html\"\n  blog.sources = \"/posts/:year-:month-:day-:title.html\"\n  blog.layout = \"blog_layout\"\n  blog.tag_template = \"tag.html\"\n  blog.paginate = true\n  blog.page_link = \"page:num\"\n  blog.per_page = 10\nend\n</code></pre>\n\n<p>Blog Index.html</p>\n\n<pre><code>---\npageable: true  \nblog: en\npriority: 1.0\nchange_frequency: weekly\ndescription: Tbd.\ntitle: Blog\n---\n&lt;div class=\"page-content\"&gt;\n  &lt;div class=\"container\"&gt;\n    &lt;ul class=\"blog-post-list\"&gt;\n        &lt;% blog.articles.each do |article| %&gt;\n        &lt;li&gt;\n          &lt;a href=\"&lt;%= article.url %&gt;\"&gt;\n            &lt;div&gt;\n              &lt;img src=\"&lt;%= article.data.image %&gt;\" class=\"blog-post-list__image\" /&gt;\n            &lt;/div&gt;\n            &lt;div class=\"blog-post-list__post-preview\"&gt;\n              &lt;p class=\"blog-post-list__title\"&gt;&lt;%= article.title %&gt;&lt;/p&gt;\n              &lt;p&gt;&lt;%= article.summary(140, '...') %&gt;&lt;/p&gt;\n              &lt;span&gt;&lt;%= article.date.strftime('%B %e, %Y') %&gt;&lt;/span&gt;\n            &lt;/div&gt;\n          &lt;/a&gt;\n        &lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;ul class=\"paginate\"&gt;\n        &lt;% if paginate &amp;&amp; num_pages &gt; 1 %&gt;\n            &lt;% if prev_page %&gt;\n                &lt;p class=\"previous\"&gt;&lt;%= link_to 'Previous page', prev_page %&gt;&lt;/p&gt;\n            &lt;% end %&gt;\n        &lt;% end %&gt;\n        &lt;% if paginate %&gt;\n            &lt;% if next_page %&gt;\n                &lt;p class=\"next \"&gt;&lt;%= link_to 'Next page', next_page %&gt;&lt;/p&gt;\n            &lt;% end %&gt;\n        &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Any hints what could be the issue here, that causes all articles to be displayed anyways would be highly appreciated! Thanks in advance :)</p>\n"}, {"tags": ["html", "ruby", "jekyll", "gif"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 2, "creation_date": 1542118964, "post_id": 53282730, "comment_id": 93447822, "body": "Could you show dir structure of jekyll project (esp. the part when <code>run.gif</code> is located)?"}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1542120904, "post_id": 53282730, "comment_id": 93449049, "body": "If you look at the console output, is there an error with the file location it is looking for the file in?"}], "answers": [{"comments": [{"owner": {"reputation": 374, "user_id": 3658843, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6e63ce1eeed4aef57daa0fe0dd597f6?s=128&d=identicon&r=PG&f=1", "display_name": "m4p85r", "link": "https://stackoverflow.com/users/3658843/m4p85r"}, "edited": false, "score": 0, "creation_date": 1542141375, "post_id": 53286394, "comment_id": 93460058, "body": "Cheers! I thought that omitting the first &quot;/&quot; would make it relative."}, {"owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "reply_to_user": {"reputation": 374, "user_id": 3658843, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6e63ce1eeed4aef57daa0fe0dd597f6?s=128&d=identicon&r=PG&f=1", "display_name": "m4p85r", "link": "https://stackoverflow.com/users/3658843/m4p85r"}, "edited": false, "score": 0, "creation_date": 1542183582, "post_id": 53286394, "comment_id": 93472256, "body": "Edited my answer."}], "tags": [], "owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "is_accepted": true, "score": 6, "last_activity_date": 1542183395, "last_edit_date": 1542183395, "creation_date": 1542129551, "answer_id": 53286394, "question_id": 53282730, "link": "https://stackoverflow.com/questions/53282730/jekyll-is-not-showing-gifs/53286394#53286394", "title": "Jekyll is not showing gifs", "body": "<p>You're using a <strong>\"relative to current path\"</strong> url : <strong>assets/Animation/run.gif</strong></p>\n\n<p>On a page with url like <strong>protocol://domain.tld/cat1/cat2/year/month/day/</strong>, this will resolve based on current path : </p>\n\n<p><strong>protocol://domain.tld/cat1/cat2/year/month/day/assets/Animation/run.gif</strong></p>\n\n<p>Which is wrong.</p>\n\n<p>You must call you assets with <strong>\"relative to root\"</strong> urls :</p>\n\n<pre><code>![yay](/assets/Animation/run.gif)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&lt;img src=\"{{ site.baseurl }}/assets/Animation/run.gif\"&gt;\n</code></pre>\n"}], "owner": {"reputation": 374, "user_id": 3658843, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6e63ce1eeed4aef57daa0fe0dd597f6?s=128&d=identicon&r=PG&f=1", "display_name": "m4p85r", "link": "https://stackoverflow.com/users/3658843/m4p85r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 53286394, "answer_count": 1, "score": 1, "last_activity_date": 1542183395, "creation_date": 1542117718, "question_id": 53282730, "link": "https://stackoverflow.com/questions/53282730/jekyll-is-not-showing-gifs", "title": "Jekyll is not showing gifs", "body": "<p>I'm trying to put a gif onto my jekyll site. </p>\n\n<p>I've tried the standard </p>\n\n<pre><code>![yay](assets/Animation/run.gif)\n</code></pre>\n\n<p>as well as:</p>\n\n<pre><code>&lt;figure&gt;\n    &lt;IMG SRC=\"assets/Animation/run.gif\"&gt;\n&lt;/figure&gt;\n</code></pre>\n\n<p>but each time I just get the little blue question mark icon saying it can't find it? All the stuff I can find online seems to suggest it should 'just work'. </p>\n\n<p>Any ideas as to what I'm doing wrong?</p>\n\n<p><a href=\"https://ash.optimalbuild.com/linux/macos/2018/10/23/Solving-animations-for-everyone.html\" rel=\"nofollow noreferrer\">Page in question</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 0, "creation_date": 1542115615, "post_id": 53281880, "comment_id": 93445650, "body": "Why did you add <code>get</code> routes ? I think <code>resources :metrics</code> would be enough if you want to use default rails routes pattern"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542115539, "post_id": 53281919, "comment_id": 93445608, "body": "Now, I am getting this error:  ActionController::UrlGenerationError in Metrics#index No route matches {:action=&gt;&quot;edit&quot;, :controller=&gt;&quot;metrics&quot;, :id=&gt;nil} missing required keys: [:id]"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1542115670, "post_id": 53281919, "comment_id": 93445687, "body": "Your data variable is nil - try replacing it with the ID of the object that you want to edit"}, {"owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 0, "creation_date": 1542115739, "post_id": 53281919, "comment_id": 93445733, "body": "Remove <code>get</code> routes and then try."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1542116106, "post_id": 53281919, "comment_id": 93445982, "body": "Yes, remove this line <code>get &#39;edit&#39; =&gt; &#39;metrics#edit&#39;</code>. That&#39;s already defined in <code>resources :metrics</code> better"}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542116148, "post_id": 53281919, "comment_id": 93446010, "body": "Removed get routes. Now in the index view, when i click on edit link, I am getting this error.  ActiveRecord::UnknownPrimaryKey in MetricsController#edit  Unknown primary key for table AutomatedThresholding in model Metric."}, {"owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 0, "creation_date": 1542116237, "post_id": 53281919, "comment_id": 93446062, "body": "Update your question with suggested answer. remove both get routes and replace <code>@metricAll</code> with <code>data</code> and then hover over that edit link and check what url is forming"}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542118839, "post_id": 53281919, "comment_id": 93447746, "body": "As suggested removed get routes and replaced @metricAll with data.Metric.    Now, on hovering to edit link, I see it as <a href=\"http://localhost/metrics/Metric1/edit\" rel=\"nofollow noreferrer\">localhost/metrics/Metric1/edit</a>"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1542118967, "post_id": 53281919, "comment_id": 93447823, "body": "Wait, why data.Metric? It should be just data"}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542119223, "post_id": 53281919, "comment_id": 93447970, "body": "When I have just data, I am getting this error: ActionController::UrlGenerationError in Metrics#index No route matches {:action=&gt;&quot;edit&quot;, :controller=&gt;&quot;metrics&quot;, :id=&gt;nil} missing required keys: [:id]"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1542119344, "post_id": 53281919, "comment_id": 93448019, "body": "try with data.id but it&#39;s really strange. it seems any of your metric objects is nil to me. try to print them."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1542119498, "post_id": 53281919, "comment_id": 93448117, "body": "another try could be <code>edit_metric_path(id: data.id)</code>"}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542120212, "post_id": 53281919, "comment_id": 93448551, "body": "Ohh.. I don&#39;t have the column id in my data object. Is that required in my table or do I need to modify my method edit as I don&#39;t have id column"}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1542120271, "post_id": 53281919, "comment_id": 93448591, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/183567/discussion-between-mallela-sriprakash-and-ursus\">continue this discussion in chat</a>."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 1, "creation_date": 1542121827, "post_id": 53281919, "comment_id": 93449666, "body": "I definitely think that&#39;s the problem. If you have a different primary key than id, try this  <code>self.primary_key = &#39;&lt;your_column&gt;&#39;</code>"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 1, "last_activity_date": 1542115202, "creation_date": 1542115202, "answer_id": 53281919, "question_id": 53281880, "link": "https://stackoverflow.com/questions/53281880/facing-issues-with-link-to-edit-in-rails/53281919#53281919", "title": "Facing issues with link_to &quot;Edit&quot; in rails", "body": "<p>You're passing ALL the metrics for the edit route. Move from </p>\n\n<pre><code>&lt;td id=\"EditButton\"&gt;&lt;%= link_to \"Edit\", edit_metric_path(@metricAll) %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>to </p>\n\n<pre><code>&lt;td id=\"EditButton\"&gt;&lt;%= link_to \"Edit\", edit_metric_path(data) %&gt;&lt;/td&gt;\n</code></pre>\n\n<p><code>data</code> is the current metric in your code</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542119410, "post_id": 53282861, "comment_id": 93448061, "body": "This is what I have in my model:  class Metric &lt; ActiveRecord::Base   self.table_name = &#39;AutomatedThresholding&#39; end"}, {"owner": {"reputation": 194, "user_id": 3334827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9e7b035a201d1f2eb77a9376ac531c?s=128&d=identicon&r=PG", "display_name": "Frank Etoundi", "link": "https://stackoverflow.com/users/3334827/frank-etoundi"}, "reply_to_user": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1542133914, "post_id": 53282861, "comment_id": 93456805, "body": "I guess you must have a database table named <code>automated_thresholdings</code>. If that&#39;s the case, this syntax <code>self.table_name = AutomatedThresholding</code>  is wrong. This should be correct <code>self.table_name = &#39;automated_thresholdings&#39;</code>  Read more: <a href=\"https://apidock.com/rails/ActiveRecord/ModelSchema/ClassMethods/table_name\" rel=\"nofollow noreferrer\">apidock.com/rails/ActiveRecord/ModelSchema/ClassMethods/&hellip;</a>"}], "tags": [], "owner": {"reputation": 194, "user_id": 3334827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9e7b035a201d1f2eb77a9376ac531c?s=128&d=identicon&r=PG", "display_name": "Frank Etoundi", "link": "https://stackoverflow.com/users/3334827/frank-etoundi"}, "is_accepted": false, "score": 0, "last_activity_date": 1542118137, "creation_date": 1542118137, "answer_id": 53282861, "question_id": 53281880, "link": "https://stackoverflow.com/questions/53281880/facing-issues-with-link-to-edit-in-rails/53282861#53282861", "title": "Facing issues with link_to &quot;Edit&quot; in rails", "body": "<p>According to your screenshot, the error is within the model. \nAlso, as mentioned by others, you should remove those <code>get</code> routes as the <code>resources :metrics</code> will generate the necessary routes for all your CRUD actions a.ka. for the <code>index, show, edit, new, create, update, destroy</code>.</p>\n\n<p>My guess is that the <code>metric.rb</code> file has a <code>belongs_to :automated_thresholding</code> relationship but the <code>metrics</code> database table is missing the field <code>automated_thresholding_id</code>. </p>\n\n<p>You should create a migration to add that field</p>\n\n<p><code>add_reference :metrics, :automated_thresholding</code></p>\n"}], "owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542118137, "creation_date": 1542115072, "question_id": 53281880, "link": "https://stackoverflow.com/questions/53281880/facing-issues-with-link-to-edit-in-rails", "title": "Facing issues with link_to &quot;Edit&quot; in rails", "body": "<p>I am trying to display all the metrics in a table format with an edit option. But, I end up with the below error</p>\n\n<p><a href=\"https://i.stack.imgur.com/MWXpz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MWXpz.png\" alt=\"enter image description here\"></a></p>\n\n<p>In Index view, I am able to see all the data. But when I click on edit link, it is not redirecting to edit view where I have different columns to be showed.</p>\n\n<p><strong>index view:</strong></p>\n\n<pre><code>&lt;%= form_for :metrics_controller, url: metrics_path(@metric), method: :get do |f| %&gt;\n  &lt;table id=\"metrics\"&gt;\n    &lt;thead&gt;\n    &lt;tr id=\"AllMetricColumnNames\"&gt;\n      &lt;th id=\"CommentsColumn\"&gt;Comments&lt;/th&gt;\n      &lt;th id=\"EditColumn\"&gt;Edit&lt;/th&gt;\n    &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;% @metricAll.each do |data| %&gt;\n      &lt;tr id=\"AllMetricValues\"&gt;\n        &lt;td id=\"Comments\"&gt;&lt;%= data.Comments %&gt;&lt;/td&gt;\n        &lt;td id=\"EditButton\"&gt;&lt;%= link_to \"Edit\", edit_metric_path(@metricAll) %&gt;&lt;/td&gt;\n    &lt;% end %&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Controller:</strong></p>\n\n<pre><code>class MetricsController &lt; ApplicationController\n  def index\n    @metricAll = Metric.all\n  end\n\n  def show\n    @metric = Metric.find(params[:id])\n  end\n\n  def edit\n    @metric = Metric.find(params[:id])\n  end\n\n  private def post_params\n    params.require(:metric).permit(:Metric, :Comments)\n  end\nend\n</code></pre>\n\n<p><strong>routes:</strong></p>\n\n<pre><code>  root 'metrics#index'\n  get 'index' =&gt; 'metrics#index'\n  get 'edit' =&gt; 'metrics#edit'\n  resources :metrics\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 5, "last_activity_date": 1542102018, "creation_date": 1542102018, "answer_id": 53277999, "question_id": 53277948, "link": "https://stackoverflow.com/questions/53277948/undefined-local-variable-or-method-f-when-using-hidden-field-tag/53277999#53277999", "title": "undefined local variable or method `f&#39; when using hidden_field tag", "body": "<p>Either that tutorial is broken or you missed the line where they do something like this:</p>\n\n<pre><code>&lt;%= form_for @subscription do |f| %&gt;\n</code></pre>\n"}], "owner": {"reputation": 326, "user_id": 6871619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a77dbd142c184c58ac6f82a8a2805b?s=128&d=identicon&r=PG&f=1", "display_name": "sokoine", "link": "https://stackoverflow.com/users/6871619/sokoine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 53277999, "answer_count": 1, "score": 1, "last_activity_date": 1542105354, "creation_date": 1542101902, "last_edit_date": 1542105354, "question_id": 53277948, "link": "https://stackoverflow.com/questions/53277948/undefined-local-variable-or-method-f-when-using-hidden-field-tag", "title": "undefined local variable or method `f&#39; when using hidden_field tag", "body": "<p>I'm following a tutorial, and i get this error when i try to add  <code>f.hidden_field</code> tag in my form.</p>\n\n<blockquote>\n  <p>undefined local variable or method 'f'</p>\n</blockquote>\n\n<pre><code>&lt;h1&gt;Signing up for \"&lt;%= @subscription.plan.name %&gt;\"&lt;/h1&gt;\n\n&lt;%= f.hidden_field :paypal_customer_token %&gt;\n&lt;%= f.hidden_field :paypal_payment_token %&gt;\n\n&lt;% if @subscription.paypal_payment_token.present? %&gt;\n  &lt;H1&gt;Payment has been provided &lt;/H1&gt;\n&lt;% else %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= radio_button_tag :pay_with, :paypal %&gt;\n    &lt;%= label_tag :pay_with_paypal do %&gt;\n      &lt;%= image_tag \"paypal.png\" %&gt;\n    &lt;% end %&gt;\n    &lt;%= link_to \"paypal.png\", paypal_checkout_path(:plan_id =&gt; @subscription.plan_id) %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1542106651, "post_id": 53277845, "comment_id": 93440704, "body": "What do you mean &quot;If the user logs in successfully,  but hits an error immediately&quot; how does this actually occur? What error is being hit? It sounds like a js timing issue."}, {"owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1542108027, "post_id": 53277845, "comment_id": 93441533, "body": "Nothing to do with JS. Error as in an exception. So for example I could just do <code>raise StandardError</code> on a controller method that gets hit after a successful login."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1542118837, "post_id": 53277845, "comment_id": 93447745, "body": "What version of Rails?  Might be related to <a href=\"https://github.com/rails/rails/issues/33447\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/33447</a>"}, {"owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1542121627, "post_id": 53277845, "comment_id": 93449538, "body": "@lacostenycoder 5.2.1"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1542132302, "post_id": 53277845, "comment_id": 93456074, "body": "Are you aware that reloading the action with the error will probably just rerun the login part and than fail for the same reason? You login the user everyone and therefore the the message again and again."}, {"owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1542194927, "post_id": 53277845, "comment_id": 93479002, "body": "@spickermann That&#39;s not true. At this stage the login has happened and none of the devise logic is being called. It&#39;s purely a case of the session not being cleared when run through the exceptions_app."}], "owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542101586, "creation_date": 1542101586, "question_id": 53277845, "link": "https://stackoverflow.com/questions/53277845/flash-not-cleared-when-using-exceptions-app", "title": "Flash not cleared when using exceptions_app", "body": "<p>So in our Rails application we use custom errors by doing: <code>config.exceptions_app = self.routes</code></p>\n\n<p>and</p>\n\n<pre><code>%w[401 403 404 500].each do |code|\n  get code, to: 'errors#show', defaults: { code: code }\nend\n</code></pre>\n\n<p>We also use Devise for our authentication.</p>\n\n<p>We've noticed a weird edge case whereby when the user logs in and is shown a flash message of signed in successfully but hits an error immediately the flash is displayed but if the user refreshes the page the flash will be displayed again and again and is never cleared.</p>\n\n<p>If they visit another page that doesn't have the error then they will see the flash again (because it wasn't cleared) but it will then clear successfully. So it seems that the exceptions_app somehow bypasses the clearing of flashes in Rails...</p>\n\n<p>To fix this we've done:</p>\n\n<pre><code>class ErrorsController &lt; ApplicationController\n  def show\n    flash.clear # clear all flashes\n    render params[:code].to_s, status: params[:code]\n  end\nend\n</code></pre>\n\n<p>So we clear the flashes on the error so they are not seen again afterwards...</p>\n\n<p>Any ideas why this is happening? Is this a bug in Rails' exceptions_app?</p>\n"}, {"tags": ["ruby", "sqlite", "sinatra", "rake"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1542098873, "post_id": 53276228, "comment_id": 93436109, "body": "The error seems to refer to the line <code>helpers Sinatra::App::Helpers::Applicaction</code> \u2013 where is <code>Sinatra::App::Helpers::Applicaction</code> defined? Is that the correct namespace? Could you show its source?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1542106987, "post_id": 53276228, "comment_id": 93440883, "body": "What happens if you put <code>require &quot;sinatra&#47;activerecord&#47;rake&quot;</code> as first line in rakefile ?"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1542108883, "post_id": 53276228, "comment_id": 93442043, "body": "Is <code>Applicaction</code> a typo?"}, {"owner": {"reputation": 21, "user_id": 9127992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81766b5deeab1b3fdfddb28111ceda0?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Macavilca", "link": "https://stackoverflow.com/users/9127992/frank-macavilca"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1542119985, "post_id": 53276228, "comment_id": 93448406, "body": "@Stefan i&#39;ll show you just i forgot my code at home"}, {"owner": {"reputation": 21, "user_id": 9127992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81766b5deeab1b3fdfddb28111ceda0?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Macavilca", "link": "https://stackoverflow.com/users/9127992/frank-macavilca"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1542120194, "post_id": 53276228, "comment_id": 93448539, "body": "@lacostenycoder i think i did that  but i will try again"}, {"owner": {"reputation": 21, "user_id": 9127992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81766b5deeab1b3fdfddb28111ceda0?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Macavilca", "link": "https://stackoverflow.com/users/9127992/frank-macavilca"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1542120213, "post_id": 53276228, "comment_id": 93448553, "body": "@MarkThomas mmm could be a problem ill change it"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9127992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81766b5deeab1b3fdfddb28111ceda0?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Macavilca", "link": "https://stackoverflow.com/users/9127992/frank-macavilca"}, "is_accepted": false, "score": 0, "last_activity_date": 1542156098, "creation_date": 1542156098, "answer_id": 53291550, "question_id": 53276228, "link": "https://stackoverflow.com/questions/53276228/sinatra-i-cant-use-rake-t/53291550#53291550", "title": "Sinatra I can&#39;t use rake -T", "body": "<p>I SOLVE THAT I HAD TO ADD  IN app.rb </p>\n\n<pre><code>require File.dirname(__FILE__) + '/config/initializers/helpers.rb'\nrequire File.dirname(__FILE__) + '/config/initializers/filters.rb'\nrequire File.dirname(__FILE__) + '/helpers/error_helper.rb'\nrequire File.dirname(__FILE__) + '/routes/error.rb'\nrequire File.dirname(__FILE__) + '/routes/home.rb'\n</code></pre>\n\n<p>but i dont know why my boot.rb doesnt work</p>\n\n<h1>config.ru</h1>\n\n<pre><code>#!/usr/bin/env rackup\n# encoding: utf-8\n\nrequire_relative 'config/boot'\nrequire File.dirname(__FILE__) + '/app'\n\nrun App\n</code></pre>\n\n<h1>boot.rb</h1>\n\n<pre><code>#registro de rutas\nDir[\"./routes/*.rb\"].each {|file| require file }\n#registro de initializers\nDir[\"./config/initializers/*.rb\"].each {|file| require file }\n#registro de modelos\nDir[\"./models/*_model.rb\"].each {|file| require file }\n#helpers\nDir[\"./helpers/*_helper.rb\"].each {|file| require file }\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9127992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81766b5deeab1b3fdfddb28111ceda0?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Macavilca", "link": "https://stackoverflow.com/users/9127992/frank-macavilca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569757258, "creation_date": 1542095567, "last_edit_date": 1569757258, "question_id": 53276228, "link": "https://stackoverflow.com/questions/53276228/sinatra-i-cant-use-rake-t", "title": "Sinatra I can&#39;t use rake -T", "body": "<p>I don't know why I can't use <code>rake -T</code> or <code>bundle exec rake -T</code></p>\n\n<pre><code># app.rb\n\nrequire 'rubygems'\nrequire 'sinatra'\nrequire \"sinatra/activerecord\"\n\nclass App &lt; Sinatra::Base\n  #configuraciones\n  set :root, File.dirname(__FILE__)\n  set :session_secret, 'super secret'\n  set :public_folder, File.dirname(__FILE__) + '/public'\n  set :layout, 'views/layouts'\n  set :database, {adapter: \"sqlite3\", database: \"data\"}\n  enable :sessions\n  #before all requests\n  before do\n    headers['server'] = 'Ruby, Ubuntu'\n  end\n  #registro de helpers de la aplicacion\n  helpers Sinatra::App::Helpers::Applicaction\n  helpers Sinatra::App::Helpers::Filters\n  #registro de helpers de routes\n  helpers Sinatra::App::Helpers::ErrorHelper\n  #registro de rutas\n  register Sinatra::App::Routing::Home\n  register Sinatra::App::Routing::Departamento\n  register Sinatra::App::Routing::Provincia\n  register Sinatra::App::Routing::Error\nend\n</code></pre>\n\n\n\n<pre><code># Rakefile.rb\n\nrequire 'sinatra'\nrequire \"sinatra/activerecord/rake\"\nrequire './app'\n</code></pre>\n\n\n\n<pre><code># config.ru\n\nrequire_relative 'config/boot'\nrequire File.dirname(__FILE__) + '/app'\n\nrun App\n</code></pre>\n\n<p>This the error message:</p>\n\n<pre><code>PS C:\\ruby\\sinatra&gt; bundle exec rake -T\nWARNING: If you plan to load any of ActiveSupport's core extensions to Hash, be\nsure to do so *before* loading Sinatra::Application or Sinatra::Base. If not,\nyou may disregard this warning.\nrake aborted!\nNameError: uninitialized constant Sinatra::App\nC:/ruby/sinatra/app.rb:18:in `&lt;class:App&gt;'\nC:/ruby/sinatra/app.rb:5:in `&lt;top (required)&gt;'\nC:/ruby/sinatra/Rakefile.rb:4:in `&lt;top (required)&gt;'\n(See full trace by running task with --trace)\nPS C:\\ruby\\sinatra&gt;\n</code></pre>\n\n<p>And here is the file structure:</p>\n\n<p><img src=\"https://i.stack.imgur.com/1FLND.png\" alt=\"enter image description here\">  </p>\n\n<p><strong><em>UPDATE</em></strong> \n <strong>First Change app.rb</strong></p>\n\n<pre><code>helpers Sinatra::App::Helpers::Application\n</code></pre>\n\n<p><strong>This is the helpers.rb</strong> </p>\n\n<pre><code> module Sinatra\n  module App\n    module Helpers\n      module Application\n        def load_css(csss)\n          rpta = ''\n          if defined? csss\n            csss.each do |css|\n              temp = '&lt;link href=\"' + CONSTANTS[:static_url] + css + '.css\" rel=\"stylesheet\"/&gt;'\n              rpta = rpta + temp\n            end\n          end\n          rpta\n        end\n\n        def load_js(jss)\n          rpta = ''\n          if defined? jss\n            jss.each do |js|\n              temp = '&lt;script src=\"' + CONSTANTS[:static_url] + js + '.js\" type=\"text/javascript\"&gt;&lt;/script&gt;'\n              rpta = rpta + temp\n            end\n          end\n          rpta\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I have the same error </p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "api", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1735, "user_id": 4903843, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9o6SR.jpg?s=128&g=1", "display_name": "Nilay Singh", "link": "https://stackoverflow.com/users/4903843/nilay-singh"}, "edited": false, "score": 0, "creation_date": 1542095249, "post_id": 53276132, "comment_id": 93434398, "body": "use select option"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1542097507, "post_id": 53276132, "comment_id": 93436669, "body": "Go through gem <a href=\"https://github.com/fabrik42/acts_as_api\" rel=\"nofollow noreferrer\">act_as_api</a>. It is really very good gem to create json response for API."}], "answers": [{"tags": [], "owner": {"reputation": 3543, "user_id": 2231236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ZyG2H.jpg?s=128&g=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/2231236/nithin"}, "is_accepted": false, "score": 1, "last_activity_date": 1542095642, "creation_date": 1542095642, "answer_id": 53276246, "question_id": 53276132, "link": "https://stackoverflow.com/questions/53276132/how-to-return-selected-data-on-json-api/53276246#53276246", "title": "how to return selected data on json api", "body": "<p>You will have to understand about JSON builders,</p>\n\n<p>start here <a href=\"https://www.ruby-toolbox.com/categories/API_Builders\" rel=\"nofollow noreferrer\">https://www.ruby-toolbox.com/categories/API_Builders</a></p>\n\n<p>Choose one and get along .</p>\n\n<p>I have used Jbuilder quite a few times</p>\n"}, {"tags": [], "owner": {"reputation": 1156, "user_id": 4955546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ypcYA0ACXs/AAAAAAAAAAI/AAAAAAAABgY/gcCpBwKBymI/photo.jpg?sz=128", "display_name": "Sikandar Tariq", "link": "https://stackoverflow.com/users/4955546/sikandar-tariq"}, "is_accepted": false, "score": 1, "last_activity_date": 1542095646, "creation_date": 1542095646, "answer_id": 53276248, "question_id": 53276132, "link": "https://stackoverflow.com/questions/53276132/how-to-return-selected-data-on-json-api/53276248#53276248", "title": "how to return selected data on json api", "body": "<p>create json-jbuilder view</p>\n\n<blockquote>\n  <p>app/[controller]/show.json.jbuilder</p>\n</blockquote>\n\n<pre><code>json.id address.id\njson.user_id address.user_id\njson.city address.city\n...\n</code></pre>\n\n<blockquote>\n  <p>your controller action</p>\n</blockquote>\n\n<pre><code>   def show\n     @address = Address.where(user_id:params[:id])       \n   end\n</code></pre>\n\n<p>for more details you may read jBuilder documentation <a href=\"https://github.com/rails/jbuilder\" rel=\"nofollow noreferrer\">https://github.com/rails/jbuilder</a></p>\n"}], "owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1542099632, "creation_date": 1542095150, "last_edit_date": 1542099632, "question_id": 53276132, "link": "https://stackoverflow.com/questions/53276132/how-to-return-selected-data-on-json-api", "title": "how to return selected data on json api", "body": "<p>i have created API i have two tables users and addresses i want only return state and city in seperate array how is it ?</p>\n\n<pre><code>    my controller  \n           def show\n             @address = Address.where(user_id:params[:id])\n             render json: @address        \n           end\n My postman output\n       https://imgur.com/a/t5xHYBI\n    #my expected output\n     [\n            { \n                \"city\": \"palani\",\n                \"city\": \"coimbatore\",\n\n            },\n            {\n                \"state\": \"tamilnadu\",\n                \"state\": \"tamilnadu\",            \n            }\n        ]\n</code></pre>\n"}, {"tags": ["ruby", "jekyll"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1542091921, "post_id": 53274072, "comment_id": 93432952, "body": "No, unfortunately one cannot extend GH pages functionality with 3rd party gems."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1542094929, "post_id": 53274072, "comment_id": 93434253, "body": "@AlekseiMatiushkin if OP would build the site locally with jekyll and then push it to  Github as HTML it could be done though right?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1542095842, "post_id": 53274072, "comment_id": 93434651, "body": "@maxpleaner most likely, yes, but this is not what was asked initially; I agree that\u2019s the way to go, indeed."}], "answers": [{"tags": [], "owner": {"reputation": 2727, "user_id": 7388630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o3TeY.jpg?s=128&g=1", "display_name": "fewlinesofcode", "link": "https://stackoverflow.com/users/7388630/fewlinesofcode"}, "is_accepted": true, "score": 1, "last_activity_date": 1542193980, "creation_date": 1542193980, "answer_id": 53298892, "question_id": 53274072, "link": "https://stackoverflow.com/questions/53274072/add-a-dependency-in-a-project-using-gem/53298892#53298892", "title": "Add a dependency in a project using gem", "body": "<p>GitHub Pages <a href=\"https://pages.github.com/versions/\" rel=\"nofollow noreferrer\">officially supports</a> <code>jekyll-relative-links   0.5.3</code>, so you can just install It as usual:</p>\n\n<ol>\n<li><p>Add the following to your site's Gemfile:</p>\n\n<p><code>gem 'jekyll-relative-links'</code></p></li>\n<li><p>Add the following to your site's config file:</p>\n\n<p><code>plugins: \n    - jekyll-relative-links</code></p></li>\n</ol>\n\n<hr>\n\n<p>More <a href=\"https://help.github.com/articles/adding-jekyll-plugins-to-a-github-pages-site/\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 2504, "user_id": 4723307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a7d84ce58c2080abbf0cf1d44ba16c8?s=128&d=identicon&r=PG&f=1", "display_name": "Liu Silong", "link": "https://stackoverflow.com/users/4723307/liu-silong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53298892, "answer_count": 1, "score": 0, "last_activity_date": 1542193980, "creation_date": 1542085071, "question_id": 53274072, "link": "https://stackoverflow.com/questions/53274072/add-a-dependency-in-a-project-using-gem", "title": "Add a dependency in a project using gem", "body": "<p>I am having a problem when I use Jekyll to build a website and host it on github. The website uses a relative path dependency <a href=\"https://github.com/benbalter/jekyll-relative-links\" rel=\"nofollow noreferrer\">jekyll-relative-links</a>, but this dependency is installed on the local disk: </p>\n\n<blockquote>\n  <p>/Users/xxx/.rvm/gems/ruby-2.5.1/gems/jekyll-relative-links-0.5.3</p>\n</blockquote>\n\n<p>I will not find this dependency when I push the site onto github, so I would like to ask if I can install this dependency in the project. Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "paperclip"], "comments": [{"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1542085289, "post_id": 53274036, "comment_id": 93430836, "body": "Not sure if it still works, but have a look at this <a href=\"https://gist.github.com/nazarhussain/1040091/5ffb5cd162c70d0573fade0c8239f924f0d9afd8\" rel=\"nofollow noreferrer\">gist.github.com/nazarhussain/1040091/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 1, "last_activity_date": 1542087569, "creation_date": 1542087569, "answer_id": 53274503, "question_id": 53274036, "link": "https://stackoverflow.com/questions/53274036/rails-paperclip-default-image-only-under-certain-conditions/53274503#53274503", "title": "Rails paperclip default image only under certain conditions", "body": "<p>Try with following,</p>\n\n<pre><code>has_attached_file \n  :product_image, \n  styles: { small: \"150x150&gt;\", default: \"350x350\"},\n  default_url: \":style/default_user_avatar.png\"\n\n  # app/assets/images/medium/default_user_avatar.png\n  # app/assets/images/thumbs/default_user_avatar.png\n</code></pre>\n\n<p>Existing method is,</p>\n\n<pre><code>def default_url\n  if @attachment_options[:default_url].respond_to?(:call)\n    @attachment_options[:default_url].call(@attachment)\n  elsif @attachment_options[:default_url].is_a?(Symbol)\n    @attachment.instance.send(@attachment_options[:default_url])\n  else\n    @attachment_options[:default_url]\n  end\nend\n</code></pre>\n\n<p>In initializer, Provide monkey patch for following,</p>\n\n<pre><code>require 'uri'\nrequire 'active_support/core_ext/module/delegation'\n\nmodule Paperclip\n  class UrlGenerator\n\n    def default_url\n      if @attachment.instance.lead_status == 'product'\n        default_url = attachment_options[:default_url]\n      else\n        default_url = # provide another missing default_url\n      end \n      if default_url.respond_to?(:call)\n        default_url.call(@attachment)\n      elsif default_url.is_a?(Symbol)\n        @attachment.instance.send(default_url)\n      else\n        default_url\n      end\n    end\n\n  end\nend\n</code></pre>\n\n<p>Update as per cases</p>\n"}], "owner": {"reputation": 505, "user_id": 7614941, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e1ce1f96528ab233b12f9a66f4ed86d6?s=128&d=identicon&r=PG&f=1", "display_name": "andrzej541", "link": "https://stackoverflow.com/users/7614941/andrzej541"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 53274503, "answer_count": 1, "score": 0, "last_activity_date": 1542087569, "creation_date": 1542084809, "question_id": 53274036, "link": "https://stackoverflow.com/questions/53274036/rails-paperclip-default-image-only-under-certain-conditions", "title": "Rails paperclip default image only under certain conditions", "body": "<p>I've got a Lead model which is splited by lead_status param on products and offers. Only leads with product status should contain images and offers should not. I've migrated attached product_image table to schema and tried to set a default image only for products. Like this: </p>\n\n<pre><code>class Lead &lt; ApplicationRecord\n\n\nhas_attached_file :product_image, styles: { small: \"150x150&gt;\", default: \"350x350\"}\nvalidates_attachment_content_type :product_image, content_type: /\\Aimage\\/.*\\z/\n\nbefore_save :product_image_default_url\n\n def product_image_default_url\n    if self.lead_status == \"product\" &amp;&amp; self.product_image.url.nil?\n      self.product_image.url = \"/images/:style/default_user_avatar.png\"\n end\nend\n</code></pre>\n\n<ol>\n<li>Every time when I save a new lead without uploaded image I get \"/product_images/original/missing.png\" as a default url. No matter which status it has. </li>\n<li>Model doesn't recognize new leads by it's status </li>\n</ol>\n\n<p>How can I change that? Force my Lead model to save a default image url according to a \"product\" status and ignore all those with \"offer\" status?</p>\n\n<p>My rails version is 5.2.1 and paperclip 6.0.0  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex", "gsub"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542088611, "post_id": 53274033, "comment_id": 93431827, "body": "I&#39;ve seen the question &quot;Why the downvote?&quot; 1,243 times. 3 of those were answered.  Probably the downvoter punished you for omitting the <code>i</code> flag, not realizing it has no effect."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542088689, "post_id": 53274033, "comment_id": 93431853, "body": "@CarySwoveland oh well, I was genuinely curious whether this doesn&#39;t cover any case. Thanks for letting me know :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1542126650, "post_id": 53274033, "comment_id": 93452925, "body": "Also maybe add a bit of information (albeit obvious in this case) such as &quot;you just need to add <code>&amp;</code> to the character class like so ...&quot;. It is possible the downvotes might be for low quality answer/could have been a comment type thing. Also might be that people are distasteful of you answering such a simple question, which is certainly not in the new spirit of SO (yang +1)"}, {"owner": {"reputation": 1368, "user_id": 732808, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48f148629ebf7d49e49b88fd0d8a7cf3?s=128&d=identicon&r=PG", "display_name": "bcackerman", "link": "https://stackoverflow.com/users/732808/bcackerman"}, "edited": false, "score": 0, "creation_date": 1544646935, "post_id": 53274033, "comment_id": 94354594, "body": "@MarcinKo\u0142odziej If I needed to allow <code>-</code> in the strings as well, how would you manipulate it? What docs do you use so I can poke in as well?"}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 4, "last_activity_date": 1542088581, "last_edit_date": 1542088581, "creation_date": 1542084803, "answer_id": 53274033, "question_id": 53273775, "link": "https://stackoverflow.com/questions/53273775/ruby-regex-to-allow-for-alphanumber-and-symbol/53274033#53274033", "title": "Ruby regex to allow for alphanumber and &amp; symbol", "body": "<p>You can use</p>\n\n<pre><code>gsub(/[^\\p{Alnum}&amp;-]/, '')\n</code></pre>\n\n<p>Note: Kept <code>-</code> as your original regex had it, removed case insensitivity as it's not needed.</p>\n"}], "owner": {"reputation": 1368, "user_id": 732808, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48f148629ebf7d49e49b88fd0d8a7cf3?s=128&d=identicon&r=PG", "display_name": "bcackerman", "link": "https://stackoverflow.com/users/732808/bcackerman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 53274033, "answer_count": 1, "score": -1, "last_activity_date": 1542088581, "creation_date": 1542083017, "question_id": 53273775, "link": "https://stackoverflow.com/questions/53273775/ruby-regex-to-allow-for-alphanumber-and-symbol", "title": "Ruby regex to allow for alphanumber and &amp; symbol", "body": "<p>I have a piece of our code <code>gsub(/[^-\\p{Alnum}]/i, '')</code> which seems to remove all symbols and characters from a string. We want to allow for usage of <code>&amp;</code> in a string too though. How can we add this in?</p>\n"}, {"tags": ["ruby", "selenium", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 10336387, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_KF1zR6Iog0/AAAAAAAAAAI/AAAAAAAAIPQ/yzbyPbK7-ck/photo.jpg?sz=128", "display_name": "Dinh Luong", "link": "https://stackoverflow.com/users/10336387/dinh-luong"}, "edited": false, "score": 0, "creation_date": 1542262673, "post_id": 53274364, "comment_id": 93507285, "body": "Thanks a lot. I tried with the first 2 options and the race-condition happened intermittently.  Fortunately, the last one seems to solve the race-condition, by clicking and giving a lil bit sleep then the issue seems disappear. This helps me to remove the tricky Javascript above."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 139, "user_id": 10336387, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_KF1zR6Iog0/AAAAAAAAAAI/AAAAAAAAIPQ/yzbyPbK7-ck/photo.jpg?sz=128", "display_name": "Dinh Luong", "link": "https://stackoverflow.com/users/10336387/dinh-luong"}, "edited": false, "score": 0, "creation_date": 1542265051, "post_id": 53274364, "comment_id": 93508088, "body": "@DinhLuong you\u2019re welcome - if you\u2019re question is answered don\u2019t forget to accept the answer (the check mark) so the question gets marked as answered."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1542087131, "last_edit_date": 1542087131, "creation_date": 1542086823, "answer_id": 53274364, "question_id": 53273329, "link": "https://stackoverflow.com/questions/53273329/race-condition-with-capybara-value-set/53274364#53274364", "title": "Race condition with Capybara value set", "body": "<p>Note: Any \"solution\" suggested that is purely the use of  <code>execute_script</code> to run some JS is a terrible idea since it completely bypasses the concept of testing what a user can do and can basically make your test worthless.</p>\n\n<p>The root cause of the issue here is the JS behavior attached to the input not being able to handle the key events fast enough. The proper fix would be to fix the JS, however if that's not possible there's a few things you can try</p>\n\n<p>First you can try changing the clear method being used by set</p>\n\n<pre><code>element.set('506307', clear: :backspace)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>element.set('506307', clear: :none) \n</code></pre>\n\n<p>If that doesn't change anything then try clicking on the input, followed by a short sleep before setting the content</p>\n\n<pre><code>element.click\nsleep 0.25\nelement.set('506307')\n</code></pre>\n\n<p>If none of those work around the issue we need to know exactly what JS behavior you have attached to the input and/or what events that JS behavior is listening to. </p>\n"}], "owner": {"reputation": 139, "user_id": 10336387, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_KF1zR6Iog0/AAAAAAAAAAI/AAAAAAAAIPQ/yzbyPbK7-ck/photo.jpg?sz=128", "display_name": "Dinh Luong", "link": "https://stackoverflow.com/users/10336387/dinh-luong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "accepted_answer_id": 53274364, "answer_count": 1, "score": 0, "last_activity_date": 1542087131, "creation_date": 1542079397, "question_id": 53273329, "link": "https://stackoverflow.com/questions/53273329/race-condition-with-capybara-value-set", "title": "Race condition with Capybara value set", "body": "<p>I have faced an issue while using <code>.set(#{value})</code> to fill the text field in registering form, e.g: the phone number i wanna put in is <code>506307</code> then it ended up with <code>063075</code>. \nThe work-around i have been made is executing Javascript block like </p>\n\n<pre><code>execute_script(\"document.querySelector('#{selector}').value = '#{value}'\")\n</code></pre>\n\n<p>However, using the same scripts applying for Webmobile based on React.JS, the scripts above just send the text but didn't send the <code>onChange</code> event, which cause another element cannot be selected/clicked -> made the test failed. </p>\n\n<p>I came up with another approach is to use the <code>send_keys #{value}</code> to trigger the key-pressed event that would make browser think there was a key-pressed event happen for that form, but it ended up with race-condition like <code>set(#{value})</code> as i mentioned. </p>\n\n<p>The another work-around is using <a href=\"https://stackoverflow.com/questions/23892547/what-is-the-best-way-to-trigger-onchange-event-in-react-js\">What is the best way to trigger onchange event in react js</a> , but i tend to use the native Capybara actions before making that tricky Javascript.</p>\n\n<p>So, is there any other way to interact / fill the form field which won't cause that Race condition issue ? </p>\n\n<p>Thanks everybody in advance. </p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 4635580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/O8FQs.jpg?s=128&g=1", "display_name": "Isaac To", "link": "https://stackoverflow.com/users/4635580/isaac-to"}, "edited": false, "score": 0, "creation_date": 1542091404, "post_id": 53273244, "comment_id": 93432785, "body": "Thanks. Your post answered my question. However, it brought up another. Does Ruby guarantee that <code>word</code>, the field reader, refers to the exact same object referred by <code>@word</code> instead of a copy of the object referred by <code>@word</code>?"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 537, "user_id": 4635580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/O8FQs.jpg?s=128&g=1", "display_name": "Isaac To", "link": "https://stackoverflow.com/users/4635580/isaac-to"}, "edited": false, "score": 0, "creation_date": 1542091473, "post_id": 53273244, "comment_id": 93432812, "body": "Yes, <code>attr_reader :word</code> is the same as <code>def word; @word; end</code>"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1542093314, "post_id": 53273244, "comment_id": 93433514, "body": "Technically, Ruby does have some types that are not full objects (by the fact their values are not references), though they behave as objects for most intents and purposes. For example, if <code>@word</code> is a small integer, <code>word</code> will return a copy and not a reference (as these objects are never referenced). However, since all such quasi-objects are immutable, there is no situation where a copy will behave differently than a reference, so it&#39;s a moot point."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1542117394, "post_id": 53273244, "comment_id": 93446824, "body": "@Amadan true, also worth mentioning that in case of these immutable objects, calling <code>@word</code> also returns a copy of <code>@word</code>, therefore adding a <code>attr_reader</code> does not really change how you interact with underlying value."}, {"owner": {"reputation": 537, "user_id": 4635580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/O8FQs.jpg?s=128&g=1", "display_name": "Isaac To", "link": "https://stackoverflow.com/users/4635580/isaac-to"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1542148354, "post_id": 53273244, "comment_id": 93462766, "body": "@Amadan Does Ruby guarantee that all mutable objects are passed by reference?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542152772, "post_id": 53273244, "comment_id": 93463901, "body": "@engineersmnky: Neither of those is mutation, it is reassignment. In one case you are reassigning a local variable; in the other, you are reassigning the instance variable. This would behave identically with real objects, not just quasi-objects, and since it is not about mutation, it doesn&#39;t invalidate Martin&#39;s point."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 537, "user_id": 4635580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/O8FQs.jpg?s=128&g=1", "display_name": "Isaac To", "link": "https://stackoverflow.com/users/4635580/isaac-to"}, "edited": false, "score": 0, "creation_date": 1542153054, "post_id": 53273244, "comment_id": 93463969, "body": "@IsaacTo Yes. What I was talking above is more of a technical curio, as it should almost never impact your code (the only exception I know is you can&#39;t define methods on <code>Integer</code> instances, like you can on most of the other objects in Ruby -- <code>k = &quot;foo&quot;; def k.bang; self + &quot;!&quot;; end; k.bang == &quot;foo!&quot;</code> works, but not if <code>k=1337</code> -- but I&#39;ve never ever needed that)."}, {"owner": {"reputation": 537, "user_id": 4635580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/O8FQs.jpg?s=128&g=1", "display_name": "Isaac To", "link": "https://stackoverflow.com/users/4635580/isaac-to"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542179951, "post_id": 53273244, "comment_id": 93470774, "body": "If you have been following the comments of this post, you may be interested in a new post,<a href=\"https://stackoverflow.com/questions/53294842/why-ruby-doesnt-allow-setting-a-local-variable-using-an-expression-containing-a\" title=\"why ruby doesnt allow setting a local variable using an expression containing a\">stackoverflow.com/questions/53294842/&hellip;</a>,  I have made. The new post is related @engineersmnky&#39;s comment."}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 5, "last_activity_date": 1542078780, "creation_date": 1542078780, "answer_id": 53273244, "question_id": 53273208, "link": "https://stackoverflow.com/questions/53273208/why-instance-variables-can-be-modified-through-a-field-reader-with-the-operat/53273244#53273244", "title": "Why instance variables can be modified through a field reader with the &lt;&lt; operator?", "body": "<p>Your <code>@word</code> references an object in memory. This object happens to be a <code>Hello!</code> string. Your class does not allow to (easily) set a new object for your <code>@word</code> instance variable, but nothing currently stops you from modifying the object directly. If you wish for the object to not be modifiable, you could <code>.freeze</code> it:</p>\n\n<pre><code>class Test\n  attr_reader :word\n  def initialize(word)\n    @word = word.freeze\n  end\n\n  def append_word(token)\n    word &lt;&lt; token\n  end\nend\n\n&gt; Test.new(\"Hello\").append_word(\"world!\")\n# FrozenError (can't modify frozen String)\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 4635580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/O8FQs.jpg?s=128&g=1", "display_name": "Isaac To", "link": "https://stackoverflow.com/users/4635580/isaac-to"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 53273244, "answer_count": 1, "score": 1, "last_activity_date": 1542078780, "creation_date": 1542078546, "question_id": 53273208, "link": "https://stackoverflow.com/questions/53273208/why-instance-variables-can-be-modified-through-a-field-reader-with-the-operat", "title": "Why instance variables can be modified through a field reader with the &lt;&lt; operator?", "body": "<p>Consider the following class.</p>\n\n<pre><code>class Test\n  attr_reader :word\n  def initialize(word)\n    @word = word\n  end\n\n  def append_word(token)\n    word &lt;&lt; token\n  end\nend\n</code></pre>\n\n<p>Consider a sample usage of the class.</p>\n\n<pre><code>2.4.0 :001 &gt; t = Test.new('Hello')\n =&gt; #&lt;Test:0x007f7f09902970 @word=\"Hello\"&gt; \n2.4.0 :002 &gt; t.append_word(' world!')\n =&gt; \"Hello world!\" \n2.4.0 :003 &gt; t.word\n =&gt; \"Hello world!\" \n2.4.0 :004 &gt; \n</code></pre>\n\n<p>I am new to Ruby. I don't understand why I can use the <code>append_word</code> instance method to modify the instance variable <code>@word</code> of a Test instance. <code>word</code> in append_word seems to be a field reader. My understanding is that a field reader is for reading only. How can <code>word &lt;&lt; token</code> in <code>append_word</code> modify the value of <code>@word</code> in a Test instance? </p>\n"}, {"tags": ["ruby", "file", "iteration", "each", "element"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542078264, "post_id": 53272662, "comment_id": 93429338, "body": "One way to write each element (a string) of an array <code>arr</code> to a file, one line per element, is <code>File.write(filename, arr.join(&quot;\\n&quot;))</code>."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "edited": false, "score": 0, "creation_date": 1542074884, "post_id": 53272719, "comment_id": 93428600, "body": "my mistake. I have removed faulty question."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1542094814, "post_id": 53272719, "comment_id": 93434211, "body": "Also, notably, <code>new_text.puts(my_array)</code> will do exactly what you want, even without any explicit loop - <code>puts</code> prints arrays with one line per row by default."}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": false, "score": 3, "last_activity_date": 1542074902, "last_edit_date": 1542074902, "creation_date": 1542074661, "answer_id": 53272719, "question_id": 53272662, "link": "https://stackoverflow.com/questions/53272662/in-ruby-how-do-i-write-array-elements-into-txt-file-such-that-each-element-is-o/53272719#53272719", "title": "in Ruby, how do I write array elements into txt file such that each element is on a separate line?", "body": "<p><code>.each should be writing each element on a different line? no</code></p>\n\n<p>No, whether you're iterating over something does not really matter. What matters is how you're writing into the file.</p>\n\n<p>Currently you're using <a href=\"https://ruby-doc.org/core-2.5.3/IO.html#method-i-write\" rel=\"nofollow noreferrer\">IO#write</a> which doesn't say anything about adding newlines. If you change <code>new_text.write</code> to <code>new_text.puts</code> (<a href=\"https://ruby-doc.org/core-2.5.3/IO.html#method-i-puts\" rel=\"nofollow noreferrer\">IO#puts</a>) you will be writing a new line after each element from your array.</p>\n\n<p>You can easily see it by using <code>$stdout</code> directly:</p>\n\n<pre><code>&gt; a = %w(foo bar)\n =&gt; [\"foo\", \"bar\"] \n&gt; a.each(&amp;$stdout.method(:write)) # write -- no newlines\nfoobar =&gt; [\"foo\", \"bar\"] \n&gt; a.each(&amp;$stdout.method(:puts))  # puts  -- newlines\nfoo\nbar\n =&gt; [\"foo\", \"bar\"] \n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542074902, "creation_date": 1542074064, "last_edit_date": 1542074842, "question_id": 53272662, "link": "https://stackoverflow.com/questions/53272662/in-ruby-how-do-i-write-array-elements-into-txt-file-such-that-each-element-is-o", "title": "in Ruby, how do I write array elements into txt file such that each element is on a separate line?", "body": "<p>I am having difficulty in writing array elements into a text file in the form of 1 element per line. In this instance array is built on sentences (.) . </p>\n\n<p>Please see comments in code below:</p>\n\n<pre><code>puts \"enter paragraph:\"\npara = gets.chomp.to_s\nmy_array = []\n\npara.split('.').each { |p| my_array &lt;&lt; p+ '.'; print \"pushed #{p}.\";puts}\nnew_text = File.new(\"new_text.txt\", \"w+\")\np my_array\nmy_array.each { |m| new_text.write(m)} #clearly iterating over my_array.\n#.each should be writing each element on a different line, no?  Where have I gone wrong?\nnew_text.seek(0)\n\n#text file is still stored in new_text variable\n#the read out shows elements are not written per line\nline = 1\nnew_text.each do |n|\n    puts \"line #{line}: #{n}\"\n    line += 1\n    end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 3973808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5e6421730e46a9f2232341b1ab69a5ac?s=128&d=identicon&r=PG&f=1", "display_name": "growling_egg", "link": "https://stackoverflow.com/users/3973808/growling-egg"}, "edited": false, "score": 2, "creation_date": 1542075977, "post_id": 53272652, "comment_id": 93428829, "body": "In that directory I don&#39;t have any .erb files but I do have application.haml, which starts with:      %html       %head         = csrf_meta_tags  My assumption is this serves the same purpose but via a different markup language?"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 1, "creation_date": 1542084982, "post_id": 53272652, "comment_id": 93430757, "body": "yes, this means you are using <code>haml</code> instead of <code>erb</code> and it should not have any effect on the error"}, {"owner": {"reputation": 153, "user_id": 3973808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5e6421730e46a9f2232341b1ab69a5ac?s=128&d=identicon&r=PG&f=1", "display_name": "growling_egg", "link": "https://stackoverflow.com/users/3973808/growling-egg"}, "edited": false, "score": 0, "creation_date": 1542091129, "post_id": 53272652, "comment_id": 93432693, "body": "Hi, thanks for the comment. To clarify, do you mean that if I use haml that it will not enable csrf protection correctly? Or do you mean that I can use either one and it should work? In the second case, is there any other reason for these POST requests to fail? Thanks!"}, {"owner": {"reputation": 153, "user_id": 3973808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5e6421730e46a9f2232341b1ab69a5ac?s=128&d=identicon&r=PG&f=1", "display_name": "growling_egg", "link": "https://stackoverflow.com/users/3973808/growling-egg"}, "edited": false, "score": 0, "creation_date": 1542093006, "post_id": 53272652, "comment_id": 93433372, "body": "I guess one other question, does putting this meta tag under %head in the application.haml file make it so that it can get referenced everywhere? Or am I only applying this to a subset of my package? Seems to me this setting would apply globally but wanted to double check. In which case, why is this issue still occurring?"}, {"owner": {"reputation": 6933, "user_id": 26604, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e94ddf54b3d31c6eda0e1c76a58c3e74?s=128&d=identicon&r=PG", "display_name": "Kyle Heironimus", "link": "https://stackoverflow.com/users/26604/kyle-heironimus"}, "edited": false, "score": 0, "creation_date": 1542116474, "post_id": 53272652, "comment_id": 93446211, "body": "It appears that this is not your problem, so I would look elsewhere, possibly to the <code>config&#47;secrets.yml</code> file mentioned in another answer."}], "tags": [], "owner": {"reputation": 6933, "user_id": 26604, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e94ddf54b3d31c6eda0e1c76a58c3e74?s=128&d=identicon&r=PG", "display_name": "Kyle Heironimus", "link": "https://stackoverflow.com/users/26604/kyle-heironimus"}, "is_accepted": false, "score": 0, "last_activity_date": 1542073995, "creation_date": 1542073995, "answer_id": 53272652, "question_id": 53272194, "link": "https://stackoverflow.com/questions/53272194/csrf-protection-when-migrating-from-rails-3-to-rails-4/53272652#53272652", "title": "CSRF protection when migrating from Rails 3 to Rails 4", "body": "<p>Your application layout, probably <code>app/views/layouts/applications.html.erb</code> needs to refer to <code>&lt;%= csrf_meta_tags %&gt;</code></p>\n\n<p>This is what is included and checked in all form posts.</p>\n\n<p>If you are not using that layout in all your views, you need to figure out another way to make sure it gets referenced everywhere.</p>\n\n<p><a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/CsrfHelper.html#method-i-csrf_meta_tags\" rel=\"nofollow noreferrer\">Docs</a></p>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 3973808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5e6421730e46a9f2232341b1ab69a5ac?s=128&d=identicon&r=PG&f=1", "display_name": "growling_egg", "link": "https://stackoverflow.com/users/3973808/growling-egg"}, "edited": false, "score": 0, "creation_date": 1542126800, "post_id": 53279337, "comment_id": 93453030, "body": "Sorry posted too early. Will update when I have enough info."}, {"owner": {"reputation": 153, "user_id": 3973808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5e6421730e46a9f2232341b1ab69a5ac?s=128&d=identicon&r=PG&f=1", "display_name": "growling_egg", "link": "https://stackoverflow.com/users/3973808/growling-egg"}, "edited": false, "score": 0, "creation_date": 1542129275, "post_id": 53279337, "comment_id": 93454589, "body": "Ok so I have a question about this. In the logs for my web server, I saw this warning: Please note that you should wait to set secret_key_base until you have 100% of your userbase on Rails 4.x and are reasonably sure you will not need to rollback to Rails 3.x. This is because cookies signed based on the new secret_key_base in Rails 4.x are not backwards compatible with Rails 3.x. You are free to leave your existing secret_token in place, not set the new secret_key_base, and ignore the deprecation warnings until you are reasonably sure that your upgrade is otherwise complete."}, {"owner": {"reputation": 153, "user_id": 3973808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5e6421730e46a9f2232341b1ab69a5ac?s=128&d=identicon&r=PG&f=1", "display_name": "growling_egg", "link": "https://stackoverflow.com/users/3973808/growling-egg"}, "edited": false, "score": 0, "creation_date": 1542129385, "post_id": 53279337, "comment_id": 93454664, "body": "I take this to mean that until we&#39;ve rolled out this upgrade to our whole user base and we&#39;ve verified that there aren&#39;t any issues, we need to comment out the secret_key_base lines in the secret_token.rb and keep using the secret_token definition. Does this mean that in my secrets.yml file, I should use: development: secret_token instead?"}, {"owner": {"reputation": 153, "user_id": 3973808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5e6421730e46a9f2232341b1ab69a5ac?s=128&d=identicon&r=PG&f=1", "display_name": "growling_egg", "link": "https://stackoverflow.com/users/3973808/growling-egg"}, "edited": false, "score": 0, "creation_date": 1542130465, "post_id": 53279337, "comment_id": 93455251, "body": "Tried replacing references to secret_key_base in secrets.yml with secret_token, still getting failed POSTs (500)."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1542106110, "creation_date": 1542106110, "answer_id": 53279337, "question_id": 53272194, "link": "https://stackoverflow.com/questions/53272194/csrf-protection-when-migrating-from-rails-3-to-rails-4/53279337#53279337", "title": "CSRF protection when migrating from Rails 3 to Rails 4", "body": "<p>Do you have a <code>config/secrets.yml</code> file ?  It should look something like this:</p>\n\n<pre><code>development:\n  secret_key_base: a75d...\n\ntest:\n  secret_key_base: 492f...\n\nproduction:\n  secret_key_base: &lt;%= ENV[\"SECRET_KEY_BASE\"] %&gt;\n</code></pre>\n\n<p>And if so you need to make sure your server has the environment variable set.  Keys need to be handled carefully and NEVER committed to a public repo i.e. GIT. </p>\n\n<p>Refer to <a href=\"https://guides.rubyonrails.org/v4.2/security.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/v4.2/security.html</a></p>\n"}], "owner": {"reputation": 153, "user_id": 3973808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5e6421730e46a9f2232341b1ab69a5ac?s=128&d=identicon&r=PG&f=1", "display_name": "growling_egg", "link": "https://stackoverflow.com/users/3973808/growling-egg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542106110, "creation_date": 1542070136, "question_id": 53272194, "link": "https://stackoverflow.com/questions/53272194/csrf-protection-when-migrating-from-rails-3-to-rails-4", "title": "CSRF protection when migrating from Rails 3 to Rails 4", "body": "<p>I am working on migrating a big website package from Ruby 1.9 to Ruby 2.3, and I'm almost done. I've got Rails almost completely moved from 3.2 to 4.2, but I've run into one snag which I cannot figure out, and this project is my first experience with either Ruby or Rails, so I've been picking up the jargon as I go. </p>\n\n<p>When I point my browser to my development server, all my GET requests succeed (200), but all my POST requests fail (500). After some research, I found out about Rails' built-in CSRF protection, and was able to determine that the package I'm working with had this protection in place when it was using Rails 3.2.</p>\n\n<p>With Rails 4.2 in place, the protection seems to be preventing any POST requests from succeeding. After researching it further, I found that Rails 4 encrypts auth cookies before sending them to the web server, whereas Rails 3 did not, and that it's a good practice to use the Rails 3 cookie until all your users are up to Rails 4. I commented out the secret_key_base definition which I'd created as part of the migration and I cleared out my browser cache, so to my understanding, I should now be using the unencrypted Rails 3 cookie.</p>\n\n<p>However, my POST requests still throw 500s. I can't share much code but I've referenced <a href=\"https://guides.rubyonrails.org/security.html#cross-site-request-forgery-csrf\" rel=\"nofollow noreferrer\">this official guide</a> and I do have this line in my application controller: </p>\n\n<pre><code>protect_from_forgery with: :exception\n</code></pre>\n\n<p>I've also verified that if I comment out the protection and use:</p>\n\n<pre><code>skip_before_action :verify_authenticity_token\n</code></pre>\n\n<p>then the POST requests succeed (they are just very insecure).</p>\n\n<p>Most of what I've read seems to indicate that this feature depends on the protect_from_forgery line I showed above, and that's it.</p>\n\n<p>I cannot seem to get these requests to succeed and I wonder if it's just another layer of knowledge I haven't yet picked up. Would very much appreciate any help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundler"], "comments": [{"owner": {"reputation": 6933, "user_id": 26604, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e94ddf54b3d31c6eda0e1c76a58c3e74?s=128&d=identicon&r=PG", "display_name": "Kyle Heironimus", "link": "https://stackoverflow.com/users/26604/kyle-heironimus"}, "edited": false, "score": 0, "creation_date": 1542074117, "post_id": 53271753, "comment_id": 93428462, "body": "Have you tried removing multi_json from your Gemfile and trying again? Maybe uninstall multi_json and try again."}, {"owner": {"reputation": 1605, "user_id": 3854235, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f3ca815da990f564c2f05c75a554a548?s=128&d=identicon&r=PG", "display_name": "mgig", "link": "https://stackoverflow.com/users/3854235/mgig"}, "reply_to_user": {"reputation": 6933, "user_id": 26604, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e94ddf54b3d31c6eda0e1c76a58c3e74?s=128&d=identicon&r=PG", "display_name": "Kyle Heironimus", "link": "https://stackoverflow.com/users/26604/kyle-heironimus"}, "edited": false, "score": 0, "creation_date": 1542394339, "post_id": 53271753, "comment_id": 93566428, "body": "Yes, and that didn&#39;t do the trick."}], "owner": {"reputation": 1605, "user_id": 3854235, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f3ca815da990f564c2f05c75a554a548?s=128&d=identicon&r=PG", "display_name": "mgig", "link": "https://stackoverflow.com/users/3854235/mgig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 14, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542066538, "creation_date": 1542066538, "question_id": 53271753, "link": "https://stackoverflow.com/questions/53271753/why-do-i-get-a-systemstackerror-when-running-bundle-install", "title": "Why do I get a SystemStackError when running `bundle install`?", "body": "<p>I'm trying to setup my ruby environment, and I keep getting the following <strong><code>SystemStackError</code></strong> error message:</p>\n\n<pre><code>$ bundle install\nWarning: No private key present, creating unsigned gem.\nWarning: No private key present, creating unsigned gem.\nWarning: No private key present, creating unsigned gem.\nFetching gem metadata from http://rubygems.org/...........\nFetching additional metadata from http://rubygems.org/..\nResolving dependencies...\nUsing rake (11.1.2)\nUsing concurrent-ruby (1.1.3)\nUsing i18n (0.9.5)\n\nSystemStackError: stack level too deep\nAn error occurred while installing multi_json (1.5.0), and Bundler cannot continue.\nMake sure that `gem install multi_json -v '1.5.0'` succeeds before bundling.\n</code></pre>\n\n<p>However, multi_json v 1.5.0 is already installed:</p>\n\n<pre><code>$ gem list | grep multi_json\nmulti_json (1.5.0)\n$\n</code></pre>\n\n<p>Any ideas how to get past this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 2504, "user_id": 3729369, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FYV4M.png?s=128&g=1", "display_name": "simonwo", "link": "https://stackoverflow.com/users/3729369/simonwo"}, "edited": false, "score": 0, "creation_date": 1542065581, "post_id": 53271568, "comment_id": 93426701, "body": "What are the outputs of the <code>which</code> calls after installation?"}, {"owner": {"reputation": 1605, "user_id": 3854235, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f3ca815da990f564c2f05c75a554a548?s=128&d=identicon&r=PG", "display_name": "mgig", "link": "https://stackoverflow.com/users/3854235/mgig"}, "reply_to_user": {"reputation": 2504, "user_id": 3729369, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FYV4M.png?s=128&g=1", "display_name": "simonwo", "link": "https://stackoverflow.com/users/3729369/simonwo"}, "edited": false, "score": 0, "creation_date": 1542065668, "post_id": 53271568, "comment_id": 93426721, "body": "They point to the same directory. I&#39;ll update the question to include it."}], "owner": {"reputation": 1605, "user_id": 3854235, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f3ca815da990f564c2f05c75a554a548?s=128&d=identicon&r=PG", "display_name": "mgig", "link": "https://stackoverflow.com/users/3854235/mgig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542065797, "creation_date": 1542065146, "last_edit_date": 1542065797, "question_id": 53271568, "link": "https://stackoverflow.com/questions/53271568/gem-not-installing-bundler-properly", "title": "gem not installing bundler properly", "body": "<p>I'm trying to install <code>bundle</code> v. 1.5.2 and I'm having some trouble getting the correct version. Strangely, when I use <code>gem</code> to install bundler, I get two different versions for <code>bundle</code> and <code>bundler</code> even though <a href=\"https://stackoverflow.com/a/43299367/3854235\">this</a> SO answer says they should be the same. Here are a few commands that show the odd behavior:</p>\n\n<pre><code>$ which bundle\n$ which bundler\n$ gem install bundler -v 1.5.2\nFetching: bundler-1.5.2.gem (100%)\nSuccessfully installed bundler-1.5.2\n1 gem installed\nInstalling ri documentation for bundler-1.5.2...\nBuilding YARD (yri) index for bundler-1.5.2...\nInstalling RDoc documentation for bundler-1.5.2...\n$ bundle -v\nBundler version 1.5.2\n$ bundler -v\nWarning: No private key present, creating unsigned gem.\nWarning: No private key present, creating unsigned gem.\nWarning: No private key present, creating unsigned gem.\nIt's recommended to use Bundler through 'bundle' binary instead of 'bundler'\nBundler version 1.16.2\n$ which bundler\n/Users/me/.rvm/gems/ruby-2.2.0@my-gem-set/bin/bundler\n$ which bundle\n/Users/me/.rvm/gems/ruby-2.2.0@my-gem-set/bin/bundle\n</code></pre>\n\n<p>Any ideas why I get different versions for <code>bundle</code> and <code>bundler</code>?</p>\n"}, {"tags": ["ruby", "rubygems", "jekyll", "github-pages"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 10640792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uRNd2.jpg?s=128&g=1", "display_name": "Ma&#235;l", "link": "https://stackoverflow.com/users/10640792/ma%c3%abl"}, "edited": false, "score": 0, "creation_date": 1542561135, "post_id": 53349092, "comment_id": 93603503, "body": "Thanks for your answer! But as I understand it, Ruby Devkit is only for Windows systems"}], "tags": [], "owner": {"reputation": 1011, "user_id": 2020118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262846d489a03db9b88bb4ecedd5a2ae?s=128&d=identicon&r=PG", "display_name": "Ron", "link": "https://stackoverflow.com/users/2020118/ron"}, "is_accepted": false, "score": 0, "last_activity_date": 1542438991, "creation_date": 1542438991, "answer_id": 53349092, "question_id": 53270401, "link": "https://stackoverflow.com/questions/53270401/why-is-my-jekyll-command-not-working-anymore/53349092#53349092", "title": "Why is my jekyll command not working anymore?", "body": "<p>I'm not a mac user and not real familiar with ruby, but when I see <code>ERROR: Failed to build gem native extension</code> it usually has to do with not having the ruby version that includes the devkit.</p>\n\n<p>As I understand it, you can get ruby with the devkit or ruby without the devkit, if there is no devkit it can't build some of the gems it needs. On a PC the devkit is required in order to install all of the jekyll dependencies.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 10640792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uRNd2.jpg?s=128&g=1", "display_name": "Ma&#235;l", "link": "https://stackoverflow.com/users/10640792/ma%c3%abl"}, "is_accepted": true, "score": -1, "last_activity_date": 1542561017, "creation_date": 1542561017, "answer_id": 53363449, "question_id": 53270401, "link": "https://stackoverflow.com/questions/53270401/why-is-my-jekyll-command-not-working-anymore/53363449#53363449", "title": "Why is my jekyll command not working anymore?", "body": "<p>I found a solution, that I think is very not clean, but works for now.</p>\n\n<p>I have two directories in <code>/Library/Ruby/Gems/</code>:</p>\n\n<ul>\n<li><code>2.0.0/</code>\n\n<ul>\n<li><code>gems/</code></li>\n<li><code>specifications/</code></li>\n<li><code>...</code></li>\n</ul></li>\n<li><code>2.3.0/</code>\n\n<ul>\n<li><code>gems/</code></li>\n<li><code>specifications/</code></li>\n<li><code>...</code></li>\n</ul></li>\n</ul>\n\n<p>The error output, when I try to run jekyll, tells that it checks (among others) in <code>/Library/Ruby/Gems/2.3.0</code>, but as I said in my question, there aren't any jekyll-related file in there.</p>\n\n<p>So, I manually copied all the files from <code>/Library/Ruby/Gems/2.0.0/gems</code> and <code>/Library/Ruby/Gems/2.0.0/specifications</code> and pasted them in <code>/Library/Ruby/Gems/2.3.0/gems</code> and <code>/Library/Ruby/Gems/2.3.0/specifications</code> respectively.</p>\n\n<p>I guess that the files I've copied are maybe outdated for the Ruby version I have (?), but it works perfectly.</p>\n\n<p>Maybe there is a more conventional way to make it work?</p>\n"}, {"comments": [{"owner": {"reputation": 1364, "user_id": 1379826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MQPSd.jpg?s=128&g=1", "display_name": "Sos", "link": "https://stackoverflow.com/users/1379826/sos"}, "edited": false, "score": 1, "creation_date": 1553679265, "post_id": 53645055, "comment_id": 97469985, "body": "I came across the same problem and used this answer in Ruby 2.4.0 and worked well. Thanks!"}, {"owner": {"reputation": 3524, "user_id": 1823497, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iXkgX.jpg?s=128&g=1", "display_name": "Mohammad Jafar Mashhadi", "link": "https://stackoverflow.com/users/1823497/mohammad-jafar-mashhadi"}, "edited": false, "score": 0, "creation_date": 1599351555, "post_id": 53645055, "comment_id": 112748530, "body": "Yup, I&#39;m on OSX Catalina and 2.3.3 can&#39;t be installed but 2.4.0 works"}], "tags": [], "owner": {"reputation": 51, "user_id": 7869673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe6019b03d7ec90a755dcb4abbeff32?s=128&d=identicon&r=PG&f=1", "display_name": "sding", "link": "https://stackoverflow.com/users/7869673/sding"}, "is_accepted": false, "score": 5, "last_activity_date": 1544073435, "creation_date": 1544073435, "answer_id": 53645055, "question_id": 53270401, "link": "https://stackoverflow.com/questions/53270401/why-is-my-jekyll-command-not-working-anymore/53645055#53645055", "title": "Why is my jekyll command not working anymore?", "body": "<p>I also don't work with Ruby, but I had a similar problem on Mac OS 10.12.6 and here is how I solved it.</p>\n\n<p>This is likely caused by some disagreement between the system Ruby environment and Jekyll, and the easiest way to fix it is to create a new environment altogether.</p>\n\n<p>First you should use <a href=\"https://rvm.io\" rel=\"noreferrer\">rvm</a> to manage your ruby versions to avoid delete the system Ruby and break your OS. After you set up rvm, run</p>\n\n<pre><code>rvm install 2.3.3\n</code></pre>\n\n<p>to install Ruby 2.3.3 (which is what I used). After it finished, make this the default Ruby version in your system:</p>\n\n<pre><code>rvm --default use 2.3.3\n</code></pre>\n\n<p>then I did the following:</p>\n\n<pre><code>gem install bundler\ngem install jekyll\nbundle install\n</code></pre>\n\n<p>and Jekyll worked for me again.</p>\n\n<p>Hope that helps.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 10640792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uRNd2.jpg?s=128&g=1", "display_name": "Ma&#235;l", "link": "https://stackoverflow.com/users/10640792/ma%c3%abl"}, "edited": false, "score": 0, "creation_date": 1548955777, "post_id": 54457221, "comment_id": 95740120, "body": "The problem I had seemed to be related to the version used by Ruby or my jekyll command, as I said in my <a href=\"https://stackoverflow.com/a/53363449/10640792\">accepted answer</a>. Are you saying that you could solve your problem with the <code>gem install bundler jekyll</code>?"}], "tags": [], "owner": {"reputation": 1, "user_id": 10994867, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P_gqd5c4MnI/AAAAAAAAAAI/AAAAAAAAE2I/clKKFy40Vcc/photo.jpg?sz=128", "display_name": "\u8b1d\u9298\u5cf0", "link": "https://stackoverflow.com/users/10994867/%e8%ac%9d%e9%8a%98%e5%b3%b0"}, "is_accepted": false, "score": 0, "last_activity_date": 1548926679, "creation_date": 1548926679, "answer_id": 54457221, "question_id": 53270401, "link": "https://stackoverflow.com/questions/53270401/why-is-my-jekyll-command-not-working-anymore/54457221#54457221", "title": "Why is my jekyll command not working anymore?", "body": "<p>I have the same problem with jeklly to bundle new website.</p>\n\n<p>try this:</p>\n\n<pre><code>xcode-select --install\ngem install bundler jekyll\n</code></pre>\n\n<p>That's the way I don't need to sudo to install bundler jekyll.</p>\n\n<pre><code>Install the Command Line Tools:\n  xcode-select --install\n\nabcLabdeMacBook-Air:zeppelin-master abclab$ xcode-select --install\nxcode-select: note: install requested for command line developer tools\nabcLabdeMacBook-Air:zeppelin-master abclab$ gem install bundler jekyll\nERROR:  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /Library/Ruby/Gems/2.3.0 directory.\nabcLabdeMacBook-Air:zeppelin-master abclab$ bundle install\nIgnoring eventmachine-1.2.7 because its extensions are not built.  Try: gem pristine eventmachine --version 1.2.7\nIgnoring ffi-1.9.25 because its extensions are not built.  Try: gem pristine ffi --version 1.9.25\nIgnoring http_parser.rb-0.6.0 because its extensions are not built.  Try: gem pristine http_parser.rb --version 0.6.0\nFetching gem metadata from http://rubygems.org/.................\nFetching gem metadata from http://rubygems.org/..\nResolving dependencies.....\nUsing concurrent-ruby 1.1.4\nFollowing files may not be writable, so sudo is needed:\n  /Library/Ruby/Gems/2.3.0\n  /Library/Ruby/Gems/2.3.0/build_info\n  /Library/Ruby/Gems/2.3.0/cache\n  /Library/Ruby/Gems/2.3.0/doc\n  /Library/Ruby/Gems/2.3.0/extensions\n  /Library/Ruby/Gems/2.3.0/gems\n  /Library/Ruby/Gems/2.3.0/specifications\nUsing i18n 0.9.5\nUsing minitest 5.11.3\nUsing thread_safe 0.3.6\nUsing tzinfo 1.2.5\nUsing activesupport 4.2.10\nUsing public_suffix 2.0.5\nUsing addressable 2.5.2\nUsing execjs 2.7.0\nUsing autoprefixer-rails 9.4.7\nUsing bundler 2.0.1\nUsing chunky_png 1.3.11\nUsing coffee-script-source 1.11.1\nUsing coffee-script 2.4.1\nUsing colorator 1.1.0\nUsing ruby-enum 0.7.2\nFetching commonmarker 0.17.13\n\n\nYour user account isn't allowed to install to the system RubyGems.\n  You can cancel this installation and run:\n\n      bundle install --path vendor/bundle\n\n  to install the gems into ./vendor/bundle/, or you can enter your password\n  and install the bundled gems to RubyGems using sudo.\n\n  Password: \n\n\nYour user account isn't allowed to install to the system RubyGems.\n  You can cancel this installation and run:\n\n      bundle install --path vendor/bundle\n\n  to install the gems into ./vendor/bundle/, or you can enter your password\n  and install the bundled gems to RubyGems using sudo.\n\n  Password: \nInstalling commonmarker 0.17.13 with native extensions\nFetching multi_json 1.13.1\nInstalling multi_json 1.13.1\nFetching sass 3.4.25\nInstalling sass 3.4.25\nFetching compass-core 1.0.3\nInstalling compass-core 1.0.3\nFetching compass-import-once 1.0.5\nInstalling compass-import-once 1.0.5\nUsing rb-fsevent 0.10.3\nFetching ffi 1.10.0\nInstalling ffi 1.10.0 with native extensions\nFetching rb-inotify 0.10.0\nInstalling rb-inotify 0.10.0\nFetching compass 1.0.3\nInstalling compass 1.0.3\nFetching dnsruby 1.61.2\nInstalling dnsruby 1.61.2\nFetching eventmachine 1.2.7\nInstalling eventmachine 1.2.7 with native extensions\nFetching http_parser.rb 0.6.0\nInstalling http_parser.rb 0.6.0 with native extensions\nUsing em-websocket 0.5.1\nFetching ethon 0.12.0\nInstalling ethon 0.12.0\nFetching multipart-post 2.0.0\nInstalling multipart-post 2.0.0\nFetching faraday 0.15.4\nInstalling faraday 0.15.4\nUsing forwardable-extended 2.6.0\nFetching gemoji 3.0.0\nInstalling gemoji 3.0.0\nFetching sawyer 0.8.1\nInstalling sawyer 0.8.1\nFetching octokit 4.13.0\nInstalling octokit 4.13.0\nFetching typhoeus 1.3.1\nInstalling typhoeus 1.3.1\nFetching github-pages-health-check 1.8.1\nInstalling github-pages-health-check 1.8.1\nUsing jekyll-sass-converter 1.5.2\nUsing ruby_dep 1.5.0\nUsing listen 3.1.5\nFetching jekyll-watch 2.1.2\nInstalling jekyll-watch 2.1.2\nUsing kramdown 1.17.0\nUsing liquid 4.0.0\nUsing mercenary 0.3.6\nFetching pathutil 0.16.2\nInstalling pathutil 0.16.2\nFetching rouge 2.2.1\nInstalling rouge 2.2.1\nUsing safe_yaml 1.0.4\nFetching jekyll 3.7.4\nInstalling jekyll 3.7.4\nFetching jekyll-avatar 0.6.0\nInstalling jekyll-avatar 0.6.0\nFetching jekyll-coffeescript 1.1.1\nInstalling jekyll-coffeescript 1.1.1\nFetching jekyll-commonmark 1.2.0\nInstalling jekyll-commonmark 1.2.0\nFetching jekyll-commonmark-ghpages 0.1.5\nInstalling jekyll-commonmark-ghpages 0.1.5\nFetching jekyll-default-layout 0.1.4\nInstalling jekyll-default-layout 0.1.4\nFetching jekyll-feed 0.11.0\nInstalling jekyll-feed 0.11.0\nFetching jekyll-gist 1.5.0\nInstalling jekyll-gist 1.5.0\nFetching jekyll-github-metadata 2.9.4\nInstalling jekyll-github-metadata 2.9.4\nFetching mini_portile2 2.4.0\nInstalling mini_portile2 2.4.0\nFetching nokogiri 1.10.1\nInstalling nokogiri 1.10.1 with native extensions\nFetching html-pipeline 2.10.0\nInstalling html-pipeline 2.10.0\nFetching jekyll-mentions 1.4.1\nInstalling jekyll-mentions 1.4.1\nFetching jekyll-optional-front-matter 0.3.0\nInstalling jekyll-optional-front-matter 0.3.0\nFetching jekyll-paginate 1.1.0\nInstalling jekyll-paginate 1.1.0\nFetching jekyll-readme-index 0.2.0\nInstalling jekyll-readme-index 0.2.0\nFetching jekyll-redirect-from 0.14.0\nInstalling jekyll-redirect-from 0.14.0\nFetching jekyll-relative-links 0.5.3\nInstalling jekyll-relative-links 0.5.3\nFetching rubyzip 1.2.2\nInstalling rubyzip 1.2.2\nFetching jekyll-remote-theme 0.3.1\nInstalling jekyll-remote-theme 0.3.1\nUsing jekyll-seo-tag 2.5.0\nFetching jekyll-sitemap 1.2.0\nInstalling jekyll-sitemap 1.2.0\nFetching jekyll-swiss 0.4.0\nInstalling jekyll-swiss 0.4.0\nFetching jekyll-theme-architect 0.1.1\nInstalling jekyll-theme-architect 0.1.1\nFetching jekyll-theme-cayman 0.1.1\nInstalling jekyll-theme-cayman 0.1.1\nFetching jekyll-theme-dinky 0.1.1\nInstalling jekyll-theme-dinky 0.1.1\nFetching jekyll-theme-hacker 0.1.1\nInstalling jekyll-theme-hacker 0.1.1\nFetching jekyll-theme-leap-day 0.1.1\nInstalling jekyll-theme-leap-day 0.1.1\nFetching jekyll-theme-merlot 0.1.1\nInstalling jekyll-theme-merlot 0.1.1\nFetching jekyll-theme-midnight 0.1.1\nInstalling jekyll-theme-midnight 0.1.1\nFetching jekyll-theme-minimal 0.1.1\nInstalling jekyll-theme-minimal 0.1.1\nFetching jekyll-theme-modernist 0.1.1\nInstalling jekyll-theme-modernist 0.1.1\nFetching jekyll-theme-primer 0.5.3\nInstalling jekyll-theme-primer 0.5.3\nFetching jekyll-theme-slate 0.1.1\nInstalling jekyll-theme-slate 0.1.1\nFetching jekyll-theme-tactile 0.1.1\nInstalling jekyll-theme-tactile 0.1.1\nFetching jekyll-theme-time-machine 0.1.1\nInstalling jekyll-theme-time-machine 0.1.1\nFetching jekyll-titles-from-headings 0.5.1\nInstalling jekyll-titles-from-headings 0.5.1\nFetching jemoji 0.10.1\nInstalling jemoji 0.10.1\nUsing minima 2.5.0\nFetching unicode-display_width 1.4.1\nInstalling unicode-display_width 1.4.1\nFetching terminal-table 1.8.0\nInstalling terminal-table 1.8.0\nFetching github-pages 193\nInstalling github-pages 193\nFetching sass-media_query_combiner 0.0.7\nInstalling sass-media_query_combiner 0.0.7\nBundle complete! 4 Gemfile dependencies, 91 gems now installed.\nUse `bundle info [gemname]` to see where a bundled gem is installed.\nPost-install message from compass:\n    Compass is charityware. If you love it, please donate on our behalf at http://umdf.org/compass Thanks!\nPost-install message from dnsruby:\nInstalling dnsruby...\n  For issues and source code: https://github.com/alexdalitz/dnsruby\n  For general discussion (please tell us how you use dnsruby): https://groups.google.com/forum/#!forum/dnsruby\nPost-install message from html-pipeline:\n-------------------------------------------------\nThank you for installing html-pipeline!\nYou must bundle Filter gem dependencies.\nSee html-pipeline README.md for more details.\nhttps://github.com/jch/html-pipeline#dependencies\n-------------------------------------------------\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 107, "user_id": 10153071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XHS8k.jpg?s=128&g=1", "display_name": "Jimut123", "link": "https://stackoverflow.com/users/10153071/jimut123"}, "is_accepted": false, "score": 0, "last_activity_date": 1598541290, "creation_date": 1598541290, "answer_id": 63619089, "question_id": 53270401, "link": "https://stackoverflow.com/questions/53270401/why-is-my-jekyll-command-not-working-anymore/63619089#63619089", "title": "Why is my jekyll command not working anymore?", "body": "<p>It might also be that you have mistakenly installed multiple dependencies of Jekyll. In that case</p>\n<pre><code>$ /usr/bin/jekyll serve\n</code></pre>\n<p>might work, or remove the one or more installation of Jekyll.</p>\n<p>Find</p>\n<p><code>$ whereis jekyll</code></p>\n<p>and then keep the above one and remove the rest of the installations.</p>\n"}], "owner": {"reputation": 91, "user_id": 10640792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uRNd2.jpg?s=128&g=1", "display_name": "Ma&#235;l", "link": "https://stackoverflow.com/users/10640792/ma%c3%abl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4351, "favorite_count": 2, "accepted_answer_id": 53363449, "answer_count": 5, "score": 9, "last_activity_date": 1598541290, "creation_date": 1542058302, "last_edit_date": 1542060571, "question_id": 53270401, "link": "https://stackoverflow.com/questions/53270401/why-is-my-jekyll-command-not-working-anymore", "title": "Why is my jekyll command not working anymore?", "body": "<p>I've recently discovered that the <code>jekyll</code> command doesn't work anymore on my computer, after perfectly using it for several months.</p>\n\n<p>Whenever I try to run a <code>jekyll</code> command, it says:</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/dependency.rb:319:in `to_specs':\n    Could not find 'jekyll' (&gt;= 0) among 34 total gem(s) (Gem::LoadError)\nChecked in 'GEM_PATH=/Users/Mael/.gem/ruby/2.3.0:/Library/Ruby/Gems/2.3.0:/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/gems/2.3.0',\n    execute `gem env` for more information\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/dependency.rb:328:in `to_spec'\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_gem.rb:65:in `gem'\n    from /usr/local/bin/jekyll:22:in `&lt;main&gt;'\n</code></pre>\n\n<p>I'm on macOS Sierra (10.12.6).</p>\n\n<h1>Xcode is installed</h1>\n\n<p>I have Xcode installed on my computer:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ xcode-select --install\nxcode-select: error: command line tools are already installed, use \"Software Update\" to install updates\n</code></pre>\n\n<h1>Reinstalling Jekyll</h1>\n\n<h2>Checking ruby version and (re)installing bundler</h2>\n\n<p>So I tried reinstalling Jekyll as I did the first time:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ ruby -v\nruby 2.3.7p456 (2018-03-28 revision 63024) [universal.x86_64-darwin16]\n\n$ sudo gem install bundler\nSuccessfully installed bundler-1.17.1\nParsing documentation for bundler-1.17.1\nDone installing documentation for bundler after 4 seconds\n1 gem installed\n</code></pre>\n\n<h2>Creating a Gemfile</h2>\n\n<p>I created a Gemfile which contains:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>gem 'github-pages'\nsource 'https://rubygems.org'\n</code></pre>\n\n<h2>Bundle install (here come the issues)</h2>\n\n<p>And ran, in the directory that contains the Gemfile:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ bundle install\n</code></pre>\n\n<p>Here, the installation doesn't work, it says:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>An error occurred while installing commonmarker (0.17.13), and Bundler cannot continue.\nMake sure that `gem install commonmarker -v '0.17.13' --source 'https://rubygems.org/'` succeeds before bundling.\n\nIn Gemfile:\n  github-pages was resolved to 192, which depends on\n    jekyll-commonmark-ghpages was resolved to 0.1.5, which depends on\n      jekyll-commonmark was resolved to 1.2.0, which depends on\n        commonmarker\n</code></pre>\n\n<p>So I tried the <code>gem install commonmarker -v '0.17.13' --source 'https://rubygems.org/'</code> command, and it says:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Building native extensions.  This could take a while...\nERROR:  Error installing commonmarker:\n        ERROR: Failed to build gem native extension.\n\n    current directory: /Library/Ruby/Gems/2.3.0/gems/commonmarker-0.17.13/ext/commonmarker\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby -r ./siteconf20181112-6105-u9aca2.rb extconf.rb\ncreating Makefile\n\ncurrent directory: /Library/Ruby/Gems/2.3.0/gems/commonmarker-0.17.13/ext/commonmarker\nmake \"DESTDIR=\" clean\n\ncurrent directory: /Library/Ruby/Gems/2.3.0/gems/commonmarker-0.17.13/ext/commonmarker\nmake \"DESTDIR=\"\nmake: *** No rule to make target `/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/include/ruby-2.3.0/universal-darwin16/ruby/config.h', needed by `arena.o'.  Stop.\n\nmake failed, exit code 2\n\nGem files will remain installed in /Library/Ruby/Gems/2.3.0/gems/commonmarker-0.17.13 for inspection.\nResults logged to /Library/Ruby/Gems/2.3.0/extensions/universal-darwin-16/2.3.0/commonmarker-0.17.13/gem_make.out\n</code></pre>\n\n<p>I noticed that I have several <code>jekyll</code> and <code>github-pages</code> <em>gems</em> in my <code>/Library/Ruby/Gems/2.0.0/gems</code> <strong>(2.0.0)</strong> directory:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>github-pages-146\ngithub-pages-health-check-1.3.5\n...\njekyll-3.4.5\njekyll-avatar-0.4.2\njekyll-coffeescript-1.0.1\n[and several other jekyll directories]\n...\n</code></pre>\n\n<p>But not in my <code>/Library/Ruby/Gems/2.3.0/gems</code> <strong>(2.3.0)</strong> directory! (the one which seems to be targeted by the <code>GEM_PATH</code> when running a <code>jekyll</code> command)</p>\n\n<p>So, maybe I did something that changed the version or something. (I've recently installed <code>osxfuse</code> and <code>sshfs</code> (via brew), I don't know if it has anything to do with the issue?)</p>\n\n<p>I don't know anything about Ruby, Gems system, and so on. Maybe the solution is obvious but I've tried several things with no success.</p>\n\n<p>(Sorry it's a bit long but I wanted to be as clear as possible!)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongoid"], "answers": [{"tags": [], "owner": {"reputation": 1377, "user_id": 3011280, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mkyAT.jpg?s=128&g=1", "display_name": "Oshan Wisumperuma", "link": "https://stackoverflow.com/users/3011280/oshan-wisumperuma"}, "is_accepted": false, "score": 2, "last_activity_date": 1547564367, "creation_date": 1547564367, "answer_id": 54201451, "question_id": 53269948, "link": "https://stackoverflow.com/questions/53269948/how-to-nested-eager-loading-in-mongoid/54201451#54201451", "title": "How to nested eager loading in mongoid?", "body": "<p>according this <a href=\"https://maximomussini.com/posts/mongoid_includes/\" rel=\"nofollow noreferrer\">blog</a></p>\n\n<blockquote>\n  <p>Although Mongoid provides eager loading support out of the box, it has\n  a few limitations:</p>\n  \n  <ul>\n  <li><p>No Nested: Only direct relations can be eager loaded.</p></li>\n  <li><p>No Polymorphic: Polymorphic relations can\u2019t be included.</p></li>\n  <li>Criteria-only: It\u2019s only possible to use eager loading with a Mongoid::Criteria object.</li>\n  </ul>\n</blockquote>\n\n<p>and also there is a <a href=\"https://github.com/ElMassimo/mongoid_includes\" rel=\"nofollow noreferrer\">solution</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10642767, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BUjQo8RTh0c/AAAAAAAAAAI/AAAAAAACOOQ/jjMnx7BjekM/photo.jpg?sz=128", "display_name": "Arina", "link": "https://stackoverflow.com/users/10642767/arina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547564367, "creation_date": 1542056076, "question_id": 53269948, "link": "https://stackoverflow.com/questions/53269948/how-to-nested-eager-loading-in-mongoid", "title": "How to nested eager loading in mongoid?", "body": "<pre><code>Class Band\n  include Mongoid::Document\n  has_many :albums\nend\n\nClass Album\n  include Mongoid::Document\n  has_many :musics\n  belongs_to :band\nend\n\nClass Music\n  include Mongoid::Document\n  belongs_to :album\nend\n</code></pre>\n\n<p>when I do this,\n@bands = Band.includes(albums: [:musics])</p>\n\n<p>albums are included successfully.\nmusics are not included.\nbullet says \"AVOID eager loading detected Band=>[:musics]\"\nhow can I include musics?</p>\n"}, {"tags": ["ruby", "dry-rb", "dry-types", "dry-struct"], "answers": [{"comments": [{"owner": {"reputation": 19714, "user_id": 1006863, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/sYOuq.jpg?s=128&g=1", "display_name": "Paulo Fidalgo", "link": "https://stackoverflow.com/users/1006863/paulo-fidalgo"}, "edited": false, "score": 0, "creation_date": 1542122809, "post_id": 53270221, "comment_id": 93450383, "body": "Even knowing that dry-struct is not meant to use as validator, for the most cases I have (data mapping between the database and XML) is fit&#39;s perfectly, as it&#39;s simple and efective. For more complex cases, your sugestion works fine, thank you."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 8, "last_activity_date": 1542063754, "last_edit_date": 1542063754, "creation_date": 1542057299, "answer_id": 53270221, "question_id": 53269946, "link": "https://stackoverflow.com/questions/53269946/dry-struct-how-to-conditionally-validate-one-attribute/53270221#53270221", "title": "dry-struct How to conditionally validate one attribute?", "body": "<p><code>dry-struct</code> is really for basic type assertion and coercion. </p>\n\n<p>If you want more complex validation then you probably want to implement <a href=\"https://dry-rb.org/gems/dry-validation/\" rel=\"noreferrer\"><code>dry-validation</code></a> as well (as recommended by <code>dry-rb</code>) </p>\n\n<p>See <a href=\"https://dry-rb.org/gems/dry-struct/\" rel=\"noreferrer\">Validating data with dry-struct</a> which states </p>\n\n<blockquote>\n  <p>Please don\u2019t. Structs are meant to work with valid input, it cannot generate error messages good enough for displaying them for a user etc. Use dry-validation for validating incoming data and then pass its output to structs.</p>\n</blockquote>\n\n<p>The conditional validation using <code>dry-validation</code> would be something like </p>\n\n<pre><code>TaxValidation = Dry::Validation.Schema do\n\n  # Could be:\n  #   required(:tax_type).filled(:str?, \n  #      size?: 2..3, \n  #      included_in?: %w(IVA IS NS)) \n  # but since we are validating against a list of Strings I figured the rest was implied\n  required(:tax_type).filled(included_in?: %w(IVA IS NS)) \n  optional(:tax_amount).maybe(:int?)\n\n  # rule name is of your choosing and will be used \n  # as the errors key (i just chose `tax_amount` for consistency)\n  rule(tax_amount:[:tax_type, :tax_amount]) do |tax_type, tax_amount|\n    tax_type.eql?('IS').then(tax_amount.filled?) \n  end\nend\n</code></pre>\n\n<ul>\n<li>This requires <code>tax_type</code> to be in the <code>%w(IVA IS NS)</code> list; </li>\n<li>Allows <code>tax_amount</code> to be optional but if it is filled in it must be an <code>Integer</code> (<code>int?</code>) and; </li>\n<li>If <code>tax_type == 'IS'</code> (<code>eql?('IS')</code>) then <code>tax_amount</code> must be filled in (which means it must be an <code>Integer</code> based on the rule above).</li>\n</ul>\n\n<p>Obviously you can validate your other inputs as well but I left these out for the sake of brevity. </p>\n\n<p>Examples: </p>\n\n<pre><code>TaxValidation.({}).success?\n#=&gt; false\nTaxValidation.({}).errors\n# =&gt; {:tax_type=&gt;[\"is missing\"]}\nTaxValidation.({tax_type: 'NO'}).errors\n#=&gt;  {:tax_type=&gt;[\"must be one of: IVA, IS, NS\"]}\nTaxValidation.({tax_type: 'NS'}).errors\n#=&gt;  {}\nTaxValidation.({tax_type: 'IS'}).errors\n#=&gt; {:tax_amount=&gt;[\"must be filled\"]}\nTaxValidation.({tax_type: 'IS',tax_amount:'NO'}).errors\n#=&gt; {:tax_amount=&gt;[\"must be an integer\"]}\nTaxValidation.({tax_type: 'NS',tax_amount:12}).errors \n#=&gt; {}\nTaxValidation.({tax_type: 'NS',tax_amount:12}).success?\n#=&gt; true \n</code></pre>\n"}], "owner": {"reputation": 19714, "user_id": 1006863, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/sYOuq.jpg?s=128&g=1", "display_name": "Paulo Fidalgo", "link": "https://stackoverflow.com/users/1006863/paulo-fidalgo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "accepted_answer_id": 53270221, "answer_count": 1, "score": 2, "last_activity_date": 1542063754, "creation_date": 1542056070, "question_id": 53269946, "link": "https://stackoverflow.com/questions/53269946/dry-struct-how-to-conditionally-validate-one-attribute", "title": "dry-struct How to conditionally validate one attribute?", "body": "<p>I'm using dry-types and dry-struct and I would like to have a conditional validation.</p>\n\n<p>for the class:</p>\n\n<pre><code>class Tax &lt; Dry::Struct\n  attribute :tax_type, Types::String.constrained(min_size: 2, max_size: 3, included_in: %w[IVA IS NS])\n  attribute :tax_country_region, Types::String.constrained(max_size: 5)\n  attribute :tax_code, Types::String.constrained(max_size: 10)\n  attribute :description, Types::String.constrained(max_size: 255)\n  attribute :tax_percentage, Types::Integer\n  attribute :tax_ammount, Types::Integer.optional\nend\n</code></pre>\n\n<p>I want to validate <code>tax_ammount</code> as an Integer and mandatory <strong>if</strong> `tax_type == 'IS'.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1542052432, "post_id": 53267596, "comment_id": 93422138, "body": "possible duplicate of <a href=\"https://stackoverflow.com/questions/37799296/what-does-the-comment-frozen-string-literal-true-do#37799399\" title=\"what does the comment frozen string literal true do%2337799399\">stackoverflow.com/questions/37799296/&hellip;</a>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1542056971, "post_id": 53267596, "comment_id": 93423957, "body": "The difference is that the first one works and the second one has nothing to do with Ruby and thus doesn&#39;t do anything.#"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 3, "last_activity_date": 1542054526, "last_edit_date": 1542054526, "creation_date": 1542054185, "answer_id": 53269549, "question_id": 53267596, "link": "https://stackoverflow.com/questions/53267596/ruby-magic-comments-frozen-string-literal-true-vs-immutable-string/53269549#53269549", "title": "Ruby: magic comments &quot;frozen_string_literal: true&quot; vs &quot;immutable: string&quot;", "body": "<p>Digging for anything on the 2nd version, it looks like they had the same intention but the 2nd magic comment syntax does not to appear to have been adopted as of Ruby 2.1.0. </p>\n\n<p>See <a href=\"https://github.com/ruby/ruby/pull/487\" rel=\"nofollow noreferrer\">https://github.com/ruby/ruby/pull/487</a></p>\n\n<p>The first version <code># frozen_string_literal: true</code> was adopted in Ruby 2.3.0 </p>\n\n<p>I tried the latter version in a few versions of ruby but didn't work.  I would guess it should not be used or trusted to work in any version of <code>&gt;= 2.3</code> but probably no versions support it.  In fact, I was not able to find any reference to that version in the open source code on github searching that syntax</p>\n\n<p><a href=\"https://github.com/ruby/ruby/search?q=immutable%3A+string&amp;unscoped_q=immutable%3A+string\" rel=\"nofollow noreferrer\">https://github.com/ruby/ruby/search?q=immutable%3A+string&amp;unscoped_q=immutable%3A+string</a></p>\n"}, {"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1542057382, "post_id": 53269670, "comment_id": 93424104, "body": "are you sure 1st version works in Ruby &lt; 2.3 ?? , I tested 2.1.2 and it does not."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9903"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1542059563, "post_id": 53269670, "comment_id": 93424909, "body": "@lacostenycoder apparently the feature was targeted for 2.1 but ended up being in 2.2: <a href=\"https://bugs.ruby-lang.org/issues/9278\" rel=\"nofollow noreferrer\">bugs.ruby-lang.org/issues/9278</a> but it looks like it&#39;s 2.3+ only :/"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9903"}, "is_accepted": false, "score": 6, "last_activity_date": 1542059688, "last_edit_date": 1542059688, "creation_date": 1542054756, "answer_id": 53269670, "question_id": 53267596, "link": "https://stackoverflow.com/questions/53267596/ruby-magic-comments-frozen-string-literal-true-vs-immutable-string/53269670#53269670", "title": "Ruby: magic comments &quot;frozen_string_literal: true&quot; vs &quot;immutable: string&quot;", "body": "<p>The 1st syntax is the magic comment for Ruby 2.3+ versions to freeze string literals, otherwise you have to use the String method like this:</p>\n\n<pre><code>'hello world!'.freeze\n</code></pre>\n\n<p>The 2nd syntax is not implemented in Ruby, however it is the <a href=\"https://www.gnu.org/software/emacs/manual/html_node/emacs/Specifying-File-Variables.html\" rel=\"nofollow noreferrer\">way that variables are specified for files in the Emacs text editor</a>.</p>\n\n<p>For example, the following comment in Emacs would declare that the file is a Ruby file and needs Ruby syntax highlighting, and that the variable <code>immutable</code> is set to the value <code>string</code>.</p>\n\n<pre><code># -*- mode: ruby; immutable: string -*-\n</code></pre>\n\n<p>After searching around, it looks like that does nothing and is not used by any Ruby syntax highlighting mode.</p>\n\n<p>So you do not need the 2nd syntax.</p>\n"}], "owner": {"reputation": 485, "user_id": 3510513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f6da8d55e969ef2509c9716da0979af?s=128&d=identicon&r=PG&f=1", "display_name": "dCSeven", "link": "https://stackoverflow.com/users/3510513/dcseven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1327, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1542059688, "creation_date": 1542045319, "question_id": 53267596, "link": "https://stackoverflow.com/questions/53267596/ruby-magic-comments-frozen-string-literal-true-vs-immutable-string", "title": "Ruby: magic comments &quot;frozen_string_literal: true&quot; vs &quot;immutable: string&quot;", "body": "<p>In ruby one can freeze all constant strings in a file via two different magic comments at the beginning of a file:</p>\n\n<pre><code># frozen_string_literal: true\n</code></pre>\n\n<p>and</p>\n\n<pre><code># -*- immutable: string -*-\n</code></pre>\n\n<p>I have no idea what the differences are.\nAre there any?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cancancan"], "comments": [{"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1542045289, "post_id": 53267426, "comment_id": 93419277, "body": "Do you mean that user can destroy a server if <i>all</i> applications on that <code>server</code> are owned by them?"}], "answers": [{"tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 0, "last_activity_date": 1542045545, "creation_date": 1542045545, "answer_id": 53267647, "question_id": 53267426, "link": "https://stackoverflow.com/questions/53267426/conditional-cancancan-abilities/53267647#53267647", "title": "Conditional CanCanCan Abilities", "body": "<p><code>Enumerable#each</code> returns object <code>self</code>, you probably want <code>.all?</code> or <code>.any?</code>:</p>\n\n<pre><code>can :destroy, ClientServer do |server|\n  server.client_applications.all?{|app| app.application_owner_email == user.email }\nend\n</code></pre>\n\n<p>Note that <code>all?</code> returns <code>true</code> for empty array.</p>\n\n<p>Also note that abilities with blocks cannot generate scopes and are usually slower.</p>\n"}], "owner": {"reputation": 503, "user_id": 5057085, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/hDmH7.jpg?s=128&g=1", "display_name": "Coder_Nick", "link": "https://stackoverflow.com/users/5057085/coder-nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542045545, "creation_date": 1542044582, "last_edit_date": 1542045399, "question_id": 53267426, "link": "https://stackoverflow.com/questions/53267426/conditional-cancancan-abilities", "title": "Conditional CanCanCan Abilities", "body": "<p>I have a ClientServer that has many ClientApplications. I want users to only be able to destroy Servers that are associated with them. Every ClientApplication object has an application_owner_email that is matched against the current_user. If the emails match, they should have destroy permission for the associated Server. \nIn the abilities.rb, I have the following</p>\n\n<pre><code>if user.has_role?(:application_owner)\n can :destroy, ClientServer.all.each do |server|\n  server.client_applications.each do |app|\n   app.application_owner_email == user.email\n  end\nend\n</code></pre>\n\n<p>But this isn't working. I have set up similar conditions. For instance, the below condition works fine:</p>\n\n<pre><code>can :destroy, ClientApplication.all.each do |app|\n  app.application_owner_email == user.email\nend\n</code></pre>\n\n<p>A user can only destroy ClientApplications where they are the application_owner. </p>\n\n<p>Any help on this would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1542041507, "post_id": 53266564, "comment_id": 93417430, "body": "Hint: Helper methods or methods on the model that can help compute things."}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 8890874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af4dad9c030a08884a52311b722398c3?s=128&d=identicon&r=PG&f=1", "display_name": "Maksim P", "link": "https://stackoverflow.com/users/8890874/maksim-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1542042857, "creation_date": 1542042857, "answer_id": 53267021, "question_id": 53266564, "link": "https://stackoverflow.com/questions/53266564/how-to-extract-logic-from-views/53267021#53267021", "title": "How to extract logic from views", "body": "<p>You can create helper: app/helpers/consumptions_helper.rb</p>\n\n<pre><code>module ConsumptionsHelper\n def some_logic\n   ...\n end\nend\n</code></pre>\n\n<p>and use it in the view</p>\n\n<pre><code>&lt;%= some_logic %&gt;\n</code></pre>\n\n<p>Please check RoR doc here\n<a href=\"https://api.rubyonrails.org/classes/ActionController/Helpers.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActionController/Helpers.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 1, "last_activity_date": 1542043448, "creation_date": 1542043448, "answer_id": 53267144, "question_id": 53266564, "link": "https://stackoverflow.com/questions/53266564/how-to-extract-logic-from-views/53267144#53267144", "title": "How to extract logic from views", "body": "<p>Why not add the logic to your <code>ConsumptionSearch</code> class? You are already abstracting logic to it. And, you are already accessing it in the view. So, perhaps something like:</p>\n\n<pre><code>class ConsumptionSearch \n  attr_reader :date_from, :date_to\n\n    def initialize(params)\n      params ||= {}\n      @date_from = parsed_date(params[:date_from],Time.now.beginning_of_month.to_date.to_s)\n      @date_to   = parsed_date(params[:date_to], (Date.today + 1).to_s)\n    end\n\n    def date_range\n      Consumption.where('created_at BETWEEN ? AND ?', @date_from, @date_to)\n    end\n\n    def price\n      ...\n    end\n\n    def total_km\n      ...\n    end\n\n    def price_per_km(round_to)\n      (price/total_km).round(round_to)\n    end\n\n  private\n\n    def parsed_date(date_string, default)\n      Date.parse(date_string)\n      rescue ArgumentError, TypeError\n      default\n    end\nend\n</code></pre>\n\n<p>And then in view:</p>\n\n<pre><code>&lt;%= @consumptions.price %&gt; \n&lt;%= @consumptions.total_km %&gt;\n&lt;%= @consumptions.price_per_km(4) %&gt; \n&lt;%= @consumptions.price_per_km(2) %&gt;\n</code></pre>\n\n<p>Personally, <code>helpers</code> are not my favorite thing. But, I realize that some people use them regularly and with great success. I'm just odd that way. </p>\n"}], "owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 53267021, "answer_count": 2, "score": 0, "last_activity_date": 1576701923, "creation_date": 1542041051, "last_edit_date": 1576701923, "question_id": 53266564, "link": "https://stackoverflow.com/questions/53266564/how-to-extract-logic-from-views", "title": "How to extract logic from views", "body": "<p>In my app I can search <code>consumptions</code> by dates.</p>\n\n<p>I have an active record model <code>Consumption</code> which <code>belongs_to :users</code> and a model <code>ConsumptionSearch</code>.</p>\n\n<p>consumption.rb</p>\n\n<pre><code>class Consumption &lt; ApplicationRecord\n    belongs_to :user\nend\n</code></pre>\n\n<p>consumption_search.rb</p>\n\n<pre><code>class ConsumptionSearch \n    attr_reader :date_from, :date_to\n\n    def initialize(params)\n        params ||= {}\n        @date_from = parsed_date(params[:date_from],Time.now.beginning_of_month.to_date.to_s)\n        @date_to   = parsed_date(params[:date_to], (Date.today + 1).to_s)\n    end\n\n    def date_range\n        Consumption.where('created_at BETWEEN ? AND ?', @date_from, @date_to)\n    end\n\n    private\n        def parsed_date(date_string, default)\n            Date.parse(date_string)\n            rescue ArgumentError, TypeError\n            default\n        end\nend\n</code></pre>\n\n<p>In the <code>consumptions_controller</code> in the <code>index</code> action I can retrieve the wanted consumptions by date</p>\n\n<pre><code>class ConsumptionsController &lt; ApplicationController\n    def index\n        @search = ConsumptionSearch.new(params[:search])\n        @consumptions = @search.date_range\n        @consumptions = @consumptions.order('created_at ASC').where(user_id: current_user.id)\n    end\nend\n</code></pre>\n\n<p>consumptions schema may help: </p>\n\n<pre><code>  create_table \"consumptions\", force: :cascade do |t|\n    t.float \"total_price\"\n    t.float \"kilometers\"\n    t.string \"shop\"\n    t.float \"liter_price\"\n    t.float \"total_liters\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.integer \"user_id\"\n    t.float \"difference\", default: 0.0\n  end\n</code></pre>\n\n<p>So in my <code>consumptions/view/index.html.erb</code> I just have to iterate over <code>@consumptions</code> to display what I need.</p>\n\n<p><strong>The question is</strong>: how can I make it more \"ruby way\", I have too much logic in the view... Where and how should I extract the logic? Thanks</p>\n\n<pre><code>&lt;%= price = (@consumptions.map { |c| c.total_price }.sum - @consumptions.last.total_price).round(2) %&gt; \n&lt;%= total_km = (@consumptions.map { |c| c.difference }.sum).round.abs %&gt;\n&lt;%= (price / total_km).round(4) %&gt; \n&lt;%= (price / total_km * 100).round(2) %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "activerecord"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1542048224, "post_id": 53265793, "comment_id": 93420420, "body": "Welcome to stackoverflow. Please see <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>. As it stands, your question is too broad and is unlikely to get a response."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542054001, "post_id": 53265793, "comment_id": 93422771, "body": "I&#39;m perplexed by the downvote as it seems to be a clear and interesting question. This is a good example of the problem that arises when downvoters fail to leave a comment that explains why they fault the question. Here the OP probably has no idea of the reason for the downvote and therefore doesn&#39;t know how to repair the question to the downvoter&#39;s satisfaction."}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1542053535, "last_edit_date": 1542053535, "creation_date": 1542051393, "answer_id": 53268961, "question_id": 53265793, "link": "https://stackoverflow.com/questions/53265793/determine-if-current-time-falls-within-time-ranges-if-not-find-what-the-next-o/53268961#53268961", "title": "Determine if Current time falls within time ranges.. If not find what the next open window is", "body": "<p>Suppose you were to construct a hash whose keys are businesses and whose values are windows, the windows being an array of seven arrays, one for each day of the week:</p>\n\n<pre><code>windows = [sun_windows, mon_windows, ... , sat_windows]\n</code></pre>\n\n<p>Each daily window is an array of ranges of the form <code>first_sec..last_sec</code>, <code>first_sec</code> and <code>last_sec</code> being seconds from midnight. These ranges are ordered in the sense that end of each range (seconds) is less than the beginning the next range.</p>\n\n<p>Suppose, for example, that for a particular business there were two windows on Mondays, <code>8:00-12:00</code> and <code>13:00-17:00</code>. Then</p>\n\n<pre><code>mon_windows = [8*3600..12*3600, 13*3600..17*3600]\n  #=&gt; [28800..43200, 46800..61200]\n</code></pre>\n\n<p>Suppose now one wanted to know if <code>[:mon, 44000]</code> were currently within a window for this business. We could use the following method for that task.</p>\n\n<pre><code>def covered?(windows_today, secs)\n  windows_today.each do |r|\n    return [false, r] if r.begin &gt; secs\n    return true if r.cover?(secs)\n  end\n  false\nend\n</code></pre>\n\n<p>As Monday is the second day of the week (offset 1), we would execute:</p>\n\n<pre><code>covered?(windows[1], 44000)\n  #=&gt; [false, 46800..61200]\n</code></pre>\n\n<p>where:</p>\n\n<pre><code>windows_today = windows[1]\n  #=&gt; [28800..43200, 46800..61200]\n</code></pre>\n\n<p>There are three possible return values from this method.</p>\n\n<ul>\n<li><code>true</code>: the message can be delivered immediately;</li>\n<li><code>[false, r]</code>: the message cannot be delivered immediately but can be delivered during the (next) window (range) <code>r</code> the same day; and</li>\n<li><code>false</code>: the message cannot be delivered the same day.</li>\n</ul>\n\n<p>Depending on requirements, possibly only <code>r.begin</code> (<code>46800</code> in the example) need be returned in the second case.</p>\n\n<p>In the example, <code>44000</code> is not within a window on Monday and the next window is the range <code>46800..61200</code> the same day. </p>\n\n<p>We would be finished unless <code>false</code> were returned. If that case we would need to determine the next window.</p>\n\n<pre><code>def next_window(windows, start_day)\n  dow = 7.times.find { |i| windows[(start_day + i) % 7].any? }\n  dow = (start_day + dow) % 7 \n  [dow, windows[dow].first]\nend\n</code></pre>\n\n<p>where <code>start_day</code> equals the <code>1</code> plus current day-of-week number (e.g., <code>1</code> for Monday, making <code>start_day = 2</code>).</p>\n\n<p>Notice that if the business is only open on Monday <code>windows[start_day+i) % 7] #=&gt; []</code> for <code>i = 0..5</code> (so <code>windows[start_day+i) % 7].first #=&gt; nil</code>), and the method would return</p>\n\n<pre><code>next_window(windows, 2)\n  #[1, 28800..43200]\n</code></pre>\n\n<p><code>28800..43200</code> being the first window the following Monday.</p>\n\n<p>Regarding time zones it would seem simplest to make all times Grenwich Mean Times.</p>\n"}], "owner": {"reputation": 19, "user_id": 1201099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0fa06b8fc7ba0608b723a1f9695eb5?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/1201099/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542053535, "creation_date": 1542038290, "question_id": 53265793, "link": "https://stackoverflow.com/questions/53265793/determine-if-current-time-falls-within-time-ranges-if-not-find-what-the-next-o", "title": "Determine if Current time falls within time ranges.. If not find what the next open window is", "body": "<p>I have an application where I need to send messages to businesses only if they are within their set message windows.</p>\n\n<p>a business might have a set of windows mon-fri  10am-3pm,  6pm-11pm\n                                       sat-sun  2am-6am,  3pm-4pm  </p>\n\n<p>This is a sample</p>\n\n<p>So a business could have multiple business windows per day and they could vary by day of the week.  Each business would also be in a different timezone so that also has to be taken into account.</p>\n\n<p>When a message comes in for delivery I need to know if the current time is within a window.  If it is not, it will be queued and I need to deliver it on the next open window.</p>\n\n<p>I am kinda at a loss on where and how to start on this one.  Any help would be appreciated.  Sorry if the question was not granular enough.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "edited": false, "score": 0, "creation_date": 1542039328, "post_id": 53265671, "comment_id": 93416170, "body": "Do you want to sort what is currently in the table, or fetch from the database again?"}, {"owner": {"reputation": 1414, "user_id": 9869951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arthur Truong", "link": "https://stackoverflow.com/users/9869951/arthur-truong"}, "reply_to_user": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "edited": false, "score": 0, "creation_date": 1542039448, "post_id": 53265671, "comment_id": 93416230, "body": "Sort whats currently in the table"}], "answers": [{"tags": [], "owner": {"reputation": 1414, "user_id": 9869951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arthur Truong", "link": "https://stackoverflow.com/users/9869951/arthur-truong"}, "is_accepted": false, "score": 0, "last_activity_date": 1542199979, "creation_date": 1542199979, "answer_id": 53300707, "question_id": 53265671, "link": "https://stackoverflow.com/questions/53265671/im-trying-to-sort-through-my-table-column-by-clicking-the-header-without-loadin/53300707#53300707", "title": "I&#39;m trying to sort through my table column by clicking the header without loading the page.", "body": "<p>I finally fixed the problem.</p>\n\n<p>The problem was that I had remote: true inside</p>\n\n<pre><code>link_to \"#{title} &lt;i class='#{icon}'&gt;&lt;/i&gt;\".html_safe, params.merge(:sort =&gt; column, direction: direction, remote: true)\n</code></pre>\n\n<p>instead</p>\n\n<pre><code>link_to \"#{title} &lt;i class='#{icon}'&gt;&lt;/i&gt;\".html_safe, params.merge(:sort =&gt; column, direction: direction), remote: true\n</code></pre>\n"}], "owner": {"reputation": 1414, "user_id": 9869951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arthur Truong", "link": "https://stackoverflow.com/users/9869951/arthur-truong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542199979, "creation_date": 1542037906, "question_id": 53265671, "link": "https://stackoverflow.com/questions/53265671/im-trying-to-sort-through-my-table-column-by-clicking-the-header-without-loadin", "title": "I&#39;m trying to sort through my table column by clicking the header without loading the page.", "body": "<p>What I'm trying to do is when a user clicks on the headers next to sort link, I want it to load without refreshing the whole page. How would I add this onto my code? </p>\n\n<p><strong>helpers</strong></p>\n\n<pre><code>module ListsHelper\n  def sort_link(column, title = nil)\n   title ||= column.titleize\n   direction = column == sort_column &amp;&amp; sort_direction == \"asc\" ? \"desc\" : \"asc\"\n   icon = sort_direction == \"asc\" ? \"fas fa-chevron-up\" : \"fas fa-chevron-down\"\n   icon = column == sort_column ? icon : \"\"\n   link_to \"#{title} &lt;i class='#{icon}'&gt;&lt;/i&gt;\".html_safe, params.merge(:sort =&gt; column, direction: direction)\n end\nend\n</code></pre>\n\n<p><strong>views</strong></p>\n\n<pre><code>&lt;div class=\"demo\"&gt;\n  &lt;br&gt;\n  &lt;table class=\"table is-responsive is-fullwidth\"&gt;\n    &lt;h1&gt;Click header to sort&lt;/h1&gt;\n    &lt;thead&gt;\n      &lt;tr&gt;\n        &lt;th&gt;&lt;%= sort_link 'Name'%&gt;&lt;/th&gt;\n        &lt;th&gt;&lt;%= sort_link 'Date' %&gt;&lt;/th&gt;\n        &lt;th&gt;&lt;%= sort_link 'Number' %&gt;&lt;/th&gt;\n        &lt;th&gt;&lt;%= sort_link 'Description' %&gt;&lt;/th&gt;\n        &lt;th colspan=\"3\"&gt;&lt;/th&gt;\n      &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;% @lists.each do |list| %&gt;\n    &lt;tbody&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= list.name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= list.date %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= list.number %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= list.description %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Show', list %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Edit', edit_list_path(list) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Destroy', list, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n\n    &lt;/tbody&gt;\n    &lt;% end %&gt;\n  &lt;/table&gt;\n\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "nomethoderror"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1542038190, "post_id": 53265380, "comment_id": 93415518, "body": "If this method takes &quot;two arrays of strings&quot; then why are you checking to see if those values are equal to an empty <code>String</code>?"}, {"owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542040259, "post_id": 53265380, "comment_id": 93416707, "body": "You&#39;re quite right, that was it."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "edited": false, "score": 0, "creation_date": 1542040404, "post_id": 53265733, "comment_id": 93416803, "body": "That&#39;s much nicer and error free, thanks for explaining the methods."}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 4, "last_activity_date": 1542038916, "last_edit_date": 1542038916, "creation_date": 1542038040, "answer_id": 53265733, "question_id": 53265380, "link": "https://stackoverflow.com/questions/53265380/program-working-but-im-still-getting-a-nomethoderror-length-nil/53265733#53265733", "title": "Program working, but I&#39;m still getting a NoMethodError &#39;length&#39; nil", "body": "<p>Starting with fixing your program. First of all, you say you're accepting arrays of strings, yet <code>if a1 == '' || a2 == ''</code> checks whether you passed empty strings. Putting <code>-1</code>, not a <code>return -1</code> does essentially nothing.</p>\n\n<p>I am assuming that the error is in this line (you have the line in stacktrace, it's <code>main.rb:10:in 'mxdiflg'</code> therefore line 10 for you): </p>\n\n<pre><code>a_total = a1_order.reverse[0].length - a2_order[0].length\n</code></pre>\n\n<p>As if your array is empty, your <code>array[0]</code> will be <code>nil</code> so you cannot call <code>.length</code> on it (just as the error you pasted says suggest).</p>\n\n<p>As for debugging, at some point you will have to get comfortable with using <a href=\"https://github.com/pry/pry\" rel=\"nofollow noreferrer\">Pry</a>, but for now it should be enough that you check the line number and error message. In this case, it's quite clear that you're calling <code>.length</code> on a <code>nil</code>, so your <code>a1_order[0]</code> must be <code>nil</code>, so your array must be empty. You may also add simple puts messages, for example:</p>\n\n<pre><code>puts \"a1_order: #{a1_order}\"\nputs \"a2_order: #{a2_order}\"\na_total = a1_order.reverse[0].length - a2_order[0].length\nb_total = a2_order.reverse[0].length - a1_order[0].length\n</code></pre>\n\n<p>Now when running your program, you can inspect your sorted arrays and it should be quite clear that you're trying to call methods on <code>nil</code>s.</p>\n\n<p>Now, having that covered, we can try to make your program a bit nicer. First of all, as I mentioned, your first check doesn't make much sense. Let's turn it into:</p>\n\n<pre><code>return -1 if [a1,a2].any?(&amp;:empty)\n</code></pre>\n\n<p>which will actually return from your method with <code>-1</code> if any of arrays are empty.</p>\n\n<p>Going further:</p>\n\n<pre><code>a1_order = a1.sort{|left, right| left.length &lt;=&gt; right.length}\n</code></pre>\n\n<p>can be written as:</p>\n\n<pre><code>a1_order.sort_by(&amp;:length)\n</code></pre>\n\n<p>Calling </p>\n\n<pre><code>a1_order.reverse[0]\n</code></pre>\n\n<p>is a bit inefficient, as it will create a copy of your array with a reversed order, you may simply do <code>a1_order.last</code> instead.</p>\n\n<p>If looking for maximum/minimum values, you may use <a href=\"https://ruby-doc.org/core-2.5.3/Enumerable.html#method-i-max_by\" rel=\"nofollow noreferrer\">Enumerable#max_by</a> / <a href=\"https://ruby-doc.org/core-2.5.3/Enumerable.html#method-i-min_by\" rel=\"nofollow noreferrer\">Enumerable#min_by</a> like so:</p>\n\n<pre><code>a_total = a1.max_by(&amp;:length).length - a2.min_by(&amp;:length).length\nb_total = a2.max_by(&amp;:length).length - a1.min_by(&amp;:length).length\n</code></pre>\n\n<p>And getting a higher value can be achieved with <a href=\"https://ruby-doc.org/core-2.5.3/Array.html#method-i-max\" rel=\"nofollow noreferrer\">Array#max</a>:</p>\n\n<pre><code>[a_total, b_total].max\n</code></pre>\n\n<p>Wrapping this all together, your method may look like this:</p>\n\n<pre><code>def mxdiflg(a1, a2)\n  return -1 if [a1, a2].any?(&amp;:empty?)\n\n  a_total = a1.max_by(&amp;:length).length - a2.min_by(&amp;:length).length\n  b_total = a2.max_by(&amp;:length).length - a1.min_by(&amp;:length).length\n\n  [a_total, b_total].max\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5470, "user_id": 2052097, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/KOzAT.jpg?s=128&g=1", "display_name": "z atef", "link": "https://stackoverflow.com/users/2052097/z-atef"}, "is_accepted": false, "score": 1, "last_activity_date": 1585887985, "last_edit_date": 1585887985, "creation_date": 1542038653, "answer_id": 53265897, "question_id": 53265380, "link": "https://stackoverflow.com/questions/53265380/program-working-but-im-still-getting-a-nomethoderror-length-nil/53265897#53265897", "title": "Program working, but I&#39;m still getting a NoMethodError &#39;length&#39; nil", "body": "<p>One of the issues is how you are checking for empty arrays. </p>\n\n<pre><code>irb(main):002:0&gt; [] == ''\n=&gt; false\n</code></pre>\n\n<p>Will always return false even though the array is empty. empty? is one way to check for empty arrays, see below. </p>\n\n<pre><code>#!/usr/bin/ruby\n\n    def run\n\n    p  mxdiflg([\"aa\" , \"b\" , \"c\"], [\"dddf\", \"r\", \"u\", \"ee\"] )\n    p  mxdiflg([], [\"f\", \"r\", \"u\", \"ee\"] )\n\n\n    end\n\n\n    def mxdiflg(a1, a2)\n\n      # return whatever you want if any of the arrays is empty\n      return false  if  a1.empty?  || a2.empty?\n\n      # drop empty elements form array\n      a1.reject!(&amp;:empty?)\n      a2.reject!(&amp;:empty?)\n\n      a1_order = a1.sort{|left, right| left.length &lt;=&gt; right.length}\n      a2_order = a2.sort{|left, right| left.length &lt;=&gt; right.length}\n\n      a_total = a1_order.reverse[0].length - a2_order[0].length\n      b_total = a2_order.reverse[0].length - a1_order[0].length\n\n      (b_total &gt; a_total) ? b_total : a_total\n\n    end\n\n\n    run\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 53265733, "answer_count": 2, "score": 1, "last_activity_date": 1585887985, "creation_date": 1542036855, "question_id": 53265380, "link": "https://stackoverflow.com/questions/53265380/program-working-but-im-still-getting-a-nomethoderror-length-nil", "title": "Program working, but I&#39;m still getting a NoMethodError &#39;length&#39; nil", "body": "<p>This program takes two arrays of strings and subtracts the length of the longest in a1 from the shortest in a2, and then vice-versa and returns the greater.</p>\n\n<p>It works (passed 103/103 tests), but I'm getting this error:</p>\n\n<pre><code>NoMethodError: undefined method `length' for nil:NilClass \nmain.rb:10:in `mxdiflg'\nmain.rb:66:in `block (2 levels) in &lt;main&gt;'\n</code></pre>\n\n<p>Where's the issue? And since this isn't the first time this has happened, how do I debug a program that works?</p>\n\n<pre><code>def mxdiflg(a1, a2)\n    if a1 == '' || a2 == ''\n    -1\n  end\n  a1_order = a1.sort{|left, right| left.length &lt;=&gt; right.length}\n  a2_order = a2.sort{|left, right| left.length &lt;=&gt; right.length}\n\n  a_total = a1_order.reverse[0].length - a2_order[0].length\n  b_total = a2_order.reverse[0].length - a1_order[0].length\n\n  if b_total &gt; a_total\n    b_total\n  else\n    a_total\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "watir", "pageobjects"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8515936, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159558143945393/picture?type=large", "display_name": "mjruttenberg", "link": "https://stackoverflow.com/users/8515936/mjruttenberg"}, "edited": false, "score": 1, "creation_date": 1542037054, "post_id": 53265395, "comment_id": 93414933, "body": "Thank you Sergio. It worked. I&#39;ll kudos your answer when the timer allows :)"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1542036899, "creation_date": 1542036899, "answer_id": 53265395, "question_id": 53265329, "link": "https://stackoverflow.com/questions/53265329/trying-to-learn-to-use-pageobjects-with-ruby-getting-error-uninitialized-cons/53265395#53265395", "title": "Trying to learn to use PageObjects with Ruby - getting error &quot;uninitialized constant Site (NameError)&quot;", "body": "<p>You define class <code>Site</code> only a few lines below. But at that point, it's not yet known.</p>\n\n<p>Move this logic to after all class definitions:</p>\n\n<pre><code>site = Site.new(Watir::Browser.new :chrome) # was :firefox but that no longer works since FF63\n\nlogin_page = site.login_page.open \nuser_page = login_page.login_as \"testuser\", \"testpassword\" # dummy user and password for now\n\nuser_page.should be_logged_in\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8515936, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159558143945393/picture?type=large", "display_name": "mjruttenberg", "link": "https://stackoverflow.com/users/8515936/mjruttenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 53265395, "answer_count": 1, "score": 1, "last_activity_date": 1542036941, "creation_date": 1542036661, "last_edit_date": 1542036941, "question_id": 53265329, "link": "https://stackoverflow.com/questions/53265329/trying-to-learn-to-use-pageobjects-with-ruby-getting-error-uninitialized-cons", "title": "Trying to learn to use PageObjects with Ruby - getting error &quot;uninitialized constant Site (NameError)&quot;", "body": "<p>I have some experience of Selenium in Python and Cucumber/Watir/RSpec in Ruby, and can write scripts that execute successfully, but they aren't using classes, so I am trying to learn more about classes and splitting the scripts up in to pageobejcts.</p>\n\n<p>I found this example to learn from: <a href=\"http://watir.com/guides/page-objects/\" rel=\"nofollow noreferrer\">http://watir.com/guides/page-objects/</a> so copied the script and made some minor edits as you'll see below.</p>\n\n<p>I'm using SublimeText 3.x with Ruby 2.4.x on Win10, so you know what tools I'm using.</p>\n\n<p>I put the whole script in to a single .rb file (the only differences are that I replaced the URL and the elements to enter the username and password) and tried to execute it and get the following error:</p>\n\n<pre><code>C:/selenium/ruby/lotw/lotwlogin.rb:3:in `&lt;main&gt;': uninitialized constant Site (NameError).\n</code></pre>\n\n<p>I added the top line (<code>required 'watir'</code>) line and it made no difference to the error encountered.</p>\n\n<p>So I have in lotwlogin.rb essentilly the structure and syntax of the original script with custom elements. However, the core structure is reporting an error and I don't know what to do about it.</p>\n\n<p>Here is my script:</p>\n\n<pre><code>require 'watir'\n\nsite = Site.new(Watir::Browser.new :chrome) # was :firefox but that no longer works since FF63\n\nlogin_page = site.login_page.open \nuser_page = login_page.login_as \"testuser\", \"testpassword\" # dummy user and password for now\n\nuser_page.should be_logged_in\n\nclass BrowserContainer   \n  def initialize(browser)\n    @browser = browser   \n  end \nend\n\nclass Site &lt; BrowserContainer   \n  def login_page\n    @login_page = LoginPage.new(@browser)\n  end\n\n  def user_page\n    @user_page = UserPage.new(@browser)\n  end\n\n  def close\n    @browser.close\n  end\nend\n\n\nclass LoginPage &lt; BrowserContainer\n  URL = \"https://lotw.arrl.org/lotw/login\"\n\n  def open\n    @browser.goto URL\n    #@browser.window.maximize\n    self   # no idea what this is for\n  end\n\n  def login_as(user, pass)\n    user_field.set user\n    password_field.set pass\n\n    login_button.click\n\n    next_page = UserPage.new(@browser)\n    Watir::Wait.until { next_page.loaded? }\n\n    next_page\n  end\n\n  private\n\n  def user_field\n    @browser.text_field(:name =&gt; \"login\")\n  end\n\n  def password_field\n    @browser.text_field(:name =&gt; \"password\")\n  end\n\n  def login_button\n    @browser.button(:value =&gt; \"Log On\")   \n  end\nend # LoginPage\n\nclass UserPage &lt; BrowserContainer   \n  def logged_in?\n    logged_in_element.exists?   \n  end\n\n  def loaded?\n    @browser.h3 == \"Welcome to Your Logbook of the World User Account Home Page\"   \n  end\n\n  private\n\n  def logged_in_element\n    @browser.div(:text =&gt; \"Log off\")   \n  end \nend # UserPage\n</code></pre>\n\n<p>Any assistance how to not get the Site error would be appreciated.</p>\n\n<p>Thanks</p>\n\n<p>Mike</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "simple-form"], "comments": [{"owner": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "edited": false, "score": 3, "creation_date": 1542031467, "post_id": 53263662, "comment_id": 93411690, "body": "If you look at your logs, the form values are under <code>params[:user]</code>. So the name would be under <code>params[:user][:name]</code>. Also have a look at <a href=\"https://guides.rubyonrails.org/action_controller_overview.html#strong-parameters\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a> and consider following the CRUD convention (just <code>create</code> action, not <code>createUser</code>) and the ruby snake_case naming convention (i.e <code>create_user</code> instead of <code>createUser</code>)"}, {"owner": {"reputation": 181, "user_id": 5756014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DiSqt.jpg?s=128&g=1", "display_name": "user5756014", "link": "https://stackoverflow.com/users/5756014/user5756014"}, "reply_to_user": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "edited": false, "score": 0, "creation_date": 1542080068, "post_id": 53263662, "comment_id": 93429700, "body": "Thanks a lot for your suggestion. I&#39;m new to rails and will follow your suggestion from my upcoming development."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5756014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DiSqt.jpg?s=128&g=1", "display_name": "user5756014", "link": "https://stackoverflow.com/users/5756014/user5756014"}, "edited": false, "score": 0, "creation_date": 1542079988, "post_id": 53264240, "comment_id": 93429676, "body": "Thanks a lot. Strong parameter solved this. I&#39;m new in rails and finding the naming convention a bit more finicky to be honest. Anyway, Thanks."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 181, "user_id": 5756014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DiSqt.jpg?s=128&g=1", "display_name": "user5756014", "link": "https://stackoverflow.com/users/5756014/user5756014"}, "edited": false, "score": 1, "creation_date": 1542100252, "post_id": 53264240, "comment_id": 93436869, "body": "The Rails guides do very good job of explaining how the framework should be used. Rails philosophy is &quot;convention over configuration&quot; so try to go by examples given as they are usually straight forward. The reason for naming convention goes beyond Rails. <a href=\"https://en.m.wikipedia.org/wiki/Naming_convention_(programming)\" rel=\"nofollow noreferrer\">en.m.wikipedia.org/wiki/Naming_convention_(programming)</a>"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 3, "last_activity_date": 1542035725, "last_edit_date": 1542035725, "creation_date": 1542032826, "answer_id": 53264240, "question_id": 53263662, "link": "https://stackoverflow.com/questions/53263662/getting-notnullviolation-when-passing-data-through-simple-form-for-in-rails/53264240#53264240", "title": "Getting NotNullViolation when passing Data through simple_form_for in Rails", "body": "<p><code>createUser</code> is not a CRUD convention, instead use <code>create</code> but also you should be using <a href=\"https://edgeapi.rubyonrails.org/classes/ActionController/StrongParameters.html\" rel=\"nofollow noreferrer\">strong parameters</a> and also don't use goofy names like <code>fresh</code> but instead model objects should be named semantically.</p>\n\n<pre><code>def create\n  user = User.new(permitted_params)\n  user.status = 1\n  user.role = 3\n\n  if user.save\n    flash[:notice] = \"User Created\"\n      redirect_to(:action =&gt; index)\n  else\n    flash[:notice] = \"Creating failed\"\n    redirect_to(:action =&gt; index)\n  end\nend\n\ndef permitted_params\n  params.require(:user).permit(:name, :email, :password, :joining_date)\nend\n</code></pre>\n\n<p>You might not need <code>joining_date</code>, since you have <code>created_at</code>, but if you do want to keep that field, at least use the name <code>joined_date</code> or <code>join_date</code> since it will always be past tense. In fact a user is never \"joining\", they either have or have not \"joined\" yet. </p>\n\n<p>As a side note you should never store passwords unencrypted, perhaps see <a href=\"https://github.com/codahale/bcrypt-ruby\" rel=\"nofollow noreferrer\">bcrypt</a></p>\n"}], "owner": {"reputation": 181, "user_id": 5756014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DiSqt.jpg?s=128&g=1", "display_name": "user5756014", "link": "https://stackoverflow.com/users/5756014/user5756014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 53264240, "answer_count": 1, "score": 1, "last_activity_date": 1542035725, "creation_date": 1542030897, "question_id": 53263662, "link": "https://stackoverflow.com/questions/53263662/getting-notnullviolation-when-passing-data-through-simple-form-for-in-rails", "title": "Getting NotNullViolation when passing Data through simple_form_for in Rails", "body": "<p>I'm getting above error when passing data through <em>simple_form_for</em>. My view, controller and database file is included below. This looks like I am not getting the values submitted by <em>simple_form_for</em> in controller. Note that, in my database table, attribute <code>status</code> is <code>not null</code> and I am not taking it as an input in view. How can I solve this error?</p>\n\n<p>Database</p>\n\n<pre><code>create_table \"users\", force: :cascade do |t|\nt.integer \"team_lead_id\"\nt.string \"name\", null: false\nt.string \"email\", null: false\nt.string \"password\", null: false\nt.date \"joining_date\", null: false\nt.integer \"status\", null: false\nt.integer \"role\"\nt.datetime \"created_at\", null: false\nt.datetime \"updated_at\", null: false\nend\n</code></pre>\n\n<p>View </p>\n\n<pre><code>&lt;%= simple_form_for @user , :url =&gt; user_createUser_url, :method =&gt; :post do |f| %&gt;\n    &lt;%= f.input :name %&gt;&lt;br /&gt;\n    &lt;%= f.input :email%&gt;&lt;br /&gt;\n    &lt;%= f.input :password %&gt;&lt;br /&gt;\n    &lt;%= f.input :joining_date, as: :date, order: [:day, :month, :year] %&gt;&lt;br/&gt;\n    &lt;%= f.submit \"Create User\" %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>Controller </p>\n\n<pre><code>def createUser\n\n    fresh = User.new\n\n    fresh.name = params[:name]\n    fresh.email = params[:email]\n    fresh.password = params[:password]\n    fresh.joining_date = params[:joining_date]\n    fresh.status = 1\n    fresh.role = 3\n\n    if fresh.save\n      flash[:notice] = \"User Created\"\n      redirect_to(:action =&gt; index)\n    else\n      flash[:notice] = \"Creating failed\"\n      redirect_to(:action =&gt; index)\n    end\n\n  end\n</code></pre>\n\n<p>And I'm getting this Error</p>\n\n<pre><code>PG::NotNullViolation: ERROR: null value in column \"name\" violates not-null constraint DETAIL: Failing row contains (12, null, null, null, null, null, 1, 3, 2018-11-12 13:37:54.589835, 2018-11-12 13:37:54.589835). : INSERT INTO \"users\" (\"status\", \"role\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3, $4) RETURNING \"id\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "routes"], "comments": [{"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1542029790, "post_id": 53263165, "comment_id": 93410759, "body": "I update question and add error pic also"}, {"owner": {"reputation": 784, "user_id": 7970365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ea30f5ef13a4593ad0eafd20304601?s=128&d=identicon&r=PG", "display_name": "D1ceWard", "link": "https://stackoverflow.com/users/7970365/d1ceward"}, "edited": false, "score": 0, "creation_date": 1542030821, "post_id": 53263165, "comment_id": 93411322, "body": "Remove <code>()</code> like <code>get &#39;&#47;news-views&#47;:page&#39;, to: redirect(&quot;&#47;car-news&#47;%{page}&quot;)</code> and add <code>get &#39;&#47;news-views&#39;, to: redirect(&quot;&#47;car-news&quot;)</code> if you really need the root path <code>&#47;news-views</code> of redirecting"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 784, "user_id": 7970365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ea30f5ef13a4593ad0eafd20304601?s=128&d=identicon&r=PG", "display_name": "D1ceWard", "link": "https://stackoverflow.com/users/7970365/d1ceward"}, "edited": false, "score": 0, "creation_date": 1542030895, "post_id": 53263165, "comment_id": 93411365, "body": "get &#39;/news-views/:title(/:page)&#39; =&gt; redirect(&#39;/car-news/:title/%{page}&#39;)  no basically i have another url also due to which it impacts and it works fine"}, {"owner": {"reputation": 784, "user_id": 7970365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ea30f5ef13a4593ad0eafd20304601?s=128&d=identicon&r=PG", "display_name": "D1ceWard", "link": "https://stackoverflow.com/users/7970365/d1ceward"}, "edited": false, "score": 1, "creation_date": 1542031494, "post_id": 53263165, "comment_id": 93411708, "body": "Yes, it&#39;s work when you pass an <code>:page</code> like /news-views/my-example, but when you go on root like <code>&#47;news-views</code> it didn&#39;t because rails redirect to literally <code>&#47;car-news&#47;%{page}</code> and <code>{}</code> aren&#39;t url encoded, that&#39;s why the bad uri"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542029775, "creation_date": 1542029152, "last_edit_date": 1542029775, "question_id": 53263165, "link": "https://stackoverflow.com/questions/53263165/bad-uri-in-rake-routes-rails", "title": "Bad URI in rake routes rails", "body": "<p>config/routes.rb</p>\n\n<pre><code>get '/news-views(/:page)',to: redirect(\"/car-news/%{page}\")\n</code></pre>\n\n<p>when I hit</p>\n\n<pre><code>/news-views/\n</code></pre>\n\n<p>it gives an Bad Uri but when I hit<code>/news-views/1</code> it works\ni want it to work without page also</p>\n\n<p><a href=\"https://i.stack.imgur.com/NSE38.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NSE38.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1542024786, "post_id": 53261926, "comment_id": 93408108, "body": "Here are all rails methods: <a href=\"https://github.com/rails/rails/\" rel=\"nofollow noreferrer\">github.com/rails/rails</a>"}, {"owner": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1542025180, "post_id": 53261926, "comment_id": 93408324, "body": "@SergioTulentsev please help me by letting me know where is the inbuilt method written in rails app. this would be very helpful to me."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1549861917, "post_id": 53261926, "comment_id": 96040935, "body": "I think you got cleared with this, so try looking for <i>&#39;how to override method_missing to avoid NomethodError in rails&#39;</i>"}], "answers": [{"comments": [{"owner": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "edited": false, "score": 0, "creation_date": 1542025669, "post_id": 53262078, "comment_id": 93408588, "body": "Thanks, Can you please suggest me  some book or study material to brushup my rails basic."}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "edited": false, "score": 0, "creation_date": 1542025983, "post_id": 53262078, "comment_id": 93408740, "body": "Absolutely, <a href=\"https://www.railstutorial.org/\" rel=\"nofollow noreferrer\">railstutorial.org</a> and <a href=\"https://rubymonk.com/\" rel=\"nofollow noreferrer\">rubymonk.com</a> are both free.  Good luck, please reach out if you need more."}], "tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": true, "score": 2, "last_activity_date": 1549861839, "last_edit_date": 1549861839, "creation_date": 1542025221, "answer_id": 53262078, "question_id": 53261926, "link": "https://stackoverflow.com/questions/53261926/where-are-rails-inbuilt-and-default-method-written-in-rails-app/53262078#53262078", "title": "where are rails inbuilt and default method written in rails app?", "body": "<p><code>NoMethodError</code> is a core error in ruby.  Normally your best best is to go <a href=\"https://ruby-doc.org/core-2.5.0\" rel=\"nofollow noreferrer\">here</a> for ruby docs and check or <a href=\"https://api.rubyonrails.org/\" rel=\"nofollow noreferrer\">here</a> for rails </p>\n\n<p>NoMethodError lives <a href=\"https://ruby-doc.org/core-2.5.0/NoMethodError.html\" rel=\"nofollow noreferrer\">here</a> in the ruby docs</p>\n"}], "owner": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 53262078, "answer_count": 1, "score": -2, "last_activity_date": 1549861839, "creation_date": 1542024643, "last_edit_date": 1549861557, "question_id": 53261926, "link": "https://stackoverflow.com/questions/53261926/where-are-rails-inbuilt-and-default-method-written-in-rails-app", "title": "where are rails inbuilt and default method written in rails app?", "body": "<p>Can any one explain help me understand how to find the location and definition or errors such as \"NoMethodError\" in rails app. </p>\n\n<p>Please let me know where can I get all the rails inbuilt method and function list.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 2, "creation_date": 1542027584, "post_id": 53261836, "comment_id": 93409601, "body": "New Thread is not a major issue: <a href=\"https://www.mikeperham.com/2015/05/08/timeout-rubys-most-dangerous-api/\" rel=\"nofollow noreferrer\">mikeperham.com/2015/05/08/timeout-rubys-most-dangerous-api</a>"}], "owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1542024334, "creation_date": 1542024334, "question_id": 53261836, "link": "https://stackoverflow.com/questions/53261836/is-there-a-one-threaded-alternative-to-timeout", "title": "Is there a one-threaded alternative to Timeout?", "body": "<p>There is a Ruby class <a href=\"https://ruby-doc.org/stdlib-2.1.1/libdoc/timeout/rdoc/Timeout.html\" rel=\"nofollow noreferrer\"><code>Timeout</code></a> that terminates the execution of a block after a certain amount of seconds:</p>\n\n<pre><code>Timeout.timeout(5) {\n  # Some long-running code...\n}\n</code></pre>\n\n<p>The problem is that every time I call <code>timeout()</code> it starts a new <code>Thread</code>. It's pretty expensive (time and memory) operation. Would be much more effective to re-use an existing thread. Are there any Gems for that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1542057151, "post_id": 53261008, "comment_id": 93424014, "body": "&quot;Now it is giving CORS error(Cross origin error).Previously it was working fine.&quot; \u2013 Then the problem is in the changes you made between &quot;previously&quot; and &quot;now&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 10289312, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x-QDA4SlsYw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPZgpK1Om6r2TP_x87yYJ3xBn9nnQ/mo/photo.jpg?sz=128", "display_name": "Chirayu Chirayu", "link": "https://stackoverflow.com/users/10289312/chirayu-chirayu"}, "is_accepted": false, "score": 0, "last_activity_date": 1542027292, "creation_date": 1542027292, "answer_id": 53262628, "question_id": 53261008, "link": "https://stackoverflow.com/questions/53261008/cors-issue-happening-in-tubesock/53262628#53262628", "title": "CORS issue happening in tubesock", "body": "<p>I was able to use rack/cors and resolve the issue</p>\n"}], "owner": {"reputation": 51, "user_id": 10289312, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x-QDA4SlsYw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPZgpK1Om6r2TP_x87yYJ3xBn9nnQ/mo/photo.jpg?sz=128", "display_name": "Chirayu Chirayu", "link": "https://stackoverflow.com/users/10289312/chirayu-chirayu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1542027292, "creation_date": 1542021352, "question_id": 53261008, "link": "https://stackoverflow.com/questions/53261008/cors-issue-happening-in-tubesock", "title": "CORS issue happening in tubesock", "body": "<p>I have a Sinatra application which runs fine.Now to implement websockets I am using tubesock gem and have added following code</p>\n\n<pre><code>class Server\n  def call(env)\n    if env[\"HTTP_UPGRADE\"] == 'websocket'\n      tubesock = Tubesock.hijack(env)\n      tubesock.onmessage do |message|\n        puts \"Got #{message}\"\n      end\n      tubesock.listen\n      [ -1, {}, [] ]\n    else\n      [404, {'Content-Type' =&gt; 'text/plain'}, ['Not Found']]\n    end\n  end\nend\n</code></pre>\n\n<p>Now it is giving CORS error(Cross origin error).Previously it was working fine.Any suggestions?\nThanks</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "rake"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1542023737, "post_id": 53260887, "comment_id": 93407515, "body": "To cut that down the a <b>Minimal</b> example, are you saying that <code>Net::HTTP::Get.new(URI.parse(&quot;https:&#47;&#47;....&#47;company&#47;07877158&#47;&zwnj;&#8203;filings&#47;...&quot;))</code> gives you a different result vs accessing that URL from a browser? Perhaps the solution is to provide a <code>Cache-Control: no-cache</code> header in the request?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1542023879, "post_id": 53260887, "comment_id": 93407607, "body": "For full details, see <a href=\"https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html\" rel=\"nofollow noreferrer\">section 14.9 of the HTTP/1.1 protocol</a>"}, {"owner": {"reputation": 145, "user_id": 8371714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41001419cf5313eb31a80621923535eb?s=128&d=identicon&r=PG&f=1", "display_name": "JimBob", "link": "https://stackoverflow.com/users/8371714/jimbob"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542024591, "post_id": 53260887, "comment_id": 93408009, "body": "That is correct - Net::HTTP::Get.new(URI.parse(&quot;https://..../company/07877158/&zwnj;&#8203;filings/...&quot;)) gives me a different result vs accessing that URL from a browser.  I&#39;ve tried adding Cache-Control: no-cache, but get &quot;NoMethodError: undefined method `fetch&#39; for nil:NilClass&quot; (to be clear, apart from the updating issue, it works fine before adding that line) - I&#39;ve added the edit to my OP"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1542025558, "post_id": 53260887, "comment_id": 93408522, "body": "You need to <b>set</b> the <code>Cache-Control</code> in the <b>request</b>. It&#39;s not a <i>lookup</i> in the <i>response</i>. See the documentation: <a href=\"https://docs.ruby-lang.org/en/2.0.0/Net/HTTP.html#class-Net::HTTP-label-Setting+Headers\" rel=\"nofollow noreferrer\">docs.ruby-lang.org/en/2.0.0/Net/&hellip;</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1542025668, "post_id": 53260887, "comment_id": 93408584, "body": "Or for instance, you can see some examples of <b>setting</b> headers here: <a href=\"https://yukimotopress.github.io/http\" rel=\"nofollow noreferrer\">yukimotopress.github.io/http</a>. Again, don&#39;t get mixed up between reading the headers in the response, vs setting the headers in your request."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1542027705, "post_id": 53260887, "comment_id": 93409679, "body": "It looks like even passing the correct headers gives the same result.  I would suggest to have a look at <a href=\"https://github.com/TheGazette/DevDocs/blob/master/home.md\" rel=\"nofollow noreferrer\">github.com/TheGazette/DevDocs/blob/master/home.md</a>"}, {"owner": {"reputation": 145, "user_id": 8371714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41001419cf5313eb31a80621923535eb?s=128&d=identicon&r=PG&f=1", "display_name": "JimBob", "link": "https://stackoverflow.com/users/8371714/jimbob"}, "edited": false, "score": 0, "creation_date": 1542028866, "post_id": 53260887, "comment_id": 93410256, "body": "Thanks, but I have read through the API literature, but with no success.  I can&#39;t work out why this is happening; it is very frustrating."}, {"owner": {"reputation": 145, "user_id": 8371714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41001419cf5313eb31a80621923535eb?s=128&d=identicon&r=PG&f=1", "display_name": "JimBob", "link": "https://stackoverflow.com/users/8371714/jimbob"}, "edited": false, "score": 0, "creation_date": 1542036407, "post_id": 53260887, "comment_id": 93414581, "body": "This is very annoying - I&#39;ve looked for an explanation, but no results anywhere!?  Where would the information be stored, and how do I clear it?"}, {"owner": {"reputation": 145, "user_id": 8371714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41001419cf5313eb31a80621923535eb?s=128&d=identicon&r=PG&f=1", "display_name": "JimBob", "link": "https://stackoverflow.com/users/8371714/jimbob"}, "edited": false, "score": 0, "creation_date": 1542041601, "post_id": 53260887, "comment_id": 93417480, "body": "So, randomly, it decided to update.  No idea why, but I know it will continue to be intermittent.  Any further opinions on why this is happening would be appreciated :-&gt;"}, {"owner": {"reputation": 145, "user_id": 8371714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41001419cf5313eb31a80621923535eb?s=128&d=identicon&r=PG&f=1", "display_name": "JimBob", "link": "https://stackoverflow.com/users/8371714/jimbob"}, "edited": false, "score": 0, "creation_date": 1542282560, "post_id": 53260887, "comment_id": 93517565, "body": "No more help from anyone? : ("}], "owner": {"reputation": 145, "user_id": 8371714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41001419cf5313eb31a80621923535eb?s=128&d=identicon&r=PG&f=1", "display_name": "JimBob", "link": "https://stackoverflow.com/users/8371714/jimbob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542024761, "creation_date": 1542020901, "last_edit_date": 1542024761, "question_id": 53260887, "link": "https://stackoverflow.com/questions/53260887/parsing-a-api-source-but-the-json-souse-is-not-updating-cache", "title": "Parsing a API source, but the JSON souse is not updating (Cache?)", "body": "<p>I have coded a rake file to monitor and fetch data from a website that has this data in JSON format.  The following is the actual source of this data</p>\n\n<p><a href=\"https://www.thegazette.co.uk/company/07877158/filings/data.json\" rel=\"nofollow noreferrer\">https://www.thegazette.co.uk/company/07877158/filings/data.json</a></p>\n\n<p>The rake file monitors the \"total_count\" in the above json and when it changes the rake will fetch and save any new information</p>\n\n<p>The issue I have is after the first time it monitors that page, it simply doesn't update.  As a real-world current example, the above json source was updated overnight with two new records, and consequently, the \"total_count\" increased from 40 to 42, but my rake is still telling me there is 40 (and subsequently doing nothing because it thinks nothing has changed)</p>\n\n<p>I think it is a cache issue but have cleared my rails cache with no success.  It is strange because I don't have this issue with other similar rakes I have created for other sites</p>\n\n<p>My rake code is as follows</p>\n\n<pre><code>desc \"Monitor\"\ntask :S_01 =&gt; :environment do\n\n    require 'rubygems'\n    require 'open-uri'\n    require 'openssl'\n\n    def g_api(url)\n        uri = URI.parse(url)\n        request = Net::HTTP::Get.new(uri)\n        request.content_type = \"application/json\"\n        req_options = {\n          use_ssl: uri.scheme == \"https\",\n        }\n        response = Net::HTTP.start(uri.hostname, uri.port, req_options) do |http|\n          http.request(request)\n        end\n        data = JSON.parse(response.body)\n\n    end\n\n    company = CompanyBorrower.where(id: 43)\n\n    company.each do |f|\n\n        begin\n\n            #scrape source\n            tg_fh_url = \"https://www.thegazette.co.uk/company/\"+f.ch+\"/filings/data.json\"\n            gf_scrape = g_api(tg_fh_url)\n\n            ch_s = gf_scrape.fetch('total_count', nil) #scrape\n\n            puts ch_s\n\n            if not f.filing_count == ch_s # has teh cound change - if not, skip\n\n                f.update_attributes(cwdetail1: ch_s, filing_update: ch_fh3)\n\n                gf_scrape['items'].first(3).each_with_index do |f1, index|\n\n                    #fetch &amp; save data here\n\n                end\n\n            end\n\n        rescue\n            next\n        end\n\n    end\n\nend\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Added the following to the code, but get an error</p>\n\n<pre><code>    response[\"Cache-Control: no-cache\"]\n</code></pre>\n\n<blockquote>\n  <p>NoMethodError: undefined method `fetch' for nil:NilClass</p>\n</blockquote>\n\n<pre><code>def g_api(url)\n    uri = URI.parse(url)\n    request = Net::HTTP::Get.new(uri)\n    request.content_type = \"application/json\"\n    req_options = {\n      use_ssl: uri.scheme == \"https\",\n    }\n    response = Net::HTTP.start(uri.hostname, uri.port, req_options) do |http|\n      http.request(request)\n    end\n\n    data = JSON.parse(response.body)\n\n    response[\"Cache-Control: no-cache\"]\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "railsapps"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542019899, "post_id": 53260120, "comment_id": 93405492, "body": "Please show the full error. Which gem says it requires <code>mysql2 (&lt; 0.6.0, &gt;= 0.4.4)</code>, in the error message? Please show (a minimal sample from) the <code>Gemfile</code> and <code>Gemfile.lock</code>. Which gems do you have that depend on <code>mysql2</code>?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542020093, "post_id": 53260120, "comment_id": 93405594, "body": "Actually scratch that, I googled the project and the top issue reported is the same as your error: <a href=\"https://github.com/RailsApps/rails-composer/issues/279\" rel=\"nofollow noreferrer\">github.com/RailsApps/rails-composer/issues/279</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1542020288, "post_id": 53260120, "comment_id": 93405703, "body": "A <a href=\"https://github.com/RailsApps/rails-composer/issues/279#issuecomment-422095200\" rel=\"nofollow noreferrer\">quick qorkaround</a> is to run the installer with SQLite, then switch it out for <code>mysql</code> after the initial step. Or to fix it properly, someone needs to update that project."}, {"owner": {"reputation": 299, "user_id": 1575148, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f2c8bc01a7132c88962056d93bcf9e20?s=128&d=identicon&r=PG", "display_name": "user1575148", "link": "https://stackoverflow.com/users/1575148/user1575148"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1542603289, "post_id": 53260120, "comment_id": 93613433, "body": "@TomLord Yes, I went with that work around."}], "owner": {"reputation": 299, "user_id": 1575148, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f2c8bc01a7132c88962056d93bcf9e20?s=128&d=identicon&r=PG", "display_name": "user1575148", "link": "https://stackoverflow.com/users/1575148/user1575148"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 835, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542018133, "creation_date": 1542018133, "question_id": 53260120, "link": "https://stackoverflow.com/questions/53260120/railsapps-mysql2-gem-version-error-with-rails-5-2-1", "title": "RailsApps mysql2 gem version error with Rails 5.2.1", "body": "<p>I am facing a mysql2 gem version error while trying to create a new RailsApps example application using Rails Composer. For example, while creating a rails-devise-roles example with the following command:</p>\n\n<pre><code>$ rails new rails-devise-roles -m https://raw.github.com/RailsApps/rails-composer/master/composer.rb\n</code></pre>\n\n<p>The error is:</p>\n\n<blockquote>\n  <p><b>Error loading the 'mysql2' Active Record adapter. Missing a gem it depends on? can't activate mysql2 (&lt; 0.6.0, >= 0.4.4), already activated mysql2-0.3.21. Make sure all dependencies are added to Gemfile. (Gem::LoadError)</b></p>\n</blockquote>\n\n<p>The messages on the console indicate mysql2 version 0.3.21 is pulled in</p>\n\n<blockquote>\n  <p>run    bundle install --without production from \".\"<br>\n  Fetching gem metadata from <a href=\"https://rubygems.org/\" rel=\"nofollow noreferrer\">https://rubygems.org/</a>.........<br>\n  Fetching gem metadata from <a href=\"https://rubygems.org/\" rel=\"nofollow noreferrer\">https://rubygems.org/</a>.<br>\n  Resolving dependencies....<br>\n  ...................<br>\n  Using mysql2 0.3.21<br></p>\n</blockquote>\n\n<p>The generated Gemfile has</p>\n\n<pre><code>gem 'mysql2', '~&gt; 0.3.18'\n</code></pre>\n\n<p>I am using <code>ruby 2.5.3</code> and <code>Rails 5.2.1</code></p>\n"}, {"tags": ["ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 1, "creation_date": 1542018335, "post_id": 53259876, "comment_id": 93404624, "body": "When you moved the <code>@@private_attributes</code> to the module it is now module variable and not a class variable. One way to get around is that you use <code>mattr_accessor :private_attributes</code> inside <code>ClassMethods</code> module and use the getter for <code>private_attributes</code> in <code>process_attributes_from</code> like so: <code>process_attributes_from(self.class.private_attributes)</code>"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1542018464, "post_id": 53259876, "comment_id": 93404685, "body": "Note that when you use PrivateAttributes module inside some other class and set private_attributes, changes will reflect in your MyClass as well."}, {"owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "reply_to_user": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1542019391, "post_id": 53259876, "comment_id": 93405205, "body": "It seems to work great, thanks for the input, the <code>mattr_accessor</code> is a perfect workaround I didn&#39;t think of !"}], "answers": [{"tags": [], "owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "is_accepted": true, "score": 1, "last_activity_date": 1542019908, "creation_date": 1542019908, "answer_id": 53260596, "question_id": 53259876, "link": "https://stackoverflow.com/questions/53259876/how-to-best-abstract-class-variables-in-ruby/53260596#53260596", "title": "How to best abstract class variables in Ruby", "body": "<p><strong>Working solution</strong></p>\n\n<p>An easy workaround is to use <code>mattr_accessor</code> on the class level or anything similar to communicate our data around. I preferred to write down my own methods in this case:</p>\n\n<pre><code>module PrivateAttributes\n  include ProcessAttributes\n\n  def self.included(base)\n    base.extend(ClassMethods)\n    base.include(InstanceMethods)\n  end\n\n  module ClassMethods\n    @@private_attributes_memory = []\n\n    def private_attributes(*args)\n      @@private_attributes_memory = args\n    end\n\n    def private_attributes_memory\n      @@private_attributes_memory\n    end\n  end\n\n  module InstanceMethods\n    def private_attributes\n      @private_attributes ||= process_attributes_from private_attributes_memory\n    end\n\n    # you can add diverse methods here\n    # which will be used in MyClass once included\n\n    private\n\n    def private_attributes_memory\n      self.class.private_attributes_memory\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 53260596, "answer_count": 1, "score": 0, "last_activity_date": 1542019908, "creation_date": 1542017242, "last_edit_date": 1542017599, "question_id": 53259876, "link": "https://stackoverflow.com/questions/53259876/how-to-best-abstract-class-variables-in-ruby", "title": "How to best abstract class variables in Ruby", "body": "<p>I've got a class such as</p>\n\n<pre><code># this has been simplified for the example\nclass MyClass\n  @@private_attributes = []\n\n  def self.private_attributes(*args)\n    @@private_attributes = args\n  end\n\n  def private_attributes\n    @private_attributes ||= @@private_attributes\n  end\nend\n</code></pre>\n\n<p>It works great. I've this <code>@@private_attributes</code> set at class level which's then used at instance level in multiple ways.</p>\n\n<p>I want to abstract this logic somewhere else to simplify my class, something like that</p>\n\n<pre><code>class MyClass\n  include PrivateAttributes\nend\n</code></pre>\n\n<p>When I create the module <code>PrivateAttributes</code>, however I shape it, the <code>@@private_attributes</code> isn't understood at <code>MyClass</code> level.</p>\n\n<p>I tried many things but here's the latest code attempt</p>\n\n<pre><code>module PrivateAttributes\n  include ProcessAttributes\n\n  def self.included(base)\n    base.extend(ClassMethods)\n    base.include(InstanceMethods)\n  end\n\n  module ClassMethods\n    @@private_attributes = []\n\n    def private_attributes(*args)\n      @@private_attributes = args\n    end\n  end\n\n  module InstanceMethods\n    def private_attributes\n      @private_attributes ||= process_attributes_from(@@private_attributes)\n    end\n\n    def private_attributes?\n      instance_options[:scope] == :private\n    end\n  end\nend\n</code></pre>\n\n<p>It crashes with this error</p>\n\n<pre><code> NameError:\n   uninitialized class variable @@private_attributes in PrivateAttributes::InstanceMethods\n   Did you mean?  private_constant\n</code></pre>\n\n<p>In short, the <code>@@private_attributes</code> isn't transferred throughout the code, but looks like it stays at the module level.</p>\n\n<p>What's the best way to abstract this logic from my original class ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "rbenv", "gemfile"], "comments": [{"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1542015464, "post_id": 53259202, "comment_id": 93403091, "body": "Did you run <code>bundle</code> beforehand to install that gem? And then, did you run <code>bundle exec rails c</code> (note - <code>bundle exec</code> part in the beginning)?"}, {"owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "reply_to_user": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 1, "creation_date": 1542040166, "post_id": 53259202, "comment_id": 93416647, "body": "@nattfodd Yes, bundle and I tried both with and without bundle exec"}, {"owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1542055485, "post_id": 53259202, "comment_id": 93423368, "body": "Bundling <code>gem &#39;sports_api&#39;, git: &#39;https:&#47;&#47;github.com&#47;mikesilvis&#47;sports_api.git&#39;</code>  worked for me. However, the SportsAPI gem does not seem to return data for me."}, {"owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "reply_to_user": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1542085478, "post_id": 53259202, "comment_id": 93430887, "body": "@whodini9 yes, bundling always worked for me as well, but are you using rbenv or rvm? it no longer works under rbenv for some strange reason."}, {"owner": {"reputation": 1294, "user_id": 1574508, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JFCdr.jpg?s=128&g=1", "display_name": "trueinViso", "link": "https://stackoverflow.com/users/1574508/trueinviso"}, "edited": false, "score": 0, "creation_date": 1542220760, "post_id": 53259202, "comment_id": 93494221, "body": "what do you get when you run <code>bundle show sports_api</code>?"}, {"owner": {"reputation": 116, "user_id": 1781803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33eb05f10f2b71b9272ab3da9c379616?s=128&d=identicon&r=PG", "display_name": "unlimitedfocus", "link": "https://stackoverflow.com/users/1781803/unlimitedfocus"}, "edited": false, "score": 0, "creation_date": 1542253207, "post_id": 53259202, "comment_id": 93504807, "body": "I&#39;m using rvm(rails 5.2.1), it works for me with <code>gem &#39;sports_api&#39;, git: &#39;git@github.com:mikesilvis&#47;sports_api.git&#39;</code> weird, have you tried with <code>rvm</code>?"}, {"owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "reply_to_user": {"reputation": 1294, "user_id": 1574508, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JFCdr.jpg?s=128&g=1", "display_name": "trueinViso", "link": "https://stackoverflow.com/users/1574508/trueinviso"}, "edited": false, "score": 0, "creation_date": 1542308605, "post_id": 53259202, "comment_id": 93532970, "body": "@trueinViso <code>&#47;Users&#47;myusername&#47;.rbenv&#47;versions&#47;2.5.3&#47;lib&#47;ruby&#47;gems&#47;2.5.0&#47;&zwnj;&#8203;bundler&#47;gems&#47;sports_&zwnj;&#8203;api-b98e25a1acfc</code>"}, {"owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "reply_to_user": {"reputation": 116, "user_id": 1781803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33eb05f10f2b71b9272ab3da9c379616?s=128&d=identicon&r=PG", "display_name": "unlimitedfocus", "link": "https://stackoverflow.com/users/1781803/unlimitedfocus"}, "edited": false, "score": 0, "creation_date": 1542308686, "post_id": 53259202, "comment_id": 93533001, "body": "@unlimitedfocus Yes, I used rvm before and it worked. I wanted to switch to rbenv because it seemed better/more simplistic. The only thing that doesn&#39;t work is this gem. I do not get why this doesn&#39;t work in rbenv."}, {"owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "edited": false, "score": 0, "creation_date": 1542320597, "post_id": 53259202, "comment_id": 93537905, "body": "could it be something with this line in the sports_api gem? <code>&#47;lib&#47;sports_api.rb</code> I tried changing <code>Dir[&quot;#{File.dirname(__FILE__)}&#47;sports_api&#47;**&#47;**&#47;*.rb&quot;].sort_&zwnj;&#8203;by(&amp;:length).reject { |file| file.match(&#47;version&#47;) }.each { |f| load(f) }</code> to <code>Dir[&quot;#{File.dirname(__FILE__)}&#47;sports_api&#47;**&#47;**&#47;*.rb&quot;].sort_&zwnj;&#8203;by(&amp;:length).reject { |file| file.match(&#47;version&#47;) }.each { |f| require f }</code> but didn&#39;t make a difference."}], "answers": [{"comments": [{"owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "edited": false, "score": 0, "creation_date": 1542309557, "post_id": 53319273, "comment_id": 93533402, "body": "Thank you, I already did <code>echo &#39;if which rbenv &gt; &#47;dev&#47;null; then eval &quot;$(rbenv init -)&quot;; fi&#39; &gt;&gt; ~&#47;.bash_profile</code> and <code>source ~&#47;.bash_profile</code> when I installed rbenv. And Here is the <code>bundle show sports_api</code> - <code>&#47;Users&#47;myusername&#47;.rbenv&#47;versions&#47;2.5.3&#47;lib&#47;ruby&#47;gems&#47;2.5.0&#47;&zwnj;&#8203;bundler&#47;gems&#47;sports_&zwnj;&#8203;api-b98e25a1acfc</code>. Head scratching. It will only work when I change the source of the git to my local path. It works fine in rvm though."}, {"owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "edited": false, "score": 0, "creation_date": 1542320580, "post_id": 53319273, "comment_id": 93537901, "body": "could it be something with this line in the sports_api gem? <code>&#47;lib&#47;sports_api.rb</code> I tried changing <code>Dir[&quot;#{File.dirname(__FILE__)}&#47;sports_api&#47;**&#47;**&#47;*.rb&quot;].sort_&zwnj;&#8203;by(&amp;:length).reject { |file| file.match(&#47;version&#47;) }.each { |f| load(f) }</code> to <code>Dir[&quot;#{File.dirname(__FILE__)}&#47;sports_api&#47;**&#47;**&#47;*.rb&quot;].sort_&zwnj;&#8203;by(&amp;:length).reject { |file| file.match(&#47;version&#47;) }.each { |f| require f }</code> but didn&#39;t make a difference."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "edited": false, "score": 0, "creation_date": 1542375680, "post_id": 53319273, "comment_id": 93556899, "body": "@iamse7en that line just automatically requires everything in all of the subfolders, except the version file (which was explicitly included in the gemspec or one of the other files). I don&#39;t actually see any difference between behavior in this gem vs others on my system (using <code>path:</code> it is automatically required, using <code>git:</code> I have to manually <code>require</code>)"}], "tags": [], "owner": {"reputation": 1020, "user_id": 1590204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13cf73dd8e0bc2feed3abe4e88626e42?s=128&d=identicon&r=PG&f=1", "display_name": "Tema Bolshakov", "link": "https://stackoverflow.com/users/1590204/tema-bolshakov"}, "is_accepted": false, "score": 1, "last_activity_date": 1542284034, "creation_date": 1542284034, "answer_id": 53319273, "question_id": 53259202, "link": "https://stackoverflow.com/questions/53259202/gem-not-loading-nameerror-uninitialized-constant-but-gem-works-in-local-pat/53319273#53319273", "title": "Gem not loading: NameError (uninitialized constant) | But gem works in local path", "body": "<p>Run <code>rbenv init</code> and follow instructions. Note, restarting terminal is require after installing rbenv (see <a href=\"https://github.com/rbenv/rbenv#installation\" rel=\"nofollow noreferrer\">https://github.com/rbenv/rbenv#installation</a> for details).</p>\n\n<p>Ensure gem installed in rbenv path by executing <code>bundle show sports_api</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "edited": false, "score": 1, "creation_date": 1542333834, "post_id": 53330269, "comment_id": 93540960, "body": "I tried this. I&#39;ve tried <code>require &#39;sports_api&#39;</code> in rails console, as well as in one of the models (<code>game.rb</code>) I use this for api for. Still unable to load it. Always get <code>NameError (uninitialized constant SportsApi::Fetcher)</code>. Never had this problem with rvm. Really confusing."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "edited": false, "score": 0, "creation_date": 1542336616, "post_id": 53330269, "comment_id": 93541453, "body": "@iamse7en Are you running <code>bundle exec irb</code> (or have a shell alias to run it) and <code>bundle exec rails console</code> for your commands? Also have you tried to run <code>rbenv rehash</code> and/or start a new terminal window? And disabling bootsnap gem temporarily to rule it out might help (it&#39;s in the stack trace). If your code is on github I&#39;d be happy to take a look"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "edited": false, "score": 0, "creation_date": 1542339086, "post_id": 53330269, "comment_id": 93541925, "body": "A couple other things you can do to troubleshoot: make sure that your bundler, rake, irb, etc. are the correct ones (e.g. your $PATH is setup to support rbenv per install instructions). Also, I&#39;d try disabling spring with <code>spring stop</code> if it&#39;s running just to narrow down the problem."}, {"owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "edited": false, "score": 1, "creation_date": 1542353063, "post_id": 53330269, "comment_id": 93545827, "body": "I&#39;m running <code>bundle exec rails console</code>. I tried <code>rebenv rehash</code> and new terminal windows, restarting computer, etc. I tried disabling bootsnap as well. I&#39;ve also tried this in rails 4.2 with no boostnap. Same exact thing. The code for <code>sports_api</code> is on github. Not the code for my app. But don&#39;t think the app is my problem."}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 0, "last_activity_date": 1542332428, "creation_date": 1542332428, "answer_id": 53330269, "question_id": 53259202, "link": "https://stackoverflow.com/questions/53259202/gem-not-loading-nameerror-uninitialized-constant-but-gem-works-in-local-pat/53330269#53330269", "title": "Gem not loading: NameError (uninitialized constant) | But gem works in local path", "body": "<p>I see this same behavior with asdf (vs rbenv) so it's not an rbenv issue.</p>\n\n<p>Adding a <code>require 'sports_api'</code> somewhere in your codebase before calling the code, while using the syntax you wish to use, will resolve the load issue.</p>\n\n<p>I'm not 100% sure of the root cause, but I suspect it's may be a a combo of how path/git syntax is handled. Using the path syntax appears to automatically require the code for you (I wouldn't expect it to)</p>\n"}, {"comments": [{"owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "edited": false, "score": 0, "creation_date": 1542362637, "post_id": 53334168, "comment_id": 93549959, "body": "This did it! I did not write this gem, and I&#39;m not sure I quite understand why it&#39;s there. Are there any unintended consequences of removing this I should be aware of?"}, {"owner": {"reputation": 2366, "user_id": 2876134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43b732ddf9b8ccefd8ddba85c9a33447?s=128&d=identicon&r=PG&f=1", "display_name": "Cong Chen", "link": "https://stackoverflow.com/users/2876134/cong-chen"}, "reply_to_user": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "edited": false, "score": 1, "creation_date": 1542363034, "post_id": 53334168, "comment_id": 93550175, "body": "The <code>reject</code> method just filtered <code>sports_api&#47;version.rb</code>"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1542375916, "post_id": 53334168, "comment_id": 93557015, "body": "@GentryChen that&#39;s a good catch. Do you know why this worked? The <code>version.rb</code> file was required explicitly in the gemspec so it looked to me like that line was fine. Maybe it has something to do with the way bundler loads gems and resolves versions?"}, {"owner": {"reputation": 2366, "user_id": 2876134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43b732ddf9b8ccefd8ddba85c9a33447?s=128&d=identicon&r=PG&f=1", "display_name": "Cong Chen", "link": "https://stackoverflow.com/users/2876134/cong-chen"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 2, "creation_date": 1542378155, "post_id": 53334168, "comment_id": 93558266, "body": "@JayDorsey I&#39;ll try my best to find out the root cause, then i will update my answer."}], "tags": [], "owner": {"reputation": 2366, "user_id": 2876134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43b732ddf9b8ccefd8ddba85c9a33447?s=128&d=identicon&r=PG&f=1", "display_name": "Cong Chen", "link": "https://stackoverflow.com/users/2876134/cong-chen"}, "is_accepted": true, "score": 2, "last_activity_date": 1542619558, "last_edit_date": 1542619558, "creation_date": 1542357583, "answer_id": 53334168, "question_id": 53259202, "link": "https://stackoverflow.com/questions/53259202/gem-not-loading-nameerror-uninitialized-constant-but-gem-works-in-local-pat/53334168#53334168", "title": "Gem not loading: NameError (uninitialized constant) | But gem works in local path", "body": "<p><strong>Updated:</strong></p>\n\n<p>There's a trip made by gem <a href=\"https://github.com/MikeSilvis/sports_api\" rel=\"nofollow noreferrer\">sports_api</a>.</p>\n\n<p>At the first line of <a href=\"https://github.com/MikeSilvis/sports_api/blob/master/lib/sports_api.rb\" rel=\"nofollow noreferrer\">lib/sports_api.rb</a>:\n<code>reject { |file| file.match(/version/) }</code> the block  would filter all the ruby files. Because of <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">rbenv</a> install ruby into <code>~/.rbenv/versions</code> directory, with that the path of every gem files would come along with <code>version</code> string: </p>\n\n<blockquote>\n  <p>Each Ruby version is installed into its own directory under <code>~/.rbenv/versions</code>.</p>\n</blockquote>\n\n<hr>\n\n<p><strong>Old answer:</strong></p>\n\n<p>Remove <code>reject</code> method at the first line of <code>sports_api.rb</code>:</p>\n\n<pre><code>Dir[\"#{File.dirname(__FILE__)}/sports_api/**/**/*.rb\"].sort_by(&amp;:length).reject { |file| file.match(/version/) }.each { |f| load(f) }\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Dir[\"#{File.dirname(__FILE__)}/sports_api/**/**/*.rb\"].sort_by(&amp;:length).each { |f| load(f) }\n</code></pre>\n\n<p>then you should delete cached gem files installed by bundler and run <code>bundle install</code></p>\n"}, {"comments": [{"owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "edited": false, "score": 0, "creation_date": 1543107550, "post_id": 53454585, "comment_id": 93798703, "body": "Yes I tried this as well but did not solve my issue."}], "tags": [], "owner": {"reputation": 94, "user_id": 1636298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4db25e36d95dc0d07830cdc91bbb87e3?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Busso", "link": "https://stackoverflow.com/users/1636298/st%c3%a9phane-busso"}, "is_accepted": false, "score": 0, "last_activity_date": 1543025040, "creation_date": 1543025040, "answer_id": 53454585, "question_id": 53259202, "link": "https://stackoverflow.com/questions/53259202/gem-not-loading-nameerror-uninitialized-constant-but-gem-works-in-local-pat/53454585#53454585", "title": "Gem not loading: NameError (uninitialized constant) | But gem works in local path", "body": "<p>I was getting the same issue with other gems and solved it by restarting spring:</p>\n\n<pre><code>bin/spring stop\n</code></pre>\n\n<p>spring helps to load environment faster but sometimes get issues with caching.</p>\n"}], "owner": {"reputation": 602, "user_id": 3492181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sMjS4.png?s=128&g=1", "display_name": "iamse7en", "link": "https://stackoverflow.com/users/3492181/iamse7en"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2488, "favorite_count": 0, "accepted_answer_id": 53334168, "answer_count": 4, "score": 7, "last_activity_date": 1543025040, "creation_date": 1542014864, "last_edit_date": 1542320809, "question_id": 53259202, "link": "https://stackoverflow.com/questions/53259202/gem-not-loading-nameerror-uninitialized-constant-but-gem-works-in-local-pat", "title": "Gem not loading: NameError (uninitialized constant) | But gem works in local path", "body": "<p>I got a new machine and installed rbenv fresh (I always used rvm before). <a href=\"https://github.com/MikeSilvis/sports_api\" rel=\"nofollow noreferrer\">This gem</a> now won't load in my app. I made no code changes. The only difference between now and then is rbenv.</p>\n\n<pre><code>Loading development environment (Rails 5.2.1)\nirb(main):001:0&gt; SportsApi::Fetcher::Score::NBA\nTraceback (most recent call last):\n        1: from (irb):1\nNameError (uninitialized constant SportsApi::Fetcher)\n</code></pre>\n\n<p>Interestingly, if I clone the gem to my local machine, then change the path in the Gemfile, it DOES load/work.</p>\n\n<pre><code># gem 'sports_api', git: 'git@github.com:mikesilvis/sports_api.git'\ngem 'sports_api', path: '~/dev/sports_api'\n\n\nirb(main):001:0&gt; SportsApi::Fetcher::Score::NBA\n=&gt; SportsApi::Fetcher::Score::NBA\n</code></pre>\n\n<p>Why does it work on local path but not on the git path? Any ideas on what I can do to fix this (to use the git path)? Thank you in advance.</p>\n\n<p>Edit: Here is the full backtrace.</p>\n\n<pre><code>uninitialized constant SportsApi::Fetcher\n\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:74:in `block in load_missing_constant'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:8:in `without_bootsnap_cache'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:74:in `rescue in load_missing_constant'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:56:in `load_missing_constant'\n(irb):2:in `irb_binding'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb/workspace.rb:85:in `eval'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb/workspace.rb:85:in `evaluate'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb/context.rb:380:in `evaluate'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb.rb:491:in `block (2 levels) in eval_input'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb.rb:623:in `signal_status'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb.rb:488:in `block in eval_input'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb/ruby-lex.rb:246:in `block (2 levels) in each_top_level_statement'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb/ruby-lex.rb:232:in `loop'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb/ruby-lex.rb:232:in `block in each_top_level_statement'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb/ruby-lex.rb:231:in `catch'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb/ruby-lex.rb:231:in `each_top_level_statement'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb.rb:487:in `eval_input'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb.rb:428:in `block in run'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb.rb:427:in `catch'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb.rb:427:in `run'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/2.5.0/irb.rb:383:in `start'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/commands/console/console_command.rb:64:in `start'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/commands/console/console_command.rb:19:in `start'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/commands/console/console_command.rb:96:in `perform'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/command/base.rb:65:in `perform'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/command.rb:46:in `invoke'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/commands.rb:18:in `&lt;main&gt;'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `block in require_with_bootsnap_lfi'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/loaded_features_index.rb:65:in `register'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:20:in `require_with_bootsnap_lfi'\n/Users/myusername/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:29:in `require'\nbin/rails:4:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1542019152, "creation_date": 1542019152, "answer_id": 53260400, "question_id": 53259135, "link": "https://stackoverflow.com/questions/53259135/how-to-get-matching-data-across-multiple-tables-in-a-controller/53260400#53260400", "title": "How to get (matching) data across multiple tables in a controller?", "body": "<p>In the Order class you can do...</p>\n\n<pre><code>belongs_to :seller, foreign_key: :seller_id, class_name: 'User'\n</code></pre>\n\n<p>Once you've done this, rails knows about the relationship between Order and User, so you can then do...</p>\n\n<pre><code>@order.seller.stripe_token\n</code></pre>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 53260400, "answer_count": 1, "score": 0, "last_activity_date": 1542019152, "creation_date": 1542014639, "last_edit_date": 1542018401, "question_id": 53259135, "link": "https://stackoverflow.com/questions/53259135/how-to-get-matching-data-across-multiple-tables-in-a-controller", "title": "How to get (matching) data across multiple tables in a controller?", "body": "<p><strong>Question:</strong> How can I get data which is associated with each other in my controller from separate controllers and models?</p>\n\n<p><strong>Issue:</strong> I need my @order.seller_id's (which matches a @user.id) and then i need the @user.stripe_token.</p>\n\n<p>So i ultimately need the @user.stripe_token from the correct user_id, which is matched up through the @order.seller_id</p>\n\n<p>The order has a seller_id which is a users id.  This id is the same across all tables that have a user attached to it.  So in order to transfer the money, I need the correct @user the seller_id is associated to</p>\n\n<p>Here's the piece of code i need this for from my orderscontroller:\n<em>(when a order gets updated, the charge gets captured and seller receives commission)  It may not be set up 100% correctly atm but this is the currently where i'm at.</em></p>\n\n<pre><code>charge = Stripe::Charge.create({\n    :amount      =&gt; (@order.order_price).to_i * 100,\n    :description =&gt; 'Rails Stripe customer',\n    :currency    =&gt; 'usd',\n    :customer =&gt; @order.stripe_customer_token,\n\n    })\n\ntransfer = Stripe::Transfer.create({\n    application_fee_percent: 75\n    :currency    =&gt; 'usd',\n    destination: ---here's where i need the correct @user.stripe_token ---,\n    transfer_group: \"notes_328324\"\n    })\n</code></pre>\n"}, {"tags": ["ruby", "rack", "puma", "padrino"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1542012016, "post_id": 53258187, "comment_id": 93401368, "body": "what os, what versions of ruby? can you post output of <code>gem env</code> and also maybe check <a href=\"https://github.com/puma/puma/issues/1608\" rel=\"nofollow noreferrer\">github.com/puma/puma/issues/1608</a>"}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1542012280, "post_id": 53258187, "comment_id": 93401508, "body": "make that simple project as small as you can while still producing the 100% load and publish it here"}, {"owner": {"reputation": 115, "user_id": 8774732, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bDtaU.jpg?s=128&g=1", "display_name": "Mlok", "link": "https://stackoverflow.com/users/8774732/mlok"}, "edited": false, "score": 0, "creation_date": 1542014567, "post_id": 53258187, "comment_id": 93402628, "body": "lacostenycoder: Ah I did not notice new puma version (I started to handle this trouble a time ago now I returned to try to find a solution - release date is near). I hope it is fixed, it seems so, but I will tell after day or two, because the stress test which I performed now, is not 100% that will go into trouble. Thanks very much for the advice! I already upgraded a few times but before version 3.12.0."}], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 8774732, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bDtaU.jpg?s=128&g=1", "display_name": "Mlok", "link": "https://stackoverflow.com/users/8774732/mlok"}, "is_accepted": true, "score": 1, "last_activity_date": 1542367181, "creation_date": 1542367181, "answer_id": 53336834, "question_id": 53258187, "link": "https://stackoverflow.com/questions/53258187/puma-with-padrino-cpu-consumption-will-not-stop/53336834#53336834", "title": "Puma with Padrino, CPU consumption will not stop", "body": "<p>Solved! New version of puma fixed this issue. Thanks all</p>\n"}], "owner": {"reputation": 115, "user_id": 8774732, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bDtaU.jpg?s=128&g=1", "display_name": "Mlok", "link": "https://stackoverflow.com/users/8774732/mlok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 1, "accepted_answer_id": 53336834, "answer_count": 1, "score": 1, "last_activity_date": 1542367181, "creation_date": 1542010740, "last_edit_date": 1542013972, "question_id": 53258187, "link": "https://stackoverflow.com/questions/53258187/puma-with-padrino-cpu-consumption-will-not-stop", "title": "Puma with Padrino, CPU consumption will not stop", "body": "<p>I have one problem which I am trying to solve, I have Ruby web project, written in Padrino, it is quite simply project. But I have problems with running the Puma. </p>\n\n<p>Everything works fine, but after a few days, or if I make a stress test, the process of Puma is consuming 100% CPU and stays there forever. I need just to restart Puma (resp. kill it and start again). </p>\n\n<p>It is happening on a few my projects, on Debian Stretch and Jessie.</p>\n\n<p>Puma version is 3.11.4</p>\n\n<p>and this is one of the config files:</p>\n\n<pre><code>preload_app!\n\nrackup 'config.ru'\n\nenvironment 'production'\n\ndaemonize\npidfile 'logs/osadababa.pid'\n\nstate_path 'logs/puma.state'\nstdout_redirect 'logs/stdout', 'logs/stderr', true\n\nthreads 4,6\n\nbind 'ssl://0.0.0.0:8060?key=/etc/letsencrypt/live/osadababa.cz/privkey.pem&amp;cert=/etc/letsencrypt/live/osadababa.cz/fullchain.pem'\n\ntag 'osadababa-dev'\n</code></pre>\n\n<p>I am desperate to know why and solve this annoying problem, I tried to play with configuration, without success. Now two of the processes are at 100%, but the website is working, just draining resources.</p>\n\n<p>Have you some experience like this? Please any suggestions.</p>\n\n<p>EDIT:</p>\n\n<pre><code>RubyGems Environment:\n  - RUBYGEMS VERSION: 2.7.7\n  - RUBY VERSION: 2.5.1 (2018-03-29 patchlevel 57) [x86_64-linux]\n  - INSTALLATION DIRECTORY: /usr/local/rvm/gems/ruby-2.5.1\n  - USER INSTALLATION DIRECTORY: /root/.gem/ruby/2.5.0\n  - RUBY EXECUTABLE: /usr/local/rvm/rubies/ruby-2.5.1/bin/ruby\n  - EXECUTABLE DIRECTORY: /usr/local/rvm/gems/ruby-2.5.1/bin\n  - SPEC CACHE DIRECTORY: /root/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /usr/local/rvm/rubies/ruby-2.5.1/etc\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-linux\n  - GEM PATHS:\n     - /usr/local/rvm/gems/ruby-2.5.1\n     - /usr/local/rvm/gems/ruby-2.5.1@global\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /opt/swift/build/swift-4.1.2-RELEASE-ubuntu14.04/usr/bin\n     - /usr/local/rvm/gems/ruby-2.5.1/bin\n     - /usr/local/rvm/gems/ruby-2.5.1@global/bin\n     - /usr/local/rvm/rubies/ruby-2.5.1/bin\n     - /usr/local/sbin\n     - /usr/local/bin\n     - /usr/sbin\n     - /usr/bin\n     - /sbin\n     - /bin\n     - /usr/local/rvm/bin\n</code></pre>\n\n<p>I am running ruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-linux]</p>\n\n<p>Using Puma from Debian package distribution. I will try the upgrade and I will try to create a simple project to test whether the problem will appear too.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "undefined", "inherited-resources"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1542002230, "post_id": 53256366, "comment_id": 93397702, "body": "Which version of rails are you using?"}, {"owner": {"reputation": 31, "user_id": 8118760, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NHN8ETqvOLw/AAAAAAAAAAI/AAAAAAAAAA8/XJ6zXA6VjSY/photo.jpg?sz=128", "display_name": "Muhammad Munib ur Rehman", "link": "https://stackoverflow.com/users/8118760/muhammad-munib-ur-rehman"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1542006091, "post_id": 53256366, "comment_id": 93398976, "body": "I&#39;m using Rails 3.2.21"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1542006461, "post_id": 53256366, "comment_id": 93399097, "body": "Check whether the answer in the flagged post works for you or not."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542035477, "post_id": 53256366, "comment_id": 93414059, "body": "Update <code>haml-rails</code> you are using version <code>0.1</code> (literally the first version tagged in github) there is currently a release for <code>1.0</code> which does not include the offending line <a href=\"https://github.com/indirect/haml-rails/blob/v0.1/lib/haml-rails.rb#L4\" rel=\"nofollow noreferrer\">0.1 error you are receiving</a> <b>vs.</b> <a href=\"https://github.com/indirect/haml-rails/blob/v1.0.0/lib/haml-rails.rb\" rel=\"nofollow noreferrer\">1.0 version of the same file</a>"}], "owner": {"reputation": 31, "user_id": 8118760, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NHN8ETqvOLw/AAAAAAAAAAI/AAAAAAAAAA8/XJ6zXA6VjSY/photo.jpg?sz=128", "display_name": "Muhammad Munib ur Rehman", "link": "https://stackoverflow.com/users/8118760/muhammad-munib-ur-rehman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "closed_date": 1542006420, "answer_count": 0, "score": 1, "last_activity_date": 1542022587, "creation_date": 1542000518, "last_edit_date": 1592644375, "question_id": 53256366, "link": "https://stackoverflow.com/questions/53256366/method-missing-undefined-method-generators-for-railsrailtieconfigurat", "closed_reason": "Duplicate", "title": "`method_missing&#39;: undefined method `generators&#39; for #&lt;Rails::Railtie::Configuration:0x000000057583e8&gt;", "body": "<p>I'm getting undefined method error when i try to run rails s command from my linux terminal. i don't have inherited_resources gem in my gemfile.</p>\n<p><strong>I understand that such question has been answered already but this is not so in my case. i don't have inherited resources gem nor it solves the issue for me even when i install required version of gem.</strong></p>\n<p>Complete logs are:</p>\n<pre><code>/gems/railties-3.2.21/lib/rails/railtie/configuration.rb:85:in 'method_missing': undefined method 'generators' for #&lt;Rails::Railtie::Configuration:0x000000049d2340&gt; (NoMethodError)\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/haml-rails-0.1/lib/haml-rails.rb:4:in '&lt;class:Railtie&gt;'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/haml-rails-0.1/lib/haml-rails.rb:3:in '&lt;module:Rails&gt;'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/haml-rails-0.1/lib/haml-rails.rb:2:in '&lt;module:Haml&gt;'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/haml-rails-0.1/lib/haml-rails.rb:1:in '&lt;top (required)&gt;'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/bundler-1.17.1/lib/bundler/runtime.rb:81:in 'require'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/bundler-1.17.1/lib/bundler/runtime.rb:81:in 'block (2 levels) in require'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/bundler-1.17.1/lib/bundler/runtime.rb:76:in 'each'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/bundler-1.17.1/lib/bundler/runtime.rb:76:in 'block in require'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/bundler-1.17.1/lib/bundler/runtime.rb:65:in 'each'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/bundler-1.17.1/lib/bundler/runtime.rb:65:in 'require'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/bundler-1.17.1/lib/bundler.rb:114:in 'require'\n    from /home/munib/workspace/mil/config/application.rb:8:in '&lt;top (required)&gt;'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/railties-3.2.21/lib/rails/commands.rb:53:in 'require'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/railties-3.2.21/lib/rails/commands.rb:53:in 'block in &lt;top (required)&gt;'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/railties-3.2.21/lib/rails/commands.rb:50:in 'tap'\n    from /home/munib/.rvm/gems/ruby-2.1.10@mil3.2.3/gems/railties-3.2.21/lib/rails/commands.rb:50:in '&lt;top (required)&gt;'\n    from script/rails:6:in 'require'\n    from script/rails:6:in '&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord", "nested-attributes"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541997446, "post_id": 53256029, "comment_id": 93396615, "body": "Can you please add log when you hit the update action?"}, {"owner": {"reputation": 742, "user_id": 5328443, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/MIICt.png?s=128&g=1", "display_name": "slehmann36", "link": "https://stackoverflow.com/users/5328443/slehmann36"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541997783, "post_id": 53256029, "comment_id": 93396695, "body": "@Vishal I&#39;ve added server logs for the <code>quotes#update</code> action."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541997957, "post_id": 53256029, "comment_id": 93396736, "body": "check your parameters for <code>quote_line_item</code> it should be <code>quote_line_items_attributes</code> . can you please try with this `  accepts_nested_attributes_for :quote_line_items, update_only: true ` and check how parameters are passing with this."}, {"owner": {"reputation": 742, "user_id": 5328443, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/MIICt.png?s=128&g=1", "display_name": "slehmann36", "link": "https://stackoverflow.com/users/5328443/slehmann36"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541998321, "post_id": 53256029, "comment_id": 93396822, "body": "@Vishal thanks for the suggestion. With your suggested updates, I receive the error <code>No association found for name &#39;quote_line_items&#39;. Has it been defined yet?</code>. The documentation shows that the model should be referenced in a singular form if the association is a <code>has_one</code>. Thanks"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541998542, "post_id": 53256029, "comment_id": 93396874, "body": "Okay, it should be only<code>accepts_nested_attributes_for :quote_line_item, update_only: true</code>, but you need to pass the parameters correctly. in form, try this <code>&lt;%= fields_for :quote_line_item, @quote.quote_line_item do |quote_line_item_fields| %&gt;</code>"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541998612, "post_id": 53256029, "comment_id": 93396893, "body": "Let me know if it isn&#39;t working"}, {"owner": {"reputation": 742, "user_id": 5328443, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/MIICt.png?s=128&g=1", "display_name": "slehmann36", "link": "https://stackoverflow.com/users/5328443/slehmann36"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541999014, "post_id": 53256029, "comment_id": 93396980, "body": "@Vishal Thanks for your suggestion. Declaring <code>fields_for</code> as you suggested in above comment didn&#39;t seem to make a difference."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541999189, "post_id": 53256029, "comment_id": 93397013, "body": "can you please update log, after adding new syntax of fields_for"}, {"owner": {"reputation": 742, "user_id": 5328443, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/MIICt.png?s=128&g=1", "display_name": "slehmann36", "link": "https://stackoverflow.com/users/5328443/slehmann36"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541999200, "post_id": 53256029, "comment_id": 93397014, "body": "I notice that the form parameters being parsed to <code>quotes#update</code> look like this: <code>&quot;quote&quot;=&gt;{&quot;issued_at&quot;=&gt;&quot;12&#47;11&#47;2018 11:05 AM&quot;}, &quot;quote_line_item&quot;=&gt;{&quot;description&quot;=&gt;&quot;Line item description goes here...&quot;, &quot;price&quot;=&gt;&quot;200.00&quot;}</code>, notice the <code>quote_line_item</code> hash outside of the <code>quote</code> hash. Is this expected behaviour, or should the <code>quote_line_item</code> has be nested within the <code>quote</code> hash?"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541999326, "post_id": 53256029, "comment_id": 93397047, "body": "and what if you only use <code>&lt;%= fields_for :quote_line_item do |quote_line_item_fields| %&gt;</code>"}, {"owner": {"reputation": 742, "user_id": 5328443, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/MIICt.png?s=128&g=1", "display_name": "slehmann36", "link": "https://stackoverflow.com/users/5328443/slehmann36"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541999555, "post_id": 53256029, "comment_id": 93397102, "body": "@Vishal I&#39;ve updated the question with your suggested <code>fields_for</code> syntax and the resulting server log. Regarding your most recent <code>fields_for</code> syntax suggestion, this makes no difference other than the form stops pre-filling the fields with their existing values. Thanks"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541999768, "post_id": 53256029, "comment_id": 93397150, "body": "last try, please add <code>@quote.build_quote_line_item</code> in your new action"}, {"owner": {"reputation": 742, "user_id": 5328443, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/MIICt.png?s=128&g=1", "display_name": "slehmann36", "link": "https://stackoverflow.com/users/5328443/slehmann36"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1542000210, "post_id": 53256029, "comment_id": 93397244, "body": "@Vishal Thanks for your suggestion. Adding <code>@quote.build_quote_line_item</code> as suggested seems to destroy any existing <code>QuoteLineItem</code> record for the <code>Quote</code> in preparation for the replacement record that&#39;s being &quot;built&quot;. Thanks for your input."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1542000712, "post_id": 53256029, "comment_id": 93397351, "body": "The only thing you missing is name of parameters for nested parameters."}, {"owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "edited": false, "score": 0, "creation_date": 1542001645, "post_id": 53256029, "comment_id": 93397538, "body": "most probably what you are missing is :id in the permit params for quote_line_item_attributes. Therefore permit params would be something like this:  params.require(:quote).permit(:issued_at, quote_line_item_attributes: [ :id, :kind, :description, :price ])"}, {"owner": {"reputation": 742, "user_id": 5328443, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/MIICt.png?s=128&g=1", "display_name": "slehmann36", "link": "https://stackoverflow.com/users/5328443/slehmann36"}, "reply_to_user": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "edited": false, "score": 0, "creation_date": 1542004253, "post_id": 53256029, "comment_id": 93398301, "body": "@AkshayGoyal Thanks for your suggestion. I&#39;ve tried adding the <code>:id</code> parameter to the <code>quote_line_item_attributes</code> permitted params as you suggested, but it didn&#39;t seem to make any difference. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 6639649, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d2464c9badaedd7153680c4dd4cd86bb?s=128&d=identicon&r=PG&f=1", "display_name": "JosephA91", "link": "https://stackoverflow.com/users/6639649/josepha91"}, "is_accepted": true, "score": 1, "last_activity_date": 1542005393, "creation_date": 1542005393, "answer_id": 53257130, "question_id": 53256029, "link": "https://stackoverflow.com/questions/53256029/values-for-nested-fields-not-saving-without-error-rails-5-2/53257130#53257130", "title": "Values for nested fields not saving without error | Rails 5.2", "body": "<p>Try referencing <code>quote_form</code> before your <code>fields_for</code>:</p>\n\n<pre><code>&lt;%= form_for @quote do |quote_form| %&gt;\n\n  ...\n\n  &lt;%= quote_form.fields_for :quote_line_item do |quote_line_item_fields| %&gt;\n  #   ^ &lt;- Add here\n\n    ...\n\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>After updating this, check that the parameters being passed to <code>quotes#edit</code> are nested:</p>\n\n<p>i.e: <code>\"quote\"=&gt;{\"issued_at\"=&gt;\"12/11/2018 11:05 AM\", \"quote_line_item\"=&gt;{\"description\"=&gt;\"Line item description goes here...\", \"price\"=&gt;\"200.00\"}, \"id\"=&gt;\"63\"}</code></p>\n"}], "owner": {"reputation": 742, "user_id": 5328443, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/MIICt.png?s=128&g=1", "display_name": "slehmann36", "link": "https://stackoverflow.com/users/5328443/slehmann36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 53257130, "answer_count": 1, "score": 1, "last_activity_date": 1542005393, "creation_date": 1541997381, "last_edit_date": 1541999370, "question_id": 53256029, "link": "https://stackoverflow.com/questions/53256029/values-for-nested-fields-not-saving-without-error-rails-5-2", "title": "Values for nested fields not saving without error | Rails 5.2", "body": "<p>I'm working on a Rails 5.2 application requiring the storing of a <code>Quote</code>, and one <code>QuoteLineItem</code> to go wwith it (<code>Quote</code> <code>has_one :quote_line_item</code>, <code>QuoteLineItem</code> <code>belongs_to :quote</code>). I've set it all up according to documentation, however when submitting the <code>quotes#edit</code> for (which contains <code>fields_for @quote.quote_line_item...</code>), the values for the <code>Quote</code> record are updated in the database, however values for the <code>QuoteLineItem</code> are not. No error is thrown on submission, and no \"Unpermitted params...\" message in server logs.</p>\n\n<p><strong>Quote Model</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Quote &lt; ApplicationRecord\n  has_one :quote_line_item, inverse_of: :quote, dependent: :destroy\n  accepts_nested_attributes_for :quote_line_item, update_only: true\nend\n</code></pre>\n\n<p><strong>QuoteLineItem Model</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class QuoteLineItem &lt; ApplicationRecord\n  belongs_to :quote, inverse_of: :quote_line_item, touch: true\nend\n</code></pre>\n\n<p><strong>Quotes Controller</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class QuotesController &lt; ApplicationController\n  def update\n    @quote = Quote.find(params[:id])\n\n    if @quote.update(quote_params)\n      flash[:success] = \"Quote was successfully updated.\"\n      redirect_to @quote\n    else\n      flash[:error] = \"Quote was not updated. Please try again.\"\n      render :edit\n    end\n  end\n\n  private\n    def quote_params\n      params.require(:quote).permit(:issued_at, quote_line_item_attributes: [ :kind, :description, :price ])\n    end\nend\n</code></pre>\n\n<p><strong>Quotes Edit View</strong></p>\n\n<pre><code>&lt;%= form_for @quote do |quote_form| %&gt;\n  &lt;% if @quote.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@quote.errors.count, \"error\") %&gt; prohibited this quote from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n        &lt;% @quote.errors.full_messages.each do |message| %&gt;\n          &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n        &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;%= quote_form.label :issued_at %&gt;\n  &lt;%= quote_form.datetime_field :issued_at %&gt;\n\n  &lt;%= fields_for :quote_line_item, @quote.quote_line_item do |quote_line_item_fields| %&gt;\n    &lt;%= quote_line_item_fields.label :description %&gt;&lt;br&gt;\n    &lt;%= quote_line_item_fields.text_field :description %&gt;\n\n    &lt;%= quote_line_item_fields.label :price %&gt;\n    &lt;%= quote_line_item_fields.number_field :price, step: :any %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Server Logs</strong></p>\n\n<pre><code>Started PATCH \"/quotes/62\" for 127.0.0.1 at 2018-11-12 13:01:46 +0800\nProcessing by QuotesController#update as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"bVa+vhRayuPDhe5xkLcK2rm10zQ9oHvtDSZsKDhMBsdX/JDjf6uXsnIJ7gM/yP7Lt9E+aBGIR9WCoLU2uNhgVQ==\", \"quote\"=&gt;{\"issued_at\"=&gt;\"12/11/2018 11:05 AM\"}, \"quote_line_item\"=&gt;{\"description\"=&gt;\"QuoteLineItem description goes here...\", \"price\"=&gt;\"800.00\"}, \"commit\"=&gt;\"Save\", \"id\"=&gt;\"62\"}\n  Quote Load (3.8ms)  SELECT  `quotes`.* FROM `quotes` WHERE `quotes`.`id` = 62 LIMIT 1\n  \u21b3 app/controllers/quotes_controller.rb:127\n   (0.7ms)  BEGIN\n  \u21b3 app/controllers/quotes_controller.rb:53\n   (3.6ms)  COMMIT\n  \u21b3 app/controllers/quotes_controller.rb:53\nRedirected to http://localhost:3000/quotes/62\nCompleted 302 Found in 44ms (ActiveRecord: 9.3ms)\n</code></pre>\n\n<p>Is there a reason this shouldn't be working? </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "fields-for"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 1, "creation_date": 1541988073, "post_id": 53255100, "comment_id": 93394837, "body": "probably needs to be <code>f.fields_for :foos</code> because <code>abc_foos</code> isn&#39;t a valid instance method on <code>Abc::Bar</code>"}, {"owner": {"reputation": 2072, "user_id": 3389795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LiAJt.jpg?s=128&g=1", "display_name": "Shiko", "link": "https://stackoverflow.com/users/3389795/shiko"}, "edited": false, "score": 0, "creation_date": 1541988728, "post_id": 53255100, "comment_id": 93394944, "body": "Have you tried ? <code>Abc::Bar.new(params.require(:abc_bar).permit(:a, :b, abc_foos_attributes: [:qux]))</code>"}, {"owner": {"reputation": 83, "user_id": 1763255, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e71462b811f4523092df090f77b5059d?s=128&d=identicon&r=PG", "display_name": "josias", "link": "https://stackoverflow.com/users/1763255/josias"}, "edited": false, "score": 0, "creation_date": 1541989885, "post_id": 53255100, "comment_id": 93395161, "body": "I have tried with the &quot;attributes&quot; sufix. When I do this I get: undefined method `[]&#39; for nil:NilClass"}, {"owner": {"reputation": 83, "user_id": 1763255, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e71462b811f4523092df090f77b5059d?s=128&d=identicon&r=PG", "display_name": "josias", "link": "https://stackoverflow.com/users/1763255/josias"}, "edited": false, "score": 0, "creation_date": 1541990230, "post_id": 53255100, "comment_id": 93395219, "body": "Hi Josh. I tried the :foos alternative. In this case I get the same error above: undefined method [] for nil:NilClass"}, {"owner": {"reputation": 83, "user_id": 1763255, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e71462b811f4523092df090f77b5059d?s=128&d=identicon&r=PG", "display_name": "josias", "link": "https://stackoverflow.com/users/1763255/josias"}, "edited": false, "score": 0, "creation_date": 1541990616, "post_id": 53255100, "comment_id": 93395305, "body": "Hi Josh, again. I forgot to mention that the inputs aren&#39;t generated in this case."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 1763255, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e71462b811f4523092df090f77b5059d?s=128&d=identicon&r=PG", "display_name": "josias", "link": "https://stackoverflow.com/users/1763255/josias"}, "edited": false, "score": 0, "creation_date": 1542024763, "post_id": 53258201, "comment_id": 93408092, "body": "Hi! I have tried this too, in this case the inputs are not generated and then :foos becomes nil. I&#39;ll update the question with the backtrace, Thanks!"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1542010799, "creation_date": 1542010799, "answer_id": 53258201, "question_id": 53255100, "link": "https://stackoverflow.com/questions/53255100/rails-5-fields-for-namespaced-classes/53258201#53258201", "title": "Rails 5 fields_for namespaced classes", "body": "<p>Can you post full backtrace errors?  But in the meantime if you try </p>\n\n<pre><code>&lt;%= f.fields_for :foos, @bar.foos do |foo| %&gt;\n     &lt;%= foo.hidden_field :qux, value: true %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>you probably also need to do </p>\n\n<pre><code>@bar = Abc::Bar.new(params.require(:abc_bar).permit(:a, :b, foos: [:qux]))\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 1763255, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e71462b811f4523092df090f77b5059d?s=128&d=identicon&r=PG", "display_name": "josias", "link": "https://stackoverflow.com/users/1763255/josias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542076107, "creation_date": 1541987804, "last_edit_date": 1542076107, "question_id": 53255100, "link": "https://stackoverflow.com/questions/53255100/rails-5-fields-for-namespaced-classes", "title": "Rails 5 fields_for namespaced classes", "body": "<p>I'm having some trouble with nested attributes when the defined classes are inside a module:</p>\n\n<pre><code># file bar.rb\nmodule Abc\n    class Bar &lt;&lt; ActiveRecord::Base\n        has_many :foos\n        accepts_nested_attributes_for :foos\n    end\nend\n\n# file foo.rb\nmodule Abc\n    class Foo &lt;&lt; ActiveRecord::Base\n        belongs_to :bar\n        # let's consider an attribute: qux\n    end\nend\n\n# inside the controller\ndef new\n    @bar = Abc::Bar.new\nend\n\n# inside a view\n&lt;%= form_for @bar .... do |f| %&gt;\n    ....\n    &lt;%= f.fields_for :abc_foos, @bar.foos do |ff| %&gt;\n         &lt;%= ff.hidden_field :qux, value: true %&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Now we got the prefix \"abc\" in the names attributes></p>\n\n<pre><code># the rendered html\n&lt;input type=\"hidden\"  name=\"abc_bar[abc_foos][qux]\" ... /&gt;\n</code></pre>\n\n<p>The params now comes with the abc_foos included:</p>\n\n<pre><code> # the params hash\n    \"abc_bar\" =&gt; {\n        ....\n       \"abc_foos\" =&gt; {\"qux\" =&gt; \"some value\"}\n    }\n</code></pre>\n\n<p>The problem: the accepts_nested_attributes_for method creates something like \"abc_foos_attributes=\" in order to receive the attributes, but the default param key name is different. So, this will not work:</p>\n\n<pre><code> # in the controller, again\n def create\n       @bar = Abc::Bar.new(params.require(:abc_bar).permit(:a, :b, abc_foos: [:qux]))\n end\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>unknown attribute 'abc_foos' for Abc::Bar.\n</code></pre>\n\n<p>I would expect something like \"foos_attributes\" as the appropriate key. What am I missing?</p>\n\n<p>Thanks!</p>\n\n<p>The full bactrace:</p>\n\n<pre><code>activemodel (5.2.1) lib/active_model/attribute_assignment.rb:53:in `_assign_attribute'\nactiverecord (5.2.1) lib/active_record/attribute_assignment.rb:31:in `block in assign_nested_parameter_attributes'\nactiverecord (5.2.1) lib/active_record/attribute_assignment.rb:31:in `each'\nactiverecord (5.2.1) lib/active_record/attribute_assignment.rb:31:in `assign_nested_parameter_attributes'\nactiverecord (5.2.1) lib/active_record/attribute_assignment.rb:25:in `_assign_attributes'\nactivemodel (5.2.1) lib/active_model/attribute_assignment.rb:35:in `assign_attributes'\nactiverecord (5.2.1) lib/active_record/core.rb:314:in `initialize'\nactiverecord (5.2.1) lib/active_record/inheritance.rb:66:in `new'\nactiverecord (5.2.1) lib/active_record/inheritance.rb:66:in `new'\napp/controllers/bar_controller.rb:33:in `create'\nactionpack (5.2.1) lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'\nactionpack (5.2.1) lib/abstract_controller/base.rb:194:in `process_action'\nactionpack (5.2.1) lib/action_controller/metal/rendering.rb:30:in `process_action'\nactionpack (5.2.1) lib/abstract_controller/callbacks.rb:42:in `block in process_action'\nactivesupport (5.2.1) lib/active_support/callbacks.rb:132:in `run_callbacks'\nactionpack (5.2.1) lib/abstract_controller/callbacks.rb:41:in `process_action'\nactionpack (5.2.1) lib/action_controller/metal/rescue.rb:22:in `process_action'\nactionpack (5.2.1) lib/action_controller/metal/instrumentation.rb:34:in `block in process_action'\nactivesupport (5.2.1) lib/active_support/notifications.rb:168:in `block in instrument'\nactivesupport (5.2.1) lib/active_support/notifications/instrumenter.rb:23:in `instrument'\nactivesupport (5.2.1) lib/active_support/notifications.rb:168:in `instrument'\nactionpack (5.2.1) lib/action_controller/metal/instrumentation.rb:32:in `process_action'\nactionpack (5.2.1) lib/action_controller/metal/params_wrapper.rb:256:in `process_action'\nactiverecord (5.2.1) lib/active_record/railties/controller_runtime.rb:24:in `process_action'\nactionpack (5.2.1) lib/abstract_controller/base.rb:134:in `process'\nactionview (5.2.1) lib/action_view/rendering.rb:32:in `process'\nactionpack (5.2.1) lib/action_controller/metal.rb:191:in `dispatch'\nactionpack (5.2.1) lib/action_controller/metal.rb:252:in `dispatch'\nactionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:52:in `dispatch'\nactionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:34:in `serve'\nactionpack (5.2.1) lib/action_dispatch/journey/router.rb:52:in `block in serve'\nactionpack (5.2.1) lib/action_dispatch/journey/router.rb:35:in `each'\nactionpack (5.2.1) lib/action_dispatch/journey/router.rb:35:in `serve'\nactionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:840:in `call'\nrack (2.0.6) lib/rack/tempfile_reaper.rb:15:in `call'\nrack (2.0.6) lib/rack/etag.rb:25:in `call'\nrack (2.0.6) lib/rack/conditional_get.rb:38:in `call'\nrack (2.0.6) lib/rack/head.rb:12:in `call'\nactionpack (5.2.1) lib/action_dispatch/http/content_security_policy.rb:18:in `call'\nrack (2.0.6) lib/rack/session/abstract/id.rb:232:in `context'\nrack (2.0.6) lib/rack/session/abstract/id.rb:226:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/cookies.rb:670:in `call'\nactiverecord (5.2.1) lib/active_record/migration.rb:559:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (5.2.1) lib/active_support/callbacks.rb:98:in `run_callbacks'\nactionpack (5.2.1) lib/action_dispatch/middleware/callbacks.rb:26:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/executor.rb:14:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'\nweb-console (3.7.0) lib/web_console/middleware.rb:135:in `call_app'\nweb-console (3.7.0) lib/web_console/middleware.rb:22:in `block in call'\nweb-console (3.7.0) lib/web_console/middleware.rb:20:in `catch'\nweb-console (3.7.0) lib/web_console/middleware.rb:20:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'\nrailties (5.2.1) lib/rails/rack/logger.rb:38:in `call_app'\nrailties (5.2.1) lib/rails/rack/logger.rb:26:in `block in call'\nactivesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `block in tagged'\nactivesupport (5.2.1) lib/active_support/tagged_logging.rb:28:in `tagged'\nactivesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `tagged'\nrailties (5.2.1) lib/rails/rack/logger.rb:26:in `call'\nsprockets-rails (3.2.1) lib/sprockets/rails/quiet_assets.rb:13:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'\nrack (2.0.6) lib/rack/method_override.rb:22:in `call'\nrack (2.0.6) lib/rack/runtime.rb:22:in `call'\nactivesupport (5.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/executor.rb:14:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/static.rb:127:in `call'\nrack (2.0.6) lib/rack/sendfile.rb:111:in `call'\nrailties (5.2.1) lib/rails/engine.rb:524:in `call'\npuma (3.12.0) lib/puma/configuration.rb:225:in `call'\npuma (3.12.0) lib/puma/server.rb:658:in `handle_request'\npuma (3.12.0) lib/puma/server.rb:472:in `process_client'\npuma (3.12.0) lib/puma/server.rb:332:in `block in run'\npuma (3.12.0) lib/puma/thread_pool.rb:133:in `block in spawn_thread'    \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 335, "user_id": 7397660, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/41bca4edee3203ddfa4ed21b501e1bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Code father", "link": "https://stackoverflow.com/users/7397660/code-father"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1541983521, "post_id": 53254668, "comment_id": 93393955, "body": "Currently the db used is PostgreSQL 9.5.14."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 3, "creation_date": 1541983772, "post_id": 53254668, "comment_id": 93394000, "body": "Have you considered using <a href=\"https://postgis.net/\" rel=\"nofollow noreferrer\">PostGIS</a>? You wouldn&#39;t have to load all the records as you would be able to filter directly on DB level using <a href=\"https://postgis.net/docs/ST_Distance.html\" rel=\"nofollow noreferrer\">ST_Distance</a>."}, {"owner": {"reputation": 335, "user_id": 7397660, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/41bca4edee3203ddfa4ed21b501e1bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Code father", "link": "https://stackoverflow.com/users/7397660/code-father"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1541983970, "post_id": 53254668, "comment_id": 93394037, "body": "Done; nope haven&#39;t tried postgis yet. Currently for the location &#39;geocoder&#39; gem is used."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1541984225, "post_id": 53254668, "comment_id": 93394074, "body": "Well, you will have to move the filtering to a database at some point. <code>vehicle.longitude.present?</code> could be moved to DB-level, but I suppose that won&#39;t help much. Your best bets are either PostGIS or ElasticSearch, imho."}, {"owner": {"reputation": 335, "user_id": 7397660, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/41bca4edee3203ddfa4ed21b501e1bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Code father", "link": "https://stackoverflow.com/users/7397660/code-father"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1541986641, "post_id": 53254668, "comment_id": 93394519, "body": "Thanks for the suggestion @MarcinKo\u0142odziej. Also, I guess indexing those fields could boost up the speed. Thoughts?"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 2, "creation_date": 1541987206, "post_id": 53254668, "comment_id": 93394672, "body": "Right now you can index only the fields you&#39;re searching by (<code>users.id</code>,<code>country</code>,<code>name</code>, etc.), indexing longitudes and latitudes without PostGIS won&#39;t help."}, {"owner": {"reputation": 2072, "user_id": 3389795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LiAJt.jpg?s=128&g=1", "display_name": "Shiko", "link": "https://stackoverflow.com/users/3389795/shiko"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1541989324, "post_id": 53254668, "comment_id": 93395052, "body": "As mentioned by @MarcinKo\u0142odziej <b>PostGIS</b> is the best and logic solution and any improve won&#39;t help because you are fetching lots of data which won&#39;t be in use, you can check the example in this link <a href=\"https://medium.com/@hin556/location-based-searching-in-rails-5-part-2-using-postgis-extension-7ab2d34b9885\" rel=\"nofollow noreferrer\">medium.com/@hin556/&hellip;</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1542035859, "post_id": 53254668, "comment_id": 93414282, "body": "Also might want to look at the <a href=\"https://github.com/alexreisner/geocoder#geospatial-database-queries\" rel=\"nofollow noreferrer\">&quot;Geospatial Database Queries&quot;</a> section for the README. Seems like you could just add <code>near([location.latitude,location.longitude], 200, units: :km)</code> in place of the <code>select</code>. Another note <code>joins(:user)</code> or <code>includes(:user).references(:user)</code> will get rid of the first where by using an inner join"}], "answers": [{"tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 3, "last_activity_date": 1541990122, "creation_date": 1541990122, "answer_id": 53255311, "question_id": 53254668, "link": "https://stackoverflow.com/questions/53254668/how-to-make-the-select-query-comparatively-faster-in-rails/53255311#53255311", "title": "How to make the select query comparatively faster in rails?", "body": "<ol>\n<li><p>Move <code>vehicle.longitude.present?</code> to database level:</p>\n\n<pre><code>.where.not(longitude: [nil, ''])\n</code></pre></li>\n<li><p>Your distance calculation has to be moved to be on database level. Loading all records and calculating distance for each of them in Ruby will be too slow. Simplest solution is to add PostGIS:</p>\n\n<ol>\n<li>Add <a href=\"https://postgis.net/\" rel=\"nofollow noreferrer\">PostGIS</a> extension to your database.</li>\n<li>(Optional) add  an <a href=\"https://github.com/rgeo/activerecord-postgis-adapter\" rel=\"nofollow noreferrer\">adapter</a> that will make it easier to work with the data.</li>\n<li>Migrate your existing latitudes/longitudes to <code>st_point</code>.</li>\n<li>Change your select to a scope which will leverage the <a href=\"https://postgis.net/docs/ST_Distance.html\" rel=\"nofollow noreferrer\">ST_Distance</a> function.</li>\n</ol></li>\n<li><p>As an alternative to 2), you may consider moving your distance querying to a search engine like ElasticSearch. I'd only consider that if you will have any performance problems with the complex query you're creating.</p></li>\n</ol>\n"}], "owner": {"reputation": 335, "user_id": 7397660, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/41bca4edee3203ddfa4ed21b501e1bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Code father", "link": "https://stackoverflow.com/users/7397660/code-father"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 53255311, "answer_count": 1, "score": 1, "last_activity_date": 1541990122, "creation_date": 1541983086, "last_edit_date": 1541983843, "question_id": 53254668, "link": "https://stackoverflow.com/questions/53254668/how-to-make-the-select-query-comparatively-faster-in-rails", "title": "How to make the select query comparatively faster in rails?", "body": "<p>I was looking for best approach to get this query faster in rails. Currently it takes lots of time due to Geocoder calculations.</p>\n\n<pre><code>Vehicle.includes(:user)\n       .where.not('users.id' =&gt; nil)\n       .where(country: 'United Kingdom')\n       .where.not(name: [nil, ''])\n       .select { |vehicle| \n         vehicle.longitude.present? &amp;&amp;\n         Geocoder::Calculations.distance_between(\n           [vehicle.latitude,vehicle.longitude], \n           [location.latitude,location.longitude]\n         ).between?(0, 200)\n       }\n</code></pre>\n\n<p>Note: Currently the db used is PostgreSQL 9.5.14. </p>\n"}, {"tags": ["ruby", "algorithm", "math", "indexing"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 4, "creation_date": 1541975000, "post_id": 53253757, "comment_id": 93392226, "body": "Hint: What is <code>[2,2,3].index(2)</code>? And you need to learn how to use a debugger to step through your code and watch what it is doing."}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1541975377, "post_id": 53253757, "comment_id": 93392311, "body": "Use the index for the combination"}, {"owner": {"reputation": 83, "user_id": 10387815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d983763c0d811879e296fc0830ada974?s=128&d=identicon&r=PG&f=1", "display_name": "Krzynek", "link": "https://stackoverflow.com/users/10387815/krzynek"}, "edited": false, "score": 0, "creation_date": 1541976911, "post_id": 53253757, "comment_id": 93392672, "body": "Thanks guys. &#39;you need to learn how to use a debugger to step through your code and watch what it is doing&#39; - noted"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 1, "creation_date": 1542017303, "post_id": 53253757, "comment_id": 93404074, "body": "@Krzynek : Since the question is already answered and accepted and tagged with the algorithm, you would have already moved on to the next problem, and that&#39;s fine. But looking at your 3 tests, <code>numbers</code> seems a sorted list. Which means you can reduce the time-complexity of your code if you look just close enough with a different approach. Maybe do that exercise when you get some time. :)"}], "answers": [{"comments": [{"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1541975671, "post_id": 53253887, "comment_id": 93392379, "body": "What a nice place not to use an exclusive range :)"}, {"owner": {"reputation": 83, "user_id": 10387815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d983763c0d811879e296fc0830ada974?s=128&d=identicon&r=PG&f=1", "display_name": "Krzynek", "link": "https://stackoverflow.com/users/10387815/krzynek"}, "edited": false, "score": 0, "creation_date": 1541976700, "post_id": 53253887, "comment_id": 93392632, "body": "Magic! Now is time to go back to ruby-docs to make sure I completely understand this bit &quot; [*0..numbers.size-1] &quot;"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1541979135, "post_id": 53253887, "comment_id": 93393113, "body": "<code>[*0..numbers.size-1]</code> can alternatively be written <code>(0..numbers.size-1).to_a</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1542074161, "post_id": 53253887, "comment_id": 93428471, "body": "Krzynek, I modified my answer."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 6, "last_activity_date": 1542128429, "last_edit_date": 1542128429, "creation_date": 1541975319, "answer_id": 53253887, "question_id": 53253757, "link": "https://stackoverflow.com/questions/53253757/ruby-how-to-return-index-of-a-pair/53253887#53253887", "title": "Ruby how to return index of a pair", "body": "<pre><code>def two_sum(numbers, target)\n  [*0..numbers.size-1].combination(2).find { |i,j| numbers[i] + numbers[j] == target }\nend\n\ntwo_sum([1234, 5678, 9012], 14690)\n  #=&gt; [1, 2]\ntwo_sum([1234, 5678, 9012], 14691)\n  #=&gt; nil\n</code></pre>\n\n<p>Here is a more efficient method that may prove useful when the arrays are large.</p>\n\n<pre><code>require 'set'\n\ndef two_sum(arr, target)\n  if target.even?\n    half = target/2\n    first = arr.index(half)\n    if first\n      last = arr.rindex(half)\n      return [first, last] unless last.nil? || first == last\n    end\n  end\n  a1, a2 = arr.uniq.partition { |n| n &lt;= target/2 }\n  s = a2.to_set\n  n = a1.find { |n| s.include?(target-n) }\n  n.nil? ? nil : [arr.index(n), arr.index(target-n)]\nend\n</code></pre>\n\n<p>If <code>target</code> is even I first check to see if one-half of it appears at least twice in <code>arr</code>. If so, we are finished (except for determining and returning the associated indices). Even if the method does not terminate after this step it is required this step does not result in an early termination it is required before the next steps are performed.</p>\n\n<p>If <code>target</code> is odd or is even but one-half of it appears less than twice in <code>arr</code> I construct a temporary array that contains unique values in <code>arr</code> and then partition that into two arrays, <code>a1</code>, containing values no greater than <code>target/2</code> and <code>a2</code>, containing values greater than <code>target/2</code>. It follows that if two numbers sum to <code>target</code> one must be in <code>a1</code> and the other must be in <code>a2</code>.</p>\n\n<p>To speed calculations I then convert <code>a2</code> to a set <code>s</code>, and then loop through <code>a1</code> looking for a value <code>n</code> such that <code>s</code> contains <code>target-n</code>. Let's try it.</p>\n\n<pre><code>arr = 100_000.times.map { rand(1_000_000) }\n\nputs \"target      i1  arr[i1]     i2  arr[i2]  calc time (secs)\"\nputs \"---------------------------------------------------------\"\n\n1000.times do\n  t = Time.now\n  target = rand(1_000_000)\n  i1, i2 = two_sum(arr, target)\n  print \"#{target} -&gt; \"\n  print i1.nil? ? \"nil                        \" :\n    \"#{i1}  #{arr[i1]}   #{i2}  #{arr[i2]}\"\n  puts \"      #{(Time.now-t).round(4)} secs\"\nend\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>target      i1  arr[i1]     i2  arr[i2]  calc time (secs)\n---------------------------------------------------------\n215113 -&gt;   41   90943   11198  124170      0.027\n344479 -&gt;    0   78758   63570  265721      0.0237\n188352 -&gt;  190   79209   39912  109143      0.0275\n   457 -&gt;  nil                              0.0255\n923135 -&gt;   78   84600   43928  838535      0.0207\n 59391 -&gt;    2    5779    5454   53612      0.0289\n259142 -&gt;   73   58864   29278  200278      0.0284\n364486 -&gt; 8049  182243   89704  182243      0.001\n895164 -&gt;   13  205843    7705  689321      0.0228\n880575 -&gt;   20  440073    6195  440502      0.021\n</code></pre>\n\n<p>We see that <code>arr</code> does not contain two numbers that sum to <code>457</code>. Also, notice the very short time in the antepenultimate row. That's because one-helf of <code>target</code> (<code>364486/2 #=&gt; 182243</code>) appears at least twice in <code>arr</code>.</p>\n"}], "owner": {"reputation": 83, "user_id": 10387815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d983763c0d811879e296fc0830ada974?s=128&d=identicon&r=PG&f=1", "display_name": "Krzynek", "link": "https://stackoverflow.com/users/10387815/krzynek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "accepted_answer_id": 53253887, "answer_count": 1, "score": 0, "last_activity_date": 1542128429, "creation_date": 1541974322, "last_edit_date": 1541974422, "question_id": 53253757, "link": "https://stackoverflow.com/questions/53253757/ruby-how-to-return-index-of-a-pair", "title": "Ruby how to return index of a pair", "body": "<p>Today I got a task with given array and 'target' which is a sum of 2 integers within that list. After some time I came out with draft solution but it does not seem to be passing all of the tests. Algorithm seems to be considering integer at [0] twice.</p>\n\n<pre><code>def two_sum(numbers, target)\n\nnumbers.combination 2 do |a, b|\n if a + b == target\n  return numbers.index(a), numbers.index(b)\n  end\n end\nend\n\nprint two_sum([1, 2, 3], 4) # Expected [0, 2] *OK\n\nprint two_sum([1234, 5678, 9012], 14690) # Expected [1, 2] *OK\n\nprint two_sum([2, 2, 3], 4) # Expected [0, 1]) but I get [0, 0] \n</code></pre>\n\n<p>I have tried to use .map first instead of .combination(2) method but with the exact same result :-/</p>\n"}, {"tags": ["arrays", "ruby", "hash", "iteration"], "answers": [{"tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": false, "score": 1, "last_activity_date": 1541966763, "last_edit_date": 1541966763, "creation_date": 1541964194, "answer_id": 53252330, "question_id": 53252238, "link": "https://stackoverflow.com/questions/53252238/ruby-iterating-over-an-array-and-find-match-in-an-hash-and-replace-the-element-i/53252330#53252330", "title": "Ruby Iterating over an array and find match in an hash and replace the element in array", "body": "<p>Using <a href=\"https://ruby-doc.org/core-2.5.3/Hash.html#method-i-key\" rel=\"nofollow noreferrer\">Hash#key</a> without replacing the array, rather creating a new one (use <code>map!</code> for replacement):</p>\n\n<pre><code>array = [1,2,3,4,5]    \nhash = {a: 4, b: 7, c: 3}\n\narray.map { |el| hash.key(el) }\n# =&gt; [nil, nil, :c, :a, nil]\n</code></pre>\n\n<p>You may want to think about using <a href=\"https://ruby-doc.org/core-2.5.3/Hash.html#method-i-invert\" rel=\"nofollow noreferrer\">Hash#invert</a> and simply referencing the elements by keys for performance reasons as <code>Hash#key</code> is <code>O(n)</code> while <code>Hash#[]</code> is <code>O(1)</code>.</p>\n\n<pre><code>array = [1,2,3,4,5]\nhash = {a: 4, b: 7, c: 3}\ninverted_hash = hash.invert\n\narray.map { |el| inverted_hash[el] }\n# =&gt; [nil, nil, :c, :a, nil]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 1630875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/YxXAS.jpg?s=128&g=1", "display_name": "awsmsce", "link": "https://stackoverflow.com/users/1630875/awsmsce"}, "is_accepted": false, "score": 0, "last_activity_date": 1541964963, "creation_date": 1541964963, "answer_id": 53252447, "question_id": 53252238, "link": "https://stackoverflow.com/questions/53252238/ruby-iterating-over-an-array-and-find-match-in-an-hash-and-replace-the-element-i/53252447#53252447", "title": "Ruby Iterating over an array and find match in an hash and replace the element in array", "body": "<p>assuming: <code>arr = 'a b c d'</code>, which is not an arr, so please make that morse_string</p>\n\n<pre><code>def morse_code(morse_string)\n  new_elements = []\n\n  # iterate over each character in the string, \n  morse_string.split(\" \").each do |element| \n    if morse_dict[element]\n      # https://apidock.com/ruby/Array/push\n      new_elements.push( morse_dict[element] )\n    else\n      # whatever you want to do when there is no match\n    end\n  end\n  # re-create the string again, but with braille \n  # https://apidock.com/ruby/Array/join\n  new_elements.join(' ')\nend\n\nmorse_string = 'a b c d'\nmorse_code(morse_string)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 10495521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OI3Mn.jpg?s=128&g=1", "display_name": "Floroz", "link": "https://stackoverflow.com/users/10495521/floroz"}, "edited": false, "score": 0, "creation_date": 1542022582, "post_id": 53253786, "comment_id": 93406897, "body": "Manipulate the string directly works, however I receive this error <code>rb:60:in block in describe: Expected: &quot;SOS&quot;, instead got: nil (Test::Error)</code> I have added SOS to the dictionary and paired with &#39;...---...&quot; but it still returns <code>nil</code>"}, {"owner": {"reputation": 65, "user_id": 10495521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OI3Mn.jpg?s=128&g=1", "display_name": "Floroz", "link": "https://stackoverflow.com/users/10495521/floroz"}, "edited": false, "score": 0, "creation_date": 1542022990, "post_id": 53253786, "comment_id": 93407102, "body": "What is not clear in &quot;dividing into an array&quot; is: you <code>.split</code> your string <code>morse</code> into an array of single morse <code>word</code>, then iterate over the single <code>word</code>, then I don&#39;t understand exactly the next iteration when you <code>.join</code> the value of MORSE_TO_ALPHA."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 65, "user_id": 10495521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OI3Mn.jpg?s=128&g=1", "display_name": "Floroz", "link": "https://stackoverflow.com/users/10495521/floroz"}, "edited": false, "score": 0, "creation_date": 1542100764, "post_id": 53253786, "comment_id": 93437171, "body": "Floors, I apologize for not replying to your comments earlier. I somehow missed them. It\u2019s late now so I\u2019ll look into the problems you mention tomorrow."}, {"owner": {"reputation": 65, "user_id": 10495521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OI3Mn.jpg?s=128&g=1", "display_name": "Floroz", "link": "https://stackoverflow.com/users/10495521/floroz"}, "edited": false, "score": 0, "creation_date": 1542118325, "post_id": 53253786, "comment_id": 93447423, "body": "Thank you Cary, I have actually managed to get past the issue by inserting the &quot;SOS&quot; in the dictionary manually and added an if statement just to ensure I could pass the test, and incurred in another error using the different versions of your code as it does not encode back the punctuation (&quot;.,!?&quot;)."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 0, "last_activity_date": 1542256768, "last_edit_date": 1542256768, "creation_date": 1541974569, "answer_id": 53253786, "question_id": 53252238, "link": "https://stackoverflow.com/questions/53252238/ruby-iterating-over-an-array-and-find-match-in-an-hash-and-replace-the-element-i/53253786#53253786", "title": "Ruby Iterating over an array and find match in an hash and replace the element in array", "body": "<p>I understand from the kata that letters are to be separated by one space and words by three spaces.</p>\n\n<p>As a first step I will two changes to the hash <code>morse_dict</code>: remove the key <code>' '</code>; and add key-value pairs for some punctuation characters. The space character key is not needed; the need for punctuation codes is discussed in the kata.</p>\n\n<pre><code>PUNCTUATION = { \".\"=&gt;\".-.-.-\", \",\"=&gt;\"--..--\", \"?\"=&gt;\"..--..\", \"!\"=&gt;\"-.-.--\" }\n\nALPHA_TO_MORSE = dict.reject { |k,_| k == \" \" }.merge(PUNCTUATION)\n  #=&gt; {\"a\"=&gt;\".-\", \"b\"=&gt;\"-...\", \"c\"=&gt;\"-.-.\", \"d\"=&gt;\"-..\", \"e\"=&gt;\".\", \"f\"=&gt;\"..-.\",\n  #    \"g\"=&gt;\"--.\", \"h\"=&gt;\"....\", \"i\"=&gt;\"..\", \"j\"=&gt;\".---\", \"k\"=&gt;\"-.-\", \"l\"=&gt;\".-..\", \n  #    \"m\"=&gt;\"--\", \"n\"=&gt;\"-.\", \"o\"=&gt;\"---\", \"p\"=&gt;\".--.\", \"q\"=&gt;\"--.-\", \"r\"=&gt;\".-.\",\n  #    \"s\"=&gt;\"...\", \"t\"=&gt;\"-\", \"u\"=&gt;\"..-\", \"v\"=&gt;\"...-\", \"w\"=&gt;\".--\", \"x\"=&gt;\"-..-\",\n  #    \"y\"=&gt;\"-.--\", \"z\"=&gt;\"--..\", \"1\"=&gt;\".----\", \"2\"=&gt;\"..---\", \"3\"=&gt;\"...--\",\n  #    \"4\"=&gt;\"....-\", \"5\"=&gt;\".....\", \"6\"=&gt;\"-....\", \"7\"=&gt;\"--...\", \"8\"=&gt;\"---..\",\n  #    \"9\"=&gt;\"----.\", \"0\"=&gt;\"-----\", \".\"=&gt;\".-.-.-\", \",\"=&gt;\"--..--\", \"?\"=&gt;\"..--..\",\n  #    \"!\"=&gt;\"-.-.--\"}\n</code></pre>\n\n<p>I obtained the Morse codes for the punctuation characters from the <a href=\"https://en.wikipedia.org/wiki/Morse_code#Letters,_numbers,_punctuation,_prosigns_for_Morse_code_and_non-English_variants\" rel=\"nofollow noreferrer\">Morse Code Wiki</a>. Additional punctuation characters could be added if desired.</p>\n\n<p>The hash <code>ALPHA_TO_MORSE</code> is used in encoding text. The inverse of this hash is needed for decoding messages in Morse code. Also needed for decoding is the key value pair <code>\"...---...\"=&gt;\"sos\"</code>.</p>\n\n<pre><code>MORSE_TO_ALPHA = ALPHA_TO_MORSE.invert.merge(\"...---...\"=&gt;\"sos\")\n  #=&gt; {\".-\"=&gt;\"a\", \"-...\"=&gt;\"b\", \"-.-.\"=&gt;\"c\", \"-..\"=&gt;\"d\", \".\"=&gt;\"e\", \"..-.\"=&gt;\"f\",\n  #    \"--.\"=&gt;\"g\", \"....\"=&gt;\"h\", \"..\"=&gt;\"i\", \".---\"=&gt;\"j\", \"-.-\"=&gt;\"k\", \".-..\"=&gt;\"l\",\n  #    \"--\"=&gt;\"m\", \"-.\"=&gt;\"n\", \"---\"=&gt;\"o\", \".--.\"=&gt;\"p\", \"--.-\"=&gt;\"q\", \".-.\"=&gt;\"r\",\n  #    \"...\"=&gt;\"s\", \"-\"=&gt;\"t\", \"..-\"=&gt;\"u\", \"...-\"=&gt;\"v\", \".--\"=&gt;\"w\", \"-..-\"=&gt;\"x\",\n  #    \"-.--\"=&gt;\"y\", \"--..\"=&gt;\"z\", \".----\"=&gt;\"1\", \"..---\"=&gt;\"2\", \"...--\"=&gt;\"3\",\n  #    \"....-\"=&gt;\"4\", \".....\"=&gt;\"5\", \"-....\"=&gt;\"6\", \"--...\"=&gt;\"7\", \"---..\"=&gt;\"8\",\n  #    \"----.\"=&gt;\"9\", \"-----\"=&gt;\"0\", \".-.-.-\"=&gt;\".\", \"--..--\"=&gt;\",\",\n  #    \"..--..\"=&gt;\"?\", \"-.-.--\"=&gt;\"!\"\"...---...\"=&gt;\"sos\"}\n</code></pre>\n\n<p>One more hash is needed to deal with cases where the message <code>\"sos\"</code> (or <code>\"SOS\"</code>--Morse code is case insensitive), or <code>\"sos\"</code> followed by a punctuation character (e.g., <code>\"sos!\"</code>) is to be encoded.<sup>1</sup> See the Wiki. </p>\n\n<pre><code>SOS_WITH_PUNCTUATION = PUNCTUATION.each_with_object({}) { |(k,v),h|\n  h[\"sos#{k}\"] = \"...---... #{v}\" }.merge('sos'=&gt;\"...---...\")\n  #=&gt; {\"sos.\"=&gt;\"...---... .-.-.-\", \"sos,\"=&gt;\"...---... --..--\",\n  #    \"sos?\"=&gt;\"...---... ..--..\", \"sos!\"=&gt;\"...---... -.-.--\", \"sos\"=&gt;\"...---...\"}\n</code></pre>\n\n<p>The encoding and decoding methods follow. <code>encode</code> checks to see if each word in the string is a key in the hash <code>SOS_WITH_PUNCTUATION</code>. If it is, the value of key is the Morse code for the word; else, the word is divided into letters and each letter is translated into Morse code.</p>\n\n<pre><code>def encode(str)\n  str.strip.downcase.split.map do |word|\n    if SOS_WITH_PUNCTUATION.key?(word)\n      SOS_WITH_PUNCTUATION[word]\n    else\n      word.each_char.map { |c| ALPHA_TO_MORSE[c] }.join(' ')\n    end\n  end.join ('   ')\nend\n\ndef decode(morse)\n  morse.strip.split(/ {3}/).map do |word|\n    word.split.map { |c| MORSE_TO_ALPHA[c] }.join\n  end.join(' ')\nend\n</code></pre>\n\n<p>We can now try out these two methods.</p>\n\n<pre><code>str = \"  Is now the time for   you, and 007, to send an SOS?\"\n</code></pre>\n\n<p></p>\n\n<pre><code>morse = encode str\n  #=&gt; \".. ...  -. --- .--  - .... .  - .. -- .  ..-. --- .-.  -.-- --- ..- --..--  .- -. -..  ----- ----- --... --..--  - ---  ... . -. -..  .- -.  ...---... ..--..\"\n</code></pre>\n\n<p></p>\n\n<pre><code>decode morse\n  #=&gt; \"is now the time for you, and 007, to send an sos?\"\n</code></pre>\n\n<p><sup>1 It would be simpler to have a pre-processing step that would convert, say, <code>\"sos.\"</code> to <code>\"sos .\"</code>, but when the resulting Morse code were decoded there would be a space between <code>\"sos\"</code> and <code>\".\"</code>. I suppose that cryptographers could deal with that, but I've chosen to avoid the insertion of the space.</sup></p>\n"}], "owner": {"reputation": 65, "user_id": 10495521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OI3Mn.jpg?s=128&g=1", "display_name": "Floroz", "link": "https://stackoverflow.com/users/10495521/floroz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 53253786, "answer_count": 3, "score": 1, "last_activity_date": 1542256768, "creation_date": 1541963571, "last_edit_date": 1542237051, "question_id": 53252238, "link": "https://stackoverflow.com/questions/53252238/ruby-iterating-over-an-array-and-find-match-in-an-hash-and-replace-the-element-i", "title": "Ruby Iterating over an array and find match in an hash and replace the element in array", "body": "<p>I would like someone to clarify how can I possibly iterating over an array, find an exact match in an hash[value], and replace the element in the array with the hash[key].</p>\n\n<p>As example, if I have a morse directory <code>morse_dict = {\n    \"a\" =&gt; \".-\",\"b\" =&gt; \"-...\",\"c\" =&gt; \"-.-.\",\"d\" =&gt; \"-..\",\"e\" =&gt; \".\",\"f\" =&gt; \"..-.\",\"g\" =&gt; \"--.\",\"h\" =&gt; \"....\",\"i\" =&gt; \"..\",\"j\" =&gt; \".---\",\"k\" =&gt; \"-.-\",\"l\" =&gt; \".-..\",\"m\" =&gt; \"--\",\"n\" =&gt; \"-.\",\"o\" =&gt; \"---\",\"p\" =&gt; \".--.\",\"q\" =&gt; \"--.-\",\"r\" =&gt; \".-.\",\"s\" =&gt; \"...\",\"t\" =&gt; \"-\",\"u\" =&gt; \"..-\",\"v\" =&gt; \"...-\",\"w\" =&gt; \".--\",\"x\" =&gt; \"-..-\",\"y\" =&gt; \"-.--\",\"z\" =&gt; \"--..\",\" \" =&gt; \" \",\"1\" =&gt; \".----\",\"2\" =&gt; \"..---\",\"3\" =&gt; \"...--\",\"4\" =&gt; \"....-\",\"5\" =&gt; \".....\",\"6\" =&gt; \"-....\",\"7\" =&gt; \"--...\",\"8\" =&gt; \"---..\",\"9\" =&gt; \"----.\",\"0\" =&gt; \"-----\"\n}</code></p>\n\n<p>and I want a method that for a given string in morse code returns a string in regular alphabet.\n<a href=\"https://www.codewars.com/kata/decode-the-morse-code/train/ruby\" rel=\"nofollow noreferrer\">This is the codewars kata</a>. </p>\n\n<p>I am not interested in the solution to the challenge itself, I would like to understand the principle of this.</p>\n\n<p>So far I have thought of proceeding this way:</p>\n\n<pre><code>def morse_code(arr)\n  arr.split(\" \").each {|element| \n  element.each_char {|char| \n(morse_dict.include?(char)) ? (print \"true\") : (print \"false\")}\n  }\nend\n</code></pre>\n\n<p>I only print false, which means that I am not actually looking for match into the hash.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1542435915, "post_id": 53251925, "comment_id": 93575808, "body": "If you want to know if the square of <i>every</i> element of a sorted <code>array1</code> equals the element of a sorted <code>array2</code> at the same index position, you could write <code>array1.sort.zip(array2.sort).all? { |n1,n2| n1*n1 == n2 }</code>."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "edited": false, "score": 0, "creation_date": 1541971936, "post_id": 53252049, "comment_id": 93391488, "body": "Many thanks, that&#39;s thorough and I&#39;ll look into enumerators. The program&#39;s working but I&#39;m getting &quot;in <code>comp&#39;: undefined method </code>sort&#39; for nil:NilClass (NoMethodError)&quot; now, any thoughts there?"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "edited": false, "score": 1, "creation_date": 1541972291, "post_id": 53252049, "comment_id": 93391581, "body": "It seems like you&#39;re passing <code>nil</code> instead of an actual array to your method."}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 1, "last_activity_date": 1541963797, "last_edit_date": 1541963797, "creation_date": 1541962378, "answer_id": 53252049, "question_id": 53251925, "link": "https://stackoverflow.com/questions/53251925/ruby-undefined-method-nomethoderror-for-nilnilclass-works-until-looped/53252049#53252049", "title": "Ruby undefined Method/NoMethodError &#39;*&#39; for nil:NilClass, works until looped", "body": "<p>Your <code>i</code> equals <code>order1.length</code>, after your loop, so the last line of your method is basically</p>\n\n<pre><code>order1[order1.length] * order1[order1.length] == order2[order1.length]\n</code></pre>\n\n<p>which is (assuming your arrays are the same length):</p>\n\n<pre><code>nil * nil == nil\n</code></pre>\n\n<p>which throws an error. Not sure why you need the last line, if you remove it and simply return a counter, your method works as expected if you use a dedicated counter, for the elements which match your condition, instead of using index for that (your index has to be incremented always):</p>\n\n<pre><code>def comp(array1, array2)\n  order1 = array1.sort\n  order2 = array2.sort\n\n  i = 0\n  counter = 0\n\n  while i &lt; order1.length\n    if order1[i] * order1[i] == order2[i]\n      counter += 1\n    end\n\n    i += 1\n  end\n\n  counter\nend\n</code></pre>\n\n<p>In Ruby it is pretty common to use proper enumerators for iterating over collections, so your <code>while</code> can be nicely substituted by <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-each_with_index\" rel=\"nofollow noreferrer\">Enumerable#each_with_index</a>:</p>\n\n<pre><code>def comp(array1, array2)\n  order1 = array1.sort\n  order2 = array2.sort\n\n  counter = 0\n\n  order1.each_with_index do |el, i|\n    if el * el == order2[i]\n      counter += 1\n    end\n  end\n\n  counter\nend\n</code></pre>\n\n<p>And as the last step, we can also <a href=\"https://ruby-doc.org/core-2.5.3/Array.html#method-i-count\" rel=\"nofollow noreferrer\">Array#count</a> how many elements in an array meet a certain condition without needing to specify a local variable, like so:</p>\n\n<pre><code>def comp(array1, array2)\n  order2 = array2.sort\n  array1.sort.each_with_index.count { |el, i| el ** 2 == order2[i] }\nend\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53252049, "answer_count": 1, "score": 1, "last_activity_date": 1541963797, "creation_date": 1541961471, "question_id": 53251925, "link": "https://stackoverflow.com/questions/53251925/ruby-undefined-method-nomethoderror-for-nilnilclass-works-until-looped", "title": "Ruby undefined Method/NoMethodError &#39;*&#39; for nil:NilClass, works until looped", "body": "<p>My program orders arrays 1 and 2, and iterates to check whether each element in 1 is the sqrt of each element in 2. I've tested the comparison without the loop and it works fine, so I don't <em>think</em> that there's an uninitialised variable.</p>\n\n<pre><code>def comp(array1, array2)\n  order1 = array1.sort\n  order2 = array2.sort\n\n  i = 0\n\n  while i &lt; order1.length\n    if order1[i] * order1[i] == order2[i]\n      i += 1\n    else\n      false\n    end\n  end\n\n  order1[i] * order1[i] == order2[i]\n\nend\n</code></pre>\n\n<p>Can you point me in the direction of the issue? I've also not used Math.sqrt because it times out on my interface.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "url", "ruby-on-rails-5", "actioncontroller"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1541968428, "post_id": 53251906, "comment_id": 93390577, "body": "I&#39;m not sure why you use permit on the params hash (it&#39;s intented to be used on ActiveRecord models to set attributes). why not just: <code>test_test_action_two_path(arg_1: params[:arg_1], arg_2: &#39;value-2&#39;}</code>?"}, {"owner": {"reputation": 564, "user_id": 1063998, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c63266bcec44bdb115df81ddfc67fca?s=128&d=identicon&r=PG", "display_name": "user1063998", "link": "https://stackoverflow.com/users/1063998/user1063998"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1541979510, "post_id": 53251906, "comment_id": 93393191, "body": "In Rails 5 you can get this error <code>Attempting to generate a URL from non-sanitized request parameters! An attacker can inject malicious data into the generated URL, such as changing the host. Whitelist and sanitize passed parameters to be secure.</code>"}, {"owner": {"reputation": 564, "user_id": 1063998, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c63266bcec44bdb115df81ddfc67fca?s=128&d=identicon&r=PG", "display_name": "user1063998", "link": "https://stackoverflow.com/users/1063998/user1063998"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1541979940, "post_id": 53251906, "comment_id": 93393295, "body": "If I&#39;m passing in multiple parameters, I&#39;d rather just do a <code>params.slice(x,y,z)</code> which throws the above error"}], "answers": [{"comments": [{"owner": {"reputation": 564, "user_id": 1063998, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c63266bcec44bdb115df81ddfc67fca?s=128&d=identicon&r=PG", "display_name": "user1063998", "link": "https://stackoverflow.com/users/1063998/user1063998"}, "edited": false, "score": 0, "creation_date": 1541979574, "post_id": 53253734, "comment_id": 93393205, "body": "But passing a params hash to a router url_helper <i>does</i> work. It&#39;s only when you perform a merge, that it stops working. Regardless of whether or not HashWithIndifferentAccess stores keys as a <code>String</code> internally, you can still access the values with a symbol or a string."}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "reply_to_user": {"reputation": 564, "user_id": 1063998, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c63266bcec44bdb115df81ddfc67fca?s=128&d=identicon&r=PG", "display_name": "user1063998", "link": "https://stackoverflow.com/users/1063998/user1063998"}, "edited": false, "score": 0, "creation_date": 1541981212, "post_id": 53253734, "comment_id": 93393539, "body": "Yes, when you access them individually, you can access them with symbols."}, {"owner": {"reputation": 564, "user_id": 1063998, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c63266bcec44bdb115df81ddfc67fca?s=128&d=identicon&r=PG", "display_name": "user1063998", "link": "https://stackoverflow.com/users/1063998/user1063998"}, "edited": false, "score": 0, "creation_date": 1542019491, "post_id": 53253734, "comment_id": 93405266, "body": "Do you have any idea how the url_helper accesses the values then? It would seem like a bug within <code>HashWithIndifferentAccess</code> as the name suggests it shouldn&#39;t matter how you try to access values."}], "tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": true, "score": 1, "last_activity_date": 1541974065, "creation_date": 1541974065, "answer_id": 53253734, "question_id": 53251906, "link": "https://stackoverflow.com/questions/53251906/url-helper-error-when-merging-in-required-parameter/53253734#53253734", "title": "url_helper error when merging in required parameter", "body": "<p><code>ActionController::Parameters</code> uses <code>HashWithIndifferentAccess</code> which stores keys as string instead of symbols. But routing URL helpers requires the arguments to be in symbol keys. So as it is mentioned in the error, <code>arg_2</code> needs to be in symbol key.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/41592312/why-does-rails-hashwithindifferentaccess-store-keys-as-strings-and-not-symbol\">Why does Rails&#39; `HashWithIndifferentAccess` store keys as strings and not symbols?</a></p>\n\n<p>Try creating a new normal Hash:</p>\n\n<pre><code>test_test_action_two_path({arg_1: \"value_1\", arg_2: \"value_2\"})\n</code></pre>\n"}], "owner": {"reputation": 564, "user_id": 1063998, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c63266bcec44bdb115df81ddfc67fca?s=128&d=identicon&r=PG", "display_name": "user1063998", "link": "https://stackoverflow.com/users/1063998/user1063998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 53253734, "answer_count": 1, "score": 1, "last_activity_date": 1541974065, "creation_date": 1541961387, "question_id": 53251906, "link": "https://stackoverflow.com/questions/53251906/url-helper-error-when-merging-in-required-parameter", "title": "url_helper error when merging in required parameter", "body": "<p>I am trying to merge a value to the params hash, and pass the resulting hash to a url helper. (Using Rails 5)</p>\n\n<p>For example. I have the following routes</p>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>get 'test-url/:arg_1' =&gt; 'test#test_action_1', :as =&gt; 'test_test_action_one'\nget 'test-url/:arg_1/:arg_2' =&gt; 'test#test_action_2', :as =&gt; 'test_test_action_two'\n</code></pre>\n\n<p>The user visits <code>/test-url/value-1</code>, and I want to generate a link in the view to <code>/test-url/value-1/value-2</code></p>\n\n<p><strong>in view file</strong></p>\n\n<pre><code>link_to test_test_action_two_url(params.permit(:arg_1).merge(arg_2: 'value-2'))\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>No route matches {:action=&gt;\"test_action_2\", :arg_1=&gt;\"value-1\", \"arg_1\"=&gt;\"value-1\", \"arg_2\"=&gt;\"value-2\", :controller=&gt;\"test\"} missing required keys: [:arg_2]\n</code></pre>\n\n<p>Under the hood the <code>ActionController::Parameters</code> object is maintaining an internal hash (with_indifferent_access). After the <code>merge</code>, the hash still has indifferent_access and you can access <code>arg_2</code> using a symbol or string.</p>\n\n<p>However, I'm not sure why the url generator is unable to find the <code>:arg_2</code> key...</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95, "user_id": 7668589, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Q1NYI.jpg?s=128&g=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/7668589/daniel-bailey"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1541954738, "post_id": 53250784, "comment_id": 93386631, "body": "Ok sorry, edited the original"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1541956754, "post_id": 53250784, "comment_id": 93387183, "body": "Aside from your actual question, this seems like a major misuse of inheritance. If class <code>A</code> inherits from class <code>B</code>, then it should make sense to say &quot;A is a type of B&quot;. In this case, is a Player a type of Wallet? No. Is a Casino a type of Player? No. I&#39;d advise rethinking your class architecture."}, {"owner": {"reputation": 95, "user_id": 7668589, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Q1NYI.jpg?s=128&g=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/7668589/daniel-bailey"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1541956825, "post_id": 53250784, "comment_id": 93387200, "body": "Yea so wallet inherits from player, and casino inherits from player, so I just called super from casino to instantiate each class. Which creates the wallet."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1541957587, "post_id": 53250784, "comment_id": 93387418, "body": "@DanielBailey &quot;which creates the wallet&quot; - again, not quite. &quot;casino = Casino.new&quot;. This <code>casino</code> is a casino and a player and a wallet, all three in the same single object. I agree with Tom Lord, this is a misuse of inheritance. There&#39;s no chance this is needed in your app"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7668589, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Q1NYI.jpg?s=128&g=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/7668589/daniel-bailey"}, "edited": false, "score": 0, "creation_date": 1541955041, "post_id": 53250954, "comment_id": 93386731, "body": "yea JS lingo I can&#39;t drop ha. Ok so I am creating an instance of the wallet inside of the player, and creating an instance of the casino inside of the player. How would I get access to those instance variables inside of casino?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95, "user_id": 7668589, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Q1NYI.jpg?s=128&g=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/7668589/daniel-bailey"}, "edited": false, "score": 0, "creation_date": 1541955132, "post_id": 53250954, "comment_id": 93386761, "body": "@DanielBailey: &quot;I am creating an instance of the wallet inside of the player&quot; - no you don&#39;t. In your hierarchy a casino IS a player, which is ALSO a wallet. Doesn&#39;t make any sense, right? :)"}, {"owner": {"reputation": 95, "user_id": 7668589, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Q1NYI.jpg?s=128&g=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/7668589/daniel-bailey"}, "edited": false, "score": 0, "creation_date": 1541955186, "post_id": 53250954, "comment_id": 93386776, "body": "yea I&#39;m so lost. Only a week in learning ruby, so struggling with how each class inherits what. Guess I need to do more reading"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95, "user_id": 7668589, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Q1NYI.jpg?s=128&g=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/7668589/daniel-bailey"}, "edited": false, "score": 1, "creation_date": 1541955206, "post_id": 53250954, "comment_id": 93386779, "body": "@DanielBailey: &quot;How would I get access to those instance variables inside of casino&quot; - call super in casino&#39;s initializer, this should set name/money."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95, "user_id": 7668589, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Q1NYI.jpg?s=128&g=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/7668589/daniel-bailey"}, "edited": false, "score": 1, "creation_date": 1541955247, "post_id": 53250954, "comment_id": 93386787, "body": "@DanielBailey: yeah, JS object model does that to people :) Look up a book called &quot;practical object-oriented design in ruby&quot; (AKA POODR). It&#39;s excellent. Might be overwhelming at first (at your skill level), but on a second or third read you&#39;ll get a level-up, guaranteed :)"}, {"owner": {"reputation": 95, "user_id": 7668589, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Q1NYI.jpg?s=128&g=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/7668589/daniel-bailey"}, "edited": false, "score": 0, "creation_date": 1541956309, "post_id": 53250954, "comment_id": 93387079, "body": "Ok I think I understand now. I removed the Player.new and Wallet.new that I had buried in my code. Then called super() on the casino class which inherited from player, which inherited from wallet. I now have access to all the wallet methods on casino. Sweet Thanks dude! Getting closer to what I want now"}, {"owner": {"reputation": 95, "user_id": 7668589, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Q1NYI.jpg?s=128&g=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/7668589/daniel-bailey"}, "edited": false, "score": 0, "creation_date": 1541957516, "post_id": 53250954, "comment_id": 93387398, "body": "I need some more help if you don&#39;t mind. Is there a direct message feature?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95, "user_id": 7668589, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Q1NYI.jpg?s=128&g=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/7668589/daniel-bailey"}, "edited": false, "score": 0, "creation_date": 1541957645, "post_id": 53250954, "comment_id": 93387435, "body": "@DanielBailey &quot;Is there a direct message feature?&quot; - nope, and on purpose. Buuut, you can hire me on codementor. :)"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1541954895, "creation_date": 1541954895, "answer_id": 53250954, "question_id": 53250784, "link": "https://stackoverflow.com/questions/53250784/how-to-access-variable-from-outside-class-in-another-file/53250954#53250954", "title": "How to access variable from outside class in another file", "body": "<p>Those are not global variables. They are called \"instance variables\" and to access them you need to create instances of your casinos and players. Looks like this.</p>\n\n<pre><code>player = Player.new\nplayer.money # =&gt; 0\nplayer.money += 10\nplayer.money # =&gt; 10\n</code></pre>\n\n<p>In your Casino class you don't call parent initializers (a simple oversight, I think), so it doesn't initialize <code>@name</code> and <code>@money</code>.</p>\n\n<p>And Roulette doesn't do anything at all to obtain a wallet. So it stays at default value nil.</p>\n"}], "owner": {"reputation": 95, "user_id": 7668589, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Q1NYI.jpg?s=128&g=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/7668589/daniel-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 53250954, "answer_count": 1, "score": 2, "last_activity_date": 1541954895, "creation_date": 1541953791, "last_edit_date": 1541954713, "question_id": 53250784, "link": "https://stackoverflow.com/questions/53250784/how-to-access-variable-from-outside-class-in-another-file", "title": "How to access variable from outside class in another file", "body": "<p>My file structure is as follows:</p>\n\n<pre><code>Main/\nGames/ \n   roulette.rb\ncasino.rb\nwallet.rb\nplayer.rb\n</code></pre>\n\n<p>I have a wallet class that holds a money value in the class like so.</p>\n\n<pre><code>class Wallet\n    attr_accessor :money\n    def initialize\n        @money = 0\n    end\nend\n</code></pre>\n\n<p>I then have a player class that inherits from the Wallet class</p>\n\n<pre><code>class Player &lt; Wallet\n\n    attr_accessor :name\n    def initialize\n        super()\n        @name = nil\n        get_user_info\n    end\n</code></pre>\n\n<p>I then have a Casino class that inherits from Player like so</p>\n\n<pre><code>class Casino &lt; Player\n    def initialize\n        binding.pry\n        puts @money, @name\n    end\n</code></pre>\n\n<p>I have also used <code>require_relative</code> to pull in both files thinking that would give me access to their global variables <code>@money, @name</code>. </p>\n\n<p>If I am inside the <code>roulette.rb</code> file here is my code I wrote just to see if it would have a value.</p>\n\n<pre><code>require_relative '../wallet.rb'\n\nclass Roulette\n    def initialize\n        puts @wallet\n    end\nend\n</code></pre>\n\n<p>How would I go about getting access to these variables in the casino class? Thanks for the help.</p>\n"}, {"tags": ["ruby", "winapi"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1541949015, "post_id": 53249586, "comment_id": 93384980, "body": "It returns a set of flags, encoded into a single 16-bit value. The documentation explains, what the individual flags are and where they are stored. What&#39;s the specific problem you have?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1541951686, "post_id": 53249586, "comment_id": 93385775, "body": "The canonical way to test if the last bit is set is to test <code>&lt;0</code>"}, {"owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1541952886, "post_id": 53249586, "comment_id": 93386086, "body": "@IInspectable The problem is what value is returned when a key is pressed? Does it return that key&#39;s hex value or another number? I&#39;ve edited my question accordingly."}, {"owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1541953015, "post_id": 53249586, "comment_id": 93386127, "body": "@DavidHeffernan If the last bit is set will it be one?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1541954142, "post_id": 53249586, "comment_id": 93386453, "body": "You are asking the wrong question. It returns different values, when the respective key is pressed, but it will always return values, where the most significant bit is set."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1541962486, "post_id": 53249586, "comment_id": 93388798, "body": "@Practical I don&#39;t understand that question. A bit can be 0 or 1. When bit is set the bit&#39;s value is 1. When the last bit is set the number must be negative. All negative numbers have the last bit set. Hence my comment."}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1542014851, "post_id": 53251637, "comment_id": 93402781, "body": "The less-than-zero check only works in case <code>1</code> a programming language provides support for integer values of a specific size, <code>2</code> all bits are used to represent the value in those types, and <code>3</code> the programming language uses two&#39;s complement to represent signed values. Ruby doesn&#39;t appear to be a programming language that provides support for all of the aforementioned."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 4, "last_activity_date": 1541965624, "last_edit_date": 1541965624, "creation_date": 1541959437, "answer_id": 53251637, "question_id": 53249586, "link": "https://stackoverflow.com/questions/53249586/what-is-getasynckeystates-return-value/53251637#53251637", "title": "What is GetAsyncKeyState&#39;s return value?", "body": "<p>The return value can be one of 4 possible values:</p>\n\n<ul>\n<li>0x0000</li>\n<li>0x0001</li>\n<li>0x8000</li>\n<li>0x8001</li>\n</ul>\n\n<p>Use <code>&amp; 0x8000</code> (or alternatively <code>&lt; 0</code> since <code>SHORT</code> is a signed type) to check if \"the most significant bit is set\" (which makes a signed type negative). </p>\n\n<p>Use <code>&amp; 0x0001</code> to check if \"the least significant bit is set\".</p>\n"}], "owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 53251637, "answer_count": 1, "score": 2, "last_activity_date": 1541965624, "creation_date": 1541945632, "last_edit_date": 1592644375, "question_id": 53249586, "link": "https://stackoverflow.com/questions/53249586/what-is-getasynckeystates-return-value", "title": "What is GetAsyncKeyState&#39;s return value?", "body": "<p>I trying to use <code>GetAsyncKeyState</code> in a project I'm working on. The only problem is I don't know what value it returns, and in turn how to check for it. According to the MSN <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-getasynckeystate\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n<blockquote>\n<p>Type: SHORT</p>\n<p>If the function succeeds, the return value specifies whether the key was pressed since the last call to <strong>GetAsyncKeyState</strong>, and whether the key is currently up or down. If the most significant bit is set, the key is down, and if the least significant bit is set, the key was pressed after the previous call to <strong>GetAsyncKeyState</strong>. However, you should not rely on this last behavior; for more information, see the Remarks.</p>\n</blockquote>\n<p>I know that type <code>SHORT</code> is a number, but I've seen a lot of different answers across StackOverflow, and the internet, but what is GetAsyncKeyState's return value when it evaluates to true, does it return 0 or 0x8001?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1541943146, "post_id": 53249218, "comment_id": 93383290, "body": "Creating a batch script that runs the command for them is the simple option. What OS are you/they on?"}, {"owner": {"reputation": 27, "user_id": 9696243, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brunhilde Line", "link": "https://stackoverflow.com/users/9696243/brunhilde-line"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1541943319, "post_id": 53249218, "comment_id": 93383351, "body": "I&#39;m on Windows 10 he should be on Windows 7"}, {"owner": {"reputation": 562, "user_id": 622944, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8UP6.jpg?s=128&g=1", "display_name": "Axe", "link": "https://stackoverflow.com/users/622944/axe"}, "edited": false, "score": 0, "creation_date": 1541943376, "post_id": 53249218, "comment_id": 93383366, "body": "Or you can use a &#39;packager&#39; like <a href=\"https://github.com/pmq20/ruby-packer\" rel=\"nofollow noreferrer\">ruby-packer</a>"}], "answers": [{"comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 27, "user_id": 9696243, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brunhilde Line", "link": "https://stackoverflow.com/users/9696243/brunhilde-line"}, "edited": false, "score": 0, "creation_date": 1541958563, "post_id": 53249336, "comment_id": 93387728, "body": "@BrunhildeLine One thing I&#39;ll note with using this approach though is that bat files are often used for malicious purposes since they can automate arbitrary commands. If the person you&#39;re sending this too doesn&#39;t necessarily trust you, or have the knowledge required to read what the bat is doing, they may be sketched out having to run a bat file. If they want a nice, ready to use executable, you might need to look at a Ruby-specific approach."}], "tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": true, "score": 3, "last_activity_date": 1541952669, "last_edit_date": 1541952669, "creation_date": 1541943743, "answer_id": 53249336, "question_id": 53249218, "link": "https://stackoverflow.com/questions/53249218/running-a-selfwritten-ruby-program-outside-of-an-ide/53249336#53249336", "title": "Running a selfwritten ruby program outside of an IDE", "body": "<p>The simple answer that should work for all versions of Windows is to just create a simple batch launcher.</p>\n\n<p>Create a <code>.bat</code> file. I usually just create a new <code>.txt</code> file via \"right click > new > text document\". Then rename it, highlight everything, including the extension, and rename it to something like <code>run.bat</code>. The <code>.bat</code> part is important. Once you rename it, the icon should change to gears. If you can't overwrite the extension, or Windows is still treating it as a text document, you'll need to either manually save it as a <code>bat</code>, or disable \"hide file extensions\" in the explorer settings so the extension can be changed. </p>\n\n<hr>\n\n<p>Edit the bat file, and put into it something like:</p>\n\n<pre><code>@echo off\n\nYOUR RUN COMMAND HERE THAT YOU WOULD NORMALLY TYPE MANUALLY\n\npause\n</code></pre>\n\n<p>Paste the command that you would normally run manually where the capital text is. The first line is so it doesn't repeat the commands back, and the <code>pause</code> is so if an error happens, the command prompt doesn't immediately close. This gives you a chance to read the error. </p>\n\n<hr>\n\n<p>Save it and close it. Now, if you double click on the bat file, your program should run. </p>\n"}, {"tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 3, "last_activity_date": 1541944680, "creation_date": 1541944680, "answer_id": 53249469, "question_id": 53249218, "link": "https://stackoverflow.com/questions/53249218/running-a-selfwritten-ruby-program-outside-of-an-ide/53249469#53249469", "title": "Running a selfwritten ruby program outside of an IDE", "body": "<p>Multiple ways</p>\n\n<ul>\n<li>if it's for occasional use and for one script only I would pack it\nto a Windows executable with <a href=\"https://github.com/larsch/ocra\" rel=\"nofollow noreferrer\">Ocra</a>, then you can double click\nthe .exe itself or a link to it</li>\n<li>same as above but use jRuby and create a .jar file, not for beginners though</li>\n<li>the easiest: if you configure Windows to start/run .rb files with your ruby.exe you can double click the .rb files itself and they\nwill execute, they will have the red Ruby stone icon</li>\n<li>if you run a .reg file to enable drap and drop on .rb files you can combine the previous technique to drop files on the script and\nthey will be the parameters to the script, see my answer <a href=\"https://stackoverflow.com/questions/8128863/how-to-get-long-filename-from-argv\">here</a> for the reg file</li>\n<li>my favorite: copy the .rb to your windows <code>\"C:\\Users\\your_user\\AppData\\Roaming\\Microsoft\\Windows\\SendTo\\\"</code>\nfolder, then you can right click file(s) or folder(s) and select\nsendto and select your script, the files or folder will again be the\nparameters for your script</li>\n<li>you can create a .bat or .cmd file that starts with the path to your ruby.exe and the script as parameter, use rubyw.exe if you\ndon't want output</li>\n</ul>\n"}], "owner": {"reputation": 27, "user_id": 9696243, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brunhilde Line", "link": "https://stackoverflow.com/users/9696243/brunhilde-line"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 53249336, "answer_count": 2, "score": 1, "last_activity_date": 1541952669, "creation_date": 1541943027, "question_id": 53249218, "link": "https://stackoverflow.com/questions/53249218/running-a-selfwritten-ruby-program-outside-of-an-ide", "title": "Running a selfwritten ruby program outside of an IDE", "body": "<p>I was wondering if it was possible to run a selfwritten ruby program just like any other program by double-clicking an icon of some sort.</p>\n\n<p>And if it's possible, how do I do it?</p>\n\n<p>I wrote a little program for a friend but I don't want him to have to use the command line to run it, because that's rather inconvenient (unless there is a way to just double-click and the command line opens the program itself..).</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "linux", "git", "github"], "comments": [{"owner": {"reputation": 140, "user_id": 5902387, "user_type": "registered", "profile_image": "https://graph.facebook.com/1128672170498929/picture?type=large", "display_name": "Marek Zavoronok", "link": "https://stackoverflow.com/users/5902387/marek-zavoronok"}, "edited": false, "score": 0, "creation_date": 1541941308, "post_id": 53248868, "comment_id": 93382858, "body": "you need upload your ssh public key to authorized_keys file in server and in github settings."}], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 1557592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d15pt.jpg?s=128&g=1", "display_name": "Karan Raj Baruah", "link": "https://stackoverflow.com/users/1557592/karan-raj-baruah"}, "is_accepted": false, "score": 0, "last_activity_date": 1541961214, "creation_date": 1541961214, "answer_id": 53251881, "question_id": 53248868, "link": "https://stackoverflow.com/questions/53248868/how-do-i-deploy-with-capistrano/53251881#53251881", "title": "How do i deploy with capistrano", "body": "<p>You need to put your Public key in the <a href=\"https://github.com/settings/keys\" rel=\"nofollow noreferrer\">Github Keys</a> page. Once you do so you can start using it.</p>\n"}], "owner": {"reputation": 7, "user_id": 10200467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c94b8d61f01e7dbe7ce4699d436a665?s=128&d=identicon&r=PG&f=1", "display_name": "Kristoffer", "link": "https://stackoverflow.com/users/10200467/kristoffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1541961214, "creation_date": 1541940249, "last_edit_date": 1541956724, "question_id": 53248868, "link": "https://stackoverflow.com/questions/53248868/how-do-i-deploy-with-capistrano", "title": "How do i deploy with capistrano", "body": "<p>When i'm trying to run <code>bundle exec cap production deploy</code> and loggin to my droplet, this error comes up. I followed this tutorial: <a href=\"https://gorails.com/deploy/ubuntu/18.04\" rel=\"nofollow noreferrer\">https://gorails.com/deploy/ubuntu/18.04</a> and have done everything in it, but it doesn't work.</p>\n\n<pre><code>00:00 git:wrapper\n  01 mkdir -p /tmp\n\u2714 01 deploy@167.99.85.170 0.147s\n  Uploading /tmp/git-ssh-membercopy-production-root.sh 100.0%\n  02 chmod 700 /tmp/git-ssh-membercopy-production-root.sh\n\u2714 02 deploy@167.99.85.170 0.141s\n00:00 git:check\n  01 git ls-remote git@github.com:Dekto/membercopy.git HEAD\n  01 git@github.com: Permission denied (publickey).\n  01 fatal: Could not read from remote repository.\n  01\n  01 Please make sure you have the correct access rights\n  01 and the repository exists.\n#&lt;Thread:0x00007fffedb4ef20@/root/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/sshkit-1.18.0/lib/sshkit/runners/parallel.rb:10 run&gt; terminated with exception (report_on_exception is true):\nTraceback (most recent call last):\n        1: from /root/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/sshkit-1.18.0/lib/sshkit/runners/parallel.rb:11:in `block (2 levels) in execute'\n/root/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/sshkit-1.18.0/lib/sshkit/runners/parallel.rb:15:in `rescue in block (2 levels) in execute': Exception while executing as deploy@167.99.85.170: git exit status: 128 (SSHKit::Runner::ExecuteError)\ngit stdout: Nothing written\ngit stderr: git@github.com: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\n(Backtrace restricted to imported tasks)\ncap aborted!\nSSHKit::Runner::ExecuteError: Exception while executing as deploy@167.99.85.170: git exit status: 128\ngit stdout: Nothing written\ngit stderr: git@github.com: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\n\n\nCaused by:\nSSHKit::Command::Failed: git exit status: 128\ngit stdout: Nothing written\ngit stderr: git@github.com: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\n\nTasks: TOP =&gt; deploy:check =&gt; git:check\n(See full trace by running task with --trace)\nThe deploy has failed with an error: Exception while executing as deploy@167.99.85.170: git exit status: 128\ngit stdout: Nothing written\ngit stderr: git@github.com: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\n\n\n** DEPLOY FAILED\n** Refer to log/capistrano.log for details. Here are the last 20 lines:\n\n\n DEBUG [fb6c095d] Command: [ -d $HOME/.rbenv/versions/2.5.3 ]\n\n DEBUG [d9437923] Finished in 12.154 seconds with exit status 0 (successful).\n\n DEBUG [ee4139eb] Running /usr/bin/env which passenger as deploy@167.99.85.170\n\n DEBUG [ee4139eb] Command: /usr/bin/env which passenger\n\n DEBUG [eaba4dfc] Finished in 0.147 seconds with exit status 1 (failed).\n\n  INFO [9eeb8f8c] Running /usr/bin/env mkdir -p /tmp as deploy@167.99.85.170\n\n DEBUG [9eeb8f8c] Command: ( export RBENV_ROOT=\"$HOME/.rbenv\" RBENV_VERSION=\"2.5.3\" ; /usr/bin/env mkdir -p /tmp )\n\n  INFO [892841a3] Finished in 0.147 seconds with exit status 0 (successful).\n\n DEBUG Uploading /tmp/git-ssh-membercopy-production-root.sh 0.0%\n\n  INFO Uploading /tmp/git-ssh-membercopy-production-root.sh 100.0%\n\n  INFO [916f98f1] Running /usr/bin/env chmod 700 /tmp/git-ssh-membercopy-production-root.sh as deploy@167.99.85.170\n\n DEBUG [916f98f1] Command: ( export RBENV_ROOT=\"$HOME/.rbenv\" RBENV_VERSION=\"2.5.3\" ; /usr/bin/env chmod 700 /tmp/git-ssh-membercopy-production-root.sh )\n\n  INFO [fc59e4ba] Finished in 0.141 seconds with exit status 0 (successful).\n\n  INFO [6d70b2b1] Running /usr/bin/env git ls-remote git@github.com:Dekto/membercopy.git HEAD as deploy@167.99.85.170\n\n DEBUG [6d70b2b1] Command: ( export RBENV_ROOT=\"$HOME/.rbenv\" RBENV_VERSION=\"2.5.3\" GIT_ASKPASS=\"/bin/echo\" GIT_SSH=\"/tmp/git-ssh-membercopy-production-root.sh\" ; /usr/bin/env git ls-remote git@github.com:Dekto/membercopy.git HEAD )\n\n DEBUG [a1aed7ca]       git@github.com: Permission denied (publickey).\n\n DEBUG [a1aed7ca]       fatal: Could not read from remote repository.\n\n\n\nPlease make sure you have the correct access rights\n\nand the repository exists.\n</code></pre>\n"}]