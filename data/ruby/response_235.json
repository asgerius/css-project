[{"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "omniauth-facebook", "ruby-2.5"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11686267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ed7432971e93968d6cf328f95edb0f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/11686267/martin"}, "edited": false, "score": 0, "creation_date": 1562805240, "post_id": 56980050, "comment_id": 100496193, "body": "Thanks! That was super helpful! Checking network connectivity I went through access rules in the firewall created to block attacks we received from other countries. Disabling a few solved the issue. So it seems that Facebook uses some of those networks. Thanks so much!"}], "tags": [], "owner": {"reputation": 112, "user_id": 4918592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2jhgW.jpg?s=128&g=1", "display_name": "Nick Seferos", "link": "https://stackoverflow.com/users/4918592/nick-seferos"}, "is_accepted": true, "score": 1, "last_activity_date": 1562803368, "creation_date": 1562803368, "answer_id": 56980050, "question_id": 56979802, "link": "https://stackoverflow.com/questions/56979802/execution-expired-error-with-facebook-login-using-omniauth-facebook/56980050#56980050", "title": "Execution expired error with facebook login, using omniauth-facebook", "body": "<p>From what it looks like is you are having a network issue where Faraday isn't set up to wait long enough for a response. All I can really tell from the trace is that somewhere along the trail to facebook and back you're encountering network issues. </p>\n\n<p>A couple of things I can think to check:</p>\n\n<ul>\n<li>If your site is running through HTTPS, ensure your certificate is working properly.\n\n<ul>\n<li>Check that your gemfile is set to require a specific version of <code>omniauth-facebook</code> that is compatible with your version of Rails and dependencies.</li>\n<li>Extend the timeout length for Faraday</li>\n<li>Use a retry gem like <a href=\"https://github.com/ooyala/retries\" rel=\"nofollow noreferrer\">https://github.com/ooyala/retries</a> to try and give the network enough time to respond before Faraday closes the connection.</li>\n</ul></li>\n</ul>\n\n<p>A few other people have commented on this issue in omniauth-facebook's github <a href=\"https://github.com/mkdynamic/omniauth-facebook/issues/283\" rel=\"nofollow noreferrer\">https://github.com/mkdynamic/omniauth-facebook/issues/283</a></p>\n"}], "owner": {"reputation": 13, "user_id": 11686267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ed7432971e93968d6cf328f95edb0f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/11686267/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 56980050, "answer_count": 1, "score": 1, "last_activity_date": 1562803368, "creation_date": 1562801151, "question_id": 56979802, "link": "https://stackoverflow.com/questions/56979802/execution-expired-error-with-facebook-login-using-omniauth-facebook", "title": "Execution expired error with facebook login, using omniauth-facebook", "body": "<p>Users are not able lo login from Facebook since July 3rd.\nI'm using omniauth-facebook. I tested login successfully from localhost (pointing to another FB test app). But in production the app shows this error:</p>\n\n<pre><code>Started GET \"/auth/facebook\" for 190.238.101.80 at 2019-07-10 17:53:51 -0500\nI, [2019-07-10T17:53:51.594796 #4707]  INFO -- omniauth: (facebook) Request phase initiated.\nStarted GET \"/auth/facebook/callback?code=AQAj5FOJuHu7UY656lbwZ4Sfcf_J_ZX9Z_t0wRT-LDfnPLU530zKj5CNGEK53yJ9maNj8O80fWgGmxCq4zWqBK7CPN-ovokGZVIvfY0KaqzNRXWOC20kH4KhkYOHjPyRh4tMYTIcHZ1a0BvHfbBLVolYECVtfD1OKJ2Xob07LCpS0SHNhYc6PA3rBAnb6GnkvOZI-8S7nwXIICdFoKu0BbHd-6L8_Dq-dPFTOpJDSWgmoJUBc65EyCnuw7NCI4IFP1UtxtOmB_QjuzRQV-voQs_SV6N97c2ICK_Qc-IqL_WBwqd54aEzdnW5UOsDV4Wo0jA&amp;state=cee86047aecb4d282b80d33bbd0469815a17d25566167d95\" for 190.238.101.80 at 2019-07-10 17:53:52 -0500\nI, [2019-07-10T17:53:52.082829 #4707]  INFO -- omniauth: (facebook) Callback phase initiated.\n\nFaraday::ConnectionFailed (execution expired):\n  /usr/lib/ruby/2.5.0/net/http.rb:937:in `initialize'\n  /usr/lib/ruby/2.5.0/net/http.rb:937:in `open'\n  /usr/lib/ruby/2.5.0/net/http.rb:937:in `block in connect'\n  /usr/lib/ruby/2.5.0/timeout.rb:103:in `timeout'\n  /usr/lib/ruby/2.5.0/net/http.rb:935:in `connect'\n  /usr/lib/ruby/2.5.0/net/http.rb:920:in `do_start'\n  /usr/lib/ruby/2.5.0/net/http.rb:909:in `start'\n  /usr/lib/ruby/2.5.0/net/http.rb:1458:in `request'\n  faraday (0.15.4) lib/faraday/adapter/net_http.rb:87:in `perform_request'\n  faraday (0.15.4) lib/faraday/adapter/net_http.rb:43:in `block in call'\n  faraday (0.15.4) lib/faraday/adapter/net_http.rb:92:in `with_net_http_connection'\n  faraday (0.15.4) lib/faraday/adapter/net_http.rb:38:in `call'\n  faraday (0.15.4) lib/faraday/request/url_encoded.rb:15:in `call'\n  faraday (0.15.4) lib/faraday/rack_builder.rb:143:in `build_response'\n  faraday (0.15.4) lib/faraday/connection.rb:387:in `run_request'\n  oauth2 (1.4.1) lib/oauth2/client.rb:99:in `request'\n  oauth2 (1.4.1) lib/oauth2/client.rb:146:in `get_token'\n  oauth2 (1.4.1) lib/oauth2/strategy/auth_code.rb:30:in `get_token'\n  omniauth-oauth2 (1.6.0) lib/omniauth/strategies/oauth2.rb:89:in `build_access_token'\n  omniauth-facebook (5.0.0) lib/omniauth/strategies/facebook.rb:110:in `build_access_token'\n  omniauth-oauth2 (1.6.0) lib/omniauth/strategies/oauth2.rb:73:in `callback_phase'\n  omniauth-facebook (5.0.0) lib/omniauth/strategies/facebook.rb:67:in `block in callback_phase'\n  omniauth-facebook (5.0.0) lib/omniauth/strategies/facebook.rb:131:in `with_authorization_code!'\n  omniauth-facebook (5.0.0) lib/omniauth/strategies/facebook.rb:66:in `callback_phase'\n  omniauth (1.9.0) lib/omniauth/strategy.rb:238:in `callback_call'\n  omniauth (1.9.0) lib/omniauth/strategy.rb:189:in `call!'\n  omniauth (1.9.0) lib/omniauth/strategy.rb:169:in `call'\n  omniauth (1.9.0) lib/omniauth/builder.rb:64:in `call'\n  rack (1.6.11) lib/rack/etag.rb:24:in `call'\n  rack (1.6.11) lib/rack/conditionalget.rb:25:in `call'\n  rack (1.6.11) lib/rack/head.rb:13:in `call'\n  actionpack (4.2.8) lib/action_dispatch/middleware/params_parser.rb:27:in `call'\n  actionpack (4.2.8) lib/action_dispatch/middleware/flash.rb:260:in `call'\n  rack (1.6.11) lib/rack/session/abstract/id.rb:225:in `context'\n  rack (1.6.11) lib/rack/session/abstract/id.rb:220:in `call'\n  actionpack (4.2.8) lib/action_dispatch/middleware/cookies.rb:560:in `call'\n  activerecord (4.2.8) lib/active_record/query_cache.rb:36:in `call'\n  activerecord (4.2.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:653:in `call'\n  actionpack (4.2.8) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'\n  activesupport (4.2.8) lib/active_support/callbacks.rb:88:in `__run_callbacks__'\n  activesupport (4.2.8) lib/active_support/callbacks.rb:778:in `_run_call_callbacks'\n  activesupport (4.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\n  actionpack (4.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\n  actionpack (4.2.8) lib/action_dispatch/middleware/remote_ip.rb:78:in `call'\n  actionpack (4.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'\n  actionpack (4.2.8) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'\n  railties (4.2.8) lib/rails/rack/logger.rb:38:in `call_app'\n  railties (4.2.8) lib/rails/rack/logger.rb:20:in `block in call'\n  activesupport (4.2.8) lib/active_support/tagged_logging.rb:68:in `block in tagged'\n  activesupport (4.2.8) lib/active_support/tagged_logging.rb:26:in `tagged'\n  activesupport (4.2.8) lib/active_support/tagged_logging.rb:68:in `tagged'\n  railties (4.2.8) lib/rails/rack/logger.rb:20:in `call'\n  actionpack (4.2.8) lib/action_dispatch/middleware/request_id.rb:21:in `call'\n  rack (1.6.11) lib/rack/methodoverride.rb:22:in `call'\n  rack (1.6.11) lib/rack/runtime.rb:18:in `call'\n  activesupport (4.2.8) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'\n  actionpack (4.2.8) lib/action_dispatch/middleware/static.rb:120:in `call'\n  rack (1.6.11) lib/rack/sendfile.rb:113:in `call'\n  actionpack (4.2.8) lib/action_dispatch/middleware/ssl.rb:24:in `call'\n  railties (4.2.8) lib/rails/engine.rb:518:in `call'\n  railties (4.2.8) lib/rails/application.rb:165:in `call'\n  rack (1.6.11) lib/rack/content_length.rb:15:in `call'\n  thin (1.7.2) lib/thin/connection.rb:86:in `block in pre_process'\n  thin (1.7.2) lib/thin/connection.rb:84:in `catch'\n  thin (1.7.2) lib/thin/connection.rb:84:in `pre_process'\n  thin (1.7.2) lib/thin/connection.rb:53:in `process'\n  thin (1.7.2) lib/thin/connection.rb:39:in `receive_data'\n  eventmachine (1.2.7) lib/eventmachine.rb:195:in `run_machine'\n  eventmachine (1.2.7) lib/eventmachine.rb:195:in `run'\n  thin (1.7.2) lib/thin/backends/base.rb:73:in `start'\n  thin (1.7.2) lib/thin/server.rb:162:in `start'\n  rack (1.6.11) lib/rack/handler/thin.rb:19:in `run'\n  rack (1.6.11) lib/rack/server.rb:287:in `start'\n  railties (4.2.8) lib/rails/commands/server.rb:80:in `start'\n  railties (4.2.8) lib/rails/commands/commands_tasks.rb:80:in `block in server'\n  railties (4.2.8) lib/rails/commands/commands_tasks.rb:75:in `tap'\n  railties (4.2.8) lib/rails/commands/commands_tasks.rb:75:in `server'\n  railties (4.2.8) lib/rails/commands/commands_tasks.rb:39:in `run_command!'\n  railties (4.2.8) lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\n  bin/rails:8:in `require'\n  bin/rails:8:in `&lt;main&gt;'\n</code></pre>\n\n<p>I tried creating a test app with Facebook using localhost and it works.\nI tried with another app in production with another domain and it works.\nIt does not work with this particular application in production. I messaged Facebook support, but they don't reply, and days have passed.</p>\n\n<p>I'm using RoR 4.2.8, with Bundler 1.17.3\nI tried with ruby-2.5.1 and ruby-2.3.3 just in case (same error)</p>\n\n<p>I tried with another Facebook app with identical settings, using another RoR v5 app with ruby-2.6 and it worked, so the FB app settings seem to be ok.</p>\n\n<p>I created another FB app, to try with the failing RoR v4.2.8 app, and it fails with the same \"Faraday::ConnectionFailed (execution expired):\" error.</p>\n\n<p>config/initializers/omniauth.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Rails.application.config.middleware.use OmniAuth::Builder do\n  provider :facebook, 'APP-ID', 'SECRET',\n    scope: 'email'\nend\n</code></pre>\n\n<p>Users should be able lo login using Facebook, but it fails with \"Faraday::ConnectionFailed (execution expired):\"</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "json", "ruby", "hash"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1562810283, "post_id": 56979634, "comment_id": 100497039, "body": "Please do not link to external sites that host your code. If you have code that is relevant to your question then you must include it directly in your question. I cannot visit pastebin from this location, making it impossible even to attempt to answer."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1562912006, "post_id": 56979634, "comment_id": 100535347, "body": "JSON is code &amp; is the only information related to your question that is required to answer it. Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">how do I ask a good question?</a> (&quot;<i>copy the code into the question itself</i>&quot;). Also read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">MCVE</a> -- is the only way to answer your question by including a 2102 line JSON snippet? Or can your question be answered just the same if you include just one or two elements from the array? Also read <a href=\"https://stackoverflow.com/editing-help\">Markdown help</a>; your code block will scroll."}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1562799800, "creation_date": 1562799800, "answer_id": 56979662, "question_id": 56979634, "link": "https://stackoverflow.com/questions/56979634/how-do-i-store-certain-values-in-a-json-hash-in-a-new-array/56979662#56979662", "title": "How do I store certain values in a JSON hash in a new array?", "body": "<p>If I got what you have and what you want: your routes receives a JSON array and you want to return a new JSON with just the fields \"address\" of the input array. I'd do something like</p>\n\n<pre><code>def your_action\n  render json: params[:your_json_array].map { |item| item[:address] }\nend\n</code></pre>\n\n<p>or if you want to be more explicit</p>\n\n<pre><code>def your_action\n  addresses = params[:your_json_array].map { |item| item[:address] }\n  render json: addresses\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11110606"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 56979662, "answer_count": 1, "score": -2, "last_activity_date": 1562799800, "creation_date": 1562799510, "question_id": 56979634, "link": "https://stackoverflow.com/questions/56979634/how-do-i-store-certain-values-in-a-json-hash-in-a-new-array", "title": "How do I store certain values in a JSON hash in a new array?", "body": "<p>In Ruby on Rails, I have managed to make an API request to receive a JSON response. I would like to iterate through the hash response and create a new array containing just the values of the <code>address</code> keys. </p>\n\n<p>No code is included in this post because only the JSON response itself is needed to answer my question (my code simply consists of my API request). Here is the JSON response: <a href=\"https://pastebin.com/qHFJKqbz\" rel=\"nofollow noreferrer\">pastebin</a></p>\n\n<p>In terms of what it should look like, it should be an array like so: [\"1577 rue des Achill\u00e9es\",\"1549 rue des Achill\u00e9es\", etc.].</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1562783552, "post_id": 56976603, "comment_id": 100489566, "body": "What&#39;s the expected output that would have? An array? or a hash without the useless key-value?"}, {"owner": {"reputation": 527, "user_id": 7858691, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ig5olmA66Rw/AAAAAAAAAAI/AAAAAAAAABk/qHdhKSRoxXs/photo.jpg?sz=128", "display_name": "Pedro Sturmer", "link": "https://stackoverflow.com/users/7858691/pedro-sturmer"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1562783571, "post_id": 56976603, "comment_id": 100489573, "body": "a hash without the useless key-value. @SebastianPalma"}, {"owner": {"reputation": 4509, "user_id": 2936491, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BIeeI.jpg?s=128&g=1", "display_name": "techdreams", "link": "https://stackoverflow.com/users/2936491/techdreams"}, "edited": false, "score": 0, "creation_date": 1562826503, "post_id": 56976603, "comment_id": 100500983, "body": "There is detailed answer for this, with different options to choose from, regarding  how to remove a key from hash and get the remaining hash. <a href=\"https://stackoverflow.com/questions/6227600/how-to-remove-a-key-from-hash-and-get-the-remaining-hash-in-ruby-rails/39231096#39231096\" title=\"how to remove a key from hash and get the remaining hash in ruby rails\">stackoverflow.com/questions/6227600/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 7, "last_activity_date": 1562783506, "creation_date": 1562783506, "answer_id": 56976683, "question_id": 56976603, "link": "https://stackoverflow.com/questions/56976603/how-to-collect-many-attributes-from-hash-in-ruby/56976683#56976683", "title": "How to collect many attributes from hash in ruby", "body": "<p>You can use Ruby's built in <a href=\"https://ruby-doc.org/core-2.6.1/Hash.html#method-i-slice\" rel=\"noreferrer\"><code>Hash#slice</code></a>:</p>\n\n<pre><code>hash = { name: \"Foo\", email: \"Bar\", useless: nil }\np hash.slice(:name, :email)\n# {:name=&gt;\"Foo\", :email=&gt;\"Bar\"}\n</code></pre>\n\n<p>If using Rails you can use <a href=\"https://api.rubyonrails.org/classes/Hash.html#method-i-except\" rel=\"noreferrer\"><code>Hash#except</code></a> which receives just the keys you want to omit:</p>\n\n<pre><code>p hash.except(:useless)\n# {:name=&gt;\"Foo\", :email=&gt;\"Bar\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 3, "last_activity_date": 1562784270, "creation_date": 1562784270, "answer_id": 56976868, "question_id": 56976603, "link": "https://stackoverflow.com/questions/56976603/how-to-collect-many-attributes-from-hash-in-ruby/56976868#56976868", "title": "How to collect many attributes from hash in ruby", "body": "<p>If useless keys are so for having <code>nil</code> values, you can also use <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-compact\" rel=\"nofollow noreferrer\">Hash#compact</a>:</p>\n\n<pre><code>h = { name: \"Foo\", email: \"Bar\", useless: nil }\nh.compact #=&gt; {:name=&gt;\"Foo\", :email=&gt;\"Bar\"}\n</code></pre>\n"}], "owner": {"reputation": 527, "user_id": 7858691, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ig5olmA66Rw/AAAAAAAAAAI/AAAAAAAAABk/qHdhKSRoxXs/photo.jpg?sz=128", "display_name": "Pedro Sturmer", "link": "https://stackoverflow.com/users/7858691/pedro-sturmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 56976683, "answer_count": 2, "score": 2, "last_activity_date": 1562784270, "creation_date": 1562783163, "last_edit_date": 1562783637, "question_id": 56976603, "link": "https://stackoverflow.com/questions/56976603/how-to-collect-many-attributes-from-hash-in-ruby", "title": "How to collect many attributes from hash in ruby", "body": "<p>I'm wondering if it's possible to collet many attributes from a hash.</p>\n\n<p>Currently using ruby 2.6.3</p>\n\n<p>Something like that</p>\n\n<pre><code>hash = { name: \"Foo\", email: \"Bar\", useless: nil }\nother_hash = hash[:name, :email]\n</code></pre>\n\n<p>The output should be another hash but without the useless key/value</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1562790680, "post_id": 56976347, "comment_id": 100492447, "body": "Are you thinking something like <a href=\"https://andyatkinson.com/blog/2014/06/23/sharing-rake-tasks-in-gems\" rel=\"nofollow noreferrer\">this</a>, <a href=\"http://blog.nrowegt.com/building-shareable-rake-tasks-gem/\" rel=\"nofollow noreferrer\">this</a>, or <a href=\"https://www.jvt.me/posts/2018/04/05/chef-gem-rake-tasks/\" rel=\"nofollow noreferrer\">this</a>? <a href=\"https://www.google.com/search?q=create+rake+task+in+gem\" rel=\"nofollow noreferrer\">This</a> might also be helpful."}, {"owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1562823535, "post_id": 56976347, "comment_id": 100499809, "body": "Also look at the builder pattern Vlad"}], "owner": {"reputation": 7359, "user_id": 996375, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f2130e50afa88022bd091e457d321a73?s=128&d=identicon&r=PG", "display_name": "Vlad", "link": "https://stackoverflow.com/users/996375/vlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562781996, "creation_date": 1562781996, "question_id": 56976347, "link": "https://stackoverflow.com/questions/56976347/inheritable-rake-task-as-a-ruby-gem-in-a-ruby-on-rails-application", "title": "Inheritable Rake task as a Ruby Gem, in a Ruby on Rails application", "body": "<p>Is it possible to write an inheritable Rake task as a Gem such that it works like a framework?</p>\n\n<p>For example, one could build all the logic inside this Rake task and expose some high level callback methods, and developers would implement this callback to run tasks.</p>\n\n<p>The important part here is I'm not asking how to call a rake task from my rails app, but how to write a rake task as a gem, so i could just install the gem in my rails app, and then perhaps I could implement a plain <code>.rb</code> file somewhere which gets called by the rake task to handle custom tasks (Instead of the app calling the rake task)</p>\n"}, {"tags": ["ruby", "firebase", "google-cloud-firestore"], "comments": [{"owner": {"reputation": 2423, "user_id": 8437740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/PsSye.png?s=128&g=1", "display_name": "Jithin", "link": "https://stackoverflow.com/users/8437740/jithin"}, "edited": false, "score": 0, "creation_date": 1562784066, "post_id": 56975766, "comment_id": 100489792, "body": "if there is no error in your code then this is not normal. And firebase stores data pretty quickly. Did you tries batch write?"}, {"owner": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "reply_to_user": {"reputation": 2423, "user_id": 8437740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/PsSye.png?s=128&g=1", "display_name": "Jithin", "link": "https://stackoverflow.com/users/8437740/jithin"}, "edited": false, "score": 1, "creation_date": 1562784591, "post_id": 56975766, "comment_id": 100490016, "body": "@KevinRED Batch writes are typically not substantially faster than sending the same as individual writes."}, {"owner": {"reputation": 2423, "user_id": 8437740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/PsSye.png?s=128&g=1", "display_name": "Jithin", "link": "https://stackoverflow.com/users/8437740/jithin"}, "edited": false, "score": 0, "creation_date": 1562784631, "post_id": 56975766, "comment_id": 100490034, "body": "is there any ref for that?"}, {"owner": {"reputation": 4765, "user_id": 3945408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0jXTc.jpg?s=128&g=1", "display_name": "Juan Lara", "link": "https://stackoverflow.com/users/3945408/juan-lara"}, "edited": false, "score": 1, "creation_date": 1562802658, "post_id": 56975766, "comment_id": 100495681, "body": "See the note at the bottom of this section: <a href=\"https://firebase.google.com/docs/firestore/manage-data/transactions#batched-writes\" rel=\"nofollow noreferrer\">firebase.google.com/docs/firestore/manage-data/&hellip;</a>. If you don&#39;t need atomicity, use parallelized individual writes."}], "owner": {"reputation": 331, "user_id": 4196199, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4bb5644459ae3c75ef171f51d362dd37?s=128&d=identicon&r=PG", "display_name": "Hernan Acosta", "link": "https://stackoverflow.com/users/4196199/hernan-acosta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562779525, "creation_date": 1562779525, "question_id": 56975766, "link": "https://stackoverflow.com/questions/56975766/writing-in-firestore-is-taking-too-much", "title": "Writing in Firestore is taking too much", "body": "<p>I'm building a notification system and I'm using Google Cloud Firestore to store the notifications messages. the Idea was to have an schema as following. A collection notifications with documents that represent the role of the \"user\" a nested collection with the Id's of that users and inside of the Id's document a collection with the notifications for that users ex: notification->customer->88 has a collection of messages for the customer 88, the messages Id's are random created by Firestore.</p>\n\n<p>In some case I'm sending the message to 800 users so I'm doing in bach by 500 (BATCH_LIMIT) that it's the limit to writes in firestore in a request. For that I'm using this code.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def self.save(entities, message)\n    entities.each_slice(BATCH_LIMIT) do |entities_chunk|\n      firestore.batch do |batch|\n        entities_chunk.each do |entity|\n          collection_reference = firestore.col(BASE_COLLECTION).doc(entity.account_type).col(entity.account_id).doc\n          batch.set(collection_reference, message)\n        end\n      end\n    end\n  end\n</code></pre>\n\n<p>This operation takes up to 180 second to complete (800 writes aprox) in Google Cloud Firestore. Is this normal ? This does not scale. There is another way to do it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562793516, "post_id": 56974995, "comment_id": 100493519, "body": "#2 and #3 are appropriate, but I find a #1 a bit bizarre. Presumably the array has been computed or has been given as an argument to a method (not a literal), so it must already be assigned to a variable. Upvoted, but I wouldn&#39;t be displeased if you ditched #1. :-)"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 3, "last_activity_date": 1562776530, "last_edit_date": 1562776530, "creation_date": 1562776128, "answer_id": 56974995, "question_id": 56974969, "link": "https://stackoverflow.com/questions/56974969/find-index-of-array-in-multidimensional-array-by-string-value/56974995#56974995", "title": "Find index of array in multidimensional array by string value", "body": "<p>That's returning <code>nil</code>, because there's no element <code>i</code> (index) in the array with value <code>#FFF600</code> (nor <code>FFF600</code>), you need to access to the <code>hex_value</code> key value:</p>\n\n<pre><code>p [\n  {:id=&gt;5, :name=&gt;\"Leaf Green\", :hex_value=&gt;\"047115\"},\n  {:id=&gt;15, :name=&gt;\"Lemon Yellow\", :hex_value=&gt;\"FFF600\"},\n  {:id=&gt;16, :name=&gt;\"Navy\", :hex_value=&gt;\"285974\"}\n].yield_self { |this| this.each_index.select { |index| this[index][:hex_value] == 'FFF600' } }\n# [1]\n</code></pre>\n\n<p>Giving you <code>[1]</code>, because of using <code>select</code>, if you want just the first occurrence, you can use <code>find</code> instead.</p>\n\n<p>I'm using <code>yield_self</code> there, to avoid assigning the array to a variable. Which is equivalent to:</p>\n\n<pre><code>array = [\n  {:id=&gt;5, :name=&gt;\"Leaf Green\", :hex_value=&gt;\"047115\"},\n  {:id=&gt;15, :name=&gt;\"Lemon Yellow\", :hex_value=&gt;\"FFF600\"},\n  {:id=&gt;16, :name=&gt;\"Navy\", :hex_value=&gt;\"285974\"}\n]\np array.each_index.select { |index| array[index][:hex_value] == 'FFF600' }\n# [1]\n</code></pre>\n\n<hr>\n\n<p>Being Ruby, you can use the method for that: <a href=\"https://ruby-doc.org/core-2.6.1/Enumerable.html#method-i-find_index\" rel=\"nofollow noreferrer\"><code>Enumerable#find_index</code></a></p>\n\n<pre><code>p [\n  {:id=&gt;5, :name=&gt;\"Leaf Green\", :hex_value=&gt;\"047115\"},\n  {:id=&gt;15, :name=&gt;\"Lemon Yellow\", :hex_value=&gt;\"FFF600\"},\n  {:id=&gt;16, :name=&gt;\"Navy\", :hex_value=&gt;\"285974\"}\n].find_index { |hash| hash[:hex_value] == 'FFF600' }\n# 1\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 8373073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0083749204d624fbd34abba4b208b929?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8373073/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 56974995, "answer_count": 1, "score": 1, "last_activity_date": 1562793021, "creation_date": 1562775977, "last_edit_date": 1562776734, "question_id": 56974969, "link": "https://stackoverflow.com/questions/56974969/find-index-of-array-in-multidimensional-array-by-string-value", "title": "Find index of array in multidimensional array by string value", "body": "<p>I need the index of an array in a multidimensional array if it contains a unique string.</p>\n\n<p>array:</p>\n\n<pre><code>[\n    {:id=&gt;5, :name=&gt;\"Leaf Green\", :hex_value=&gt;\"047115\"},\n    {:id=&gt;15, :name=&gt;\"Lemon Yellow\", :hex_value=&gt;\"FFF600\"},\n    {:id=&gt;16, :name=&gt;\"Navy\", :hex_value=&gt;\"285974\"}\n]\n</code></pre>\n\n<p>If hex_value of 'FFF600' exists, return the arrays position, which in this case would be 1.</p>\n\n<p>This is where I am at, but it's returning []. </p>\n\n<pre><code>index = array.each_index.select{|i| array[i] == '#FFF600'}\n</code></pre>\n"}, {"tags": ["ruby", "puppet", "facter"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1562776063, "post_id": 56974718, "comment_id": 100486175, "body": "&quot;<i>I&#39;m trying to get multiple structured custom facts to append to my root key (called rag here), but instead they always replace the current value.</i>&quot; -- it&#39;s unclear to me exactly what you&#39;re describing here.  If you want us to analyze code that is not behaving as you expect, then we need to see the code -- that is, a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> demonstrating the issue."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1562776175, "post_id": 56974718, "comment_id": 100486243, "body": "&quot;<i>I&#39;m breaking it in multiple files for better maintenance (each script outputs 1 key), but i feel like there should be a better way</i>&quot; -- this is really broad, and it seems pretty opinion-based.  &quot;Better&quot; in what sense?"}, {"owner": {"reputation": 5186, "user_id": 982924, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3eea6a04f8ca5824206dad8d7455a70d?s=128&d=identicon&r=PG", "display_name": "RASG", "link": "https://stackoverflow.com/users/982924/rasg"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1562777773, "post_id": 56974718, "comment_id": 100486985, "body": "@JohnBollinger &#39;better&#39; in a sense of not having to use a custom fact just to read the external facts values and append. if you replace the line that ouputs the json <code>puts JSON.pretty_generate(retorno)</code> with <code>Facter.add(:rag, :type =&gt; :aggregate)</code> and move the script to where <code>rag.rb</code> is, the key <code>rag.</code> will have only the value for the last executed file. let me know if its not clear yet, and i will edit the question."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1562778174, "post_id": 56974718, "comment_id": 100487154, "body": "Do you mean you make such a substitution and move for <i>each</i> external fact file?  Please, the details matter, and presenting the actual code that manifests the problem is much better than describing it."}, {"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1562864236, "post_id": 56974718, "comment_id": 100522365, "body": "Also, with the question as it is presented, I do not understand why external facts are involved at all."}, {"owner": {"reputation": 5186, "user_id": 982924, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3eea6a04f8ca5824206dad8d7455a70d?s=128&d=identicon&r=PG", "display_name": "RASG", "link": "https://stackoverflow.com/users/982924/rasg"}, "reply_to_user": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1562865030, "post_id": 56974718, "comment_id": 100522747, "body": "@MattSchuchard i will work on editing the question and making it more clear."}], "owner": {"reputation": 5186, "user_id": 982924, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3eea6a04f8ca5824206dad8d7455a70d?s=128&d=identicon&r=PG", "display_name": "RASG", "link": "https://stackoverflow.com/users/982924/rasg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1562777371, "creation_date": 1562774996, "last_edit_date": 1562777371, "question_id": 56974718, "link": "https://stackoverflow.com/questions/56974718/append-multiple-structured-custom-facts", "title": "append multiple structured custom facts", "body": "<p>I'm trying to get multiple structured <code>custom facts</code> to append to my root key (called <code>rag</code> here), but instead they always replace the current value.</p>\n\n<p><strong>Q1: Is this the expected behavior of Facter.add ?</strong></p>\n\n<p>So to get it to work i created two <code>external facts</code>, and on the <code>custom fact</code> i just read their results and append to the root with <code>type =&gt; :aggregate</code></p>\n\n<p>I do get the expected result, which is:</p>\n\n<p><em>:~# facter -p rag</em></p>\n\n<pre><code>{\n  role =&gt; \"win-mbox\",\n  ambiente =&gt; \"producao\",\n  enabled_services =&gt; [\n    \"auditd\",\n    \"lvm2-monitor\",\n    \"mdmonitor\",\n    \"rhsmcertd\",\n    \"rsyslog\",\n    \"sshd\",\n    \"syslog\",\n    \"sysstat\",\n  ]\n}\n</code></pre>\n\n<p>I'm breaking it in multiple files for better maintenance (each script outputs 1 key), but i feel like there should be a better way.</p>\n\n<p><strong>Q2: Is there a better way? I mean, not having to use a custom fact just to read the external facts values and append.</strong></p>\n\n<p>Below, details about the code:</p>\n\n<p><em>/opt/puppetlabs/puppet/cache/facts.d/rag_system_services.rb</em></p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'facter'\nrequire 'json'\n\nretorno   = Hash.new { |h,k| h[k] = Hash.new(&amp;h.default_proc) }\nos_family = Facter.value(:osfamily)\n\nif os_family == 'RedHat'\n    retorno[:rag_system_services] = `systemctl list-unit-files --no-legend --no-pager -t service --state=enabled`.scan(/(^.+?)\\.service\\s+enabled/i).flatten\nelse\n    retorno[:rag_system_services] = `rcconf --list | sort`.scan(/(^.+?)\\s+on/i).flatten\nend\n\nputs JSON.pretty_generate(retorno)\n</code></pre>\n\n<p><em>/opt/puppetlabs/puppet/cache/facts.d/rag_role.rb</em></p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'facter'\nrequire 'json'\n\nretorno = Hash.new { |h,k| h[k] = Hash.new(&amp;h.default_proc) }\nfqdn    = Facter.value(:fqdn)\n\nretorno[:rag_role] = if fqdn.start_with? 'win-'\n    case fqdn\n        when /-aio/    then 'win-aio'\n        when /-ldap/   then 'win-ldap'\n        when /-logger/ then 'win-logger'\n        when /-mbox/   then 'win-mbox'\n        when /-mta/    then 'win-mta'\n        when /-proxy/  then 'win-proxy'\n    end\nelsif fqdn.include? 'lnx-'\n    case fqdn\n        when /balancer/ then 'lnx-balancer'\n        when /database/ then 'lnx-database'\n        when /nfs/      then 'lnx-nfs'\n        when /server/   then 'lnx-server'\n    end\nelse\n    case fqdn\n        when /^dns-/         then 'dns'\n        when /^elastic-/     then 'elastic'\n        when /^pre-auth/     then 'pre-auth'\n        when /^puppetserver/ then 'puppetserver'\n    end\nend\n\nputs JSON.pretty_generate(retorno)\n</code></pre>\n\n<p><em>/opt/puppetlabs/puppet/cache/lib/facter/rag.rb</em></p>\n\n<pre><code>Facter.add(:rag, :type =&gt; :aggregate) do\n\n    chunk(:ambiente) do\n        rag = {}\n        rag['ambiente'] = (Facter.value(:fqdn).include? 'hom-') ? 'homologacao' : 'producao'\n        rag\n    end\n\n    chunk(:enabled_services) do\n        rag = {}\n        rag['enabled_services'] = Facter.value(:rag_system_services)\n        rag\n    end\n\n    chunk(:role) do\n        rag = {}\n        rag['role'] = Facter.value(:rag_role)\n        rag\n    end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "simple-form", "simple-form-for"], "answers": [{"comments": [{"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1562801188, "post_id": 56978432, "comment_id": 100495447, "body": "Its looks like the key in params is <code>entrega</code> not <code>client_number</code>. Maybe try to change this <code>@search[&quot;client_number&quot;]</code> - <code>@search[&quot;entrega&quot;]</code>"}, {"owner": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "reply_to_user": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1562854405, "post_id": 56978432, "comment_id": 100516999, "body": "Yes Lukas, this is the question. The question is because someone deleted their response where contained this and I replied correctly as above. Regards"}], "tags": [], "owner": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "is_accepted": false, "score": 0, "last_activity_date": 1562791732, "creation_date": 1562791732, "answer_id": 56978432, "question_id": 56974505, "link": "https://stackoverflow.com/questions/56974505/how-a-set-a-search-value-to-a-variable-in-a-controller/56978432#56978432", "title": "How a set a &quot;search&quot; value to a variable in a controller", "body": "<p>Based in an earlier response, I resolved the conflict, changing the Controller:</p>\n\n<pre><code>def index\n    @objectives = DeliveryObjective.all     \n\n    @search = params[\"search\"]    \n    if @search.present?            \n        @entrega = @search[\"client_number\"]                     \n        @objective = DeliveryObjective.where(client_number: @entrega)             \n    end        \nend\n\ndef show \n    @search = params[\"search\"]    \n    if @search.present?        \n        @entrega = @search[\"client_number\"]\n    @delivery_objective = DeliveryObjective.where(client_number: @entrega)\n   end             \nend \n</code></pre>\n\n<p>It's a little bit dirty, but can help someone.</p>\n"}], "owner": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562791732, "creation_date": 1562774172, "last_edit_date": 1562774382, "question_id": 56974505, "link": "https://stackoverflow.com/questions/56974505/how-a-set-a-search-value-to-a-variable-in-a-controller", "title": "How a set a &quot;search&quot; value to a variable in a controller", "body": "<p>I had a value that is inserted in a input at index and led me to a show page.</p>\n\n<p>But, when I insert and submit, I gain a Blank Page! However, if I type in the URL the path to the show item, it appears!</p>\n\n<p>Print from the input on client side:</p>\n\n<p><a href=\"https://imgur.com/a/ZSnacmM\" rel=\"nofollow noreferrer\">https://imgur.com/a/ZSnacmM</a></p>\n\n<p>I tried and get the following result with biding pry</p>\n\n<p><a href=\"https://imgur.com/a/d3H9VAi\" rel=\"nofollow noreferrer\">https://imgur.com/a/d3H9VAi</a></p>\n\n<p>The \"entrega\" really comes with the input that is the cient_number, but @entrega does'nt</p>\n\n<p>So, When goes to if, all the values are nil. I really don't understand</p>\n\n<p>I've tried the following code at Controller:</p>\n\n<pre><code>def sac_index\n        #binding.pry\n        @objectives = DeliveryObjective.all        \n        @search = params[\"search\"]    \n        if @search.present?            \n            @entrega = @search[\"client_number\"]                      \n            @objectives = DeliveryObjective.where(client_number: @entrega)             \n        end\n        #@search_uol = DeliveryObjective.where(client_number: params[:id])\n    end\n\n    def sac_show \n        #@delivery_objective = DeliveryObjective.where(client_number: @search)\n        @delivery_objective  = DeliveryObjective.where(client_number: params[:id])\n        binding.pry\n    end\n</code></pre>\n\n<p>When I input the client_number, I want to be rendered to the show page from the item.</p>\n"}, {"tags": ["html", "ruby", "watir"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1562796349, "post_id": 56974129, "comment_id": 100494351, "body": "<code>I&#39;m using watir-webdriver </code>  If so, I&#39;d certainly advise moving to the <code>watir</code> gem..."}], "answers": [{"comments": [{"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1562776653, "post_id": 56974552, "comment_id": 100486467, "body": "In general we recommend Watir users avoid XPath when possible since it is much more difficult to read. With the latest versions of Watir, there is no longer a performance hit for most nested element location."}, {"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "reply_to_user": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1562776948, "post_id": 56974552, "comment_id": 100486594, "body": "@titusfortner Thanks for your comment. In that case can OP use <code>li(text: &#39;Invoice&#39;, class: &#39;gridcontrolcolumn&#39;)</code>?"}, {"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "reply_to_user": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1562783745, "post_id": 56974552, "comment_id": 100489648, "body": "@titusfortner Just want to know, is it only the readability? or there anything to be noted"}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1563380321, "post_id": 56974552, "comment_id": 100683655, "body": "Readability and the fact that most people don&#39;t actually know how to write correct xpath, so it&#39;s often easiest to tell them not to do it at all. Watir provides locator methods for anything you might want to do in xpath."}], "tags": [], "owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "is_accepted": false, "score": 0, "last_activity_date": 1562774330, "creation_date": 1562774330, "answer_id": 56974552, "question_id": 56974129, "link": "https://stackoverflow.com/questions/56974129/identifying-a-html-element-for-selection-in-ruby-where-finders-all-match/56974552#56974552", "title": "Identifying a html element for selection in ruby where finders all match", "body": "<p>Replace the below line</p>\n\n<pre><code>.input(id: 'ctl00_MainContent_cboDefaultPaymentType_Input').li(class: '\"gridcontrolcolumn\" &gt;\n  Direct Debit &lt; /li&gt;').click\n</code></pre>\n\n<p>with this</p>\n\n<pre><code>.li(xpath: \"//ul[@class='rcbList']//li[@class='gridcontrolcolumn'][normalize-space(.)='Invoice']\").click\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11750927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/605d64f1da165d298d4887647a2e6f16?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Hardman", "link": "https://stackoverflow.com/users/11750927/jon-hardman"}, "edited": false, "score": 0, "creation_date": 1562832840, "post_id": 56975073, "comment_id": 100504118, "body": "Tried this method and its resolved my issue straight away. Thanks for your help"}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 0, "last_activity_date": 1562776468, "creation_date": 1562776468, "answer_id": 56975073, "question_id": 56974129, "link": "https://stackoverflow.com/questions/56974129/identifying-a-html-element-for-selection-in-ruby-where-finders-all-match/56975073#56975073", "title": "Identifying a html element for selection in ruby where finders all match", "body": "<p>There look to be a couple issues with locating the <code>li</code> using <code>.input(id: 'ctl00_MainContent_cboDefaultPaymentType_Input').li(class: '\"gridcontrolcolumn\" &gt;      Direct Debit &lt; /li&gt;').click</code>:</p>\n\n<ul>\n<li>The <code>li</code> isn't usually in the <code>input</code>.</li>\n<li>The <code>li</code> class is just \"gridcontrolcolumn\" - ie no quotations or other text.</li>\n</ul>\n\n<p>I would try the simplest:</p>\n\n<pre><code>frame = @browser.iframe(id: 'contentIFrame1').iframe(id: 'navLink{bd27b00e-3d5e-b7b5-0ddb-864216077292}AreaFrame')\nframe.li(text: 'Direct Debit').click\n</code></pre>\n\n<p>This will actually return the outer <code>li</code>, which should be sufficient. If you actually need the inner <code>li</code>, try:</p>\n\n<pre><code>frame.li(text: 'Direct Debit', class: 'gridcontrolcolumn').click\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "is_accepted": false, "score": 0, "last_activity_date": 1562776506, "creation_date": 1562776506, "answer_id": 56975087, "question_id": 56974129, "link": "https://stackoverflow.com/questions/56974129/identifying-a-html-element-for-selection-in-ruby-where-finders-all-match/56975087#56975087", "title": "Identifying a html element for selection in ruby where finders all match", "body": "<p>First, see if you can upgrade to the latest version of Watir 6.x if you aren't already as watir-webdriver is deprecated.</p>\n\n<p>The <code>:class</code> locator is a single class (or an array of multiple classes), so putting in CSS selectors won't work.</p>\n\n<p>You have <code>:text</code> locators for both <code>String</code> and <code>RegExp</code>:</p>\n\n<pre><code>.li(text: 'Direct Debit')\n.li(text: /Payment/)\n</code></pre>\n\n<p>You can read about all of the various ways to locate Watir elements here:\n<a href=\"http://watir.com/guides/locating/\" rel=\"nofollow noreferrer\">http://watir.com/guides/locating/</a></p>\n"}], "owner": {"reputation": 13, "user_id": 11750927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/605d64f1da165d298d4887647a2e6f16?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Hardman", "link": "https://stackoverflow.com/users/11750927/jon-hardman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 56975073, "answer_count": 3, "score": 1, "last_activity_date": 1562776506, "creation_date": 1562772896, "last_edit_date": 1562773978, "question_id": 56974129, "link": "https://stackoverflow.com/questions/56974129/identifying-a-html-element-for-selection-in-ruby-where-finders-all-match", "title": "Identifying a html element for selection in ruby where finders all match", "body": "<p>I'm using watir-webdriver in a ruby project to mimic a users actions on a business system. In order to perform the task, I am required to select a drop down field and then select an option from this. </p>\n\n<p>The code in which the option elements are shown is:</p>\n\n<pre><code>&lt;ul class=\"rcbList\" style=\"list-style:none;margin:0;padding:0;zoom:1;\"&gt;\n    &lt;li class=\"rcbHovered  rcbTemplate\"&gt;\n        &lt;ul&gt;\n            &lt;li style=\"width: 100%\" class=\"gridcontrolcolumn\"&gt;\n                Direct Debit\n            &lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/li&gt;\n    &lt;li class=\"rcbItem  rcbTemplate\"&gt;\n        &lt;ul&gt;\n            &lt;li style=\"width: 100%\" class=\"gridcontrolcolumn\"&gt;\n                Invoice\n            &lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/li&gt;\n    &lt;li class=\"rcbItem  rcbTemplate\"&gt;\n        &lt;ul&gt;\n            &lt;li style=\"width: 100%\" class=\"gridcontrolcolumn\"&gt;\n                Online Payment\n            &lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>Note I can differentiate the options using the \"description\" in the code. However, I am unable to use any finders (e.g. class:/id: etc to identify them in ruby.)  </p>\n\n<p>Is there an expression in which i can identify the descriptive text at the end?</p>\n\n<p>I've previously tried using a send_keys function to select them using their title, however the field is read only and does not respond to send_keys.</p>\n\n<p>My current (non functioning) ruby code is as follows:</p>\n\n<pre><code>@browser.iframe(id: 'contentIFrame1')\n      .iframe(id: 'navLink{bd27b00e-3d5e-b7b5-0ddb-864216077292}AreaFrame')\n      .input(id: 'ctl00_MainContent_cboDefaultPaymentType_Input').wait_until_present.click\n  @browser.iframe(id: 'contentIFrame1')\n      .iframe(id: 'navLink{bd27b00e-3d5e-b7b5-0ddb-864216077292}AreaFrame')\n      .input(id: 'ctl00_MainContent_cboDefaultPaymentType_Input').li(class: '\"gridcontrolcolumn\" &gt;\n      Direct Debit &lt; /li&gt;').click\n</code></pre>\n\n<p>Naturally if I use <code>.li(class:\"gridcontrolcolumn\").click</code>, I have too many values returned.</p>\n\n<pre><code>Watir::Exception::UnknownObjectException: timed out after 30 seconds, waiting for #&lt;Watir::LI: located: false; {:id=&gt;\"contentIFrame1\", :tag_name=&gt;\"iframe\"} --&gt; {:id=&gt;\"navLink{bd27b00e-3d5e-b7b5-0ddb-864216077292}AreaFrame\", :tag_name=&gt;\"iframe\"} --&gt; {:id=&gt;\"ctl00_MainContent_cboDefaultPaymentType_Input\", :tag_name=&gt;\"input\"} --&gt; {:class=&gt;\"\\\"gridcontrolcolumn\\\" &gt;\\n      Direct Debit &lt; /li&gt;\", :tag_name=&gt;\"li\"}&gt; to be located\n./features/step_definitions/create_DD_mandate.rb:65:in `/^Change the payment type to DD$/'\n./features/create_DD_contact.feature:13:in `Then Change the payment type to DD'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "cqrs", "event-sourcing", "rails-event-store"], "answers": [{"comments": [{"owner": {"reputation": 3908, "user_id": 322863, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cff6feb283b9f194892e8f6737eed875?s=128&d=identicon&r=PG", "display_name": "aef", "link": "https://stackoverflow.com/users/322863/aef"}, "edited": false, "score": 0, "creation_date": 1575561911, "post_id": 57054691, "comment_id": 104615950, "body": "Thanks for the links. Sadly your first article never mentions how and from whom Builder is ever called and if it is supposed to be registered as a subscriber."}, {"owner": {"reputation": 350, "user_id": 1078927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63928b05bae11b832bd9d231cc669d70?s=128&d=identicon&r=PG", "display_name": "\u015awistak35", "link": "https://stackoverflow.com/users/1078927/%c5%9awistak35"}, "reply_to_user": {"reputation": 3908, "user_id": 322863, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cff6feb283b9f194892e8f6737eed875?s=128&d=identicon&r=PG", "display_name": "aef", "link": "https://stackoverflow.com/users/322863/aef"}, "edited": false, "score": 0, "creation_date": 1581252761, "post_id": 57054691, "comment_id": 106361402, "body": "@aef In that particular case (first link), the model which was built there was needed only &quot;on demand&quot;, so we didn&#39;t need to continuously build it. I have some improved version of that, which allows to &quot;close to continuous work&quot; (with 5 minutes lag or something like that), which is perfect for many cases, and it still relies only on having message queue. Alternative would be to write your own scheduler for some log (not queue) tool. Persistent projections is also something I want to add for RES, but I&#39;m not sure when yet, and how hard it will be to make it relatively scheduler agnostic."}], "tags": [], "owner": {"reputation": 271, "user_id": 169237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3kh1h.png?s=128&g=1", "display_name": "Pawel Pacana", "link": "https://stackoverflow.com/users/169237/pawel-pacana"}, "is_accepted": true, "score": 3, "last_activity_date": 1563271175, "creation_date": 1563271175, "answer_id": 57054691, "question_id": 56974095, "link": "https://stackoverflow.com/questions/56974095/persistent-relational-projections-in-railseventstore/57054691#57054691", "title": "Persistent relational projections in RailsEventStore", "body": "<p>There is no out-of-the-box background process in RailsEventStore to support <a href=\"https://blog.arkency.com/why-event-sourcing-basically-requires-cqrs-and-read-models/\" rel=\"nofollow noreferrer\">persistent projections</a> the same way EventStore database does them.</p>\n\n<p>There are however pieces you can fit together to achieve something similar \u2014 <a href=\"https://railseventstore.org/docs/subscribe/\" rel=\"nofollow noreferrer\">event handlers</a> and <a href=\"https://railseventstore.org/docs/link/\" rel=\"nofollow noreferrer\">linking</a>. </p>\n\n<p>My colleague Rafa\u0142 put together a few posts documenting this approach:</p>\n\n<ul>\n<li><a href=\"https://blog.arkency.com/using-streams-to-build-read-models/\" rel=\"nofollow noreferrer\">https://blog.arkency.com/using-streams-to-build-read-models/</a></li>\n<li><a href=\"https://blog.arkency.com/read-model-patterns-in-case-of-lack-of-order-guarantee/\" rel=\"nofollow noreferrer\">https://blog.arkency.com/read-model-patterns-in-case-of-lack-of-order-guarantee/</a></li>\n</ul>\n\n<p>If you'd like to implement such projection as a separate background process rather to rely on event handlers (whether synchronous or not) then <a href=\"https://github.com/RailsEventStore/rails_event_store/tree/9754a0271e6516a09b12fd437708379bedc9d75f/contrib/distributed_rails_event_store\" rel=\"nofollow noreferrer\">Distributed RailsEventStore</a> with <a href=\"https://railseventstore.org/docs/repository/#using-pglinearizedeventrepository-for-linearized-writes\" rel=\"nofollow noreferrer\">PgLinearizedRepository</a> might be a good starting point. </p>\n"}], "owner": {"reputation": 3908, "user_id": 322863, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cff6feb283b9f194892e8f6737eed875?s=128&d=identicon&r=PG", "display_name": "aef", "link": "https://stackoverflow.com/users/322863/aef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 57054691, "answer_count": 1, "score": 1, "last_activity_date": 1563271175, "creation_date": 1562772791, "question_id": 56974095, "link": "https://stackoverflow.com/questions/56974095/persistent-relational-projections-in-railseventstore", "title": "Persistent relational projections in RailsEventStore", "body": "<p>I am trying to build a CQRS and event sourced Rails 5.2.x application using RailsEventStore.</p>\n\n<p>Now I would like to project my event stream into a relational model, ideally just using ActiveRecord and the PostgreSQL database I also used for my event store.</p>\n\n<p>In the documentation of RailsEventStore I only found on-the-fly, non-persistent projections.</p>\n\n<p>Is there any infrastructure available to continuously build and update a relational representation of an event stream? It needs to remember which events have already been applied to the relational model across restarts of the application.</p>\n\n<p>In case you know how to do it, please let me know.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1562770987, "post_id": 56973442, "comment_id": 100483338, "body": "What path are you actually hitting to cause the error? And why doesn&#39;t <code>show</code> show a goal? It appears to <code>build</code> one, not show one."}, {"owner": {"reputation": 189, "user_id": 9240948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcc15724e3e0e50997b05261932368?s=128&d=identicon&r=PG&f=1", "display_name": "thebot", "link": "https://stackoverflow.com/users/9240948/thebot"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1562771514, "post_id": 56973442, "comment_id": 100483651, "body": "@DaveNewton Thank you for the comment. This one: user_goals_path(@user, @goal). How should I change the controller?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1562773362, "post_id": 56973442, "comment_id": 100484726, "body": "And what goal are you passing in? <code>show</code> is for showing a goal, which means it&#39;ll have an ID. <code>build</code> doesn&#39;t save a goal (or show a goal), it creates an unsaved goal (IIRC) so will have no ID. <code>show</code> should retrieve a goal."}, {"owner": {"reputation": 189, "user_id": 9240948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcc15724e3e0e50997b05261932368?s=128&d=identicon&r=PG&f=1", "display_name": "thebot", "link": "https://stackoverflow.com/users/9240948/thebot"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1562774905, "post_id": 56973442, "comment_id": 100485570, "body": "@DaveNewton I&#39;ve changed show function to: \t<code>def show \t\t@user = User.find(params[:user_id]) \t\t@goal = @user.goals.find(:id) \tend. </code> still not working. Same error message."}, {"owner": {"reputation": 189, "user_id": 9240948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcc15724e3e0e50997b05261932368?s=128&d=identicon&r=PG&f=1", "display_name": "thebot", "link": "https://stackoverflow.com/users/9240948/thebot"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1562774928, "post_id": 56973442, "comment_id": 100485585, "body": "@DaveNewton Not sure what you mean by &quot;And what goal are you passing in?&quot;"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1562776275, "post_id": 56973442, "comment_id": 100486291, "body": "You&#39;re passing a goal when you call <code>user_goals_path(@user, @goal)</code>. What goal are you passing in? You might want to take a step back: you can just <i>look</i> at the parameters used to make the call, and in the controller you can <i>see</i> the request being made."}, {"owner": {"reputation": 189, "user_id": 9240948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcc15724e3e0e50997b05261932368?s=128&d=identicon&r=PG&f=1", "display_name": "thebot", "link": "https://stackoverflow.com/users/9240948/thebot"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1562780331, "post_id": 56973442, "comment_id": 100488161, "body": "@DaveNewton I&#39;m very sorry for my noob question: &quot;look&quot; where? &quot;see&quot; exactly where? What seems to be wrong with the code?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1562784403, "post_id": 56973442, "comment_id": 100489951, "body": "... In the controller&#39;s method inspect the params. Those are the params available for your use. If you&#39;re not seeing what you expect then you&#39;re not passing reasonable values to the <code>user_goals_path</code> method. Maybe a tutorial would be a good idea."}, {"owner": {"reputation": 189, "user_id": 9240948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcc15724e3e0e50997b05261932368?s=128&d=identicon&r=PG&f=1", "display_name": "thebot", "link": "https://stackoverflow.com/users/9240948/thebot"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1562785991, "post_id": 56973442, "comment_id": 100490587, "body": "@DaveNewton OK - I asked because I assumed you were telling me to look somewhere I didn&#39;t post. I think you mean this? ``` params.require(:goal).permit(:text) ``` I think this code is ok, but if not, please tell me why."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1562786040, "post_id": 56973442, "comment_id": 100490605, "body": "I&#39;m telling you to <i>inspect the parameters being passed in from the request</i>."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 9240948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcc15724e3e0e50997b05261932368?s=128&d=identicon&r=PG&f=1", "display_name": "thebot", "link": "https://stackoverflow.com/users/9240948/thebot"}, "edited": false, "score": 0, "creation_date": 1562796161, "post_id": 56978789, "comment_id": 100494296, "body": "This is great, thank you! The only problem now is that when I click on a goal, it leads me to index.html.erb (where I have only one line: &lt;%= @goal.text %&gt;) instead of show.html.erb (same: &lt;%= @goal.text %&gt;). When I manually type in url: ...goals/15, the show.html.erb shows the goal text. But when I click on a goal from the list, the index.html.erb generates: undefined method `text&#39; for #&lt;Goal::ActiveRecord_Associations_CollectionProxy:0x00007fb8&zwnj;&#8203;6c76f6e8&gt;. How can I click on a goal and go to show.html.erb?"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "reply_to_user": {"reputation": 189, "user_id": 9240948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcc15724e3e0e50997b05261932368?s=128&d=identicon&r=PG&f=1", "display_name": "thebot", "link": "https://stackoverflow.com/users/9240948/thebot"}, "edited": false, "score": 0, "creation_date": 1562820415, "post_id": 56978789, "comment_id": 100498951, "body": "From your <code>@goals = @user.goals</code> in index file, you can generate a list of goals in your index view, and link to goal path"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "reply_to_user": {"reputation": 189, "user_id": 9240948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcc15724e3e0e50997b05261932368?s=128&d=identicon&r=PG&f=1", "display_name": "thebot", "link": "https://stackoverflow.com/users/9240948/thebot"}, "edited": false, "score": 0, "creation_date": 1562820507, "post_id": 56978789, "comment_id": 100498975, "body": "in your goals index view: <code>&lt;ul&gt; &lt;% @goals.each do |goal| %&gt; &lt;%= link_to goal.text, user_goal_path(goal) %&gt;  &lt;% end %&gt; &lt;&#47;ul&gt;</code>  If it helps, plz don&#39;t forget to vote and mark resolve for my answer :) @thebot"}, {"owner": {"reputation": 189, "user_id": 9240948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcc15724e3e0e50997b05261932368?s=128&d=identicon&r=PG&f=1", "display_name": "thebot", "link": "https://stackoverflow.com/users/9240948/thebot"}, "edited": false, "score": 0, "creation_date": 1562975162, "post_id": 56978789, "comment_id": 100561921, "body": "Thank you. Unfortunately it returns an error: <code>undefined method `each&#39; for nil:NilClass</code> And replacing @goals.each with @user.goals.each returns a similar error as the one my code returns."}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 0, "last_activity_date": 1562793545, "creation_date": 1562793545, "answer_id": 56978789, "question_id": 56973442, "link": "https://stackoverflow.com/questions/56973442/in-rails-show-for-nested-resources-not-working/56978789#56978789", "title": "In Rails, show for nested resources not working", "body": "<p>First thing, in the show</p>\n\n<pre><code>@goal = @user.goals.find(:id) \n\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>@goal = @user.goals.find(params[:id]) \n</code></pre>\n\n<p>You said you tried with <code>@user.goals.find(goal_params)</code> in <code>show</code> action and I see it in your <code>index</code> action also. This will call the <code>goal_params</code> method, which require <code>params[:goal]</code>  while your <code>index</code> or <code>show</code> request does not send to server, only when you submit the form, you will have that params. This is the cause of your error.</p>\n\n<p>Second thing, your <code>index</code> should use</p>\n\n<pre><code>@goals = @user.goals\n</code></pre>\n\n<p>INSTEAD OF</p>\n\n<pre><code>@goal = @user.goals.find(goal_params)\n</code></pre>\n\n<p>Also, the <code>strong parameters</code> is used for <code>create</code> and <code>update</code> actions only to avoid mass assignment to our database. It's not used to <code>find</code> a record.</p>\n"}], "owner": {"reputation": 189, "user_id": 9240948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcc15724e3e0e50997b05261932368?s=128&d=identicon&r=PG&f=1", "display_name": "thebot", "link": "https://stackoverflow.com/users/9240948/thebot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562793545, "creation_date": 1562770539, "last_edit_date": 1562775340, "question_id": 56973442, "link": "https://stackoverflow.com/questions/56973442/in-rails-show-for-nested-resources-not-working", "title": "In Rails, show for nested resources not working", "body": "<p>I am using nested resources. When I click on a goal that's been created, I keep getting this error: </p>\n\n<pre><code>param is missing or the value is empty: goal\n</code></pre>\n\n<p>And it directs me to the \"params.require...\" line:</p>\n\n<pre><code>    private\n        def goal_params\n            params.require(:goal).permit(:text)\n        end\n</code></pre>\n\n<p>I'm not sure what's causing this. I can create and show the list. But when I click on a goal I get this error. I'm new to rails and I'm at my wit's end. </p>\n\n<p>My view: </p>\n\n<pre><code>&lt;h1&gt;Listing goals&lt;/h1&gt;\n\n&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Text&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n\n  &lt;% @user.goals.each do |goal| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= link_to goal.text, user_goals_path(@user, @goal)%&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n\n\n&lt;h2&gt;Add a comment:&lt;/h2&gt;\n&lt;%= form_for([@user, @user.goals.build]) do |form| %&gt;\n  &lt;p&gt;\n    &lt;%= form.text_area :text %&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n    &lt;%= form.submit %&gt;\n  &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My controller:</p>\n\n<pre><code>class GoalsController &lt; ApplicationController\n\n    def index\n        @user = User.find(params[:user_id])\n        @goal = @user.goals.find(goal_params)\n    end\n\n    def show\n        @user = User.find(params[:user_id])\n        @goal = @user.goals.find(:id) \n        #also tried goal_params and :goal_id instead of :id\n    end\n\n    def new\n        @user = User.find(params[:user_id])\n        @goal = @user.goals.new\n    end\n\n\n    def create \n        @user = User.find(params[:user_id])\n        @goal = @user.goals.build(goal_params)\n        @goal.user = current_user\n\n        if @goal.save\n            redirect_to new_user_goal_path, notice: \"Success!~\"\n        else \n            redirect_to new_user_goal_path, alert: \"Failure!\"\n        end\n        #to root_path\n    end \n\n    private\n        def goal_params\n            params.require(:goal).permit(:text)\n        end\nend\n</code></pre>\n\n<p>My routes:</p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users\n\n  resources :user do\n    resources :goals\n  end\n\n  devise_scope :user do\n    authenticated :user do\n      root 'home#index', as: :authenticated_root\n    end\n\n\n\n    unauthenticated do\n      root 'devise/sessions#new', as: :unauthenticated_root\n    end\n  end\n\nend\n</code></pre>\n\n<p>My show.html.erb:</p>\n\n<pre><code>&lt;p&gt;\n  &lt;strong&gt;Text:&lt;/strong&gt;\n  &lt;%= @goal.text %&gt;\n&lt;/p&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms"], "answers": [{"tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 0, "last_activity_date": 1562793876, "creation_date": 1562793876, "answer_id": 56978857, "question_id": 56973249, "link": "https://stackoverflow.com/questions/56973249/send-only-the-part-of-form-or-the-nested-form/56978857#56978857", "title": "Send only the part of form or the nested form", "body": "<p>When you submit your form, it will send your form data to your controller action, and I think only this action. Also, form will be submit only once</p>\n\n<p>If you want to submit your form twice, why don't you add a custom action to your submit button click. Here you can have two <code>ajax</code> calls to your different actions?\nOr, you can use <code>strong parameters</code> to restrict what will be receive for your individual controller actions</p>\n"}], "owner": {"reputation": 401, "user_id": 7156757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8768142e36048bf7d98b346110611ebc?s=128&d=identicon&r=PG&f=1", "display_name": "O.Vykhor", "link": "https://stackoverflow.com/users/7156757/o-vykhor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562793876, "creation_date": 1562769962, "question_id": 56973249, "link": "https://stackoverflow.com/questions/56973249/send-only-the-part-of-form-or-the-nested-form", "title": "Send only the part of form or the nested form", "body": "<p>Is there any way to send part of the form to the controller, like send only <code>fields_for</code> to the controller? I have form with multiple attributes, some of them for the model and will be stored in DB and some for API, user will be fill a few fields and then other fields will be rendered (according to api response). So, I need to send my form twice, but I don't want to send whole model form, and just send attributes for the api from this form and then the full form.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "namespaces", "autoload", "directory-structure"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1562774829, "post_id": 56973069, "comment_id": 100485533, "body": "I don&#39;t know the answer, but I suspect you can find it in the <a href=\"https://guides.rubyonrails.org/autoloading_and_reloading_constants.html\" rel=\"nofollow noreferrer\">Autoloading and Reloading Constants Rails Guide</a>."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1562775145, "post_id": 56973069, "comment_id": 100485707, "body": "Ruby on Rails uses convention over configuration a lot and is highly opinionated. My advice is: Follow these conventions and do not try to fight them. If you leave the default path it will make your life much harder and you will certainly regret it in the future."}, {"owner": {"reputation": 3908, "user_id": 322863, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cff6feb283b9f194892e8f6737eed875?s=128&d=identicon&r=PG", "display_name": "aef", "link": "https://stackoverflow.com/users/322863/aef"}, "edited": false, "score": 0, "creation_date": 1562827845, "post_id": 56973069, "comment_id": 100501680, "body": "Rails and its community used this argument since its beginning to excuse its lack of flexibility. But the idea of convention over configuration does not imply that. It just implies that there are sane defaults. Overall Rails has become much better in this regard and it should, because as Rails applications grow, the Rails way doesn&#39;t fit and is an impediment to maintainability."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 9069168, "user_type": "registered", "profile_image": "https://graph.facebook.com/1573157946093303/picture?type=large", "display_name": "Abhishek Kushwaha", "link": "https://stackoverflow.com/users/9069168/abhishek-kushwaha"}, "is_accepted": false, "score": 1, "last_activity_date": 1562879041, "creation_date": 1562879041, "answer_id": 56997276, "question_id": 56973069, "link": "https://stackoverflow.com/questions/56973069/directories-that-do-not-affect-class-namespace-in-rails/56997276#56997276", "title": "Directories that do not affect class namespace in Rails", "body": "<p>The idea of convention over configuration is to make you code in easier and conventional way, despite of that Rails offers you a lot of flexibility to reflect your ideas within your application. In your case, if you want to introduce additional directories to your models just add the <strong>config.autoload_paths += %W(#{config.root}/app/models/events)</strong> (It was image in my case, the picture deepicts the same)in <strong>config/application.rb</strong> so that you class look like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bzKRw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bzKRw.png\" alt=\"enter image description here\"></a></p>\n\n<p>and my classes looks as regular one without any namespaces. This should solve your purpose.</p>\n"}], "owner": {"reputation": 3908, "user_id": 322863, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cff6feb283b9f194892e8f6737eed875?s=128&d=identicon&r=PG", "display_name": "aef", "link": "https://stackoverflow.com/users/322863/aef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1562879041, "creation_date": 1562769398, "question_id": 56973069, "link": "https://stackoverflow.com/questions/56973069/directories-that-do-not-affect-class-namespace-in-rails", "title": "Directories that do not affect class namespace in Rails", "body": "<p>I am building a Rails 5.2.x application and I am looking for ways to improve the directory structure of my project.</p>\n\n<p>Some model classes in my application represent events and I would like to separate these from other classes which do not represent events.</p>\n\n<p>So ideally I would like to have an <code>events</code> subdirectory like this:</p>\n\n<pre><code>[RAILS ROOT]/app/models/something.rb\n[RAILS ROOT]/app/models/events/some_event.rb\n</code></pre>\n\n<p>Which contain <code>Something</code> and <code>SomeEvent</code> reprectively.</p>\n\n<p>It seems though, that Rails would require me to name the event class <code>Events::SomeEvent</code> in this case.</p>\n\n<p>My actual classes already heavily use namespaces and therefore have long and clumsy names. I would like being able to easily separate my event classes visually while development, without them having even longer names.</p>\n\n<p>Also, in case of the events, I would like to avoid changing the class names, because loading of historical data uses the name for deserialization into the correct class.</p>\n\n<p>Is there a way to introduce additional subdirectories in Rails without the need to represent them as a namespace component? If so, I would really like to know how.</p>\n"}, {"tags": ["regex", "ruby", "regex-negation"], "comments": [{"owner": {"reputation": 18299, "user_id": 2191572, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWbVr.png?s=128&g=1", "display_name": "MonkeyZeus", "link": "https://stackoverflow.com/users/2191572/monkeyzeus"}, "edited": false, "score": 0, "creation_date": 1562768826, "post_id": 56972771, "comment_id": 100482063, "body": "I think that XPath is much more appropriate for this sort of extraction."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1562770935, "post_id": 56972771, "comment_id": 100483306, "body": "Related: <a href=\"https://stackoverflow.com/a/1732454/179125\">stackoverflow.com/a/1732454/179125</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562769599, "post_id": 56972880, "comment_id": 100482544, "body": "Sorry Tim. I forgot to add tags outside of the textarea too. I modified the question above with the updated Rubular."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "reply_to_user": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562769656, "post_id": 56972880, "comment_id": 100482572, "body": "How does your question change (I&#39;m not seeing any change)?  Can you edit your question and show us exactly what you are trying to match?"}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562769967, "post_id": 56972880, "comment_id": 100482746, "body": "Yes, does this Rubular make more sense: <a href=\"https://rubular.com/r/emay1eMo8FWlVQ\" rel=\"nofollow noreferrer\">rubular.com/r/emay1eMo8FWlVQ</a>? Basically, I&#39;m trying to exclude all tags inside &quot;textarea&quot; blocks unless it has the data-match-this=&quot;true&quot; attribute. If it&#39;s easier, we can modify the test string to use something like do-not-data-match-this=&quot;true&quot; instead."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "reply_to_user": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562770074, "post_id": 56972880, "comment_id": 100482814, "body": "My regex identifies all text which you want to keep, if I understand correctly.  Then, why can&#39;t you just iterate your text file and retain only the portions which match?"}], "tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": false, "score": 0, "last_activity_date": 1562768793, "creation_date": 1562768793, "answer_id": 56972880, "question_id": 56972771, "link": "https://stackoverflow.com/questions/56972771/how-can-i-exclude-regex-matches-inside-blocks-with-a-certain-attribute/56972880#56972880", "title": "How can I exclude regex matches inside blocks with a certain attribute?", "body": "<p>Here is one possibility:</p>\n\n<pre><code>&lt;textarea[^&gt;]+data-match-this=\"[^\"]+\"[^&gt;]*&gt;.*?&lt;\\/textarea&gt;   \n</code></pre>\n\n<p><a href=\"https://regex101.com/r/bAgRTl/2\" rel=\"nofollow noreferrer\"><h2>Demo</h2></a></p>\n"}, {"comments": [{"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562793373, "post_id": 56978180, "comment_id": 100493461, "body": "Wow! Great solution. Works perfect :) Thank you so much!!"}], "tags": [], "owner": {"reputation": 855, "user_id": 364392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1af8b60c508bb4f5f11371b13c379c8b?s=128&d=identicon&r=PG", "display_name": "Inversion", "link": "https://stackoverflow.com/users/364392/inversion"}, "is_accepted": true, "score": 1, "last_activity_date": 1562790541, "creation_date": 1562790541, "answer_id": 56978180, "question_id": 56972771, "link": "https://stackoverflow.com/questions/56972771/how-can-i-exclude-regex-matches-inside-blocks-with-a-certain-attribute/56978180#56978180", "title": "How can I exclude regex matches inside blocks with a certain attribute?", "body": "<p>It was hard\u2026  </p>\n\n<pre><code>(?:&lt;textarea data-do-not-match-this=\"true\"&gt;.+?&lt;\\/textarea&gt;.*?)?({{.*?}})\n</code></pre>\n\n<p><a href=\"https://rubular.com/r/32MFMtZ2Ms3lOX\" rel=\"nofollow noreferrer\">https://rubular.com/r/32MFMtZ2Ms3lOX</a></p>\n"}], "owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 56978180, "answer_count": 2, "score": 1, "last_activity_date": 1562790541, "creation_date": 1562768398, "last_edit_date": 1562771000, "question_id": 56972771, "link": "https://stackoverflow.com/questions/56972771/how-can-i-exclude-regex-matches-inside-blocks-with-a-certain-attribute", "title": "How can I exclude regex matches inside blocks with a certain attribute?", "body": "<p>I am trying to match all tags except for tags inside textareas that have the \"data-do-not-match-this='true'\" attribute. Given I have this test string:</p>\n\n<pre><code>&lt;textarea&gt;{{one}}{{two}}&lt;/textarea&gt; \n\n&lt;textarea data-do-not-match-this=\"true\"&gt;{{three}}{{four}}&lt;/textarea&gt; \n\n&lt;textarea&gt;\n{{five}}\n{{six}}{{seven}}\n&lt;/textarea&gt; \n\n&lt;textarea data-do-not-match-this=\"true\"&gt;\n{{eight}}\n{{nine}}{{ten}}\n&lt;/textarea&gt;\n\n{{eleven}}{{twelve}}\n</code></pre>\n\n<p>I have this regex so far:</p>\n\n<pre><code>(?&lt;!data\\-do\\-not\\-match\\-this=\"true\"&gt;)({{.*?}})\n</code></pre>\n\n<p>The regex incorrectly matches {{four}}, {{eight}}, {{nine}}, and {{ten}}. How can I fix the regex to exclude tags I do not want to match?</p>\n\n<p>This is my Rubular: </p>\n\n<p><a href=\"https://rubular.com/r/TfjuwRd8dSjFJX\" rel=\"nofollow noreferrer\">https://rubular.com/r/TfjuwRd8dSjFJX</a></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 183, "user_id": 6176394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/945261141733c25671268e2aa465249d?s=128&d=identicon&r=PG&f=1", "display_name": "Artur Martsinkovskyi", "link": "https://stackoverflow.com/users/6176394/artur-martsinkovskyi"}, "edited": false, "score": 0, "creation_date": 1562773894, "post_id": 56972660, "comment_id": 100485042, "body": "Your solution is wrong because it covers only linear shift of digits and not the permutation(e.g. when two or more digits swap places, not only replace. It won&#39;t find the nearest smaller number with same digits, it won&#39;t find anything because your joined variable does not change after the first assignment and you check for it in the while condition. It seems like you don&#39;t understand the programming that well, so you should better learn it better(like variable assignment concept) before tackling such problems."}], "answers": [{"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 0, "last_activity_date": 1562770626, "last_edit_date": 1562770626, "creation_date": 1562770136, "answer_id": 56973299, "question_id": 56972660, "link": "https://stackoverflow.com/questions/56972660/finding-next-smallest-number-with-same-digits/56973299#56973299", "title": "Finding next smallest number with same digits", "body": "<p>If you aren't tasked with creating the array of numbers yourself, there's an <a href=\"http://ruby-doc.org/core-2.6.3/Array.html#method-i-permutation\" rel=\"nofollow noreferrer\">Array#permutation</a> method available to generate all the combinations of numbers based on your original number. </p>\n\n<p>Then, after some cleanup &amp; sorting you can find the index of your number and then add 1 to find the next highest number.</p>\n\n<pre><code>def next_number(i)\n  puts \"Your number is #{i}\"\n  permutations = i.to_s.split('').permutation.to_a.map(&amp;:join).map(&amp;:to_i).uniq.sort\n  index = (permutations.find_index(i) + 1)\n\n  puts \"Next highest is #{permutations[index]}\"\nend\n\n# Usage\nnext_number(4357)\nnext_number(81541)\n</code></pre>\n\n<p>Caveats:</p>\n\n<ul>\n<li>Doesn't address if your number is the highest permutation (e.g. <code>next_number(999)</code>)</li>\n<li>Probably not the \"fastest\" way to do this, if it's part of a code challenge</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1562774050, "last_edit_date": 1562774050, "creation_date": 1562773606, "answer_id": 56974343, "question_id": 56972660, "link": "https://stackoverflow.com/questions/56972660/finding-next-smallest-number-with-same-digits/56974343#56974343", "title": "Finding next smallest number with same digits", "body": "<p>You are using a while loop where the variable used in while condition does not change inside the loop.</p>\n\n<p>One option to solve the problem by brute force is using <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-permutation\" rel=\"nofollow noreferrer\">Array#permutation</a> on the <a href=\"https://ruby-doc.org/core-2.6.3/Integer.html#method-i-digits\" rel=\"nofollow noreferrer\">Integer#digits</a> array:</p>\n\n<pre><code>n = 1231\nn.digits.permutation.uniq.map { |e| e.join.to_i }.sort.keep_if { |k| k &gt; n }.first\n#=&gt; 1312\n</code></pre>\n\n<p>It uses <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-keep_if\" rel=\"nofollow noreferrer\">Array#keep_if</a> to keep all the numbers (<code>k</code>) bigger than <code>n</code>.</p>\n\n<p>It returns <code>nil</code> if there is no biggest number.\n<hr>\nUsing <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-partition\" rel=\"nofollow noreferrer\">Enumerable#partition</a> you can see \"what's inside\":</p>\n\n<pre><code>n.digits.permutation.uniq.map { |e| e.join.to_i }.sort.partition { |k| k &gt; n }\n#=&gt; [[1312, 1321, 2113, 2131, 2311, 3112, 3121, 3211], [1123, 1132, 1213, 1231]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1562812192, "last_edit_date": 1562812192, "creation_date": 1562784365, "answer_id": 56976885, "question_id": 56972660, "link": "https://stackoverflow.com/questions/56972660/finding-next-smallest-number-with-same-digits/56976885#56976885", "title": "Finding next smallest number with same digits", "body": "<p>Let's begin by creating a method whose argument <code>digits</code> is an array of digits and which returns a (\"counting\") hash whose keys are the digits <code>0-9</code> and whose values are <code>digits.count(d)</code> for each key <code>d</code>. </p>\n\n<pre><code>def count_digits(digits)\n  digits.each_with_object((0..9).to_a.product([0]).to_h) { |d,h| h[d] += 1 }\nend\n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>digits = 35145.digits\n  #=&gt; [5, 4, 1, 5, 3] \ndigit_counts = count_digits(digits)\n  #=&gt; {0=&gt;0, 1=&gt;1, 2=&gt;0, 3=&gt;1, 4=&gt;1, 5=&gt;2, 6=&gt;0, 7=&gt;0, 8=&gt;0, 9=&gt;0}\n</code></pre>\n\n<p>(See <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-product\" rel=\"nofollow noreferrer\">Array#product</a> and <a href=\"https://ruby-doc.org/core-2.5.0/Integer.html#method-i-digits\" rel=\"nofollow noreferrer\">Integer#digits</a>). We can now write a method that returns the desired result.</p>\n\n<pre><code>def next_smallest(n)\n  digits = n.digits\n  digit_counts = count_digits(digits)\n  (n-1).downto(0).find { |m| count_digits(m.digits) == digit_counts }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>require 'time'\n\ndef doit(n)\n  t = Time.now\n  n = next_smallest(n)\n  puts \"Elapsed time in seconds = #{(Time.now-t).round(7)}\"\n  n\nend\n\ndoit  44444\n  # Elapsed time in seconds = 0.2008061\n  #=&gt; nil \ndoit  35154\n  # Elapsed time in seconds = 5.18e-05\n  #=&gt; 35145 \ndoit  35154217464215716524742391453862\n  # Elapsed time in seconds = 0.0005618\n  #=&gt; 35154217464215716524742391453826 \ndoit  351542174642157165247423914538623999\n  # Elapsed time in seconds = 3.4207082\n  #=&gt; 351542174642157165247423914538399962 \n</code></pre>\n\n<p>Though it may be somewhat academic, we can do better. Given <code>digits</code> and <code>digit_counts</code> above, to update <code>digits</code> for  </p>\n\n<pre><code>n = 35153\n</code></pre>\n\n<p>we may write (because the last digit is greater than zero):</p>\n\n<pre><code>digits[0] -= 1\ndigits\n  #=&gt; [4, 4, 1, 5, 3] \n</code></pre>\n\n<p>Similarly, after making a deep copy of <code>digit_counts</code>:</p>\n\n<pre><code>h = digit_counts.transform_values(&amp;:itself)\n  #=&gt; {0=&gt;0, 1=&gt;1, 2=&gt;0, 3=&gt;1, 4=&gt;1, 5=&gt;2, 6=&gt;0, 7=&gt;0, 8=&gt;0, 9=&gt;0}\n</code></pre>\n\n<p>we may update this hash by writing:</p>\n\n<pre><code>d0 = digits.first\n  #=&gt; 4 \nh[d0] += 1\nh[d0+1] -= 1\nh #=&gt; {0=&gt;0, 1=&gt;1, 2=&gt;0, 3=&gt;1, 4=&gt;2, 5=&gt;1, 6=&gt;0, 7=&gt;0, 8=&gt;0, 9=&gt;0} \n</code></pre>\n\n<p>rather than calling <code>count_digits</code>. (See <a href=\"http://ruby-doc.org/core-2.6.1/Hash.html#method-i-transform_values\" rel=\"nofollow noreferrer\">Hash#transform_values</a>). Now let's revise the method as follows.</p>\n\n<pre><code>def next_smallest(n)\n  digits = n.digits\n  digit_counts = count_digits(digits)\n  h = digit_counts.transform_values(&amp;:itself)\n  (n-1).downto(10).find do |m|\n    d0 = digits.first\n    if d0 &gt; 0\n      digits[0] -= 1\n      h[d0] -= 1\n      h[d0-1] += 1\n    else\n      digits = m.digits\n      h = count_digits(digits)\n    end\n    h == digit_counts\n  end\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>doit  44444\n  # Elapsed time in seconds = 0.0607323\n  #=&gt; nil \ndoit  35154\n  # Elapsed time in seconds = 0.0001582\n  #=&gt; 35145 \ndoit  35154217464215716524742391453862\n  # Elapsed time in seconds = 0.000216\n  #=&gt; 35154217464215716524742391453826 \ndoit  351542174642157165247423914538623999\n  # Elapsed time in seconds = 0.5180595\n  #=&gt; 351542174642157165247423914538399962 \n</code></pre>\n\n<p>Further improvements would be possible in the case where the last digit is zero (to avoid calling <code>count_digits</code>). If, for example,</p>\n\n<pre><code>n = 2130\ndigits = n.digits\n  #=&gt; [0, 3, 1, 2]\nh = count_digits(digits)\n  #=&gt; {0=&gt;1, 1=&gt;1, 2=&gt;1, 3=&gt;1, 4=&gt;0, 5=&gt;0, 6=&gt;0, 7=&gt;0, 8=&gt;0, 9=&gt;0}\n</code></pre>\n\n<p><code>digits</code> and <code>h</code> could be updated for <code>n = 2129</code> as follows:</p>\n\n<pre><code>n -= 1\n  #=&gt; 2129\nd1 = digits[1] \n  #=&gt; 3 \ndigits\n  #=&gt; [9, 2, 1, 2] \nh[0] -= 1\nh[9] += 1\nh[d1] -= 1\nh[d1-1] += 1\nh #=&gt; {0=&gt;0, 1=&gt;1, 2=&gt;2, 3=&gt;0, 4=&gt;0, 5=&gt;0, 6=&gt;0, 7=&gt;0, 8=&gt;0, 9=&gt;1} \n</code></pre>\n\n<p>One could do something similar if <code>n = 2100</code> or <code>2000</code>, but it quickly becomes faster to just call <code>count_digits</code>, </p>\n"}], "owner": {"reputation": 19, "user_id": 4025947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x0WPM.jpg?s=128&g=1", "display_name": "CodeKrakken", "link": "https://stackoverflow.com/users/4025947/codekrakken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 740, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1562812192, "creation_date": 1562768076, "last_edit_date": 1562769122, "question_id": 56972660, "link": "https://stackoverflow.com/questions/56972660/finding-next-smallest-number-with-same-digits", "title": "Finding next smallest number with same digits", "body": "<p>I'm working with Ruby and trying to write a code that will take a numerical input and return the next biggest number with the same digits.  </p>\n\n<p>I have seen this same question asked here before but the code differs too much to help me solve my particular problem.</p>\n\n<pre><code>def next_smaller n\n  ndigitsarray=n.digits.reverse\n  bigdigitsarray=ndigitsarray.sort.reverse\n  bigdigitsjoint=bigdigitsarray.join.to_i\n    while bigdigitsjoint&gt;n do \n  bigdigitsarray.insert(1, bigdigitsarray.delete_at(0)) \n    end\n  return bigdigitsarray.join.to_i\nend\n</code></pre>\n\n<p>The code times out; I am not sure why it isn't looping correctly. Any help would be gratefully received!</p>\n\n<p>EDIT - I have worked out why there is an infinite loop, but I am leaving this up for now in case anyone has any suggestions for solving the larger problem!</p>\n"}, {"tags": ["python", "ruby", "python-imaging-library", "homebrew", "recipe"], "answers": [{"tags": [], "owner": {"reputation": 1329, "user_id": 111960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d5c92476e067787fc7e06f5970dda22?s=128&d=identicon&r=PG", "display_name": "jonchang", "link": "https://stackoverflow.com/users/111960/jonchang"}, "is_accepted": false, "score": 0, "last_activity_date": 1562900903, "creation_date": 1562900903, "answer_id": 56999705, "question_id": 56972532, "link": "https://stackoverflow.com/questions/56972532/how-to-include-python-pillow-as-homebrew-formula-requisite/56999705#56999705", "title": "How to include Python Pillow as Homebrew formula requisite?", "body": "<p>You likely need to include additional <code>depends_on</code> clauses to help Pillow locate compiled libraries: e.g., <code>depends_on \"openjpeg\"</code> (which provides <code>openjpeg.h</code>).</p>\n"}], "owner": {"reputation": 146, "user_id": 8759193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UFeYw.jpg?s=128&g=1", "display_name": "bglezseoane", "link": "https://stackoverflow.com/users/8759193/bglezseoane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562900903, "creation_date": 1562767680, "question_id": 56972532, "link": "https://stackoverflow.com/questions/56972532/how-to-include-python-pillow-as-homebrew-formula-requisite", "title": "How to include Python Pillow as Homebrew formula requisite?", "body": "<p>I used to use Homebrew tap formulas to distribute my self maintained programs. However, it is imposible for me to do with some programs which use Pillow, because Homebrew fails when try to install it isolate.</p>\n\n<p>Example of a recipe which uses Pillow:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Monoshape &lt; Formula\n    include Language::Python::Virtualenv\n\n    desc \"Extracts monochromatic shapes\"\n    homepage \"https://github.com/GlezSeoane/monoshape\"\n    url \"https://github.com/GlezSeoane/monoshape/archive/v1.0.tar.gz\"\n    sha256 \"6edbecfc60db6f91fba6e520769f811009743eec89d655c54e4e6006ad5b0dbb\"\n\n    depends_on \"python\"\n\n    resource \"filetype\" do\n        url \"https://files.pythonhosted.org/packages/e8/53/298887541ae479f8467d4d23e028c6d15f9811da25c582297fd3869666b7/filetype-1.0.5.tar.gz\"\n        sha256 \"17a3b885f19034da29640b083d767e0f13c2dcb5dcc267945c8b6e5a5a9013c7\"\n    end\n\n    resource \"Pillow\" do\n        url \"https://files.pythonhosted.org/packages/51/fe/18125dc680720e4c3086dd3f5f95d80057c41ab98326877fc7d3ff6d0ee5/Pillow-6.1.0.tar.gz\"\n        sha256 \"0804f77cb1e9b6dbd37601cee11283bba39a8d44b9ddb053400c58e0c0d7d9de\"\n    end\n\n    def install\n        virtualenv_install_with_resources\n        man1.install \"manpages/monoshape.1\"\n    end\n\n    test do\n        system \"python\", \"-c\", \"'import monoshape.__main__'\"\n    end\nend\n</code></pre>\n\n<p>Homebrew error output when try to use the formula:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>brew reinstall --verbose --debug ./Formula/monoshape.rb\n</code></pre>\n\n<pre><code>...\n==&gt; Downloading https://files.pythonhosted.org/packages/81/1a/6b2971adc1bca55b9a53ed1efa372acff7e8b9913982a396f3fa046efaf8/Pillow-6.0.0.tar.gz\n/usr/bin/curl -q --show-error --user-agent Homebrew/2.1.7\\ \\(Macintosh\\;\\ Intel\\ Mac\\ OS\\ X\\ 10.14.5\\)\\ curl/7.54.0 --location --silent --head --request GET https://files.pythonhosted.org/packages/81/1a/6b2971adc1bca55b9a53ed1efa372acff7e8b9913982a396f3fa046efaf8/Pillow-6.0.0.tar.gz\nAlready downloaded: /Users/glezseoane/Library/Caches/Homebrew/downloads/ea7321a9356188da36d495f4135bfd7dfeb7add8558b773a6421e9096db03779--Pillow-6.0.0.tar.gz\n==&gt; Verifying ea7321a9356188da36d495f4135bfd7dfeb7add8558b773a6421e9096db03779--Pillow-6.0.0.tar.gz checksum\ntar xof /Users/glezseoane/Library/Caches/Homebrew/downloads/ea7321a9356188da36d495f4135bfd7dfeb7add8558b773a6421e9096db03779--Pillow-6.0.0.tar.gz -C /private/tmp/d20190708-31029-1m7e24t\ncp -pR /private/tmp/d20190708-31029-1m7e24t/Pillow-6.0.0/. /private/tmp/monoshape--Pillow-20190708-31029-1w8theb/Pillow-6.0.0\nchmod -Rf +w /private/tmp/d20190708-31029-1m7e24t\n==&gt; /usr/local/Cellar/monoshape/1.0/libexec/bin/pip install -v --no-deps --no-binary :all: --ignore-installed /private/tmp/monoshape--Pillow-20190708-31029-1w8theb/Pillow-6.0.0\nCreated temporary directory: /private/tmp/pip-ephem-wheel-cache-aihec4je\nCreated temporary directory: /private/tmp/pip-req-tracker-6pqza4qj\nCreated requirements tracker '/private/tmp/pip-req-tracker-6pqza4qj'\nCreated temporary directory: /private/tmp/pip-install-tjb4rpw6\nProcessing /private/tmp/monoshape--Pillow-20190708-31029-1w8theb/Pillow-6.0.0\n  Created temporary directory: /private/tmp/pip-req-build-rgrd0jy0\n  Added file:///private/tmp/monoshape--Pillow-20190708-31029-1w8theb/Pillow-6.0.0 to build tracker '/private/tmp/pip-req-tracker-6pqza4qj'\n    Running setup.py (path:/private/tmp/pip-req-build-rgrd0jy0/setup.py) egg_info for package from file:///private/tmp/monoshape--Pillow-20190708-31029-1w8theb/Pillow-6.0.0\n    Running command python setup.py egg_info\n    running egg_info\n    creating pip-egg-info/Pillow.egg-info\n    writing pip-egg-info/Pillow.egg-info/PKG-INFO\n    writing dependency_links to pip-egg-info/Pillow.egg-info/dependency_links.txt\n    writing top-level names to pip-egg-info/Pillow.egg-info/top_level.txt\n    writing manifest file 'pip-egg-info/Pillow.egg-info/SOURCES.txt'\n    reading manifest file 'pip-egg-info/Pillow.egg-info/SOURCES.txt'\n    reading manifest template 'MANIFEST.in'\n    warning: no files found matching '*.c'\n    warning: no files found matching '*.h'\n    warning: no files found matching '*.sh'\n    no previously-included directories found matching 'docs/_static'\n    warning: no previously-included files found matching '.appveyor.yml'\n    warning: no previously-included files found matching '.coveragerc'\n    warning: no previously-included files found matching '.codecov.yml'\n    warning: no previously-included files found matching '.editorconfig'\n    warning: no previously-included files found matching '.landscape.yaml'\n    warning: no previously-included files found matching '.readthedocs.yml'\n    warning: no previously-included files found matching 'azure-pipelines.yml'\n    warning: no previously-included files found matching 'tox.ini'\n    warning: no previously-included files matching '.git*' found anywhere in distribution\n    warning: no previously-included files matching '*.pyc' found anywhere in distribution\n    warning: no previously-included files matching '*.so' found anywhere in distribution\n    no previously-included directories found matching '.azure-pipelines'\n    no previously-included directories found matching '.travis'\n    writing manifest file 'pip-egg-info/Pillow.egg-info/SOURCES.txt'\n  Source in /private/tmp/pip-req-build-rgrd0jy0 has version 6.0.0, which satisfies requirement Pillow==6.0.0 from file:///private/tmp/monoshape--Pillow-20190708-31029-1w8theb/Pillow-6.0.0\n  Removed Pillow==6.0.0 from file:///private/tmp/monoshape--Pillow-20190708-31029-1w8theb/Pillow-6.0.0 from build tracker '/private/tmp/pip-req-tracker-6pqza4qj'\nSkipping bdist_wheel for Pillow, due to binaries being disabled for it.\nInstalling collected packages: Pillow\n  Created temporary directory: /private/tmp/pip-record-1a95g79y\n  Running setup.py install for Pillow: started\n    Running command /usr/local/Cellar/monoshape/1.0/libexec/bin/python3.7 -u -c 'import setuptools, tokenize;__file__='\"'\"'/private/tmp/pip-req-build-rgrd0jy0/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record /private/tmp/pip-record-1a95g79y/install-record.txt --single-version-externally-managed --compile --install-headers /usr/local/Cellar/monoshape/1.0/libexec/bin/../include/site/python3.7/Pillow\n    running install\n    running build\n    running build_py\n    creating build\n    creating build/lib.macosx-10.14-x86_64-3.7\n    creating build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/MpoImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageMode.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PngImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/XbmImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PcxImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/SunImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageFile.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/SpiderImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/TarIO.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/FitsStubImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/MpegImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/BdfFontFile.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/GribStubImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageStat.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PixarImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/GimpPaletteFile.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageColor.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ContainerIO.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/MspImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/MicImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/_version.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImtImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/GifImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PalmImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageQt.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageMath.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PaletteFile.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/FontFile.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PdfParser.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ExifTags.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageCms.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/FpxImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageChops.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/BufrStubImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PSDraw.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PcdImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageFilter.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageDraw2.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImagePath.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/DcxImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/__init__.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/JpegPresets.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/Hdf5StubImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/features.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageDraw.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/GimpGradientFile.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageWin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/IcoImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/_tkinter_finder.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/EpsImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/TgaImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageMorph.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/Jpeg2KImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/WalImageFile.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PcfFontFile.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/BlpImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageTk.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/GbrImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageOps.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PdfImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageShow.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageEnhance.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/WmfImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageGrab.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/WebPImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/FliImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/TiffTags.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/CurImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/_util.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/GdImageFile.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/TiffImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/IptcImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImagePalette.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/BmpImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageTransform.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/IcnsImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/McIdasImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/XpmImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/DdsImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageSequence.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PyAccess.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/_binary.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/Image.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/XVThumbImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/SgiImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PsdImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/JpegImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/ImageFont.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/PpmImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    copying src/PIL/FtexImagePlugin.py -&gt; build/lib.macosx-10.14-x86_64-3.7/PIL\n    running egg_info\n    writing src/Pillow.egg-info/PKG-INFO\n    writing dependency_links to src/Pillow.egg-info/dependency_links.txt\n    writing top-level names to src/Pillow.egg-info/top_level.txt\n    reading manifest file 'src/Pillow.egg-info/SOURCES.txt'\n    reading manifest template 'MANIFEST.in'\n    warning: no files found matching '*.c'\n    warning: no files found matching '*.h'\n    warning: no files found matching '*.sh'\n    no previously-included directories found matching 'docs/_static'\n    warning: no previously-included files found matching '.appveyor.yml'\n    warning: no previously-included files found matching '.coveragerc'\n    warning: no previously-included files found matching '.codecov.yml'\n    warning: no previously-included files found matching '.editorconfig'\n    warning: no previously-included files found matching '.landscape.yaml'\n    warning: no previously-included files found matching '.readthedocs.yml'\n    warning: no previously-included files found matching 'azure-pipelines.yml'\n    warning: no previously-included files found matching 'tox.ini'\n    warning: no previously-included files matching '.git*' found anywhere in distribution\n    warning: no previously-included files matching '*.pyc' found anywhere in distribution\n    warning: no previously-included files matching '*.so' found anywhere in distribution\n    no previously-included directories found matching '.azure-pipelines'\n    no previously-included directories found matching '.travis'\n    writing manifest file 'src/Pillow.egg-info/SOURCES.txt'\n    running build_ext\n    building 'PIL._imaging' extension\n    creating build/temp.macosx-10.14-x86_64-3.7\n    building 'PIL._imagingcms' extension\n    building 'PIL._imagingft' extension\n    building 'PIL._webp' extension\n    creating build/temp.macosx-10.14-x86_64-3.7/src\n    clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/System/Library/Frameworks/Tk.framework/Versions/8.5/Headers -DHAVE_WEBPMUX -I/usr/local/Cellar/freetype/2.10.0/include/freetype2 -I/usr/local/Cellar/openjpeg/2.3.1/include/openjpeg-2.3 -I/private/tmp/pip-req-build-rgrd0jy0/src/libImaging -I/usr/local/Cellar/monoshape/1.0/libexec/include -I/usr/local/include -I/usr/include -I/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/include/python3.7m -c src/_webp.c -o build/temp.macosx-10.14-x86_64-3.7/src/_webp.o\n    clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/System/Library/Frameworks/Tk.framework/Versions/8.5/Headers -I/usr/local/Cellar/freetype/2.10.0/include/freetype2 -I/usr/local/Cellar/openjpeg/2.3.1/include/openjpeg-2.3 -I/private/tmp/pip-req-build-rgrd0jy0/src/libImaging -I/usr/local/Cellar/monoshape/1.0/libexec/include -I/usr/local/include -I/usr/include -I/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/include/python3.7m -c src/_imagingft.c -o build/temp.macosx-10.14-x86_64-3.7/src/_imagingft.o\n    clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/System/Library/Frameworks/Tk.framework/Versions/8.5/Headers -I/usr/local/Cellar/freetype/2.10.0/include/freetype2 -I/usr/local/Cellar/openjpeg/2.3.1/include/openjpeg-2.3 -I/private/tmp/pip-req-build-rgrd0jy0/src/libImaging -I/usr/local/Cellar/monoshape/1.0/libexec/include -I/usr/local/include -I/usr/include -I/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/include/python3.7m -c src/_imagingcms.c -o build/temp.macosx-10.14-x86_64-3.7/src/_imagingcms.o\n    creating build/temp.macosx-10.14-x86_64-3.7/src/libImaging\n    clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/System/Library/Frameworks/Tk.framework/Versions/8.5/Headers -DHAVE_LIBJPEG -DHAVE_OPENJPEG -DHAVE_LIBZ -DHAVE_LIBTIFF -DPILLOW_VERSION=\"6.0.0\" -I/usr/local/Cellar/freetype/2.10.0/include/freetype2 -I/usr/local/Cellar/openjpeg/2.3.1/include/openjpeg-2.3 -I/private/tmp/pip-req-build-rgrd0jy0/src/libImaging -I/usr/local/Cellar/monoshape/1.0/libexec/include -I/usr/local/include -I/usr/include -I/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/include/python3.7m -c src/_imaging.c -o build/temp.macosx-10.14-x86_64-3.7/src/_imaging.o\n    src/_imagingft.c:25:10: fatal error: 'ft2build.h' file not found\n    #include &lt;ft2build.h&gt;\n             ^~~~~~~~~~~~\n    1 error generated.\n    building 'PIL._imagingtk' extension\n    creating build/temp.macosx-10.14-x86_64-3.7/src/Tk\n    clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/System/Library/Frameworks/Tk.framework/Versions/8.5/Headers -Isrc/Tk -I/usr/local/Cellar/freetype/2.10.0/include/freetype2 -I/usr/local/Cellar/openjpeg/2.3.1/include/openjpeg-2.3 -I/private/tmp/pip-req-build-rgrd0jy0/src/libImaging -I/usr/local/Cellar/monoshape/1.0/libexec/include -I/usr/local/include -I/usr/include -I/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/include/python3.7m -c src/_imagingtk.c -o build/temp.macosx-10.14-x86_64-3.7/src/_imagingtk.o\n    clang -bundle -undefined dynamic_lookup -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk build/temp.macosx-10.14-x86_64-3.7/src/_webp.o -L/usr/local/Cellar/monoshape/1.0/libexec/lib -L/usr/local/lib -L/usr/lib -lwebp -lwebpmux -lwebpdemux -o build/lib.macosx-10.14-x86_64-3.7/PIL/_webp.cpython-37m-darwin.so\n    clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/System/Library/Frameworks/Tk.framework/Versions/8.5/Headers -Isrc/Tk -I/usr/local/Cellar/freetype/2.10.0/include/freetype2 -I/usr/local/Cellar/openjpeg/2.3.1/include/openjpeg-2.3 -I/private/tmp/pip-req-build-rgrd0jy0/src/libImaging -I/usr/local/Cellar/monoshape/1.0/libexec/include -I/usr/local/include -I/usr/include -I/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/include/python3.7m -c src/Tk/tkImaging.c -o build/temp.macosx-10.14-x86_64-3.7/src/Tk/tkImaging.o\n    building 'PIL._imagingmath' extension\n    clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/System/Library/Frameworks/Tk.framework/Versions/8.5/Headers -I/usr/local/Cellar/freetype/2.10.0/include/freetype2 -I/usr/local/Cellar/openjpeg/2.3.1/include/openjpeg-2.3 -I/private/tmp/pip-req-build-rgrd0jy0/src/libImaging -I/usr/local/Cellar/monoshape/1.0/libexec/include -I/usr/local/include -I/usr/include -I/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/include/python3.7m -c src/_imagingmath.c -o build/temp.macosx-10.14-x86_64-3.7/src/_imagingmath.o\n    clang -bundle -undefined dynamic_lookup -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk build/temp.macosx-10.14-x86_64-3.7/src/_imagingcms.o -L/usr/local/Cellar/monoshape/1.0/libexec/lib -L/usr/local/lib -L/usr/lib -llcms2 -o build/lib.macosx-10.14-x86_64-3.7/PIL/_imagingcms.cpython-37m-darwin.so\n    building 'PIL._imagingmorph' extension\n    clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/System/Library/Frameworks/Tk.framework/Versions/8.5/Headers -I/usr/local/Cellar/freetype/2.10.0/include/freetype2 -I/usr/local/Cellar/openjpeg/2.3.1/include/openjpeg-2.3 -I/private/tmp/pip-req-build-rgrd0jy0/src/libImaging -I/usr/local/Cellar/monoshape/1.0/libexec/include -I/usr/local/include -I/usr/include -I/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/include/python3.7m -c src/_imagingmorph.c -o build/temp.macosx-10.14-x86_64-3.7/src/_imagingmorph.o\n    clang -bundle -undefined dynamic_lookup -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk build/temp.macosx-10.14-x86_64-3.7/src/_imagingtk.o build/temp.macosx-10.14-x86_64-3.7/src/Tk/tkImaging.o -L/usr/local/Cellar/monoshape/1.0/libexec/lib -L/usr/local/lib -L/usr/lib -o build/lib.macosx-10.14-x86_64-3.7/PIL/_imagingtk.cpython-37m-darwin.so\n    clang -bundle -undefined dynamic_lookup -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk build/temp.macosx-10.14-x86_64-3.7/src/_imagingmorph.o -L/usr/local/Cellar/monoshape/1.0/libexec/lib -L/usr/local/lib -L/usr/lib -o build/lib.macosx-10.14-x86_64-3.7/PIL/_imagingmorph.cpython-37m-darwin.so\n    clang -bundle -undefined dynamic_lookup -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk build/temp.macosx-10.14-x86_64-3.7/src/_imagingmath.o -L/usr/local/Cellar/monoshape/1.0/libexec/lib -L/usr/local/lib -L/usr/lib -o build/lib.macosx-10.14-x86_64-3.7/PIL/_imagingmath.cpython-37m-darwin.so\n    clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/System/Library/Frameworks/Tk.framework/Versions/8.5/Headers -DHAVE_LIBJPEG -DHAVE_OPENJPEG -DHAVE_LIBZ -DHAVE_LIBTIFF -DPILLOW_VERSION=\"6.0.0\" -I/usr/local/Cellar/freetype/2.10.0/include/freetype2 -I/usr/local/Cellar/openjpeg/2.3.1/include/openjpeg-2.3 -I/private/tmp/pip-req-build-rgrd0jy0/src/libImaging -I/usr/local/Cellar/monoshape/1.0/libexec/include -I/usr/local/include -I/usr/include -I/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/include/python3.7m -c src/decode.c -o build/temp.macosx-10.14-x86_64-3.7/src/decode.o\n    In file included from src/decode.c:869:\n    /private/tmp/pip-req-build-rgrd0jy0/src/libImaging/Jpeg2K.h:11:10: fatal error: 'openjpeg.h' file not found\n    #include &lt;openjpeg.h&gt;\n             ^~~~~~~~~~~~\n    1 error generated.\n    error: command 'clang' failed with exit status 1\n  Running setup.py install for Pillow: finished with status 'error'\nCleaning up...\n  Removing source in /private/tmp/pip-req-build-rgrd0jy0\nRemoved build tracker '/private/tmp/pip-req-tracker-6pqza4qj'\nERROR: Command \"/usr/local/Cellar/monoshape/1.0/libexec/bin/python3.7 -u -c 'import setuptools, tokenize;__file__='\"'\"'/private/tmp/pip-req-build-rgrd0jy0/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record /private/tmp/pip-record-1a95g79y/install-record.txt --single-version-externally-managed --compile --install-headers /usr/local/Cellar/monoshape/1.0/libexec/bin/../include/site/python3.7/Pillow\" failed with error code 1 in /private/tmp/pip-req-build-rgrd0jy0/\nException information:\nTraceback (most recent call last):\n  File \"/usr/local/Cellar/monoshape/1.0/libexec/lib/python3.7/site-packages/pip/_internal/cli/base_command.py\", line 178, in main\n    status = self.run(options, args)\n  File \"/usr/local/Cellar/monoshape/1.0/libexec/lib/python3.7/site-packages/pip/_internal/commands/install.py\", line 414, in run\n    use_user_site=options.use_user_site,\n  File \"/usr/local/Cellar/monoshape/1.0/libexec/lib/python3.7/site-packages/pip/_internal/req/__init__.py\", line 58, in install_given_reqs\n    **kwargs\n  File \"/usr/local/Cellar/monoshape/1.0/libexec/lib/python3.7/site-packages/pip/_internal/req/req_install.py\", line 951, in install\n    spinner=spinner,\n  File \"/usr/local/Cellar/monoshape/1.0/libexec/lib/python3.7/site-packages/pip/_internal/utils/misc.py\", line 776, in call_subprocess\n    % (command_desc, proc.returncode, cwd))\npip._internal.exceptions.InstallationError: Command \"/usr/local/Cellar/monoshape/1.0/libexec/bin/python3.7 -u -c 'import setuptools, tokenize;__file__='\"'\"'/private/tmp/pip-req-build-rgrd0jy0/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record /private/tmp/pip-record-1a95g79y/install-record.txt --single-version-externally-managed --compile --install-headers /usr/local/Cellar/monoshape/1.0/libexec/bin/../include/site/python3.7/Pillow\" failed with error code 1 in /private/tmp/pip-req-build-rgrd0jy0/\n/usr/bin/curl --version\n/usr/libexec/java_home --xml --failfast\n/usr/libexec/java_home --xml --failfast\n/usr/local/Homebrew/Library/Homebrew/debrew.rb:13:in `raise'\nBuildError: Failed executing: /usr/local/Cellar/monoshape/1.0/libexec/bin/pip install -v --no-deps --no-binary :all: --ignore-installed /private/tmp/monoshape--Pillow-20190708-31029-1w8theb/Pillow-6.0.0\n</code></pre>\n\n<p><strong>Since macOS Mojave 10.14.5 with Python 3.7 and Homebrew updated</strong>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 3553984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e01a7fca436d77af2dee2a846b930041?s=128&d=identicon&r=PG", "display_name": "Mathieu LeFran&#231;ois", "link": "https://stackoverflow.com/users/3553984/mathieu-lefran%c3%a7ois"}, "is_accepted": true, "score": 0, "last_activity_date": 1562774953, "creation_date": 1562774953, "answer_id": 56974712, "question_id": 56972527, "link": "https://stackoverflow.com/questions/56972527/uncaught-exception-cannot-load-such-file-skiptrace-internal-cruby/56974712#56974712", "title": "Uncaught exception: cannot load such file -- skiptrace/internal/cruby", "body": "<p>I think this is related to <a href=\"https://github.com/gsamokovarov/skiptrace/issues/5\" rel=\"nofollow noreferrer\">https://github.com/gsamokovarov/skiptrace/issues/5</a> ...</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 13, "user_id": 11765398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a992d9eda23a447582f6b8398c2428b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Ranchev", "link": "https://stackoverflow.com/users/11765398/vlad-ranchev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 56974712, "answer_count": 1, "score": 1, "last_activity_date": 1562774953, "creation_date": 1562767657, "last_edit_date": 1562768175, "question_id": 56972527, "link": "https://stackoverflow.com/questions/56972527/uncaught-exception-cannot-load-such-file-skiptrace-internal-cruby", "title": "Uncaught exception: cannot load such file -- skiptrace/internal/cruby", "body": "<p>Need some help with Macos Mojave, ruby-2.6.3 and rails-5.2.3</p>\n\n<p>Can't start rails server cause error:</p>\n\n<p>Uncaught exception: cannot load such file -- skiptrace/internal/cruby\n  /Users/tarasfediv/.rvm/gems/ruby-2.6.3/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in <code>require'\n  /Users/tarasfediv/.rvm/gems/ruby-2.6.3/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in</code>block in require'\n  /Users/tarasfediv/.rvm/gems/ruby-2.6.3/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:257:in `load_dependency'\n...</p>\n"}, {"tags": ["regex", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 2040, "user_id": 10845848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CeMb4.jpg?s=128&g=1", "display_name": "Alexey Sigida", "link": "https://stackoverflow.com/users/10845848/alexey-sigida"}, "edited": false, "score": 0, "creation_date": 1562765030, "post_id": 56971646, "comment_id": 100479879, "body": "Try this : <code>email =~ &#47;^(([A-Za-z0-9]*\\.+_+)|([A-Za-z0-9]+\\-+)|([A-Za-z0-9]+\\+)|([&zwnj;&#8203;A-Za-z0-9]+\\+))*[A-Z&zwnj;&#8203;\u200c\u200ba-z0-9]+@{1}((\\w+\\&zwnj;&#8203;-+)|(\\w+\\.))*\\w{1,63&zwnj;&#8203;}\\.[a-zA-Z]{2,4}$&#47;i</code>"}, {"owner": {"reputation": 11, "user_id": 11047387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3205d4fd2da236dc76edafdc04017f7?s=128&d=identicon&r=PG&f=1", "display_name": "AwsmDev", "link": "https://stackoverflow.com/users/11047387/awsmdev"}, "reply_to_user": {"reputation": 2040, "user_id": 10845848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CeMb4.jpg?s=128&g=1", "display_name": "Alexey Sigida", "link": "https://stackoverflow.com/users/10845848/alexey-sigida"}, "edited": false, "score": 0, "creation_date": 1562765118, "post_id": 56971646, "comment_id": 100479925, "body": "thanks, but I need to put code in my form_tag no? Actually the def isn&#39;t linked to my form_tag search field I think ?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562766586, "post_id": 56971646, "comment_id": 100480668, "body": "<a href=\"https://hackernoon.com/the-100-correct-way-to-validate-email-addresses-7c4818f24643\" rel=\"nofollow noreferrer\">hackernoon.com/&hellip;</a> is an interesting read."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11047387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3205d4fd2da236dc76edafdc04017f7?s=128&d=identicon&r=PG&f=1", "display_name": "AwsmDev", "link": "https://stackoverflow.com/users/11047387/awsmdev"}, "edited": false, "score": 0, "creation_date": 1562917315, "post_id": 56979026, "comment_id": 100537736, "body": "Thank, but with your help, I only can verify the email. I just want to &quot;bypass&quot; the &quot;+&quot; character when the search is sent"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "reply_to_user": {"reputation": 11, "user_id": 11047387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3205d4fd2da236dc76edafdc04017f7?s=128&d=identicon&r=PG&f=1", "display_name": "AwsmDev", "link": "https://stackoverflow.com/users/11047387/awsmdev"}, "edited": false, "score": 0, "creation_date": 1562918839, "post_id": 56979026, "comment_id": 100538523, "body": "It&#39;s not only verifying. Let say you have email <code>test123@gmail.com</code> in your db. Your pass <code>test+123@gmail.com</code> as search params, using <code>User.where(email: correct_email(params[:search]))</code> can find your email @AwsmDev"}, {"owner": {"reputation": 11, "user_id": 11047387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3205d4fd2da236dc76edafdc04017f7?s=128&d=identicon&r=PG&f=1", "display_name": "AwsmDev", "link": "https://stackoverflow.com/users/11047387/awsmdev"}, "edited": false, "score": 0, "creation_date": 1563356110, "post_id": 56979026, "comment_id": 100669311, "body": "Thank you for your help, but where can I insert &#39;User where&#39;? I have to insert it in this line? &quot;&lt;% = text_field_tag: search, params [: search]%&gt;&quot;"}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 1, "last_activity_date": 1562794876, "creation_date": 1562794876, "answer_id": 56979026, "question_id": 56971646, "link": "https://stackoverflow.com/questions/56971646/how-my-form-tag-in-ruby-can-accept-my-def-regex-in-application-helper/56979026#56979026", "title": "How my form_tag in ruby can accept my def REGEX (in application helper)?", "body": "<p>The simplest way to work direct in rails is to correct the email before searching. </p>\n\n<p>In your controller</p>\n\n<pre><code>def correct_email(email)\n  email.gsub(/[^0-9A-Za-z@.]/, '') # only keep 0-9 , A-Z, a-z, '.' and '@'\nend\n</code></pre>\n\n<p>Then </p>\n\n<pre><code>User.where(email: correct_email(params[:search]))\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11047387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3205d4fd2da236dc76edafdc04017f7?s=128&d=identicon&r=PG&f=1", "display_name": "AwsmDev", "link": "https://stackoverflow.com/users/11047387/awsmdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562794876, "creation_date": 1562764793, "last_edit_date": 1562775241, "question_id": 56971646, "link": "https://stackoverflow.com/questions/56971646/how-my-form-tag-in-ruby-can-accept-my-def-regex-in-application-helper", "title": "How my form_tag in ruby can accept my def REGEX (in application helper)?", "body": "<p>I have an email search bar in my page. When I put the <code>+</code> character in my <code>text_field</code>, the email isn't found.</p>\n\n<p>For example, searching for <code>test123@gmail.com</code> works, but searching for <code>test+123@gmail.com</code> doesn't work.</p>\n\n<p>My form code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;%= form_tag users_path, :method =&gt; 'get', local: true, class: 'ui form' do %&gt;\n  &lt;div class=\"fields\"&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= label_tag \"Search by email:\" %&gt;\n      &lt;%= text_field_tag :search, params[:search] %&gt;\n    &lt;/div&gt;\n    &lt;div id=\"search-bar-button-users\", class=\"field\"&gt;\n      &lt;button class=\"ui labeled icon button\"&gt;\n        &lt;i class=\"search icon\"&gt;&lt;/i&gt;\n          Search\n        &lt;/button&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>My ApplicationHelper:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def is_a_valid_email?(email)\n  (email =~ /^(([A-Za-z0-9]*\\.+*_+)|([A-Za-z0-9]+\\-+)|([A-Za-z0-9]+\\+)|([A-Za-z0-9]+\\+))*[A-Z\u200c\u200ba-z0-9]+@{1}((\\w+\\-+)|(\\w+\\.))*\\w{1,63}\\.[a-zA-Z]{2,4}$/i)\nend \n</code></pre>\n\n<p>I would like the search bar to ignore the <code>+</code> and still find the email.</p>\n"}, {"tags": ["ruby", "algorithm", "random", "language-agnostic", "combinations"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562766466, "post_id": 56971534, "comment_id": 100480603, "body": "I&#39;m not sure but it could be related to the Knapsack problem (<a href=\"https://en.wikipedia.org/wiki/Knapsack_problem\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Knapsack_problem</a>). If that&#39;s true, it&#39;s expected for your program to fail with large input. You could try dynamic programming <a href=\"https://en.wikipedia.org/wiki/Knapsack_problem#Solving\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Knapsack_problem#Solving</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562795115, "post_id": 56971534, "comment_id": 100494007, "body": "@Eric, I assume you are referring to the construction of the state space from which random selections would be made. Deep in my bones I believe this to be NP-complete, not amenable, therefore, to the use of dynamic programming. For a DP solution to apply one must identify the state-space and recursive calculations that would be employed. I don&#39;t see the fit."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1562795566, "post_id": 56971534, "comment_id": 100494131, "body": "Dennis, I believe your only recourse is to enumerate combinations of hashes and keep only those that pass all the tests (from which you would sample), meaning that computation time would increase exponentially with the number of hashes (but would not depend on the numbers of requirements you impose). I would be surprised if you could could select all valid combinations in reasonable time if there were more than 15+- hashes (much less 1,000)."}], "owner": {"reputation": 37, "user_id": 5360070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c43398aed190964f241c4d6b60042290?s=128&d=identicon&r=PG", "display_name": "Denis sellu", "link": "https://stackoverflow.com/users/5360070/denis-sellu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562764428, "creation_date": 1562764428, "question_id": 56971534, "link": "https://stackoverflow.com/questions/56971534/finding-a-combination-of-hashes-to-match-a-desired-percentage-distribution-of-va", "title": "Finding a combination of hashes to match a desired percentage distribution of values", "body": "<p>Given an array of hashes, I am looking for a a way to select a random subset of these hashes, such that the distribution of attributes of the subset matches desired percentages.</p>\n\n<p>For example, given the following array:</p>\n\n<pre><code>[\n  {\n    question_id: 1,\n    grade: 1,\n    marks: [\n      { topic: 'number', ao: 1 },\n      { topic: 'ratios', ao: 2 }\n    ]\n  },\n  {\n    question_id: 2,\n    grade: 3,\n    marks: [\n      { topic: 'number', ao: 2 },\n      { topic: 'number', ao: 2 }\n    ]\n  },\n  {\n    question_id: 3,\n    grade: 2,\n    marks: [\n      { topic: 'number', ao: 1 },\n      { topic: 'geometry', ao: 1 },\n      { topic: 'ratios', ao: 1 },\n      { topic: 'number', ao: 2 },\n      { topic: 'geometry', ao: 2 }\n    ]\n  },\n  {\n    question_id: 4,\n    grade: 3,\n    marks: [\n      { topic: 'number', ao: 1 },\n      { topic: 'ratios', ao: 2 },\n      { topic: 'geometry', ao: 2 },\n      { topic: 'geometry', ao: 2 }\n    ]\n  },\n  {\n    question_id: 5,\n    grade: 1,\n    marks: [\n      { topic: 'ratios', ao: 1 },\n      { topic: 'ratios', ao: 2 }\n    ]\n  },\n  {\n    question_id: 6,\n    grade: 1,\n    marks: [\n      { topic: 'number', ao: 1 },\n      { topic: 'number', ao: 2 },\n      { topic: 'number', ao: 2 },\n      { topic: 'ratios', ao: 2 }\n    ]\n  },\n  {\n    question_id: 7,\n    grade: 3,\n    marks: [\n      { topic: 'number', ao: 2 }\n    ]\n  },\n  {\n    question_id: 8,\n    grade: 3,\n    marks: [\n      { topic: 'geometry', ao: 1 }\n    ]\n  }\n]\n</code></pre>\n\n<p>I would like the find a random combination that satisfies the following:</p>\n\n<p>Total number of marks = 10</p>\n\n<p>50% of the marks are topic number<br>\n20% of the marks are topic ratios<br>\n30% of the marks are topic geometry  </p>\n\n<p>40% of the marks are grade 1<br>\n50% of the marks are grade 2<br>\n10% of the marks are grade 3  </p>\n\n<p>50% of the marks are ao 1<br>\n50% of the marks are ao 2  </p>\n\n<p>An example outcome that satisfies these requirements is:</p>\n\n<pre><code>[\n  {\n    question_id: 3,\n    grade: 2,\n    marks: [\n      { topic: 'number', ao: 1 },\n      { topic: 'geometry', ao: 1 },\n      { topic: 'ratios', ao: 1 },\n      { topic: 'number', ao: 2 },\n      { topic: 'geometry', ao: 2 }\n    ]\n  },\n  {\n    question_id: 6,\n    grade: 1,\n    marks: [\n      { topic: 'number', ao: 1 },\n      { topic: 'number', ao: 2 },\n      { topic: 'number', ao: 2 },\n      { topic: 'ratios', ao: 2 }\n    ]\n  },\n  {\n    question_id: 8,\n    grade: 3,\n    marks: [\n      { topic: 'geometry', ao: 1 }\n    ]\n  }\n]\n</code></pre>\n\n<p>Ideally, if a combination did not exist to satisfy these requirements (with some degree of tolerance), I would expect to receive an error.</p>\n\n<p>My initial approach to the problem was to find find all the possible combinations of questions which would sum to 10 marks total, and then iterate through these combinations and check each to see if it satisfied all of other the requirements.</p>\n\n<p>I started with this algorithm that finds all possible combinations of numbers from an array to sum to a desired total:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def subset_sum(numbers, target, partial=[], result=[])\n    s = partial.inject 0, :+\n\n    if s == target\n      result &lt;&lt; partial\n    end\n\n    return if s &gt;= target\n\n    (0..(numbers.length - 1)).each do |i|\n      n = numbers[i]\n      remaining = numbers.drop(i+1)\n      subset_sum(remaining, target, partial + [n], result)\n    end\n\n    result\n  end\nend\n</code></pre>\n\n<p>However in the real application of my problem I expect the array of questions to have a length over 1000, and total number of marks equal to 40. For these numbers this solution is far too under optimized and the runtime is very long.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "domain-driven-design", "autoload", "bounded-contexts"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1562770636, "post_id": 56971450, "comment_id": 100483145, "body": "If you drop the config setting, and stick the <code>identify</code> folder inside of rails root <code>app</code>, it will auto load them and allow you to wrap the Identity module/namespace around them"}, {"owner": {"reputation": 3908, "user_id": 322863, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cff6feb283b9f194892e8f6737eed875?s=128&d=identicon&r=PG", "display_name": "aef", "link": "https://stackoverflow.com/users/322863/aef"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 1, "creation_date": 1562770781, "post_id": 56971450, "comment_id": 100483218, "body": "Which is what I intended to avoid. I would like separate my bounded contexts clearly and have them visible on the root directory level. And the relevant files right in these directories."}], "owner": {"reputation": 3908, "user_id": 322863, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cff6feb283b9f194892e8f6737eed875?s=128&d=identicon&r=PG", "display_name": "aef", "link": "https://stackoverflow.com/users/322863/aef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1562769601, "creation_date": 1562764194, "last_edit_date": 1562769601, "question_id": 56971450, "link": "https://stackoverflow.com/questions/56971450/autoload-classes-with-namespaces-defined-by-lookup-path-in-rails", "title": "Autoload classes with namespaces defined by lookup path in Rails", "body": "<p>I am trying to build a Rails 5.2.x application that closely resembles the structure of bounded contexts according to Domain-driven Design.</p>\n\n<p>Given that <code>identity</code> is the name of a bounded context which contains the entities <code>user</code> and <code>group</code>, I would like to have a directory structure like this:</p>\n\n<pre><code>&lt;RAILS ROOT&gt;/identity/user.rb\n&lt;RAILS ROOT&gt;/identity/group.rb\n</code></pre>\n\n<p>I would like these to contain the classes <code>Identity::User</code> and <code>Identity::Group</code> respectively.</p>\n\n<p>Inspired by the <code>bounded_context</code> gem, I added the following line to my <code>application.rb</code>:</p>\n\n<pre><code>config.paths.add 'identity', eager_load: true\n</code></pre>\n\n<p>Sadly, this doesn't really match what I had in mind. Using this approach, Rails seems to require me to setup the directory structure like this:</p>\n\n<pre><code>&lt;RAILS ROOT&gt;/identity/identity/user.rb\n&lt;RAILS ROOT&gt;/identity/identity/group.rb\n</code></pre>\n\n<p>Which is not exactly what I had in mind.</p>\n\n<p>Is there a way to make Rails' autoloader understand, that all the files in my path already are within the namespace <code>Identity</code>, so I don't have to reflect this in the directory structure again?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 6, "creation_date": 1562765910, "post_id": 56971409, "comment_id": 100480306, "body": "The docs for <a href=\"http://ruby-doc.org/core-2.6.3/doc/syntax/assignment_rdoc.html#label-Local+Variables+and+Methods\" rel=\"nofollow noreferrer\">Assignment</a> mention it briefly: <i>&quot;The local variable is created when the parser encounters the assignment, not when the assignment occurs&quot;</i>"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1562766110, "post_id": 56971409, "comment_id": 100480398, "body": "It&#39;s a weird behavior indeed. You could use the <a href=\"https://ruby-doc.org/core-2.6.3/Kernel.html#method-i-Integer\" rel=\"nofollow noreferrer\"><code>Kernel#Integer</code></a>  method and write <code>capture = Integer(capture)</code> to make sure it fails when <code>capture</code> doesn&#39;t look like an integer : <code>&quot;5.3&quot;</code>, <code>nil</code> or <code>&quot;&quot;</code> for example."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1562766146, "post_id": 56971409, "comment_id": 100480412, "body": "BTW, calling <code>to_i</code> even if the receiver could be <code>nil</code> might not be the best approach. Can you show more of your code? There&#39;s probably a cleaner way to solve this."}, {"owner": {"reputation": 1038, "user_id": 734750, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/ByU6z.jpg?s=128&g=1", "display_name": "popedotninja", "link": "https://stackoverflow.com/users/734750/popedotninja"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1562767796, "post_id": 56971409, "comment_id": 100481418, "body": "@EricDuminil The tip about <code>Interger(foo)</code> is super useful, thanks.  That helped quite a bit to simplify the code.  I am already using it :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1562796381, "post_id": 56971409, "comment_id": 100494362, "body": "The link given by @Stefan contains a goldmine of information and is very well-written, worth a careful read by all Rubyists."}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 14, "last_activity_date": 1562833030, "last_edit_date": 1562833030, "creation_date": 1562764301, "answer_id": 56971484, "question_id": 56971409, "link": "https://stackoverflow.com/questions/56971409/in-ruby-for-an-undefined-variable-foo-why-doesnt-foo-foo-raise-an-error/56971484#56971484", "title": "In Ruby, for an undefined variable &quot;foo&quot;, why doesn&#39;t &quot;foo = foo&quot; raise an error?", "body": "<p>Ruby has this weird <em>feature</em> that it hoists variables when they're declared:</p>\n\n<blockquote>\n  <p>This means that when the parser sees x=1, it will actually declare the variable, by assigning it to nil and let the interpreter then figure out if the x = 1 line will ever get executed.</p>\n</blockquote>\n\n<p><a href=\"https://ieftimov.com/post/variable-hoisting-ruby/\" rel=\"nofollow noreferrer\">source</a></p>\n\n<p>So when you write</p>\n\n<pre><code>a = a.to_i\n</code></pre>\n\n<p>it first declare <code>a = nil</code> then calls <code>to_i</code> on it and the assigns:</p>\n\n<pre><code>a = nil\na = a.to_i\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>It also works like that in other cases, e.g. with <code>if</code>:</p>\n\n<pre><code>pry&gt; b\nNameError: undefined local variable or method `b' for main:Object\nfrom (pry):30:in `__pry__'\npry&gt; b if b.nil?\nNameError: undefined local variable or method `b' for main:Object\nfrom (pry):31:in `__pry__'\npry&gt; b = 1 if b.nil?\n#=&gt; 1\npry&gt; b\n#=&gt; 1\n</code></pre>\n\n<p>and (example from the linked blogpost):</p>\n\n<pre><code>if false\n  x = 1\nend\nputs x.class\n# NilClass\n</code></pre>\n"}], "owner": {"reputation": 1038, "user_id": 734750, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/ByU6z.jpg?s=128&g=1", "display_name": "popedotninja", "link": "https://stackoverflow.com/users/734750/popedotninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1562833030, "creation_date": 1562764065, "last_edit_date": 1562766540, "question_id": 56971409, "link": "https://stackoverflow.com/questions/56971409/in-ruby-for-an-undefined-variable-foo-why-doesnt-foo-foo-raise-an-error", "title": "In Ruby, for an undefined variable &quot;foo&quot;, why doesn&#39;t &quot;foo = foo&quot; raise an error?", "body": "<p>When <code>foo</code> is an undefined variable, attempting to access it raises a <code>NameError</code>:</p>\n\n<pre><code>foo\n#=&gt; NameError: undefined local variable or method `foo'\n\na = foo\n#=&gt; NameError: undefined local variable or method `foo'\n</code></pre>\n\n<p>Why doesn't <code>foo = foo</code> raise a <code>NameError</code>?</p>\n\n<pre><code>foo = foo\n#=&gt; nil\n</code></pre>\n\n<p>Yesterday, it took me hours to track down this line as the bug in a program...</p>\n\n<pre><code>capture = capture.to_i\n</code></pre>\n\n<p>What I had intended to do was convert <code>capture_str</code> to an <code>Integer</code>.  What I had done instead was introduce a <code>nil</code> by saying <code>capture = capture</code>, and then turning that nil into a <code>0</code>.  So I was doing this...</p>\n\n<pre><code>capture = capture.to_i\n#=&gt; 0\n</code></pre>\n\n<p>But I had been incorrectly assuming that a variable <code>NameError</code> would have been thrown, like this...</p>\n\n<pre><code>capture = capture_str.to_i\n#=&gt; NameError: undefined local variable or method `capture_str'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "performance", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 0, "last_activity_date": 1562761388, "creation_date": 1562761388, "answer_id": 56970615, "question_id": 56970569, "link": "https://stackoverflow.com/questions/56970569/after-using-require-false-in-gems-do-i-have-to-load-gem-again-and-again-whereve/56970615#56970615", "title": "After using require false in gems, do i have to load gem again and again wherever i need or it will be cached?", "body": "<p>Use <code>require</code> to not <code>load</code> to get the gems in you app and they'll be loaded only once.</p>\n\n<p>See more: <a href=\"http://hiteshrawal.blogspot.com/2011/12/ruby-require-vs-load.html\" rel=\"nofollow noreferrer\">http://hiteshrawal.blogspot.com/2011/12/ruby-require-vs-load.html</a></p>\n"}], "owner": {"reputation": 23, "user_id": 11763699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653e65fffbbea4103b9dd8e13d6f84c9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohaib", "link": "https://stackoverflow.com/users/11763699/zohaib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 56970615, "answer_count": 1, "score": 1, "last_activity_date": 1562761388, "creation_date": 1562761200, "question_id": 56970569, "link": "https://stackoverflow.com/questions/56970569/after-using-require-false-in-gems-do-i-have-to-load-gem-again-and-again-whereve", "title": "After using require false in gems, do i have to load gem again and again wherever i need or it will be cached?", "body": "<p>Due to slow server boot time issue I want to use require false with gems which I don't want to load during server start and then I will load them wherever I need those gems code. \nBut  want to ask, gem will get load again and again in every file where I need them or load only once and then use it from cache (I have enabled cached).</p>\n"}, {"tags": ["sql", "ruby", "rest", "ruby-on-rails-3", "mysql2"], "answers": [{"tags": [], "owner": {"reputation": 279, "user_id": 1939534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1440b992011864dc67e329354d16a2?s=128&d=identicon&r=PG", "display_name": "Piyush Awasthi", "link": "https://stackoverflow.com/users/1939534/piyush-awasthi"}, "is_accepted": false, "score": 2, "last_activity_date": 1562758109, "creation_date": 1562758109, "answer_id": 56969766, "question_id": 56969322, "link": "https://stackoverflow.com/questions/56969322/how-do-i-retrieve-a-random-get-request-in-ruby-on-rails-5/56969766#56969766", "title": "How do I retrieve a random GET request in Ruby on Rails 5?", "body": "<p>You can do that in Model as well as controller.</p>\n\n<p>Model:</p>\n\n<pre><code>class Model &lt; ApplicationRecord\n  def self.random\n   Model.limit(1).order(\"RANDOM()\").first\n  end\nend\n</code></pre>\n\n<p>Controller: In method show</p>\n\n<pre><code>def show\n   render json: Model.find_by(id: params[:id]) || Model.random\nend\n</code></pre>\n\n<p>I hope that helpful.</p>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1562762178, "creation_date": 1562762178, "answer_id": 56970857, "question_id": 56969322, "link": "https://stackoverflow.com/questions/56969322/how-do-i-retrieve-a-random-get-request-in-ruby-on-rails-5/56970857#56970857", "title": "How do I retrieve a random GET request in Ruby on Rails 5?", "body": "<p>I would configure a <code>quotes/random</code> <a href=\"https://guides.rubyonrails.org/routing.html#adding-collection-routes\" rel=\"nofollow noreferrer\">collection route</a>:</p>\n\n<pre><code># in config/routes.rb\nresources :quote do\n  get 'random', on: :collection\nend\n</code></pre>\n\n<p>and use a controller method like this:</p>\n\n<pre><code># in controllers/quotes_controller.rb\ndef random\n  @quote = Quote.order('RAND()').first\n  render :show\nend\n</code></pre>\n\n<p>Please note: Returning a single random row from a table is <a href=\"https://stackoverflow.com/a/19419/2483313\">database specific</a> \u2013 for MySQL </p>\n\n<pre><code>ORDER BY RAND() LIMIT 1\n</code></pre>\n\n<p>seems to be the way to go.</p>\n"}], "owner": {"reputation": 13, "user_id": 11101678, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pp3cmrDASmg/AAAAAAAAAAI/AAAAAAAAACk/cnj2emwjAcI/photo.jpg?sz=128", "display_name": "Distant Nebula", "link": "https://stackoverflow.com/users/11101678/distant-nebula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 56970857, "answer_count": 2, "score": 1, "last_activity_date": 1562762178, "creation_date": 1562756581, "question_id": 56969322, "link": "https://stackoverflow.com/questions/56969322/how-do-i-retrieve-a-random-get-request-in-ruby-on-rails-5", "title": "How do I retrieve a random GET request in Ruby on Rails 5?", "body": "<p>I've created my REST API based on Michael Scott from the Office, so far if you go onto the main part of the API it displays all the quotes /api/v1/quotes/ and you can get individual ones if you add an id number such as /api/v1/quotes/5,but I want users to be able to get a random quote when they put in a GET request.</p>\n\n<p>This would preferably be done with an extra part of the URL such as /api/v1/quotes/random.</p>\n\n<p>I've looked at a lot online but I can't figure this out. Do I put my code into the quotes controller and create another function or do I have to put this somewhere else such as routes.db? Also do I put in the SQL function of RANDOM or is there a better and more efficient way to randomise it. My database only has 50 records in it and it's done in mysql2.</p>\n\n<p>Thanks in advance.</p>\n\n<p>It's my first time posting here as usually I hate asking for help as I think I can always figure it out myself but I'm extremely new to Ruby so I'm fairly clueless on how to solve this. If you need me to clarify my question then just let me know.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "post", "parameters"], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562762130, "post_id": 56969463, "comment_id": 100478140, "body": "Thanks for the suggestion, unfortunately it doesn&#39;t seem to work for me. Running <code>params.to_h.select{|key, value| key =~ &#47;^prop&#47;}</code> returns nothings"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562762707, "post_id": 56969463, "comment_id": 100478485, "body": "could you post the content of <code>params</code>?"}, {"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562762885, "post_id": 56969463, "comment_id": 100478598, "body": "<code>{&quot;utf8&quot;=&gt;&quot;\u2713&quot;,  &quot;_method&quot;=&gt;&quot;put&quot;,  &quot;authenticity_token&quot;=&gt;&quot;xxxxx&quot;,  &quot;userEmails&quot;=&gt;&quot;teste@test.com,test2@test.com,test4@test.com,&zwnj;&#8203;fasd@gmail.com&quot;,  &quot;propProperty1checkbox&quot;=&gt;&quot;on&quot;,  &quot;propProperty1&quot;=&gt;&quot;3&quot;,  &quot;propAnotherPropertycheckbox&quot;=&gt;&quot;on&quot;,  &quot;propAnotherProperty&quot;=&gt;&quot;4&quot;,  &quot;commit&quot;=&gt;&quot;Submit&quot;,  &quot;Application&quot;=&gt;&quot;8&quot;,  &quot;Company&quot;=&gt;&quot;1&quot; }</code>"}, {"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562764217, "post_id": 56969463, "comment_id": 100479364, "body": "This is interesting. I agree that it works when running it all at once <code>{&quot;utf8&quot;=&gt;&quot;\u2713&quot;, &quot;_method&quot;=&gt;&quot;put&quot;, &quot;authenticity_token&quot;=&gt;&quot;xxxxx&quot;, &quot;userEmails&quot;=&gt;&quot;teste@test.com,test2@test.com,test4@test.com,&zwnj;&#8203;fasd@gmail.com&quot;, &quot;propProperty1checkbox&quot;=&gt;&quot;on&quot;, &quot;propProperty1&quot;=&gt;&quot;3&quot;, &quot;propAnotherPropertycheckbox&quot;=&gt;&quot;on&quot;, &quot;propAnotherProperty&quot;=&gt;&quot;4&quot;, &quot;commit&quot;=&gt;&quot;Submit&quot;, &quot;Application&quot;=&gt;&quot;8&quot;, &quot;Company&quot;=&gt;&quot;1&quot; }.to_h.select{|k, v| k =~ &#47;^prop&#47;}</code>  However it seems when trying to run it straight from params it does not work for some reason"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562764344, "post_id": 56969463, "comment_id": 100479443, "body": "Try with <code>{|key, value| key.to_s =~ &#47;^prop&#47;}</code>"}, {"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562764514, "post_id": 56969463, "comment_id": 100479554, "body": "Still getting the same output <code>params.to_h.select{|key, value| key.to_s =~ &#47;^prop&#47;} =&gt; {}</code>"}, {"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562764746, "post_id": 56969463, "comment_id": 100479706, "body": "<code>params.to_a =&gt; [[&quot;utf8&quot;, &quot;\u2713&quot;],  [&quot;_method&quot;, &quot;put&quot;],  [&quot;authenticity_token&quot;, &quot;xxxxx&quot;],  [&quot;userEmails&quot;, &quot;teste@test.com,test2@test.com,test4@test.com,fasd@gmail.com&zwnj;&#8203;&quot;],  [&quot;propProperty1checkbox&quot;, &quot;on&quot;],  [&quot;propProperty1&quot;, &quot;5&quot;],  [&quot;propAnotherPropertycheckbox&quot;, &quot;on&quot;],  [&quot;propAnotherProperty&quot;, &quot;9&quot;],  [&quot;commit&quot;, &quot;Submit&quot;],  [&quot;Application&quot;, &quot;8&quot;],  [&quot;Company&quot;, &quot;1&quot;]]</code>"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562764803, "post_id": 56969463, "comment_id": 100479739, "body": "I have no idea then :|"}, {"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562764914, "post_id": 56969463, "comment_id": 100479804, "body": "No problem, I&#39;ll try work with what you gave me. Must just be a small thing! Thanks for the help!"}, {"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562766452, "post_id": 56969463, "comment_id": 100480596, "body": "Got it! Just had to remove.<code>to_h</code>!  <code>params.select{|key, value| key.to_s =~ &#47;^prop&#47;}</code> works perfectly!"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1562763367, "last_edit_date": 1562763367, "creation_date": 1562757075, "answer_id": 56969463, "question_id": 56969195, "link": "https://stackoverflow.com/questions/56969195/access-params-with-wildcard-in-rails/56969463#56969463", "title": "Access params with wildcard in Rails", "body": "<p>You can use <code>#select</code> on <code>params</code> hash to filter only the params that are interesting for you:</p>\n\n<pre><code>params = {\"user_id\"=&gt;1, \n \"propProperty1checkbox\"=&gt;\"on\",                                                                                   \n \"propProperty1\"=&gt;\"testing\",                                                                                      \n \"propAnotherPropertycheckbox\"=&gt;\"on\",                                                                             \n \"propAnotherProperty\"=&gt;\"another test value\"\n}\nparams.to_h.select{|key, value| key =~ /^prop/}\n#=&gt; {\"propProperty1checkbox\"=&gt;\"on\",\n#\"propProperty1\"=&gt;\"testing\",\n#\"propAnotherPropertycheckbox\"=&gt;\"on\",\n#\"propAnotherProperty\"=&gt;\"another test value\"}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Example from the comment:</p>\n\n<pre><code>[13] pry(main)&gt; {\"utf8\"=&gt;\"\u2713\", \"_method\"=&gt;\"put\", \"authenticity_token\"=&gt;\"xxxxx\", \"userEmails\"=&gt;\"teste@test.com,test2@test.com,test4@test.com,fasd@gmail.com\", \"propProperty1checkbox\"=&gt;\"on\", \"propProperty1\"=&gt;\"3\", \"propAnotherPropertycheckbox\"=&gt;\"on\", \"propAnotherProperty\"=&gt;\"4\", \"commit\"=&gt;\"Submit\", \"Application\"=&gt;\"8\", \"Company\"=&gt;\"1\" }.to_h.select{|k, v| k =~ /^prop/}\n=&gt; {\"propProperty1checkbox\"=&gt;\"on\",\n \"propProperty1\"=&gt;\"3\",\n \"propAnotherPropertycheckbox\"=&gt;\"on\",\n \"propAnotherProperty\"=&gt;\"4\"}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562762991, "post_id": 56969487, "comment_id": 100478662, "body": "Thanks for the suggestion, I&#39;ve now edited my code to <code>-@all_properties.each do |prop|     %input{:name =&gt; &quot;prop[prop.name][checkbox]&quot;, :type =&gt; &quot;checkbox&quot;, :id =&gt; &quot;prop&quot;+prop.name+&quot;checkbox&quot;}     #{prop.name}     %input{:name =&gt; &quot;prop[prop.name][text]&quot;, :type =&gt; &quot;text&quot;, :id =&gt; &quot;prop&quot;+prop.name}</code>  When posting the form, my params[:prop] only seems to store the data for the last input like <code>&quot;prop&quot;=&gt;{&quot;prop.name&quot;=&gt;{&quot;checkbox&quot;=&gt;&quot;on&quot;, &quot;text&quot;=&gt;&quot;2&quot;}}</code>"}, {"owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "reply_to_user": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1562826949, "post_id": 56969487, "comment_id": 100501194, "body": "You need text interpolation:  <code>:name =&gt; &quot;prop[#{prop.name}][checkbox]&quot;</code>"}], "tags": [], "owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "is_accepted": false, "score": 1, "last_activity_date": 1562757193, "creation_date": 1562757193, "answer_id": 56969487, "question_id": 56969195, "link": "https://stackoverflow.com/questions/56969195/access-params-with-wildcard-in-rails/56969487#56969487", "title": "Access params with wildcard in Rails", "body": "<p>You can try something like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>input(name: \"props[#{pro_name}][checkbox]\"...)\ninput(name: \"props[#{pro_name}][text]\"...)\n</code></pre>\n\n<p>Then, in your controller:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def method\n  props = params[:props]\n  props.each do |property_name, values|\n    chk = values[:checkbox]\n    text = values[:text]\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 56969463, "answer_count": 2, "score": 0, "last_activity_date": 1562764629, "creation_date": 1562756141, "last_edit_date": 1562764629, "question_id": 56969195, "link": "https://stackoverflow.com/questions/56969195/access-params-with-wildcard-in-rails", "title": "Access params with wildcard in Rails", "body": "<p>At the moment I have a form_tag which contains inputs and puts these inputs into parameters. \nI want to be able to loop over them in the controller action.</p>\n\n<p>I've tried getting all <code>params</code> excluding all the usual <code>params</code> (action, controller, model name etc.) and then using a wildcard like <code>params[:prop*]</code>.</p>\n\n<p>Here is the offending form inputs:</p>\n\n<pre><code>%input{:name =&gt; \"userEmails\", :id =&gt;\"userEmails\", :type =&gt; \"hidden\", :value =&gt; \"\"}\n  -@all_properties.each do |prop|\n    %input{:name =&gt; \"prop\"+prop.name+\"checkbox\", :type =&gt; \"checkbox\", :id =&gt; \"prop\"+prop.name+\"checkbox\"}\n    #{prop.name}\n    %input{:name =&gt; \"prop\"+prop.name, :type =&gt; \"text\", :id =&gt; \"prop\"+prop.name}\n</code></pre>\n\n<p>These show up in params like <code>{\"propProperty1checkbox\"=&gt;\"on\", \"propProperty1\" =&gt; \"testing\", \"propAnotherPropertycheckbox\" =&gt; \"on\", \"propAnotherProperty\" =&gt; \"another test value\"}</code> etc.</p>\n\n<p>I'm unsure how to access these as the names of the properties can change and so need to be accessed abstractly.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1562763352, "post_id": 56968647, "comment_id": 100478858, "body": "Where is this code coming from? I hope it&#39;s an example of what <i>not</i> to do in Ruby."}, {"owner": {"reputation": 153, "user_id": 7140795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92e2fdf7740ae782f0e0cea386e47aeb?s=128&d=identicon&r=PG&f=1", "display_name": "RosLuP", "link": "https://stackoverflow.com/users/7140795/roslup"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562775605, "post_id": 56968647, "comment_id": 100485966, "body": "That is only the start of the function, it continue using all arguments..."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562775955, "post_id": 56968647, "comment_id": 100486132, "body": "Ouch. Has it been minified? What&#39;s the purpose of this lambda?"}, {"owner": {"reputation": 153, "user_id": 7140795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92e2fdf7740ae782f0e0cea386e47aeb?s=128&d=identicon&r=PG&f=1", "display_name": "RosLuP", "link": "https://stackoverflow.com/users/7140795/roslup"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562776584, "post_id": 56968647, "comment_id": 100486434, "body": "@EricDuminil gain one or two characters in a codegolf competition..."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562778438, "post_id": 56968647, "comment_id": 100487271, "body": "If it were for golfing, you could remove all the whitespaces: <code>-&gt;a,b,c,d,e,f,g,h,i,j{l=-&gt;s,t=c{Math.log(s,t)}}</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1562796917, "post_id": 56968647, "comment_id": 100494479, "body": "I find it curious that, while this question is on hold as unclear what is being asked, it has to date received three upvotes, suggesting that at least three readers not only  understand it, but think it&#39;s a good question.  (I&#39;m in the &quot;have no idea&quot; camp.)"}], "answers": [{"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562759250, "post_id": 56969109, "comment_id": 100476568, "body": "For which code did you write the simplified version? It doesn&#39;t seem to match OP&#39;s code or your first example."}, {"owner": {"reputation": 703, "user_id": 3275627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sFsXG.jpg?s=128&g=1", "display_name": "Jonathan Duarte", "link": "https://stackoverflow.com/users/3275627/jonathan-duarte"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562762087, "post_id": 56969109, "comment_id": 100478112, "body": "Simplified version of the concept, not the code itself."}], "tags": [], "owner": {"reputation": 703, "user_id": 3275627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sFsXG.jpg?s=128&g=1", "display_name": "Jonathan Duarte", "link": "https://stackoverflow.com/users/3275627/jonathan-duarte"}, "is_accepted": false, "score": 5, "last_activity_date": 1562755824, "creation_date": 1562755824, "answer_id": 56969109, "question_id": 56968647, "link": "https://stackoverflow.com/questions/56968647/arguments-of-one-anonymous-function-in-ruby/56969109#56969109", "title": "arguments of one anonymous function in Ruby", "body": "<p>The first part: <code>-&gt; a, b, c, d, e, f, g, h, i, j { ... }</code> is declaration of a lambda, or anonymous function.</p>\n\n<p>where a,b,c... and so on are arguments to be passed as variables inside the block <code>{..}</code></p>\n\n<p>This is the same as: <code>lambda { |a,b,c,...j| ... }</code></p>\n\n<p>You can see a similar example here:</p>\n\n<pre><code>ex1 = -&gt; a,b,c,d {\n  puts a;\n  puts b;\n  puts c;\n}\n\nex1.call('1', '2', '3', '4');\n</code></pre>\n\n<p>Then it returns another lambda inside of it:</p>\n\n<p>l = <code>-&gt;</code> s, t = c {Math.log(s, t)</p>\n\n<p>as denoted by the <code>-&gt;</code> symbol, and defaults <code>t</code> argument to previously supplied <code>c</code> arg in the outer lambda.</p>\n\n<p>Finally it call Math.log on s and t arguments from the inner lambda.</p>\n\n<p>Here's a simplified version:</p>\n\n<pre><code>ex2 = -&gt; a,b { c = -&gt; d, e = b { puts d; puts e } }\n\nex2.call(1,2).call(3) # e is optional since it's defaulted to b\n# =&gt; 3,2\n</code></pre>\n\n<p>Note: Your code is missing some <code>}</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 4, "last_activity_date": 1562759601, "last_edit_date": 1562759601, "creation_date": 1562758653, "answer_id": 56969909, "question_id": 56968647, "link": "https://stackoverflow.com/questions/56968647/arguments-of-one-anonymous-function-in-ruby/56969909#56969909", "title": "arguments of one anonymous function in Ruby", "body": "<p>To be honest, this code is absolutely horrible. I'd be surprised to learn that there's only one bug.</p>\n\n<p>Here's a rewrite:</p>\n\n<pre><code>weird_log = lambda do |_, _, default_base, _, _, _, _, _, _, _|\n  lambda do |x, base=default_base|\n    Math.log(x, base)\n  end\nend\n</code></pre>\n\n<p>It's a bit more readable and it makes it clear that the method signature is useless. In the original code, only <code>c</code> is used from the 10 original arguments. </p>\n\n<p><code>a, b, d, e, f, g, h, i, j</code> aren't used so they can be renamed to <code>_</code>. They need to be specified, though, even if they aren't used:</p>\n\n<pre><code>weird_log.call(nil, nil, 10)\n#=&gt; ArgumentError: wrong number of arguments (given 3, expected 10)\nweird_log.call(nil, nil, 10, nil, nil, nil, nil, nil, nil, nil)\n#=&gt; #&lt;Proc:0x00000000031e57c8@(pry):9 (lambda)&gt;\nweird_log.call(nil, nil, 10, nil, nil, nil, nil, nil, nil, nil).call(100)\n#=&gt; 2.0\nweird_log.call(nil, nil, 10, nil, nil, nil, nil, nil, nil, nil).call(100, Math::E)\n# =&gt; 4.605170185988092\n</code></pre>\n\n<p>A less cryptic way would be to write:</p>\n\n<pre><code>def my_log(base = Math::E)\n  -&gt;(x) { Math.log(x, base) }\nend\n</code></pre>\n\n<p>It can be used this way:</p>\n\n<pre><code>log10 = my_log(10)\n# =&gt; #&lt;Proc:0x000000000222d2b8@(irb):2 (lambda)&gt; \nlog10.call(100)\n# =&gt; 2.0\nnatural_log = my_log\n#=&gt; #&lt;Proc:0x0000000002243540@(irb):2 (lambda)&gt;\nnatural_log.call(10)\n#=&gt; 2.302585092994046\n</code></pre>\n\n<p>But then, you might as well use <a href=\"https://ruby-doc.org/core-2.6.1/Math.html#method-c-log\" rel=\"nofollow noreferrer\"><code>Math.log</code></a> directly:</p>\n\n<pre><code>Math.log(100, 10)\n# =&gt; 2.0\nMath.log(10)\n# =&gt; 2.302585092994046\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 7140795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92e2fdf7740ae782f0e0cea386e47aeb?s=128&d=identicon&r=PG&f=1", "display_name": "RosLuP", "link": "https://stackoverflow.com/users/7140795/roslup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "closed_date": 1562768544, "answer_count": 2, "score": 3, "last_activity_date": 1562759601, "creation_date": 1562754094, "last_edit_date": 1562758356, "question_id": 56968647, "link": "https://stackoverflow.com/questions/56968647/arguments-of-one-anonymous-function-in-ruby", "closed_reason": "Needs details or clarity", "title": "arguments of one anonymous function in Ruby", "body": "<p>I would like to know the meaning of this piece of code for find one possible bug:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>-&gt; a, b, c, d, e, f, g, h, i, j {\n  l = -&gt; s, t = c {\n    Math.log(s, t)\n  }\n}\n</code></pre>\n\n<p>Thank you </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "sendgrid", "sendgrid-api-v3"], "comments": [{"owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1562850920, "post_id": 56967786, "comment_id": 100514834, "body": "You should ask a new question, not update an answered question. Also if you feel like you were helped you should accept and upvote answers :-)"}, {"owner": {"reputation": 53, "user_id": 4255631, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd560fd846007d76fc570720c9a1d8f1?s=128&d=identicon&r=PG&f=1", "display_name": "DeeBee", "link": "https://stackoverflow.com/users/4255631/deebee"}, "reply_to_user": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1562926552, "post_id": 56967786, "comment_id": 100542615, "body": "I tried to upvote your answer as it was a help (to solve the specific &#39;include&#39; problem), but I do not have enough reputation to do so.  Also, my original issue was still not resolved which is to get a transactional dynamic template working with SendGrid v3.  In the meantime I have made some progress which I will document now as an answer to help others doing the same."}, {"owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1562946068, "post_id": 56967786, "comment_id": 100553138, "body": "I updated my answer, I think you made a mistake using <code>JSON.parse</code> and that you are not actually calling the right mailer method from your controller."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4255631, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd560fd846007d76fc570720c9a1d8f1?s=128&d=identicon&r=PG&f=1", "display_name": "DeeBee", "link": "https://stackoverflow.com/users/4255631/deebee"}, "edited": false, "score": 0, "creation_date": 1562770601, "post_id": 56969036, "comment_id": 100483128, "body": "Thanks -  I updated my code accordingly.  Latest issues as per my Update #3."}], "tags": [], "owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "is_accepted": false, "score": 0, "last_activity_date": 1562946018, "last_edit_date": 1562946018, "creation_date": 1562755529, "answer_id": 56969036, "question_id": 56967786, "link": "https://stackoverflow.com/questions/56967786/sendgrid-v3-not-working-for-me-with-rails-my-mailer-rb/56969036#56969036", "title": "Sendgrid v3 not working for me with rails my_mailer.rb", "body": "<p>You cannot <code>include</code> a module in a method. You have to include it in your class, so outside of the methode, like</p>\n\n<pre><code>class SomethingMailer\n  require 'sendgrid-ruby'\n  include SendGrid\n\n  def confirmation_instructions(record, token, opts={})\n    ...\n  end\nend\n</code></pre>\n\n<p>For your third update problem: </p>\n\n<p>You are not sending a JSON but instead you are creating a JSON, then parsing it into a hash, then sending that hash, instead of the JSON.</p>\n\n<pre><code>JSON.parse #parses a JSON into a Hash\n</code></pre>\n\n<p>You should do the opposite and have a hash that you transform into a JSON</p>\n\n<p>Something like</p>\n\n<pre><code>data = {\n  template_id: your_template_id # or pass a string\n  personalizations: [\n    ...\n  ]\n}\n</code></pre>\n\n<p>Then you call</p>\n\n<pre><code>data_json = data.to_json\nresponse = sg.client.mail._(\"send\").post(request_body: data_json)\n</code></pre>\n\n<p>However this does not explain why your template  in <code>app/views/my_mailer/confirmation_instructions.html.erb</code> gets sent. So I think you are either calling a different mailer_method at the same time, or you are not calling your actual confirmation_instructions method at all. Try to confirm that you SendGrid Methods actually is called and see what it returns. It should have returned some kind of error before, when you were sending a hash instead of a string.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 4255631, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd560fd846007d76fc570720c9a1d8f1?s=128&d=identicon&r=PG&f=1", "display_name": "DeeBee", "link": "https://stackoverflow.com/users/4255631/deebee"}, "is_accepted": true, "score": 0, "last_activity_date": 1562928587, "last_edit_date": 1562928587, "creation_date": 1562928126, "answer_id": 57005354, "question_id": 56967786, "link": "https://stackoverflow.com/questions/56967786/sendgrid-v3-not-working-for-me-with-rails-my-mailer-rb/57005354#57005354", "title": "Sendgrid v3 not working for me with rails my_mailer.rb", "body": "<p>For anyone trying to get SendGrid v3 API working with Ruby/Devise/Heroku and use SendGrid's dynamic transactional emails these tips may help you. I spent a week getting this to work and these steps (&amp; mistakes I made) were not apparent in the various documentation:</p>\n\n<ol>\n<li><p>Generating the SendGrid API key (on SendGrid website): when generating the key, the API key only appears once allowing you to copy it, from then on it is invisible. As I could not see the key later I mistakenly used the \"API Key ID\" in my Heroku environment variables, rather than the true API Key.</p></li>\n<li><p>Ensure the name you give the key in Heroku (for me: \"SENDGRID_APIKEY_GENERAL\") matches the code you use to reference it i.e. sg = SendGrid::API.new(api_key: ENV['SENDGRID_APIKEY_GENERAL'])</p></li>\n<li><p>For sending variables to be substituted in the template use \"dynamic_template_data\" and not \"substitutions\".  This should be within the \"personalizations\" section (see code example below).</p></li>\n<li><p>I found it useful to refer to the Sendgrid dynamic template ID by using an environment variable in Heroku (for me: 'SENDGRID_TRANS_EMAIL_CONFIRM_TEMPLATE_ID') as opposed to hard-coding in Ruby (just allowed me to experiment with different templates rather than changing code). </p></li>\n<li><p>The correct syntax for using a variable in the JSON string in Ruby is e.g.             \"CONFIRM_TOKEN\": \"'+token+'\"   (see code example below)</p></li>\n<li><p>Do not use other characters in the name:  i.e. \"CONFIRM_TOKEN\"  worked but \"-CONFIRM_TOKEN-\" did not work</p></li>\n<li><p>In the HTML of the transactional email template on SendGrid use this syntax for the substitution:  {{CONFIRM_TOKEN}}</p></li>\n<li><p>When creating a transactional template on SendGrid you can only have a 'design' view or a 'code' view not both. You must select at the start when creating the template and cannot switch after.</p></li>\n<li><p>In the devise confirmations_instructions action refer to the user as a record (e.g. email) as record.email</p></li>\n<li><p>Gemfile:   <strong>gem 'rails', '5.2.2'</strong>      <em>ruby  '2.6.1'</em>      <strong>gem 'devise', '4.6.1'</strong>        <em>gem 'sendgrid-ruby', '6.0.0'</em></p></li>\n</ol>\n\n<p>Here is my successful ruby code that I have in my_mailer.rb:</p>\n\n<pre><code>  def confirmation_instructions(record, token, opts={})\n\n    data = JSON.parse('{\n      \"personalizations\": [\n        {\n          \"to\": [\n            {\n              \"email\": \"'+record.email+'\"\n            }\n          ],\n          \"subject\": \"Some nice subject line content\",\n          \"dynamic_template_data\": {\n            \"CONFIRM_TOKEN\": \"'+token+'\",\n            \"TEST_DATA\": \"hello\"\n          }\n        }\n      ],\n      \"from\": {\n        \"email\": \"aaaa@aaaa.com\"\n      },\n      \"content\": [\n        {\n          \"type\": \"text/plain\",\n          \"value\": \"and easy to do anywhere, even with Ruby\"\n        }\n      ],\n      \"template_id\": \"'+ENV['SENDGRID_TRANS_EMAIL_CONFIRM_TEMPLATE_ID']+'\"\n    }')\n\n    sg = SendGrid::API.new(api_key: ENV['SENDGRID_APIKEY_GENERAL'])\n    response = sg.client.mail._(\"send\").post(request_body: data)\n    puts response.status_code\n    puts response.body\n    puts response.headers\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4255631, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd560fd846007d76fc570720c9a1d8f1?s=128&d=identicon&r=PG&f=1", "display_name": "DeeBee", "link": "https://stackoverflow.com/users/4255631/deebee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "accepted_answer_id": 57005354, "answer_count": 2, "score": 1, "last_activity_date": 1562946018, "creation_date": 1562751432, "last_edit_date": 1562770479, "question_id": 56967786, "link": "https://stackoverflow.com/questions/56967786/sendgrid-v3-not-working-for-me-with-rails-my-mailer-rb", "title": "Sendgrid v3 not working for me with rails my_mailer.rb", "body": "<p>I want to send a transactional mail via Sendgrid when a user registers (I use devise for authentication). I had this working fine in my_mailer.rb using SMTP as follows:</p>\n\n<pre><code>  def confirmation_instructions(record, token, opts={})\n    # SMTP header for Sendgrid - v2\n    # headers[\"X-SMTPAPI\"]= {\n    #  \"sub\": {\n    #    \"-CONFIRM_TOKEN-\": [\n    #      token\n    #    ]       \n    #   },\n    #  \"filters\": {\n    #   \"templates\": {\n    #     \"settings\": {\n    #       \"enable\": 1,\n    #       \"template_id\": \"1111111-1111-1111-1111-111111111111\"\n    #     }\n    #   }\n    #  }   \n    # }.to_json    \n</code></pre>\n\n<p>However, prompted by Sendgrid to use v3 syntax to support newer mail templates, I changed code to the following (from the sendgrid help docs, as opposed to a real understanding):</p>\n\n<pre><code>  def confirmation_instructions(record, token, opts={})\n\n    require 'sendgrid-ruby'\n    include SendGrid\n\n    sg = SendGrid::API.new(api_key: ENV['SENDGRID_API_KEY'])\n\n    data = JSON.parse('{\n      \"substitutions\": {\n        \"-CONFIRM_TOKEN-\": [\n          token\n        ],\n      \"template_id\": \"1111111-1111-1111-1111-111111111111\"\n    }')\n\n    response = sg.client.mail._(\"send\").post(request_body: data)\n    puts response.status_code\n    puts response.body\n    puts response.parsed_body\n    puts response.headers    \n</code></pre>\n\n<p>Now I get the error message:<br>\n   <code>'NoMethodError (undefined method `include' for #&lt;MyMailer:0x0000000003cfa398&gt;):'</code></p>\n\n<p>If I comment out the 'include' line I get:<br>\n    <code>'TypeError (no implicit conversion of nil into String):' on the line: \"sg = SendGrid...\"</code></p>\n\n<p>I use the Gem:  sendgrid-ruby (5.3.0)</p>\n\n<p>Any ideas would be appreciated - I've been trying to hit on the correct syntax by trial-and-error for a while now and finally admit I am stuck.</p>\n\n<p><strong>UPDATE#1:</strong><br>\nThe first issue was I was using the wrong API_KEY env. variable (copied from 2 different help docs): \"SENDGRID_API_KEY\" (in code) vs. SENDGRID_APIKEY_GENERAL (set in Heroku). Fixed.</p>\n\n<p><strong>UPDATE #2:</strong><br>\nWith the \"include\" line commented out I now seem to be getting a JSON parse error:</p>\n\n<p><code>JSON::ParserError (416: unexpected token at 'token</code></p>\n\n<p>So my 2 current issues are now:<br>\n (1) I would like 'token' to be the confirmation token variable but it is not being passed</p>\n\n<p>(2) Sending the below simple (1 line) content of 'data' does not throw up an error, but the appropriate template within Sendgrid is not selected:</p>\n\n<pre><code>data = JSON.parse('{\n  \"template_id\": \"1111111-1111-1111-1111-111111111111\"    \n}')\n</code></pre>\n\n<p><strong>UPDATE #3:</strong><br>\nHere's an update on the status of my issue and exactly where I am now stuck:</p>\n\n<p>This code works fine (using Sendgrid v2 which I am trying to upgrade from):</p>\n\n<pre><code>  def confirmation_instructions(record, token, opts={})\n\n    #\n    # SMTP header for Sendgrid     - v2\n    #     This works fine\n    #\n\n    headers[\"X-SMTPAPI\"]= {\n     \"sub\": {\n       \"-CONFIRM_TOKEN-\": [\n         token\n       ]\n      },\n     \"filters\": {\n      \"templates\": {\n        \"settings\": {\n          \"enable\": 1,\n          \"template_id\": \"1111111-1111-1111-1111-111111111111\"\n        }\n      }\n     }\n    }.to_json \n\n</code></pre>\n\n<p>This Sendgrid v3 code does not work (the email does get sent via Sendgrid but it does not select the template within Sendgrid - it just uses whatever code is in app/views/my_mailer/confirmation_instructions.html.erb):</p>\n\n<pre><code>    #\n    # Sendgrid API v3\n    #   This sends an email alright but it takes content from app/views/my_mailer/confirmation_instructions.html.erb\n    #   It DOES NOT select the template within Sendgrid\n    #\n\n    data = JSON.parse('{\n      \"template_id\": \"1111111-1111-1111-1111-111111111111\",\n      \"personalizations\": [\n        {\n          \"substitutions\": {\n            \"-CONFIRM_TOKEN-\": \"'+token+'\"\n          } \n        }\n      ]\n    }')\n\n    sg = SendGrid::API.new(api_key: ENV['SENDGRID_APIKEY_GENERAL2'])\n    response = sg.client.mail._(\"send\").post(request_body: data)\n    puts response.status_code\n    puts response.body\n    puts response.parsed_body\n    puts response.headers\n\n</code></pre>\n\n<p>As always, any insight appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 945, "user_id": 2374753, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IOy7p.jpg?s=128&g=1", "display_name": "ddonche", "link": "https://stackoverflow.com/users/2374753/ddonche"}, "edited": false, "score": 0, "creation_date": 1562770559, "post_id": 56965235, "comment_id": 100483101, "body": "Going in and making everything &quot;has_many&quot; with the dependent destroy on it is what did the trick."}], "tags": [], "owner": {"reputation": 1148, "user_id": 6591347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/muykQ.png?s=128&g=1", "display_name": "Oleksii Filonenko", "link": "https://stackoverflow.com/users/6591347/oleksii-filonenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1562742686, "creation_date": 1562742686, "answer_id": 56965235, "question_id": 56965116, "link": "https://stackoverflow.com/questions/56965116/deleting-record-violates-foreign-key-constraint/56965235#56965235", "title": "Deleting Record violates foreign key constraint", "body": "<p>Your <code>User</code> should use the <a href=\"https://guides.rubyonrails.org/association_basics.html#dependent\" rel=\"nofollow noreferrer\"><code>:dependent</code> option</a>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class User &lt; ApplicationRecord\n  # ...\n  has_many :notifications, foreign_key: :notified_by_id, dependent: :destroy\nend\n</code></pre>\n\n<p>The <code>:foreign_key</code> <a href=\"https://stackoverflow.com/a/2685662/6591347\">should also be specified</a> if you used <code>:class_name</code> on the <code>belongs_to</code> side of the association.</p>\n\n<p>Now, when you delete a <code>User</code>, all of the notifications referencing them are also deleted.</p>\n\n<p>You can repeat the same process for the <code>Article</code> or any other model referenced.</p>\n"}, {"comments": [{"owner": {"reputation": 945, "user_id": 2374753, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IOy7p.jpg?s=128&g=1", "display_name": "ddonche", "link": "https://stackoverflow.com/users/2374753/ddonche"}, "edited": false, "score": 0, "creation_date": 1562770620, "post_id": 56965422, "comment_id": 100483138, "body": "I did not know about this dependent: :nullify thing. Thank you."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 945, "user_id": 2374753, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IOy7p.jpg?s=128&g=1", "display_name": "ddonche", "link": "https://stackoverflow.com/users/2374753/ddonche"}, "edited": false, "score": 0, "creation_date": 1562783253, "post_id": 56965422, "comment_id": 100489445, "body": "@ddonche Hmm The given answer is more explanatory than the answer you accepted. this may be confusing for future SO searchers :) Hopefully, that make sense."}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 2, "last_activity_date": 1562745636, "last_edit_date": 1562745636, "creation_date": 1562743359, "answer_id": 56965422, "question_id": 56965116, "link": "https://stackoverflow.com/questions/56965116/deleting-record-violates-foreign-key-constraint/56965422#56965422", "title": "Deleting Record violates foreign key constraint", "body": "<p>It may be due to while an <code>article</code> is deleted the associated <code>comments</code> are being deleted together and there is a foreign key constraint between comments and notifications tables at db level which prevents it from deletion.</p>\n\n<p>My suggestion is to add <code>dependent: :destroy</code> in <code>Comment</code> model if you want that associated notifications to be deleted along with comments</p>\n\n<pre><code>class Comment &lt; ApplicationRecord\n  has_many :notifications, dependent: destroy\nend\n</code></pre>\n\n<p>If you want to notifications not to be deleted while deleting comments</p>\n\n<pre><code>class Comment &lt; ApplicationRecord\n  has_many :notifications, dependent: :nullify\nend\n</code></pre>\n\n<p>For more details please have a look\nDifference between <a href=\"https://stackoverflow.com/questions/2797339/rails-dependent-destroy-vs-dependent-delete-all\">dependet :destroy &amp; dependent: :nullify</a></p>\n"}], "owner": {"reputation": 945, "user_id": 2374753, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IOy7p.jpg?s=128&g=1", "display_name": "ddonche", "link": "https://stackoverflow.com/users/2374753/ddonche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 56965235, "answer_count": 2, "score": 1, "last_activity_date": 1562745636, "creation_date": 1562742279, "question_id": 56965116, "link": "https://stackoverflow.com/questions/56965116/deleting-record-violates-foreign-key-constraint", "title": "Deleting Record violates foreign key constraint", "body": "<p>I have a table for notifications, which stores the ID from several Models, so a user gets a notification upon actions related to those (someone posted a comment on your article). The notifications do not \"belong to\" anything but a user it's going to, though, it's just referencing the IDs of things. So now whenever I try to delete an article, for example, I get an error:</p>\n\n<pre><code>ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  update or delete on table \"comments\" violates foreign key constraint \"fk_rails_9268535f02\" on table \"notifications\"\n</code></pre>\n\n<p>How can I set it up to delete any referenced notifications also?</p>\n\n<p>My db schema for notifications: </p>\n\n<pre><code>create_table \"notifications\", force: :cascade do |t|\nt.integer  \"recipient_id\"\nt.integer  \"notified_by_id\"\nt.integer  \"glip_id\"\nt.integer  \"article_id\"\nt.integer  \"group_id\"\nt.integer  \"post_id\"\nt.integer  \"comment_id\"\nt.integer  \"notation_id\"\nt.integer  \"response_id\"\nt.integer  \"remark_id\"\nt.integer  \"conversation_id\"\nt.integer  \"message_id\"\nt.boolean  \"read\",              default: false\nt.datetime \"created_at\",                        null: false\nt.datetime \"updated_at\",                        null: false\nt.integer  \"notification_type\"\nt.index [\"article_id\"], name: \"index_notifications_on_article_id\"\nt.index [\"comment_id\"], name: \"index_notifications_on_comment_id\"\nt.index [\"conversation_id\"], name: \"index_notifications_on_conversation_id\"\nt.index [\"glip_id\"], name: \"index_notifications_on_glip_id\"\nt.index [\"group_id\"], name: \"index_notifications_on_group_id\"\nt.index [\"message_id\"], name: \"index_notifications_on_message_id\"\nt.index [\"notation_id\"], name: \"index_notifications_on_notation_id\"\nt.index [\"notified_by_id\"], name: \"index_notifications_on_notified_by_id\"\nt.index [\"post_id\"], name: \"index_notifications_on_post_id\"\nt.index [\"recipient_id\"], name: \"index_notifications_on_recipient_id\"\nt.index [\"remark_id\"], name: \"index_notifications_on_remark_id\"\nt.index [\"response_id\"], name: \"index_notifications_on_response_id\"\n</code></pre>\n\n<p>end</p>\n\n<p>And my notifications Model:</p>\n\n<pre><code>class Notification &lt; ApplicationRecord\n  enum notification_type: { comment: 0, notation: 1, message: 2, feature: 3, marked_helpful: 4,\n                            participation: 5, response: 6, remark: 7, follow: 8, unfollow: 9 }\n  enum read: { read: true, unread: false }\n  belongs_to :notified_by, class_name: 'User'\nend\n</code></pre>\n"}, {"tags": ["ruby", "fastlane"], "comments": [{"owner": {"reputation": 3312, "user_id": 412528, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7a781dab51284428bf9a44f3e0c85b6a?s=128&d=identicon&r=PG", "display_name": "Guillermo Siliceo Trueba", "link": "https://stackoverflow.com/users/412528/guillermo-siliceo-trueba"}, "edited": false, "score": 1, "creation_date": 1562724007, "post_id": 56962356, "comment_id": 100462583, "body": "You can\u2019t export an ENV variable to the parent shell from ruby but you can write a bash file that does it see <a href=\"https://stackoverflow.com/questions/2660571/exporting-an-environment-variable-in-ruby\" title=\"exporting an environment variable in ruby\">stackoverflow.com/questions/2660571/&hellip;</a>"}, {"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 1, "creation_date": 1562748815, "post_id": 56962356, "comment_id": 100470781, "body": "Please open an issue at the fastlane repository with a feature request - being able to return data from a lane seems like a reasonable and very useful thing."}, {"owner": {"reputation": 273, "user_id": 739278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dtAr6.png?s=128&g=1", "display_name": "nakeer", "link": "https://stackoverflow.com/users/739278/nakeer"}, "edited": false, "score": 0, "creation_date": 1563515546, "post_id": 56962356, "comment_id": 100732626, "body": "saw couple of postings requesting for that on their github repo, but no solution yet from then. But yes, will give a shot"}], "answers": [{"tags": [], "owner": {"reputation": 4814, "user_id": 673923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497066284e28d6fb3475f43ae555dfe6?s=128&d=identicon&r=PG", "display_name": "Marc Attinasi", "link": "https://stackoverflow.com/users/673923/marc-attinasi"}, "is_accepted": false, "score": 0, "last_activity_date": 1582065299, "creation_date": 1582065299, "answer_id": 60290426, "question_id": 56962356, "link": "https://stackoverflow.com/questions/56962356/returning-value-from-fastlane-fastfile/60290426#60290426", "title": "Returning value from fastlane fastfile", "body": "<p>The project I am working on calls fastlane scripts from Groovy scripts. We have the lanes take an <code>output_file</code> option and write their results there. The Groovy scripts then read the results from the file. Cumbersome, but effective.</p>\n\n<p>BTW: we also have an <code>error_file</code> option so errors can be written out similarly...</p>\n"}], "owner": {"reputation": 273, "user_id": 739278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dtAr6.png?s=128&g=1", "display_name": "nakeer", "link": "https://stackoverflow.com/users/739278/nakeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1779, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1582065299, "creation_date": 1562722778, "question_id": 56962356, "link": "https://stackoverflow.com/questions/56962356/returning-value-from-fastlane-fastfile", "title": "Returning value from fastlane fastfile", "body": "<p>My shell script would trigger a fastlane action (ruby) and I need return some value back to the shell script </p>\n\n<p>One option being suggested everywhere is to set it as a env variable. \nBut unable to print the value in shell script.</p>\n\n<p>Fastlane action</p>\n\n<pre><code>platform :ios do\n  desc \"Description of what the lane does\"\n  lane :getData do\n        ENV['FL_VALUE'] = \"Test\"\n  end\nend\n</code></pre>\n\n<p>Sample shell script</p>\n\n<pre><code>!/bin/sh\n...\nbundle exec fastlane getData\n...\necho $FL_VALUE\n</code></pre>\n\n<p>other suggestions were to write the data into some file and read it from the shell script. But would prefer to use the env variable.</p>\n"}, {"tags": ["sql-server", "ruby", "sequel-gem"], "comments": [{"owner": {"reputation": 5041, "user_id": 3391334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f540b70ec7755bba1a0bfd3b83afda?s=128&d=identicon&r=PG", "display_name": "Critical Error", "link": "https://stackoverflow.com/users/3391334/critical-error"}, "edited": false, "score": 1, "creation_date": 1562720061, "post_id": 56962093, "comment_id": 100461886, "body": "This may be a silly question, but what is the underlying column type?"}, {"owner": {"reputation": 1331, "user_id": 6359753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73961b0d8661795d0b3f8300b633124c?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Yang", "link": "https://stackoverflow.com/users/6359753/henry-yang"}, "reply_to_user": {"reputation": 15914, "user_id": 1127428, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pSzU4.jpg?s=128&g=1", "display_name": "Dale K", "link": "https://stackoverflow.com/users/1127428/dale-k"}, "edited": false, "score": 1, "creation_date": 1562721502, "post_id": 56962093, "comment_id": 100462137, "body": "@DaleBurrell I am trying to access the Microsoft SQL server, but I am reading it by using the SQL developer provided by Oracle."}, {"owner": {"reputation": 1331, "user_id": 6359753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73961b0d8661795d0b3f8300b633124c?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Yang", "link": "https://stackoverflow.com/users/6359753/henry-yang"}, "reply_to_user": {"reputation": 5041, "user_id": 3391334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f540b70ec7755bba1a0bfd3b83afda?s=128&d=identicon&r=PG", "display_name": "Critical Error", "link": "https://stackoverflow.com/users/3391334/critical-error"}, "edited": false, "score": 0, "creation_date": 1562721616, "post_id": 56962093, "comment_id": 100462154, "body": "@CriticalError The underlying data type is numeric with 10 precision as displayed in the image. I don&#39;t know if that caused the 0.1e1 expression in Ruby but the Oracle SQL developer display 1 instead of 0.1e1. I don&#39;t understand why this discrepancy exists"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1562722903, "creation_date": 1562722903, "answer_id": 56962370, "question_id": 56962093, "link": "https://stackoverflow.com/questions/56962093/why-is-sql-developer-id-column-return-me-bigdecimal-instead-of-simple-integer/56962370#56962370", "title": "Why is SQL developer ID column return me BigDecimal instead of simple integer?", "body": "<p>A <code>NUMERIC</code> value on your database is actually a non-integer type. You have a numeric scale here of 0, as in \"no decimal part\" but it's still considered a <code>BigDecimal</code> by Ruby with, as on the database, no decimal part.</p>\n\n<p>If you have an integer type, like <code>INT</code>, then you'll get an Integer in Ruby, but only if. This column could be represented by <code>INT(10)</code> but it isn't and until you make that alteration Sequel will respect that difference.</p>\n\n<p>It does seem extraordinarily unusual to have a <code>NUMERIC</code> type identifier. That's probably a mistake.</p>\n"}], "owner": {"reputation": 1331, "user_id": 6359753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73961b0d8661795d0b3f8300b633124c?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Yang", "link": "https://stackoverflow.com/users/6359753/henry-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 56962370, "answer_count": 1, "score": 0, "last_activity_date": 1562722903, "creation_date": 1562719805, "question_id": 56962093, "link": "https://stackoverflow.com/questions/56962093/why-is-sql-developer-id-column-return-me-bigdecimal-instead-of-simple-integer", "title": "Why is SQL developer ID column return me BigDecimal instead of simple integer?", "body": "<p>I'm using the sequel gem to read a SQL server database table.</p>\n\n<p>Before I do that, I connect to the SQL server database using Oracle SQL developer, and the id column shows 1, 2, 3, 4, 5...</p>\n\n<p>The table definition looks like this in SQL Developer:\n<a href=\"https://i.stack.imgur.com/cOy3m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cOy3m.png\" alt=\"enter image description here\"></a></p>\n\n<p>But when I use the sequel gem to read the table in Ruby, that ID column is a BigDecimal and shows something like 0.1e1. Why is this? If this is an ID, shouldn't it always be integer?</p>\n\n<p>How am I expected to use this field? Am I supposed to call to_i on it to convert it to integer?</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 670, "user_id": 7471822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8fe7bbe549522ddb5e12747cd583e0?s=128&d=identicon&r=PG&f=1", "display_name": "ldtcoop", "link": "https://stackoverflow.com/users/7471822/ldtcoop"}, "edited": false, "score": 0, "creation_date": 1562716834, "post_id": 56961748, "comment_id": 100461282, "body": "Can there be textareas with a different class?"}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "reply_to_user": {"reputation": 670, "user_id": 7471822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8fe7bbe549522ddb5e12747cd583e0?s=128&d=identicon&r=PG&f=1", "display_name": "ldtcoop", "link": "https://stackoverflow.com/users/7471822/ldtcoop"}, "edited": false, "score": 0, "creation_date": 1562717054, "post_id": 56961748, "comment_id": 100461326, "body": "Yes, there can be textareas with a different class. Maybe we can have an attribute like the following, instead using class: data-match-this=&quot;true&quot;. I will revise my question."}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562717648, "post_id": 56961748, "comment_id": 100461458, "body": "By default, it shouldn&#39;t match any tags inside textarea, except for textareas that have the &quot;data-match-this=&#39;true&#39;&quot; tag. It should match all other tags on the page. Hope that makes sense and let me know if I can clarify"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1562718194, "post_id": 56961748, "comment_id": 100461568, "body": "Sorry, I don&#39;t really follow your requirements then. Can you post a list of the matches you want to get?"}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562718315, "post_id": 56961748, "comment_id": 100461583, "body": "Yes, on the Rubular (<a href=\"https://rubular.com/r/RuVrypBsdDVJii\" rel=\"nofollow noreferrer\">rubular.com/r/RuVrypBsdDVJii</a>), I&#39;ve matched {{one}}, {{two}}, and {{five}}. I want to modify the regex to also match {{three}}. That is, I want to match all tags except for {{four}}."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 1, "creation_date": 1562719628, "post_id": 56961748, "comment_id": 100461813, "body": "OK, that makes sense. Thanks for clarifying. Is <code>(?&lt;!data\\-match\\-this=&quot;true&quot;&gt;)({{.*?}})</code> sufficient, or might it be possible that there are more attributes in the element?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1562720248, "post_id": 56961748, "comment_id": 100461918, "body": "Why not use an HTML parser like <a href=\"https://github.com/sparklemotion/nokogiri\" rel=\"nofollow noreferrer\">Nokogiri</a>?"}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562720272, "post_id": 56961748, "comment_id": 100461928, "body": "Thanks, ggorlen! This is almost there, but it&#39;s just matching {{four}} instead of {{three}}. Is it possible to do the opposite, and match {{three}} instead of the {{four}} tag? Appreciate all the help!"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 1, "creation_date": 1562720420, "post_id": 56961748, "comment_id": 100461949, "body": "Oh, whoops--try <code>(?&lt;!textarea&gt;)({{.*?}})</code>?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1562720599, "post_id": 56961748, "comment_id": 100461989, "body": "<code>Nokogiri::HTML(html_variable).css(&#39;textarea[data-match-this]&zwnj;&#8203;&#39;)</code>"}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562720622, "post_id": 56961748, "comment_id": 100461995, "body": "I think it&#39;s easier if I just use your first solution because the second textarea may have other attributes. I changed the code to use a data-do-not-match-this=&quot;true&quot; tag instead: <a href=\"https://rubular.com/r/HxJQhlxWD6WbFi\" rel=\"nofollow noreferrer\">rubular.com/r/HxJQhlxWD6WbFi</a>. It works great! If you post your answer, I&#39;ll check it as the accepted solution :) Thanks ggorlen!!"}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562720725, "post_id": 56961748, "comment_id": 100462011, "body": "Thanks for your help 3limin4t0r. I&#39;m trying to match all the other tags too on the page :) I think ggorlen got it"}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562725131, "post_id": 56961748, "comment_id": 100462773, "body": "Hi ggorlen, if there are more attributes in the element, is there a regex to ignore the extra attributes? See for example: <a href=\"https://rubular.com/r/dTZVlEpci2EJck\" rel=\"nofollow noreferrer\">rubular.com/r/dTZVlEpci2EJck</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562718109, "post_id": 56961882, "comment_id": 100461548, "body": "Thanks ldtcoop. Appreciate your help! I&#39;m also trying to match the other tags on the page outside of the textarea tags too"}, {"owner": {"reputation": 670, "user_id": 7471822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8fe7bbe549522ddb5e12747cd583e0?s=128&d=identicon&r=PG&f=1", "display_name": "ldtcoop", "link": "https://stackoverflow.com/users/7471822/ldtcoop"}, "reply_to_user": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562718501, "post_id": 56961882, "comment_id": 100461610, "body": "Ahh! I understand now. I have an idea of how to do that, but I just stepped away from my computer. If no one has figured this out by the time I get back to one, I&#39;ll see if my idea pans out"}], "tags": [], "owner": {"reputation": 670, "user_id": 7471822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8fe7bbe549522ddb5e12747cd583e0?s=128&d=identicon&r=PG&f=1", "display_name": "ldtcoop", "link": "https://stackoverflow.com/users/7471822/ldtcoop"}, "is_accepted": false, "score": 1, "last_activity_date": 1562717544, "creation_date": 1562717544, "answer_id": 56961882, "question_id": 56961748, "link": "https://stackoverflow.com/questions/56961748/how-do-i-match-textarea-tags-with-a-certain-attribute/56961882#56961882", "title": "How do I match textarea tags with a certain attribute?", "body": "<p>I was able to match only textarea tags (including ones with classes and ones with no content) with <code>data-match-this='true'</code> using this \n regex: <code>&lt;textarea.*data-match-this=\"true\".*&gt;.*&lt;\\/textarea&gt;</code>. If you need to capture the content, just add some parentheses like so: <code>&lt;textarea.*data-match-this=\"true\".*&gt;(.*)&lt;\\/textarea&gt;</code>. To make it only get tags with content, change the last <code>.*</code> to <code>.+</code>: <code>&lt;textarea.*data-match-this=\"true\".*&gt;.+&lt;\\/textarea&gt;</code></p>\n"}, {"comments": [{"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 1, "creation_date": 1562725906, "post_id": 56962239, "comment_id": 100462905, "body": "Thanks, Emma! There would be other attributes in the second textarea tag. If so, is there a way to only match with the textarea that has the &quot;data-match-this&quot; attribute?"}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 1, "creation_date": 1562726841, "post_id": 56962239, "comment_id": 100463076, "body": "AMAZING! I modified your solution a little bit to just match the tags: <a href=\"https://rubular.com/r/pXmbTXfUqsEKN5\" rel=\"nofollow noreferrer\">rubular.com/r/pXmbTXfUqsEKN5</a>. It works great! Thank you so much Emma!!! :)"}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 1, "creation_date": 1562743972, "post_id": 56962239, "comment_id": 100468210, "body": "Hi again Emma. If the tags are all on the same line, how can I match them? I tried adding a ? instead of a $ at the end, but can only match the first tag. See here: <a href=\"https://rubular.com/r/g6otktRF7NObGt\" rel=\"nofollow noreferrer\">rubular.com/r/g6otktRF7NObGt</a>"}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 1, "creation_date": 1562747042, "post_id": 56962239, "comment_id": 100469772, "body": "Oh sorry again! I see this might be more complicated than I expected. I saw that the regex won&#39;t take new lines into account: <a href=\"https://rubular.com/r/okL75rmrur5O2W\" rel=\"nofollow noreferrer\">rubular.com/r/okL75rmrur5O2W</a>"}, {"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 1, "creation_date": 1562771714, "post_id": 56962239, "comment_id": 100483776, "body": "No prob! Thanks again Emma :)"}], "tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": true, "score": 1, "last_activity_date": 1562727749, "last_edit_date": 1562727749, "creation_date": 1562721584, "answer_id": 56962239, "question_id": 56961748, "link": "https://stackoverflow.com/questions/56961748/how-do-i-match-textarea-tags-with-a-certain-attribute/56962239#56962239", "title": "How do I match textarea tags with a certain attribute?", "body": "<p>I'm guessing that this expression might work, with maybe a bit modification:</p>\n\n<pre><code>^((?=(.*?&lt;textarea.*(data-match-this=\"true\".*))&gt;)|(?!(.*?&lt;textarea.*&gt;))).*?({{(?!#|\\/).*?}}).*$\n</code></pre>\n\n<p>which is explained on the top right panel of <a href=\"https://regex101.com/r/0M0Zwx/1/\" rel=\"nofollow noreferrer\">this demo</a>, if you wish to explore further or simplify/modify it, and in <a href=\"https://regex101.com/r/0M0Zwx/1/debugger\" rel=\"nofollow noreferrer\">this link</a>, you can watch how it would match against some sample inputs step by step, if you like.</p>\n"}, {"comments": [{"owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "edited": false, "score": 0, "creation_date": 1562725606, "post_id": 56962313, "comment_id": 100462848, "body": "Thanks for the solution sln. I&#39;m also trying to match {{one}}, {{two}}, and {{five}} too, in addition to {{three}}. Is there a way to do it?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "is_accepted": false, "score": 3, "last_activity_date": 1562722719, "last_edit_date": 1562722719, "creation_date": 1562722397, "answer_id": 56962313, "question_id": 56961748, "link": "https://stackoverflow.com/questions/56961748/how-do-i-match-textarea-tags-with-a-certain-attribute/56962313#56962313", "title": "How do I match textarea tags with a certain attribute?", "body": "<p>You'd do it like this  </p>\n\n<p><code>/&lt;textarea(?=\\s)(?=(?:[^&gt;\"']|\"[^\"]*\"|'[^']*')*?\\sdata-match-this\\s*=\\s*(?:(['\"])\\s*true\\s*\\1))\\s+(?:\"[\\S\\s]*?\"|'[\\S\\s]*?'|[^&gt;]?)+&gt;([\\S\\s]*?)&lt;\\/textarea\\s*&gt;/</code>  </p>\n\n<p><a href=\"https://regex101.com/r/Oy6vQd/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/Oy6vQd/1</a></p>\n\n<p>Where the content is in group 2.<br>\nNote - the position of the attribute/value searched for<br>\nis independent, it can be anywhere in the tag.  </p>\n\n<p>Explained  </p>\n\n<pre><code> # Begin open textarea tag\n\n &lt; textarea \n (?= \\s )\n (?=                    # Asserttion (a pseudo atomic group)\n      (?: [^&gt;\"'] | \" [^\"]* \" | ' [^']* ' )*?\n      \\s data-match-this \\s* = \\s* \n      (?:\n           ( ['\"] )               # (1), Quote\n           \\s* true \\s*           # data-match-this = true\n           \\1 \n      )\n )\n                        # Have the data-match-this = true, \n                        # just match the rest of tag\n \\s+ \n (?: \" [\\S\\s]*? \" | ' [\\S\\s]*? ' | [^&gt;]? )+\n\n &gt;                      # End span tag\n\n ( [\\S\\s]*? )           # (2), textarea content\n &lt;/textarea \\s* &gt;       # Close textarea tag\n</code></pre>\n"}], "owner": {"reputation": 4140, "user_id": 203108, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/830323b962d8a783cb552b965cdcb480?s=128&d=identicon&r=PG", "display_name": "sjsc", "link": "https://stackoverflow.com/users/203108/sjsc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 56962239, "answer_count": 3, "score": 2, "last_activity_date": 1562727749, "creation_date": 1562716118, "last_edit_date": 1562717146, "question_id": 56961748, "link": "https://stackoverflow.com/questions/56961748/how-do-i-match-textarea-tags-with-a-certain-attribute", "title": "How do I match textarea tags with a certain attribute?", "body": "<p>I want to match textarea tags with a certain attribute only. Given I have this string:</p>\n\n<pre><code>{{one}}\n\n&lt;div&gt;{{two}}&lt;/div&gt;\n\n&lt;textarea data-match-this=\"true\"&gt;{{three}}&lt;/textarea&gt;\n\n&lt;textarea&gt;{{four}}&lt;/textarea&gt;\n\n{{five}}\n</code></pre>\n\n<p>I currently have this regex:</p>\n\n<pre><code>({{(?!#|\\/).*?}})(?!&lt;textarea&gt;)(?!&lt;\\/textarea\\&gt;)\n</code></pre>\n\n<p>That currently matches all tags except for the ones inside the textarea's. What regex can I use to enable it to match the tags inside the textarea with the \"data-match-this='true'\" attribute?</p>\n\n<p>Here is my Rubular: <a href=\"https://rubular.com/r/RuVrypBsdDVJii\" rel=\"nofollow noreferrer\">https://rubular.com/r/RuVrypBsdDVJii</a></p>\n"}, {"tags": ["ruby", "windows", "rubygems", "require"], "comments": [{"owner": {"reputation": 1670, "user_id": 6388521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-VdFWPJVSpRc/AAAAAAAAAAI/AAAAAAAAAFo/vCc8QOz6v9Y/photo.jpg?sz=128", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/6388521/ruslan"}, "edited": false, "score": 7, "creation_date": 1562707351, "post_id": 56960125, "comment_id": 100459278, "body": "You should consider reporting this to the ruby dev team <a href=\"https://bugs.ruby-lang.org/projects/ruby/wiki/HowToReport\" rel=\"nofollow noreferrer\">bugs.ruby-lang.org/projects/ruby/wiki/HowToReport</a>"}, {"owner": {"reputation": 1670, "user_id": 6388521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-VdFWPJVSpRc/AAAAAAAAAAI/AAAAAAAAAFo/vCc8QOz6v9Y/photo.jpg?sz=128", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/6388521/ruslan"}, "edited": false, "score": 2, "creation_date": 1562707522, "post_id": 56960125, "comment_id": 100459346, "body": "There&#39;s also a preview for 2.7.0. Could give that a try"}, {"owner": {"reputation": 855, "user_id": 364392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1af8b60c508bb4f5f11371b13c379c8b?s=128&d=identicon&r=PG", "display_name": "Inversion", "link": "https://stackoverflow.com/users/364392/inversion"}, "reply_to_user": {"reputation": 1670, "user_id": 6388521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-VdFWPJVSpRc/AAAAAAAAAAI/AAAAAAAAAFo/vCc8QOz6v9Y/photo.jpg?sz=128", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/6388521/ruslan"}, "edited": false, "score": 0, "creation_date": 1562740229, "post_id": 56960125, "comment_id": 100466458, "body": "For Windows, there is no installer for 2.7 yet \u2014 <a href=\"https://rubyinstaller.org/downloads/\" rel=\"nofollow noreferrer\">rubyinstaller.org/downloads</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1562762567, "post_id": 56960125, "comment_id": 100478398, "body": "can we see the contents of the required file?"}, {"owner": {"reputation": 855, "user_id": 364392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1af8b60c508bb4f5f11371b13c379c8b?s=128&d=identicon&r=PG", "display_name": "Inversion", "link": "https://stackoverflow.com/users/364392/inversion"}, "edited": false, "score": 0, "creation_date": 1562775081, "post_id": 56960125, "comment_id": 100485671, "body": "&#39;logger&#39; is a default gem. But it fails for any gem."}, {"owner": {"reputation": 855, "user_id": 364392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1af8b60c508bb4f5f11371b13c379c8b?s=128&d=identicon&r=PG", "display_name": "Inversion", "link": "https://stackoverflow.com/users/364392/inversion"}, "edited": false, "score": 0, "creation_date": 1562788023, "post_id": 56960125, "comment_id": 100491409, "body": "Reported an issue \u2014 <a href=\"https://bugs.ruby-lang.org/issues/15993\" rel=\"nofollow noreferrer\">bugs.ruby-lang.org/issues/15993</a>"}], "answers": [{"comments": [{"owner": {"reputation": 855, "user_id": 364392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1af8b60c508bb4f5f11371b13c379c8b?s=128&d=identicon&r=PG", "display_name": "Inversion", "link": "https://stackoverflow.com/users/364392/inversion"}, "edited": false, "score": 0, "creation_date": 1562927122, "post_id": 57005080, "comment_id": 100542962, "body": "Reported issue \u2014 bugs.ruby-lang.org/issues/15993"}], "tags": [], "owner": {"reputation": 855, "user_id": 364392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1af8b60c508bb4f5f11371b13c379c8b?s=128&d=identicon&r=PG", "display_name": "Inversion", "link": "https://stackoverflow.com/users/364392/inversion"}, "is_accepted": true, "score": 0, "last_activity_date": 1562927091, "creation_date": 1562927091, "answer_id": 57005080, "question_id": 56960125, "link": "https://stackoverflow.com/questions/56960125/how-to-use-require-if-there-is-cyrillic-char-in-the-path/57005080#57005080", "title": "How to use require if there is Cyrillic char in the path", "body": "<p>Looks like there is an <strong>ugly workaround</strong>.</p>\n\n<p>1)  Ensure to do <code>chcp 1251</code> in current console session.<br>\n2)  Run Ruby with an option <code>--disable=gems</code> so it will not fail initially.<br>\n3)  Add next code at the very beginning of a script:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>if $:[0].encoding.name == 'Windows-1251'\n    $:.each {|path| path.encode! 'UTF-8' }\n    $:.push '.'    # somehow it helps, looks like a modification of array is needed\n    require 'rubygems'\nend\n</code></pre>\n\n<p>This helped me to overcome the problem and run my script from a folder with Cyrillic and spaces in the path.</p>\n\n<p>But it definitely should be fixed.</p>\n"}], "owner": {"reputation": 855, "user_id": 364392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1af8b60c508bb4f5f11371b13c379c8b?s=128&d=identicon&r=PG", "display_name": "Inversion", "link": "https://stackoverflow.com/users/364392/inversion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 57005080, "answer_count": 1, "score": 7, "last_activity_date": 1562927091, "creation_date": 1562704270, "last_edit_date": 1562788340, "question_id": 56960125, "link": "https://stackoverflow.com/questions/56960125/how-to-use-require-if-there-is-cyrillic-char-in-the-path", "title": "How to use require if there is Cyrillic char in the path", "body": "<p>I\u2019m trying to build a cross-platform portable application with Ruby and there is a problem on Windows. When there is a Cyrillic character (maybe just not Latin) in the path <code>require</code> doesn\u2019t work:</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>D:\\users\\\u043a\u0438\u0457\\Ruby\\2.6\\bin&gt;ruby -v\nruby 2.6.3p62 (2019-04-16 revision 67580) [x64-mingw32]\n\nD:\\users\\\u043a\u0438\u0457\\Ruby\\2.6\\bin&gt;ruby -e \"require 'logger'\"\nTraceback (most recent call last):\n        1: from &lt;internal:gem_prelude&gt;:2:in `&lt;internal:gem_prelude&gt;'\n&lt;internal:gem_prelude&gt;:2:in `require': No such file or directory -- D:/users/\u0420\u0454\u0420\u0451\u0421\u2014/Ruby/2.6/lib/ruby/2.6.0/rubygems.rb (LoadError)\n\nD:\\users\\\u043a\u0438\u0457\\Ruby\\2.6\\bin&gt;ruby --disable=rubyopt -e \"require 'logger'\"\nTraceback (most recent call last):\n        1: from &lt;internal:gem_prelude&gt;:2:in `&lt;internal:gem_prelude&gt;'\n&lt;internal:gem_prelude&gt;:2:in `require': No such file or directory -- D:/users/\u0420\u0454\u0420\u0451\u0421\u2014/Ruby/2.6/lib/ruby/2.6.0/rubygems.rb (LoadError)\n\nD:\\users\\\u043a\u0438\u0457\\Ruby\\2.6\\bin&gt;gem list\nTraceback (most recent call last):\n        1: from &lt;internal:gem_prelude&gt;:2:in `&lt;internal:gem_prelude&gt;'\n&lt;internal:gem_prelude&gt;:2:in `require': No such file or directory -- D:/users/\u0420\u0454\u0420\u0451\u0421\u2014/Ruby/2.6/lib/ruby/2.6.0/rubygems.rb (LoadError)\n</code></pre>\n\n<p>We can see such encoding transformations in the output: </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\u0420\u0454\u0420\u0451\u0421\u2014 -&gt; \u043a\u0438\u0457\nwin1251 -&gt; utf-8\n</code></pre>\n\n<p>I have an old Ruby installation that works fine:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>D:\\users\\\u043a\u0438\u0457\\Ruby\\2.0\\bin&gt;ruby -e \"require 'logger'\"\n\nD:\\users\\\u043a\u0438\u0457\\Ruby\\2.0\\bin&gt;ruby -v\nruby 2.0.0p451 (2014-02-24) [i386-mingw32]\n</code></pre>\n\n<p>The same is for <code>ruby 2.0.0p643 (2015-02-25) [i386-mingw32]</code>.</p>\n\n<p>I also checked that <code>require</code> fails in the same case for  </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ruby 2.1.9p490 (2016-03-30 revision 54437) [i386-mingw32]\n</code></pre>\n"}, {"tags": ["html", "ruby", "loops", "nokogiri", "watir"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1562711802, "post_id": 56957889, "comment_id": 100460379, "body": "A lot of times, when dealing with dynamic pages, you have to dig into the logic of the JavaScript, then replicate it in the Ruby code. That allows you to more programmatically walk through the page, pick out the data you need, apply some Ruby code to it and determine what link the JavaScript would open, and tell Ruby to do it directly."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1562711919, "post_id": 56957889, "comment_id": 100460402, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. Your code doesn&#39;t do anything if we try to run it, and without that you&#39;re asking us to write a test harness, recreate the HTML, and then try to determine the problem, however that&#39;s a lot of room for error in providing you a solution. Instead we need something more definite to help you."}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1562767960, "post_id": 56957889, "comment_id": 100481518, "body": "It might be worthwile to check what framework the shop uses and then access the item iteratively (e.g. the shop might expose <code>https:&#47;&#47;shop.url&#47;products&#47;1</code> even if it usually will have a speaking URL - for magento it is <code>&#47;catalog&#47;product&#47;view&#47;id</code>). With good luck you can access a list of products via an open REST API, too."}], "answers": [{"tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": false, "score": 0, "last_activity_date": 1562707243, "creation_date": 1562707243, "answer_id": 56960659, "question_id": 56957889, "link": "https://stackoverflow.com/questions/56957889/how-to-loop-through-a-page-with-multiple-objects/56960659#56960659", "title": "How to loop through a page with multiple objects", "body": "<p>I'm not sure if I understand the page flow correctly, but it sounds like you need to:</p>\n\n<ul>\n<li>Store all of the data_mainkey values</li>\n<li>Iterate through each of the mainkey values - re-locating the element each time</li>\n</ul>\n\n<p>The code would look like:</p>\n\n<pre><code>main_keys = browser.divs(class: 'item').map(&amp;:data_mainkey)\nmain_keys.each do |key|\n  # Depending how the page is written, the div(class: 'content') might not be necessary\n  browser.div(data_mainkey: key).div(class: 'content').click\n\n  # Get the price\n\n  # Navigate back to the list page\nend\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11560747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LG3ct9XsR10/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reb8UYMKTrMhNL-zRn3IFGoEiQIZQ/mo/photo.jpg?sz=128", "display_name": "Melissive", "link": "https://stackoverflow.com/users/11560747/melissive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562711573, "creation_date": 1562693576, "last_edit_date": 1562711573, "question_id": 56957889, "link": "https://stackoverflow.com/questions/56957889/how-to-loop-through-a-page-with-multiple-objects", "title": "How to loop through a page with multiple objects", "body": "<p>I'm trying to make a scraper for a market website that lists their content in a weird way.\nFor each item on the list, I have to click it to find the price, and once I've clicked it and return after the data has been parsed, the order of the list of items might have changed.</p>\n\n<p>The is no specific way to refer to each \"link\" using Watir, so to actually successfully parse the price of all the items in an orderly fashion is outside of my knowledge.</p>\n\n<p>I use Watir to access an item <code>rb browser.element(:text =&gt; 'ItemName').click</code>.  That is fine if it was just the one item I wanted to parse data from using Nokogiri. </p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;div id=\"market\" class=\"itemList active\" style=\"height: 396px;\" data-category=\"30\"&gt;\n    &lt;div class=\"item\" data-mainkey=\"4601\" data-count=\"40503\" data-grade=\"0\"&gt;\n        &lt;div class=\"thumbImg\" style=\"background-image: url(&amp;quot;https://akamai-webcdn.kgstatic.net/TradeMarket/Common/item/4601.png&amp;quot;)\"&gt;&lt;/div&gt;\n        &lt;div class=\"content\"&gt;&lt;p&gt;Ash Timber&lt;/p&gt;&lt;p class=\"gray\"&gt;&lt;/p&gt;&lt;/div&gt;\n        &lt;div class=\"count\"&gt;40503&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\"item\" data-mainkey=\"4602\" data-count=\"266\" data-grade=\"0\"&gt;\n    &lt;div class=\"thumbImg\" style=\"background-image: url(&amp;quot;https://akamai-webcdn.kgstatic.net/TradeMarket/Common/item/4602.png&amp;quot;)\"&gt;&lt;/div&gt;\n    &lt;div class=\"content\"&gt;&lt;p&gt;Maple Timber&lt;/p&gt;&lt;p class=\"gray\"&gt;&lt;/p&gt;&lt;/div&gt;\n    &lt;div class=\"count\"&gt;266&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>That is how the list would look, except it's a few hundred more articles.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>browser.element(:text =&gt; 'Materials').click\nsleep 2\nbrowser.element(:text =&gt; 'Wood').click\nsleep 2\nbrowser.element(:text =&gt; 'Ash Timber').click\nsleep 2\n\n\npage = Nokogiri::HTML(browser.html)\npage.xpath('/html/body/div/div[1]/main/div[1]/div[2]/div[2]/p[1]').each do |nc|\n  @name = (nc).text\n  puts @name\nend\n</code></pre>\n\n<p>Is there a way to iterate through each item based on their \"data-mainkey\", since that is the identifier of the item from what I've seen.</p>\n\n<p>This is currently the project and it outputs the name of the item just fine.</p>\n\n<p>I would like the project to go through the list of articles, enter each and parse out the value to an array and show the result, but I have no clue how to approach this.</p>\n"}, {"tags": ["javascript", "ruby", "tags", "haml"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11411657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d582bb10b0480812634a5488a337a49?s=128&d=identicon&r=PG&f=1", "display_name": "kpedrick1", "link": "https://stackoverflow.com/users/11411657/kpedrick1"}, "edited": false, "score": 0, "creation_date": 1562783000, "post_id": 56959173, "comment_id": 100489338, "body": "When I tried this I see this in page source ``` &lt;script&gt;   /* Extole Script <i>/   (function(c,e,k,l,a){c[e]=c[e]||{};for(c[e].q=c[e].q||[];a&lt;l&zwnj;&#8203;.length;)k(l[a++],c[&zwnj;&#8203;e])})(window,&quot;extole&zwnj;&#8203;&quot;,function(c,e){e[c]&zwnj;&#8203;=e[c]||function(){e.&zwnj;&#8203;q.push([c,arguments]&zwnj;&#8203;)}},[&quot;createZone&quot;],0&zwnj;&#8203;);   /</i> End Extole Script */    extole.createZone({      name: &#39;conversion&#39;,      data: {        &quot;first_name&quot; = &lt;%= session[&quot;fist_name&quot;] %&gt;,        &quot;last_name&quot; = &lt;%= session[&quot;last_name&quot;] %&gt;,        &quot;email&quot; = &lt;%= session[&quot;email_address&quot;] %&gt;,         }   }); &lt;/script&gt; ```"}, {"owner": {"reputation": 4667, "user_id": 268673, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/33abb5182937ebcc3765f224aa74c16d?s=128&d=identicon&r=PG", "display_name": "AndreDurao", "link": "https://stackoverflow.com/users/268673/andredurao"}, "reply_to_user": {"reputation": 15, "user_id": 11411657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d582bb10b0480812634a5488a337a49?s=128&d=identicon&r=PG&f=1", "display_name": "kpedrick1", "link": "https://stackoverflow.com/users/11411657/kpedrick1"}, "edited": false, "score": 0, "creation_date": 1563207618, "post_id": 56959173, "comment_id": 100615085, "body": "@kpedrick1 I meant in the index.js.erb or index.json.jbuilder view that contains the code which will be rendered"}], "tags": [], "owner": {"reputation": 4667, "user_id": 268673, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/33abb5182937ebcc3765f224aa74c16d?s=128&d=identicon&r=PG", "display_name": "AndreDurao", "link": "https://stackoverflow.com/users/268673/andredurao"}, "is_accepted": false, "score": 1, "last_activity_date": 1562710940, "last_edit_date": 1562710940, "creation_date": 1562699303, "answer_id": 56959173, "question_id": 56957886, "link": "https://stackoverflow.com/questions/56957886/how-to-pass-a-ruby-session-variable-to-a-javascript-tag/56959173#56959173", "title": "How to pass a Ruby session variable to a JavaScript tag", "body": "<p>Did you tried to use the same code in the view, for example:</p>\n\n<pre><code>\"first_name\" = &lt;%= session[\"fist_name\"] %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 5126049, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cLUJOlUBgOM/AAAAAAAAAAI/AAAAAAAAABY/UaaUag_nNlI/photo.jpg?sz=128", "display_name": "Dmitrii Kharlamov", "link": "https://stackoverflow.com/users/5126049/dmitrii-kharlamov"}, "is_accepted": false, "score": 0, "last_activity_date": 1610404387, "creation_date": 1610404387, "answer_id": 65675489, "question_id": 56957886, "link": "https://stackoverflow.com/questions/56957886/how-to-pass-a-ruby-session-variable-to-a-javascript-tag/65675489#65675489", "title": "How to pass a Ruby session variable to a JavaScript tag", "body": "<p>It looks like you're using HAML for your template (judging by the <code>:javascript</code> filter), but you're trying to use ERB interpolation inside.</p>\n<p>You need to use proper HAML interpolation:</p>\n<pre><code>:javascript\n\n  /* Extole Script */\n  (function(c,e,k,l,a){c[e]=c[e]||{};for(c[e].q=c[e].q||[];a&lt;l.length;)k(l[a++],c[e])})(window,&quot;extole&quot;,function(c,e){e[c]=e[c]||function(){e.q.push([c,arguments])}},[&quot;createZone&quot;],0);\n  /* End Extole Script */\n   extole.createZone({\n     name: 'conversion',\n     data: {\n       &quot;first_name&quot; = '#{fist_name}',\n       &quot;last_name&quot; = '#{last_name}',\n       &quot;email&quot; = '#{email_address}',\n\n     }\n  });\n</code></pre>\n<p>The surrounding single quotes are there for JS to interpret these as strings.</p>\n<p>Documentation: <a href=\"https://haml.info/docs/yardoc/file.REFERENCE.html#ruby-interpolation-\" rel=\"nofollow noreferrer\">https://haml.info/docs/yardoc/file.REFERENCE.html#ruby-interpolation-</a></p>\n"}], "owner": {"reputation": 15, "user_id": 11411657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d582bb10b0480812634a5488a337a49?s=128&d=identicon&r=PG&f=1", "display_name": "kpedrick1", "link": "https://stackoverflow.com/users/11411657/kpedrick1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1610404387, "creation_date": 1562693567, "last_edit_date": 1562710908, "question_id": 56957886, "link": "https://stackoverflow.com/questions/56957886/how-to-pass-a-ruby-session-variable-to-a-javascript-tag", "title": "How to pass a Ruby session variable to a JavaScript tag", "body": "<p>I am working with a vendor that uses a JavaScript tag for sale attribution.  I need to pass session variables to the tag.  The tag is firing, and I can see the variables in the logs, but not in the tag.</p>\n\n<p>I verified that the session variable is set by adding <code>puts{variable}</code> to the controller and see the proper values in the log, but not able to get the variables in the JavaScript tag.</p>\n\n<p>This is the Tag code:</p>\n\n<pre><code>:javascript\n\n  /* Extole Script */\n  (function(c,e,k,l,a){c[e]=c[e]||{};for(c[e].q=c[e].q||[];a&lt;l.length;)k(l[a++],c[e])})(window,\"extole\",function(c,e){e[c]=e[c]||function(){e.q.push([c,arguments])}},[\"createZone\"],0);\n  /* End Extole Script */\n   extole.createZone({\n     name: 'conversion',\n     data: {\n       \"first_name\" = &lt;%= fist_name %&gt;,\n       \"last_name\" = &lt;%= last_name%&gt;,\n       \"email\" = &lt;%= email_address&gt;,\n\n     }\n  });\n</code></pre>\n\n<p>This is the Controller code:</p>\n\n<pre><code>  def index\n\n    if session['cart_products'] == nil\n      session['cart_products'] = {}\n    end\n    puts \"\\n\\nCoupon\\n\\n\"\n    puts session['coupon_code']\n    puts session['email_address']\n    puts session['first_name']\n    puts session['last_name']\n    puts session['carttotal']\n    puts \"\\n\\n\"\n    @cart_size = session['cart_products'].length\n\n  end\n</code></pre>\n\n<p>The logs show the <code>session['first_name']</code> value.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "arabic", "arabic-support"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1562713164, "post_id": 56957713, "comment_id": 100460623, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. We need some sample code to run showing what you&#39;ve tried, along with any errors received."}, {"owner": {"reputation": 1130, "user_id": 3248186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6d0ec4335f097cad1110b0a92c125567?s=128&d=identicon&r=PG&f=1", "display_name": "user3248186", "link": "https://stackoverflow.com/users/3248186/user3248186"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1562736953, "post_id": 56957713, "comment_id": 100465255, "body": "@theTinMan Already added sample code of what I tried. Was trying to integrate the otp variable into my string, but it&#39;s not printing the otp variable value, instead it&#39;s printing as it is, and the meaning of the text when i tried google translate is also changing. shared the sample text in 2nd quote"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1562741156, "post_id": 56957713, "comment_id": 100466857, "body": "Did you use single or double quotes with your string? Who do you actually output the string? In ERB, in the console?"}, {"owner": {"reputation": 1130, "user_id": 3248186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6d0ec4335f097cad1110b0a92c125567?s=128&d=identicon&r=PG&f=1", "display_name": "user3248186", "link": "https://stackoverflow.com/users/3248186/user3248186"}, "edited": false, "score": 0, "creation_date": 1562755245, "post_id": 56957713, "comment_id": 100474488, "body": "used double quotes. and output the string in console."}], "answers": [{"tags": [], "owner": {"reputation": 920, "user_id": 1673227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbgZ.jpg?s=128&g=1", "display_name": "M.Elkady", "link": "https://stackoverflow.com/users/1673227/m-elkady"}, "is_accepted": false, "score": 3, "last_activity_date": 1562693848, "creation_date": 1562693848, "answer_id": 56957954, "question_id": 56957713, "link": "https://stackoverflow.com/questions/56957713/how-to-print-arabic-text-in-ruby-on-rails-application/56957954#56957954", "title": "How to print arabic text in ruby on rails application", "body": "<p>I recommend  using <strong>Internationalization (I18n) API</strong> docs <a href=\"https://guides.rubyonrails.org/i18n.html#organization-of-locale-files\" rel=\"nofollow noreferrer\">here</a> </p>\n\n<p>then in local <code>config/locales/ar.yml</code> you can define a key for this sentence \n<code>note: \u0631\u0645\u0632 \u0627\u0644\u062a\u062d\u0642\u0642 \u0644\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644 \u0625\u0644\u0649 \u062a\u0637\u0628\u064a\u0642 \u0627\u0644\u0627\u062e\u062a\u0628\u0627\u0631 \u0627\u0644\u062e\u0627\u0635 \u0628\u064a \u0647\u0648: %{otp}. \u0644\u0627 \u062a\u0634\u0627\u0631\u0643 \u0627\u0644\u0631\u0645\u0632 \u0645\u0639 \u0623\u064a \u0634\u062e\u0635 \u0644\u0623\u0646\u0647 \u0633\u0631\u064a</code></p>\n\n<p>and in your application </p>\n\n<pre><code>I18n.t 'note' ,  otp: otp \n</code></pre>\n\n<p>trying to write Arabic inside your code will make you have really hard times  </p>\n"}], "owner": {"reputation": 1130, "user_id": 3248186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6d0ec4335f097cad1110b0a92c125567?s=128&d=identicon&r=PG&f=1", "display_name": "user3248186", "link": "https://stackoverflow.com/users/3248186/user3248186"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "closed_date": 1562766367, "answer_count": 1, "score": -2, "last_activity_date": 1562693848, "creation_date": 1562692889, "question_id": 56957713, "link": "https://stackoverflow.com/questions/56957713/how-to-print-arabic-text-in-ruby-on-rails-application", "closed_reason": "Not suitable for this site", "title": "How to print arabic text in ruby on rails application", "body": "<p>How can I print an arabic string as it is in a ruby on rails application.\nThis's my sample arabic text :</p>\n\n<pre>\n\u0631\u0645\u0632 \u0627\u0644\u062a\u062d\u0642\u0642 \u0644\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644 \u0625\u0644\u0649 \u062a\u0637\u0628\u064a\u0642 \u0627\u0644\u0627\u062e\u062a\u0628\u0627\u0631 \u0627\u0644\u062e\u0627\u0635 \u0628\u064a \u0647\u0648: 3155. \u0644\u0627 \u062a\u0634\u0627\u0631\u0643 \u0627\u0644\u0631\u0645\u0632 \u0645\u0639 \u0623\u064a \u0634\u062e\u0635 \u0644\u0623\u0646\u0647 \u0633\u0631\u064a\n</pre>\n\n<blockquote>\n  <p>\u0631\u0645\u0632 \u0627\u0644\u062a\u062d\u0642\u0642 \u0644\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644 \u0625\u0644\u0649 \u062a\u0637\u0628\u064a\u0642 \u0627\u0644\u0627\u062e\u062a\u0628\u0627\u0631 \u0627\u0644\u062e\u0627\u0635 \u0628\u064a \u0647\u0648: 3155. \u0644\u0627 \u062a\u0634\u0627\u0631\u0643 \u0627\u0644\u0631\u0645\u0632 \u0645\u0639 \u0623\u064a \u0634\u062e\u0635 \u0644\u0623\u0646\u0647 \u0633\u0631\u064a</p>\n</blockquote>\n\n<p>The number 3155 is a variable I want to put in the text above. But I'm unable to do this, as it's somehow getting changed, when I change the constant number to handle variable like #{otp}</p>\n\n<blockquote>\n  <p>\u0631\u0645\u0632 \u0627\u0644\u062a\u062d\u0642\u0642 \u0644\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644 \u0625\u0644\u0649 \u062a\u0637\u0628\u064a\u0642 \u0627\u0644\u0627\u062e\u062a\u0628\u0627\u0631 \u0627\u0644\u062e\u0627\u0635 \u0628\u064a \u0647\u0648: #{otp}. \u0644\u0627 \u062a\u0634\u0627\u0631\u0643 \u0627\u0644\u0631\u0645\u0632 \u0645\u0639 \u0623\u064a \u0634\u062e\u0635 \u0644\u0623\u0646\u0647 \u0633\u0631\u064a</p>\n</blockquote>\n\n<pre>\n\u0631\u0645\u0632 \u0627\u0644\u062a\u062d\u0642\u0642 \u0644\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644 \u0625\u0644\u0649 \u062a\u0637\u0628\u064a\u0642 \u0627\u0644\u0627\u062e\u062a\u0628\u0627\u0631 \u0627\u0644\u062e\u0627\u0635 \u0628\u064a \u0647\u0648: #{otp}. \u0644\u0627 \u062a\u0634\u0627\u0631\u0643 \u0627\u0644\u0631\u0645\u0632 \u0645\u0639 \u0623\u064a \u0634\u062e\u0635 \u0644\u0623\u0646\u0647 \u0633\u0631\u064a\n</pre>\n\n<p>Can someone please help me with this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "methods"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1562691042, "post_id": 56957174, "comment_id": 100452878, "body": "What&#39;s the full stacktrace of the error?"}, {"owner": {"reputation": 11, "user_id": 10205106, "user_type": "registered", "profile_image": "https://graph.facebook.com/207500713445503/picture?type=large", "display_name": "Dion Bajramaj", "link": "https://stackoverflow.com/users/10205106/dion-bajramaj"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1562691514, "post_id": 56957174, "comment_id": 100453091, "body": "<a href=\"https://imgur.com/a/eJIyKBO\" rel=\"nofollow noreferrer\">imgur.com/a/eJIyKBO</a>"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1562692466, "post_id": 56957174, "comment_id": 100453458, "body": "The problem is that <code>@categories</code> is <code>nil</code> because you haven&#39;t defined it in your <code>create</code> method."}, {"owner": {"reputation": 11, "user_id": 10205106, "user_type": "registered", "profile_image": "https://graph.facebook.com/207500713445503/picture?type=large", "display_name": "Dion Bajramaj", "link": "https://stackoverflow.com/users/10205106/dion-bajramaj"}, "edited": false, "score": 0, "creation_date": 1562692682, "post_id": 56957174, "comment_id": 100453521, "body": "Hw to fix it then?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1562706541, "post_id": 56957174, "comment_id": 100459024, "body": "&quot;it&#39;s still not working&quot; ... is there a different error? Same error?"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "edited": false, "score": 0, "creation_date": 1562742353, "post_id": 56957174, "comment_id": 100467447, "body": "What&#39;s the error you mentioned in this sentence, I believe it should be another error?  <code>: I&#39;ve tried to declare @categories on create method, but still it&#39;s not working:</code>"}], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 1449406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nkyLF.jpg?s=128&g=1", "display_name": "Nataniele", "link": "https://stackoverflow.com/users/1449406/nataniele"}, "is_accepted": false, "score": 0, "last_activity_date": 1562750216, "creation_date": 1562750216, "answer_id": 56967397, "question_id": 56957174, "link": "https://stackoverflow.com/questions/56957174/undefined-method-map-for-nilnilclass-did-you-mean-tap-how-to-fix/56967397#56967397", "title": "undefined method `map&#39; for nil:NilClass Did you mean? tap - How to fix?", "body": "<p>Check the <code>map</code> call in your <code>new</code> method.\n<code>@categories = Category.all.map{ |c| [c.name, c.id] }</code>\nIt might be the cause of the error. 'A\u0441tiveRecord' returns an empty array if no records found but I would verify the output anyway in case something unexpected happened. </p>\n"}, {"tags": [], "owner": {"reputation": 176, "user_id": 8182291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135f6960e27f824a1e79a530815a4562?s=128&d=identicon&r=PG&f=1", "display_name": "Vatsal Jain", "link": "https://stackoverflow.com/users/8182291/vatsal-jain"}, "is_accepted": false, "score": 0, "last_activity_date": 1562764765, "creation_date": 1562764765, "answer_id": 56971635, "question_id": 56957174, "link": "https://stackoverflow.com/questions/56957174/undefined-method-map-for-nilnilclass-did-you-mean-tap-how-to-fix/56971635#56971635", "title": "undefined method `map&#39; for nil:NilClass Did you mean? tap - How to fix?", "body": "<p>Seems like you are receiving nil from AR query. To handle such errors you can try this:</p>\n\n<pre><code>@categories = Category.all.to_a.map{ |c| [c.name, c.id]}\n</code></pre>\n\n<p>But the results will be 0 since there are not any.</p>\n"}], "owner": {"reputation": 11, "user_id": 10205106, "user_type": "registered", "profile_image": "https://graph.facebook.com/207500713445503/picture?type=large", "display_name": "Dion Bajramaj", "link": "https://stackoverflow.com/users/10205106/dion-bajramaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562764765, "creation_date": 1562690547, "last_edit_date": 1562692972, "question_id": 56957174, "link": "https://stackoverflow.com/questions/56957174/undefined-method-map-for-nilnilclass-did-you-mean-tap-how-to-fix", "title": "undefined method `map&#39; for nil:NilClass Did you mean? tap - How to fix?", "body": "<p>I am making a Rails application, which will have something as \"products\" on it. Products will have a photo, name, category, code and description.</p>\n\n<p>I've tried many ways but none worked.</p>\n\n<p>Products_controller's NEW and CREATE methods:</p>\n\n<pre><code>def new\n    if !logged_in?\n        redirect_to root_path\n    end\n    if logged_in?\n        @product = current_user.products.build\n        @categories = Category.all.map{ |c| [c.name, c.id] }\n    end\nend \ndef create\n    @product = current_user.products.build(product_params) \n    @product.category_id = params[:category_id]\n    if @product.save\n        redirect_to root_path\n    else \n        render 'new'\n    end\n</code></pre>\n\n<p>HTML CODE: </p>\n\n<pre><code>&lt;div class=\"col-md-6 col-md-offset-3\"&gt;\n&lt;div class=\"deniso\"&gt;\n\n&lt;% &lt;h1&gt;Shto Produkt:&lt;/h1&gt;\n   &lt;%= simple_form_for @product, :html =&gt; {:multipart =&gt; true} do |f| %&gt;\n&lt;%= f.file_field :product_img %&gt;\n &lt;div class=\"cate\"&gt;  \n   &lt;%= select_tag(:category_id, options_for_select(@categories), :prompt =&gt; \"Zgjidhni kategorine:\") %&gt;\n  &lt;/div&gt; \n  &lt;h4&gt;Emri i produktit&lt;/h4&gt;\n   &lt;%= f.input :title, label: \"Emri i Produktit:\" %&gt;\n   &lt;h4&gt;Kodi&lt;/h4&gt;\n   &lt;%= f.input :kodi, label: \"Kodi:\" %&gt;\n   &lt;h4&gt;Qmimi&lt;h4&gt;\n   &lt;%= f.input :qmimi, label: \"Qmimi:\" %&gt;\n   &lt;h4&gt;Pershkrimi&lt;/h4&gt;\n   &lt;%= f.input :pershkrimi, label: \"Pershkrimi:\" %&gt;\n   &lt;div class=\"btn btn-1\"&gt;\n   &lt;%= f.button :submit %&gt;\n   &lt;/div&gt;\n   &lt;% end %&gt;\n   &lt;/div&gt;\n\n    &lt;%= link_to \"Kthehuni mbrapa\", root_path, class: \"btn-custom2\" %&gt;\n\n    &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>ERROR CODE:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>NoMethodError in Products#create\nShowing C:/Users/PC/Desktop/Npshkodra/app/views/products/new.html.erb where line #12 raised:\n\nundefined method `map' for nil:NilClass\nDid you mean?  tap\n&lt;%= f.file_field :product_img %&gt;\n &lt;div class=\"cate\"&gt;  \n   &lt;%= select_tag(:category_id, options_for_select(@categories), :prompt =&gt; \"Zgjidhni kategorine:\") %&gt;\n  &lt;/div&gt; \n  &lt;h4&gt;Emri i produktit&lt;/h4&gt;\n   &lt;%= f.input :title, label: \"Emri i Produktit:\" %&gt;\n</code></pre>\n\n<p>I expect that product will be created.</p>\n\n<p>EDIT:\nI've tried to declare <code>@categories</code> on <code>create</code> method, but still it's not working:</p>\n\n<pre><code>      @categories = Category.all.map{ |c| [c.name, c.id] }\n       @product = current_user.products.build(product_params) \n       @product.category_id = params[:category_id]\n       if @product.save\n           redirect_to root_path\n       else \n           render 'new'\n       end\n    end \n     ```\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1562694292, "post_id": 56957052, "comment_id": 100454193, "body": "Consider: <code>&quot;cat&quot;.to_sym #=&gt; :cat</code>, <code>&quot;cat 9 lives&quot;.to_sym #=&gt; :&quot;cat 9 lives&quot;</code>, <code>&quot;9lives&quot;.to_sym #=&gt; :&quot;9lives&quot;</code>. What can you deduce from these results?"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1562691431, "post_id": 56957095, "comment_id": 100453052, "body": "Also wild: <code>x=&quot;Google&quot;; :&quot;#{x}, Inc.&quot;</code> is also valid."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 5, "last_activity_date": 1562691013, "last_edit_date": 1562691013, "creation_date": 1562690214, "answer_id": 56957095, "question_id": 56957052, "link": "https://stackoverflow.com/questions/56957052/colon-prefixed-string-in-ruby/56957095#56957095", "title": "Colon prefixed string in ruby", "body": "<blockquote>\n  <p>What bugs be the most is this <code>:'Official Name' =&gt;</code>. It looks like a symbol with white spaces.</p>\n</blockquote>\n\n<p>That's exactly what it is.</p>\n\n<pre><code>p :'Official Name'.class\n# =&gt; Symbol\n</code></pre>\n\n<p>However, in a Hash literal you can put the colon at the end instead, which I think reads a little nicer:</p>\n\n<pre><code>rr = {\n  id: 215043,\n  \"Official Name\": \"Google, Inc.\",\n}\n\nrr.keys.each {|key| p [key, key.class] }\n# =&gt; [:id, Symbol]\n#    [:\"Official Name\", Symbol]\n</code></pre>\n\n<p>For future reference, the <a href=\"http://ruby-doc.org/core-2.6.3/\" rel=\"nofollow noreferrer\">official docs</a> are fairly easy to navigate once you get used to them. In this case, you'll want to follow the link for <a href=\"http://ruby-doc.org/core-2.6.3/doc/syntax/literals_rdoc.html\" rel=\"nofollow noreferrer\">doc/syntax/literals.rdoc</a>, then check out the sections on <a href=\"http://ruby-doc.org/core-2.6.3/doc/syntax/literals_rdoc.html#label-Symbols\" rel=\"nofollow noreferrer\">Symbols</a> and <a href=\"http://ruby-doc.org/core-2.6.3/doc/syntax/literals_rdoc.html#label-Hashes\" rel=\"nofollow noreferrer\">Hashes</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1475, "user_id": 1743874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/vQYev.png?s=128&g=1", "display_name": "Piccolo", "link": "https://stackoverflow.com/users/1743874/piccolo"}, "is_accepted": false, "score": 1, "last_activity_date": 1562690224, "creation_date": 1562690224, "answer_id": 56957097, "question_id": 56957052, "link": "https://stackoverflow.com/questions/56957052/colon-prefixed-string-in-ruby/56957097#56957097", "title": "Colon prefixed string in ruby", "body": "<p>This is still a <a href=\"https://ruby-doc.org/core-2.5.0/Symbol.html\" rel=\"nofollow noreferrer\">symbol</a>.</p>\n\n<p>Ruby lets you define a symbol that has spaces in it if you wrap it in quotes like that.</p>\n\n<p>Check out <a href=\"https://stackoverflow.com/a/15353567/1743874\">this answer</a> to see an example of a symbol with spaces being created from a String.</p>\n"}], "owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56957095, "answer_count": 2, "score": 4, "last_activity_date": 1562691013, "creation_date": 1562690047, "last_edit_date": 1562690630, "question_id": 56957052, "link": "https://stackoverflow.com/questions/56957052/colon-prefixed-string-in-ruby", "title": "Colon prefixed string in ruby", "body": "<p>I am new to Ruby, and just came across this code snippet:</p>\n\n<pre><code>rr = {\n  id: 215043,\n  :'Official Name' =&gt; \"Google, Inc.\"\n}\n</code></pre>\n\n<p>What bugs be the most is this <code>:'Official Name' =&gt;</code>. It looks like a symbol with spaces. </p>\n\n<p>And when I print it, I see:</p>\n\n<pre><code>{:id=&gt;\"215043\", :\"Official Name\"=&gt;\"Google, Inc.\"}\n</code></pre>\n\n<p>Please help me understand this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "rake", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "is_accepted": false, "score": 1, "last_activity_date": 1562765774, "last_edit_date": 1592644375, "creation_date": 1562765774, "answer_id": 56971940, "question_id": 56956663, "link": "https://stackoverflow.com/questions/56956663/ruby-2-6-1-and-bundler-2-0-1-to-heroku-should-i-write-a-procfile/56971940#56971940", "title": "Ruby 2.6.1 and Bundler 2.0.1 to Heroku : should I write a Procfile?", "body": "<p>There are <a href=\"https://devcenter.heroku.com/articles/bundler-version#known-upgrade-issues\" rel=\"nofollow noreferrer\">known issues with Bundler 2 on Heroku</a>, including this one:</p>\n<blockquote>\n<p>A Gemfile.lock that specifies bundler 2.0.2 does not work with bundler 2.0.1</p>\n<p>If you attempt to deploy an app that uses bundler 2.0.2 onto the Heroku platform with bundler 2.0.1 you may get this error:</p>\n<pre><code>`find_spec_for_exe': can't find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)\n</code></pre>\n<p>This is due to a bug in the Rubygems bundler version checking code. To avoid this issue, upgrade your Ruby version. It is fixed in 2.5.5+ and 2.6.3+. If you do not update, your Ruby version then every new release of Bundler 2.x will trigger this issue.</p>\n</blockquote>\n<p>Upgrade Ruby to at least version 2.6.3 locally, update the <code>ruby</code> version in your <code>Gemfile</code>, <code>bundle install</code>, commit the changes, and redeploy.</p>\n"}], "owner": {"reputation": 394, "user_id": 11509906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYTfF.jpg?s=128&g=1", "display_name": "Sumak", "link": "https://stackoverflow.com/users/11509906/sumak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562765774, "creation_date": 1562688544, "last_edit_date": 1562691886, "question_id": 56956663, "link": "https://stackoverflow.com/questions/56956663/ruby-2-6-1-and-bundler-2-0-1-to-heroku-should-i-write-a-procfile", "title": "Ruby 2.6.1 and Bundler 2.0.1 to Heroku : should I write a Procfile?", "body": "<p>I'm facing errors I can't handle while trying to deploy an app to Heroku (it's my first time). </p>\n\n<pre><code># ERROR when I try to `git push heroku master`\nremote: -----&gt; Detecting rake tasks\nremote: \nremote:  !\nremote:  !     Could not detect rake tasks\nremote:  !     ensure you can run `$ bundle exec rake -P` against your app\nremote:  !     and using the production group of your Gemfile.\nremote:  !     Activating bundler (2.0.1) failed:\nremote:  !     Could not find 'bundler' (2.0.1) required by your /tmp/build_e569680f858939ef8f1f8ef3e8902eff/Gemfile.lock.\nremote:  !     To update to the latest version installed on your system, run `bundle update --bundler`.\nremote:  !     To install the missing version, run `gem install bundler:2.0.1`\nremote:  !     Checked in 'GEM_PATH=/tmp/build_e569680f858939ef8f1f8ef3e8902eff/vendor/bundle/ruby/2.6.0', execute `gem env` for more information\nremote:  !     \nremote:  !     To install the version of bundler this project requires, run `gem install bundler -v '2.0.1'\n</code></pre>\n\n<pre><code># heroku buildpacks\n=== staging-det-music Buildpack URLs\n1. heroku/nodejs\n2. heroku/ruby\n</code></pre>\n\n<pre><code># Gemfile.lock\nRUBY VERSION\n   ruby 2.6.1p33\n\nBUNDLED WITH\n   2.0.1\n</code></pre>\n\n<p>I've tried several solutions, like:</p>\n\n<ul>\n<li><p>running <code>RAILS_ENV=production bundle exec rake assets:precompile</code> (see <a href=\"https://stackoverflow.com/questions/36394297/heroku-push-error-could-not-detect-rake-tasks/36394839#36394839\">here</a>)</p></li>\n<li><p>adding the <code>RAILS_SERVE_STATIC_FILES</code> key (same)</p></li>\n<li><p>upgrade Ruby to 2.6.3 (see <a href=\"https://stackoverflow.com/questions/56935905/could-not-find-bundler-2-0-1-required-by-your-gemfile-lock-while-deploying\">here</a>, can't find 2.6.3 with rbenv nor rvm)</p></li>\n</ul>\n\n<p>I believe it might be due to <a href=\"https://devcenter.heroku.com/articles/bundler-version#known-upgrade-issues\" rel=\"nofollow noreferrer\">this issue</a>. Am I concerned by this point ?</p>\n\n<blockquote>\n  <p>2) When using binstubs to run a command instead of bundle exec the wrong\n  version of Bundler can get activated when using Ruby 2.6.x. This bug\n  is reported to Ruby Core and will be fixed when Ruby 2.6.3 is\n  released.</p>\n  \n  <p>In the short term, the workaround is to ensure all commands in the\n  Procfile and app.json are prefaced with bundle exec. For example:</p>\n  \n  <p><code>web: bundle exec bin/rails server -p $PORT -e $RAILS_ENV</code> </p>\n  \n  <p><code>worker: bundle exec sidekiq -C config/sidekiq.yml</code></p>\n</blockquote>\n\n<p>As a newbie I feel really lost, could anyone help me on this ?</p>\n\n<p>Thanks for your time</p>\n\n<p><strong>SOLUTION:</strong> found <a href=\"https://github.com/heroku/heroku-buildpack-ruby/issues/833\" rel=\"nofollow noreferrer\">here</a> removing <code>BUNDLED WITH</code> and the following line in Gemfile.lock</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "rest-client"], "comments": [{"owner": {"reputation": 835, "user_id": 1026901, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d43afae270038a0a826f25f29183ce4?s=128&d=identicon&r=PG", "display_name": "Btuman", "link": "https://stackoverflow.com/users/1026901/btuman"}, "edited": false, "score": 0, "creation_date": 1562684718, "post_id": 56955480, "comment_id": 100449459, "body": "Are you saying you tried <code>spotify_track.present?</code> or <code>spotify_track.acousticness.present?</code>"}, {"owner": {"reputation": 22592, "user_id": 147586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4f5d494ebdc9e7cce1aecf3ce3e8bc1?s=128&d=identicon&r=PG", "display_name": "Shpigford", "link": "https://stackoverflow.com/users/147586/shpigford"}, "reply_to_user": {"reputation": 835, "user_id": 1026901, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d43afae270038a0a826f25f29183ce4?s=128&d=identicon&r=PG", "display_name": "Btuman", "link": "https://stackoverflow.com/users/1026901/btuman"}, "edited": false, "score": 0, "creation_date": 1562684806, "post_id": 56955480, "comment_id": 100449522, "body": "@Btuman <code>spotify_track.acousticness.present?</code>"}, {"owner": {"reputation": 835, "user_id": 1026901, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d43afae270038a0a826f25f29183ce4?s=128&d=identicon&r=PG", "display_name": "Btuman", "link": "https://stackoverflow.com/users/1026901/btuman"}, "edited": false, "score": 0, "creation_date": 1562684862, "post_id": 56955480, "comment_id": 100449557, "body": "On a successful call, what does <code>spotify_track.acousticness.class</code> return?"}, {"owner": {"reputation": 22592, "user_id": 147586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4f5d494ebdc9e7cce1aecf3ce3e8bc1?s=128&d=identicon&r=PG", "display_name": "Shpigford", "link": "https://stackoverflow.com/users/147586/shpigford"}, "reply_to_user": {"reputation": 835, "user_id": 1026901, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d43afae270038a0a826f25f29183ce4?s=128&d=identicon&r=PG", "display_name": "Btuman", "link": "https://stackoverflow.com/users/1026901/btuman"}, "edited": false, "score": 0, "creation_date": 1562685286, "post_id": 56955480, "comment_id": 100449832, "body": "@Btuman <code>=&gt; Float</code>"}, {"owner": {"reputation": 835, "user_id": 1026901, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d43afae270038a0a826f25f29183ce4?s=128&d=identicon&r=PG", "display_name": "Btuman", "link": "https://stackoverflow.com/users/1026901/btuman"}, "edited": false, "score": 0, "creation_date": 1562685340, "post_id": 56955480, "comment_id": 100449864, "body": "and on an <code>.spotify_track.acousticness</code> that returns that 404?"}, {"owner": {"reputation": 22592, "user_id": 147586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4f5d494ebdc9e7cce1aecf3ce3e8bc1?s=128&d=identicon&r=PG", "display_name": "Shpigford", "link": "https://stackoverflow.com/users/147586/shpigford"}, "reply_to_user": {"reputation": 835, "user_id": 1026901, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d43afae270038a0a826f25f29183ce4?s=128&d=identicon&r=PG", "display_name": "Btuman", "link": "https://stackoverflow.com/users/1026901/btuman"}, "edited": false, "score": 0, "creation_date": 1562685664, "post_id": 56955480, "comment_id": 100450071, "body": "Sorry, if I do <code>spotify_track.acousticness.class</code> when that attribute is <code>nil</code>, it returns 404. When <code>acousticness</code> has a value, then calling <code>.class</code> on it, returns <code>Float</code>."}, {"owner": {"reputation": 835, "user_id": 1026901, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d43afae270038a0a826f25f29183ce4?s=128&d=identicon&r=PG", "display_name": "Btuman", "link": "https://stackoverflow.com/users/1026901/btuman"}, "edited": false, "score": 0, "creation_date": 1562686621, "post_id": 56955480, "comment_id": 100450640, "body": "Would you mind trying <code>spotify_track.respond_to?(&quot;acousticness&quot;)</code>"}, {"owner": {"reputation": 22592, "user_id": 147586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4f5d494ebdc9e7cce1aecf3ce3e8bc1?s=128&d=identicon&r=PG", "display_name": "Shpigford", "link": "https://stackoverflow.com/users/147586/shpigford"}, "reply_to_user": {"reputation": 835, "user_id": 1026901, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d43afae270038a0a826f25f29183ce4?s=128&d=identicon&r=PG", "display_name": "Btuman", "link": "https://stackoverflow.com/users/1026901/btuman"}, "edited": false, "score": 0, "creation_date": 1562686923, "post_id": 56955480, "comment_id": 100450817, "body": "It returns <code>true</code>."}, {"owner": {"reputation": 835, "user_id": 1026901, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d43afae270038a0a826f25f29183ce4?s=128&d=identicon&r=PG", "display_name": "Btuman", "link": "https://stackoverflow.com/users/1026901/btuman"}, "edited": false, "score": 1, "creation_date": 1562687925, "post_id": 56955480, "comment_id": 100451346, "body": "(that was actually a brain fart on my part, since it would always return true). Looking over the documentation, my only guess after going through their documentation/code is raw_response variable: <code>RSpotify.raw_response = true</code>, which should get you an object that you can play with nicer. Beyond that, I would consider opening an issue on their github page, as they seemed to have possibly implemented this incorrectly"}], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1562685041, "creation_date": 1562685041, "answer_id": 56955651, "question_id": 56955480, "link": "https://stackoverflow.com/questions/56955480/how-to-check-for-nil-on-an-object/56955651#56955651", "title": "How to check for nil on an object?", "body": "<p>You can rescue and add some code to it,</p>\n\n<pre><code>rescue RestClient::ExceptionWithResponse =&gt; err\n</code></pre>\n\n<p>Refer <a href=\"https://github.com/rest-client/rest-client#response-callbacks-error-handling\" rel=\"nofollow noreferrer\">rest-client#response-callbacks-error-handling</a></p>\n"}], "owner": {"reputation": 22592, "user_id": 147586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4f5d494ebdc9e7cce1aecf3ce3e8bc1?s=128&d=identicon&r=PG", "display_name": "Shpigford", "link": "https://stackoverflow.com/users/147586/shpigford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1562685041, "creation_date": 1562684507, "last_edit_date": 1562684827, "question_id": 56955480, "link": "https://stackoverflow.com/questions/56955480/how-to-check-for-nil-on-an-object", "title": "How to check for nil on an object?", "body": "<p>I do the following call to get a Ruby object, which returns data from Spotify's API:</p>\n\n<p><code>spotify_track = RSpotify::AudioFeatures.find('3RmAqYZZjiSyMV40hm6rDL')</code></p>\n\n<p>That returns:</p>\n\n<pre><code>#&lt;RSpotify::AudioFeatures:0x00007fe0cc079b30 @acousticness=nil, @analysis_url=\"https://api.spotify.com/v1/audio-analysis/3RmAqYZZjiSyMV40hm6rDL\", @danceability=nil, @duration_ms=35361, @energy=nil, @instrumentalness=nil, @key=1, @liveness=nil, @loudness=-12.186, @mode=1, @speechiness=nil, @tempo=0, @time_signature=nil, @track_href=\"https://api.spotify.com/v1/tracks/3RmAqYZZjiSyMV40hm6rDL\", @valence=nil, @external_urls=nil, @href=nil, @id=\"3RmAqYZZjiSyMV40hm6rDL\", @type=\"audio_features\", @uri=\"spotify:track:3RmAqYZZjiSyMV40hm6rDL\"&gt; \n</code></pre>\n\n<p>When I try to get one of the attributes that's <code>nil</code>, I get a 404 error:</p>\n\n<pre><code>&gt; spotify_track.acousticness\nTraceback (most recent call last):\n        1: from (irb):25\nRestClient::NotFound (404 Not Found)\n</code></pre>\n\n<p>So, how can I check to see if an attribute is <code>nil</code> or not? </p>\n\n<p>The usual things like <code>spotify_track.acousticness.present?</code>, <code>spotify_track.acousticness.blank?</code> and <code>spotify_track.try(:acousticness)</code> all return that same RestClient 404 error.</p>\n\n<p>I'm using the <a href=\"https://github.com/guilhermesad/rspotify\" rel=\"nofollow noreferrer\">RSpotify</a> gem, which makes use of the <a href=\"https://github.com/rest-client/rest-client\" rel=\"nofollow noreferrer\">REST Client</a> gem.</p>\n"}, {"tags": ["ruby", "yaml"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562687431, "post_id": 56955479, "comment_id": 100451080, "body": "You&#39;ve described your end goal but you haven&#39;t shown us what you&#39;ve tried, nor asked a question or indicated what problem you&#39;re having. Please edit your question to include the code you&#39;ve written so far and the specifics of your problem."}, {"owner": {"reputation": 11, "user_id": 11239226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aac8eb65c2b5d8e5ee44e1f1051ffe9e?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/11239226/phantom"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562688095, "post_id": 56955479, "comment_id": 100451434, "body": "Hi Jordan thanks for your reply. I haven&#39;t tried much coz i have no idea how to put them together. But, I have researched about it.I will edit the question on what i found. I haven&#39;t used much of parsing the .txt file to yaml file."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562689017, "post_id": 56955479, "comment_id": 100451921, "body": "Related: 1) <a href=\"https://stackoverflow.com/a/41620747/179125\">stackoverflow.com/a/41620747/179125</a> 2) <a href=\"https://stackoverflow.com/q/55104522/179125\">stackoverflow.com/q/55104522/179125</a>"}], "owner": {"reputation": 11, "user_id": 11239226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aac8eb65c2b5d8e5ee44e1f1051ffe9e?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/11239226/phantom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562688371, "creation_date": 1562684506, "last_edit_date": 1562688371, "question_id": 56955479, "link": "https://stackoverflow.com/questions/56955479/trying-to-parse-my-password-details-into-yaml-instead-of-entering-it-manually", "title": "Trying to parse my password details into yaml, Instead of entering it manually", "body": "<p>I\u2019m storing my password and connection strings in yaml file before. Now, I\u2019m trying to store my password in local drive in \".txt\" format and parse it to the yaml file. If anyone can help me in what way to approach in parsing would be helpful.</p>\n\n<p>Below are the password details and connection strings used in <code>yaml</code> file which I created.</p>\n\n<pre><code>app_server_name: ************\napp_server_username: $USERNAME$\napp_server_password: \u2018**********\u2019 #trying to parse from local drive\napp_yaml_file: /devl/galaxy/common/edwEnvironmentConfig.yml\nenvironment_profile: /home/$USERNAME$/eproduct/difenv\nteradata_logon_file: /home/$USERNAME$/.priv/devl/.td_connection\nproject_root_directory: /home/$USERNAME$/eproduct/\nteradata_auth_type: \u2018ldap\u2019\ntmode: \u2018TERA\u2019\n</code></pre>\n\n<p>What I Found:\n<a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/yaml/rdoc/YAML.html\" rel=\"nofollow noreferrer\">http://ruby-doc.org/stdlib-1.9.3/libdoc/yaml/rdoc/YAML.html</a></p>\n\n<p>Also using the psych gem:\n<a href=\"https://docs.ruby-lang.org/en/2.5.0/Psych.html\" rel=\"nofollow noreferrer\">https://docs.ruby-lang.org/en/2.5.0/Psych.html</a></p>\n\n<p>I expect to parse my password details into yaml instead of manually entering it.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "sentry", "raven"], "comments": [{"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "edited": false, "score": 0, "creation_date": 1562683050, "post_id": 56954834, "comment_id": 100448350, "body": "you can use<code>Raven.user_context email: &#39;example@mail.com&#39;</code>"}, {"owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "reply_to_user": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "edited": false, "score": 0, "creation_date": 1562683174, "post_id": 56954834, "comment_id": 100448436, "body": "I need to send specific custom information everytime, so do you suggest that i should set <code>user_context </code> everytime before calling <code>send_event</code>?"}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "edited": false, "score": 0, "creation_date": 1562683342, "post_id": 56954834, "comment_id": 100448549, "body": "you write a method to set context in application controller and call it in before action"}], "answers": [{"comments": [{"owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "edited": false, "score": 0, "creation_date": 1562683736, "post_id": 56955055, "comment_id": 100448808, "body": "Hi @Sumanth Madishetty, thanks for your answer, not sure i can use an application controller here as the information i need to send changes every time and I am doing this in a background worker."}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "reply_to_user": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "edited": false, "score": 0, "creation_date": 1562683950, "post_id": 56955055, "comment_id": 100448949, "body": "i just used application controller as i thought you would need to set context every time, if you want to do that in explicit methods you can do that too"}], "tags": [], "owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "is_accepted": false, "score": 2, "last_activity_date": 1562683656, "last_edit_date": 1562683656, "creation_date": 1562683195, "answer_id": 56955055, "question_id": 56954834, "link": "https://stackoverflow.com/questions/56954834/send-additional-information-with-raven-send-event/56955055#56955055", "title": "Send additional information with Raven.send_event", "body": "<p>You can set user_context to raven using <code>Raven.user_context</code> method</p>\n\n<p>You can write a method to set context in Application Controller and call the same in before action</p>\n\n<p>For example</p>\n\n<pre><code>Raven.user_context(\n# a unique ID which represents this user\nid: current_user.id, # 1\n\n# the actor's email address, if available\n email: current_user.email, # \"example@example.org\"\n\n # the actor's username, if available\n  username: current_user.username, # \"foo\"\n\n  # the actor's IP address, if available\n  ip_address: request.ip # '127.0.0.1'\n)\n</code></pre>\n\n<p>You can write in application controller as</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\nbefore_action :set_raven_context, if: proc { Rails.env.production? } //If you want to set only in prod\n\ndef set_raven_context\n\n\nRaven.user_context(\n# a unique ID which represents this user\nid: current_user.id, # 1\n\n# the actor's email address, if available\n email: current_user.email, # \"example@example.org\"\n\n # the actor's username, if available\n  username: current_user.username, # \"foo\"\n\n  # the actor's IP address, if available\n  ip_address: request.ip # '127.0.0.1'\n)\n\n#You can also set extra context using `Raven.extra_context`\nRaven.extra_context app: url, environment: Rails.env, time: Time.now\nend\n\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "is_accepted": false, "score": 0, "last_activity_date": 1562837007, "creation_date": 1562837007, "answer_id": 56985874, "question_id": 56954834, "link": "https://stackoverflow.com/questions/56954834/send-additional-information-with-raven-send-event/56985874#56985874", "title": "Send additional information with Raven.send_event", "body": "<p>For anyone facing similar issue, i managed to do it via, under the key <code>extra</code> you can specify any extra keys which you want to send to sentry for further debugging</p>\n\n<pre><code>    Raven.capture_message \"custom message\",\n      logger: 'logger',\n      extra: {\n        time_at: Time.now\n      },\n      tags: {\n        env: Rails.env\n      }\n\n</code></pre>\n"}], "owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562837007, "creation_date": 1562682482, "question_id": 56954834, "link": "https://stackoverflow.com/questions/56954834/send-additional-information-with-raven-send-event", "title": "Send additional information with Raven.send_event", "body": "<p>I have integrated Sentry in my <code>Ruby On Rails</code> application and I want to send a custom event when a specific case happens, I am able to send the events with </p>\n\n<pre><code>Raven.send_event({:message =&gt; 'Custom event'})\n</code></pre>\n\n<p>How do i send additional information related to the same. I need to send for example, <code>user_id</code>, <code>email_id</code>, <code>login_name</code> and other custom parameters. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "hash"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1562678184, "post_id": 56953369, "comment_id": 100445303, "body": "That is not a valid <code>Hash</code> please provide a valid syntax."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1562678578, "post_id": 56953369, "comment_id": 100445538, "body": "That array can&#39;t be &quot;floating&quot; inside the hash, must be assigned to a key."}, {"owner": {"reputation": 55, "user_id": 7768571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b13f227615045903c1d993ad0a7efd3?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh Raju", "link": "https://stackoverflow.com/users/7768571/ganesh-raju"}, "edited": false, "score": 0, "creation_date": 1562678679, "post_id": 56953369, "comment_id": 100445594, "body": "sorry, i just updated final hash."}, {"owner": {"reputation": 835, "user_id": 2208016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bfa904de4db33e337f3d3d74db5b0a?s=128&d=identicon&r=PG", "display_name": "DaveMongoose", "link": "https://stackoverflow.com/users/2208016/davemongoose"}, "edited": false, "score": 1, "creation_date": 1562680016, "post_id": 56953369, "comment_id": 100446443, "body": "A better format for the hash would probably be using the name as the key: <code>{&quot;a&quot; =&gt; [{:date=&gt;20190702, :count=&gt;10}, {:date=&gt;20190703, :count=&gt;20}], &quot;b&quot; =&gt; [{:date=&gt;20190702, :count=&gt;10}]}</code>  If you wanted to, you could even use the date for the inner key, too, but it would depend how you want to use the data: <code>{&quot;a&quot; =&gt; {20190702 =&gt; 10, 20190703 =&gt; 20}, &quot;b&quot; =&gt; {20190702 =&gt; 10}}</code>"}, {"owner": {"reputation": 55, "user_id": 7768571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b13f227615045903c1d993ad0a7efd3?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh Raju", "link": "https://stackoverflow.com/users/7768571/ganesh-raju"}, "reply_to_user": {"reputation": 835, "user_id": 2208016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bfa904de4db33e337f3d3d74db5b0a?s=128&d=identicon&r=PG", "display_name": "DaveMongoose", "link": "https://stackoverflow.com/users/2208016/davemongoose"}, "edited": false, "score": 0, "creation_date": 1562680576, "post_id": 56953369, "comment_id": 100446784, "body": "@DaveMongoose .. thank you. your first case (array inside hash) should be fine."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1562738089, "post_id": 56953369, "comment_id": 100465655, "body": "@GaneshRaju check provided answer and verify"}], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 1, "last_activity_date": 1562694293, "last_edit_date": 1562694293, "creation_date": 1562686459, "answer_id": 56956085, "question_id": 56953369, "link": "https://stackoverflow.com/questions/56953369/make-a-hash-from-active-records/56956085#56956085", "title": "make a hash from active records", "body": "<p>You can have, </p>\n\n<pre><code>hash = users.group_by { |x| x.name }\n\nhash.map do |name, model_data|\n  {  \n     name: name,\n     data: model_data.group_by { |x| x[:date] }.values.map { |z| {date: z[0][:date], count: (z.inject(0) { |m,a| m += a[:count].to_i })} }\n  }\nend\n</code></pre>\n\n<p>Output will be,</p>\n\n<pre><code>[\n    {:name=&gt;\"a\", :data=&gt;[{:date=&gt;20190702, :count=&gt;10}, {:date=&gt;20190703, :count=&gt;20}.....]},\n    {:name=&gt;\"b\", :data=&gt;[{:date=&gt;20190702, :count=&gt;10}, ...etc]},\n    {:name=&gt;\"c\", :data=&gt;[{:date=&gt;20190702, :count=&gt;8}, {:date=&gt;20190703, :count=&gt;20}, ..etc]}\n]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 7768571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b13f227615045903c1d993ad0a7efd3?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh Raju", "link": "https://stackoverflow.com/users/7768571/ganesh-raju"}, "edited": false, "score": 0, "creation_date": 1562849945, "post_id": 56958155, "comment_id": 100514178, "body": "tq for ur answer. extend to that if any date was missing ( ex: expected output having 2nd and 4rd and third having no data) .. how to make hash with missing date with count will be zero"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 55, "user_id": 7768571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b13f227615045903c1d993ad0a7efd3?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh Raju", "link": "https://stackoverflow.com/users/7768571/ganesh-raju"}, "edited": false, "score": 1, "creation_date": 1562852817, "post_id": 56958155, "comment_id": 100516040, "body": "@GaneshRaju that is a new and different question please feel free to post as such"}, {"owner": {"reputation": 55, "user_id": 7768571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b13f227615045903c1d993ad0a7efd3?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh Raju", "link": "https://stackoverflow.com/users/7768571/ganesh-raju"}, "edited": false, "score": 0, "creation_date": 1562853003, "post_id": 56958155, "comment_id": 100516164, "body": "sure I will post as new question."}, {"owner": {"reputation": 55, "user_id": 7768571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b13f227615045903c1d993ad0a7efd3?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh Raju", "link": "https://stackoverflow.com/users/7768571/ganesh-raju"}, "edited": false, "score": 0, "creation_date": 1562925216, "post_id": 56958155, "comment_id": 100541915, "body": "{&quot;a&quot; =&gt; {20190702 =&gt; 10, 20190703 =&gt; 20}, &quot;b&quot; =&gt; {20190702 =&gt; 10}} can we make in this format."}, {"owner": {"reputation": 55, "user_id": 7768571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b13f227615045903c1d993ad0a7efd3?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh Raju", "link": "https://stackoverflow.com/users/7768571/ganesh-raju"}, "edited": false, "score": 0, "creation_date": 1562931500, "post_id": 56958155, "comment_id": 100545144, "body": "Thank you brother. I will try it."}, {"owner": {"reputation": 55, "user_id": 7768571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b13f227615045903c1d993ad0a7efd3?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh Raju", "link": "https://stackoverflow.com/users/7768571/ganesh-raju"}, "edited": false, "score": 1, "creation_date": 1562934946, "post_id": 56958155, "comment_id": 100546911, "body": "<code>data.each_with_object(empty_hash) {|((site,date),count),hash| hash[site].store date, count }</code>"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 1, "last_activity_date": 1562846965, "last_edit_date": 1562846965, "creation_date": 1562694683, "answer_id": 56958155, "question_id": 56953369, "link": "https://stackoverflow.com/questions/56953369/make-a-hash-from-active-records/56958155#56958155", "title": "make a hash from active records", "body": "<p>So given the fact that this is ActiveRecord data to begin with why not something like </p>\n\n<pre><code>data = Model.group(:name,:date).order(name: :asc, date: :asc).sum(:count)\ndata.each_with_object(Hash.new {|h,k| h[k] = []}) do |((name,date),count),obj|\n  obj[name] &lt;&lt; {date: date, count: count} \nend\n</code></pre>\n\n<p>This will produce: </p>\n\n<pre><code>{\n  \"a\"=&gt;[{:date=&gt;20190702, :count=&gt;0}, {:date=&gt;20190703, :count=&gt;20}],\n  \"b\"=&gt;[{:date=&gt;20190702, :count=&gt;10}],\n  \"c\"=&gt;[{:date=&gt;20190702, :count=&gt;8}, {:date=&gt;20190703, :count=&gt;20}]\n}\n</code></pre>\n\n<p>and all of the summing and grouping is placed on the SQL side of things (which is very efficient at aggregation) </p>\n"}], "owner": {"reputation": 55, "user_id": 7768571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b13f227615045903c1d993ad0a7efd3?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh Raju", "link": "https://stackoverflow.com/users/7768571/ganesh-raju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1562750469, "accepted_answer_id": 56958155, "answer_count": 2, "score": 0, "last_activity_date": 1562846965, "creation_date": 1562677812, "last_edit_date": 1562678617, "question_id": 56953369, "link": "https://stackoverflow.com/questions/56953369/make-a-hash-from-active-records", "closed_reason": "Needs details or clarity", "title": "make a hash from active records", "body": "<p>It could be have similar names and dates. but, take sum of count of similar dates.</p>\n\n<pre><code>   #&lt;ActiveRecord::Relation [Model name: \"a\", date: \"20190703\", count: 20&gt;\n   #&lt;ActiveRecord::Relation [Model name: \"b\", date: \"20190702\", count: 10&gt;\n   #&lt;ActiveRecord::Relation [Model name: \"a\", date: \"20190702\", count: nil&gt;\n   #&lt;ActiveRecord::Relation [Model name: \"c\", date: \"20190703\", count: 20&gt;\n   #&lt;ActiveRecord::Relation [Model name: \"c\", date: \"20190702\", count: 3&gt;\n   #&lt;ActiveRecord::Relation [Model name: \"c\", date: \"20190702\", count: 5&gt; ...etc\n</code></pre>\n\n<p>Expected result would be like</p>\n\n<pre><code>{\n    :name=&gt;\"a\", :data=&gt;[{:date=&gt;20190702, :count=&gt;10}, {:date=&gt;20190703, :count=&gt;20}.....]\n    :name=&gt;\"b\", :data=&gt;[{:date=&gt;20190702, :count=&gt;10}, ...etc]\n    :name=&gt;\"c\", :data=&gt;[{:date=&gt;20190702, :count=&gt;8}, {:date=&gt;20190703, :count=&gt;20}, ..etc]\n}\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1562677428, "post_id": 56953233, "comment_id": 100444867, "body": "It&#39;s because the floor of <code>(-1 - 1&#47;24)</code> equals <code>-2</code>."}, {"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1562677605, "post_id": 56953233, "comment_id": 100444983, "body": "Does it mean that Ruby always calls <code>#floor</code> under the hood in case of Integer division? And where does <code>(-1 - 1&#47;24)</code> come from?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1562682974, "post_id": 56953233, "comment_id": 100448308, "body": "Here is a more detailed explanation behind the behaviour: <a href=\"https://stackoverflow.com/a/19518866/1954610\">stackoverflow.com/a/19518866/1954610</a>"}, {"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1562683459, "post_id": 56953233, "comment_id": 100448626, "body": "@TomLord Wow, so there were some historical discussions like that, thanks a lot! After  10 years of Ruby, I&#39;ve never asked myself about it until today :)."}], "answers": [{"comments": [{"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1562678110, "post_id": 56953292, "comment_id": 100445261, "body": "I have not asked about <code>#divmod</code> method but <code>#&#47;</code>."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1562680046, "post_id": 56953292, "comment_id": 100446458, "body": "See the update."}, {"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1562680257, "post_id": 56953292, "comment_id": 100446562, "body": "it is really unclear (IMHO) that all the call to <code>#&#47;</code> method will use <code>#floor</code>."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1562680040, "last_edit_date": 1562680040, "creation_date": 1562677553, "answer_id": 56953292, "question_id": 56953233, "link": "https://stackoverflow.com/questions/56953233/negative-number-division-in-ruby/56953292#56953292", "title": "Negative number division in Ruby", "body": "<p>Interger division in Ruby returns floor or the floating point result of the division:</p>\n\n<p><a href=\"https://ruby-doc.org/core-2.6/Numeric.html#method-i-div\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.6/Numeric.html#method-i-div</a></p>\n\n<blockquote>\n  <p>Uses <code>/</code> to perform division, then converts the result to an integer. Numeric does not define the <code>/</code> operator; this is left to subclasses.</p>\n  \n  <p>Equivalent to <code>num.divmod(numeric)[0]</code>.</p>\n</blockquote>\n\n<p>And <a href=\"https://ruby-doc.org/core-2.6/Numeric.html#method-i-divmod\" rel=\"nofollow noreferrer\"><code>divmod</code></a> uses <code>floor</code>:\n:</p>\n\n<pre><code>q = floor(x/y)\nx = q*y + r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": false, "score": 4, "last_activity_date": 1562678277, "creation_date": 1562678277, "answer_id": 56953527, "question_id": 56953233, "link": "https://stackoverflow.com/questions/56953233/negative-number-division-in-ruby/56953527#56953527", "title": "Negative number division in Ruby", "body": "<p>A way you can think about integer division is:</p>\n\n<ol>\n<li>You do the floating point division.</li>\n<li>You round the result down.</li>\n</ol>\n\n<p>Hence:</p>\n\n<pre><code>(25.0 / 24.0).floor  # =&gt; 1\n(-25.0 / 24.0).floor # =&gt; -2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1562679021, "post_id": 56953582, "comment_id": 100445819, "body": "Pheu, this one just adds another one question: <code>-25&#47;24 =&gt; -2</code>, but  <code>(-25&#47;24) =&gt; -1</code>"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1562679166, "post_id": 56953582, "comment_id": 100445906, "body": "@belgoros, nice question, I found answer in python doc. Please check edited answer."}, {"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1562679296, "post_id": 56953582, "comment_id": 100445972, "body": "thank you. So my suggestion was correct about calling <code>#floor</code> at the end of every division under the hood? I didn&#39;t find any answer in Ruby docs."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1562679384, "post_id": 56953582, "comment_id": 100446028, "body": "@belgoros, Yes it was all about floor to negative side :)"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 1, "creation_date": 1562683408, "post_id": 56953582, "comment_id": 100448596, "body": "@belgoros, it&#39;s all about precedence, so <code>-(25.0&#47;24.0).floor</code> it&#39;s like <code>-((25.0&#47;24.0).floor) #--&gt; -(1)</code>"}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 3, "last_activity_date": 1562679121, "last_edit_date": 1562679121, "creation_date": 1562678426, "answer_id": 56953582, "question_id": 56953233, "link": "https://stackoverflow.com/questions/56953233/negative-number-division-in-ruby/56953582#56953582", "title": "Negative number division in Ruby", "body": "<p>I could simply find desired functionality by using parenthesis,</p>\n\n<pre><code>-(25/24)\n# =&gt; -1\n</code></pre>\n\n<p>Perhaps, <strong>why -25/24 surprised you:</strong></p>\n\n<p>For the actual values in float division provide you <code>-1.041</code></p>\n\n<p>Your result using integer division is being rounded down toward the more negative value of -2. This is also known as <strong>Floor division</strong></p>\n"}, {"comments": [{"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1562684166, "post_id": 56955303, "comment_id": 100449101, "body": "Thank you for such a detailed explanation. By the way, the link to <a href=\"https://stackoverflow.com/wiki/Donald_Knuth\">SO Knuth</a> resource is broken."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1562684206, "post_id": 56955303, "comment_id": 100449124, "body": "@belgoros it was meant to point to Wikipedia, fixed it :-)"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1562738192, "post_id": 56955303, "comment_id": 100465697, "body": "This is concrete explanation, thanks!"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 4, "last_activity_date": 1562742083, "last_edit_date": 1562742083, "creation_date": 1562683957, "answer_id": 56955303, "question_id": 56953233, "link": "https://stackoverflow.com/questions/56953233/negative-number-division-in-ruby/56955303#56955303", "title": "Negative number division in Ruby", "body": "<p>Different programming languages use different definitions for (negative) integer division. Ruby uses the one described by <a href=\"https://en.wikipedia.org/wiki/Donald_Knuth\" rel=\"nofollow noreferrer\">Knuth</a> in <a href=\"https://en.wikipedia.org/wiki/Concrete_Mathematics\" rel=\"nofollow noreferrer\">Concrete Mathematics</a>, p. 82.<sup>\u2020</sup></p>\n\n<p>It can be illustrated by an example: let's say we are working with weeks. Our weeks start on Sunday. Numbers are zero-based, so we begin at week <code>0</code>, day <code>0</code>:</p>\n\n<pre><code>----- 0 -----\n0 1 2 3 4 5 6\nS M T W T F S\n^\n</code></pre>\n\n<p>If we move <em>forward</em> by 9 days, we are at week <code>1</code>, day <code>2</code>:</p>\n\n<pre><code>----- 0 -----   ----- 1 -----\n0 1 2 3 4 5 6   0 1 2 3 4 5 6\nS M T W T F S   S M T W T F S\n                    ^\n</code></pre>\n\n<p>These values are returned by <code>/</code> and <code>%</code>:</p>\n\n<pre><code>9 / 7 #=&gt; 1\n9 % 7 #=&gt; 2\n</code></pre>\n\n<p>If we move <em>backward</em> by 9 days (from 0), we are at week <code>-2</code>, day <code>5</code>:</p>\n\n<pre><code>---- -2 -----   ---- -1 -----   ----- 0 -----\n0 1 2 3 4 5 6   0 1 2 3 4 5 6   0 1 2 3 4 5 6\nS M T W T F S   S M T W T F S   S M T W T F S\n          ^\n</code></pre>\n\n<p>Using <code>/</code> and <code>%</code>:</p>\n\n<pre><code>-9 / 7 #=&gt; -2\n-9 % 7 #=&gt; 5\n</code></pre>\n\n<hr>\n\n<p><sup>\u2020</sup> There's a funny note on the margin of that page:</p>\n\n<blockquote>\n  <p><em>Beware of computer languages that use another definition.</em></p>\n</blockquote>\n"}], "owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "closed_date": 1562691006, "answer_count": 4, "score": 1, "last_activity_date": 1562742083, "creation_date": 1562677342, "last_edit_date": 1562677437, "question_id": 56953233, "link": "https://stackoverflow.com/questions/56953233/negative-number-division-in-ruby", "closed_reason": "Duplicate", "title": "Negative number division in Ruby", "body": "<p>Can anybody explain the below result of the division of a negative number:</p>\n\n<pre><code>2.6.1 :001 &gt; -25/24\n =&gt; -2 \n2.6.1 :002 &gt; 25/24\n =&gt; 1 \n\n</code></pre>\n\n<p>Why is it <code>-2</code> instead of <code>-1</code>?</p>\n\n<p>More examples on <em>weird</em> behaviour:</p>\n\n<pre><code>2.6.1 :003 &gt; 24/25\n =&gt; 0 \n2.6.1 :004 &gt; -24/25\n =&gt; -1 \n</code></pre>\n\n<p>Any ideas?\nThank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch"], "comments": [{"owner": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "edited": false, "score": 0, "creation_date": 1562676468, "post_id": 56952859, "comment_id": 100444284, "body": "It sees the <code>City model</code> link is not the correct one (same as the <code>JS</code> one)"}, {"owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "reply_to_user": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "edited": false, "score": 0, "creation_date": 1562676998, "post_id": 56952859, "comment_id": 100444608, "body": "@Val Oh, I didn&#39;t notice. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "is_accepted": true, "score": 0, "last_activity_date": 1562682516, "creation_date": 1562682516, "answer_id": 56954850, "question_id": 56952859, "link": "https://stackoverflow.com/questions/56952859/i-get-an-error-unknown-key-for-a-value-string-in-q/56954850#56954850", "title": "I get an error &#39;Unknown key for a VALUE_STRING in [q]&#39;", "body": "<p>Still, the wrong parameters came to me. </p>\n\n<p>Corrected so:</p>\n\n<p><em>Location controller:</em></p>\n\n<pre><code>def fetch_locations\n    locations = []\n    p params[:q]\n    search = CountryCity.search(params[:q])\n\n    search.each do |result|\n      locations &lt;&lt; result.city + ', ' + result.name\n    end\n\n    render json: {locations: locations}\nend\n</code></pre>\n\n<p><em>City model:</em></p>\n\n<pre><code>def self.search params\n    CountryCity.__elasticsearch__.search(params)\nend\n</code></pre>\n"}], "owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 56954850, "answer_count": 1, "score": 1, "last_activity_date": 1562682516, "creation_date": 1562676141, "last_edit_date": 1562676897, "question_id": 56952859, "link": "https://stackoverflow.com/questions/56952859/i-get-an-error-unknown-key-for-a-value-string-in-q", "title": "I get an error &#39;Unknown key for a VALUE_STRING in [q]&#39;", "body": "<p>I use elasticsearch for the drop-down list of cities when searching.</p>\n\n<pre><code>Error: Elasticsearch::Transport::Transport::Errors::BadRequest Unknown key for a VALUE_STRING in [q]\n</code></pre>\n\n<p>I checked all the parameters that are passed, everything should be correct</p>\n\n<p>Location controller:\n<a href=\"https://pastebin.com/CMEEXSU3\" rel=\"nofollow noreferrer\">https://pastebin.com/CMEEXSU3</a></p>\n\n<p>City model:\n<a href=\"https://pastebin.com/XWWNTDFD\" rel=\"nofollow noreferrer\">https://pastebin.com/XWWNTDFD</a></p>\n\n<p>JS:\n<a href=\"https://pastebin.com/kEDes10b\" rel=\"nofollow noreferrer\">https://pastebin.com/kEDes10b</a></p>\n\n<p>Error:\n<a href=\"https://pastebin.com/k48yPmKD\" rel=\"nofollow noreferrer\">https://pastebin.com/k48yPmKD</a></p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "edited": false, "score": 0, "creation_date": 1562673511, "post_id": 56952070, "comment_id": 100442544, "body": "Welcome to stackoverflow.  Here we help programmers.  What is your programming question?"}, {"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1562674005, "post_id": 56952070, "comment_id": 100442835, "body": "The programming question is how can they speed up gem install. Seems clear enough."}, {"owner": {"reputation": 835, "user_id": 1026901, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d43afae270038a0a826f25f29183ce4?s=128&d=identicon&r=PG", "display_name": "Btuman", "link": "https://stackoverflow.com/users/1026901/btuman"}, "edited": false, "score": 0, "creation_date": 1562684125, "post_id": 56952070, "comment_id": 100449077, "body": "I would consider using RVM to help manage this. <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">rvm.io/rvm/install</a>"}], "answers": [{"tags": [], "owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1562674221, "creation_date": 1562674221, "answer_id": 56952304, "question_id": 56952070, "link": "https://stackoverflow.com/questions/56952070/slow-gem-install-on-centos-vm/56952304#56952304", "title": "Slow gem install on centos vm", "body": "<p>Try <code>bundle install --jobs=4</code> to support parallel downloads, though it's not a huge increase (reported as <a href=\"https://philna.sh/blog/2017/06/12/speed-up-bundle-install-with-this-one-trick/\" rel=\"nofollow noreferrer\">1.6x here</a>.</p>\n\n<p>Gem install can indeed be slow, hopefully running it once will help with local caching on CDNs.</p>\n"}], "owner": {"reputation": 31, "user_id": 9987664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0abac047f54749fb48a3e9cdc702f3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Dor6", "link": "https://stackoverflow.com/users/9987664/dor6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562674221, "creation_date": 1562673424, "last_edit_date": 1562673545, "question_id": 56952070, "link": "https://stackoverflow.com/questions/56952070/slow-gem-install-on-centos-vm", "title": "Slow gem install on centos vm", "body": "<p>At work I have a private gems server on a centos 7 with ruby 2.2.\nWe updated our ruby version to ruby 2.4 and now new gems we want to use can't be installed on this server.\nSo we created a new server using ruby 2.4 on centos 7.</p>\n\n<p>The problem is that installing gems is taking stpendesly amount of time. Something we didn't have problem with on the old gems server.</p>\n\n<p>How can I fix it? </p>\n\n<p>Note the servers are offline so we use gem install  - - local</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cqrs", "event-sourcing", "rails-event-store"], "answers": [{"tags": [], "owner": {"reputation": 271, "user_id": 169237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3kh1h.png?s=128&g=1", "display_name": "Pawel Pacana", "link": "https://stackoverflow.com/users/169237/pawel-pacana"}, "is_accepted": true, "score": 2, "last_activity_date": 1563197985, "creation_date": 1563197985, "answer_id": 57041018, "question_id": 56951441, "link": "https://stackoverflow.com/questions/56951441/cleanly-validating-event-schemas-in-railseventstore/57041018#57041018", "title": "Cleanly validating event schemas in RailsEventStore", "body": "<p>An example of Dry::Struct schema can be found in sample app repository:</p>\n\n<p><a href=\"https://github.com/RailsEventStore/cqrs-es-sample-with-res/blob/e4983433bc5d71252da58a23da9374f17e1d5cb3/ordering/lib/ordering/order_submitted.rb\" rel=\"nofollow noreferrer\">https://github.com/RailsEventStore/cqrs-es-sample-with-res/blob/e4983433bc5d71252da58a23da9374f17e1d5cb3/ordering/lib/ordering/order_submitted.rb</a> + \n<a href=\"https://github.com/RailsEventStore/cqrs-es-sample-with-res/blob/e4983433bc5d71252da58a23da9374f17e1d5cb3/ordering/lib/ordering/order_submitted.rb\" rel=\"nofollow noreferrer\">https://github.com/RailsEventStore/cqrs-es-sample-with-res/blob/e4983433bc5d71252da58a23da9374f17e1d5cb3/ordering/lib/ordering/order_submitted.rb</a></p>\n\n<p>While inheriting from <code>RailsEventStore::Event</code> is the simplest, it is not a requirement. A good example of that can be Protobuf integration: \n<a href=\"https://railseventstore.org/docs/protobuf/#defining-events\" rel=\"nofollow noreferrer\">https://railseventstore.org/docs/protobuf/#defining-events</a>. It resembles an event envelope even more.</p>\n\n<p>An event passed to RES is required to respond at least to <code>event_id</code>, <code>data</code>, <code>metadata</code> and <code>type</code>:\n<a href=\"https://github.com/RailsEventStore/rails_event_store/blob/cfc91c9cb367e514ba1c6de1a711a7610780b520/ruby_event_store/lib/ruby_event_store/mappers/transformation/domain_event.rb#L9-L12\" rel=\"nofollow noreferrer\">https://github.com/RailsEventStore/rails_event_store/blob/cfc91c9cb367e514ba1c6de1a711a7610780b520/ruby_event_store/lib/ruby_event_store/mappers/transformation/domain_event.rb#L9-L12</a>. You can also see there how it is instantiated when loaded from the store.</p>\n\n<p>This behaviour can be altered when you provide your <a href=\"https://railseventstore.org/docs/mapping_serialization/\" rel=\"nofollow noreferrer\">own mapper</a> or just replace <code>RubyEventStore::Mappers::Transformation::DomainEvent</code> responsible for that transformation. </p>\n\n<p>Please compare:\n<a href=\"https://github.com/RailsEventStore/rails_event_store/blob/cfc91c9cb367e514ba1c6de1a711a7610780b520/ruby_event_store/lib/ruby_event_store/mappers/default.rb\" rel=\"nofollow noreferrer\">https://github.com/RailsEventStore/rails_event_store/blob/cfc91c9cb367e514ba1c6de1a711a7610780b520/ruby_event_store/lib/ruby_event_store/mappers/default.rb</a></p>\n\n<p>vs.\n<a href=\"https://github.com/RailsEventStore/rails_event_store/blob/cfc91c9cb367e514ba1c6de1a711a7610780b520/ruby_event_store/lib/ruby_event_store/mappers/protobuf.rb\" rel=\"nofollow noreferrer\">https://github.com/RailsEventStore/rails_event_store/blob/cfc91c9cb367e514ba1c6de1a711a7610780b520/ruby_event_store/lib/ruby_event_store/mappers/protobuf.rb</a></p>\n"}], "owner": {"reputation": 3908, "user_id": 322863, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cff6feb283b9f194892e8f6737eed875?s=128&d=identicon&r=PG", "display_name": "aef", "link": "https://stackoverflow.com/users/322863/aef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 1, "accepted_answer_id": 57041018, "answer_count": 1, "score": 1, "last_activity_date": 1563197985, "creation_date": 1562671309, "question_id": 56951441, "link": "https://stackoverflow.com/questions/56951441/cleanly-validating-event-schemas-in-railseventstore", "title": "Cleanly validating event schemas in RailsEventStore", "body": "<p>I am building a CQRS and event sourced application with Rails and RailsEventStore. In RailsEventStore it seems you are supposed to inherit classes that represent events from RailsEventStore::Event.</p>\n\n<pre><code>class UserRegistered &lt; RailsEventStore::Event\n  \u2026\nend\n</code></pre>\n\n<p>This base class exposes an event_id, a data hash and an optional metadata hash. As far as I understand, this looks more like what Greg Young once called an event envelope and my domain model is supposed to only care for the actual event, which is stored within the envelopes data hash.</p>\n\n<p>Now I would like to enforce a schema on the my event. But it seems like RailsEventStore wants me to model a subclass of RailsEventStore::Event (the envelope) for each event type differentiated by my domain model.</p>\n\n<p>Validating the contents of the data hash in a subclass of the envelope feels hacky and dirty. I always need to override the initialize method and pass on stuff that I really don't care about.</p>\n\n<pre><code>class UserRegistered &lt; RailsEventStore::Event\n  def initialize(event_id: SecureRandom.uuid, metadata: nil, data: {})\n    ensure_valid!(data)\n\n    super(event_id: event_id, metadata: metadata, data: data)\n  end\n\n  def ensure_valid!(data)\n    raise ArgumentError unless data[:user_id]\n  end\nend\n</code></pre>\n\n<p>Also accessing all the events attributes through <code>event.data[:my_attribute]</code> doesn't feel nice. Adding lots of delegation methods for each envelope subclass seems to be a waste as well.</p>\n\n<p>I would rather like to model a plain Ruby object or use something like Dry::Struct to enforce a schema on the content attributes of my event.</p>\n\n<pre><code>class UserRegistered &lt; Dry::Struct\n  attribute :user_id, Dry::Types::String\nend\n</code></pre>\n\n<p>Am I missing something here? How can I validate my events in a clean way?</p>\n"}, {"tags": ["ruby", "time"], "comments": [{"owner": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "edited": false, "score": 0, "creation_date": 1562666396, "post_id": 56950019, "comment_id": 100438842, "body": "I think you forgot the code, please edit your question"}], "answers": [{"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 6, "last_activity_date": 1562673779, "last_edit_date": 1562673779, "creation_date": 1562666753, "answer_id": 56950162, "question_id": 56950019, "link": "https://stackoverflow.com/questions/56950019/ruby-how-many-days/56950162#56950162", "title": "Ruby - How many days?", "body": "<p>You can create a <a href=\"https://ruby-doc.org/stdlib-2.6.1/libdoc/date/rdoc/DateTime.html#method-c-new\" rel=\"nofollow noreferrer\"><code>Date</code></a> object directly with:</p>\n\n<pre><code>Date.new(year, month, day)\n</code></pre>\n\n<p>There's no need to convert it to a string and parse. Parsing could also be dangerous. Is <code>1982-04-02</code> the 4th of February or 2nd of April?</p>\n\n<p>You cannot add a number and string like this, BTW. Should <code>1 + '2'</code> be <code>'12'</code> or <code>3</code>? Ruby cannot decide for you so you need to explicitly convert integers to string.</p>\n\n<pre><code>day.to_s + \"-\" + month.to_s + \"-\" + year.to_s\n</code></pre>\n\n<p>or simply</p>\n\n<pre><code>[day, month, year].join('-')\n</code></pre>\n\n<p>But you don't need it anyway:</p>\n\n<pre><code>require 'date'\n\ndef age_in_days(day, month, year)\n  birthdate = Date.new(year, month, day)\n  (Date.today - birthdate).to_i\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11682335"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 56950162, "answer_count": 1, "score": 2, "last_activity_date": 1562673779, "creation_date": 1562666263, "last_edit_date": 1562666625, "question_id": 56950019, "link": "https://stackoverflow.com/questions/56950019/ruby-how-many-days", "title": "Ruby - How many days?", "body": "<p>I need to calculate how many days lived on earth based on three parameters : day, month and year.\nI don't know how to convert the input onto a date; and then how to convert the date onto number of days.\nThis is my code for the moment...  </p>\n\n<pre><code>require 'date'\ndef age_in_days(day, month, year)\n  lived = (day+\"-\"+month+\"-\"+year).to_s\n  date_lived Date.parse(lived)\n  return (Date.today - date_lived).to_i\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "sorting"], "comments": [{"owner": {"reputation": 860, "user_id": 1412141, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e5898502b5a6abf191712c8aaec73780?s=128&d=identicon&r=PG", "display_name": "Smek", "link": "https://stackoverflow.com/users/1412141/smek"}, "edited": false, "score": 0, "creation_date": 1562669422, "post_id": 56948097, "comment_id": 100440366, "body": "Which database do you use? MySQL? PostgreSQL? Or something else?"}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "reply_to_user": {"reputation": 860, "user_id": 1412141, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e5898502b5a6abf191712c8aaec73780?s=128&d=identicon&r=PG", "display_name": "Smek", "link": "https://stackoverflow.com/users/1412141/smek"}, "edited": false, "score": 0, "creation_date": 1562721535, "post_id": 56948097, "comment_id": 100462143, "body": "@Smek Didn&#39;t see this in time - I use Postgres."}], "answers": [{"tags": [], "owner": {"reputation": 7736, "user_id": 687142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VErBp.jpg?s=128&g=1", "display_name": "xlembouras", "link": "https://stackoverflow.com/users/687142/xlembouras"}, "is_accepted": true, "score": 0, "last_activity_date": 1562661106, "creation_date": 1562661106, "answer_id": 56948432, "question_id": 56948097, "link": "https://stackoverflow.com/questions/56948097/how-to-retrieve-relational-data-from-rails-db-in-the-form-of-a-nested-hash/56948432#56948432", "title": "How to retrieve relational data from Rails DB in the form of a nested hash?", "body": "<p>You are almost there!</p>\n\n<p>You can use <a href=\"https://apidock.com/ruby/Enumerable/each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a> to fix your output a bit.</p>\n\n<pre><code>data = StatusRecord.joins(:status, :user)\n  .where(statuses: {name: ['active', 'inactive']})\n  .select('status_records.date, statuses.name as status, users.name as username')\n  .each_with_object(Hash.new {|h,k| h[k] = Hash.new {|hh,kk| hh[kk] = [] } }) do |sr, hash|\n    hash[sr.status][sr.username] &lt;&lt; sr.date\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 860, "user_id": 1412141, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e5898502b5a6abf191712c8aaec73780?s=128&d=identicon&r=PG", "display_name": "Smek", "link": "https://stackoverflow.com/users/1412141/smek"}, "is_accepted": false, "score": 0, "last_activity_date": 1562670043, "creation_date": 1562670043, "answer_id": 56951081, "question_id": 56948097, "link": "https://stackoverflow.com/questions/56948097/how-to-retrieve-relational-data-from-rails-db-in-the-form-of-a-nested-hash/56951081#56951081", "title": "How to retrieve relational data from Rails DB in the form of a nested hash?", "body": "<p>Here is a pure sql solution <strong>please note this only works with MySQL 5.7+</strong> but perhaps there are similar solutions for other databases.</p>\n\n<pre><code>    SELECT JSON_OBJECT(s.name, GROUP_CONCAT(srs.record)) AS record\n    FROM statuses AS s\n         INNER JOIN (SELECT JSON_OBJECT(u.name, GROUP_CONCAT(date)) AS record, status_id\n                     FROM status_records AS sr\n                              JOIN users u ON u.id = sr.user_id GROUP BY\n                          u.id,\n                          status_id) srs ON srs.status_id = s.id\n    GROUP BY s.id;\n</code></pre>\n\n<p>You would be able to parse the resulting record column of each row into a hash.</p>\n"}], "owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56948432, "answer_count": 2, "score": 0, "last_activity_date": 1562670043, "creation_date": 1562659845, "last_edit_date": 1562660169, "question_id": 56948097, "link": "https://stackoverflow.com/questions/56948097/how-to-retrieve-relational-data-from-rails-db-in-the-form-of-a-nested-hash", "title": "How to retrieve relational data from Rails DB in the form of a nested hash?", "body": "<p>In my Rails DB, I have these tables:</p>\n\n<ul>\n<li><code>users</code></li>\n<li><code>statuses</code> (let's say their names include <code>active</code> and <code>inactive</code>), </li>\n<li><code>status_records</code> for each date for each user to show their status (e.g. <code>date: '2019-07-09', user: User.first, status: Status.find_by(name: 'active')</code></li>\n</ul>\n\n<p>I would like to retrieve data in a nested hash like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>data = {\n  \"active\"=&gt;{\n    \"Rick\"=&gt;[\"2019-07-09\", \"2019-07-10\"],\n    \"Morty\"=&gt;[\"2019-07-09\", \"2019-07-10\"],\n    \"Summer\"=&gt;[\"2019-07-09\", \"2019-07-10\"]\n  },\n  \"inactive\"=&gt;{\n    \"Rick\"=&gt;[\"2019-07-01\", \"2019-07-02\", \"2019-07-03\"],\n    \"Summer\"=&gt;[\"2019-07-15\"]\n  }\n}\n</code></pre>\n\n<p>So far, I've gotten this far.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>data = StatusRecord.joins(:status, :user)\n  .where(statuses: {name: ['active', 'inactive']})\n  .select('status_records.date, statuses.name as status, users.name as username')\n  .group_by(|record| [record.status, record.username])\n</code></pre>\n\n<p>The above brings me to the data structure below, but as I wrote previously, this is not exactly what I want (I want to organise the data as a nested hash).</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>data = {\n  [\"active\", \"Rick\"]=&gt;[\"2019-07-09\", \"2019-07-10\"],\n  [\"active\", \"Morty\"]=&gt;[\"2019-07-09\", \"2019-07-10\"],\n  [\"active\", \"Summer\"]=&gt;[\"2019-07-09\", \"2019-07-10\"],\n  [\"inactive\", \"Rick\"]=&gt; [\"2019-07-01\", \"2019-07-02\", \"2019-07-03\"],\n  [\"inactive\", \"Summer\"]=&gt;[\"2019-07-15\"]\n}\n</code></pre>\n\n<p>Is there a way to rewrite this query so that I can get the data in the desired structure?</p>\n"}, {"tags": ["ruby", "windows", "git-bash"], "comments": [{"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 3, "creation_date": 1562655824, "post_id": 56946202, "comment_id": 100433338, "body": "Try <code>STDOUT.flush</code> before <code>input = gets</code> or <code>STDOUT.sync = true</code> at the begining of the program."}], "owner": {"reputation": 31, "user_id": 11757798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa2b7a8f7892909bafaa72f96b6b00de?s=128&d=identicon&r=PG&f=1", "display_name": "domsti", "link": "https://stackoverflow.com/users/11757798/domsti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1562652307, "creation_date": 1562652307, "question_id": 56946202, "link": "https://stackoverflow.com/questions/56946202/git-bash-on-windows-with-ruby-waiting-for-gets-input-before-printing-prompt", "title": "Git Bash on Windows with Ruby: Waiting for gets() input before printing prompt?", "body": "<p>I'm new to programming/Ruby and can't figure out this quirky issue...</p>\n\n<p>Running this Ruby code through Git Bash on Windows:</p>\n\n<p><strong>$ ruby test.rb</strong></p>\n\n<pre><code>puts \"Give me input: \"\ninput = gets\nputs \"You gave me #{input}\"\n</code></pre>\n\n<p>does not print the \"Give me input: \" string before waiting for input with gets() as it should. Instead it immediately waits for input before printing the prompt and the result. I've tried using $stdout.flush after the prompt puts() but the output remains the same.</p>\n\n<p>Every other terminal I've used works fine though.</p>\n"}, {"tags": ["ruby", "intellij-idea", "rubygems"], "comments": [{"owner": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1562661253, "post_id": 56945567, "comment_id": 100436116, "body": "Just to be sure, does that directory reside in the project?"}, {"owner": {"reputation": 3668, "user_id": 367796, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/knppv.jpg?s=128&g=1", "display_name": "steinybot", "link": "https://stackoverflow.com/users/367796/steinybot"}, "reply_to_user": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1562835121, "post_id": 56945567, "comment_id": 100505294, "body": "No it doesn&#39;t. Does that make a difference?"}, {"owner": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1563194912, "post_id": 56945567, "comment_id": 100607918, "body": "That was for understanding your structure. Have you tried setting this path in the bundler config file?"}], "owner": {"reputation": 3668, "user_id": 367796, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/knppv.jpg?s=128&g=1", "display_name": "steinybot", "link": "https://stackoverflow.com/users/367796/steinybot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562648111, "creation_date": 1562648111, "question_id": 56945567, "link": "https://stackoverflow.com/questions/56945567/how-do-i-debug-a-ruby-gem-in-a-different-directory-in-the-context-of-a-bundle-in", "title": "How do I debug a Ruby Gem in a different directory in the context of a bundle in IntelliJ IDEA", "body": "<p>I am using IntelliJ IDEA to develop a Ruby gem.</p>\n\n<p>To run the gem from the command line without installing it first I am using:</p>\n\n<pre><code>bundle exec my_gem\n</code></pre>\n\n<p>This works fine.</p>\n\n<p>I can also create a <code>Gem Command</code> run configuration within IntelliJ IDEA and that works.</p>\n\n<p>What I actually want to do is to run this gem in another directory.</p>\n\n<p>Using bundler:</p>\n\n<pre><code>bundle exec --gemfile /path/to/my_gem my_gem\n</code></pre>\n\n<p>However from IntelliJ IDEA can't get this to work as there is no way to specify the path to the Gemfile. It fails saying:</p>\n\n<pre><code>Could not locate Gemfile or .bundle/ directory\n</code></pre>\n\n<p>Anyone know a solution to this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1562648221, "post_id": 56945449, "comment_id": 100430629, "body": "Can you add a bit more code? Show your existing classes around your scopes and relations?"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 1, "creation_date": 1562659140, "post_id": 56945449, "comment_id": 100434998, "body": "<code>default_scope { joins(item_tags: :tags)order(item_tags: { tags: :desc) } }</code> might work. I think you need to add the joins and then traverse the association in the order?"}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1562659791, "post_id": 56945449, "comment_id": 100435338, "body": "You can put an order by clause on the <code>has_many</code> <code>has_many :tags, -&gt; { order(some_column: :desc) }, through: :produce</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2477, "user_id": 3810626, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1370478d8a471131d99acbae1dbeb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "user3810626", "link": "https://stackoverflow.com/users/3810626/user3810626"}, "is_accepted": true, "score": 1, "last_activity_date": 1562878437, "creation_date": 1562878437, "answer_id": 56997161, "question_id": 56945449, "link": "https://stackoverflow.com/questions/56945449/default-order-on-owner-property/56997161#56997161", "title": "Default order on owner property", "body": "<p>Going off of Mike Heft's comment and cleaning up the syntax a bit, I ended up with:</p>\n\n<pre><code>default_scope {joins(:tags).order(\"CASE WHEN tags.name LIKE ...\")}\n</code></pre>\n\n<p>And that created an SQL query that returns things in the right order. </p>\n\n<p>(This ends up being scrambled again, because the code above that is just pulling the IDs for the product, and returning them in that order. I applied the same gag on that level and...still got them scrambled. \ud83e\udd23So, while I still have to sort out who's responsible for what, it was a simple \"join().order()\".)</p>\n"}], "owner": {"reputation": 2477, "user_id": 3810626, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1370478d8a471131d99acbae1dbeb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "user3810626", "link": "https://stackoverflow.com/users/3810626/user3810626"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56997161, "answer_count": 1, "score": 0, "last_activity_date": 1562878437, "creation_date": 1562647181, "question_id": 56945449, "link": "https://stackoverflow.com/questions/56945449/default-order-on-owner-property", "title": "Default order on owner property", "body": "<p>I have a shopping basket which has items in it. My class is <em>BasketItem &lt; ActiveRecord::Base</em>.</p>\n\n<p>A BasketItem <em>belongs_to :item</em>.</p>\n\n<p><em>Item</em> has many <em>item_tags</em>. It also has many tags <i>through</i> <em>item_tags</em>.</p>\n\n<p>Tags have a key-value set up. The key can be things like \"price\", \"perishable\", \"produce\", etc. The \"produce\" key has values like \"citrus fruit\", \"berry fruit\", \"melon fruit\", \"vegetable\", \"root\", \"fungus\" and so on.</p>\n\n<p>When pulling a basket, I want the items to come back in a default order of: all the fruits, fungus, then everything else.</p>\n\n<p>In SQL, I'd do my joins and then add:</p>\n\n<pre><code>ORDER BY (\n   CASE\n   WHEN tags.value LIKE '%fruit%' THEN 0\n   WHEN tags.value = 'Vegetable' THEN 1\n   ELSE 2\n   END)\n</code></pre>\n\n<p>I have tried:</p>\n\n<pre><code>has_many :tags, through: :produce\n</code></pre>\n\n<p>with a default scope of:</p>\n\n<pre><code>default_scope { order(tags: :desc) }\n</code></pre>\n\n<p>Just to see if I can access the tags, which I can't. In fact, looking at the SQL generate, it's straight up pulling from basket_items with no joins. </p>\n\n<p>1) So how do I order on that tag relationship?\n2) How do I get my CASE in there?\n3) And how do I make that the default? (If it's not default_scope.)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "arguments", "parentheses"], "comments": [{"owner": {"reputation": 10027, "user_id": 385907, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5e249e45a1849e387e324787d08ef738?s=128&d=identicon&r=PG", "display_name": "barlop", "link": "https://stackoverflow.com/users/385907/barlop"}, "edited": false, "score": 0, "creation_date": 1562633256, "post_id": 56943764, "comment_id": 100427970, "body": "if anybody votes to close this, please comment why. It&#39;s only one line and I have not given an example, but I think it&#39;s very self explanatory"}, {"owner": {"reputation": 10027, "user_id": 385907, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5e249e45a1849e387e324787d08ef738?s=128&d=identicon&r=PG", "display_name": "barlop", "link": "https://stackoverflow.com/users/385907/barlop"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562633520, "post_id": 56943764, "comment_id": 100428008, "body": "@maxpleaner not really because ruby is quite complex, and I wouldn&#39;t immediately rule out that there is a way to pass multiple hashes just because I can&#39;t see a way. And there are keyword arguments (which I didn&#39;t know much about), which makes it more complex"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1562633527, "post_id": 56943764, "comment_id": 100428009, "body": "Also, saying <code>obj.m x, y</code> can qualify as &quot;passing more than one hash to a method&quot;. So are you talking about passing multiple hashes? Multiple hashes as hash literals? A mix of both?"}, {"owner": {"reputation": 10027, "user_id": 385907, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5e249e45a1849e387e324787d08ef738?s=128&d=identicon&r=PG", "display_name": "barlop", "link": "https://stackoverflow.com/users/385907/barlop"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1562633613, "post_id": 56943764, "comment_id": 100428027, "body": "@muistooshort  I hadn&#39;t thought of that. From what you&#39;re saying, it looks like you can pass multiple hashes. i&#39;ll try that"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1562633769, "post_id": 56943764, "comment_id": 100428050, "body": "Also also, keyword arguments can also be involved when you say <code>h = { a: &#39;a&#39; }; m h</code> when you <code>def m(a:)</code>. And multiple hash literals can be <code>m { k: v }, k2: v2, k3: v3</code> (this variation pops up in Rails a fair bit when there are multiple options hashes for a form builder method). So you need to be a lot clearer about what you&#39;re asking as @maxpleaner notes."}, {"owner": {"reputation": 10027, "user_id": 385907, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5e249e45a1849e387e324787d08ef738?s=128&d=identicon&r=PG", "display_name": "barlop", "link": "https://stackoverflow.com/users/385907/barlop"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1562633980, "post_id": 56943764, "comment_id": 100428093, "body": "@muistooshort  yeah I mentioned the keyword arguments thing in my answer . but well spotted re non-literal hash I hadn&#39;t spotted that"}, {"owner": {"reputation": 10027, "user_id": 385907, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5e249e45a1849e387e324787d08ef738?s=128&d=identicon&r=PG", "display_name": "barlop", "link": "https://stackoverflow.com/users/385907/barlop"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1562634482, "post_id": 56943764, "comment_id": 100428168, "body": "@muistooshort you can post that as an answer"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1562664064, "post_id": 56943764, "comment_id": 100437598, "body": "@barlop maybe you find the time to edit / clarify your question in regard to the comments so we can try to reopen it."}, {"owner": {"reputation": 10027, "user_id": 385907, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5e249e45a1849e387e324787d08ef738?s=128&d=identicon&r=PG", "display_name": "barlop", "link": "https://stackoverflow.com/users/385907/barlop"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1562675526, "post_id": 56943764, "comment_id": 100443745, "body": "@Stefan i&#39;ve just adjusted the question and added an example"}], "answers": [{"tags": [], "owner": {"reputation": 10027, "user_id": 385907, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5e249e45a1849e387e324787d08ef738?s=128&d=identicon&r=PG", "display_name": "barlop", "link": "https://stackoverflow.com/users/385907/barlop"}, "is_accepted": true, "score": 2, "last_activity_date": 1562712261, "last_edit_date": 1562712261, "creation_date": 1562629852, "answer_id": 56943768, "question_id": 56943764, "link": "https://stackoverflow.com/questions/56943764/in-ruby-how-can-you-pass-more-than-one-hash-to-a-method-without-parentheses/56943768#56943768", "title": "In Ruby, how can you pass more than one hash to a method, without parentheses?", "body": "<p>Mu points out that you can pass multiple hashes without parentheses, if you pass them in as non-literals i.e. as variables.</p>\n\n<p>But other than that, so, for literal hashes,</p>\n\n<p>You do(need parentheses to pass multiple literal hashes), unless you are passing keyword arguments.. You can pass multiple keyword arguments without parentheses.</p>\n\n<p>a keyword argument would be when the parameters of the method include a colon like e.g. <code>def blah x:, y:</code>  then you can call with <code>blah y:2,x:3</code> . Sometimes you have to look at the parameter(s) to see if an argument is a keyword argument, e.g. if you have a method called with abc x:3\n then that might be <code>def abc x:</code>  in which case you called it with a keyword argument.  Or it might be <code>def abc x</code> in which case you called it with a hash, omitting the {}.</p>\n\n<p>When I say keyword argument, I don't mean a hash..  and vice versa, when I say hash I mean not a keyword argument.</p>\n\n<p>When a call is without parentheses, you can only pass one hash and that hash has to be the last argument.  And you can skip the {} around it.</p>\n\n<p>note- I'm no expert, but as to a related question of whether a keyword argument is a type of hash,   from what I understand, as of writing, pre ruby 3, they are, but there is a proposal for ruby 3 to have 'real' keyword arguments that are distinct from hashes <a href=\"https://bugs.ruby-lang.org/issues/14183\" rel=\"nofollow noreferrer\">https://bugs.ruby-lang.org/issues/14183</a> </p>\n\n<p>a keyword argument can't be multi-valued.</p>\n\n<p>also, a hash can be automatically converted to a keyword argument. (e.g. if a method is defined with a parameter that is a keyword argument, you can pass a hash in e.g. <code>{x:\"a\"}</code>  , that x being a symbol, and that hash will be converted to a keyword argument <code>x:\"a\"</code> (that x being a parameter name).</p>\n\n<p>I'll add a point regarding blocks and parentheses, because a block done with {} does look a little bit like a hash though is not a hash. And a block can have some influence on whether parentheses are needed.</p>\n\n<p>If you see <code>abc {}</code>, that {} is a block not a hash, and blocks don't count as an argument. Hence that call works for <code>def abc</code> but not for <code>def abc x</code> where one would get an error related to number of arguments passed.</p>\n\n<p>even when passing a block after some other arguments, there should be no comma before the block, and if a block done with {} follows some arguments, you need parentheses, but if a block done with <code>do .. end</code> follows some arguments, you don't need parentheses</p>\n\n<p>it is suggested that one use parentheses when one has multiple arguments, unless it's a DSL(domain specific language). <a href=\"https://stackoverflow.com/questions/340624/do-you-leave-parentheses-in-or-out-in-ruby\">Do you leave parentheses in or out in Ruby?</a></p>\n"}], "owner": {"reputation": 10027, "user_id": 385907, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5e249e45a1849e387e324787d08ef738?s=128&d=identicon&r=PG", "display_name": "barlop", "link": "https://stackoverflow.com/users/385907/barlop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 56943768, "answer_count": 1, "score": 0, "last_activity_date": 1562712261, "creation_date": 1562629803, "last_edit_date": 1562711989, "question_id": 56943764, "link": "https://stackoverflow.com/questions/56943764/in-ruby-how-can-you-pass-more-than-one-hash-to-a-method-without-parentheses", "title": "In Ruby, how can you pass more than one hash to a method, without parentheses?", "body": "<p>In Ruby, how can one pass more than one hash to a method, without parentheses?</p>\n\n<p>For example</p>\n\n<pre><code>def abc x,y\nend\n</code></pre>\n\n<p><code>abc {4,5},{6,4}</code> &lt;-- <code>syntax error, unexpected ',', expecting '}'</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "guard"], "answers": [{"tags": [], "owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "is_accepted": false, "score": 1, "last_activity_date": 1562670931, "creation_date": 1562670931, "answer_id": 56951337, "question_id": 56943445, "link": "https://stackoverflow.com/questions/56943445/guard-rspec-rails-run-only-model-specs/56951337#56951337", "title": "Guard rspec-rails: run only model specs", "body": "<p>In Guardfile look for any lines like these:</p>\n\n<pre><code>  watch(%r{^app/controllers/(.+)_(controller)\\.rb$})  { \"spec/features\" }\n  watch(%r{^app/models/(.+)\\.rb$})  { \"spec/features\" }\n  watch(rails.controllers) do |m|\n    [\n      rspec.spec.call(\"routing/#{m[1]}_routing\"),\n      rspec.spec.call(\"controllers/#{m[1]}_controller\"),\n      rspec.spec.call(\"acceptance/#{m[1]}\")\n    ]\n  end\n</code></pre>\n\n<p>This line for example:</p>\n\n<pre><code>watch(%r{^app/models/(.+)\\.rb$})  { \"spec/features\" }\n</code></pre>\n\n<p>As you can see it watches for any changes happen to models folder then it run the spec/features</p>\n\n<p>Replacing it with:</p>\n\n<pre><code>watch(%r{^app/models/(.+)\\.rb$})  { \"spec/models\" }\n</code></pre>\n\n<p>Will run the models spec only when any file on models is changed.</p>\n\n<p>This is my Gaurdfile which i'm using in case it might help you</p>\n\n<pre><code>guard :rspec, cmd: \"bundle exec rspec\" do\n  require \"guard/rspec/dsl\"\n  dsl = Guard::RSpec::Dsl.new(self)\n\n  # RSpec files\n  rspec = dsl.rspec\n  watch(rspec.spec_helper) { rspec.spec_dir }\n  watch(rspec.spec_support) { rspec.spec_dir }\n  watch(rspec.spec_files)\n\n  # Ruby files\n  ruby = dsl.ruby\n  dsl.watch_spec_files_for(ruby.lib_files)\n\n  # Rails files\n  rails = dsl.rails(view_extensions: %w(erb haml slim))\n  dsl.watch_spec_files_for(rails.app_files)\n  dsl.watch_spec_files_for(rails.views)\n\n  watch(%r{^app/controllers/(.+)_(controller)\\.rb$})  { \"spec/features\" }\n  watch(%r{^app/models/(.+)\\.rb$})  { \"spec/features\" }\n  watch(rails.controllers) do |m|\n    [\n      rspec.spec.call(\"routing/#{m[1]}_routing\"),\n      rspec.spec.call(\"controllers/#{m[1]}_controller\"),\n      rspec.spec.call(\"acceptance/#{m[1]}\")\n    ]\n  end\n\n  # Rails config changes\n  watch(rails.spec_helper)     { rspec.spec_dir }\n  watch(rails.routes)          { \"#{rspec.spec_dir}/routing\" }\n  watch(rails.routes)          { \"spec\"  } # { \"#{rspec.spec_dir}/routing\"  }\n  watch(rails.app_controller)  { \"#{rspec.spec_dir}/controllers\" }\n\n  # Capybara features specs\n  watch(rails.view_dirs)     { \"spec/features\"  } # { |m| rspec.spec.call(\"features/#{m[1]}\")  }\n  watch(rails.layouts)       { |m| rspec.spec.call(\"features/#{m[1]}\") }\n\n  # Turnip features and steps\n  watch(%r{^spec/acceptance/(.+)\\.feature$})\n  watch(%r{^spec/acceptance/steps/(.+)_steps\\.rb$}) do |m|\n    Dir[File.join(\"**/#{m[1]}.feature\")][0] || \"spec/acceptance\"\n  end\nend\n</code></pre>\n\n<p>If you decided to use this script, just replace the lines i mentioned above, while i recommend that you go for your own configurations, since Guardfile meant to be different based on everyone's needs</p>\n"}], "owner": {"reputation": 10599, "user_id": 105514, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c94ec944a76e9fc31fcbd6d29285c153?s=128&d=identicon&r=PG", "display_name": "Daniel Cukier", "link": "https://stackoverflow.com/users/105514/daniel-cukier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1562670931, "creation_date": 1562626608, "question_id": 56943445, "link": "https://stackoverflow.com/questions/56943445/guard-rspec-rails-run-only-model-specs", "title": "Guard rspec-rails: run only model specs", "body": "<p>We are using Guard gem to automatically run specs on a Rails 5 app. How to configure it to run only the models specs? Our config is:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>guard :rspec, cmd: 'spring rspec -p', parallel: true, failed_mode: :focus do\n</code></pre>\n\n<p>We tried to change it to </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>guard :rspec, cmd: 'spring rspec ./spec/models/ -p', parallel: true, failed_mode: :focus do\n</code></pre>\n\n<p>but it still runs all tests.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "view", "gif"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 2, "creation_date": 1562621028, "post_id": 56942086, "comment_id": 100425469, "body": "Use javascript or action cable. Your approach doesn&#39;t make any sense since your view is rendered only after the action is completed."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11594273, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IOFEkvCMF2w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD4pEG-eRD8Il9rR4YHnkTVe-dJA/mo/photo.jpg?sz=128", "display_name": "sr1", "link": "https://stackoverflow.com/users/11594273/sr1"}, "edited": false, "score": 0, "creation_date": 1562703524, "post_id": 56942854, "comment_id": 100457939, "body": "any suggestions for javascript code above that I wrote?"}, {"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "reply_to_user": {"reputation": 31, "user_id": 11594273, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IOFEkvCMF2w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD4pEG-eRD8Il9rR4YHnkTVe-dJA/mo/photo.jpg?sz=128", "display_name": "sr1", "link": "https://stackoverflow.com/users/11594273/sr1"}, "edited": false, "score": 0, "creation_date": 1562704373, "post_id": 56942854, "comment_id": 100458232, "body": "No, but I can update my example to address your div"}], "tags": [], "owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "is_accepted": false, "score": 2, "last_activity_date": 1562704435, "last_edit_date": 1562704435, "creation_date": 1562621847, "answer_id": 56942854, "question_id": 56942086, "link": "https://stackoverflow.com/questions/56942086/attempting-to-add-a-loading-gif-while-a-method-is-running-using-ruby-on-rails-up/56942854#56942854", "title": "Attempting to add a loading gif while a method is running using ruby on rails UPDATED: using javascript now", "body": "<p>As the comment says, you probably want to use javascript to do this as it ties into the events like page loading.</p>\n\n<p>Here is the javascript</p>\n\n<pre><code>$(function() {\n  $(document).on('ready', function() {\n    $('.progress').css('display', 'none');\n  });\n});\n</code></pre>\n\n<p>In the HTML I have this.  I use javascript to hide it once the page is loaded (that is the code above).</p>\n\n<pre><code>&lt;div class=\"progress\"&gt;\n  &lt;%= image_tag \"loading2.gif\"%&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>In case it helps, here is the css for the loader class, you should be able to adjust this for your needs.</p>\n\n<pre><code>.progress {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #1f1f1f;\n  z-index: 99996;\n  height: 100%;\n  width: 100%;\n  overflow: hidden !important;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11594273, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IOFEkvCMF2w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD4pEG-eRD8Il9rR4YHnkTVe-dJA/mo/photo.jpg?sz=128", "display_name": "sr1", "link": "https://stackoverflow.com/users/11594273/sr1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562704435, "creation_date": 1562617365, "last_edit_date": 1562702041, "question_id": 56942086, "link": "https://stackoverflow.com/questions/56942086/attempting-to-add-a-loading-gif-while-a-method-is-running-using-ruby-on-rails-up", "title": "Attempting to add a loading gif while a method is running using ruby on rails UPDATED: using javascript now", "body": "<p>I am currently trying to add a loading gif whenever a method is running as it takes a few minutes to run. </p>\n\n<p>I have this in my application.js file :</p>\n\n<pre><code>function showProgress() {\n  $('.content').hide();\n  $('.progress').show();\n}\n\n$(document).ready(function () {\n  $('.progress').hide();       \n  $('.btn-primary').on('click', showProgress);\n});\n</code></pre>\n\n<p>and in my html file (show file for my controller)\nI have : </p>\n\n<pre><code>&lt;div class=\"content\"&gt;\n...\n  &lt;%= link_to 'Run Test', runTest_path, :class =&gt; \"btn-primary\", :method =&gt; :get%&gt;\n...\n&lt;/div&gt;\n\n\n&lt;div class=\"progress\"&gt;\n  &lt;%= image_tag \"loading2.gif\"%&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>It works as intended however it only works the first time i click the button to run the method and it won't show the gif after that. Also if I don't immediately click the button that runs the method after creating the instance (as it redirects to this show page) and go to another part of the web app then the loading gif appears when I go back to this show page and will only disappear when I refresh. Any suggestions?</p>\n"}, {"tags": ["ruby", "method-reference", "pointfree", "first-class-functions"], "answers": [{"comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "reply_to_user": {"reputation": 798, "user_id": 7820990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c60d2aee016d63cfa414ee2a1fb6a1f?s=128&d=identicon&r=PG&f=1", "display_name": "Ebuall", "link": "https://stackoverflow.com/users/7820990/ebuall"}, "edited": false, "score": 0, "creation_date": 1562617880, "post_id": 56942139, "comment_id": 100424298, "body": "Correct. Each function takes zero or one block arguments, which are indicated with an ampersand. <code>times</code> and many looping or enumeration functions work this way. If the documentation says that a function takes a block, you need to either use <code>{ ... }</code> (or, equivalently, <code>do ... end</code>) or put an ampersand in front of the value."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 2, "creation_date": 1562618130, "post_id": 56942139, "comment_id": 100424402, "body": "<code>5.times { |x| puts x }</code> which @SilvioMayolo gives is by far the more idiomatic way."}, {"owner": {"reputation": 798, "user_id": 7820990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c60d2aee016d63cfa414ee2a1fb6a1f?s=128&d=identicon&r=PG&f=1", "display_name": "Ebuall", "link": "https://stackoverflow.com/users/7820990/ebuall"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1562618281, "post_id": 56942139, "comment_id": 100424473, "body": "@steenslag but makes you mention arguments for no reason. And they could change. Very simple and readable pointfree does not hurt."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 1, "creation_date": 1562618966, "post_id": 56942139, "comment_id": 100424775, "body": "Ruby is designed to be read in pseudo-english. <code>5.times { |x| puts x }</code> reads: &quot;5 times, put the number on the screen&quot;. <code>5.times(method(:puts))</code> reads: &quot;5 times, method the puts&quot;. As a Haskeller, I agree that pointfree is very nice in some languages, but Ruby is not one of those languages. The language is designed with blocks in mind."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1562619411, "post_id": 56942139, "comment_id": 100424937, "body": "FWIW Ruby 2.7-preview1 has <a href=\"https://medium.com/@baweaver/ruby-2-7-numbered-parameters-3f5c06a55fe4\" rel=\"nofollow noreferrer\">numbered block parameters</a> as an experimental feature: <code>5.times { puts @1 }</code>."}, {"owner": {"reputation": 798, "user_id": 7820990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c60d2aee016d63cfa414ee2a1fb6a1f?s=128&d=identicon&r=PG&f=1", "display_name": "Ebuall", "link": "https://stackoverflow.com/users/7820990/ebuall"}, "edited": false, "score": 0, "creation_date": 1562725229, "post_id": 56942139, "comment_id": 100462783, "body": "@SilvioMayolo it&#39;s supposed to be <code>5 numbers each puts</code> instead of <code>5 numbers each x puts x</code>. Lightweight pointfree is always more language-like."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 4, "last_activity_date": 1562617671, "creation_date": 1562617671, "answer_id": 56942139, "question_id": 56942056, "link": "https://stackoverflow.com/questions/56942056/ruby-passing-method/56942139#56942139", "title": "Ruby passing method", "body": "<p><code>times</code> takes a block argument, which is distinguished from \"regular\" arguments by an ampersand. You can either pass it an explicit block</p>\n\n<pre><code>5.times { |x| puts x }\n</code></pre>\n\n<p>or you can pass it a value with <code>&amp;</code></p>\n\n<pre><code>5.times(&amp;method(:puts))\n</code></pre>\n\n<p>Having the block argument treated differently allows us to write methods that look and act a lot like built-in statements. For instance, an infinite loop in Ruby can be written as</p>\n\n<pre><code>loop {\n  # fun stuff happening in here\n}\n</code></pre>\n\n<p>But <a href=\"https://ruby-doc.org/core-2.6.3/Kernel.html#method-i-loop\" rel=\"nofollow noreferrer\"><code>loop</code></a> is a method in the core library, not a built-in keyword. We could've written that <code>loop</code> function ourselves. <code>Enumerable</code> and other modules make heavy use of block arguments to provide friendlier syntax, which is one of the primary goals of Ruby as a language.</p>\n"}], "owner": {"reputation": 798, "user_id": 7820990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c60d2aee016d63cfa414ee2a1fb6a1f?s=128&d=identicon&r=PG&f=1", "display_name": "Ebuall", "link": "https://stackoverflow.com/users/7820990/ebuall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56942139, "answer_count": 1, "score": 2, "last_activity_date": 1562617766, "creation_date": 1562617221, "last_edit_date": 1562617766, "question_id": 56942056, "link": "https://stackoverflow.com/questions/56942056/ruby-passing-method", "title": "Ruby passing method", "body": "<p>Trying to understand ruby's complexity, but makes no sense so far.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>5.times(method(:puts))\n</code></pre>\n\n<p>Gives error, that doesn't make a lot of sense. Do I have some kind of syntax error or is it not possible to do in ruby?</p>\n\n<pre><code>ArgumentError: wrong number of arguments (given 1, expected 0)\n        from (irb):78:in `times'\n</code></pre>\n\n<p>I am trying to do something similar to</p>\n\n<pre><code>[0, 1, 2, 3, 4].forEach(console.log)\n</code></pre>\n\n<p>and</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>java.util.stream.IntStream.range(0, 5).forEach(System.out::println);\n</code></pre>\n\n<p>At the same time these do work:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>method(:puts).call(1)\n# and\n5.times { |i| puts i }\n</code></pre>\n"}, {"tags": ["ruby", "metaprogramming"], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1562691338, "last_edit_date": 1562691338, "creation_date": 1562637266, "answer_id": 56944395, "question_id": 56942002, "link": "https://stackoverflow.com/questions/56942002/getting-the-nesting-heirarchy-for-any-given-module-in-ruby/56944395#56944395", "title": "Getting the nesting heirarchy for any given module in Ruby", "body": "<p>Try this:</p>\n\n<pre><code>module A\n  module B\n    module C\n      Module.nesting\n    end\n  end\nend\n  #=&gt; [A::B::C, A::B, A]\n\nmodule A::B\n  module C\n    Module.nesting\n  end\nend\n  #=&gt; [A::B::C, A::B] \n</code></pre>\n\n<p>The reason <code>A</code> is not included in the last return value is that <code>nesting</code> depends on the structure of the code (\"lexical\") and not on the parent-child relationships of the modules. For that reason I think any method that causes <code>self</code> to equal the given module (the method's argument), and then execute <code>Module.nesting</code>, is doomed to failure.</p>\n\n<p>You can, however, do the following.</p>\n\n<pre><code>def get_nesting(mod)\n  a = mod.to_s.split('::')\n  a.size.times.map { |i| Module.const_get(a[0..i].join('::')) }.reverse\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>get_nesting(A)       #=&gt; [A] \nget_nesting(A::B)    #=&gt; [A::B, A] \nget_nesting(A::B::C) #=&gt; [A::B::C, A::B, A] \n\nget_nesting(A::B::C).map { |m| m.class } \n  #=&gt; [Module, Module, Module]\n</code></pre>\n\n<p>Considering that this depends on <a href=\"http://ruby-doc.org/core-2.5.1/Module.html#method-i-to_s\" rel=\"nofollow noreferrer\">Module#to_s</a>, this would be classified as a kludge.</p>\n"}], "owner": {"reputation": 9435, "user_id": 2626000, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/j8GY0.jpg?s=128&g=1", "display_name": "Aaron Christiansen", "link": "https://stackoverflow.com/users/2626000/aaron-christiansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56944395, "answer_count": 1, "score": 1, "last_activity_date": 1562691338, "creation_date": 1562616873, "question_id": 56942002, "link": "https://stackoverflow.com/questions/56942002/getting-the-nesting-heirarchy-for-any-given-module-in-ruby", "title": "Getting the nesting heirarchy for any given module in Ruby", "body": "<p>I have a method which needs to be able to access the nesting hierarchy of a module definition. Suppose I have this definition:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module A\n  module B\n    module C\n    end\n  end\nend\n</code></pre>\n\n<p>I'm trying to write a method such that, if a reference to <code>C</code> is passed to the method, it is able to return the result of <code>Module.nesting</code> as if it was called inside the definintion. For example:</p>\n\n<pre><code>get_nesting(A::B::C) # =&gt; [A::B::C, A::B, A]\n</code></pre>\n\n<p>However, I can't figure out how to call <code>Module.nesting</code> in a different context. I've tried using <code>instance_exec</code>, but this just returns the nesting in the current scope.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module X\n  def self.get_nesting(m)\n    m.instance_exec { Module.nesting }\n  end\nend\n\nX.get_nesting(A::B::C) # =&gt; [X]\n</code></pre>\n\n<p>I want this to return <code>[A::B::C, A::B, A]</code> instead.</p>\n\n<p>Is there a way to get the nesting for a module in this way, using <code>Module.nesting</code> or otherwise? </p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11666817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94bfbc906f8ac86327d3f953cea3315?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Kannojia", "link": "https://stackoverflow.com/users/11666817/abhinav-kannojia"}, "edited": false, "score": 0, "creation_date": 1562620501, "post_id": 56942424, "comment_id": 100425304, "body": "Thanks.. I can&#39;t believe, I did this silly mistake."}], "tags": [], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "is_accepted": false, "score": 0, "last_activity_date": 1562619215, "creation_date": 1562619215, "answer_id": 56942424, "question_id": 56941596, "link": "https://stackoverflow.com/questions/56941596/how-to-generate-the-expected-output-by-using-split-method-used-in-my-code/56942424#56942424", "title": "How to generate the expected output by using split method used in my code?", "body": "<p>Not sure why you need to monkeypatch* array here, is this a school exercise or something?  </p>\n\n<p>I think your bug is you need to pass in the comma delimiter arg to split. </p>\n\n<p>I would solve the underlying problem as a reduce/inject/fold thing, myself.</p>\n\n<pre><code>s = \"['abc','def',1234,234,'abcd','x','mnop',5,'zZzZ']\"\nsplits = s.tr(\"'[]''\",'').split(',') # need to pass in the comma for the split\nHash[splits.inject({}) { |memo,s| memo[s.length] ||= []; memo[s.length] &lt;&lt; s; memo }.sort] # doesn't use Array.each but?\n</code></pre>\n\n<blockquote>\n  <p>{1=>[\"x\", \"5\"], 3=>[\"def\", \"234\"], 4=>[\"1234\", \"abcd\", \"mnop\"],\n  5=>[\"['abc\"], 6=>[\"zZzZ']\"]}</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11666817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94bfbc906f8ac86327d3f953cea3315?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Kannojia", "link": "https://stackoverflow.com/users/11666817/abhinav-kannojia"}, "edited": false, "score": 0, "creation_date": 1562654024, "post_id": 56942621, "comment_id": 100432420, "body": "Thanks.. that was a great add to my knowledge."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 1, "user_id": 11666817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94bfbc906f8ac86327d3f953cea3315?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Kannojia", "link": "https://stackoverflow.com/users/11666817/abhinav-kannojia"}, "edited": false, "score": 0, "creation_date": 1562654919, "post_id": 56942621, "comment_id": 100432855, "body": "@AbhinavKannojia Accept &amp; upvote answer if it helps you."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 2, "last_activity_date": 1562651597, "last_edit_date": 1562651597, "creation_date": 1562620424, "answer_id": 56942621, "question_id": 56941596, "link": "https://stackoverflow.com/questions/56941596/how-to-generate-the-expected-output-by-using-split-method-used-in-my-code/56942621#56942621", "title": "How to generate the expected output by using split method used in my code?", "body": "<p>Given the array (converted from string, note integers as string between \"\"):</p>\n\n<pre><code>ary = str[1..-2].delete('\\'').split(',')\nary #=&gt; [\"abc\", \"def\", \"1234\", \"234\", \"abcd\", \"x\", \"mnop\", \"5\", \"zZzZ\"]\n</code></pre>\n\n<p>The most \"idiomatic\" way should be using group_by:</p>\n\n<pre><code>ary.group_by(&amp;:size)\n</code></pre>\n\n<p>If you want to use each, then you could use <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a>, where the object is an <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash#new</a> with an empty array as default:</p>\n\n<pre><code>ary.each_with_object(Hash.new{ |h,k| h[k] = []}) { |e, h| h[e.size] &lt;&lt; e }\n</code></pre>\n\n<p>Which is the same as</p>\n\n<pre><code>res = Hash.new{ |h,k| h[k] = []}\nary.each { |e| res[e.size] &lt;&lt; e }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11666817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94bfbc906f8ac86327d3f953cea3315?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Kannojia", "link": "https://stackoverflow.com/users/11666817/abhinav-kannojia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56942621, "answer_count": 2, "score": 0, "last_activity_date": 1562651597, "creation_date": 1562614742, "last_edit_date": 1562619633, "question_id": 56941596, "link": "https://stackoverflow.com/questions/56941596/how-to-generate-the-expected-output-by-using-split-method-used-in-my-code", "title": "How to generate the expected output by using split method used in my code?", "body": "<p>Question:</p>\n\n<blockquote>\n  <p>Create a method for Array that returns a hash having 'key' as length of the element and value as an array of all the elements of that length. Make use of <code>Array#each</code>.</p>\n  \n  <p>Returned Hash should be sorted by key.</p>\n</blockquote>\n\n<p>I have tried to do it through Hash sorting over length. I have almost resolved it using another method but I want to use split and hash to achieve expected output.</p>\n\n<p>Can anyone suggest any amendments in my code below?</p>\n\n<p>Input argument:</p>\n\n<pre><code>array-hash.rb \"['abc','def',1234,234,'abcd','x','mnop',5,'zZzZ']\"\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>{1=&gt;[\"x\", \"5\"], 3=&gt;[\"abc\", \"def\", \"234\"], 4=&gt;[\"1234\", \"abcd\", \"mnop\", \"zZzZ\"]}\n</code></pre>\n\n<pre><code>class String\n  def key_length(v2)\n    hash = {}\n    v2.each do |item|\n      item_length = item.to_s.length\n      hash[item_length] ||= []\n      hash[item_length].push(item)\n    end\n    Hash[hash.sort]\n  end\nend\n\nreader = ''\nif ARGV.empty?\n  puts 'Please provide an input'\nelse\n  v1 = ARGV[0]\n  v2 = v1.tr(\"'[]''\",'').split\n  p reader.key_length(v2)\nend\n</code></pre>\n\n<p>Actual output:</p>\n\n<pre><code>{35=&gt;[\"abc,def,1234,234,abcd,x,mnop,5,zZzZ\"]}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 0, "creation_date": 1562614895, "post_id": 56941407, "comment_id": 100423237, "body": "Are u using filter? Before action?"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 11756281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/090ea26c11c757c33832e5bc20f01b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Yozuu", "link": "https://stackoverflow.com/users/11756281/yozuu"}, "edited": false, "score": 0, "creation_date": 1562619163, "post_id": 56942095, "comment_id": 100424854, "body": "Yes i using set_image in before_action sorry i forget to say it  I go try this tks"}, {"owner": {"reputation": 71, "user_id": 11756281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/090ea26c11c757c33832e5bc20f01b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Yozuu", "link": "https://stackoverflow.com/users/11756281/yozuu"}, "edited": false, "score": 0, "creation_date": 1562619420, "post_id": 56942095, "comment_id": 100424942, "body": "I got a error with a quey parameters Cannot read file /public/uploads/posts/@image/image.jpg I tried with full path but it&#39;s the same thing"}, {"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "reply_to_user": {"reputation": 71, "user_id": 11756281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/090ea26c11c757c33832e5bc20f01b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Yozuu", "link": "https://stackoverflow.com/users/11756281/yozuu"}, "edited": false, "score": 0, "creation_date": 1562629100, "post_id": 56942095, "comment_id": 100427285, "body": "So it fixes your first issue :) Then what does a Post instance looks like (what are its attributes) ? And what is the final path you need to pass to <code>send_file</code> ? Can&#39;t work as you&#39;ve done, you&#39;re not using <code>@image</code> variable in <code>download</code>."}, {"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "reply_to_user": {"reputation": 71, "user_id": 11756281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/090ea26c11c757c33832e5bc20f01b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Yozuu", "link": "https://stackoverflow.com/users/11756281/yozuu"}, "edited": false, "score": 0, "creation_date": 1562629600, "post_id": 56942095, "comment_id": 100427377, "body": "@z3rtyyy_ I updated my answer with a beginning of solution for the second part of the issue. Please answer the question above so I can help you more."}], "tags": [], "owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "is_accepted": true, "score": 1, "last_activity_date": 1562660310, "last_edit_date": 1562660310, "creation_date": 1562617422, "answer_id": 56942095, "question_id": 56941407, "link": "https://stackoverflow.com/questions/56941407/how-to-download-file-with-id-params/56942095#56942095", "title": "How to download file with id params?", "body": "<p>Assuming you use <code>set_image</code> in a <code>before_action</code> filter.</p>\n\n<p>First you should pass the <code>post</code> instance or id to your route helper : </p>\n\n<p>If your route takes a param e.g. <code>/posts/:id/download</code> :</p>\n\n<pre><code>&lt;%= link_to \"Download\", download_posts_path(@post) %&gt;\n&lt;%= link_to \"Download\", download_posts_path(@post.id) %&gt;\n</code></pre>\n\n<p>If not you can pass it with a query parameter e.g. <code>posts/download/?id=1</code></p>\n\n<pre><code>&lt;%= link_to \"Download\", download_posts_path(id: @post.id) %&gt;\n</code></pre>\n\n<p>Both solution will provide you a <code>params[:id]</code> in your controller. Otherwise <code>params[:id]</code> will be <code>nil</code> and <code>find</code> raises an error.</p>\n\n<p>Then there's something wrong in the <code>download</code> action as @DileepNandanam pointed out. You're not using your <code>Post</code> instance (<code>@image</code>) at all, you're just passing <code>send_file</code> a string containing \"@image\", not the variable but just a string. You may want to use interpolation to build a valid path to your image. For example if your <code>@image</code> has a <code>:name</code> which could be <code>\"image.jpg\"</code> you would do it like this:</p>\n\n<pre><code>send_file \"/public/uploads/posts/#{@image.name}\"\n</code></pre>\n\n<p>Or you could name your images with the <code>post</code> id like <code>13.jpg</code> then you'll do : </p>\n\n<pre><code>send_file \"/public/uploads/posts/#{@image.id}.jpg\"\n</code></pre>\n\n<p>Or even create separate forlders with post's ids : </p>\n\n<pre><code>send_file \"/public/uploads/posts/#{@image.id}/image.jpg\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2356, "user_id": 1547872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/x2Brf.jpg?s=128&g=1", "display_name": "dileep nandanam", "link": "https://stackoverflow.com/users/1547872/dileep-nandanam"}, "is_accepted": false, "score": 1, "last_activity_date": 1562623249, "creation_date": 1562623249, "answer_id": 56943039, "question_id": 56941407, "link": "https://stackoverflow.com/questions/56941407/how-to-download-file-with-id-params/56943039#56943039", "title": "How to download file with id params?", "body": "<pre><code>send_file \"/public/uploads/posts/#{@image.image_file_name}/image.jpg\", :type =&gt; 'image/jpeg', :disposition =&gt; 'attachment', :x_sendfile =&gt; true\n</code></pre>\n\n<p>The method image_file_name may varies depends on the attachment you have specified on model</p>\n\n<p>A better way is to use the url for attachment like</p>\n\n<pre><code>send_file @image.image.url(:original)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 11756281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/090ea26c11c757c33832e5bc20f01b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Yozuu", "link": "https://stackoverflow.com/users/11756281/yozuu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 56942095, "answer_count": 2, "score": 1, "last_activity_date": 1562660310, "creation_date": 1562613903, "last_edit_date": 1562637564, "question_id": 56941407, "link": "https://stackoverflow.com/questions/56941407/how-to-download-file-with-id-params", "title": "How to download file with id params?", "body": "<p>Hello I try to download a jpeg image on rails by verifying that the Post exists and by recovering its id in parameter.</p>\n\n<p>I try something but i got a error... I show you:</p>\n\n<pre><code>def download\n  send_file '/public/uploads/posts/@image/image.jpg', :type =&gt; 'image/jpeg', :disposition =&gt; 'attachment', :x_sendfile =&gt; true\nend\n\nprivate\n\ndef set_image\n  @image = Post.find(params[:id])\nend\n</code></pre>\n\n<p>In my controller I have to in my routes get download.</p>\n\n<p>And my <code>link_to</code> is:</p>\n\n<pre><code>&lt;%= link_to \"Download\", download_posts_path %&gt;\n</code></pre>\n\n<p>But rails say to me \"Couldn't find Post without an ID\".\nI don't understand why... He dont't have the id but I dont't know why ?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "haml", "rollbar"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 2, "creation_date": 1562621237, "post_id": 56941024, "comment_id": 100425537, "body": "&quot;Not playing nice&quot; is colorful, but not very helpful. Are you getting errors? If so, what. If not, what information do you have that might inform an answer?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1562711135, "post_id": 56941024, "comment_id": 100460275, "body": "Welcome to Stack Overflow. Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. You&#39;re not telling us enough to give a definitive answer."}], "answers": [{"tags": [], "owner": {"reputation": 2356, "user_id": 1547872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/x2Brf.jpg?s=128&g=1", "display_name": "dileep nandanam", "link": "https://stackoverflow.com/users/1547872/dileep-nandanam"}, "is_accepted": false, "score": 1, "last_activity_date": 1566030261, "last_edit_date": 1566030261, "creation_date": 1562623568, "answer_id": 56943077, "question_id": 56941024, "link": "https://stackoverflow.com/questions/56941024/how-to-put-a-script-and-object-in-a-haml-file/56943077#56943077", "title": "How to put a script and object in a HAML file", "body": "<p>In my layout add:</p>\n\n<pre><code>  = yield(:javascript)\n</code></pre>\n\n<p>and in view</p>\n\n<pre><code> - content_for :javascript do\n  :javascript\n    $(function(){\n      //your indented multiline javascript code\n    })\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 10725180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ILCL.jpg?s=128&g=1", "display_name": "Jack Collins", "link": "https://stackoverflow.com/users/10725180/jack-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1581308555, "creation_date": 1562612228, "last_edit_date": 1581308555, "question_id": 56941024, "link": "https://stackoverflow.com/questions/56941024/how-to-put-a-script-and-object-in-a-haml-file", "title": "How to put a script and object in a HAML file", "body": "<p>I am trying to add rollbar to a Rails application that uses React for the front-end. I need to place a script in my HAML file that will allow for rollbar configuration, however the script, and subsequent objects are not playing nice with the HAML file.</p>\n\n<p>This is what I need to put in the HAML file </p>\n\n<pre><code>&lt;script&gt;\nvar _rollbarConfig = {\n    accessToken: \"POST_CLIENT_ITEM_ACCESS_TOKEN\",\n    captureUncaught: true,\n    captureUnhandledRejections: true,\n    payload: {\n        environment: \"production\"\n    }\n};\n// Rollbar Snippet\n!function(r){var e={};function o(n){if(e[n])return e[n].exports;var t=e[n]={i:n,l:!1,exports:{}};return r[n].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=r,o.c=e,o.d=function(r,e,n){o.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:n})},o.r=function(r){\"undefined\"!=typeof Symbol&amp;&amp;Symbol.toStringTag&amp;&amp;Object.defineProperty(r,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(r,\"__esModule\",{value:!0})},o.t=function(r,e){if(1&amp;e&amp;&amp;(r=o(r)),8&amp;e)return r;if(4&amp;e&amp;&amp;\"object\"==typeof r&amp;&amp;r&amp;&amp;r.__esModule)return r;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:r}),2&amp;e&amp;&amp;\"string\"!=typeof r)for(var t in r)o.d(n,t,function(e){return r[e]}.bind(null,t));return n},o.n=function(r){var e=r&amp;&amp;r.__esModule?function(){return r.default}:function(){return r};return o.d(e,\"a\",e),e},o.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},o.p=\"\",o(o.s=0)}([function(r,e,o){var n=o(1),t=o(4);_rollbarConfig=_rollbarConfig||{},_rollbarConfig.rollbarJsUrl=_rollbarConfig.rollbarJsUrl||\"https://cdnjs.cloudflare.com/ajax/libs/rollbar.js/2.8.1/rollbar.min.js\",_rollbarConfig.async=void 0===_rollbarConfig.async||_rollbarConfig.async;var a=n.setupShim(window,_rollbarConfig),l=t(_rollbarConfig);window.rollbar=n.Rollbar,a.loadFull(window,document,!_rollbarConfig.async,_rollbarConfig,l)},function(r,e,o){var n=o(2);function t(r){return function(){try{return r.apply(this,arguments)}catch(r){try{console.error(\"[Rollbar]: Internal error\",r)}catch(r){}}}}var a=0;function l(r,e){this.options=r,this._rollbarOldOnError=null;var o=a++;this.shimId=function(){return o},\"undefined\"!=typeof window&amp;&amp;window._rollbarShims&amp;&amp;(window._rollbarShims[o]={handler:e,messages:[]})}var i=o(3),d=function(r,e){return new l(r,e)},s=function(r){return new i(d,r)};function c(r){return t(function(){var e=Array.prototype.slice.call(arguments,0),o={shim:this,method:r,args:e,ts:new Date};window._rollbarShims[this.shimId()].messages.push(o)})}l.prototype.loadFull=function(r,e,o,n,a){var l=!1,i=e.createElement(\"script\"),d=e.getElementsByTagName(\"script\")[0],s=d.parentNode;i.crossOrigin=\"\",i.src=n.rollbarJsUrl,o||(i.async=!0),i.onload=i.onreadystatechange=t(function(){if(!(l||this.readyState&amp;&amp;\"loaded\"!==this.readyState&amp;&amp;\"complete\"!==this.readyState)){i.onload=i.onreadystatechange=null;try{s.removeChild(i)}catch(r){}l=!0,function(){var e;if(void 0===r._rollbarDidLoad){e=new Error(\"rollbar.js did not load\");for(var o,n,t,l,i=0;o=r._rollbarShims[i++];)for(o=o.messages||[];n=o.shift();)for(t=n.args||[],i=0;i&lt;t.length;++i)if(\"function\"==typeof(l=t[i])){l(e);break}}\"function\"==typeof a&amp;&amp;a(e)}()}}),s.insertBefore(i,d)},l.prototype.wrap=function(r,e,o){try{var n;if(n=\"function\"==typeof e?e:function(){return e||{}},\"function\"!=typeof r)return r;if(r._isWrap)return r;if(!r._rollbar_wrapped&amp;&amp;(r._rollbar_wrapped=function(){o&amp;&amp;\"function\"==typeof o&amp;&amp;o.apply(this,arguments);try{return r.apply(this,arguments)}catch(o){var e=o;throw e&amp;&amp;(\"string\"==typeof e&amp;&amp;(e=new String(e)),e._rollbarContext=n()||{},e._rollbarContext._wrappedSource=r.toString(),window._rollbarWrappedError=e),e}},r._rollbar_wrapped._isWrap=!0,r.hasOwnProperty))for(var t in r)r.hasOwnProperty(t)&amp;&amp;(r._rollbar_wrapped[t]=r[t]);return r._rollbar_wrapped}catch(e){return r}};for(var p=\"log,debug,info,warn,warning,error,critical,global,configure,handleUncaughtException,handleAnonymousErrors,handleUnhandledRejection,captureEvent,captureDomContentLoaded,captureLoad\".split(\",\"),u=0;u&lt;p.length;++u)l.prototype[p[u]]=c(p[u]);r.exports={setupShim:function(r,e){if(r){var o=e.globalAlias||\"Rollbar\";if(\"object\"==typeof r[o])return r[o];r._rollbarShims={},r._rollbarWrappedError=null;var a=new s(e);return t(function(){e.captureUncaught&amp;&amp;(a._rollbarOldOnError=r.onerror,n.captureUncaughtExceptions(r,a,!0),n.wrapGlobals(r,a,!0)),e.captureUnhandledRejections&amp;&amp;n.captureUnhandledRejections(r,a,!0);var t=e.autoInstrument;return!1!==e.enabled&amp;&amp;(void 0===t||!0===t||\"object\"==typeof t&amp;&amp;t.network)&amp;&amp;r.addEventListener&amp;&amp;(r.addEventListener(\"load\",a.captureLoad.bind(a)),r.addEventListener(\"DOMContentLoaded\",a.captureDomContentLoaded.bind(a))),r[o]=a,a})()}},Rollbar:s}},function(r,e){function o(r,e,o){if(e.hasOwnProperty&amp;&amp;e.hasOwnProperty(\"addEventListener\")){for(var n=e.addEventListener;n._rollbarOldAdd&amp;&amp;n.belongsToShim;)n=n._rollbarOldAdd;var t=function(e,o,t){n.call(this,e,r.wrap(o),t)};t._rollbarOldAdd=n,t.belongsToShim=o,e.addEventListener=t;for(var a=e.removeEventListener;a._rollbarOldRemove&amp;&amp;a.belongsToShim;)a=a._rollbarOldRemove;var l=function(r,e,o){a.call(this,r,e&amp;&amp;e._rollbar_wrapped||e,o)};l._rollbarOldRemove=a,l.belongsToShim=o,e.removeEventListener=l}}r.exports={captureUncaughtExceptions:function(r,e,o){if(r){var n;if(\"function\"==typeof e._rollbarOldOnError)n=e._rollbarOldOnError;else if(r.onerror){for(n=r.onerror;n._rollbarOldOnError;)n=n._rollbarOldOnError;e._rollbarOldOnError=n}e.handleAnonymousErrors();var t=function(){var o=Array.prototype.slice.call(arguments,0);!function(r,e,o,n){r._rollbarWrappedError&amp;&amp;(n[4]||(n[4]=r._rollbarWrappedError),n[5]||(n[5]=r._rollbarWrappedError._rollbarContext),r._rollbarWrappedError=null),e.handleUncaughtException.apply(e,n),o&amp;&amp;o.apply(r,n)}(r,e,n,o)};o&amp;&amp;(t._rollbarOldOnError=n),r.onerror=t}},captureUnhandledRejections:function(r,e,o){if(r){\"function\"==typeof r._rollbarURH&amp;&amp;r._rollbarURH.belongsToShim&amp;&amp;r.removeEventListener(\"unhandledrejection\",r._rollbarURH);var n=function(r){var o,n,t;try{o=r.reason}catch(r){o=void 0}try{n=r.promise}catch(r){n=\"[unhandledrejection] error getting `promise` from event\"}try{t=r.detail,!o&amp;&amp;t&amp;&amp;(o=t.reason,n=t.promise)}catch(r){}o||(o=\"[unhandledrejection] error getting `reason` from event\"),e&amp;&amp;e.handleUnhandledRejection&amp;&amp;e.handleUnhandledRejection(o,n)};n.belongsToShim=o,r._rollbarURH=n,r.addEventListener(\"unhandledrejection\",n)}},wrapGlobals:function(r,e,n){if(r){var t,a,l=\"EventTarget,Window,Node,ApplicationCache,AudioTrackList,ChannelMergerNode,CryptoOperation,EventSource,FileReader,HTMLUnknownElement,IDBDatabase,IDBRequest,IDBTransaction,KeyOperation,MediaController,MessagePort,ModalWindow,Notification,SVGElementInstance,Screen,TextTrack,TextTrackCue,TextTrackList,WebSocket,WebSocketWorker,Worker,XMLHttpRequest,XMLHttpRequestEventTarget,XMLHttpRequestUpload\".split(\",\");for(t=0;t&lt;l.length;++t)r[a=l[t]]&amp;&amp;r[a].prototype&amp;&amp;o(e,r[a].prototype,n)}}}},function(r,e){function o(r,e){this.impl=r(e,this),this.options=e,function(r){for(var e=function(r){return function(){var e=Array.prototype.slice.call(arguments,0);if(this.impl[r])return this.impl[r].apply(this.impl,e)}},o=\"log,debug,info,warn,warning,error,critical,global,configure,handleUncaughtException,handleAnonymousErrors,handleUnhandledRejection,_createItem,wrap,loadFull,shimId,captureEvent,captureDomContentLoaded,captureLoad\".split(\",\"),n=0;n&lt;o.length;n++)r[o[n]]=e(o[n])}(o.prototype)}o.prototype._swapAndProcessMessages=function(r,e){var o,n,t;for(this.impl=r(this.options);o=e.shift();)n=o.method,t=o.args,this[n]&amp;&amp;\"function\"==typeof this[n]&amp;&amp;(\"captureDomContentLoaded\"===n||\"captureLoad\"===n?this[n].apply(this,[t[0],o.ts]):this[n].apply(this,t));return this},r.exports=o},function(r,e){r.exports=function(r){return function(e){if(!e&amp;&amp;!window._rollbarInitialized){for(var o,n,t=(r=r||{}).globalAlias||\"Rollbar\",a=window.rollbar,l=function(r){return new a(r)},i=0;o=window._rollbarShims[i++];)n||(n=o.handler),o.handler._swapAndProcessMessages(l,o.messages);window[t]=n,window._rollbarInitialized=!0}}}}]);\n// End Rollbar Snippet\n&lt;/script&gt;\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "associations"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562613001, "post_id": 56940446, "comment_id": 100422412, "body": "The <code>build</code> method only works for collections."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 9069168, "user_type": "registered", "profile_image": "https://graph.facebook.com/1573157946093303/picture?type=large", "display_name": "Abhishek Kushwaha", "link": "https://stackoverflow.com/users/9069168/abhishek-kushwaha"}, "is_accepted": false, "score": 0, "last_activity_date": 1562880069, "creation_date": 1562880069, "answer_id": 56997443, "question_id": 56940446, "link": "https://stackoverflow.com/questions/56940446/how-do-i-save-two-models-that-require-the-presence-of-each-other/56997443#56997443", "title": "How do I save two models that require the presence of each-other", "body": "<p>The <strong>build method syntax</strong> is different for <strong>has_one</strong> and <strong>has_many</strong> associations.</p>\n\n<pre><code>class User &lt; ApplicationRecord\n    has_one :home, class_name: :Guild, foreign_key: :home_id\n    #Let's say user has many messages\n    has_many :messages\n\n    belongs_to :guild\nend\n</code></pre>\n\n<p>Syntax for has_many association:</p>\n\n<pre><code>user.messages.build\n</code></pre>\n\n<p>Syntax for has_one association:</p>\n\n<pre><code>user.build_home  # this will work\n\nuser.home.build  # this will throw error\n</code></pre>\n\n<p>Read the has_one association <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#M001834\" rel=\"nofollow noreferrer\">documentation</a> for more details.</p>\n"}], "owner": {"reputation": 11, "user_id": 11755911, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vU3mXdrRvJQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMu4LK2gfpZca0ApLJNTnSl5vhow/photo.jpg?sz=128", "display_name": "Omar Abbasi", "link": "https://stackoverflow.com/users/11755911/omar-abbasi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562880069, "creation_date": 1562609386, "last_edit_date": 1562693867, "question_id": 56940446, "link": "https://stackoverflow.com/questions/56940446/how-do-i-save-two-models-that-require-the-presence-of-each-other", "title": "How do I save two models that require the presence of each-other", "body": "<p>Users belong to a Guild and can create and own others. </p>\n\n<p>When creating an account a <code>Home</code> guild is created for a User that functions uniquely from other guilds. </p>\n\n<p>I've tried <code>user=User.new ==&gt; user.home.build</code> but that doesn't seem to function.  </p>\n\n<p>I keep getting <code>NoMethodError: undefined method 'build' for nil:NilClass</code></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># == Schema Information\n#\n# Table name: guilds\n#\n#  id         :bigint           not null, primary key\n#  is_home    :boolean          default(FALSE)\n#  name       :string           not null\n#  owner_id   :integer          not null\n#  member_id  :integer          not null\n#  created_at :datetime         not null\n#  updated_at :datetime         not null\n#\n\nclass Guild &lt; ApplicationRecord\n    belongs_to :owner, class_name: :User\n\n    has_many :guild_members, class_name: :User\n\n    # Trying here.\n    def self.create_home(user) \n        home = Guild.new(is_home: true, name: user.name, owner_id: user.id ) \n    end\nend\n\n\n# frozen_string_literal: true\n\n# == Schema Information\n#\n# Table name: users\n#\n#  id              :bigint           not null, primary key\n#  username        :string           not null\n#  digits          :integer          not null\n#  email           :string\n#  password_digest :string           not null\n#  session_token   :string           not null\n#  created_at      :datetime         not null\n#  updated_at      :datetime         not null\n#  home_id         :integer          not null\n#\n\nclass User &lt; ApplicationRecord\n  has_one :home, class_name: :Guild, foreign_key: :home_id\n\n  belongs_to :guild\nend\n</code></pre>\n"}, {"tags": ["ruby", "string", "encoding"], "answers": [{"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 5, "last_activity_date": 1562610445, "last_edit_date": 1562610445, "creation_date": 1562609246, "answer_id": 56940415, "question_id": 56940212, "link": "https://stackoverflow.com/questions/56940212/defining-a-stringprev-method-in-ruby/56940415#56940415", "title": "Defining a String#prev method in Ruby", "body": "<p>You are going to have to pass the encoding for that because the default external encoding is <code>US-ASCII</code>. </p>\n\n<p>Changing <code>chr</code> to <code>chr('UTF-8')</code> will result in <code>\"\\u0915\"</code> which is correct for the symbol prior to <code>'\u0916'</code></p>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56940415, "answer_count": 1, "score": 2, "last_activity_date": 1562610995, "creation_date": 1562608370, "last_edit_date": 1562610995, "question_id": 56940212, "link": "https://stackoverflow.com/questions/56940212/defining-a-stringprev-method-in-ruby", "title": "Defining a String#prev method in Ruby", "body": "<p>I have seen Ruby's String#next can handle non ASCII characters.\nSaying that I know English, Bengali and Hindi:</p>\n\n<pre><code>&gt; 'a'.next    # =&gt; \"b\"\n&gt; '\u0995'.next    # =&gt; \"\u0996\"\n&gt; '\u0915'.next    # =&gt; \"\u0916\"\n</code></pre>\n\n<p>Which is right.</p>\n\n<p>Now I want to dynamically define a <code>prev</code> method to the String class.\nI can do this:</p>\n\n<pre><code>String.define_method(:prev) { slice(0..-2) + slice(-1).ord.-(1).chr }\n&gt; 'hit'.prev    # =&gt; \"his\"\n&gt; 'b'.prev      # =&gt; \"a\"\n\n&gt; '\u0916'.prev\nTraceback (most recent call last):\n        4: from /home/sourav/.irb:351:in `&lt;main&gt;'\n        3: from (irb):17\n        2: from (irb):11:in `block in irb_binding'\n        1: from (irb):11:in `chr'\nRangeError (2325 out of char range)\n\n</code></pre>\n\n<p>But it should return the followings:</p>\n\n<pre><code>&gt; 'b'.prev     # =&gt; \"a\"\n&gt; '\u0916'.prev    # =&gt; \"\u0915\"\n&gt; '\u0996'.prev    # =&gt; \"\u0995\"\n</code></pre>\n\n<p>Is there a way to do that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2958, "user_id": 3597730, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d76b8f632aeb1d920d79d7dd5ab63097?s=128&d=identicon&r=PG", "display_name": "ruby_newbie", "link": "https://stackoverflow.com/users/3597730/ruby-newbie"}, "edited": false, "score": 4, "creation_date": 1562609189, "post_id": 56940126, "comment_id": 100420858, "body": "Why does setting something in the initializer seem wrong to you?  You can set a class variable using the @@my_variable but It is strongly discouraged IMO.  Personally I would do it in the initializers if every user of the app will be using the same S3 bucket.  If you need different buckets for different users you may consider using session storage but I think the initializer is the right place for this.  Care to elaborate on what issue you are running into with your tests using the initializer?"}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1562648929, "post_id": 56940126, "comment_id": 100430796, "body": "Defining global constants in an initializer is absolutely fine in Rails. Just make sure you don&#39;t mutate them, and if you find yourself defining way too many of them maybe reconsider what you&#39;re doing. If you&#39;re getting warnings about constants changing, double check to make sure that nothing is setting them. Also you can add <code>.freeze</code> to any constant to prevent it from being mutated. That may be what your specs are complaining about."}, {"owner": {"reputation": 31, "user_id": 2579191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d386a4de0c410bf299fd227f523d82e?s=128&d=identicon&r=PG", "display_name": "user2579191", "link": "https://stackoverflow.com/users/2579191/user2579191"}, "edited": false, "score": 0, "creation_date": 1562656843, "post_id": 56940126, "comment_id": 100433849, "body": "I have tried to clarify my problem. Setting everything up in a initializer is what I want to do. I would love the code I have to just work.   I need to have a stub object for the bucket for the specs to work."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2579191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d386a4de0c410bf299fd227f523d82e?s=128&d=identicon&r=PG", "display_name": "user2579191", "link": "https://stackoverflow.com/users/2579191/user2579191"}, "edited": false, "score": 0, "creation_date": 1562657188, "post_id": 56945795, "comment_id": 100433997, "body": "The code is what I want in this situation. I am glad you agree with me there. The issue is that the code is not working."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1562649652, "creation_date": 1562649652, "answer_id": 56945795, "question_id": 56940126, "link": "https://stackoverflow.com/questions/56940126/how-can-i-avoid-a-constant-when-i-want-a-global-object-in-rails/56945795#56945795", "title": "How can I avoid a constant when I want a global object in rails?", "body": "<p>This code might look strange, but it's actually exactly what you'd want in this situation. Keep in mind this situation is a bit irregular, it's for configuring a plugin that has external API dependencies and associated keys that must be populated before the rest of the code works.</p>\n\n<p>It's ugly from an implementation perspective, but from a usability perspective it's nice. You can just do <code>AWSHelpers::S3.configure do |config|</code> as shown in the initializer. All that code is to make those semantics work properly.</p>\n"}, {"tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": false, "score": 0, "last_activity_date": 1562888214, "creation_date": 1562888214, "answer_id": 56998558, "question_id": 56940126, "link": "https://stackoverflow.com/questions/56940126/how-can-i-avoid-a-constant-when-i-want-a-global-object-in-rails/56998558#56998558", "title": "How can I avoid a constant when I want a global object in rails?", "body": "<p>This is a cheap trick, but it works.</p>\n\n<p>in <code>config/application.rb</code>:</p>\n\n<pre><code>module YourApp\n  class Application &lt; Rails::Application\n\n    def s3_bucket\n      @s3_bucket ||= begin\n        # your stuff\n      end \n    end \n  end\nend \n\nRails.application.s3_bucket.object(a_key)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 2579191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d386a4de0c410bf299fd227f523d82e?s=128&d=identicon&r=PG", "display_name": "user2579191", "link": "https://stackoverflow.com/users/2579191/user2579191"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1563537038, "creation_date": 1562607999, "last_edit_date": 1563537038, "question_id": 56940126, "link": "https://stackoverflow.com/questions/56940126/how-can-i-avoid-a-constant-when-i-want-a-global-object-in-rails", "title": "How can I avoid a constant when I want a global object in rails?", "body": "<p>I am want to add S3 file storage to my rails 5 application. Since I am using heroku I used their <a href=\"https://devcenter.heroku.com/articles/direct-to-s3-image-uploads-in-rails#s3-sdk\" rel=\"nofollow noreferrer\">tutorial</a> which says to just create a constant named <code>S3_BUCKET</code> in your <code>config/initializers/aws.rb</code> and you can use that constant everywhere. </p>\n\n<p>The heroku code looks like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#config/initializers/aws.rb\n\nS3_BUCKET = Aws::S3::Resource.new.bucket(ENV['S3_BUCKET'])\n</code></pre>\n\n<p>The problem with this is that I have to override this constant for the specs to work.</p>\n\n<p>I have this alternative solution (which is sadly not working):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#lib/aws_helpers/s3.rb\n\nmodule AWSHelpers\n  module S3\n    class &lt;&lt; self\n      attr_accessor :configuration\n\n      def configure\n        self.configuration ||= Configuration.new\n        yield(configuration)\n      end\n\n      def bucket\n        @bucket ||= Aws::S3::Resource.new.bucket(configuration.s3_bucket)\n      end\n    end\n\n    class Configuration\n      attr_accessor :s3_bucket, :aws_access_key_id, :aws_secret_access_key_id\n    end\n  end\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#config/initializers/aws.rb\n\nAWSHelpers::S3.configure do |config|\n  config.s3_bucket = ENV['S3_BUCKET']\n  config.aws_access_key_id = ENV['AWS_ACCESS_KEY_ID']\n  config.aws_secret_access_key_id = ENV['AWS_SECRET_ACCESS_KEY']\nend\n</code></pre>\n\n<p>What I want to be able to do in a controller is:</p>\n\n<pre><code>AWSHelpers::S3.bucket.object(a_key)\n</code></pre>\n\n<p>Unfortunately this fails and tells me that <code>bucket</code> method can't return anything because the configuration is nil.</p>\n\n<p>What I know:</p>\n\n<ol>\n<li>the aws initializer gets executed and when I add <code>puts</code> in all the methods I can see the correct output when my server starts via <code>rails s</code> </li>\n<li>the controller knows about the service module or it would not even get to the <code>bucket</code> method</li>\n<li>the code works when I dump the content of <code>config/initializers/aws.rb</code> into the controller</li>\n</ol>\n\n<p>I really would like to know why the code above is not working. It seems to set up everything correctly and then when I want to use it in the controller suddenly things are as if i'd never called <code>configure</code>.</p>\n\n<p>I am also open to other suggestions on how to do this. Just using the constant is not an option because it has to be changed for the specs to work.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "rails-activerecord"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1562606854, "post_id": 56939772, "comment_id": 100419936, "body": "Isn&#39;t update_all available for your Rails version?"}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1562673628, "post_id": 56939772, "comment_id": 100442612, "body": "There seem to be some typos in your code (<code>reivews</code>, ...)"}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1562673756, "post_id": 56939772, "comment_id": 100442691, "body": "You tagged your question with <code>ruby-on-rails-3</code>. If that is indeed the version you use (if you can, don&#39;t! use Rails 5.x), it would be helpful to mention that in the question itself."}], "answers": [{"tags": [], "owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "is_accepted": false, "score": 0, "last_activity_date": 1562679737, "last_edit_date": 1562679737, "creation_date": 1562673888, "answer_id": 56952204, "question_id": 56939772, "link": "https://stackoverflow.com/questions/56939772/how-to-use-rails-update-method-for-multiple-object-with-collection/56952204#56952204", "title": "How to use rails update method for multiple object with collection", "body": "<p>In \"modern\" Rails versions (apparently since 3.0) you can use</p>\n\n<p><code>update_all</code> (<a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-update_all\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-update_all</a>)</p>\n\n<p>like this:</p>\n\n<p><code>Review.where(id: [2,5,10]).update_all(reviews_params)</code></p>\n\n<p>. That code would update the <code>Reviews</code> with id 2, 5 and 10.</p>\n"}], "owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562679737, "creation_date": 1562606271, "last_edit_date": 1562679694, "question_id": 56939772, "link": "https://stackoverflow.com/questions/56939772/how-to-use-rails-update-method-for-multiple-object-with-collection", "title": "How to use rails update method for multiple object with collection", "body": "<p>I am trying to update multiple objects with rails update method with update collection object as following codes:(couldn't really find the collection method)</p>\n\n<pre><code>def update\n\n      @reiew = Review.find(reivew_params)\n       review.update!(reivew_params)\n\n        if @reivews.update(reivew_params)\n        respond_to do |format|\n        format.html { redirect_to reivew_path}\n      end\n    else\n        respond_to do |format|\n        format.html { notice: 'saved errors'}\n      end\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "linux-mint"], "comments": [{"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "edited": false, "score": 0, "creation_date": 1562605960, "post_id": 56939423, "comment_id": 100419502, "body": "Are you using any version manager? Such as rvm or rbenv?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11078628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfcbb21c5a14bd76a4b712a80a9d60d1?s=128&d=identicon&r=PG", "display_name": "Alexander Smirnov", "link": "https://stackoverflow.com/users/11078628/alexander-smirnov"}, "is_accepted": false, "score": 0, "last_activity_date": 1562613988, "last_edit_date": 1562613988, "creation_date": 1562613562, "answer_id": 56941326, "question_id": 56939423, "link": "https://stackoverflow.com/questions/56939423/how-do-i-get-the-bundle-install-command-to-only-look-at-the-current-version-of/56941326#56941326", "title": "How do I get the &quot;bundle install&quot; command to only look at the current version of &quot;ruby&quot; (which I chose)?", "body": "<p><code>bundler</code> gem orients on Ruby version, which locked in <code>Gemfile.lock</code>. Just change Ruby version in <code>Gemfile</code> (not .lock). Try <code>2.3.3</code> at first. Maybe you need to install it with <code>rvm</code> or <code>rbenv</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1562651989, "post_id": 56941652, "comment_id": 100431645, "body": "Also recommend adding a <code>.ruby-gemset</code> file to keep your gems separate for each project as a best practice."}], "tags": [], "owner": {"reputation": 367, "user_id": 3045497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c748f160a6a3fcf402837091c1a41ea8?s=128&d=identicon&r=PG", "display_name": "artem_russkikh", "link": "https://stackoverflow.com/users/3045497/artem-russkikh"}, "is_accepted": true, "score": 2, "last_activity_date": 1562615026, "creation_date": 1562615026, "answer_id": 56941652, "question_id": 56939423, "link": "https://stackoverflow.com/questions/56939423/how-do-i-get-the-bundle-install-command-to-only-look-at-the-current-version-of/56941652#56941652", "title": "How do I get the &quot;bundle install&quot; command to only look at the current version of &quot;ruby&quot; (which I chose)?", "body": "<p><code>/usr/bin/ruby -v</code> gives you the version of ruby installed in your operating system.</p>\n\n<p>It seems that you already run <code>rvm use --default 2.6.3</code> because your <code>ruby</code> points to <code>rvm</code> location.</p>\n\n<p>Ruby environment manager <code>RVM</code> supports configuration inside following files: <code>.rvmrc</code>, <code>.versions.conf</code>, <code>.ruby-version</code>, <code>Gemfile</code>. More here: <a href=\"https://rvm.io/workflow/projects\" rel=\"nofollow noreferrer\">https://rvm.io/workflow/projects</a></p>\n\n<p>Check these files, it's good practice to set ruby version inside <code>.ruby-version</code> or <code>Gemfile</code>.</p>\n"}], "owner": {"reputation": 41, "user_id": 8520558, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1J1o2PwI9wY/AAAAAAAAAAI/AAAAAAAAAB0/wAqbG3jpvac/photo.jpg?sz=128", "display_name": "Vladimir Denisov", "link": "https://stackoverflow.com/users/8520558/vladimir-denisov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 56941652, "answer_count": 2, "score": 4, "last_activity_date": 1562615026, "creation_date": 1562604666, "question_id": 56939423, "link": "https://stackoverflow.com/questions/56939423/how-do-i-get-the-bundle-install-command-to-only-look-at-the-current-version-of", "title": "How do I get the &quot;bundle install&quot; command to only look at the current version of &quot;ruby&quot; (which I chose)?", "body": "<p>I installed <code>Ruby (v2.6.3)</code> and <code>Rails (v5.2.3)</code>.</p>\n\n<p>Even completed a training project on this framework.\nThen he took up a working project and first of all executed the command <code>bundle install</code>.\nAll modules were delivered normally, except one \"sassc-2.0.1\"</p>\n\n<p>Installation fails with this error:</p>\n\n<blockquote>\n  <p>sassc-2.0.1 requires ruby version >= 2.3.3, which is incompatible with the current version, ruby 2.3.1p112</p>\n</blockquote>\n\n<p>That is, I chose one version, and in fact uses a different version.\nI can't understand the reason for this.</p>\n\n<p>But I didn't give up the first time.\nI tried to check the ruby version in different ways:</p>\n\n<p>(1) Get ruby version</p>\n\n<pre><code>$&gt; ruby -v\nruby 2.6.3p62 (2019-04-16 revision 67580) [x86_64-linux]\n</code></pre>\n\n<p>(2) Get path to bin for ruby</p>\n\n<pre><code>$&gt; which ruby\n/home/vdenisov/.rvm/rubies/ruby-2.6.3/bin/ruby\n</code></pre>\n\n<p>(3) Get path to bin for bundle</p>\n\n<pre><code>$&gt; which bundle\n/home/vdenisov/.rvm/rubies/ruby-2.6.3/bin/bundle\n</code></pre>\n\n<p>All these commands give out that the current version of ruby is 2.6.3</p>\n\n<p>However, my friend advised me to do one more check</p>\n\n<p>(4) WTF ???</p>\n\n<pre><code>$&gt; /usr/bin/ruby -v\nruby 2.3.1p112 (2016-04-26) [x86_64-linux-gnu]\n</code></pre>\n\n<p>P.S.: before that I programmed in nodejs and there is a version Manager \"nvm\" - when you run the command \"nvm use a.b.c\" in the system, always use the nodejs version of \"a.b.c\" (the same I expected from the \"rvm\").</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": true, "score": 2, "last_activity_date": 1562602533, "last_edit_date": 1562602533, "creation_date": 1562602060, "answer_id": 56938757, "question_id": 56938445, "link": "https://stackoverflow.com/questions/56938445/prime-factorization-in-ruby-using-trial-division/56938757#56938757", "title": "Prime Factorization in Ruby using Trial Division", "body": "<p>There are 2 mistakes as far as I can see: the <code>f=3</code> line is in the while loop, causing f to be nil when n happens to be odd. nil has no <code>*</code> method, which causes the error.</p>\n\n<p>Also <code>while f*f&lt;n</code> fails for 9, ; should be <code>while f*f &lt;= n</code>. Note that <code>puts</code> returns <code>nil</code>, so the whole method returns nil.</p>\n\n<p>Also: <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/prime/rdoc/Prime.html#method-i-prime_division\" rel=\"nofollow noreferrer\">https://ruby-doc.org/stdlib-2.6.3/libdoc/prime/rdoc/Prime.html#method-i-prime_division</a> .(<code>require \"prime\"; p 100.prime_division</code>)</p>\n"}], "owner": {"reputation": 3, "user_id": 11755220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5271e0299f88aa1ddbbffc2085280429?s=128&d=identicon&r=PG&f=1", "display_name": "Jarvusc12", "link": "https://stackoverflow.com/users/11755220/jarvusc12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 56938757, "answer_count": 1, "score": 0, "last_activity_date": 1562602533, "creation_date": 1562600722, "last_edit_date": 1562602153, "question_id": 56938445, "link": "https://stackoverflow.com/questions/56938445/prime-factorization-in-ruby-using-trial-division", "title": "Prime Factorization in Ruby using Trial Division", "body": "<p>I am new to Ruby. I do have some past experience using python, but recently when I got back into coding I chose to learn Ruby. I am working on a program that needs to find the prime factors of a number so I created a method using trial division. Then when I try to call the method I get an error <code>trial_division': undefined method `*' for nil:NilClass (NoMethodError)</code>.</p>\n\n<p>I have tried using break for the while loops instead of end and got the same results. I don't know what in ruby is causing this method to not be recognized.</p>\n\n<pre><code>def trial_division(n)\n  a = []\n  while n % 2 == 0\n    a.push(2)\n    n /= 2\n  f = 3\n  end\n  while f * f &lt; n\n      if n % f == 0\n        a.push(f)\n        n /= f\n      else\n        f += 2\n      end\n  end\n  if n != 1\n    a.push(n)\n  end\nputs a\nend\n</code></pre>\n\n<p>I'd like the program to find the prime factors of a number and display the array.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1562599601, "post_id": 56938108, "comment_id": 100416576, "body": "Where do you save <code>shipping_methods</code> or <code>quote</code>?"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1562599743, "post_id": 56938108, "comment_id": 100416649, "body": "Just updated my question with those details. @mrzasa"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1562603574, "post_id": 56938108, "comment_id": 100418494, "body": "At no point to you call <code>save</code> so why would you anticipate that it would save? You could add <code>rate.save</code> in the each loop or change <code>rate.price = i.price</code> to <code>rate.update_attribute(:price, i.price)</code> if you don&#39;t mind skipping validation for this change"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1562612254, "post_id": 56938108, "comment_id": 100422123, "body": "<code>update</code> executes the <code>before_save</code> callback @engineersmnky"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1562614225, "post_id": 56938108, "comment_id": 100422942, "body": "Yes on <code>quote</code> which is ignorant of  anything <code>refresh_rates</code> is doing"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1562600099, "creation_date": 1562600099, "answer_id": 56938281, "question_id": 56938108, "link": "https://stackoverflow.com/questions/56938108/child-attributes-updated-with-first-or-initialize-not-saving-ruby-on-rails/56938281#56938281", "title": "Child attributes updated with .first_or_initialize not saving - Ruby on Rails", "body": "<p>When you call</p>\n\n<pre><code> rate = record.shipping_methods.where(name: i.name).first_or_initialize\n</code></pre>\n\n<p><code>shipping_method</code> is loaded from DB to a new object in memory that is not associated with <code>quote</code>. You should either:</p>\n\n<ol>\n<li>update the objects that are loaded in <code>shipping_method</code> association (without calling any methods that fetches them from the DB), or</li>\n<li>save <code>shipping methods</code> separately</li>\n</ol>\n\n<p>I would advise to try 1).</p>\n"}, {"tags": [], "owner": {"reputation": 155, "user_id": 1351923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2e90f5f2053a45b118f1ecae8c06030?s=128&d=identicon&r=PG", "display_name": "Bhimasen Rautaray", "link": "https://stackoverflow.com/users/1351923/bhimasen-rautaray"}, "is_accepted": false, "score": 0, "last_activity_date": 1562674281, "creation_date": 1562674281, "answer_id": 56952324, "question_id": 56938108, "link": "https://stackoverflow.com/questions/56938108/child-attributes-updated-with-first-or-initialize-not-saving-ruby-on-rails/56952324#56952324", "title": "Child attributes updated with .first_or_initialize not saving - Ruby on Rails", "body": "<p>This method should be:</p>\n\n<pre><code>def refresh_rates(record, admin)\n    #api call that returns a list of rates\n    updated_rates.each do |i|\n         rate = record.shipping_methods.where(name: i.name).first_or_initialize\n         rate.price = i.price\n    end\nend\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>def refresh_rates(record, admin)\n    #api call that returns a list of rates\n    updated_rates.each do |i|\n         rate = record.shipping_methods.where(name: i.name).first_or_initialize\n         rate.price = i.price\n         rate.save\n    end\nend\n</code></pre>\n\n<p>OR: </p>\n\n<pre><code>def refresh_rates(record, admin)\n    #api call that returns a list of rates\n    updated_rates.each do |i|\n         rate = record.shipping_methods.where(name: i.name).first_or_initialize(price: i.price)\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 56938281, "answer_count": 2, "score": 0, "last_activity_date": 1562674281, "creation_date": 1562599426, "last_edit_date": 1562599727, "question_id": 56938108, "link": "https://stackoverflow.com/questions/56938108/child-attributes-updated-with-first-or-initialize-not-saving-ruby-on-rails", "title": "Child attributes updated with .first_or_initialize not saving - Ruby on Rails", "body": "<p>I have a <code>quote</code> which has many <code>shipping methods</code>. When I save the <code>quote</code>, the shipping method prices are not updated when I use <code>.first_or_initialize</code>. I have also tried setting <code>autosave: true</code> on my association like so:</p>\n\n<p>quote.rb</p>\n\n<pre><code>has_many :shipping_methods, dependent: :destroy, autosave: true\n</code></pre>\n\n<p>I have a callback which refreshes my shipping methods &amp; their prices (quote.rb). </p>\n\n<pre><code>before_save :refresh_shipping_rates\n\ndef refresh_shipping_rates\n  ShippingMethod.refresh_rates(self, admin = true)\nend\n</code></pre>\n\n<p>My ShippingMethod.refresh_rates function (shipping_method.rb):</p>\n\n<pre><code>def refresh_rates(record, admin)\n    #api call that returns a list of rates\n    updated_rates.each do |i|\n         rate = record.shipping_methods.where(name: i.name).first_or_initialize\n         rate.price = i.price\n    end\nend\n</code></pre>\n\n<p>My quote is updated via a form submission to my <code>update</code> action. </p>\n\n<pre><code>def update\n    @quote = Quote.find(params[:id])\n    @quote.update(parameters)\n\n    if @quote.valid?\n\n        flash[:notice] = []\n        flash[:notice] &lt;&lt; \"Successfully Updated\"\n        render \"update\"\n    else\n        flash[:error] = []\n        @quote.errors.full_messages.each do |message|\n            flash[:error] &lt;&lt; message \n        end\n        render \"layouts/fail\"\n    end\n\nend\n</code></pre>\n\n<p>I assume the <code>shipping_methods</code> should be updated simply because they are associated to the parent record that is being updated even though none of their attributes are submitted through the form.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 32611, "user_id": 9819146, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ioXmnWNrB_w/AAAAAAAAAAI/AAAAAAAAADs/Q47JYDWDFyo/photo.jpg?sz=128", "display_name": "Maheer Ali", "link": "https://stackoverflow.com/users/9819146/maheer-ali"}, "edited": false, "score": 0, "creation_date": 1562584956, "post_id": 56933842, "comment_id": 100408111, "body": "Can please show some inputs and expected outputs."}, {"owner": {"reputation": 29, "user_id": 11404905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1311e2ebf347a624cd4c1e6d720603b5?s=128&d=identicon&r=PG&f=1", "display_name": "Anu", "link": "https://stackoverflow.com/users/11404905/anu"}, "reply_to_user": {"reputation": 32611, "user_id": 9819146, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ioXmnWNrB_w/AAAAAAAAAAI/AAAAAAAAADs/Q47JYDWDFyo/photo.jpg?sz=128", "display_name": "Maheer Ali", "link": "https://stackoverflow.com/users/9819146/maheer-ali"}, "edited": false, "score": 0, "creation_date": 1562585796, "post_id": 56933842, "comment_id": 100408516, "body": "How can I show if It&#39;s 4 digits or 5 digits or 6 digits, the largest palindromic number ?"}, {"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 0, "creation_date": 1562585905, "post_id": 56933842, "comment_id": 100408569, "body": "What happens if you change the values of <code>to</code> and <code>from</code>?"}, {"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 2, "creation_date": 1562586006, "post_id": 56933842, "comment_id": 100408618, "body": "Surely the largest n-digit palindromic number is just a sequence of 9s. So it&#39;s 999 for three digits, 9999 for four digits ... What are you <i>actually</i> trying to work out?"}, {"owner": {"reputation": 29, "user_id": 11404905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1311e2ebf347a624cd4c1e6d720603b5?s=128&d=identicon&r=PG&f=1", "display_name": "Anu", "link": "https://stackoverflow.com/users/11404905/anu"}, "edited": false, "score": 0, "creation_date": 1562586092, "post_id": 56933842, "comment_id": 100408655, "body": "yes if I change the value it does work but is there a way I can do so that I don&#39;t need to change the digit? it detects the digit and works quickly as it takes long time now."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1562589017, "post_id": 56933842, "comment_id": 100410154, "body": "Does it need to be a product? You code wouldn&#39;t find <code>929</code> for example, because it&#39;s prime."}], "answers": [{"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1562589731, "post_id": 56935133, "comment_id": 100410543, "body": "Given the size and complexity of the code, I hope it&#39;s much faster than <code>(10**(nb-1)...10**nb).select{ |i| i.to_s == i.to_s.reverse }</code>"}, {"owner": {"reputation": 29, "user_id": 11404905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1311e2ebf347a624cd4c1e6d720603b5?s=128&d=identicon&r=PG&f=1", "display_name": "Anu", "link": "https://stackoverflow.com/users/11404905/anu"}, "edited": false, "score": 0, "creation_date": 1562590039, "post_id": 56935133, "comment_id": 100410714, "body": "Can you explain the code please. I am new to coding."}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1562590070, "post_id": 56935133, "comment_id": 100410730, "body": "My first reaction was &quot;My brain is so sick generating such code&quot; but I tried your code that is waaaay easier than mine (with nb = 10) it&#39;s still running. My code took 0.79 second with nb = 10...  Can you test on your side ?"}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "reply_to_user": {"reputation": 29, "user_id": 11404905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1311e2ebf347a624cd4c1e6d720603b5?s=128&d=identicon&r=PG&f=1", "display_name": "Anu", "link": "https://stackoverflow.com/users/11404905/anu"}, "edited": false, "score": 0, "creation_date": 1562590338, "post_id": 56935133, "comment_id": 100410865, "body": "@Anu Basically, my goal is to generate the side that is &quot;mirrored&quot; in the palindrome using permutation. The number of mirrored digit is nb / 2 (it&#39;s an integer division).  There&#39;s a specific cas where only generating the mirrored part is not enough, when nb is odd. Because you don&#39;t have an even number of digit so I have to generate the middle column (my variable naming is wrong) during the mirrored part generation. With a drawing it&#39;ll be easier to explain, I&#39;m not a native english ^^&#39;"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1562590543, "post_id": 56935133, "comment_id": 100410991, "body": "It&#39;s all good, your code is indeed <i>much</i> faster than mine (e.g. 180x for nb=6). It makes sense because you generate palindromes directly whereas my code simply test every possible number."}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1562591126, "post_id": 56935133, "comment_id": 100411324, "body": "Your code is much faster than his code and it&#39;s way easier to understand than mine so it&#39;s a good solution too :)"}, {"owner": {"reputation": 29, "user_id": 11404905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1311e2ebf347a624cd4c1e6d720603b5?s=128&d=identicon&r=PG&f=1", "display_name": "Anu", "link": "https://stackoverflow.com/users/11404905/anu"}, "edited": false, "score": 0, "creation_date": 1562591746, "post_id": 56935133, "comment_id": 100411700, "body": "But how do I check if a product of 4 digit number is a palindrome? At the moment it checks for 4 digits"}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1562591871, "post_id": 56935133, "comment_id": 100411790, "body": "<code>(your_product).to_s == (your_product).to_s.reverse</code>"}], "tags": [], "owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "is_accepted": false, "score": 1, "last_activity_date": 1562590744, "last_edit_date": 1562590744, "creation_date": 1562589462, "answer_id": 56935133, "question_id": 56933842, "link": "https://stackoverflow.com/questions/56933842/how-can-i-generalise-my-code-to-find-palindrome-number-for-two-numbers-with-more/56935133#56935133", "title": "How can I generalise my code to find palindrome number for two numbers with more digits 4,5 or 6 and what can I do to make it work more quickly?", "body": "<p>A solution :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def palindrome(nb, exlude_zeros = true)\n  raise ArgumentError, 'nb should be &gt;= 1' if nb &lt; 1\n  num_permutation = nb / 2\n  should_generate_middle_column = nb.odd?\n  # Process\n  if should_generate_middle_column\n    # In this part we'll generate 101 111 121 131 141 151 161 171 181 191\n    # The middle column is 0 1 2 3 4 5 6 7 8 9 for 1x1\n    # Before generating the middle column we'll generate the permutation like in the else part.\n    result = (0..9).to_a.repeated_permutation(num_permutation).collect do |arr|\n      rev = arr.reverse\n      (0..9).collect { |i| (arr.clone &lt;&lt; i).concat(rev).join.to_i }\n    end\n    result.flatten!\n  else\n    # In this part we'll only find the permutations (for nb / 2) \n    # and mirror the permutations givin the palindrome.\n    result = (0..9).to_a.repeated_permutation(num_permutation).collect do |arr|\n        arr.concat(arr.reverse).join.to_i\n    end\n  end\n  result.reject! { |i| i.to_s.size != nb } if exlude_zeros\n  return result\nend\n</code></pre>\n\n<p>You can call it like this :<br>\npalindrome(1)<br>\npalindrome(2)<br>\npalindrome(3)<br>\netc...</p>\n\n<p>It'll return the list of palindrome number of the size you specified as input number.</p>\n"}, {"tags": [], "owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "is_accepted": false, "score": 2, "last_activity_date": 1562596248, "last_edit_date": 1562596248, "creation_date": 1562592476, "answer_id": 56935984, "question_id": 56933842, "link": "https://stackoverflow.com/questions/56933842/how-can-i-generalise-my-code-to-find-palindrome-number-for-two-numbers-with-more/56935984#56935984", "title": "How can I generalise my code to find palindrome number for two numbers with more digits 4,5 or 6 and what can I do to make it work more quickly?", "body": "<p>Here's another solution:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class PalindromeGenerator\n  def initialize(length)\n    raise ArgumentError if length &lt;= 1\n\n    @length = length\n  end\n\n  def run\n    length.odd? ? run_odd : run_even\n  end\n\n  private\n\n  attr_reader :length\n\n  def run_even\n    halves.map { |half| \"#{half}#{half.to_s.reverse}\".to_i }\n  end\n\n  def run_odd\n    halves.each_with_object([]) do |half, memo|\n      middles.each do |middle|\n        memo &lt;&lt; \"#{half}#{middle}#{half.to_s.reverse}\".to_i\n      end\n    end\n  end\n\n  def halves\n    half_length = length / 2\n    min = 10**(half_length - 1)\n    max = 10**half_length\n    (min...max)\n  end\n\n  def middles\n    (0..9)\n  end\nend\n</code></pre>\n\n<p>It builds the left halves of the palindrome from the given <code>length</code>. Then, it builds the palindrome list:</p>\n\n<ul>\n<li>If <code>length</code> is even, simply <code>map</code> and mirror the left half.</li>\n<li>If <code>length</code> is odd, for each half you have to build 10 palindromes by adding any number in the middle.</li>\n</ul>\n\n<hr>\n\n<p>For instance, given <code>length = 5</code>:</p>\n\n<ul>\n<li><code>half_length</code> is 2.</li>\n<li>The left halves are all numbers from 10 (<code>10**(2-1)</code>) to 99 (<code>10**2 - 1</code>).</li>\n<li>Since 5 is odd, the list can be built as follows:\n\n<ul>\n<li><code>half = 10</code> -> <code>[10001, 10101, 10201, 10301, 10401, 10501, 10601, 10701, 10801, 10901]</code></li>\n<li><code>half = 11</code> -> ...</li>\n<li>...</li>\n</ul></li>\n</ul>\n\n<p>I think it could be optimized quite a bit, but it's already a lot better than a naive approach.</p>\n"}, {"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 2, "creation_date": 1562593392, "post_id": 56936159, "comment_id": 100412762, "body": "You can use <code>...</code> instead of <code>- 1</code>."}, {"owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 2, "creation_date": 1562596134, "post_id": 56936159, "comment_id": 100414440, "body": "No, he means <a href=\"http://ruby-doc.org/core-2.1.3/Range.html\" rel=\"nofollow noreferrer\">exclusive ranges</a>. &quot;[Ranges] created using <code>...</code> exclude the end value&quot;. You should write <code>(0...digits.size &#47; 2)</code>."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1562596411, "last_edit_date": 1562596411, "creation_date": 1562593096, "answer_id": 56936159, "question_id": 56933842, "link": "https://stackoverflow.com/questions/56933842/how-can-i-generalise-my-code-to-find-palindrome-number-for-two-numbers-with-more/56936159#56936159", "title": "How can I generalise my code to find palindrome number for two numbers with more digits 4,5 or 6 and what can I do to make it work more quickly?", "body": "<p>Maybe it's not efficient, but the basic idea is to split the the number into digits array (<a href=\"https://ruby-doc.org/core-2.6.3/Integer.html#method-i-digits\" rel=\"nofollow noreferrer\">Integer#digits</a>), and check the halves:</p>\n\n<pre><code>n = 12421\n\ndigits = n.digits\ndigits[0...digits.size / 2] == digits.reverse[0...digits.size / 2]\n#=&gt; true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1562831206, "creation_date": 1562831206, "answer_id": 56984109, "question_id": 56933842, "link": "https://stackoverflow.com/questions/56933842/how-can-i-generalise-my-code-to-find-palindrome-number-for-two-numbers-with-more/56984109#56984109", "title": "How can I generalise my code to find palindrome number for two numbers with more digits 4,5 or 6 and what can I do to make it work more quickly?", "body": "<p>Suppose we wish to identify all palindromes between <code>from = 27</code> and <code>to = 3345</code>. Rather than examine each number between <code>from</code> and <code>to</code> in order to identify the palindromes, I will generate all the palindromes between <code>20</code> and <code>3999</code> recursively and combinatorially, and then use two binary searches to exclude all palindromes between <code>20</code> and <code>26</code> (i.e., <code>22</code> only) and all palindromes between <code>3346</code> and <code>3999</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def palindromes(from, to)\n  arr = ranges(from, to).each_with_object([]) do |(n,f,t),arr|\n    arr.concat(pals(n,f,t))\n  end.map { |a| a.join.to_i }                                                                          \n  is = arr.bsearch_index { |n| n &gt;= from }\n  ie = arr.bsearch_index { |n| n &gt; to }\n  ie = ie.nil? ? arr.size-1 : ie-1\n  arr[is..ie]\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>def ranges(from, to)\n  *a, from_first_digit = from.digits\n  from_nbr_digits = a.size + 1\n  *a, to_first_digit = to.digits\n  to_nbr_digits = a.size + 1\n  (from_nbr_digits..to_nbr_digits).each_with_object([]) { |ndigits, a|\n    a &lt;&lt; [ndigits, from_nbr_digits == ndigits ? from_first_digit : 1,\n          to_nbr_digits == ndigits ? to_first_digit : 9] }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>def pals(ndigits, first, last)\n  case ndigits\n  when 1\n    (first..last).to_a\n  when 2\n    (first..last).map {|d| [d,d]}\n  else\n    a = pals(ndigits-2, 0, 9)\n    (first..last).each_with_object([]) { |d,arr|\n      a.each {|b| arr &lt;&lt; [d,*b,d] } }\n  end\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>palindromes(27, 3345)\n  #=&gt; [                    33,   44,   55,   66,   77,   88,   99,\n  #     101,  111,  121,  131,  141,  151,  161,  171,  181,  191,\n  #     202,  212,  222,  232,  242,  252,  262,  272,  282,  292,\n  #     ...\n  #     909,  919,  929,  939,  949,  959,  969,  979,  989,  999,\n  #    1001, 1111, 1221, 1331, 1441, 1551, 1661, 1771, 1881, 1991,\n  #    2002, 2112, 2222, 2332, 2442, 2552, 2662, 2772, 2882, 2992,\n  #    3003, 3113, 3223, 3333]\n\npalindromes(1141, 3345)\n  #=&gt; [            1221, 1331, 1441, 1551, 1661, 1771, 1881, 1991,\n  #    2002, 2112, 2222, 2332, 2442, 2552, 2662, 2772, 2882, 2992,\n  #    3003, 3113, 3223, 3333]\n\nrequire 'time'\n\nt = Time.now \n(a = palindromes(27, 34_564_824_166)).size\n  #=&gt; 445635 (number of palindromes within range)\nputs \"Elapsed time = #{(Time.now-t).round(2)} seconds\"\n  # Elapsed time = 2.77 seconds\na.first(20)\n  #=&gt; [                33,  44,  55,  66,  77,  88,  99,\n  #    101, 111, 121, 131, 141, 151, 161, 171, 181, 191,\n  #    202, 212, 222] \na.last(10)\n  #=&gt; [34563836543, 34563936543, 34564046543, 34564146543, 34564246543,\n  #    34564346543, 34564446543, 34564546543, 34564646543, 34564746543] \n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>(under construction)</p>\n"}], "owner": {"reputation": 29, "user_id": 11404905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1311e2ebf347a624cd4c1e6d720603b5?s=128&d=identicon&r=PG&f=1", "display_name": "Anu", "link": "https://stackoverflow.com/users/11404905/anu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1562831206, "creation_date": 1562584896, "last_edit_date": 1562586216, "question_id": 56933842, "link": "https://stackoverflow.com/questions/56933842/how-can-i-generalise-my-code-to-find-palindrome-number-for-two-numbers-with-more", "title": "How can I generalise my code to find palindrome number for two numbers with more digits 4,5 or 6 and what can I do to make it work more quickly?", "body": "<p>I want the palindrome code to work not just for 3 digit but for 4, 5 or 6 and how can I work more quickly?</p>\n\n<pre><code>to = 999\nfrom = 100\npalindroms = []\nfor i in from..to do\n  p i\n  for j in 1..to do\n    k = i * j\n    palindroms &lt;&lt; k if k.to_s == k.to_s.reverse\n  end\nend\nputs palindroms.max\n</code></pre>\n"}, {"tags": ["ruby", "shopify"], "answers": [{"tags": [], "owner": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "is_accepted": false, "score": 0, "last_activity_date": 1562599167, "creation_date": 1562599167, "answer_id": 56938024, "question_id": 56932941, "link": "https://stackoverflow.com/questions/56932941/rate-limit-shopify-api-calls-in-ruby/56938024#56938024", "title": "Rate limit Shopify API calls in Ruby", "body": "<p>The simplest approach is to Monkeypatch ActiveResource. Here is a repo that does all the work for you. </p>\n\n<p><a href=\"https://github.com/mikeyhew/shopify_api_mixins\" rel=\"nofollow noreferrer\">https://github.com/mikeyhew/shopify_api_mixins</a></p>\n"}, {"comments": [{"owner": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "edited": false, "score": 0, "creation_date": 1562687238, "post_id": 56955274, "comment_id": 100450989, "body": "Have you used that Gem? Does it work well? Do you have any example uses of it you can post as a gist or something? It seems interesting, but also kind of murky how that interacts with Active Resource."}], "tags": [], "owner": {"reputation": 1919, "user_id": 384689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66498e80512ef50822cceb2a2f5cba3?s=128&d=identicon&r=PG", "display_name": "claasz", "link": "https://stackoverflow.com/users/384689/claasz"}, "is_accepted": false, "score": 1, "last_activity_date": 1562683848, "creation_date": 1562683848, "answer_id": 56955274, "question_id": 56932941, "link": "https://stackoverflow.com/questions/56932941/rate-limit-shopify-api-calls-in-ruby/56955274#56955274", "title": "Rate limit Shopify API calls in Ruby", "body": "<p>There's a gem from Shopify itself to help with rate limiting: <a href=\"https://github.com/Shopify/limiter\" rel=\"nofollow noreferrer\">https://github.com/Shopify/limiter</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "edited": false, "score": 0, "creation_date": 1562687510, "post_id": 56956286, "comment_id": 100451123, "body": "Interesting approach... :)"}], "tags": [], "owner": {"reputation": 46, "user_id": 804949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e355d63a47961cae6255f230a3872bdc?s=128&d=identicon&r=PG", "display_name": "Dumb E.", "link": "https://stackoverflow.com/users/804949/dumb-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1562687149, "creation_date": 1562687149, "answer_id": 56956286, "question_id": 56932941, "link": "https://stackoverflow.com/questions/56932941/rate-limit-shopify-api-calls-in-ruby/56956286#56956286", "title": "Rate limit Shopify API calls in Ruby", "body": "<blockquote>\n  <p>I would rather use the data supplied in X-Shopify-Shop-Api-Call-Limit\n  and Retry-After rather than adding a fixed sleep.</p>\n</blockquote>\n\n<p>The <a href=\"https://github.com/ScreenStaring/shopify_api_retry\" rel=\"nofollow noreferrer\">Shopify API Retry gem</a> does this. It looks to <code>Retry-After</code> header but does use fixed sleep. No way around sleeping. How else to wait?  </p>\n\n<p>It does not do any \"monkey patching\". This is good. Monkey patching likely will cause problem at some point.  </p>\n\n<p>To use with your code</p>\n\n<pre><code>products = ShopifyAPIRetry.retry { ShopifyAPI::Product.find(:all, :params =&gt; {:limit =&gt; limit}) }\nproducts.each do |product|\n  variant = ShopifyAPIRetry.retry { ShopifyAPI::Variant.find(product.variants.first.id) }\n\n  variant.price = price\n  ShopifyAPIRetry.retry { variant.save }\n\n  inventoryitem = ShopifyAPIRetry.retry { ShopifyAPI::InventoryItem.find(product.variants.first.inventory_item_id) }\n\n  inventoryitem.cost = cost\n  ShopifyAPIRetry.retry { inventoryitem.save }\nend\n</code></pre>\n\n<p>Having to call <code>retry</code> everywhere is not that nice. You could possibly consolidate some places into single call. </p>\n"}], "owner": {"reputation": 47, "user_id": 11736353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2addd684a803ad395bc651a0fdc38b27?s=128&d=identicon&r=PG&f=1", "display_name": "user11736353", "link": "https://stackoverflow.com/users/11736353/user11736353"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1562687149, "creation_date": 1562581447, "question_id": 56932941, "link": "https://stackoverflow.com/questions/56932941/rate-limit-shopify-api-calls-in-ruby", "title": "Rate limit Shopify API calls in Ruby", "body": "<p>I am using Shopify's <code>shopify_api</code> gem in Ruby.</p>\n\n<p>I am updating each products cost and price from an external source however I am hitting the API limits and receiving <code>429 Too Many Requests</code> (<a href=\"https://help.shopify.com/en/api/reference/rest-admin-api-rate-limits\" rel=\"nofollow noreferrer\">https://help.shopify.com/en/api/reference/rest-admin-api-rate-limits</a>).</p>\n\n<p>How can I edit the below to respect the API limits?</p>\n\n<p>I would rather use the data supplied in <code>X-Shopify-Shop-Api-Call-Limit</code> and <code>Retry-After</code> rather than adding a fixed <code>sleep</code>.</p>\n\n<pre><code>products = ShopifyAPI::Product.find(:all, :params =&gt; {:limit =&gt; limit})\n\nproducts.each do |product|\n                variant = ShopifyAPI::Variant.find(product.variants.first.id)\n\n                variant.price = price\n                variant.save\n\n                inventoryitem = ShopifyAPI::InventoryItem.find(product.variants.first.inventory_item_id)\n\n                inventoryitem.cost = cost\n                inventoryitem.save\n        end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1257, "user_id": 4108555, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e4b39206bd7e7e23b3faa85b7cb1373c?s=128&d=identicon&r=PG&f=1", "display_name": "NN796", "link": "https://stackoverflow.com/users/4108555/nn796"}, "edited": false, "score": 0, "creation_date": 1562581359, "post_id": 56932669, "comment_id": 100406342, "body": "I ran it on my rails console. I am getting the same error: <code>undefined method &#47; for nil:NilClass (NoMethodError)</code>"}, {"owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 0, "creation_date": 1562593344, "post_id": 56932669, "comment_id": 100412731, "body": "&quot;Methods defined with <code>attr_accessor</code> are not inherited&quot;. Yes, they are. The article you link mentions class-level accessors. Your edit is the right answer though. I suggest you remove the first part."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1562652152, "post_id": 56932669, "comment_id": 100431702, "body": "@User123 As an aside, this is just simple inheritance, not polymorphism."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 6, "last_activity_date": 1562594442, "last_edit_date": 1562594442, "creation_date": 1562580506, "answer_id": 56932669, "question_id": 56932538, "link": "https://stackoverflow.com/questions/56932538/how-to-access-a-variable-in-polymorphism-with-ruby/56932669#56932669", "title": "How to access a variable in Polymorphism with Ruby?", "body": "<p>You're running it in wrong way. You should create instances of concrete shapes and then call methods on them:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[8] pry(main)&gt; circle = Circle.new\n=&gt; #&lt;Circle:0x0000563ed7328770&gt;\n[9] pry(main)&gt; circle.size = 5\n=&gt; 5\n[10] pry(main)&gt; circle.calculate_area\n=&gt; 12.566370614359172\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10021926"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 56932669, "answer_count": 1, "score": 2, "last_activity_date": 1562594442, "creation_date": 1562580068, "question_id": 56932538, "link": "https://stackoverflow.com/questions/56932538/how-to-access-a-variable-in-polymorphism-with-ruby", "title": "How to access a variable in Polymorphism with Ruby?", "body": "<p>I am trying to access the <code>size</code> variable in each of the polymorphic methods. When I run the code, I get the following error:</p>\n\n<pre><code>examples.rb:181:in `calculate_area': undefined method `/' for nil:NilClass (NoMethodError)\n        from examples.rb:175:in `calculate_area'\n        from examples.rb:199:in `&lt;main&gt;'\n</code></pre>\n\n<p>I have tried numerous hacks but haven't come up with a good solution. Here is the code below.</p>\n\n<pre><code>class Shape    \n\n    attr_accessor :size\n\n    def calculate_area(shape_type)\n        shape_type.calculate_area\n    end\nend\n\nclass Circle &lt; Shape\n    def calculate_area\n        return Math::PI * (size / 2) * (size / 2)\n    end\nend\n\nclass Square &lt; Shape\n    def calculate_area\n        return size * size\n    end\nend\n\nclass Triangle &lt; Shape\n    def calculate_area\n        return 0.5 * (size * 2) * size\n    end\nend\n\nshape = Shape.new\nshape.size = 5\nputs shape.calculate_area(Circle.new)\nputs shape.calculate_area(Square.new)\nputs shape.calculate_area(Triangle.new)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 174, "user_id": 5671433, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cNNGRVmEyv4/AAAAAAAAAAI/AAAAAAAACMU/anNZhDN_uf0/photo.jpg?sz=128", "display_name": "Moiz Mansur", "link": "https://stackoverflow.com/users/5671433/moiz-mansur"}, "edited": false, "score": 0, "creation_date": 1562578988, "post_id": 56932135, "comment_id": 100405110, "body": "Can you try sending status with your render like <code>render json: @pipeline, status: :ok</code>. I think that should fix your problem"}, {"owner": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "reply_to_user": {"reputation": 174, "user_id": 5671433, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cNNGRVmEyv4/AAAAAAAAAAI/AAAAAAAACMU/anNZhDN_uf0/photo.jpg?sz=128", "display_name": "Moiz Mansur", "link": "https://stackoverflow.com/users/5671433/moiz-mansur"}, "edited": false, "score": 0, "creation_date": 1562579175, "post_id": 56932135, "comment_id": 100405201, "body": "@MoizMansur Thankyou for your reply but it`s not working."}, {"owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "edited": false, "score": 0, "creation_date": 1562586348, "post_id": 56932135, "comment_id": 100408782, "body": "try <code>render json: {:pipeline =&gt; @pipeline}</code> in your controller"}, {"owner": {"reputation": 486, "user_id": 7069011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AfPIn.jpg?s=128&g=1", "display_name": "ThorTL67", "link": "https://stackoverflow.com/users/7069011/thortl67"}, "edited": false, "score": 0, "creation_date": 1562592085, "post_id": 56932135, "comment_id": 100411939, "body": "What is being displayed in your terminal?"}], "answers": [{"comments": [{"owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "reply_to_user": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "edited": false, "score": 0, "creation_date": 1562585297, "post_id": 56933484, "comment_id": 100408288, "body": "are you sure there is nothing printed in console. I guess you should get <code>Request 155 success</code>"}, {"owner": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "edited": false, "score": 0, "creation_date": 1562585626, "post_id": 56933484, "comment_id": 100408438, "body": "Yes, I am sure nothing printed in the console. It`s an issue URL not responding"}, {"owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "reply_to_user": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "edited": false, "score": 0, "creation_date": 1562585899, "post_id": 56933484, "comment_id": 100408564, "body": "what is your controller name?"}, {"owner": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "edited": false, "score": 0, "creation_date": 1562586129, "post_id": 56933484, "comment_id": 100408673, "body": "This is my controller name : NewPipelinesController"}], "tags": [], "owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "is_accepted": false, "score": 0, "last_activity_date": 1562586113, "last_edit_date": 1562586113, "creation_date": 1562583610, "answer_id": 56933484, "question_id": 56932135, "link": "https://stackoverflow.com/questions/56932135/ajax-url-is-not-responding-after-the-data-saved-successfully-in-database/56933484#56933484", "title": "Ajax url is not responding after the data saved successfully in database", "body": "<p>Try with</p>\n\n<pre><code>def create\n  @pipeline = current_user.pipelines.new params[:pipeline]\n  if @pipeline.save\n    respond_to do |format|\n      format.json {render json: @pipeline}\n    end\n  else\n    render new\n  end\nend\n\n\n$.ajax({\nurl: '/new_pipelines'\ntype: 'POST'\ndataType: 'json'\ndata: {pipeline:{pipelinegraphtype:pipelinegraphtype, name:tags_or_pipeline_name, published:\"0\", scheduler_id:\"22\", state:\"prepared\"},pipelinegraphname:pipelinegraphtype}\nsuccess: (data) -&gt;\n  console.log('Request 155 success')\nerror: () -&gt;\n  console.log('Request 155 fail')\n});\n</code></pre>\n"}], "owner": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562586113, "creation_date": 1562578701, "last_edit_date": 1562581791, "question_id": 56932135, "link": "https://stackoverflow.com/questions/56932135/ajax-url-is-not-responding-after-the-data-saved-successfully-in-database", "title": "Ajax url is not responding after the data saved successfully in database", "body": "<p>I am working on the live project of Ruby on rails. I have a pipeline section when I created new pipeline each time I stored data in a database though  hit the Ajax URL but now the issue is ajax url is not responding but data  successfully storing in database </p>\n\n<p><strong>Ajax Url:</strong></p>\n\n<pre><code>url: '/new_pipelines'\ntype: 'Post'\ndataType: 'json'\ndata: {pipeline:{pipelinegraphtype:pipelinegraphtype, name:tags_or_pipeline_name, published:\"0\", scheduler_id:\"22\", state:\"prepared\"},pipelinegraphname:pipelinegraphtype}\nsuccess: (data) -&gt;\n  console.log('Request 155 success')\nerror: () -&gt;\n  console.log('Request 155 fail')\n</code></pre>\n\n<p><strong>Create Method:</strong></p>\n\n<pre><code>def create\n  @pipeline = current_user.pipelines.new params[:pipeline]\n  if @pipeline.save\n    @pipeline.save\n    render json: @pipeline\n  else\n    render new\n  end\nend\n</code></pre>\n\n<p>Route:</p>\n\n<pre><code>match '/new_pipelines' =&gt; 'new_pipelines#create'\n</code></pre>\n"}, {"tags": ["ruby", "performance", "sorbet"], "answers": [{"tags": [], "owner": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "is_accepted": false, "score": 0, "last_activity_date": 1562579445, "creation_date": 1562579445, "answer_id": 56932353, "question_id": 56931904, "link": "https://stackoverflow.com/questions/56931904/will-using-sorbets-ruby-type-checker-have-an-impact-on-a-ruby-apps-performance/56932353#56932353", "title": "Will using Sorbet&#39;s ruby type checker have an impact on a ruby app&#39;s performance?", "body": "<p>the optimizations you are talking about apply more to the JIT that is beeing worked on for the ruby runtime.</p>\n\n<p>in general, sorbet aims at type-safety by introducing type interfaces or method signatures. they enable static type-checks that are applied before deploying the application in order to get rid of \"type errors\".</p>\n\n<p>sorbet comes with a runtime component that can enforce type checks at runtime in your runnable application, but those are going to decrease the applications performance as they wrap method-calls in order to check for correct types <a href=\"https://sorbet.org/docs/runtime#runtime-checked-sig-s\" rel=\"nofollow noreferrer\">https://sorbet.org/docs/runtime#runtime-checked-sig-s</a></p>\n"}, {"tags": [], "owner": {"reputation": 471, "user_id": 537862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2419732d3fbaf4b86de1f2bbab2931d?s=128&d=identicon&r=PG", "display_name": "user537862", "link": "https://stackoverflow.com/users/537862/user537862"}, "is_accepted": true, "score": 2, "last_activity_date": 1562602750, "creation_date": 1562602750, "answer_id": 56938939, "question_id": 56931904, "link": "https://stackoverflow.com/questions/56931904/will-using-sorbets-ruby-type-checker-have-an-impact-on-a-ruby-apps-performance/56938939#56938939", "title": "Will using Sorbet&#39;s ruby type checker have an impact on a ruby app&#39;s performance?", "body": "<blockquote>\n  <p>I thought maybe ruby interpreter does a similar work which can potentially mean that type-checking may increase interpreting speed</p>\n</blockquote>\n\n<p>It doesn't yet, but one could potentially build this one day.\nGoal of Sorbet was to build a type system for people, compared to building a type system for computers(compiler). It can introduce some performance overhead, but as Stripe runs it in production, we keep it in check. Internally, we page us if overhead is >7% of cpu time.</p>\n\n<blockquote>\n  <p>I did some reading on dynamically typed languages (particularly Javascript in this case) and found out that if we keep sending some function (foo for example) the same type of objects, the engine does some optimising work on that function, so that when it is invoked again with the same types, there interpreting work would be quicker.</p>\n</blockquote>\n\n<p>Yes, this can be done. What you're describing is a common optimization in Just-In-Time(JIT) compilers. The technique that you seem to refer to uses run time profiling and actually is a common alternative technique that allows to achieve this result in <em>absence</em> of type system. It's also worth noting that well-build JITs can do it more frequently than a type system, as type system encodes what <em>could</em> happen, while profiling &amp; JITs can optimize for what <em>actually happens in practice</em>. </p>\n\n<p>That said, building a JIT is frequently much more work than building an online compiler, thus, depending on amount of investment one wants to put into speeding up Ruby, either using building a JIT or using types can prove better under different real-world constrains. </p>\n\n<blockquote>\n  <p>I thought maybe ruby interpreter does a similar work which can potentially mean that type-checking may increase interpreting speed</p>\n</blockquote>\n\n<p>Summarizing the previous paragraph, Sorbet typesystem does not currently speedup Ruby, but it doesn't slow it down much either.\nType systems could be indeed used to speed up languages, but they aren't your only tool, with profiling &amp; JIT compilation being the major competitor.</p>\n"}], "owner": {"reputation": 103, "user_id": 6487983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eeccfe185f3adfc3a589d2bf1ee3918?s=128&d=identicon&r=PG&f=1", "display_name": "zivaricha", "link": "https://stackoverflow.com/users/6487983/zivaricha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 56938939, "answer_count": 2, "score": 2, "last_activity_date": 1562602750, "creation_date": 1562577895, "last_edit_date": 1562584901, "question_id": 56931904, "link": "https://stackoverflow.com/questions/56931904/will-using-sorbets-ruby-type-checker-have-an-impact-on-a-ruby-apps-performance", "title": "Will using Sorbet&#39;s ruby type checker have an impact on a ruby app&#39;s performance?", "body": "<p>Maybe a newb's question but if you never ask youll never know</p>\n\n<p>Will using Stripe's Sorbet (<a href=\"https://sorbet.org/\" rel=\"nofollow noreferrer\">https://sorbet.org/</a>) on a RoR app, can potentially improve the app's performance? \n(performance meaning response times, not robustness \\ runtime error rate)</p>\n\n<p>I did some reading on dynamically typed languages (particularly Javascript in this case) and found out that if we keep sending some function (<code>foo</code> for example) the same type of objects, the engine does some optimising work on that function, so that when it is invoked again with the same types, there interpreting work would be quicker.</p>\n\n<p>I thought maybe ruby interpreter does a similar work which can potentially mean that type-checking may increase interpreting speed</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 2501, "user_id": 1859956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rgRBJ.jpg?s=128&g=1", "display_name": "emi", "link": "https://stackoverflow.com/users/1859956/emi"}, "edited": false, "score": 0, "creation_date": 1562582784, "post_id": 56931840, "comment_id": 100407057, "body": "Can you post your <code>RailsAdmin::MainController</code> and also the full stack trace? What you posted is not the full stack trace."}, {"owner": {"reputation": 16, "user_id": 11753441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9jle8SV6etw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-DCm8Bt4Ac1m-eTpnXz-EmX7-OQ/photo.jpg?sz=128", "display_name": "Jerome", "link": "https://stackoverflow.com/users/11753441/jerome"}, "reply_to_user": {"reputation": 2501, "user_id": 1859956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rgRBJ.jpg?s=128&g=1", "display_name": "emi", "link": "https://stackoverflow.com/users/1859956/emi"}, "edited": false, "score": 0, "creation_date": 1562589199, "post_id": 56931840, "comment_id": 100410247, "body": "Unless I&#39;m mistaken, I don&#39;t have a rails_admin controller. I have in my controllers the ones I created as well as the application_controller. I updated the post with the full stack trace. Thx"}, {"owner": {"reputation": 214, "user_id": 1048150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a62edcdbf359a08425f5618c1a4385?s=128&d=identicon&r=PG", "display_name": "brod", "link": "https://stackoverflow.com/users/1048150/brod"}, "edited": false, "score": 0, "creation_date": 1600988117, "post_id": 56931840, "comment_id": 113271437, "body": "This seems very similar to a problem I have had here: <a href=\"https://stackoverflow.com/questions/63892568/stack-level-too-deep-rails-5-in-define-generate-prefix\" title=\"stack level too deep rails 5 in define generate prefix\">stackoverflow.com/questions/63892568/&hellip;</a> . Can you debug the mount method in <code>mapper.rb</code>? If you see it being called repeatedly, that is likely to be the reason for the <code>stack to deep</code>"}], "answers": [{"comments": [{"owner": {"reputation": 16, "user_id": 11753441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9jle8SV6etw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-DCm8Bt4Ac1m-eTpnXz-EmX7-OQ/photo.jpg?sz=128", "display_name": "Jerome", "link": "https://stackoverflow.com/users/11753441/jerome"}, "edited": false, "score": 0, "creation_date": 1562598642, "post_id": 56937601, "comment_id": 100415987, "body": "I updated the post with the <code>routes</code> and the <code>MainController</code>."}, {"owner": {"reputation": 16, "user_id": 11753441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9jle8SV6etw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-DCm8Bt4Ac1m-eTpnXz-EmX7-OQ/photo.jpg?sz=128", "display_name": "Jerome", "link": "https://stackoverflow.com/users/11753441/jerome"}, "edited": false, "score": 0, "creation_date": 1562678415, "post_id": 56937601, "comment_id": 100445432, "body": "Maybe because I use root_path instead of root_url for my redirection in the after_sign_in_path_for (mainController) ?"}], "tags": [], "owner": {"reputation": 66, "user_id": 1219790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IvoGn.jpg?s=128&g=1", "display_name": "Jessica Simpson", "link": "https://stackoverflow.com/users/1219790/jessica-simpson"}, "is_accepted": false, "score": 2, "last_activity_date": 1562597749, "creation_date": 1562597749, "answer_id": 56937601, "question_id": 56931840, "link": "https://stackoverflow.com/questions/56931840/stack-level-too-deep-systemstackerror-actionpack/56937601#56937601", "title": "Stack level too deep (SystemStackError) actionpack", "body": "<p>An option is that <code>RailsAdmin</code> cannot decide the prefix for your admin routes since there's an overlap in them. You can check all generated routes by running <code>rake routes</code> on your console.</p>\n\n<p>Do you have a redirect on your MainController? Because from the stacktrace it seems like you are either in a redirect loop caused by a <code>redirect_to</code> or by not having a valid admin session. If you can post the code of your <code>home#index</code> or the whole MainController I could provide a better answer.</p>\n"}], "owner": {"reputation": 16, "user_id": 11753441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9jle8SV6etw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-DCm8Bt4Ac1m-eTpnXz-EmX7-OQ/photo.jpg?sz=128", "display_name": "Jerome", "link": "https://stackoverflow.com/users/11753441/jerome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562598551, "creation_date": 1562577639, "last_edit_date": 1562598551, "question_id": 56931840, "link": "https://stackoverflow.com/questions/56931840/stack-level-too-deep-systemstackerror-actionpack", "title": "Stack level too deep (SystemStackError) actionpack", "body": "<p>I am developing a web application with ruby \u200b\u200bon rails and I have an error.</p>\n\n<p>The error appears randomly after navigating several times in the RAILS ADMIN console : </p>\n\n<h1>SystemStackError in RailsAdmin::MainController#dashboard</h1>\n\n<p>I do not know which way to go to solve the problem.</p>\n\n<h1>rake routes</h1>\n\n<pre><code>Controller#Action\n         new_user_session GET    /users/sign_in(.:format)                                                                 devise/sessions#new\n             user_session POST   /users/sign_in(.:format)                                                                 devise/sessions#create\n     destroy_user_session DELETE /users/sign_out(.:format)                                                                devise/sessions#destroy\n        new_user_password GET    /users/password/new(.:format)                                                            devise/passwords#new\n       edit_user_password GET    /users/password/edit(.:format)                                                           devise/passwords#edit\n            user_password PATCH  /users/password(.:format)                                                                devise/passwords#update\n                          PUT    /users/password(.:format)                                                                devise/passwords#update\n                          POST   /users/password(.:format)                                                                devise/passwords#create\n cancel_user_registration GET    /users/cancel(.:format)                                                                  devise/registrations#cancel\n    new_user_registration GET    /users/sign_up(.:format)                                                                 devise/registrations#new\n   edit_user_registration GET    /users/edit(.:format)                                                                    devise/registrations#edit\n        user_registration PATCH  /users(.:format)                                                                         devise/registrations#update\n                          PUT    /users(.:format)                                                                         devise/registrations#update\n                          DELETE /users(.:format)                                                                         devise/registrations#destroy\n                          POST   /users(.:format)                                                                         devise/registrations#create\n              rails_admin        /admin                                                                                   RailsAdmin::Engine\n                     root GET    /                                                                                        home#index\n                  contact GET    /contact(.:format)                                                                       home#contact\n                   propos GET    /propos(.:format)                                                                        home#propos\n                 settings GET    /settings(.:format)                                                                      settings#index\n                  collect GET    /collect(.:format)                                                                       collect#index\n            dashboardPres GET    /dashboardPres(.:format)                                                                 dashboard#index\n                          POST   /settings(.:format)                                                                      settings#index\n                          POST   /dashboardPres(.:format)                                                                 dashboard#index\n                          POST   /collect(.:format)                                                                       collect#index\n           collect_update POST   /collect_update(.:format)                                                                collect#update\n       rails_service_blob GET    /rails/active_storage/blobs/:signed_id/*filename(.:format)                               active_storage/blobs#show\nrails_blob_representation GET    /rails/active_storage/representations/:signed_blob_id/:variation_key/*filename(.:format) active_storage/representations#show\n       rails_disk_service GET    /rails/active_storage/disk/:encoded_key/*filename(.:format)                              active_storage/disk#show\nupdate_rails_disk_service PUT    /rails/active_storage/disk/:encoded_token(.:format)                                      active_storage/disk#update\n     rails_direct_uploads POST   /rails/active_storage/direct_uploads(.:format)                                           active_storage/direct_uploads#create\n\nRoutes for RailsAdmin::Engine:\n  dashboard GET         /                                      rails_admin/main#dashboard\n      index GET|POST    /:model_name(.:format)                 rails_admin/main#index\n        new GET|POST    /:model_name/new(.:format)             rails_admin/main#new\n     export GET|POST    /:model_name/export(.:format)          rails_admin/main#export\nbulk_delete POST|DELETE /:model_name/bulk_delete(.:format)     rails_admin/main#bulk_delete\nbulk_action POST        /:model_name/bulk_action(.:format)     rails_admin/main#bulk_action\n       show GET         /:model_name/:id(.:format)             rails_admin/main#show\n       edit GET|PUT     /:model_name/:id/edit(.:format)        rails_admin/main#edit\n     delete GET|DELETE  /:model_name/:id/delete(.:format)      rails_admin/main#delete\nshow_in_app GET         /:model_name/:id/show_in_app(.:format) rails_admin/main#show_in_app\n</code></pre>\n\n<h1>Main Controller</h1>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  rescue_from DeviseLdapAuthenticatable::LdapException do |exception|\n    render :text =&gt; exception, :status =&gt; 500\n  end\n  before_action :persist_last_visited_path, :authenticate_user!\n  before_action :configure_devise_parameters, if: :devise_controller?\n\n\n  rescue_from CanCan::AccessDenied do |exception|\n      redirect_to root_url, :alert =&gt; exception.message\n  end\n\n  def after_sign_in_path_for(resource)\n    if cookies[:last_visited_path].present?\n      cookies[:last_visited_path]\n     else\n      root_path\n     end\n  end\n\n  def configure_devise_parameters\n      devise_parameter_sanitizer.permit(:sign_up) { |u| u.permit(:username, :email, :password, :password_confirmation) }\n  end\n\n\n  def persist_last_visited_path\n    unless Rails.configuration.ignored_paths.include?(request.path) || request.xhr?   \n      cookies[:last_visited_path] = request.path\n    end\n  end\n\nend\n</code></pre>\n\n<h1>The full trace :</h1>\n\n<pre><code>actionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:689:in `block (2 levels) in define_generate_prefix'\nactionpack (5.2.2) lib/action_dispatch/routing/route_set.rb:813:in `url_for'\nactionpack (5.2.2) lib/action_dispatch/routing/route_set.rb:273:in `call'\nactionpack (5.2.2) lib/action_dispatch/routing/route_set.rb:214:in `call'\nactionpack (5.2.2) lib/action_dispatch/routing/route_set.rb:331:in `block (2 levels) in define_url_helper'\nrails_admin (1.4.2) app/views/rails_admin/main/dashboard.html.haml:12:in `block in __usr_local_bundle_gems_rails_admin_______app_views_rails_admin_main_dashboard_html_haml___4103999051765141740_69997247796300'\nrails_admin (1.4.2) app/views/rails_admin/main/dashboard.html.haml:10:in `each'\nrails_admin (1.4.2) app/views/rails_admin/main/dashboard.html.haml:10:in `__usr_local_bundle_gems_rails_admin_______app_views_rails_admin_main_dashboard_html_haml___4103999051765141740_69997247796300'\nactionview (5.2.2) lib/action_view/template.rb:159:in `block in render'\nactivesupport (5.2.2) lib/active_support/notifications.rb:170:in `instrument'\nactionview (5.2.2) lib/action_view/template.rb:354:in `instrument_render_template'\nactionview (5.2.2) lib/action_view/template.rb:157:in `render'\nactionview (5.2.2) lib/action_view/renderer/template_renderer.rb:54:in `block (2 levels) in render_template'\nactionview (5.2.2) lib/action_view/renderer/abstract_renderer.rb:44:in `block in instrument'\nactivesupport (5.2.2) lib/active_support/notifications.rb:168:in `block in instrument'\nactivesupport (5.2.2) lib/active_support/notifications/instrumenter.rb:23:in `instrument'\nactivesupport (5.2.2) lib/active_support/notifications.rb:168:in `instrument'\nactionview (5.2.2) lib/action_view/renderer/abstract_renderer.rb:43:in `instrument'\nactionview (5.2.2) lib/action_view/renderer/template_renderer.rb:53:in `block in render_template'\nactionview (5.2.2) lib/action_view/renderer/template_renderer.rb:61:in `render_with_layout'\nactionview (5.2.2) lib/action_view/renderer/template_renderer.rb:52:in `render_template'\nactionview (5.2.2) lib/action_view/renderer/template_renderer.rb:16:in `render'\nactionview (5.2.2) lib/action_view/renderer/renderer.rb:44:in `render_template'\nactionview (5.2.2) lib/action_view/renderer/renderer.rb:25:in `render'\nactionview (5.2.2) lib/action_view/rendering.rb:103:in `_render_template'\nactionpack (5.2.2) lib/action_controller/metal/streaming.rb:219:in `_render_template'\nactionview (5.2.2) lib/action_view/rendering.rb:84:in `render_to_body'\nactionpack (5.2.2) lib/action_controller/metal/rendering.rb:52:in `render_to_body'\nactionpack (5.2.2) lib/action_controller/metal/renderers.rb:142:in `render_to_body'\nactionpack (5.2.2) lib/abstract_controller/rendering.rb:25:in `render'\nactionpack (5.2.2) lib/action_controller/metal/rendering.rb:36:in `render'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:46:in `block (2 levels) in render'\nactivesupport (5.2.2) lib/active_support/core_ext/benchmark.rb:14:in `block in ms'\n/usr/local/lib/ruby/2.5.0/benchmark.rb:308:in `realtime'\nactivesupport (5.2.2) lib/active_support/core_ext/benchmark.rb:14:in `ms'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:46:in `block in render'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:87:in `cleanup_view_runtime'\nactiverecord (5.2.2) lib/active_record/railties/controller_runtime.rb:31:in `cleanup_view_runtime'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:45:in `render'\n/usr/local/bundle/bundler/gems/remotipart-999f98133c6f/lib/remotipart/render_overrides.rb:17:in `render_with_remotipart'\nrails_admin (1.4.2) lib/rails_admin/config/actions/dashboard.rb:37:in `block (2 levels) in &lt;class:Dashboard&gt;'\nrails_admin (1.4.2) app/controllers/rails_admin/main_controller.rb:22:in `instance_eval'\nrails_admin (1.4.2) app/controllers/rails_admin/main_controller.rb:22:in `dashboard'\nactionpack (5.2.2) lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'\nactionpack (5.2.2) lib/abstract_controller/base.rb:194:in `process_action'\nactionpack (5.2.2) lib/action_controller/metal/rendering.rb:30:in `process_action'\nactionpack (5.2.2) lib/abstract_controller/callbacks.rb:42:in `block in process_action'\nactivesupport (5.2.2) lib/active_support/callbacks.rb:132:in `run_callbacks'\nactionpack (5.2.2) lib/abstract_controller/callbacks.rb:41:in `process_action'\nactionpack (5.2.2) lib/action_controller/metal/rescue.rb:22:in `process_action'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:34:in `block in process_action'\nactivesupport (5.2.2) lib/active_support/notifications.rb:168:in `block in instrument'\nactivesupport (5.2.2) lib/active_support/notifications/instrumenter.rb:23:in `instrument'\nactivesupport (5.2.2) lib/active_support/notifications.rb:168:in `instrument'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:32:in `process_action'\nactionpack (5.2.2) lib/action_controller/metal/params_wrapper.rb:256:in `process_action'\nactiverecord (5.2.2) lib/active_record/railties/controller_runtime.rb:24:in `process_action'\nactionpack (5.2.2) lib/abstract_controller/base.rb:134:in `process'\nactionview (5.2.2) lib/action_view/rendering.rb:32:in `process'\nactionpack (5.2.2) lib/action_controller/metal.rb:191:in `dispatch'\nactionpack (5.2.2) lib/action_controller/metal.rb:252:in `dispatch'\nactionpack (5.2.2) lib/action_dispatch/routing/route_set.rb:52:in `dispatch'\nactionpack (5.2.2) lib/action_dispatch/routing/route_set.rb:34:in `serve'\nactionpack (5.2.2) lib/action_dispatch/journey/router.rb:52:in `block in serve'\nactionpack (5.2.2) lib/action_dispatch/journey/router.rb:35:in `each'\nactionpack (5.2.2) lib/action_dispatch/journey/router.rb:35:in `serve'\nactionpack (5.2.2) lib/action_dispatch/routing/route_set.rb:840:in `call'\nrailties (5.2.2) lib/rails/engine.rb:524:in `call'\nrailties (5.2.2) lib/rails/railtie.rb:190:in `public_send'\nrailties (5.2.2) lib/rails/railtie.rb:190:in `method_missing'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:19:in `block in &lt;class:Constraints&gt;'\nactionpack (5.2.2) lib/action_dispatch/routing/mapper.rb:48:in `serve'\nactionpack (5.2.2) lib/action_dispatch/journey/router.rb:52:in `block in serve'\nactionpack (5.2.2) lib/action_dispatch/journey/router.rb:35:in `each'\nactionpack (5.2.2) lib/action_dispatch/journey/router.rb:35:in `serve'\nactionpack (5.2.2) lib/action_dispatch/routing/route_set.rb:840:in `call'\nrack-pjax (1.1.0) lib/rack/pjax.rb:12:in `call'\n/usr/local/bundle/bundler/gems/remotipart-999f98133c6f/lib/remotipart/middleware.rb:32:in `call'\nwarden (1.2.8) lib/warden/manager.rb:36:in `block in call'\nwarden (1.2.8) lib/warden/manager.rb:34:in `catch'\nwarden (1.2.8) lib/warden/manager.rb:34:in `call'\nrack (2.0.6) lib/rack/tempfile_reaper.rb:15:in `call'\nrack (2.0.6) lib/rack/etag.rb:25:in `call'\nrack (2.0.6) lib/rack/conditional_get.rb:25:in `call'\nrack (2.0.6) lib/rack/head.rb:12:in `call'\nactionpack (5.2.2) lib/action_dispatch/http/content_security_policy.rb:18:in `call'\nrack (2.0.6) lib/rack/session/abstract/id.rb:232:in `context'\nrack (2.0.6) lib/rack/session/abstract/id.rb:226:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/cookies.rb:670:in `call'\nactiverecord (5.2.2) lib/active_record/migration.rb:559:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (5.2.2) lib/active_support/callbacks.rb:98:in `run_callbacks'\nactionpack (5.2.2) lib/action_dispatch/middleware/callbacks.rb:26:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/executor.rb:14:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'\nweb-console (3.7.0) lib/web_console/middleware.rb:135:in `call_app'\nweb-console (3.7.0) lib/web_console/middleware.rb:22:in `block in call'\nweb-console (3.7.0) lib/web_console/middleware.rb:20:in `catch'\nweb-console (3.7.0) lib/web_console/middleware.rb:20:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'\nrailties (5.2.2) lib/rails/rack/logger.rb:38:in `call_app'\nrailties (5.2.2) lib/rails/rack/logger.rb:26:in `block in call'\nactivesupport (5.2.2) lib/active_support/tagged_logging.rb:71:in `block in tagged'\nactivesupport (5.2.2) lib/active_support/tagged_logging.rb:28:in `tagged'\nactivesupport (5.2.2) lib/active_support/tagged_logging.rb:71:in `tagged'\nrailties (5.2.2) lib/rails/rack/logger.rb:26:in `call'\nsprockets-rails (3.2.1) lib/sprockets/rails/quiet_assets.rb:13:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/request_id.rb:27:in `call'\nrack (2.0.6) lib/rack/method_override.rb:22:in `call'\nrack (2.0.6) lib/rack/runtime.rb:22:in `call'\nactivesupport (5.2.2) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/executor.rb:14:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/static.rb:127:in `call'\nrack (2.0.6) lib/rack/sendfile.rb:111:in `call'\nrailties (5.2.2) lib/rails/engine.rb:524:in `call'\npuma (3.12.0) lib/puma/configuration.rb:225:in `call'\npuma (3.12.0) lib/puma/server.rb:658:in `handle_request'\npuma (3.12.0) lib/puma/server.rb:472:in `process_client'\npuma (3.12.0) lib/puma/server.rb:332:in `block in run'\npuma (3.12.0) lib/puma/thread_pool.rb:133:in `block in spawn_thread' \n</code></pre>\n\n<p>Can someone help me to solve this problem ? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1562577696, "post_id": 56930831, "comment_id": 100404421, "body": "This smells like an XY problem. Where do those strings come from?"}, {"owner": {"reputation": 71, "user_id": 4132642, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495440995/picture?type=large", "display_name": "FaZe Unempl0yedd", "link": "https://stackoverflow.com/users/4132642/faze-unempl0yedd"}, "edited": false, "score": 0, "creation_date": 1562587379, "post_id": 56930831, "comment_id": 100409294, "body": "<a href=\"https://stackoverflow.com/questions/6455177/how-to-parse-output-of-array-inspect-back-into-an-array\" title=\"how to parse output of array inspect back into an array\">stackoverflow.com/questions/6455177/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 807, "user_id": 1688322, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/cZ6Ai.jpg?s=128&g=1", "display_name": "Robin van Dijk", "link": "https://stackoverflow.com/users/1688322/robin-van-dijk"}, "is_accepted": false, "score": 10, "last_activity_date": 1562573753, "creation_date": 1562573753, "answer_id": 56930862, "question_id": 56930831, "link": "https://stackoverflow.com/questions/56930831/how-to-convert-the-given-string-to-array-in-rails/56930862#56930862", "title": "how to convert the given string to array in rails", "body": "<p>You can do it with JSON.</p>\n\n<pre><code>require 'json'\n\nstring = \"[\\\"Winter\\\", \\\"Summer\\\", \\\"Spring\\\"]\"\nJSON.parse(string)\n=&gt; [\"Winter\", \"Summer\", \"Spring\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 326, "user_id": 1241447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f26f8ae450e0c51b672402c30c2d38e1?s=128&d=identicon&r=PG", "display_name": "jbmeerkat", "link": "https://stackoverflow.com/users/1241447/jbmeerkat"}, "edited": false, "score": 0, "creation_date": 1562660661, "post_id": 56933807, "comment_id": 100435797, "body": "<b>Please, never do things like this in production code</b>. It may lead to a serious vulnerability."}], "tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 1, "last_activity_date": 1562584795, "creation_date": 1562584795, "answer_id": 56933807, "question_id": 56930831, "link": "https://stackoverflow.com/questions/56930831/how-to-convert-the-given-string-to-array-in-rails/56933807#56933807", "title": "how to convert the given string to array in rails", "body": "<p>just alternate solution (not safe) :</p>\n\n<pre><code>&gt; string = \"[\\\"Winter\\\", \\\"Summer\\\", \\\"Spring\\\"]\"\n&gt; eval(string)\n#=&gt; [\"Winter\", \"Summer\", \"Spring\"]\n</code></pre>\n\n<p>Note: better option to parse with JSON</p>\n"}], "owner": {"reputation": 1044, "user_id": 4929150, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/1f9a6a13c0a52d12b585ab8a36e68acb?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/4929150/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562584795, "creation_date": 1562573597, "last_edit_date": 1562573773, "question_id": 56930831, "link": "https://stackoverflow.com/questions/56930831/how-to-convert-the-given-string-to-array-in-rails", "title": "how to convert the given string to array in rails", "body": "<p>I have the following Strings. I want them to convert into Arrays like below in rails</p>\n\n<p><code>\"[\\\"Winter\\\", \\\"Summer\\\", \\\"Spring\\\"]\"</code> to <code>[\"Winter\", \"Summer\", \"Spring\"]</code></p>\n\n<p><code>\"[\\\"IELTS\\\", \\\"GRE\\\", \\\"PTE\\\", \\\"SAT\\\"]\"</code> to <code>[\"IELTS\", \"GRE\", \"PTE\", \"SAT\"]</code></p>\n\n<p>How can i convert these</p>\n"}, {"tags": ["ruby", "nmatrix"], "comments": [{"owner": {"reputation": 3623, "user_id": 170300, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/CwqxD.jpg?s=128&g=1", "display_name": "Juno Woods", "link": "https://stackoverflow.com/users/170300/juno-woods"}, "edited": false, "score": 1, "creation_date": 1562603386, "post_id": 56930105, "comment_id": 100418397, "body": "I&#39;d suggest opening an issue in the NMatrix tracker. <a href=\"http://github.com/sciruby/nmatrix/issues\" rel=\"nofollow noreferrer\">github.com/sciruby/nmatrix/issues</a>. Regardless of where you ask, please provide a minimum working example, as it&#39;s hard to debug this kind of thing without it."}], "owner": {"reputation": 161, "user_id": 7576758, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-985SkdQTZ7o/AAAAAAAAAAI/AAAAAAAACfQ/Byl2b0Cf0q0/photo.jpg?sz=128", "display_name": "Sydney Hauke", "link": "https://stackoverflow.com/users/7576758/sydney-hauke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562570577, "creation_date": 1562570577, "question_id": 56930105, "link": "https://stackoverflow.com/questions/56930105/horizontal-concatenation-of-nmatrix-matrices-is-incorrect-in-the-second-column", "title": "Horizontal concatenation of NMatrix matrices is incorrect in the second column", "body": "<p>I am generating an LDPC parity check matrix compliant with the CCSDS standard with the help of Ruby and the NMatrix module from SciRuby. Generating the matrix involves creating submatrices that you concatenate together to form the final parity check matrix. However the final result of the concatenation is incorrect.</p>\n\n<p>Here is what I do now for concatenation :</p>\n\n<pre><code>def pi_K(k, m)\n    mat = NMatrix.zeros(m, dtype: :int8, stype: :yale)\n\n    mat.each_with_indices { |elem, col, row|\n        if col == pi(k, row, m)\n            mat[col, row] = 1 \n        end\n    }\n\n    return mat\nend\n\ndef xor_mul(a, b)\n    return (a.dot(b)).map { |e| e % 2 }\nend\n\n# Some code not shown here\n\nm = $submatrix_m[code_rate][block_len]\n\nz_m = NMatrix.zeros(m, dtype: :int8, stype: :yale)\ni_m = NMatrix.eye(m, dtype: :int8, stype: :yale)\n\ni_m_pi_1   = xor_mul(i_m, pi_K(1, m))\npi_2_3_4   = xor_mul(xor_mul(pi_K(2, m), pi_K(3, m)), pi_K(4, m))\npi_5_6     = xor_mul(pi_K(5, m), pi_K(6, m))\npi_7_8     = xor_mul(pi_K(7, m), pi_K(8, m))\n\nh = z_m.hconcat(z_m, i_m, z_m, i_m_pi_1).vconcat( \\\n    i_m.hconcat(i_m, z_m, i_m, pi_2_3_4)).vconcat( \\\n    i_m.hconcat(pi_5_6, z_m, pi_7_8, i_m))\n\n# Save h matrix...\n</code></pre>\n\n<p>And here is what I get when I plot the final <em>h</em> matrix in Octave :</p>\n\n<p><img src=\"https://i.imgur.com/E4fXIQc.png\" alt=\"Matrix plot in Octave\"></p>\n\n<p>As you can see, the second block-column is empty but that is not expected. This block-column should have an identity submatrix and another submatrix <em>pi_5_6</em>.\nI feel there is something wrong during the concatenation of the submatrices, however I see nothing wrong.</p>\n"}, {"tags": ["ruby", "hyperstack"], "answers": [{"comments": [{"owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "edited": false, "score": 1, "creation_date": 1562781884, "post_id": 56955241, "comment_id": 100488776, "body": "This answers the real issue here, which is payload size.  For security you should use Policies to control all CRUD access to the models regardless of what page the models are used on.  If in the model&#39;s class description you have constants or other information that should not be viewed on the client, you can wrap it an <code>if RUBY_ENGINE != &#39;opal&#39;</code> conditional, and the compiler will remove the code."}, {"owner": {"reputation": 127, "user_id": 4438296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a0462f1ee59ed387dfcb8f0d9734f9d?s=128&d=identicon&r=PG", "display_name": "Michail", "link": "https://stackoverflow.com/users/4438296/michail"}, "edited": false, "score": 0, "creation_date": 1591862629, "post_id": 56955241, "comment_id": 110218125, "body": "This approach works very well and can minimize time and size of assets to be loaded (production and development -wise). To apply one must first disable autoloading for application code in hyperstck configuration."}], "tags": [], "owner": {"reputation": 101, "user_id": 11256360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a7ecf4e880a5fa5f709f4a3d733c5d?s=128&d=identicon&r=PG", "display_name": "adamcreekroad", "link": "https://stackoverflow.com/users/11256360/adamcreekroad"}, "is_accepted": true, "score": 2, "last_activity_date": 1562683774, "creation_date": 1562683774, "answer_id": 56955241, "question_id": 56929320, "link": "https://stackoverflow.com/questions/56929320/restrict-hyperstack-components-models-to-only-those-necessary-for-some-specific/56955241#56955241", "title": "Restrict Hyperstack components/models to only those necessary for some specific page to work?", "body": "<p>There is no nice automatic way of doing this, but it's not too much work to achieve this. You would have to create a shared JS file of anything that's used on every page (opal, hyperstack, react, etc), and then create a separate JS file for every Page/Single Page App.</p>\n\n<p><br></p>\n\n<p>Here's a very basic example:</p>\n\n<p>Application.js</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/assets/javascripts/application.rb\n\nrequire 'webpack/client_only'\nrequire 'components/shared'\n</code></pre>\n\n<p>Shared JS file</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/hyperstack/components/shared.rb\n\nrequire 'opal'\n\nrequire 'webpack/client_and_server'\nrequire 'hyperstack-config'\n\n# etc...\n</code></pre>\n\n<p>User Dashboard SPA:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/hyperstack/components/user_dashboard.rb\n\n# Require shared models\nrequire './models/user'\n\n# Require shared components\nrequire_tree './components/user_dashboard'\n</code></pre>\n\n<p>Todo List SPA:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/hyperstack/components/todo_list.rb\n\n# Require shared models\nrequire './models/todo'\nrequire './models/user'\n\n# Require shared components\nrequire_tree './components/todo_list'\n</code></pre>\n\n<p>User Dashboard HTML Layout</p>\n\n<pre><code># app/views/layouts/user_dashboard.html.erb\n\n&lt;%= javascript_include_tag('application.js') %&gt;\n&lt;%= javascript_include_tag('components/todo_list.js') %&gt;\n</code></pre>\n\n<p>Todo List HTML Layout</p>\n\n<pre><code># app/views/layouts/todo_list.html.erb\n\n&lt;%= javascript_include_tag('application.js') %&gt;\n&lt;%= javascript_include_tag('components/todo_list.js') %&gt;\n</code></pre>\n\n<p><br></p>\n\n<p>What I've also done to make it more dynamic is create a helper method in the controller to define the name of the separate JS file to use based on the controller. This also allows you to use only one layout file if desired:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/controllers/application_controller.rb\n\nclass ApplicationController\n  helper_method :spa_asset\n\n  def spa_asset\n    params[:controller]\n  end\nend\n</code></pre>\n\n<pre><code># app/views/layouts/application.html.erb\n\n&lt;%= javascript_include_tag('application.js') %&gt;\n&lt;%= javascript_include_tag(spa_asset) %&gt;\n</code></pre>\n\n<p>And then inheriting controller can redefine it if the file name doesn't match the controller name:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/controllers/foo_controller.rb\n\nclass FooController\n  def spa_asset\n    'todo_list'\n  end\nend\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 127, "user_id": 4438296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a0462f1ee59ed387dfcb8f0d9734f9d?s=128&d=identicon&r=PG", "display_name": "Michail", "link": "https://stackoverflow.com/users/4438296/michail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56955241, "answer_count": 1, "score": 1, "last_activity_date": 1562683774, "creation_date": 1562566830, "last_edit_date": 1562569312, "question_id": 56929320, "link": "https://stackoverflow.com/questions/56929320/restrict-hyperstack-components-models-to-only-those-necessary-for-some-specific", "title": "Restrict Hyperstack components/models to only those necessary for some specific page to work?", "body": "<p>When you access some page in Hyperstack, every model from app/hyperstack/models directory is included and sent to the browser. For the sake of security and performance, is it possible to load (automatically or by some directive) only the required code for the models and not that are used from the components?</p>\n\n<p>Maybe this can be done in a way similar that policies work for data? So I am asking if there is some kind of policy in Hyperstack that restricts the code that is sent to the browser?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "concurrency", "concurrent-ruby"], "comments": [{"owner": {"reputation": 7736, "user_id": 687142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VErBp.jpg?s=128&g=1", "display_name": "xlembouras", "link": "https://stackoverflow.com/users/687142/xlembouras"}, "edited": false, "score": 1, "creation_date": 1562565317, "post_id": 56929032, "comment_id": 100399108, "body": "TBH concurrency doesn&#39;t seem like the optimal approach here. There is a chance you &quot;just&quot; need to optimize your DB and code inside <code>api_get_rate</code>. Can you provide the code for <code>api_get_rate</code> ?"}, {"owner": {"reputation": 79, "user_id": 5075531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-qXRT2YFq1ko/AAAAAAAAAAI/AAAAAAAAAOE/XTEz9VNp6QM/photo.jpg?sz=128", "display_name": "windfallisland", "link": "https://stackoverflow.com/users/5075531/windfallisland"}, "reply_to_user": {"reputation": 7736, "user_id": 687142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VErBp.jpg?s=128&g=1", "display_name": "xlembouras", "link": "https://stackoverflow.com/users/687142/xlembouras"}, "edited": false, "score": 0, "creation_date": 1562602227, "post_id": 56929032, "comment_id": 100417848, "body": "@xlembouras The api_get_rate function makes a call that crawls the web for rate data - this crawl takes can take up to 15 seconds, sometimes more. It&#39;s not grabbing the rate data from the DB at the moment. Why do you say concurrency is not the optimal approach here? Do you have any other suggestions?"}, {"owner": {"reputation": 7736, "user_id": 687142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VErBp.jpg?s=128&g=1", "display_name": "xlembouras", "link": "https://stackoverflow.com/users/687142/xlembouras"}, "edited": false, "score": 2, "creation_date": 1562649143, "post_id": 56929032, "comment_id": 100430840, "body": "I agree with @fylooi &#39;s <a href=\"https://stackoverflow.com/a/56930633/687142\">answer</a> . You need a queueing system and/or some off-line operations."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 1, "creation_date": 1562649815, "post_id": 56929032, "comment_id": 100431025, "body": "What the comments are saying is correct. Rethink the problem. Controllers should never make long running api calls because they will hang your server&#39;s connections while waiting for data. Instead that work should be delegated to a worker, probably through ActiveJob. Recommend <a href=\"https://blog.codeship.com/how-to-use-rails-active-job/\" rel=\"nofollow noreferrer\">this</a> as a tutorial. Has a section titled &quot;Talking with external APIs&quot;."}, {"owner": {"reputation": 79, "user_id": 5075531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-qXRT2YFq1ko/AAAAAAAAAAI/AAAAAAAAAOE/XTEz9VNp6QM/photo.jpg?sz=128", "display_name": "windfallisland", "link": "https://stackoverflow.com/users/5075531/windfallisland"}, "reply_to_user": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1562777060, "post_id": 56929032, "comment_id": 100486656, "body": "@Glyoko I see, thanks for the suggestions! Definitely going to do some digging."}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 3, "creation_date": 1562578934, "post_id": 56930633, "comment_id": 100405079, "body": "You could also use ActionCable as an alternative to polling."}, {"owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1562655705, "post_id": 56930633, "comment_id": 100433273, "body": "@max Probably a bit overkill if this is the only part of the application which needs live async updates"}], "tags": [], "owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "is_accepted": true, "score": 3, "last_activity_date": 1562572776, "creation_date": 1562572776, "answer_id": 56930633, "question_id": 56929032, "link": "https://stackoverflow.com/questions/56929032/ruby-on-rails-best-way-to-asynchronously-make-long-api-calls-and-return-values/56930633#56930633", "title": "Ruby on Rails - Best way to asynchronously make long api calls and return values to js on the frontend?", "body": "<p>The conventional Rails approach to this kind of problem would be to implement the long running request as a background job using ActiveJob. </p>\n\n<p>Each rate request would trigger a separate job running in a worker process, and the job would update your job in DB (or Redis) upon completion. </p>\n\n<p>You'd then have another controller which your JS polls to check status / results of individual jobs. </p>\n"}, {"tags": [], "owner": {"reputation": 1919, "user_id": 384689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66498e80512ef50822cceb2a2f5cba3?s=128&d=identicon&r=PG", "display_name": "claasz", "link": "https://stackoverflow.com/users/384689/claasz"}, "is_accepted": false, "score": 1, "last_activity_date": 1562685241, "creation_date": 1562685241, "answer_id": 56955726, "question_id": 56929032, "link": "https://stackoverflow.com/questions/56929032/ruby-on-rails-best-way-to-asynchronously-make-long-api-calls-and-return-values/56955726#56955726", "title": "Ruby on Rails - Best way to asynchronously make long api calls and return values to js on the frontend?", "body": "<p>Unless you're a Rails expert, I would recommend against using concurrent-ruby gem together with Rails as it could make things quite complicated.</p>\n\n<p>One common approach is already provided by @fylooi - using ActiveJob to handle background jobs and a JavaScript poller to detect when it's finished. You would have to setup the ActiveJob backend, which is a little bit of work.</p>\n\n<p>Another solution would be to stay completely synchronous in Rails and do the parallelization in JavaScript instead. I.e., you would run multiple AJAX requests in parallel. (<a href=\"https://docs.pushtechnology.com/cloud/latest/manual/html/designguide/solution/support/connection_limitations.html\" rel=\"nofollow noreferrer\">Max 6</a>, but this might be enough for your case.)</p>\n"}], "owner": {"reputation": 79, "user_id": 5075531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-qXRT2YFq1ko/AAAAAAAAAAI/AAAAAAAAAOE/XTEz9VNp6QM/photo.jpg?sz=128", "display_name": "windfallisland", "link": "https://stackoverflow.com/users/5075531/windfallisland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 0, "accepted_answer_id": 56930633, "answer_count": 2, "score": 1, "last_activity_date": 1562685241, "creation_date": 1562564972, "last_edit_date": 1562602668, "question_id": 56929032, "link": "https://stackoverflow.com/questions/56929032/ruby-on-rails-best-way-to-asynchronously-make-long-api-calls-and-return-values", "title": "Ruby on Rails - Best way to asynchronously make long api calls and return values to js on the frontend?", "body": "<p>I am creating a search page that displays up to 9 rates. On the frontend, I am sending a request to my rails application that contains the necessary data to grab the 9 rates.  </p>\n\n<p>In one of my rails controllers, I crawl a webpage to get the rate. This can take anywhere between 2 and 15 seconds. </p>\n\n<p>I would like run all 9 requests in the background so I may process other requests that come in. For example, the user can make a search and suggested results will display. </p>\n\n<p>I am attempting to use the concurrent-ruby gem with Promises.\nThe cleaned_params variable is an array of data needed to make the request. There are up to 9 requests data. </p>\n\n<p>Here is what I have so far: </p>\n\n<pre><code> tasks = cleaned_params.map { |request_data| \n    Concurrent::Promises.future(request_data) { |request_data| api_get_rate(request_data) }\n  }\n\n  # My tasks could still be in the pending state, all_promises is a new promise that will be fulfilled once all fo the inner promises have been fulfilled\n  all_promises = Concurrent::Promises.zip(*tasks)\n\n# Use all_promises.value! to block - I don't want to render a response until we have the rates. \n  render json: {:success =&gt; true, :status =&gt; 200, :rates =&gt; all_promises.value! }\n</code></pre>\n\n<p>Right now I see that all requests to the api_get_rate are being started, but inside my <code>api_get_rate</code> function, I make a call to a method in another class, <code>BetterRateOverride.check_rate</code>. When I run this same code synchronously, I am successfully able to call the above method, but when I run it how I have it setup right now, my code just hangs once it gets to this call. Why is this happening?</p>\n\n<p>Is it not possible to call a method from another class while in a background thread? Do promises run in background threads? I read that Promises run in the ruby global thread pool. </p>\n\n<p>If this is not the best approach, can you steer me in the right direction?</p>\n\n<p>Thanks for any help.</p>\n\n<p>Edit: I think this may be the issue for my code deadlocking: \n<a href=\"https://github.com/rails/rails/issues/26847\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/issues/26847</a></p>\n"}, {"tags": ["ruby", "interpreter", "callstack"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 2, "creation_date": 1562556365, "post_id": 56927931, "comment_id": 100397327, "body": "For call stack during execution (the only place where &quot;call stack&quot; makes sense), possible duplicate at <a href=\"https://stackoverflow.com/questions/6322524/how-do-you-view-a-sample-of-the-call-stack-in-ruby\">How do you view a sample of the call stack in ruby?</a>. But your example sounds like you want an <i>execution profile</i>, in which case <a href=\"https://stackoverflow.com/questions/4092641/profiling-ruby-code\">Profiling Ruby Code</a> is relevant, and more details <a href=\"https://stackify.com/ruby-profiler-types-and-why-you-need-them/\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 95, "user_id": 10973211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de36ac107d545bb948526da4bba55e3c?s=128&d=identicon&r=PG&f=1", "display_name": "HJL", "link": "https://stackoverflow.com/users/10973211/hjl"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1562557407, "post_id": 56927931, "comment_id": 100397454, "body": "@Amadan Thank you for your comment and help. Both links will be helpful for my next step of research, so I&#39;m very happy to have them. However, both are dealing with the user-written ruby code, not the ruby interpreter itself. I&#39;m looking for the function call stack of the interpreter that gets executed. Thank you a bunch for your help tho!"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 2, "creation_date": 1562557686, "post_id": 56927931, "comment_id": 100397496, "body": "In that case, you will want to compile your own Ruby, unoptimised, with debugging symbols not stripped. Then you will get the same choice though: do you want a stack trace at a specific point in execution (use gdb and set a breakpoint), or do you want an execution profile (you&#39;ll also want <code>-pg</code> option while compiling, then use <code>gprof</code>)."}, {"owner": {"reputation": 95, "user_id": 10973211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de36ac107d545bb948526da4bba55e3c?s=128&d=identicon&r=PG&f=1", "display_name": "HJL", "link": "https://stackoverflow.com/users/10973211/hjl"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1562615418, "post_id": 56927931, "comment_id": 100423429, "body": "@Amadan I can definitely use gdb to set a breakpoint and trace from there. I did not aware of the <code>-pg</code> and <code>gprof</code> until now. Thank you for your help!"}], "owner": {"reputation": 95, "user_id": 10973211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de36ac107d545bb948526da4bba55e3c?s=128&d=identicon&r=PG&f=1", "display_name": "HJL", "link": "https://stackoverflow.com/users/10973211/hjl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562555145, "creation_date": 1562555145, "question_id": 56927931, "link": "https://stackoverflow.com/questions/56927931/how-to-get-ruby-interpreter-callstack", "title": "How to get Ruby interpreter callstack?", "body": "<p>I'm trying to get the call stacks of Ruby interpreter when it gets executed. For example, I have some ruby code in <code>foo.rb</code> and when I execute it with some options (if any to get the call stack) by <code>$ruby foo.rb</code>, then I would like to get which functions of interpreter get executed.</p>\n\n<p>I found this (<a href=\"https://programmer.help/blogs/ruby-2.x-source-code-learning-an-overview-of-interpreters.html\" rel=\"nofollow noreferrer\">https://programmer.help/blogs/ruby-2.x-source-code-learning-an-overview-of-interpreters.html</a>) nice article related to my questions and provides some idea of how I should approach, but I'm not quite sure how I should do it.</p>\n\n<p>Basically, the article is saying that \"Open OPT_CALL_THREADED_CODE switch in vm_opts.h header file when compiling Ruby\nruby_run_node call stack\" to get the call stack, but I don't really get what does it mean by \"Open OPT_CALL_THREADED_CODE\".</p>\n\n<p>I did look at the vm_opts.h, but it does not tell much.</p>\n\n<p>This issue is a very specific topic, but if anyone has any idea how I can get the call stack in anyways or with the method the article is suggesting, please please help me out here.</p>\n\n<p>Thank you for all your help!</p>\n"}, {"tags": ["ruby", "cocoapods", "xcode-project", "xcodeproj"], "owner": {"reputation": 1930, "user_id": 808174, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/I7X6I.jpg?s=128&g=1", "display_name": "Aatish Molasi", "link": "https://stackoverflow.com/users/808174/aatish-molasi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562555580, "creation_date": 1562555069, "last_edit_date": 1562555580, "question_id": 56927917, "link": "https://stackoverflow.com/questions/56927917/script-to-remove-file-from-a-single-target", "title": "Script to remove file from a single target", "body": "<p>We're building an app that has different versions for different countries.</p>\n\n<p>As part of a localisation effort I'm aiming to write a script that swaps certain asset files with another based on the language parameter. </p>\n\n<p>I've written a python script for <a href=\"https://github.com/kronenthaler/mod-pbxproj\" rel=\"nofollow noreferrer\">this</a> using a <a href=\"https://github.com/kronenthaler/mod-pbxproj\" rel=\"nofollow noreferrer\">python library</a>, but that has a bug where on editing the files xcode doesn't really recognise the structure anymore and we have to restart xcode.</p>\n\n<p>So the newer approach is to use <a href=\"https://github.com/CocoaPods/Xcodeproj\" rel=\"nofollow noreferrer\">this</a> ruby gem.</p>\n\n<p>I am fetching the project and I can access the files</p>\n\n<pre><code>project = Xcodeproj::Project.open(project_path)\ntarget = project.targets.first\nfiles = target.source_build_phase.files.to_a.map\n</code></pre>\n\n<p>But I can't find anything in the <a href=\"https://www.rubydoc.info/gems/xcodeproj/index\" rel=\"nofollow noreferrer\">documentation</a> where it would allow me to remove a file from just one target.</p>\n\n<p>I have thought about creating a new target and adding all the files except the one I want deleted.\nBut I think that seems overkill for the issue we're trying to solve.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails", "shoulda-matchers"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1562553602, "post_id": 56927732, "comment_id": 100396826, "body": "What&#39;s your shoulda-matchers gem version?"}, {"owner": {"reputation": 8447, "user_id": 7932059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aedf69bb41128a68d2a556a279c7698a?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen You", "link": "https://stackoverflow.com/users/7932059/nguyen-you"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1562553822, "post_id": 56927732, "comment_id": 100396854, "body": "@SebastianPalma shoulda-matchers (3.1.2)"}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 4, "last_activity_date": 1562555441, "creation_date": 1562555441, "answer_id": 56927971, "question_id": 56927732, "link": "https://stackoverflow.com/questions/56927732/shouldamatchersindependentdelegatemethodmatcher-undefined-method-allow-n/56927971#56927971", "title": "Shoulda::Matchers::Independent::DelegateMethodMatcher: undefined method `allow_nil&#39;", "body": "<p>You must upgrade your shoulda-matchers gem to the version 4.0.0.rc1 or greater.</p>\n\n<p>You can see the <code>allow_nil</code> method was introduced in <a href=\"https://github.com/thoughtbot/shoulda-matchers/commit/d49cfcae1b294e12a05e06a5612cb8ebb22a7df1\" rel=\"nofollow noreferrer\">this</a> commit, which belongs to the 4.0.0 release.</p>\n"}], "owner": {"reputation": 8447, "user_id": 7932059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aedf69bb41128a68d2a556a279c7698a?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen You", "link": "https://stackoverflow.com/users/7932059/nguyen-you"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 56927971, "answer_count": 1, "score": 2, "last_activity_date": 1562555441, "creation_date": 1562553120, "last_edit_date": 1562554018, "question_id": 56927732, "link": "https://stackoverflow.com/questions/56927732/shouldamatchersindependentdelegatemethodmatcher-undefined-method-allow-n", "title": "Shoulda::Matchers::Independent::DelegateMethodMatcher: undefined method `allow_nil&#39;", "body": "<p>I'm trying to test a delegate method of my <code>Comment</code> model using <em>shoulda-matchers (3.1.2)</em> &amp; <em>rspec-rails (3.7.2)</em> in my <em>rails (5.0.1)</em> application with <em>ruby 2.5.0-p0 (x86_64-linux)</em>\nand getting this error:</p>\n\n<pre><code>1) Comment delegation \n     Failure/Error: it { should delegate_method(:name).to(:user).allow_nil }\n\n     NoMethodError:\n       undefined method `allow_nil' for #&lt;Shoulda::Matchers::Independent::DelegateMethodMatcher:0x00005587de5bc488&gt;\n     # ./spec/models/comment_spec.rb:11:in `block (3 levels) in &lt;top (required)&gt;'\n\nFinished in 0.00225 seconds (files took 3.62 seconds to load)\n1 example, 1 failure\n</code></pre>\n\n<p>The code is quite clean and straightforward, I think there could be some errors with the library rather than my implementation code. Does anyone know what is going wrong here? Thanks!</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 2002, "user_id": 1896134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72817a5f0bd7c29704bbe5c04cd49532?s=128&d=identicon&r=PG", "display_name": "JayRizzo", "link": "https://stackoverflow.com/users/1896134/jayrizzo"}, "edited": false, "score": 0, "creation_date": 1562553029, "post_id": 56927705, "comment_id": 100396734, "body": "Because you are matching 0 or more of anything and replacing it with abc for the second line.  The first line looks to be replacing &#39;hel&#39; with abc and the &#39;lo&#39; with abc."}, {"owner": {"reputation": 2002, "user_id": 1896134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72817a5f0bd7c29704bbe5c04cd49532?s=128&d=identicon&r=PG", "display_name": "JayRizzo", "link": "https://stackoverflow.com/users/1896134/jayrizzo"}, "edited": false, "score": 0, "creation_date": 1562553118, "post_id": 56927705, "comment_id": 100396744, "body": "By adding the ^ you are signifying that you want to replace the entirety of the line to abc."}, {"owner": {"reputation": 401, "user_id": 7824640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ImUAfD7p5hw/AAAAAAAAAAI/AAAAAAAABNo/YB8fbLxMUhY/photo.jpg?sz=128", "display_name": "Hidehiro NAGAOKA", "link": "https://stackoverflow.com/users/7824640/hidehiro-nagaoka"}, "reply_to_user": {"reputation": 2002, "user_id": 1896134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72817a5f0bd7c29704bbe5c04cd49532?s=128&d=identicon&r=PG", "display_name": "JayRizzo", "link": "https://stackoverflow.com/users/1896134/jayrizzo"}, "edited": false, "score": 1, "creation_date": 1562554086, "post_id": 56927705, "comment_id": 100396895, "body": "Why does it split into &#39;hel&#39; and &#39;lo&#39;?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 2002, "user_id": 1896134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72817a5f0bd7c29704bbe5c04cd49532?s=128&d=identicon&r=PG", "display_name": "JayRizzo", "link": "https://stackoverflow.com/users/1896134/jayrizzo"}, "edited": false, "score": 3, "creation_date": 1562554820, "post_id": 56927705, "comment_id": 100396997, "body": "@JayRizzo <code>&quot;hello&quot;.gsub(&#47;.*&#47;) { puts $&amp;.inspect; &quot;abc&quot; }</code> says otherwise."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1562555177, "post_id": 56927705, "comment_id": 100397071, "body": "Interestingly enough, you only need to anchor it at the beginning to get it to make &quot;sense&quot;: <code>&quot;hello&quot;.gsub(&#47;^.*&#47;, &quot;abc&quot;)</code> or <code>&quot;hello&quot;.gsub(&#47;\\A.*&#47;, &quot;abc&quot;)</code>. Anchoring at the end with <code>$</code>, <code>\\z</code>, or <code>\\Z</code> does nothing. Using <code>gsub(&#47;.+&#47;)</code> produces the expected result of course. Presumably <code>.*</code> is matching the &quot;nothing&quot; at the end of the string since <code>*</code> means &quot;zero or more&quot;"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1562555495, "post_id": 56927705, "comment_id": 100397134, "body": "Not an answer, but here&#39;s some data. At rubular.com there is one match, the entire string. At regex101.com, with no options, there is one match. Adding the &quot;global&quot; <code>&#47;g</code> option (&quot;Don&#39;t return after first match&quot;) there are two matches, one an &quot;empty match&quot;. <code>&#47;g</code> is not support with Ruby, however."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 2002, "user_id": 1896134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72817a5f0bd7c29704bbe5c04cd49532?s=128&d=identicon&r=PG", "display_name": "JayRizzo", "link": "https://stackoverflow.com/users/1896134/jayrizzo"}, "edited": false, "score": 1, "creation_date": 1562555961, "post_id": 56927705, "comment_id": 100397257, "body": "@JayRizzo, let&#39;s have your reasoning for the second sentence of your first comment. Guesses and opinions are of no value."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1562557311, "post_id": 56927705, "comment_id": 100397440, "body": "Another data point: <code>&quot;hello&quot;.scan &#47;.*&#47; #=&gt; [&quot;hello&quot;, &quot;&quot;]</code>."}, {"owner": {"reputation": 401, "user_id": 7824640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ImUAfD7p5hw/AAAAAAAAAAI/AAAAAAAABNo/YB8fbLxMUhY/photo.jpg?sz=128", "display_name": "Hidehiro NAGAOKA", "link": "https://stackoverflow.com/users/7824640/hidehiro-nagaoka"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562557731, "post_id": 56927705, "comment_id": 100397502, "body": "@CarySwoveland thx! I got the same result on the same website. Does &#39;g&#39; in regex101 mean &#39;greedy&#39; of the regexp? Regexp is greedy by default, so it makes sense. But even it&#39;s greedy, does &#39;matching nothing after matching the whole string&#39; make sense?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1562558098, "post_id": 56927705, "comment_id": 100397557, "body": "Hidehiro, see @matiska&#39;s answer to <a href=\"https://stackoverflow.com/questions/12993629/what-is-the-meaning-of-the-g-flag-in-regular-expressions\">this SO quesion</a>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562558471, "post_id": 56927705, "comment_id": 100397615, "body": "@WiktorStribi\u017cew, please have a look at this."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1562559152, "post_id": 56927705, "comment_id": 100397709, "body": "@CarySwoveland: Rubular does show you the second match if you toggle &quot;Show invisibles&quot; checkmark. (It looks like a space, but it&#39;s not - use Inspect on it to see it&#39;s two different <code>&lt;span&gt;</code> elements, the second of which is empty.)"}, {"owner": {"reputation": 2002, "user_id": 1896134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72817a5f0bd7c29704bbe5c04cd49532?s=128&d=identicon&r=PG", "display_name": "JayRizzo", "link": "https://stackoverflow.com/users/1896134/jayrizzo"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1568181247, "post_id": 56927705, "comment_id": 102188481, "body": "@CarySwoveland you are correct, I misspoke and had a misunderstanding of it.  The reason for not duplicating is because of the overlap of the pattern, is my understanding.  Cheers!"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1562563238, "post_id": 56928312, "comment_id": 100398553, "body": "Great answer! I learned a lot."}, {"owner": {"reputation": 401, "user_id": 7824640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ImUAfD7p5hw/AAAAAAAAAAI/AAAAAAAABNo/YB8fbLxMUhY/photo.jpg?sz=128", "display_name": "Hidehiro NAGAOKA", "link": "https://stackoverflow.com/users/7824640/hidehiro-nagaoka"}, "edited": false, "score": 0, "creation_date": 1562823570, "post_id": 56928312, "comment_id": 100499825, "body": "Thank you so much!! Can I ask one question? Why doesn&#39;t first match contain position 5? In other words, why does the first match stop at postion 4?"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 4, "last_activity_date": 1562560244, "last_edit_date": 1562560244, "creation_date": 1562558884, "answer_id": 56928312, "question_id": 56927705, "link": "https://stackoverflow.com/questions/56927705/whats-the-second-match-after-the-whole-string-with/56928312#56928312", "title": "What&#39;s the second match after the whole string with /.*/?", "body": "<p>The important bit is that a regexp can never match twice at same position. The matches also cannot overlap. Furthermore, note that there are six possible positions involved in <code>\"hello\"</code>: one at the start of each character, and one at the very end (see <a href=\"https://stackoverflow.com/questions/3568222/array-slicing-in-ruby-explanation-for-illogical-behaviour-taken-from-rubykoans/3568281#3568281\">fenceposting</a>).</p>\n\n<p>When you start searching for <code>/.*/</code>, there's a match at position 0, and it takes up five characters. This disqualifies positions 0, 1, 2, 3 and 4 from further matches (as they are part of the first match).</p>\n\n<p>The second match starts matching at position 5, and finds a match for \"0 or more characters\" - namely, 0 characters. The position 5 is not contained in the first match, and so not disqualified by the \"no overlap\" rule.</p>\n\n<hr>\n\n<p>When you anchor the start with <code>/^.*/</code>, the position 5 becomes ineligible, as it is not the start.</p>\n\n<p>When you anchor the end with <code>/.*$/</code>, both position 0 and position 5 will detect that after their 5-character or 0-character match respectively they are at the end of the search string, and thus you still get both matches.</p>\n\n<p>When you change the regexp to \"1 or more characters\" with <code>/.+/</code>, then the position 5 is again ineligible because there is no more characters to match, but at least 1 is required.</p>\n\n<hr>\n\n<p>Note also that it is not just Ruby, the same behaviour is found in all the engines I tested. Python's <code>sub</code> is a bit inconsistent (possibly because of its adjacency condition? Not sure), but <code>findall</code> reports the same two matches:</p>\n\n<pre><code>re.findall('.*', 'hello') # =&gt; ['hello', '']\n</code></pre>\n\n<p>JavaScript works just like Ruby:</p>\n\n<pre><code>\"hello\".replace(/.*/g, \"abc\") // =&gt; \"abcabc\"\n</code></pre>\n\n<p>As does Java:</p>\n\n<pre><code>\"hello\".replaceAll(\".*\", \"abc\") // =&gt; \"abcabc\"\n</code></pre>\n\n<p>And even PHP (using PREG):</p>\n\n<pre><code>preg_replace('/.*/', 'abc', 'hello'); # =&gt; \"abcabc\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1562562247, "creation_date": 1562562247, "answer_id": 56928673, "question_id": 56927705, "link": "https://stackoverflow.com/questions/56927705/whats-the-second-match-after-the-whole-string-with/56928673#56928673", "title": "What&#39;s the second match after the whole string with /.*/?", "body": "<p>This is because regex engine does not go back, meaning when it matched some text, it will never go back inside matched text, i.e. matvhes won't overlap.</p>\n\n<p>You used <code>*</code> quantifier, meaning that it is greedy, so it will match as much as possible. If you'd use <code>*?</code>, then you'd get match at every position at a string, because <code>?</code> makes it non-greedy, so it will match at least as possible. While <code>*</code> means zero or more characters, you'd get 0-length matches.</p>\n"}], "owner": {"reputation": 401, "user_id": 7824640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ImUAfD7p5hw/AAAAAAAAAAI/AAAAAAAABNo/YB8fbLxMUhY/photo.jpg?sz=128", "display_name": "Hidehiro NAGAOKA", "link": "https://stackoverflow.com/users/7824640/hidehiro-nagaoka"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1562568619, "accepted_answer_id": 56928312, "answer_count": 2, "score": 2, "last_activity_date": 1562570922, "creation_date": 1562552786, "last_edit_date": 1562570922, "question_id": 56927705, "link": "https://stackoverflow.com/questions/56927705/whats-the-second-match-after-the-whole-string-with", "closed_reason": "Duplicate", "title": "What&#39;s the second match after the whole string with /.*/?", "body": "<p>I got this result the regexp in the <strong>Ruby</strong>.</p>\n\n<p>At first, a question itself is not the same.\nAnd this is not the same question because the answer is different.\nAnd also discussion in the comment makes the difference as well.</p>\n\n<p>In the first result, it looks <code>.*</code> matching <em>nothing</em> after matching whole <code>'hello'</code>.</p>\n\n<p>But why does it happen?</p>\n\n<pre><code>[53] pry(main)&gt; \"hello\".gsub(/.*/, \"abc\")\n=&gt; \"abcabc\"\n[54] pry(main)&gt; \"hello\".gsub(/^.*$/, \"abc\")\n=&gt; \"abc\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "bootstrap-4", "erb"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1562579089, "post_id": 56926775, "comment_id": 100405154, "body": "<code>b.object</code> should give you the current item in the iteration."}, {"owner": {"reputation": 81, "user_id": 8588771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d550969cf4321be9d958aff98b94e6f6?s=128&d=identicon&r=PG&f=1", "display_name": "user8588771", "link": "https://stackoverflow.com/users/8588771/user8588771"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1562622156, "post_id": 56926775, "comment_id": 100425804, "body": "Thanks. So it does return first_name in this instance. But I would like to be able to return multiple items (first_name, last_name, club, etc) then display them in a table that is searchable and filterable."}], "owner": {"reputation": 81, "user_id": 8588771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d550969cf4321be9d958aff98b94e6f6?s=128&d=identicon&r=PG&f=1", "display_name": "user8588771", "link": "https://stackoverflow.com/users/8588771/user8588771"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580810102, "creation_date": 1562540585, "last_edit_date": 1580810102, "question_id": 56926775, "link": "https://stackoverflow.com/questions/56926775/ruby-on-rails-form-with-collection-check-boxes-in-a-table-has-and-belongs-to-m", "title": "Ruby on Rails form with collection_check_boxes in a table - has_and_belongs_to_many association", "body": "<p>I have a has_and_belongs_to_many association between my Player and Registration models (registration is for an event). When a registration list is created, I show a list of all players and collection_check_boxes to select one or more players for that registration list. </p>\n\n<p>Ideally, I would like to show this list as a table. Fist column check box, second column Player.name, third column Player.club, etc. </p>\n\n<p>The problem is I can't find a way to access each attribute for Player within the each do look so that I can format the table. Instead, I can only generate one label.</p>\n\n<pre><code>&lt;%= f.collection_check_boxes :player_ids, @players, :id, :first_name do |b| %&gt;\n  &lt;%= b.check_box %&gt;\n  &lt;%= b.label %&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>I have tried creating a method within the Player model to show more attributes within the label but it's not ideal.</p>\n\n<h2>Model</h2>\n\n<pre><code>def player\n  \"#{first_name} #{last_name} #{club} ...\"\nend\n&lt;%= f.collection_check_boxes :player_ids, @players, :id, :player do |b| %&gt;\n</code></pre>\n\n<p>Here is my code:</p>\n\n<h2>Player Model</h2>\n\n<pre><code>class Player &lt; ApplicationRecord\n  has_and_belongs_to_many :registrations, dependent: :destroy\n\n  def player\n    \"#{first_name} #{last_name} #{club}\"\n  end\nend\n</code></pre>\n\n<h2>Registration Model</h2>\n\n<pre><code>class Registration &lt; ApplicationRecord\n  belongs_to :fixture\n  has_and_belongs_to_many :players\nend\n</code></pre>\n\n<h2>Form</h2>\n\n<pre><code>&lt;%= simple_form_for(@registration) do |f| %&gt;\n\n&lt;div class=\"form-inputs\"&gt;\n&lt;%= f.association :fixture %&gt;\n\n&lt;table class=\"table col-md-4\"&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;td&gt;\n        &lt;!-- check box --&gt;\n      &lt;/td&gt;\n      &lt;th&gt;\n        Name (Primary Venue)\n      &lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n  &lt;tbody&gt;\n   &lt;%= f.collection_check_boxes :player_ids, @players, :id, :player do |b| %&gt;\n     &lt;tr&gt;\n       &lt;td&gt;\n        &lt;div class=\"collection-check-box\"&gt;\n          &lt;%= b.check_box %&gt;\n        &lt;/div&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;div class=\"collection-check-box\"&gt;\n          &lt;%= b.label %&gt;\n        &lt;/div&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n   &lt;% end %&gt;\n  &lt;/tbody&gt;\n &lt;/table&gt;\n&lt;/div&gt;\n&lt;div class=\"form-actions\"&gt;\n  &lt;%= f.button :submit %&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My question is, how can I display this check_box collection list within a table with multiple columns referencing Player attributes?</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1562537234, "post_id": 56926444, "comment_id": 100394518, "body": "What&#39;s the code in your spec?"}, {"owner": {"reputation": 351, "user_id": 11196706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f06fbb48577defe7d7b222b6a05a98f?s=128&d=identicon&r=PG&f=1", "display_name": "juemura7", "link": "https://stackoverflow.com/users/11196706/juemura7"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1562537599, "post_id": 56926444, "comment_id": 100394574, "body": "@SebastianPalma I have updated to add in the spec :)"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1562537778, "post_id": 56926444, "comment_id": 100394605, "body": "In <code>pay</code>, the coin argument is an array of floats, a float does not implement the <code>[]</code> method, hence your error. Can you explain further what you&#39;re trying to do, in order to get a better understanding and a better answer?"}, {"owner": {"reputation": 351, "user_id": 11196706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f06fbb48577defe7d7b222b6a05a98f?s=128&d=identicon&r=PG&f=1", "display_name": "juemura7", "link": "https://stackoverflow.com/users/11196706/juemura7"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1562538030, "post_id": 56926444, "comment_id": 100394657, "body": "I see, but how come it works when I feature test this in my terminal, seems odd?   Sure - when a user pays with coins for an item (50p coin in this example, which is the 0.5), I want this to be added to the money already in the cash register (the first hash). Does that make sense?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1562542707, "post_id": 56926444, "comment_id": 100395277, "body": "Sorry, the last comment wasn&#39;t really the problem, I confused the error since the coin shadowing variable within each. Take a look at the answer provided."}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 3, "last_activity_date": 1562540809, "last_edit_date": 1562540809, "creation_date": 1562540009, "answer_id": 56926721, "question_id": 56926444, "link": "https://stackoverflow.com/questions/56926444/nomethoderror-when-trying-to-access-ruby-hash-yet-works-in-irb/56926721#56926721", "title": "NoMethodError when trying to access Ruby hash, yet works in irb", "body": "<p>The error comes when invoking [] in a <code>nil</code> object.</p>\n\n<p>When you pass a denomination that's not in your <code>@change</code> instance variable, the result of <code>@change.find { ... }</code> will be <code>nil</code>, and invoking <code>[]</code> in a <code>nil</code> object will raise a NoMethodError.</p>\n\n<p>That's a case you haven't covered, and that might be solved by using <code>next</code> within the <code>each</code> enumerator:</p>\n\n<pre><code>coins.each do |coin|\n  current_denomination = @change.find { |x| x[:denomination] == coin }\n  next unless current_denomination\n\n  current_denomination[:amount] += 1\nend\n\np pay([0.05, 0.05, 2.0, 100])\n</code></pre>\n\n<p>In case there's no change with the same coin and denomination, you just \"jump\" to the next element within coins.</p>\n\n<p>Notice the current implementation of <code>@change</code> allows you to repeat the hashes within the array, which can lead to errors if a denomination differs with its initial value of amount. You can just use a Hash to store both, denomination and amount as key-value:</p>\n\n<pre><code>p [0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1.0, 2.0].to_h { |a| [a, 5] }\n# {0.01=&gt;5, 0.02=&gt;5, 0.05=&gt;5, 0.1=&gt;5, 0.2=&gt;5, 0.5=&gt;5, 1.0=&gt;5, 2.0=&gt;5}\n</code></pre>\n\n<p>That's Ruby 2.6+.</p>\n\n<hr>\n\n<p>As a minor tweak to your implementation, you can move <code>@change</code> to a separate method, which you can call and use then by invoking <code>tap</code> on it:</p>\n\n<pre><code>DENOMINATIONS = [0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1.0, 2.0].freeze\nHASH_KEYS = %i[denomination amount].freeze\n\ndef initial_coins\n  DENOMINATIONS.zip(Array.new(8, 5)).map { |coin| HASH_KEYS.zip(coin).to_h }\nend\n\ndef pay(coins = [])\n  initial_coins.tap do |this|\n    coins.each do |coin|\n      current_denomination = this.find { |initial_coin| initial_coin[:denomination] == coin }\n      next unless current_denomination\n\n      current_denomination[:amount] += 1\n    end\n  end\nend\n\npp pay([0.05, 0.05, 2.0, 100])\n# [{:denomination=&gt;0.01, :amount=&gt;5},\n#  {:denomination=&gt;0.02, :amount=&gt;5},\n#  {:denomination=&gt;0.05, :amount=&gt;7},\n#  {:denomination=&gt;0.1, :amount=&gt;5},\n#  {:denomination=&gt;0.2, :amount=&gt;5},\n#  {:denomination=&gt;0.5, :amount=&gt;5},\n#  {:denomination=&gt;1.0, :amount=&gt;5},\n#  {:denomination=&gt;2.0, :amount=&gt;6}]\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 11196706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f06fbb48577defe7d7b222b6a05a98f?s=128&d=identicon&r=PG&f=1", "display_name": "juemura7", "link": "https://stackoverflow.com/users/11196706/juemura7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56926721, "answer_count": 1, "score": 1, "last_activity_date": 1562540809, "creation_date": 1562537078, "last_edit_date": 1562537587, "question_id": 56926444, "link": "https://stackoverflow.com/questions/56926444/nomethoderror-when-trying-to-access-ruby-hash-yet-works-in-irb", "title": "NoMethodError when trying to access Ruby hash, yet works in irb", "body": "<p>I am building a cash register in Ruby that has the following hash: </p>\n\n<pre><code>\n\n    @change = [\n                  { :denomination =&gt; 0.01, :amount =&gt; 5 },\n                  { :denomination =&gt; 0.02, :amount =&gt; 5 },\n                  { :denomination =&gt; 0.05, :amount =&gt; 5 },\n                  { :denomination =&gt; 0.10, :amount =&gt; 5 },\n                  { :denomination =&gt; 0.20, :amount =&gt; 5 },\n                  { :denomination =&gt; 0.50, :amount =&gt; 5 },\n                  { :denomination =&gt; 1.00, :amount =&gt; 5 },\n                  { :denomination =&gt; 2.00, :amount =&gt; 5 }\n        ]\n\n</code></pre>\n\n<p>When a user makes a purchase, the coins they use are passed in as an argument in the form of an array. </p>\n\n<pre><code>\n    def pay(coins = [])\n        coins.each do |coin|\n          coin = @change.find { |x| x[:denomination] == coin }\n          coin[:amount] += 1\n        end\n     end\n\n</code></pre>\n\n<p>This works fine when I manually test in irb from my terminal. However, when I try to run <code>rspec</code>, it fails with a NoMethodError:</p>\n\n<pre><code> Failure/Error: coin[:amount] += 1\n\n     NoMethodError:\n       undefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>I really cannot see why this is failing with a NoMethodError, especially as it runs fine in the terminal. Can anyone please help? </p>\n\n<p>Thanks :) </p>\n\n<p>UPDATE: </p>\n\n<p>Spec for this:</p>\n\n<pre><code>describe '#pay' do\n    it 'updates the change' do\n      till.pay([0.5])\n      expect(till.change).to include(:denomination=&gt;0.5, :amount=&gt;6)\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 3, "creation_date": 1562528579, "post_id": 56925482, "comment_id": 100392823, "body": "Just do <code>m1.product(m2)</code>."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562536519, "post_id": 56925482, "comment_id": 100394404, "body": "For what it&#39;s worth, what you tried could be written <code>m1.flat_map{ |letter| m2.map{ |bool| [letter, bool] } }</code> or <code>m1.map { |i| m2.map {|e| array1 &lt;&lt; i; array2 &lt;&lt; e }}</code>. Using <code>product</code> is indeed a better solution but now you know how your code could be fixed."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562529235, "post_id": 56925602, "comment_id": 100392965, "body": "Perhaps preface with, &quot;As @lurker suggests,&quot;."}, {"owner": {"reputation": 36, "user_id": 3245101, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001412901920/picture?type=large", "display_name": "Evandro Fruhauf", "link": "https://stackoverflow.com/users/3245101/evandro-fruhauf"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1562529858, "post_id": 56925602, "comment_id": 100393127, "body": "@CarySwoveland It does, I didn&#39;t notice his answer, sorry. Anyway, this question comes from a Telegram group, I had reply there before, then I just come to put here."}], "tags": [], "owner": {"reputation": 36, "user_id": 3245101, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001412901920/picture?type=large", "display_name": "Evandro Fruhauf", "link": "https://stackoverflow.com/users/3245101/evandro-fruhauf"}, "is_accepted": true, "score": 2, "last_activity_date": 1562529030, "creation_date": 1562529030, "answer_id": 56925602, "question_id": 56925482, "link": "https://stackoverflow.com/questions/56925482/how-can-i-change-the-output-order-of-a-multi-dimensional-array-in-ruby/56925602#56925602", "title": "How can i change the output order of a multi-dimensional array in Ruby?", "body": "<p>for this you must use the Product function available on Ruby.</p>\n\n<p><a href=\"https://apidock.com/ruby/Array/product\" rel=\"nofollow noreferrer\">https://apidock.com/ruby/Array/product</a></p>\n\n<pre><code>&gt; m1 = [\"a\", \"b\", \"c\"]\n=&gt; [\"a\", \"b\", \"c\"]\n&gt; m2 = [\"yes\", \"no\"]\n=&gt; [\"yes\", \"no\"]\n&gt; m1.product(m2)\n=&gt; [[\"a\", \"yes\"], [\"a\", \"no\"], [\"b\", \"yes\"], [\"b\", \"no\"], [\"c\", \"yes\"], [\"c\", \"no\"]]\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 11380912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c9qq5.jpg?s=128&g=1", "display_name": "Jonathan Cardoso", "link": "https://stackoverflow.com/users/11380912/jonathan-cardoso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 1, "closed_date": 1562529337, "accepted_answer_id": 56925602, "answer_count": 1, "score": 2, "last_activity_date": 1562529030, "creation_date": 1562528023, "question_id": 56925482, "link": "https://stackoverflow.com/questions/56925482/how-can-i-change-the-output-order-of-a-multi-dimensional-array-in-ruby", "closed_reason": "Duplicate", "title": "How can i change the output order of a multi-dimensional array in Ruby?", "body": "<p>I have these two arrays:</p>\n\n<pre><code>m1 = [\"a\", \"b\", \"c\"]\nm2 = [\"yes\", \"no\"]\n</code></pre>\n\n<p>and I expect the following result:</p>\n\n<pre><code>expected-output = [[\"a\", \"yes\"], [\"a\", \"no\"],\n                   [\"b\", \"yes\"], [\"b\", \"no\"],\n                   [\"c\", \"yes\"], [\"c\", \"no\"]]\n</code></pre>\n\n<p>This is the code that I tried: </p>\n\n<pre><code>array1 = []\narray2 = []\nm2.map { |e| m1.map {|i| array1 &lt;&lt; i and array2 &lt;&lt; e }}\nnewArray = array1.zip(array2)\nprint newArray\n</code></pre>\n\n<p>but my outcome is not in the right order:</p>\n\n<pre><code>[[\"a\", \"yes\"], [\"b\", \"yes\"], \n [\"c\", \"yes\"], [\"a\", \"no\"], \n [\"b\", \"no\"], [\"c\", \"no\"]]\n</code></pre>\n\n<p>PS: I already used the sort method and it didn't work.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1562569191, "post_id": 56925303, "comment_id": 100400474, "body": "There is no array in your example."}], "answers": [{"comments": [{"owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "edited": false, "score": 0, "creation_date": 1562530982, "post_id": 56925395, "comment_id": 100393381, "body": "thank you. However, I needed to add <code>to_unsafe_h</code>, because the code was throwing error <code>rails undefined method </code>any?&#39; for #&lt;ActionController::Parameters:<code>. -&gt; </code>data[&#39;car_documents_attributes&#39;].to_unsafe_h.any? {...`"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "edited": false, "score": 0, "creation_date": 1562532162, "post_id": 56925395, "comment_id": 100393577, "body": "Yes, <code>ActionController::Parameters</code> is a different implementation which needs to be converted to an &quot;unsafe&quot; hash in order to invoke some methods. See the edit."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1562532779, "last_edit_date": 1562532779, "creation_date": 1562527336, "answer_id": 56925395, "question_id": 56925303, "link": "https://stackoverflow.com/questions/56925303/how-to-check-if-an-array-contains-a-certain-value/56925395#56925395", "title": "How to check if an array contains a certain value?", "body": "<p>That's a hash containing more hashes. What you can do is to access to <code>car_documents_attributes</code>, iterate over those hash values and check if any <code>document_type</code> is \"contract\": </p>\n\n<pre><code>data = {\n  \"car_documents_attributes\" =&gt; {\n    \"1562523330183\" =&gt; { \"id\" =&gt; \"\", \"filename\" =&gt; \"tyYYqHeqSFOnqLHEz5lO_rc_tispor12756_6wldwu.pdf\", \"document_type\" =&gt; \"contract\"},\n    \"1562523353208\" =&gt; { \"id\" =&gt; \"\", \"filename\" =&gt; \"a9P8TyECRiKbI2YdRVZy_rc_tispor12756_bbtzdz.pdf\", \"document_type\" =&gt; \"request\" },\n    \"1562523353496\" =&gt; { \"id\" =&gt; \"\", \"filename\" =&gt; \"WCM5FHOfSw6yNSUrfPPm_rc_tispor12756_dqu9r2.pdf\", \"document_type\" =&gt; \"notes\" }\n  }\n}\np data['car_documents_attributes'].any? { |_, doc| doc['document_type'] == 'contract' }\n# true\n</code></pre>\n\n<hr>\n\n<p>Didn't know it was data coming from the params. If so, you do need to permit what's being received or convert the params to an unsafe hash.</p>\n\n<p>Also, you can try using <code>fetch</code> instead <code>[]</code> when trying to get <code>car_documents_attributes</code>, because if that key isn't in <code>data</code>, it'll throw <code>nil</code>, which would throw a NoMethodError:</p>\n\n<pre><code>data.fetch('car_documents_attributes', []).any? { |_, doc| doc['document_type'] == 'contract' }\n</code></pre>\n"}], "owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 56925395, "answer_count": 1, "score": 0, "last_activity_date": 1562533082, "creation_date": 1562526665, "last_edit_date": 1562533082, "question_id": 56925303, "link": "https://stackoverflow.com/questions/56925303/how-to-check-if-an-array-contains-a-certain-value", "title": "How to check if an array contains a certain value?", "body": "<p>I am working with an array in this form:</p>\n\n<pre><code>\"car_documents_attributes\"=&gt;{\n    \"1562523330183\"=&gt;{\n        \"id\"=&gt;\"\", \"filename\"=&gt;\"tyYYqHeqSFOnqLHEz5lO_rc_tispor12756_6wldwu.pdf\", \"document_type\"=&gt;\"contract\"\n    }, \n    \"1562523353208\"=&gt;{\n        \"id\"=&gt;\"\", \"filename\"=&gt;\"a9P8TyECRiKbI2YdRVZy_rc_tispor12756_bbtzdz.pdf\", \"document_type\"=&gt;\"request\"\n    },\n     \"1562523353496\"=&gt;{\n        \"id\"=&gt;\"\", \"filename\"=&gt;\"WCM5FHOfSw6yNSUrfPPm_rc_tispor12756_dqu9r2.pdf\", \"document_type\"=&gt;\"notes\"\n    },\n    ...\n}\n</code></pre>\n\n<p>I need to find out if in this array is an item where <code>document_type</code>=<code>contract</code> (there can be none, one or multiple ones).</p>\n\n<p>The way I do it is looping through the array item by item, which can be slow if there are tens of items.</p>\n\n<p>Is there a better and faster way to simply check if in the array is an item with <code>document_type</code> = <code>contract</code>?</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "edited": false, "score": 0, "creation_date": 1562513163, "post_id": 56923474, "comment_id": 100389148, "body": "<code>[^upon]</code> will match all characters other that <code>u</code> or <code>p</code> or <code>o</code> or <code>n</code>... will <code>string.split.reject { |s| s == &quot;upon&quot; }.join(&quot; &quot;)</code> solve your issue?"}, {"owner": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "edited": false, "score": 0, "creation_date": 1562513209, "post_id": 56923474, "comment_id": 100389163, "body": "you can also use <code>sub</code> method to search and replace a string"}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 1, "creation_date": 1562514534, "post_id": 56923474, "comment_id": 100389472, "body": "Welcome to SO. Please take the time to read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. It will help you craft solid questions that will hopefully get useful answers.  What exactly is your question?  Is it &quot;what do brackets do in regex?&quot;  And---one step further--&quot;what does the <code>^</code> char do within brackets in regex?&quot;"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1562519029, "post_id": 56923474, "comment_id": 100390555, "body": "No, it is not clearer. What do you mean by &quot;match everything except...&quot;? You are given a string of characters, not a sentence. If a string may contain substrings (sequences of characters) that you wish to extract you must identify the characteristics of the substrings of interest.  Suppose, in your example, the string were &quot;Once upon a qupon&quot;. What is the array of strings you wish to extract? To be an effective programmer you need to be precise in your language as well as in your code.  Lastly, when you edit a question to clarify, just rewrite it; don&#39;t make it a narrative."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1562570432, "post_id": 56923474, "comment_id": 100401011, "body": "It is NOT possible to match a sequence of chars that is not equal to some sequence of patterns. You may only match some text that is not equal to a/some single char(s). That&#39;s why you cannot use <code>scan</code> here. Use either <code>gsub</code> or <code>split</code> with your pattern. If you do not need a whole word match use <code>s.split(&#39;upon&#39;).map(&amp;:strip).join(&#39; &#39;)</code>, see <a href=\"https://ideone.com/97y4NT\" rel=\"nofollow noreferrer\">demo</a>."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1562520459, "post_id": 56923543, "comment_id": 100390898, "body": "What if the string ends <code>&quot; upon&quot;</code>? <code>&#47;\\bupon ?\\b&#47;</code> would match &quot;upone&quot;, so that&#39;s no good. Nor would <code>&#47;\\bupon(?= |\\z)</code> work, as you want to match a following space, if there is one. Perhaps <code>&#47;\\bupon \\b|\\bupon\\z&#47;</code>."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 1, "last_activity_date": 1562514468, "last_edit_date": 1562514468, "creation_date": 1562513262, "answer_id": 56923543, "question_id": 56923474, "link": "https://stackoverflow.com/questions/56923474/inverted-regex-dilemma/56923543#56923543", "title": "Inverted Regex Dilemma", "body": "<p>Wrap the word within boundaries to form the \"upon\" word (plus a whitespace):</p>\n\n<pre><code>\"once upon a time long ago\".gsub(/\\bupon \\b/, '')\n# \"once a time long ago\"\n</code></pre>\n\n<p>Using <code>sub</code> or <code>gsub</code>, depending on the number of occurrences you can find in your string.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": false, "score": 0, "last_activity_date": 1562513952, "creation_date": 1562513952, "answer_id": 56923627, "question_id": 56923474, "link": "https://stackoverflow.com/questions/56923474/inverted-regex-dilemma/56923627#56923627", "title": "Inverted Regex Dilemma", "body": "<p>I'm guessing that this expression might also work:</p>\n\n<pre><code>(?:\\bupon\\b\\s+)|(.*?)\n</code></pre>\n\n<h3>Test</h3>\n\n<pre><code>re = /(?:\\bupon\\b\\s+)|(.*?)/m\nstr = 'once upon a time long ago once upon a time long ago once upon a time long ago '\nsubst = '$1'\n\nresult = str.gsub(re, subst)\n\nputs result\n</code></pre>\n\n<p>The expression is explained on the top right panel of <a href=\"https://regex101.com/r/MRk1by/1/\" rel=\"nofollow noreferrer\">this demo</a>, if you wish to explore further or modify it, and in <a href=\"https://regex101.com/r/MRk1by/1/debugger\" rel=\"nofollow noreferrer\">this link</a>, you can watch how it would match against some sample inputs step by step, if you like.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562519706, "post_id": 56923794, "comment_id": 100390701, "body": "Consider defining of a <i>character class</i> before giving your examples."}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562521029, "post_id": 56923794, "comment_id": 100391038, "body": "Fair enough.  Tried to keep the answer as &quot;simple&quot; as possible because the OP seems confused.  Not really sure what he is trying to solve and didn&#39;t want to devolve into a full regex tutorial (which the OP should really start with)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562522364, "post_id": 56923794, "comment_id": 100391387, "body": "I just meant something like, <code>&quot;[upon]&quot;</code> is a <i>character class</i>, meaning that any one of the characters between the braces must be matched. By making the first character a circumflex/caret (<code>&#39;^&#39;</code>) none of the remaining characters can be matched.&quot;. Just a suggestion..."}], "tags": [], "owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "is_accepted": false, "score": 0, "last_activity_date": 1562515739, "last_edit_date": 1562515739, "creation_date": 1562515036, "answer_id": 56923794, "question_id": 56923474, "link": "https://stackoverflow.com/questions/56923474/inverted-regex-dilemma/56923794#56923794", "title": "Inverted Regex Dilemma", "body": "<p>Unescaped brackets are intended to match characters.  For example, any of the following regex's would match on the string 'upon':</p>\n\n<pre><code>/[upon]/\n/[upoXn]/\n/[nopu]/\n#==&gt; upon\n#==&gt; upon\n#==&gt; upon\n</code></pre>\n\n<p>However, <code>^</code> has special meaning within brackets: it is a negation operator. </p>\n\n<p>So, <code>/[^upon]/</code> is specifically not matching on any characters contained in the string 'upon'.  </p>\n\n<p>This is demonstrated in your example:</p>\n\n<pre><code>string.scan(/[^upon]/).join\n#=&gt; \"ce a time lg ag\"\n</code></pre>\n\n<p>If you are just looking to replace the string 'upon', then <code>String::gsub</code> (as @Sebastian Palma suggests) should do the trick.  YMMV.</p>\n"}], "owner": {"reputation": 11, "user_id": 9905636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db33921cfd751b8f0a8f78bd5c98249f?s=128&d=identicon&r=PG&f=1", "display_name": "Dave L", "link": "https://stackoverflow.com/users/9905636/dave-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1562516992, "creation_date": 1562512828, "last_edit_date": 1562516992, "question_id": 56923474, "link": "https://stackoverflow.com/questions/56923474/inverted-regex-dilemma", "title": "Inverted Regex Dilemma", "body": "<p>I've searched the forum but can't find an answer.</p>\n\n<p>I'm using ruby v1.9.3 and need to invert a regex match.\nfor example:</p>\n\n<pre><code> string = \"once upon a time long ago\"\n    string.scan(/upon/).join\n</code></pre>\n\n<p>but:</p>\n\n<pre><code>    string.scan(/[^upon]/).join\n\n==&gt; \"ce a time lg ag\"\n</code></pre>\n\n<p>the individual letters of \"upon\" are being matched too, seemingly caused by the brackets.</p>\n\n<p>Edit:\nThanks for t he quick replies all.\nSorry I dont Think I explained myself very well\nwhat I want to do is match everything except \"upon\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/GhYN8.png\" rel=\"nofollow noreferrer\">Rubular example</a></p>\n\n<p>I hope this is clearer now</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "arabic"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1562516289, "post_id": 56923363, "comment_id": 100389889, "body": "Take a peek at <a href=\"https://stackoverflow.com/questions/11664403/does-ruby-provide-a-way-to-do-file-read-with-specified-encoding\" title=\"does ruby provide a way to do file read with specified encoding\">stackoverflow.com/questions/11664403/&hellip;</a>.  You might need to specify encoding when reading the string."}, {"owner": {"reputation": 61, "user_id": 9489957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMfyE.jpg?s=128&g=1", "display_name": "ramzieus", "link": "https://stackoverflow.com/users/9489957/ramzieus"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1562537205, "post_id": 56923363, "comment_id": 100394512, "body": "it&#39;s open uri not a file, and it&#39;s encoding is utf-8"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1562541968, "post_id": 56923363, "comment_id": 100395183, "body": "Include the <b>exact</b> code necessary to reproduce the issue."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1562652328, "post_id": 56923363, "comment_id": 100431758, "body": "And the <b>exact</b> error message please"}, {"owner": {"reputation": 61, "user_id": 9489957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMfyE.jpg?s=128&g=1", "display_name": "ramzieus", "link": "https://stackoverflow.com/users/9489957/ramzieus"}, "edited": false, "score": 0, "creation_date": 1562745209, "post_id": 56923363, "comment_id": 100468832, "body": "the code is included"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 9489957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMfyE.jpg?s=128&g=1", "display_name": "ramzieus", "link": "https://stackoverflow.com/users/9489957/ramzieus"}, "is_accepted": true, "score": 0, "last_activity_date": 1562745305, "creation_date": 1562745305, "answer_id": 56965929, "question_id": 56923363, "link": "https://stackoverflow.com/questions/56923363/parsing-json-on-ruby-arabic-unicode/56965929#56965929", "title": "Parsing json on ruby, arabic unicode", "body": "<p>I get the solution by remove the <a href=\"https://en.wikipedia.org/wiki/Byte_order_mark\" rel=\"nofollow noreferrer\">BOM</a></p>\n\n<pre><code>JSON.parse(open('https://www.example.com/wp-json/wp/v2/posts').read.gsub!(\"\\xEF\\xBB\\xBF\".force_encoding(\"UTF-8\"), '')\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 9489957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMfyE.jpg?s=128&g=1", "display_name": "ramzieus", "link": "https://stackoverflow.com/users/9489957/ramzieus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 56965929, "answer_count": 1, "score": 0, "last_activity_date": 1562745305, "creation_date": 1562512082, "last_edit_date": 1562599959, "question_id": 56923363, "link": "https://stackoverflow.com/questions/56923363/parsing-json-on-ruby-arabic-unicode", "title": "Parsing json on ruby, arabic unicode", "body": "<p>I get json parse error on ruby code the article is on arabic because of : </p>\n\n<pre><code>JSON.parse(open('https://www.examlpe.com/wp-json/wp/v2/posts').read)\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code>&lt;p dir=\\\"rtl\\\"&gt;\\u0623\\u0639\\u0644\\u0646\\u062a \\u0627\\u0644\\u0634\\u0631\\u0643\\u0629 \\u0627\\u0644\\u0648\\u0637\\u0646\\u064a\\u0629 \\u0644\\u0644\\u0646\\u0642\\u0644 \\u0628\\u0627\\u0644\\u0633\\u0643\\u0643 .&lt;\\/p&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562600167, "post_id": 56922596, "comment_id": 100416841, "body": "This seems like it might be an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem/66378#66378\">XY problem</a>. For what purpose are you generating a secure token?"}, {"owner": {"reputation": 14111, "user_id": 5783745, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Z5VSF.jpg?s=128&g=1", "display_name": "stevec", "link": "https://stackoverflow.com/users/5783745/stevec"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562600243, "post_id": 56922596, "comment_id": 100416889, "body": "@JordanRunning I am using it to control use of an API. The API doesn&#39;t contain anything sensitive, but (thinking ahead) I want to be able to prevent abuse or ban badly behaved users. So I will have the token in the API urls"}], "answers": [{"tags": [], "owner": {"reputation": 12415, "user_id": 1881769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d6e5b6160c64e3a7b7ee8df9b019f05?s=128&d=identicon&r=PG", "display_name": "tessi", "link": "https://stackoverflow.com/users/1881769/tessi"}, "is_accepted": true, "score": 1, "last_activity_date": 1562831827, "last_edit_date": 1562831827, "creation_date": 1562508407, "answer_id": 56922858, "question_id": 56922596, "link": "https://stackoverflow.com/questions/56922596/what-is-the-recommended-number-for-generating-secure-tokens-in-rails-with-secure/56922858#56922858", "title": "What is the recommended number for generating secure tokens in rails with SecureRandom.base64?", "body": "<p>Your answer is to be found in the <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/securerandom/rdoc/Random/Formatter.html#method-i-base64\" rel=\"nofollow noreferrer\">ruby docs</a>. Let me cite:</p>\n\n<blockquote>\n  <p><code>SecureRandom.base64</code> generates a random base64 string.</p>\n  \n  <p>The argument n specifies the length, in bytes, of the random number to\n  be generated. The length of the result string is about 4/3 of n.</p>\n  \n  <p>If n is not specified or is nil, 16 is assumed. It may be larger in\n  the future.</p>\n  \n  <p>The result may contain A-Z, a-z, 0-9, \u201c+\u201d, \u201c/\u201d and \u201c=\u201d.</p>\n\n<pre><code>require 'securerandom'\n\nSecureRandom.base64 #=&gt; \"/2BuBuLf3+WfSKyQbRcc/A==\"\nSecureRandom.base64 #=&gt; \"6BbW0pxO0YENxn38HMUbcQ==\"\n</code></pre>\n  \n  <p>If a secure random number generator is not available,\n  NotImplementedError is raised.</p>\n  \n  <p>See RFC 3548 for the definition of base64.</p>\n</blockquote>\n\n<p>So you see that the <code>n</code> is the number of bytes your random number will have. The different length in the output string comes from converting that number into base64. The base64 encoding needs more bytes than an integer to store the same information.</p>\n\n<p>If <code>n=16</code> is enough, depends on your specific use case. You may want to research how likely it is to produce a collision (two random number generations producing the same output) and how likely that results in a risk of your application.</p>\n"}], "owner": {"reputation": 14111, "user_id": 5783745, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Z5VSF.jpg?s=128&g=1", "display_name": "stevec", "link": "https://stackoverflow.com/users/5783745/stevec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 56922858, "answer_count": 1, "score": -2, "last_activity_date": 1562831827, "creation_date": 1562506216, "question_id": 56922596, "link": "https://stackoverflow.com/questions/56922596/what-is-the-recommended-number-for-generating-secure-tokens-in-rails-with-secure", "title": "What is the recommended number for generating secure tokens in rails with SecureRandom.base64?", "body": "<p>I am using <code>SecureRandom.base64(16)</code>, but I'm not exactly sure if that's enough. I am also unsure what exactly the <code>16</code> means. I would have made a sensible guess that it's the number of random characters generated, but some tests disprove that. </p>\n\n<p>E.g.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>SecureRandom.base64(16)\n=&gt; \"Hqncn1pVVHzoBJkFNpat4g==\" # 22 characters, plus 2 equals signs at the end\n\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 2673, "user_id": 4172728, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FQpL7.jpg?s=128&g=1", "display_name": "Gokul", "link": "https://stackoverflow.com/users/4172728/gokul"}, "is_accepted": true, "score": 3, "last_activity_date": 1562509843, "creation_date": 1562509843, "answer_id": 56923038, "question_id": 56922549, "link": "https://stackoverflow.com/questions/56922549/order-precedence-of-rails-validation-checks/56923038#56923038", "title": "Order/precedence of rails validation checks", "body": "<p>Rails will run all validations in the order specified even if any validation gets failed. Probably you need to validate datetime only if the values are present.</p>\n\n<p>You can do this in two ways,</p>\n\n<ol>\n<li><p>Check for the presence of the value before validating,</p>\n\n<pre><code>validates_datetime :start_time, if: -&gt; { start_time.present? }\nvalidates_datetime :end_time, if: -&gt; { end_time.present? }\n</code></pre></li>\n<li><p>Allows a nil or empty string value to be valid,</p>\n\n<pre><code>validates_datetime :start_time, allow_blank: true\nvalidates_datetime :end_time, allow_blank: true\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "edited": false, "score": 0, "creation_date": 1562588349, "post_id": 56924982, "comment_id": 100409802, "body": "Thank you for your help. As I understand it Rails processes every single validation check in the model, regardless of whether any one of them fails. It seems bit counterintuitive to me but I&#39;m sure there&#39;s a good reason. What was confusing me is that if the first validation check, checking whether the field values were present, passes (which it shouldn&#39;t do - because they aren&#39;t), surely? But now I understand that Rails just continues regardless and processes all other checks, even though the first presence check failed. Hence why other errors were appearing from other functions, confusingly."}], "tags": [], "owner": {"reputation": 771, "user_id": 1051942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f703f37922352d71c44d34fb8425951?s=128&d=identicon&r=PG", "display_name": "Kuo Jimmy", "link": "https://stackoverflow.com/users/1051942/kuo-jimmy"}, "is_accepted": false, "score": 1, "last_activity_date": 1562524265, "creation_date": 1562524265, "answer_id": 56924982, "question_id": 56922549, "link": "https://stackoverflow.com/questions/56922549/order-precedence-of-rails-validation-checks/56924982#56924982", "title": "Order/precedence of rails validation checks", "body": "<p>Simplest way, add this line right after <code>def duration_restrictions</code></p>\n\n<pre><code>return if ([ start_time, end_time ].find(&amp;:blank?))\n</code></pre>\n\n<p>Rails always validate custom method first.</p>\n"}], "owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 56923038, "answer_count": 2, "score": 1, "last_activity_date": 1562597369, "creation_date": 1562505846, "last_edit_date": 1562597369, "question_id": 56922549, "link": "https://stackoverflow.com/questions/56922549/order-precedence-of-rails-validation-checks", "title": "Order/precedence of rails validation checks", "body": "<p>I'm trying to get my head around the order/precedence with which Rails processes validation checks. Let me give an example.</p>\n\n<p>In my model class I have these validation checks and custom validation methods:</p>\n\n<pre><code>class SupportSession &lt; ApplicationRecord\n\n  # Check both dates are actually provided when user submits a form\n  validates :start_time, presence: true\n  validates :end_time, presence: true\n\n  # Check datetime format with validates_timeliness gem: https://github.com/adzap/validates_timeliness\n  validates_datetime :start_time\n  validates_datetime :end_time\n\n  # Custom method to ensure duration is within limits\n  def duration_restrictions\n\n    # Next line returns nil if uncommented so clearly no start and end dates data which should have been picked up by the first validation checks\n    # raise duration_mins.inspect # Returns nil\n\n    # Use same gem as above to calculate duration of a SupportSession\n    duration_mins = TimeDifference.between(start_time, end_time).in_minutes\n\n    if duration_mins == 0\n      errors[:base] &lt;&lt; 'A session must last longer than 1 minute'\n    end\n\n    if duration_mins &gt; 180\n      errors[:base] &lt;&lt; 'A session must be shorter than 180 minutes (3 hours)'\n    end\n  end\n</code></pre>\n\n<p>The problem is that Rails doesn't seem to be processing the 'validates presence' or 'validates_datetime' checks first to make sure that the data is there in the first place for me to work with. I just get this error on the line where I calculate duration_mins (because there is no start_time and end_time provided:</p>\n\n<pre><code>undefined method `to_time' for nil:NilClass\n</code></pre>\n\n<p>Is there a reason for this or have I just run into a bug? Surely the validation checks should make sure that values for start_time and end_time are present, or do I have to manually check the values in all of my custom methods? That's not very DRY.</p>\n\n<p>Thanks for taking a look.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1562533729, "post_id": 56922575, "comment_id": 100393862, "body": "I don&#39;t think he wants a string."}, {"owner": {"reputation": 69, "user_id": 3189109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASu4.png?s=128&g=1", "display_name": "theendcomplete", "link": "https://stackoverflow.com/users/3189109/theendcomplete"}, "reply_to_user": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1562584266, "post_id": 56922575, "comment_id": 100407783, "body": "@pascalbetz <code>adjustment = +10</code> in question for sure is a string"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1562608255, "post_id": 56922575, "comment_id": 100420487, "body": "I don&#39;t think so. I think it was added for clarity (though it might confuse programmers :-))"}], "tags": [], "owner": {"reputation": 69, "user_id": 3189109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASu4.png?s=128&g=1", "display_name": "theendcomplete", "link": "https://stackoverflow.com/users/3189109/theendcomplete"}, "is_accepted": false, "score": -1, "last_activity_date": 1562583981, "last_edit_date": 1562583981, "creation_date": 1562506080, "answer_id": 56922575, "question_id": 56922508, "link": "https://stackoverflow.com/questions/56922508/dynamically-adjusting-number-in-ruby/56922575#56922575", "title": "Dynamically adjusting number in Ruby", "body": "<p>not sure if I clearly understand the question but have you tried something like the example below?</p>\n\n<pre><code>my_available = -10\nsupplier_available = 0\na = supplier_available - my_available\nadjustment = if a&gt;0\n               a = '+'+a\n             else\n               a\n              end\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 1, "last_activity_date": 1562533618, "creation_date": 1562533618, "answer_id": 56926119, "question_id": 56922508, "link": "https://stackoverflow.com/questions/56922508/dynamically-adjusting-number-in-ruby/56926119#56926119", "title": "Dynamically adjusting number in Ruby", "body": "<p>try: <code>adjustment = supplier_available - my_available</code></p>\n\n<p>This will yield the correct result for the samples you gave:</p>\n\n<pre><code>my_available = 10\nsupplier_available = 0\nadjustment = -10 # =&gt; 0 - 10\n\nmy_available = 0\nsupplier_available = 10\nadjustment = +10 # =&gt; 10 - 0\n\nmy_available = -10\nsupplier_available = 0\nadjustment = +10 # =&gt; 0 - -10\n</code></pre>\n\n<p>Note that <code>+10</code> and <code>10</code> is the same (<code>+10 == 10 =&gt; true</code>) so you can drop the sign for positive numbers. </p>\n"}], "owner": {"reputation": 47, "user_id": 11736353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2addd684a803ad395bc651a0fdc38b27?s=128&d=identicon&r=PG&f=1", "display_name": "user11736353", "link": "https://stackoverflow.com/users/11736353/user11736353"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1562583981, "creation_date": 1562505516, "question_id": 56922508, "link": "https://stackoverflow.com/questions/56922508/dynamically-adjusting-number-in-ruby", "title": "Dynamically adjusting number in Ruby", "body": "<p>I maintain an in stock count in our application but each day I want to overwrite that number with the in stock count on the stock list that comes from our supplier.</p>\n\n<p>The problem that I have is that the application that I use requires an adjustment rather than just setting what the new in stock count should be.</p>\n\n<pre><code>my_available = 10\nsupplier_available = 0\nadjustment = -10\n\nmy_available = 0\nsupplier_available = 10\nadjustment = +10\n\nmy_available = -10\nsupplier_available = 0\nadjustment = +10\n</code></pre>\n\n<p>How can I calculate the <code>adjustment</code> in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 69, "user_id": 3189109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASu4.png?s=128&g=1", "display_name": "theendcomplete", "link": "https://stackoverflow.com/users/3189109/theendcomplete"}, "edited": false, "score": 0, "creation_date": 1562502849, "post_id": 56922076, "comment_id": 100387045, "body": "Is <code>params[:id]</code> variable allowed to be passed in the controller? Don&#39;t you have any security methods for passing only required params from the internet?"}, {"owner": {"reputation": 641, "user_id": 11750453, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ukwo8wIwYxA/AAAAAAAAAAI/AAAAAAAAAIs/JAHcH6TWHBw/photo.jpg?sz=128", "display_name": "Trisma", "link": "https://stackoverflow.com/users/11750453/trisma"}, "edited": false, "score": 0, "creation_date": 1562503027, "post_id": 56922076, "comment_id": 100387046, "body": "Yes it is since when I output params[:id] it shows me the data I passed (explained in question above. I have <code>params.permit(:thread_owner, :title)</code> to limit what is passed but this don&#39;t affect an id passed into the request. I even tried to add <code>:id</code> but it don&#39;t change anything."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1562503345, "post_id": 56922076, "comment_id": 100386821, "body": "In the case of the app context, not console, how are you determining that <code>threads</code> is empty?"}, {"owner": {"reputation": 641, "user_id": 11750453, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ukwo8wIwYxA/AAAAAAAAAAI/AAAAAAAAAIs/JAHcH6TWHBw/photo.jpg?sz=128", "display_name": "Trisma", "link": "https://stackoverflow.com/users/11750453/trisma"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1562503584, "post_id": 56922076, "comment_id": 100386868, "body": "It returns nothing, I tried something like <code>puts &quot;Threads are : + threads&quot;</code> and it don&#39;t print anything. When it returns to my front end I have Array(0)"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1562503732, "post_id": 56922076, "comment_id": 100386903, "body": "Yep, you did say already it returns nothing. Where did you put the <code>puts</code>? And was that exactly the <code>puts</code> you used? That one won&#39;t print <code>threads</code>. You&#39;d need something like, <code>puts &quot;Threads are : #{threads.inspect}&quot;</code>. Did you try the <code>puts</code> right after the <code>threads = ...</code> assignment in your <code>show</code> method? And can you show the front-end code that is handling the json?"}, {"owner": {"reputation": 641, "user_id": 11750453, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ukwo8wIwYxA/AAAAAAAAAAI/AAAAAAAAAIs/JAHcH6TWHBw/photo.jpg?sz=128", "display_name": "Trisma", "link": "https://stackoverflow.com/users/11750453/trisma"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1562503965, "post_id": 56922076, "comment_id": 100386959, "body": "I added this directly after <code>threads = MessageThread.where(thread_owner: &quot;testmail@ki.com&quot;)</code> I tried <code>threads.inspect</code> and that returns <code>#&lt;ActiveRecord::Relation []&gt;</code> Added front end to the queston"}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1562503973, "post_id": 56922076, "comment_id": 100386960, "body": "Debugging with a real debugger is much more efficient than endless <code>puts</code> statements <a href=\"https://guides.rubyonrails.org/debugging_rails_applications.html#debugging-with-the-byebug-gem\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1562504231, "post_id": 56922076, "comment_id": 100387033, "body": "You could also try inspecting <code>params[:id]</code> to make sure it&#39;s what you expect."}, {"owner": {"reputation": 641, "user_id": 11750453, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ukwo8wIwYxA/AAAAAAAAAAI/AAAAAAAAAIs/JAHcH6TWHBw/photo.jpg?sz=128", "display_name": "Trisma", "link": "https://stackoverflow.com/users/11750453/trisma"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1562504394, "post_id": 56922076, "comment_id": 100387073, "body": "@lurker I tried outputting that and it gives me what I want. I tried the same value in rails console and it shows me all the <code>MessageThread</code> I need"}, {"owner": {"reputation": 641, "user_id": 11750453, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ukwo8wIwYxA/AAAAAAAAAAI/AAAAAAAAAIs/JAHcH6TWHBw/photo.jpg?sz=128", "display_name": "Trisma", "link": "https://stackoverflow.com/users/11750453/trisma"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1562505085, "post_id": 56922076, "comment_id": 100387252, "body": "@lurker Added EDIT 2"}], "answers": [{"tags": [], "owner": {"reputation": 641, "user_id": 11750453, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ukwo8wIwYxA/AAAAAAAAAAI/AAAAAAAAAIs/JAHcH6TWHBw/photo.jpg?sz=128", "display_name": "Trisma", "link": "https://stackoverflow.com/users/11750453/trisma"}, "is_accepted": true, "score": 1, "last_activity_date": 1562506239, "creation_date": 1562506239, "answer_id": 56922602, "question_id": 56922076, "link": "https://stackoverflow.com/questions/56922076/parameter-part-after-is-missing-com/56922602#56922602", "title": "Parameter part after . is missing (.com)", "body": "<p>I found how to fix this here : <a href=\"https://stackoverflow.com/questions/2952235/rails-params-with-dot-e-g-google-com\">Rails \u2014 Params with &quot;dot&quot; (e.g. /google.com)</a></p>\n\n<p>What happens is that rails don't get the .com extension of my email, results in an empty array.\nThis is my route for the <code>MessageThread</code> class :</p>\n\n<p><code>resources :message_threads, constraints: { id: /[0-z\\.]+/ }</code></p>\n"}], "owner": {"reputation": 641, "user_id": 11750453, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ukwo8wIwYxA/AAAAAAAAAAI/AAAAAAAAAIs/JAHcH6TWHBw/photo.jpg?sz=128", "display_name": "Trisma", "link": "https://stackoverflow.com/users/11750453/trisma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56922602, "answer_count": 1, "score": -1, "last_activity_date": 1562583725, "creation_date": 1562501714, "last_edit_date": 1562583725, "question_id": 56922076, "link": "https://stackoverflow.com/questions/56922076/parameter-part-after-is-missing-com", "title": "Parameter part after . is missing (.com)", "body": "<p>So I'm trying to create a chat system here.\nI created a MessageThread Class that extends from <code>ApplicationRecord</code>.\nI want to fetch all the threads that are linked to a specific email, and return them in a json format, this is how I did it : </p>\n\n<pre><code>def show\n    threads = MessageThread.where(thread_owner: params[:id])\n     render json: {\n        status: 'SUCCESS',\n        message: 'Thread list fetched',\n        data: threads,\n     }, status: :ok\nend\n</code></pre>\n\n<p>I logged the <code>params[:id]</code> and that correspond to what I've sent in my React front-end.</p>\n\n<p>The problem here is that <code>threads</code> returns an empty array (I can translate this to there is no thread associated with that email).</p>\n\n<p>Now the tricky part is that if I execute this in rails console : </p>\n\n<p><code>threads = MessageThread.where(thread_owner: \"testmail@ki.com\")</code></p>\n\n<p>It will return an array with 3 threads in it (all linked to that mail).</p>\n\n<p>So why does this work in rails console but not in my rails controller?</p>\n\n<p>EDIT : \nHere is my front-end that handles the request : </p>\n\n<pre><code>async requestThread(data) {\n        await fetch(`http://localhost:3000//message_threads/${data}`, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        })\n            .then(response =&gt; response.json())\n            .then(data =&gt; {\n                console.log(data)\n            })\n            .catch(e =&gt; {\n                console.log(e)\n            })\n    }\n\n    generateJsonData = () =&gt; {\n        this.requestThread(localStorage.getItem('email'))\n    }\n</code></pre>\n\n<p>EDIT 2:\nI just figured out that my mail extension is going away when coming in in rails.\nIt comes in like <code>mail@gmail</code> and not <code>mail@gmail.com</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1562502423, "post_id": 56921894, "comment_id": 100386625, "body": "An <code>if</code> <code>else</code> statement is much more readable than some cryptic one-liner IMO"}], "answers": [{"tags": [], "owner": {"reputation": 771, "user_id": 1051942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f703f37922352d71c44d34fb8425951?s=128&d=identicon&r=PG", "display_name": "Kuo Jimmy", "link": "https://stackoverflow.com/users/1051942/kuo-jimmy"}, "is_accepted": false, "score": 0, "last_activity_date": 1562524536, "creation_date": 1562524536, "answer_id": 56925022, "question_id": 56921894, "link": "https://stackoverflow.com/questions/56921894/how-to-have-blank-value-in-options-for-select-if-no-recorded-value-show-chosen/56925022#56925022", "title": "how to have blank value in options_for_select if no recorded value, show chosen value if record exists?", "body": "<p><code>include_blank: @image_files.empty? ? 'Choose None' : nil</code></p>\n\n<p>In fact it's also <code>if</code> <code>else</code></p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1562524536, "creation_date": 1562500107, "question_id": 56921894, "link": "https://stackoverflow.com/questions/56921894/how-to-have-blank-value-in-options-for-select-if-no-recorded-value-show-chosen", "title": "how to have blank value in options_for_select if no recorded value, show chosen value if record exists?", "body": "<p>This is sort of a silly questions since I do have a way of solving this but I am wondering ig there is a better way to doing this.  I notice rails has many magical ways to doing thangs that \"just worked\"..... So I wonder if there is a better, rails way, to do thiss</p>\n\n<p>In an <code>options_for_select</code> form helper, I would like to have a value chosen if there is a value already exists in the database, else, blank.</p>\n\n<p>The following has a blank value no matter if something exists or not:</p>\n\n<pre><code>&lt;%= ff.select :image_file_id, options_for_select(@image_files.map { |image| [image.id, {'data-img-src'=&gt;image.image_file_url(:thumb)}]}), {:include_blank =&gt; 'Choose None'}, class: \"image-picker\" %&gt;\n</code></pre>\n\n<p>This has a default value of whats exists in the database, but if nothing exists in the database, it shows the first value in the databases:</p>\n\n<pre><code>&lt;%= ff.select :image_file_id, options_for_select(@image_files.map { |image| [image.id, {'data-img-src'=&gt;image.image_file_url(:thumb)}]}, ff.object.image_file_id), {:include_blank =&gt; 'Choose None'}, class: \"image-picker\" %&gt;\n</code></pre>\n\n<p>I read prompt would do what I want, showing blank if record not exists, shows value if value exists, but if didn't seem to work any way I tried.</p>\n\n<p>Aside from doing and <code>if</code> <code>else</code> statement, if there a way to do this in one rails magic line?</p>\n"}, {"tags": ["ruby-on-rails", "regex", "ruby"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1562496921, "post_id": 56921431, "comment_id": 100385387, "body": "There could be many edge cases in a SQL where clause which your sample string may not make obvious.  Are you sure that this example covers all edge cases?"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1562499989, "post_id": 56921431, "comment_id": 100386050, "body": "Looks like you are looking to create a regex, but do not know where to get started. Please check <a href=\"https://stackoverflow.com/questions/22937618\">Reference - What does this regex mean</a> resource, it has plenty of hints. Once you get some expression ready and still have issues with the solution, please edit the question with the latest details and we&#39;ll be glad to help you fix the problem."}, {"owner": {"reputation": 605, "user_id": 1398515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e66c923725405358c56acb9ab4f93a2?s=128&d=identicon&r=PG", "display_name": "Datt", "link": "https://stackoverflow.com/users/1398515/datt"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1562500306, "post_id": 56921431, "comment_id": 100386117, "body": "@WiktorStribi\u017cew Can you please check the question properly? This isn&#39;t duplicate and I know basics of regex, it contains <code>AND</code> and I can&#39;t split using &#39;AND&#39; because, for some AND cases, I don&#39;t have to split."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1562500342, "post_id": 56921431, "comment_id": 100386125, "body": "So, where is the regex you need help with?"}, {"owner": {"reputation": 605, "user_id": 1398515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e66c923725405358c56acb9ab4f93a2?s=128&d=identicon&r=PG", "display_name": "Datt", "link": "https://stackoverflow.com/users/1398515/datt"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1562500517, "post_id": 56921431, "comment_id": 100386166, "body": "@TimBiegeleisen I know this doesn&#39;t cover all the cases but I have covered a sample edge case where for some &#39;AND&#39; conditions I can&#39;t split a string."}, {"owner": {"reputation": 605, "user_id": 1398515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e66c923725405358c56acb9ab4f93a2?s=128&d=identicon&r=PG", "display_name": "Datt", "link": "https://stackoverflow.com/users/1398515/datt"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1562500579, "post_id": 56921431, "comment_id": 100386179, "body": "@WiktorStribi\u017cew Could you read problem statement properly? updated_at BETWEEN &#39;2018-05-01T00:00:00+05:30&#39; AND &#39;2019-05-01T00:00:00+05:30&#39; AND user_id = 5, here I want to split with <code>AND</code> but not <code>AND</code> where <code>BETWEEN..AND</code> comes. For such cases, we can do it using regex in <code>Ruby</code>"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1562501208, "post_id": 56921431, "comment_id": 100386331, "body": "You may need to write a rudimentary parser to do what you want."}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1562511549, "last_edit_date": 1562511549, "creation_date": 1562508943, "answer_id": 56922926, "question_id": 56921431, "link": "https://stackoverflow.com/questions/56921431/split-a-database-query-string-using-regex-in-ruby/56922926#56922926", "title": "Split a database query string using regex in ruby", "body": "<p>You might be able to do this with regex but here's a parser that may work for your use case.  It can surely be improved but it should work.</p>\n\n<pre><code>require 'time'\n\ndef parse(sql)\n  arr = []\n  split = sql.split(' ')\n  date_counter = 0\n  split.each_with_index do |s, i|\n    date_counter = 2 if s == 'BETWEEN'\n    time = Time.parse(s.strip) rescue nil\n    date_counter -= 1 if time\n    arr &lt;&lt; i+1 if date_counter == 1\n  end\n  arr.select(&amp;:even?).each do |index|\n    split.insert(index + 2, 'SPLIT_ME')\n  end\n  split = split.join(' ').split('SPLIT_ME').map{|l| l.strip.gsub(/(AND)$/, '')}\n  split.map do |line|\n    line[/^AND/] ? line.split('AND') : line\n  end.flatten.select{|l| !l.empty?}.map(&amp;:strip)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1562517686, "post_id": 56924022, "comment_id": 100390238, "body": "Also note that this solution mutates the string. If you don&#39;t want this make sure to <code>#dup</code> it beforehand."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1562615053, "last_edit_date": 1562615053, "creation_date": 1562516736, "answer_id": 56924022, "question_id": 56921431, "link": "https://stackoverflow.com/questions/56921431/split-a-database-query-string-using-regex-in-ruby/56924022#56924022", "title": "Split a database query string using regex in ruby", "body": "<p>This is not really a regex, but more a simple parser.</p>\n\n<ol>\n<li>This works by matching a regex from the start of the string until it encounters a whitespace followed by either <code>and</code> or <code>between</code> followed by a whitespace character. The result is removed from the <code>where_cause</code> and saved in <code>statement</code>.</li>\n<li>If the start of the string now starts with a whitespace followed by <code>between</code> followed by a whitespace. It is added to <code>statement</code> and removed from <code>where_cause</code> with anything after that, allowing 1 <code>and</code>. Matching stops if the end of the string is reached or another <code>and</code> is encountered.</li>\n<li>If point 2 didn't match check if the string starts with a whitespace followed by <code>and</code> followed by a whitespace. If this is the case remove this from <code>where_cause</code>.</li>\n<li>Finally add <code>statement</code> to the <code>statements</code> array if it isn't an empty string.</li>\n</ol>\n\n<p>All matching is done case insensitive.</p>\n\n<pre><code>where_cause = \"created_at BETWEEN '2018-01-01T00:00:00+05:30' AND '2019-01-01T00:00:00+05:30' AND updated_at BETWEEN '2018-05-01T00:00:00+05:30' AND '2019-05-01T00:00:00+05:30' AND user_id = 5 AND status = 'closed'\"\n\nstatements = []\nuntil where_cause.empty?\n  statement = where_cause.slice!(/\\A.*?(?=[\\s](and|between)[\\s]|\\z)/mi)\n\n  if where_cause.match? /\\A[\\s]between[\\s]/i\n    between = /\\A[\\s]between[\\s].*?[\\s]and[\\s].*?(?=[\\s]and[\\s]|\\z)/mi\n    statement &lt;&lt; where_cause.slice!(between)\n  elsif where_cause.match? /\\A[\\s]and[\\s]/i\n    where_cause.slice!(/\\A[\\s]and[\\s]/i)\n  end\n\n  statements &lt;&lt; statement unless statement.empty?\nend\n\npp statements\n# [\"created_at BETWEEN '2018-01-01T00:00:00+05:30' AND '2019-01-01T00:00:00+05:30'\",\n#  \"updated_at BETWEEN '2018-05-01T00:00:00+05:30' AND '2019-05-01T00:00:00+05:30'\",\n#  \"user_id = 5\",\n#  \"status = 'closed'\"]\n</code></pre>\n\n<p><strong>Note:</strong> Ruby uses <code>\\A</code> to match the start of the string and <code>\\z</code> to match the end of a string instead of the usual <code>^</code> and <code>$</code>, which match the beginning and ending of a line respectively. See the <a href=\"http://ruby-doc.org/core-2.6.3/doc/regexp_rdoc.html#label-Anchors\" rel=\"nofollow noreferrer\">regexp anchor documentation</a>.</p>\n\n<p>You can replace every <code>[\\s]</code> with <code>\\s</code> if you like. I've added them in to make the regex more readable.</p>\n\n<p><strong>Keep in mind that this solution isn't perfect, but might give you an idea how to solve the issue. The reason I say this is because it doesn't account for the words <code>and</code>/<code>between</code> in column name or string context.</strong></p>\n\n<p>The following where cause:</p>\n\n<pre><code>where_cause = \"name = 'Tarzan AND Jane'\"\n</code></pre>\n\n<p>Will output:</p>\n\n<pre><code>#=&gt; [\"name = 'Tarzan\", \"Jane'\"]\n</code></pre>\n\n<p><strong>This solution also assumes correctly structured SQL queries. The following queries don't result in what you might think:</strong></p>\n\n<pre><code>where_cause = \"created_at = BETWEEN AND\"\n# TypeError: no implicit conversion of nil into String\n# ^ does match /\\A[\\s]between[\\s]/i, but not the #slice! argument \nwhere_cause = \"id = BETWEEN 1 AND 2 BETWEEN 1 AND 3\"\n#=&gt; [\"id = BETWEEN 1 AND 2 BETWEEN 1\", \"3\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571626808, "post_id": 58479247, "comment_id": 103290680, "body": "Datt, I&#39;d be interested in knowing if this is what you wanted."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1571626747, "creation_date": 1571626747, "answer_id": 58479247, "question_id": 56921431, "link": "https://stackoverflow.com/questions/56921431/split-a-database-query-string-using-regex-in-ruby/58479247#58479247", "title": "Split a database query string using regex in ruby", "body": "<p>I'm not certain if I understand the question, particularly in view of the previous answers, but if you simply wish to extract the indicated substrings from your string, and all column names begin with lowercase letters, you could write the following (where <code>str</code> holds the string given in the question):</p>\n\n<pre><code>str.split(/ +AND +(?=[a-z])/)\n  #=&gt; [\"created_at BETWEEN '2018-01-01T00:00:00+05:30' AND '2019-01-01T00:00:00+05:30'\",\n  #    \"updated_at BETWEEN '2018-05-01T00:00:00+05:30' AND '2019-05-01T00:00:00+05:30'\",\n  #    \"user_id = 5\",\n  #    \"status = 'closed'\"]\n</code></pre>\n\n<p>The regular expression reads, \"match one or more spaces, followed by <code>'AND'</code>, followed by one or more spaces, followed by a positive lookahead that contains a lowercase letter\". Being in a positive lookahead, the lowercase letter is not part of the match that is returned. </p>\n"}], "owner": {"reputation": 605, "user_id": 1398515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e66c923725405358c56acb9ab4f93a2?s=128&d=identicon&r=PG", "display_name": "Datt", "link": "https://stackoverflow.com/users/1398515/datt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1571626747, "creation_date": 1562496135, "question_id": 56921431, "link": "https://stackoverflow.com/questions/56921431/split-a-database-query-string-using-regex-in-ruby", "title": "Split a database query string using regex in ruby", "body": "<p>I have a query string which I want to separate out</p>\n\n<pre><code>created_at BETWEEN '2018-01-01T00:00:00+05:30' AND '2019-01-01T00:00:00+05:30' AND updated_at BETWEEN '2018-05-01T00:00:00+05:30' AND '2019-05-01T00:00:00+05:30' AND user_id = 5 AND status = 'closed'\n\n</code></pre>\n\n<p>Like this</p>\n\n<pre><code>created_at BETWEEN '2018-01-01T00:00:00+05:30' AND '2019-01-01T00:00:00+05:30'\n\nupdated_at BETWEEN '2018-05-01T00:00:00+05:30' AND '2019-05-01T00:00:00+05:30'\n\nuser_id = 5\n\nstatus = 'closed'\n</code></pre>\n\n<p>This is just an example string, I want to separate the query string dynamically. I know can't just split with <code>AND</code> because of the pattern like <code>BETWEEN .. AND</code></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1562491767, "post_id": 56920598, "comment_id": 100384295, "body": "Can you please post some example input and the expected output?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1562492046, "post_id": 56920598, "comment_id": 100384373, "body": "Note: <code>digit-1.times do</code> does not do what you think it does."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1562493178, "post_id": 56920598, "comment_id": 100384627, "body": "Also <code>n.divmod(1)</code> does NOT return number&#39;s digits."}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1562577099, "post_id": 56920598, "comment_id": 100404132, "body": "Can you edit in the definition of a &quot;strong&quot; number?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1563056869, "post_id": 57023171, "comment_id": 100576559, "body": "This is a terribly inefficient way of calculating a factorial, BTW. Even if tail call optimization was on, this function is <b>not</b> tail-recursive."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1563057520, "post_id": 57023171, "comment_id": 100576666, "body": "In fact, no need to bother with recursion at all. A simple <code>(1..n).reduce(:*)</code> will suffice."}, {"owner": {"reputation": 1, "user_id": 5961654, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ImmciBBtjlc/AAAAAAAAAAI/AAAAAAAAGrE/qnNYYzJ3b6A/photo.jpg?sz=128", "display_name": "Pratham Sharma", "link": "https://stackoverflow.com/users/5961654/pratham-sharma"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1563060522, "post_id": 57023171, "comment_id": 100577027, "body": "I had a thought of <code>number.downto(1).inject(:*)</code> but to keep it simple I did it that way."}], "tags": [], "owner": {"reputation": 1, "user_id": 5961654, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ImmciBBtjlc/AAAAAAAAAAI/AAAAAAAAGrE/qnNYYzJ3b6A/photo.jpg?sz=128", "display_name": "Pratham Sharma", "link": "https://stackoverflow.com/users/5961654/pratham-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1563055836, "creation_date": 1563055836, "answer_id": 57023171, "question_id": 56920598, "link": "https://stackoverflow.com/questions/56920598/strong-number-identifier-ruby-code-issue/57023171#57023171", "title": "Strong number identifier (Ruby code issue)", "body": "<p>Hope this helps!\nI have tried to reduce the code by breaking it into pieces</p>\n\n<p>Input: 145</p>\n\n<pre><code>def method_name(num)\n  array = num.to_s.chars.map(&amp;:to_i) # =&gt; [1,4,5]\n  fact_arr = array.map {|f| fact(f)} # =&gt; [1, 24, 120]\n\n  if (num == fact_arr.inject(:+))\n    return \"STRONG!!\"\n  else\n    return \"NOT STRONG!!\"\n  end\nend\n\ndef fact(n)\n  if (n == 0)\n    1\n  else\n    n * fact(n-1)\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 981, "user_id": 8896337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uI5ps.jpg?s=128&g=1", "display_name": "B-M", "link": "https://stackoverflow.com/users/8896337/b-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1563067943, "last_edit_date": 1563067943, "creation_date": 1563067227, "answer_id": 57023919, "question_id": 56920598, "link": "https://stackoverflow.com/questions/56920598/strong-number-identifier-ruby-code-issue/57023919#57023919", "title": "Strong number identifier (Ruby code issue)", "body": "<p><code>k.divmod(n)</code> returns an array = [quocient_of_division(k/n), rest of division(k/n)]. Example: <code>145.divmod(1)</code> returns <code>=&gt;[145, 0]</code>. Also, <code>digit-1.times</code> in your code should be <code>(digit-1).times</code></p>\n\n<p>The way I thought that this could be done is like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def is_strong?(number)\n  result = 0\n  numbers = number.to_s.chars.map(&amp;:to_i)\n  powers = { 0 =&gt; 1, 1 =&gt; 1, 2 =&gt; 2, 3 =&gt; 6, 4 =&gt; 24, 5 =&gt; 120, 6 =&gt; 760, 7 =&gt; 5040, 8 =&gt; 40320, 9 =&gt; 362880 }\n  numbers.each do |n|\n    result += powers[n]\n  end  \n  return (result == number)\nend\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4025947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x0WPM.jpg?s=128&g=1", "display_name": "CodeKrakken", "link": "https://stackoverflow.com/users/4025947/codekrakken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1563067943, "creation_date": 1562489043, "last_edit_date": 1562583481, "question_id": 56920598, "link": "https://stackoverflow.com/questions/56920598/strong-number-identifier-ruby-code-issue", "title": "Strong number identifier (Ruby code issue)", "body": "<p>I need to write some code that can identify a Strong Number.</p>\n\n<p>A strong number is the number that the sum of the factorial of its digits is equal to number itself.</p>\n\n<p>For example : 145 , since 1! + 4! + 5! = 1 + 24 + 120 = 145</p>\n\n<p>I've been trying to solve this but to no avail. Can anyone tell me where I'm going wrong? I need the \"adder\" and \"multiplier\" variables to increase with each loop, so I can compare the total at the end of the method, but they keep defaulting to zero. Can anyone see where I'm going wrong? Thanks!</p>\n\n<pre><code>def strong_num(n)\n  digits=n.divmod(1)\n  multiplier=1\n  adder=0\n\n  digits.each do |digit|\n    x=digit\n    digit-1.times do\n      multiplier=multiplier*x\n      adder=adder+multiplier\n\n      x=x-1\n    end\n  end\n\n  if n==adder\n    return \"STRONG!!!!\"\n  else \n    return \"Not Strong !!\"\n  end\nend\n</code></pre>\n\n<p>Sample input:</p>\n\n<pre><code>Test.assert_equals(strong_num(1)  , \"STRONG!!!!\")\nTest.assert_equals(strong_num(2)  , \"STRONG!!!!\")\nTest.assert_equals(strong_num(7)  , \"Not Strong !!\")\nTest.assert_equals(strong_num(93) , \"Not Strong !!\")\nTest.assert_equals(strong_num(145), \"STRONG!!!!\")\nTest.assert_equals(strong_num(185), \"Not Strong !!\")\n</code></pre>\n\n<p>Sample output:</p>\n\n<pre><code>Test Passed: Value == \"STRONG!!!!\"\nTest Passed: Value == \"STRONG!!!!\"\nExpected: \"Not Strong !!\", instead got: \"STRONG!!!!\"\nExpected: \"Not Strong !!\", instead got: \"STRONG!!!!\"\nTest Passed: Value == \"STRONG!!!!\"\nExpected: \"Not Strong !!\", instead got: \"STRONG!!!!\"\nTest Passed: Value == \"STRONG!!!!\"\nExpected: \"Not Strong !!\", instead got: \"STRONG!!!!\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 2, "creation_date": 1562496156, "post_id": 56920524, "comment_id": 100385251, "body": "Why you cannot change order of actions, 1. delete files, 2 update price?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1562548400, "post_id": 56920524, "comment_id": 100396055, "body": "That/s what I was trying to figure out.  Ended up realizing I needed this ins the nested model thanks to @kuo_jimmy"}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1562547646, "post_id": 56925126, "comment_id": 100395924, "body": "Okay this makes more sense.  I tried a few different ways but still not working? I updated my OP at the bottom with 1 of the attemps"}], "tags": [], "owner": {"reputation": 771, "user_id": 1051942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f703f37922352d71c44d34fb8425951?s=128&d=identicon&r=PG", "display_name": "Kuo Jimmy", "link": "https://stackoverflow.com/users/1051942/kuo-jimmy"}, "is_accepted": false, "score": 0, "last_activity_date": 1562525354, "creation_date": 1562525354, "answer_id": 56925126, "question_id": 56920524, "link": "https://stackoverflow.com/questions/56920524/how-to-create-sum-calculation-on-update-after-saving-before-redirect-after-all/56925126#56925126", "title": "How to create sum calculation on update after saving, before redirect, after all actions?", "body": "<p>try to use <code>after_commit :update_product_price, on: :destroy</code> in your <code>ShopProductPrintFile</code> model. It will trigger when <code>shop_product_print_files</code> destroyed and you need to recalculate the price for product.</p>\n\n<p>And in your example, you need to add <code>save!</code> to your <code>after_commit</code> or it won't save to database. But you should be careful that it will trigger another update to product model and trigger <code>after_commit</code> again. so you have to add a condition to detect if <code>after_commit</code> should be triggered.</p>\n"}, {"tags": [], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "is_accepted": false, "score": 0, "last_activity_date": 1562548446, "creation_date": 1562548446, "answer_id": 56927302, "question_id": 56920524, "link": "https://stackoverflow.com/questions/56920524/how-to-create-sum-calculation-on-update-after-saving-before-redirect-after-all/56927302#56927302", "title": "How to create sum calculation on update after saving, before redirect, after all actions?", "body": "<p>This works with putting in my ShopProductPrintFile model.</p>\n\n<p>On update, create, and destroy.</p>\n\n<pre><code>  after_commit :calculate_sp\n\n  def calculate_sp\n    shop_product = ShopProduct.find(self.shop_product.id)\n      price = (shop_product.print_locations.to_a.sum { |sp| sp.price } + shop_product.product.price)\n    shop_product.price =  price\n    shop_product.save!\n  end\n</code></pre>\n\n<p>I will not be accepting this response as I am sure there is a better way or syntax for doing this.  If you have this, please respond with it and why it is a more efficient or better approach and I will accept yours</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562548446, "creation_date": 1562488348, "last_edit_date": 1562548336, "question_id": 56920524, "link": "https://stackoverflow.com/questions/56920524/how-to-create-sum-calculation-on-update-after-saving-before-redirect-after-all", "title": "How to create sum calculation on update after saving, before redirect, after all actions?", "body": "<p>I have a nested form:</p>\n\n<pre><code>  &lt;%= form_for shop_product do |f| %&gt;\n   ...\n    &lt;%= f.fields_for :shop_product_print_files do |ff| %&gt;\n       &lt;%= ff.object.print_location.title %&gt;\n          &lt;%= ff.hidden_field :print_location_id %&gt;\n              &lt;%= ff.select :image_file_id, options_for_select(@image_files.map { |image| [image.id, {'data-img-src'=&gt;image.image_file_url(:thumb)}]}), {:include_blank =&gt; 'Noneblank'}, class: \"image-picker\" %&gt;\n       ...\n</code></pre>\n\n<p>Which on update, will reject and delete if the <code>:image_file_id</code> is blank:</p>\n\n<p><strong>shop_product model</strong></p>\n\n<pre><code> accepts_nested_attributes_for :shop_product_print_files, reject_if: :reject_file, :allow_destroy =&gt; true\n\n  def reject_file(attributes)\n    if attributes[:image_file_id].blank?\n      if attributes[:id].present?\n        attributes.merge!({:_destroy =&gt; 1}) &amp;&amp; false\n      else\n        true\n      end\n    end\n  end\n</code></pre>\n\n<p>In the update method, where the issue is:</p>\n\n<pre><code>@shop_product.price = (@shop_product.print_locations.to_a.sum { |sp| sp.price } + @shop_product.product.price)\n</code></pre>\n\n<p>The delete is happening AFTER the update and seems to be the last action that happens before the redirect of the successful update.</p>\n\n<p>How can I create this calculation after it's updated and the records are destroyed?</p>\n\n<p>I tried:</p>\n\n<pre><code>after_commit :calculate_price\n\n  def calculate_price\n      self.price = (self.print_locations.to_a.sum { |sp| sp.price } + self.product.price)\n    end\n  end\n</code></pre>\n\n<p><code>after_updated</code>\n<code>after_save</code></p>\n\n<p>Not working</p>\n\n<p>To clarify as well, this calculation works on create.  the issue is because of deleting the records on update as mentioned, it kicks in before the database is changed which is why i figured <code>after_commit</code> would work.  </p>\n\n<p>Attempt in ShopProductPrintFile model:</p>\n\n<pre><code>after_commit :calculate_sp, on: [:update, :destroy]\n\n  def calculate_sp\n    shop_product = ShopProduct.find(self.shop_product.id)\n      price = (shop_product.print_locations.to_a.sum { |sp| sp.price } + shop_product.product)\n      shop_product.update_attributes!(price: price)\n    end\n  end\n</code></pre>\n\n<p>Still not working but seems like this should? Is my syntax not correct in writing?</p>\n\n<p>SOLUTION:</p>\n\n<pre><code>  after_commit :calculate_sp\n\n  def calculate_sp\n    shop_product = ShopProduct.find(self.shop_product.id)\n      price = (shop_product.print_locations.to_a.sum { |sp| sp.price } + shop_product.product.price)\n    shop_product.price =  price\n    shop_product.save!\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "regex", "ruby"], "comments": [{"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1562488553, "post_id": 56920471, "comment_id": 100383631, "body": "Can you add some examples what you do and do not want to match?"}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "reply_to_user": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1562489050, "post_id": 56920471, "comment_id": 100383723, "body": "I want to run all the spec files inside models, controllers &amp; presenters folder"}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 1, "creation_date": 1562493477, "post_id": 56920471, "comment_id": 100384673, "body": "Looking at <a href=\"https://github.com/grosser/parallel_tests\" rel=\"nofollow noreferrer\">this page</a> perhaps try <code>rake parallel:spec[&#39;spec\\&#47;(?:models|controllers|presenters)&#39;]</code> <a href=\"https://regex101.com/r/xqUbEJ/1/\" rel=\"nofollow noreferrer\">regex demo</a>"}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "reply_to_user": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1562497311, "post_id": 56920471, "comment_id": 100385444, "body": "@Thefourthbird Thanks only thing I need to add 1 extra slash to make it work after parallel:spec.  rake parallel:spec\\ [&#39;spec\\/(?:models|controllers|presenters)&#39;]"}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 1, "creation_date": 1562497446, "post_id": 56920471, "comment_id": 100385474, "body": "In your current pattern the forward slash is optional. You might also omit the <code>.*</code> if the name of 1 of the group follows directly."}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "reply_to_user": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1562497593, "post_id": 56920471, "comment_id": 100385508, "body": "@Thefourthbird Something like this rake parallel:spec[&#39;spec\\/?(models|controllers|presenters)&#39;]"}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1562497809, "post_id": 56920471, "comment_id": 100385549, "body": "My comment about the optional forward slash was about the second pattern of your examples. Does <code>parallel:spec[&#39;spec\\&#47;(?:models|controllers|presenters)&#39;]</code> work?"}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "reply_to_user": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1562512964, "post_id": 56920471, "comment_id": 100389092, "body": "@Thefourthbird This doesn&#39;t work I got an error zsh: no matches found: parallel:spec[spec\\/(?:models|controllers|presenters)]"}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "reply_to_user": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1562526193, "post_id": 56920471, "comment_id": 100392270, "body": "@Thefourthbird One part of my question is still remaining How to run single or multiple files with parallel test"}], "owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 282, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562561789, "creation_date": 1562487873, "last_edit_date": 1562561789, "question_id": 56920471, "link": "https://stackoverflow.com/questions/56920471/how-to-run-multiple-folder-and-files-using-parallel-test", "title": "How to run multiple folder and files using parallel test", "body": "<p>I am trying to use the parallel testing gem for my application. So, I want to run some specific folders or files but couldn't able to do. I tried the below things but it didn't work for me</p>\n\n<pre><code>rake parallel:spec['spec\\/models|controllers']\n\nrake parallel:spec['spec\\/?.*(models|controllers|presenters)']\n\nrake parallel:spec['spec\\/models spec\\/controllers']\n\nrake parallel:spec['spec/models spec/controllers']\n</code></pre>\n"}, {"tags": ["ruby", "charles-proxy"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1562457818, "post_id": 56918242, "comment_id": 100379581, "body": "Make your life easier. Use HTTParty, as most rubyists do: <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">github.com/jnunemaker/httparty</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2358, "user_id": 1072281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5900eea054e31a49f94492cc5618ee17?s=128&d=identicon&r=PG&f=1", "display_name": "colinux", "link": "https://stackoverflow.com/users/1072281/colinux"}, "is_accepted": true, "score": 1, "last_activity_date": 1562456659, "creation_date": 1562456659, "answer_id": 56918402, "question_id": 56918242, "link": "https://stackoverflow.com/questions/56918242/trying-to-replicate-mobile-app-post-request-in-ruby-getting-502-gateway-error/56918402#56918402", "title": "Trying to replicate Mobile App POST Request in Ruby, Getting 502 Gateway Error", "body": "<p>This is probably not directly tied to the body length you're sending.</p>\n\n<p>I see possibly 2 problems here :</p>\n\n<ul>\n<li>the 502 error : are your <code>uri.host</code>  and <code>port</code> correct ?  A 502 error means there is something wrong on the server side. Also try by removing the <code>Host</code> header.</li>\n<li>body content is not gzipped</li>\n</ul>\n\n<p>You're defining an header <code>Content-Encoding: gzip</code> but you didn't compress the data (<code>Net::Http</code> doesn't do that automatically).</p>\n\n<p>Try with something like that :</p>\n\n<pre><code>require \"gzip\"\n\n@header_post = { \n  # ... \n}\n\nhttp = Net::HTTP.new(uri.host, uri.port)\npath = '/1.1/user/-/friends/invitations'\n\ndata = \"invitedUserId=REDACTED&amp;source=PROFILE_INVITATION\"\n\n# instanciate a new gzip buffer\ngzip = Zlib::GzipWriter.new(StringIO.new)\n\n# append your data\ngzip &lt;&lt; data\n\n# get the gzip body and use it in your request\nbody = gzip.close.string\nresp, data = http.post(path, body, @header_post)\n</code></pre>\n\n<p>Alternatively, maybe the server is accepting a non-gzipped content. You could try simply by deleting the <code>Content-Encoding</code>\nerror from your original code.</p>\n\n<p>However if it was the only mistake, the server should not send a 502 but a 4xx error. So I'm guessing there is another issue there with the uri config like a suggested above.</p>\n"}], "owner": {"reputation": 133, "user_id": 1922913, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bd2358c3d44a862db562aa8e8abfb4c3?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/1922913/krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 56918402, "answer_count": 1, "score": 0, "last_activity_date": 1562456659, "creation_date": 1562454758, "question_id": 56918242, "link": "https://stackoverflow.com/questions/56918242/trying-to-replicate-mobile-app-post-request-in-ruby-getting-502-gateway-error", "title": "Trying to replicate Mobile App POST Request in Ruby, Getting 502 Gateway Error", "body": "<p>I'm trying to automate actions I can take manually in an iPhone app using Ruby, but when I do, I get a 502 bad gateway error.</p>\n\n<p>Using Charles Proxy I got the request the iPhone app is making:</p>\n\n<pre><code>POST /1.1/user/-/friends/invitations HTTP/1.1\nHost: redacted.com\nAccept-Locale: en_US\nAccept: */*\nAuthorization: Bearer REDACTED\nContent-Encoding: gzip\nAccept-Encoding: br, gzip, deflate\nAccept-Language: en_US\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nContent-Length: 66\nConnection: keep-alive\nX-App-Version: 814\n\ninvitedUserId=REDACTED&amp;source=PROFILE_INVITATION\n</code></pre>\n\n<p>I wrote the following code in Ruby to send this same request:</p>\n\n<pre><code>@header_post = {\n  \"Host\" =&gt; \"redacted.com\",\n  \"Accept-Locale\" =&gt; \"en_US\",\n  \"Accept\" =&gt; \"*/*\",\n  \"Authorization\" =&gt; \"Bearer REDACTED\",\n  \"Content-Encoding\" =&gt; \"gzip\",\n  \"Accept-Encoding\" =&gt; \"br, gzip, deflate\",\n  \"Accept-Language\" =&gt; \"en_US\",\n  \"Content-Type\" =&gt; \"application/x-www-form-urlencoded; charset=UTF-8\",\n  \"Connection\" =&gt; \"keep-alive\",\n  \"X-App-Version\" =&gt; \"814\"\n}\nhttp = Net::HTTP.new(uri.host, uri.port)\nhttp.use_ssl = true\npath = '/1.1/user/-/friends/invitations'\n\ndata = \"invitedUserId=REDACTED&amp;source=PROFILE_INVITATION\"\n\nresp, data = http.post(path, data, @header_post)\n</code></pre>\n\n<p>Unfortunately I get a 502 Bad Gateway Error when running this code.</p>\n\n<p>One thing I noticed which I think is key to the solution here is that, in the POST request the mobile app is making, the content length is 66. But the length of the string \"invitedUserId=REDACTED&amp;source=PROFILE_INVITATION\" with un-redacted userId is only 46.</p>\n\n<p>Am I missing another form variable with format \"&amp;param=value\" which has length 20? Or am I missing something else?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["ruby", "inject"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1562450775, "post_id": 56917037, "comment_id": 100378645, "body": "When using <code>inject</code> (aka <code>reduce</code>), the block variable that is the accumulator (generally referred to as the <i>memo</i>)--here <code>sum</code>--is assigned to the result of the block calculation at each step. You therefore can simplify <code>sum = sum + Rational(1,x)</code> to <code>sum + Rational(1,x)</code>."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562602083, "post_id": 56917037, "comment_id": 100417783, "body": "This is neither here nor there, but a more compact way to write <code>Rational(1, x)</code> is <code>1r&#47;x</code>."}], "answers": [{"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 2, "creation_date": 1562445904, "post_id": 56917213, "comment_id": 100377712, "body": "Hmm. <code>arr.reverse.inject{ |sum, i| i + Rational(1, sum) }</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562446665, "post_id": 56917213, "comment_id": 100377889, "body": "Thanks, @Eric, a definite improvement. I&#39;ve done an edit."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 4, "last_activity_date": 1562605659, "last_edit_date": 1562605659, "creation_date": 1562442670, "answer_id": 56917213, "question_id": 56917037, "link": "https://stackoverflow.com/questions/56917037/computing-nested-sum-using-ruby-inject/56917213#56917213", "title": "Computing nested sum using Ruby inject", "body": "<pre><code>arr = [0, 2, 1, 12, 8]\n\narr.reverse.reduce { |tot, n| n + Rational(1, tot) }\n  #=&gt; 105/307\n</code></pre>\n\n<p>The steps:</p>\n\n<pre><code>a = arr.reverse\n  #=&gt; [8, 12, 1, 2, 0] \nb = a.reduce do |tot ,n|\n  puts \"tot=#{tot}, n=#{n}\"\n  (n + Rational(1, tot)).tap { |r| puts \"  tot=#{r}\" }\nend\n  #=&gt; (105/307) \n</code></pre>\n\n<p>This prints:</p>\n\n<pre><code>tot=8, n=12\n  tot=97/8\ntot=97/8, n=1\n  tot=105/97\ntot=105/97, n=2\n  tot=307/105\ntot=307/105, n=0\n  tot=105/307\n</code></pre>\n\n<p>Alternatively, recursion could be used.</p>\n\n<pre><code>def recurse(arr)\n  arr.size == 1 ? arr.first : arr.first + Rational(1, recurse(arr.drop(1)))\nend\n\nrecurse arr\n  #=&gt; (105/307)\n</code></pre>\n"}], "owner": {"reputation": 829, "user_id": 1322914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/66be9ebb7e7e3cb81d43a924518483e2?s=128&d=identicon&r=PG", "display_name": "regulus", "link": "https://stackoverflow.com/users/1322914/regulus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1562605659, "creation_date": 1562441072, "last_edit_date": 1562449457, "question_id": 56917037, "link": "https://stackoverflow.com/questions/56917037/computing-nested-sum-using-ruby-inject", "title": "Computing nested sum using Ruby inject", "body": "<p>I'm trying to use Ruby's inject to sum an array representing a finite continued fraction, where</p>\n\n<pre><code>[a, b, c, d, e, ... , x] = a + 1/(b + 1/(c + 1/(d + 1/(e + ... 1/x)...)))\n</code></pre>\n\n<p>I can't figure out how to get the proper nested evaluation to return the correct value using inject. </p>\n\n<p>Instead, what I've written just returns the flat sum of the terms rather than a nested sum. For example,</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>total = [0, 2, 1, 12, 8].inject do |sum,x|\n  sum = sum + Rational(1,x)\nend\nputs total\n#=&gt;  41/24\n</code></pre>\n\n<p>That is, \n    <code>0 + 1/2 + 1/1 + 1/12 + 1/8 #=&gt;  41/24</code>\ninstead of\n    <code>0 + 1/(2 + 1/(1 + 1/(12+1/8))) #=&gt;  105/307</code>, which is the correct value.</p>\n\n<p>Is it possible to compute this type of sum using the inject method? </p>\n\n<p>If not, how can I compute it correctly?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562441062, "post_id": 56916555, "comment_id": 100376731, "body": "I just ran <code>caller_locations.map(&amp;:path).include?($PROGRAM_NAME)</code> in IRB and got false."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562601811, "post_id": 56916555, "comment_id": 100417652, "body": "I don&#39;t know the answer to your question, but it sounds like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem/66378#66378\">XY problem</a>. What problem are you trying to solve?"}, {"owner": {"reputation": 12376, "user_id": 228534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4ebe6ef5e1502536b89bb7e83d406fb?s=128&d=identicon&r=PG", "display_name": "Soumya", "link": "https://stackoverflow.com/users/228534/soumya"}, "edited": false, "score": 0, "creation_date": 1562607844, "post_id": 56916555, "comment_id": 100420328, "body": "Maybe. I&#39;m just trying to find the closest call frame that originates in $PROGRAM_NAME, regardless of whether it&#39;s in a method definition or top level. This seemed like the simplest way to do it."}], "owner": {"reputation": 12376, "user_id": 228534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4ebe6ef5e1502536b89bb7e83d406fb?s=128&d=identicon&r=PG", "display_name": "Soumya", "link": "https://stackoverflow.com/users/228534/soumya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562436741, "creation_date": 1562436741, "question_id": 56916555, "link": "https://stackoverflow.com/questions/56916555/will-caller-locations-path-always-include-program-name", "title": "Will caller_locations[...].path always include $PROGRAM_NAME?", "body": "<p>Can I safely assume that <code>caller_locations[i].path == $PROGRAM_NAME</code> will return true for some <code>i</code>, or can there be cases where none of the caller locations return <code>$PROGRAM_NAME</code> (e.g. hard links / symlinks / some convoluted require case)?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "continuous-deployment", "capistrano3"], "answers": [{"comments": [{"owner": {"reputation": 477, "user_id": 2454958, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/600879854c516cd3b5c1df1817f008f2?s=128&d=identicon&r=PG", "display_name": "fade2black", "link": "https://stackoverflow.com/users/2454958/fade2black"}, "edited": false, "score": 0, "creation_date": 1562687731, "post_id": 56956328, "comment_id": 100451248, "body": "In order to tell whether or not my deployment process is setup correctly I NEED TO KNOW which role (db, web, app) runs which tasks. I really know that db runs migration (since it is db related). I also deduce that web runs asset compilation after some trial (NOT LEARNING FROM DOCS). What tasks does app run? Any docs or reference?"}, {"owner": {"reputation": 1919, "user_id": 384689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66498e80512ef50822cceb2a2f5cba3?s=128&d=identicon&r=PG", "display_name": "claasz", "link": "https://stackoverflow.com/users/384689/claasz"}, "reply_to_user": {"reputation": 477, "user_id": 2454958, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/600879854c516cd3b5c1df1817f008f2?s=128&d=identicon&r=PG", "display_name": "fade2black", "link": "https://stackoverflow.com/users/2454958/fade2black"}, "edited": false, "score": 0, "creation_date": 1562744947, "post_id": 56956328, "comment_id": 100468702, "body": "In your question you say that you deploy to a single server. In that case you don&#39;t need to care about role - task relations. The whole point of role configuration is only needed in case you have a more complex load-balanced setup with multiple servers for the same application."}], "tags": [], "owner": {"reputation": 1919, "user_id": 384689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66498e80512ef50822cceb2a2f5cba3?s=128&d=identicon&r=PG", "display_name": "claasz", "link": "https://stackoverflow.com/users/384689/claasz"}, "is_accepted": false, "score": 0, "last_activity_date": 1562687287, "creation_date": 1562687287, "answer_id": 56956328, "question_id": 56914396, "link": "https://stackoverflow.com/questions/56914396/which-roles-should-i-include-in-production-rb-while-deploying-a-rail-api-app-usi/56956328#56956328", "title": "Which roles should I include in production.rb while deploying a Rail API app using Capistrano?", "body": "<p>For a single server deployment, my Capistrano configuration typically looks like</p>\n\n<pre><code># role-based syntax\nrole :app, %w{user@myserver}\nrole :web, %w{user@myserver}\nrole :db, %w{user@myserver}\n</code></pre>\n\n<p>So three <code>role</code> statements for the same server. </p>\n\n<p>I guess Capistrano is executing different tasks depending on each role - e.g. migrations are run on <code>db</code>, asset compilation is run on <code>web</code> etc. So if you have a single server, it would take all roles.</p>\n\n<p>If your deployment only works for some of the roles, that would be an indicator that your deployment process is not setup correctly. </p>\n"}], "owner": {"reputation": 477, "user_id": 2454958, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/600879854c516cd3b5c1df1817f008f2?s=128&d=identicon&r=PG", "display_name": "fade2black", "link": "https://stackoverflow.com/users/2454958/fade2black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562687287, "creation_date": 1562418574, "last_edit_date": 1562419571, "question_id": 56914396, "link": "https://stackoverflow.com/questions/56914396/which-roles-should-i-include-in-production-rb-while-deploying-a-rail-api-app-usi", "title": "Which roles should I include in production.rb while deploying a Rail API app using Capistrano?", "body": "<p>I have a Rails 5 API application and I want to deploy it on a remote server which hosts both application and database (Postgres).</p>\n\n<p>I managed to deploy only after I removed <code>web</code> and <code>app</code> roles </p>\n\n<pre><code>server \"myserver\", user: \"myuser\", roles: %w{db} \n</code></pre>\n\n<p>When I add <code>web</code> or <code>app</code> the Capistrano fails to deploy. For example it tries to precompile assets or tries to find a folder which does not exist. </p>\n\n<p>I understand that Capistrano lets us tag each server with one or more roles, so we can control what tasks are executed where.</p>\n\n<p>How do we know exactly which role executes which task? In particular, what role(s) do I need to successfully deploy a Rails 5 API application? </p>\n\n<p>I could not find any information on Capistrano home page answering my question.</p>\n"}, {"tags": ["ruby", "inheritance", "method-chaining"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1562415663, "post_id": 56913583, "comment_id": 100371010, "body": "Why <code>ChildClass.foo(a).bar(b).buzz(r)</code> and not <code>ChildClass.foo(a).buzz(x).bar(b).buzz(r)</code>. What if just <code>ChildClass.foo(a)</code> is called? Should is return <code>ChildClass.foo(a)</code> or <code>ChildClass.foo(a).buzz(r)</code>? And what is <code>r</code>?"}, {"owner": {"reputation": 1184, "user_id": 1269041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f4555652545040e404bd072400c810c?s=128&d=identicon&r=PG", "display_name": "konart", "link": "https://stackoverflow.com/users/1269041/konart"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1562417579, "post_id": 56913583, "comment_id": 100371407, "body": "Not sure I understand your first question. Methods&#39; and var\\args&#39; names are purely random and only there for convenience, the number of chained methods can vary. Regardless of how many methods are called in a chain (0 to infinity) the <code>buzz</code> method should be called. So if none is called - we are calling just <code>buzz</code>. If only <code>foo</code> is called we append <code>buzz</code>. How does it metter what is <code>r</code>? Let&#39;s say it is a Hash."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1562418110, "post_id": 56913583, "comment_id": 100371536, "body": "My question is, how can calling <code>ChildClass.foo(a).bar(b)</code> be equal to <code>ChildClass.foo(a).bar(b).buzz(r)</code> if there is a required argument without a default value? What is the argument provided to <code>buzz</code> on <code>ChildClass.foo(a).bar(b)</code>? Can it be inferred from the class, or one of the other methods called?"}, {"owner": {"reputation": 1184, "user_id": 1269041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f4555652545040e404bd072400c810c?s=128&d=identicon&r=PG", "display_name": "konart", "link": "https://stackoverflow.com/users/1269041/konart"}, "edited": false, "score": 0, "creation_date": 1562423185, "post_id": 56913583, "comment_id": 100372687, "body": "You can assume that Class and ChildClass are database models and that each of the chained methods return some form of a <code>dataset</code> object (but not an actual data). You can replace <code>foo</code>, <code>bar</code> and <code>buzz</code> with <code>select</code>, <code>where</code> and <code>order</code>. Their arguments are objects that will be passed down to the <code>dataset</code> object."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 2, "creation_date": 1562434551, "post_id": 56913583, "comment_id": 100375346, "body": "are you talking about something similar to how active record automatically evaluates your query at the end of the method chain?"}, {"owner": {"reputation": 1184, "user_id": 1269041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f4555652545040e404bd072400c810c?s=128&d=identicon&r=PG", "display_name": "konart", "link": "https://stackoverflow.com/users/1269041/konart"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562444720, "post_id": 56913583, "comment_id": 100377436, "body": "@maxpleaner Judging from this qestion (and the answer) - <a href=\"https://stackoverflow.com/questions/1332404/how-to-detect-the-end-of-a-method-chain-in-ruby\" title=\"how to detect the end of a method chain in ruby\">stackoverflow.com/questions/1332404/&hellip;</a> I am (more or less at least). But the given answer as I understand it relies no the fact that chained method will always return an object that will have methods unavailable for an actuall data object (Array fro example). Which can be false."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562446280, "post_id": 56913583, "comment_id": 100377790, "body": "Do you know how this object will be used? Is there a method which will always be called with this object, either as the receiver or as an argument?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562446280, "post_id": 56913583, "comment_id": 100377791, "body": "It is not possible for ruby to <i>just know</i> when you have reached the end of a method chain. There are hacks to get around this, such as how ActiveRecord defines <code>each</code> and <code>inspect</code> to actually evaluate the query. It&#39;s simpler to be explicit. You can define a method like <code>resolve</code>/<code>evaluate</code> which has to be manually called at the end of the chain. Or you can use some sort of block, e.g. <code>MyClass.send_query { &lt;build the query in here&gt; }</code>. I am happy to make an answer showing these examples but I&#39;m not sure it&#39;s what you want."}, {"owner": {"reputation": 1184, "user_id": 1269041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f4555652545040e404bd072400c810c?s=128&d=identicon&r=PG", "display_name": "konart", "link": "https://stackoverflow.com/users/1269041/konart"}, "edited": false, "score": 0, "creation_date": 1562446431, "post_id": 56913583, "comment_id": 100377826, "body": "Yeah, I&#39;ve already decided I&#39;d rather use some sort of proxy-builder and then just append whatever I have to. Thank!"}], "owner": {"reputation": 1184, "user_id": 1269041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f4555652545040e404bd072400c810c?s=128&d=identicon&r=PG", "display_name": "konart", "link": "https://stackoverflow.com/users/1269041/konart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562411766, "creation_date": 1562411766, "question_id": 56913583, "link": "https://stackoverflow.com/questions/56913583/how-to-always-append-a-class-method-to-a-chained-method-call", "title": "How to always append a class method to a chained method call", "body": "<p>Let's cay you have a class <code>Class</code> with N class methods methods that can be chained (thing of DB Model):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Class\n  def self.foo(a)\n    @a = a\n    self\n  end\n\n  ...\nend\n</code></pre>\n\n<p>So it can be called like <code>Class.foo(a).bar(b)</code> etc.</p>\n\n<p>Now, you have a child class <code>ChildClass</code> and you wan't it to always add another chained method in the end:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ChildClass &lt; Class\n  def self.buzz(r)\n    @r = r\n    self\n  end\nend\n</code></pre>\n\n<p>So that</p>\n\n<p><code>ChildClass.foo(a).bar(b)</code> </p>\n\n<p>would always actually be</p>\n\n<p><code>ChildClass.foo(a).bar(b).buzz(r)</code> </p>\n"}, {"tags": ["ruby", "if-statement", "hash", "each", "hash-of-hashes"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1562417101, "post_id": 56912625, "comment_id": 100371320, "body": "The exceptions tells us that either <code>multiple_coupons</code> or <code>multiple_coupons[item]</code> is <code>nil</code>. Meaning that <code>multiple_coupons</code> (if not <code>nil</code>) doesn&#39;t include the key <code>&quot;AVOCADO&quot;</code> or <code>&quot;CHEESE&quot;</code>."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 3, "creation_date": 1562433867, "post_id": 56912625, "comment_id": 100375199, "body": "<code>coupons.each do |k|</code> should be <code>coupons.each do |coupon|</code>. And you should then use <code>coupon</code>, not <code>coupons[0]</code> because otherwise you&#39;ll always just use the first <code>coupon</code>, multiple times."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1562434209, "post_id": 56912625, "comment_id": 100375276, "body": "The reason there have been no answers after 8 hours is that readers are unwilling to invest the time required to figure out your code (with the possible exception of @Duminil). You say that one test does not pass. If so, why present all the tests that do pass?  I suggest you remove all the test code, define <code>cart</code> and <code>coupons</code> for the problematic case and show the error message (with line number) that occurs when <code>apply_coupons(cart, coupons)</code>  is executed. Also, begin by explaining what you wish to compute. Lastly, please ditch &quot;(this is a tough one)&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562602371, "post_id": 56936933, "comment_id": 100417914, "body": "Downvoted because it does not attempt to help OP understand why the original code wasn&#39;t working."}], "tags": [], "owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "is_accepted": true, "score": -1, "last_activity_date": 1562595561, "creation_date": 1562595561, "answer_id": 56936933, "question_id": 56912625, "link": "https://stackoverflow.com/questions/56912625/using-each-and-multiple-if-statements-in-ruby/56936933#56936933", "title": "Using each and multiple if statements in Ruby", "body": "<pre><code>def apply_coupons(cart, coupons)\n  coupons.each do |coupon|\n    if cart.keys.include?(coupon[:item])\n      if cart[coupon[:item]][:count] &gt;= coupon[:num]\n        itemwithCoupon = \"#{coupon[:item]} W/COUPON\"\n        if cart[itemwithCoupon]\n          cart[itemwithCoupon][:count] += coupon[:num]\n          cart[coupon[:item]][:count] -= coupon[:num]\n        else\n          cart[itemwithCoupon] = {}\n          cart[itemwithCoupon][:price] = (coupon[:cost] / coupon[:num])\n          cart[itemwithCoupon][:clearance] = cart[coupon[:item]][:clearance]\n          cart[itemwithCoupon][:count] = coupon[:num]\n          cart[coupon[:item]][:count] -= coupon[:num]\n        end\n      end\n    end\n  end\n  cart\n\nend\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 56936933, "answer_count": 1, "score": 1, "last_activity_date": 1562595561, "creation_date": 1562403544, "last_edit_date": 1562582262, "question_id": 56912625, "link": "https://stackoverflow.com/questions/56912625/using-each-and-multiple-if-statements-in-ruby", "title": "Using each and multiple if statements in Ruby", "body": "<p>I first want to apologize because I am not sure if it will make complete sense but I want to provide you with as much context as possible. I working on a lesson that is trying to teach me iterating over hashes and nested hashes. I have been working on this for a couple days now and have been struggling and now I think I have put in too many lines of code, it might look a bit sloppy. </p>\n\n<p>So first off the method is tested against the following items and tests:</p>\n\n<pre><code>describe \"Grocer\" do\n  let(:items) do\n    [\n      {\"AVOCADO\" =&gt; {:price =&gt; 3.00, :clearance =&gt; true}},\n      {\"KALE\" =&gt; {:price =&gt; 3.00, :clearance =&gt; false}},\n      {\"BLACK_BEANS\" =&gt; {:price =&gt; 2.50, :clearance =&gt; false}},\n      {\"ALMONDS\" =&gt; {:price =&gt; 9.00, :clearance =&gt; false}},\n      {\"TEMPEH\" =&gt; {:price =&gt; 3.00, :clearance =&gt; true}},\n      {\"CHEESE\" =&gt; {:price =&gt; 6.50, :clearance =&gt; false}},\n      {\"BEER\" =&gt; {:price =&gt; 13.00, :clearance =&gt; false}},\n      {\"PEANUTBUTTER\" =&gt; {:price =&gt; 3.00, :clearance =&gt; true}},\n      {\"BEETS\" =&gt; {:price =&gt; 2.50, :clearance =&gt; false}},\n      {\"SOY MILK\" =&gt; {:price =&gt; 4.50, :clearance =&gt; true}}\n    ]\n  end\n\n  let(:coupons) do\n    [\n      {:item =&gt; \"AVOCADO\", :num =&gt; 2, :cost =&gt; 5.00},\n      {:item =&gt; \"BEER\", :num =&gt; 2, :cost =&gt; 20.00},\n      {:item =&gt; \"CHEESE\", :num =&gt; 3, :cost =&gt; 15.00}\n    ]\n  end\n</code></pre>\n\n<p>So these are the items it they go through. Along with the coupons and their values. Below is the tests apply_coupons will go through:</p>\n\n<pre><code>  describe \"#apply_coupons\" do\n    context \"base case - with perfect coupon (number of items identical):\" do\n      before(:each) do\n        @avocado = find_item('AVOCADO')\n        @avocado_coupon = coupons.find { |coupon| coupon[:item] == \"AVOCADO\" }\n        @cart = [@avocado, @avocado]\n        @consolidated_cart = consolidate_cart(@cart)\n        @avocado_result = apply_coupons(@consolidated_cart, [@avocado_coupon])\n      end\n\n      it \"adds a new key, value pair to the cart hash called 'ITEM NAME W/COUPON'\" do\n        expect(@avocado_result.keys).to include(\"AVOCADO W/COUPON\")\n      end\n\n      it \"adds the coupon price to the property hash of couponed item\" do\n        expect(@avocado_result[\"AVOCADO W/COUPON\"][:price]).to eq(2.50)\n      end\n\n      it \"adds the count number to the property hash of couponed item\" do\n        expect(@avocado_result[\"AVOCADO W/COUPON\"][:count]).to eq(2)\n      end\n\n      it \"removes the number of discounted items from the original item's count\" do\n        expect(@avocado_result[\"AVOCADO\"][:price]).to eq(3.00)\n        expect(@avocado_result[\"AVOCADO\"][:count]).to eq(0)\n      end\n\n      it \"remembers if the item was on clearance\" do\n        expect(@avocado_result[\"AVOCADO W/COUPON\"][:clearance]).to eq(true)\n      end\n\n    end\n\n    context \"more advanced cases:\" do\n\n      it \"accounts for when there are more items than the coupon allows\" do\n        cheese = find_item('CHEESE')\n        cart = Array.new(5, cheese)\n        consolidated_cart = consolidate_cart(cart)\n        cheese_coupon = find_coupon(\"CHEESE\")\n        cheese_result = apply_coupons(consolidated_cart, [cheese_coupon])\n\n        expect(cheese_result[\"CHEESE\"][:price]).to eq(6.50)\n        expect(cheese_result[\"CHEESE\"][:count]).to eq(2)\n        expect(cheese_result[\"CHEESE W/COUPON\"][:price]).to eq(5.00)\n        expect(cheese_result[\"CHEESE W/COUPON\"][:count]).to eq(3)\n        expect(cheese_result[\"CHEESE W/COUPON\"][:clearance]).to eq(false)\n      end\n\n      it \"doesn't break if the coupon doesn't apply to any items\" do\n        cheese = find_item('CHEESE')\n        cart = Array.new(2, cheese)\n        consolidated_cart = consolidate_cart(cart)\n\n        irrelevant = apply_coupons(consolidated_cart, [find_coupon(\"AVOCADO\")])\n        expect(irrelevant[\"CHEESE\"][:price]).to eq(6.50)\n        expect(irrelevant[\"CHEESE\"][:count]).to eq(2)\n        expect(irrelevant.keys).to_not include(\"AVOCADO W/COUPON\")\n        expect(irrelevant.keys).to_not include(\"AVOCADO\")\n      end\n\n      it \"can apply multiple coupons\" do\n        avocado = find_item('AVOCADO')\n        cheese = find_item('CHEESE')\n        cart = Array.new(4, cheese)\n        3.times { cart &lt;&lt; avocado }\n        consolidated_cart = consolidate_cart(cart)\n        coupons = [find_coupon(\"AVOCADO\"), find_coupon(\"CHEESE\")]\n\n        multiple_coupons = apply_coupons(consolidated_cart, coupons)\n\n        [\"AVOCADO\", \"CHEESE\"].each { |item| expect(multiple_coupons[item][:count]).to eq(1) }\n        expect(multiple_coupons[\"CHEESE\"][:price]).to eq(6.50)\n        expect(multiple_coupons[\"AVOCADO\"][:price]).to eq(3.00)\n        expect(multiple_coupons[\"CHEESE W/COUPON\"][:price]).to eq(5.00)\n        expect(multiple_coupons[\"CHEESE W/COUPON\"][:count]).to eq(3)\n        expect(multiple_coupons[\"CHEESE W/COUPON\"][:clearance]).to eq(false)\n        expect(multiple_coupons[\"AVOCADO W/COUPON\"][:price]).to eq(2.50)\n        expect(multiple_coupons[\"AVOCADO W/COUPON\"][:count]).to eq(2)\n        expect(multiple_coupons[\"AVOCADO W/COUPON\"][:clearance]).to eq(true)\n      end\n\n      it \"doesn't break if there is no coupon\" do\n        cheese = items.find { |item| item['CHEESE'] }\n        cart = [cheese, cheese]\n        consolidated_cart = consolidate_cart(cart)\n        no_coupon_result = apply_coupons(consolidated_cart, [])\n\n        expect(no_coupon_result[\"CHEESE\"][:price]).to eq(6.50)\n        expect(no_coupon_result[\"CHEESE\"][:count]).to eq(2)\n      end\n\n      it \"can increment coupon count if two are applied\" do\n        avocado = find_item(\"AVOCADO\")\n        coupon = find_coupon(\"AVOCADO\")\n        consol_cart = consolidate_cart([avocado, avocado, avocado, avocado, avocado])\n        two_coupon_result = apply_coupons(consol_cart, [coupon, coupon])\n\n        expect(two_coupon_result[\"AVOCADO\"][:count]).to eq(1)\n        expect(two_coupon_result[\"AVOCADO W/COUPON\"][:price]).to eq(2.50)\n        expect(two_coupon_result[\"AVOCADO\"][:price]).to eq(3.00)\n        expect(two_coupon_result[\"AVOCADO W/COUPON\"][:count]).to eq(4)\n      end\n    end\n  end\n</code></pre>\n\n<p>Now, my code so far passes up until the advance case of applying multiple coupons but also<br>\ncan apply multiple coupons (FAILED - 1)\ndoesn't break if there is no coupon (FAILED - 2)\ncan increment coupon count if two are applied (FAILED - 3):</p>\n\n<pre><code>def apply_coupons(cart, coupons)\n  #cart is a hash with 2 keys with a nested hash with 3 values\n  #coupons is an array with a hash with 3 keys and 3 values\n  #if coupons[0].values.include?(cart.keys[0]) will find avocado in coupon\n  #coupons[0].values[0] is AVOCADO in coupon\n  #cart.keys[0] is AVOCADO in cart\n  #coupons[0].values[0] + \" W/COUPON\" creates \"AVOCADO W/COUPON\"\n  #coupons[0].values[1] = 2 the number of coupons\n  #coupons[0].values[2] = 5.0 which is the number off need to be divded by 2(number of coupons)\n\n  applyCoupons = {}\n\n    coupons.each do |k| \n\n    if coupons.include?(\" W/COUPON\")\n      applyCoupons[coupons[0].values[0] + \" W/COUPON\"]\n      applyCoupons[coupons[0].values[0] + \" W/COUPON\"][:price] = coupons[0].values[2] / coupons[0].values[1] \n      applyCoupons[coupons[0].values[0] + \" W/COUPON\"][:clearance] = cart.values[0].has_value?(true)\n      applyCoupons[coupons[0].values[0]][:count] += 1\n    end\n\n    if cart.keys[0] == coupons[0].values[0] \n      applyCoupons[cart.keys[0]] = cart.values[0]\n      applyCoupons[coupons[0].values[0] + \" W/COUPON\"] = {}\n      applyCoupons[coupons[0].values[0] + \" W/COUPON\"][:price] = coupons[0].values[2] / coupons[0].values[1] \n       applyCoupons[coupons[0].values[0] + \" W/COUPON\"][:clearance] = cart.values[0].has_value?(true)\n       applyCoupons[coupons[0].values[0] + \" W/COUPON\"][:count] = coupons[0].values[1]\n       applyCoupons[coupons[0].values[0]][:count] -= coupons[0].values[1]\n    else\n      applyCoupons[cart.keys[0]] = cart.values[0]\n    end\n  end\n  applyCoupons\nend\n</code></pre>\n\n<p>The error I get:\nFailures:</p>\n\n<p>1) Grocer #apply_coupons more advanced cases: can apply multiple coupons\n     Failure/Error: [\"AVOCADO\", \"CHEESE\"].each { |item| expect(multiple_coupons[item][:count]).to eq(1) }</p>\n\n<pre><code> NoMethodError:\n   undefined method `[]' for nil:NilClass\n # ./spec/grocer_spec.rb:121:in `block (5 levels) in &lt;top (required)&gt;'\n # ./spec/grocer_spec.rb:121:in `each'\n # ./spec/grocer_spec.rb:121:in `block (4 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>This is a big ask but I am learning so any help is appreciated. Would love to learn methods that will make my code simpler too.</p>\n"}]