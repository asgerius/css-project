[{"tags": ["ruby", "parallel-processing", "chef-infra", "knife"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1526511662, "post_id": 50380194, "comment_id": 87778305, "body": "The backtick method waits for output, it blocks. You need a non-blocking approach like <a href=\"https://docs.ruby-lang.org/en/2.5.0/Open3.html\" rel=\"nofollow noreferrer\"><code>popen3</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1526521528, "creation_date": 1526521528, "answer_id": 50382179, "question_id": 50380194, "link": "https://stackoverflow.com/questions/50380194/ruby-run-parallel-tasks-in-background-and-return-results-without-displaying-stdo/50382179#50382179", "title": "ruby run parallel tasks in background and return results without displaying stdout?", "body": "<p>You probably want to be using one of the APIs like chef-api for Ruby or PyChef for Python.</p>\n"}], "owner": {"reputation": 1, "user_id": 2113352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81c169a52279804d9dcb5822e04fd848?s=128&d=identicon&r=PG", "display_name": "Stromweld", "link": "https://stackoverflow.com/users/2113352/stromweld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526521528, "creation_date": 1526506252, "question_id": 50380194, "link": "https://stackoverflow.com/questions/50380194/ruby-run-parallel-tasks-in-background-and-return-results-without-displaying-stdo", "title": "ruby run parallel tasks in background and return results without displaying stdout?", "body": "<p>I am working on a chef knife bootstrap script and am trying to make it work on windows or POSIX based systems. In it I'm trying to query chef-server for roles and environments. On windows the queries can take up to 30 seconds, so I'm trying to run them in parallel and in the background and store the values to be called upon later as I ask the user for other input and then eventually to pick a role and environment returned from the queries. For the life of me I can not figure out how to get queries to run in the background without pause the main program.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>chef_role = `knife search role '*:*' -i`.split.map { |i| { name: i } }.sort_by! { |n| n[:name] }\nchef_env = `knife search environment '*' -i`.split.map { |i| { name: i } }.sort_by! { |n| n[:name] }\n# Parallel fetch chef resources\nknife_search = [chef_role, chef_env]\npar = []\ni = 0\nknife_search.each do |search|\n  par[i] = Thread.new do\n    search\n  end\n  i += 1\nend\npar.each(&amp;:join)\nputs \"Test1 = #{chef_role.inspect} | Test2 = #{chef_env.inspect}\"\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1526524646, "post_id": 50379430, "comment_id": 87780850, "body": "Your example is not very great. The elements you gave in the array can be easily confused with the indices. They look too similar."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1526667355, "post_id": 50379890, "comment_id": 87849825, "body": "@CarySwoveland I was inspired"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 4, "last_activity_date": 1526562028, "last_edit_date": 1526562028, "creation_date": 1526504798, "answer_id": 50379890, "question_id": 50379430, "link": "https://stackoverflow.com/questions/50379430/how-to-find-indices-of-max-n-elements-in-array-in-stable-order/50379890#50379890", "title": "How to find indices of max n elements in array in stable order", "body": "<p>You can supply a block to <code>max</code> to make the determination more specific like so </p>\n\n<pre><code>a.each_with_index.max(n) do |a,b| \n  if a[0] == b[0] # the numbers are the same\n    b[1] &lt;=&gt; a[1] # compare the indexes in reverse\n  else\n    a[0] &lt;=&gt; b[0] # compare the numbers themselves\n  end\nend.map(&amp;:last) \n#=&gt; [5,3,4,2]\n</code></pre>\n\n<p><code>max</code> block expects a comparable response e.g. -1,0,1 so in this case we are just saying if the number is the same then compare the indexes in reverse order e.g. <code>4 &lt;=&gt; 3 #=&gt; -1</code> the -1 indicates this values is less so that will then be placed after 3 </p>\n\n<p>Also to expand on @CarySwoveland's answer (which I am a bit jealous I did not think of), since you only care about returning the indices we could implement as follows without a secondary <code>map</code></p>\n\n<pre><code>a.each_index.max_by(n) { |x| [a[x],-x] }\n#=&gt; [5,3,4,2]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526522091, "post_id": 50380404, "comment_id": 87780375, "body": "Beautiful. Exactly the answer I came up with."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1526561383, "post_id": 50380404, "comment_id": 87799358, "body": "While I applaud your, always, thorough answers your original implementation is still referenced in the <i>Continuing</i> section but the new implementation (which is much nicer by the way) no longer uses <code>min_by</code>"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 5, "last_activity_date": 1526569001, "last_edit_date": 1526569001, "creation_date": 1526507353, "answer_id": 50380404, "question_id": 50379430, "link": "https://stackoverflow.com/questions/50379430/how-to-find-indices-of-max-n-elements-in-array-in-stable-order/50380404#50380404", "title": "How to find indices of max n elements in array in stable order", "body": "<p><strong>Code</strong></p>\n\n<pre><code>def max_with_order(arr, n)\n   arr.each_with_index.max_by(n) { |x,i| [x,-i] }.map(&amp;:last)\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>a = [0,1,2,3,3,4]\n\nmax_with_order(a, 1)  #=&gt; [5]\nmax_with_order(a, 2)  #=&gt; [5, 3]\nmax_with_order(a, 3)  #=&gt; [5, 3, 4]\nmax_with_order(a, 4)  #=&gt; [5, 3, 4, 2]\nmax_with_order(a, 5)  #=&gt; [5, 3, 4, 2, 1]\nmax_with_order(a, 6)  #=&gt; [5, 3, 4, 2, 1, 0]\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>For <code>n = 3</code> the steps are as follows.</p>\n\n<pre><code>b = a.each_with_index\n  #=&gt; #&lt;Enumerator: [0, 1, 2, 3, 3, 4]:each_with_index&gt;\n</code></pre>\n\n<p>We can convert <code>b</code> to an array to see the (six) values it will generate and pass to the block.</p>\n\n<pre><code>b.to_a                \n  #=&gt; [[0, 0], [1, 1], [2, 2], [3, 3], [3, 4], [4, 5]]\n</code></pre>\n\n<p>Continuing,</p>\n\n<pre><code>c = b.max_by(n) { |x,i| [x,-i] }\n  #=&gt; [[4, 5], [3, 3], [3, 4]]\nc.map(&amp;:last)\n  #=&gt; [5, 3, 4]\n</code></pre>\n\n<p>Note that the elements of <code>arr</code> need not be numeric, merely comparable.</p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1526561536, "post_id": 50381323, "comment_id": 87799460, "body": "This does not actually do anything other than potentially changing the value of <code>i</code>, dependent on the order of the values in <code>a</code>, and the return value will be <code>[0,1,2,3,3,4]</code> because <code>each</code> will return the <code>Enumerable</code> upon completion of the iteration"}], "tags": [], "owner": {"reputation": 599, "user_id": 586195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNRg4.png?s=128&g=1", "display_name": "OfficeYA", "link": "https://stackoverflow.com/users/586195/officeya"}, "is_accepted": false, "score": 0, "last_activity_date": 1526514180, "last_edit_date": 1526514180, "creation_date": 1526513391, "answer_id": 50381323, "question_id": 50379430, "link": "https://stackoverflow.com/questions/50379430/how-to-find-indices-of-max-n-elements-in-array-in-stable-order/50381323#50381323", "title": "How to find indices of max n elements in array in stable order", "body": "<p>@compsy you wrote <strong>without</strong> changing order, so it would be:</p>\n\n<pre><code>a = [0,1,2,3,3,4]\nn = a.max\ni = 0\na.each do |x|\n  break if x == n\n  i += 1\nend\n</code></pre>\n\n<p>I use variable <em>i</em> as index, when <em>x</em> (which is the value beeing analized) is equals <em>n</em> we use <em>break</em> to stop the <em>each</em> method conserving the last value of <em>i</em> wich corresponds to the position of the max value at the array. Be aware that value of <em>i</em> is different by one of the natural position in the array, and tht is because in arrays the first element is 0 not 1.</p>\n\n<p>I <em>break</em> the <em>each</em> because there is no need to keep checking all the other values of the array after we found the position of the value.</p>\n"}], "owner": {"reputation": 173, "user_id": 8508408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53ea69f3734d6b9383a35531d4c011bb?s=128&d=identicon&r=PG&f=1", "display_name": "compsy", "link": "https://stackoverflow.com/users/8508408/compsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 50380404, "answer_count": 3, "score": 0, "last_activity_date": 1526569001, "creation_date": 1526502585, "last_edit_date": 1526524074, "question_id": 50379430, "link": "https://stackoverflow.com/questions/50379430/how-to-find-indices-of-max-n-elements-in-array-in-stable-order", "title": "How to find indices of max n elements in array in stable order", "body": "<p>I have a number and an array:</p>\n\n<pre><code>n = 4\na = [0, 1, 2, 3, 3, 4]\n</code></pre>\n\n<p>I want to find the indices corresponding to the maximal <code>n</code> elements of <code>a</code> in the reverse order of the element size, and in stable order when the element sizes are equal. The expected output is:</p>\n\n<pre><code>[5, 3, 4, 2]\n</code></pre>\n\n<p>This code:</p>\n\n<pre><code>a.each_with_index.max(n).map(&amp;:last) \n# =&gt; [5, 4, 3, 2]\n</code></pre>\n\n<p>gives the right indices, but changes the order.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 309, "user_id": 8539925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3FIuP.jpg?s=128&g=1", "display_name": "Omar Donnadieu Mercado", "link": "https://stackoverflow.com/users/8539925/omar-donnadieu-mercado"}, "edited": false, "score": 0, "creation_date": 1526511563, "post_id": 50379311, "comment_id": 87778277, "body": "Hello Mark,  I would suggest creating a helper method to calculate that amount. Since you need to access the variables that you mentioned above, and then use it inside the loop."}, {"owner": {"reputation": 11, "user_id": 2747405, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002225860244/picture?type=large", "display_name": "Mark Rybarczyk", "link": "https://stackoverflow.com/users/2747405/mark-rybarczyk"}, "reply_to_user": {"reputation": 309, "user_id": 8539925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3FIuP.jpg?s=128&g=1", "display_name": "Omar Donnadieu Mercado", "link": "https://stackoverflow.com/users/8539925/omar-donnadieu-mercado"}, "edited": false, "score": 0, "creation_date": 1526581439, "post_id": 50379311, "comment_id": 87812035, "body": "Thanks for the comment Omar, I was able to figure this out.  Posted my solution in my edit."}], "owner": {"reputation": 11, "user_id": 2747405, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002225860244/picture?type=large", "display_name": "Mark Rybarczyk", "link": "https://stackoverflow.com/users/2747405/mark-rybarczyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526581391, "creation_date": 1526502101, "last_edit_date": 1526581391, "question_id": 50379311, "link": "https://stackoverflow.com/questions/50379311/access-variable-outside-of-loop-in-table-to-total-columns", "title": "Access variable outside of loop in table to total columns", "body": "<p>I have a table where I am looping thru affiliate_sales which is giving me most of the data that I need with the exception of calculating a grand total of the \"total earned\" column.  </p>\n\n<pre class=\"lang-erb prettyprint-override\"><code>&lt;thead&gt;\n        &lt;tr&gt;\n            &lt;td&gt;&lt;strong&gt;Model Name&lt;/strong&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;strong&gt;Subscriber's Email&lt;/strong&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;strong&gt;Subscription Amount&lt;/strong&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;strong&gt;Your Share&lt;/strong&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;strong&gt;Lifetime *&lt;/strong&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;strong&gt;Date Started&lt;/strong&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;strong&gt;Date Canceled&lt;/strong&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;strong&gt;Payments&lt;/strong&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;strong&gt;Total Earned&lt;/strong&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n          &lt;% @affiliate_sales.each do |sales| %&gt;\n          &lt;!-- figure out number of payments made --&gt;\n            &lt;% if sales.active? &amp;&amp; sales.lifetime.blank? %&gt;\n                &lt;% active_payments = ((Date.today.year * 12 + Date.today.month) - (sales.created_at.year * 12 + sales.created_at.month) + 1) %&gt;\n            &lt;% end %&gt;\n            &lt;% if sales.active === false  &amp;&amp; sales.lifetime.blank? %&gt;\n                &lt;% canceled_payments = ((sales.end_date.year * 12 + sales.end_date.month) - (sales.created_at.year * 12 + sales.created_at.month)) %&gt;\n            &lt;% end %&gt;\n            &lt;!-- end payments calc --&gt;\n            &lt;% if active_payments.present? %&gt;\n                    &lt;% total_active_payments = (sales.cost * 0.25) * (active_payments) %&gt;\n            &lt;% end %&gt;\n            &lt;% if canceled_payments.present? %&gt;\n                &lt;% total_canceled_payments = (sales.cost * 0.25) * (canceled_payments) %&gt;\n            &lt;% end %&gt;\n            &lt;tr&gt;\n                &lt;td&gt;&lt;%= sales.model.stage_name %&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;%= sales.user.email %&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;%= number_to_currency(sales.cost) %&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;%= number_to_currency(sales.cost * 0.25) %&gt;&lt;/td&gt;\n                &lt;td&gt;\n                    &lt;% if sales.lifetime? %&gt;\n                        yes\n                    &lt;% else %&gt;\n                        no\n                    &lt;% end %&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;%= Time.at(sales.created_at).to_datetime.strftime(\"%B %d, %Y\") %&gt;&lt;/td&gt;\n                &lt;% if sales.end_date.present? %&gt;\n                    &lt;td&gt;&lt;%= Time.at(sales.end_date).to_datetime.strftime(\"%B %d, %Y\") %&gt;&lt;/td&gt;\n                &lt;% else %&gt;\n                    &lt;td&gt;active&lt;/td&gt;\n                &lt;% end %&gt;\n                &lt;!-- start of column payments  --&gt;\n                &lt;% if active_payments.present? %&gt;\n                    &lt;td&gt;&lt;%= active_payments %&gt;&lt;/td&gt;\n                &lt;% end %&gt;\n                &lt;% if canceled_payments.present? %&gt;\n                    &lt;td&gt;&lt;%= canceled_payments %&gt;&lt;/td&gt;\n                &lt;% end %&gt;\n                &lt;!-- end of number of payments made --&gt;\n                &lt;!-- start total earned --&gt;\n                &lt;% if total_active_payments.present? %&gt;\n                    &lt;td&gt;&lt;%= number_to_currency(total_active_payments) %&gt;&lt;/td&gt;\n                &lt;% end %&gt;\n                &lt;% if total_canceled_payments.present? %&gt;\n                    &lt;td&gt;&lt;%= number_to_currency(total_canceled_payments) %&gt;&lt;/td&gt;\n                &lt;% end %&gt;\n                &lt;!-- end total of payments --&gt;\n            &lt;/tr&gt;\n        &lt;% end %&gt;\n            &lt;tr class=\"totals\"&gt;\n        &lt;td&gt;Totals&lt;/td&gt;\n        &lt;td&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= number_to_currency @affiliate_sales_total %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n      &lt;/tbody&gt;\n</code></pre>\n\n<p>One of my calculations is to figure out how many monthly payments have been made by a subscriber, which I am doing successfully with the variables active_payments and canceled_payments within my loop. </p>\n\n<p>From there I am multiplying the number of payments made by the cost of the subscription times the affiliates percentage, which gives me the \"total earned (total_active_payments and total_canceled_payments) on each subscription for the affiliate. </p>\n\n<p>In my \"totals\" row (outside of the loop) I'm using a method in my affiliate_sites_controller which calculates the total costs of the subscriptions:</p>\n\n<pre><code>def affiliate_sales\n  if current_user.affiliate_sites.present?\n    Subscription.where(teddys_affiliate_site_token: current_user.affiliate_sites.first.affiliate_site_token)\n  end\nend\n\ndef affiliate_canceled_subs\n  if current_user.affiliate_sites.present?\n    Subscription.where(active: false, teddys_affiliate_site_token: current_user.affiliate_sites.first.affiliate_site_token)\n  end\nend\n\ndef affiliate_sales_total\n  if current_user.affiliate_sites.present?\n    affiliate_sales.sum(:cost) * 0.25\n  end\nend\n</code></pre>\n\n<p>Where I'm running into problems is trying to add up the \"total earned\" column as a grand total.  Since I'm not able to access those variable outside of the loop, is there another way to figure this out?  </p>\n\n<p>Here's my controller:</p>\n\n<pre><code>before_action :authenticate_user!\n\ndef new\n    @affiliate_site = current_user.affiliate_sites.new\nend\n\ndef show\n  @affiliate_site = current_user.affiliate_sites.first\n  @affiliate_site_token = affiliate_site_token\n  @affiliate_sales = affiliate_sales\n  @affiliate_sales_total = affiliate_sales_total\n  @progress_bar = percentage_to_payout\n  @affiliate_canceled_subs = affiliate_canceled_subs\nend\n\ndef create\n  @affiliate_site = current_user.affiliate_sites.new(affiliate_site_params)\n  if @affiliate_site.save\n  # send_model_application_email\n    redirect_to profile_path(current_user), notice: \"Your Affiliate information has been successfully submitted!\"\n  else\n    render :new\n  end\nend\n\ndef edit\n  @affiliate_site = current_user.affiliate_sites.first\nend\n\ndef update\n  @affiliate_site = current_user.affiliate_sites.first\n  if @affiliate_site.update(affiliate_site_params)\n    redirect_to affiliate_site_path(current_user.affiliate_sites.first), notice: \"Your information has been successfully updated!\"\n  else\n    render :edit\n  end\nend\n\ndef affiliate_site_token\n  if current_user.affiliate_sites.present?\n    current_user.affiliate_sites.first.affiliate_site_token\n  end\nend\n\ndef affiliate_sales\n  if current_user.affiliate_sites.present?\n    Subscription.where(teddys_affiliate_site_token: current_user.affiliate_sites.first.affiliate_site_token)\n  end\nend\n\ndef affiliate_canceled_subs\n  if current_user.affiliate_sites.present?\n    Subscription.where(active: false, teddys_affiliate_site_token: current_user.affiliate_sites.first.affiliate_site_token)\n  end\nend\n\ndef affiliate_sales_total\n  if current_user.affiliate_sites.present?\n    affiliate_sales.sum(:cost) * 0.25\n  end\nend\n\ndef affiliate_rebills\n  active_subscriptions = Subscription.where(teddys_affiliate_site_token: current_user.affiliate_sites.first.affiliate_site_token, active: true, lifetime: [false, nil])\n  # figure out number of months it has rebilled\n  (Date.today.year * 12 + Date.today.month) - (active_subscriptions.created_at.year * 12 + active_subscriptions.created_at.month)\nend\n\ndef rebills_before_canceled\n  canceled_subscriptions = Subscription.where(teddys_affiliate_site_token: current_user.affiliate_sites.first.affiliate_site_token, active: false, lifetime: [false, nil]) &amp;&amp; Subscription.end_date?\n    (canceled_subscriptions.end_date.year * 12 + canceled_subscriptions.end_date.month) - (canceled_subscriptions.created_at.year * 12 + canceled_subscriptions.created_at.month)\nend\n\ndef percentage_to_payout\n  if current_user.affiliate_sites.present?\n    result = (affiliate_sales_total / 50.0) * 100\n    return result.to_s.at(0..4) + '%'\n  end\nend\n\nprivate\n\n  def affiliate_site_params\n    params.require(:affiliate_site).permit(:full_name, :company_name, :tax_id, :affiliate_site_token, :website, :email, :user_id, :affiliate_terms)\n  end\nend\n</code></pre>\n\n<p>EDIT:  So, I was able to figure this out.  After refactoring my logic heavy view, I created 2 methods in my subscription.rb model, to calculate the number of payments made by a subscriber:</p>\n\n<pre><code>def total_active_payments\n    ((Date.today.year * 12 + Date.today.month) - (created_at.year * 12 + created_at.month) + 1)\nend\n\ndef canceled_subscription_payments\n    ((end_date.year * 12 + end_date.month) - (created_at.year * 12 + created_at.month))\nend\n</code></pre>\n\n<p>then I added 2 new methods in my controller:</p>\n\n<pre><code>def grand_total_active_payments\n  grand_total_active_payments = 0\n  Subscription.where(teddys_affiliate_site_token: current_user.affiliate_sites.first.affiliate_site_token, active: true).each do |sub|\n    grand_total_active_payments += ((sub.cost * 0.25) * sub.total_active_payments)\n  end\n  grand_total_active_payments\nend\n\ndef grand_total_canceled_payments\n  grand_total_canceled_payments = 0\n  Subscription.where(teddys_affiliate_site_token: current_user.affiliate_sites.first.affiliate_site_token, active: false).each do |sub|\n    grand_total_canceled_payments += ((sub.cost * 0.25) * sub.canceled_subscription_payments)\n  end\n  grand_total_canceled_payments\nend\n</code></pre>\n\n<p>then I simply added those two instances together in my view:</p>\n\n<pre><code>&lt;tr class=\"totals\"&gt;\n  &lt;td&gt;Totals&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= number_to_currency @affiliate_sales_total %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= number_to_currency(@grand_total_active_payments + @grand_total_canceled_payments) %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n</code></pre>\n"}, {"tags": ["ruby", "activerecord", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 1669, "user_id": 1441037, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/85eec3ad4f6bcfe601a20cfa80a932d5?s=128&d=identicon&r=PG", "display_name": "Evan V", "link": "https://stackoverflow.com/users/1441037/evan-v"}, "edited": false, "score": 0, "creation_date": 1526577901, "post_id": 50380879, "comment_id": 87810201, "body": "Boom! Thank you."}], "tags": [], "owner": {"reputation": 1808, "user_id": 9184597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7875ba2d289a9f0e410a82fb7f15f03?s=128&d=identicon&r=PG&f=1", "display_name": "R.F. Nelson", "link": "https://stackoverflow.com/users/9184597/r-f-nelson"}, "is_accepted": true, "score": 1, "last_activity_date": 1526578096, "last_edit_date": 1526578096, "creation_date": 1526510254, "answer_id": 50380879, "question_id": 50379269, "link": "https://stackoverflow.com/questions/50379269/activerecord-gem-shows-up-in-gem-list-but-get-file-not-found-error-when-trying-t/50380879#50380879", "title": "activerecord gem shows up in gem list but get file not found error when trying to load", "body": "<p>Credit to <a href=\"https://stackoverflow.com/questions/50191222/how-to-require-activerecord-in-irb?noredirect=1&amp;lq=1\">this post</a> for the following solution:</p>\n\n<p>Try this:</p>\n\n<pre><code>require 'bundler/setup'\nrequire 'active_record'\n</code></pre>\n\n<p>You'll need the first line to ensure your Bundler environment is loaded before attempting to require gems with dependencies.</p>\n\n<p>If you take a look at the <a href=\"https://github.com/rails/rails/tree/master/activerecord\" rel=\"nofollow noreferrer\">Github repo</a> for <code>activerecord</code>, the actual file name is <code>active_record.rb</code>, which explains the second line.</p>\n"}], "owner": {"reputation": 1669, "user_id": 1441037, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/85eec3ad4f6bcfe601a20cfa80a932d5?s=128&d=identicon&r=PG", "display_name": "Evan V", "link": "https://stackoverflow.com/users/1441037/evan-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1527707647, "accepted_answer_id": 50380879, "answer_count": 1, "score": 0, "last_activity_date": 1526578096, "creation_date": 1526501895, "question_id": 50379269, "link": "https://stackoverflow.com/questions/50379269/activerecord-gem-shows-up-in-gem-list-but-get-file-not-found-error-when-trying-t", "closed_reason": "Duplicate", "title": "activerecord gem shows up in gem list but get file not found error when trying to load", "body": "<p>I want to pull some data from the major league baseball gameday API and insert into a local MySQL database using ruby. </p>\n\n<p>I'm trying to use activerecord gem to insert data into MySQL DB but I can't get the activerecord gem to load. </p>\n\n<p>I try to load the activerecord gem in irb but get error:</p>\n\n<pre><code>    irb(main):008:0&gt; require 'activerecord'\nTraceback (most recent call last):\n        4: from /usr/bin/irb:11:in `&lt;main&gt;'\n        3: from (irb):8\n        2: from /usr/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n        1: from /usr/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\nLoadError (cannot load such file -- activerecord)\n</code></pre>\n\n<p>At first I thought activerecord wasn't installed correctly but when I pull the gem list in terminal it does show up. </p>\n\n<pre><code>$ gem list\n\n*** LOCAL GEMS ***\n\nactivemodel (5.2.0)\nactiverecord (5.2.0)\nactivesupport (5.2.0)\n...\n</code></pre>\n\n<p>Any suggestions on what might be wrong greatly appreciated!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 1, "creation_date": 1526501876, "post_id": 50379237, "comment_id": 87774725, "body": "Add to your post a sample of the <code>json</code> hash. Just a sample; and yes in general <code>.dig</code> is the right approach. Remember if your hash contain arrays you add their indices to <code>.dig</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526502322, "post_id": 50379237, "comment_id": 87774943, "body": "What result are you aiming for? What <i>exactly</i> do you mean by &quot;pull in the comments&quot;? If you&#39;re just asking &quot;can I use <code>Hash#dig</code> for this?&quot;, then the answer is yes."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526502425, "post_id": 50379237, "comment_id": 87774996, "body": "Or, you could use an <a href=\"https://github.com/avinashbot/redd\" rel=\"nofollow noreferrer\">existing API wrapper</a> if you&#39;re trying to do something &quot;complicated&quot;... (But since I don&#39;t know what you&#39;re doing, I can&#39;t advise on that!)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1526502747, "post_id": 50379237, "comment_id": 87775136, "body": "OK, looking at that sample JSON, your current attempt isn&#39;t going to work since the top level node in that JSON is <code>&quot;data&quot;</code>, not <code>&quot;children&quot;</code>. And you can&#39;t map directly from <code>&quot;children&quot;</code> to <code>&quot;data&quot;</code>, since it&#39;s actually an array. How about <code>json.dig(&quot;data&quot;, &quot;children&quot;).map { |child| child.dig(&quot;data&quot;, &quot;body&quot;) }</code> - is that what you&#39;re trying to do?"}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 1, "creation_date": 1526506385, "post_id": 50379237, "comment_id": 87776625, "body": "Dig digs through arrays; just put in the index you need. <code>json.dig(&#39;data&#39;, &#39;children&#39;, 0, &#39;data&#39;, &#39;body&#39;)</code>."}], "owner": {"reputation": 53, "user_id": 9802463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6711fadd723070dbdb68182ddaef1b15?s=128&d=identicon&r=PG&f=1", "display_name": "KyKy", "link": "https://stackoverflow.com/users/9802463/kyky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1526502511, "creation_date": 1526501686, "last_edit_date": 1526502511, "question_id": 50379237, "link": "https://stackoverflow.com/questions/50379237/ruby-using-dig-to-query-values-in-a-nested-hash-returning-blank", "title": "Ruby - Using .dig to query values in a nested hash - returning blank", "body": "<p>I'm attempting to pull comments from reddit.com/r/programming and output the comments in the terminal. I pull the json from reddit and then parse it into a nested hash, but am having trouble querying the hash to pull the comments. Is using HASH.dig the correct approach?</p>\n\n<pre><code>require 'net/http'\nrequire 'rubygems'\nrequire 'json'\n\nurl = 'https://www.reddit.com/r/programming/comments.json?sort=top&amp;t=all&amp;limit=10'\nuri = URI(url)\nresponse = Net::HTTP.get(uri)\njson = JSON.parse(response)\nputs json.dig(\"children\",\"data\",\"body\")\n</code></pre>\n\n<p>I'm looking output the comments one-by-one, but when I run the above, the output is blank. Here's a sample of the hash:</p>\n\n<pre><code>{\"kind\"=&gt;\"Listing\", \"data\"=&gt;{\"modhash\"=&gt;\"\", \"dist\"=&gt;10, \"children\"=&gt;[{\"kind\"=&gt;\"t1\", \"data\"=&gt;{\"subreddit_id\"=&gt;\"t5_2tbbg\", \"approved_at_utc\"=&gt;nil, \"edited\"=&gt;false, \"mod_reason_by\"=&gt;nil, \"banned_by\"=&gt;nil, \"author_flair_type\"=&gt;\"text\", \"removal_reason\"=&gt;nil, \"link_id\"=&gt;\"t3_8jwhvk\", \"author_flair_template_id\"=&gt;nil, \"likes\"=&gt;nil, \"replies\"=&gt;\"\", \"user_reports\"=&gt;[], \"saved\"=&gt;false, \"id\"=&gt;\"dz3b25e\", \"banned_at_utc\"=&gt;nil, \"mod_reason_title\"=&gt;nil, \"gilded\"=&gt;0, \"archived\"=&gt;false, \"report_reasons\"=&gt;nil, \"author\"=&gt;\"QueenCrownDown\", \"num_comments\"=&gt;1, \"can_mod_post\"=&gt;false, \"send_replies\"=&gt;true, \"parent_id\"=&gt;\"t3_8jwhvk\", \"score\"=&gt;1, \"approved_by\"=&gt;nil, \"over_18\"=&gt;false, \"mod_note\"=&gt;nil, \"collapsed\"=&gt;false, \"body\"=&gt;\"Any 25$ purchase or just Sunday Riley?! Def taking advantage of this I\u2019ve wanted to try good genes for ages. \", \"link_title\"=&gt;\"[misc] Sunday Riley good genes 7 day sample with a $25 purchase at Sephora. Code:GOODGOOD\",\n</code></pre>\n"}, {"tags": ["ruby", "selenium", "appium", "pageobjects", "appium-android"], "comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1526524274, "post_id": 50378334, "comment_id": 87780772, "body": "Your error says that element doesn&#39;t exist. Please include selenium tag when you are using selenium for automation. You are moving out of many people visibility who regularly check questions with selenium tag."}, {"owner": {"reputation": 405, "user_id": 1947573, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e203c0cfcdf3f8a3f44e7353dfade700?s=128&d=identicon&r=PG", "display_name": "RV_Dev", "link": "https://stackoverflow.com/users/1947573/rv-dev"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1526567013, "post_id": 50378334, "comment_id": 87803480, "body": "@Rajagopalan Yes it says element does not exist as it is hidden and will be visible if I click on a show more button."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1526567388, "post_id": 50378334, "comment_id": 87803768, "body": "No, it wouldn&#39;t say element doesn&#39;t exist while element is hidden, it would say element is invisible, that means element is coming into existence when you click the button, you better delete this question and repost again because it might have gone down so users of selenium might not have seen."}], "owner": {"reputation": 405, "user_id": 1947573, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e203c0cfcdf3f8a3f44e7353dfade700?s=128&d=identicon&r=PG", "display_name": "RV_Dev", "link": "https://stackoverflow.com/users/1947573/rv-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526566954, "creation_date": 1526497719, "last_edit_date": 1526566954, "question_id": 50378334, "link": "https://stackoverflow.com/questions/50378334/how-to-initialize-hidden-page-objects-using-appium-ruby", "title": "How to initialize hidden page objects using appium ruby", "body": "<p>I am using page object model for a mobile app. I am not able to initialize the elements that are hidden on the page but will be visible later in the test. Can someone please suggest what is the solution for it? Following is the code and error:</p>\n\n<pre><code>class AppDetails\n    include PageObject\n    attr_reader :appium_driver, :screen, :button, :header, :more_info, :type\n def initialize(driver, package_name)\n    @screen = driver.find_element(blaahh)\n    @button = driver.find_element(blaahh)\n    @more_info = driver.find_element(blaahh) **###hidden element**\n    @type = driver.find_element(blaahh) **###hidden element**\n end\nend\n</code></pre>\n\n<p>When I run automation I get following error:</p>\n\n<pre><code>Selenium::WebDriver::Error::NoSuchElementError: An element could not be located on the page using the given search parameters.\nNoSuchElementError: An element could not be located on the page using the given search parameters.\n    at AndroidDriver.callee$0$0$ (/Applications/Appium.app/Contents/Resources/app/node_modules/appium-android-driver/lib/commands/find.js:69:13)\n    at tryCatch (/Applications/Appium.app/Contents/Resources/app/node_modules/appium-android-driver/node_modules/babel-runtime/regenerator/runtime.js:67:40)\n    at GeneratorFunctionPrototype.invoke [as _invoke] (/Applications/Appium.app/Contents/Resources/app/node_modules/appium-android-driver/node_modules/babel-runtime/regenerator/runtime.js:315:22)\n    at GeneratorFunctionPrototype.prototype.(anonymous function) [as throw] (/Applications/Appium.app/Contents/Resources/app/node_modules/appium-android-driver/node_modules/babel-runtime/regenerator/runtime.js:100:21)\n    at GeneratorFunctionPrototype.invoke (/Applications/Appium.app/Contents/Resources/app/node_modules/appium-android-driver/node_modules/babel-runtime/regenerator/runtime.js:136:37)\n    at &lt;anonymous&gt;\n</code></pre>\n\n<p>Thanks,\nRV</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "web", "model-view-controller", "controller"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 1, "creation_date": 1526498587, "post_id": 50378110, "comment_id": 87773203, "body": "Read this: <a href=\"http://wiki.c2.com/?ModelViewController\" rel=\"nofollow noreferrer\">wiki.c2.com/?ModelViewController</a> . But your post is about to get put &quot;on hold&quot; for being too broad..."}], "answers": [{"tags": [], "owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "is_accepted": false, "score": 3, "last_activity_date": 1526500127, "last_edit_date": 1526500127, "creation_date": 1526499515, "answer_id": 50378740, "question_id": 50378110, "link": "https://stackoverflow.com/questions/50378110/rails-models-and-controllers/50378740#50378740", "title": "Rails models and controllers", "body": "<p>You should do this tutorial : <a href=\"http://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/getting_started.html</a> it pretty shows much everything about Rails concisely.</p>\n\n<p>But basically .. </p>\n\n<p><strong>Controllers</strong> are files that are the first endpoint to routes. When you type an address in the navbar you end up in a controller first. Then, inside your controller an action is triggered (Show, Index, Update ...). </p>\n\n<p>Actions can be blank it is not a problem. But most of the time there is some logic added. This logic can be loading some data, creating records in the database etc ...</p>\n\n<p>Once the action is completed a <strong>view</strong> is triggered. This view corresponds to the controller action that has been just been visited. It is usually an ERB file that will eventually produce an HTML file after the server side scripting is completed. </p>\n\n<p><strong>Models</strong> sit alongside controllers and views: they handle all the database data. This includes validations for the fields of specific tables (does an uploaded file exceed max size, can a field of a record be blank etc ...). One database table = one model.</p>\n"}, {"tags": [], "owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "is_accepted": true, "score": 0, "last_activity_date": 1526502326, "creation_date": 1526502326, "answer_id": 50379367, "question_id": 50378110, "link": "https://stackoverflow.com/questions/50378110/rails-models-and-controllers/50379367#50379367", "title": "Rails models and controllers", "body": "<p>The most simple explanation would be :</p>\n\n<p>Controllers talk to your views and models, they take requests from users (when a user is visiting your website, all requests go to the route.rb file, depending on how you set up the route.rb file the requests go to the right controller or directly to views, if you have static pages for example) and create responses.</p>\n\n<p>Models are handling the hard stuff, they communicate with the database and add/remove/edit any new data in the database and provide the controller with the data it needs.</p>\n\n<p>Views are just html files in which you can embed ruby code (views end with the .html.erb extension (erb is for embedded ruby)). They get the data they need from the database through controllers. The controller then sends the right views as a response to the user request.</p>\n\n<p>When are you supposed to create a new view,controller or model? That's very hard to answer without an example. Every application is specific and require a good amount of experience to set up your MVC correctly.</p>\n\n<p>This is the explanation from just another newbee in Rails, so don't take anything I wrote as completely true and correct.</p>\n\n<p>I would suggest you to look into some books for beginners which walk you through the whole process of creating a fully functional website in Rails. </p>\n\n<p>My suggestion would be to check out Michael Hartl's book <a href=\"https://www.railstutorial.org/\" rel=\"nofollow noreferrer\">The Ruby on Rails tutorial</a> or if you want to take a step further and learn Ruby and RoR in detail, visit <a href=\"https://www.theodinproject.com/\" rel=\"nofollow noreferrer\">The Odin Project</a>. Both are completely free and helped me a lot understand how Rails works. </p>\n"}], "owner": {"reputation": 504, "user_id": 6007401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5db6f7de076ae3e9e278f1cffa02326?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6007401/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "accepted_answer_id": 50379367, "answer_count": 2, "score": 1, "last_activity_date": 1526502326, "creation_date": 1526496743, "last_edit_date": 1526499591, "question_id": 50378110, "link": "https://stackoverflow.com/questions/50378110/rails-models-and-controllers", "title": "Rails models and controllers", "body": "<p>I am new to development. I've read a few books on rails and often times they dive straight into examples. In some examples they generate resources which includes models, views, controllers etc. while in others they generate models only and vice versa. When should controllers be generated?It'd be great if someone could shed some lights to this to help me begin. Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch"], "comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1526497284, "post_id": 50377911, "comment_id": 87772581, "body": "Is the all-nil one always the last one?"}, {"owner": {"reputation": 35, "user_id": 3235417, "user_type": "registered", "profile_image": "https://graph.facebook.com/18801567/picture?type=large", "display_name": "p4ndepravity", "link": "https://stackoverflow.com/users/3235417/p4ndepravity"}, "reply_to_user": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1526561171, "post_id": 50377911, "comment_id": 87799214, "body": "@Joe so far yes, at least that is my working assumption. There appears to be an <code>if data.nil? then return klass.new end</code> and for some reason the elasticsearch query (or the subsequent parsing) is including nil data at the end."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3235417, "user_type": "registered", "profile_image": "https://graph.facebook.com/18801567/picture?type=large", "display_name": "p4ndepravity", "link": "https://stackoverflow.com/users/3235417/p4ndepravity"}, "edited": false, "score": 0, "creation_date": 1526561246, "post_id": 50378251, "comment_id": 87799270, "body": "great point about breaking at the first non-nil variable, this is the answer i&#39;m looking for. thanks!"}, {"owner": {"reputation": 1619, "user_id": 288448, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/57f8ee211bf2020efb3b8bec42feeb33?s=128&d=identicon&r=PG", "display_name": "Ryan Sandridge", "link": "https://stackoverflow.com/users/288448/ryan-sandridge"}, "edited": false, "score": 0, "creation_date": 1526601608, "post_id": 50378251, "comment_id": 87819717, "body": "<code>send</code> will only work if there are <code>attr_reader</code>s on the object."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 1619, "user_id": 288448, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/57f8ee211bf2020efb3b8bec42feeb33?s=128&d=identicon&r=PG", "display_name": "Ryan Sandridge", "link": "https://stackoverflow.com/users/288448/ryan-sandridge"}, "edited": false, "score": 1, "creation_date": 1526638554, "post_id": 50378251, "comment_id": 87833285, "body": "Yes, good point @RyanSandridge... I would&#39;ve edited my answer but I&#39;ve just upvoted yours instead."}, {"owner": {"reputation": 35, "user_id": 3235417, "user_type": "registered", "profile_image": "https://graph.facebook.com/18801567/picture?type=large", "display_name": "p4ndepravity", "link": "https://stackoverflow.com/users/3235417/p4ndepravity"}, "reply_to_user": {"reputation": 1619, "user_id": 288448, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/57f8ee211bf2020efb3b8bec42feeb33?s=128&d=identicon&r=PG", "display_name": "Ryan Sandridge", "link": "https://stackoverflow.com/users/288448/ryan-sandridge"}, "edited": false, "score": 0, "creation_date": 1526652340, "post_id": 50378251, "comment_id": 87841792, "body": "I ended up using <code>resources += resource if resource.first.instance_variables.find {|field| resource.first.instance_variable_get(field)}</code> because I needed to handle a variety of classes with various attributes. Ultimately, the <code>.find</code> method worked because it returned nil if all the instance variables were nil. @RyanSandridge answer used the get method so I&#39;m not sure who should have the answer mark. Leaving it up to a dev to change as is appropriate. Thanks all"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1526498050, "last_edit_date": 1526498050, "creation_date": 1526497338, "answer_id": 50378251, "question_id": 50377911, "link": "https://stackoverflow.com/questions/50377911/how-do-i-check-that-all-attributes-values-in-a-class-or-json-object-are-nil/50378251#50378251", "title": "how do i check that all attributes/values in a class or json object are nil", "body": "<p>Someone may come up with a better way, but it seems you don't need to check all values of all objects, as the first value you check that's non-nil means that object is good.  I'd do something that checks each value up to the point that a non-nil value is found. It would also help efficiency if you can order tested fields with most likely to have a value first (e.g. <code>user_id</code> )</p>\n\n<pre><code>array.select do |object|\n  %i(user_id height age).find do |field_name| \n    object.send(field_name)\n  end\nend\n</code></pre>\n\n<p>If it's only the last object that needs to be tested, then even easier...</p>\n\n<pre><code>array.pop if %i(user_id height age).find {|field_name| array.last.send(field_name) }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 3235417, "user_type": "registered", "profile_image": "https://graph.facebook.com/18801567/picture?type=large", "display_name": "p4ndepravity", "link": "https://stackoverflow.com/users/3235417/p4ndepravity"}, "edited": false, "score": 0, "creation_date": 1526560539, "post_id": 50378298, "comment_id": 87798740, "body": "thanks, i did not know about the instance_variable method. even though i will likely mark a different response as answer, this is a great implementation."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1526498227, "last_edit_date": 1526498227, "creation_date": 1526497564, "answer_id": 50378298, "question_id": 50377911, "link": "https://stackoverflow.com/questions/50377911/how-do-i-check-that-all-attributes-values-in-a-class-or-json-object-are-nil/50378298#50378298", "title": "how do i check that all attributes/values in a class or json object are nil", "body": "<p>I'm sure there is a cleaner way, but just in case you need to map each object:</p>\n\n<pre><code>def are_attributes_not_nil?(my_object)\n  my_object.instance_variables.map{ |attr| my_object.send(attr.to_s[1..-1]).nil? }.uniq.include? false\nend\n</code></pre>\n\n<p>returns false if all attributes are nil</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 3235417, "user_type": "registered", "profile_image": "https://graph.facebook.com/18801567/picture?type=large", "display_name": "p4ndepravity", "link": "https://stackoverflow.com/users/3235417/p4ndepravity"}, "edited": false, "score": 0, "creation_date": 1526561762, "post_id": 50379065, "comment_id": 87799630, "body": "thanks for the response, but im unable to modify the Api::User class. otherwise this might have been my chosen solution. also, the data comes in the form of JSON and is converted to an array of objects, not vice versa."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 35, "user_id": 3235417, "user_type": "registered", "profile_image": "https://graph.facebook.com/18801567/picture?type=large", "display_name": "p4ndepravity", "link": "https://stackoverflow.com/users/3235417/p4ndepravity"}, "edited": false, "score": 0, "creation_date": 1526563082, "post_id": 50379065, "comment_id": 87800610, "body": "Ah, I misread the question in that case. But this still might give you an idea how to solve your problem."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1526500935, "creation_date": 1526500935, "answer_id": 50379065, "question_id": 50377911, "link": "https://stackoverflow.com/questions/50377911/how-do-i-check-that-all-attributes-values-in-a-class-or-json-object-are-nil/50379065#50379065", "title": "how do i check that all attributes/values in a class or json object are nil", "body": "<p>My solution involves first implementing a way to convert the objects into hashes before turning them into the JSON itself.</p>\n\n<pre><code>api_user_array #=&gt; [#&lt;Api::User:0x006546546 ... &gt;, #&lt;Api::User:0x006546542 ... &gt;]\napi_user_array = api_user_array.map(&amp;:to_h).reject { |hash| hash.values.all?(&amp;:nil?) }\n# should result in an array of hashes with at least one value not nil\n</code></pre>\n\n<p>This assumes that you implement the <em>Api::User#to_h</em> method. This could be something like this:</p>\n\n<pre><code>def attribute_names\n  %w[user_id height age]\nend\n\ndef to_h\n  attribute_names.each_with_object({}) { |attr, hash| hash[attr] = send(attr) }\n  # assuming all attributes have a getter, otherwise\n  attribute_names.each_with_object({}) { |attr, hash| hash[attr] = instance_variable_get(\"@#{attr}\") }\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1619, "user_id": 288448, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/57f8ee211bf2020efb3b8bec42feeb33?s=128&d=identicon&r=PG", "display_name": "Ryan Sandridge", "link": "https://stackoverflow.com/users/288448/ryan-sandridge"}, "is_accepted": false, "score": 2, "last_activity_date": 1526562908, "creation_date": 1526562908, "answer_id": 50392417, "question_id": 50377911, "link": "https://stackoverflow.com/questions/50377911/how-do-i-check-that-all-attributes-values-in-a-class-or-json-object-are-nil/50392417#50392417", "title": "how do i check that all attributes/values in a class or json object are nil", "body": "<p>I'd lean heavy on methods that <code>Enumerable</code> and <code>Object</code> give you. From <code>Enumerable</code> we can use <code>select</code> to choose only those elements of the array that meet some condition. That condition is that at least one of the instance variables is not <code>nil</code>, and for that we can use <code>any?</code>.</p>\n\n<p>From <code>Object</code> we will use <code>instance_variables</code> to get a collection of instance variables, and we will access the value of those instance variables with <code>instance_variable_get</code>.</p>\n\n<p>It would look something like this:</p>\n\n<pre><code>filtered_array = array.select do |object| \n  object.instance_variables.any? { |var| object.instance_variable_get(var) }\nend\n</code></pre>\n\n<p>Of course <code>any?</code> is efficient in that it will stop iteration and return true on the very first \"truthy\" variable. As suggested by SteveTurczyn if you only need to check the last value, it is even quicker.</p>\n\n<pre><code>filtered_array = array[0..-2] if array[-1].instance_variables.none? { |var| object.instance_variable_get(var) }\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3235417, "user_type": "registered", "profile_image": "https://graph.facebook.com/18801567/picture?type=large", "display_name": "p4ndepravity", "link": "https://stackoverflow.com/users/3235417/p4ndepravity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 50378251, "answer_count": 4, "score": 1, "last_activity_date": 1526562908, "creation_date": 1526495889, "question_id": 50377911, "link": "https://stackoverflow.com/questions/50377911/how-do-i-check-that-all-attributes-values-in-a-class-or-json-object-are-nil", "title": "how do i check that all attributes/values in a class or json object are nil", "body": "<p>I have a method that retrieves an elasticsearch query from an API and converts it to an array of JSON objects.</p>\n\n<p>In some cases, the last JSON object is not a nil object, but all the attributes have nil values.</p>\n\n<p>I'd like to avoid mapping over every object, but I need to filter out those JSON objects that have <strong>all</strong> nil values.</p>\n\n<p>for example:  </p>\n\n<pre><code>=&gt; [#&lt;Api::User:0x006546546\n      @user_id=1,\n      @height=70,\n      @age=25&gt;,\n    #&lt;Api::User:0x006546542\n      @user_id=nil\n      @height=nil\n      @age=nil&gt;]\n</code></pre>\n\n<p>I want to remove the all-nil object from the array either while it is in JSON format or after it is converted to an array of Api::User objects.</p>\n\n<p>Is a map the only way to check all values of all objects or is there a less resource-intensive method?</p>\n"}, {"tags": ["ruby", "service-accounts", "google-calendar-api"], "answers": [{"tags": [], "owner": {"reputation": 20989, "user_id": 148844, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/263aa1ae12d9757f78167b80e596c3df?s=128&d=identicon&r=PG", "display_name": "Chloe", "link": "https://stackoverflow.com/users/148844/chloe"}, "is_accepted": true, "score": 3, "last_activity_date": 1526495134, "creation_date": 1526495134, "answer_id": 50377730, "question_id": 50376820, "link": "https://stackoverflow.com/questions/50376820/how-do-i-authorize-a-service-account-for-google-calendar-api-in-ruby/50377730#50377730", "title": "How do I authorize a service account for Google Calendar API in Ruby?", "body": "<p>OK I found a way.</p>\n\n<p><a href=\"https://developers.google.com/api-client-library/ruby/auth/service-accounts\" rel=\"nofollow noreferrer\">https://developers.google.com/api-client-library/ruby/auth/service-accounts</a></p>\n\n<pre><code>require 'google/apis/calendar_v3'\nrequire 'googleauth'\n\n# Get the environment configured authorization\nscopes =  ['https://www.googleapis.com/auth/calendar']\nauthorization = Google::Auth.get_application_default(scopes)\n\n# Clone and set the subject\nauth_client = authorization.dup\nauth_client.sub = 'myemail@mydomain.com'\nauth_client.fetch_access_token!\n\n# Initialize the API\nservice = Google::Apis::CalendarV3::CalendarService.new\nservice.authorization = auth_client\n\n# Fetch the next 10 events for the user\ncalendar_id = 'primary'\nresponse = service.list_events(calendar_id,\n                               max_results: 10,\n                               single_events: true,\n                               order_by: 'startTime',\n                               time_min: Time.now.iso8601)\nputs 'Upcoming events:'\nputs 'No upcoming events found' if response.items.empty?\nresponse.items.each do |event|\n  start = event.start.date || event.start.date_time\n  puts \"- #{event.summary} (#{start})\"\nend\n</code></pre>\n\n<p>And</p>\n\n<pre><code>&gt;set GOOGLE_APPLICATION_CREDENTIALS=client_secrets.json\n\nC:\\Users\\Chloe\\workspace&gt;ruby quickstart.rb\nUpcoming events:\n- Test (2018-05-17)\n- SSL Certificate for CMS (2019-02-13)\n</code></pre>\n\n<p>But I wonder where it saves the refresh token and access token? All I have to do now is make it work for ephemeral file systems like Heroku and store the tokens in the database.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 4642696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pwJFz.jpg?s=128&g=1", "display_name": "Vasil Levski", "link": "https://stackoverflow.com/users/4642696/vasil-levski"}, "is_accepted": false, "score": 1, "last_activity_date": 1561438218, "creation_date": 1561438218, "answer_id": 56747012, "question_id": 50376820, "link": "https://stackoverflow.com/questions/50376820/how-do-i-authorize-a-service-account-for-google-calendar-api-in-ruby/56747012#56747012", "title": "How do I authorize a service account for Google Calendar API in Ruby?", "body": "<p>For anyone still looking this is what worked for me:</p>\n\n<pre><code>require 'google/apis/calendar_v3'\nrequire 'googleauth'\n\nscope = 'https://www.googleapis.com/auth/calendar'\n\nauthorizer = Google::Auth::ServiceAccountCredentials.make_creds(\n  json_key_io: File.open('/path/to/creds.json'),\n  scope: scope)\n\nauthorizer.fetch_access_token!\n\nservice = Google::Apis::CalendarV3::CalendarService.new\nservice.authorization = authorizer\n\ncalendar_id = 'primary'\nresponse = service.list_events(calendar_id,\n                               max_results: 10,\n                               single_events: true,\n                               order_by: 'startTime',\n                               time_min: Time.now.iso8601)\nputs 'Upcoming events:'\nputs 'No upcoming events found' if response.items.empty?\nresponse.items.each do |event|\n  start = event.start.date || event.start.date_time\n  puts \"- #{event.summary} (#{start})\"\nend\n</code></pre>\n\n<p>The trick was finding the docs for the google-auth-library-ruby\n<a href=\"https://github.com/googleapis/google-auth-library-ruby\" rel=\"nofollow noreferrer\">https://github.com/googleapis/google-auth-library-ruby</a></p>\n"}], "owner": {"reputation": 20989, "user_id": 148844, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/263aa1ae12d9757f78167b80e596c3df?s=128&d=identicon&r=PG", "display_name": "Chloe", "link": "https://stackoverflow.com/users/148844/chloe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2578, "favorite_count": 0, "accepted_answer_id": 50377730, "answer_count": 2, "score": 1, "last_activity_date": 1561438218, "creation_date": 1526491628, "question_id": 50376820, "link": "https://stackoverflow.com/questions/50376820/how-do-i-authorize-a-service-account-for-google-calendar-api-in-ruby", "title": "How do I authorize a service account for Google Calendar API in Ruby?", "body": "<p>How do I authorize a service account for Google Calendar API in Ruby? I tried the quick start guide, but it crashed.</p>\n\n<p><a href=\"https://developers.google.com/calendar/quickstart/ruby#step_3_set_up_the_sample\" rel=\"nofollow noreferrer\">https://developers.google.com/calendar/quickstart/ruby#step_3_set_up_the_sample</a></p>\n\n<code>quickstart.rb</code>\n\n<pre><code>require 'google/apis/calendar_v3'\nrequire 'googleauth'\nrequire 'googleauth/stores/file_token_store'\nrequire 'fileutils'\n\nOOB_URI = 'urn:ietf:wg:oauth:2.0:oob'.freeze\nAPPLICATION_NAME = 'Google Calendar API Ruby Quickstart'.freeze\nCLIENT_SECRETS_PATH = 'client_secrets.json'.freeze\nCREDENTIALS_PATH = 'token.yaml'.freeze\nSCOPE = Google::Apis::CalendarV3::AUTH_CALENDAR_READONLY\n\n##\n# Ensure valid credentials, either by restoring from the saved credentials\n# files or intitiating an OAuth2 authorization. If authorization is required,\n# the user's default browser will be launched to approve the request.\n#\n# @return [Google::Auth::UserRefreshCredentials] OAuth2 credentials\ndef authorize\n  client_id = Google::Auth::ClientId.from_file(CLIENT_SECRETS_PATH) ### LINE 19\n  token_store = Google::Auth::Stores::FileTokenStore.new(file: CREDENTIALS_PATH)\n  authorizer = Google::Auth::UserAuthorizer.new(client_id, SCOPE, token_store)\n  user_id = 'default'\n  credentials = authorizer.get_credentials(user_id)\n  if credentials.nil?\n    url = authorizer.get_authorization_url(base_url: OOB_URI)\n    puts 'Open the following URL in the browser and enter the ' \\\n         'resulting code after authorization:\\n' + url\n    code = gets\n    credentials = authorizer.get_and_store_credentials_from_code(\n      user_id: user_id, code: code, base_url: OOB_URI\n    )\n  end\n  credentials\nend\n\n# Initialize the API\nservice = Google::Apis::CalendarV3::CalendarService.new\nservice.client_options.application_name = APPLICATION_NAME\nservice.authorization = authorize\n\n# Fetch the next 10 events for the user\ncalendar_id = 'primary'\nresponse = service.list_events(calendar_id,\n                               max_results: 10,\n                               single_events: true,\n                               order_by: 'startTime',\n                               time_min: Time.now.iso8601)\nputs 'Upcoming events:'\nputs 'No upcoming events found' if response.items.empty?\nresponse.items.each do |event|\n  start = event.start.date || event.start.date_time\n  puts \"- #{event.summary} (#{start})\"\nend\n</code></pre>\n\n<code>Console</code>\n\n<pre><code>&gt;ruby quickstart.rb\nC:/ruby23/lib/ruby/gems/2.3.0/gems/googleauth-0.6.2/lib/googleauth/client_id.rb:97:in `from_hash': Expected top level property 'installed' or 'web' to be present. (RuntimeError)\n        from C:/ruby23/lib/ruby/gems/2.3.0/gems/googleauth-0.6.2/lib/googleauth/client_id.rb:83:in `block in from_file'\n        from C:/ruby23/lib/ruby/gems/2.3.0/gems/googleauth-0.6.2/lib/googleauth/client_id.rb:80:in `open'\n        from C:/ruby23/lib/ruby/gems/2.3.0/gems/googleauth-0.6.2/lib/googleauth/client_id.rb:80:in `from_file'\n        from quickstart.rb:19:in `authorize'\n        from quickstart.rb:39:in `&lt;main&gt;'\n</code></pre>\n\n<p>The (outdated) documentation for authorizing service accounts only has examples for Java and Python.</p>\n\n<p><a href=\"https://developers.google.com/identity/protocols/OAuth2ServiceAccount#authorizingrequests\" rel=\"nofollow noreferrer\">https://developers.google.com/identity/protocols/OAuth2ServiceAccount#authorizingrequests</a></p>\n\n<p>Old similar question with 0 answers: <a href=\"https://stackoverflow.com/questions/37635873/google-calendar-api-in-ruby-using-service-account\">Google Calendar API in Ruby using Service Account</a></p>\n"}, {"tags": ["ruby", "date", "error-messaging"], "comments": [{"owner": {"reputation": 1420, "user_id": 5045091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MAqXn.jpg?s=128&g=1", "display_name": "theterminalguy", "link": "https://stackoverflow.com/users/5045091/theterminalguy"}, "edited": false, "score": 1, "creation_date": 1526491791, "post_id": 50376557, "comment_id": 87769869, "body": "A better thing to do Ryan will be to create an exception. Just extend StandardError, create your own error class and then raise an exception with a detail message."}, {"owner": {"reputation": 141, "user_id": 8286358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/405e78d1a1ffc5810e717ec12205fda9?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8286358/ryan"}, "reply_to_user": {"reputation": 1420, "user_id": 5045091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MAqXn.jpg?s=128&g=1", "display_name": "theterminalguy", "link": "https://stackoverflow.com/users/5045091/theterminalguy"}, "edited": false, "score": 0, "creation_date": 1526502267, "post_id": 50376557, "comment_id": 87774919, "body": "I&#39;m a total noob, could you type out a code example?"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 8286358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/405e78d1a1ffc5810e717ec12205fda9?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8286358/ryan"}, "edited": false, "score": 0, "creation_date": 1526511305, "post_id": 50379531, "comment_id": 87778204, "body": "So how would I add the code in this comment, to my code above in my post ---&gt;  def valid_date( str, format=&quot;%m/%d/%Y&quot; )   Date.strptime(str,format) rescue false end"}], "tags": [], "owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "is_accepted": false, "score": 1, "last_activity_date": 1526503079, "creation_date": 1526503079, "answer_id": 50379531, "question_id": 50376557, "link": "https://stackoverflow.com/questions/50376557/creating-an-error-message-for-an-invalid-input/50379531#50379531", "title": "Creating an error message for an invalid input", "body": "<p>Probably the best way to do this is putting your input in a while loop, prompting for a new answer every time the input isn't what you expected it to be.</p>\n\n<p>To check the input you should use a <a href=\"https://ruby-doc.org/core-2.1.1/Regexp.html\" rel=\"nofollow noreferrer\">Regexp</a>. Here's an <a href=\"https://stackoverflow.com/questions/5978510/regex-to-match-date\">explanation</a>\nhow to write a regexp to match a date.</p>\n"}, {"tags": [], "owner": {"reputation": 1086, "user_id": 5201594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHVDD.jpg?s=128&g=1", "display_name": "rahul mishra", "link": "https://stackoverflow.com/users/5201594/rahul-mishra"}, "is_accepted": false, "score": 1, "last_activity_date": 1526528876, "creation_date": 1526528876, "answer_id": 50383040, "question_id": 50376557, "link": "https://stackoverflow.com/questions/50376557/creating-an-error-message-for-an-invalid-input/50383040#50383040", "title": "Creating an error message for an invalid input", "body": "<p>For Creating a Custom Error refer below code:\nHere I create and raise <code>InvalidDateError</code> for the wrong date input.</p>\n\n<pre><code>   #type in the month and year you want like so ---&gt; \"Feb 2034\"\nclass InvalidDateError &lt; StandardError\nend\n\nrequire 'date'\nrequire 'pry-byebug'\ninput = gets.chomp\n\ninputArray = input.split(\" \").to_a\n\ntextMonth = inputArray[0] \ntextYear = inputArray[1]\nbegin\n    startOfMonth = Date.strptime(input, \"%b %Y\")\n    nextMonth = startOfMonth.next_month\n    endOfMonth = nextMonth - 1\n    daysInMonth = (endOfMonth - startOfMonth + 1).to_i\n    puts \"#{textMonth} of year #{textYear} has #{daysInMonth} days!\"\nrescue StandardError=&gt; e\n    raise InvalidDateError.new(\"Invalid Date : #{input}\")\nend\n</code></pre>\n\n<p>If you don't want to raise an error and only want to show error message then replace <code>raise InvalidDateError.new(\"Invalid Date : #{input}\")</code>\nwith <code>puts \"Invalid Date : #{input}\"</code></p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1526554176, "creation_date": 1526554176, "answer_id": 50389590, "question_id": 50376557, "link": "https://stackoverflow.com/questions/50376557/creating-an-error-message-for-an-invalid-input/50389590#50389590", "title": "Creating an error message for an invalid input", "body": "<p>As suggested by Viktor, and stolen :) from <a href=\"https://stackoverflow.com/a/13400595/5239030\">crantok</a></p>\n\n<pre><code>require 'date'\ndate_valid = false\n\nwhile !date_valid\n  puts 'Insert date as yyyy-mm-dd:'\n  input_date = gets.chomp\n\n  begin\n    parsed_date = Date.parse(input_date)\n    date_valid = true\n  rescue ArgumentError\n    puts 'format error'\n  end\nend\n\nmonth = parsed_date.month\nyear = parsed_date.year\ndays_in_month = Date.new(year, month, -1).day\nputs \"In #{year} month #{month} has #{days_in_month} days\"\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 8286358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/405e78d1a1ffc5810e717ec12205fda9?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8286358/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1526554176, "creation_date": 1526490640, "last_edit_date": 1526491162, "question_id": 50376557, "link": "https://stackoverflow.com/questions/50376557/creating-an-error-message-for-an-invalid-input", "title": "Creating an error message for an invalid input", "body": "<p>I have the following code that returns the # of days in any given month, which works fine unless someone types in something that isn't a date, or they format the date wrong.  To remedy this I want to send out an error message for an invalid input, but I don't know how.  So how do I create an error message for this small app?</p>\n\n<pre><code>   #type in the month and year you want like so ---&gt; \"Feb 2034\"\n\nrequire 'date'\n\ninput = gets.chomp\n\ninputArray = input.split(\" \").to_a\n\ntextMonth = inputArray[0]\ntextYear = inputArray[1]\n\nstartOfMonth = Date.strptime(input, \"%b %Y\")\nnextMonth = startOfMonth.next_month\nendOfMonth = nextMonth - 1\ndaysInMonth = (endOfMonth - startOfMonth + 1).to_i\n\nputs \"#{textMonth} of year #{textYear} has #{daysInMonth} days!\"\n</code></pre>\n"}, {"tags": ["jquery", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1526492186, "post_id": 50376427, "comment_id": 87770098, "body": "Can you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, with emphasis on the word <i>minimal</i>? I highly doubt that it requires <b>464 lines of code</b> to describe your problem."}, {"owner": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526493857, "post_id": 50376427, "comment_id": 87770942, "body": "Does that work for you @TomLord?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1526497939, "post_id": 50376427, "comment_id": 87772903, "body": "Could you at least show us the incoming request (copy from your server output) and the full error stack."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "edited": false, "score": 0, "creation_date": 1526496196, "post_id": 50377857, "comment_id": 87772056, "body": "Thanks for the comment, but I am still getting the same error."}, {"owner": {"reputation": 6100, "user_id": 3704297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GjB9f.jpg?s=128&g=1", "display_name": "omikes", "link": "https://stackoverflow.com/users/3704297/omikes"}, "reply_to_user": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "edited": false, "score": 0, "creation_date": 1526496289, "post_id": 50377857, "comment_id": 87772104, "body": "@CristianPolanco use the same code you had before, but rename show.js to new.js, and make sure new.js is in the same folder as new.html"}, {"owner": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "edited": false, "score": 0, "creation_date": 1526496347, "post_id": 50377857, "comment_id": 87772130, "body": "My apologies, I did not read the next part. My javascript is called show.js. I will surely do that then."}, {"owner": {"reputation": 6100, "user_id": 3704297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GjB9f.jpg?s=128&g=1", "display_name": "omikes", "link": "https://stackoverflow.com/users/3704297/omikes"}, "reply_to_user": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "edited": false, "score": 0, "creation_date": 1526496401, "post_id": 50377857, "comment_id": 87772163, "body": "in fairness i wrote it while you were still responding to me :p"}, {"owner": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "edited": false, "score": 0, "creation_date": 1526496586, "post_id": 50377857, "comment_id": 87772245, "body": "Hahah, do you think I should name my js &#39;new.js&#39; instead? Because it is still showing the same error."}, {"owner": {"reputation": 6100, "user_id": 3704297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GjB9f.jpg?s=128&g=1", "display_name": "omikes", "link": "https://stackoverflow.com/users/3704297/omikes"}, "reply_to_user": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "edited": false, "score": 0, "creation_date": 1526496637, "post_id": 50377857, "comment_id": 87772266, "body": "make it <code>new.js.erb</code> so that ruby can recognize it"}, {"owner": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "edited": false, "score": 0, "creation_date": 1526496737, "post_id": 50377857, "comment_id": 87772315, "body": "Right now my js file is my assets folder. Should I move it to my views folder? Where my new.html.erb is?"}, {"owner": {"reputation": 6100, "user_id": 3704297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GjB9f.jpg?s=128&g=1", "display_name": "omikes", "link": "https://stackoverflow.com/users/3704297/omikes"}, "reply_to_user": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "edited": false, "score": 0, "creation_date": 1526496834, "post_id": 50377857, "comment_id": 87772367, "body": "Ohhh let my change my answer"}, {"owner": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "edited": false, "score": 0, "creation_date": 1526497197, "post_id": 50377857, "comment_id": 87772548, "body": "In this link: <a href=\"https://imgur.com/a/GWcVf7P\" rel=\"nofollow noreferrer\">here</a> is what the compiler tells me when I try running it."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "edited": false, "score": 0, "creation_date": 1526498359, "post_id": 50377857, "comment_id": 87773088, "body": "@CristianPolanco No JavaScript that is referenced in the controllers should always be in the <code>app&#47;views&#47;some_dir</code> directory. Only assets should be in the assets folder. JavaScript can be an asset or a view, but when it needs to pass through the controller it means you have a chance to interpret server objects (using erb or coffeescript) which in turn makes it a view."}, {"owner": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1526566911, "post_id": 50377857, "comment_id": 87803401, "body": "@JohanWentholt, I am not understanding (at least I think), but anything that I have in show.js I should put in a new.js.erb file?"}], "tags": [], "owner": {"reputation": 6100, "user_id": 3704297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GjB9f.jpg?s=128&g=1", "display_name": "omikes", "link": "https://stackoverflow.com/users/3704297/omikes"}, "is_accepted": false, "score": 0, "last_activity_date": 1526497307, "last_edit_date": 1526497307, "creation_date": 1526495669, "answer_id": 50377857, "question_id": 50376427, "link": "https://stackoverflow.com/questions/50376427/actioncontrollerunknownformat-ruby-on-rails/50377857#50377857", "title": "ActionController::UnknownFormat (Ruby on Rails)", "body": "<p>My last attempt, as I am out of my depth it seems. Use this along with your original code, files unrenamed. Leave your js file where it is.</p>\n\n<pre><code>respond_to do |format|\n    format.html {}\n    format.js do\n        redirect('/assets/show.js')\n    end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "is_accepted": false, "score": 0, "last_activity_date": 1526567393, "creation_date": 1526567393, "answer_id": 50394061, "question_id": 50376427, "link": "https://stackoverflow.com/questions/50376427/actioncontrollerunknownformat-ruby-on-rails/50394061#50394061", "title": "ActionController::UnknownFormat (Ruby on Rails)", "body": "<p>Though I really appreciate all the effort that has been put towards solving this question, I must advice that I found the solution to the problem.</p>\n\n<p>The error was on my index.html.erb, which I did not put because I thought it had nothing to do with the problem. My index looked like this:</p>\n\n<pre><code>&lt;div&gt;\n    &lt;%= link_to \"Create new class\", new_klass_path(@klass) %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The unknown format error came because it did not know what \"@klass\" was; or so I believe. As soon as I took it away, the transition from one page to the other went smoothly. Moreover, it looks like this know:</p>\n\n<pre><code>&lt;div&gt;\n    &lt;%= link_to \"Create new class\", new_klass_path %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>If this pisses anyone off, I deeply apologize. I really appreciate everyone's help. I am going to try to level up quickly, to give you guys checks for useful answers.</p>\n"}], "owner": {"reputation": 3, "user_id": 9801537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35745de46ae01007e0c9ec8400dfca1?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian Polanco", "link": "https://stackoverflow.com/users/9801537/cristian-polanco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1526567393, "creation_date": 1526490136, "last_edit_date": 1526493839, "question_id": 50376427, "link": "https://stackoverflow.com/questions/50376427/actioncontrollerunknownformat-ruby-on-rails", "title": "ActionController::UnknownFormat (Ruby on Rails)", "body": "<p>I am creating a Ruby on Rails application where I render my 'new.html.erb' (in my klass controller) and on top of it render my partial '_select_previous.html.erb,' also, I have a 'link_to' to switch back and forth from one to the other. However, when I try to start my project at the 'index.html.erb' and then use a 'link_to' to go to the new file, it shows me that error above.</p>\n\n<p>I am using jQuery to do the switching from one view to the other.</p>\n\n<p>Here is my new.html.erb:</p>\n\n<pre><code>&lt;p&gt; Or select from the previous created classes &lt;%= link_to \"here\", \nnew_klass_path, id: \"link_to\", :remote =&gt; true %&gt; &lt;/p&gt;\n\n&lt;div id=\"previous\"&gt;\n   &lt;%= render :partial =&gt; 'select_previous' %&gt;\n&lt;/div&gt;\n\n&lt;div id=\"content\"&gt;\n &lt;!-- Ruby form --&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>This is my klasses controller:</p>\n\n<pre><code>def index\n    @klass = Klass.all.paginate(:page =&gt; params[:page])\n    #import_klasses(@klass)\nend\n\ndef new\n    @klass = Klass.new\n    #saved = @klass.save\n    #@klass.save!\n    #if saved\n       #s1 = Student.last.id\n       #k1 = Klass.last.id\n       #@enrollments = Enrollment.new(student_id: s1, klass_id: k1)\n       #binding.pry\n       #@enrollments.save!\n     #redirect_to :controller =&gt; 'enrollments', :action =&gt; 'index'\n     #flash[:alert] = \"Class Created\"\n  #end\n#end\n\n  respond_to do |format|\n     format.html {}\n     format.js\n  end\nend\n</code></pre>\n\n<p>And this is my show.js:</p>\n\n<pre><code>$(document).ready(function() {\n$(\"#days\").hide();\n$(\"#grade\").hide();\n$(\"#class\").hide();\n$(\"#all\").hide();\n$(\"#previous\").hide();\n\n$(\"#link_to\").click(function () {\n    var count = $(this).data(\"count\") || 0;\n    if(count == 1)\n    {\n        $(\"#content\").hide();\n        $(\"#previous\").show();\n    }\n    else if(count == 2)\n    {\n        $(\"#content\").show();\n        $(\"#previous\").hide();\n        count = 0;\n    }\n\n    $(this).data(\"count\", ++count);\n});\n});\n</code></pre>\n\n<p>Thank in advance for any help you may provide me.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1526489250, "post_id": 50375875, "comment_id": 87768496, "body": "Hi again! One way would be to look at the current grade? For example if it&#39;s a C and the student studies then it becomes a B, but if it&#39;s already a B it becomes an A. and so on."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 1, "creation_date": 1526489345, "post_id": 50375875, "comment_id": 87768548, "body": "I&#39;m not sure that posting these questions for each exercise you have is the best way for you to learn the general ideas here so that you&#39;ll be able to do these yourself in the future? Have you got a link to the course/website where these come from?"}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "reply_to_user": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1526490014, "post_id": 50375875, "comment_id": 87768933, "body": "How&#39;s it going? I appreciate that, there are no websites or links that I can refer to as far as directly addressing these exercises. Only general concepts are given to us and we have to try to implement them in the exercises given to us."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1526494026, "post_id": 50375875, "comment_id": 87771044, "body": "Hi! If you\u2019re ok to drop me an email (contact details in my profile) I\u2019ll try and give a couple of general tips that might help. Cheers."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526496804, "post_id": 50375875, "comment_id": 87772350, "body": "You could change <code>@grade</code> based on its current value. So if @grade is C then set it to B. If @grade is B then set it to A. Do you know how to implement an <code>if</code> or <code>case</code> expression?"}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526497251, "post_id": 50375875, "comment_id": 87772571, "body": "sort of, that is what im trying to grasp right now. I&#39;m having trouble trying it figure out how to structure the if statements and what methods or terms to use to have it make sense."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526499625, "post_id": 50375875, "comment_id": 87773722, "body": "I&#39;ve posted an answer below but you should really try to solve this on your own. Show your attempts next time, even if they don&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 1, "creation_date": 1526499602, "post_id": 50378648, "comment_id": 87773709, "body": "ah ok, i appreciate you going through that, I will take a look at this for a little bit and see if i can digest what you did."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1526499787, "last_edit_date": 1526499787, "creation_date": 1526499103, "answer_id": 50378648, "question_id": 50375875, "link": "https://stackoverflow.com/questions/50375875/using-tdd-code-to-help-this-student-to-pass-ruby/50378648#50378648", "title": "Using TDD/CODE to help this student to pass - RUBY", "body": "<p>You could use an <a href=\"http://ruby-doc.org/core-2.5.1/doc/syntax/control_expressions_rdoc.html#label-if+Expression\" rel=\"nofollow noreferrer\"><code>if</code></a> expression:</p>\n\n<pre><code>def study\n  if grade == 'C'\n    @grade = 'B'\n  elsif grade == 'B'\n    @grade = 'A'\n  end\nend\n</code></pre>\n\n<p>or \u2013 a little more succinct \u2013 a <a href=\"http://ruby-doc.org/core-2.5.1/doc/syntax/control_expressions_rdoc.html#label-case+Expression\" rel=\"nofollow noreferrer\"><code>case</code></a> expression:</p>\n\n<pre><code>def study\n  case grade\n  when 'C'\n    @grade = 'B'\n  when 'B'\n    @grade = 'A'\n  end\nend\n</code></pre>\n\n<p>Note that I'm using the getter <code>grade</code> to <em>read</em> the value and the instance variable <code>@grade</code> to <em>assign</em> a new value.</p>\n\n<p>Another approach is to use some kind of mapping, e.g. via <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-tr-21\" rel=\"nofollow noreferrer\"><code>tr!</code></a>:</p>\n\n<pre><code>def study\n  @grade.tr!('BC', 'AB')\nend\n</code></pre>\n\n<p>It replaces the characters in the first argument with the corresponding characters in the second argument, i.e. <code>'B'</code> with <code>'A'</code> and <code>'C'</code> with <code>'B'</code>.</p>\n"}], "owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 50378648, "answer_count": 1, "score": 0, "last_activity_date": 1526499787, "creation_date": 1526488203, "last_edit_date": 1526495974, "question_id": 50375875, "link": "https://stackoverflow.com/questions/50375875/using-tdd-code-to-help-this-student-to-pass-ruby", "title": "Using TDD/CODE to help this student to pass - RUBY", "body": "<p>I'm trying to solve a TDD exercise. I managed to make the first test pass:</p>\n\n<pre><code>def test_grade_is_mediocre\n  student = Student.new\n  assert_equal 'C', student.grade\nend\n</code></pre>\n\n<p>By implementing this code:</p>\n\n<pre><code>class Student\n  attr_reader :grade\n\n\n  def initialize(grade = \"C\")\n    @grade = grade\n  end\n\n  def study\n  end\nend\n</code></pre>\n\n<p>But I got stuck at the second test:</p>\n\n<pre><code>def test_grade_can_improve\n  student = Student.new\n  student.study\n  assert_equal \"B\", student.grade\n  student.study\n  assert_equal \"A\", student.grade\nend\n</code></pre>\n\n<p>Can anyone guide me in the right direction as to how to address the grade changes once the student studies? I have pass <code>grade = \"C\"</code> as an argument to get the first test to pass and I know I need to define the <code>study</code> method but am stuck in trying to figure out how to address how the student improves his grades after he studies once and then twice. Do I need to set some sort of counter?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1526486196, "post_id": 50375289, "comment_id": 87766893, "body": "So it worked before? What changed since then?"}, {"owner": {"reputation": 99, "user_id": 9435011, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-surR8ciCRkU/AAAAAAAAAAI/AAAAAAAAB9E/5G43kwUd2Io/photo.jpg?sz=128", "display_name": "Mohammed Sayer", "link": "https://stackoverflow.com/users/9435011/mohammed-sayer"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1526486292, "post_id": 50375289, "comment_id": 87766946, "body": "i tried deploying it using capistrano but after since i am not even able to run it on development anymore, i had kept a backup before i started messing with capistrano now when i try to run using the backup directory i am still getting the same error"}], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 9435011, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-surR8ciCRkU/AAAAAAAAAAI/AAAAAAAAB9E/5G43kwUd2Io/photo.jpg?sz=128", "display_name": "Mohammed Sayer", "link": "https://stackoverflow.com/users/9435011/mohammed-sayer"}, "is_accepted": true, "score": 0, "last_activity_date": 1526487386, "creation_date": 1526487386, "answer_id": 50375652, "question_id": 50375289, "link": "https://stackoverflow.com/questions/50375289/not-able-to-run-rails-app-locally/50375652#50375652", "title": "not able to run rails app locally", "body": "<p>I have solved the issue, though i was using the new backup directory i had the <code>rsa</code> key in <code>ssh-add</code> because of capistrano previous deployment try's once i removed that and tried to run it things ran normally </p>\n"}], "owner": {"reputation": 99, "user_id": 9435011, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-surR8ciCRkU/AAAAAAAAAAI/AAAAAAAAB9E/5G43kwUd2Io/photo.jpg?sz=128", "display_name": "Mohammed Sayer", "link": "https://stackoverflow.com/users/9435011/mohammed-sayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 50375652, "answer_count": 1, "score": 0, "last_activity_date": 1526487386, "creation_date": 1526486111, "question_id": 50375289, "link": "https://stackoverflow.com/questions/50375289/not-able-to-run-rails-app-locally", "title": "not able to run rails app locally", "body": "<p>Hello i am fairly new to rails and i have a rails app which use to run normally before, recently when i am trying to to command <code>rails s</code> on my machine it throws me <code>method_missing': undefined method web_console'</code> error. I am totally lost. here is the log</p>\n\n<pre><code>rails s\n=&gt; Booting Puma\n=&gt; Rails 5.0.7 application starting in development on http://localhost:3000\n=&gt; Run `rails server -h` for more startup options\nExiting\n/Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/railtie/configuration.rb:95:in `method_missing': undefined method `web_console' for #&lt;Rails::Application::Configuration:0x007fa04bb518f8&gt; (NoMethodError)\nDid you mean?  console\n    from /Users/mohammedsayerwala/Documents/Aqua/config/environments/development.rb:24:in `block in &lt;top (required)&gt;'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/railtie.rb:209:in `instance_eval'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/railtie.rb:209:in `configure'\n    from /Users/mohammedsayerwala/Documents/Aqua/config/environments/development.rb:1:in `&lt;top (required)&gt;'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:293:in `require'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:293:in `block in require'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:259:in `load_dependency'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:293:in `require'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/engine.rb:600:in `block (2 levels) in &lt;class:Engine&gt;'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/engine.rb:599:in `each'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/engine.rb:599:in `block in &lt;class:Engine&gt;'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/initializable.rb:30:in `instance_exec'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/initializable.rb:30:in `run'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:228:in `block in tsort_each'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:422:in `block (2 levels) in each_strongly_connected_component_from'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:431:in `each_strongly_connected_component_from'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:421:in `block in each_strongly_connected_component_from'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/initializable.rb:44:in `each'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/initializable.rb:44:in `tsort_each_child'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:415:in `call'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:415:in `each_strongly_connected_component_from'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:349:in `block in each_strongly_connected_component'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:347:in `each'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:347:in `call'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:347:in `each_strongly_connected_component'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:226:in `tsort_each'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/tsort.rb:205:in `tsort_each'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/initializable.rb:54:in `run_initializers'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/application.rb:352:in `initialize!'\n    from /Users/mohammedsayerwala/Documents/Aqua/config/environment.rb:5:in `&lt;top (required)&gt;'\n    from /Users/mohammedsayerwala/Documents/Aqua/config.ru:3:in `require_relative'\n    from /Users/mohammedsayerwala/Documents/Aqua/config.ru:3:in `block in &lt;main&gt;'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/rack-2.0.5/lib/rack/builder.rb:55:in `instance_eval'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/rack-2.0.5/lib/rack/builder.rb:55:in `initialize'\n    from /Users/mohammedsayerwala/Documents/Aqua/config.ru:in `new'\n    from /Users/mohammedsayerwala/Documents/Aqua/config.ru:in `&lt;main&gt;'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/rack-2.0.5/lib/rack/builder.rb:49:in `eval'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/rack-2.0.5/lib/rack/builder.rb:49:in `new_from_string'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/rack-2.0.5/lib/rack/builder.rb:40:in `parse_file'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/rack-2.0.5/lib/rack/server.rb:319:in `build_app_and_options_from_config'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/rack-2.0.5/lib/rack/server.rb:219:in `app'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/commands/server.rb:84:in `app'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/rack-2.0.5/lib/rack/server.rb:354:in `wrapped_app'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/commands/server.rb:148:in `log_to_stdout'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/commands/server.rb:102:in `start'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/commands/commands_tasks.rb:90:in `block in server'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/commands/commands_tasks.rb:85:in `tap'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/commands/commands_tasks.rb:85:in `server'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/commands/commands_tasks.rb:49:in `run_command!'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.7/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n    from /Users/mohammedsayerwala/Documents/Aqua/bin/rails:9:in `require'\n    from /Users/mohammedsayerwala/Documents/Aqua/bin/rails:9:in `&lt;top (required)&gt;'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.2/lib/spring/client/rails.rb:28:in `load'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.2/lib/spring/client/rails.rb:28:in `call'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.2/lib/spring/client/command.rb:7:in `call'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.2/lib/spring/client.rb:30:in `run'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.2/bin/spring:49:in `&lt;top (required)&gt;'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `load'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `&lt;top (required)&gt;'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:68:in `require'\n    from /Users/mohammedsayerwala/.rbenv/versions/2.4.0/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:68:in `require'\n    from /Users/mohammedsayerwala/Documents/Aqua/bin/spring:14:in `&lt;top (required)&gt;'\n    from bin/rails:3:in `load'\n    from bin/rails:3:in `&lt;main&gt;'\n</code></pre>\n\n<p>I am using rails 5.0.7 version and ruby 2.4.0\ni tried doing <code>spring stop</code> and even commenting the spring gem inside the gemfile but nothing worked. \nThanks for the help in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526486394, "post_id": 50375247, "comment_id": 87767007, "body": "How do the <code>amount</code> columns work, exactly? You need to keep them synchronised, right? So you&#39;re trying to right a test that this synchronisation works as expected?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526486411, "post_id": 50375247, "comment_id": 87767016, "body": "It&#39;s hard to suggest what test to write, if you haven&#39;t shown what needs testing ;)"}, {"owner": {"reputation": 9735, "user_id": 625184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61e61fa593df732de1ccaad37ea4f59?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/625184/jon"}, "edited": false, "score": 1, "creation_date": 1526487829, "post_id": 50375247, "comment_id": 87767794, "body": "Your comment about &quot;lost some decimals&quot; is a bit concerning. Please don&#39;t store financial figures using floating-point numbers. Store everything as integers, and convert from pence/cents into pounds/dollars when you display amounts in the view."}, {"owner": {"reputation": 29, "user_id": 7203387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7894d657478623505eb49188d1ae9beb?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/7203387/andres-fernandes"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526494421, "post_id": 50375247, "comment_id": 87771228, "body": "@TomLord i added an example"}, {"owner": {"reputation": 29, "user_id": 7203387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7894d657478623505eb49188d1ae9beb?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/7203387/andres-fernandes"}, "reply_to_user": {"reputation": 9735, "user_id": 625184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61e61fa593df732de1ccaad37ea4f59?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/625184/jon"}, "edited": false, "score": 0, "creation_date": 1526494430, "post_id": 50375247, "comment_id": 87771234, "body": "check the example please @jon"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526500494, "post_id": 50375247, "comment_id": 87774093, "body": "@AndresFernandes I still don&#39;t understand what you&#39;re trying to <b>test</b> here... Unless there&#39;s some critical information missing from your post, the <code>PaymentDocument</code>s and <code>PaymentAmount</code>s can have <b>any</b> values... So why would it necessarily be the case that their <code>amount</code>s add up? If there&#39;s nothing enforcing this? Sure, they <i>might</i> just so happen to add up, but you can&#39;t exactly write a test to say &quot;ifthey add up, then they add up; if they don&#39;t then they don&#39;t&quot;."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526500805, "post_id": 50375247, "comment_id": 87774226, "body": "Is there something in the <code>PaymentAmounts</code> model, that updates the <code>amount</code> of the <code>PaymentDocument</code>? Is there some service object which sets all of these values? What happens if  the <code>PaymentDocument</code> gets updated? What happens if a <code>PaymentAmount</code> gets updated? There are many ways that this <i>could</i> be implemented, but how do you expect this to work? You still haven&#39;t shown us anything, so I have no idea how to &quot;test it&quot;."}, {"owner": {"reputation": 9735, "user_id": 625184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61e61fa593df732de1ccaad37ea4f59?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/625184/jon"}, "edited": false, "score": 0, "creation_date": 1526572756, "post_id": 50375247, "comment_id": 87807476, "body": "@AndresFernandes - my comment still stands. DO NOT use floating point numbers when dealing with financial data."}], "answers": [{"tags": [], "owner": {"reputation": 1086, "user_id": 5201594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHVDD.jpg?s=128&g=1", "display_name": "rahul mishra", "link": "https://stackoverflow.com/users/5201594/rahul-mishra"}, "is_accepted": true, "score": 1, "last_activity_date": 1526533651, "creation_date": 1526533651, "answer_id": 50383695, "question_id": 50375247, "link": "https://stackoverflow.com/questions/50375247/rspec-and-factorygirl-with-several-models/50383695#50383695", "title": "Rspec and FactoryGirl with several models", "body": "<p>I Assume that when creating payment_amount then associated  payment_document amount automatically updated.\nif this is the case you can test it by something like that.</p>\n\n<pre><code>describe '#payment' do\n    it 'should very amount' do\n      pd = Factory.create(:payment_document)\n      attributes = [ { pd_id: pd.id, amount: 40095.00 },\n                     { pd_id: pd.id, amount: 500000.94 },\n                     { pd_id: pd.id, amount: 3000000.00 }\n                   ]\n      attributes.each do |attrs|\n        Factory.create(:payment_amount, attrs)\n      end\n\n     total_amount = attributes.map{ |m| m[:amount]}.sum\n     expect(pd.reload.amount).to eq(total_amount)\n    end\n  end\n</code></pre>\n\n<p>NOTE:  this is a guess as I haven't aware of your model code.</p>\n"}], "owner": {"reputation": 29, "user_id": 7203387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7894d657478623505eb49188d1ae9beb?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/7203387/andres-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 50383695, "answer_count": 1, "score": 0, "last_activity_date": 1526533651, "creation_date": 1526485967, "last_edit_date": 1526494408, "question_id": 50375247, "link": "https://stackoverflow.com/questions/50375247/rspec-and-factorygirl-with-several-models", "title": "Rspec and FactoryGirl with several models", "body": "<p>i'm new using the tests on rails and i have some doubts... I need to test several models, i know how to test the basics, like the validations and associations, but i'm not sure how to approach what i need to do.</p>\n\n<p>I have two models, PaymentDocument, PaymentAmount (PaymentDocument has_many PaymentAmount), each model has a field called \"amount\", the amount in the PaymentDocument model has the sum of every PaymentAmount associated to it. so i need to apply some math operation to each PaymentAmount amount and sum them, then do the same math operation to the PaymentDocument amount and compare it to check if there are exactly equal or i lost some decimals.</p>\n\n<p>Right now i have two specs file, one for the PaymentDocument and another one for the PaymentAmount, how i can test both models at the same time (to verify if the info of each model is correct) and then apply the math operation i mention before?</p>\n\n<p>payment_document_spec</p>\n\n<pre><code>require \"rails_helper\"\n\nRSpec.describe PaymentDocument, type: :model do\n\n  describe \"validations\" do\n    it { is_expected.to validate_presence_of(:amount) }\n    it { is_expected.to validate_numerality_of(:amount).is_greater_than(0) }\n  end\n  describe \"associations\" do\n   it { is_expected.to belong_to(:payment_amounts) }\n  end\nend\n</code></pre>\n\n<p>payment_amount_spec</p>\n\n<pre><code>require \"rails_helper\"\n\nRSpec.describe PaymentAmount, type: :model do\n\n  describe \"validations\" do\n    it { is_expected.to validate_presence_of(:payment_document) }\n    it { is_expected.to validate_presence_of(:amount) }\n    it { is_expected.to validate_numerality_of(:amount).is_greater_than(0) }\n  end\n\n  describe \"associations\" do\n    it { is_expected.to have_many(:payment_document) }\n  end\n\nend\n</code></pre>\n\n<p>edit:</p>\n\n<p>Example</p>\n\n<pre><code>   PaymentDocument\n   {\n    id =&gt; 1,\n    amount =&gt; 3540095,94\n   }\n   PaymentAmounts: \n     {\n      id =&gt; 1,\n      pd_id =&gt; 1,\n      amount =&gt; 40095.00,\n    }\n    {\n      id =&gt; 2,\n      pd_id =&gt; 1,\n      amount =&gt; 500000.94,\n    }\n    {\n      id =&gt; 2,\n      pd_id =&gt; 1,\n      amount =&gt; 3000000.00,\n    }\n\n#The math operation is remove divide the amounts by 1000 and round them by 2\n\n{\n  id =&gt; 1,\n  pd_id =&gt; 1,\n  amount =&gt; 40.10,\n}\n{\n  id =&gt; 2,\n  pd_id =&gt; 1,\n  amount =&gt; 500.00,\n}\n{\n  id =&gt; 2,\n  pd_id =&gt; 1,\n  amount =&gt; 3000.00,\n}\n\n#The sum of all the payment amounts is 3540.10 and if i do the same operation to the amount of the payment document the result is 3540.1 but in some cases it may not be equal so that's why i want to test this. \n</code></pre>\n"}, {"tags": ["ruby", "azure", "chef-infra"], "comments": [{"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1526485931, "post_id": 50374851, "comment_id": 87766718, "body": "Is this a custom resource you made yourself?"}, {"owner": {"reputation": 23, "user_id": 6349252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45e7c045705156e92aa37d0f3a994b95?s=128&d=identicon&r=PG&f=1", "display_name": "Typh", "link": "https://stackoverflow.com/users/6349252/typh"}, "reply_to_user": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1526539648, "post_id": 50374851, "comment_id": 87785621, "body": "Yes, it is a custom resource!"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1526541829, "post_id": 50374851, "comment_id": 87786789, "body": "Please show the code for it too"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6349252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45e7c045705156e92aa37d0f3a994b95?s=128&d=identicon&r=PG&f=1", "display_name": "Typh", "link": "https://stackoverflow.com/users/6349252/typh"}, "edited": false, "score": 0, "creation_date": 1526567873, "post_id": 50379025, "comment_id": 87804136, "body": "Yeah! This worked for me. I had to add &#39;new_resource&#39; to the properties and it worked. Thank you very much!"}], "tags": [], "owner": {"reputation": 3665, "user_id": 9797143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/173377baee1db5827d6a9be47a5c082c?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon Miller", "link": "https://stackoverflow.com/users/9797143/brandon-miller"}, "is_accepted": true, "score": 1, "last_activity_date": 1526500748, "creation_date": 1526500748, "answer_id": 50379025, "question_id": 50374851, "link": "https://stackoverflow.com/questions/50374851/chef-cookbook-undefined-local-variable-or-method/50379025#50379025", "title": "Chef cookbook: undefined local variable or method", "body": "<p>It's possible your resource is using deprecated property naming.</p>\n\n<ul>\n<li>Verify that the <code>sii_share_share</code> resource has a property named <code>local_path</code></li>\n<li>If it does then you need to verify that all of the code inside the\nresource itself refers to the <code>local_path</code> property using\n<code>new_resource.local_path</code> and not <code>local_path</code>. This has been a\n<a href=\"https://docs.chef.io/deprecations_namespace_collisions.html\" rel=\"nofollow noreferrer\">pending deprecation that went in to effect with Chef Client 14</a>.</li>\n</ul>\n\n<p>You should always review <a href=\"https://docs.chef.io/release_notes.html#breaking-changes\" rel=\"nofollow noreferrer\">breaking changes</a> before making the move between major versions of Chef Client. The end of each chef-client run also outputs deprecation messages as a warning before these breaking changes go in to place.</p>\n"}], "owner": {"reputation": 23, "user_id": 6349252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45e7c045705156e92aa37d0f3a994b95?s=128&d=identicon&r=PG&f=1", "display_name": "Typh", "link": "https://stackoverflow.com/users/6349252/typh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2374, "favorite_count": 0, "accepted_answer_id": 50379025, "answer_count": 1, "score": 1, "last_activity_date": 1526500748, "creation_date": 1526484639, "question_id": 50374851, "link": "https://stackoverflow.com/questions/50374851/chef-cookbook-undefined-local-variable-or-method", "title": "Chef cookbook: undefined local variable or method", "body": "<p>I'm having a problem with a chef cookbook that create several shared filesystems. </p>\n\n<p>This is the fragment that is giving me problems:</p>\n\n<pre><code>sii_share_share \"ansible\" do\n    remote_path \"//#{ node['sii_base']['utils_storage_account_name'] }.file.core.windows.net/ansible\"\n    local_path \"/opt/ansible\"\n    fstype \"cifs\"\n    dir_owner \"root\"\n    dir_group \"sysadmin\"\n    dir_mode \"0770\"\n    file_mode \"0660\"\n    cifs_credentials_file \"/root/.smb.utils.credentials\"\nend\n</code></pre>\n\n<p>The error is \"undefined local variable or method `local_path' for #&lt;#:0x00000000047b3ed8>\"</p>\n\n<p>This error is happening with these versions:</p>\n\n<blockquote>\n  <p>Chef-client: 14.1.12</p>\n  \n  <p>ruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-linux]</p>\n</blockquote>\n\n<p>With previous versions (chef-client 13.6 and ruby 2.3.1p112) this is working fine. I'm running these cookbooks in Azure, using the Linux Chef extension.</p>\n\n<p>Have anyone experimented something like this?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "escaping"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1526484856, "post_id": 50374848, "comment_id": 87766045, "body": "No need to escape the content you are sure about. <code>&quot;#button_&lt;%= comment.id %&gt;&quot;</code> is perfectly fine, since <code>comment.id</code> is definitely integer."}, {"owner": {"reputation": 387, "user_id": 8152465, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17b78615d8f648d8b9745b530b880422?s=128&d=identicon&r=PG&f=1", "display_name": "rod", "link": "https://stackoverflow.com/users/8152465/rod"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1526493333, "post_id": 50374848, "comment_id": 87770662, "body": "Ok thank you. So I only have to escape string. This example need to be escaped ? $(&quot;#post-title&quot;).html(&quot;&lt;%= escape_javascript @post.title) %&gt;&quot;);"}], "owner": {"reputation": 387, "user_id": 8152465, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17b78615d8f648d8b9745b530b880422?s=128&d=identicon&r=PG&f=1", "display_name": "rod", "link": "https://stackoverflow.com/users/8152465/rod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1526484631, "creation_date": 1526484631, "question_id": 50374848, "link": "https://stackoverflow.com/questions/50374848/rails-when-escape-javascript", "title": "Rails: When Escape Javascript", "body": "<p>My question is if ruby code inside script tag MUST be always escaped?\nHave I to escape javascript when I set a class/id of a div for example?</p>\n\n<pre><code>&lt;script&gt;\n    $(\"#button_&lt;%= comment.id %&gt;\").click(function(){\n       ... ...\n       ... ...\n    });\n&lt;/script&gt;\n</code></pre>\n\n<p>OR </p>\n\n<pre><code>&lt;script&gt;\n    $(\"#button_&lt;%= escape_javascript comment.id.to_s %&gt;\").click(function(){\n       ... ...\n       ... ...\n    });\n&lt;/script&gt;\n</code></pre>\n\n<p>Or ruby code must be escaped only when render partials? Thank you</p>\n"}, {"tags": ["ruby", "sinatra"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1526485098, "creation_date": 1526485098, "answer_id": 50374991, "question_id": 50374838, "link": "https://stackoverflow.com/questions/50374838/string-interpolation-not-working-in-sinatra-redirect/50374991#50374991", "title": "String interpolation not working in Sinatra redirect", "body": "<p>In ruby the string literals declared in single quotes <em>are not interpolated</em>, unlike double-quoted literals:</p>\n\n<pre><code>\"#{42}\"\n#\u21d2\u00a0\"42\"\n'#{42}'\n#\u21d2 \"\\#{42}\"\n</code></pre>\n\n<p>So, just change single quotes to double quotes in the argument to <code>redirect to</code>.</p>\n"}], "owner": {"reputation": 5565, "user_id": 1695507, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1f7f9576a6f6486bf26e4a8dbbf09868?s=128&d=identicon&r=PG", "display_name": "thumbtackthief", "link": "https://stackoverflow.com/users/1695507/thumbtackthief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "closed_date": 1526491079, "accepted_answer_id": 50374991, "answer_count": 1, "score": 0, "last_activity_date": 1526485098, "creation_date": 1526484607, "last_edit_date": 1526484769, "question_id": 50374838, "link": "https://stackoverflow.com/questions/50374838/string-interpolation-not-working-in-sinatra-redirect", "closed_reason": "Duplicate", "title": "String interpolation not working in Sinatra redirect", "body": "<p>When I use this method:</p>\n\n<pre><code>patch '/posts/:id' do\n  post = Post.find(params[:id])\n  post.update(name: params[:name], content: params[:content])\n  redirect to '/posts/#{post.id}'\nend\n</code></pre>\n\n<p>I get the error <code>ERROR URI::InvalidURIError: bad URI(is not URI?): http://localhost:9393/posts/#{post.id}</code></p>\n\n<p>But when I either hardcode the id or concatenate the strings like this:\n<code>redirect to '/posts/' + post.id.to_s\n</code></p>\n\n<p>it works fine.  Am I missing something obvious?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "model-associations", "ruby-on-rails-5.1"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 4067927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0b43a3981d21d45a93a11cc007a9ed07?s=128&d=identicon&r=PG&f=1", "display_name": "anndrew78", "link": "https://stackoverflow.com/users/4067927/anndrew78"}, "edited": false, "score": 0, "creation_date": 1526484467, "post_id": 50374424, "comment_id": 87765784, "body": "Nice, thank fl9! Now form for comment is rendering fine, but I get the new issue, when I submit the form, page is reloading with status 200, but comment is not save in database. I am trying to send it via ajax and no luck. Could you help me with it or I need to post a new question?"}, {"owner": {"reputation": 394, "user_id": 9289181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kEJV4.jpg?s=128&g=1", "display_name": "fl9", "link": "https://stackoverflow.com/users/9289181/fl9"}, "reply_to_user": {"reputation": 177, "user_id": 4067927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0b43a3981d21d45a93a11cc007a9ed07?s=128&d=identicon&r=PG&f=1", "display_name": "anndrew78", "link": "https://stackoverflow.com/users/4067927/anndrew78"}, "edited": false, "score": 1, "creation_date": 1526485392, "post_id": 50374424, "comment_id": 87766387, "body": "Can you confirm that submitting the form triggers the <code>create</code> action of the <code>CommentsController</code>? And if so, have you tried to replace <code>@comment.save</code> by <code>@comment.save!</code> ? If no error is thrown with the <code>save!</code> method then the comment should be saved."}], "tags": [], "owner": {"reputation": 394, "user_id": 9289181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kEJV4.jpg?s=128&g=1", "display_name": "fl9", "link": "https://stackoverflow.com/users/9289181/fl9"}, "is_accepted": true, "score": 1, "last_activity_date": 1526483370, "creation_date": 1526483370, "answer_id": 50374424, "question_id": 50374171, "link": "https://stackoverflow.com/questions/50374171/rails-5ajax-wrong-number-of-arguments-given-1-expected-0/50374424#50374424", "title": "Rails 5(ajax): wrong number of arguments (given 1, expected 0)", "body": "<p>You need to call <code>form_with</code> like this in your <code>_form.html.erb</code> file</p>\n\n<pre><code>&lt;%= form_with model: [@post, @post.comments.build], id: :new_comment do |form| %&gt;\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 4067927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0b43a3981d21d45a93a11cc007a9ed07?s=128&d=identicon&r=PG&f=1", "display_name": "anndrew78", "link": "https://stackoverflow.com/users/4067927/anndrew78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1515, "favorite_count": 0, "accepted_answer_id": 50374424, "answer_count": 1, "score": 0, "last_activity_date": 1526483370, "creation_date": 1526482615, "question_id": 50374171, "link": "https://stackoverflow.com/questions/50374171/rails-5ajax-wrong-number-of-arguments-given-1-expected-0", "title": "Rails 5(ajax): wrong number of arguments (given 1, expected 0)", "body": "<p>I was trying to create associated model Comment for Post via ajax in Rails 5, but get the error.</p>\n\n<p>ArgumentError in Posts#show</p>\n\n<p>Showing /home/mnml/rails/ajax-app/app/views/comments/_form.html.erb where line #2 raised:</p>\n\n<p>wrong number of arguments (given 1, expected 0)</p>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>  resources :posts, only: [:new, :create, :show, :destroy] do \n    resources :comments, only: [:new, :create, :show, :destroy]\n  end\n</code></pre>\n\n<p><strong>post.rb</strong></p>\n\n<pre><code>  belongs_to :user\n  has_many :comments\n</code></pre>\n\n<p><strong>comment.rb</strong></p>\n\n<pre><code>  belongs_to :user, optional: true\n  belongs_to :post\n</code></pre>\n\n<p><strong>posts_controller.rb</strong></p>\n\n<pre><code>  def show\n    @post = Post.find(params[:id])\n    @comment = @post.comments.build\n    @comments = @post.comments\n  end\n</code></pre>\n\n<p><strong>comments_controller.rb</strong></p>\n\n<pre><code>  def new\n    @post = Post.find(params[:post_id])\n    @comment = @post.comments.build\n  end\n\n  def create\n    @post = Post.find(params[:post_id])\n    @comment = @post.comments.build(comment_params)\n    @comment.user_id = current_user.id\n\n    respond_to do |format|\n      if @comment.save\n        format.html { redirect_to @comment.post, notice: 'Comment was successfully created.' }\n        #format.json { render @comment, status: :created, location: @comment }\n        format.js\n      else\n        format.html { render :new }\n        format.json { render json: @comment.errors.full_messages, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  private\n    def comment_params\n      params.require(:comment).permit(:description)\n    end\n</code></pre>\n\n<p><strong>posts/show.html.erb</strong></p>\n\n<pre><code>&lt;%= render \"comments/form\"%&gt;\n</code></pre>\n\n<p><strong>comments/_form.html.erb</strong></p>\n\n<pre><code>&lt;form&gt;\n&lt;%= form_with [@post, @post.comments.build], id: :new_comment do |form| %&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= form.label :description %&gt;\n    &lt;%= form.text_field :description, id: :comment_description, class: \"form-control\" %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= form.submit \"Comment it\", class: \"btn btn-default\", data: { \"disable-with\": \"Comment is saving...\" } %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p><strong>comments/create.js.erb</strong></p>\n\n<pre><code>$('#comments').prepend('&lt;%= j render(@comment) %&gt;')\n</code></pre>\n\n<p>Where I do my mistake? Thanks for help</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-2"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9576420, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Simran Sawhney", "link": "https://stackoverflow.com/users/9576420/simran-sawhney"}, "is_accepted": false, "score": 0, "last_activity_date": 1526649499, "creation_date": 1526649499, "answer_id": 50412241, "question_id": 50373781, "link": "https://stackoverflow.com/questions/50373781/ror-the-phusion-passenger-application-server-encountered-an-error-while-starti/50412241#50412241", "title": "ROR - The Phusion Passenger application server encountered an error while starting your web application", "body": "<p>You need to define the mode of environment in nginx configuration.</p>\n\n<pre><code>server{\n     listen 80 default_server;\n     passenger_enabled on;\n     passenger_app_env production;\n     root &lt;path to application folder&gt;;\n}\n</code></pre>\n\n<p>If you see passenger_app_env is set to production.</p>\n\n<p>For more details, could you please share the nginx error logs ?</p>\n"}], "owner": {"reputation": 33, "user_id": 7235843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8af2dd610e2c78f2d4fcc1e071c92c?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7235843/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 665, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1526649499, "creation_date": 1526481465, "last_edit_date": 1526482710, "question_id": 50373781, "link": "https://stackoverflow.com/questions/50373781/ror-the-phusion-passenger-application-server-encountered-an-error-while-starti", "title": "ROR - The Phusion Passenger application server encountered an error while starting your web application", "body": "<p>When i upload my ROR code in server and run my website that time i face this type of error.</p>\n\n<pre><code>The Phusion Passenger application server encountered an error while starting your web application.\nBecause you are running this web application in staging or production mode\n</code></pre>\n"}, {"tags": ["ruby", "printing", "terminal", "integer", "fizzbuzz"], "comments": [{"owner": {"reputation": 13, "user_id": 9800288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PFU9.jpg?s=128&g=1", "display_name": "gbs0", "link": "https://stackoverflow.com/users/9800288/gbs0"}, "edited": false, "score": 0, "creation_date": 1526480062, "post_id": 50372873, "comment_id": 87762571, "body": "@TomLord Awesome!! Worked 100% :D"}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 0, "last_activity_date": 1526479342, "creation_date": 1526479342, "answer_id": 50373008, "question_id": 50372873, "link": "https://stackoverflow.com/questions/50372873/split-integers-in-terminal/50373008#50373008", "title": "&#39;Split&#39; integers in Terminal", "body": "<p>With string interpolation:</p>\n\n<pre><code>$stdout.print \"#{n}, \"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1526480729, "creation_date": 1526480729, "answer_id": 50373535, "question_id": 50372873, "link": "https://stackoverflow.com/questions/50372873/split-integers-in-terminal/50373535#50373535", "title": "&#39;Split&#39; integers in Terminal", "body": "<p>Just out of curiosity; another solution would be to <em>construct</em> the whole line by joining the array:</p>\n\n<pre><code>puts (1..35).map { |n| \n  if n % 35 == 0 then \"NamaTeam\"\n  elsif n % 7 == 0 then \"Team\"\n  elsif n % 5 == 0 then \"Nama\"\n  else n end \n}.join(', ')\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9800288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PFU9.jpg?s=128&g=1", "display_name": "gbs0", "link": "https://stackoverflow.com/users/9800288/gbs0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 1, "accepted_answer_id": 50373008, "answer_count": 2, "score": 1, "last_activity_date": 1526480729, "creation_date": 1526478987, "last_edit_date": 1526479692, "question_id": 50372873, "link": "https://stackoverflow.com/questions/50372873/split-integers-in-terminal", "title": "&#39;Split&#39; integers in Terminal", "body": "<p>In <strong>Ruby</strong>, I'm trying to solve a quiz as like a <em>FizzBuzz Challenge</em>. My question is \"How I can print the integer number <code>|n|</code> adding a <strong>comma and space</strong><code>(\", \")</code>at the end of they?\"</p>\n\n<p>To separate the <code>Nama</code>and <code>Team</code> strings I'm using <code>$stdout.print \"Team, \" &amp;&amp; $stdout.print \"Nama, \"</code>. But for the integers my syntax is <code>$stdout.print n</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vzFz6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vzFz6.png\" alt=\"image\"></a></p>\n\n<h3>Code right now:</h3>\n\n<pre><code>puts \"Enter the maximum amount of numbers\"\nprint \"&gt;\"\nupper_limit = gets.chomp.to_i\n\n(1..upper_limit).each do |n|\n\n  if n % 35  == 0\n    $stdout.print \"NamaTeam\"\n\n  elsif n % 7 == 0\n    $stdout.print \"Team, \"\n\n  elsif n % 5 == 0\n    $stdout.print \"Nama, \"\n\n  else\n    $stdout.print n\n  end\nend\n</code></pre>\n\n<p>I already tried to use <code>.join(' ')</code> and <code>.split(' ')</code> methods but they don't work with <code>integer</code> numbers D:</p>\n\n<p>Best Regards for the community!</p>\n"}, {"tags": ["ruby", "ssl", "openssl", "starttls"], "answers": [{"tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": false, "score": 2, "last_activity_date": 1526483664, "last_edit_date": 1526483664, "creation_date": 1526483347, "answer_id": 50374419, "question_id": 50372482, "link": "https://stackoverflow.com/questions/50372482/starttls-connection-with-ruby-and-openssl/50374419#50374419", "title": "STARTTLS connection with Ruby and OpenSSL", "body": "<p>The POP3 specification states that you need to send <code>STLS</code> in order to initiate the TLS handshake. Therefore you should send <code>STLS</code> on the unencrypted socket first, and after that you should be able to call <code>connect</code> on the OpenSSL layer, which will then perform the actual handshake. </p>\n\n<p>If you call <code>connect</code> before sending <code>STLS</code>, the server won't know what is going on, and will interpret it as garbage input. </p>\n\n<p>Working example:</p>\n\n<pre><code>tcp = TCPSocket.new(host, port)\n\nputs tcp.gets\ntcp.puts 'STLS'\nputs tcp.gets\n\nssl_context = OpenSSL::SSL::SSLContext.new\nssl_client  = OpenSSL::SSL::SSLSocket.new(tcp, ssl_context)\n\nssl_client.connect\nputs ssl_client.state\n\nssl_client.puts \"NOOP\"\nputs ssl_client.gets\n</code></pre>\n\n<p>Output: </p>\n\n<pre><code>+OK POP3 ready &lt;2067986403.1526483285@....&gt;\n+OK\nSSLOK\n+OK\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 299999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb10014899c5bc1e75d0460d6cce5b49?s=128&d=identicon&r=PG", "display_name": "Denny", "link": "https://stackoverflow.com/users/299999/denny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526483664, "creation_date": 1526477929, "question_id": 50372482, "link": "https://stackoverflow.com/questions/50372482/starttls-connection-with-ruby-and-openssl", "title": "STARTTLS connection with Ruby and OpenSSL", "body": "<p>Using <code>openssl s_client</code> on the command line I am able to establish a comection to a POP3 server which requires STARTTLS.</p>\n\n<pre><code>openssl s_client -connect pop3.example.com:110 -starttls pop3\n</code></pre>\n\n<p>How can I accomplish the same (especially the <code>-starttls pop</code> part) utilizing Ruby's OpenSSL library:</p>\n\n<pre><code>tcp_socket = TCPSocket.new host, port\nssl_context = OpenSSL::SSL::SSLContext.new\nssl_client = OpenSSL::SSL::SSLSocket.new tcp_socket, ssl_context\nssl_client.connect\n</code></pre>\n"}, {"tags": ["ruby", "binary-search-tree"], "comments": [{"owner": {"reputation": 363, "user_id": 7534274, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/n9TCm.jpg?s=128&g=1", "display_name": "Xullnn", "link": "https://stackoverflow.com/users/7534274/xullnn"}, "edited": false, "score": 1, "creation_date": 1526484619, "post_id": 50372238, "comment_id": 87765895, "body": "<a href=\"https://en.wikipedia.org/wiki/Binary_tree#Methods_for_storing_binary_trees\" rel=\"nofollow noreferrer\">Binary tree</a> is a data structure. But what you were trying to do is building then sorting a binary tree. Which one do you want? If it&#39;s the latter, I think  your code is pretty clear and straightforward. But a little error, your <code>Binary#build_tree</code> method accepts an array, if this array contains many node objects, then the code should be <code>arr.each {|el| add_child(el.value,@root)}</code>, cause you can&#39;t compare an object with an integer."}, {"owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "reply_to_user": {"reputation": 363, "user_id": 7534274, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/n9TCm.jpg?s=128&g=1", "display_name": "Xullnn", "link": "https://stackoverflow.com/users/7534274/xullnn"}, "edited": false, "score": 0, "creation_date": 1526496944, "post_id": 50372238, "comment_id": 87772419, "body": "@Caven Im wanting to Build a binary tree, the sorting is less important to me (Well technically the build should be sorting them correctly as a binary tree is built). Also the &quot;input&quot; is supposed to just simply be an array of numbers never node objects."}, {"owner": {"reputation": 363, "user_id": 7534274, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/n9TCm.jpg?s=128&g=1", "display_name": "Xullnn", "link": "https://stackoverflow.com/users/7534274/xullnn"}, "edited": false, "score": 1, "creation_date": 1526501676, "post_id": 50372238, "comment_id": 87774641, "body": "People who start with a sorted array and pick the midpoint as the first root might want to generate a balanced binary tree."}, {"owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "reply_to_user": {"reputation": 363, "user_id": 7534274, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/n9TCm.jpg?s=128&g=1", "display_name": "Xullnn", "link": "https://stackoverflow.com/users/7534274/xullnn"}, "edited": false, "score": 0, "creation_date": 1526569402, "post_id": 50372238, "comment_id": 87805204, "body": "Thats probably what im thinking of. Typically BST&#39;s are expected unsorted arrays right?"}, {"owner": {"reputation": 363, "user_id": 7534274, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/n9TCm.jpg?s=128&g=1", "display_name": "Xullnn", "link": "https://stackoverflow.com/users/7534274/xullnn"}, "edited": false, "score": 0, "creation_date": 1526573179, "post_id": 50372238, "comment_id": 87807711, "body": "It depends on your main purpose.  If you just wanna construct a binary tree data structure, then you needn&#39;t to consider too much about other things."}], "answers": [{"comments": [{"owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 0, "creation_date": 1526569560, "post_id": 50387442, "comment_id": 87805301, "body": "Thanks! So it sounds like at least my tree building solution was on the right track? these are helpful comments though. Im a bit confused how the <code>to_s</code> correct prints the nodes in order however?"}, {"owner": {"reputation": 363, "user_id": 7534274, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/n9TCm.jpg?s=128&g=1", "display_name": "Xullnn", "link": "https://stackoverflow.com/users/7534274/xullnn"}, "edited": false, "score": 0, "creation_date": 1526572936, "post_id": 50387442, "comment_id": 87807580, "body": "What a lovely answer : )"}, {"owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 0, "creation_date": 1526616002, "post_id": 50387442, "comment_id": 87822595, "body": "Also Im a bit confused at what your saying with defining <code>@parent</code> as well."}, {"owner": {"reputation": 106, "user_id": 5345794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-J-vYOijXsyA/AAAAAAAAAAI/AAAAAAAAXMU/R06rKaWK_vA/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/5345794/guillaume"}, "edited": false, "score": 0, "creation_date": 1526620947, "post_id": 50387442, "comment_id": 87823897, "body": "About your first comment: your solution was definitely on the right track. Not sure what confuses you about <code>to_s</code>; this is what binary trees are about: sorting values, smaller on the left, larger on the right. We print all nodes on the left (by construction only nodes with a value smaller than the root are there), and we finish with the right and larger values. Repeat in sub-trees."}, {"owner": {"reputation": 106, "user_id": 5345794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-J-vYOijXsyA/AAAAAAAAAAI/AAAAAAAAXMU/R06rKaWK_vA/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/5345794/guillaume"}, "edited": false, "score": 0, "creation_date": 1526628269, "post_id": 50387442, "comment_id": 87827047, "body": "And about your comment on <code>@parent</code>, not sure either what confuses you. My only point is to tell you an empty instance variable like <code>@parent</code> exists event the first time you access its value, and is equal to <code>nil</code>."}], "tags": [], "owner": {"reputation": 106, "user_id": 5345794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-J-vYOijXsyA/AAAAAAAAAAI/AAAAAAAAXMU/R06rKaWK_vA/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/5345794/guillaume"}, "is_accepted": true, "score": 3, "last_activity_date": 1526547785, "creation_date": 1526547785, "answer_id": 50387442, "question_id": 50372238, "link": "https://stackoverflow.com/questions/50372238/ruby-is-this-binary-tree-correct/50387442#50387442", "title": "Ruby, is this Binary Tree Correct?", "body": "<p>welcome to the ruby world! Beware you might really like it and never come back to another language :)</p>\n\n<p>Here are some comments I can give you:</p>\n\n<h2>Testing</h2>\n\n<p>First thing when you wonder if your code is correct is to test it with different inputs. You can do it by hand, in the console, or you can write tests that will follow you during the development.</p>\n\n<h3>By printing</h3>\n\n<p>A quick way of testing what you do is to define the <code>to_s</code> method on your <code>Node</code> class. For instance, this will allow to check your tree is ordered:</p>\n\n<pre><code>class Node\n  \u2026\n  def to_s\n     \"#{left} #{value} #{right}\".strip\n  end\nend \n</code></pre>\n\n<p><code>to_s</code> is the default ruby method used when converting an object to a string. You can for instance do:</p>\n\n<pre><code>#&gt; puts BinaryTree.new.build_tree([5, 9, 1, 6])\n1 5 6 9\n</code></pre>\n\n<h3>By testing</h3>\n\n<p>For your peace of mind, you can describe some tests that will allow you to write code, and modify it, and check it is still working. I would suggest minitest for doing it easily.</p>\n\n<pre><code>require 'minitest/autorun'\n\ndescribe BinaryTree do\n  before do\n    @constructor = BinaryTree.new\n  end\n\n  describe 'when given an array' do\n    it 'sorts it' do\n      @constructor.build_tree([1, 3, 2]).to_s.must_equal '1 2 3'\n    end\n  end\n\n  describe 'when given an array with duplicates' do\n    it 'builds the correct tree' do\n      @constructor.build_tree([1, 3, 2, 3]).to_s.must_equal '1 2 3 3'\n    end\n  end\nend\n</code></pre>\n\n<p>You can then run it with <code>ruby -Ilib:test binary_tree.rb</code> if <code>binary_tree.rb</code> is the file where you put your code.</p>\n\n<p>You will see there, as you mentioned, that the duplicate code doesn\u2019t work.\nYou can make it work by removing a condition in the <code>if\u2026elsif</code> block.</p>\n\n<p>Then you wan work on the code and run the test as often as you like so that you are confident you didn\u2019t break anything.</p>\n\n<p>Each time you have an edge case you are not sure your code handles, just put that in a test.</p>\n\n<h2>Counting the nodes</h2>\n\n<p>Your <code>Node.nodes</code> method is probably not what you want if it is supposed to count the number of nodes in your binary tree.\nIt should be in the instance of a <code>Node</code>, not in the class itself: if you have several trees, all nodes are taken into account for each tree.</p>\n\n<h2>Ruby things</h2>\n\n<p>Some of the things you write could be expressed differently in ruby:</p>\n\n<h3>Nil is not necessary</h3>\n\n<p><code>attr_accessor parent</code> is syntactic sugar for</p>\n\n<pre><code>def parent\n  @parent\nend\n\ndef parent=(other)\n  @parent = other\nend\n</code></pre>\n\n<p>In ruby if your instance variable <code>@parent</code> is not declared, it has the value <code>nil</code> by default, and calling <code>node.parent</code> will return <code>nil</code> too.</p>\n\n<p>You don\u2019t need these 2 lines in the initializer:</p>\n\n<pre><code>@left = nil\n@right = nil\n</code></pre>\n\n<h3>Return is not necessary</h3>\n\n<p>When your last instruction in a method is a return, you don\u2019t need the <code>return</code> keyword. That is what I did with the <code>to_s</code> method above.</p>\n\n<h3>Named parameters</h3>\n\n<p>I think it is cleaner to have named parameters when they are not obvious.\nFor instance, calling <code>Node.new(value, node)</code> doesn\u2019t really help understanding what are these 2 parameters for. I get that a node should have a value, but what is this second parameter?</p>\n\n<p>You could define:</p>\n\n<pre><code>def initialize(value, parent: nil)\n  # Same as before\nend\n</code></pre>\n\n<p>and call it with <code>Node.new(value, parent: node)</code>, or <code>Node.new(value)</code></p>\n\n<h2>OO things</h2>\n\n<h3>Moving methods where they belong</h3>\n\n<p>Your <code>BinaryTree#add_child</code> method should be on a node. You are adding a child to the node. Move it there, so you don\u2019t need your second parameter:\n<code>add_child(value, node.right)</code> becomes <code>node.right.add_child(value)</code></p>\n\n<pre><code>class Node\n  ...\n  def add_child(other_value)\n    if other_value &lt; value\n      left.nil? ? self.left = Node.new(other_value, parent: self) : left.add_child(other_value)\n    else\n      right.nil? ? self.right = Node.new(other_value, parent: self) : right.add_child(other_value)\n    end\n  end\nend\n\nclass BinaryTree\n  ...\n  def add_child(value)\n    if @root.nil?\n      @root = Node.new(value)\n    else\n      @root.add_child(value)\n    end\n    @root\n  end\nend\n</code></pre>\n\n<p>While you are there you could also get rid of <code>build_tree</code> in the <code>BinaryTree</code> class, and move it to the <code>Node</code>.</p>\n\n<p>I hope it will help you in your Ruby Journey.</p>\n"}], "owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 50387442, "answer_count": 1, "score": 0, "last_activity_date": 1526547785, "creation_date": 1526477246, "question_id": 50372238, "link": "https://stackoverflow.com/questions/50372238/ruby-is-this-binary-tree-correct", "title": "Ruby, is this Binary Tree Correct?", "body": "<p>So im going through the OdinProject and starting on the \"BinaryTree\" portion. I've written a Binary Tree but only in C++ using pointers. So without pointers it's a little more confusing to me at how the nodes connect:</p>\n\n<pre><code>class Node\n\n  attr_accessor :value, :parent, :left, :right\n  @@nodes = 0\n\n  def self.nodes\n    @@nodes\n  end\n\n  def initialize(value, parent=nil)\n    @value = value\n    @parent = parent\n    @left = nil\n    @right = nil\n    @@nodes += 1\n  end\n\nend\n\n\nclass BinaryTree\n\n  def initialize\n    @root = nil\n  end\n\n  def build_tree(arr)\n    arr.each {|el| add_child(el,@root)}\n    @root\n  end\n\n  def add_child(value,node)\n    if @root.nil?\n      @root = Node.new(value)\n    else\n      if value &lt; node.value\n        node.left.nil? ? node.left = Node.new(value,node) : add_child(value,node.left)\n      elsif value &gt; node.value\n        node.right.nil? ? node.right = Node.new(value,node) : add_child(value,node.right)\n      end\n    end\n    return node\n  end\n\nend\n</code></pre>\n\n<p>I've done some basic print functions, and it SEEMS to be working correctly, but I was wondering if this looks correct to others that understand ruby better. (Sidenote: I realize this does not handle duplicate numbers). Am I missing something with the \"building\" portion of the tree.</p>\n\n<p>The reason im concerned is a see a lot of different \"build\" implementations. One that starts at the midpoint for instance, or is this just for \"Sorted\" arrays?</p>\n"}, {"tags": ["ruby", "selenium", "winium"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1526476194, "post_id": 50371696, "comment_id": 87759509, "body": "<a href=\"https://ruby-doc.org/core-2.2.0/Thread.html#method-i-kill\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.2.0/Thread.html#method-i-kill</a> - says it termintes the thread and schedules another thread to be run?"}, {"owner": {"reputation": 449, "user_id": 6324558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/695946b2499d7dcb2759724e66cfad38?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Delahaye", "link": "https://stackoverflow.com/users/6324558/alexis-delahaye"}, "edited": false, "score": 0, "creation_date": 1526477332, "post_id": 50371696, "comment_id": 87760372, "body": "I did <code>a = Thread.new { &#47;&#47;some infinite loop }</code> , then <code>a.kill</code>, I got :  <code>&lt;Thread:0x00000001542e18@(irb):14 sleep&gt;</code> , so I retried <code>a.kill</code> and got this time <code>&lt;Thread:0x00000001542e18@(irb):14 dead&gt;</code> Maybe you need to kill it twice ?"}, {"owner": {"reputation": 1, "user_id": 9800220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WDP9CKEfEjs/AAAAAAAAAAI/AAAAAAAADyY/L3FnKMlY_GE/photo.jpg?sz=128", "display_name": "Leonardo De Oliveira", "link": "https://stackoverflow.com/users/9800220/leonardo-de-oliveira"}, "edited": false, "score": 0, "creation_date": 1526478286, "post_id": 50371696, "comment_id": 87761067, "body": "I tried and i still see Winium running in TCPView, maybe i have to use socket to close the port and that will do it?"}, {"owner": {"reputation": 1, "user_id": 9800220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WDP9CKEfEjs/AAAAAAAAAAI/AAAAAAAADyY/L3FnKMlY_GE/photo.jpg?sz=128", "display_name": "Leonardo De Oliveira", "link": "https://stackoverflow.com/users/9800220/leonardo-de-oliveira"}, "edited": false, "score": 0, "creation_date": 1526480317, "post_id": 50371696, "comment_id": 87762790, "body": "i found a solution to this, i passed the taskkill ccommand to the console with the image name for winium and did a forceful exec and that does the trick.<code>system (&#39;taskkill &#47;IM Winium.Desktop.Driver.exe &#47;f&#39;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9800220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WDP9CKEfEjs/AAAAAAAAAAI/AAAAAAAADyY/L3FnKMlY_GE/photo.jpg?sz=128", "display_name": "Leonardo De Oliveira", "link": "https://stackoverflow.com/users/9800220/leonardo-de-oliveira"}, "is_accepted": false, "score": 0, "last_activity_date": 1526483968, "creation_date": 1526483968, "answer_id": 50374633, "question_id": 50371696, "link": "https://stackoverflow.com/questions/50371696/closing-a-winium-from-a-thread-with-ruby/50374633#50374633", "title": "Closing a Winium from a thread with Ruby", "body": "<p>I found a solution to this, i passed the taskkill command to the console with the image name for winium and did a forceful exec and that does the trick.\n<code>system ('taskkill /IM Winium.Desktop.Driver.exe /f')</code></p>\n"}], "owner": {"reputation": 1, "user_id": 9800220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WDP9CKEfEjs/AAAAAAAAAAI/AAAAAAAADyY/L3FnKMlY_GE/photo.jpg?sz=128", "display_name": "Leonardo De Oliveira", "link": "https://stackoverflow.com/users/9800220/leonardo-de-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526483968, "creation_date": 1526475742, "last_edit_date": 1526476354, "question_id": 50371696, "link": "https://stackoverflow.com/questions/50371696/closing-a-winium-from-a-thread-with-ruby", "title": "Closing a Winium from a thread with Ruby", "body": "<p>So i'm trying to automate a desktop app using winium and i want to automate the launching of the winium driver thru script, so far i'm able to start it just fine, but when it comes to closing it, that's the problem.</p>\n\n<pre><code>winium = Thread.new{\n   system (\n      File.dirname(__FILE__) \n      +'/Features/Support/support/Winium.Desktop.Driver.exe')\n} \nsleep 5 \nwinium.kill\n</code></pre>\n\n<p>But after i kill the thread, if i check with TCPView i can see that winium is still open, this will cause issues if i try to running the script multiple times without winium closing correctly.. My question is how can i make sure that Winium is stopping after i kill the thread?</p>\n\n<p>i'm working in rubyMine, with ruby 2.4.4 and using the 1.6.0 version of the winium driver.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1526477578, "post_id": 50371370, "comment_id": 87760539, "body": "Hi I think you question was already answered here: <a href=\"https://stackoverflow.com/questions/14197897/categories-and-sub-categories-model-rails#14198034\" title=\"categories and sub categories model rails%2314198034\">stackoverflow.com/questions/14197897/&hellip;</a> try that, or is something not adressed there?"}, {"owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1526477766, "post_id": 50371370, "comment_id": 87760684, "body": "Ah sorry, I actually understand the question now."}, {"owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1526477978, "post_id": 50371370, "comment_id": 87760831, "body": "Are you on Rails 5, did you see this comment in the above question: <a href=\"https://stackoverflow.com/questions/14197897/categories-and-sub-categories-model-rails#comment76815635_14198034\" title=\"categories and sub categories model rails%23comment76815635_14198034\">stackoverflow.com/questions/14197897/&hellip;</a>"}, {"owner": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "reply_to_user": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1526481120, "post_id": 50371370, "comment_id": 87763372, "body": "@Roland Studer  i am on rails 4. Yes i tried this link. I have attached the response of that. It returns nul.. query fired is also wrong"}], "answers": [{"tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": true, "score": 0, "last_activity_date": 1526478041, "creation_date": 1526478041, "answer_id": 50372528, "question_id": 50371370, "link": "https://stackoverflow.com/questions/50371370/how-to-implement-parent-categories-categories-and-subcategories-using-self-refe/50372528#50372528", "title": "How to implement Parent Categories, Categories and Subcategories using self referencing controller in Rails 4", "body": "<p>Try this:</p>\n\n<pre><code>  belongs_to :parent_category, foreign_key: :parent_id, class_name: 'Category'\n  has_many :sub_categories, foreign_key: :parent_id, class_name: 'Category'\n</code></pre>\n"}], "owner": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 50372528, "answer_count": 1, "score": 1, "last_activity_date": 1526478041, "creation_date": 1526474815, "question_id": 50371370, "link": "https://stackoverflow.com/questions/50371370/how-to-implement-parent-categories-categories-and-subcategories-using-self-refe", "title": "How to implement Parent Categories, Categories and Subcategories using self referencing controller in Rails 4", "body": "<p>I am trying to implement a three level deep association using self referencing.</p>\n\n<pre><code>Cat1\n    Sub1\n        SubSub1\n        SubSub2\n    Sub2\nCat2\n    Sub1\nCat3\n    Sub1\n    Sub2\n        SubSub1\n</code></pre>\n\n<p>I am able to get the child category of a category by this relation:</p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n  has_many :sub_categories, class_name: \"Category\", foreign_key: :parent_id\nend\n</code></pre>\n\n<p>This is fine when i have only two level deep category. For three level deep association using self referencing i tried using this relation, but failed to get the desired output.</p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n  belongs_to :parent_category, class_name: \"Category\"\n  has_many :sub_categories, class_name: \"Category\", foreign_key: :parent_id\nend\n</code></pre>\n\n<p>here is what i get using this association.query fired on <code>Category.find(3).parent_category</code> is wrong.</p>\n\n<pre><code>2.0.0-p648 :012 &gt; Category.find(2)\n  Category Load (1.2ms)  SELECT `categories`.* FROM `categories` WHERE `categories`.`id` = 2 LIMIT 1\n =&gt; #&lt;Category id: 2, title: \"Suit\", description: \"sffdsfsxcx ssdfvvs\", seo_name: \"sfsdf\", parent_id: nil, hoe_page: nil, status: true, sequence: \"1\", banner_image_file_name: nil, banner_image_content_type: nil, banner_image_file_size: nil, banner_image_updated_at: nil, image_file_name: nil, image_content_type: nil, image_file_size: nil, image_updated_at: nil, home_description: \"adhkadaa\", home_page: true, long_description: \"sdfsddfffssssde\", created_at: \"2018-04-09 07:42:55\", updated_at: \"2018-04-09 07:42:55\"&gt; \n2.0.0-p648 :013 &gt; Category.find(3)\n  Category Load (1.1ms)  SELECT `categories`.* FROM `categories` WHERE `categories`.`id` = 3 LIMIT 1\n =&gt; #&lt;Category id: 3, title: \"a\", description: \"aaa\", seo_name: \"a\", parent_id: 2, hoe_page: nil, status: true, sequence: \"1\", banner_image_file_name: nil, banner_image_content_type: nil, banner_image_file_size: nil, banner_image_updated_at: nil, image_file_name: nil, image_content_type: nil, image_file_size: nil, image_updated_at: nil, home_description: \"aaa\", home_page: true, long_description: \"aaa\", created_at: \"2018-04-09 09:44:11\", updated_at: \"2018-04-09 09:44:11\"&gt; \n2.0.0-p648 :014 &gt; Category.find(3).parent_category\n  Category Load (1.1ms)  SELECT `categories`.* FROM `categories` WHERE `categories`.`id` = 3 LIMIT 1\n =&gt; nil \n</code></pre>\n\n<p>Please help me here by making me understand what would be the perfect association for my purpose. <strong>Please dont give me gem name like \"Ancestry\" or \"awesome_nested_set\", I need pure rails associations.</strong></p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "api", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1526479440, "post_id": 50371239, "comment_id": 87762027, "body": "If <code>nome</code> is always at the end, then I would suggest <code>split(&#39;-&#39;).last</code> instead of <code>split(&#39;-&#39;)[7]</code>. That way, if <code>split</code> ever results in more than eight elements (these things happen - formats change, someone adds a new element to the file name, etc.), you&#39;ll still get the expected result."}], "answers": [{"tags": [], "owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "is_accepted": true, "score": 2, "last_activity_date": 1526478605, "last_edit_date": 1526478605, "creation_date": 1526477434, "answer_id": 50372303, "question_id": 50371239, "link": "https://stackoverflow.com/questions/50371239/rails-how-to-add-a-custom-attribute-to-json/50372303#50372303", "title": "Rails - How to add a custom attribute to json?", "body": "<p>You can use <a href=\"https://apidock.com/ruby/Hash/merge\" rel=\"nofollow noreferrer\">merge</a>:</p>\n\n<pre><code> files = Arquivo.all.as_json(include: [:tag]).map { |file| file.merge(cut_name: file['nome'].split('-')[7])}\n</code></pre>\n"}], "owner": {"reputation": 2274, "user_id": 7390929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WPB1g.jpg?s=128&g=1", "display_name": "Lucas Andrade", "link": "https://stackoverflow.com/users/7390929/lucas-andrade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "accepted_answer_id": 50372303, "answer_count": 1, "score": 0, "last_activity_date": 1526478605, "creation_date": 1526474406, "question_id": 50371239, "link": "https://stackoverflow.com/questions/50371239/rails-how-to-add-a-custom-attribute-to-json", "title": "Rails - How to add a custom attribute to json?", "body": "<p>I have File class (named as Arquivo, portuguese) in my project, and file has name attribute, it's a big name with some tag's, identifiers and the 'real name\" at the end. So I need to create a new custom param at my json @files to send only the \"real name\"</p>\n\n<p>Name example:</p>\n\n<p><code>CODE-ALM-TAG-TT-TAG-1122-COD12-realNameFile.txt</code></p>\n\n<p>I already try the anwser of this <a href=\"https://stackoverflow.com/questions/3146980/how-to-append-data-to-json-in-ruby-rails\">almost duplicate question here</a> but here he include the same param <code>message: \"it works\"</code> in all elements of array, and I need a diffente param for each element</p>\n\n<p>I already did something that works but it's ugly, I think that has an easier way to do it:</p>\n\n<pre><code>def all_files\n  files = Arquivo.all.as_json(include: [:tag])\n  files = add_cut_name(files)\n  render json: { files: files }\nend\n\ndef add_cut_name(files)\n  files.each do |file|\n    file[\"cut_name\"] = file[\"nome\"].split('-')[7]\n  end\n  files\nend\n</code></pre>\n\n<p>I am thinking in something like this:</p>\n\n<pre><code>def all_files\n  files = Arquivo.all.as_json(include: [:tag], cut_name: [\"nome\"].split('-')[7])\n  render json: { files: files }\nend\n</code></pre>\n\n<p>But this didn't work</p>\n"}, {"tags": ["ruby", "cucumber", "appium"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1526469095, "post_id": 50369311, "comment_id": 87754583, "body": "Define a nightly cron job that will delete all files older than 1 day in that folder?"}, {"owner": {"reputation": 106, "user_id": 1093170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/773880eb1e62554ec182c19ddf861c85?s=128&d=identicon&r=PG&f=1", "display_name": "iLion", "link": "https://stackoverflow.com/users/1093170/ilion"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1526469647, "post_id": 50369311, "comment_id": 87754931, "body": "Thanks for your answer :)"}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 4963904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67998ed6039e6be2eaef900eeba691d?s=128&d=identicon&r=PG&f=1", "display_name": "Vitthal Bobade", "link": "https://stackoverflow.com/users/4963904/vitthal-bobade"}, "is_accepted": true, "score": 1, "last_activity_date": 1526469733, "last_edit_date": 1526469733, "creation_date": 1526469594, "answer_id": 50369536, "question_id": 50369311, "link": "https://stackoverflow.com/questions/50369311/appium-tests-screenshot-folder-delete-programmatically/50369536#50369536", "title": "Appium Tests Screenshot folder delete programmatically", "body": "<p>You can write below code in hooks.rb file. It will delete all the screenshots before creating new screen shots for each new report.</p>\n\n<pre><code>AfterConfiguration do\n  FileUtils.rm_r(\"screenshots_folder_name\") if File.directory?(\"screenshots_folder_name\")\nend\n</code></pre>\n"}], "owner": {"reputation": 106, "user_id": 1093170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/773880eb1e62554ec182c19ddf861c85?s=128&d=identicon&r=PG&f=1", "display_name": "iLion", "link": "https://stackoverflow.com/users/1093170/ilion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 50369536, "answer_count": 1, "score": 1, "last_activity_date": 1526469733, "creation_date": 1526468989, "question_id": 50369311, "link": "https://stackoverflow.com/questions/50369311/appium-tests-screenshot-folder-delete-programmatically", "title": "Appium Tests Screenshot folder delete programmatically", "body": "<p>I am taking screen shots on each scenarios for report purpose. But folder size is increasing each time. Is there any way to delete old screen shots automatically?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5742, "user_id": 9411789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf2e95bbcd5e90f257443fd94c7b846?s=128&d=identicon&r=PG&f=1", "display_name": "PPL", "link": "https://stackoverflow.com/users/9411789/ppl"}, "edited": false, "score": 0, "creation_date": 1526468232, "post_id": 50368963, "comment_id": 87754024, "body": "try this, <a href=\"http://codingpad.maryspad.com/2017/04/29/update-mac-os-x-to-the-current-version-of-ruby/\" rel=\"nofollow noreferrer\">codingpad.maryspad.com/2017/04/29/&hellip;</a>"}, {"owner": {"reputation": 11593, "user_id": 8090893, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/76d11d82f4b09abd8412c30342b4e71e?s=128&d=identicon&r=PG&f=1", "display_name": "iOS", "link": "https://stackoverflow.com/users/8090893/ios"}, "reply_to_user": {"reputation": 5742, "user_id": 9411789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf2e95bbcd5e90f257443fd94c7b846?s=128&d=identicon&r=PG&f=1", "display_name": "PPL", "link": "https://stackoverflow.com/users/9411789/ppl"}, "edited": false, "score": 0, "creation_date": 1526468476, "post_id": 50368963, "comment_id": 87754170, "body": "@ PPL when I try this command curl -L <a href=\"https://get.rvm.io\" rel=\"nofollow noreferrer\">get.rvm.io</a> | bash -s stable.  I&#39;m getting NOTE: GPG version 2.1.17 have a bug which cause failures during fetching keys from remote server. Please downgrade or upgrade to newer version (if available) or use the second method described above."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526471339, "post_id": 50368963, "comment_id": 87756055, "body": "@iOS Have you googled the error: &quot;NOTE: GPG version 2.1.17 have a bug which cause failures during fetching keys from remote server. Please downgrade or upgrade to newer version (if available) or use the second method described above.&quot;? What have you found? What have you tried? I could make some suggestions, but I&#39;d basically just be copy+pasting some information from a quick google search, which seems really counterproductive."}, {"owner": {"reputation": 11593, "user_id": 8090893, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/76d11d82f4b09abd8412c30342b4e71e?s=128&d=identicon&r=PG&f=1", "display_name": "iOS", "link": "https://stackoverflow.com/users/8090893/ios"}, "edited": false, "score": 0, "creation_date": 1526471431, "post_id": 50368963, "comment_id": 87756109, "body": "When I run this command &quot;gpg2 --recv-keys 409B6B1796C275462A1703113804BB82D3C0E3&quot;, Getting -bash: gpg2: command not found. And when I run &quot;curl -sSL <a href=\"https://rvm.io/mpapis.asc\" rel=\"nofollow noreferrer\">rvm.io/mpapis.asc</a> | gpg --import -&quot;, Getting gpg: key 3804BB82D39DE3: 47 signatures not checked due to missing keys gpg: key 3804BB82D39DE3: &quot;Michal Papis (RVM signing) &lt;mpapis@gmail.com&gt;&quot; not changed gpg: Total number processed: 1 gpg:              unchanged: 1"}, {"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1526471531, "post_id": 50368963, "comment_id": 87756179, "body": "Using homebrew to install <code>rvm</code> or <code>rbenv</code> (my personal choice) is easier and avoids this."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526471572, "post_id": 50368963, "comment_id": 87756204, "body": "@iOS Please can you <a href=\"https://stackoverflow.com/posts/50368963/edit\">edit your question</a> with a clear description of what you tried (where did you get that information?), along with the results. Drip-feeding information in the comments makes it much harder for people to properly understand your question."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526471701, "post_id": 50368963, "comment_id": 87756292, "body": "The <code>gem env</code>, <code>ruby -v</code> and links you provided don&#39;t really affect the problem. The <b>only</b> information above that&#39;s really crucial is: &quot;I do not have RVM installed. I want to install ruby 2.5.1. When I install RVM with &lt;command&gt;, I get the error: &lt;full error message&gt;. I found similar problems here: &lt;link&gt;. When I tried that, I got this error: &lt;full error&gt;&quot;."}, {"owner": {"reputation": 11593, "user_id": 8090893, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/76d11d82f4b09abd8412c30342b4e71e?s=128&d=identicon&r=PG&f=1", "display_name": "iOS", "link": "https://stackoverflow.com/users/8090893/ios"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526472046, "post_id": 50368963, "comment_id": 87756564, "body": "@Tom Lord thank you, I updated my question"}], "answers": [{"tags": [], "owner": {"reputation": 11593, "user_id": 8090893, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/76d11d82f4b09abd8412c30342b4e71e?s=128&d=identicon&r=PG&f=1", "display_name": "iOS", "link": "https://stackoverflow.com/users/8090893/ios"}, "is_accepted": true, "score": 7, "last_activity_date": 1543159698, "last_edit_date": 1543159698, "creation_date": 1526474587, "answer_id": 50371306, "question_id": 50368963, "link": "https://stackoverflow.com/questions/50368963/update-ruby-in-mac/50371306#50371306", "title": "update ruby in mac", "body": "<p>Finally i updated successfully with the help of these links...</p>\n\n<p><a href=\"https://www.computersnyou.com/5307/setup-homebrew-and-rvm-on-mac-osx-10-11-ei-capitan/\" rel=\"noreferrer\">https://www.computersnyou.com/5307/setup-homebrew-and-rvm-on-mac-osx-10-11-ei-capitan/</a></p>\n\n<p>I typed this command, </p>\n\n<pre><code>\\curl -sSL https://get.rvm.io | bash -s stable\n</code></pre>\n\n<p>After that i used this command, </p>\n\n<pre><code>type rvm | head -n 1\n</code></pre>\n\n<p>It's printing \"rvm is a function\"</p>\n\n<p>After that i used this command, </p>\n\n<pre><code>rvm install ruby-head\n</code></pre>\n\n<p>After some time RVM installed.</p>\n\n<p>When i type this command </p>\n\n<pre><code>ruby -v\n</code></pre>\n\n<p>I'm getting this message \"ruby 2.6.0dev (2018-05-16 trunk 63444) [x86_64-darwin17]\"</p>\n"}], "owner": {"reputation": 11593, "user_id": 8090893, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/76d11d82f4b09abd8412c30342b4e71e?s=128&d=identicon&r=PG&f=1", "display_name": "iOS", "link": "https://stackoverflow.com/users/8090893/ios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6409, "favorite_count": 0, "accepted_answer_id": 50371306, "answer_count": 1, "score": 2, "last_activity_date": 1552731573, "creation_date": 1526467903, "last_edit_date": 1552731573, "question_id": 50368963, "link": "https://stackoverflow.com/questions/50368963/update-ruby-in-mac", "title": "update ruby in mac", "body": "<p>I do not have RVM installed. I want to install ruby 2.5.1. When I install RVM with \"rvm install ruby-2.5.1\", I get the error: \"-bash: rvm: command not found\".</p>\n\n<p>My default ruby version in my iMac is 2.3.3</p>\n\n<p>When I run \"ruby -v\" I'm getting this,</p>\n\n<pre><code>ruby 2.3.3p222 (2016-11-21 revision 56859) [universal.x86_64-darwin17]\n</code></pre>\n\n<p>But the latest version is 2.5.1</p>\n\n<p>When I try to install rvm it's getting this message.</p>\n\n<p>NOTE: GPG version 2.1.17 have a bug which cause failures during fetching keys from remote server. Please downgrade or upgrade to newer version (if available) or use the second method described above.</p>\n\n<p>I tried these to solve my problem URL's to solve, but no use.</p>\n\n<p><a href=\"http://railsapps.github.io/installrubyonrails-mac.html\" rel=\"nofollow noreferrer\">http://railsapps.github.io/installrubyonrails-mac.html</a></p>\n\n<p><a href=\"https://www.ruby-lang.org/en/downloads/\" rel=\"nofollow noreferrer\">https://www.ruby-lang.org/en/downloads/</a></p>\n\n<p><a href=\"https://blog.arkency.com/which-ruby-version-am-i-using-how-to-check/\" rel=\"nofollow noreferrer\">https://blog.arkency.com/which-ruby-version-am-i-using-how-to-check/</a></p>\n\n<p>When I enter \"gem env\"</p>\n\n<pre><code>RubyGems Environment:\n - RUBYGEMS VERSION: 2.5.2\n  - RUBY VERSION: 2.3.3 (2016-11-21 patchlevel 222) [universal.x86_64-darwin17]\n  - INSTALLATION DIRECTORY: /Library/Ruby/Gems/2.3.0\n  - USER INSTALLATION DIRECTORY: /Users/research/.gem/ruby/2.3.0\n  - RUBY EXECUTABLE: /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby\n  - EXECUTABLE DIRECTORY: /usr/local/bin\n  - SPEC CACHE DIRECTORY: /Users/research/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /Library/Ruby/Site\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - universal-darwin-17\n  - GEM PATHS:\n     - /Library/Ruby/Gems/2.3.0\n     - /Users/research/.gem/ruby/2.3.0\n     - /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/gems/2.3.0\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /usr/local/bin\n     - /usr/bin\n     - /bin\n     - /usr/sbin\n     - /sbin\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 3, "creation_date": 1526466599, "post_id": 50368389, "comment_id": 87752948, "body": "That is how <code>ensure</code> is designed to work. That is the whole point. Are you expecting particular implementation details of <code>ensure</code>? That probably depends on the Ruby implementation."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1526472010, "post_id": 50368389, "comment_id": 87756534, "body": "The question of the day: what would happen if you <b><code>return</code> from <code>ensure</code></b>?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526472294, "post_id": 50368389, "comment_id": 87756757, "body": "According to the Ruby ISO Standard: &quot;The <i>ensure-clause</i> of a <i>body-statement</i>, if any, is always evaluated, even when the evaluation of <i>body-statement</i> is terminated by a <i>jump-expression</i>.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1526471507, "post_id": 50368514, "comment_id": 87756165, "body": "While I like the printer idea, implementations that follow <a href=\"https://github.com/ruby/spec\" rel=\"nofollow noreferrer\">github.com/ruby/spec</a> have a bit less liberty here ;-)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1526471787, "post_id": 50368514, "comment_id": 87756361, "body": "@MichaelKohl \u201c<i>Some</i> interpreters\u201d might disrespect the <i>ruby</i> spec :)"}, {"owner": {"reputation": 1321, "user_id": 1025695, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8980c65a94bb9a9a5526d464791b7644?s=128&d=identicon&r=PG", "display_name": "Huliax", "link": "https://stackoverflow.com/users/1025695/huliax"}, "reply_to_user": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 1, "creation_date": 1526823005, "post_id": 50368514, "comment_id": 87884748, "body": "I wish I could accept two answers.  If I had decided to be lazy about things then this would have been it.  It turned out to be good for me to work through the source and the answer by @MichaelKohl led me to that."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1526466658, "creation_date": 1526466658, "answer_id": 50368514, "question_id": 50368389, "link": "https://stackoverflow.com/questions/50368389/what-happens-during-begin-return-ensure/50368514#50368514", "title": "What happens during `begin; return; ensure`?", "body": "<blockquote>\n  <p>when <em>you</em> encounter a <code>return</code> statement then <em>you</em> </p>\n</blockquote>\n\n<p>When <strong>MRI</strong> encounters the <code>return</code> statement, it does <strong>something</strong>. Some interpreters might print <code>\"FOO\"</code> to the printer; that is located in your boss\u2019 room :)</p>\n\n<blockquote>\n  <p>pop the call off the stack and return the value specified by <code>return</code></p>\n</blockquote>\n\n<p>Almost. When <strong>MRI</strong> encounters the <code>return</code> statement, it <em>calls the <code>ensure</code> block if it exists</em> and <strong>then</strong> pops the call off the stack.</p>\n\n<p>The thing is there is no mandatory rule that <code>return</code> must do something special, graved in stone. Ruby interpreter (and some others) does it that way.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1526470576, "creation_date": 1526470576, "answer_id": 50369902, "question_id": 50368389, "link": "https://stackoverflow.com/questions/50368389/what-happens-during-begin-return-ensure/50369902#50369902", "title": "What happens during `begin; return; ensure`?", "body": "<p><code>return</code> assigns a value to the method, even if the execution goes trough <code>ensure</code> block.</p>\n\n<p>For example:</p>\n\n<pre><code>def foo\n  begin\n    puts txt = 'foo'\n    return txt\n  ensure\n    puts 'bar'\n  end\n  puts txt = 'baz'\n  return txt\nend\n\np foo\n</code></pre>\n\n<p>Puts \"foo\" and \"bar\" but not \"baz\". Also foo method returns the string \"foo\".</p>\n"}, {"tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": true, "score": 2, "last_activity_date": 1526471140, "creation_date": 1526471140, "answer_id": 50370092, "question_id": 50368389, "link": "https://stackoverflow.com/questions/50368389/what-happens-during-begin-return-ensure/50370092#50370092", "title": "What happens during `begin; return; ensure`?", "body": "<p>This is just the way it's defined in MRI, more specifically in the function <code>rb_ensure</code> in <a href=\"https://github.com/ruby/ruby/blob/02c1358be526e0fec672a420df80cd7d25ef1eae/eval.c#L1022-L1064\" rel=\"nofollow noreferrer\">eval.c</a> (I snipped the actual implementation, but essentially it just generates a Ruby execution context, executes the block in that context and then makes sure that all <code>ensure</code> blocks are run one after the other:</p>\n\n<pre><code>* Equivalent to &lt;code&gt;begin .. ensure .. end&lt;/code&gt;.\n *\n * Calls the function \\a b_proc with \\a data1 as the argument,\n * then calls \\a e_proc with \\a data2 when execution terminated.\n * \\return The return value of \\a b_proc if no exception occurred,\n *   or \\c Qnil if otherwise.\n * \\sa rb_rescue\n * \\sa rb_rescue2\n * \\sa rb_protect\n * \\ingroup exception\n */\nVALUE\nrb_ensure(VALUE (*b_proc)(ANYARGS), VALUE data1, VALUE (*e_proc)(ANYARGS), VALUE data2)\n{\n    ...\n}\n</code></pre>\n\n<p>If you're interested in how the parser decides to call this faction, look at <code>parse.y</code> it's part of the rules for <code>bodystmt</code>.</p>\n"}], "owner": {"reputation": 1321, "user_id": 1025695, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8980c65a94bb9a9a5526d464791b7644?s=128&d=identicon&r=PG", "display_name": "Huliax", "link": "https://stackoverflow.com/users/1025695/huliax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 50370092, "answer_count": 3, "score": 2, "last_activity_date": 1526471140, "creation_date": 1526466308, "last_edit_date": 1526466859, "question_id": 50368389, "link": "https://stackoverflow.com/questions/50368389/what-happens-during-begin-return-ensure", "title": "What happens during `begin; return; ensure`?", "body": "<p>I was looking into the internals of a gem, and ran into the following pattern:</p>\n\n<pre><code>def foo\n  begin\n    return 'foo'\n  ensure\n    puts 'bar'\n  end\nend\nfoo\n</code></pre>\n\n<p>This will print the strings <code>'foo'</code> and <code>'bar'</code> to <code>STDOUT</code>. How does this happen? My naive understanding would be that when you encounter a <code>return</code> statement, then you pop the call off the stack and return the value specified by return. I would imagine that if this were the case, then you would not then be able to execute the <code>ensure</code> block. Obviously the <code>ensure</code> block is executed. I'm curious as to how this is happening.  How is this behavior implemented?</p>\n"}, {"tags": ["ruby", "testing", "minitest", "assertions"], "answers": [{"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 4, "last_activity_date": 1526464895, "creation_date": 1526464895, "answer_id": 50367881, "question_id": 50367812, "link": "https://stackoverflow.com/questions/50367812/is-assert-equal-or-assert-equal-possible-in-ruby-minitest/50367881#50367881", "title": "Is `assert_equal ... or assert_equal ...` possible in ruby minitest?", "body": "<p>If you want to match any one of the object having the given name, you can use <a href=\"https://apidock.com/ruby/v1_9_3_125/MiniTest/Assertions/assert_includes\" rel=\"nofollow noreferrer\">assert_includes</a></p>\n\n<pre><code>asset_one = Cache.asset_one\nasset_two = Cache.asset_two\n\nassert_includes([asset_one, asset_two].map(&amp;:name), Pages.name)\n</code></pre>\n\n<p>This should solve your purpose.</p>\n"}], "owner": {"reputation": 45, "user_id": 8366368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7e00f18157eb434739dc4d50250d6f?s=128&d=identicon&r=PG&f=1", "display_name": "JackGruber", "link": "https://stackoverflow.com/users/8366368/jackgruber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 50367881, "answer_count": 1, "score": 1, "last_activity_date": 1526465866, "creation_date": 1526464719, "last_edit_date": 1526465866, "question_id": 50367812, "link": "https://stackoverflow.com/questions/50367812/is-assert-equal-or-assert-equal-possible-in-ruby-minitest", "title": "Is `assert_equal ... or assert_equal ...` possible in ruby minitest?", "body": "<p>I am creating a test that can be expressed as a disjunction of assertions; when the first assertion fails, then it should look at the next. Particularly, an item will be equal to one of two things. Which one, I do not know.</p>\n\n<p>My code looks something like this. It does not work but it might give you an idea of what I am trying to do.</p>\n\n<pre><code>asset_one = Cache.asset_one\nasset_two = Cache.asset_two\n\nassert_equal(asset_one.name, Pages.name) or \nassert_equal(asset_two.name, Pages.name)\n</code></pre>\n\n<p>The <code>Pages.name</code> should match one of the targets. I don't know which one. If it doesn't match the first, then I want it to skip it and try to match the second. </p>\n\n<p>Any help is as always much appreciated.</p>\n"}, {"tags": ["ruby", "apache", "rubygems", "passenger", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 2186942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/718d0dab0427431898dc3cdf06faa92b?s=128&d=identicon&r=PG", "display_name": "Jussi Hirvi", "link": "https://stackoverflow.com/users/2186942/jussi-hirvi"}, "is_accepted": false, "score": 0, "last_activity_date": 1529611927, "creation_date": 1529611927, "answer_id": 50976785, "question_id": 50367352, "link": "https://stackoverflow.com/questions/50367352/how-to-sort-out-multiple-versions-of-ruby-passenger-and-rack-under-apache/50976785#50976785", "title": "How to sort out multiple versions of Ruby, Passenger and Rack (under Apache)", "body": "<p>Can you use <a href=\"https://rvm.io\" rel=\"nofollow noreferrer\">RVM</a>? It should help you manage several rubies and gemsets. </p>\n\n<p>In my system I noticed that one Passenger module is enough, just like the documentation says. I installed it with <code>gem install passenger</code>in an otherwise empty gemset. </p>\n\n<p>One confusing thing I noticed is that the <code>PassengerRuby</code>directive (in the case of Apache) for each VirtualHost should point to each app's gemset, <em>not</em> to the gemset where the Passenger module is installed, nor to any generic (anonymous) gemset. Otherwise you will get confusing multitude of overlapping gemsets. The ruby version mentioned in the <code>PassengerRuby</code> does not need to be the same that Passenger was compiled against. Example from my CentOS installation: </p>\n\n<pre><code>PassengerRuby /usr/local/rvm/gems/ruby-2.4.2@gemset-of-my-app/wrappers/ruby\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 198420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce42c8db6cff8cef4e63b696e30c88e?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/198420/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529611927, "creation_date": 1526463565, "last_edit_date": 1526467144, "question_id": 50367352, "link": "https://stackoverflow.com/questions/50367352/how-to-sort-out-multiple-versions-of-ruby-passenger-and-rack-under-apache", "title": "How to sort out multiple versions of Ruby, Passenger and Rack (under Apache)", "body": "<p>I have a classic \"monolith\" server running multiple Ruby-applications under Passenger. According to the Passenger documentation this should work fine, but I've found a few problems that I need help to sort out.</p>\n\n<p>The documentation states:</p>\n\n<blockquote>\n  <p>Passenger may be installed with any Ruby interpreter. Once installed,\n  you can run Passenger's Ruby parts under any Ruby interpreter you\n  want, even if that Ruby interpreter was not the one you originally\n  installed Passenger with.</p>\n  \n  <p>[---]</p>\n  \n  <p>Passenger is also capable of running Ruby web applications under any\n  Ruby interpreter you want. So it is not important which Ruby you use\n  to install Passenger: it will work regardless. Please refer to the\n  documentation for the passenger_ruby directive to learn how run\n  different web applications under different Ruby interpreters.</p>\n</blockquote>\n\n<p>I have installed Passenger and the Apache module using an official package for my SLES distribution. It is a rather old version (5.0.18), but since the distribution is still maintained it is patched to fix any known security vulnerabilities. This Passenger of course is installed under the system Ruby.</p>\n\n<p>I also have multiple other Rubies installed. If I point to a fresh install using the PassengerRuby directive, it complains that passenger is not found. I've realized <em>I need to have Passenger installed under each Ruby interpreter</em> to be able to start the application. (I haven't seen this explained in the documentation.) This poses a problem though. When installing Passenger under my new Ruby, I use rubygems directly, not the RPM. I can try to select the same version as the RPM (5.0.18) but then it would be a non-patched version. I can also just let the gem command pick the latest (most patched) version, but then the application won't start:</p>\n\n<pre><code>App 21959 stderr: /opt/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/passenger-5.3.0/src/ruby_supportlib/phusion_passenger/loader_shared_helpers.rb:941:in `try_write_file': undefined method `try_write_file' for #&lt;Hash:0x0000560031e58c88&gt; (NoMethodError)\nApp 21959 stderr:   from /opt/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/passenger-5.3.0/src/ruby_supportlib/phusion_passenger/loader_shared_helpers.rb:522:in `dump_envvars'\nApp 21959 stderr:   from /opt/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/passenger-5.3.0/src/ruby_supportlib/phusion_passenger/loader_shared_helpers.rb:464:in `dump_all_information'\nApp 21959 stderr:   from /opt/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/passenger-5.3.0/src/ruby_supportlib/phusion_passenger/loader_shared_helpers.rb:394:in `about_to_abort'\nApp 21959 stderr:   from /usr/lib64/passenger/5.0.18//helper-scripts/rack-preloader.rb:89:in `rescue in init_passenger'\nApp 21959 stderr:   from /usr/lib64/passenger/5.0.18//helper-scripts/rack-preloader.rb:72:in `init_passenger'\nApp 21959 stderr:   from /usr/lib64/passenger/5.0.18//helper-scripts/rack-preloader.rb:152:in `&lt;module:App&gt;'\nApp 21959 stderr:   from /usr/lib64/passenger/5.0.18//helper-scripts/rack-preloader.rb:29:in `&lt;module:PhusionPassenger&gt;'\nApp 21959 stderr:   from /usr/lib64/passenger/5.0.18//helper-scripts/rack-preloader.rb:28:in `&lt;main&gt;'\n</code></pre>\n\n<p>It looks like a helper script from the \"main\" Passenger hooks into the newer Passenger. And I guess the error is because som API may have changed?</p>\n\n<p>So this is my first problem \u2013 does the installed Passenger require each used Ruby interpreter to have it's own installation of the exact same version of Passenger? How do you handle this?</p>\n\n<p>Now let's say I've solved the first step and have compatible Passengers installed. Then I try to start the app again:</p>\n\n<pre><code>App 1407 stdout: \n[ 2018-05-15 21:34:57.4890 1367/7f1eda77b700 App/Implementation.cpp:303 ]: Could not spawn process for application /myApp: An error occured while starting up the preloader.\n  Error ID: 5a8f172f\n  Error details saved to: /var/run/passenger/passenger-error-XwWBnN.html\n  Message from application: You have already activated rack 2.0.5, but your Gemfile requires rack 2.0.3. Prepending `bundle exec` to your command may solve this. (Gem::LoadError)\n</code></pre>\n\n<p>Turns out that Passenger itself has a dependency on Rack. The gem sucked in the latest version, which was Rack 2.0.5. Passenger loads this version and then executes Bundler setup. But the application is locked to version 2.0.3. Prepending bundle exec to the PassengerRuby directive doesn't solve it, as then Passenger itself won't be available - unless I add it to the Gemfile, which the documentation <a href=\"https://www.phusionpassenger.com/library/indepth/ruby/bundler.html#does-passenger-itself-need-to-be-added-to-the-gemfile\" rel=\"nofollow noreferrer\">quite clearly states</a> should not be necessary.</p>\n\n<p>So I can synchronize these versions, but then I will need to synchronize the Rack version across <em>all</em> applications under a specific Ruby interpreter. This greatly reduces the benefit of bundler, it was meant to solve this kind of problems. Or I need to couple my applications to the current deployment method. What is the best (least bad) way to solve this?</p>\n"}, {"tags": ["ruby", "appium"], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 1093170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/773880eb1e62554ec182c19ddf861c85?s=128&d=identicon&r=PG&f=1", "display_name": "iLion", "link": "https://stackoverflow.com/users/1093170/ilion"}, "is_accepted": true, "score": 1, "last_activity_date": 1526478716, "last_edit_date": 1526478716, "creation_date": 1526463627, "answer_id": 50367378, "question_id": 50367209, "link": "https://stackoverflow.com/questions/50367209/appium-driver-os-name/50367378#50367378", "title": "Appium driver OS name", "body": "<p>You can check as below. \nThis line of code will return true if you are using android driver otherwise false.</p>\n\n<pre><code>$driver.device_is_android?\n</code></pre>\n\n<p>Above line of code will work only after initializing driver. </p>\n"}], "owner": {"reputation": 156, "user_id": 4963904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67998ed6039e6be2eaef900eeba691d?s=128&d=identicon&r=PG&f=1", "display_name": "Vitthal Bobade", "link": "https://stackoverflow.com/users/4963904/vitthal-bobade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 1, "accepted_answer_id": 50367378, "answer_count": 1, "score": 1, "last_activity_date": 1526478716, "creation_date": 1526463194, "last_edit_date": 1526464100, "question_id": 50367209, "link": "https://stackoverflow.com/questions/50367209/appium-driver-os-name", "title": "Appium driver OS name", "body": "<p>While writing script for Android and iOS in single file. How to check appium driver is created for iOS or Android? I have tried to check for version release but it gives build version only. </p>\n"}, {"tags": ["ruby", "gtk", "ruby-gnome2"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526460887, "post_id": 50366132, "comment_id": 87748953, "body": "I have a slight guess (from my past memory) that your OS setting might be having priority over your setting in the Gtk app. Is the color that you currently see the color that you see in other apps on your environment?"}, {"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528906216, "post_id": 50366132, "comment_id": 88687084, "body": "Best way is to utilize CSS, Gtk3 supports it. To know which class text-highlight inherits from, you can use Gtk inspector. Its like your Chrome console."}], "owner": {"reputation": 953, "user_id": 2733453, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1108602033/picture?type=large", "display_name": "Rahul Vijay Dawda", "link": "https://stackoverflow.com/users/2733453/rahul-vijay-dawda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526460028, "creation_date": 1526460028, "question_id": 50366132, "link": "https://stackoverflow.com/questions/50366132/text-highlight-color-with-gtk", "title": "Text highlight color with Gtk", "body": "<p>I am developing a desktop application with Gtk. When designing a dialog that has a textbox, I noticed that the text highlight color was not matching the UI design requirements. The color I see by default is shade of blue but I'd like it to be a shade of orange. See the attached image for clarity.<a href=\"https://i.stack.imgur.com/cADBd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cADBd.png\" alt=\"Image Link\"></a></p>\n\n<p>I have tried things like setting the background/base but it doesn't work.</p>\n\n<pre><code>entry.modify_bg(Gtk::STATE_SELECTED,Gdk::Color.parse(\"orange\"))\n</code></pre>\n\n<p>Any idea how I can get it to work the way I want? For what it's worth, I'm programming in Ruby with Gtk as the front end framework.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1526457029, "post_id": 50364920, "comment_id": 87746491, "body": "<code>Set.ancestors[1..-1].any? { |klass| klass.public_method_defined?(:add) }  =&gt; false</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 5, "creation_date": 1526457153, "post_id": 50364920, "comment_id": 87746573, "body": "This way of monkeypatching is obsolete anyway, with the advent of <code>Module#prepend</code>. Read up on it, if you&#39;re not familiar. It allows you to amend existing classes <b>and</b> use super. :)"}], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 5, "last_activity_date": 1526456844, "last_edit_date": 1526456844, "creation_date": 1526456658, "answer_id": 50365056, "question_id": 50364920, "link": "https://stackoverflow.com/questions/50364920/cant-call-super-when-monkeypatching-setadd/50365056#50365056", "title": "Can&#39;t call super when monkeypatching Set#add", "body": "<blockquote>\n  <p>Why doesn't it work to call <code>super</code>?</p>\n</blockquote>\n\n<p>It is because <code>Set#add</code> is defined right on <code>Set</code> itself, and not on any of its super classes. And you're overwriting that definition.</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526463091, "post_id": 50366857, "comment_id": 87750548, "body": "Another option is to patch a single instance via <code>extend</code>, e.g. <code>s.extend(AddWithMultipleArgs)</code> which also allows <code>super</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1526463215, "post_id": 50366857, "comment_id": 87750637, "body": "&quot;injecting above&quot; - Interesting wording. In your mental image, does the ancestors chain go <i>down</i>? In mine, the chain grows from bottom up."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1526465078, "post_id": 50366857, "comment_id": 87751943, "body": "@SergioTulentsev what do you mean by <i>&quot;grows from bottom up&quot;</i> \u2013 in your mental model, is <code>BasicObject</code> at the top or at the bottom?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526465153, "post_id": 50366857, "comment_id": 87751991, "body": "@Stefan: at the top."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1526465716, "post_id": 50366857, "comment_id": 87752355, "body": "@SergioTulentsev that aligns with my model. It&#39;s also the way family trees and class diagrams are usually drawn \u2013 parent / superclass on top, child / subclass below (super = above, sub = under)."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526465864, "post_id": 50366857, "comment_id": 87752446, "body": "@Stefan: indeed."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526465923, "post_id": 50366857, "comment_id": 87752482, "body": "Who said &quot;injecting above&quot;? I said &quot;before&quot; :P Anyway, linguistics aside, the important conceptual point is just to understand where each method is actually defined, and the order of their delegation."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 3, "last_activity_date": 1526463286, "last_edit_date": 1526463286, "creation_date": 1526462233, "answer_id": 50366857, "question_id": 50364920, "link": "https://stackoverflow.com/questions/50364920/cant-call-super-when-monkeypatching-setadd/50366857#50366857", "title": "Can&#39;t call super when monkeypatching Set#add", "body": "<p>If you override a method, then you're changing its definition. Calling <code>super</code> will not work; the original method does <em>not</em> still exist as something to forward the message call on to.</p>\n\n<p>There are a few ways to solve this. The \"classical\" way would be to not override the method at all, and instead define your own <strong>subclass</strong> of <code>Set</code>:</p>\n\n<pre><code>require 'set'\nclass MySet &lt; Set\n def add(*args)\n    args.each { |arg| super arg }\n    self\n  end\nend\ns = MySet.new\ns.add 1,2\n#=&gt; #&lt;MySet: {1, 2}&gt;\n</code></pre>\n\n<p>...But this may not be ideal since you'll need to reference <code>MySet</code> (or whatever you call it) all over the codebase, instead of <code>Set</code>.</p>\n\n<p>If you want to modify the behaviour of <code>Set</code> directly, then the \"old-school\" ruby way (<em>no longer recommended</em>, as of ruby <code>v2.0+</code>) is to  to <code>alias</code> the original method to a different name, then create your own version and call the original:</p>\n\n<pre><code>require 'set'\nclass Set\n  alias_method :original_add, :add\n  def add(*args)\n    args.each { |arg| original_add(arg) }\n    self\n  end  \nend\ns = Set.new\ns.add 1,2\n#=&gt; #&lt;Set: {1, 2}&gt;\n</code></pre>\n\n<p>Rails also used to provide a helper method: <a href=\"https://apidock.com/rails/ActiveSupport/CoreExtensions/Module/alias_method_chain\" rel=\"nofollow noreferrer\"><code>alias_method_chain</code></a>, which made it a little easier to perform this common workaround.</p>\n\n<p>But clearly, that's not a great solution since you end up polluting the class with weird methods like <code>original_&lt;foo&gt;</code>, or <code>&lt;foo&gt;_with(out)_&lt;feature&gt;</code>. Thankfully Ruby 2.0 added a new method: <code>Module#prepend</code>, which provides a much cleaner solution to the problem:</p>\n\n<pre><code>require 'set'\nmodule AddWithMultipleArgs\n  def add(*args)\n    args.each { |arg| super arg }\n    self\n  end\nend\n\nclass Set\n  prepend AddWithMultipleArgs\nend\n\n# Or, you can just call:\n# Set.prepend(AddWithMultipleArgs)\n\ns = Set.new\ns.add 1,2\n#=&gt; #&lt;Set: {1, 2}&gt;\n</code></pre>\n\n<p>This works by injecting your new method <strong>before</strong> the original version, in the class' ancestor chain:</p>\n\n<pre><code>Set.ancestors\n#=&gt; [AddWithMultipleArgs, Set, Enumerable, Object, PP::ObjectMixin, Kernel, BasicObject]\n</code></pre>\n\n<p>Since you never modified the original version of the method, on the <code>Set</code> class itself, calling <code>super</code> will work as you expect.</p>\n"}], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 50366857, "answer_count": 2, "score": 0, "last_activity_date": 1526463286, "creation_date": 1526456246, "last_edit_date": 1526456556, "question_id": 50364920, "link": "https://stackoverflow.com/questions/50364920/cant-call-super-when-monkeypatching-setadd", "title": "Can&#39;t call super when monkeypatching Set#add", "body": "<p>I want to patch <code>Set#add</code> to accept multiple arguments, the same way as with <code>Array#push</code>. The following:</p>\n\n<pre><code>require 'set'\nclass Set\n  def add(*args)\n    args.each { |arg| super arg }\n    self\n  end\nend\ns = Set.new\ns.add 1,2\n</code></pre>\n\n<p>doesn't work, it raises:</p>\n\n<blockquote>\n  <p>'block in add': super: no superclass method `add' for # (NoMethodError)</p>\n</blockquote>\n\n<p>I don't see why this should be the case, since \nI saw in the <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/set/rdoc/Set.html#method-i-add\" rel=\"nofollow noreferrer\"><code>Set#add</code></a> source that it has a standard definition. It's such a simple definition that I can easily get around using <code>super</code>:</p>\n\n<pre><code>require 'set'\nclass Set\n  def add(*args)\n    args.each { |arg| @hash[arg] = true }\n    self\n  end\nend\ns = Set.new\ns.add 1,2\n</code></pre>\n\n<p>Why doesn't it work to call <code>super</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "edited": false, "score": 3, "creation_date": 1526456494, "post_id": 50364844, "comment_id": 87746172, "body": "it would be good for you to have understanding on basics rubyonrails model, migration concept."}], "answers": [{"comments": [{"owner": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526456621, "post_id": 50364917, "comment_id": 87746247, "body": "first time i am working with this, my boss asked me if i have some programming knowledge and he told me to write that programm for him"}, {"owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "edited": false, "score": 1, "creation_date": 1526457673, "post_id": 50364917, "comment_id": 87746889, "body": "@fool-dev look at above question he is writing migration code inside model."}, {"owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "reply_to_user": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526458252, "post_id": 50364917, "comment_id": 87747258, "body": "@LarsErhardt Follow the <b><i>Update</i></b> section and try this"}, {"owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "edited": false, "score": 0, "creation_date": 1526463331, "post_id": 50364917, "comment_id": 87750736, "body": "Remove this line <code>add_index :wa_players, :id</code> and try again"}], "tags": [], "owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "is_accepted": false, "score": 0, "last_activity_date": 1526463487, "last_edit_date": 1526463487, "creation_date": 1526456240, "answer_id": 50364917, "question_id": 50364844, "link": "https://stackoverflow.com/questions/50364844/rails-db-migrate-error/50364917#50364917", "title": "Rails db migrate error", "body": "<p>It will be <code>t.string</code> then <code>column_name</code> like </p>\n\n<pre><code>def change\n    create_table :wa_players, :id =&gt; false do |t|\n      t.string :id\n      t.string :player_name\n      t.string :uuid\n      t.string :password\n      t.string :money\n      t.string :items_sold\n      t.string :items_bought\n      t.string :earnt\n      t.string :spent\n      t.string :permissions\n      t.string :locked\n      t.timestamps null: false\n    end\n    add_index :wa_players, :id, unique: true\nend\n</code></pre>\n\n<p>Look at that <a href=\"http://edgeguides.rubyonrails.org/active_record_migrations.html#creating-a-table\" rel=\"nofollow noreferrer\"><strong><code>Creating a Table</code></strong></a></p>\n\n<p><strong>Update</strong></p>\n\n<p>I don't know how you trying but follow these steps</p>\n\n<ol>\n<li><p>run your console like <code>rails g model WaPlayer</code></p></li>\n<li><p>Go to <code>db/migrate/TIMESTAMP_create_wa_players.rb</code> </p></li>\n<li><p>Then paste this <code>change</code> method into <code>class</code></p></li>\n<li><p>Then run <code>rails db:migrate</code> or <code>rake db:migrate</code> after <code>rake db:create</code> if you did not create the DB till now</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "reply_to_user": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526456988, "post_id": 50364934, "comment_id": 87746467, "body": "@LarsErhardt it won&#39;t work if you change only these two lines, you need to change whole lines"}, {"owner": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526457090, "post_id": 50364934, "comment_id": 87746525, "body": "heres the whole err: <a href=\"https://pastebin.com/RAstaWVs\" rel=\"nofollow noreferrer\">pastebin.com/RAstaWVs</a> Ive changed all lines in the schema t.string :id and so on"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526457294, "post_id": 50364934, "comment_id": 87746668, "body": "@LarsErhardt: try <code>t.string :id, primary_key: true</code>"}, {"owner": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526457545, "post_id": 50364934, "comment_id": 87746809, "body": "Funny to pass me code thats reproducing the same error <a href=\"https://pastebin.com/9Y98gwhZ\" rel=\"nofollow noreferrer\">pastebin.com/9Y98gwhZ</a>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 1, "creation_date": 1526457661, "post_id": 50364934, "comment_id": 87746885, "body": "@LarsErhardt: well, this <i>should</i> work. If you make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (say, a stripped down rails app, pushed to github), I&#39;ll take a look."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 3, "creation_date": 1526457738, "post_id": 50364934, "comment_id": 87746939, "body": "@LarsErhardt: wait wait wait, what is your <code>change</code> method doing in the MODEL? Show me the migration!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526460104, "post_id": 50364934, "comment_id": 87748437, "body": "@LarsErhardt: yeah, your migration is off. Apply the abovementioned advice to the migration file."}, {"owner": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526460183, "post_id": 50364934, "comment_id": 87748480, "body": "advice? what do you mean? can you tell me the exactly order?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526460223, "post_id": 50364934, "comment_id": 87748501, "body": "@LarsErhardt: the <code>primary_key: true</code> and the <code>id: false</code>. Also snake_case."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1526456956, "last_edit_date": 1526456956, "creation_date": 1526456275, "answer_id": 50364934, "question_id": 50364844, "link": "https://stackoverflow.com/questions/50364844/rails-db-migrate-error/50364934#50364934", "title": "Rails db migrate error", "body": "<p>Don't know where you are getting your activerecord knowledge from, but you seem to have messed it up. It's not a <code>t.&lt;column&gt; &lt;type&gt;</code>. It is <code>t.&lt;type&gt; &lt;column&gt;</code>.</p>\n\n<pre><code>t.string :id\nt.string :player_name\n</code></pre>\n\n<p>And so on.</p>\n\n<p>(Note: most names in ruby follow snake_case naming convention, not camelCase).</p>\n"}, {"comments": [{"owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "reply_to_user": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526467832, "post_id": 50366599, "comment_id": 87753759, "body": "remove the add_index line from migration and  modify t.string :id with t.string :id, index: true and then check again."}, {"owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "reply_to_user": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526467975, "post_id": 50366599, "comment_id": 87753848, "body": "def change  create_table :wa_players, :id =&gt; false do |t|   t.string :id, index: true   t.string :player_name   t.string :uuid   t.string :password   t.string :money   t.string :items_sold   t.string :items_bought   t.string :earnt   t.string :spent   t.string :permissions   t.string :locked   t.timestamps null: false  end end"}, {"owner": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526468943, "post_id": 50366599, "comment_id": 87754479, "body": "Ok Mr Troll, theres the same error again.....<a href=\"https://pastebin.com/RcgQEy51\" rel=\"nofollow noreferrer\">pastebin.com/RcgQEy51</a>"}, {"owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "reply_to_user": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "edited": false, "score": 0, "creation_date": 1526469227, "post_id": 50366599, "comment_id": 87754663, "body": "It seems like the migration you are trying to run has already been migrated"}], "tags": [], "owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1526461454, "creation_date": 1526461454, "answer_id": 50366599, "question_id": 50364844, "link": "https://stackoverflow.com/questions/50364844/rails-db-migrate-error/50366599#50366599", "title": "Rails db migrate error", "body": "<p>From the content provided, it seems like you are heading the wrong way: </p>\n\n<p>Firstly, generating migration for model which seems you have done it as you have shared the model class.</p>\n\n<p>Model Class</p>\n\n<pre><code>class WaPlayer &lt; ApplicationRecord::Base\n has_secure_password\nend\n</code></pre>\n\n<p>Thus, there would be migration for the same ie: </p>\n\n<pre><code>def change\n create_table :wa_players, :id =&gt; false do |t|\n  t.id :String\n  t.playerName :String\n  t.uuid :String\n  t.password :String\n  t.money :String\n  t.itemsSold :String\n  t.itemsBought :String\n  t.earnt :String\n  t.spent :String\n  t.Permissions :String\n  t.Locked :String\n  t.timestamps null: false\n  end\n add_index :wa_players, :id\nend\n</code></pre>\n\n<p>The contents of the migration are wrong which needs to be updated with:</p>\n\n<pre><code>def change\n create_table :wa_players, :id =&gt; false do |t|\n  t.string :id\n  t.string :player_name\n  t.string :uuid\n  t.string :password\n  t.string :money\n  t.string :items_sold\n  t.string :items_bought\n  t.string :earnt\n  t.string :spent\n  t.string :permissions\n  t.string :locked\n  t.timestamps null: false\n end\n  add_index :wa_players, :id\nend\n</code></pre>\n\n<p>Now you need to run </p>\n\n<pre><code>rake db:create \n</code></pre>\n\n<p>if the db has not been migrated else run </p>\n\n<pre><code>rake db:migrate.\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 8920201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7816467db37e9a525854acea19e16cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Erhardt", "link": "https://stackoverflow.com/users/8920201/lars-erhardt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1526463487, "creation_date": 1526455975, "last_edit_date": 1526456130, "question_id": 50364844, "link": "https://stackoverflow.com/questions/50364844/rails-db-migrate-error", "title": "Rails db migrate error", "body": "<p>I started to write an api in rails. I want to migrate my model to db, but I get this error: </p>\n\n<pre><code>E:\\WebAuction\\Backend\\api&gt;rails db:migrate\nrails db:migrate\nrails aborted!\nStandardError: An error has occurred, all later migrations canceled:\n\nyou can't redefine the primary key column 'id'. To define a custom primary key, pass { id: false } to create_table.\nE:/WebAuction/Backend/api/db/migrate/20180516070242_create_wa_players.rb:4:in `block in change'\nE:/WebAuction/Backend/api/db/migrate/20180516070242_create_wa_players.rb:3:in `change'\nbin/rails:4:in `&lt;main&gt;'\n\nCaused by:\nArgumentError: you can't redefine the primary key column 'id'. To define a custom primary key, pass { id: false } to create_table.\nE:/WebAuction/Backend/api/db/migrate/20180516070242_create_wa_players.rb:4:in `block in change'\nE:/WebAuction/Backend/api/db/migrate/20180516070242_create_wa_players.rb:3:in `change'\nbin/rails:4:in `&lt;main&gt;'\nTasks: TOP =&gt; db:migrate\n(See full trace by running task with --trace)\n== 20180516070242 CreateWaPlayers: migrating ==================================\n-- create_table(:wa_players)\n</code></pre>\n\n<p>My Model class</p>\n\n<pre><code>class WaPlayer &lt; ApplicationRecord::Base\n  has_secure_password\n\n  def change\n    create_table :wa_players, :id =&gt; false do |t|\n      t.id :String\n      t.playerName :String\n      t.uuid :String\n      t.password :String\n      t.money :String\n      t.itemsSold :String\n      t.itemsBought :String\n      t.earnt :String\n      t.spent :String\n      t.Permissions :String\n      t.Locked :String\n      t.timestamps null: false\n    end\n    add_index :wa_players, :id\n  end\nend\n</code></pre>\n\n<p>If someone knows how to fix, please tell me how.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "server"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1526455584, "post_id": 50364689, "comment_id": 87745619, "body": "Do you have postgresql installed?"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1526455590, "post_id": 50364689, "comment_id": 87745623, "body": "Just as the error message says, <i>&quot;Make sure that <code>gem install pg -v &#39;0.18.4&#39;</code> succeeds before bundling&quot;</i>"}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "edited": false, "score": 0, "creation_date": 1526455835, "post_id": 50364689, "comment_id": 87745781, "body": "Yes. If I run <code>gem install pg -v &#39;0.18.4&#39;</code> then also it shows an error like <code>Error installing pg:  ERROR: Failed to build gem native extension.</code>"}], "owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526455414, "creation_date": 1526455414, "question_id": 50364689, "link": "https://stackoverflow.com/questions/50364689/rails-how-to-run-helpy-application", "title": "Rails - How to run Helpy application?", "body": "<p>I am trying to run a cloned <code>Helpy</code> application from <a href=\"https://github.com/helpyio/helpy\" rel=\"nofollow noreferrer\">https://github.com/helpyio/helpy</a> on my local system. <code>Docker</code> and <code>docker-compose</code> installation has been done.</p>\n\n<p>If I run <code>rails s</code> then it will shows <code>Could not find proper version of railties (4.2.10) in any of the sources\nRun</code>bundle install<code>to install missing gems.</code></p>\n\n<p>If I run <code>bundle install</code> then it will shows <code>An error occurred while installing pg (0.18.4), and Bundler cannot continue.\nMake sure that \"gem install pg -v '0.18.4'\" succeeds before bundling.</code></p>\n\n<p>Now how can I run this application? Please help me. </p>\n\n<p>Also let me know if any configuration file changes is required as per my localhost or any other installation is required?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1526455693, "post_id": 50364510, "comment_id": 87745688, "body": "You want to scan table <i>events_hash_tags</i> and see which <code>hash_tag_id</code>s top the list i.e. occur most of the time."}, {"owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1526456097, "post_id": 50364510, "comment_id": 87745943, "body": "Thanks, I have not any model for <b><i>events_hash_tags</i></b>, what can I do now?"}], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "edited": false, "score": 0, "creation_date": 1526531474, "post_id": 50374391, "comment_id": 87782286, "body": "Yes you are right, but the <code>name</code> column is unique it associated with <b><i>events_hash_tags</i></b>"}], "tags": [], "owner": {"reputation": 320, "user_id": 5759222, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VXD7b.png?s=128&g=1", "display_name": "Pat Mellon", "link": "https://stackoverflow.com/users/5759222/pat-mellon"}, "is_accepted": false, "score": 1, "last_activity_date": 1526483270, "creation_date": 1526483270, "answer_id": 50374391, "question_id": 50364510, "link": "https://stackoverflow.com/questions/50364510/how-to-find-trending-hashtags-based-on-use-case-in-ruby-on-rails/50374391#50374391", "title": "How to find trending hashtags based on use case in Ruby on Rails", "body": "<p><code>HashTag.all.group('name').count.sort_by {|_key, value| value}.reverse.to_h</code> would give a sorted count of all the hash tags entered in your db. If you add a where query you can limit your search to the day, week, or whatever. If you ran a query like this every hour it would list the most used, or trending, hashtags for that hour.</p>\n"}, {"tags": [], "owner": {"reputation": 48, "user_id": 9769384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a173e67ef27e664bfa1e9014f5ac36c8?s=128&d=identicon&r=PG&f=1", "display_name": "user9769384", "link": "https://stackoverflow.com/users/9769384/user9769384"}, "is_accepted": true, "score": 1, "last_activity_date": 1526540017, "creation_date": 1526540017, "answer_id": 50385124, "question_id": 50364510, "link": "https://stackoverflow.com/questions/50364510/how-to-find-trending-hashtags-based-on-use-case-in-ruby-on-rails/50385124#50385124", "title": "How to find trending hashtags based on use case in Ruby on Rails", "body": "<p>Another answer from @PatMellon is partially right the reason is @questionnaire said in the comment, below the answer which is the <code>name</code> column is unique and it associated with <code>events_hash_tags</code>.</p>\n\n<p>I think you need to follow the <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association\" rel=\"nofollow noreferrer\"><strong><code>has_many :through</code></strong></a> Association and <a href=\"http://guides.rubyonrails.org/association_basics.html#options-for-belongs-to\" rel=\"nofollow noreferrer\"><strong><code>counter_cache</code></strong></a> for counting association.</p>\n\n<p>And then</p>\n\n<pre><code>@trendings = HashTag.limit(5).order(events_hash_tags_count: :desc)\n</code></pre>\n\n<p>I think it will help</p>\n"}], "owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 1, "accepted_answer_id": 50385124, "answer_count": 2, "score": 0, "last_activity_date": 1526540017, "creation_date": 1526454777, "question_id": 50364510, "link": "https://stackoverflow.com/questions/50364510/how-to-find-trending-hashtags-based-on-use-case-in-ruby-on-rails", "title": "How to find trending hashtags based on use case in Ruby on Rails", "body": "<p>At first, that is my schema file</p>\n\n<pre><code>create_table \"events\", force: :cascade do |t|\n  t.string \"title\"\n  t.text \"description\"\n  t.string \"location\"\n  t.integer \"user_id\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\n  t.index [\"user_id\"], name: \"index_events_on_user_id\"\nend\n\ncreate_table \"events_hash_tags\", id: false, force: :cascade do |t|\n  t.integer \"event_id\"\n  t.integer \"hash_tag_id\"\n  t.index [\"event_id\"], name: \"index_events_hash_tags_on_event_id\"\n  t.index [\"hash_tag_id\"], name: \"index_events_hash_tags_on_hash_tag_id\"\nend\n\ncreate_table \"hash_tags\", force: :cascade do |t|\n  t.string \"name\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n</code></pre>\n\n<p><code>hashtags</code> creating successfully in <code>hash_tags</code> table and creating the association with <code>events_hash_tags</code>.</p>\n\n<p>I want to know how to find the trending <code>hashtags</code> based on use cases like if 10 hashtags on <code>hash_tags</code> table then how to find which <code>hashtag</code> used in most events if one <code>hashtag</code> used in 10 events and that is maximum then how to find that programmatically.</p>\n\n<p>My question is how to find 5 trending <code>hashtags</code> which used maximum time of events.</p>\n\n<p>Perdon if I did not explain well.</p>\n\n<p>Thanks </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "date", "tempus-dominus-datetimepicker"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1526456151, "post_id": 50364431, "comment_id": 87745971, "body": "Can you control the format that the datetime picker uses? Things tend to go smoother when you use non-ambiguous ISO8601 formats except at the very edges."}, {"owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1526457956, "post_id": 50364431, "comment_id": 87747087, "body": "I would think so but it wasn&#39;t in the basic docs. And it&#39;s complicated by the fact that two libraries are involved. Moment.js which manipulates date formats and Tempus Dominus Bootstrap 4 which creates the datepicker."}, {"owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1526463721, "post_id": 50364431, "comment_id": 87750962, "body": "I figured out how to do that and added it as a separate answer."}], "answers": [{"comments": [{"owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "edited": false, "score": 0, "creation_date": 1526455414, "post_id": 50364657, "comment_id": 87745530, "body": "Unfortunately I tried that and for some reason it&#39;s not working. It does indeed convert it as such but it still saves it to the database in the wrong format."}, {"owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "edited": false, "score": 0, "creation_date": 1526455743, "post_id": 50364657, "comment_id": 87745712, "body": "Okay I figured it out. I had to remove the field from the whitelisted event_params before converting it using DateTime.strptime function you mentioned."}, {"owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "edited": false, "score": 0, "creation_date": 1526456033, "post_id": 50364657, "comment_id": 87745910, "body": "Thanks, I&#39;ll try out the initializer as well. In the controller action, besides removing the field from event_params I had to add to the create and update actions:"}, {"owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "edited": false, "score": 0, "creation_date": 1526456047, "post_id": 50364657, "comment_id": 87745917, "body": "@event.starts_at = DateTime.strptime(params[&#39;event&#39;][&#39;starts_at&#39;],&#39;%m/%d/%Y %H:%M %p&#39;)"}, {"owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "edited": false, "score": 0, "creation_date": 1526456156, "post_id": 50364657, "comment_id": 87745974, "body": "To the database it was being saved in the standard datetime format as: 2018-09-06 18:00:00"}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1526456425, "post_id": 50364657, "comment_id": 87746124, "body": "Yes, it just defines how to read and display the date from anywhere, but not change DateTime object"}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 2, "last_activity_date": 1526455789, "last_edit_date": 1526455789, "creation_date": 1526455314, "answer_id": 50364657, "question_id": 50364431, "link": "https://stackoverflow.com/questions/50364431/rails-reverses-day-and-month-when-saving-datetimepicker-form-field/50364657#50364657", "title": "Rails reverses day and month when saving DateTimePicker form field", "body": "<p>You can tell Ruby how to read time string:</p>\n\n<pre><code>DateTime.strptime('06/09/2018', '%m/%d/%Y')\n</code></pre>\n\n<p>More details you can see in this <a href=\"https://stackoverflow.com/questions/10091959/rails-how-to-parse-date-time-string-into-a-specific-time-zone\">answer</a>.</p>\n\n<p><strong>Edited:</strong></p>\n\n<p>Also, you can set the default date format as <a href=\"https://stackoverflow.com/questions/17870762/changing-the-default-date-and-time-format-in-rails-4\">there</a>:</p>\n\n<p>Add this to config/initializers/date_time.rb</p>\n\n<pre><code>Date::DATE_FORMATS[:default] = \"%m/%d/%Y\" \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "is_accepted": false, "score": 1, "last_activity_date": 1526504458, "last_edit_date": 1526504458, "creation_date": 1526463653, "answer_id": 50367391, "question_id": 50364431, "link": "https://stackoverflow.com/questions/50364431/rails-reverses-day-and-month-when-saving-datetimepicker-form-field/50367391#50367391", "title": "Rails reverses day and month when saving DateTimePicker form field", "body": "<p>I found out you can change the date format to one Ruby correctly understands and that is easily readable by users. Change the JavaScript to:</p>\n\n<pre><code>$(document).on('turbolinks:load', function() {\n  $('#datetimepicker1').datetimepicker(\n    'format', 'MMMM D, YYYY h:mm A'\n  );\n});\n</code></pre>\n\n<p>This will display the date to the user as June 9, 2018 6:30 PM. Date format comes from Moment.js <a href=\"http://momentjs.com/docs/#/displaying/format/\" rel=\"nofollow noreferrer\">http://momentjs.com/docs/#/displaying/format/</a> but is added to the format option of Tempus Dominus.</p>\n\n<p>As a side note, to get tempus dominus boostrap 4 working in Rails, you have to also load moment.js. Either call the cdn or add the momentjs-rails gem. If the latter then in your application.js file you need to require it, something like this:</p>\n\n<pre><code># app/assets/javascripts/application.js\n...\n//= require moment\n//= require tempusdominus-bootstrap-4.js\n</code></pre>\n"}], "owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 0, "accepted_answer_id": 50364657, "answer_count": 2, "score": 0, "last_activity_date": 1526504458, "creation_date": 1526454456, "last_edit_date": 1526455059, "question_id": 50364431, "link": "https://stackoverflow.com/questions/50364431/rails-reverses-day-and-month-when-saving-datetimepicker-form-field", "title": "Rails reverses day and month when saving DateTimePicker form field", "body": "<p>I am trying to use Tempus Dominus Bootstrap 4 in a form on a Ruby on Rails 5.2 app so the user can select a date. Here is the code:</p>\n\n<p><strong>app/views/events/_form.html.erb</strong></p>\n\n<pre><code>&lt;div class='form-group'&gt;\n  &lt;%= f.label :starts_at, 'Start Date and Time', class: 'control-label' %&gt;\n  &lt;div class=\"input-group date\" id=\"datetimepicker1\" data-target-input=\"nearest\"&gt;\n    &lt;%= f.text_field(:starts_at, class: \"form-control datetimepicker-input\", data: {target:\"#datetimepicker1\"}) %&gt;\n    &lt;div class=\"input-group-append\" data-target=\"#datetimepicker1\" data-toggle=\"datetimepicker\"&gt;\n      &lt;div class=\"input-group-text\"&gt;&lt;i class=\"fas fa-calendar-plus\"&gt;&lt;/i&gt;&lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>app/assets/javascripts/events.js</strong></p>\n\n<pre><code>$(function () {\n  $('#datetimepicker1').datetimepicker();\n});\n</code></pre>\n\n<p><strong>app/controllers/events_controller.rb</strong></p>\n\n<pre><code>  def create\n    @event = Event.new(event_params)\n    @event.user = current_user\n    if @event.save\n      redirect_to @event, notice: 'Event was successfully created.' \n    else\n      render :new \n    end\n  end\n</code></pre>\n\n<p>I want to submit the format with month first. When I pick a date June 9, 2018 and submit the form, it saves it to the database with the month and day reversed: Sept 6, 2018. When I look at the <code>params</code> after the form is submitted, the format is <code>06/09/2018 6:00 PM</code> with month first, but Ruby/Rails converts it to a datetime object assuming day first.</p>\n\n<p>How do I tell Ruby that the month is first when converting it to a date object? Can I do something in the controller before saving it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3250752"}, "reply_to_user": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1526436077, "post_id": 50361401, "comment_id": 87739368, "body": "Thank you for the edit suggestion @Phlip."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3250752"}, "reply_to_user": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1526436230, "post_id": 50361401, "comment_id": 87739399, "body": "@Subash, thank you for your edit suggestion."}, {"owner": {"reputation": 1772, "user_id": 3733369, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tKoY4.jpg?s=128&g=1", "display_name": "Rcordoval", "link": "https://stackoverflow.com/users/3733369/rcordoval"}, "edited": false, "score": 0, "creation_date": 1526442897, "post_id": 50361401, "comment_id": 87740827, "body": "which version of rails are you using?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526448977, "post_id": 50361401, "comment_id": 87742476, "body": "What is your question?"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1526456603, "post_id": 50361401, "comment_id": 87746236, "body": "Please add code of your controller action for edit_account_activation_path"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3250752"}, "edited": false, "score": 0, "creation_date": 1526482474, "post_id": 50361401, "comment_id": 87764381, "body": "I am using Rails 5 the latest version."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3250752"}, "edited": false, "score": 0, "creation_date": 1526483320, "post_id": 50361401, "comment_id": 87764989, "body": "The error messages on here are not detailed and don&#39;t give enough information to solve the coding parts of a question post."}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1526714199, "post_id": 50361401, "comment_id": 87860340, "body": "Try to add some debugging messages to the controller, like <code>p params</code>, <code>p user.inspect</code> and <code>p user.authenticated?(:activation, params[:id])</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3250752"}, "edited": false, "score": 0, "creation_date": 1526482551, "post_id": 50362221, "comment_id": 87764437, "body": "I am using Rails 5 the latest version"}], "tags": [], "owner": {"reputation": 1772, "user_id": 3733369, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tKoY4.jpg?s=128&g=1", "display_name": "Rcordoval", "link": "https://stackoverflow.com/users/3733369/rcordoval"}, "is_accepted": false, "score": 0, "last_activity_date": 1526445263, "last_edit_date": 1526445263, "creation_date": 1526442667, "answer_id": 50362221, "question_id": 50361401, "link": "https://stackoverflow.com/questions/50361401/unable-to-solve-rails-tutorial-error/50362221#50362221", "title": "Unable to solve rails tutorial error", "body": "<p>May be the error is before, and you didn't notice. This would be the syntax for rails 4.2 (without params:) :</p>\n\n<pre><code>assert_difference 'User.count', 1 do\n      post users_path, user: { name: 'Example User',\n                               email: 'user@example.com',\n                               password: 'foo12',\n                               password_confirmation: 'foo12' }\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3250752"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526528621, "creation_date": 1526435720, "last_edit_date": 1526528621, "question_id": 50361401, "link": "https://stackoverflow.com/questions/50361401/unable-to-solve-rails-tutorial-error", "title": "Unable to solve rails tutorial error", "body": "<p>I am following the rails tutorial online book and I am unable to fix the issue below</p>\n\n<pre><code>FAIL[\"test_valid_signup_information_with_account_activation\", UsersSignupTest, 5.62457\n6674999844]\ntest_valid_signup_information_with_account_activation#UsersSignupTest (5.63s)\nExpected false to be truthy.\ntest/integration/users_signup_test.rb:38:in block in &lt;class:UsersSignupTest&gt;\n\nrequire 'test_helper'\n\nclass UsersSignupTest &lt; ActionDispatch::IntegrationTest\n\n  def setup\n    ActionMailer::Base.deliveries.clear\n  end\n\n  test \"invalid signup information\" do\n    get signup_path\n    assert_no_difference 'User.count' do\n      post users_path, params: { user: { name: \"\", email: \"user@invalid\", password: \"foo\", password_confirmation: \"bar\" } }\n    end\n    assert_template 'users/new'\n    assert_select 'div#error_explanation'\n    assert_select 'div.field_with_errors'\n  end\n\n  test \"valid signup information with account activation\" do\n    get signup_path\n    assert_difference 'User.count', 1 do\n      post users_path, params: { user: { name:  \"Example User\", email: \"user@example.com\", password: \"foobar12\", password_confirmation: \"foobar12\" } }\n    end\n    assert_equal 1, ActionMailer::Base.deliveries.size\n    user = assigns(:user)\n    assert_not user.activated?\n    # Try to log in before activation.\n    log_in_as(user)\n    assert_not is_logged_in?\n    # Invalid activation token\n    get edit_account_activation_path(\"invalid token\")\n    assert_not is_logged_in?\n    # Valid token, wrong email\n    get edit_account_activation_path(user.activation_token, email: 'wrong')\n    assert_not is_logged_in?\n    # Valid activation token\n    get edit_account_activation_path(user.activation_token, email: user.email)\n    **assert user.reload.activated?** \n    # Problem is here, but unsure why??\n    follow_redirect!\n    assert_template 'users/show'\n    assert is_logged_in?\n  end\nend\n</code></pre>\n\n<p>Here is the code for the Account Activations Controller as requested:</p>\n\n<pre><code>class AccountActivationsController &lt; ApplicationController\n\ndef edit\n user = User.find_by(email: params[:email])\n if user &amp;&amp; !user.activated? &amp;&amp; user.authenticated?(:activation, params[:id])\n # user.activate\n user.update_attribute(:activated, true)\n user.update_attribute(:activated_at, Time.zone.now)\n log_in user\n flash[:success] = \"Account activated!\"\n redirect_to user\nelse\n        flash[:danger] = \"Invalid activation link\"\n        redirect_to root_url\n      end\n     end\n    end\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1526433381, "post_id": 50361068, "comment_id": 87738857, "body": "Your logic is erroneous. the word <code>that</code> follows four spaces which matches <code>&#47;\\s{2}\\w+&#47;</code>."}, {"owner": {"reputation": 16007, "user_id": 8291949, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a7pBo.gif?s=128&g=1", "display_name": "wp78de", "link": "https://stackoverflow.com/users/8291949/wp78de"}, "edited": false, "score": 0, "creation_date": 1526434653, "post_id": 50361068, "comment_id": 87739100, "body": "How should one know that the example statement should end at &#180;bar 42&#180;? You probably need a parser for this."}, {"owner": {"reputation": 25150, "user_id": 383888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Kd57u.jpg?s=128&g=1", "display_name": "Mori", "link": "https://stackoverflow.com/users/383888/mori"}, "edited": false, "score": 0, "creation_date": 1526436544, "post_id": 50361068, "comment_id": 87739461, "body": "The pattern that ends the selection is &quot;newline, then 2 spaces, then 1 or more word characters&quot;. My attempt to encode that is <code>&#47;^\\s{2}\\w+&#47;</code>. The problem is that I can&#39;t get a selection that <i>ends</i> before that pattern."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526446784, "post_id": 50361068, "comment_id": 87741761, "body": "Your example code fragment is not valid Ruby code."}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 3, "last_activity_date": 1526454319, "last_edit_date": 1526454319, "creation_date": 1526437622, "answer_id": 50361614, "question_id": 50361068, "link": "https://stackoverflow.com/questions/50361068/how-to-construct-ruby-regex-that-matches-up-to-first-example-of-a-multi-characte/50361614#50361614", "title": "How to construct Ruby regex that matches up to first example of a multi character pattern?", "body": "<pre><code>r = /\n    (?&lt;=     # begin a positive lookbehind\n      \\b     # match a (zero-width) word break\n      foo    # match string\n      [ ]    # match a space\n    )        # close positive lookbehind\n    .*?      # match zero or more chars, non-greedily\n    (?=      # begin a positive lookahead\n      \\n     # match newline char\n      [ ]{2} # match two spaces\n      \\w     # match a word char\n    )        # close positive lookahead\n    /xm      # free-spacing and multiline modes\n\ncode[r]\n  #=&gt; \"an arbitrary statement\\n    that could go on for \\n    several lines\"\n</code></pre>\n\n<p>The conventional expression for the regular expression is as follows.</p>\n\n<pre><code>/(?&lt;=\\bfoo ).*?(?=\\n  \\w)/m\n</code></pre>\n\n<p>Notice that in free-spacing mode I've matched spaces with with a character class containing one space (<code>[ ]</code>). Had I used spaces, as I did in the regex immediately above, they would have been removed because I was using <em>free-spacing</em> mode to define the regex, which disregards spaces.</p>\n\n<p>It's important that the expression that captures the string that is returned be <em>non-greedy</em> (<code>.*?</code> rather than <code>.*</code>). If it were greedy (<code>.*</code>) we would obtain an erroneous result, as illustrated by the following example:</p>\n\n<pre><code>str = \"foo oh my\\n  a\\n  b\\n  c\"\nstr[r]\n  #=&gt; \"oh my\"\nstr[/(?&lt;=\\bfoo ).*(?=\\n  \\w)/m]\n  #=&gt; \"oh my\\n  a\\n  b\"\n</code></pre>\n\n<p>In the greedy case, <code>.*</code> gobbles up as much as in can until it comes to the last possible match of the positive lookahead <code>(?=\\n  \\w)</code>, namely <code>\"\\n  c\"</code>.</p>\n\n<p>The <em>word break</em> (<code>\\b</code>) is to ensure that we do not match, for example, <code>\"snafoo\"</code>. It requires that <code>\"foo\"</code> be preceded by a non-word character or be the first character of the string.</p>\n\n<p>Another way to write the regex is as follows.</p>\n\n<pre><code>code[/\\bfoo \\K.*?(?=\\n  \\w)/m]\n  #=&gt; \"an arbitrary statement\\n    that could go on for \\n    several lines\"\n</code></pre>\n\n<p><code>\\K</code> can be read, \"discard everything matched so far when returning the matched string\". That is, the part before <code>\\K</code> must be matched; it just isn't used in forming the matched string that is returned.</p>\n\n<p>A final way to write the regex is to use a capture group.</p>\n\n<pre><code>code[/\\bfoo (.*?)\\n  \\w/m, 1]\n  #=&gt; \"an arbitrary statement\\n    that could go on for \\n    several lines\"\n</code></pre>\n\n<p>The string of interest is captured in capture group <code>1</code>, and then is returned in <a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">String#[]</a>'s optional second argument.</p>\n\n<p>Lastly, note that <code>\\w</code> toward the end has the same effect as <code>\\w+</code>.</p>\n"}], "owner": {"reputation": 25150, "user_id": 383888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Kd57u.jpg?s=128&g=1", "display_name": "Mori", "link": "https://stackoverflow.com/users/383888/mori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 50361614, "answer_count": 1, "score": 0, "last_activity_date": 1526454319, "creation_date": 1526432350, "last_edit_date": 1526436426, "question_id": 50361068, "link": "https://stackoverflow.com/questions/50361068/how-to-construct-ruby-regex-that-matches-up-to-first-example-of-a-multi-characte", "title": "How to construct Ruby regex that matches up to first example of a multi character pattern?", "body": "<p>I have a multiline fragment of ruby code from which I need to extract the arguments to a particular method, method <code>foo</code> in this example:</p>\n\n<pre><code>code = \"qux = define {\\n  foo an arbitrary statement\\n    that could go on for \\n    several lines\\n  bar 42\\n  baz\\43\\n}\"\n</code></pre>\n\n<p>From this I would like to extract <code>an arbitrary statement\\n   that could go on for \\n   several lines</code>. For this purpose I'd like to capture everything between <code>foo</code> and the first instance of <code>/^\\s{2}\\w+/</code>, marking the start of the next method and its argument.</p>\n\n<p>Among my failures to do this (within <code>code.match(&lt;example regex here&gt;)[1]</code>) are:</p>\n\n<pre><code>/foo(.*)\\s{2}\\w+/m\n/^\\s+foo(.*)^\\s{2}\\w+/m\n/\\n\\s+foo(.*)\\n\\s{2}\\w+/m\n/\\n\\s+foo(.*)\\n\\s{2}\\w+?/m\n</code></pre>\n\n<p>Et cetera. None seem to return the \"statement\" pattern I'm looking for. Lazy/greedy operators have some effect, but never eliminate all of the string after the target <code>foo(.*)</code> pattern.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1526432185, "post_id": 50361038, "comment_id": 87738603, "body": "Have you tried editing <code>&#39;form&#39;</code>?"}, {"owner": {"reputation": 725, "user_id": 265780, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2eebc3bf40f7788a5c94359331e5b3cc?s=128&d=identicon&r=PG", "display_name": "Bad Programmer", "link": "https://stackoverflow.com/users/265780/bad-programmer"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1526432951, "post_id": 50361038, "comment_id": 87738767, "body": "I am a total RoR noob.  I reviewed <a href=\"http://guides.rubyonrails.org/form_helpers.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/form_helpers.html</a> to try to build a form with only the two inputs I needed, but apparently the values were being passed an nill."}], "answers": [{"comments": [{"owner": {"reputation": 725, "user_id": 265780, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2eebc3bf40f7788a5c94359331e5b3cc?s=128&d=identicon&r=PG", "display_name": "Bad Programmer", "link": "https://stackoverflow.com/users/265780/bad-programmer"}, "edited": false, "score": 0, "creation_date": 1526435869, "post_id": 50361191, "comment_id": 87739321, "body": "Thanks.  This was exactly what I was looking for."}], "tags": [], "owner": {"reputation": 20491, "user_id": 511558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935cbe780c1c0a4adfeb7b2dd404a32e?s=128&d=identicon&r=PG", "display_name": "DanneManne", "link": "https://stackoverflow.com/users/511558/dannemanne"}, "is_accepted": true, "score": 1, "last_activity_date": 1526433764, "creation_date": 1526433764, "answer_id": 50361191, "question_id": 50361038, "link": "https://stackoverflow.com/questions/50361038/only-include-specific-attributes-as-input-options-for-form-generated-by-scaffold/50361191#50361191", "title": "Only include specific attributes as input options for form generated by scaffold in Ruby on Rails", "body": "<p>The way I would do this is to copy the contents of the <code>_form</code> template and paste it directly into the <code>new</code> template instead of the the row where it calls <code>render 'form'</code>.</p>\n\n<p>Then once you have done that, you can modify which inputs you want to have in the <code>new</code> template, without it affecting the other actions that are rendering the <code>_form</code> template.</p>\n\n<p>Just note that in the code you copy from the <code>_form</code> template, you must replace any reference to <code>person</code> with <code>@person</code> instead.</p>\n"}], "owner": {"reputation": 725, "user_id": 265780, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2eebc3bf40f7788a5c94359331e5b3cc?s=128&d=identicon&r=PG", "display_name": "Bad Programmer", "link": "https://stackoverflow.com/users/265780/bad-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 50361191, "answer_count": 1, "score": 1, "last_activity_date": 1526433764, "creation_date": 1526432080, "question_id": 50361038, "link": "https://stackoverflow.com/questions/50361038/only-include-specific-attributes-as-input-options-for-form-generated-by-scaffold", "title": "Only include specific attributes as input options for form generated by scaffold in Ruby on Rails", "body": "<p>I used a generator to create a scaffold for \"Person\".  I passed in the three attributes of the model: height, weight, age</p>\n\n<pre><code>rails g scaffold Person\n</code></pre>\n\n<p>This did what was expected, and created everything i needed to get going, including a ready-made CRUD.  However, I want age to be an optional input.  The form that was autogenerated has fields to input all three attributes, but I only want inputs for height and weight to be displayed.</p>\n\n<pre><code>&lt;%= render 'form', person: @person%&gt;\n</code></pre>\n\n<p>How can I update this so that only height and weight are shown in the person/new view, but still allow age to be entered in a view linked to another action?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1526444637, "post_id": 50360910, "comment_id": 87741247, "body": "What is <code>A</code> and <code>bs</code> in <code>A.find(1).bs.unscoped.destroy_all</code> ? Are they <code>Parent</code> and <code>children</code>?"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 1, "creation_date": 1526456985, "post_id": 50360910, "comment_id": 87746465, "body": "default_scope is always bad idea :( Change it to &#39;active&#39; (for example) scope and use it where you need"}, {"owner": {"reputation": 1667, "user_id": 359660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/73a63c1f44ef127e609753975421ef7f?s=128&d=identicon&r=PG", "display_name": "LanceH", "link": "https://stackoverflow.com/users/359660/lanceh"}, "edited": false, "score": 0, "creation_date": 1526475683, "post_id": 50360910, "comment_id": 87759129, "body": "Sorry, I was going with A and B, then edited to parent child.  I&#39;m inheriting the code, and default scope is ingrained at the moment."}], "answers": [{"comments": [{"owner": {"reputation": 1667, "user_id": 359660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/73a63c1f44ef127e609753975421ef7f?s=128&d=identicon&r=PG", "display_name": "LanceH", "link": "https://stackoverflow.com/users/359660/lanceh"}, "edited": false, "score": 0, "creation_date": 1579279811, "post_id": 59708061, "comment_id": 105725585, "body": "Good suggestion but I believe we used destroy to manage external connections and storage."}], "tags": [], "owner": {"reputation": 926, "user_id": 579217, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55b04cb2a330db181631c950a43947c4?s=128&d=identicon&r=PG&f=1", "display_name": "JBlake", "link": "https://stackoverflow.com/users/579217/jblake"}, "is_accepted": false, "score": 1, "last_activity_date": 1578862609, "creation_date": 1578862609, "answer_id": 59708061, "question_id": 50360910, "link": "https://stackoverflow.com/questions/50360910/override-default-scope-of-a-child-object-on-cascade-delete/59708061#59708061", "title": "Override default scope of a child object on cascade delete", "body": "<p>I would delegate this to the database, since I doubt you need to run callbacks on records that are already soft deleted. Plus it's much faster and uses no memory.</p>\n\n<p>New Migration:</p>\n\n<pre><code>add_foreign_key :child_table, :parent_table, on_delete: :cascade\n</code></pre>\n\n<p>Then you can simply do</p>\n\n<pre><code>Parent.find(1).delete\n</code></pre>\n"}], "owner": {"reputation": 1667, "user_id": 359660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/73a63c1f44ef127e609753975421ef7f?s=128&d=identicon&r=PG", "display_name": "LanceH", "link": "https://stackoverflow.com/users/359660/lanceh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1578862609, "creation_date": 1526431012, "last_edit_date": 1526475743, "question_id": 50360910, "link": "https://stackoverflow.com/questions/50360910/override-default-scope-of-a-child-object-on-cascade-delete", "title": "Override default scope of a child object on cascade delete", "body": "<pre><code>class Parent\n    has_many :children, dependent: :destroy\nend\n\nclass Child\n    belongs_to :parent\n    default_scope { where(deleted_at: nil).not_deleted }\nend\n</code></pre>\n\n<p>My problem comes from some Child objects are soft deleted.  Calling Parent.last.destroy will attempt to destroy only those children in the default scope.</p>\n\n<p>Yes, I know how to do something like <code>Child.last.unscoped</code>, but I want is for something like <code>Parent.find(1).destroy</code> to destroy all child objects, including those which have been soft deleted.</p>\n\n<pre><code>Parent.find(1).children.unscoped.destroy_all\nParent.destroy\n</code></pre>\n\n<p>The above works.  Is there any way to get this down to just <code>Parent.find(1).destroy</code>?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8430098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9851c7c153f49c75616233d248e3deb?s=128&d=identicon&r=PG&f=1", "display_name": "Kane Walsh", "link": "https://stackoverflow.com/users/8430098/kane-walsh"}, "edited": false, "score": 0, "creation_date": 1526478473, "post_id": 50363760, "comment_id": 87761213, "body": "I don&#39;t know what I was doing wrong, but I&#39;ve gone back onto my rails application and its running fine now. Thanks for your tips Leo, I appreciate your suggestions. Hopefully no further problems occur :)"}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1526451922, "creation_date": 1526451922, "answer_id": 50363760, "question_id": 50360762, "link": "https://stackoverflow.com/questions/50360762/javascript-error-causing-rails-link-to-functions-to-stop-working/50363760#50363760", "title": "Javascript error causing rails link_to functions to stop working", "body": "<p>When you click on <code>link_to</code> what happens? Check your server log(console unless daemon mode or <code>log/development.log</code> otherwise) - what that says, what views checks or renders(that can helps when all request sends as xhr)? If after click nothing is written to the log check your browser console - there are some errors or messages? \nOtherwise, check your js files, maybe somewhere present click listener on the tag <code>a</code> that prevented his scenario.</p>\n\n<p>Also, provide your router code, link example and same controller(or link to repo) if all was not helpful</p>\n"}], "owner": {"reputation": 1, "user_id": 8430098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9851c7c153f49c75616233d248e3deb?s=128&d=identicon&r=PG&f=1", "display_name": "Kane Walsh", "link": "https://stackoverflow.com/users/8430098/kane-walsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526451922, "creation_date": 1526429420, "last_edit_date": 1526441847, "question_id": 50360762, "link": "https://stackoverflow.com/questions/50360762/javascript-error-causing-rails-link-to-functions-to-stop-working", "title": "Javascript error causing rails link_to functions to stop working", "body": "<p>This is my first post so apologies if my question formatting is not up to par.</p>\n\n<p>I am having an issue with the JavaScript on my ruby on rails web application at the moment, I have been following the rails tutorial by Michael Hartl Ruby on Rails Tutorial (found <a href=\"https://www.railstutorial.org/book/following_users\" rel=\"nofollow noreferrer\">here</a>). Within chapter 14 he shows users how to implement AJAX functionality to allow <code>follow/unfollow</code> buttons to update a view without the user having to refresh the screen. </p>\n\n<p>Anyway, the problem I'm having is that somewhere in my code is a problem which is causing all my rails link_to methods to stop working when clicked. I am not receiving any errors, but am just unable to navigate my site due to the links not working. Its definitely a javascript problem as when removing the line: </p>\n\n<pre><code>&lt;%= javascript_include_tag 'application', media: 'all', 'data-turbolinks-track' =&gt; true %&gt;  \n</code></pre>\n\n<p>from my application.html.erb file my buttons work. I would have just left the javascript to include tag out of my application file but it is needed for some of my other website functionality. </p>\n\n<p>Any help would be appreciated, </p>\n\n<p>thanks</p>\n\n<p>kane</p>\n"}, {"tags": ["json", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "is_accepted": false, "score": 0, "last_activity_date": 1526433183, "creation_date": 1526433183, "answer_id": 50361131, "question_id": 50360677, "link": "https://stackoverflow.com/questions/50360677/ruby-handling-different-json-response-that-is-not-what-is-expected/50361131#50361131", "title": "Ruby: Handling different JSON response that is not what is expected", "body": "<p>It would appear you can just check <code>json[\"Message360\"][\"ResponseStatus\"]</code> first for a 0 or 1 to indicate failure or success.</p>\n\n<p>I'd probably add a <code>rescue</code> to help catch any other errors (malformed JSON, network issue, etc.)</p>\n\n<pre><code>CSV.foreach('data1.csv',headers: true) do |row|\n    number = row['number'].to_i\n...\n    json = JSON.parse(res.body)\n    if json[\"Message360\"][\"ResponseStatus\"] == 1  \n        new = json[\"Message360\"][\"Carrier\"].values\n\n        CSV.open(\"new.csv\", \"ab\") do |csv|\n            csv &lt;&lt; new\n        end\n    else\n        # handle bad response\n    end\nrescue StandardError =&gt; e\n    # request failed for some reason, log e and the number?\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8260965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6aadcd992b653fbed742f7797d51e83?s=128&d=identicon&r=PG&f=1", "display_name": "Alex T", "link": "https://stackoverflow.com/users/8260965/alex-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1526433183, "creation_date": 1526428677, "question_id": 50360677, "link": "https://stackoverflow.com/questions/50360677/ruby-handling-different-json-response-that-is-not-what-is-expected", "title": "Ruby: Handling different JSON response that is not what is expected", "body": "<p>Searched online and read through the documents, but have not been able to find an answer.  I am fairly new and part of learning Ruby I wanted to make the script below.</p>\n\n<p>The Script essentially does a Carrier Lookup on a list of numbers that are provided through a CSV file.  The CSV file has just one row with the column header \"number\".  </p>\n\n<p>Everything runs fine UNTIL the API gives me an output that is different from the others.  In this example, it tells me that one of the numbers in my file is not a valid US number.  This then causes my script to stop running.  </p>\n\n<p>I am looking to see if there is a way to either ignore it (I read about Begin and End, but was not able to get it to work) or ideally either create a separate file with those errors or just put the data into the main file.</p>\n\n<p>Any help would be much appreciated.  Thank you.</p>\n\n<p><strong>Ruby Code:</strong></p>\n\n<pre><code>require 'csv'\nrequire 'uri'\nrequire 'net/http'\nrequire 'json'\n\n\nnumber = 0\n\n\nCSV.foreach('data1.csv',headers: true) do |row|\n    number = row['number'].to_i\n    uri = URI(\"https://api.message360.com/api/v3/carrier/lookup.json?PhoneNumber=#{number}\")\n    req = Net::HTTP::Post.new(uri)\n    req.basic_auth 'XXX' , 'XXX'\n    res = Net::HTTP.start(uri.hostname, uri.port, :use_ssl =&gt; true) {|http|\n    http.request(req)\n    }\n    json = JSON.parse(res.body)\n    new = json[\"Message360\"][\"Carrier\"].values\n\n\n    CSV.open(\"new.csv\", \"ab\") do |csv|\n        csv &lt;&lt; new\n    end\nend\n</code></pre>\n\n<p><strong>File Data:</strong></p>\n\n<pre><code>number\n5556667777\n9998887777\n</code></pre>\n\n<p>Good Response example in JSON:</p>\n\n<pre><code>{\"Message360\"=&gt;{\"ResponseStatus\"=&gt;1, \"Carrier\"=&gt;{\"ApiVersion\"=&gt;\"3\", \"CarrierSid\"=&gt;\"XXX\", \"AccountSid\"=&gt;\"XXX\", \"PhoneNumber\"=&gt;\"+19495554444\", \"Network\"=&gt;\"Cellco Partnership dba Verizon Wireless - CA\", \"Wireless\"=&gt;\"true\", \"ZipCode\"=&gt;\"92604\", \"City\"=&gt;\"Irvine\", \"Price\"=&gt;0.0003, \"Status\"=&gt;\"success\", \"DateCreated\"=&gt;\"2018-05-15 23:05:15\"}}}\n</code></pre>\n\n<p><strong>The response that causes Script to stop:</strong></p>\n\n<pre><code>{\n    \"Message360\": {\n        \"ResponseStatus\": 0,\n        \"Errors\": {\n            \"Error\": [\n                {\n                    \"Code\": \"ER-M360-CAR-111\",\n                    \"Message\": \"Allowed Only Valid E164 North American Numbers.\",\n                    \"MoreInfo\": []\n                }\n            ]\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "reply_to_user": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1526429849, "post_id": 50360386, "comment_id": 87738109, "body": "It&#39;s true that it is a duplicate but all the answers are no good."}, {"owner": {"reputation": 199, "user_id": 6670519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7r9T.jpg?s=128&g=1", "display_name": "Dapeng114", "link": "https://stackoverflow.com/users/6670519/dapeng114"}, "edited": false, "score": 0, "creation_date": 1526441667, "post_id": 50360386, "comment_id": 87740551, "body": "you can do this:  text = File.readlines(&quot;file.csv&quot;)[1..-1].join()  then   csv = CSV.parse(text, headers: true)"}, {"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 0, "creation_date": 1526444312, "post_id": 50360386, "comment_id": 87741184, "body": "The answers in the exemplar look good to me."}], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "closed_date": 1526427836, "answer_count": 0, "score": 0, "last_activity_date": 1526426110, "creation_date": 1526426110, "question_id": 50360386, "link": "https://stackoverflow.com/questions/50360386/how-to-skip-the-first-row-in-csv-that-is-not-the-header-row-with-rails", "closed_reason": "Duplicate", "title": "How to skip the first row in CSV that is not the &quot;header row&quot; with Rails?", "body": "<p>The CSV:</p>\n\n<pre><code>Arbitrary data to skip\nName, ID, Hobby, ...\nJoe, 1, Movies....\n</code></pre>\n\n<p>How to skip the first line, but still use the 2nd line with <code>headers: true</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "nested-forms"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1526458936, "post_id": 50360169, "comment_id": 87747701, "body": "Check the HTML generated and look if the form inputs are properly built."}, {"owner": {"reputation": 3189, "user_id": 5564683, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/VotLv.jpg?s=128&g=1", "display_name": "Augusto Carmo", "link": "https://stackoverflow.com/users/5564683/augusto-carmo"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1526461565, "post_id": 50360169, "comment_id": 87749421, "body": "Hello, @iGian! How can I tell if the form inputs were properly built? Thanks :)"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1526468017, "post_id": 50360169, "comment_id": 87753877, "body": "I mean it looks there is an extra level in params, I think it should be <code>&quot;product_model_attr_vals_attributes&quot;=&gt;{&quot;0&quot;=&gt;{&quot;id&quot;=&gt;&quot;1&quot;}}</code> from <code>&lt;input name=&quot;product_model[product_model_attr_vals_attributes][0][i&zwnj;&#8203;d]&quot;&gt;</code>"}, {"owner": {"reputation": 958, "user_id": 5666052, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/100002574636751/picture?type=large", "display_name": "Pedro Gabriel Lima", "link": "https://stackoverflow.com/users/5666052/pedro-gabriel-lima"}, "edited": false, "score": 0, "creation_date": 1526471217, "post_id": 50360169, "comment_id": 87755963, "body": "Could you show your method <code>new</code> in <code>product_model_controller.rb</code>, please."}, {"owner": {"reputation": 3189, "user_id": 5564683, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/VotLv.jpg?s=128&g=1", "display_name": "Augusto Carmo", "link": "https://stackoverflow.com/users/5564683/augusto-carmo"}, "edited": false, "score": 0, "creation_date": 1526503729, "post_id": 50360169, "comment_id": 87775551, "body": "I have just added :)"}], "owner": {"reputation": 3189, "user_id": 5564683, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/VotLv.jpg?s=128&g=1", "display_name": "Augusto Carmo", "link": "https://stackoverflow.com/users/5564683/augusto-carmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526503705, "creation_date": 1526424509, "last_edit_date": 1526503705, "question_id": 50360169, "link": "https://stackoverflow.com/questions/50360169/create-an-object-using-nested-forms", "title": "Create an object using Nested Forms", "body": "<p>I have the following tables in my project:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VYMP7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VYMP7.png\" alt=\"A subset of my database tables\"></a></p>\n\n<p>I am trying to make a nested form to create a <strong>Product Model</strong>, where the user can input the <strong>name</strong> and check which <strong>Attr Vals</strong> this new <strong>Product Model</strong> will have.</p>\n\n<p>Here is what I have so far:</p>\n\n<p><em><strong>attr.rb</strong></em></p>\n\n<pre><code>class Attr &lt; ApplicationRecord\n  validates :name, presence: true\n  validates :name, uniqueness: true\n\n  has_many :attr_vals\nend\n</code></pre>\n\n<p><em><strong>attr_val.rb</strong></em></p>\n\n<pre><code>class AttrVal &lt; ApplicationRecord\n  validates :name, presence: true\n  validates :name, uniqueness: { scope: :attr_id }\n\n  has_many :product_models, through: :product_model_attr_vals\n  has_many :products, through: :product_attr_vals\n\n  belongs_to :attr\nend\n</code></pre>\n\n<p><em><strong>product_model_attr_val.rb</strong></em></p>\n\n<pre><code>class ProductModelAttrVal &lt; ApplicationRecord\n  validates :product_model_id, uniqueness: { scope: :attr_val_id }\n\n  belongs_to :product_model\n  belongs_to :attr_val\nend\n</code></pre>\n\n<p><em><strong>product_model.rb</strong></em></p>\n\n<pre><code>class ProductModel &lt; ApplicationRecord\n  validates :name, presence: true\n  validates :name, uniqueness: true\n\n  has_many :products\n  has_many :product_model_attr_vals\n  has_many :attr_vals, through: :product_model_attr_vals\n  has_many :attrs, through: :attr_vals\n\n  accepts_nested_attributes_for :product_model_attr_vals\n\n  belongs_to :product_category\nend\n</code></pre>\n\n<p><em><strong>product_model/new.html.erb</strong></em></p>\n\n<pre><code>&lt;%= form_for @product_model, url: {action: \"create\"} do |pm_f| %&gt;\n  &lt;%= pm_f.text_field :name %&gt;&lt;br /&gt;\n  &lt;br /&gt;\n  &lt;ul&gt;\n    &lt;% Attr.all.each do |attr| %&gt;\n      &lt;li&gt;\n        &lt;%= label_tag attr.name %&gt;&lt;br /&gt;\n          &lt;ul&gt;\n            &lt;% attr.attr_vals.each do |attr_val| %&gt;\n              &lt;li&gt;\n                &lt;%= pm_f.fields_for :product_model_attr_vals, attr_val, index: attr_val.id do |av_f| %&gt;\n                  &lt;%= av_f.check_box :id, { checked: @product_model.attr_vals.where(id: attr_val.id).count &gt; 0 } %&gt;\n                  &lt;%= label_tag attr_val.name %&gt;&lt;br /&gt;\n                &lt;% end %&gt;\n              &lt;/li&gt;\n            &lt;% end %&gt;\n          &lt;/ul&gt;\n      &lt;/li&gt;\n    &lt;% end %&gt;\n  &lt;/ul&gt;\n  &lt;br/&gt;\n  &lt;%= pm_f.submit \"Create\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><em><strong>product_model_controller.rb</strong></em></p>\n\n<pre><code>def create\n  if ProductModel.create(product_model_params)\n    # do nothing\n  else \n    @product_model = ProductModel.new\n    @attrs = Attr.all # delete me\n    @categories = ProductCategory.all #delete me\n  end\n  render 'new'\nend\n\ndef new\n    @product_model = ProductModel.new\n    @attrs = Attr.all\n    @categories = ProductCategory.all\nend\n\nprivate\n\ndef product_model_params\n  params.require(:product_model).permit(:name, product_model_attr_vals_attributes: [:id, :name])\nend\n</code></pre>\n\n<p>The result is something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aalfL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aalfL.png\" alt=\"Form\"></a></p>\n\n<p>The problem I am having is that the Product Model is not being created due to some errors and I do not know how to fix them, as I am new to Ruby on Rails and I do not know where else to look for help.</p>\n\n<p>What am I missing?</p>\n\n<hr>\n\n<pre><code>Processing by ProductModelsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"f56GFgd99m54gAbhn7iPuLLs8oAqsRZDtK58gqLlW8GP3kXs436ozCBkG+745cDF847gDCcEg==\", \"product_model\"=&gt;{\"name\"=&gt;\"New Product Model Name\", \"product_model_attr_vals_attributes\"=&gt;{\"0\"=&gt;{\"1\"=&gt;{\"id\"=&gt;\"1\"}}, \"1\"=&gt;{\"2\"=&gt;{\"id\"=&gt;\"2\"}}, \"2\"=&gt;{\"3\"=&gt;{\"id\"=&gt;\"3\"}}, \"3\"=&gt;{\"4\"=&gt;{\"id\"=&gt;\"4\"}}, \"4\"=&gt;{\"5\"=&gt;{\"id\"=&gt;\"5\"}}, \"5\"=&gt;{\"6\"=&gt;{\"id\"=&gt;\"6\"}}, \"6\"=&gt;{\"7\"=&gt;{\"id\"=&gt;\"7\"}}, \"7\"=&gt;{\"8\"=&gt;{\"id\"=&gt;\"8\"}}, \"8\"=&gt;{\"9\"=&gt;{\"id\"=&gt;\"9\"}}, \"9\"=&gt;{\"10\"=&gt;{\"id\"=&gt;\"10\"}}, \"10\"=&gt;{\"11\"=&gt;{\"id\"=&gt;\"11\"}}}}, \"commit\"=&gt;\"Create\"}\nUnpermitted parameter: :1\nUnpermitted parameter: :2\nUnpermitted parameter: :3\nUnpermitted parameter: :4\nUnpermitted parameter: :5\nUnpermitted parameter: :6\nUnpermitted parameter: :7\nUnpermitted parameter: :8\nUnpermitted parameter: :9\nUnpermitted parameter: :10\nUnpermitted parameter: :11\n   (0.1ms)  BEGIN\n  ProductModel Exists (0.2ms)  SELECT  1 AS one FROM `product_models` WHERE `product_models`.`name` = BINARY 'New Product Model Name' LIMIT 1\n  ProductModelAttrVal Exists (0.2ms)  SELECT  1 AS one FROM `product_model_attr_vals` WHERE `product_model_attr_vals`.`product_model_id` IS NULL AND `product_model_attr_vals`.`attr_val_id` IS NULL LIMIT 1\n  CACHE ProductModelAttrVal Exists (0.0ms)  SELECT  1 AS one FROM `product_model_attr_vals` WHERE `product_model_attr_vals`.`product_model_id` IS NULL AND `product_model_attr_vals`.`attr_val_id` IS NULL LIMIT 1  [[\"LIMIT\", 1]]\n  CACHE ProductModelAttrVal Exists (0.0ms)  SELECT  1 AS one FROM `product_model_attr_vals` WHERE `product_model_attr_vals`.`product_model_id` IS NULL AND `product_model_attr_vals`.`attr_val_id` IS NULL LIMIT 1  [[\"LIMIT\", 1]]\n  CACHE ProductModelAttrVal Exists (0.0ms)  SELECT  1 AS one FROM `product_model_attr_vals` WHERE `product_model_attr_vals`.`product_model_id` IS NULL AND `product_model_attr_vals`.`attr_val_id` IS NULL LIMIT 1  [[\"LIMIT\", 1]]\n  CACHE ProductModelAttrVal Exists (0.0ms)  SELECT  1 AS one FROM `product_model_attr_vals` WHERE `product_model_attr_vals`.`product_model_id` IS NULL AND `product_model_attr_vals`.`attr_val_id` IS NULL LIMIT 1  [[\"LIMIT\", 1]]\n  CACHE ProductModelAttrVal Exists (0.0ms)  SELECT  1 AS one FROM `product_model_attr_vals` WHERE `product_model_attr_vals`.`product_model_id` IS NULL AND `product_model_attr_vals`.`attr_val_id` IS NULL LIMIT 1  [[\"LIMIT\", 1]]\n  CACHE ProductModelAttrVal Exists (0.0ms)  SELECT  1 AS one FROM `product_model_attr_vals` WHERE `product_model_attr_vals`.`product_model_id` IS NULL AND `product_model_attr_vals`.`attr_val_id` IS NULL LIMIT 1  [[\"LIMIT\", 1]]\n  CACHE ProductModelAttrVal Exists (0.0ms)  SELECT  1 AS one FROM `product_model_attr_vals` WHERE `product_model_attr_vals`.`product_model_id` IS NULL AND `product_model_attr_vals`.`attr_val_id` IS NULL LIMIT 1  [[\"LIMIT\", 1]]\n  CACHE ProductModelAttrVal Exists (0.0ms)  SELECT  1 AS one FROM `product_model_attr_vals` WHERE `product_model_attr_vals`.`product_model_id` IS NULL AND `product_model_attr_vals`.`attr_val_id` IS NULL LIMIT 1  [[\"LIMIT\", 1]]\n  CACHE ProductModelAttrVal Exists (0.0ms)  SELECT  1 AS one FROM `product_model_attr_vals` WHERE `product_model_attr_vals`.`product_model_id` IS NULL AND `product_model_attr_vals`.`attr_val_id` IS NULL LIMIT 1  [[\"LIMIT\", 1]]\n  CACHE ProductModelAttrVal Exists (0.0ms)  SELECT  1 AS one FROM `product_model_attr_vals` WHERE `product_model_attr_vals`.`product_model_id` IS NULL AND `product_model_attr_vals`.`attr_val_id` IS NULL LIMIT 1  [[\"LIMIT\", 1]]\n   (0.1ms)  ROLLBACK\n  Rendering product_models/new.html.erb within layouts/application\n  Rendered product_models/new.html.erb within layouts/application (1.7ms)\nCompleted 500 Internal Server Error in 20ms (ActiveRecord: 0.7ms)\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 2, "creation_date": 1526422932, "post_id": 50359754, "comment_id": 87736513, "body": "two things. First, you have an <code>attr_reader</code> for <code>eats_cookies</code>, so once that&#39;s set in your <code>initialize</code> method, you can use the reader to get its value, e.g. <code>eats_cookies</code> instead of <code>@eats_cookies</code>. Second, your <code>fits?</code> predicate could use an <code>if</code>/<code>else</code>, but why not just <code>def fits? eats_cookies &lt;= 2; end</code>?"}, {"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 1, "creation_date": 1526423254, "post_id": 50359754, "comment_id": 87736605, "body": "That said, is <code>@eats_cookies</code> supposed to be a counter? Looking at your usage of it, it looks like perhaps you&#39;d like a counter to get incremented every time it&#39;s called?"}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1526423429, "post_id": 50359754, "comment_id": 87736645, "body": "The construct <code>true unless @eats_cookies &gt; 2  else   false  end&#39; is heinous. Try just </code>@eats_cookies &lt;= 2` - the <code>&lt;=</code> will do the <code>true</code> and <code>false</code> for you."}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526442704, "post_id": 50359754, "comment_id": 87740784, "body": "I got closer to getting the test to pass with the @eats_cookies &lt;= 2, but it still gives me a failure for refute santa.fits"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1526444988, "post_id": 50359754, "comment_id": 87741327, "body": "How are you assigning <code>eat_cookies</code> in <code>initialize</code> when you are not passing it in args?"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526442622, "post_id": 50360089, "comment_id": 87740764, "body": "I tried that and still got an undefined methods for eat_cookies and when I add that to the attr_accessor, it gave me a failure for refute santa.fits?"}, {"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "reply_to_user": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526444951, "post_id": 50360089, "comment_id": 87741317, "body": "I accidentally left out a <code>self</code> in the <code>eat_cookies</code> method. If it still doesn&#39;t work, I&#39;d try printing out the cookies - something like <code>puts &quot;cookies: #{cookies_eaten}&quot;</code> inside of your <code>fits?</code> method."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1526445072, "post_id": 50360089, "comment_id": 87741347, "body": "May be because in this definition, it is <code>eat_cookies</code> and in your test above, it is <code>eats_cookies</code>"}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526486725, "post_id": 50360089, "comment_id": 87767210, "body": "Yes, Jagdeep is right, if I change it to eats_cookies, the tests pass. I appreciate the help. And another question, why is the self needed and what does that do?"}, {"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1526488467, "post_id": 50360089, "comment_id": 87768133, "body": "I think this answer explains why you need <code>self</code> fairly well: <a href=\"https://stackoverflow.com/a/23448046/716039\">stackoverflow.com/a/23448046/716039</a>"}], "tags": [], "owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "is_accepted": true, "score": 1, "last_activity_date": 1526444720, "last_edit_date": 1526444720, "creation_date": 1526423908, "answer_id": 50360089, "question_id": 50359754, "link": "https://stackoverflow.com/questions/50359754/ruby-dealing-with-booleans/50360089#50360089", "title": "Ruby: Dealing with Booleans", "body": "<p>I'm inferring what you're trying to do here, but I think I would do something like this:</p>\n\n<pre><code>class Santa\n  attr_accessor :cookies_eaten\n\n  def initialize\n    @cookies_eaten = 0\n  end\n\n  def eat_cookies\n    self.cookies_eaten += 1\n  end\n\n  def fits?\n    cookies_eaten &lt;= 2\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 50360089, "answer_count": 1, "score": 0, "last_activity_date": 1526444720, "creation_date": 1526421671, "last_edit_date": 1592644375, "question_id": 50359754, "link": "https://stackoverflow.com/questions/50359754/ruby-dealing-with-booleans", "title": "Ruby: Dealing with Booleans", "body": "<h1>TDD</h1>\n<pre><code>gem 'minitest', '~&gt; 5.2'\nrequire 'minitest/autorun'\nrequire 'minitest/pride'\nrequire_relative 'santa'\n\nclass SantaTest &lt; Minitest::Test\n\n def test_santa_fits_down_the_chimney\n  santa = Santa.new\n  assert santa.fits?, &quot;Santa fits down the chimney&quot;\n end\n\n def test_if_santa_eats_too_many_cookies_he_does_not_fit_down_the_chimney\n\n  santa = Santa.new\n  santa.eats_cookies\n  assert santa.fits?, &quot;He still fits&quot;\n\n  santa.eats_cookies\n  assert santa.fits?, &quot;It's a bit of a sqeeze&quot;\n\n  santa.eats_cookies\n  refute santa.fits?, &quot;Good thing his suit is stretchy or that wouldn't \n  fit in that either&quot;\n end\nend\n</code></pre>\n<h1>CODE</h1>\n<pre><code>class Santa\n attr_reader :eats_cookies\n\n def initialize\n  @eats_cookies = eats_cookies\n end\n\n def fits?\n  true unless @eats_cookies &gt; 2\n else\n  false\n end\nend\n</code></pre>\n<p>Any direction as to what I can write to get the test to pass on the last test? I'm having an issue organizing the if/then, unless/else statements to make the test pass.</p>\n<p>Am I on the right track or am I far off? Appreciate any help</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 2, "creation_date": 1526414757, "post_id": 50358356, "comment_id": 87733320, "body": "There are a million ways to implement the internals of <code>Kid</code>, <code>eat_candy</code> and <code>hyperactive?</code>. You need to attempt to solve this yourself and then include all the relevant code here, along with a specific question about where you&#39;re stuck. Asking us to implement everything to your specification is off-topic for Stack Overflow."}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1526414927, "post_id": 50358356, "comment_id": 87733398, "body": "Gotcha, appreciate the input. I guess I solved the first test by refuting that the kid is hyperactive by defining the method hyperactive? and stating that that is false. My issue is that once you refute that initial statement, what direction do I need to go to keep that assertion that it is false initially and then addressing the issue of the kid eating candy and then becoming hyperactive"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1526415133, "post_id": 50358356, "comment_id": 87733489, "body": "You need to implement whatever <code>eat_candy</code> does, and then alter the implementation of <code>hyperactive?</code> to use whatever you come up with from <code>eat_candy</code>. It seems like you probably want to maintain some state about how much candy the <code>Kid</code> has eaten and then compare that state with whatever threshold you want to use to determine whether the kid is <code>hyperactive?</code>."}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1526416370, "post_id": 50358356, "comment_id": 87734107, "body": "Hm ok, here&#39;s the whole snippet of the TDD and code that I have, that might give you a better picture of what I was doing. So I have defined the eat_candy method, I&#39;m assuming I need to add an attr_reader for it and then try working that into how much the kid ate?"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 1, "creation_date": 1526416753, "post_id": 50358356, "comment_id": 87734275, "body": "That sounds like the right direction, yes."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1526416833, "post_id": 50358356, "comment_id": 87734312, "body": "One of the ideas of TDD is to write the simplest code needed to make each test pass and then write another failing test, and then make that test pass etc. So you were right to make a <code>hyperactive?</code> that always returns <code>false</code> in order to make <code>test_kid_is_not_hyperactive</code> pass. However that code is no longer enough to make <code>test_kid_is_hyperactive_after_60_grams_of_sugar</code> also pass. So you need to write a <code>hyperactive?</code> method that returns different things depending on how much sugar eaten. And you have the value for how much sugar eaten in <code>@grams_of_sugar_eaten</code>"}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526417365, "post_id": 50358356, "comment_id": 87734550, "body": "Ok, I guess I&#39;m having a hard time figuring out how to go about doing that, would false unless @grams_of_sugar_eaten &gt; 60 else true make any sense? It doesn&#39;t work but am I in the right ballpark?"}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1526417483, "post_id": 50358356, "comment_id": 87734608, "body": "Yep, definitely in the right ballpark. Is this a course you&#39;re studying? Are there some lessons to give you some guidance?"}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526417851, "post_id": 50358356, "comment_id": 87734768, "body": "Yes I&#39;m trying to learn ruby, there aren&#39;t any specific lessons on it, but the expectation is to read about booleans and understand them and then work that into code and writing methods. Any tips to revise what I had to something that makes sense? It&#39;s giving me:   1) Failure: KidTest#test_kid_is_hyperactive_after_60_grams_of_sugar [kid_test.rb:32]: Not hyperactive yet...    2) Failure: KidTest#test_kid_is_not_hyperactive [kid_test.rb:25]: Expected true to not be truthy."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1526418305, "post_id": 50358356, "comment_id": 87734980, "body": "Something like this <a href=\"https://www.tutorialspoint.com/ruby/ruby_if_else.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/ruby/ruby_if_else.htm</a> or this <a href=\"https://www.codecademy.com/courses/learn-ruby/lessons/control-flow-in-ruby/\" rel=\"nofollow noreferrer\">codecademy.com/courses/learn-ruby/lessons/control-flow-in-ru&zwnj;&#8203;by</a> is a good starting point."}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 1, "creation_date": 1526418621, "post_id": 50358356, "comment_id": 87735100, "body": "Ok appreciate the help. I&#39;ll try to see if I can get it to work"}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1526418769, "post_id": 50358356, "comment_id": 87735168, "body": "Cool. Do post another question if you get stuck but try and read some general tutorials on booleans and then ask a specific question when you need help. People will be much more likely to answer when they see what you&#39;ve already tried and when the question isn&#39;t as broad."}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526419799, "post_id": 50358356, "comment_id": 87735539, "body": "Hm, I&#39;ve posted two tries at solving it, but both give me an error, am I getting closer or still missing something?"}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1526453877, "post_id": 50358356, "comment_id": 87744659, "body": "The second version (where you&#39;ve used <code>if @grams_of_sugar_eaten &gt; 60</code>) is <i>almost</i> there. Looking at the test, if the kid eats sugar 12 times (exactly 60 grams) then that&#39;s enough to become hyperactive. So you want to &quot;use greater than or equal to&quot; (<code>&gt;=</code>) in place of just &quot;greater than&quot; (<code>&gt;</code>)."}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526485594, "post_id": 50358356, "comment_id": 87766503, "body": "ah that would be it. I appreciate you pointing that out. Why is this robot language so hard for me to grasp??"}, {"owner": {"reputation": 1319, "user_id": 511209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6b25434aee590d1acee954558528aa?s=128&d=identicon&r=PG", "display_name": "Shadow Radiance", "link": "https://stackoverflow.com/users/511209/shadow-radiance"}, "edited": false, "score": 0, "creation_date": 1526682906, "post_id": 50358356, "comment_id": 87855514, "body": "The question has been edited out of being a question. This should either be closed or reframed as a question with an answer."}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526764173, "post_id": 50358356, "comment_id": 87873703, "body": "I agree, I have updated the comments about what has happened. Thanks for letting me know."}], "owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526764143, "creation_date": 1526414554, "last_edit_date": 1592644375, "question_id": 50358356, "link": "https://stackoverflow.com/questions/50358356/ruby-tdd-plus-coding-dealing-with-booleans", "title": "Ruby TDD Plus Coding: Dealing with Booleans", "body": "<h1>TDD</h1>\n<pre><code>gem 'minitest', '~&gt; 5.2'\nrequire 'minitest/autorun'\nrequire 'minitest/pride'\nrequire_relative 'kid'\n\nclass KidTest &lt; Minitest::Test\n\n def test_kid_has_not_eaten_sugar\n \n  kid = Kid.new\n  assert_equal 0, kid.grams_of_sugar_eaten\n end\n\n def test_kid_gets_5_grams_from_eating_candy\n\n  kid = Kid.new\n  kid.eat_candy\n  assert_equal 5, kid.grams_of_sugar_eaten\n\n  5.times { kid.eat_candy }\n  assert_equal 30, kid.grams_of_sugar_eaten\n end\n\n def test_kid_is_not_hyperactive\n\n  kid = Kid.new\n  refute kid.hyperactive?\n end\n\n def test_kid_is_hyperactive_after_60_grams_of_sugar\n\n  kid = Kid.new\n  11.times { kid.eat_candy }\n  refute kid.hyperactive?, &quot;Not hyperactive yet...&quot;\n  kid.eat_candy\n  assert kid.hyperactive?, &quot;OK, now the kid is hyperactive.&quot;\n end\nend\n</code></pre>\n<h1>CODE</h1>\n<pre><code> class Kid\n  attr_reader :grams_of_sugar_eaten\n\n  def initialize\n   @grams_of_sugar_eaten = 0\n  end\n\n  def eat_candy(grams = 5)\n   @grams_of_sugar_eaten += grams\n  end\n\n  def hyperactive?\n    @grams_of_sugar_eaten &gt;= 60\n  end\n end\n</code></pre>\n<p>How can I go about to make the test pass for the last test?\nThe kid is initially not hyperactive and now after eating candy, he is hyperactive.</p>\n<p>I have defined a method hyperactive? and refuted that the kid is hyperactive by stating that it is false, but how do I then go about keeping that statement and then addressing that the kid is hyperactive after eating candy? Any direction in the right step is greatly appreciated.</p>\n<p><em>UPDATE</em></p>\n<p>So, with the help of others, the answer that made sense to me would be the final code written here. All tests pass.</p>\n<p>To start, I made a class Kid to address the new instance of Kid being made.</p>\n<p>The first test wants to see if the kid has 0 grams_of_sugar_eaten.</p>\n<p>I defined the method by initializing gram_of_sugar_eaten as an instance variable and setting that to 0. I made sure to add the attr_reader up top so that it can be accessed throughout the whole file.</p>\n<p>Next test wants to see that the kid gets 5 grams_of_sugar_eaten from eating candy.</p>\n<p>I defined the method of eat_candy and to address the kid eating 5 grams_of_sugar_eaten, I passed it in as an argument with the variable that I set as grams and assigned that to the Integer of 5.</p>\n<p>To address the last part of that test, I have set the instance variable of\ngrams_of_sugar_eaten plus/equal to grams. This will address whatever increments the grams eaten.</p>\n<p>The next test is to see if the kid is not hyperactive. I initially just wrote a hyperactive? method and assigned that to false, then I looked ahead and saw that the next test was asking to see if the kid is not hyperactive even after eating up to 59 grams of sugar.</p>\n<p>Once he hits 60 grams of sugar, he becomes hyperactive, so to address this,\ninstead of a visible if/then statement stating false/true, I simplified it by putting the instance variable of grams_of_sugar_eaten to greater than or equal to 60.</p>\n<p>This is pretty much saying the if/then statements implicitly by asking if the 60 is greater than or equal to the grams_of_sugar_eaten, it's true, if it doesn't reach that point, then it's false.</p>\n"}, {"tags": ["ruby", "docx", "caracal"], "answers": [{"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 1, "last_activity_date": 1527528118, "last_edit_date": 1527528118, "creation_date": 1526417093, "answer_id": 50358913, "question_id": 50358115, "link": "https://stackoverflow.com/questions/50358115/caracal-gem-on-ruby-jump-to-different-methods-while-continue-writing-on-the-docu/50358913#50358913", "title": "Caracal gem on ruby jump to different methods while continue writing on the document", "body": "<p>The variable <code>docx</code> is only in scope within the block attached to the <code>save</code> method. In order for the other methods to be able to see and use this variable you will need to pass it as a parameter.</p>\n\n<p>First make the methods accept a parameter, e.g.</p>\n\n<pre><code>def method1(docx)\n  docx.p \"write this\"\nend\n</code></pre>\n\n<p>then pass the actual variable as an argument when calling the method:</p>\n\n<pre><code>#...\nif $var == 1\n  method1(docx)\nelse\n# etc...\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 9724583, "user_type": "registered", "profile_image": "https://graph.facebook.com/470946310005803/picture?type=large", "display_name": "Andres P&#233;rez", "link": "https://stackoverflow.com/users/9724583/andres-p%c3%a9rez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 50358913, "answer_count": 1, "score": 0, "last_activity_date": 1527528118, "creation_date": 1526413602, "question_id": 50358115, "link": "https://stackoverflow.com/questions/50358115/caracal-gem-on-ruby-jump-to-different-methods-while-continue-writing-on-the-docu", "title": "Caracal gem on ruby jump to different methods while continue writing on the document", "body": "<p>I've been using the Caracal gem for Ruby, and I'm struggling to get it to jump between methods, while still writing to the same document. For example:</p>\n\n<pre><code>def main_method\n   Caracal::Document.save \"test.docx\" do |docx|\n      docx.p \"stuff\"\n      docx.h1 \"more stuff\"\n      docx.h2 \"even more stuff\"\n            if $var == 1\n            method1\n            else\n            method2\n            end\n   end\nend\n\ndef method1\n  docx.p \"write this\"\nend\n\ndef method2\n  docx.p \"or write this instead\"\nend\n</code></pre>\n\n<p>But no, if I jump to another method, it doesn't continue writing in the document, and apparently there is no way with Caracal to open a document, position at the end, and continue writing (like Rub\u00fd's File.open('test.txt', 'a')</p>\n\n<p>Anybody knows a way around this? I know I can put the \"write this\" directly inside the if statements, but this is just a basic example, in reality I need several ramifications as different conditions are met, so I really need to jump to different methods, or it would be a terrible mess.</p>\n\n<p>Thanks community!!</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "sanitize"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 7381391, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f1eb6a05bef3c6ed8664012a885607e7?s=128&d=identicon&r=PG&f=1", "display_name": "PandyZhao", "link": "https://stackoverflow.com/users/7381391/pandyzhao"}, "edited": false, "score": 0, "creation_date": 1526416378, "post_id": 50358213, "comment_id": 87734114, "body": "Awesome, thanks! Not sure why my linter (or my eyes) didn&#39;t catch the comma."}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 2, "last_activity_date": 1526414740, "last_edit_date": 1526414740, "creation_date": 1526413977, "answer_id": 50358213, "question_id": 50357324, "link": "https://stackoverflow.com/questions/50357324/rails-html-permit-sanitizer-not-working-as-i-expected/50358213#50358213", "title": "Rails HTML Permit Sanitizer Not Working As I Expected", "body": "<p>The first problem (\"Why is [this] scrubbing the <code>img</code> tag and <code>src</code> and <code>alt</code> attributes?\") is caused by the stray comma after the array.</p>\n\n<pre><code>#             Here v\nself.tags = %w(img),\n</code></pre>\n\n<p>TIL Ruby doesn't require the square brackets for arrays:</p>\n\n<pre><code>a = \"b\", \"c\" # =&gt; [\"b\", \"c\"]\n</code></pre>\n\n<p>So, that comma is turning your <code>tags</code> into an array of arrays:</p>\n\n<pre><code>ExampleScrubber.new.tags # =&gt; [[\"img\"], [\"src\", \"alt\"]]\n</code></pre>\n\n<p>Which is causing issues and allowing the tag to be scrubbed. Removing the comma causes things to work correctly:</p>\n\n<pre><code>class ExampleScrubber &lt; Rails::Html::PermitScrubber\n  def initialize\n    super\n    self.tags = %w(img)\n    self.attributes = %w(src alt)\n  end\n\n  # commented out for the example, but what I'm trying to ultimately do\n  # def allowed_node?(node)\n    # node.name == \"div\" &amp;&amp; node.attributes.values.first.value = \"highlight\"\n  # end\nend\n\nbody = \"&lt;ul&gt;\\n&lt;li&gt;yes&lt;/li&gt;\\n&lt;li&gt;tests&lt;/li&gt;\\n&lt;/ul&gt;\\n\\n&lt;p&gt;&lt;img src=\\\"something.jpeg\\\" alt=\\\"something\\\"&gt;&lt;/p&gt;\\n\"\nActionController::Base.helpers.sanitize(body, scrubber: ExampleScrubber.new)\n# =&gt; \"\\nyes\\ntests\\n\\n\\n&lt;img src=\\\"something.jpeg\\\" alt=\\\"something\\\"&gt;\\n\"\n</code></pre>\n\n<p>So to accomplish your goal, to only keep <code>divs</code> and only if they have an attribute (any attribute) including the word 'highlight' you might try something like:</p>\n\n<pre><code>class ExampleScrubber &lt; Rails::Html::PermitScrubber\n  def initialize\n    super\n    self.tags = %w( div )\n  end\n\n  def allowed_node?(node)\n    @tags.include?(node.name) &amp;&amp; node.attributes.values.any? do |attribute_value|\n      attribute_value.value.include?('highlight')\n    end\n  end\nend\n\nbody = \"&lt;ul&gt;\\n&lt;li class='highlight'&gt;yes&lt;/li&gt;\\n&lt;li&gt;tests&lt;/li&gt;\\n&lt;/ul&gt;\\n\\n&lt;p&gt;&lt;img src=\\\"something.jpeg\\\" alt=\\\"something\\\"&gt;&lt;/p&gt;\\n&lt;div class='highlight'&gt;Something&lt;/div&gt;&lt;div&gt;Else&lt;/div&gt;\"\nresults = ActionController::Base.helpers.sanitize(body, scrubber: ExampleScrubber.new)\n# =&gt; \"\\nyes\\ntests\\n\\n\\n\\n&lt;div class=\\\"highlight\\\"&gt;Something&lt;/div&gt;Else\"\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 7381391, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f1eb6a05bef3c6ed8664012a885607e7?s=128&d=identicon&r=PG&f=1", "display_name": "PandyZhao", "link": "https://stackoverflow.com/users/7381391/pandyzhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 50358213, "answer_count": 1, "score": 0, "last_activity_date": 1526429064, "creation_date": 1526410270, "last_edit_date": 1526429064, "question_id": 50357324, "link": "https://stackoverflow.com/questions/50357324/rails-html-permit-sanitizer-not-working-as-i-expected", "title": "Rails HTML Permit Sanitizer Not Working As I Expected", "body": "<p>I\u2019ve been stuck trying to figure out how to use the Rails sanitizer. It doesn\u2019t seem to be working as I expected. Think I\u2019m misunderstanding something.</p>\n\n<p>Basically, I'm trying to sanitize all <code>divs</code> except <code>divs</code> that have an attribute that have a value of <code>highlight</code>. But for example's sake, I tried to use <code>PermitScrubber</code> on it's own.</p>\n\n<p>I set my tags and attributes and am inheriting from PermitScrubber, but it scrubs my permitted tags and attributes anyway:</p>\n\n<pre><code>class ExampleScrubber &lt; Rails::Html::PermitScrubber\n  def initialize\n    super\n    self.tags = %w(img),\n    self.attributes = %w(src alt)\n  end\n\n  # commented out for the example, but what I'm trying to ultimately do\n  # def allowed_node?(node)\n    # node.name == \"div\" &amp;&amp; node.attributes.values.first.value = \"highlight\"\n  # end\nend\n\n@comment.body = \"&lt;ul&gt;\\n&lt;li&gt;yes&lt;/li&gt;\\n&lt;li&gt;tests&lt;/li&gt;\\n&lt;/ul&gt;\\n\\n&lt;p&gt;&lt;img src=\\\"something.jpeg\\\" alt=\\\"something\\\"&gt;&lt;/p&gt;\\n\"\nActionController::Base.helpers.sanitize(\n  @comment.body,\n  scrubber: ExampleScrubber.new\n)\n#=&gt; \"\\nyes\\ntests\\n\\n\\n\\n\"\n</code></pre>\n\n<p>So two things:\n 1. Why is scrubbing the <code>img</code> tag and <code>src</code> and <code>alt</code> attributes?\n 2. I know I could refactor the <code>allowed_node?</code> method, but I want to figure out number one first.</p>\n\n<p>Thanks for reading \u270c\ufe0f</p>\n"}, {"tags": ["ruby", "regex", "unicode"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1526409880, "post_id": 50356548, "comment_id": 87730875, "body": "Ruby&#39;s <a href=\"http://ruby-doc.org/core-2.3.6/Regexp.html\" rel=\"nofollow noreferrer\"><code>RegExp</code></a> isn&#39;t necessarily identical to Oniguruma. The Ruby docs do say that <code>\\w</code> is ASCII whereas <code>[[:alpha]]</code> is Unicode-aware. Neither one seems to say anything about <code>(?u)</code> though. I tend to use <code>\\w</code>, <code>\\s</code>, ... if I specifically want ASCII-ish behavior and <code>\\p{...}</code> otherwise."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1526410011, "post_id": 50356548, "comment_id": 87730935, "body": "<code>u</code> is actually described <a href=\"https://ruby-doc.org/core-2.5.0/Regexp.html#class-Regexp-label-Encoding\" rel=\"nofollow noreferrer\">in the Ruby docs</a>."}], "answers": [{"comments": [{"owner": {"reputation": 6638, "user_id": 8127, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "sundar - Remember Monica", "link": "https://stackoverflow.com/users/8127/sundar-remember-monica"}, "edited": false, "score": 1, "creation_date": 1526410540, "post_id": 50357308, "comment_id": 87731225, "body": "Thank you! This combined with the Extended groups options described at <a href=\"https://github.com/k-takata/Onigmo/blob/master/doc/RE#L239\" rel=\"nofollow noreferrer\">github.com/k-takata/Onigmo/blob/master/doc/RE#L239</a> seem to explain what&#39;s happening correctly."}], "tags": [], "owner": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "is_accepted": true, "score": 4, "last_activity_date": 1526410206, "creation_date": 1526410206, "answer_id": 50357308, "question_id": 50356548, "link": "https://stackoverflow.com/questions/50356548/difference-in-unicode-behaviour-between-w-vs-alpha-in-ruby/50357308#50357308", "title": "Difference in Unicode behaviour between `\\w` vs `[[:alpha:]]` in Ruby", "body": "<p>Since version 2.0, Ruby uses <a href=\"https://github.com/k-takata/Onigmo\" rel=\"nofollow noreferrer\">Onigmo</a>, an Oniguruma fork that supports more features implemented in Perl 5.10.</p>\n\n<p>If you compare the doc you linked (Oniguruma) with <a href=\"https://github.com/k-takata/Onigmo/blob/master/doc/RE\" rel=\"nofollow noreferrer\">Onigmo's doc</a> you can see a difference between the <code>\\w</code> descriptions:</p>\n\n<ul>\n<li>Oniguruma:</li>\n</ul>\n\n<blockquote>\n  <p>\\w       word character</p>\n\n<pre><code>       Not Unicode:\n         alphanumeric, \"_\" and multibyte char.\n\n       Unicode: General_Category -- (Letter|Mark|Number|Connector_Punctuation)\n</code></pre>\n</blockquote>\n\n<ul>\n<li>Onigmo:</li>\n</ul>\n\n<blockquote>\n  <p>\\w       word character</p>\n\n<pre><code>       Not Unicode:\n         alphanumeric and \"_\".\n\n       Unicode: General_Category -- (Letter|Mark|Number|Connector_Punctuation)\n\n       It depends on ONIG_OPTION_ASCII_RANGE option that non-ASCII char includes or not.\n</code></pre>\n</blockquote>\n\n<p>As you can see, there's no more this <b>\"and multibyte char.\"</b> that doesn't make sense (at least for me) and that is probably a typo. Whatever, it's very unclear.</p>\n\n<p>The <code>u</code> modifier switches the shorthand character classes from \"Not Unicode\" (default) to \"Unicode\".\nThat's why you obtain only <code>caf</code> without it and <code>caf\u00e9</code> with it when you try to match it using the character class <code>\\w</code>.</p>\n\n<p>On the other side the character class <code>[[:alpha:]]</code> seems to be already extended by default to unicode characters since it matches \"caf\u00e9\" without the u modifier. A start of explanation can be found in the doc:</p>\n\n<blockquote>\n  <p>It depends on ONIG_OPTION_ASCII_RANGE option and\n      ONIG_OPTION_POSIX_BRACKET_ALL_RANGE option that POSIX brackets\n  match non-ASCII char or not.</p>\n</blockquote>\n\n<p>But you can force it to ascii using the <code>(?a)</code> modifier.</p>\n"}], "owner": {"reputation": 6638, "user_id": 8127, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "sundar - Remember Monica", "link": "https://stackoverflow.com/users/8127/sundar-remember-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 2, "accepted_answer_id": 50357308, "answer_count": 1, "score": 2, "last_activity_date": 1526410206, "creation_date": 1526407042, "question_id": 50356548, "link": "https://stackoverflow.com/questions/50356548/difference-in-unicode-behaviour-between-w-vs-alpha-in-ruby", "title": "Difference in Unicode behaviour between `\\w` vs `[[:alpha:]]` in Ruby", "body": "<p>(For this question, ignore the number and underscore matching of <code>\\w</code>, which is irrelevant to the discussion here.)<br>\nAccording to the <a href=\"https://github.com/kkos/oniguruma/blob/master/doc/RE\" rel=\"nofollow noreferrer\">Oniguruma docs</a>, both the shorthand character classes like <code>\\w</code> and POSIX classes like <code>[:alpha:]</code> have similar behaviour with regard to Unicode: they have simple ascii behaviour for \"Not Unicode Case\" (I assume that means the string's <code>encoding</code> is not a Unicode one), and a different behaviour that uses Unicode properties for \"Unicode Case\". </p>\n\n<p>From that documentation, it sounds as in a case where one of those uses Unicode properties, the other will also use them. However, in practice they seem to differ: the POSIX classes use Unicode properties automatically, whereas the <code>\\w</code> type classes have to be explicitly marked with <code>?u</code> to use Unicode property based matching:</p>\n\n<pre><code>$ ruby -e 'print(\"~caf\u00e9.\".encoding)'\nUTF-8\n$ ruby -e 'print(/[[:alpha:]]+/.match(\"~caf\u00e9.\"))'\ncaf\u00e9\n$ ruby -e 'print(/\\w+/.match(\"~caf\u00e9.\"))'\ncaf\n$ ruby -e 'print(/(?u)\\w+/.match(\"~caf\u00e9.\"))'\ncaf\u00e9\n$ ruby -v\nruby 2.3.6p384 \n</code></pre>\n\n<p>Is this a bug, or is my interpretation of the docs wrong? (And what exactly does <code>?u</code> do, could someone link to where it is documented?)</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1526412106, "post_id": 50357535, "comment_id": 87732038, "body": "I&#39;ve managed to figure it out and I see I have exacly same solution. Thanks!"}], "tags": [], "owner": {"reputation": 1086, "user_id": 5201594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHVDD.jpg?s=128&g=1", "display_name": "rahul mishra", "link": "https://stackoverflow.com/users/5201594/rahul-mishra"}, "is_accepted": true, "score": 3, "last_activity_date": 1526411121, "creation_date": 1526411121, "answer_id": 50357535, "question_id": 50356457, "link": "https://stackoverflow.com/questions/50356457/how-to-properly-mock-objects-in-rspec/50357535#50357535", "title": "How to properly mock objects in RSpec?", "body": "<p>bucket and key parameters differ in actual calling and mocking. \nUse below code it works:</p>\n\n<pre><code>describe S3DownloadUrlGenerator do\n  before do\n    allow(Aws::S3::Client).to receive(:new) { s3_client }\n  end\n  let(:s3_client) { spy(\"s3 client\") }\n  let(:presigner) { spy(\"s3 presigner\") }\n  it \"generates download URL for a file\" do\n    expect(Aws::S3::Presigner).to receive(:new).with(client: s3_client).and_return(presigner)\n    expect(presigner).to receive(:presigned_url).with(\n      :get_object,\n      bucket: \"my-bucket\",\n      key: \"Test_file.txt\",\n      response_content_disposition: \"attachment\",\n    ).and_return(\"https://www.example.com\")\n    expect(described_class.new(\"Test_file.txt\").presigned_url).to eq(\"https://www.example.com\")\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 50357535, "answer_count": 1, "score": 0, "last_activity_date": 1526651468, "creation_date": 1526406699, "last_edit_date": 1526651468, "question_id": 50356457, "link": "https://stackoverflow.com/questions/50356457/how-to-properly-mock-objects-in-rspec", "title": "How to properly mock objects in RSpec?", "body": "<p>I have a simple class, which generates a download URL to a file stored on S3 and I need to write a unit test to test this class. So far I've had no luck.</p>\n\n<pre><code>class S3DownloadUrlGenerator\n  def initialize(filename)\n    @filename = filename\n  end\n\n  def presigned_url\n    signer = Aws::S3::Presigner.new(client: s3)\n    signer.presigned_url(\n      :get_object,\n      bucket: \"my-bucket\",\n      key: filename,\n      response_content_disposition: \"attachment\",\n    )\n  end\n\n  private\n\n  def s3\n    @s3 ||= Aws::S3::Client.new(\n      region: \"my-region,\n      http_open_timeout: 5,\n      http_read_timeout: 25,\n    )\n  end\n\n  attr_reader :filename\nend\n</code></pre>\n\n<p>I want to test if calling #presigned_url on an instance of S3DownloadUrlGenerator returns a URL.\nThis is my test:</p>\n\n<pre><code>describe S3DownloadUrlGenerator do\n  before do\n    allow(Aws::S3::Client).to receive(:new) { s3_client }\n  end\n  let(:s3_client) { spy(\"s3 client\") }\n  let(:presigner) { spy(\"s3 presigner\") }\n\n  it \"generates download URL for a file\" do\n    expect(Aws::S3::Presigner).to receive(:new).with(client: s3_client).and_return(presigner)\n    expect(presigner).to receive(:presigned_url).with(\n      :get_object,\n      bucket: \"my-test-bucket\",\n      key: \"test_file.txt\",\n      response_content_disposition: \"attachment\",\n    ).and_return(\"https://www.example.com\")\n    expect(described_class.new(\"Test_file.txt\").presigned_url).to eq(\"https://www.example.com\")\n  end\nend\n</code></pre>\n\n<p>but I get an error:</p>\n\n<pre><code>Failure/Error: expect(described_class.new(\"Test_file.txt\").presigned_url).to eq(\"https://www.example.com\")\n\n       expected: \"https://www.example.com\"\n            got: #&lt;Double \"s3 presigner\"&gt;\n\n       (compared using ==)\n</code></pre>\n\n<p>I am bit new to this and I would like to learn how to properly test such cases. Thank you very much for the help.</p>\n"}, {"tags": ["arrays", "ruby", "counting"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1526407255, "post_id": 50356307, "comment_id": 87729514, "body": "Not entirely sure what you&#39;re trying to do here. 1. Is there a reason you append <code>each</code> with <code>with_index</code>? You don&#39;t use the index anywhere in your code. 2. Iterating over <code>array1</code> seems pointless since they all contain the same object, maybe this is a test array? Either way <code>array1.uniq</code> maybe the better choice to stop repeating yourself. 3. Why are you measuring the count if you&#39;re not using it anywhere?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1526408675, "post_id": 50356307, "comment_id": 87730248, "body": "<i>&quot;I am trying to count how many blue symbols are in array2&quot;</i>. <code>array2.count(:blue) #=&gt; 0</code> will do the trick."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1526423556, "post_id": 50356307, "comment_id": 87736676, "body": "You need to explain what you are trying to do, in words, at the beginning. For example, &quot;Given two arrays, <code>array1</code> and <code>array2</code>, and an object, <code>obj</code>, return the number of times <code>obj</code> appears in <code>array1</code>, provided <code>obj</code> appears at least once in <code>array2</code>. If <code>obj</code> does not appear in <code>array2</code>, return <code>0</code>&quot;. Note that the solution is the same regardless of the classes to which the objects belong."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526528399, "post_id": 50356307, "comment_id": 87781582, "body": "You are &quot;trying to count how many blue symbols are in <code>array2</code>&quot;. Not sure how <code>array1</code> has any relevance here, and why you have <code>array1</code> in your code."}], "answers": [{"comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1526406855, "post_id": 50356366, "comment_id": 87729319, "body": "<code>unless array2.count(color1).zero?</code> looks better"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 1, "creation_date": 1526406926, "post_id": 50356366, "comment_id": 87729355, "body": "Debatable, I&#39;d say :)"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1526406956, "post_id": 50356366, "comment_id": 87729370, "body": "@Ilya preceded by <code>near_matches += 1</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1526417432, "post_id": 50356366, "comment_id": 87734582, "body": "<code>near_matches += 1 if array2.include?(color1)</code> may be more efficient than <code>count</code> as the former terminates as soon as one instance of <code>color1</code> is found. Both <code>include?</code> and <code>count</code> are written in C. <code>include?</code> arguably reads better as well, as it&#39;s not really the <code>count</code> that is wanted. In that regard <code>any?</code> would be even better, but it requires a block."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1526543610, "post_id": 50356366, "comment_id": 87787811, "body": "I&#39;m not sure this is correct. What should happen if <code>:blue</code> appears twice in <code>array2</code>? Why not simply use <code>near_matches += array2.count(color1)</code>?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1526543697, "post_id": 50356366, "comment_id": 87787863, "body": "I&#39;m not sure too because the question is totally unclear to me. I just wanted to point out the issue. Don&#39;t mind about the algorithm the user wants to implement."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 3, "last_activity_date": 1526406358, "creation_date": 1526406358, "answer_id": 50356366, "question_id": 50356307, "link": "https://stackoverflow.com/questions/50356307/counting-symbols-in-arrays/50356366#50356366", "title": "Counting symbols in arrays", "body": "<p><code>count</code> method returns a number, and every number is truthy in Ruby. The only non-truthy values are <code>nil</code> and <code>false</code>, so this expression</p>\n\n<pre><code>near_matches += 1\n</code></pre>\n\n<p>is always performed. Maybe you could do</p>\n\n<pre><code>if array2.count(color1) &gt; 0\n  near_matches += 1\nend \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1086, "user_id": 5201594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHVDD.jpg?s=128&g=1", "display_name": "rahul mishra", "link": "https://stackoverflow.com/users/5201594/rahul-mishra"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1526412948, "post_id": 50357061, "comment_id": 87732444, "body": "@sagar Pandya Thanks for formatting. I am new to StackOverflow. next time I format the content before posting. Thanks!"}, {"owner": {"reputation": 1086, "user_id": 5201594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHVDD.jpg?s=128&g=1", "display_name": "rahul mishra", "link": "https://stackoverflow.com/users/5201594/rahul-mishra"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1526530115, "post_id": 50357061, "comment_id": 87781978, "body": "@CarySwoveland sry for the late reply. I mean other than <code>false and nil</code>  all values are logically evaluated to <code>true</code>  ref: <a href=\"https://stackoverflow.com/questions/23068834/what-evaluates-to-false-in-ruby\" title=\"what evaluates to false in ruby\">stackoverflow.com/questions/23068834/&hellip;</a>  let me know if you have any different thoughts on that  thanks!"}, {"owner": {"reputation": 1086, "user_id": 5201594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHVDD.jpg?s=128&g=1", "display_name": "rahul mishra", "link": "https://stackoverflow.com/users/5201594/rahul-mishra"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1526531715, "post_id": 50357061, "comment_id": 87782354, "body": "sry for the confusion have updated it. Thanks and Have a great day ahead!"}], "tags": [], "owner": {"reputation": 1086, "user_id": 5201594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHVDD.jpg?s=128&g=1", "display_name": "rahul mishra", "link": "https://stackoverflow.com/users/5201594/rahul-mishra"}, "is_accepted": false, "score": 1, "last_activity_date": 1526531643, "last_edit_date": 1526531643, "creation_date": 1526409145, "answer_id": 50357061, "question_id": 50356307, "link": "https://stackoverflow.com/questions/50356307/counting-symbols-in-arrays/50357061#50357061", "title": "Counting symbols in arrays", "body": "<p><code>nil</code> and <code>false</code> are the only two values, that evaluate to <code>false</code> in Ruby.</p>\n\n<p>ref: <a href=\"https://stackoverflow.com/questions/23068834/what-evaluates-to-false-in-ruby\">What evaluates to false in Ruby?</a></p>\n\n<p><code>array2.count(color1)</code> will never return <code>nil</code> or <code>false</code> so near_matches always incremented and at the end its value is equal to <code>array1.size</code></p>\n\n<p>you should use inject    </p>\n\n<pre><code>array1.uniq.inject(0){ |sum,color| sum + array2.count(color) }\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9226882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee8ddf3acfc2dd7ff02846885c2126a?s=128&d=identicon&r=PG&f=1", "display_name": "Bri Expost", "link": "https://stackoverflow.com/users/9226882/bri-expost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1526531643, "creation_date": 1526406054, "last_edit_date": 1526528335, "question_id": 50356307, "link": "https://stackoverflow.com/questions/50356307/counting-symbols-in-arrays", "title": "Counting symbols in arrays", "body": "<p>I have:</p>\n\n<pre><code>array1 = [:blue, :blue, :blue, :blue]\narray2 = [:green, :green, :yellow, :red] \n</code></pre>\n\n<p>I am trying to count how many blue symbols are in <code>array2</code>, which is <code>0</code>. I did:</p>\n\n<pre><code>near_matches = 0\narray1.each do |color1|\n  if array2.count(color1)\n    near_matches += 1\n  end\nend\n\nnear_matches #=&gt; 4\n</code></pre>\n\n<p>There are no matching color symbols in <code>array1</code> with <code>array2</code>, and yet I still get <code>4</code> as an output. I was wondering why the output of my code is <code>4</code>.</p>\n"}, {"tags": ["ruby", "tdd"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1526404797, "post_id": 50355941, "comment_id": 87728198, "body": "Please format your code snippets properly."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 1, "creation_date": 1526404956, "post_id": 50355941, "comment_id": 87728301, "body": "You need to add an <code>eat_candy</code> method to your <code>Kid</code> class that increases <code>@grams_of_sugar_eaten</code> by the right amount. Give that a try and then post a follow up if you get stuck."}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526405271, "post_id": 50355941, "comment_id": 87728489, "body": "I think I reedited the code to where it should be formatted properly, please let me know if it looks weird still."}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526405340, "post_id": 50355941, "comment_id": 87728527, "body": "I&#39;ve added a eat_candy method, but am not sure what to do in order to increase the grams_of_sugar_eaten to 5 and then to 30 without messing up the first test"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526405607, "post_id": 50355941, "comment_id": 87728661, "body": "Hint: 5 * 6 = 30."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526406187, "post_id": 50356184, "comment_id": 87728942, "body": "ok that works, I appreciate the help. So for the eat_candy method, we&#39;re passing the argument of grams = 5 and then just having to adjust the amount of grams eaten by whatever increment was given?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526406814, "post_id": 50356184, "comment_id": 87729288, "body": "Yeah, the <code>= 5</code> part means &quot;default to 5&quot;, so if no argument is given that will be 5 grams. You could say <code>eat_candy(900)</code> to induce a sugar coma."}, {"owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526410511, "post_id": 50356184, "comment_id": 87731212, "body": "How would you go about solving the booleans issue in the last test? Any hints as far as addressing the hyperactivity initially and then having to deal with him becoming hyperactive?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "edited": false, "score": 0, "creation_date": 1526410913, "post_id": 50356184, "comment_id": 87731414, "body": "That&#39;s technically another question, so might be worth re-posting and focusing on that angle."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": -1, "last_activity_date": 1526405565, "creation_date": 1526405565, "answer_id": 50356184, "question_id": 50355941, "link": "https://stackoverflow.com/questions/50355941/ruby-tdd-plus-coding/50356184#50356184", "title": "Ruby: TDD Plus Coding", "body": "<p>You've added <code>eat_candy</code> as an <code>attr_reader</code>, not a method. The <code>initialize</code> function here sets <code>eat_candy</code> to itself.</p>\n\n<p>A possible fix:</p>\n\n<pre><code>class Kid\n  attr_reader :grams_of_sugar_eaten\n\n  def initialize\n    @grams_of_sugar_eaten = 0\n  end\n\n  def eat_candy(grams = 5)\n    @grams_of_sugar_eaten += grams\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 9795689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "cjl85", "link": "https://stackoverflow.com/users/9795689/cjl85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 50356184, "answer_count": 1, "score": 0, "last_activity_date": 1526414594, "creation_date": 1526404617, "last_edit_date": 1526414594, "question_id": 50355941, "link": "https://stackoverflow.com/questions/50355941/ruby-tdd-plus-coding", "title": "Ruby: TDD Plus Coding", "body": "<pre><code>gem 'minitest', '~&gt; 5.2'\n# TDD\n\nrequire 'minitest/autorun'\nrequire 'minitest/pride'\nrequire_relative 'kid'\n\nclass KidTest &lt; Minitest::Test\n  def test_kid_has_not_eaten_sugar\n    kid = Kid.new\n    assert_equal 0, kid.grams_of_sugar_eaten\n  end\n\n  def test_kid_gets_5_grams_from_eating_candy\n\n    kid = Kid.new\n    kid.eat_candy\n    assert_equal 5, kid.grams_of_sugar_eaten\n\n    5.times { kid.eat_candy }\n    assert_equal 30, kid.grams_of_sugar_eaten\n  end\n\n  def test_kid_is_not_hyperactive\n\n    kid = Kid.new\n    refute kid.hyperactive?\n  end\n\n  def test_kid_is_hyperactive_after_60_grams_of_sugar\n\n    kid = Kid.new\n    11.times { kid.eat_candy }\n    refute kid.hyperactive?, \"Not hyperactive yet...\"\n    kid.eat_candy\n    assert kid.hyperactive?, \"OK, now the kid is hyperactive.\"\n  end\nend\n\n# CODE\n\nclass Kid\n  attr_reader :grams_of_sugar_eaten\n\n\n  def initialize\n    @grams_of_sugar_eaten = 0\n  end\n\n  def eat_candy(grams = 5)\n    @grams_of_sugar_eaten += grams\n  end\n\n  def hyperactive?\n    false\n  end\nend\n</code></pre>\n\n<p>Can anyone help direct me in the thinking that I should have as far as how to go about getting the 2nd test to pass and so on?</p>\n\n<p>I'm not sure what to do make the test pass after the kid eats 5 grams of sugar and then after 5.times to have it pass after he eats 30 grams of sugar.</p>\n\n<p>Appreciate any help</p>\n"}, {"tags": ["ruby", "sinatra", "environments"], "comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1526403888, "post_id": 50355358, "comment_id": 87727665, "body": "Sinatra&#39;s <code>sinatra_contrib</code> includes the <code>config_file</code> extension that lets you decouple this to some extent - <a href=\"https://github.com/sinatra/sinatra/blob/master/sinatra-contrib/lib/sinatra/config_file.rb\" rel=\"nofollow noreferrer\">github.com/sinatra/sinatra/blob/master/sinatra-contrib/lib/&hellip;</a> - though it won&#39;t let you do conditional <code>require</code>s etc."}, {"owner": {"reputation": 259, "user_id": 2657500, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JSrW2.png?s=128&g=1", "display_name": "jmolina", "link": "https://stackoverflow.com/users/2657500/jmolina"}, "reply_to_user": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1526450095, "post_id": 50355358, "comment_id": 87742922, "body": "Thanks for the response. ConfigFile allows you to export config to a yaml file, but not adding ruby code in there. I&#39;m going to change my question to show which is my problem."}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 2657500, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JSrW2.png?s=128&g=1", "display_name": "jmolina", "link": "https://stackoverflow.com/users/2657500/jmolina"}, "edited": false, "score": 0, "creation_date": 1526450376, "post_id": 50355818, "comment_id": 87743031, "body": "Thanks for the answer. However, I&#39;m looking for a place to put also ruby code, like Rails has with the development.rb files instead of yaml files that only allows you to have key-value config."}], "tags": [], "owner": {"reputation": 152, "user_id": 8537414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e5657f119d17b6de0b97b6d89301b0?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio Cipolla", "link": "https://stackoverflow.com/users/8537414/antonio-cipolla"}, "is_accepted": false, "score": 1, "last_activity_date": 1526404138, "creation_date": 1526404138, "answer_id": 50355818, "question_id": 50355358, "link": "https://stackoverflow.com/questions/50355358/sinatra-with-multiple-environment-config/50355818#50355818", "title": "Sinatra with multiple environment config", "body": "<p>try sinatra/config, you can store all your config settings in a file and provide specific environment configuration.</p>\n\n<pre><code> require \"sinatra\"\n require \"sinatra/contrib\"\n\nconfig_file '../config/config.yml'\nget \"/\"\nsettings.bar\nend\n#config.yml\ndevelopment:\n  foo: development\n  bar: bar\ntest:\n  foo: test\n  bar: bar\nproduction:\n  foo: production\n  bar: bar\n</code></pre>\n\n<p><a href=\"http://sinatrarb.com/contrib/config_file\" rel=\"nofollow noreferrer\">http://sinatrarb.com/contrib/config_file</a></p>\n"}, {"tags": [], "owner": {"reputation": 259, "user_id": 2657500, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JSrW2.png?s=128&g=1", "display_name": "jmolina", "link": "https://stackoverflow.com/users/2657500/jmolina"}, "is_accepted": true, "score": 0, "last_activity_date": 1526455122, "creation_date": 1526455122, "answer_id": 50364605, "question_id": 50355358, "link": "https://stackoverflow.com/questions/50355358/sinatra-with-multiple-environment-config/50364605#50364605", "title": "Sinatra with multiple environment config", "body": "<p>I finally came up with a solution using self.included class method:</p>\n\n\n\n<pre class=\"lang-rb prettyprint-override\"><code># config.rb\nrequire 'sinatra/custom_logger'\n\nmodule Config\n  def self.included(base_klass)\n    base_klass.extend(ClassMethods)\n\n    base_klass.helpers(Sinatra::CustomLogger)\n\n    base_klass.class_eval do\n      configure :development do\n        logger = MyCustomLogger.new(\n          param1,\n          param2,\n          param3,\n          paramx\n        )\n\n\n        set :logger, logger\n      end\n\n      configure :production do\n        # other stuff\n      end\n    end\n  end\n\n  module ClassMethods; end\nend\n</code></pre>\n\n<p>then</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require_relative 'config'\n\nclass MyApp &lt; Sinatra::Base\n  include Config\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 2657500, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JSrW2.png?s=128&g=1", "display_name": "jmolina", "link": "https://stackoverflow.com/users/2657500/jmolina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 50364605, "answer_count": 2, "score": 0, "last_activity_date": 1553589139, "creation_date": 1526402593, "last_edit_date": 1526450294, "question_id": 50355358, "link": "https://stackoverflow.com/questions/50355358/sinatra-with-multiple-environment-config", "title": "Sinatra with multiple environment config", "body": "<p>After working with Sinatra a couple of weeks I reached the moment to deploy my app in a staging environment. After reviewing <a href=\"http://sinatrarb.com/configuration.html\" rel=\"nofollow noreferrer\">sinatra configuration settings</a> and looking around I did not find a way to have a config file per environment so that instead of having this:</p>\n\n\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'sinatra/base'\nrequire 'sinatra/custom_logger'\n\nclass MyApp &lt; Sinatra::Base\n  helpers Sinatra::CustomLogger\n\n  configure :development do\n    logger = MyCustomLogger::Logger.new(param1, \n                                        param2, \n                                        param3,\n                                        paramX)\n    set :logger, logger\n    ...\n  end\n\n  configure :production do\n    logger = MyAnotherCustomerLogger.new(param1, param2)\n    set :logger, logger\n  end\n\n  configure :whatever do\n\n  end\n\n  # endpoints definition\nend\n</code></pre>\n\n<p>I would like to get to something cleaner like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'sinatra/base'\nrequire 'environment_config'\n\nclass MyApp &lt; Sinatra::Base\n  register EnvironmentConfig # Not sure how..\n\n  ...\nend\n\nclass EnvironmentConfig\n  configuration :development do\n    # 10 lines of configuration\n  end\n\n  configuration: production do\n    # 20 lines of configuration\n  end\nend\n</code></pre>\n\n<p>And within that class/module we can either have a file per environment or one file with all the different configurations.</p>\n\n<p>My question then would be, is there a way to structure a Sinatra app in a way that the configuration is not on the same place as the definitions of the endpoints?\nThank you beforehand.</p>\n"}, {"tags": ["ruby", "nokogiri"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 1, "creation_date": 1526402649, "post_id": 50355272, "comment_id": 87726945, "body": "Why is there a space in <code>&quot;http:&#47;&#47;www.oddsmath.com&#47;odds- comparison&#47;&quot;</code>?"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1526404921, "post_id": 50355272, "comment_id": 87728279, "body": "Can you describe in English how to uniquely identify the table you want?"}, {"owner": {"reputation": 73, "user_id": 9177662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676fe695fafe582e6e14ab6ac0b98696?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9177662/john"}, "edited": false, "score": 0, "creation_date": 1526405353, "post_id": 50355272, "comment_id": 87728538, "body": "Hi Mark, It&#39;s the main table on that page - the odds comparison table - should brink back the following fields date, league, type, home team, 1(2),X(2), 2(2), Away Team, Margin"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 9177662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676fe695fafe582e6e14ab6ac0b98696?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9177662/john"}, "edited": false, "score": 0, "creation_date": 1526406743, "post_id": 50356361, "comment_id": 87729246, "body": "Good spot - you are right! I was looking at the inspect element view rather than show the page source. It&#39;s in the former but not in the latter."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 73, "user_id": 9177662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676fe695fafe582e6e14ab6ac0b98696?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9177662/john"}, "edited": false, "score": 1, "creation_date": 1526407284, "post_id": 50356361, "comment_id": 87729528, "body": "@John - Correct, because the inspect element view shows the current status of the page as affected by all JS that has been run.  If you want to see all the raw documents/data the browser loads you can look at the network tab in the developer console of the console."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1526406343, "creation_date": 1526406343, "answer_id": 50356361, "question_id": 50355272, "link": "https://stackoverflow.com/questions/50355272/parsing-a-table-with-nokogiri/50356361#50356361", "title": "Parsing a table with Nokogiri", "body": "<p>If you look at the actual HTML returned when you visit that page, you'll see the table is actually empty, and the contents are dynamically loaded by JS.  Because of that you can't do what you want with just nokogiri opening the page. You'll need to use something that allows you to control a real browser (or emulates a browser with JS support) in order for the page to fully load before getting the page contents, or you'll need to figure out what URL the page is loading the data for the table from and see if you can access it directly from there (may not be possible).</p>\n"}], "owner": {"reputation": 73, "user_id": 9177662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676fe695fafe582e6e14ab6ac0b98696?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9177662/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 50356361, "answer_count": 1, "score": 0, "last_activity_date": 1526406343, "creation_date": 1526402315, "last_edit_date": 1526405288, "question_id": 50355272, "link": "https://stackoverflow.com/questions/50355272/parsing-a-table-with-nokogiri", "title": "Parsing a table with Nokogiri", "body": "<p>I feel like I must be so close on this one but I cant seem to identify the right table name to get the data from. Could someone take a quick look at this and tell me where I am going wrong? Pretty sure I am currently getting no data back from the table variable?</p>\n\n<pre><code>def oddsmath\n\n   require 'nokogiri'\n\n\n   tables_data = []\n\n   doc = Nokogiri::HTML(open(\"http://www.oddsmath.com/odds-comparison/\"))\n\n  doc.css('table#table-odds-comparison.tbl-odds-comparison.tablesorter.tablesorter-default.hasStickyHeaders').each do |table|\n\n# find all rows in the current table, then iterate over the second all the way to the final one...\ntable.css('tr')[1..-1].each do |tr|\n\n# collect the cell data and raw names from the remaining rows' cells...\nraw_name = tr.at('th').text\ncell_data = tr.css('td').map(&amp;:text)\n\n# aggregate it...\ntables_data += [raw_name, cell_data]\nend\nend\n@output=tables_data\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "form-for"], "comments": [{"owner": {"reputation": 269, "user_id": 5677587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S2Q4c.png?s=128&g=1", "display_name": "ragurney", "link": "https://stackoverflow.com/users/5677587/ragurney"}, "edited": false, "score": 0, "creation_date": 1526402139, "post_id": 50354866, "comment_id": 87726662, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/972857/multiple-objects-in-a-rails-form\">Multiple objects in a Rails form</a>"}, {"owner": {"reputation": 300, "user_id": 4481206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/421264bfc22afa5b1e1faf28e8af6c98?s=128&d=identicon&r=PG&f=1", "display_name": "APS", "link": "https://stackoverflow.com/users/4481206/aps"}, "edited": false, "score": 1, "creation_date": 1526403461, "post_id": 50354866, "comment_id": 87727433, "body": "You need to make the hidden field unique for each iteration. Here generated hidden field has same id which returns last value as other values get override.."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 5543726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1191007070915645/picture?type=large", "display_name": "Mathieu Larouche", "link": "https://stackoverflow.com/users/5543726/mathieu-larouche"}, "is_accepted": false, "score": 0, "last_activity_date": 1526406237, "creation_date": 1526406237, "answer_id": 50356336, "question_id": 50354866, "link": "https://stackoverflow.com/questions/50354866/rails-form-for-only-submitting-last-input/50356336#50356336", "title": "Rails form_for only submitting last input", "body": "<p>I dont know your use case but you can use the gem cocoon for doing that. There will also be a link to add/remove another product.</p>\n\n<p><a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">https://github.com/nathanvda/cocoon</a></p>\n"}, {"tags": [], "owner": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "is_accepted": false, "score": 0, "last_activity_date": 1526412127, "creation_date": 1526412127, "answer_id": 50357765, "question_id": 50354866, "link": "https://stackoverflow.com/questions/50354866/rails-form-for-only-submitting-last-input/50357765#50357765", "title": "Rails form_for only submitting last input", "body": "<p>You can iterate with <code>each_with_index</code>:</p>\n\n<pre><code>&lt;%= form_for :inventory do |f| %&gt;\n  &lt;% @products.each_with_index do |product, i| %&gt;\n    &lt;tr&gt;\n      &lt;%= f.hidden_field \"product_id[#{i}]\", :value =&gt; product.id %&gt;\n    &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Like that the output is not very elegant (something like <code>\"product_id\"=&gt;{\"0\"=&gt;\"1\", \"1\"=&gt;\"2\", \"2\"=&gt;\"3\"... }</code>) but it's for the example to show how every hidden field needs a unique key.<br>\nYou can define your params in a better way to use them in the controller, just keep them unique.</p>\n"}], "owner": {"reputation": 11, "user_id": 5858700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36df741e1a6e7f2f924092b3d88e416?s=128&d=identicon&r=PG&f=1", "display_name": "Marco G", "link": "https://stackoverflow.com/users/5858700/marco-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1526412127, "creation_date": 1526400866, "question_id": 50354866, "link": "https://stackoverflow.com/questions/50354866/rails-form-for-only-submitting-last-input", "title": "Rails form_for only submitting last input", "body": "<p>Im trying to create inputs by looping each product and have one form submission for all the inputs. Currently, the form only submits the last input. How would I make it so all the inputs get submitted?  </p>\n\n<pre><code>&lt;%= form_for :inventory do |f| %&gt;\n    &lt;% @products.each do |product| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= product.name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= product.measurement %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= f.number_field :amount, class: 'form-control' %&gt;&lt;/td&gt;\n        &lt;%= f.hidden_field :product_id, :value =&gt; product.id %&gt;\n      &lt;/tr&gt;\n      &lt;% end %&gt;\n     &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "conditional", "control-flow", "pundit"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1526400105, "post_id": 50354216, "comment_id": 87725500, "body": "Out of curiosity, why do you mix <code>or</code> and <code>||</code>? What seems to be &quot;not the best&quot; about <code>a || b || c</code>?"}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1526414655, "post_id": 50354216, "comment_id": 87733264, "body": "I just did that to separate it visually because admin and moderator are similar"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1526414894, "post_id": 50354216, "comment_id": 87733379, "body": "FWIW, the <a href=\"https://github.com/bbatsov/ruby-style-guide#no-and-or-or\" rel=\"nofollow noreferrer\">ruby style guide</a> suggests <code>or</code> is &quot;banned&quot; due to the &quot;high probability of introducing subtle bugs&quot;."}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1526415116, "post_id": 50354216, "comment_id": 87733484, "body": "cool. thanks @jvillian"}], "answers": [{"comments": [{"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1526414749, "post_id": 50355002, "comment_id": 87733316, "body": "would it be better to put <code>admin_or_moderator</code> in the user model or as a private method on the policy?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1526424025, "post_id": 50355002, "comment_id": 87736803, "body": "it could makes sense even in the user model for me"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1526401313, "creation_date": 1526401313, "answer_id": 50355002, "question_id": 50354216, "link": "https://stackoverflow.com/questions/50354216/how-to-write-a-pundit-policy-with-3-or-statements/50355002#50355002", "title": "How to write a Pundit policy with 3 or statements?", "body": "<p>Two possible ways to: either</p>\n\n<pre><code>def update?\n  user.admin_or_moderator? || user == @artist.user\nend\n</code></pre>\n\n<p><code>admin_or_moderator?</code> is just to say, it could be even something like <code>privileged?</code> and implement this method in your <code>User</code> model. Or</p>\n\n<pre><code>def update?\n  %i(admin moderator).include?(user.role) || user == @artist.user\nend\n</code></pre>\n\n<p>Here I'm guessing you have something like a role in your <code>User</code> model but that's the idea</p>\n"}, {"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 2, "last_activity_date": 1526417464, "last_edit_date": 1526417464, "creation_date": 1526415454, "answer_id": 50358555, "question_id": 50354216, "link": "https://stackoverflow.com/questions/50354216/how-to-write-a-pundit-policy-with-3-or-statements/50358555#50358555", "title": "How to write a Pundit policy with 3 or statements?", "body": "<p>BTW, you <em>could</em> do something like:</p>\n\n<pre><code>delegate *%w(admin? moderator?), to: :user\n\ndef user_artist?\n  user == @artist.user\nend\n\ndef update?\n  admin? || moderator? || user_artist?\nend\n</code></pre>\n\n<p>That seems pretty clean to me.</p>\n"}], "owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 50355002, "answer_count": 2, "score": 1, "last_activity_date": 1526417464, "creation_date": 1526398718, "question_id": 50354216, "link": "https://stackoverflow.com/questions/50354216/how-to-write-a-pundit-policy-with-3-or-statements", "title": "How to write a Pundit policy with 3 or statements?", "body": "<p>I have a <a href=\"https://github.com/varvet/pundit\" rel=\"nofollow noreferrer\">Pundit policy</a> that's working properly, but the way I've written it doesn't seem to be the \"best\" way to express this. It's a policy with three \"or\" statements. Here's the code:</p>\n\n<pre><code>def update?\n  user.admin? or user.moderator? || user.id == @artist.user_id\nend\n</code></pre>\n\n<p>What's another way I could write this? Or is this the best way to express this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526396071, "post_id": 50353250, "comment_id": 87722757, "body": "<i>&quot;I need an OR&quot;</i> \u2013 here it is: <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-or\" rel=\"nofollow noreferrer\"><code>or</code></a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1526396508, "post_id": 50353250, "comment_id": 87723066, "body": "possible dupe of <a href=\"https://stackoverflow.com/questions/3639656/activerecord-or-query\" title=\"activerecord or query\">stackoverflow.com/questions/3639656/activerecord-or-query</a>"}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1526398828, "post_id": 50353250, "comment_id": 87724663, "body": "@lacostenycoder the question is not for an or but for the better activerecord way, if ther would be multiple fields an or is no good"}], "answers": [{"comments": [{"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1526398953, "post_id": 50353669, "comment_id": 87724762, "body": "thx Steve,in my example that could be used, but in reality there are multiple fields and it isn&#39;t DRY , if no better suggestion I&#39;ll accept and will have to live with the SQL solution iaa"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1526411404, "post_id": 50353669, "comment_id": 87731668, "body": "I&#39;ve edited to suggest a way you could do it for multiple fields.   I&#39;m not in a position to test this chaining but it should work?"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 1, "creation_date": 1526411425, "post_id": 50353669, "comment_id": 87731680, "body": "Sometimes SQL is the best way to go, though. :)"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 4, "last_activity_date": 1526411494, "last_edit_date": 1526411494, "creation_date": 1526397008, "answer_id": 50353669, "question_id": 50353250, "link": "https://stackoverflow.com/questions/50353250/ruby-activerecord-find-same-value-in-multiple-fields/50353669#50353669", "title": "Ruby Activerecord: find same value in multiple fields", "body": "<p>There is an <code>or</code> method available...</p>\n\n<pre><code>MyModel.where(a_field: 'some_value').or(MyModel.where(another_field: 'some_value')).first.try(:id)\n</code></pre>\n\n<p>for multiple fields you could do </p>\n\n<pre><code>test_value = 'some_value'\n\nmy_models = MyModel.where(id: nil)\n\n%i(a_field another_field third_field fourth_field fifth_field).each do |field|\n  my_models = my_models.or(MyModel.where(field =&gt; test_value))\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2735, "user_id": 7006199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFqCJ.jpg?s=128&g=1", "display_name": "Nimish Gupta", "link": "https://stackoverflow.com/users/7006199/nimish-gupta"}, "is_accepted": false, "score": 2, "last_activity_date": 1526403302, "last_edit_date": 1526403302, "creation_date": 1526403201, "answer_id": 50355532, "question_id": 50353250, "link": "https://stackoverflow.com/questions/50353250/ruby-activerecord-find-same-value-in-multiple-fields/50355532#50355532", "title": "Ruby Activerecord: find same value in multiple fields", "body": "<p><a href=\"https://github.com/activerecord-hackery/ransack\" rel=\"nofollow noreferrer\">Ransack</a> is a gem which is used to build complex queries.</p>\n\n<p>It supports both <code>or</code> and <code>and</code> operators.</p>\n\n<p>For searching on multiple columns with same value you can build ransack query in following way.</p>\n\n<p><code>MyModel.ransack(field1_or_field2_or_field3_eq: 'some_value')</code></p>\n\n<p>Ransack provide various options to get your result like (equal_to condition, like_condition etc...).</p>\n\n<p>If you don't want to use any external gem then I think @steve's answers is apt.</p>\n"}, {"tags": [], "owner": {"reputation": 1086, "user_id": 5201594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHVDD.jpg?s=128&g=1", "display_name": "rahul mishra", "link": "https://stackoverflow.com/users/5201594/rahul-mishra"}, "is_accepted": false, "score": 2, "last_activity_date": 1526412682, "creation_date": 1526412682, "answer_id": 50357893, "question_id": 50353250, "link": "https://stackoverflow.com/questions/50353250/ruby-activerecord-find-same-value-in-multiple-fields/50357893#50357893", "title": "Ruby Activerecord: find same value in multiple fields", "body": "<p>Myltiple ways to do so:</p>\n\n<p><strong>Rails:</strong> </p>\n\n<pre><code>Post.where('id = 1').or(Post.where('id = 2'))\n</code></pre>\n\n<p>refs: <a href=\"https://github.com/rails/rails/commit/9e42cf019f2417473e7dcbfcb885709fa2709f89\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/commit/9e42cf019f2417473e7dcbfcb885709fa2709f89</a></p>\n\n<p><strong>Use rais_or Gem:</strong>  <a href=\"https://github.com/khiav223577/rails_or\" rel=\"nofollow noreferrer\">https://github.com/khiav223577/rails_or</a></p>\n\n<pre><code>EX: user = User.where(account: account).or(email: account).take\n</code></pre>\n\n<p><strong>Use ARel</strong> # Arel is best for complex queries</p>\n\n<pre><code>t = Post.arel_table\nresults = Post.where(\n  t[:author].eq(\"Someone\").\n  or(t[:title].matches(\"%something%\"))\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1541793104, "creation_date": 1541793104, "answer_id": 53232436, "question_id": 50353250, "link": "https://stackoverflow.com/questions/50353250/ruby-activerecord-find-same-value-in-multiple-fields/53232436#53232436", "title": "Ruby Activerecord: find same value in multiple fields", "body": "<p>I forgot about this question, here is how I do this now</p>\n\n<pre><code>def search_in_all_fields model, text\n  model.where(\n    model.column_names\n      .map {|field| \"#{field} like '%#{text}%'\" }\n      .join(\" or \")\n  )\nend\n</code></pre>\n\n<p>Or better as a scope in the model itself</p>\n\n<pre><code>class Model &lt; ActiveRecord::Base\n  scope :search_in_all_fields, -&gt;(text){\n    where(\n      column_names\n        .map {|field| \"#{field} like '%#{text}%'\" }\n        .join(\" or \")\n    )\n  }\nend\n</code></pre>\n\n<p>You would just need to call it like this</p>\n\n<pre><code>Model.search_in_all_fields \"test\"\n</code></pre>\n\n<p>Before you start.., to be sure there is no sql injection here still better and shorter</p>\n\n<pre><code>class Model &lt; ActiveRecord::Base\n  scope :search_all_fields, -&gt;(text){\n    where(\"#{column_names.join(' || ')} like ?\", \"%#{text}%\")\n  }\nend\n</code></pre>\n"}], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 723, "favorite_count": 0, "accepted_answer_id": 50353669, "answer_count": 4, "score": 1, "last_activity_date": 1541793104, "creation_date": 1526395799, "last_edit_date": 1526399094, "question_id": 50353250, "link": "https://stackoverflow.com/questions/50353250/ruby-activerecord-find-same-value-in-multiple-fields", "title": "Ruby Activerecord: find same value in multiple fields", "body": "<p>I use the following query in SQL to find the same value in multiple fields of my model but would like to do it in a more correct Activerecord way.</p>\n\n<pre><code>MyModel.where(\"'some_value' in (a_field, another_field)\").first.try(:id)\n</code></pre>\n\n<p>The following does not work since it's an AND and I need an OR</p>\n\n<pre><code>MyModel.where(a_field: 'some_value', another_field: 'some_value').first.try(:id)\n</code></pre>\n\n<p>Any suggestions ?\nOut of curiosity: if I use the first (which works) and use a <code>puts</code> or <code>p</code> to view the result I see the results two times ? I wonder why..</p>\n\n<p>EDIT in this example I use only two fields but in reality there could be more so an or wouldn't be doable and not dry</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "multithreading"], "comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 5, "creation_date": 1526394974, "post_id": 50352909, "comment_id": 87721862, "body": "I presume the <code>ModuleFoo.MethodFoo</code> call isn&#39;t essential to the rendering of the view? If not, you&#39;ll likely want this processed as a background job - have a look at <a href=\"https://github.com/collectiveidea/delayed_job\" rel=\"nofollow noreferrer\">Delayed Job</a> or <a href=\"https://github.com/resque/resque\" rel=\"nofollow noreferrer\">Resque</a> for examples of popular handlers."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 5, "creation_date": 1526395043, "post_id": 50352909, "comment_id": 87721924, "body": "Sidekiq is another popular option too."}, {"owner": {"reputation": 140, "user_id": 3425542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8JQSA.png?s=128&g=1", "display_name": "p0kero", "link": "https://stackoverflow.com/users/3425542/p0kero"}, "edited": false, "score": 0, "creation_date": 1526395048, "post_id": 50352909, "comment_id": 87721930, "body": "Yes, MethodFoo is not essential. Thank you for the links!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1526395924, "post_id": 50352909, "comment_id": 87722626, "body": "Rails also has <a href=\"http://guides.rubyonrails.org/active_job_basics.html\" rel=\"nofollow noreferrer\">Active Job</a> which comes with <a href=\"http://api.rubyonrails.org/v5.2.0/classes/ActiveJob/QueueAdapters.html\" rel=\"nofollow noreferrer\">adapters</a> for several backends."}], "owner": {"reputation": 140, "user_id": 3425542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8JQSA.png?s=128&g=1", "display_name": "p0kero", "link": "https://stackoverflow.com/users/3425542/p0kero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1526394831, "creation_date": 1526394831, "question_id": 50352909, "link": "https://stackoverflow.com/questions/50352909/how-to-create-a-thread-in-a-rails-controller", "title": "How to create a Thread in a Rails controller?", "body": "<p>I'm fixing an existing rails web application. This application call the Index method of the controllers when a url is called. This Index calls another method from a module which last about 10 seconds, so the view isn't showed to the user until this module method finish. I have tried to execute the module method in a new thread in this way:  </p>\n\n<pre><code>Thread.new do\n  ModuleFoo.MethodFoo\nend\n</code></pre>\n\n<p>but it continues waiting the 10 seconds and then showing (or rendering) the view to the user. It's this behavior normal? What should I use instead?</p>\n\n<p>Thank you in advance. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1526394613, "post_id": 50352113, "comment_id": 87721601, "body": "It&#39;s public now, but it used not to be."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1526393025, "last_edit_date": 1526393025, "creation_date": 1526392593, "answer_id": 50352113, "question_id": 50351882, "link": "https://stackoverflow.com/questions/50351882/ruby-include-chain-module-after-class-load/50352113#50352113", "title": "Ruby include chain module after class load", "body": "<p>Why are you including <code>A</code> into <code>B</code>, not into <code>Ab</code>? This would work:</p>\n\n<pre><code># B.send(:include, A)\nAb.include A\n</code></pre>\n\n<p>Your code does not work because <code>include B</code> is executed and basically all methods from <code>B</code> added into the base. One could implement <code>self.included</code> callback in <code>B</code>, collect all the classes/modules it\u2019s included into <em>and</em> update all of them when <code>include</code> is called on it\u2019s eigenclass, but it looks like a weird overkill. </p>\n\n<p><em>Sidenote:</em> <a href=\"https://ruby-doc.org/core/Module.html#method-i-include\" rel=\"nofollow noreferrer\"><code>Module#include</code></a> is public.</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1526394467, "post_id": 50352533, "comment_id": 87721502, "body": "No need to put <code>include A</code> in <code>included</code>. It should work as a &quot;normal&quot; include too."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1526394749, "last_edit_date": 1526394749, "creation_date": 1526393775, "answer_id": 50352533, "question_id": 50351882, "link": "https://stackoverflow.com/questions/50351882/ruby-include-chain-module-after-class-load/50352533#50352533", "title": "Ruby include chain module after class load", "body": "<p>You can just include module <code>A</code> in module <code>B</code>:</p>\n\n<pre><code>module A\n  def method_a\n    puts \"Method_a\"\n  end\nend\n\nmodule B\n  include A\n\n  def method_b\n    puts \"Method_b\"\n  end\nend\n\nclass Ab\n  include B\n\n  def calltest\n    method_a\n    method_b\n  end\nend\n\nAb.new.calltest\n# Method_a\n# Method_b\n#=&gt; nil\n</code></pre>\n"}], "owner": {"reputation": 6510, "user_id": 1514776, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/5uc8P.jpg?s=128&g=1", "display_name": "Selvamani", "link": "https://stackoverflow.com/users/1514776/selvamani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1526395191, "creation_date": 1526391903, "last_edit_date": 1526395191, "question_id": 50351882, "link": "https://stackoverflow.com/questions/50351882/ruby-include-chain-module-after-class-load", "title": "Ruby include chain module after class load", "body": "<p>I have a situation where I have to load my module after load class. Here below the sample code</p>\n\n<pre><code>require 'active_support/concern'\nmodule A\n  extend ActiveSupport::Concern\n  def method_a\n    puts \"Method_a\"\n  end\nend\n\nmodule B\n  extend ActiveSupport::Concern\n  def method_b\n    puts \"Method_b\"\n  end\nend\n\nclass Ab\n  include B\n  def calltest\n    method_a\n    method_b\n  end\nend\n\nB.send(:include, A)\n\nAb.new.method_a\nAb.new.method_b\n</code></pre>\n\n<p>I the above example when I call <code>method_a</code>, it throws an error. But if move that line above <code>Ab</code> class, it works fine. I don't want to include <code>A</code> module in class <code>Ab</code>. Could someone help me to call without changing the order of the code? </p>\n"}, {"tags": ["ruby", "http", "server-sent-events"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526395348, "post_id": 50351583, "comment_id": 87722160, "body": "The event stream protocol is simple, it shouldn&#39;t be that hard to write a parser yourself. See  <a href=\"https://html.spec.whatwg.org/multipage/server-sent-events.html#event-stream-interpretation\" rel=\"nofollow noreferrer\">Parsing an event stream</a>. I&#39;m voting to close this one as you are merely asking for a gem or tutorial."}, {"owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526409284, "post_id": 50351583, "comment_id": 87730562, "body": "@stefan Parsing it is only half the job. I have to start receiving the stream first. Besides, aren&#39;t tutorials part of the purpose of this site?"}, {"owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526493864, "post_id": 50351583, "comment_id": 87770950, "body": "@stefan no, seriously, how is this question off-topic?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526495389, "post_id": 50351583, "comment_id": 87771710, "body": "I voted to close it because of <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>: <i>&quot;4. Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam.&quot;</i>"}, {"owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526670302, "post_id": 50351583, "comment_id": 87851169, "body": "I was asking how to DO something. If that&#39;s off-topic, then you might as well close the damn site and have done with it."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526676757, "post_id": 50351583, "comment_id": 87853665, "body": "It&#39;s just a <i>vote</i>, nothing more, nothing less. Your question has not been closed, neither has it been down-voted. What&#39;s the problem?"}], "owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 467, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1539733729, "creation_date": 1526391103, "last_edit_date": 1526395419, "question_id": 50351583, "link": "https://stackoverflow.com/questions/50351583/how-to-consume-http-server-sent-events-in-ruby", "title": "How to consume HTTP Server Sent Events in Ruby?", "body": "<p>I need to connect to an HTTP server and subscribe to a <a href=\"https://www.w3schools.com/html/html5_serversentevents.asp\" rel=\"nofollow noreferrer\">Server Sent Event (SSE)</a> source using Ruby (not Rails).</p>\n\n<p>The only gems I've found that support this are <a href=\"https://github.com/af83/em-eventsource\" rel=\"nofollow noreferrer\">em-eventsource</a> (which is <a href=\"https://github.com/af83/em-eventsource/issues/12\" rel=\"nofollow noreferrer\">horribly broken</a>), and <a href=\"https://github.com/conjurinc/sse-client-ruby\" rel=\"nofollow noreferrer\">sse-client-ruby</a> which seems to be a bare fragment that requires unspecified extra plumbing in order to work.</p>\n\n<p>Is there another Ruby gem that I could use? Or, could someone provide a simple home-grown example of consuming SSE events in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-2"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1526390579, "creation_date": 1526390579, "answer_id": 50351379, "question_id": 50351324, "link": "https://stackoverflow.com/questions/50351324/nomethoderror-undefined-method-new-payment-model-for-nilnilclass-in-ror-ver/50351379#50351379", "title": "NoMethodError (undefined method `new_payment_model&#39; for nil:NilClass) in ROR Version 2", "body": "<p>The issue happens in validation proc in <code>a.franchisee.new_payment_model</code>.</p>\n\n<p>I would assume, <code>franchisee</code> might be <code>nil</code>. I believe this would fix the issue:</p>\n\n<pre><code>validates_numericality_of\n  :activation_price,\n  :greater_than =&gt; 0.0,\n  :unless =&gt; Proc.new { |a| a.franchisee.nil? || a.franchisee.new_payment_model}\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7235843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8af2dd610e2c78f2d4fcc1e071c92c?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7235843/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 50351379, "answer_count": 1, "score": 1, "last_activity_date": 1526390579, "creation_date": 1526390400, "question_id": 50351324, "link": "https://stackoverflow.com/questions/50351324/nomethoderror-undefined-method-new-payment-model-for-nilnilclass-in-ror-ver", "title": "NoMethodError (undefined method `new_payment_model&#39; for nil:NilClass) in ROR Version 2", "body": "<p>I have a face error in ROR version 2, NoMethodError (undefined method `new_payment_model' for nil:NilClass) here is my code </p>\n\n<pre><code>class Authorization &lt; ActiveRecord::Base\n  belongs_to :franchisee\n  belongs_to :deleted_by, :class_name =&gt; 'User', :foreign_key =&gt; :deleted_by\n  belongs_to :created_by, :class_name =&gt; 'User', :foreign_key =&gt; :created_by\n  has_many   :transactions\n  validates_presence_of :notify_email\n  validates_presence_of :activation_price, :expires_on\n  validates_length_of :notify_email, :maximum =&gt; 255\n  validates_format_of :notify_email, :with =&gt; EMAIL_REGEX\n  validates_numericality_of :activation_price, :greater_than =&gt; 0.0, :unless =&gt; Proc.new {|a| a.franchisee.new_payment_model}\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526387089, "post_id": 50349751, "comment_id": 87716000, "body": "What do you mean by &quot;group in randomly&quot;? Do you want to split the array at a random position? Or do you want to create two (maybe more?) groups containing random elements? Are there any constraints regarding the number of elements / groups or their order? Clarify your requirements, please."}, {"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526387268, "post_id": 50349751, "comment_id": 87716132, "body": "sorry for poor explanation, edited the question"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526387462, "post_id": 50349751, "comment_id": 87716277, "body": "Regarding your edit / clarification: what about that &quot;randomly&quot;? Do you just want to split the array in half?"}, {"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526387526, "post_id": 50349751, "comment_id": 87716328, "body": "@Stefan yes, half"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1526388166, "post_id": 50349751, "comment_id": 87716804, "body": "Out of curiosity @SumeetMasih, did you try googling e.g. &quot;ruby array split in half&quot; before posting? The top answer below is identical to the first result on google."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1526390632, "post_id": 50349751, "comment_id": 87718638, "body": "is <code>allay</code> a misspelling or deliberate?"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526386532, "post_id": 50349830, "comment_id": 87715620, "body": "I think the OP wants to split the array at a random index while keeping the element&#39;s order."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526386642, "post_id": 50349830, "comment_id": 87715693, "body": "@Stefan I guess we&#39;re interpreting &quot;I want to group in randomly&quot; differently?"}, {"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1526387110, "post_id": 50349830, "comment_id": 87716014, "body": "I don&#39;t want to shuffle the array and also need to maintain the order"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1526387342, "post_id": 50349830, "comment_id": 87716181, "body": "@SumeetMasih Thank you for the clarification. Updated. Good call, @Stefan!"}, {"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1526388924, "post_id": 50349830, "comment_id": 87717356, "body": "@mwp excellent solution but it takes comparatively more time than @igor Drozdov solution. Benchmark for this solution (first one) <code>0.000000   0.000000   0.000000 (  0.000011)</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1526388927, "post_id": 50349830, "comment_id": 87717362, "body": "<code>(allay.length &#47; 2.0).round</code> \u21d2 <code>(allay.length &#47; 2)</code>."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1526389015, "post_id": 50349830, "comment_id": 87717426, "body": "@mudasobwa That will yield arrays of lengths 2, 2, and 1; when the desired result is arrays of lengths 3 and 2."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1526389132, "post_id": 50349830, "comment_id": 87717514, "body": "@SumeetMasih I would need to see your benchmarking script, but that looks like a rounding error of difference. Also, Igor&#39;s original solution assumed you knew the lengths of the output arrays ahead of time, and his current solution assumes you&#39;re determine the lengths of the output arrays before calling the method, so it&#39;s doing less work."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526389259, "post_id": 50349830, "comment_id": 87717597, "body": "@mwp nevertheless <code>Enumerable#each_slice</code> has to enumerate the array via <code>each</code> (slow) whereas <code>Array#take</code> and <code>Array#drop</code> can extract the subarrays directly (fast)."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526389363, "post_id": 50349830, "comment_id": 87717676, "body": "@Stefan That&#39;s fair!"}, {"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1526389523, "post_id": 50349830, "comment_id": 87717801, "body": "@mwp I calculated the length of allay dynamically in both cases. In your solution it was done once while in Igor Drozdov&#39;s solution did it twice."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1526389598, "post_id": 50349830, "comment_id": 87717858, "body": "@SumeetMasih Ah, gotcha. Then Stefan&#39;s observations about the comparative performance of the two solutions are correct."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1526389860, "post_id": 50349830, "comment_id": 87718061, "body": "@mudasobwa just increment by one: <code>allay.length.succ &#47; 2</code>"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526389976, "post_id": 50349830, "comment_id": 87718168, "body": "@Stefan Nice! Adopted."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526390362, "post_id": 50349830, "comment_id": 87718437, "body": "You also have to take array size into account when benchmarking. For large arrays, <code>take</code> / <code>drop</code> is orders of magnitude faster."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526390442, "post_id": 50349830, "comment_id": 87718488, "body": "@Stefan Even with a small array it&#39;s 4.5X faster, so it&#39;s a clear performance winner."}], "tags": [], "owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "is_accepted": false, "score": 9, "last_activity_date": 1526390000, "last_edit_date": 1526390000, "creation_date": 1526386139, "answer_id": 50349830, "question_id": 50349751, "link": "https://stackoverflow.com/questions/50349751/how-to-split-ruby-array-of-hashes/50349830#50349830", "title": "How to Split Ruby Array of Hashes", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.2.0/Enumerable.html#method-i-each_slice\" rel=\"nofollow noreferrer\"><code>Enumerable#each_slice</code></a> to get the behavior you desire:</p>\n\n<pre><code>left, right = allay\n  .each_slice(allay.length.succ / 2)\n  .to_a\n</code></pre>\n\n<p>There are other ways to do it, of course, but they're not quite as nice. Here's another:</p>\n\n<pre><code>pivot = allay.length.succ / 2\nleft, right = allay\n  .partition\n  .with_index { |_, i| i &lt; pivot }\n</code></pre>\n\n<p>And another:</p>\n\n<pre><code>left, right = [], allay.dup\nleft &lt;&lt; right.shift until left.length &gt;= right.length\n</code></pre>\n\n<hr>\n\n<p>Benchmarks!</p>\n\n<pre><code>      each_slice    785.207k (\u00b1 5.6%) i/s -      3.920M in   5.006885s\n      with_index    694.555k (\u00b1 6.6%) i/s -      3.474M in   5.023968s\n      push_shift      1.674M (\u00b1 6.2%) i/s -      8.343M in   5.004380s\n       take_drop      3.468M (\u00b1 6.8%) i/s -     17.303M in   5.013369s\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526388016, "post_id": 50349859, "comment_id": 87716702, "body": "Not a good solution, IMO. Your current code assumes that the array contains exactly 6 items. It would be a little messy to generalise this for any even-sized array, and more so for an odd-sized array. However, generalising this approach to split &quot;An N-element array into M groups&quot; would be very messy indeed. <code>mvp</code>&#39;s answer, by contrast, would be trivial to generalise and understand."}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526388291, "post_id": 50349859, "comment_id": 87716893, "body": "I don&#39;t think you&#39;re right here. The solution splits an array of any length on the provided index. I just creates an array of two arrays, where the first one contains first <code>3</code> elements and the second one contains the rest elements. But I updated my answer for your better understanding, thanks."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526388498, "post_id": 50349859, "comment_id": 87717044, "body": "Well, now you&#39;ve edited the answer to something different: &quot;Splitting on the <code>n</code>th index&quot; is not the same as &quot;Splitting into <code>n</code> equally sized groups&quot;. Your new answer would now work for any array size, but you&#39;d need to perform an additional check to find the midway point. And again, what would happen if you want to split into 3/4/5/6/... groups? The calculation for these indexes becomes a non-trivial secondary task, and the method would need a non-trivial update to accommodate an arbitrary number of groupings."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526388590, "post_id": 50349859, "comment_id": 87717124, "body": "I&#39;m not saying &quot;it won&#39;t work&quot;, or &quot;it&#39;s very hard&quot;, I&#39;m saying just saying it&#39;s a more long-winded/complex approach than <code>each_slice((allay.length &#47; number_of_groups).round)</code> as suggested above."}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526388811, "post_id": 50349859, "comment_id": 87717274, "body": "I don&#39;t claim, that it will work for any case. I just suggested the solution for the OP&#39;s problem. OP just wants to split the array into <code>2</code> groups, not <code>n</code>. So I don&#39;t see, that my answer incorrect somehow"}, {"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1526389005, "post_id": 50349859, "comment_id": 87717419, "body": "@IgorDrozdov Benchmark for this solution with given array <code>0.000000   0.000000   0.000000 (  0.000008)</code>  which is less than the other solution provided."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526389078, "post_id": 50349859, "comment_id": 87717472, "body": "The method should take the array as an argument, too."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526389239, "post_id": 50349859, "comment_id": 87717582, "body": "@Stefan and the body should be <code>%i[take drop].map { |m| allay.public_send(m, n) }</code> to DRY avoiding repetition of <code>allay</code>."}, {"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526389341, "post_id": 50349859, "comment_id": 87717659, "body": "@Stefan no need to use it as a method, I can directly use it as a script"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 2, "creation_date": 1526389443, "post_id": 50349859, "comment_id": 87717741, "body": "@SumeetMasih I wouldn&#39;t focus on micro-benchmarks like this. They&#39;re almost certainly irrelevant in the grand scheme of things, unless performance is super critical. And I also wouldn&#39;t advise embedding &quot;complex&quot; code inline; separating it makes it reusable, easier to read and easy to test in isolation. Use this method if it better solves your problem (e.g. &quot;split array into 2 elements, and 4 elements&quot;), but not if it&#39;s a nanosecond faster at the expense of worse design."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1526389623, "post_id": 50349859, "comment_id": 87717872, "body": "@SumeetMasih I also question your means of benchmarking... You should be running the method <i>thousands</i> of times to get an accurate figure, not just once. Claiming that the runtime is <code>0.000008 seconds</code> tells me your benchmark is likely meaningless."}, {"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526389951, "post_id": 50349859, "comment_id": 87718142, "body": "@TomLord I ran the benchmark against the example array given in question.  Due to very small size of array we got a round number. Lastly, the performance is critical I have to do this with 2-3 thousand of rows. So from me It would make a difference."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1526390560, "post_id": 50349859, "comment_id": 87718586, "body": "@SumeetMasih Again, I&#39;ll repeat: You cannot get a reliable benchmark based on such a small method, which takes <code>0.000008 seconds</code> to run. You need to re-run the method <i>thousands of times</i> to get the true benchmark. For example, you may want to look at the <a href=\"https://github.com/evanphx/benchmark-ips\" rel=\"nofollow noreferrer\"><code>https:&#47;&#47;github.com&#47;evanphx&#47;benchmark-ips</code></a> library. If you are basing your benchmarks on your current approach, then they will likely be unreliable/meaningless."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 1, "creation_date": 1526390742, "post_id": 50349859, "comment_id": 87718723, "body": "@SumeetMasih Furthermore, much bigger performance gains can likely be made from wider architectural decisions, not nanosecond gains like this. What are you actually doing with this data? Perhaps you could use bulk API calls, or bulk SQL inserts, or use parallel processes, or use lazy evaluation of the file, or .... Many more things, all of which will have 1000x bigger impact than squeezing nanoseconds based on unreliable benchmarks! If you&#39;d like more concrete advice on this, I&#39;d suggest opening a new question with more context of the problem being solved."}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 3, "last_activity_date": 1526389266, "last_edit_date": 1526389266, "creation_date": 1526386224, "answer_id": 50349859, "question_id": 50349751, "link": "https://stackoverflow.com/questions/50349751/how-to-split-ruby-array-of-hashes/50349859#50349859", "title": "How to Split Ruby Array of Hashes", "body": "<p>It can be achieved by using <a href=\"https://ruby-doc.org/core-2.5.0/Array.html#method-i-drop\" rel=\"nofollow noreferrer\">drop</a> and <a href=\"https://ruby-doc.org/core-2.5.0/Array.html#method-i-take\" rel=\"nofollow noreferrer\">take</a>:</p>\n\n<pre><code>def split_by_index(array, n)\n  [array.take(n), array.drop(n)]\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1526392501, "post_id": 50352067, "comment_id": 87720113, "body": "I found the OP&#39;s question unclear, so used the mwp&#39;s answer as a guide to expected output."}], "tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 0, "last_activity_date": 1526392452, "creation_date": 1526392452, "answer_id": 50352067, "question_id": 50349751, "link": "https://stackoverflow.com/questions/50349751/how-to-split-ruby-array-of-hashes/50352067#50352067", "title": "How to Split Ruby Array of Hashes", "body": "<p>You can use <code>[]</code> notation with ranges.</p>\n\n<pre><code>arr = [*1..6]\ns = arr.size\n[arr[0..s/2-1], arr[s/2..-1]]\n #=&gt; [[1, 2, 3], [4, 5, 6]]\n\narr = [*1..7]\ns = arr.size\n[arr[0..s/2-1], arr[s/2..-1]]\n #=&gt; [[1, 2, 3], [4, 5, 6, 7]]\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 1, "accepted_answer_id": 50349859, "answer_count": 3, "score": 0, "last_activity_date": 1526392452, "creation_date": 1526385919, "last_edit_date": 1526387615, "question_id": 50349751, "link": "https://stackoverflow.com/questions/50349751/how-to-split-ruby-array-of-hashes", "title": "How to Split Ruby Array of Hashes", "body": "<p>I want to split an array of hashes.</p>\n\n<p><code>.split</code> is not working on it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zjGde.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zjGde.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to split it in two while maintaining the order so may be  <code>.partion</code>, <code>.select</code>, <code>group_by</code> will not work for me. </p>\n\n<p>Something from this </p>\n\n<pre><code>allay = [\n  {name: \"Iron Man\", power: \"Tech\"},\n  {name: \"Spiderman\", power: \"Iron Man as Uncle\"},\n  {name: \"Thor\", power: \"God\"},\n  {name: \"Hawk Eye\", power: \"None\"},\n  {name: \"Black Widow\", power: \"love her\"}\n]\n</code></pre>\n\n<p>to this as an output</p>\n\n<pre><code>=&gt; [\n  [\n    {name: \"Iron Man\", power: \"Tech\"},\n    {name: \"Spiderman\", power: \"Iron Man as an Uncle\"},\n    {name: \"Thor\", power: \"God\"}\n  ],\n  [\n    {name: \"Hawk Eye\", power: \"None\"},\n    {name: \"Black Widow\", power: \"love her &lt;3\"}\n  ]\n]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongoid"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1526384557, "post_id": 50349295, "comment_id": 87714329, "body": "<code>save</code> returns <code>true</code>?"}, {"owner": {"reputation": 657, "user_id": 321629, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c028050688670a758fdbf35691978a35?s=128&d=identicon&r=PG", "display_name": "CyberMew", "link": "https://stackoverflow.com/users/321629/cybermew"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1526384822, "post_id": 50349295, "comment_id": 87714491, "body": "Yes, save did execute (record created) and returned true, but I&#39;m not sure why that exception happened"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1526385308, "post_id": 50349295, "comment_id": 87714773, "body": "<i>&quot;so I can do some checking inside myself&quot;</i> \u2013 you would typically use validations or a <code>before_save</code> callback (depending on what you are trying to do)."}], "answers": [{"comments": [{"owner": {"reputation": 657, "user_id": 321629, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c028050688670a758fdbf35691978a35?s=128&d=identicon&r=PG", "display_name": "CyberMew", "link": "https://stackoverflow.com/users/321629/cybermew"}, "edited": false, "score": 0, "creation_date": 1526384948, "post_id": 50349353, "comment_id": 87714571, "body": "I have clarified the code a little. I wanted to intercept the original <code>save</code> call. The code is minimal so as to introduce the problem quickly"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1526385983, "post_id": 50349353, "comment_id": 87715220, "body": "<i>&quot;Why do you try to call save on whatever super (i.e. save) returns?&quot;</i> \u2013 I&#39;d say the OP just wanted to call (the overridden) <code>save</code> and was not aware that <code>super</code> <i>is</i> that method call."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1526386550, "post_id": 50349353, "comment_id": 87715634, "body": "Right, it seems probable."}, {"owner": {"reputation": 657, "user_id": 321629, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c028050688670a758fdbf35691978a35?s=128&d=identicon&r=PG", "display_name": "CyberMew", "link": "https://stackoverflow.com/users/321629/cybermew"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526396097, "post_id": 50349353, "comment_id": 87722779, "body": "Ah I get it now. Yes @Stefan was right. My idea of <code>super</code> was the instance of the class itself, not the method call, that&#39;s why I called <code>save</code> again. My understanding of the concept was wrong. Now I get what you mean. TIL!"}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 5, "last_activity_date": 1526384636, "creation_date": 1526384636, "answer_id": 50349353, "question_id": 50349295, "link": "https://stackoverflow.com/questions/50349295/overriding-save-method-in-model/50349353#50349353", "title": "Overriding save method in model", "body": "<p>Why do you try to call <code>save</code> on whatever <code>super</code> (i.e. <code>save</code>) returns? From your description, you want something like this:</p>\n\n<pre><code>def save\n  # some additional work\n  super\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526386083, "post_id": 50349557, "comment_id": 87715288, "body": "How do you teach Rails to use <code>save_with_guard</code> instead of <code>save</code> when using <code>create</code> / <code>update</code> etc?"}, {"owner": {"reputation": 1085, "user_id": 2878929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/U2qzc.jpg?s=128&g=1", "display_name": "Seph Cordovano", "link": "https://stackoverflow.com/users/2878929/seph-cordovano"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526386366, "post_id": 50349557, "comment_id": 87715499, "body": "@Stefan instead of calling .save you would call .save_with_guard on the object."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1526386695, "post_id": 50349557, "comment_id": 87715727, "body": "Sure, but there are other ways to save an object, e.g. via <code>update</code> or <code>save!</code> (with bang). Those methods would still call <code>save</code>, thus bypassing your checks."}], "tags": [], "owner": {"reputation": 5800, "user_id": 4287733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835e993afb1e20c1981dd6b8b59ded2d?s=128&d=identicon&r=PG", "display_name": "Nermin", "link": "https://stackoverflow.com/users/4287733/nermin"}, "is_accepted": false, "score": 1, "last_activity_date": 1526385323, "creation_date": 1526385323, "answer_id": 50349557, "question_id": 50349295, "link": "https://stackoverflow.com/questions/50349295/overriding-save-method-in-model/50349557#50349557", "title": "Overriding save method in model", "body": "<p>As stated by @Marek</p>\n\n<pre><code>module OverrideSave\n\n    def save\n        super if some_condition_true\n    end\nend\n</code></pre>\n\n<p>But it is not good behavior to override <code>save</code> method, it would be better to create a new method which would use save method, so you still have <code>save</code> method.</p>\n\n<pre><code>module OverrideSave\n  def save_with_guard\n     save if some_condition_true\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 657, "user_id": 321629, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c028050688670a758fdbf35691978a35?s=128&d=identicon&r=PG", "display_name": "CyberMew", "link": "https://stackoverflow.com/users/321629/cybermew"}, "edited": false, "score": 0, "creation_date": 1526395773, "post_id": 50352548, "comment_id": 87722515, "body": "Is it possible to stop the <code>save</code> operation if it failed the validation?"}, {"owner": {"reputation": 81, "user_id": 5543726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1191007070915645/picture?type=large", "display_name": "Mathieu Larouche", "link": "https://stackoverflow.com/users/5543726/mathieu-larouche"}, "reply_to_user": {"reputation": 657, "user_id": 321629, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c028050688670a758fdbf35691978a35?s=128&d=identicon&r=PG", "display_name": "CyberMew", "link": "https://stackoverflow.com/users/321629/cybermew"}, "edited": false, "score": 0, "creation_date": 1526396932, "post_id": 50352548, "comment_id": 87723356, "body": "Yes you just have to return false"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1526445372, "post_id": 50352548, "comment_id": 87741424, "body": "This is not a validation @MathieuLarouche. It is a callback which will abort the save if returned <code>false</code> from here. In validations, you need to set error on a field (or base object) to stop it from saving."}, {"owner": {"reputation": 81, "user_id": 5543726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1191007070915645/picture?type=large", "display_name": "Mathieu Larouche", "link": "https://stackoverflow.com/users/5543726/mathieu-larouche"}, "edited": false, "score": 0, "creation_date": 1526472597, "post_id": 50352548, "comment_id": 87756974, "body": "well, he talked about stopping the save, if he wants to add an error to a field he just has to add    errors.add(:field, &quot;error message&quot;)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526562892, "post_id": 50352548, "comment_id": 87800481, "body": "Starting with Rails 5 you have to use <code>throw :abort</code> by default instead of returning <code>false</code> in order to halt the callback chain."}], "tags": [], "owner": {"reputation": 81, "user_id": 5543726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1191007070915645/picture?type=large", "display_name": "Mathieu Larouche", "link": "https://stackoverflow.com/users/5543726/mathieu-larouche"}, "is_accepted": false, "score": 2, "last_activity_date": 1526445595, "last_edit_date": 1526445595, "creation_date": 1526393819, "answer_id": 50352548, "question_id": 50349295, "link": "https://stackoverflow.com/questions/50349295/overriding-save-method-in-model/50352548#50352548", "title": "Overriding save method in model", "body": "<p>You don't need to override the <code>save</code> method for above. You can use <code>before_save</code> <a href=\"http://guides.rubyonrails.org/active_record_callbacks.html\" rel=\"nofollow noreferrer\">callback</a> in your model:</p>\n\n<pre><code>class CardTransaction\n  before_save :do_some_validation\n\n  private\n\n  def do_some_validation\n    # will get there before the save is called\n    false if custom_validation\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 657, "user_id": 321629, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c028050688670a758fdbf35691978a35?s=128&d=identicon&r=PG", "display_name": "CyberMew", "link": "https://stackoverflow.com/users/321629/cybermew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 50349353, "answer_count": 3, "score": 0, "last_activity_date": 1526445595, "creation_date": 1526384453, "last_edit_date": 1526384773, "question_id": 50349295, "link": "https://stackoverflow.com/questions/50349295/overriding-save-method-in-model", "title": "Overriding save method in model", "body": "<p>I'm new to Ruby/Rails and I want to override the <code>save</code> method so I can do some checking inside myself before calling the actual <code>save</code> method, however, I am getting this exception for some reason: </p>\n\n<pre><code>#&lt;NoMethodError: undefined method `save' for true:TrueClass&gt;\n</code></pre>\n\n<p>This is my code for the module and class.</p>\n\n<p>Module:</p>\n\n<pre><code>module OverrideSave\n\n    def save\n        super.save if some_condition_true\n    end\n  end\n</code></pre>\n\n<p>Class:</p>\n\n<pre><code>class CardTransaction\n  include Mongoid::Document\n  include Mongoid::Timestamps::Created\n  prepend OverrideSave\n\n  field :type, type: String\n  field :transaction_value, type: BigDecimal\n  field :receipt_value, type: BigDecimal\n  field :store_id, type: String\n\n  belongs_to :card\nend\n</code></pre>\n\n<p>I'm not sure what went wrong, any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hanami"], "comments": [{"owner": {"reputation": 1586, "user_id": 1243967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af908b146b714030997e10a1f36f4410?s=128&d=identicon&r=PG", "display_name": "Aleksander Pohl", "link": "https://stackoverflow.com/users/1243967/aleksander-pohl"}, "edited": false, "score": 0, "creation_date": 1533159312, "post_id": 50348785, "comment_id": 90249601, "body": "Have you tried to mount the applications side by side in <code>config.ru</code>?"}], "owner": {"reputation": 295, "user_id": 3378662, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/845b4f83f7bd0d7118ccb4f6ab3acd77?s=128&d=identicon&r=PG&f=1", "display_name": "alv_721", "link": "https://stackoverflow.com/users/3378662/alv-721"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1589551197, "creation_date": 1526382871, "question_id": 50348785, "link": "https://stackoverflow.com/questions/50348785/how-do-i-include-hanami-into-the-existing-rails-app", "title": "How do I include Hanami into the existing Rails app?", "body": "<p>Is that possible to use Hanami as a engine in the Rails application? I didn't found any straight-forward way to do this in the docs so far.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "actionmailer", "amazon-ses"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526404728, "post_id": 50345835, "comment_id": 87728165, "body": "<code>model.track_emails.create</code> will keep appending records to the same array if <code>model</code> is re-used between calls. This could lead to significant memory usage since the garbage collector can&#39;t release anything retained in there, those records are considered &quot;in use&quot;. You can sometimes side-create the emails outside of that association to avoid this."}, {"owner": {"reputation": 43, "user_id": 9321828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3917626716567def2bfa95ad1ca379a2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Simon", "link": "https://stackoverflow.com/users/9321828/andy-simon"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526539249, "post_id": 50345835, "comment_id": 87785435, "body": "@tadman yes, the model is re-used. this model Message. As for emails, there can be a maximum of two email addresses. Could you please tell me, what kind of decision do you propose? Are you sure that the time of rendering and memory leak is related with this?"}, {"owner": {"reputation": 43, "user_id": 9321828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3917626716567def2bfa95ad1ca379a2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Simon", "link": "https://stackoverflow.com/users/9321828/andy-simon"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526544128, "post_id": 50345835, "comment_id": 87788129, "body": "@tadman and if I do create track_emails in a callback after_create, will there be a memory leak?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526573708, "post_id": 50345835, "comment_id": 87808038, "body": "Ruby doesn&#39;t have conventional memory leaks. It has &quot;unintentionally retained&quot; objects."}, {"owner": {"reputation": 43, "user_id": 9321828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3917626716567def2bfa95ad1ca379a2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Simon", "link": "https://stackoverflow.com/users/9321828/andy-simon"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526623843, "post_id": 50345835, "comment_id": 87824897, "body": "@tadman could you please tell me, what kind of solution would you suggest in this case?"}], "owner": {"reputation": 43, "user_id": 9321828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3917626716567def2bfa95ad1ca379a2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Simon", "link": "https://stackoverflow.com/users/9321828/andy-simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1526374354, "creation_date": 1526373689, "last_edit_date": 1526374354, "question_id": 50345835, "link": "https://stackoverflow.com/questions/50345835/memory-leak-when-bulk-mailing", "title": "Memory leak when bulk mailing", "body": "<p>I'm doing an email delivery in the background (more than 1k letters). The server is on Heroku. For background tasks, I use <code>sucker_punch</code>. Rails is 4.1.6, web-server is <code>passenger</code>. This is my code:</p>\n\n<pre><code>def email_blast message, child_message_id, resend\n    @download_url = message.doc_file_size ? message.doc.url : ''\n    @subscriber = message.subscriber\n    @message = message\n    send_message child_message_id, resend\nend\n\ndef send_message child_message_id, resend\n    messages = child_message_id ? Message.where(id: child_message_id) : Message.where(parent_message_id: @message.id)\n    messages = messages.joins(:pending_messages).uniq if resend &amp;&amp; child_message_id.nil?\n    subject = 'New Message'\n    type = @message.type.split('::').second || @message.type.split('::').first\n    messages.each do |message|\n      send_mail message.all_email_addresses, action_name, subject, message, type\n    end\nend\n\n\ndef send_mail emails, template, subject, model, type\n    response = mail(to: emails, subject: subject,\n                    template_name: template).deliver!\n    create_track_emails response.string.split(' ').third.strip, get_status(response), 'delivered', emails, model, type\n  rescue =&gt; e\n    create_track_emails '00000', 'failed', e.message, emails, model, type\nend\n\ndef get_status response\n    response.status == '250' ? 'success' : 'failed'\nend\n\ndef create_track_emails smtp_message_id, status, description, emails, model, type\n    id = type == 'Logon' ? model.id : model.to_id\n    emails.each do |email|\n      model.track_emails.create(email_address: email,\n                                status: status,\n                                status_description: description,\n                                smtp_message_id: smtp_message_id,\n                                subscriber_id: model.subscriber_id,\n                                user_id: id,\n                                message_type: type)\n    end\nend\n</code></pre>\n\n<p>I observe memory leak. I also see that the partial render time increases with each letter:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jLMrW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jLMrW.png\" alt=\"enter image description here\"></a></p>\n\n<p>Please tell me what can be the problem, and where to dig.</p>\n"}, {"tags": ["ruby", "ferret", "acts-as-ferret"], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1526375159, "creation_date": 1526372567, "last_edit_date": 1526375159, "question_id": 50345526, "link": "https://stackoverflow.com/questions/50345526/delete-hanging-ferret-index-entry-after-record-deleted", "title": "Delete hanging ferret index entry after record deleted", "body": "<p>I'm using ActsAsFerret which is a Rails wrapper for the Ruby-based <a href=\"https://github.com/yieldbot/ferret\" rel=\"nofollow noreferrer\">Ferret</a> search engine.  </p>\n\n<p>Sometimes it seems a record is deleted using SQL, rather than via ActiveRecord (ie record.destroy), and when this happens an index entry is left in the Ferret index.</p>\n\n<p>I can see it in this example, where School #136574 has left a hanging index entry:  In the search below I'm using the <code>lazy</code> option, which says \"Just get the data out of the Ferret index and don't bother hitting the database\":</p>\n\n<pre><code>&gt;&gt; @schools = School.search(params)\n=&gt; [#&lt;FerretResult wrapper for School with id 136574, #&lt;FerretResult wrapper for School with id 55814]\n&gt;&gt; @schools.collect(&amp;:id)\nActiveRecord::RecordNotFound: Couldn't find School with ID=136574\n</code></pre>\n\n<p>This causes a serious problem because if you try and do anything with the results it does School.find(id) and you get an exception like above.</p>\n\n<p>I did <code>School.rebuild_index</code>, thinking that would fix it, but it hasn't.</p>\n\n<p>I <strong>can</strong> work around it - it seems that calling <code>.collect</code> on the results has been overridden to convert them into their corresponding object (causing the exception), and I can do something like this:</p>\n\n<pre><code>@schools = @schools.select{|result| School.find_by_id(result.id)};@schools.size\n</code></pre>\n\n<p>This does work, but it's slow, and a bit of a pain in the ass.  </p>\n\n<p>Does anyone know a way to delete the hanging index records?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "edited": false, "score": 1, "creation_date": 1526371683, "post_id": 50345185, "comment_id": 87706203, "body": "Try: <code>p.port_stocks.map{|ps| ps.volume * ps.purchase_price}.sum</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526371698, "post_id": 50345185, "comment_id": 87706210, "body": "Do you want to do the calculation in Ruby or in your database?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526371761, "post_id": 50345185, "comment_id": 87706247, "body": "Unrelated to your question but you shouldn&#39;t use floats for monetary values."}, {"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526371862, "post_id": 50345185, "comment_id": 87706306, "body": "@Stefan I want to do the calculation in Ruby. Also, why should I use floats for monetary values? I feel like I have heard that somewhere before, but can you give me a link or something I can read up more about that and explore the alternatives please? Thanks!"}, {"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "reply_to_user": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "edited": false, "score": 0, "creation_date": 1526371923, "post_id": 50345185, "comment_id": 87706338, "body": "@guitarman Perfect. That works like a charm. Please add it as an answer and I will accept it. Thanks!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1526373425, "post_id": 50345185, "comment_id": 87707208, "body": "@marcamillion <i>&quot;why should I use floats&quot;</i> \u2013 you should <b>not</b> use floats for monetary values. Because floats are inaccurate and can easily introduce rounding errors, e.g. <code>0.1 * 0.2</code> returns <code>0.020000000000000004</code>. See <a href=\"https://stackoverflow.com/q/3730019/477037\">stackoverflow.com/q/3730019/477037</a> for a detailed explanation. Take a look a the <a href=\"https://github.com/RubyMoney/money\" rel=\"nofollow noreferrer\">money</a> gem and its <a href=\"https://github.com/RubyMoney/money-rails\" rel=\"nofollow noreferrer\">money-rails</a> integration."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526374043, "post_id": 50345185, "comment_id": 87707573, "body": "@Stefan - didn&#39;t know that, thanks for raising it and the explanation. Reading the linked post now."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526373857, "post_id": 50345448, "comment_id": 87707478, "body": "The assignment in the latter example is superfluous, i.e. just use <code>+</code> instead of <code>+=</code>."}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 6, "last_activity_date": 1526477249, "last_edit_date": 1526477249, "creation_date": 1526372284, "answer_id": 50345448, "question_id": 50345185, "link": "https://stackoverflow.com/questions/50345185/how-do-i-sum-the-product-of-two-values-across-multiple-objects-in-rails/50345448#50345448", "title": "How do I sum the product of two values, across multiple objects in Rails?", "body": "<p>The best way of doing this using Rails is to pass a block to <code>sum</code>, such as the following:</p>\n\n<pre><code>p.port_stocks.sum do |port_stock|\n  port_stock.volume * port_stock.purchase_price\nend\n</code></pre>\n\n<p>That uses the method dedicated to totalling figures, and tends to be very fast and efficient - particularly when compared to manipulating the data ahead of calling a straight <code>sum</code> without a block.</p>\n\n<p>A quick benchmark <a href=\"https://repl.it/@SDRACK/QuickBenchmark\" rel=\"nofollow noreferrer\">here</a> typically shows it performing ~20% faster than the obvious alternatives.</p>\n\n<p>I've not been able to test, but give that a try and it should resolve this for you.</p>\n\n<p>Let me know how you get on!</p>\n\n<hr>\n\n<p>Just a quick update as you also mention the best Ruby way, <code>sum</code> was <a href=\"https://blog.bigbinary.com/2016/11/02/ruby-2-4-introduces-enumerable-sum.html\" rel=\"nofollow noreferrer\">introduced in 2.4</a>, though on older versions of Ruby you can use <a href=\"https://ruby-doc.org/core-2.1.0/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\">reduce</a> (also aliased to <code>inject</code>):</p>\n\n<pre><code>p.port_stocks.reduce(0) do |sum, port_stock|\n  sum + (port_stock.volume * port_stock.purchase_price)\nend\n</code></pre>\n\n<p>This isn't as efficient as <code>sum</code>, but thought I'd give you the options :)</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526383759, "post_id": 50347990, "comment_id": 87713793, "body": "<code>collection.map { ... }.sum</code> =&gt; <code>collection.sum { ... }</code>"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1526384078, "post_id": 50347990, "comment_id": 87714000, "body": "Performs worse than using <code>sum</code> with a block, and is less readable IMHO."}, {"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1526425775, "post_id": 50347990, "comment_id": 87737254, "body": "@SRack there proof to suggest that it performs worse?"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1526476887, "post_id": 50347990, "comment_id": 87760016, "body": "I&#39;ve benchmarked it in the past @maramillion (<a href=\"https://repl.it/@SDRACK/QuickBenchmark\" rel=\"nofollow noreferrer\">code here</a> if you&#39;re interested), after answering a question similar to this with Guitarman&#39;s solution and seeing someone else post to use <code>sum</code> :) Was interested to see how <code>map</code>, <code>reduce</code> and <code>sum</code> compared, so I ran the numbers. <code>sum</code> generally comes out on top (usually by ~20%), and I&#39;d maintain it&#39;s the most readable."}], "tags": [], "owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "is_accepted": false, "score": 2, "last_activity_date": 1526380252, "creation_date": 1526380252, "answer_id": 50347990, "question_id": 50345185, "link": "https://stackoverflow.com/questions/50345185/how-do-i-sum-the-product-of-two-values-across-multiple-objects-in-rails/50347990#50347990", "title": "How do I sum the product of two values, across multiple objects in Rails?", "body": "<p>You are right to use <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-map\" rel=\"nofollow noreferrer\">Array#map</a> to iterate through all stocks, but instead to sum all total_spend values, you could calculate it for each stock. After, you sum all results and your done:</p>\n\n<pre><code>p.port_stocks.map{|ps| ps.volume * ps.purchase_price}.sum\n</code></pre>\n\n<p>Or you could use <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\">Enumerable#reduce</a> like SRack did. This would return the result with one step/iteration.</p>\n"}], "owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 50345448, "answer_count": 2, "score": 0, "last_activity_date": 1526477249, "creation_date": 1526371343, "last_edit_date": 1526378317, "question_id": 50345185, "link": "https://stackoverflow.com/questions/50345185/how-do-i-sum-the-product-of-two-values-across-multiple-objects-in-rails", "title": "How do I sum the product of two values, across multiple objects in Rails?", "body": "<p>Imagine I have a portfolio <code>p</code> that has 2 stocks <code>port_stocks</code>. What I want to do is run a calculation on each <code>port_stock</code>, and then sum up all the results.</p>\n\n<pre><code>[60] pry(main)&gt; p.port_stocks\n=&gt; [#&lt;PortStock:0x00007fd520e064e0\n  id: 17,\n  portfolio_id: 1,\n  stock_id: 385,\n  volume: 2000,\n  purchase_price: 5.9,\n  total_spend: 11800.0&gt;,\n #&lt;PortStock:0x00007fd52045be68\n  id: 18,\n  portfolio_id: 1,\n  stock_id: 348,\n  volume: 1000,\n  purchase_price: 9.0,\n  total_spend: 9000.0&gt;]\n[61] pry(main)&gt; \n</code></pre>\n\n<p>So, in essence, using the code above I would like to do this:</p>\n\n<pre><code>ps = p.port_stocks.first #(`id=17`)\nfirst = ps.volume * ps.purchase_price # 2000 * 5.9 = 11,800\n\nps = p.port_stocks.second #(`id=18`)\nsecond = ps.volume * ps.purchase_price # 1000 * 9.0 = 9,000\n\nfirst + second = 19,800\n</code></pre>\n\n<p>I want to simply get <code>19,800</code>. Ideally I would like to do this in a very Ruby way.</p>\n\n<p>If I were simply summing up all the values in 1 <code>total_spend</code>, I know I could simply do: <code>p.port_stocks.map(&amp;:total_spend).sum</code> and that would be that.</p>\n\n<p>But not sure how to do something similar when I am first doing a math operation on each object, then adding up all the products from all the objects. This should obviously work for 2 objects or 500.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 449, "user_id": 6324558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/695946b2499d7dcb2759724e66cfad38?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Delahaye", "link": "https://stackoverflow.com/users/6324558/alexis-delahaye"}, "edited": false, "score": 0, "creation_date": 1526372248, "post_id": 50345163, "comment_id": 87706523, "body": "i think you should be looking for regular expression, the problem remaining is that your commands have many different syntaxes (command and args separated by space, but not for &quot;C:\\\\Program Files&quot; for example, then separated by &#39;-&#39; . Does it have to work with all syntaxes for your project ?"}, {"owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "edited": false, "score": 0, "creation_date": 1526374292, "post_id": 50345163, "comment_id": 87707734, "body": "Can your command ever contain whitespace? If not, could you split on whitespace, treat the first token as the command and then format the arguments or options as appropriate?"}, {"owner": {"reputation": 261, "user_id": 442708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4224b4422400ac46d17248a04646f215?s=128&d=identicon&r=PG", "display_name": "vasu", "link": "https://stackoverflow.com/users/442708/vasu"}, "reply_to_user": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "edited": false, "score": 0, "creation_date": 1526374646, "post_id": 50345163, "comment_id": 87707904, "body": "@rwold spliting on whitespace will not work where command is like <code>&quot;C:\\\\Program Files\\\\example\\\\program.exe&quot;</code>"}, {"owner": {"reputation": 261, "user_id": 442708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4224b4422400ac46d17248a04646f215?s=128&d=identicon&r=PG", "display_name": "vasu", "link": "https://stackoverflow.com/users/442708/vasu"}, "reply_to_user": {"reputation": 449, "user_id": 6324558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/695946b2499d7dcb2759724e66cfad38?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Delahaye", "link": "https://stackoverflow.com/users/6324558/alexis-delahaye"}, "edited": false, "score": 0, "creation_date": 1526374766, "post_id": 50345163, "comment_id": 87707970, "body": "@AlexisDelahaye yes it should work with all examples"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526376986, "post_id": 50345163, "comment_id": 87709476, "body": "@vasu (1) Your example is not valid ruby syntax; I presume you meant <code>&#47;(?=\\s-)&#47;</code>. (2) Why won&#39;t that example work by just splitting on space? Even in the comment above, I don&#39;t see how that will fail? (3) There&#39;s probably no need to &quot;reinvent the wheel&quot; here with some regex. There is a standard convention in almost all languages: The command line arguments are known as <code>ARGV</code>, which you can access in ruby as a constant. Ruby also provides <a href=\"https://ruby-doc.org/core/ARGF.html\" rel=\"nofollow noreferrer\"><code>ARGF</code></a>, which works as a data stream."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526377283, "post_id": 50345163, "comment_id": 87709678, "body": "@vasu If you need more complex/custom handling of command line arguments, the ruby standard library also provides <a href=\"https://docs.ruby-lang.org/en/2.5.0/OptionParser.html\" rel=\"nofollow noreferrer\"><code>OptionParser</code></a>, or for even more advanced usage there are several popular third party libraries such as <a href=\"https://github.com/erikhuda/thor\" rel=\"nofollow noreferrer\"><code>thor</code></a>. However you go about solving this (although I&#39;m unsure what &quot;this&quot; actually is, given your vague problem description: <i>&quot;it won&#39;t work&quot;</i>), I doubt you need to reinvent any wheels."}, {"owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "edited": false, "score": 0, "creation_date": 1526377379, "post_id": 50345163, "comment_id": 87709760, "body": "@vasu D&#39;oh! My eyes glossed over that expecting Unix style escaping that would be easily fixed. See my answer."}, {"owner": {"reputation": 261, "user_id": 442708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4224b4422400ac46d17248a04646f215?s=128&d=identicon&r=PG", "display_name": "vasu", "link": "https://stackoverflow.com/users/442708/vasu"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526378553, "post_id": 50345163, "comment_id": 87710574, "body": "@TomLord I have edited my question for ruby syntax and more details why can&#39;t it be get in ARGV. Answer to your question why it won&#39;t work for splitting on space is if command contains file path with File name like Program File it will split on space and will separate out the file name."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526378816, "post_id": 50345163, "comment_id": 87710749, "body": "@vasu You still don&#39;t need to look beyond the ruby standard library, and certainly not use any weird regex like the other answers are suggesting. I&#39;ll post something below...."}], "answers": [{"tags": [], "owner": {"reputation": 649, "user_id": 1630556, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/fVmI3.jpg?s=128&g=1", "display_name": "Maciej Szlosarczyk", "link": "https://stackoverflow.com/users/1630556/maciej-szlosarczyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1526383652, "last_edit_date": 1526383652, "creation_date": 1526377349, "answer_id": 50346982, "question_id": 50345163, "link": "https://stackoverflow.com/questions/50345163/how-to-separate-out-command-with-its-arguments-coming-in-format-of-string-using/50346982#50346982", "title": "How to separate out command with its arguments coming in format of string using ruby", "body": "<p><strong>Tom Lord's answer is far better than this one.</strong></p>\n\n<hr>\n\n<p>You probably want to look at <a href=\"https://ruby-doc.org/stdlib-2.4.1/libdoc/optparse/rdoc/OptionParser.html\" rel=\"nofollow noreferrer\">OptionParser</a> or <a href=\"https://ruby-doc.org/stdlib-2.1.3/libdoc/getoptlong/rdoc/GetoptLong.html\" rel=\"nofollow noreferrer\">GetOptLong</a> if you need parsing of command line arguments provided to a ruby program.</p>\n\n<hr>\n\n<p>If you are interested in parsing some strings that may or may not be commands with arguments, here's a quick-and-dirty:</p>\n\n<p>I'd use <code>scan</code> instead of <code>split</code> with the following regex: <code>/(\".*\"|[\\w\\:\\:\\.\\-\\\\]+)/</code>. </p>\n\n<p>Best results come from: <code>'some string'.scan(/(\".*\"|[\\w\\:\\:\\.\\-\\\\]+)/).flatten</code>:</p>\n\n<pre><code>[\"ping\", \"http:\\\\www.google.com\"]\n[\"abc-abc\", \"-V\"]\n[\"abc-abc\", \"-L\", \"c:\\\\folder\\\\\", \"name\\\\test.log\"]\n# Technically, this is wrong, but so is the non-escaped whitespace.\n[\"\\\"C:\\\\Program Files\\\\example\\\\program.exe\\\"\", \"-arg1\", \"-arg2\"]\n[\"\\\"C:\\\\Program Files\\\\example\\\\program.exe\\\"\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "is_accepted": false, "score": 0, "last_activity_date": 1526377950, "creation_date": 1526377950, "answer_id": 50347196, "question_id": 50345163, "link": "https://stackoverflow.com/questions/50345163/how-to-separate-out-command-with-its-arguments-coming-in-format-of-string-using/50347196#50347196", "title": "How to separate out command with its arguments coming in format of string using ruby", "body": "<p>It seems to me that if there's no consistent pattern to your command syntax, then any regex based approach will inevitably fail. It seems better instead to solve this problem the way a human would, i.e. with some knowledge of <em>context</em>.</p>\n\n<p>In a *nix terminal, you can use the <code>compgen</code> command to list available commands. This Ruby script invokes that command to print the first 5 options from that list:</p>\n\n<pre><code>list = `cd ~ &amp;&amp; compgen -c`\nlist_arr = list.split(\"\\n\")\nlist_arr[0,6].each{|x| puts x }\n</code></pre>\n\n<p>(The <code>cd</code> in the first line seems to be needed because of the context in which my Ruby is running with rvm.) For Windows, you may find <a href=\"https://stackoverflow.com/questions/22158304/command-to-list-all-available-commands-in-windows-command-prompt\">this thread</a> a useful starting point.</p>\n\n<p>I'd match against the elements of this list to identify my commands, and take it from there.</p>\n"}, {"comments": [{"owner": {"reputation": 261, "user_id": 442708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4224b4422400ac46d17248a04646f215?s=128&d=identicon&r=PG", "display_name": "vasu", "link": "https://stackoverflow.com/users/442708/vasu"}, "edited": false, "score": 0, "creation_date": 1526380421, "post_id": 50347629, "comment_id": 87711708, "body": "I checked Shellwords and only worried where it takes on <code>\\\\</code> from file path here                                                           <code>Shellwords.split(&quot;abc-abc -L c:\\\\folder name\\\\test.log&quot;)   #=&gt; [&quot;abc-abc&quot;, &quot;-L&quot;, &quot;c:folder&quot;, &quot;nametest.log&quot;]</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 261, "user_id": 442708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4224b4422400ac46d17248a04646f215?s=128&d=identicon&r=PG", "display_name": "vasu", "link": "https://stackoverflow.com/users/442708/vasu"}, "edited": false, "score": 0, "creation_date": 1526380598, "post_id": 50347629, "comment_id": 87711800, "body": "@vasu That&#39;s not a valid example. In order to pass a pathname with spaces like this, you would need to wrap it in quotes - i.e. <code>Shellwords.split(&quot;abc-abc -L &#39;c:\\\\folder name\\\\test.log&#39;&quot;) #=&gt; [&quot;abc-abc&quot;, &quot;-L&quot;, &quot;c:\\\\folder name\\\\test.log&quot;]</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 261, "user_id": 442708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4224b4422400ac46d17248a04646f215?s=128&d=identicon&r=PG", "display_name": "vasu", "link": "https://stackoverflow.com/users/442708/vasu"}, "edited": false, "score": 0, "creation_date": 1526380755, "post_id": 50347629, "comment_id": 87711884, "body": "Are any of the examples I provided above different from the result you require? In which case, what result <i>do</i> you require? Are there other example inputs for which this won&#39;t work? What inputs? What result do you require?"}, {"owner": {"reputation": 261, "user_id": 442708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4224b4422400ac46d17248a04646f215?s=128&d=identicon&r=PG", "display_name": "vasu", "link": "https://stackoverflow.com/users/442708/vasu"}, "edited": false, "score": 0, "creation_date": 1526380927, "post_id": 50347629, "comment_id": 87711977, "body": "This case also removes <code>\\\\</code> here <code>Shellwords.split(&quot;ping http:\\\\www.google.com here url is argument&quot;)   #=&gt; [&quot;ping&quot;, &quot;http:www.google.com&quot;, &quot;here&quot;, &quot;url&quot;, &quot;is&quot;, &quot;argument&quot;]</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 261, "user_id": 442708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4224b4422400ac46d17248a04646f215?s=128&d=identicon&r=PG", "display_name": "vasu", "link": "https://stackoverflow.com/users/442708/vasu"}, "edited": false, "score": 0, "creation_date": 1526381479, "post_id": 50347629, "comment_id": 87712306, "body": "@vasu Which website are you visiting with backslashes in the URL? :S Again, the&#39;s not a valid example - you would actually need to do <code>Shellwords.split(&quot;ping &#39;http:\\\\\\\\www.google.com&#39; here url is argument&quot;)</code> (note the additional quotes, and double-backslash). But again, this feels very contrived since URIs don&#39;t contain backslashes!"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 261, "user_id": 442708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4224b4422400ac46d17248a04646f215?s=128&d=identicon&r=PG", "display_name": "vasu", "link": "https://stackoverflow.com/users/442708/vasu"}, "edited": false, "score": 0, "creation_date": 1526381563, "post_id": 50347629, "comment_id": 87712341, "body": "If anything, this use of <code>Shellwords.split</code> rather than a custom regex only helps illustrate my point: Your code should be parsing the string via standard libraries, to avoid buggy behaviour from false assumptions about dodgy input!"}, {"owner": {"reputation": 261, "user_id": 442708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4224b4422400ac46d17248a04646f215?s=128&d=identicon&r=PG", "display_name": "vasu", "link": "https://stackoverflow.com/users/442708/vasu"}, "edited": false, "score": 0, "creation_date": 1526381660, "post_id": 50347629, "comment_id": 87712395, "body": "My bad here about URI"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 3, "last_activity_date": 1526381590, "last_edit_date": 1526381590, "creation_date": 1526379196, "answer_id": 50347629, "question_id": 50345163, "link": "https://stackoverflow.com/questions/50345163/how-to-separate-out-command-with-its-arguments-coming-in-format-of-string-using/50347629#50347629", "title": "How to separate out command with its arguments coming in format of string using ruby", "body": "<p>Use <a href=\"http://ruby-doc.org/stdlib/libdoc/shellwords/rdoc/Shellwords.html\" rel=\"nofollow noreferrer\"><code>Shellwords.split</code></a>, from the standard library:</p>\n\n<pre><code>Shellwords.split(\"ping http:\\\\www.google.com here url is argument\")\n  #=&gt; [\"ping\", \"http:www.google.com\", \"here\", \"url\", \"is\", \"argument\"]\nShellwords.split(\"abc-abc -V\")\n  #=&gt; [\"abc-abc\", \"-V\"]\nShellwords.split(\"abc-abc -L c:\\\\folder name\\\\test.log\")\n  #=&gt; [\"abc-abc\", \"-L\", \"c:folder\", \"nametest.log\"]\nShellwords.split('\"C:\\\\Program Files\\\\example\\\\program.exe\" -arg1 -arg2')\n  #=&gt; [\"C:\\\\Program Files\\\\example\\\\program.exe\", \"-arg1\", \"-arg2\"]\nShellwords.split('\"C:\\\\Program Files\\\\example\\\\program.exe\"')\n  #=&gt; [\"C:\\\\Program Files\\\\example\\\\program.exe\"]\n</code></pre>\n\n<p>No need to reinvent the wheel with a custom regex/splitter, or an external system call.</p>\n"}], "owner": {"reputation": 261, "user_id": 442708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4224b4422400ac46d17248a04646f215?s=128&d=identicon&r=PG", "display_name": "vasu", "link": "https://stackoverflow.com/users/442708/vasu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1526387799, "creation_date": 1526371271, "last_edit_date": 1526387799, "question_id": 50345163, "link": "https://stackoverflow.com/questions/50345163/how-to-separate-out-command-with-its-arguments-coming-in-format-of-string-using", "title": "How to separate out command with its arguments coming in format of string using ruby", "body": "<p>I have to pass a command with its arguments in a scheduled task, while separating the arguments from the command. I used:</p>\n\n<pre><code>split(/(?=\\s-)/)\n</code></pre>\n\n<p>to do this, but it won't work when the argument is not passed as <code>-arg</code> format.</p>\n\n<p>Example of commands can be passed in format:</p>\n\n<pre><code>\"ping http://www.google.com\" here url is argument\n\"abc-abc -V\"\n\"abc-abc -L c:\\\\folder name\\\\test.log\"\n'\"C:\\\\Program Files\\\\example\\\\program.exe\" -arg1 -arg2'\n\"C:\\\\Program Files\\\\example\\\\program.exe\"\n</code></pre>\n\n<p>To make this more clear these commands are not passed as command line argument which can get in ARGV</p>\n\n<p>The command gets set in command property which accepts input in string format</p>\n\n<p><code>command '\"C:\\\\Program Files\\\\example\\\\program.exe\" -arg1 -arg2'</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "conditional"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526370288, "post_id": 50344728, "comment_id": 87705417, "body": "Is this a Rails question? Are you trying to build a query dynamically?"}, {"owner": {"reputation": 115, "user_id": 5630260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf5dd9a49c3c5e97cf9ef931d9a20e1?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/5630260/harry"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526371607, "post_id": 50344728, "comment_id": 87706169, "body": "You are right, Stefan, it is a dynamic query. I will add the tag, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1526371193, "post_id": 50344805, "comment_id": 87705957, "body": "<code>unless date_conditions.empty?</code> is redundant."}, {"owner": {"reputation": 115, "user_id": 5630260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf5dd9a49c3c5e97cf9ef931d9a20e1?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/5630260/harry"}, "edited": false, "score": 0, "creation_date": 1526371364, "post_id": 50344805, "comment_id": 87706043, "body": "I would just get rid of the unless, but it looks nice."}, {"owner": {"reputation": 5800, "user_id": 4287733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835e993afb1e20c1981dd6b8b59ded2d?s=128&d=identicon&r=PG", "display_name": "Nermin", "link": "https://stackoverflow.com/users/4287733/nermin"}, "edited": false, "score": 2, "creation_date": 1526372092, "post_id": 50344805, "comment_id": 87706425, "body": "In the question last part was not <code>else</code> it was <code>elsif</code> so when no <code>date_1</code> and no <code>date_2</code> is provided method will return <code>nil</code> same as in the question. So I would not say that unless is redundant"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1526372290, "post_id": 50344805, "comment_id": 87706542, "body": "@mudasobwa: depends on how <code>conditions</code> is implemented. (This isn&#39;t a built-in AR method, is it?) To replicate the original code <i>exactly</i>, this <code>unless</code> is needed (or something like it)"}], "tags": [], "owner": {"reputation": 5800, "user_id": 4287733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835e993afb1e20c1981dd6b8b59ded2d?s=128&d=identicon&r=PG", "display_name": "Nermin", "link": "https://stackoverflow.com/users/4287733/nermin"}, "is_accepted": false, "score": 4, "last_activity_date": 1526370021, "creation_date": 1526370021, "answer_id": 50344805, "question_id": 50344728, "link": "https://stackoverflow.com/questions/50344728/better-solution-for-one-other-or-both-cases/50344805#50344805", "title": "Better solution for &quot;one, other or both&quot; cases", "body": "<pre><code>def between_dates(date_1, date_2)\n  date_conditions = []\n  date_conditions &lt;&lt; 'created_at &gt;= date_1' if date_1\n  date_conditions &lt;&lt; 'created_at &lt;= date_2' if date_2\n  conditions date_conditions.join(' AND ') unless date_conditions.empty?\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 5630260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf5dd9a49c3c5e97cf9ef931d9a20e1?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/5630260/harry"}, "edited": false, "score": 0, "creation_date": 1526371452, "post_id": 50344811, "comment_id": 87706094, "body": "Correct if I&#39;m wrong, but this solution is basically a &quot;multi-line&quot; version of the one proposed by Nermin. I personally prefer that way, but yours is more readable and I would rather put this version in prod."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 115, "user_id": 5630260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf5dd9a49c3c5e97cf9ef931d9a20e1?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/5630260/harry"}, "edited": false, "score": 0, "creation_date": 1526371529, "post_id": 50344811, "comment_id": 87706140, "body": "@Harry: correct, our codes do the same thing. Only Nermin&#39;s code also handles the case where <i>none</i> of the dates are present (the <code>unless</code>)"}, {"owner": {"reputation": 115, "user_id": 5630260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf5dd9a49c3c5e97cf9ef931d9a20e1?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/5630260/harry"}, "edited": false, "score": 1, "creation_date": 1526371798, "post_id": 50344811, "comment_id": 87706265, "body": "<code>[].join (&#39; AND &#39;)</code> returns <code>&quot;&quot;</code>, which is acceptable. As I said, I like shorter codes, but this looks better to maintain."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 115, "user_id": 5630260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf5dd9a49c3c5e97cf9ef931d9a20e1?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/5630260/harry"}, "edited": false, "score": 0, "creation_date": 1526371831, "post_id": 50344811, "comment_id": 87706288, "body": "@Harry: I agree with you there :)"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 5, "last_activity_date": 1526370033, "creation_date": 1526370033, "answer_id": 50344811, "question_id": 50344728, "link": "https://stackoverflow.com/questions/50344728/better-solution-for-one-other-or-both-cases/50344811#50344811", "title": "Better solution for &quot;one, other or both&quot; cases", "body": "<p>I'd use something like this:</p>\n\n<pre><code>def between_dates(date_1, date_2)\n  parts = []\n\n  if date_1\n    parts &lt;&lt; \"created_at &gt;= date_1\"\n  end\n\n  if date_2\n    parts &lt;&lt; \"created_at &lt;= date_2\"\n  end\n\n  full = parts.join(' AND ')\n  conditions(full)\nend\n</code></pre>\n\n<p>This can be further prettified in many ways, but you get the idea.</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1526370346, "post_id": 50344847, "comment_id": 87705450, "body": "I can see why someone can consider this elegant, but personally, I wouldn&#39;t write something like this in production code. Mainly because conditions structure is too much embedded in the code. Imagine, for example, that you need to call a function for one of the conditions. <code>MONTH(date)</code> or something. Now your elegant reduce falls apart. :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1526370662, "post_id": 50344847, "comment_id": 87705641, "body": "@SergioTulentsev yes, this is true. Also, adding <i>more</i> conditions (say, a dozen :) will increase the amount of this code insignificantly, while yours will be rejected by rubocop for 52LOCs in the method."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1526370694, "post_id": 50344847, "comment_id": 87705660, "body": "@mudasobwa touch&#233;."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1526370815, "post_id": 50344847, "comment_id": 87705736, "body": "@maxpleaner the more I think about this the more I think <code>created_ad</code> should be moved into input array as well."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1526370125, "creation_date": 1526370125, "answer_id": 50344847, "question_id": 50344728, "link": "https://stackoverflow.com/questions/50344728/better-solution-for-one-other-or-both-cases/50344847#50344847", "title": "Better solution for &quot;one, other or both&quot; cases", "body": "<p>I am not sure if this is more elegant, but I always do <code>reduce</code> everything to avoid typos:</p>\n\n<pre><code>[[date_1, '&gt;='], [date_2, '&lt;=']].\n  select(&amp;:first).\n  map { |date, sign| \"created_at #{sign} #{date}\" }.\n  join(' AND ')\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 5630260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf5dd9a49c3c5e97cf9ef931d9a20e1?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/5630260/harry"}, "edited": false, "score": 0, "creation_date": 1526375717, "post_id": 50345668, "comment_id": 87708558, "body": "That&#39;s a great solution. It doesn&#39;t exactly fit my case, but it will be kept as a reference."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 9, "last_activity_date": 1526373521, "last_edit_date": 1526373521, "creation_date": 1526373120, "answer_id": 50345668, "question_id": 50344728, "link": "https://stackoverflow.com/questions/50344728/better-solution-for-one-other-or-both-cases/50345668#50345668", "title": "Better solution for &quot;one, other or both&quot; cases", "body": "<p>Rails lets you build a query dynamically. Here's an example using <a href=\"http://guides.rubyonrails.org/active_record_querying.html#scopes\" rel=\"noreferrer\">scopes</a> and a class method. Since scopes always return an <code>ActiveRecord::Relation</code> object (even if the block returns <code>nil</code>), they are chainable:</p>\n\n<pre><code>class Event &lt; ApplicationRecord\n  scope :created_before, -&gt; (date) { where('created_at &lt;= ?', date) if date }\n  scope :created_after,  -&gt; (date) { where('created_at &gt;= ?', date) if date }\n\n  def self.created_between(date_1, date_2)\n    created_after(date_1).created_before(date_2)\n  end\nend\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>Event.created_between(nil, Date.today)\n# SELECT `events`.* FROM `events` WHERE (created_at &lt;= '2018-05-15')\n\nEvent.created_between(Date.yesterday, nil)\n# SELECT `events`.* FROM `events` WHERE (created_at &gt;= '2018-05-14')\n\nEvent.created_between(Date.yesterday, Date.today)\n# SELECT `events`.* FROM `events` WHERE (created_at &gt;= '2018-05-14') AND (created_at &lt;= '2018-05-15')\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5630260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf5dd9a49c3c5e97cf9ef931d9a20e1?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/5630260/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 50344811, "answer_count": 4, "score": 3, "last_activity_date": 1526373521, "creation_date": 1526369739, "last_edit_date": 1526371629, "question_id": 50344728, "link": "https://stackoverflow.com/questions/50344728/better-solution-for-one-other-or-both-cases", "title": "Better solution for &quot;one, other or both&quot; cases", "body": "<p>I was checking some code, and something similar to the following showed up:</p>\n\n<pre><code>def between_dates(date_1, date_2)\n  if date_1 &amp;&amp; date_2\n    conditions \"created_at &gt;= date_1 AND created_at &lt;= date_2\"\n  elseif date_1\n    conditions \"created_at &gt;= date_1\"\n  elseif date_2\n    conditions \"created_at &lt;= date_2\"\n  end\nend\n</code></pre>\n\n<p>It looked the kind of code that could be improved, but I couldn't find a more elegant solution for such a trivial and common conditional statement.</p>\n\n<p>I'm looking for a better answer for this problem when we must return a value for one, other or both.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 3, "creation_date": 1526369226, "post_id": 50344533, "comment_id": 87704832, "body": "It&#39;s because it&#39;s the same array. You have 5 references to the same array in your &#39;outer&#39; array."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526369716, "post_id": 50344533, "comment_id": 87705095, "body": "What is wrong? You tell us, not the other way around."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526370741, "post_id": 50344533, "comment_id": 87705691, "body": "See <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-c-new-label-Common+gotchas\" rel=\"nofollow noreferrer\"><code>Array.new</code> \u2013 Common gotchas</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 2, "last_activity_date": 1526369264, "creation_date": 1526369264, "answer_id": 50344579, "question_id": 50344533, "link": "https://stackoverflow.com/questions/50344533/nested-array-in-ruby-updates-all-the-array-values-instead-of-one/50344579#50344579", "title": "Nested array in Ruby, updates all the array values instead of one", "body": "<p>You could use the <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-c-new\" rel=\"nofollow noreferrer\">block syntax</a> to initialize the array:</p>\n\n<pre><code>arr = Array.new(5) { Array.new }\n =&gt; [[], [], [], [], []] \n\narr[0].push(1)\narr\n =&gt; [[1], [], [], [], []]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1526370480, "creation_date": 1526370480, "answer_id": 50344938, "question_id": 50344533, "link": "https://stackoverflow.com/questions/50344533/nested-array-in-ruby-updates-all-the-array-values-instead-of-one/50344938#50344938", "title": "Nested array in Ruby, updates all the array values instead of one", "body": "<p><code>map</code> produces the array:</p>\n\n<pre><code>arr = 5.times.map { [] }\n\narr.first &lt;&lt; 42\n#\u21d2 [42]\narr\n#\u21d2 [[42], [], [], [], []]\n</code></pre>\n"}], "owner": {"reputation": 524, "user_id": 7155089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f2edae810d151e29ba5ce2df8695d1c?s=128&d=identicon&r=PG&f=1", "display_name": "Kishy Nivas", "link": "https://stackoverflow.com/users/7155089/kishy-nivas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 50344579, "answer_count": 2, "score": -2, "last_activity_date": 1526370480, "creation_date": 1526369122, "last_edit_date": 1526370044, "question_id": 50344533, "link": "https://stackoverflow.com/questions/50344533/nested-array-in-ruby-updates-all-the-array-values-instead-of-one", "title": "Nested array in Ruby, updates all the array values instead of one", "body": "<p>I tried to create a nested array, but when I update one of them, all other arrays seems to be updated, What am I doing wrong?</p>\n\n<pre><code>arr\u3000= Array.new(5,Array.new())\n# =&gt; [[], [], [], [], []] \narr[0]\n# =&gt; [] \narr[0].push(1)\n# =&gt; [1] \narr\n# =&gt; [[1], [1], [1], [1], [1]]\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1526368458, "post_id": 50343884, "comment_id": 87704391, "body": "You almost always get betters answers when showing actual code. Your example is not even valid Ruby."}, {"owner": {"reputation": 55, "user_id": 8637293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b1358e569a8aa1226e0d8173dde645?s=128&d=identicon&r=PG", "display_name": "Jackson Gong", "link": "https://stackoverflow.com/users/8637293/jackson-gong"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526369100, "post_id": 50343884, "comment_id": 87704747, "body": "Hi Stefan: thanks for the suggestion. my actual code was quite long so I didn&#39;t want them to distract, but maybe I should add some fillers instead to make it easier to read."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1526369800, "post_id": 50343884, "comment_id": 87705147, "body": "Shortening code in order to provide a minimal example is fine. But if you remove too much, it tends to become a XY problem."}], "answers": [{"tags": [], "owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "is_accepted": false, "score": 0, "last_activity_date": 1526366922, "creation_date": 1526366922, "answer_id": 50343903, "question_id": 50343884, "link": "https://stackoverflow.com/questions/50343884/how-can-i-jump-out-of-a-double-if-block/50343903#50343903", "title": "How can I jump out of a double &#39;if&#39; block?", "body": "<p>The best way is to push those lines into a new method, and <code>return</code> out of it. Problem solved, <em>with</em> shorter methods.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 8637293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b1358e569a8aa1226e0d8173dde645?s=128&d=identicon&r=PG", "display_name": "Jackson Gong", "link": "https://stackoverflow.com/users/8637293/jackson-gong"}, "edited": false, "score": 1, "creation_date": 1526369206, "post_id": 50344325, "comment_id": 87704820, "body": "This is exactly what I need. Thank you!!"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1526369303, "post_id": 50344325, "comment_id": 87704885, "body": "Do you really suggest to use a <code>catch</code> block to restructure an <code>if</code> loop? I mean it as honest question and it answers the question but you know, i think it is quite ugly?"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 0, "last_activity_date": 1526368431, "creation_date": 1526368431, "answer_id": 50344325, "question_id": 50343884, "link": "https://stackoverflow.com/questions/50343884/how-can-i-jump-out-of-a-double-if-block/50344325#50344325", "title": "How can I jump out of a double &#39;if&#39; block?", "body": "<p>Use <code>catch</code>, <code>throw</code> construction like this:</p>\n\n<pre><code>catch :from_inner do\n  if condition A\n    if condition A.1\n      # ...\n    elsif condition A.2\n      # ...\n    else \n      throw :from_inner\n    end \n    # ...\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526368806, "post_id": 50344412, "comment_id": 87704585, "body": "You miss the whole point. Your code skips the <code>(do something after either A.1 or A.2)</code> part."}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1526369100, "post_id": 50344412, "comment_id": 87704746, "body": "@sawa, you were absolutly right, corrected it. Thank you for pointing it out"}], "tags": [], "owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "is_accepted": false, "score": 0, "last_activity_date": 1526369037, "last_edit_date": 1526369037, "creation_date": 1526368692, "answer_id": 50344412, "question_id": 50343884, "link": "https://stackoverflow.com/questions/50343884/how-can-i-jump-out-of-a-double-if-block/50344412#50344412", "title": "How can I jump out of a double &#39;if&#39; block?", "body": "<p>Just change your if structure:</p>\n\n<pre><code> if condition A\n  if condition A.1\n    do something\n  elsif condition A.2\n    do something_else\n  end \n  if A.1 || A.2\n    (do something after either A.1 or A.2)\n  end\nend\n</code></pre>\n\n<p>This could be impossible due to performance reasons, but should work in most cases. Alternatively you could  move the <code>do something after</code> to a separate function and call it from both cases.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 8637293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b1358e569a8aa1226e0d8173dde645?s=128&d=identicon&r=PG", "display_name": "Jackson Gong", "link": "https://stackoverflow.com/users/8637293/jackson-gong"}, "edited": false, "score": 0, "creation_date": 1526369897, "post_id": 50344542, "comment_id": 87705203, "body": "Can you elaborate? Sorry I&#39;m new and never heard of this technique before."}], "tags": [], "owner": {"reputation": 510, "user_id": 1145628, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z9OfY.png?s=128&g=1", "display_name": "Gabriel Scavassa", "link": "https://stackoverflow.com/users/1145628/gabriel-scavassa"}, "is_accepted": false, "score": 0, "last_activity_date": 1526369154, "creation_date": 1526369154, "answer_id": 50344542, "question_id": 50343884, "link": "https://stackoverflow.com/questions/50343884/how-can-i-jump-out-of-a-double-if-block/50344542#50344542", "title": "How can I jump out of a double &#39;if&#39; block?", "body": "<p>Best solution for you is the <strong>switch case</strong></p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 8637293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b1358e569a8aa1226e0d8173dde645?s=128&d=identicon&r=PG", "display_name": "Jackson Gong", "link": "https://stackoverflow.com/users/8637293/jackson-gong"}, "edited": false, "score": 0, "creation_date": 1526395906, "post_id": 50346898, "comment_id": 87722610, "body": "Thanks! This should work, but I&#39;m a bit hesitant to repeat the conditions (which is quite long, such as browser.link(class: &#39;download-pdf-link&#39;).exists? for a.1) in the outer and inner &#39;if&#39; block and make the outer condition really long. What&#39;s a rubyist way of referring to long conditions more than one time? assign it to a variable first?"}], "tags": [], "owner": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "is_accepted": false, "score": 0, "last_activity_date": 1526377028, "creation_date": 1526377028, "answer_id": 50346898, "question_id": 50343884, "link": "https://stackoverflow.com/questions/50343884/how-can-i-jump-out-of-a-double-if-block/50346898#50346898", "title": "How can I jump out of a double &#39;if&#39; block?", "body": "<p>I feel there's a much neater way of doing this, changing conditions to be more ruby like as well:</p>\n\n<pre><code>if condition_a &amp;&amp; (condition_a_1 || condition_a_2)\n  do_something if condition_a_1\n  do_something_else if condition a_2\n  do_something_after_a_1_or_a_2\nend\n</code></pre>\n\n<p>Then have functions for the do_somethings</p>\n"}], "owner": {"reputation": 55, "user_id": 8637293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b1358e569a8aa1226e0d8173dde645?s=128&d=identicon&r=PG", "display_name": "Jackson Gong", "link": "https://stackoverflow.com/users/8637293/jackson-gong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 50344325, "answer_count": 5, "score": 0, "last_activity_date": 1526377028, "creation_date": 1526366831, "last_edit_date": 1526376472, "question_id": 50343884, "link": "https://stackoverflow.com/questions/50343884/how-can-i-jump-out-of-a-double-if-block", "title": "How can I jump out of a double &#39;if&#39; block?", "body": "<p>I have some code that looks like this:</p>\n\n<pre><code>if condition A\n  if condition A.1\n    # do something\n  elsif condition A.2\n    # do something_else\n  else \n    # (want to jump out condition A)\n  end \n  # (do something after either A.1 or A.2)\nend\n</code></pre>\n\n<p>I want to jump out of the double if block if neither <code>A.1</code> nor <code>A.2</code> is true; otherwise it'll attempt to execute the code after the inner <code>if</code> block, which will cause error. I tried <code>next</code> and <code>break</code>, but neither works. What should I do?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm", "gemfile"], "comments": [{"owner": {"reputation": 571, "user_id": 4759390, "user_type": "registered", "profile_image": "https://graph.facebook.com/839598759461592/picture?type=large", "display_name": "Artem Dorodovskyi", "link": "https://stackoverflow.com/users/4759390/artem-dorodovskyi"}, "edited": false, "score": 0, "creation_date": 1526368627, "post_id": 50343709, "comment_id": 87704487, "body": "Could you add full backtrace? It is need to know what happened before loading HTTPClient."}, {"owner": {"reputation": 21, "user_id": 9683301, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "john zhang", "link": "https://stackoverflow.com/users/9683301/john-zhang"}, "reply_to_user": {"reputation": 571, "user_id": 4759390, "user_type": "registered", "profile_image": "https://graph.facebook.com/839598759461592/picture?type=large", "display_name": "Artem Dorodovskyi", "link": "https://stackoverflow.com/users/4759390/artem-dorodovskyi"}, "edited": false, "score": 0, "creation_date": 1526412803, "post_id": 50343709, "comment_id": 87732377, "body": "i posted the full trace!"}, {"owner": {"reputation": 571, "user_id": 4759390, "user_type": "registered", "profile_image": "https://graph.facebook.com/839598759461592/picture?type=large", "display_name": "Artem Dorodovskyi", "link": "https://stackoverflow.com/users/4759390/artem-dorodovskyi"}, "edited": false, "score": 0, "creation_date": 1526455671, "post_id": 50343709, "comment_id": 87745674, "body": "Can you add your inputs of <code>bootsnap</code> Gemfile, boot.rb, etc.? Remove <code>require &#39;bootsnap&#47;setup&#39;</code> from your <code>boot.rb</code> file"}, {"owner": {"reputation": 588, "user_id": 1751556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacd343f6fcfd3b6d219b0f46d3aa3ed?s=128&d=identicon&r=PG", "display_name": "hraynaud", "link": "https://stackoverflow.com/users/1751556/hraynaud"}, "edited": false, "score": 0, "creation_date": 1551502656, "post_id": 50343709, "comment_id": 96673010, "body": "having a similar issue! its driving me nuts"}], "owner": {"reputation": 21, "user_id": 9683301, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "john zhang", "link": "https://stackoverflow.com/users/9683301/john-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 877, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1526396361, "creation_date": 1526366115, "last_edit_date": 1526396361, "question_id": 50343709, "link": "https://stackoverflow.com/questions/50343709/kernel-require-rb-file-cannot-load-such-file-but-i-have-the-gem", "title": "kernel_require.rb file cannot load such file but I have the gem", "body": "<p>I get the output:</p>\n\n<blockquote>\n  <p>/Users/JZ/.rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:32:in `require': cannot load such file -- HTTPClient (LoadError)</p>\n</blockquote>\n\n<p>I have run <code>gem install httpclient</code> and <code>bundle install</code> and it says that all gems have been installed.</p>\n\n<p>I have multiple ruby versions, could this be the issue? </p>\n\n<p>Running <code>which -a ruby</code> returns:</p>\n\n<pre><code>/Users/JZ/.rvm/rubies/ruby-2.5.1/bin/ruby\n/usr/bin/ruby\n/usr/bin/ruby\n</code></pre>\n\n<p>I have seen that others have had this issue and it fixed it for them, but I think I have the right version of ruby.</p>\n\n<p>I have tried just about everything, from uninstalling Ruby / Rails to uninstalling bundler, but don't know how to fix this!</p>\n\n<p>Here's the full trace:</p>\n\n<pre><code>4: from bin/rails:5:in `&lt;main&gt;'\n3: from /Users/JZ/.rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:283:in `require'\n2: from /Users/JZ/.rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:249:in `load_dependency'\n1: from /Users/JZ/.rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:283:in `block in require'\n/Users/JZ/.rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:32:in `require': cannot load such file -- HTTPClient (LoadError)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "url", "routes"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1526362905, "post_id": 50342570, "comment_id": 87701901, "body": "It is very much similar to a question asked yesterday <a href=\"https://stackoverflow.com/questions/50323880/changing-url-in-the-web-page\" title=\"changing url in the web page\">stackoverflow.com/questions/50323880/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "is_accepted": false, "score": 0, "last_activity_date": 1526360997, "creation_date": 1526360997, "answer_id": 50342707, "question_id": 50342570, "link": "https://stackoverflow.com/questions/50342570/changing-the-url-on-selecting-a-tab/50342707#50342707", "title": "Changing the url on selecting a tab", "body": "<p>Download Redmine for some excellent examples of Rails coding.</p>\n\n<p>It does the \"change URL on selecting a tab\" trick like this:</p>\n\n<pre><code>function showTab(name, url) {\n  $('#tab-content-' + name).parent().find('.tab-content').hide();\n  $('#tab-content-' + name).parent().find('div.tabs a').removeClass('selected');\n  $('#tab-content-' + name).show();\n  $('#tab-' + name).addClass('selected');\n  //replaces current URL with the \"href\" attribute of the current link\n  //(only triggered if supported by browser)\n  if (\"replaceState\" in window.history) {\n    window.history.replaceState(null, document.title, url);\n  }\n  return false;\n}\n</code></pre>\n\n<p>The tab itself sets its <code>onclick</code> to <code>\"showTab('#{tab[:name]}', this.href); this.blur(); return false;\"</code>. So apparently the <code>this.href</code> goes into <code>url</code>, then into <code>window.history.replaceState</code>.</p>\n"}], "owner": {"reputation": 89, "user_id": 9489349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311f6f5bab6da02e18d5819a55a77bbd?s=128&d=identicon&r=PG&f=1", "display_name": "Harini", "link": "https://stackoverflow.com/users/9489349/harini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526360997, "creation_date": 1526360090, "question_id": 50342570, "link": "https://stackoverflow.com/questions/50342570/changing-the-url-on-selecting-a-tab", "title": "Changing the url on selecting a tab", "body": "<p>I have various tab in my page which has url <code>profile</code> and when a tab is selected i want the url to change from <code>profile</code> to <code>profile/*selected_tab_name*</code>. The url is changed to what i need when the details is saved or after the form is submitted in the desired tab. I want the url to change once on pressing the tab. Can anyone help me with it! </p>\n\n<p>Controller code</p>\n\n<pre><code>class ProfileController &lt; ApplicationController\n  before_action :set_user, only: %i[index update_profile]\n\n  def index\n\n    @address = if @user.address\n                 @user.address\n               else\n                 Address.new\n               end\n  end\n\n  def update_profile\n    respond_to do |format|\n      if @user.update(user_params)\n        format.html { redirect_to profile_index_path, notice: 'Profile was successfully updated.' }\n      else\n        format.html { render :index }\n      end\n    end\n  end\n\n  def change_password\n   @user = current_user\n    if @user.update_with_password(user_password_params)\n      redirect_to root_path\n    else\n      render \"index\"\n    end\n end\n\nprivate\n\n  def set_user\n    @user = User.find(current_user.id)\n  end\n\n  def user_params\n    params.require(:user).permit(:name)\n  end\n\n  def address_params\n    params.require(:user).permit(address: %i[area state country])\n  end\n\n  def user_password_params\n    params.require(:user).permit(:password, :password_confirmation, :current_password)\n  end\nend\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>resources :profile do\n   collection do\n     patch 'update_profile'\n     patch 'change_password'\n   end\n end\n</code></pre>\n\n<p>View code</p>\n\n<pre><code>&lt;li class=\"nav-item m-tabs__item\"&gt;\n          &lt;a class=\"nav-link m-tabs__link active\" data-toggle=\"tab\" href=\"#m_user_profile_tab_1\" role=\"tab\"&gt;\n            &lt;i class=\"flaticon-share m--hide\"&gt;&lt;/i&gt;\n            Update Profile\n          &lt;/a&gt;\n        &lt;/li&gt;\n        &lt;li class=\"nav-item m-tabs__item\"&gt;\n          &lt;a class=\"nav-link m-tabs__link\" data-toggle=\"tab\" href=\"#m_user_profile_tab_2\" role=\"tab\"&gt;\n            Change Password\n          &lt;/a&gt;\n        &lt;/li&gt;\n        &lt;li class=\"nav-item m-tabs__item\"&gt;\n          &lt;a class=\"nav-link m-tabs__link\" data-toggle=\"tab\" href=\"#m_user_profile_tab_3\" role=\"tab\"&gt;\n            Settings\n          &lt;/a&gt;\n        &lt;/li&gt;\n</code></pre>\n\n<p>terminal log</p>\n\n<pre><code>Started PATCH \"/profile/change_password\" for 127.0.0.1 at 2018-05-15 10:20:55 +0530\nProcessing by ProfileController#change_password as HTML\n Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"KZDdXW/q89Iq2YBV0aobPi8hNXsn7sicGYgKs5/OOM0JF/1F8QOvHJdx9/S3st45VE1TrBWoJqmJIQage3QiyQ==\", \"user\"=&gt;{\"current_password\"=&gt;\"[FILTERED]\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"Save password\"}\n User Load (0.4ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 ORDER BY `users`.`id` ASC LIMIT 1\n\"=============================\"\n  (0.2ms)  BEGIN\n SQL (0.3ms)  UPDATE `users` SET `encrypted_password` = '$2a$11$w14M.QgK7gBWtz.UyKamr.OdKn.O/gm9h/Vgb28uzaSZcH1SU7dSO', `updated_at` = '2018-05-15 04:50:55' WHERE `users`.`id` = 1\n  (8.3ms)  COMMIT\nRedirected to http://localhost:3000/\nCompleted 302 Found in 251ms (ActiveRecord: 9.1ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "dry"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1526358994, "post_id": 50342242, "comment_id": 87700691, "body": "Are <code>jse_link</code> and <code>name</code> always required attributes? You might want to consider a presence validation in the models then. Or do they have to match the local values? Did you consider an instance method on <code>Stock</code> to only update the record when certain conditions are met?"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1526359645, "post_id": 50342242, "comment_id": 87700855, "body": "The question is not clear. Can you share how you would have done it and then ask for refactoring it?"}, {"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1526359654, "post_id": 50342242, "comment_id": 87700857, "body": "@spickermann They aren&#39;t always required attributes. What&#39;s happening is I am writing a script that pings a remote HTTP endpoint and updates my local db periodically. Sometimes, due to remote calls, some data is missed. So all I want to happen is on the next go around, it basically fills in the missing data. It isn&#39;t completely mission critical if it misses it on the first time, but in subsequent times it should catch it. I didn&#39;t consider adding an instance method on <code>Stock</code> to do this. Can you show me an example of what that might look like?"}, {"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1526359768, "post_id": 50342242, "comment_id": 87700895, "body": "@JagdeepSingh I just did....refresh the question."}], "answers": [{"comments": [{"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1526359846, "post_id": 50342516, "comment_id": 87700918, "body": "This is a clever solution, the only thing is that it isn&#39;t mission critical that these attributes exist in this case. What I am doing is pinging a remote HTTP endpoint every X mins, so if it misses an attribute for an object one time I would like to be able to catch it the next time around. I hope that makes sense."}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "reply_to_user": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1526360181, "post_id": 50342516, "comment_id": 87701017, "body": "I&#39;m not sure if I understand you point clearly, but if you change <code>jse_link.empty? &amp;&amp; name.empty?</code> to <code>jse_link.empty? || name.empty?</code> will be solved?"}, {"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1526360842, "post_id": 50342516, "comment_id": 87701237, "body": "No...sorry, what I should have said is that I don&#39;t need a validation on the model because it is OK for some of the objects to not have some of the attributes sometimes, because the script will be run again in X mins and it can be updated then. Hope that clarifies what I meant."}], "tags": [], "owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "is_accepted": false, "score": 0, "last_activity_date": 1526359720, "creation_date": 1526359720, "answer_id": 50342516, "question_id": 50342242, "link": "https://stackoverflow.com/questions/50342242/how-do-i-check-for-the-existence-of-attributes-on-an-object-and-update-missing-o/50342516#50342516", "title": "How do I check for the existence of attributes on an object and update missing ones?", "body": "<p>You can use <a href=\"http://guides.rubyonrails.org/active_record_validations.html#common-validation-options\" rel=\"nofollow noreferrer\">validations</a>:</p>\n\n<pre><code>class Stock &lt; ActiveRecord::Base\n  validate :link_and_name, on: :validate_link_and_name\n\n  def link_and_name\n    if jse_link.empty? &amp;&amp; name.empty?\n      errors.add(:link_and_name_empty, 'need to provide link and name')\n    end\n  end\nend\n</code></pre>\n\n<p>Then in your controller:</p>\n\n<pre><code>stock.update(price: price)\nunless stock.valid?(:validate_link_and_name)\n  stock.update(jse_link: link, name: name)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1526360741, "post_id": 50342561, "comment_id": 87701202, "body": "Interesting. Never knew I could pass in attributes like that to a method. That&#39;s the first time I am seeing that."}, {"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1526361062, "post_id": 50342561, "comment_id": 87701329, "body": "The one thing you missed is the equality check on the <code>price</code>, ie if both prices match then do nothing."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1526362715, "post_id": 50342561, "comment_id": 87701838, "body": "Update does not update records if there was no change. IMO this should be fine, or do I miss something?"}, {"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1526370781, "post_id": 50342561, "comment_id": 87705717, "body": "Works like a charm. Thanks!"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1526360742, "last_edit_date": 1526360742, "creation_date": 1526360050, "answer_id": 50342561, "question_id": 50342242, "link": "https://stackoverflow.com/questions/50342242/how-do-i-check-for-the-existence-of-attributes-on-an-object-and-update-missing-o/50342561#50342561", "title": "How do I check for the existence of attributes on an object and update missing ones?", "body": "<p>You might want to consider a method in your <code>Stock</code> model like this:</p>\n\n<pre><code>def patch(price:, new_link:, new_name:)\n  update(\n    price: price,\n    jse_link: (jse_link.presence || new_link),\n    name: (name.presence || new_name)\n  )\nend\n</code></pre>\n\n<p>And use it in your controller like this without a condition:</p>\n\n<pre><code>if stock.new_record?\n  # ...\nelse\n  stock.patch(new_link: link, new_name: name, price: price)\nend\n</code></pre>\n"}], "owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50342561, "answer_count": 2, "score": 0, "last_activity_date": 1526360742, "creation_date": 1526357715, "last_edit_date": 1526359751, "question_id": 50342242, "link": "https://stackoverflow.com/questions/50342242/how-do-i-check-for-the-existence-of-attributes-on-an-object-and-update-missing-o", "title": "How do I check for the existence of attributes on an object and update missing ones?", "body": "<p>So imagine I have the following code:</p>\n\n<pre><code>    stock = Stock.find_or_initialize_by(ticker: ticker)\n    if stock.new_record?\n      stock.assign_attributes(jse_link: link, name: name, price: price)\n      stock.save!\n      puts \"#{stock.ticker} created successfully with price: #{stock.price}, name: #{stock.name} and can be viewed at #{stock.jse_link}.\"\n    elsif stock.jse_link.empty? || stock.name.empty?\n      stock.update!(jse_link: link, name: name, price: price)\n      puts \"#{stock.ticker} updated successfully with price: #{stock.price}, name: #{stock.name} and can be viewed at #{stock.jse_link}.\"\n    elsif !stock.price.eql? price\n      stock.update!(price: price)\n      puts \"#{stock.ticker} updated successfully with price: #{stock.price}.\"\n    end\n</code></pre>\n\n<p>How do I refactor the above code to be more DRY &amp; elegant?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1526355862, "post_id": 50341798, "comment_id": 87699927, "body": "You mean <code>find_or_create_by()</code>, I assume?"}, {"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1526356044, "post_id": 50341798, "comment_id": 87699967, "body": "Also this doesn&#39;t quite work because <code>first_or_create</code> and <code>find_or_create_by</code> are actually methods on an AR object, not a Ruby array."}, {"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "reply_to_user": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "edited": false, "score": 0, "creation_date": 1526356435, "post_id": 50341798, "comment_id": 87700052, "body": "@Usar I just tested it with a <code>ticker</code> I know is not there, and it still gives me the same error: <code>NoMethodError: undefined method &#39;first_or_create&#39; for []:Array</code>"}, {"owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "edited": false, "score": 1, "creation_date": 1526356882, "post_id": 50341798, "comment_id": 87700164, "body": "above query doesnt work if there is no stock object."}], "tags": [], "owner": {"reputation": 547, "user_id": 6792180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mpzfa.jpg?s=128&g=1", "display_name": "Andres23Ramirez", "link": "https://stackoverflow.com/users/6792180/andres23ramirez"}, "is_accepted": false, "score": -1, "last_activity_date": 1526354007, "creation_date": 1526354007, "answer_id": 50341798, "question_id": 50341737, "link": "https://stackoverflow.com/questions/50341737/how-do-i-find-update-or-create-an-object-in-rails-in-1-call/50341798#50341798", "title": "How do I find &amp; update or create an object in Rails in 1 call?", "body": "<p>what you can do in concatenating queries:</p>\n\n<pre><code>stock = Stock.where(ticker: ticker).update(price: price).first_or_create(ticker: ticker, jse_link: link, name: name, price: price)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1526357401, "post_id": 50342150, "comment_id": 87700270, "body": "This is what my initial intuition was telling me, but I am wondering if it can be done without the conditional?"}], "tags": [], "owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "is_accepted": true, "score": 4, "last_activity_date": 1526357032, "creation_date": 1526357032, "answer_id": 50342150, "question_id": 50341737, "link": "https://stackoverflow.com/questions/50341737/how-do-i-find-update-or-create-an-object-in-rails-in-1-call/50342150#50342150", "title": "How do I find &amp; update or create an object in Rails in 1 call?", "body": "<p>I think you need to write if or else since you have different parameter to create and update.</p>\n\n<pre><code>stack = Stock.exists?(ticker: ticker) ? Stock.where(ticker: ticker).update(price: price) : Stock.create!(ticker: ticker, jse_link: link, name: name, price: price)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 7641368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23b426dae56ec4b1718d8a82ec12636?s=128&d=identicon&r=PG&f=1", "display_name": "Son Dang", "link": "https://stackoverflow.com/users/7641368/son-dang"}, "is_accepted": false, "score": 2, "last_activity_date": 1526446578, "creation_date": 1526446578, "answer_id": 50362698, "question_id": 50341737, "link": "https://stackoverflow.com/questions/50341737/how-do-i-find-update-or-create-an-object-in-rails-in-1-call/50362698#50362698", "title": "How do I find &amp; update or create an object in Rails in 1 call?", "body": "<p>You can use <code>find_or_initialize_by</code> and <code>tap</code></p>\n\n<pre><code>Stock.find_or_initialize_by(ticker: ticker).tap do |stack|\n  stack.price = price\n  if stack.new_record?\n    stack.jse_link = link\n    stack.name = name\n  end\n  stack.save\nend\n</code></pre>\n"}], "owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1780, "favorite_count": 0, "accepted_answer_id": 50342150, "answer_count": 3, "score": 0, "last_activity_date": 1526446578, "creation_date": 1526353490, "question_id": 50341737, "link": "https://stackoverflow.com/questions/50341737/how-do-i-find-update-or-create-an-object-in-rails-in-1-call", "title": "How do I find &amp; update or create an object in Rails in 1 call?", "body": "<p>So I tried this: </p>\n\n<pre><code>stock = Stock.find_or_create_by(ticker: ticker, jse_link: link, name: name, price: price)\n</code></pre>\n\n<p>It turns out that if ActiveRecord can't find a <code>Stock</code> object that matches all 4 attributes, it creates a new one. So if it finds an object that matches 3 of the 4 attributes, it creates a duplicate attribute.</p>\n\n<p>Is there a simple way, without having to use <code>if</code> statements to do all of this in 1 call?</p>\n\n<p>i.e. What I want to do is this:</p>\n\n<ul>\n<li>Find a <code>Stock</code> object that matches <code>ticker: ticker</code>. </li>\n<li>If that <code>Stock</code> object exists, then I want to update <code>price: price</code>.</li>\n<li>If that <code>Stock</code> object does not exist, then I want to create a new object with those 4 attributes (<code>ticker: ticker, jse_link: link, name: name, price: price</code>).</li>\n</ul>\n\n<p>Can I do the above without having to use conditional statements?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 6, "creation_date": 1526344992, "post_id": 50340809, "comment_id": 87697848, "body": "Someone may reply with a complete program, but we really shouldn&#39;t do that to people who are learning. Look up <code>Array#split</code> and <code>Array#uniq</code> to get started."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526345542, "post_id": 50340809, "comment_id": 87697955, "body": "Hint: Use a <code>lazy</code> enumerator if you&#39;re concerned about over-processing, and take <code>take(13)</code>."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1526350671, "post_id": 50340809, "comment_id": 87698930, "body": "<i>&quot;I know how to open the file and read line by line&quot;</i> Okay, what do you end up with?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 2, "creation_date": 1526355809, "post_id": 50340809, "comment_id": 87699911, "body": "What is your question?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1526398512, "post_id": 50340809, "comment_id": 87724480, "body": "You could use a <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/set/rdoc/Set.html\" rel=\"nofollow noreferrer\">Set</a>."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "reply_to_user": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1526419939, "post_id": 50340809, "comment_id": 87735586, "body": "@Phlip <code>Array#split</code> does not exist."}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1526420071, "post_id": 50340809, "comment_id": 87735627, "body": "Good point. But I&#39;m sure Professor Google will make something of &quot;ruby array split&quot;..."}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 3, "last_activity_date": 1526422601, "last_edit_date": 1526422601, "creation_date": 1526357924, "answer_id": 50342269, "question_id": 50340809, "link": "https://stackoverflow.com/questions/50340809/extracting-unique-words/50342269#50342269", "title": "Extracting unique words", "body": "<p>Let's first create a test file.</p>\n\n<pre><code>str =&lt;&lt;END\nWe like pancakes for breakfast,\nbut we know others like waffles.\nEND\n\nFName = 'temp'\nFile.write(FName, str)\n  #=&gt; 65 (characters written)\n</code></pre>\n\n<p>We need to return an array containing the first <code>nbr_unique</code> unique words from the file named <code>file</code>, so let's write a method that will do that.</p>\n\n<pre><code>def unique_words(fname, nbr_unique)\n  &lt;code needed here&gt;\nend\n</code></pre>\n\n<p>You need to add unique words to an array that will be returned by this method, so let's begin by creating an empty array and then return that array at the end of the method.</p>\n\n<pre><code>def unique_words(fname, nbr_unique)\n  arr = []\n  &lt;code needed here&gt;\n  arr\nend\n</code></pre>\n\n<p>You know how to read a file line-by-line, so let's do that, using the class method <a href=\"http://ruby-doc.org/core-2.4.0/IO.html#method-c-foreach&gt;\" rel=\"nofollow noreferrer\">IO::foreach</a><sup>1</sup>.</p>\n\n<pre><code>def unique_words(fname, nbr_unique)\n  arr = []\n  File.foreach(fname) do |line|\n    &lt;code need here to process line&gt;\n  end\n  arr\nend\n</code></pre>\n\n<p>The block variable <code>line</code> equals <code>\"We like pancakes for breakfast,\\n\"</code> after the first line is read. Firstly, the newline character needs to be removed. Examine the methods of the class \n<a href=\"http://ruby-doc.org/core-2.4.0/String.html\" rel=\"nofollow noreferrer\">String</a> to see if one can be used to do that.</p>\n\n<p>The second line contains the word <code>\"we\"</code>. I assume <code>\"We\"</code> and <code>\"we\"</code> are not to be regarded as unique words. This is usually handled by converting all characters of a string to either all lowercase or all uppercase. You can do this to each line or to each word (after words have been extracted from a line).  Again, look for a suitable method in the class <code>String</code> for doing this.</p>\n\n<p>Next you need to extract words from each line. Once again, look for a <code>String</code> method for doing that.</p>\n\n<p>Next we need to determine if, say, <code>\"like\"</code> (or <code>\"LIKE\"</code>) is to be added to the array <code>arr</code>. Look at the instance methods for the class <a href=\"http://ruby-doc.org/core-2.4.0/Array.html\" rel=\"nofollow noreferrer\">Array</a> for a suitable method. If it is added we need to see if <code>arr</code> now contains <code>nbr_unique</code> words. If it does we don't need to read any more lines of the file, so we need to break out of <code>foreach</code>'s block (perhaps use the keyword <code>break</code>).</p>\n\n<p>There's one more thing we need to take care of. The first line contains  <code>\"breakfast,\"</code>, the second, <code>\"waffles.\"</code>. We obviously don't want the words returned to contain punctuation. There are two ways to do that. The first is to remove the punctuation, the second is to accept only letters.</p>\n\n<p>Given a string that contains punctuation (a line or a word) we can create a second string that equals the original string with the punctuation removed. One way to do that is to use the method <a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-tr\" rel=\"nofollow noreferrer\">String#tr</a>. Suppose the string is <code>\"breakfast,\"</code>. Then</p>\n\n<pre><code>\"breakfast,\".tr(\".,?!;:'\", \"\") #=&gt; \"breakfast\"\n</code></pre>\n\n<p>To only accept letters we could use any of the following regular expressions (all return <code>\"breakfast\"</code>):</p>\n\n<pre><code>\"breakfast,\".gsub(/[a-zA-Z]+/, \"\")\n\"breakfast,\".gsub(/[a-z]+/i, \"\")\n\"breakfast,\".gsub(/[[:alphaa:]]+/, \"\")\n\"breakfast,\".gsub(/\\p{L}+/, \"\")\n</code></pre>\n\n<p>The first two work with ASCII characters only. The third (POSIX) and fourth work (<em>\\p{} construct</em>) with Unicode (search within <a href=\"http://ruby-doc.org/core-2.4.0/Regexp.html\" rel=\"nofollow noreferrer\">Regexp</a>).</p>\n\n<p>Note that it is more efficient to remove punctuation from a line before words are extracted.</p>\n\n<p><strong>Extra credit: use <a href=\"http://ruby-doc.org/core-2.4.0/Enumerator.html#method-i-with_object\" rel=\"nofollow noreferrer\">Enumerator#with_object</a></strong></p>\n\n<p>Whenever you see an object (here <code>arr</code>) initialized to be be empty, manipulated and then returned at the end of a method, you should consider using the method <code>Enumerator#with_object</code> or (more commonly), <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a>. Both of these return the object referred to in the method name.</p>\n\n<p>The method <code>IO::foreach</code> returns an enumerator (an instance of the class <code>Enumerator</code>) when it does not have a block (see doc). We therefore could write</p>\n\n<pre><code>def unique_words(fname, nbr_unique)\n  File.foreach(fname).with_object([]) do |line, arr|\n    &lt;code need here to process line&gt;\n  end\nend\n</code></pre>\n\n<p>We have eliminated two lines (<code>arr = []</code> and <code>arr</code>), but have also confined <code>arr</code>'s scope to the block. This is not a big deal but is the Ruby way.</p>\n\n<p><strong>More extra credit: use methods of the class <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/set/rdoc/Set.html\" rel=\"nofollow noreferrer\">Set</a></strong></p>\n\n<p>Suppose we wrote the following.</p>\n\n<pre><code>require 'set'\n\ndef unique_words(fname, nbr_unique)\n  File.foreach(fname).with_object(Set.new) do |line, set|\n    &lt;code need here to process line&gt;\n  end.to_a\nend\n</code></pre>\n\n<p>When we extract the word <code>\"we\"</code> from the second line we need to check if it should be added to the set. Since sets have unique elements we can just try to do it. We won't be able to do that because <code>set</code> will already contain that word from the first line of the file. A handy method for doing that is <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/set/rdoc/Set.html#method-i-add-3F\" rel=\"nofollow noreferrer\">Set#add?</a>:</p>\n\n<pre><code>set.add?(\"we\")\n  #=&gt; nil\n</code></pre>\n\n<p>Here the method returns <code>nil</code>, meaning the set already contains that word. It also tells us that we don't need to check if the set now contains <code>nbr_unique</code> words. Had we been able to add the word to the set, <code>set</code> (with the added word) would be returned. </p>\n\n<p>The block returns the value of <code>set</code> (a set). The method <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/set/rdoc/Set.html#method-i-to_a\" rel=\"nofollow noreferrer\">Set#to_a</a> converts that set to an array, which is returned by the method.</p>\n\n<p><sup>1 Notice that I've invoked the class method <code>IO::foreach</code> by writing <code>File.foreach(fname)...</code> below. This is permissible because <code>File</code> is a subclass of <code>IO</code> (<code>File.superclass #=&gt; IO</code>). I could have instead written <code>IO.foreach(fname)...</code>, but it is more common to use <code>File</code> as the receiver.</sup></p>\n"}], "owner": {"reputation": 31, "user_id": 9777997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea729cacc5db63d02beded01113ec582?s=128&d=identicon&r=PG&f=1", "display_name": "Renato", "link": "https://stackoverflow.com/users/9777997/renato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 50342269, "answer_count": 1, "score": -3, "last_activity_date": 1526422601, "creation_date": 1526344688, "last_edit_date": 1526361243, "question_id": 50340809, "link": "https://stackoverflow.com/questions/50340809/extracting-unique-words", "title": "Extracting unique words", "body": "<p>I need to take a file name and an integer N, and return the first N unique words in the file given. Let us say that <code>input.txt</code> has this content:</p>\n\n<pre><code>I like pancakes in my breakfast. Also, I like pancakes in my dinner.\n</code></pre>\n\n<p>The output of running this with N = 13 could be</p>\n\n<pre><code>I\nlike\npancakes\nin\nmy\nbreakfast.\nAlso,\ndinner.\n</code></pre>\n\n<p>I know how to open the file and read line by line, but beyond that, I don't know how to take the unique words out if the lines.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "web"], "comments": [{"owner": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "edited": false, "score": 0, "creation_date": 1526340286, "post_id": 50340274, "comment_id": 87696842, "body": "i think your error come from <a href=\"https://github.com/excid3/simple_calendar/blob/master/lib/simple_calendar/calendar.rb#L88\" rel=\"nofollow noreferrer\">here</a>. Do you have any events in <code>@events</code> ?"}, {"owner": {"reputation": 63, "user_id": 9718847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce790e80108a9314f85a35512470eb0?s=128&d=identicon&r=PG&f=1", "display_name": "G.Hines", "link": "https://stackoverflow.com/users/9718847/g-hines"}, "reply_to_user": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "edited": false, "score": 0, "creation_date": 1526340520, "post_id": 50340274, "comment_id": 87696885, "body": "I don&#39;t have any events no, literally only worked through the documentation up until this point. Had so many issues with other solutions I was just trying to get it working first."}], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 6792180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mpzfa.jpg?s=128&g=1", "display_name": "Andres23Ramirez", "link": "https://stackoverflow.com/users/6792180/andres23ramirez"}, "is_accepted": false, "score": 0, "last_activity_date": 1526352573, "creation_date": 1526352573, "answer_id": 50341631, "question_id": 50340274, "link": "https://stackoverflow.com/questions/50340274/have-a-nomethoderror-when-trying-to-implement-simple-calendar-in-ror-application/50341631#50341631", "title": "Have a NoMethodError when trying to implement simple_calendar in RoR application", "body": "<p>Event If you do not have events do not use <code>events: @event</code> leaves only this code:</p>\n\n<pre><code>&lt;%= month_calendar do |date| %&gt;\n  &lt;%= date %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>If you have any object that you want to show change it by events</p>\n"}], "owner": {"reputation": 63, "user_id": 9718847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce790e80108a9314f85a35512470eb0?s=128&d=identicon&r=PG&f=1", "display_name": "G.Hines", "link": "https://stackoverflow.com/users/9718847/g-hines"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1526352573, "creation_date": 1526339682, "question_id": 50340274, "link": "https://stackoverflow.com/questions/50340274/have-a-nomethoderror-when-trying-to-implement-simple-calendar-in-ror-application", "title": "Have a NoMethodError when trying to implement simple_calendar in RoR application", "body": "<p>I am trying to implement the gem simple_calendar into my application for a project. I am following the Github documentation (<a href=\"https://github.com/excid3/simple_calendar\" rel=\"nofollow noreferrer\">https://github.com/excid3/simple_calendar</a>) to help me through the process but I have an issue in the 'Rendering Events' section. </p>\n\n<p>After running the scaffold command for single day events and making the changes to my controller and view I tried updating my calendar page and got the error 'undefined method `reject' for nil:NilClass'. It has highlighted the first line of my calendar view as having the issue but I do not know what the issue is:</p>\n\n<pre><code> &lt;%= month_calendar events: @events do |date, events| %&gt;\n  &lt;%= date.day %&gt;\n   &lt;% events.each do |event| %&gt;\n  &lt;div&gt;\n   &lt;%=event.name %&gt;\n  &lt;/div&gt;\n &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I cannot find 'reject' anywhere in my code and I'm stuck as to what to do next. Any help at all would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activestorage"], "comments": [{"owner": {"reputation": 753, "user_id": 1034364, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Kltcx.jpg?s=128&g=1", "display_name": "memoht", "link": "https://stackoverflow.com/users/1034364/memoht"}, "edited": false, "score": 1, "creation_date": 1526357752, "post_id": 50340043, "comment_id": 87700350, "body": "The docs indicate that for <code>blob_path</code> &quot;upon access, a redirect to the actual service endpoint is returned. This indirection decouples the public URL from the actual one&quot; so by design this will foil what you are doing. Perhaps investigate using the download option."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1526360593, "post_id": 50340043, "comment_id": 87701156, "body": "The <a href=\"https://github.com/rails/rails/blob/master/activestorage/lib/active_storage/service/disk_service.rb\" rel=\"nofollow noreferrer\">disk service implementation</a> has a method called <code>path_for</code> that does what you&#39;re looking for but it is private. So using <code>#send</code> to get the paths or going through the download-to-temp-files process seem to be the options."}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 600091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54720fca1654a999e94a95433990aa7f?s=128&d=identicon&r=PG", "display_name": "Pepa Chmel", "link": "https://stackoverflow.com/users/600091/pepa-chmel"}, "edited": false, "score": 7, "creation_date": 1530100848, "post_id": 50353130, "comment_id": 89114232, "body": "Small improvement <code>ActiveStorage::Blob.service.send(:path_for, user.avatar.blob.key)</code>"}], "tags": [], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "is_accepted": true, "score": 9, "last_activity_date": 1526397552, "last_edit_date": 1526397552, "creation_date": 1526395484, "answer_id": 50353130, "question_id": 50340043, "link": "https://stackoverflow.com/questions/50340043/get-path-to-activestorage-file-on-disk/50353130#50353130", "title": "Get path to ActiveStorage file on disk", "body": "<p>Thanks to the help of @muistooshort in the comments, after looking at the <a href=\"https://github.com/rails/rails/blob/master/activestorage/lib/active_storage/service/disk_service.rb\" rel=\"noreferrer\">Active Storage Code</a>, this works:</p>\n\n<pre><code>active_storage_disk_service = ActiveStorage::Service::DiskService.new(root: Rails.root.to_s + '/storage/')\nactive_storage_disk_service.send(:path_for, user.avatar.blob.key)\n  # =&gt; returns full path to the document stored locally on disk\n</code></pre>\n\n<p>This solution feels a bit hacky to me.  I'd love to hear of other solutions.  This does work for me though. </p>\n"}, {"tags": [], "owner": {"reputation": 443, "user_id": 5997874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1hXYF.png?s=128&g=1", "display_name": "ldl", "link": "https://stackoverflow.com/users/5997874/ldl"}, "is_accepted": false, "score": 5, "last_activity_date": 1528896935, "creation_date": 1528896935, "answer_id": 50838639, "question_id": 50340043, "link": "https://stackoverflow.com/questions/50340043/get-path-to-activestorage-file-on-disk/50838639#50838639", "title": "Get path to ActiveStorage file on disk", "body": "<p>You can download the attachment to a local dir and then process it.</p>\n\n<p>Supposing you have in your model:</p>\n\n<pre><code>has_one_attached :pdf_attachment\n</code></pre>\n\n<p>You can define: </p>\n\n<pre><code>def process_attachment      \n   # Download the attached file in temp dir\n   pdf_attachment_path = \"#{Dir.tmpdir}/#{pdf_attachment.filename}\"\n   File.open(pdf_attachment_path, 'wb') do |file|\n       file.write(pdf_attachment.download)\n   end   \n\n   # process the downloaded file\n   # ...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 536, "user_id": 777037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61926f0477ef05cef6aa52cbff925570?s=128&d=identicon&r=PG", "display_name": "vitormil", "link": "https://stackoverflow.com/users/777037/vitormil"}, "is_accepted": false, "score": 34, "last_activity_date": 1533563687, "creation_date": 1533563687, "answer_id": 51709314, "question_id": 50340043, "link": "https://stackoverflow.com/questions/50340043/get-path-to-activestorage-file-on-disk/51709314#51709314", "title": "Get path to ActiveStorage file on disk", "body": "<p>Just use:</p>\n\n<pre><code>ActiveStorage::Blob.service.send(:path_for, user.avatar.key)\n</code></pre>\n\n<p>You can do something like this on your model:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_one_attached :avatar\n\n  def avatar_on_disk\n    ActiveStorage::Blob.service.send(:path_for, avatar.key)\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 106, "user_id": 2242218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a336352b7b4bd2ffb89f806ccb5a000?s=128&d=identicon&r=PG", "display_name": "Dominic", "link": "https://stackoverflow.com/users/2242218/dominic"}, "edited": false, "score": 0, "creation_date": 1603423098, "post_id": 53908358, "comment_id": 114039248, "body": "lol not while on the job - complexity is better than simplicity. Otherwise React wouldn&#39;t be so popular."}, {"owner": {"reputation": 9277, "user_id": 465915, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3a8fc598ccc6dc3c646717b0f76af23c?s=128&d=identicon&r=PG", "display_name": "ecoologic", "link": "https://stackoverflow.com/users/465915/ecoologic"}, "reply_to_user": {"reputation": 106, "user_id": 2242218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a336352b7b4bd2ffb89f806ccb5a000?s=128&d=identicon&r=PG", "display_name": "Dominic", "link": "https://stackoverflow.com/users/2242218/dominic"}, "edited": false, "score": 0, "creation_date": 1615507771, "post_id": 53908358, "comment_id": 117719561, "body": "We couldn&#39;t be farther apart on this particular topic."}], "tags": [], "owner": {"reputation": 9277, "user_id": 465915, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3a8fc598ccc6dc3c646717b0f76af23c?s=128&d=identicon&r=PG", "display_name": "ecoologic", "link": "https://stackoverflow.com/users/465915/ecoologic"}, "is_accepted": false, "score": 28, "last_activity_date": 1558586734, "last_edit_date": 1558586734, "creation_date": 1545614327, "answer_id": 53908358, "question_id": 50340043, "link": "https://stackoverflow.com/questions/50340043/get-path-to-activestorage-file-on-disk/53908358#53908358", "title": "Get path to ActiveStorage file on disk", "body": "<p>I'm not sure why all the other answers use <code>send(:url_for, key)</code>.  I'm using <strong>Rails 5.2.2</strong> and <code>url_for</code> is a public method, therefore, it's way better to avoid <code>send</code>, or simply call <code>path_for</code>:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_one_attached :avatar\n\n  def avatar_path\n    ActiveStorage::Blob.service.path_for(avatar.key)\n  end\nend\n</code></pre>\n\n<p>Worth noting that in the view you can do things like this:</p>\n\n<pre><code>&lt;p&gt;\n  &lt;%= image_tag url_for(@user.avatar) %&gt;\n  &lt;br&gt;\n  &lt;%= link_to 'View', polymorphic_url(@user.avatar) %&gt;\n  &lt;br&gt;\n  Stored at &lt;%= @user.image_path %&gt;\n  &lt;br&gt;\n  &lt;%= link_to 'Download', rails_blob_path(@user.avatar, disposition: :attachment) %&gt;\n  &lt;br&gt;\n  &lt;%= f.file_field :avatar %&gt;\n&lt;/p&gt;\n</code></pre>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21323, "favorite_count": 6, "accepted_answer_id": 50353130, "answer_count": 4, "score": 34, "last_activity_date": 1558586734, "creation_date": 1526338026, "question_id": 50340043, "link": "https://stackoverflow.com/questions/50340043/get-path-to-activestorage-file-on-disk", "title": "Get path to ActiveStorage file on disk", "body": "<p>I need to get the path to the file on disk which is using <code>ActiveStorage</code>.  The file is stored locally.</p>\n\n<p>When I was using paperclip, I used the <code>path</code> method on the attachment which returned the full path.</p>\n\n<p>Example:</p>\n\n<pre><code>user.avatar.path\n</code></pre>\n\n<p>While looking at the <a href=\"http://edgeguides.rubyonrails.org/active_storage_overview.html#linking-to-files\" rel=\"noreferrer\"> Active Storage Docs</a>, it looked like <code>rails_blob_path</code> would do the trick.  After looking at what it returned though, it does not provide the path to the document.  Thus, it returns this error:</p>\n\n<blockquote>\n  <p>No such file or directory @ rb_sysopen - </p>\n</blockquote>\n\n<p><strong>Background</strong></p>\n\n<p>I need the path to the document because I am using the <a href=\"https://rubygems.org/gems/combine_pdf\" rel=\"noreferrer\">combine_pdf</a> gem in order to combine multiple pdfs into a single pdf.  </p>\n\n<p>For the paperclip implementation, I iterated through the full_paths of the selected pdf attachments and <code>load</code> them into the combined pdf:</p>\n\n<pre><code>attachment_paths.each {|att_path| report &lt;&lt; CombinePDF.load(att_path)}\n</code></pre>\n"}, {"tags": ["mysql", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526337385, "post_id": 50339915, "comment_id": 87696149, "body": "A) Don&#39;t use global variables, those prefixed with <code>$</code> in Ruby. B) Don&#39;t use <code>;</code> unless it&#39;s strictly necessary (e.g. one-liners). C) You can call with hash arguments and omit the <code>{ ... }</code> braces on calls, like <code>execute(title: &#39;...&#39;, image: &#39;...&#39;, sku: &#39;...&#39;)</code> which is much simpler syntax."}, {"owner": {"reputation": 495, "user_id": 617108, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/PApP6.jpg?s=128&g=1", "display_name": "Phillip Gooch", "link": "https://stackoverflow.com/users/617108/phillip-gooch"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526349650, "post_id": 50339915, "comment_id": 87698719, "body": "A) I know it&#39;s a global variable B) habit of javascript and PHP, I remove them as I notice them C) while the call works fine it doesn&#39;t pass the variables into the prepared statement, leaving me with a bunch of unexpected null field in the database"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526404116, "post_id": 50339915, "comment_id": 87727809, "body": "Again, <b>don&#39;t use global variables</b>. This is a very bad habit to get into. You should also ditch the <code>;</code> as the &quot;When in Rome&quot; principle applies here. Ruby absolutely doesn&#39;t use them. PHP <i>must</i>. JavaScript depends on your philosophy. Keeping it consistent is important."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526404151, "post_id": 50339915, "comment_id": 87727826, "body": "Another thing to note is you can <code>ON DUPLICATE KEY UPDATE title=VALUES(title), image=VALUES(image)</code> with no need to repeat the placeholders."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526404201, "post_id": 50339915, "comment_id": 87727854, "body": "Only three fields will be populated by this, the rest will be NULL. Which fields do you need to populate as well?"}, {"owner": {"reputation": 495, "user_id": 617108, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/PApP6.jpg?s=128&g=1", "display_name": "Phillip Gooch", "link": "https://stackoverflow.com/users/617108/phillip-gooch"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526595572, "post_id": 50339915, "comment_id": 87818355, "body": "I am aware global variables are bad, but I was more interested in getting this working then getting them working well, I was simple working on the rough version to see if my ideas would work, it&#39;s far from production code. And yes, again In know the ; are un-needed, I put them in as habit then remove them once I notice them, I didn&#39;t update the question because while yes they are bad they are not important in regards to the question."}, {"owner": {"reputation": 495, "user_id": 617108, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/PApP6.jpg?s=128&g=1", "display_name": "Phillip Gooch", "link": "https://stackoverflow.com/users/617108/phillip-gooch"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526595729, "post_id": 50339915, "comment_id": 87818401, "body": "It&#39;s not that 3 fields were populating and the rest were null, it&#39;s that the 3 fields that should be populated were null. While using VALUES(title) and the like will work I&#39;d still much rather be able to use properly named variables as it&#39;ll make the code more readable and easier to understand later."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526598807, "post_id": 50339915, "comment_id": 87819194, "body": "This might be a limitation on your driver where it doesn&#39;t bind the same value multiple times. That&#39;s why using <code>VALUES(x)</code> instead of <code>:x</code> might help."}], "owner": {"reputation": 495, "user_id": 617108, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/PApP6.jpg?s=128&g=1", "display_name": "Phillip Gooch", "link": "https://stackoverflow.com/users/617108/phillip-gooch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526337116, "creation_date": 1526337116, "question_id": 50339915, "link": "https://stackoverflow.com/questions/50339915/prepared-insert-on-duplicate-key-mysql-queries-in-ruby", "title": "Prepared insert on duplicate key mysql queries in ruby", "body": "<p>I'm converting a node script into a ruby one just to brush up on the language (I haven't had much reason to use it as of late) and want to use a MySQL insert on duplicate key update query thats been prepared in advanced. The query is prepared like this</p>\n\n<pre><code>$add_update = db.prepare('insert into `titles` (`title`,`image`,`sku`) value (?,?,?) on duplicate key update `title`=?,`image`=?')\n</code></pre>\n\n<p>but that execute, it's not pretty</p>\n\n<pre><code>$add_update.execute('Item','item.jpg','00012534','Item','item.jpg');\n</code></pre>\n\n<p>Naturally those question marks get a bit confusing (I've already been tripped up my in the execute only updating the initial image). I'v tried binding names in the query, and while MySQL is fine with that the gem i'm using, mysql2, but it's documentation makes it seem like it's possible I don't see any specifics on how to do it. </p>\n\n<p>Ideally I could pass a hash containing the keys and values I want to use, but my google-fu has failed me (I'm probably just using the wrong terms as I can't imagine that it's not supported). Something like:</p>\n\n<pre><code>$add_update = db.prepare('insert into `titles` (`title`,`image`,`sku`) value (:title,:image,:sku) on duplicate key update `title`=:title,`image`=:image')\n$add_update.execute({:title=&gt;'Item',:image=&gt;'image.jps',:sku'00012534'});\n</code></pre>\n\n<p>I'm not using rails and chose mysql2 simple because it was the first gem I found to interface with my existing mysql server. If there is another gem that supports what I'm looking for I have no problem changing, this project is really just to get some ruby practice in and brush off the cobwebs.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "acts-as-taggable-on"], "comments": [{"owner": {"reputation": 38974, "user_id": 3381, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/023a6a37e8177cb2f84a236bbce643cf?s=128&d=identicon&r=PG", "display_name": "Ben Scheirman", "link": "https://stackoverflow.com/users/3381/ben-scheirman"}, "edited": false, "score": 1, "creation_date": 1544713762, "post_id": 50339632, "comment_id": 94381349, "body": "Ran into this today, thanks for posting this. Saved me a bit of time :)"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 8257082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eOqmS.jpg?s=128&g=1", "display_name": "Twistedben", "link": "https://stackoverflow.com/users/8257082/twistedben"}, "edited": false, "score": 1, "creation_date": 1526401027, "post_id": 50348675, "comment_id": 87726033, "body": "Thanks Narashimha."}], "tags": [], "owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "is_accepted": true, "score": 2, "last_activity_date": 1526382550, "creation_date": 1526382550, "answer_id": 50348675, "question_id": 50339632, "link": "https://stackoverflow.com/questions/50339632/actsastaggableon-undefined-method-for-nilnilclass-create-action/50348675#50348675", "title": "ActsAsTaggableOn Undefined Method &#39;[]=&#39; for nil:NilClass - Create Action", "body": "<p>There is an open <a href=\"https://github.com/mbleigh/acts-as-taggable-on/issues/874\" rel=\"nofollow noreferrer\">issue</a> on this and an open <a href=\"https://github.com/mbleigh/acts-as-taggable-on/pull/887\" rel=\"nofollow noreferrer\">PR</a> as well. Please go through these issues</p>\n\n<p>You can use the gem from those branches (or) you can have your own fork with a fix for this issue. </p>\n"}], "owner": {"reputation": 111, "user_id": 8257082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eOqmS.jpg?s=128&g=1", "display_name": "Twistedben", "link": "https://stackoverflow.com/users/8257082/twistedben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 50348675, "answer_count": 1, "score": 3, "last_activity_date": 1529699080, "creation_date": 1526335315, "last_edit_date": 1529699080, "question_id": 50339632, "link": "https://stackoverflow.com/questions/50339632/actsastaggableon-undefined-method-for-nilnilclass-create-action", "title": "ActsAsTaggableOn Undefined Method &#39;[]=&#39; for nil:NilClass - Create Action", "body": "<p>Thanks in advance for the help.</p>\n\n<p><strong>Below, at the bottom of my post, I updated it with the fix for this issue, partly thanks to Narasimha Reddy. Hope it helps anyone with a similar issue after upgrading to Rails 5.2. UPDATE: ActsAsTaggableOn 6.0 is out and fixes this issue.</strong></p>\n\n<p>I have recently upgraded to Rails 5.2, Ruby 2.5, and switched my development database to PostgreSQL (9.3.18, gem: 1.0.0). Previously, this issue wasn't occurring, and only the aforementioned changes have been made since then. I use ActsAsTaggableOn (5.0.0) gem for a review form that uses two lists: love_list and improve_list. Now, when submitting the form, I receive the following error: </p>\n\n<pre><code>    NoMethodError in CityReviewsController#create\nundefined method `[]=' for nil:NilClass Extracted source (around line 56)\n\n 56:   @new_city_review = @city.city_reviews.build(city_review_params)\n    @new_city_review.user_id = current_user.id  \n\nRails.root: /home/ubuntu/mvp1\nApplication Trace | Framework Trace | Full Trace\nacts-as-taggable-on (5.0.0) lib/acts_as_taggable_on/taggable/core.rb:206:in `process_dirty_object'\nacts-as-taggable-on (5.0.0) lib/acts_as_taggable_on/taggable/core.rb:184:in `set_tag_list_on'\nacts-as-taggable-on (5.0.0) lib/acts_as_taggable_on/taggable/core.rb:45:in `love_list='\nactivemodel (5.2.0) lib/active_model/attribute_assignment.rb:51:in `public_send'\nactivemodel (5.2.0) lib/active_model/attribute_assignment.rb:51:in `_assign_attribute'\nactivemodel (5.2.0) lib/active_model/attribute_assignment.rb:44:in `block in _assign_attributes'\nactivemodel (5.2.0) lib/active_model/attribute_assignment.rb:43:in `each'\nactivemodel (5.2.0) lib/active_model/attribute_assignment.rb:43:in `_assign_attributes'\nactiverecord (5.2.0) lib/active_record/attribute_assignment.rb:23:in `_assign_attributes'\nactivemodel (5.2.0) lib/active_model/attribute_assignment.rb:35:in `assign_attributes'\nactiverecord (5.2.0) lib/active_record/core.rb:314:in `initialize'\nactiverecord (5.2.0) lib/active_record/inheritance.rb:66:in `new'\nactiverecord (5.2.0) lib/active_record/inheritance.rb:66:in `new'\nactiverecord (5.2.0) lib/active_record/reflection.rb:154:in `build_association'\nactiverecord (5.2.0) lib/active_record/associations/association.rb:270:in `build_record'\nactiverecord (5.2.0) lib/active_record/associations/collection_association.rb:106:in `build'\nactiverecord (5.2.0) lib/active_record/associations/collection_proxy.rb:319:in `build'\napp/controllers/city_reviews_controller.rb:56:in `create'\nactionpack (5.2.0) lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'\nactionpack (5.2.0) lib/abstract_controller/base.rb:194:in `process_action'\nactionpack (5.2.0) lib/action_controller/metal/rendering.rb:30:in `process_action'\nactionpack (5.2.0) lib/abstract_controller/callbacks.rb:42:in `block in process_action'\nactivesupport (5.2.0) lib/active_support/callbacks.rb:132:in `run_callbacks'\nactionpack (5.2.0) lib/abstract_controller/callbacks.rb:41:in `process_action'\nactionpack (5.2.0) lib/action_controller/metal/rescue.rb:22:in `process_action'\nactionpack (5.2.0) lib/action_controller/metal/instrumentation.rb:34:in `block in process_action'\nactivesupport (5.2.0) lib/active_support/notifications.rb:168:in `block in instrument'\nactivesupport (5.2.0) lib/active_support/notifications/instrumenter.rb:23:in `instrument'\nactivesupport (5.2.0) lib/active_support/notifications.rb:168:in `instrument'\nactionpack (5.2.0) lib/action_controller/metal/instrumentation.rb:32:in `process_action'\nactionpack (5.2.0) lib/action_controller/metal/params_wrapper.rb:256:in `process_action'\nactiverecord (5.2.0) lib/active_record/railties/controller_runtime.rb:24:in `process_action'\nactionpack (5.2.0) lib/abstract_controller/base.rb:134:in `process'\nactionview (5.2.0) lib/action_view/rendering.rb:32:in `process'\nactionpack (5.2.0) lib/action_controller/metal.rb:191:in `dispatch'\nactionpack (5.2.0) lib/action_controller/metal.rb:252:in `dispatch'\nactionpack (5.2.0) lib/action_dispatch/routing/route_set.rb:52:in `dispatch'\nactionpack (5.2.0) lib/action_dispatch/routing/route_set.rb:34:in `serve'\nactionpack (5.2.0) lib/action_dispatch/journey/router.rb:52:in `block in serve'\nactionpack (5.2.0) lib/action_dispatch/journey/router.rb:35:in `each'\nactionpack (5.2.0) lib/action_dispatch/journey/router.rb:35:in `serve'\nactionpack (5.2.0) lib/action_dispatch/routing/route_set.rb:840:in `call'\nomniauth (1.8.1) lib/omniauth/strategy.rb:190:in `call!'\nomniauth (1.8.1) lib/omniauth/strategy.rb:168:in `call'\nwarden (1.2.7) lib/warden/manager.rb:36:in `block in call'\nwarden (1.2.7) lib/warden/manager.rb:35:in `catch'\nwarden (1.2.7) lib/warden/manager.rb:35:in `call'\nrack (2.0.5) lib/rack/tempfile_reaper.rb:15:in `call'\nrack (2.0.5) lib/rack/etag.rb:25:in `call'\nrack (2.0.5) lib/rack/conditional_get.rb:38:in `call'\nrack (2.0.5) lib/rack/head.rb:12:in `call'\nactionpack (5.2.0) lib/action_dispatch/http/content_security_policy.rb:18:in `call'\nrack (2.0.5) lib/rack/session/abstract/id.rb:232:in `context'\nrack (2.0.5) lib/rack/session/abstract/id.rb:226:in `call'\nactionpack (5.2.0) lib/action_dispatch/middleware/cookies.rb:670:in `call'\nactiverecord (5.2.0) lib/active_record/migration.rb:559:in `call'\nactionpack (5.2.0) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (5.2.0) lib/active_support/callbacks.rb:98:in `run_callbacks'\nactionpack (5.2.0) lib/action_dispatch/middleware/callbacks.rb:26:in `call'\nactionpack (5.2.0) lib/action_dispatch/middleware/executor.rb:14:in `call'\nbetter_errors (2.4.0) lib/better_errors/middleware.rb:59:in `call'\nactionpack (5.2.0) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'\nweb-console (3.6.2) lib/web_console/middleware.rb:135:in `call_app'\nweb-console (3.6.2) lib/web_console/middleware.rb:22:in `block in call'\nweb-console (3.6.2) lib/web_console/middleware.rb:20:in `catch'\nweb-console (3.6.2) lib/web_console/middleware.rb:20:in `call'\nactionpack (5.2.0) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'\nrailties (5.2.0) lib/rails/rack/logger.rb:38:in `call_app'\nrailties (5.2.0) lib/rails/rack/logger.rb:26:in `block in call'\nactivesupport (5.2.0) lib/active_support/tagged_logging.rb:71:in `block in tagged'\nactivesupport (5.2.0) lib/active_support/tagged_logging.rb:28:in `tagged'\nactivesupport (5.2.0) lib/active_support/tagged_logging.rb:71:in `tagged'\nrailties (5.2.0) lib/rails/rack/logger.rb:26:in `call'\nsprockets-rails (3.2.1) lib/sprockets/rails/quiet_assets.rb:13:in `call'\nactionpack (5.2.0) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'\nrequest_store (1.4.1) lib/request_store/middleware.rb:19:in `call'\nactionpack (5.2.0) lib/action_dispatch/middleware/request_id.rb:27:in `call'\nrack (2.0.5) lib/rack/method_override.rb:22:in `call'\nrack (2.0.5) lib/rack/runtime.rb:22:in `call'\nactivesupport (5.2.0) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'\nactionpack (5.2.0) lib/action_dispatch/middleware/executor.rb:14:in `call'\nactionpack (5.2.0) lib/action_dispatch/middleware/static.rb:127:in `call'\nrack (2.0.5) lib/rack/sendfile.rb:111:in `call'\nrailties (5.2.0) lib/rails/engine.rb:524:in `call'\npuma (3.11.4) lib/puma/configuration.rb:225:in `call'\npuma (3.11.4) lib/puma/server.rb:632:in `handle_request'\npuma (3.11.4) lib/puma/server.rb:446:in `process_client'\npuma (3.11.4) lib/puma/server.rb:306:in `block in run'\npuma (3.11.4) lib/puma/thread_pool.rb:120:in `block in spawn_thread'\nRequest\nParameters:\n{\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"+KJueLU14yKJPxcTyhPbg0cQFkShT0oYjl9ddJR2pGKSDroJTReEMw7zukg3mpB5Gf3O8HhGYHDbYYqtNoM6Pw==\",\n \"city_review\"=&gt;\n  {\"title\"=&gt;\"Blah Blah Blah\",\n   \"score\"=&gt;\"3\",\n   \"love_list\"=&gt;\"Schools / Education, Night Life, \",\n   \"improve_list\"=&gt;\"Schools / Education, Taxes, \",\n   \"description\"=&gt;\n    \"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium.\\r\\n\" +\n    \"Proin varius tincidunt purus, congue hendrerit ex interdum sed. Sed interdum, nibh ac lacinia vulputate, neque tellus ultricies nibh, eget vehicula ligula diam sit amet diam. Donec aliquam blandit laoreet. Cras at efficitur est. Phasellus quis enim vitae nisl sodales feugiat non sit amet tellus. Phasellus commodo, risus vitae luctus porta, nulla leo luctus massa, vel tempus odio tellus at nulla. Ut dictum nibh urna, quis scelerisque odio pellentesque ut. Sed at pretium nisi. Maecenas facilisis enim sed molestie gravida.\"},\n \"commit\"=&gt;\"Submit Review\",\n \"city_id\"=&gt;\"lakewood\"}\n</code></pre>\n\n<p>In my server terminal I receive a 500 error: </p>\n\n<blockquote>\n  <p>\"Completed 500 Internal Server Error in 13ms (ActiveRecord: 1.5ms)\"</p>\n</blockquote>\n\n<p>In Rails Console, I receive the same error. My Controller is posted below:</p>\n\n<pre><code>class CityReviewsController &lt; ApplicationController\n# Main controller for City Reviews\n  before_action :set_city_review, only: [:show, :edit, :update, :destroy, :upvote]\n  # Below - Sets City for method actions of City Review.\n  before_action :set_city, except: [:edit, :update, :destroy] \n  # Below - Multiples the score value that is initially 1 out of 5 and factors it by 20.\n  before_action :multiply_score, only: [:create, :update]\n  # Below - Sets user related params and IDs \n  before_action :set_user_params, only: [:edit, :update, :destroy]\n\n  def show\n    # Below - adds punch counter to City Review.\n    @city_review.punch(request)\n    @city_review_comments = @city_review.comments\n  end\n\n  # GET /city_reviews/new\n  def new\n    @new_city_review = CityReview.new\n  end\n\n  # GET /city_reviews/1/edit\n  def edit\n    # Calls all user related params and ids from a before action above.\n\n  end\n\n  def create\n    # Below -  Creates a WUL City Review for the city using the \"city_review_params\" method in \"private\" below, passing\n      # attributes for the :title, :score, :description, :city_review_score_id, :user_id, and :city_id, taggings list (:love_list, :improve_list) and assigning the Review to the city.\n    @new_city_review = @city.city_reviews.build(city_review_params)\n    # Below - Sets the user id to the current user posting the city review\n    @new_city_review.user_id = current_user.id \n    # Below - Sets the City Review ID to the current users city's ID.\n    @new_city_review.city_id = current_user.city.id\n    # Below - Sets the City Review Score Id to the associated city id which should match the City Score ID column.\n    @new_city_review.city_review_score_id = current_user.city.id\n    # Begin - If statement for determining if the City Review was committed to the DB successfully, then rendering the City Reviews \n      # show page with a success message, or displaying an error and rendering a new form page.\n    if @new_city_review.save # If it saves, display Flash message success, if not move to 'else'\n      flash[:notice] = \"Your What You Love review for #{@city.name} has been successfully posted!\"   # Shows a Flash message of success\n      redirect_to city_review_path(@city, @new_city_review)  # Redirects to the City Review's show page.\n    else\n      flash[:alert] = \"Could not post your What You Love review for #{@city.name}. See why below!\"   # Shows a Flash message of error\n      render 'new' # Reload the New template with errors\n    end # End - If statement for review creation.\n  end\n\n  def update\n    # Calls all user related params and ids from a before action above.\n    @city_review.user_id = current_user.id \n    # Below - Sets the City Review ID to the current users city's ID.\n    @city_review.city_id = current_user.city.id\n    # Below - Sets the City Review Score Id to the associated city id which should match the City Score ID column.\n    @city_review.city_review_score_id = current_user.city.id\n\n    if @city_review.update(city_review_params)\n      flash[:notice] = \"Your What You Love Review has been updated successfully!\"\n      redirect_to city_review_path(@city, @city_review)\n    else \n      flash[:alert] = \"Your What You Love Review could not be updated. See why below!\"\n      render 'edit'\n    end \n  end\n\n  def destroy\n    # Calls all user related params and ids from a before action above.\n    if @city_review.user === current_user\n      if @city_review.destroy\n        flash[:alert] = \"Your What You Love review has been deleted.\"\n        redirect_to city_review_index_path(@city)\n      end\n    end\n  end\n\n  private\n    # Below - Finds the City Review ID from the params\n    def set_city_review\n      @city_review = CityReview.friendly.find(params[:id])\n    end\n    # Below - Sets up the city for City Review\n    def set_city\n      @city = City.friendly.find(params[:city_id])\n    end\n\n    def city_review_params\n      params.require(:city_review).permit(:id, :title, :description, :score, :user_id, :city_id, :city_review_score_id, :love_list, :improve_list)\n    end\n\n    # Below - Sets up user related params on edit, update and destroy.\n    def set_user_params \n      @user = User.friendly.find(params[:user_id])\n      @city_review = CityReview.friendly.find(params[:id])\n      @city = @city_review.city.friendly_id\n      @city_review_edit = @city_review\n    end \n    # Takes the user submitted Score value (1..1.5..) out of 5, empties the existing params (:score),\n      # multiplies it by 20 to get a percentage value out of 100, and reassigns the params to the newly\n        # multiplied value.\n    def multiply_score\n      user_score = params[:city_review].delete(:score).to_f\n      score = user_score * 20\n      params[:city_review][:score] = score\n    end\nend\n</code></pre>\n\n<p>My relevant model code for ActsAsTaggableOn: </p>\n\n<pre><code>   acts_as_taggable_on :love, :improve\n</code></pre>\n\n<p>I used, per ActsAsTaggableOn gem suggestion, their migration setup by running the command: </p>\n\n<blockquote>\n  <p>rake acts_as_taggable_on_engine:install:migrations</p>\n</blockquote>\n\n<p>And this is how my schema looks for those tables:</p>\n\n<pre><code> create_table \"taggings\", id: :serial, force: :cascade do |t|\n    t.integer \"tag_id\"\n    t.string \"taggable_type\"\n    t.integer \"taggable_id\"\n    t.string \"tagger_type\"\n    t.integer \"tagger_id\"\n    t.string \"context\", limit: 128\n    t.datetime \"created_at\"\n    t.index [\"context\"], name: \"index_taggings_on_context\"\n    t.index [\"tag_id\", \"taggable_id\", \"taggable_type\", \"context\", \"tagger_id\", \"tagger_type\"], name: \"taggings_idx\", unique: true\n    t.index [\"tag_id\"], name: \"index_taggings_on_tag_id\"\n    t.index [\"taggable_id\", \"taggable_type\", \"context\"], name: \"index_taggings_on_taggable_id_and_taggable_type_and_context\"\n    t.index [\"taggable_id\", \"taggable_type\", \"tagger_id\", \"context\"], name: \"taggings_idy\"\n    t.index [\"taggable_id\"], name: \"index_taggings_on_taggable_id\"\n    t.index [\"taggable_type\"], name: \"index_taggings_on_taggable_type\"\n    t.index [\"tagger_id\", \"tagger_type\"], name: \"index_taggings_on_tagger_id_and_tagger_type\"\n    t.index [\"tagger_id\"], name: \"index_taggings_on_tagger_id\"\n  end\n\n  create_table \"tags\", id: :serial, force: :cascade do |t|\n    t.string \"name\"\n    t.integer \"taggings_count\", default: 0\n    t.index [\"name\"], name: \"index_tags_on_name\", unique: true\n  end\n</code></pre>\n\n<p>In attempt to troubleshoot this, I tried a lot of different things, such as rolling back migrations, reinstalling the gem, changing the name of the lists, using the default, using it on a different model, and a few different controller actions. Also, in the code, you'll also see the presence of FriendlyID Gem. </p>\n\n<p>Thank you so much for reading and your assistance. </p>\n\n<p>*To temporarily fix this ActsAsTaggableOn issue with Rails 5.2, use a branch from Fodoj called rails-5.2. In your gemfile add the git link and branch to acts-as-taggable-on gem and then run <em>bundle install</em> and restart your server:* </p>\n\n<pre><code>gem 'acts-as-taggable-on', :git =&gt; 'https://github.com/Fodoj/acts-as-taggable-on', :branch =&gt; 'rails-5.2'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-5.1.6"], "comments": [{"owner": {"reputation": 4497, "user_id": 1050875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3549436942ea890da97f41d1dbd3594f?s=128&d=identicon&r=PG", "display_name": "akbarbin", "link": "https://stackoverflow.com/users/1050875/akbarbin"}, "edited": false, "score": 0, "creation_date": 1526355276, "post_id": 50339289, "comment_id": 87699791, "body": "Hi @Salil. What is output <code>params.to_h.merge(query_hash)</code> when the link works? is it url?"}], "answers": [{"tags": [], "owner": {"reputation": 576, "user_id": 2361564, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/tPogy.png?s=128&g=1", "display_name": "Mark Davies", "link": "https://stackoverflow.com/users/2361564/mark-davies"}, "is_accepted": false, "score": 3, "last_activity_date": 1544614907, "creation_date": 1544614907, "answer_id": 53742276, "question_id": 50339289, "link": "https://stackoverflow.com/questions/50339289/actioncontrollerunfilteredparameters-unable-to-convert-unpermitted-parameter/53742276#53742276", "title": "ActionController::UnfilteredParameters - unable to convert unpermitted parameters to hash - Rails 5.1.6", "body": "<p>I know this is a late response but I had a similar problem and found a solution so it may be helpful to others.  </p>\n\n<p>I had a similar issue with a link where I was passing the ransack parameters in Active Admin.  My link to looked similar to yours:</p>\n\n<pre><code>link_to('PRIMARY EMAILS ONLY', export_primary_emails_admin_admin_areas_path(format: \"csv\", params: params[:q]))\n</code></pre>\n\n<p>Even though I had set the strong parameters, as per the documentation, I kept getting the same error.  The only way I could get this to work was to force the parameter to be permitted using this directly before the link_to.  </p>\n\n<pre><code>params[:q].permit!\n</code></pre>\n\n<p>It is effectively doing the same thing as strong params would in allowing anything in the \"q\" parameter(s).</p>\n\n<pre><code>ActiveAdmin.register AdminArea do\n  permit_params q: []\nend\n</code></pre>\n"}], "owner": {"reputation": 43225, "user_id": 297087, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/17b3a5816f0647e9b0f7c49d60f93e7b?s=128&d=identicon&r=PG", "display_name": "Salil", "link": "https://stackoverflow.com/users/297087/salil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1640, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1544614907, "creation_date": 1526333389, "question_id": 50339289, "link": "https://stackoverflow.com/questions/50339289/actioncontrollerunfilteredparameters-unable-to-convert-unpermitted-parameter", "title": "ActionController::UnfilteredParameters - unable to convert unpermitted parameters to hash - Rails 5.1.6", "body": "<p>I am getting this error in following code</p>\n\n<pre><code>link_to params.to_h.merge(query_hash), options do\n  raw(\"#{title} \" + fa_icon(icon))\nend\n</code></pre>\n\n<p>To fix it i tried following things which didn't work mentioned <a href=\"https://stackoverflow.com/a/46029524/297087\">here</a></p>\n\n<pre><code> request.parameters.merge(query_hash)\n</code></pre>\n\n<p>also</p>\n\n<pre><code>safe_params = params.permit(params.keys.flatten)\nlink_to safe_params.to_h.merge(query_hash), options do\n  raw(\"#{title} \" + fa_icon(icon))\nend\n</code></pre>\n\n<p>But nothing works for me, has anybody gone through such error.\nAny help is appreciated.</p>\n"}, {"tags": ["arrays", "ruby", "inject"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 2, "creation_date": 1526331788, "post_id": 50338948, "comment_id": 87694202, "body": "Rounding - see &quot;is floating point math broken&quot; questions: <code>sum</code> probably uses native code; if so, it can be optimized, but also means it doesn&#39;t have to do the <i>exact</i> same sequence of rounding to a double-64 each step. What is the result of <code>[10, 15, 1.1, 2, 6.16, 1].sum</code>? What about <code>10 + 15 + 1.1 + 2 + 6.16 + 1</code>? Those should show the same behavior &quot;deviations&quot; as the code in the question."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526332352, "post_id": 50338948, "comment_id": 87694417, "body": "The order in which these are added has an impact on what value you get out due to quirks of floating point values. I have a feeling <code>sum</code> works in a different order."}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 4, "creation_date": 1526334011, "post_id": 50338948, "comment_id": 87695042, "body": "TIL we should prefer <code>sum</code> not only for performance but for accuracy when adding floating point numbers, thanks for this. It&#39;s pretty informative to look at the amount of complexity that exists in the <a href=\"https://github.com/mrkn/enumerable-statistics/blob/master/ext/enumerable/statistics/extension/statistics.c#L636\" rel=\"nofollow noreferrer\">C implementation</a>  of something as (seemingly) trivial as <code>Array#sum</code>."}], "answers": [{"tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": true, "score": 7, "last_activity_date": 1526333671, "last_edit_date": 1592644375, "creation_date": 1526333671, "answer_id": 50339355, "question_id": 50338948, "link": "https://stackoverflow.com/questions/50338948/ruby-sum-vs-inject-produces-different-results/50339355#50339355", "title": "Ruby: sum vs. inject(:+) produces different results", "body": "<p>The C implementation of <code>Array#sum</code> delegates to the <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"noreferrer\">Kahan summation algorithm</a> when some of its inputs are floating point numbers.</p>\n<p>This algorithm ...</p>\n<blockquote>\n<p>...significantly reduces the numerical error in the total obtained by adding a sequence of finite precision floating point numbers, compared to the obvious approach. This is done by keeping a separate running compensation (a variable to accumulate small errors).</p>\n<p><em>-- <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"noreferrer\">Wikipedia</a></em></p>\n</blockquote>\n<p>See <a href=\"https://www.rubydoc.info/github/mrkn/enumerable-statistics/master/Array%3Asum\" rel=\"noreferrer\">Array#sum</a> and the <a href=\"https://github.com/mrkn/enumerable-statistics/blob/master/ext/enumerable/statistics/extension/statistics.c#L687\" rel=\"noreferrer\">implementation on Github</a>.</p>\n"}], "owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 1, "accepted_answer_id": 50339355, "answer_count": 1, "score": 11, "last_activity_date": 1526333671, "creation_date": 1526331679, "last_edit_date": 1526333135, "question_id": 50338948, "link": "https://stackoverflow.com/questions/50338948/ruby-sum-vs-inject-produces-different-results", "title": "Ruby: sum vs. inject(:+) produces different results", "body": "<p>I've noticed <code>array.sum</code> and <code>array.inject(:+)</code> produce different results. What's the reason for this?</p>\n\n<pre><code>a = [10, 1.1, 6.16]\n\na.inject(:+)\n# =&gt; 17.259999999999998\n\na.sum\n# =&gt; 17.26\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "datetime"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1526331301, "post_id": 50338765, "comment_id": 87694001, "body": "How do you know which time zone the user is in? Or is that part of your question - are you asking how it should be collected/stored?"}, {"owner": {"reputation": 507, "user_id": 6484367, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/8e9d26d6946fc918749adbefd5dd751c?s=128&d=identicon&r=PG&f=1", "display_name": "dsomel21", "link": "https://stackoverflow.com/users/6484367/dsomel21"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526331928, "post_id": 50338765, "comment_id": 87694255, "body": "@TomLord I know what timezone User&#39;s are in. I want to get the put whatever the <code>time</code> string is (ie. &quot;3:00 PM&quot;) and just merge their timezone with that time. It&#39;s hard to explain."}, {"owner": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "edited": false, "score": 2, "creation_date": 1526333004, "post_id": 50338765, "comment_id": 87694690, "body": "@dsomel21 try this : <code>start.to_time.in_time_zone(unit_time_zone)</code> (solution found <a href=\"https://stackoverflow.com/a/1386889/9541423\">here</a>)"}, {"owner": {"reputation": 507, "user_id": 6484367, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/8e9d26d6946fc918749adbefd5dd751c?s=128&d=identicon&r=PG&f=1", "display_name": "dsomel21", "link": "https://stackoverflow.com/users/6484367/dsomel21"}, "reply_to_user": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "edited": false, "score": 0, "creation_date": 1526393511, "post_id": 50338765, "comment_id": 87720809, "body": "@sovalina That&#39;s not what I want at all. This is converting timezones. I want to be able to say &quot;3:00&quot; UTC and then be able to change it to &quot;3 PM&quot; New York without change the hour."}, {"owner": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "edited": false, "score": 1, "creation_date": 1526394403, "post_id": 50338765, "comment_id": 87721452, "body": "@dsomel21ok i get it, so how about : <code>ActiveSupport::TimeZone.new(unit_time_zone).strptime(start, &#39;%I:%M %p&#39;)</code>"}], "owner": {"reputation": 507, "user_id": 6484367, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/8e9d26d6946fc918749adbefd5dd751c?s=128&d=identicon&r=PG&f=1", "display_name": "dsomel21", "link": "https://stackoverflow.com/users/6484367/dsomel21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526361823, "creation_date": 1526330871, "last_edit_date": 1526361823, "question_id": 50338765, "link": "https://stackoverflow.com/questions/50338765/parse-datetime-with-a-specific-timezone", "title": "Parse DateTime with a specific timezone", "body": "<p>I get some time input from a user (living in Toronto), which is the time someone wants to start their schedule, i.e.,</p>\n\n<pre><code>start = \"4:00 PM\"\n</code></pre>\n\n<p>I have to convert it into a <code>DateTime</code>. When I save it, I want to get:</p>\n\n<pre><code>16:00 #{local_time_zone}\n</code></pre>\n\n<p>but if save it, it will save it as:</p>\n\n<pre><code>16:00 UTC\n</code></pre>\n\n<p>So, I decided to use <code>DateTime.parse</code>. I expect to get:</p>\n\n<pre><code>2018-05-14 16:00:00 -0400\n</code></pre>\n\n<p>but I get from my code:</p>\n\n<pre><code>unit_time_zone = \"Eastern Time (US &amp; Canada)\"\nTime.parse(\"#{start} #{unit_time_zone}\")\n# =&gt; 2018-05-14 16:00:00 +0000\n</code></pre>\n\n<p>I even tried to parse <code>Time</code>, convert it into seconds, and parse that into a <code>DateTime</code>. It does not account for the user's time.</p>\n\n<p>How can I get a string of time in the format <code>\"3:00 PM\"</code> in a specific timezone, and not convert 3:00 PM in Toronto, 3:00 PM in Tokyo, etc.?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "edited": false, "score": 0, "creation_date": 1526330719, "post_id": 50338428, "comment_id": 87693724, "body": "Alright so I&#39;ve done what you said but I&#39;m still getting the same error"}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1526330808, "post_id": 50338428, "comment_id": 87693773, "body": "Did you fix <code>PostTest#index</code> so it also creates a User, and it assigns that user&#39;s <code>id</code> to <code>user_id</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "edited": false, "score": 0, "creation_date": 1526330823, "post_id": 50338428, "comment_id": 87693779, "body": "Ok so I just had to copy the user_id in my user yml file and everything is now working thank you."}], "tags": [], "owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "is_accepted": true, "score": 1, "last_activity_date": 1526329214, "creation_date": 1526329214, "answer_id": 50338428, "question_id": 50338415, "link": "https://stackoverflow.com/questions/50338415/rails-post-test-model-error/50338428#50338428", "title": "rails post test model error", "body": "<p><code>User.new</code> creates a new user in memory, but not in the database. It won't have a valid <code>id</code> to populate <code>user_id</code>.</p>\n\n<p>Try <code>User.create!</code>.</p>\n\n<p>Next, database records are not shared between test runs. Rails attempts \"test isolation\" by zilching records after each test case. So your PostTest needs its own copy of <code>User.create!</code>.</p>\n\n<p>After you get this working, look up the general topic of \"rails test fixtures\"...</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 50338428, "answer_count": 1, "score": 0, "last_activity_date": 1526329214, "creation_date": 1526329144, "question_id": 50338415, "link": "https://stackoverflow.com/questions/50338415/rails-post-test-model-error", "title": "rails post test model error", "body": "<p>So this is the error I'm getting</p>\n\n<p>.F</p>\n\n<p>Failure:\nPostTest#test_post_should_be_valid [/home/ubuntu/workspace/test/models/post_test.rb:9]:\n[\"User must exist\"]</p>\n\n<p>I'm not sure what it means by \"user must exist\" since I'm pretty sure a user with an user_id one does exist.\nheres my code</p>\n\n<h1>post_test.rb</h1>\n\n<pre><code>require 'test_helper'\n\nclass PostTest &lt; ActiveSupport::TestCase\n  def setup\n    @post=Post.new(user_id: \"1\",name:\"ruby meetup\")\n  end\n\n  test \"post should be valid\" do\n    assert @post.valid?, @post.errors.full_messages\n  end\n\nend\n</code></pre>\n\n<h1>post.rb</h1>\n\n<pre><code>class Post &lt; ApplicationRecord\nbelongs_to :user\n geocoded_by :address\nafter_validation :geocode, if: -&gt;(obj){ obj.address.present? and obj.address_changed? }\nreverse_geocoded_by :latitude, :longitude\nafter_validation :reverse_geocode\n\n\n  has_many :rsvps\n  has_many :users, through: :rsvps\n\n  validates :name, presence: true\n\n\n\n\n\n\nend\n</code></pre>\n\n<p>I'm not sure if this will be helpful but I'm also going to include my user test and user model.</p>\n\n<h1>user_test.rb</h1>\n\n<pre><code>require 'test_helper'\n\nclass UserTest &lt; ActiveSupport::TestCase\n  def setup\n    @user=User.new(email:\"fo30@hotmail.com\", password: \"h3h3123\")\n  end\n\n\n  test \"user should be valid\" do\n    assert @user.valid?, @user.errors.full_messages\n  end\nend\n</code></pre>\n\n<h1>user.rb</h1>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n         has_many :posts\n\n          has_many :rsvps\n          has_many :posts, through: :rsvps\n\n          validates :email, presence: true\n\n\n\n\n\nend\n</code></pre>\n\n<p>Any help will greatly be appreciated as I just recently started testing in rails.</p>\n"}, {"tags": ["ruby", "multithreading", "sidekiq"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4966663, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--LF2uB-XVw0/AAAAAAAAAAI/AAAAAAAAABk/0rD1AqbwZ-4/photo.jpg?sz=128", "display_name": "Sam Livingston-Gray", "link": "https://stackoverflow.com/users/4966663/sam-livingston-gray"}, "edited": false, "score": 0, "creation_date": 1526329528, "post_id": 50338460, "comment_id": 87693182, "body": "Thanks, Mike! Always happy to send you more money (especially when it&#39;s not my money). :)"}, {"owner": {"reputation": 1228, "user_id": 960819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/382c8d761371f83ff28f5e96da0204fe?s=128&d=identicon&r=PG", "display_name": "Pere Joan Martorell", "link": "https://stackoverflow.com/users/960819/pere-joan-martorell"}, "edited": false, "score": 0, "creation_date": 1584032758, "post_id": 50338460, "comment_id": 107319083, "body": "In Sidekiq wiki is stated that Typhoeus crashes a lot so I understand you don&#39;t recommend to use it with Sidekiq? is this statement still valid?"}], "tags": [], "owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "is_accepted": true, "score": 3, "last_activity_date": 1526329413, "creation_date": 1526329413, "answer_id": 50338460, "question_id": 50338326, "link": "https://stackoverflow.com/questions/50338326/concurrent-http-requests-from-within-a-single-sidekiq-worker/50338460#50338460", "title": "Concurrent HTTP requests from within a single Sidekiq worker?", "body": "<p>It's reasonable to use threads within Sidekiq job threads.  It's not reasonable to build your own threading infrastructure.  You can use a reusable thread pool with the <code>concurrent-ruby</code> or <code>parallel</code> gems, you can use an http client which is thread-safe and allows concurrent requests, etc.  HTTP.rb is a good one from Tony Arcieri but plain old net/http will work too:</p>\n\n<p><a href=\"https://github.com/httprb/http/wiki/Thread-Safety\" rel=\"nofollow noreferrer\">https://github.com/httprb/http/wiki/Thread-Safety</a></p>\n\n<p>Just remember that there's a few complexities: the job might be retried, how do you handle errors that the HTTP client raises?  If you don't split these requests 1-to-1 with jobs, you might need to track each or idempotency becomes an issue.</p>\n\n<p>And you are always welcome to increase your Sidekiq Enterprise thread count.  :-D</p>\n"}], "owner": {"reputation": 13, "user_id": 4966663, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--LF2uB-XVw0/AAAAAAAAAAI/AAAAAAAAABk/0rD1AqbwZ-4/photo.jpg?sz=128", "display_name": "Sam Livingston-Gray", "link": "https://stackoverflow.com/users/4966663/sam-livingston-gray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 0, "accepted_answer_id": 50338460, "answer_count": 1, "score": 1, "last_activity_date": 1526329413, "creation_date": 1526328803, "question_id": 50338326, "link": "https://stackoverflow.com/questions/50338326/concurrent-http-requests-from-within-a-single-sidekiq-worker", "title": "Concurrent HTTP requests from within a single Sidekiq worker?", "body": "<p>I'm trying to interact with Google's Calendar API.  My tests so far show response times of 5-10 <strong>seconds</strong> to insert a single event, and I may need to export thousands of events at once <em>[don't ask]</em>.  This seems likely to spam the heck out of my queues for unreasonable amounts of time.  (95% of current jobs in this app finish in &lt;300ms, so this will make it harder to allocate resources appropriately.)</p>\n\n<p>I'm currently using Faraday in this app to call other, faster Google APIs.  The Faraday wiki suggests using Typhoeus for parallel HTTP requests; however, using Typhoeus with Sidekiq was deemed <a href=\"https://twitter.com/mperham/status/477479180725022720\" rel=\"nofollow noreferrer\">\"a bad idea\"</a> as of 2014.</p>\n\n<p>Is Typhoeus still a bad idea?  If so, is it reasonable to spawn N threads in a Sidekiq worker, make an HTTP request within each thread, and then wait for all threads to rejoin?  Is there some other way to accomplish this extremely I/O-bound task without throwing more workers at the problem?  Should I ask my manager to increase our Sidekiq Enterprise spend?  ;)  Or should I just throw these jobs in a low-priority queue and tell our users with ridiculous habits that they'll just have to wait?</p>\n"}, {"tags": ["ruby", "net-ssh"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526363949, "post_id": 50338003, "comment_id": 87702292, "body": "What is your question?"}, {"owner": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526389809, "post_id": 50338003, "comment_id": 87718020, "body": "The error shows my question."}], "answers": [{"comments": [{"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "edited": false, "score": 1, "creation_date": 1526523051, "post_id": 50341264, "comment_id": 87780566, "body": "<code>ssh-rsa</code> isn&#39;t a host key, it&#39;s a key type. Remove that."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 4, "last_activity_date": 1526349487, "creation_date": 1526349487, "answer_id": 50341264, "question_id": 50338003, "link": "https://stackoverflow.com/questions/50338003/ruby-script-netsshhostkeymismatch-but-ssh-works/50341264#50341264", "title": "Ruby script Net::SSH::HostKeyMismatch but ssh works", "body": "<p>The <code>keys</code> array needs to point at your private key(s). <code>authorized_keys</code> is the public fingerprints for keys allowed to log in to the current host. Also you seem to have put a private key type in for <code>host_key</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "is_accepted": false, "score": 1, "last_activity_date": 1526504151, "creation_date": 1526504151, "answer_id": 50379745, "question_id": 50338003, "link": "https://stackoverflow.com/questions/50338003/ruby-script-netsshhostkeymismatch-but-ssh-works/50379745#50379745", "title": "Ruby script Net::SSH::HostKeyMismatch but ssh works", "body": "<p>Here is my solution:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'net/ssh'\n\nHOST = 'myhost'\nUSER = 'markhorrocks'\n\nNet::SSH.start(HOST, USER,\n:auth_methods =&gt; ['publickey'],\n:passphrase =&gt; 'mypassphrase',\n:non_interactive =&gt; true,\n:host_key =&gt; \"ssh-rsa\",\n:encryption =&gt; \"blowfish-cbc\",\n:keys =&gt; [ '/home/markhorrocks/.ssh/id_rsa' ],\n:port =&gt; '1234',\n:forward_agent =&gt; true,\n:verify_host_key =&gt; false,\n:compression =&gt; \"zlib@openssh.com\"\n ) do |session|\n       begin\n          rescue Net::SSH::HostKeyMismatch =&gt; e\n          puts \"remembering new key: #{e.fingerprint}\"\n          e.remember_host!\n          retry\n       end\n\n  output = session.exec!('ls')\n  puts output\n end\n</code></pre>\n"}], "owner": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 50341264, "answer_count": 2, "score": 4, "last_activity_date": 1526505650, "creation_date": 1526327531, "last_edit_date": 1526505650, "question_id": 50338003, "link": "https://stackoverflow.com/questions/50338003/ruby-script-netsshhostkeymismatch-but-ssh-works", "title": "Ruby script Net::SSH::HostKeyMismatch but ssh works", "body": "<p>I can ssh into a remote host on my aws network but using net/ssh fails in a ruby script. my gem is net-ssh(4.2.0) on Ubuntu 16.04. It doesn't prompt for a passphrase even with non_interactive => false.</p>\n\n<p>error:</p>\n\n<blockquote>\n  <p>Authentication failed for user Net::SSH::AuthenticationFailed</p>\n</blockquote>\n\n<p>Why does this code fail?</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire 'rubygems'\nrequire 'net/ssh'\n\nHOST = 'myhost'\n\nNet::SSH.start(HOST,\n:auth_methods =&gt; ['publickey'],\n:passphrase =&gt; 'mypassphrase',\n:non_interactive =&gt; true,\n:host_key =&gt; \"ssh-rsa\",\n:keys =&gt; [ '/home/markhorrocks/.ssh/id_rsa' ]\n ) do |session|\n  output = session.exec!('ls')\n  puts output\n end\n</code></pre>\n\n<p>After editing my code to this I get error </p>\n\n<blockquote>\n  <p>(Net::SSH::HostKeyMismatch)</p>\n</blockquote>\n\n<pre><code>HOST = 'myhost'\nUSER = 'markhorrocks'\n\nNet::SSH.start(HOST, USER,\n:auth_methods =&gt; ['publickey'],\n:passphrase =&gt; 'mypassphrase',\n:non_interactive =&gt; true,\n:host_key =&gt; \"ssh-rsa\",\n  :encryption =&gt; \"blowfish-cbc\",\n:keys =&gt; [ '/home/markhorrocks/.ssh/id_rsa' ],\n:port =&gt; '1234',\n:forward_agent =&gt; true,\n  :compression =&gt; \"zlib@openssh.com\"\n ) do |session|\n  output = session.exec!('ls')\n  puts output\n end\n</code></pre>\n"}, {"tags": ["ruby", "performance"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 1, "creation_date": 1526327082, "post_id": 50337774, "comment_id": 87692022, "body": "Have you tried to benchmark your code? What was the result?"}, {"owner": {"reputation": 679, "user_id": 3551956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6EKQJ.jpg?s=128&g=1", "display_name": "babie", "link": "https://stackoverflow.com/users/3551956/babie"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1526327668, "post_id": 50337774, "comment_id": 87692262, "body": "@HolgerJust oh, Thank you for reminding me. I will try it."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1526327835, "post_id": 50337774, "comment_id": 87692340, "body": "Out of curiosity, why would there be a performance difference?"}, {"owner": {"reputation": 679, "user_id": 3551956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6EKQJ.jpg?s=128&g=1", "display_name": "babie", "link": "https://stackoverflow.com/users/3551956/babie"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1526328212, "post_id": 50337774, "comment_id": 87692510, "body": "@jvillian I think when run code with many lines, it means more time, right?"}, {"owner": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 2, "creation_date": 1526328899, "post_id": 50337774, "comment_id": 87692846, "body": "Why do you think that? The same code functions no matter what. Performance is based on implementation not how many lines of code are in your application. The example you provided is just a style difference- some prefer how the top looks, others prefer how the bottom looks."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526329574, "post_id": 50337774, "comment_id": 87693203, "body": "There <i>may</i> be a miniscule measurable difference in the time it takes to parse the file, but I suspect you&#39;ll notice any difference at all. But by all means, benchmark it and see for yourself."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 5, "last_activity_date": 1526330114, "creation_date": 1526330114, "answer_id": 50338619, "question_id": 50337774, "link": "https://stackoverflow.com/questions/50337774/ruby-performance-with-multiple-lines-of-code/50338619#50338619", "title": "Ruby performance with multiple lines of code", "body": "<p>Syntactically these two are identical, there's no difference. When the Ruby parser engages on this code there will be an almost immeasurable increase in time required to process the newline characters, but we're talking about perhaps a handful of clock-cycles on a CPU that's going to be running at 2 <em>billion</em> clocks per second or more. That's, at best, <em>nanoseconds</em>.</p>\n\n<p>Additionally, this statement is run only once, when the model is created, so a tiny performance impact like that will be difficult to measure. The temperature of your CPU, which impacts CPU speed, is far more significant, and that will fluctuate enough that getting a good read here is impossible.</p>\n\n<p>Fewer lines is not faster. Fewer characters is not faster. Performance is independent of that.</p>\n\n<p>If you're ever curious about performance, benchmark it, but that's only relevant for code that's substantially different. In this case the code is identical apart from formatting.</p>\n\n<p>The reasoning behind the design of Ruby is to make things faster for the developer, that you can <em>express</em> your intent quickly, concisely, and in a manner that's easy to read back later. This comes at the cost of performance but as Ruby developers we make that concession willingly.</p>\n\n<p>If something has to be fast, there's always ways of optimizing it, but it's important to avoid premature optimization. If it works, and it performs adequately for your use case, spend your time solving new problems rather than rehashing old ones.</p>\n"}], "owner": {"reputation": 679, "user_id": 3551956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6EKQJ.jpg?s=128&g=1", "display_name": "babie", "link": "https://stackoverflow.com/users/3551956/babie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 50338619, "answer_count": 1, "score": -1, "last_activity_date": 1526364423, "creation_date": 1526326507, "last_edit_date": 1526364423, "question_id": 50337774, "link": "https://stackoverflow.com/questions/50337774/ruby-performance-with-multiple-lines-of-code", "title": "Ruby performance with multiple lines of code", "body": "<p>Are there any differences in performance between these two code implementations?</p>\n\n<p>First implement:</p>\n\n<pre><code>class AppSerializer &lt; ActiveModel::Serializer\n  attributes :name, :device, :identify, :token, :color\nend\n</code></pre>\n\n<p>Second implement:</p>\n\n<pre><code>class AppSerializer &lt; ActiveModel::Serializer\n  attributes :name,\n             :device,\n             :identify,\n             :token,\n             :color\nend\n</code></pre>\n\n<p>Which is better for performance?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9737634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86924d26a612a035ba0c8a27c42f9461?s=128&d=identicon&r=PG&f=1", "display_name": "user9737634", "link": "https://stackoverflow.com/users/9737634/user9737634"}, "edited": false, "score": 0, "creation_date": 1526325947, "post_id": 50337597, "comment_id": 87691487, "body": "I have answer_type in survey_question model and want to validate presence answer_content from survey_answer only if I have answer_type value i.e. radio button"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526326159, "post_id": 50337597, "comment_id": 87691591, "body": "So... Yes, I think this answers your question? Can you confirm whether it solves your problem? If yes, and you are happy with the solution, mark the answer as correct."}, {"owner": {"reputation": 3, "user_id": 9737634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86924d26a612a035ba0c8a27c42f9461?s=128&d=identicon&r=PG&f=1", "display_name": "user9737634", "link": "https://stackoverflow.com/users/9737634/user9737634"}, "edited": false, "score": 0, "creation_date": 1526326402, "post_id": 50337597, "comment_id": 87691693, "body": "no it doesn&#39;t. can you tell me what does answer stands for ?"}, {"owner": {"reputation": 667, "user_id": 6141597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d52107448cce3dc1010f66ceb534270?s=128&d=identicon&r=PG&f=1", "display_name": "abax", "link": "https://stackoverflow.com/users/6141597/abax"}, "edited": false, "score": 0, "creation_date": 1526326702, "post_id": 50337597, "comment_id": 87691818, "body": "By using the above validation your <code>SurveyAnswer</code> will only validate the presence of <code>answer_content</code> when the related <code>SurveyQuestion</code> answer type is Radio Button. If you want to only validate the presence of <code>answer_content</code> when the type is <i>not</i> &#39;Radio Button&#39; then replace the <code>if</code> with <code>unless</code>."}], "tags": [], "owner": {"reputation": 667, "user_id": 6141597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d52107448cce3dc1010f66ceb534270?s=128&d=identicon&r=PG&f=1", "display_name": "abax", "link": "https://stackoverflow.com/users/6141597/abax"}, "is_accepted": true, "score": 1, "last_activity_date": 1526325725, "creation_date": 1526325725, "answer_id": 50337597, "question_id": 50337449, "link": "https://stackoverflow.com/questions/50337449/add-model-validation-rails/50337597#50337597", "title": "Add Model Validation {Rails}", "body": "<p>I'm not sure if you are looking for an <code>if</code> or <code>unless</code> based on using <code>!=</code> in your example, but try the following:</p>\n\n<p><code>validates_presence_of :answer_content, if: -&gt;(answer) { answer.survey_question.answer_type == 'Radio Button' }</code></p>\n"}], "owner": {"reputation": 3, "user_id": 9737634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86924d26a612a035ba0c8a27c42f9461?s=128&d=identicon&r=PG&f=1", "display_name": "user9737634", "link": "https://stackoverflow.com/users/9737634/user9737634"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 1, "accepted_answer_id": 50337597, "answer_count": 1, "score": 0, "last_activity_date": 1526325725, "creation_date": 1526325123, "question_id": 50337449, "link": "https://stackoverflow.com/questions/50337449/add-model-validation-rails", "title": "Add Model Validation {Rails}", "body": "<p>I have two model association as follows:\nSurvey_question and survey_answer.</p>\n\n<p><strong>Survey_question Model</strong></p>\n\n<pre><code>class SurveyAnswer &lt; ApplicationRecord\nbelongs_to :survey_question\n\nvalidates_presence_of :answer_content, if: \"answer_type!=Radio Button\"\nend\n</code></pre>\n\n<p><strong>Survey_question Model</strong></p>\n\n<pre><code>class SurveyQuestion &lt; ApplicationRecord\nbelongs_to :user\nbelongs_to :survey\n\nhas_many :survey_answers\naccepts_nested_attributes_for :survey_answers, allow_destroy: true\n\nhas_many :survey_responses\naccepts_nested_attributes_for :survey_responses\n\nvalidates :question_content, presence: true\nvalidates :answer_type, presence:  true\nend\n</code></pre>\n\n<p>I just to validate presence of survey_answer's answer_content when survey_question's answer_type is \"Radio Button\" ? how can I achieve this ??\nthanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake", "rakefile"], "comments": [{"owner": {"reputation": 855, "user_id": 6013582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XGso5.png?s=128&g=1", "display_name": "s89_", "link": "https://stackoverflow.com/users/6013582/s89"}, "edited": false, "score": 0, "creation_date": 1526325046, "post_id": 50337340, "comment_id": 87691032, "body": "<a href=\"http://mikeballou.com/blog/2011/07/18/zsh-and-rake-parameters/\" rel=\"nofollow noreferrer\">mikeballou.com/blog/2011/07/18/zsh-and-rake-parameters</a> - may be a solution which I&#39;m looking into..."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1526325075, "post_id": 50337340, "comment_id": 87691051, "body": "You may need to escape the <code>[</code> char."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1526325116, "post_id": 50337340, "comment_id": 87691069, "body": "Or the <code>noglob</code> which you found, but then you need to explicitly allow globbing when you need it."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1526326021, "post_id": 50337340, "comment_id": 87691529, "body": "Basic OS stuff; odds are <code>noglob</code> won&#39;t affect you for running <code>rake</code> anyway."}], "answers": [{"tags": [], "owner": {"reputation": 855, "user_id": 6013582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XGso5.png?s=128&g=1", "display_name": "s89_", "link": "https://stackoverflow.com/users/6013582/s89"}, "is_accepted": true, "score": 0, "last_activity_date": 1526325457, "creation_date": 1526325457, "answer_id": 50337537, "question_id": 50337340, "link": "https://stackoverflow.com/questions/50337340/rails-rake-build-error/50337537#50337537", "title": "Rails - rake build error", "body": "<p>I found a solution. Add alias rake='noglob rake' in your .zshrc.</p>\n\n<p>Solution :- <a href=\"http://mikeballou.com/blog/2011/07/18/zsh-and-rake-parameters/\" rel=\"nofollow noreferrer\">http://mikeballou.com/blog/2011/07/18/zsh-and-rake-parameters/</a></p>\n"}], "owner": {"reputation": 855, "user_id": 6013582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XGso5.png?s=128&g=1", "display_name": "s89_", "link": "https://stackoverflow.com/users/6013582/s89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 50337537, "answer_count": 1, "score": 0, "last_activity_date": 1526325457, "creation_date": 1526324706, "question_id": 50337340, "link": "https://stackoverflow.com/questions/50337340/rails-rake-build-error", "title": "Rails - rake build error", "body": "<p>I'm setting up my dev environment for a new project, where the instructions use rake (something I've never used).</p>\n\n<p>I've just imported some JSON data into mongodb with </p>\n\n<pre><code>mongoimport --db mydevenvironment --port 27017 --collection places --file mydir/tmp/places.json\n</code></pre>\n\n<p>The next command is to use rake to build, as follows:</p>\n\n<pre><code>rake build:devenvironment_from_files[,,,,1/2/3/4/5/6/7/8/9/10/11/12/13/14/15/16/17/18/19,27017] --trace\n</code></pre>\n\n<p>I've found very little documentation anywhere online for the rake build command.  How does it work exactly, and what do the array of numbers signify? Are these file locations?</p>\n\n<p>The error I get is:</p>\n\n<pre><code>zsh: no matches found: build:devenvironment_from_files[,,,,1/2/3/4/5/6/7/8/9/10/11/12/13/14/15/16/17/18/19,27017]\n</code></pre>\n\n<p>But I've no idea where to start diagnosing this.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1526326046, "post_id": 50337305, "comment_id": 87691538, "body": "<code>gets</code> is a blocking function."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1526328821, "post_id": 50337305, "comment_id": 87692811, "body": "You need to ask the user for an input inside the loop, then break if a condition is met. For example instead of <code>sleep 1</code>. You can not change the value of a variable from outside the loop, if this is what you mean."}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1526331730, "post_id": 50337305, "comment_id": 87694176, "body": "Please don&#39;t edit solutions into your questions. If you think you&#39;ve found the answer, post it below as an answer and mark it &quot;accepted&quot; with the green checkmark by the voting buttons."}], "answers": [{"tags": [], "owner": {"reputation": 1854, "user_id": 669745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4b0416684de65970e4d1b4da1bb290?s=128&d=identicon&r=PG", "display_name": "Panic", "link": "https://stackoverflow.com/users/669745/panic"}, "is_accepted": true, "score": 1, "last_activity_date": 1526331550, "creation_date": 1526331550, "answer_id": 50338923, "question_id": 50337305, "link": "https://stackoverflow.com/questions/50337305/ruby-how-to-stop-a-loop-with-user-input/50338923#50338923", "title": "ruby how to stop a loop with user input?", "body": "<p>You don't really need another thread.</p>\n\n<pre><code>numbers = []\n\nputs 'Press ENTER to start'\nputs 'Press Ctrl-C to stop'\ngets\n\nloop do\n  numbers &lt;&lt; rand\n  sleep 1\nrescue Interrupt\n  puts\n  printf \"Count: %d\\n\", numbers.size\n  printf \"Mean: %f\\n\", numbers.sum / numbers.size\n\n  exit\nend\n</code></pre>\n\n<p>Requires Ruby >= 2.5</p>\n"}], "owner": {"reputation": 31, "user_id": 9777997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea729cacc5db63d02beded01113ec582?s=128&d=identicon&r=PG&f=1", "display_name": "Renato", "link": "https://stackoverflow.com/users/9777997/renato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 50338923, "answer_count": 1, "score": 0, "last_activity_date": 1526331701, "creation_date": 1526324566, "last_edit_date": 1526331701, "question_id": 50337305, "link": "https://stackoverflow.com/questions/50337305/ruby-how-to-stop-a-loop-with-user-input", "title": "ruby how to stop a loop with user input?", "body": "<p>I'm new to ruby and I'm trying to make a loop that outputs a random number between 0 and 1 every second until user hits any key. Then, output the total number of random numbers generated and the average value of the numbers generated. However, I can't make the loop to stop at all, is there anything like break to stop the loop in ruby?</p>\n\n<pre><code>def random\n    ran = []\n    puts \"Press 1 and 'enter' to start and 2 to stop \\n\"\n    s = gets.chomp\n    ran &lt;&lt; Random.rand(0.0...1.1)\n\n    ran.each do|i| \n      ran &lt;&lt; Random.rand(0.0...1.1)\n      puts i\n      sleep(1)\n    end\n\n    puts \"The total number of random numbers generated is: #{ran.length}\"\n\nend\nrandom\n</code></pre>\n"}, {"tags": ["ruby", "command-line", "path", "rubygems", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 949, "user_id": 906230, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/26cf4cf1d265e6dc6aa3f34b4f813898?s=128&d=identicon&r=PG", "display_name": "fullstackplus", "link": "https://stackoverflow.com/users/906230/fullstackplus"}, "edited": false, "score": 0, "creation_date": 1526369726, "post_id": 50337477, "comment_id": 87705099, "body": "OK, when I do <code>ls ~&#47;.gem&#47;ruby&#47;</code>I get to directories: 1.8 and 1.9.1. Of the two, only 1.8 has a <code>bin</code> directory in it. So I&#39;ve added <code>export PATH=~&#47;.gem&#47;ruby&#47;1.8&#47;bin:$PATH</code> to <code>.bash_profile</code>but still no effect."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 949, "user_id": 906230, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/26cf4cf1d265e6dc6aa3f34b4f813898?s=128&d=identicon&r=PG", "display_name": "fullstackplus", "link": "https://stackoverflow.com/users/906230/fullstackplus"}, "edited": false, "score": 1, "creation_date": 1526379586, "post_id": 50337477, "comment_id": 87711227, "body": "Then it seems you installed your gems somewhere else."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 2, "last_activity_date": 1526325208, "creation_date": 1526325208, "answer_id": 50337477, "question_id": 50336872, "link": "https://stackoverflow.com/questions/50336872/getting-the-bundler-gem-execuble-in-path/50337477#50337477", "title": "Getting the bundler gem execuble in $PATH", "body": "<blockquote>\n  <p>What's the path to the bundler gem executable then?</p>\n</blockquote>\n\n<p>It is listed in the documentation snippet you posted in your question as:</p>\n\n<pre><code>~/.gem/ruby/&lt;ruby version&gt;/bin\n</code></pre>\n\n<p>Note: replace <code>&lt;ruby version&gt;</code> with the library compatibility version (not the language version or the engine version!) of the implementation you are using.</p>\n"}, {"tags": [], "owner": {"reputation": 949, "user_id": 906230, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/26cf4cf1d265e6dc6aa3f34b4f813898?s=128&d=identicon&r=PG", "display_name": "fullstackplus", "link": "https://stackoverflow.com/users/906230/fullstackplus"}, "is_accepted": false, "score": 0, "last_activity_date": 1526408519, "creation_date": 1526408519, "answer_id": 50356910, "question_id": 50336872, "link": "https://stackoverflow.com/questions/50336872/getting-the-bundler-gem-execuble-in-path/50356910#50356910", "title": "Getting the bundler gem execuble in $PATH", "body": "<p>Running <code>gem environment</code> yielded this line, among others:</p>\n\n<blockquote>\n  <p>EXECUTABLE DIRECTORY: /usr/local/Cellar/ruby/2.4.1_1/bin</p>\n</blockquote>\n\n<p>From there, it was only a matter of adding the above path to the <code>$PATH</code> variable in <code>.bash_profile</code>.</p>\n"}], "owner": {"reputation": 949, "user_id": 906230, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/26cf4cf1d265e6dc6aa3f34b4f813898?s=128&d=identicon&r=PG", "display_name": "fullstackplus", "link": "https://stackoverflow.com/users/906230/fullstackplus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 50337477, "answer_count": 2, "score": 1, "last_activity_date": 1526408519, "creation_date": 1526322877, "question_id": 50336872, "link": "https://stackoverflow.com/questions/50336872/getting-the-bundler-gem-execuble-in-path", "title": "Getting the bundler gem execuble in $PATH", "body": "<p>I've installed Bundler 1.16.1 and am trying to configure my <code>$PATH</code> variable for using the <code>bundle</code> command. The <a href=\"https://github.com/bundler/bundler/blob/master/doc/TROUBLESHOOTING.md\" rel=\"nofollow noreferrer\">Bundler Troubleshooting Guide</a> says:</p>\n\n<blockquote>\n  <p>Note that you will need to append <code>~/.gem/ruby/&lt;ruby version&gt;/bin</code> to\n  your <code>$PATH</code> variable to use <code>bundle</code>.</p>\n</blockquote>\n\n<p>I'm unable to locate the <code>/bin</code> executable. Here's the output of some troubleshooting commands on my system:</p>\n\n<pre><code>$ which ruby\n/usr/local/bin/ruby\n$ which gem \n/usr/local/bin/gem\n$ gem which bundler\n/usr/local/Cellar/ruby/2.4.1_1/lib/ruby/gems/2.4.0/gems/bundler-1.16.1/lib/bundler.rb\n</code></pre>\n\n<p>Also, <code>echo $PATH</code> reveals that <code>/usr/local/bin/gem</code> is in the <code>$PATH</code> already.</p>\n\n<p>What's the path to the bundler gem executable then?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1526321142, "post_id": 50336381, "comment_id": 87689017, "body": "<code>to_i</code> does not mutate the object so <code>item.to_i</code> doesn&#39;t actually do anything in your application. This would need to be changed to <code>item = item.to_i</code>. Additionally <code>Array(answer)</code> also does nothing and <code>answer.is_a? Integer</code> will never be <code>true</code> and <code>str_test</code> will always be <code>false</code> once you cast and assign <code>item</code> using <code>item = item.to_i</code>. Oh yeah and your test will always fail."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1526321651, "post_id": 50336381, "comment_id": 87689297, "body": "There&#39;s a lot of really <i>odd</i> Ruby code going on here. If you&#39;re learning Ruby I&#39;d strongly recommend getting a reference book that has some consistency to it. An older version of the &quot;<a href=\"http://ruby-doc.com/docs/ProgrammingRuby/\" rel=\"nofollow noreferrer\">pickaxe book</a>&quot; is available online, the newer version <a href=\"https://pragprog.com/book/ruby4/programming-ruby-1-9-2-0\" rel=\"nofollow noreferrer\">for sale</a>. This book uses idiomatic Ruby where conventions are clearly communicated."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1526325533, "post_id": 50336381, "comment_id": 87691276, "body": "&quot;Can one of you guys help me figure out where it goes wrong?&quot; \u2013 Can you narrow this down a bit more? To be honest, there is pretty much not a single line of code in there that makes sense, so it is a bit hard to answer that question with anything else except &quot;Everywhere&quot;. It would be much better if you narrowed down your problem as much as possible into a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and ask about a concrete, specific problem and not &quot;where is it going wrong&quot;. In fact, the output is 100% correct, so in some sense, nowhere is it going wrong."}], "answers": [{"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": false, "score": 1, "last_activity_date": 1526322153, "creation_date": 1526322153, "answer_id": 50336704, "question_id": 50336381, "link": "https://stackoverflow.com/questions/50336381/converting-to-i-doesnt-work-ruby/50336704#50336704", "title": "Converting to_i doesn&#39;t work (Ruby)", "body": "<p>Assigning</p>\n\n<pre><code>item = item.to_i\n</code></pre>\n\n<p>Would fix the output in <code>tf</code>, but your returned answer would still be all strings. If you want to do this one by one like you're doing you would need to assign it back into the index of the array:</p>\n\n<pre><code>answer.each_with_index do |item, index|\n  answer[index] = item.to_i\nend\n</code></pre>\n\n<p>Though, an even better way to do this would be with <a href=\"https://ruby-doc.org/core/Array.html#method-i-map\" rel=\"nofollow noreferrer\"><code>map</code></a> (returns a new array) or <a href=\"https://ruby-doc.org/core/Array.html#method-i-map-21\" rel=\"nofollow noreferrer\"><code>map!</code></a> (in-place):</p>\n\n<pre><code># return this line (make it the last line in the method) or make sure\n# to re-assign answer\nanswer.map(&amp;:to_i)\n# or do this one to use `answer` later on with all integers.\nanswer.map!(&amp;:to_i)\n</code></pre>\n\n<p>(See <a href=\"https://stackoverflow.com/questions/14881125/what-does-to-proc-method-mean\">this question</a> about that <code>&amp;:to_i</code> syntax).</p>\n\n<p>It should also be noted (maybe), that Rubyists in general don't like <code>for</code> loops and prefer <code>each</code> loops.</p>\n\n<p>Also, the line:</p>\n\n<pre><code>Array(answer)\n</code></pre>\n\n<p>doesn't modify the <code>answer</code> in place, and returns it cast to an array, so the line is doing nothing:</p>\n\n<pre><code>a = \"1\"\nArray(a) # =&gt; [\"1\"]\na # =&gt; \"1\"\na = Array(a) # =&gt; [\"1\"]\na # =&gt; [\"1\"]\n</code></pre>\n\n<p>You also, don't even need to do this, since <code>answer</code> is already an array from where you <code>split</code> it (You could also have used <a href=\"https://ruby-doc.org/core/String.html#method-i-chars\" rel=\"nofollow noreferrer\"><code>chars</code></a> instead of <code>split(//)</code>). The line <code>unless answer.is_a?(Integer)</code> will thusly never be true.</p>\n\n<p>The last major thing, I see is that in newer versions of ruby, there's a built-in method to do all this, <a href=\"https://ruby-doc.org/core/Integer.html#method-i-digits\" rel=\"nofollow noreferrer\"><code>digits</code></a>:</p>\n\n<pre><code> 35231.digits # =&gt; [1, 3, 2, 5, 3]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9789986, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0UasjlsUn30/AAAAAAAAAAI/AAAAAAAAAVQ/XlhTWRcscxE/photo.jpg?sz=128", "display_name": "Zabieru", "link": "https://stackoverflow.com/users/9789986/zabieru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1526322153, "creation_date": 1526320726, "last_edit_date": 1526320922, "question_id": 50336381, "link": "https://stackoverflow.com/questions/50336381/converting-to-i-doesnt-work-ruby", "title": "Converting to_i doesn&#39;t work (Ruby)", "body": "<p>I'm pretty new to programming and i'm doing fundamentals on codewars.com and I'm having some trouble with this one. The objective is to take a group of integers, reverse them, and put them into an array. Here's my code. (I made the tf function to see what was going on in the code.)</p>\n\n<pre><code>def digitize(n)\n  answer = n.to_s.split(//).reverse!\n  def tf(it)\n    str_test = it.is_a? String\n    int_test = it.is_a? Integer\n    puts \"String: #{str_test}\"\n    puts \"Integer: #{int_test}\"\n  end\n  Array(answer)\n  unless answer.is_a? Integer\n    for item in answer\n      item.to_i\n      puts item\n      tf(item)\n    end\n  end\n  return answer\nend\n</code></pre>\n\n<p>Sample test:</p>\n\n<pre><code>Test.assert_equals(digitize(35231),[1,3,2,5,3])\n</code></pre>\n\n<p>When tested, it returns:</p>\n\n<pre><code>1\nString: true\nInteger: false\n3\nString: true\nInteger: false\n2\nString: true\nInteger: false\n5\nString: true\nInteger: false\n3\nString: true\nInteger: false\n</code></pre>\n\n<p>Can one of you guys help me figure out where it goes wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "highcharts"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1526517312, "post_id": 50336235, "comment_id": 87779551, "body": "Alternatively <code>first[key] ||= []</code> or <code>first[key] = [] unless first.key?(key)</code>"}], "tags": [], "owner": {"reputation": 5800, "user_id": 4287733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835e993afb1e20c1981dd6b8b59ded2d?s=128&d=identicon&r=PG", "display_name": "Nermin", "link": "https://stackoverflow.com/users/4287733/nermin"}, "is_accepted": true, "score": 1, "last_activity_date": 1526320219, "creation_date": 1526320219, "answer_id": 50336235, "question_id": 50336184, "link": "https://stackoverflow.com/questions/50336184/standardizing-two-hashes-to-include-same-keys/50336235#50336235", "title": "Standardizing two Hashes to include same keys", "body": "<pre><code>first_keys = first.keys\nsecond_keys = second.keys\nkeys = first_keys + second_keys\n\nkeys.uniq.each do |key|\n  first[key]  = [] if first[key].nil?\n  second[key] = [] if second[key].nil?\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1526475536, "post_id": 50336241, "comment_id": 87759005, "body": "@CarySwoveland But if you explicitly set it it to <code>nil</code> that key shows up in <code>keys</code> and iteration whereas if you don&#39;t, it doesn&#39;t."}], "tags": [], "owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "is_accepted": false, "score": 1, "last_activity_date": 1526320234, "creation_date": 1526320234, "answer_id": 50336241, "question_id": 50336184, "link": "https://stackoverflow.com/questions/50336184/standardizing-two-hashes-to-include-same-keys/50336241#50336241", "title": "Standardizing two Hashes to include same keys", "body": "<p>There's a lot of ways to do this as it's rather open-ended, but you could create a common <code>keys</code> array from the two hashes and iterate over that assigning <code>nil</code> to the hash at that <code>key</code>. I would do it specifically like this</p>\n\n<pre><code>keys = (first.keys + second.keys).uniq\nkeys.each do |key|\n  first[key] ||= nil\n  second[key] ||= nil\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1526331455, "last_edit_date": 1526331455, "creation_date": 1526328466, "answer_id": 50338247, "question_id": 50336184, "link": "https://stackoverflow.com/questions/50336184/standardizing-two-hashes-to-include-same-keys/50338247#50338247", "title": "Standardizing two Hashes to include same keys", "body": "<p>As you are graphing the data, presumably with months on the x-axis and days on the y-axis, I think it would be most convenient to iterate over a range of months that provides a minimal cover of the keys (months) contained in both hashes.</p>\n\n<pre><code>data = [{ 5=&gt;[3, 5, 11, 24], 6=&gt;[1, 7, 13, 30], 2=&gt;[4, 13, 18, 29] },\n        { 4=&gt;[6, 9, 19, 26], 5=&gt;[4, 8, 11, 22], 1=&gt;[1, 19, 22, 24] }]\n\nmonth_range = Range.new(*data.reduce([]) { |arr, h| arr | h.keys }.minmax)\n  #=&gt; 1..6\n</code></pre>\n\n<p>Note</p>\n\n<pre><code>a = data.reduce([]) { |arr, h| arr | h.keys }\n  #=&gt; [5, 6, 2, 4, 1]\nb = a.minmax\n  #=&gt; [1, 6]\nRange.new(*b)\n  #=&gt; Range.new(*[1, 6]) =&gt; Range.new(1, 6) =&gt; 1..6\n</code></pre>\n\n<p>I've represented the input as an arbitrary array of hashes, should there be more than two.</p>\n\n<p>For graphing, simply iterate over <code>month_range</code>, then for each month <code>m</code> iterate over the elements <code>h</code> of <code>data</code> (hashes) for which <code>h</code> has a key <code>m</code>, and plot the days in <code>h[m]</code>, if any (not \"no data\").</p>\n\n<pre><code>month_range.each do |m|\n  data.each do |h|\n    &lt;plot h[m]&gt; if h.has_key?(m) &amp;&amp; h[m].any?\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 9777408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6a3cda3ae7cbda8c7d98d3b5f66e44?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/9777408/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 50336235, "answer_count": 3, "score": 0, "last_activity_date": 1526370282, "creation_date": 1526320002, "last_edit_date": 1526370282, "question_id": 50336184, "link": "https://stackoverflow.com/questions/50336184/standardizing-two-hashes-to-include-same-keys", "title": "Standardizing two Hashes to include same keys", "body": "<p>I am looking to graph multiple series in a highcharts graph.  I have the following two variables</p>\n\n<pre><code>   first = {5 =&gt; [dates in here], 6 =&gt; [dates in here], etc}\n   second = {4 =&gt; [dates in here], 5 =&gt; [dates in here], etc}\n</code></pre>\n\n<p>The keys are the number associated with the months (4, April, 5, May, etc.)</p>\n\n<p>The problem I am running into is that The two hashes may not always have the same corresponding months.  So when I am graphing the data the first[5] is graphing next to second[4], and first[6] is graphing next to second[5] etc. </p>\n\n<p>How can I standardize the two variables so that they always contain the same keys even if it would look something like this:</p>\n\n<pre><code>   first = {4 =&gt; [no data], 5 =&gt; [dates in here], 6 =&gt; [dates in here], etc}\n   second = {4 =&gt; [dates in here], 5 =&gt; [dates in here], 6 =&gt; [no data], etc}\n</code></pre>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1526319179, "post_id": 50335953, "comment_id": 87688100, "body": "By &quot;carrots&quot; I presume you mean <code>&lt;&gt;</code> (angle brackets) and not \ud83e\udd55?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526319219, "post_id": 50335953, "comment_id": 87688114, "body": "Can you edit your question to include what you tried that only removed the characters, but didn&#39;t do what you wanted?"}, {"owner": {"reputation": 11, "user_id": 8922299, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b6c287879dbecfc176e68da4399c96e6?s=128&d=identicon&r=PG&f=1", "display_name": "Yeager", "link": "https://stackoverflow.com/users/8922299/yeager"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1526319532, "post_id": 50335953, "comment_id": 87688250, "body": "I have added it."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1526320302, "post_id": 50335953, "comment_id": 87688626, "body": "If you only want to remove the first instance of the pattern, consider using <code>String#sub</code> instead of <code>String#gsub</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8922299, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b6c287879dbecfc176e68da4399c96e6?s=128&d=identicon&r=PG&f=1", "display_name": "Yeager", "link": "https://stackoverflow.com/users/8922299/yeager"}, "edited": false, "score": 0, "creation_date": 1526320874, "post_id": 50336093, "comment_id": 87688894, "body": "Thanks, but what is the significance of this <code>^&gt;</code>. I&#39;m also wondering if I can do an <code>and</code> statement that would allow other things that must be replaced by nothing. For instance: I want to simplify this <code>body[&quot;text&quot;].gsub(&#47;&lt;[^&gt;]*&gt;&#47;, &#39;&#39;).gsub(&#47;[\\n]&#47;, &#39;&#39;).gsub(&#47;[,]&#47;, &#39;&#39;).chomp</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11, "user_id": 8922299, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b6c287879dbecfc176e68da4399c96e6?s=128&d=identicon&r=PG&f=1", "display_name": "Yeager", "link": "https://stackoverflow.com/users/8922299/yeager"}, "edited": false, "score": 1, "creation_date": 1526321207, "post_id": 50336093, "comment_id": 87689044, "body": "Inside of &quot;set notation&quot;, the <code>[...]</code> part in a regular expression, a leading caret (<code>^</code>) means &quot;inverse&quot;, as in <code>[^&gt;]</code> means &quot;any not angle close bracket character&quot;. This prevents the regular expression from going berserk when encountering text like <code>&quot;&lt;1&gt;A&lt;2&gt;B&lt;3&gt;C&quot;</code> and grabbing <code>&lt;1...3&gt;</code> as if that was one tag. The &quot;not&quot; part means it must stop at <code>1&gt;</code>."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1526319662, "creation_date": 1526319662, "answer_id": 50336093, "question_id": 50335953, "link": "https://stackoverflow.com/questions/50335953/remove-substring-between-certain-characters/50336093#50336093", "title": "Remove substring between certain characters", "body": "<p>Just a minor adjustment of your code is required:</p>\n\n<pre><code>File.open(\"Test_Tele\u00f3.txt\", \"a+\") do |somefile|\n  jdoc.fetch(\"messages\").each do |body|\n    ts = body[\"ts\"].to_i\n    somefile.puts body[\"text\"].gsub(/&lt;[^&gt;]*&gt;/, '').chomp \n  end\nend\n</code></pre>\n\n<p>I've also use the block-style <code>open</code> here since that will automatically close the file when the block completes. This helps avoid forgetting and leaving files open by accident.</p>\n"}], "owner": {"reputation": 11, "user_id": 8922299, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b6c287879dbecfc176e68da4399c96e6?s=128&d=identicon&r=PG&f=1", "display_name": "Yeager", "link": "https://stackoverflow.com/users/8922299/yeager"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526364187, "creation_date": 1526319096, "last_edit_date": 1526364187, "question_id": 50335953, "link": "https://stackoverflow.com/questions/50335953/remove-substring-between-certain-characters", "title": "Remove substring between certain characters", "body": "<p>I was wondering if there was a way to remove everything between two carrots from a string:</p>\n\n<pre><code>\"&lt;@000000&gt; I thought you said this would happen?\"\n</code></pre>\n\n<p>to get:</p>\n\n<pre><code>\"I thought you said this would happen?\"\n</code></pre>\n\n<p>I thought using global substitution would work. I attempted with this code:</p>\n\n<pre><code>somefile = File.open(\"Test_Tele\u00f3.txt\", \"a+\")\n  jdoc.fetch(\"messages\").each do |body|\n    ts = body[\"ts\"].to_i\n    somefile.puts body[\"text\"].gsub(/[&lt;]/, '').gsub(/[&gt;]/, '').chomp\n  end\n</code></pre>\n\n<p>And the output is:</p>\n\n<pre><code>@000000 I thought you said this would happen?\n</code></pre>\n\n<p>It only removed the carrots and not the between characters.</p>\n\n<p>Any advice?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9777997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea729cacc5db63d02beded01113ec582?s=128&d=identicon&r=PG&f=1", "display_name": "Renato", "link": "https://stackoverflow.com/users/9777997/renato"}, "edited": false, "score": 0, "creation_date": 1526317199, "post_id": 50335310, "comment_id": 87687122, "body": "Thanks, that was such an easy fix, but I have another question How can I save the maximun speed and return it in a statement like I have done?"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 31, "user_id": 9777997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea729cacc5db63d02beded01113ec582?s=128&d=identicon&r=PG&f=1", "display_name": "Renato", "link": "https://stackoverflow.com/users/9777997/renato"}, "edited": false, "score": 0, "creation_date": 1526317670, "post_id": 50335310, "comment_id": 87687382, "body": "@Renato Check the updated answer, i included an example."}, {"owner": {"reputation": 31, "user_id": 9777997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea729cacc5db63d02beded01113ec582?s=128&d=identicon&r=PG&f=1", "display_name": "Renato", "link": "https://stackoverflow.com/users/9777997/renato"}, "edited": false, "score": 0, "creation_date": 1526318221, "post_id": 50335310, "comment_id": 87687644, "body": "Thanks you so much, I was trying to do it with arrays and coulnd&#39;t get anything save into the array"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 31, "user_id": 9777997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea729cacc5db63d02beded01113ec582?s=128&d=identicon&r=PG&f=1", "display_name": "Renato", "link": "https://stackoverflow.com/users/9777997/renato"}, "edited": false, "score": 0, "creation_date": 1526318600, "post_id": 50335310, "comment_id": 87687812, "body": "@Renato You could use an array if you like; check the updated answer for an example."}], "tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": true, "score": 2, "last_activity_date": 1526318562, "last_edit_date": 1526318562, "creation_date": 1526316511, "answer_id": 50335310, "question_id": 50335036, "link": "https://stackoverflow.com/questions/50335036/ruby-travel-time/50335310#50335310", "title": "Ruby travel time", "body": "<p>You have an infinite loop here:</p>\n\n<pre><code>until distance &gt; 1000 do\n  speed = Random.rand(5...15)\n  distance = speed * 1\n  time = time + 1\nend\n</code></pre>\n\n<p>This loop will never ende because the biggest value <code>distance</code> can get is <code>15</code>, so i think you want to add to <code>distance</code>, not replace it; son try using <code>+=</code> instead of <code>=</code>:</p>\n\n<pre><code>until distance &gt; 1000 do\n  speed = Random.rand(5...15)\n  distance += speed * 1\n  time = time + 1\nend\n</code></pre>\n\n<p>Same goes for all loops in each case.</p>\n\n<blockquote>\n  <p>How can I save the maximum speed and return it in a statement like I\n  have done?</p>\n</blockquote>\n\n<p>One way to do it would be to add another variable (i.e. <code>max_speed</code>) and assign <code>speed</code> value to it whenever <code>speed</code> is greater than <code>max_speed</code>:</p>\n\n<pre><code>time = 0\ndistance = 0\nmax_speed = 0\n\nuntil distance &gt; 1000 do\n  speed = Random.rand(5...15)\n  max_speed = speed if speed &gt; max_speed\n  distance += speed * 1\n  time = time + 1\nend\n\nputs \"The maximum speed was #{max_speed} miles per hour\"\n</code></pre>\n\n<p>Another way would be to use an array (although i prefer the first option):</p>\n\n<pre><code>speed = []\n\nuntil distance &gt; 1000 do\n  speed &lt;&lt; Random.rand(5...15)\n  distance += speed.last * 1\n  time = time + 1\nend\n\nputs \"The maximum speed was #{speed.max} miles per hour\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1526316513, "creation_date": 1526316513, "answer_id": 50335311, "question_id": 50335036, "link": "https://stackoverflow.com/questions/50335036/ruby-travel-time/50335311#50335311", "title": "Ruby travel time", "body": "<p>You're not actually summing up the distance -  distance is never going to increase past 1000</p>\n\n<pre><code>until distance &gt; 1000 do\n  speed = Random.rand(5...15)\n  distance = speed * 1 # will never equal more than 15\n  time = time + 1\nend\n</code></pre>\n\n<p>You probably want</p>\n\n<pre><code>distance += speed * 1 # not sure why you're multiplying by 1 though\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1526318631, "creation_date": 1526318631, "answer_id": 50335848, "question_id": 50335036, "link": "https://stackoverflow.com/questions/50335036/ruby-travel-time/50335848#50335848", "title": "Ruby travel time", "body": "<p>As a style comment: don't use <code>case</code> statements as control flow like if/then statements. Just use them to set values, and move everything else out. This can eliminate a lot of redundant code. Example:</p>\n\n<pre><code>time = 0\ndistance = 0\nuntil distance &gt; 1000 do   \n  speed = case vehicle\n    when \"1\" then Random.rand(5...15)    #Bicycle\n    when \"2\" then Random.rand(20...70)   #Car\n    when \"3\" then Random.rand(400...600) #Plane\n    end\n  distance += speed * 1\n  time = time + 1\nend\nputs \"The number of hours it took to travel 1000 miles was #{time} hours\"\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9777997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea729cacc5db63d02beded01113ec582?s=128&d=identicon&r=PG&f=1", "display_name": "Renato", "link": "https://stackoverflow.com/users/9777997/renato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 50335310, "answer_count": 3, "score": 0, "last_activity_date": 1526318631, "creation_date": 1526315468, "question_id": 50335036, "link": "https://stackoverflow.com/questions/50335036/ruby-travel-time", "title": "Ruby travel time", "body": "<p>I'm new to ruby and I'm having a hard time trying to figure out how to calculate a random travel time until it passes 1000 miles. So far, I can't figure out why it doesn't output the results, it just stays with the user input. Help please</p>\n\n<pre><code>def travel_time()\n    printf \"Pick a vehicle: \\n\"\n    printf \"1.  Bicycle \\n\"\n    printf \"2.  Car \\n\"\n    printf \"3.  Jet Plane \\n\"\n    puts \"Choose 1-3: \\n\"\n    vehicle = gets.chomp\n\n  case vehicle\n    when \"1\"\n        #Bicycle: 5-15 miles per hour\n        time = 0\n        distance = 0\n        until distance &gt; 1000 do\n         speed = Random.rand(5...15)\n         distance = speed * 1\n         time = time + 1\n        end\n        puts \"The number of hours it took to travel 1000 miles was #{time} hours\"\n    when \"2\"\n        #Car: 20-70 miles per hour\n        time = 0\n        distance = 0\n        until distance &gt; 1000 do\n        speed = Random.rand(20...70)\n        distance = speed * 1\n        time = time + 1\n        end\n        puts \"The number of hours it took to travel 1000 miles was #{time} hours\"\n\n    when \"3\"\n        #Jet Plane: 400-600 miles per hour\n        time = 0\n        distance = 0\n        until distance &gt; 1000 do\n        speed = Random.rand(400...600)\n        distance = speed * 1\n        time = time + 1\n        end\n        puts \"The number of hours it took to travel 1000 miles was #{time} hours\"\n    end\nend\ntravel_time\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "puma", "capistrano3"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1526314888, "post_id": 50334669, "comment_id": 87685952, "body": "Generally if you have <code>shared_path</code> in a config file uploaded by capistrano, the config file would be a template that gets filled in - something like  <code>puma.rb.erb</code> which has <code>&lt;%= shared_path %&gt;</code> in it - Is your <code>puma.rb</code> a template before deploy?"}, {"owner": {"reputation": 366, "user_id": 9038679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71dff90952dfd25d3447a9466d790083?s=128&d=identicon&r=PG&f=1", "display_name": "Hipjea", "link": "https://stackoverflow.com/users/9038679/hipjea"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1526315027, "post_id": 50334669, "comment_id": 87686010, "body": "The puma.rb file in my Rails app is the default one. Running Capistrano gives <code>puma:check</code> <code>WARN  puma.rb NOT FOUND!</code> and it generates the puma.rb file in the remote server under the <code>shared</code> directory."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1526315515, "post_id": 50334669, "comment_id": 87686265, "body": "But that <code>puma.rb</code> is being created by something -- which Capistrano puma plugin are you using (and what version of it)"}], "answers": [{"comments": [{"owner": {"reputation": 366, "user_id": 9038679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71dff90952dfd25d3447a9466d790083?s=128&d=identicon&r=PG&f=1", "display_name": "Hipjea", "link": "https://stackoverflow.com/users/9038679/hipjea"}, "edited": false, "score": 0, "creation_date": 1526316745, "post_id": 50335263, "comment_id": 87686886, "body": "Thanks ! That was it, a newbie error... :) Works fine now !"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1526316830, "last_edit_date": 1526316830, "creation_date": 1526316310, "answer_id": 50335263, "question_id": 50334669, "link": "https://stackoverflow.com/questions/50334669/capistrano-puma-wont-start-due-to-shared-path/50335263#50335263", "title": "Capistrano Puma won&#39;t start due to &quot;shared_path&quot;", "body": "<p>After a quick reread of your question the issue immediately became apparent.  You're setting your puma settings that need to be interpolated with single quote strings, which disables interpolations - Any of the settings that include <code>#{...}</code> need to be surrounded with double quotes</p>\n\n<pre><code>set :puma_bind,       \"unix://#{shared_path}/tmp/sockets/puma_myapp.sock;\"\nset :puma_state,      \"#{shared_path}/tmp/pids/puma_myapp.state\"\nset :puma_pid,        \"#{shared_path}/tmp/pids/puma_myapp.pid\"\n...\n</code></pre>\n"}], "owner": {"reputation": 366, "user_id": 9038679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71dff90952dfd25d3447a9466d790083?s=128&d=identicon&r=PG&f=1", "display_name": "Hipjea", "link": "https://stackoverflow.com/users/9038679/hipjea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 50335263, "answer_count": 1, "score": 0, "last_activity_date": 1526316830, "creation_date": 1526314052, "question_id": 50334669, "link": "https://stackoverflow.com/questions/50334669/capistrano-puma-wont-start-due-to-shared-path", "title": "Capistrano Puma won&#39;t start due to &quot;shared_path&quot;", "body": "<p>I'm trying to build a Capistrano deployment script and it works so far except the Puma part : </p>\n\n<pre><code>set :puma_bind,       'unix://#{shared_path}/tmp/sockets/puma_myapp.sock;'\nset :puma_state,      '#{shared_path}/tmp/pids/puma_myapp.state'\nset :puma_pid,        '#{shared_path}/tmp/pids/puma_myapp.pid'\nset :puma_access_log, '#{release_path}/log/puma.error.log'\nset :puma_error_log,  '#{release_path}/log/puma.access.log'\nset :puma_conf,       \"#{shared_path}/puma.rb\"\nset :puma_threads,    [4, 16]\nset :puma_workers,    3\nset :puma_env, 'production'\nset :assets_roles, [:web, :app]\nset :rails_assets_groups, :assets\nset :keep_assets, 2\nappend :rbenv_map_bins, 'puma', 'pumactl'\n\nnamespace :puma do\n  desc 'create directories for Puma pids and socket'\n  task :make_dirs do\n    on roles(:app) do\n      execute \"mkdir #{shared_path}/tmp/sockets -p\"\n      execute \"mkdir #{shared_path}/tmp/pids -p\"\n    end\n  end\n\n  before :start, :make_dirs\nend\n</code></pre>\n\n<p>When I execute the script, it fails after the command <code>puma:start</code> giving the errors :</p>\n\n<pre><code>bundler: failed to load command: puma (/var/www/myapp/shared/bundle/ruby/2.5.0/bin/puma)\n  01 NameError: undefined local variable or method `shared_path' for #&lt;Puma::DSL:0x000055e752c4c018&gt;\n  01 Did you mean?  state_path\n</code></pre>\n\n<p>I looked a the shared/puma.rb conf that is uploaded to the server, and nothing seems curious, except the use of the <code>#{shared_path}</code> variable, that isn't defined in the puma.rb file :</p>\n\n<pre><code>#!/usr/bin/env puma\n\ndirectory '/var/www/myapp/current'\nrackup \"/var/www/myapp/current/config.ru\"\nenvironment 'production'\n\ntag ''\n\npidfile \"#{shared_path}/tmp/pids/puma.pid\"\nstate_path \"#{shared_path}/tmp/pids/puma.state\"\nstdout_redirect '#{release_path}/log/puma.error.log', '#{release_path}/log/puma.access.log', true\n\nthreads 0,16\n\nbind 'unix://#{shared_path}/tmp/sockets/puma_myapp.sock;'\n\nworkers 0\n\nprune_bundler\n\non_restart do\n  puts 'Refreshing Gemfile'\n  ENV[\"BUNDLE_GEMFILE\"] = \"\"\nend\n</code></pre>\n\n<p>Am I missing something ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "parsing", "hash"], "comments": [{"owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "edited": false, "score": 0, "creation_date": 1526314476, "post_id": 50334607, "comment_id": 87685751, "body": "What is the output of <code>row.has_key?(&quot;Strain&quot;)</code>. Also, have you tried iterating over the row with <code>each</code> and can you print out the key values for each element in the row? It does look like your code should work. Have you tried parsing the CSV in a regular IRB session without Rails? There may be something in your environment that&#39;s causing the oddity"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1526314543, "post_id": 50334607, "comment_id": 87685785, "body": "Does <code>row[row.headers.first]</code> return the correct result? What does <code>row.headers.first.bytes</code> look like? (also please add code as text (use the code formatting button for it) instead of as images)"}, {"owner": {"reputation": 51, "user_id": 9789038, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155263546177714/picture?type=large", "display_name": "Ian Brooks", "link": "https://stackoverflow.com/users/9789038/ian-brooks"}, "edited": false, "score": 0, "creation_date": 1526316180, "post_id": 50334607, "comment_id": 87686588, "body": "Leo - <code>row.has_key?(&quot;Strain&quot;)</code> returns <code>false</code> I&#39;m surprised, we can see &quot;Strain&quot; as one of the options. I haven&#39;t tried iterating over the row with each, I&#39;ll try that now. I also haven&#39;t tried plain IRB so I can give that a go as well.    Lime - <code>row[row.headers.first]</code> returns <code>&quot;818 Headband&quot;</code> which is surprising because <code>row.headers.first</code> returns <code>&quot;Strain&quot;</code> but <code>row[&quot;Strain&quot;]</code> still returns <code>nil</code>."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1526319525, "post_id": 50334607, "comment_id": 87688247, "body": "@IanBrooks what about <code>rows.headers.first.bytes</code> or <code>rows.headers.first.codepoints</code>? Those will tell you if there are any hidden/invisible characters in the header. If there are you&#39;ll need to <code>gsub</code> them out or delete the text in the original csv and retype it by hand to make sure nothing extra gets added"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 9789038, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155263546177714/picture?type=large", "display_name": "Ian Brooks", "link": "https://stackoverflow.com/users/9789038/ian-brooks"}, "is_accepted": true, "score": 2, "last_activity_date": 1526479739, "last_edit_date": 1526479739, "creation_date": 1526321919, "answer_id": 50336647, "question_id": 50334607, "link": "https://stackoverflow.com/questions/50334607/csvrow-and-hash-navigation-not-working-ruby-2-3-3-rails-5-1/50336647#50336647", "title": "CSV::Row and Hash navigation not working Ruby 2.3.3 Rails 5.1", "body": "<p>Simple Lime pointed me the right way! Thank you!</p>\n\n<p>The issue is that there are hidden characters that don't get rendered when the header is printed as a string. Thats why <code>csv.first[csv.headers.first]</code> works but <code>csv.first[\"Strain\"]</code> doesn't, even though <code>csv.headers.first</code> returns <code>\"Strain\"</code>. Presumably what its REALLY returning is something like <code>\"invisiblestuffStrain\"</code> (exaggerated but you get the idea).</p>\n\n<p>To check and see if this is the case for you, call the <code>.bytes</code> method on the header and then call <code>.bytes</code> again on the string value you expect e.g.<code>\"Strain\".bytes</code>. If there is any difference, you have hidden characters. </p>\n\n<p>Here is my actual console output:</p>\n\n<pre><code>$ csv.headers.first.bytes\n=&gt; [239, 187, 191, 83, 116, 114, 97, 105, 110]\n$ \"Strain\".bytes\n=&gt; [83, 116, 114, 97, 105, 110]\n</code></pre>\n\n<p>You can see 3 extra characters being stored for that object that don't get shown when it's rendered as a string.</p>\n\n<p>Simple Lime says: \"you'll need to <code>gsub</code> them out or delete the text in the original csv and retype it by hand to make sure nothing extra gets added\"</p>\n\n<p>For me I had to modify the <code>.csv</code> directly from my text editor insted of using excel and saving it as a <code>.csv</code>.</p>\n\n<p>Edit: I discovered that saving from an <code>.xlsx</code> workbook in MS Excel, to the <code>.csv</code> is what caused those strange characters to appear. I had to edit the file so I re-opend and re-saved and got that same error again when I re-seeded. Just as before, re-typing that first header from a text editor fixed the issue.</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 4960293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8890b77b4e8eead615b6f1a9dfd7b59?s=128&d=identicon&r=PG&f=1", "display_name": "Kalyani Kirad", "link": "https://stackoverflow.com/users/4960293/kalyani-kirad"}, "is_accepted": false, "score": 2, "last_activity_date": 1550972000, "last_edit_date": 1550972000, "creation_date": 1550952654, "answer_id": 54845737, "question_id": 50334607, "link": "https://stackoverflow.com/questions/50334607/csvrow-and-hash-navigation-not-working-ruby-2-3-3-rails-5-1/54845737#54845737", "title": "CSV::Row and Hash navigation not working Ruby 2.3.3 Rails 5.1", "body": "<p>You can use the gsub method to remove the extra invisible characters </p>\n\n<pre><code>gsub(\"\\xEF\\xBB\\xBF\",\"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4360, "user_id": 1868841, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ADiwD.jpg?s=128&g=1", "display_name": "Waqar UlHaq", "link": "https://stackoverflow.com/users/1868841/waqar-ulhaq"}, "edited": false, "score": 0, "creation_date": 1582822218, "post_id": 60437226, "comment_id": 106917752, "body": "Please don&#39;t post link only answers to other Stack Exchange questions. Instead, include the essential portions of the answer here, and <i>tailor the answer to this specific question.</i>"}], "tags": [], "owner": {"reputation": 1, "user_id": 12974309, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/afc2a7ac5ad963d2e8a6f4b706700f4e?s=128&d=identicon&r=PG", "display_name": "user12974309", "link": "https://stackoverflow.com/users/12974309/user12974309"}, "is_accepted": false, "score": 0, "last_activity_date": 1582819334, "creation_date": 1582819334, "answer_id": 60437226, "question_id": 50334607, "link": "https://stackoverflow.com/questions/50334607/csvrow-and-hash-navigation-not-working-ruby-2-3-3-rails-5-1/60437226#60437226", "title": "CSV::Row and Hash navigation not working Ruby 2.3.3 Rails 5.1", "body": "<p>The file contains a <a href=\"https://en.wikipedia.org/wiki/Byte_order_mark\" rel=\"nofollow noreferrer\">UTF-8 BOM</a>.</p>\n\n<p>There are a number of ways you can remove it. See answers on <a href=\"https://unix.stackexchange.com/questions/381230/how-can-i-remove-the-bom-from-a-utf-8-file\">How can I remove the BOM from a UTF-8 file?</a></p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 12099013, "user_type": "registered", "profile_image": "https://graph.facebook.com/2962237940473019/picture?type=large", "display_name": "Gabriel Gu&#233;rin", "link": "https://stackoverflow.com/users/12099013/gabriel-gu%c3%a9rin"}, "is_accepted": false, "score": 0, "last_activity_date": 1608732742, "creation_date": 1608732742, "answer_id": 65425689, "question_id": 50334607, "link": "https://stackoverflow.com/questions/50334607/csvrow-and-hash-navigation-not-working-ruby-2-3-3-rails-5-1/65425689#65425689", "title": "CSV::Row and Hash navigation not working Ruby 2.3.3 Rails 5.1", "body": "<p>I thought I had your problem too until I realized that Ruby did not split the columns properly. I am putting my solution here just in case others are stuck in the same situation. All I needed to add was the <code>col_sep</code> property as follows:\n<code>CSV.parse('file_name', headers: true, encoding: 'ISO-8859-1', col_sep: ';')</code></p>\n"}], "owner": {"reputation": 51, "user_id": 9789038, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155263546177714/picture?type=large", "display_name": "Ian Brooks", "link": "https://stackoverflow.com/users/9789038/ian-brooks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 816, "favorite_count": 0, "accepted_answer_id": 50336647, "answer_count": 4, "score": 2, "last_activity_date": 1608732742, "creation_date": 1526313755, "last_edit_date": 1526318420, "question_id": 50334607, "link": "https://stackoverflow.com/questions/50334607/csvrow-and-hash-navigation-not-working-ruby-2-3-3-rails-5-1", "title": "CSV::Row and Hash navigation not working Ruby 2.3.3 Rails 5.1", "body": "<p>I've parsed a csv using <code>CSV.parse</code> and am navigating it row by row. So the object we're looking at is a <code>CSV::Row</code> called <code>row</code> </p>\n\n<p>This is a screenshot of what happens when I try to navigate <code>row</code>:\n<a href=\"https://i.stack.imgur.com/AJozE.png\" rel=\"nofollow noreferrer\">screenshot</a></p>\n\n<p>As you can see I can call <code>.headers()</code> and as you'd expect <code>Strain</code> is in the list</p>\n\n<p>When you look at the object itself you can see <code>\"Strain\":\"818 Headband\"</code></p>\n\n<p>So <code>row['Strain']</code> should equal <code>8181 Headband</code> except it returns <code>nil</code></p>\n\n<p>Naturally I tried <code>row.Strain</code>, <code>row[\"Strain\"]</code>, <code>row[Strain]</code>,<code>row[:Strain]</code> none of which worked.</p>\n\n<p>I also considered that it might be contained with in a one-entry array so i tried <code>row[0]['Strain']</code> and that also returned <code>nil</code>, unsurprisingly.</p>\n\n<p>Assuming the issue was with the <code>CSV::Row</code> object, I called <code>row_hash = row.to_hash()</code> to get the object as a hash.</p>\n\n<p>now that we're in basic ruby of course normal calls like <code>row_hash['Strain']</code> will work right?!? Nope. still <code>nil</code>.\n<a href=\"https://i.stack.imgur.com/7S8M3.png\" rel=\"nofollow noreferrer\">a view of row_hash</a></p>\n\n<p>I'm so baffled, this isn't complex code at all. The docs for <code>Hash</code> and<code>CSV::Row</code> both list <code>[]</code> as a method and all the articles I've googled up list <code>row['key']</code> as the correct format...except it doesn't work for me. </p>\n\n<p>Please help, I have a series of these csvs that I need to seed a database with and I can't do that if I can't navigate the hash!!</p>\n\n<p>Edit 12:51pm 5/15/18: </p>\n\n<pre><code>csv.each do |row|\n  row.each do |key, value|\n    binding.pry\n  end\nend\n\n$ key\n=&gt; \"Strain\"\n$ value\n=&gt; \"818 Headband\"\n$ row[\"Strain\"]\n=&gt; nil\n</code></pre>\n\n<p>This can't be right...</p>\n\n<p>Edit 1:05pm 5/15/18:</p>\n\n<p><code>$ = irb(main)</code></p>\n\n<pre><code>$ csv_text = File.read('strain_data_formatted.csv')\n=&gt; ... (it dumped the whole csv to console)\n$ csv = CSV.parse(csv_text, :headers =&gt; true, :encoding =&gt; 'ISO-8859-1')\n=&gt; #&lt;CSV::Table mode:col_or_row row_count:118&gt;\n$ csv.first\n=&gt; #&lt;CSV::Row \"Strain\":\"818 Headband\" \"Subspecies\":nil \"Heritage\":nil... \n$ csv.first[\"Strain\"]\n=&gt; nil\n$ csv.headers.first\n=&gt; \"Strain\"\n$ csv.first[csv.headers.first]\n=&gt; \"818 Headband\"\n$ csv.headers.first.class\n=&gt; String\n$ \"Strain\".class\n=&gt; String\n$ csv.headers.first == \"Strain\"\n=&gt; false\n$ csv.headers.first\n=&gt; \"Strain\"\n</code></pre>\n\n<p>How is <code>csv.headers.first</code> a string with value \"Strain\" but it doesn't equal a string with value \"Strain\"?!? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526310478, "post_id": 50333462, "comment_id": 87683341, "body": "The test failures state that <code>User.new(email:&quot;fo0@hotmail.com&quot;)</code> and <code>Post.new(:ruby_meetup)</code> are invalid records. What are the errors? (have you looked at e.g. <code>@user.errors.messages</code>?) What are the <code>User</code> and <code>Post</code> models? Perhaps you have some other validation rule(s) in there, such as <code>validates :name, presence: true</code>? You haven&#39;t shown us the models, nor the error message, so I can only speculate what the cause might be."}, {"owner": {"reputation": 449, "user_id": 6324558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/695946b2499d7dcb2759724e66cfad38?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Delahaye", "link": "https://stackoverflow.com/users/6324558/alexis-delahaye"}, "edited": false, "score": 0, "creation_date": 1526310483, "post_id": 50333462, "comment_id": 87683342, "body": "<code>@post=Post.new(:ruby_meetup)</code> you are passing a Symbol as argument, whereas the constructor expect a hash, why are not affecting a value to this symbol ? for example <code>Post.new ruby_meetup: true</code> or <code>Post.new type: :ruby_meetup</code> , please put your code for Post model so we can help more precisely"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1526310488, "post_id": 50333462, "comment_id": 87683345, "body": "the first &quot;error&quot; is saying that you were expecting <code>@user.valid?</code> to be <code>true</code>, but it isn&#39;t. So, you might have some validations in your User model that require more than just the email. As for the second error, it comes from doing <code>Post.new(:ruby_meetup)</code>, <code>ruby_meetup</code> is a key, and <code>Post.new</code> expects a hash as parameter, just like what you did in <code>User.new(email:&quot;fo0@hotmail.com&quot;)</code>"}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1526310509, "post_id": 50333462, "comment_id": 87683366, "body": "<code>PostTest</code> tell you what you&#39;re doing wrong quite explicitly: &quot;When assigning attributes, you must pass a hash as an argument.&quot; <code>:ruby_meetup</code> is not a hash, you&#39;re missing the key."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "edited": false, "score": 0, "creation_date": 1526314413, "post_id": 50333462, "comment_id": 87685724, "body": "alright sorry about that I&#39;ve added both the post model and the user model."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "edited": false, "score": 0, "creation_date": 1526314432, "post_id": 50333628, "comment_id": 87685736, "body": "i&#39;ve now added the post model and user model thanks."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1526315274, "post_id": 50333628, "comment_id": 87686129, "body": "What did you get from <code>@user.errors.full_messages</code>? Did you change the <code>symbol</code> to a <code>hash</code> and did that resolve the second error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "edited": false, "score": 0, "creation_date": 1526317163, "post_id": 50333628, "comment_id": 87687107, "body": "I get a no method error when I put @user.errors.full_messages"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "edited": false, "score": 0, "creation_date": 1526318004, "post_id": 50333628, "comment_id": 87687538, "body": "lso for the second one I&#39;m getting an unknown attribute error.     @post=Post.new(ruby_meetup: &#39;true&#39;) This is how my code looks like maybe I&#39;ve coded it wrong? edit: I&#39;ve changed the code to look like this     @post=Post.new(user_id: &quot;1&quot;) and now I&#39;m getting the same error as my user.test"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "edited": false, "score": 0, "creation_date": 1526321085, "post_id": 50333628, "comment_id": 87688989, "body": "in my user_test.rb file?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "edited": false, "score": 0, "creation_date": 1526322896, "post_id": 50333628, "comment_id": 87689876, "body": "I&#39;m getting the same error message as before, Failure: UserTest#test_user_should_be_valid [/home/ubuntu/workspace/test/models/user_test.rb:9]: Expected false to be truthy."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1526323228, "post_id": 50333628, "comment_id": 87690058, "body": "In your console, you should see the output of your <code>puts</code> statement. In addition to the test error message that you are mentioning."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "edited": false, "score": 0, "creation_date": 1526323648, "post_id": 50333628, "comment_id": 87690283, "body": "Thats not the case, I&#39;m only getting the test error message."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 2, "last_activity_date": 1526310494, "creation_date": 1526310494, "answer_id": 50333628, "question_id": 50333462, "link": "https://stackoverflow.com/questions/50333462/rails-model-test-error-failure/50333628#50333628", "title": "Rails model test error/failure", "body": "<p>Since you don't show anything about your <code>User</code> model, it's impossible to know why it's not valid. But, in your test, you could do something like: </p>\n\n<pre><code>puts @user.errors.full_messages\n</code></pre>\n\n<p>And see what the problem is. </p>\n\n<p>On that second error, the error messages is telling you exactly what is wrong. You are not passing a <code>hash</code> in the <code>new</code>, you're passing a symbol:</p>\n\n<pre><code>def setup\n  @post=Post.new(:ruby_meetup)\nend\n</code></pre>\n\n<p><code>:ruby_meetup</code> should be something like:</p>\n\n<pre><code>ruby_meetup: 'some_value'\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "is_accepted": false, "score": 0, "last_activity_date": 1526329036, "creation_date": 1526329036, "answer_id": 50338394, "question_id": 50333462, "link": "https://stackoverflow.com/questions/50333462/rails-model-test-error-failure/50338394#50338394", "title": "Rails model test error/failure", "body": "<p>The error has been solved.  I put this code in my user_test.rb</p>\n\n<pre><code>assert @user.valid?, @user.errors.full_messages\n</code></pre>\n\n<p>and fixed the error which was I left the password empty.</p>\n\n<p>Thank you everyone for the help, I do appreciate it.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9601213"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 50333628, "answer_count": 2, "score": 1, "last_activity_date": 1526859611, "creation_date": 1526310007, "last_edit_date": 1526859611, "question_id": 50333462, "link": "https://stackoverflow.com/questions/50333462/rails-model-test-error-failure", "title": "Rails model test error/failure", "body": "<p>Let me start off with saying that I'm fairly new to testing in Rails. I'm getting some errors in my tests and I don't quite know why.</p>\n\n<pre><code>rails test:models\nRun options: --seed 21021\n\n# Running:\n\nF\n\nFailure:\nUserTest#test_user_should_be_valid [/home/ubuntu/workspace/test/models/user_test.rb:9]:\nExpected false to be truthy.\n\n\nbin/rails test test/models/user_test.rb:8\n\nE\n\nError:\nPostTest#test_post_should_be_valid:\nArgumentError: When assigning attributes, you must pass a hash as an argument.\n    test/models/post_test.rb:5:in `setup'\n\n\nbin/rails test test/models/post_test.rb:8\n\n\n\nFinished in 0.237740s, 8.4126 runs/s, 4.2063 assertions/s.\n2 runs, 1 assertions, 1 failures, 1 errors, 0 skips\n</code></pre>\n\n<p>Here's the code</p>\n\n<h1>user_test</h1>\n\n<pre><code>require 'test_helper'\n\nclass UserTest &lt; ActiveSupport::TestCase\n  def setup\n    @user=User.new(email:\"fo0@hotmail.com\")\n  end\n\n  test \"user should be valid\" do\n    assert @user.valid?\n  end\nend\n</code></pre>\n\n<h1>post_test</h1>\n\n<pre><code>require 'test_helper'\n\nclass PostTest &lt; ActiveSupport::TestCase\n  def setup\n    @post=Post.new(:ruby_meetup)\n  end\n\n  test \"post should be valid\" do\n    assert @post.valid?\n  end\n\nend\n</code></pre>\n\n<h1>user.rb</h1>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n         has_many :posts\n\n          has_many :rsvps\n          has_many :posts, through: :rsvps\n\n          validates :email, presence: true\n\nend\n</code></pre>\n\n<h1>post.rb</h1>\n\n<pre><code>class Post &lt; ApplicationRecord\nbelongs_to :user\n geocoded_by :address\nafter_validation :geocode, if: -&gt;(obj){ obj.address.present? and obj.address_changed? }\nreverse_geocoded_by :latitude, :longitude\nafter_validation :reverse_geocode\n\n\n  has_many :rsvps\n  has_many :users, through: :rsvps\n\n  validates :name, presence: true\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "minimagick"], "answers": [{"tags": [], "owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "is_accepted": false, "score": 0, "last_activity_date": 1526455952, "creation_date": 1526455952, "answer_id": 50364836, "question_id": 50333019, "link": "https://stackoverflow.com/questions/50333019/how-to-add-background-to-text-using-minimagickimage/50364836#50364836", "title": "How to add background to text using MiniMagick::Image", "body": "<p>This is how I could get the <code>background</code> property to work:</p>\n\n<pre><code>image = MiniMagick::Image.open(\"#{Rails.root}/a.png\")\n\nimage.combine_options do |c|\n  c.gravity 'center'\n  c.background 'lightgrey'\n  c.splice \"0x30\"\n  c.fill 'green'\n  c.pointsize 20\n  c.annotate '0', \"Hello I am here\"\n  c.annotate '0', \"#{Time.now}\"\nend\n\nimage.format 'pdf'\nimage.write(\"#{Rails.root}/b.pdf\")\n</code></pre>\n"}], "owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1526455952, "creation_date": 1526308774, "last_edit_date": 1526309312, "question_id": 50333019, "link": "https://stackoverflow.com/questions/50333019/how-to-add-background-to-text-using-minimagickimage", "title": "How to add background to text using MiniMagick::Image", "body": "<p>I'm writing some text on an image with the help of <strong>MiniMagick::Image</strong></p>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>image = MiniMagick::Image.open(\"#{Rails.root}/a.png\")\n\nimage.combine_options do |c|\n  c.fill 'green'\n  c.pointsize 20\n  c.gravity 'center'\n  c.draw \"text 0,-110 'Hello I am here'\"\n  c.draw \"text 150,-180 '#{Time.now}\"\n  c.background 'blue'\nend\n\nimage.format 'pdf'\nimage.write(\"#{Rails.root}/b.pdf\")\n</code></pre>\n\n<p>But, the background doesn't appear</p>\n\n<p>I have referred <a href=\"https://www.rubydoc.info/github/minimagick/minimagick/MiniMagick%2FImage%3Acombine_options\" rel=\"nofollow noreferrer\">LINK1</a> &amp; <a href=\"http://www.imagemagick.org/script/convert.php\" rel=\"nofollow noreferrer\">LINK2</a></p>\n"}]