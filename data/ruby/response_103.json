[{"tags": ["ruby", "regex", "file", "url"], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 7351912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86933d38d7248d6e56ecdb86d7587a07?s=128&d=identicon&r=PG", "display_name": "user7351912", "link": "https://stackoverflow.com/users/7351912/user7351912"}, "edited": false, "score": 0, "creation_date": 1482969434, "post_id": 41371365, "comment_id": 69944516, "body": "<code>Using a regular expression</code>"}, {"owner": {"reputation": 48, "user_id": 7351912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86933d38d7248d6e56ecdb86d7587a07?s=128&d=identicon&r=PG", "display_name": "user7351912", "link": "https://stackoverflow.com/users/7351912/user7351912"}, "edited": false, "score": 0, "creation_date": 1482970694, "post_id": 41371365, "comment_id": 69944883, "body": "What does the <code>match[8]</code> part do?"}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "reply_to_user": {"reputation": 48, "user_id": 7351912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86933d38d7248d6e56ecdb86d7587a07?s=128&d=identicon&r=PG", "display_name": "user7351912", "link": "https://stackoverflow.com/users/7351912/user7351912"}, "edited": false, "score": 0, "creation_date": 1482970964, "post_id": 41371365, "comment_id": 69944939, "body": "It gets the 8th capture group, which happens to be query part."}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 1, "last_activity_date": 1482969631, "last_edit_date": 1482969631, "creation_date": 1482969388, "answer_id": 41371365, "question_id": 41371323, "link": "https://stackoverflow.com/questions/41371323/how-to-verify-if-a-url-has-a-get-parameter-using-a-regex/41371365#41371365", "title": "How to verify if a URL has a GET parameter using a regex", "body": "<p>You mean whether it has query parameters?</p>\n\n<pre><code>require 'uri'\n\nif URI('http://fakesite.net/php').query\n  ...\nend\n</code></pre>\n\n<p>If you insist on using a regexp use this</p>\n\n<pre><code>match = URI.regexp.match('http://fakesite.net/php?id=2')\nif match[8]\n  ...\nend\n</code></pre>\n\n<p>You can print the regular expression with</p>\n\n<pre><code>puts URI.regexp\n</code></pre>\n\n<p>It is looooooong, you best just use the <code>URI</code> class. </p>\n"}], "owner": {"reputation": 48, "user_id": 7351912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86933d38d7248d6e56ecdb86d7587a07?s=128&d=identicon&r=PG", "display_name": "user7351912", "link": "https://stackoverflow.com/users/7351912/user7351912"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 41371365, "answer_count": 1, "score": 0, "last_activity_date": 1482969631, "creation_date": 1482969090, "question_id": 41371323, "link": "https://stackoverflow.com/questions/41371323/how-to-verify-if-a-url-has-a-get-parameter-using-a-regex", "title": "How to verify if a URL has a GET parameter using a regex", "body": "<p>I have a file containing a bunch of random URLs:</p>\n\n<pre><code>https://google.com\nhttp://fakesite.net/php?id=2\nhttps://example.com/\nhttp://anotherexample.com/pho?admin=2\n</code></pre>\n\n<p>How can I verify that the URL contains a GET parameter and not a POST using a regular expression?</p>\n"}, {"tags": ["ruby", "block"], "answers": [{"tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": false, "score": 4, "last_activity_date": 1482973079, "last_edit_date": 1482973079, "creation_date": 1482969852, "answer_id": 41371433, "question_id": 41371266, "link": "https://stackoverflow.com/questions/41371266/implement-to-s2-with-stringto-proc-in-ruby/41371433#41371433", "title": "Implement to_s(2) with String#to_proc in Ruby", "body": "<p>Just write this</p>\n\n<pre><code>[2, 4, 6, 8].map { |each| each.to_s(2) }\n</code></pre>\n\n<p>Though I guess that is not what you're looking for \u2026</p>\n\n<p>Here is how <code>Symbol#to_proc</code> is implemented. </p>\n\n<pre><code>class Symbol\n  def to_proc\n    proc { |each| each.send(self) }\n  end\nend\n</code></pre>\n\n<p>If you want you can define <code>to_proc</code> on an Array as follows</p>\n\n<pre><code>class Array\n  def to_proc\n    symbol, *args = self\n    proc { |each| each.send(symbol, *args) }\n  end\nend\n</code></pre>\n\n<p>And then use</p>\n\n<pre><code>[2, 4, 6, 8].map(&amp;[:to_s, 2])\n</code></pre>\n\n<p>Another alternative is using <code>curry</code>.</p>\n\n<p>Though that does not work with bound methods, so you'll have to define a <code>to_s</code> lambda function first.</p>\n\n<pre><code>to_s = lambda { |n, each| each.to_s(n) }\n\n[2, 4, 6, 8].map(&amp;to_s.curry[2])\n</code></pre>\n\n<p>Though all of that seems more like academic exercises.</p>\n"}, {"comments": [{"owner": {"reputation": 6391, "user_id": 2909897, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LMSiW.jpg?s=128&g=1", "display_name": "mbigras", "link": "https://stackoverflow.com/users/2909897/mbigras"}, "edited": false, "score": 0, "creation_date": 1483034460, "post_id": 41371595, "comment_id": 69971958, "body": "So in the context of <code>a.map(&amp;:+.(2))</code> &quot;caller&quot; refers to <code>1,3,5,7,9</code> (each are Fixnums) and they are being sent a message that is <code>self</code> because it refers to the symbol <code>:+</code>? It has nothing to do with <code>Kernel#caller</code> correct? Also, can you elaborate on why both <code>*args</code> and <code>*rest</code> exist?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 6391, "user_id": 2909897, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LMSiW.jpg?s=128&g=1", "display_name": "mbigras", "link": "https://stackoverflow.com/users/2909897/mbigras"}, "edited": false, "score": 0, "creation_date": 1483034822, "post_id": 41371595, "comment_id": 69972127, "body": "<code>caller</code> is just a variable name, it&#39;s not the Kernel method. In the <code>a.map</code> example <code>caller</code> is a single element of the array. Each element has the proc called. If you say <code>1.tap(&amp;:class)</code> caller will be <code>1</code>. With <code>[1].map(&amp;:class)</code> caller is the number <code>1</code>, not the array. Honestly I&#39;m not sure what the <code>rest</code> does (i copied that code). It seems to work just fine if you remove it."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 2, "last_activity_date": 1483029768, "last_edit_date": 1495535433, "creation_date": 1482971030, "answer_id": 41371595, "question_id": 41371266, "link": "https://stackoverflow.com/questions/41371266/implement-to-s2-with-stringto-proc-in-ruby/41371595#41371595", "title": "Implement to_s(2) with String#to_proc in Ruby", "body": "<p>The problem with your approach is that there's no way to deduce the type of the argument when it's always passed as a string.</p>\n\n<p>By the way, to address your question:</p>\n\n<blockquote>\n  <p>How do the [2, 4, 6, 8] values get into the proc that String#to_proc returns?</p>\n</blockquote>\n\n<p>They are <code>some_arg</code> here, which is not a variable you have to define but instead is a parameter that is automatically passed when the proc is called. </p>\n\n<p>Here's a rewriting of the String patch and some usage examples:</p>\n\n<pre><code>class String\n  def to_proc\n    fn, *args = split ' '\n    -&gt;(obj) { obj.send(fn.to_sym, *args) }\n  end\nend\n</code></pre>\n\n<p>This works for the following example:</p>\n\n<pre><code>p result = [[1,2,3]].map(&amp;\"join -\")\n# =&gt; ['1-2-3']\n</code></pre>\n\n<p>but fails for this (your example):</p>\n\n<pre><code>p result = [2, 4, 6, 8].map(&amp;'to_s 2')\n# =&gt; TypeError\n</code></pre>\n\n<p>The problem is <code>to_s('2')</code> is being called, when the 2 should be an integer, not a string. I can't think of any way to get around this except for maybe some serialization (although one of the other answers shows how <code>eval</code> can work).</p>\n\n<p>Now that the limitations of this approach are clear, it's worth comparing it to the more commonly used patch on Symbol to enable argument passing to proc shorthands (this taken from <a href=\"https://stackoverflow.com/questions/23695653/can-you-supply-arguments-to-the-mapmethod-syntax-in-ruby\">can-you-supply-arguments-to-the-mapmethod-syntax-in-ruby</a>)</p>\n\n<pre><code>class Symbol\n  def call(*args, &amp;block)\n    -&gt;(caller, *rest) { caller.send(self, *rest, *args, &amp;block) }\n  end\nend\n\na = [1,3,5,7,9]\na.map(&amp;:+.(2))\n# =&gt; [3, 5, 7, 9, 11] \n</code></pre>\n\n<p>This way you can pass any type of arguments to the proc, not just strings.</p>\n\n<p>Once you've defined it, you can easily swap out String for Symbol:</p>\n\n<pre><code>class String\n  def call(*args, &amp;blk)\n    to_sym.call(*args, &amp;blk)\n  end\nend\n\nputs [1,2,3].map(&amp;'+'.(1))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": true, "score": 3, "last_activity_date": 1482971206, "creation_date": 1482971206, "answer_id": 41371617, "question_id": 41371266, "link": "https://stackoverflow.com/questions/41371266/implement-to-s2-with-stringto-proc-in-ruby/41371617#41371617", "title": "Implement to_s(2) with String#to_proc in Ruby", "body": "<p>When you run <code>some_method(&amp;some_obj)</code>, Ruby first call the <code>some_obj.to_proc</code> to get a proc, then it \"converts\" that proc to a block and passes that block to <code>some_method</code>. So how the arguments go into the proc depends on how <code>some_method</code> passes arguments to the block.</p>\n\n<p>For example, as you defined <code>String#to_proc</code>, which returns a <code>proc{|arg| ...}</code> (a proc with one argument), and calls <code>[...].map(&amp;'to_s 2')</code>, Ruby interprets it as </p>\n\n<pre><code>[...].map(&amp;('to_s 2'.to_proc))\n</code></pre>\n\n<p>which is</p>\n\n<pre><code>[...].map(&amp;proc{|arg| ... })\n</code></pre>\n\n<p>and finally</p>\n\n<pre><code>[...].map {|arg| ... }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 1, "last_activity_date": 1483031193, "last_edit_date": 1495535433, "creation_date": 1482975530, "answer_id": 41372064, "question_id": 41371266, "link": "https://stackoverflow.com/questions/41371266/implement-to-s2-with-stringto-proc-in-ruby/41372064#41372064", "title": "Implement to_s(2) with String#to_proc in Ruby", "body": "<h1>Refactored code</h1>\n\n<p>You're free to choose the name for the proc block variable. So it could be <code>yet_another_arg</code>, <code>some_arg</code> or <code>something_else</code>. In this case, the object you're passing to <code>to_proc</code> is actually the object you want to <a href=\"https://stackoverflow.com/a/916621/6419007\">receive</a> the proc call, so you could call it <code>receiver</code>. The method and param are in the String, so you get them with <a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-split\" rel=\"nofollow noreferrer\"><code>String#split</code></a> from <code>self</code>.</p>\n\n<pre><code>class String\n  def to_proc\n    proc do |receiver|\n      method_name, param = self.split\n      receiver.method(method_name.to_sym).call(param.to_i)\n    end\n  end\nend\n\np result = [2, 4, 6, 8].map(&amp;'to_s 2')\n# =&gt; [\"10\", \"100\", \"110\", \"1000\"]\n</code></pre>\n\n<p>Note that this method has been tailored to accept one method name and one integer argument. It doesn't work in the general case.</p>\n\n<h1>Another possibility</h1>\n\n<h3>Warning</h3>\n\n<p><a href=\"https://stackoverflow.com/questions/637421/is-eval-supposed-to-be-nasty\">eval</a> is <a href=\"http://archive.oreilly.com/pub/a/ruby/excerpts/ruby-best-practices/worst-practices.html\" rel=\"nofollow noreferrer\">evil</a></p>\n\n<h3>You've been warned</h3>\n\n<p>This works with the exact syntax you wanted, and it also works for a wider range of methods and parameters :</p>\n\n<pre><code>class String\n  def to_proc\n    proc { |x| eval \"#{x.inspect}.#{self}\" }\n  end\nend\n\np [2, 4, 6, 8].map(&amp;'to_s 2')\n#=&gt; [\"10\", \"100\", \"110\", \"1000\"]\np [\"10\", \"100\", \"110\", \"1000\"].map(&amp;'to_i 2')\n#=&gt; [2, 4, 6, 8]\np [1, 2, 3, 4].map(&amp;'odd?')\n#=&gt; [true, false, true, false]\np %w(a b c).map(&amp;'*3')\n#=&gt; [\"aaa\", \"bbb\", \"ccc\"]\np [[1,2,3],[1,2],[1]].map(&amp;'map(&amp;\"*2\")')\n#=&gt; [[2, 4, 6], [2, 4], [2]]\n</code></pre>\n\n<p>It also brings security problems, though. With great power comes great responsibility!</p>\n"}], "owner": {"reputation": 6391, "user_id": 2909897, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LMSiW.jpg?s=128&g=1", "display_name": "mbigras", "link": "https://stackoverflow.com/users/2909897/mbigras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "accepted_answer_id": 41371617, "answer_count": 4, "score": 3, "last_activity_date": 1483031193, "creation_date": 1482968617, "last_edit_date": 1495541915, "question_id": 41371266, "link": "https://stackoverflow.com/questions/41371266/implement-to-s2-with-stringto-proc-in-ruby", "title": "Implement to_s(2) with String#to_proc in Ruby", "body": "<p>I'm learning about the unary operator, <code>&amp;</code>.</p>\n\n<p>There are some great questions about using <code>&amp;</code> in the parameters of a method invocation. Usually the format goes something like <code>some_obj.some_method(&amp;:symbol)</code>:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/38130526/ruby-unary-operator-only-valid-on-method-arguments\">Ruby unary operator <code>&amp;</code> only valid on method arguments</a></li>\n<li><a href=\"https://stackoverflow.com/questions/9429819/what-is-the-functionality-of-operator-in-ruby\">What is the functionality of \u201c&amp;: \u201d operator in ruby?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/1217088/what-does-mapname-mean-in-ruby\">What does map(&amp;:name) mean in Ruby?</a></li>\n<li><a href=\"https://stackoverflow.com/a/37058497/2909897\">Unary Ampersand Operator and passing procs as arguments in Ruby</a></li>\n</ul>\n\n<p>It seems like the main idea is ruby calls the <code>to_proc</code> method on <code>:symbol</code> when the unary operator is placed in front of the symbol. Because <code>Symbol#to_proc</code> exists \"everything works\".</p>\n\n<p>I'm still confused about how everything just works.</p>\n\n<p>What if I want to implement a \"to_proc sort of functionality with a string\". I'm putting it in quotes because I'm not really sure how to even talk about what I'm trying to do.</p>\n\n<p>But the goal is to write a <code>String#to_proc</code> method such that the following works:</p>\n\n<pre><code>class String\n  def to_proc # some args?\n    Proc.new do\n      # some code?\n    end\n  end\nend\np result = [2, 4, 6, 8].map(&amp;'to_s 2')\n#=&gt; [\"10\", \"100\", \"110\", \"1000\"]\n</code></pre>\n\n<p>This is how I did it:</p>\n\n<pre><code>class String\n  def to_proc\n    Proc.new do |some_arg|\n      parts = self.split(/ /)\n      some_proc = parts.first.to_sym.to_proc\n      another_arg = parts.last.to_i\n      some_proc.call(some_arg, another_arg)\n    end\n  end\nend\np result = [2, 4, 6, 8].map(&amp;'to_s 2')\n#=&gt; [\"10\", \"100\", \"110\", \"1000\"]\n</code></pre>\n\n<p>The main part I'm confused about is how I get the parameters into the <code>String#to_proc</code> method. It seems like:</p>\n\n<pre><code>def to_proc\n  Proc.new do |some_arg| ...\nend\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>def to_proc some_arg\n  Proc.new do |yet_another_arg| ...\nend\n</code></pre>\n\n<p>Or something like that. How do the <code>[2, 4, 6, 8]</code> values get into the proc that <code>String#to_proc</code> returns?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "git", "heroku"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1482965053, "post_id": 41370655, "comment_id": 69943214, "body": "<code>nokogiri-1.7.0 requires ruby version &gt;= 2.1.0, which is incompatible with the        current version, ruby 2.0.0p648</code>"}, {"owner": {"reputation": 31, "user_id": 4368695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3324e0ef5256b3dfe5cd90e41e592800?s=128&d=identicon&r=PG&f=1", "display_name": "neinx", "link": "https://stackoverflow.com/users/4368695/neinx"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1482965461, "post_id": 41370655, "comment_id": 69943351, "body": "yea, i know that&#39;s the issue, but here&#39;s my problem, if i update ruby the app seems to break in other areas, so it&#39;s a lot more headache to deal with, and i don&#39;t have nokogiri in my gemfile, it&#39;s just a dependency in gemfile.lock. and i really don&#39;t know what to do to fix it"}, {"owner": {"reputation": 459, "user_id": 6859623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d763ef30fff1f0bedf896dd1c0ce71a?s=128&d=identicon&r=PG&f=1", "display_name": "angkiki", "link": "https://stackoverflow.com/users/6859623/angkiki"}, "edited": false, "score": 0, "creation_date": 1482965914, "post_id": 41370655, "comment_id": 69943466, "body": "You could set a version restriction on nokogiri in your gemfile"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7355937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63e9989688172925e165ad16441e662?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Palumbi", "link": "https://stackoverflow.com/users/7355937/anthony-palumbi"}, "is_accepted": false, "score": 2, "last_activity_date": 1483052600, "creation_date": 1483052600, "answer_id": 41388406, "question_id": 41370655, "link": "https://stackoverflow.com/questions/41370655/cannot-push-to-heroku-since-latest-nokogiri-gem-update/41388406#41388406", "title": "Cannot push to heroku since latest Nokogiri gem update", "body": "<p>You can update your gemfile to a version that is compatible:\nfor example:</p>\n\n<p>gem 'nokogiri', '~> 1.5.9'</p>\n"}], "owner": {"reputation": 31, "user_id": 4368695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3324e0ef5256b3dfe5cd90e41e592800?s=128&d=identicon&r=PG&f=1", "display_name": "neinx", "link": "https://stackoverflow.com/users/4368695/neinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483052600, "creation_date": 1482964308, "question_id": 41370655, "link": "https://stackoverflow.com/questions/41370655/cannot-push-to-heroku-since-latest-nokogiri-gem-update", "title": "Cannot push to heroku since latest Nokogiri gem update", "body": "<p>Everything seemed to be fine until Nokogiri gem update in Dec 27 2016, this is what it says in heroku logs and i can't seem to find out how to solve it. it works on development, it just doesn't push to heroku. Thank you in advance</p>\n\n<pre><code>    enter code here.\n-----&gt; Ruby app detected\n-----&gt; Compiling Ruby/Rails\n-----&gt; Using Ruby version: ruby-2.0.0\n###### WARNING:\n       Removing `Gemfile.lock` because it was generated on Windows.\n       Bundler will do a full resolve so native gems are handled properly.\n       This may result in unexpected gem versions being used in your app.\n       In rare occasions Bundler may not be able to resolve your dependencies at all.\n       https://devcenter.heroku.com/articles/bundler-windows-gemfile\n-----&gt; Installing dependencies using bundler 1.13.6\n       Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin -j4\n       Fetching gem metadata from https://rubygems.org/..........\n       Fetching version metadata from https://rubygems.org/..\n       Fetching dependency metadata from https://rubygems.org/.\n       Resolving dependencies...\n       nokogiri-1.7.0 requires ruby version &gt;= 2.1.0, which is incompatible with the\n       current version, ruby 2.0.0p648\n       Bundler Output: Fetching gem metadata from https://rubygems.org/..........\n       Fetching version metadata from https://rubygems.org/..\n       Fetching dependency metadata from https://rubygems.org/.\n       Resolving dependencies...\n       nokogiri-1.7.0 requires ruby version &gt;= 2.1.0, which is incompatible with the\n       current version, ruby 2.0.0p648\n !\n !     Failed to install gems via Bundler.\n !\n !     Push rejected, failed to compile Ruby app.\n !     Push failed\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "rspec", "devise"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1482992610, "post_id": 41370623, "comment_id": 69950039, "body": "Can&#39;t you use <code>sign_in @user</code> in <code>before(:each)</code> block?"}], "answers": [{"tags": [], "owner": {"reputation": 708, "user_id": 3122676, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8010ad2ee7c8b7a109b6679699c0b20e?s=128&d=identicon&r=PG&f=1", "display_name": "fossil", "link": "https://stackoverflow.com/users/3122676/fossil"}, "is_accepted": false, "score": 0, "last_activity_date": 1484210799, "last_edit_date": 1484210799, "creation_date": 1484210210, "answer_id": 41608434, "question_id": 41370623, "link": "https://stackoverflow.com/questions/41370623/rspec-authenticating-before-test-with-devise-auth-token/41608434#41608434", "title": "RSpec: Authenticating before test with devise_auth_token", "body": "<p>You can use a helper method </p>\n\n<pre><code>#/spec/support/helpers/session_helper.rb\nmodule SessionHelper\n\n  def set_request_headers(resp)\n    { 'ACCEPT' =&gt; \"application/json\",\n      'Content-Type' =&gt; \"application/json\",\n      'access-token' =&gt; resp['access-token'],\n      'token-type' =&gt; resp['token-type'],\n      'client' =&gt; resp['client'],\n      'expiry' =&gt; resp['expiry'],\n      'uid' =&gt; resp['uid']\n    }\n  end\n\n  def subdomain_login(uid, password, subdomain)\n    request_params = {\n      'email' =&gt; uid,\n      'password' =&gt; password\n    }\n    host! \"#{subdomain}.lvh.me\"\n    post \"/portal/auth/sign_in\", params: request_params\n    return set_request_headers(response.headers)\n  end\nend\n</code></pre>\n\n<p>Make sure you have the following entry in your <code>/spec/rails_helper</code></p>\n\n<pre><code>Dir[Rails.root.join('spec/support/**/*.rb')].each { |f| require f }\nRSpec.configure do |config|\n config.include SessionHelper, :type =&gt; :request\nend\n</code></pre>\n\n<p>You can use <code>subdomain_login</code> in your tests. Here is an Rspec example.</p>\n\n<pre><code>post '/portal/system/locations', params: request_params.to_json,\n  headers: subdomain_login(user_id, password, subdomain)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6157853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/928af5ef3d076356d94569dea4e2e48e?s=128&d=identicon&r=PG&f=1", "display_name": "A. Bright", "link": "https://stackoverflow.com/users/6157853/a-bright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 685, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484210799, "creation_date": 1482964149, "question_id": 41370623, "link": "https://stackoverflow.com/questions/41370623/rspec-authenticating-before-test-with-devise-auth-token", "title": "RSpec: Authenticating before test with devise_auth_token", "body": "<p>I am using <a href=\"https://github.com/lynndylanhurley/devise_token_auth\" rel=\"nofollow noreferrer\">devise_auth_token</a> to authenticate users for an API. I would like to authenticate users before each test is run, but keep getting a 401 error. When I use postman to the endpoint with the correct headers, it works, but fails to work during tests.</p>\n\n<pre><code>before(:each) do\n    @user = FactoryGirl.create(:user)\nend\n\ndef get_auth\n  headers = @user.create_new_auth_token\n  auth = Hash.new\n  auth[\"client\"] = headers[\"client\"]\n  auth[\"access-token\"] = headers[\"access-token\"]\n  auth[\"uid\"] = headers[\"uid\"]\n  auth[\"expiry\"] = headers[\"expiry\"]\n  return auth\nend\n\nit \"auth user should return success\" do\n    get 'get_tasks_for_user', params: {uid: @user.uid}, headers: get_auth\n    expect(response).to have_http_status(200)\nend\n</code></pre>\n\n<p>RSpec</p>\n\n<pre><code>TasksController auth user should return success\n     Failure/Error: expect(response).to have_http_status 200\n       expected the response to have status code 200 but it was 401\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite"], "comments": [{"owner": {"reputation": 4219, "user_id": 539149, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/50d4553da2590287def72a6a6d96e3e2?s=128&d=identicon&r=PG", "display_name": "Zack Morris", "link": "https://stackoverflow.com/users/539149/zack-morris"}, "edited": false, "score": 0, "creation_date": 1498242046, "post_id": 41370565, "comment_id": 76437960, "body": "I&#39;m having the exact same problem trying to install <code>gem install sequel mysql sqlite3</code> so I can convert from mysql to sqlite like in <a href=\"https://stackoverflow.com/a/11328913/539149\">stackoverflow.com/a/11328913/539149</a> did you ever find a solution?"}], "answers": [{"comments": [{"owner": {"reputation": 772, "user_id": 1458227, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yxUI0.png?s=128&g=1", "display_name": "NamNamNam", "link": "https://stackoverflow.com/users/1458227/namnamnam"}, "edited": false, "score": 1, "creation_date": 1511155973, "post_id": 44728500, "comment_id": 81724129, "body": "2017-Nov-20 &#39;gem install sqlite3 -- --with-sqlite3-lib=/usr/lib&#39; totally solve my problem, Thanks!"}], "tags": [], "owner": {"reputation": 4219, "user_id": 539149, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/50d4553da2590287def72a6a6d96e3e2?s=128&d=identicon&r=PG", "display_name": "Zack Morris", "link": "https://stackoverflow.com/users/539149/zack-morris"}, "is_accepted": true, "score": 19, "last_activity_date": 1498245224, "creation_date": 1498245224, "answer_id": 44728500, "question_id": 41370565, "link": "https://stackoverflow.com/questions/41370565/ruby-sqlite3-installation-sqlite3-libversion-number-macos-sierra/44728500#44728500", "title": "Ruby Sqlite3 installation sqlite3_libversion_number() macOS Sierra", "body": "<p>I finally managed to solve this by <strong>specifying the built-in Mac OS X sqlite library directory</strong> on macOS Sierra 10.12.5 (16F73):</p>\n\n<pre><code>$ whereis sqlite3\n/usr/bin/sqlite3\n# if binary is in /usr/bin then library is typically in /usr/lib\n$ gem install sqlite3 -- --with-sqlite3-lib=/usr/lib\nBuilding native extensions with: '--with-sqlite3-lib=/usr/lib'\nThis could take a while...\nSuccessfully installed sqlite3-1.3.13\nParsing documentation for sqlite3-1.3.13\nDone installing documentation for sqlite3 after 0 seconds\n1 gem installed\n</code></pre>\n\n<p>I tried specifying the <a href=\"https://brew.sh/\" rel=\"noreferrer\">Homebrew</a> library directory but for some reason it didn't work:</p>\n\n<pre><code>$ brew ls --verbose sqlite3\n/usr/local/Cellar/sqlite/3.19.3/.brew/sqlite.rb\n/usr/local/Cellar/sqlite/3.19.3/bin/sqlite3\n/usr/local/Cellar/sqlite/3.19.3/include/msvc.h\n/usr/local/Cellar/sqlite/3.19.3/include/sqlite3.h\n/usr/local/Cellar/sqlite/3.19.3/include/sqlite3ext.h\n/usr/local/Cellar/sqlite/3.19.3/INSTALL_RECEIPT.json\n/usr/local/Cellar/sqlite/3.19.3/lib/libsqlite3.0.dylib\n/usr/local/Cellar/sqlite/3.19.3/lib/libsqlite3.a\n/usr/local/Cellar/sqlite/3.19.3/lib/libsqlite3.dylib\n/usr/local/Cellar/sqlite/3.19.3/lib/pkgconfig/sqlite3.pc\n/usr/local/Cellar/sqlite/3.19.3/README.txt\n/usr/local/Cellar/sqlite/3.19.3/share/man/man1/sqlite3.1\n$ gem install sqlite3 -- --with-sqlite3-lib=/usr/local/Cellar/sqlite/3.19.3/lib\nThis could take a while...\nERROR:  Error installing sqlite3:\n    ERROR: Failed to build gem native extension.\n...\n</code></pre>\n\n<p>If someone knows how to specify the Homebrew library directory, please let me know because that would provide a little more control over installation (supposedly <a href=\"https://www.macports.org/\" rel=\"noreferrer\">MacPorts</a> works but I no longer use it).</p>\n\n<hr>\n\n<p>For anyone curious, here's the full command to install Ruby's <a href=\"https://github.com/jeremyevans/sequel\" rel=\"noreferrer\">Sequel</a>:</p>\n\n<pre><code>gem install sequel mysql sqlite3 -- --with-sqlite3-lib=/usr/lib\n</code></pre>\n\n<p>And how to convert a <a href=\"https://laravel.com/docs/homestead\" rel=\"noreferrer\">Laravel Homestead</a> MySQL database listening on host port 3306 to SQLite from <a href=\"https://stackoverflow.com/questions/41370565/ruby-sqlite3-installation-sqlite3-libversion-number-macos-sierra#comment76437960_41370565\">my comment on the question</a>:</p>\n\n<pre><code>sequel mysql://homestead:secret@192.168.10.10:3306/my_database -C sqlite://my_database.sqlite\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 912, "user_id": 362420, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BPoSl.png?s=128&g=1", "display_name": "Riccardo", "link": "https://stackoverflow.com/users/362420/riccardo"}, "edited": false, "score": 0, "creation_date": 1539888826, "post_id": 51856164, "comment_id": 92674950, "body": "Is there a way to make this work from Gemfile directly? Something like:      # Add to Gemfile     gem &#39;sqlite3&#39;, :lib =&gt; &quot;/usr/lib/&quot;, :condition =&gt; :only_if_mac"}, {"owner": {"reputation": 298, "user_id": 4796700, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/NrrM2.jpg?s=128&g=1", "display_name": "Tatiana Frank", "link": "https://stackoverflow.com/users/4796700/tatiana-frank"}, "edited": false, "score": 2, "creation_date": 1542568204, "post_id": 51856164, "comment_id": 93605512, "body": "This is what finally worked for me: <code>bundle config build.sqlite3 --with-sqlite3-include=$HOME&#47;include --with-sqlite3-lib=$HOME&#47;lib --with-sqlite3-dir=$HOME&#47;bin</code>"}], "tags": [], "owner": {"reputation": 51, "user_id": 10228566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2437e7fdb647d4c7a9be3e5478032595?s=128&d=identicon&r=PG&f=1", "display_name": "Mervyn Tan", "link": "https://stackoverflow.com/users/10228566/mervyn-tan"}, "is_accepted": false, "score": 5, "last_activity_date": 1534327464, "last_edit_date": 1534327464, "creation_date": 1534325290, "answer_id": 51856164, "question_id": 41370565, "link": "https://stackoverflow.com/questions/41370565/ruby-sqlite3-installation-sqlite3-libversion-number-macos-sierra/51856164#51856164", "title": "Ruby Sqlite3 installation sqlite3_libversion_number() macOS Sierra", "body": "<p>This worked for me on Mac High Sierra OS 10.13</p>\n\n<pre><code>gem install sqlite3 -- --with-sqlite3-lib=/usr/lib\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4313278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000569822670/picture?type=large", "display_name": "Matt Klaver", "link": "https://stackoverflow.com/users/4313278/matt-klaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3232, "favorite_count": 1, "accepted_answer_id": 44728500, "answer_count": 2, "score": 4, "last_activity_date": 1534327464, "creation_date": 1482963862, "question_id": 41370565, "link": "https://stackoverflow.com/questions/41370565/ruby-sqlite3-installation-sqlite3-libversion-number-macos-sierra", "title": "Ruby Sqlite3 installation sqlite3_libversion_number() macOS Sierra", "body": "<p>I'm trying to install the Metasploit framework (unimportant) and bundler is attempting to install sqlite3, which is where it fails consistently. Sqlite3 is installed (executing sqlite3 at the command line brings me into the environment) and is linked using <code>brew link sqlite3</code> (and adding the --force, for some reason) but <code>bundler install</code> fails each time with this error: </p>\n\n<pre><code>sudo gem install sqlite3\nBuilding native extensions.  This could take a while...\nERROR:  Error installing sqlite3:\n    ERROR: Failed to build gem native extension.\n\n    /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby extconf.rb\nError: Running Homebrew as root is extremely dangerous and no longer supported.\nAs Homebrew does not drop privileges on installation you would be giving all\nbuild scripts full access to your system.\nchecking for sqlite3.h... yes\nchecking for pthread_create() in -lpthread... yes\nchecking for sqlite3_libversion_number() in -lsqlite3... no\nsqlite3 is missing. Try 'brew install sqlite3',\n'yum install sqlite-devel' or 'apt-get install libsqlite3-dev'\nand check your shared library search path (the\nlocation where your sqlite3 shared library is located).\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby\n    --with-sqlite3-config\n    --without-sqlite3-config\n    --with-pkg-config\n    --without-pkg-config\n    --with-sqlite3-dir\n    --without-sqlite3-dir\n    --with-sqlite3-include\n    --without-sqlite3-include=${sqlite3-dir}/include\n    --with-sqlite3-lib\n    --without-sqlite3-lib=${sqlite3-dir}/\n    --with-pthreadlib\n    --without-pthreadlib\n    --with-sqlite3lib\n    --without-sqlite3lib\n\n\nGem files will remain installed in /Library/Ruby/Gems/2.0.0/gems/sqlite3-1.3.12 for inspection.\nResults logged to /Library/Ruby/Gems/2.0.0/gems/sqlite3-1.3.12/ext/sqlite3/gem_make.out\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "heroku", "amazon-s3"], "comments": [{"owner": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482969071, "post_id": 41370472, "comment_id": 69944402, "body": "are you using the fog gem?"}, {"owner": {"reputation": 111, "user_id": 3799793, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4745a686533c0961a731744fe9651731?s=128&d=identicon&r=PG&f=1", "display_name": "user3799793", "link": "https://stackoverflow.com/users/3799793/user3799793"}, "reply_to_user": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482972484, "post_id": 41370472, "comment_id": 69945262, "body": "I am not. Should I?"}, {"owner": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482973917, "post_id": 41370472, "comment_id": 69945557, "body": "Yes. Try it and also ImageMagic for reducing file size. I don&#39;t see anything in the heroku logs that raise a red flag. Fog is an easy way to get photos to S3, and if it fails you&#39;ll get an error message."}, {"owner": {"reputation": 111, "user_id": 3799793, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4745a686533c0961a731744fe9651731?s=128&d=identicon&r=PG&f=1", "display_name": "user3799793", "link": "https://stackoverflow.com/users/3799793/user3799793"}, "reply_to_user": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482976777, "post_id": 41370472, "comment_id": 69946109, "body": "i tried following this, but didn&#39;t have any success. <a href=\"http://jessicag.github.io/Using-Paperclip-AWS-and-Fog/\" rel=\"nofollow noreferrer\">jessicag.github.io/Using-Paperclip-AWS-and-Fog</a>"}, {"owner": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482977698, "post_id": 41370472, "comment_id": 69946287, "body": "So exactly what happens when you select a photo to upload and you click the &quot;submit&quot; button? Maybe look at your logs."}, {"owner": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482977781, "post_id": 41370472, "comment_id": 69946301, "body": "Curious about how heroku is involved at this point. You s/b in the development mode to sort this out, then deploy."}, {"owner": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482977987, "post_id": 41370472, "comment_id": 69946330, "body": "You&#39;ll also have to migrate your database, both locally and after you deploy to heroku, the production database  (in the command line:  heroku run rake db:migrate  )"}, {"owner": {"reputation": 111, "user_id": 3799793, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4745a686533c0961a731744fe9651731?s=128&d=identicon&r=PG&f=1", "display_name": "user3799793", "link": "https://stackoverflow.com/users/3799793/user3799793"}, "reply_to_user": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482979400, "post_id": 41370472, "comment_id": 69946623, "body": "After i hit the submit button an empty post loads. The image, i&#39;m not sure what happens to it, but it is not saved in any way. It&#39;s not in the s3 bucket or posted. However the logs show the image being submitted. This is now happening in both development and production."}, {"owner": {"reputation": 111, "user_id": 3799793, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4745a686533c0961a731744fe9651731?s=128&d=identicon&r=PG&f=1", "display_name": "user3799793", "link": "https://stackoverflow.com/users/3799793/user3799793"}, "reply_to_user": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482979691, "post_id": 41370472, "comment_id": 69946702, "body": "<a href=\"https://immense-gorge-61510.herokuapp.com\" rel=\"nofollow noreferrer\">immense-gorge-61510.herokuapp.com</a> is the location of the app. If you want to take a look at whats going on for yourself."}, {"owner": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482979707, "post_id": 41370472, "comment_id": 69946705, "body": "Post the pertinent part of the development log (and you did the migrations, right? and restarted the server?)"}, {"owner": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482980054, "post_id": 41370472, "comment_id": 69946801, "body": "heroku reports app still in development... rather see your Rails code"}, {"owner": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482980354, "post_id": 41370472, "comment_id": 69946864, "body": "This is a comprehensive tutorial on the subject, and I highly recommend it:  <a href=\"https://rails.devcamp.com/trails/rails-project-photo-uploader-tutorial\" rel=\"nofollow noreferrer\">rails.devcamp.com/trails/rails-project-photo-uploader-tutori&zwnj;&#8203;al</a>"}, {"owner": {"reputation": 111, "user_id": 3799793, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4745a686533c0961a731744fe9651731?s=128&d=identicon&r=PG&f=1", "display_name": "user3799793", "link": "https://stackoverflow.com/users/3799793/user3799793"}, "reply_to_user": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "edited": false, "score": 0, "creation_date": 1482981340, "post_id": 41370472, "comment_id": 69947076, "body": "PostsController#create as HTML 2016-12-29T03:09:58.864346+00:00 app[web.1]:   Parameters: {&quot;utf8&quot;=&gt;&quot;\u2713&quot;, &quot;authenticity_token&quot;=&gt;&quot;yu7xLpKdXfgH3FrMXwVMIFQjUrSoNfXtnJ2e+&zwnj;&#8203;QTXYORAtu7lVfZd0/m9E&zwnj;&#8203;ea1gJzsvL+Rl3DifmIRs&zwnj;&#8203;ktI9EBTmA==&quot;, &quot;post&quot;=&gt;{&quot;content&quot;=&gt;&quot;&quot;, &quot;image&quot;=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x007fbd8cca7d&zwnj;&#8203;20 @tempfile=#&lt;Tempfile:/tmp/RackMultipart20161229-4-4r86ub.jpg&zwnj;&#8203;&gt;, @original_filename=&quot;best-kitten-names-1.jpg&quot;, @content_type=&quot;image/jpeg&quot;, @headers=&quot;Content-Disposition: form-data; name=\\&quot;post[image]\\&quot;; filename=\\&quot;best-kitten-names-1.jpg&quot;\\r\\nContent-Type: image/jpeg\\r\\n&quot;&gt;}, &quot;commit&quot;=&gt;&quot;Post&quot;}"}], "answers": [{"tags": [], "owner": {"reputation": 567, "user_id": 2133083, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1eff23520876dc4ba8e040424fedbc4b?s=128&d=identicon&r=PG", "display_name": "Tom Connolly", "link": "https://stackoverflow.com/users/2133083/tom-connolly"}, "is_accepted": false, "score": 0, "last_activity_date": 1482983793, "creation_date": 1482983793, "answer_id": 41372925, "question_id": 41370472, "link": "https://stackoverflow.com/questions/41370472/heroku-paperclip-rails-4-s3-not-working/41372925#41372925", "title": "heroku paperclip rails 4 s3 not working", "body": "<p>OK, it looks like the picture went into your tempfile instead of to S3. Now you know you have to configure the bucket. Pay close attention to this page:\n<a href=\"https://rails.devcamp.com/rails-project-photo-uploader-tutorial/connecting-to-s3-on-aws/how-to-connect-to-the-aws-s3-api\" rel=\"nofollow noreferrer\">https://rails.devcamp.com/rails-project-photo-uploader-tutorial/connecting-to-s3-on-aws/how-to-connect-to-the-aws-s3-api</a>\nYou're close! Don't give up.</p>\n"}], "owner": {"reputation": 111, "user_id": 3799793, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4745a686533c0961a731744fe9651731?s=128&d=identicon&r=PG&f=1", "display_name": "user3799793", "link": "https://stackoverflow.com/users/3799793/user3799793"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482983793, "creation_date": 1482963431, "question_id": 41370472, "link": "https://stackoverflow.com/questions/41370472/heroku-paperclip-rails-4-s3-not-working", "title": "heroku paperclip rails 4 s3 not working", "body": "<p>I am having trouble getting heroku to work with s3. When i submit an image post, it seems my application submits it(what i can tell from heroku logs). But no image shows up after submission except for a blank post. And there is no image in the s3 bucket. I followed documentation from: <a href=\"https://devcenter.heroku.com/articles/paperclip-s3\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/paperclip-s3</a> for s3 and here: <a href=\"https://github.com/thoughtbot/paperclip\" rel=\"nofollow noreferrer\">https://github.com/thoughtbot/paperclip</a> for paperlip. </p>\n\n<pre><code>    production.rb \n\n    config.paperclip_defaults = {\n    storage: :s3,\n    # s3_host_name: 's3.amazonaws.com',\n    s3_credentials: {\n      bucket: ENV.fetch('S3_BUCKET_NAME'),\n      access_key_id: ENV.fetch('AWS_ACCESS_KEY_ID'),\n      secret_access_key: ENV.fetch('AWS_SECRET_ACCESS_KEY'),\n      s3_region: ENV.fetch('AWS_REGION'),\n    }\n  }\n\n\n\n$ heroku config:set S3_BUCKET_NAME=your_bucket_name\n$ heroku config:set AWS_ACCESS_KEY_ID=your_access_key_id\n$ heroku config:set AWS_SECRET_ACCESS_KEY=your_secret_access_key\n$ heroku config:set AWS_REGION=us-east-1\n\n\nHeroku Logs\n\n2016-12-28T21:57:52.101029+00:00 heroku[web.1]: Unidling\n2016-12-28T21:57:52.101275+00:00 heroku[web.1]: State changed from down to starting\n2016-12-28T21:57:57.778592+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 30838 -e production`\n2016-12-28T21:58:02.108725+00:00 app[web.1]: [2016-12-28 21:58:02] INFO  WEBrick 1.3.1\n2016-12-28T21:58:02.108742+00:00 app[web.1]: [2016-12-28 21:58:02] INFO  ruby 2.2.6 (2016-11-15) [x86_64-linux]\n2016-12-28T21:58:02.109000+00:00 app[web.1]: [2016-12-28 21:58:02] INFO  WEBrick::HTTPServer#start: pid=4 port=30838\n2016-12-28T21:58:02.570577+00:00 heroku[web.1]: State changed from starting to up\n2016-12-28T21:58:04.144516+00:00 app[web.1]: =&gt; Booting WEBrick\n2016-12-28T21:58:04.144539+00:00 app[web.1]: =&gt; Rails 4.2.3 application starting in production on http://0.0.0.0:30838\n2016-12-28T21:58:04.144541+00:00 app[web.1]: =&gt; Run `rails server -h` for more startup options\n2016-12-28T21:58:04.144541+00:00 app[web.1]: =&gt; Ctrl-C to shutdown server\n2016-12-28T21:58:04.144542+00:00 app[web.1]: Started POST \"/posts\" for 162.199.225.97 at 2016-12-28 21:58:04 +0000\n2016-12-28T21:58:04.185386+00:00 app[web.1]: Processing by PostsController#create as HTML\n2016-12-28T21:58:04.185468+00:00 app[web.1]:   Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"L8jVCl6TKg9movpIhk8pt6P9oAv2h7c8sNGHu3n3XhoAke5HgoQuRMncUje71ng/EzSsrBxP5bUBrByTqWALEw==\", \"post\"=&gt;{\"content\"=&gt;\"\", \"image\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x007f8aaa6441a0 @tempfile=#&lt;Tempfile:/tmp/RackMultipart20161228-4-mfx8dx.jpg&gt;, @original_filename=\"best-kitten-names-1.jpg\", @content_type=\"image/jpeg\", @headers=\"Content-Disposition: form-data; name=\\\"post[image]\\\"; filename=\\\"best-kitten-names-1.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\n\"&gt;}, \"commit\"=&gt;\"Post\"}\n2016-12-28T21:58:04.205630+00:00 app[web.1]:   User Load (1.1ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1  ORDER BY \"users\".\"id\" ASC LIMIT 1  [[\"id\", 1]]\n2016-12-28T21:58:04.264197+00:00 app[web.1]:    (0.7ms)  BEGIN\n2016-12-28T21:58:04.268176+00:00 app[web.1]:   SQL (1.1ms)  INSERT INTO \"posts\" (\"content\", \"user_id\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3, $4) RETURNING \"id\"  [[\"content\", \"\"], [\"user_id\", 1], [\"created_at\", \"2016-12-28 21:58:04.264795\"], [\"updated_at\", \"2016-12-28 21:58:04.264795\"]]\n2016-12-28T21:58:04.270377+00:00 app[web.1]:    (1.6ms)  COMMIT\n2016-12-28T21:58:04.271066+00:00 app[web.1]: Redirected to https://immense-gorge-61510.herokuapp.com/users/1\n2016-12-28T21:58:04.271231+00:00 app[web.1]: Completed 302 Found in 86ms (ActiveRecord: 12.4ms)\n2016-12-28T21:58:04.271721+00:00 heroku[router]: at=info method=POST path=\"/posts\" host=immense-gorge-61510.herokuapp.com request_id=e3e74cff-240a-4041-bc5b-5e4bae727b53 fwd=\"162.199.225.97\" dyno=web.1 connect=0ms service=135ms status=302 bytes=1168\n2016-12-28T21:58:04.562237+00:00 heroku[router]: at=info method=GET path=\"/users/1\" host=immense-gorge-61510.herokuapp.com request_id=b17a22b5-d8f7-4305-860d-7366fbd8e8f1 fwd=\"162.199.225.97\" dyno=web.1 connect=0ms service=143ms status=200 bytes=5100\n2016-12-28T21:58:04.425366+00:00 app[web.1]: Started GET \"/users/1\" for 162.199.225.97 at 2016-12-28 21:58:04 +0000\n2016-12-28T21:58:04.428258+00:00 app[web.1]: Processing by UsersController#show as HTML\n2016-12-28T21:58:04.428277+00:00 app[web.1]:   Parameters: {\"id\"=&gt;\"1\"}\n2016-12-28T21:58:04.430570+00:00 app[web.1]:   User Load (0.9ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1  ORDER BY \"users\".\"id\" ASC LIMIT 1  [[\"id\", 1]]\n2016-12-28T21:58:04.434624+00:00 app[web.1]:   User Load (0.8ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n2016-12-28T21:58:04.438495+00:00 app[web.1]:   Post Load (1.0ms)  SELECT \"posts\".* FROM \"posts\" WHERE \"posts\".\"user_id\" = $1  [[\"user_id\", 1]]\n2016-12-28T21:58:04.459392+00:00 app[web.1]:    (0.9ms)  SELECT COUNT(*) FROM \"posts\" WHERE (user_id = 1)\n2016-12-28T21:58:04.470197+00:00 app[web.1]:   Post Load (1.1ms)  SELECT  \"posts\".* FROM \"posts\" WHERE (user_id = 1)  ORDER BY \"posts\".\"created_at\" DESC LIMIT 10 OFFSET 0\n2016-12-28T21:58:04.473733+00:00 app[web.1]:   User Load (1.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n2016-12-28T21:58:04.489307+00:00 app[web.1]:   CACHE (0.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n2016-12-28T21:58:04.490576+00:00 app[web.1]:   CACHE (0.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n2016-12-28T21:58:04.492301+00:00 app[web.1]:   CACHE (0.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n2016-12-28T21:58:04.493573+00:00 app[web.1]:   CACHE (0.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n2016-12-28T21:58:04.494749+00:00 app[web.1]:   CACHE (0.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n2016-12-28T21:58:04.496086+00:00 app[web.1]:   CACHE (0.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n2016-12-28T21:58:04.497785+00:00 app[web.1]:   CACHE (0.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n2016-12-28T21:58:04.498880+00:00 app[web.1]:   Rendered shared/_wall.html.slim (34.4ms)\n2016-12-28T21:58:04.513974+00:00 app[web.1]:   Rendered shared/_error_messages.html.slim (6.4ms)\n2016-12-28T21:58:04.515710+00:00 app[web.1]:   Rendered shared/_post_form.html.slim (16.2ms)\n2016-12-28T21:58:04.515770+00:00 app[web.1]:   Rendered users/show.html.slim within layouts/application (73.9ms)\n2016-12-28T21:58:04.552423+00:00 app[web.1]:    (0.8ms)  SELECT COUNT(*) FROM \"notifications\" WHERE \"notifications\".\"recipient_id\" = $1 AND \"notifications\".\"checked\" = $2  [[\"recipient_id\", 1], [\"checked\", \"f\"]]\n2016-12-28T21:58:04.553223+00:00 app[web.1]:   Rendered layouts/_header.html.slim (26.5ms)\n2016-12-28T21:58:04.560863+00:00 app[web.1]:   Rendered shared/_flash_messages.html.slim (6.3ms)\n2016-12-28T21:58:04.561408+00:00 app[web.1]: Completed 200 OK in 133ms (Views: 116.4ms | ActiveRecord: 8.2ms)\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1482961355, "post_id": 41369988, "comment_id": 69941869, "body": "Your question suggests &quot;newYork&quot; is to be returned, but you show &quot;NewYork&quot;."}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1482961579, "post_id": 41369988, "comment_id": 69941965, "body": "@CarySwoveland I now mentioned camelcase words"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1482961846, "post_id": 41369988, "comment_id": 69942105, "body": "<i>Sidenote:</i> <code>str.gsub(&#47;-(.)&#47;,$1.capitalize)</code> won\u2019t work as expected. Try it on <code>santiago-de-chile</code>. It works in your example only because there is the only hyphen."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1482962237, "post_id": 41369988, "comment_id": 69942239, "body": "to @CarySwoveland&#39;s point camel case means different things such as camelCase (called camel case or lower camel case) or CamelCase (also called camel case or Pascal Case or upper camel case). Your question requests the first and states the second is correct thus the confusion. Also the use of 4 lines is superfluous especially the third line which has no implication."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1482964168, "post_id": 41369988, "comment_id": 69942890, "body": "Further to the last two comments, I suggest you edit to state your question precisely. You need to clarify whether there is one hyphen or possibly two or more, and what you want done with the strings that would be obtained if you were to split the string on hyphens. I wouldn&#39;t change it now, but the fact you are starting with a symbol is distracting, as the first step in all answers is to convert it to a string. I think it would have been better to just present a string in your question."}], "answers": [{"tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 4, "last_activity_date": 1482960951, "creation_date": 1482960951, "answer_id": 41370052, "question_id": 41369988, "link": "https://stackoverflow.com/questions/41369988/replacing-hyphens-in-words-with-the-next-letter-capitalized/41370052#41370052", "title": "Replacing hyphens in words with the next letter capitalized", "body": "<p>Here's one way:</p>\n\n<pre><code>sym.to_s.split('-').map(&amp;:capitalize).join #=&gt; \"NewYork\" \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1482961599, "post_id": 41370061, "comment_id": 69941978, "body": "Is \\A the same thing as [A-Z]?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1482961712, "post_id": 41370061, "comment_id": 69942040, "body": "Not at all. <code>\\A</code> is a beginning-of-string matcher. I use it to avoid the necessity to explicitly capitalize the string to make the very first letter upcased."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1482960998, "creation_date": 1482960998, "answer_id": 41370061, "question_id": 41369988, "link": "https://stackoverflow.com/questions/41369988/replacing-hyphens-in-words-with-the-next-letter-capitalized/41370061#41370061", "title": "Replacing hyphens in words with the next letter capitalized", "body": "<pre><code>sym.to_s.gsub(/(-|\\A)./) { $&amp;[-1].upcase }\n</code></pre>\n\n<p>or</p>\n\n<pre><code>sym.to_s.gsub(/(-|\\A)./) { |m| m[-1].upcase }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1482963115, "creation_date": 1482963115, "answer_id": 41370419, "question_id": 41369988, "link": "https://stackoverflow.com/questions/41369988/replacing-hyphens-in-words-with-the-next-letter-capitalized/41370419#41370419", "title": "Replacing hyphens in words with the next letter capitalized", "body": "<pre><code>r = /\n    ([[:alpha:]]+) # match 1 or more letters in capture group 1\n    -              # match a hyphen\n    ([[:alpha:]]+) # match 1 or more letters in capture group 2\n    /x             # free-spacing regex definition mode\n\nsym = :'new-york'\nsym.to_s.sub(r) { $1.capitalize + $2.capitalize }\n  #=&gt; \"NewYork\"\n</code></pre>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 41370061, "answer_count": 3, "score": 0, "last_activity_date": 1524704682, "creation_date": 1482960606, "last_edit_date": 1524704682, "question_id": 41369988, "link": "https://stackoverflow.com/questions/41369988/replacing-hyphens-in-words-with-the-next-letter-capitalized", "title": "Replacing hyphens in words with the next letter capitalized", "body": "<p>I have a symbol like the following. Whenever the symbol contains the \"-\" hyphen mark, I want to remove it and upcase the subsequent letter. \nI am able to do it like so:</p>\n\n<pre><code>sym = :'new-york'\nstr = sym.to_s.capitalize\n/-(.)/.match(str)     \nstr = str.gsub(/-(.)/,$1.capitalize)     \n=&gt; \"NewYork\"\n</code></pre>\n\n<p>This required four lines. Is there a more elegant way to create CamelCase (upper CamelCase e.g. NewYork, NewJersey, BucksCounty) from hyphened words in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos", "apache", "passenger"], "answers": [{"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1483030703, "post_id": 41381565, "comment_id": 69970080, "body": "Hi, I put what you have above in my &quot;httpd.conf&quot; file but upon restarting Apache, I get teh error (from the logs), &quot;Cannot serve directory /Users/davea/Documents/workspace/sims/: No matching DirectoryIndex (index.html) found, and server-generated directory index forbidden by Options directive&quot;."}, {"owner": {"reputation": 2340, "user_id": 2250791, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e72d4f734d39c777f543025d36d4de4e?s=128&d=identicon&r=PG", "display_name": "Camden Narzt", "link": "https://stackoverflow.com/users/2250791/camden-narzt"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1483030797, "post_id": 41381565, "comment_id": 69970144, "body": "<code>&#47;Users&#47;davea&#47;Documents&#47;workspace&#47;sims&#47;</code> should be <code>&#47;Users&#47;davea&#47;Documents&#47;workspace&#47;sims&#47;public</code>"}], "tags": [], "owner": {"reputation": 2340, "user_id": 2250791, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e72d4f734d39c777f543025d36d4de4e?s=128&d=identicon&r=PG", "display_name": "Camden Narzt", "link": "https://stackoverflow.com/users/2250791/camden-narzt"}, "is_accepted": true, "score": 0, "last_activity_date": 1483021444, "creation_date": 1483021444, "answer_id": 41381565, "question_id": 41369935, "link": "https://stackoverflow.com/questions/41369935/how-do-i-connect-apache-to-my-running-ruby-on-rails-instance-using-passenger/41381565#41381565", "title": "How do I connect Apache to my running Ruby on Rails instance using passenger?", "body": "<p>You need to configure a virtualhost in apache and then Passenger will start your rails app for you (you don't start your rails server when using apache integration).</p>\n\n<p>At a minimum you need to point the apache virtualhost's document root to the public directory in your rails app.</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n    ServerName yourserver.com\n    DocumentRoot /path/to/myapp/public\n\n    &lt;Directory /path/to/myapp/public&gt;\n        Allow from all\n        Options -MultiViews\n        Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>Further reading:</p>\n\n<p><a href=\"https://www.phusionpassenger.com/library/config/apache/intro.html\" rel=\"nofollow noreferrer\">https://www.phusionpassenger.com/library/config/apache/intro.html</a>\n<a href=\"https://www.phusionpassenger.com/library/config/apache/reference/\" rel=\"nofollow noreferrer\">https://www.phusionpassenger.com/library/config/apache/reference/</a></p>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "accepted_answer_id": 41381565, "answer_count": 1, "score": 0, "last_activity_date": 1483021444, "creation_date": 1482960333, "question_id": 41369935, "link": "https://stackoverflow.com/questions/41369935/how-do-i-connect-apache-to-my-running-ruby-on-rails-instance-using-passenger", "title": "How do I connect Apache to my running Ruby on Rails instance using passenger?", "body": "<p>I\u2019m using Apache 2.4 and Rails 5 on Mac Sierra. I did</p>\n\n<pre><code>brew install passenger\n</code></pre>\n\n<p>and then I created this file</p>\n\n<pre><code>localhost:apache2 davea$ cat /etc/apache2/other/passenger.conf\nLoadModule passenger_module  /usr/local/opt/passenger/libexec/buildout/apache2/mod_passenger.so\nPassengerRoot /usr/local/opt/passenger/libexec/src/ruby_supportlib/phusion_passenger/locations.ini\nPassengerDefaultRuby /usr/bin/ruby\n</code></pre>\n\n<p>But after restarting Apache</p>\n\n<pre><code>sudo apachectl restart\n</code></pre>\n\n<p>and then starting my Rails server (which runs on port 3000), I visit the local url on my machine</p>\n\n<pre><code>https://mylocalurl.com/\n</code></pre>\n\n<p>and I\u2019m still seeing my Apache page, not my Rails page. What else am I missing that would connect Apache to Rails?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 2230, "user_id": 6337957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1177d893bf3115edf0119cf56e7220?s=128&d=identicon&r=PG", "display_name": "Greg Navis", "link": "https://stackoverflow.com/users/6337957/greg-navis"}, "is_accepted": true, "score": 3, "last_activity_date": 1482960516, "creation_date": 1482960516, "answer_id": 41369969, "question_id": 41369845, "link": "https://stackoverflow.com/questions/41369845/prevent-output-while-using-ruby-benchmark/41369969#41369969", "title": "Prevent output while using Ruby Benchmark", "body": "<p>Looking at <a href=\"http://apidock.com/ruby/FileUtils/sh\" rel=\"nofollow noreferrer\">the source of <code>sh</code></a> it seems it accepts <code>verbose</code> as an option so the right invocation for you should be:</p>\n\n<pre><code>sh \"touch foo.txt\", verbose: false\n</code></pre>\n\n<p>The same <a href=\"http://apidock.com/ruby/v1_9_3_392/FileUtils/touch/class\" rel=\"nofollow noreferrer\">can be said of <code>touch</code></a>:</p>\n\n<pre><code>touch \"bar.txt\", verbose: false\n</code></pre>\n\n<p>It seems the docs don't mention these options at all. \ud83d\ude15</p>\n"}, {"comments": [{"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1482961718, "post_id": 41370010, "comment_id": 69942043, "body": "Why the downvote? Please comment so I can improve the answer."}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": false, "score": 0, "last_activity_date": 1482960738, "creation_date": 1482960738, "answer_id": 41370010, "question_id": 41369845, "link": "https://stackoverflow.com/questions/41369845/prevent-output-while-using-ruby-benchmark/41370010#41370010", "title": "Prevent output while using Ruby Benchmark", "body": "<p>You can redirect <code>$stdout</code></p>\n\n<p>See this example</p>\n\n<pre><code>puts 1\noriginal_stdout = $stdout\n$stdout = open(\"/dev/null\", \"w\")\nputs 2\n$stdout = original_stdout\nputs 3\n</code></pre>\n\n<p>Which prints</p>\n\n<pre><code>1\n3\n</code></pre>\n\n<p>But does not print <code>2</code></p>\n"}], "owner": {"reputation": 6391, "user_id": 2909897, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LMSiW.jpg?s=128&g=1", "display_name": "mbigras", "link": "https://stackoverflow.com/users/2909897/mbigras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 41369969, "answer_count": 2, "score": 2, "last_activity_date": 1482960738, "creation_date": 1482959968, "last_edit_date": 1495540802, "question_id": 41369845, "link": "https://stackoverflow.com/questions/41369845/prevent-output-while-using-ruby-benchmark", "title": "Prevent output while using Ruby Benchmark", "body": "<p>I'm trying to compare the <a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/fileutils/rdoc/FileUtils.html#method-c-touch\" rel=\"nofollow noreferrer\">touch</a> method that Rake includes to shelling out to the system touch.</p>\n\n<p>Each operation is sending output to stdout:</p>\n\n<pre><code>require 'benchmark'\nrequire 'rake'\n\nn = 3\nresult = Benchmark.bm do |x|\n  x.report(\"sh:\") do\n    n.times { sh \"touch foo.txt\" }\n  end\n  x.report(\"touch:\") do\n    n.times { touch \"bar.txt\" }\n  end\nend\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>user     system      total        real\nsh:touch foo.txt\ntouch foo.txt\ntouch foo.txt\n  0.000000   0.010000   0.030000 (  0.024775)\ntouch:touch bar.txt\ntouch bar.txt\ntouch bar.txt\n  0.000000   0.000000   0.000000 (  0.000412)\n</code></pre>\n\n<p>What I'd like is:</p>\n\n<pre><code>user     system      total        real\nsh:touch foo.txt\n  0.000000   0.010000   0.030000 (  0.024775)\ntouch:touch bar.txt\n  0.000000   0.000000   0.000000 (  0.000412)\n</code></pre>\n\n<p>Or something else that only has the results.</p>\n\n<p>I read in <a href=\"https://stackoverflow.com/questions/36969333/run-benchmark-but-dont-print-the-result\">another question</a> to use <code>Benchmark.measure</code> but the following also doesn't work:</p>\n\n<pre><code>require 'benchmark'\nrequire 'rake'\n\nn = 3\nresult = Benchmark.measure do \n  n.times { sh \"touch foo.txt\" }\nend\n\nputs result\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>touch foo.txt\ntouch foo.txt\ntouch foo.txt\n  0.000000   0.000000   0.010000 (  0.022931)\n</code></pre>\n\n<p>How do I benchmark <code>sh</code> and <code>touch</code> but prevent output from going to stdout?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 1, "creation_date": 1482960181, "post_id": 41369290, "comment_id": 69941388, "body": "Possibly <code>include ActionController::Rescue</code>.  See here: <a href=\"http://stackoverflow.com/questions/15976146/handling-activerecordrecordnotfound-with-actioncontrollermetal\" title=\"handling activerecordrecordnotfound with actioncontrollermetal\">stackoverflow.com/questions/15976146/&hellip;</a>"}, {"owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "reply_to_user": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1482960325, "post_id": 41369290, "comment_id": 69941438, "body": "@7stud yes tried it but nothing happned"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1482960644, "post_id": 41369290, "comment_id": 69941577, "body": "What exception are you not able to catch?"}, {"owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "reply_to_user": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1482961744, "post_id": 41369290, "comment_id": 69942060, "body": "@7stud Now it worked for me to catch exceptions, just restarted the server my bad ..Thanks for the Help :)"}], "answers": [{"comments": [{"owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "edited": false, "score": 0, "creation_date": 1483531732, "post_id": 41371145, "comment_id": 70132341, "body": "yes that also good but here was looking for custom exception handling rather than any wrapper, otherwise I can also use new-relic as well which awesome .."}], "tags": [], "owner": {"reputation": 2405, "user_id": 135845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agZcF.jpg?s=128&g=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/135845/eric"}, "is_accepted": false, "score": 0, "last_activity_date": 1482967814, "creation_date": 1482967814, "answer_id": 41371145, "question_id": 41369290, "link": "https://stackoverflow.com/questions/41369290/actioncontrollermetal-how-to-catch-all-exceptions-to-send-notification-email/41371145#41371145", "title": "ActionController::Metal How to catch all exceptions to send notification email?", "body": "<p>I'm not sure if this speaks to your exact problem, or whether you really need to create this yourself, but if you're open to additional dependencies I use the <a href=\"https://github.com/smartinez87/exception_notification\" rel=\"nofollow noreferrer\">exception_notifier gem</a> for this.</p>\n"}], "owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482967814, "creation_date": 1482957054, "last_edit_date": 1482961838, "question_id": 41369290, "link": "https://stackoverflow.com/questions/41369290/actioncontrollermetal-how-to-catch-all-exceptions-to-send-notification-email", "title": "ActionController::Metal How to catch all exceptions to send notification email?", "body": "<p>I am using ActionController::Metal inherted controllers for for rails services, I want to catch all exceptions , So that I can notify myself through email</p>\n\n<p><code>rescue_from Exception</code> is not working</p>\n\n<p>I have used above code in another app in application controller it is working good But not in this case</p>\n\n<p>Which module should be included in to base controller in order to use it any help?</p>\n\n<p>Code:</p>\n\n<pre><code>  rescue_from Exception do |exception|\n    Rails.logger.warn \"\\n-EXCEPTION OCCURE IN APPLICATION-\\n============\\n-On\\n-#{Time.now}\\n======\\nRequest-refer\\n#{request.referer}\\n=====\\nrequest.xhr?\\n#{request.xhr?}\\n=======\\nRequest environment\\n#{request.env[\"HTTP_USER_AGENT\"]}\\n====\\n-MESSAGE\\n-#{exception.message}\\n======\\n-Url\\n-#{request.url} \\n============\\n-Backtrace\\n-#{exception.backtrace}\"\n  end\n</code></pre>\n"}, {"tags": ["ruby", "argv", "optparse"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 4, "creation_date": 1482957614, "post_id": 41368631, "comment_id": 69940367, "body": "There&#39;s no inherent limit to how many arguments you can make but presumably after you&#39;ve exhausted all the single letters you&#39;re stuck with long versions. What&#39;s the problem here? Make sure all the appropriate blocks are firing correctly, like dump out your <code>options</code> before executing. This appears to be a debugging problem."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482961405, "post_id": 41368631, "comment_id": 69941896, "body": "Where this <code>:cols</code> came from? The option name is <code>column</code>, isn\u2019t it?"}, {"owner": {"reputation": 397, "user_id": 7328276, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b3b9e5edae1cf58d98b8fa3dc6e05a9a?s=128&d=identicon&r=PG&f=1", "display_name": "User9123", "link": "https://stackoverflow.com/users/7328276/user9123"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1483014993, "post_id": 41368631, "comment_id": 69961462, "body": "@tadman That makes sense, thank you"}, {"owner": {"reputation": 397, "user_id": 7328276, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b3b9e5edae1cf58d98b8fa3dc6e05a9a?s=128&d=identicon&r=PG&f=1", "display_name": "User9123", "link": "https://stackoverflow.com/users/7328276/user9123"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1483015014, "post_id": 41368631, "comment_id": 69961473, "body": "@mudasobwa the <code>[:cols]</code> comes from <code>{ |o| OPTIONS[:cols] = o }</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1483046518, "post_id": 41368631, "comment_id": 69977022, "body": "It&#39;s also worth noting that mutating what should be constant <code>OPTIONS</code> is also not a great plan. If you&#39;re intending to manipulate that, it should be a regular variable: <code>options</code>."}], "owner": {"reputation": 397, "user_id": 7328276, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b3b9e5edae1cf58d98b8fa3dc6e05a9a?s=128&d=identicon&r=PG&f=1", "display_name": "User9123", "link": "https://stackoverflow.com/users/7328276/user9123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1482953971, "creation_date": 1482953971, "question_id": 41368631, "link": "https://stackoverflow.com/questions/41368631/limit-to-the-amount-of-options-that-can-be-created-using-rubys-optparse", "title": "Limit to the amount of options that can be created using Ruby&#39;s OptParse", "body": "<p>Due to the size of the program I will not be able to post all of it, please see the latest push <a href=\"https://github.com/WhitewidowScanner/whitewidow\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>I have a program that has around 15 option flags in it:</p>\n\n<pre><code>ARGV &lt;&lt; '-h' if ARGV.empty? # Display help dialog if no flags are passed\nOptionParser.new do |opt|\n  opt.banner = banner_message\n  opt.on('-f FILE', '--file FILE', 'Pass a filename to scan for vulnerabilities')         { |o| OPTIONS[:file]    = o }\n  opt.on('-s URL', '--spider URL', 'Spider a web page and save all the URLS')             { |o| OPTIONS[:spider]  = o }\n  opt.on('-p IP:PORT', '--proxy IP:PORT', 'Configure to run with a proxy, must use \":\"')  { |o| OPTIONS[:proxy]   = o }\n  opt.on('-x NUM', '--run-x NUM', 'Run the specified amount of dry runs')                 { |o| OPTIONS[:run]     = o }\n  opt.on('-D DORK', '--dork DORK', 'Use your own dork to do the searching')               { |o| OPTIONS[:dork]    = o } # Issue #32 https://github.com/Ekultek/whitewidow/issues/32\n  opt.on('-c NAME', '--column NAME', 'Specify a column name to be run for union SQLi')    { |o| OPTIONS[:cols]    = o }\n  opt.on('-d', '--default', 'Run in default mode, scrape Google')                         { |o| OPTIONS[:default] = o }\n  opt.on('-l', '--legal', 'Show the legal information and the TOS')                       { |o| OPTIONS[:legal]   = o }\n  opt.on('-b', '--banner', 'Hide the banner')                                             { |o| OPTIONS[:banner]  = o }\n  opt.on('-v', '--version', 'Display the version number and exit')                        { |o| OPTIONS[:version] = o }\n  opt.on('-u', '--update', 'Update whitewidow with the newest version')                   { |o| OPTIONS[:update]  = o }\n  opt.on('--dry-run', 'Run a dry run (no checking for vulnerability with prompt)')        { |o| OPTIONS[:dry]     = o }\n  opt.on('--batch', 'No prompts, used in conjunction with the dry run')                   { |o| OPTIONS[:batch]   = o }\n  opt.on('--beep', 'Make a beep when the program finds a vulnerability')                  { |o| OPTIONS[:beep]    = o }\n  opt.on('--rand-agent', 'Use a random user agent')                                       { |o| OPTIONS[:agent]   = o }\n  opt.on('--sqlmap', 'Run sqlmap through the SQL_VULN.LOG file as a bulk file')           { |o| OPTIONS[:sqlmap]  = o }\n  opt.on('--test', 'Used mostly for development use')                                     { |o| OPTIONS[:test]    = o }\n  opt.on('-h', '--help', 'Display this help dialog and exit') do\n    usage_page\n    puts opt\n  end\nend.parse!\n</code></pre>\n\n<p>The newest option is the <code>-c</code> flag, what I'm trying to do is get the information from the <code>-c</code> flag and use it as the extraction point for the information, however, when I run the flag, it will only pull information from the file that is default:</p>\n\n<pre><code>#\n# Decide whether to use random column names, or a specific one\n#\ndef random_col_name?\n  if OPTIONS[:cols]\n    OPTIONS[:cols]\n  else\n    File.readlines(\"#{PATH}/lib/lists/common_columns.txt\").sample\n  end\nend\n</code></pre>\n\n<p>For example:\n<code>ruby program.rb -d -c test -D php?id=</code>\nWill pull <code>http://www.bible-history.com/subcat.php?id=2</code> which is correct, put from there is should add the information from the <code>-c</code> flag to the end of it like so: <code>http://www.bible-history.com/subcat.php?id=2 test</code>. However all it does is add the information from the file: <code>http://www.bible-history.com/subcat.php?id=2 clave</code>. My question being, why is it that when I try to extract the information from the flag, it will not accept the <code>ARGV</code> and only reads from the file, is there a limit to the amount of options I can create?</p>\n"}, {"tags": ["ruby", "sql-update", "datamapper"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1482972105, "creation_date": 1482972105, "answer_id": 41371711, "question_id": 41368560, "link": "https://stackoverflow.com/questions/41368560/datamapper-cant-update-password-token/41371711#41371711", "title": "Datamapper can&#39;t update password token", "body": "<p>In this method:</p>\n\n<pre><code>   def generate_token\n     self.password_token = SecureRandom.hex\n     self.save\n   end\n</code></pre>\n\n<p>You're calling <code>self.save</code>, which isn't guaranteed to succeed.</p>\n\n<p>If you want to know why it's failing to save, use <code>save!</code> instead.</p>\n"}], "owner": {"reputation": 1, "user_id": 5151439, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3e7b83b5936c3987c995e64d0cca9371?s=128&d=identicon&r=PG&f=1", "display_name": "Leke Abolade", "link": "https://stackoverflow.com/users/5151439/leke-abolade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483032398, "creation_date": 1482953640, "last_edit_date": 1483032398, "question_id": 41368560, "link": "https://stackoverflow.com/questions/41368560/datamapper-cant-update-password-token", "title": "Datamapper can&#39;t update password token", "body": "<p>I have a <code>user</code> model </p>\n\n<pre><code>class User\n  include Datamapper::Resource\n\n  property :id, Serial\n  property :password_token, String\n\n  def generate_token\n   self.password_token = SecureRandom.hex\n    self.save\n   end\nend\n</code></pre>\n\n<p>and this controller route:</p>\n\n<pre><code>post '/users/token_sent' do\n user = User.first(email: params[:email])\n   if user\n     user.generate_token \n   end\n redirect('index')\nend\n</code></pre>\n\n<p>I would like the <code>password_token</code> property to be changed to the <code>SecureRandom.hex</code> instance when the user fills in an email to recover their password from the post route. </p>\n\n<p>The method does not update the <code>password_token</code> to the Users database.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "apache", "ubuntu-14.04", "passenger"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1351104"}, "edited": false, "score": 0, "creation_date": 1482955720, "post_id": 41368041, "comment_id": 69939557, "body": "Which version of Passenger are you running?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1351104"}, "edited": false, "score": 0, "creation_date": 1482955874, "post_id": 41368041, "comment_id": 69939627, "body": "Could be related to <a href=\"https://github.com/phusion/passenger/issues/1362\" rel=\"nofollow noreferrer\">this issue</a> which has been fixed as of Passenger 4.0.58"}, {"owner": {"reputation": 7, "user_id": 3389904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000511755693/picture?type=large", "display_name": "Andr&#233; Cavallari", "link": "https://stackoverflow.com/users/3389904/andr%c3%a9-cavallari"}, "edited": false, "score": 0, "creation_date": 1483032921, "post_id": 41368041, "comment_id": 69971238, "body": "I am using the lattest version of passenger"}], "owner": {"reputation": 7, "user_id": 3389904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000511755693/picture?type=large", "display_name": "Andr&#233; Cavallari", "link": "https://stackoverflow.com/users/3389904/andr%c3%a9-cavallari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1482951135, "creation_date": 1482951135, "question_id": 41368041, "link": "https://stackoverflow.com/questions/41368041/error-500-rails-passenger-apache", "title": "Error 500 Rails + Passenger + Apache", "body": "<p>I've configure Apache 2.4.1 + Ruby on Rails using passenger on Ubuntu 14.04, but when I try to access my application I get a 500 error... the last log of apache and my VirtualHost config are here:</p>\n\n<p><a href=\"https://gist.github.com/anonymous/f27e04d8ed014554c7b64bb54321a9d7\" rel=\"nofollow noreferrer\">https://gist.github.com/anonymous/f27e04d8ed014554c7b64bb54321a9d7</a></p>\n"}, {"tags": ["ruby", "inheritance", "constants"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 3, "creation_date": 1482950927, "post_id": 41367887, "comment_id": 69937530, "body": "Read up about <code>self</code> in Ruby... this will help you a lot."}], "answers": [{"tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 2, "last_activity_date": 1482950698, "creation_date": 1482950698, "answer_id": 41367943, "question_id": 41367887, "link": "https://stackoverflow.com/questions/41367887/why-do-i-get-an-undefined-local-variable-or-method-error-when-using-a-constant/41367943#41367943", "title": "Why do I get an undefined local variable or method error when using a constant, but not when using a method?", "body": "<p>Because <code>number</code> is an instance method on <code>Thing</code>. The scope of the class definition of <code>OtherThing</code> is an instance of <code>Class</code>, which means it isn't an instance of <code>Thing</code> or an instance of <code>OtherThing</code> at definition. </p>\n\n<p>That said, you shouldn't be defining constants by executing methods. You could presumably have a calculated class variable that you call <code>freeze</code> on to prevent editing post-startup, but even that's not a very common pattern.</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1482960475, "post_id": 41369930, "comment_id": 69941501, "body": "I don&#39;t think the end goal is to define that constant that way. It&#39;s just an illustration to &quot;this works, that doesn&#39;t&quot;"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1482960506, "post_id": 41369930, "comment_id": 69941518, "body": "Or maybe it is. Who knows :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1482960620, "post_id": 41369930, "comment_id": 69941570, "body": "@SergioTulentsev Yes, I just dropped two examples, showing \u201cwhat works, what does not\u201d :)"}, {"owner": {"reputation": 921, "user_id": 3601621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/548735107/picture?type=large", "display_name": "Adzz", "link": "https://stackoverflow.com/users/3601621/adzz"}, "edited": false, "score": 0, "creation_date": 1482961600, "post_id": 41369930, "comment_id": 69941979, "body": "Ahh I see, I didn&#39;t realise constants were made at the class level, I thought they were on each instance. Interesting thanks!"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1482960311, "creation_date": 1482960311, "answer_id": 41369930, "question_id": 41367887, "link": "https://stackoverflow.com/questions/41367887/why-do-i-get-an-undefined-local-variable-or-method-error-when-using-a-constant/41369930#41369930", "title": "Why do I get an undefined local variable or method error when using a constant, but not when using a method?", "body": "<p>You need a class method to achieve the functionality you are looking for:</p>\n\n<pre><code>class Thing\n  #   \u21d3\u21d3\u21d3\u21d3   HERE\n  def self.number\n    10\n  end\nend\n\nclass OtherThing &lt; Thing\n  CONSTANT = number / 2\nend\n</code></pre>\n\n<p><code>CONSTANT</code> assignment is happening on the class level, hence it has an access to class methods of <code>Thing</code>, but not to the instance methods of it.</p>\n\n<p>On the other hand, you might instantiate <code>Thing</code> and then call the instance method on it:</p>\n\n<pre><code>class Thing\n  def number\n    10\n  end\nend\n\nclass OtherThing &lt; Thing\n  #          \u21d3\u21d3\u21d3\u21d3\u21d3\u21d3\u21d3\u21d3\u21d3  HERE\n  CONSTANT = Thing.new.number / 2\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": false, "score": 1, "last_activity_date": 1482962331, "last_edit_date": 1482962331, "creation_date": 1482961610, "answer_id": 41370161, "question_id": 41367887, "link": "https://stackoverflow.com/questions/41367887/why-do-i-get-an-undefined-local-variable-or-method-error-when-using-a-constant/41370161#41370161", "title": "Why do I get an undefined local variable or method error when using a constant, but not when using a method?", "body": "<p>Because of scope.</p>\n\n<p>Methods calls are evaluated based on the dynamic scope and distinguish between class and instance scope. Constants are resolved in lexical scope and do not distinguish between class and instance scope like methods do.</p>\n\n<pre><code>class A\n  # expressions are evaluated in scope of class A\n  def m\n    # expressions are evaluated in scope of an instance of A\n    return 42\n  end\nend\n</code></pre>\n\n<p>Class and instance are not the same.</p>\n\n<pre><code>A \na = A.new\n\nA.class # =&gt; Class\na.class # =&gt; A\n\nA.respond_to?(:m) # =&gt; false\na.respond_to?(:m) # =&gt; true\n\nA.m # =&gt; raises NoMethodError\na.m # =&gt; 42\n</code></pre>\n\n<p>Hence in the class body you cannot call instance methods.</p>\n\n<p>Constants however are looked up using lexical scope, that is the surrounding context of classes and modules in the source file. </p>\n\n<pre><code>module M\n  # can access global constants and those defined in M\n  class A\n    # can access global constants and those defined in M or A\n    def m\n      # can access global constants and those defined in M or A\n    end\n  end\nend\n</code></pre>\n\n<p>You can inspect the current constant lookup path with <code>Module.nesting</code></p>\n"}, {"tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 1, "last_activity_date": 1497325399, "last_edit_date": 1497325399, "creation_date": 1482988892, "answer_id": 41373549, "question_id": 41367887, "link": "https://stackoverflow.com/questions/41367887/why-do-i-get-an-undefined-local-variable-or-method-error-when-using-a-constant/41373549#41373549", "title": "Why do I get an undefined local variable or method error when using a constant, but not when using a method?", "body": "<blockquote>\n  <p>I'm not necessarily looking for a hack to make this work, but and [sic]\n  understanding as to why it doesn't.</p>\n</blockquote>\n\n<p>Here's the error message:</p>\n\n<pre><code>undefined local variable or method 'number'\n</code></pre>\n\n<p>When the Ruby interpreter sees <code>number</code> it looks for a local variable or a method named <code>number</code>. In the context of a method, the interpreter reads <code>number</code> as <code>self.number</code>. So this line:</p>\n\n<pre><code>CONSTANT = number / 2\n</code></pre>\n\n<p>is actually considered as:</p>\n\n<pre><code>CONSTANT = self.number / 2\n</code></pre>\n\n<p><strong>So what's <code>self</code>?</strong></p>\n\n<p>Well that depends on where you've defined it (explicitly or implicitly). Within a class block, <code>self</code> is the class itself i.e. <code>OtherThing</code>. Since <code>OtherThing</code> nor any of its ancestors has a class-method <code>number</code> defined, nor does there exist a variable <code>number</code>, Ruby throws the error message.</p>\n\n<p><code>self</code> defined within an instance method definition is the current object. But this is awfully abstract without examples and some more theory. Other relevant topics are <em>Singleton-Classes</em> and <em>Inheritance</em>. If you like books, then I recommend <em>The Well-Grounded Rubyist 2nd Ed, Chapter 5</em> by <em>David A. Black</em>. On second thoughts, read/study the whole book.</p>\n"}], "owner": {"reputation": 921, "user_id": 3601621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/548735107/picture?type=large", "display_name": "Adzz", "link": "https://stackoverflow.com/users/3601621/adzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 41369930, "answer_count": 4, "score": -1, "last_activity_date": 1497325399, "creation_date": 1482950466, "last_edit_date": 1483019200, "question_id": 41367887, "link": "https://stackoverflow.com/questions/41367887/why-do-i-get-an-undefined-local-variable-or-method-error-when-using-a-constant", "title": "Why do I get an undefined local variable or method error when using a constant, but not when using a method?", "body": "<p>How come if I have a class like:</p>\n\n<pre><code>class Thing\n  def number\n    10\n  end\nend\n</code></pre>\n\n<p>And I inherit from it like this:</p>\n\n<pre><code>class OtherThing &lt; Thing\n  CONSTANT = number / 2\nend\n</code></pre>\n\n<p>I get <code>undefined local variable or method 'number'</code> when I try to instantiate the class, but if I do this:</p>\n\n<pre><code>   class OtherThing &lt; Thing\n     def method_instead_of_constant\n       number / 2\n     end\n   end\n</code></pre>\n\n<p>It works?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I'm not necessarily looking for a hack to make this work, but an understanding as to why it doesn't. <code>mudasobwa</code>'s answer below helped the most; constants are assigned at the class level, not on instances.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482949538, "post_id": 41367670, "comment_id": 69936854, "body": "What about <code>text.gsub(&#47;\\R+|\\&#47;&#47;, &#39;&#39;)</code>? However, the escape symbols are most likely to be missing in your actual input."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1482949606, "post_id": 41367670, "comment_id": 69936885, "body": "@WiktorStribi\u017cew those are <i>not actual backslashes</i>. It\u2019s how ruby\u2019s <code>puts</code> outputs double quotes."}, {"owner": {"reputation": 311, "user_id": 2958617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100000054935616/picture?type=large", "display_name": "learning_to_swim", "link": "https://stackoverflow.com/users/2958617/learning-to-swim"}, "edited": false, "score": 0, "creation_date": 1482949615, "post_id": 41367670, "comment_id": 69936891, "body": "That still returns with a backslash"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482949646, "post_id": 41367670, "comment_id": 69936908, "body": "Yes, <code>&#47;\\R+&#47;</code> is enough :)"}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 1, "creation_date": 1482949846, "post_id": 41367670, "comment_id": 69936995, "body": "It&#39;s not clear from your question whether the characters <code>\\\\ </code> and <code>r</code> are in your string, or if they are (as your title suggests) actual carriage return characters. It&#39;s also not clear whether your string is wrapped in double-quote characters (<code>&quot;</code>) or if those are denoting the string in Ruby."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482950008, "post_id": 41367670, "comment_id": 69937070, "body": "@mudasobwa: BTW, it all depends on how this text is declared. With single quoted literals, the backslashes are preserved."}, {"owner": {"reputation": 311, "user_id": 2958617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100000054935616/picture?type=large", "display_name": "learning_to_swim", "link": "https://stackoverflow.com/users/2958617/learning-to-swim"}, "reply_to_user": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1482950264, "post_id": 41367670, "comment_id": 69937198, "body": "@coreyward - I edited my question above to describe how I capture the text. The \\\\ and r are in the text string."}, {"owner": {"reputation": 311, "user_id": 2958617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100000054935616/picture?type=large", "display_name": "learning_to_swim", "link": "https://stackoverflow.com/users/2958617/learning-to-swim"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482950312, "post_id": 41367670, "comment_id": 69937227, "body": "@WiktorStribi\u017cew - Yes, that definitely seems shorter, but I cannot seem to take off the single backslashes that appear in the string."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482950357, "post_id": 41367670, "comment_id": 69937246, "body": "Please post the <i>code</i> to reproduce your issue."}, {"owner": {"reputation": 311, "user_id": 2958617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100000054935616/picture?type=large", "display_name": "learning_to_swim", "link": "https://stackoverflow.com/users/2958617/learning-to-swim"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482950519, "post_id": 41367670, "comment_id": 69937324, "body": "@WiktorStribi\u017cew - The code towards the end of my edited question is all I am using. page.content is actual string that is in blockquotes above."}, {"owner": {"reputation": 1986, "user_id": 3564468, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4cdabbec68b4220322af987fe9e4486b?s=128&d=identicon&r=PG", "display_name": "amitection", "link": "https://stackoverflow.com/users/3564468/amitection"}, "edited": false, "score": 0, "creation_date": 1482950606, "post_id": 41367670, "comment_id": 69937362, "body": "would this work (\\\\r)|(\\\\n)|(\\&#41; ? I tried it with your passage on <a href=\"https://regex101.com/\" rel=\"nofollow noreferrer\">this website</a> and worked fine for me."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482950789, "post_id": 41367670, "comment_id": 69937456, "body": "Look at <a href=\"http://ideone.com/YnATOP\" rel=\"nofollow noreferrer\">ideone.com/YnATOP</a>, there are <i>no</i> escape symbols if the string literal is double-quoted."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482951535, "post_id": 41367670, "comment_id": 69937799, "body": "@mudasobwa <code>puts</code> will actually just show the quotes, but <code>p</code> (or <code>puts str.inspect</code>) will show the quotes escaped (i.e. with backslashes)."}], "answers": [{"tags": [], "owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "is_accepted": true, "score": 4, "last_activity_date": 1482952405, "last_edit_date": 1482952405, "creation_date": 1482951938, "answer_id": 41368230, "question_id": 41367670, "link": "https://stackoverflow.com/questions/41367670/ruby-remove-new-lines-carriage-returns-from-text/41368230#41368230", "title": "Ruby: Remove new lines, carriage returns from text", "body": "<p>The most efficient way to perform this operation is with <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-delete\" rel=\"nofollow noreferrer\"><code>String#delete</code></a> (or <code>#delete!</code>):</p>\n\n<pre><code>text.delete!(\"\\r\\n\\\\\")\np text\nputs\nputs text\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>\"An Ox came down to a reedy pool to drink. As he splashed heavily into\n  the water, he crushed a young Frog into the mud.The old Frog soon\n  missed the little one and asked his brothers and sisters what had\n  become of him.\\\"A great big monster,\\\" said one of them, \\\"stepped on\n  little brother with one of his huge feet!\\\"\\\"Big, was he!\\\" said the\n  old Frog, puffing herself up. \\\"Was he as big as this?\\\"\\\"Oh, much\n  bigger!\\\" they cried.The Frog puffed up still more.\\\"He could not have\n  been bigger than this,\\\" she said. But the little Frogs all declared\n  that the monster was much, much bigger and the old Frog kept puffing\n  herself out more and more until, all at once, she burst.\"</p>\n  \n  <p>An Ox came\n  down to a reedy pool to drink. As he splashed heavily into the water,\n  he crushed a young Frog into the mud.The old Frog soon missed the\n  little one and asked his brothers and sisters what had become of\n  him.\"A great big monster,\" said one of them, \"stepped on little\n  brother with one of his huge feet!\"\"Big, was he!\" said the old Frog,\n  puffing herself up. \"Was he as big as this?\"\"Oh, much bigger!\" they\n  cried.The Frog puffed up still more.\"He could not have been bigger\n  than this,\" she said. But the little Frogs all declared that the\n  monster was much, much bigger and the old Frog kept puffing herself\n  out more and more until, all at once, she burst.</p>\n</blockquote>\n\n<p>Benchmark results:</p>\n\n<pre><code>Warming up --------------------------------------\n         String#gsub     2.826k i/100ms\n           String#tr    35.794k i/100ms\n       String#delete    37.147k i/100ms\nCalculating -------------------------------------\n         String#gsub     29.801k (\u00b1 2.8%) i/s -    149.778k in   5.030044s\n           String#tr    399.391k (\u00b1 3.3%) i/s -      2.004M in   5.024297s\n       String#delete    411.065k (\u00b1 4.0%) i/s -      2.080M in   5.068783s\n</code></pre>\n\n<p>I used <code>/\\R+|\\//</code> for the String#gsub method.</p>\n"}], "owner": {"reputation": 311, "user_id": 2958617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100000054935616/picture?type=large", "display_name": "learning_to_swim", "link": "https://stackoverflow.com/users/2958617/learning-to-swim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1671, "favorite_count": 1, "accepted_answer_id": 41368230, "answer_count": 1, "score": 0, "last_activity_date": 1482952405, "creation_date": 1482949455, "last_edit_date": 1482950158, "question_id": 41367670, "link": "https://stackoverflow.com/questions/41367670/ruby-remove-new-lines-carriage-returns-from-text", "title": "Ruby: Remove new lines, carriage returns from text", "body": "<p>I have a text string such as this, and I need to remove all the carriage returns and backslashes. </p>\n\n<blockquote>\n  <p>An Ox came down to a reedy pool to drink. As he splashed heavily into\n  the water, he crushed a young Frog into the mud.\\r\\n\\r\\nThe old Frog\n  soon missed the little one and asked his brothers and sisters what had\n  become of him.\\r\\n\\r\\n\\\"A great big monster,\\\" said one of them,\n  \\\"stepped on little brother with one of his huge feet!\\\"\\r\\n\\r\\n\\\"Big,\n  was he!\\\" said the old Frog, puffing herself up. \\\"Was he as big as\n  this?\\\"\\r\\n\\r\\n\\\"Oh, much bigger!\\\" they cried.\\r\\n\\r\\nThe Frog puffed\n  up still more.\\r\\n\\r\\n\\\"He could not have been bigger than this,\\\" she\n  said. But the little Frogs all declared that the monster was much,\n  much bigger and the old Frog kept puffing herself out more and more\n  until, all at once, she burst.\\r\\n</p>\n</blockquote>\n\n<p>I tried this, but this still leaves out the the backslashes. </p>\n\n<pre><code>text.gsub(/\\r?\\n|\\r/, \"\")\n</code></pre>\n\n<blockquote>\n  <p>\"An Ox came down to a reedy pool to drink. As he splashed heavily into\n  the water, he crushed a young Frog into the mud.  The old Frog soon\n  missed the little one and asked his brothers and sisters what had\n  become of him.  \\\"A great big monster,\\\" said one of them, \\\"stepped\n  on little brother with one of his huge feet!\\\"  \\\"Big, was he!\\\" said\n  the old Frog, puffing herself up. \\\"Was he as big as this?\\\"  \\\"Oh,\n  much bigger!\\\" they cried.  The Frog puffed up still more.  \\\"He could\n  not have been bigger than this,\\\" she said. But the little Frogs all\n  declared that the monster was much, much bigger and the old Frog kept\n  puffing herself out more and more until, all at once, she burst. \"</p>\n</blockquote>\n\n<p>The following expression seems to match the correct pattern at <a href=\"http://rubular.com\" rel=\"nofollow noreferrer\">www.rubular.com</a> including the individual backslashes, but does not seem to work in my console (Ruby 2.2.1)</p>\n\n<pre><code>text.gsub(/(\\\\r\\\\n)|\\\\/, \"\")\n</code></pre>\n\n<p>Note: For full disclosure, this string of text is captured in an HTML editor and stored into a database column. I have a need to strip out the HTML characters and I use the following -</p>\n\n<pre><code>text = ActionView::Base.full_sanitizer.sanitize(page.content).gsub(/\\r?\\n|\\r\\\\|\\\\/, \"\")\n</code></pre>\n\n<p>I appreciate any help you can provide!</p>\n"}, {"tags": ["html", "css", "ruby", "sinatra"], "answers": [{"tags": [], "owner": {"reputation": 225, "user_id": 5859194, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a539c08ebb2d8bd85d5ac84f29a820ef?s=128&d=identicon&r=PG&f=1", "display_name": "ryanpback", "link": "https://stackoverflow.com/users/5859194/ryanpback"}, "is_accepted": true, "score": 0, "last_activity_date": 1482956748, "creation_date": 1482956748, "answer_id": 41369214, "question_id": 41367437, "link": "https://stackoverflow.com/questions/41367437/css-slow-response-time-with-sinatra/41369214#41369214", "title": "CSS slow response time with Sinatra", "body": "<p>I was not able to find an answer online. However, I cleared my browser cache and it is now working properly. If anybody knows why this is needed, I'd be happy to know why.</p>\n"}], "owner": {"reputation": 225, "user_id": 5859194, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a539c08ebb2d8bd85d5ac84f29a820ef?s=128&d=identicon&r=PG&f=1", "display_name": "ryanpback", "link": "https://stackoverflow.com/users/5859194/ryanpback"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 41369214, "answer_count": 1, "score": 0, "last_activity_date": 1482956748, "creation_date": 1482948381, "question_id": 41367437, "link": "https://stackoverflow.com/questions/41367437/css-slow-response-time-with-sinatra", "title": "CSS slow response time with Sinatra", "body": "<p>I have searched high and low and cannot seem to find an answer to my question. I am creating a webpage using Ruby and Sinatra and I have had some issues with my /css/styles.css. I know that my routing is correct because I have styles being applied to my site; however, I have noticed that sometimes (more often than I'd like) the styles do not want to load. I have a form field that I have hidden with:</p>\n\n<pre><code>#duration-field {\n  display: none;\n}\n</code></pre>\n\n<p>This has been working; however, when I remove it and put it back it just doesn't seem to want to load. This is just one example, but many times, styles do not get applied right away. It may take up to 10 minutes or so for the styles to be applied. As I am sure you can imagine, this really slows down the process. I have tried opening the console, going to sources, and refreshing, but it doesn't seem to affect anything.</p>\n\n<p>Has anybody experienced this before and know what may be causing this?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ruby", "lambda", "proc"], "comments": [{"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1482950301, "post_id": 41367302, "comment_id": 69937220, "body": "For what it&#39;s worth, if you needed this in application you would do <code>-&gt; (x = nil) { x = x || default; ... }</code> where <code>default</code> is the out-of-block, in-scope local variable that you wish to use as the default."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1482952936, "post_id": 41367302, "comment_id": 69938392, "body": "@coreyward I did not ask how to overcome this, <code>-&gt;(x = default) { ... }</code> is sufficiently enough. I asked about why RHO is not treated as it should be."}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 1, "creation_date": 1482953403, "post_id": 41367302, "comment_id": 69938586, "body": "Griping that the behavior is \u201cnot treated as it should be\u201d is not within the scope of Stack Overflow, which aims to assist with actual, non-hypothetical programing questions. This is expected behavior in Ruby, per the language creator."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1482954023, "post_id": 41367302, "comment_id": 69938856, "body": "@coreyward This is an actual, non-hypotetical problem. If you don\u2019t understand it, it does not mean the problem does not exist. RHO in no one language behaves this way. The answer \u201c<code>x = x</code> code takes precedence over common sense and is always resolved to <code>x = nil</code>, despite scoping\u201d would be fine (though a bit frustrating.)"}], "answers": [{"comments": [{"owner": {"reputation": 633, "user_id": 5107759, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/33e659c0770221780a6fd21960909b6d?s=128&d=identicon&r=PG", "display_name": "joanbm", "link": "https://stackoverflow.com/users/5107759/joanbm"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1482952364, "post_id": 41367725, "comment_id": 69938158, "body": "@mudasobwa Are you serious ? What nonsense are you talking about ? In Ruby 2.2 or newer you would even get warning <code>circular argument reference - x</code>. See <a href=\"https://bugs.ruby-lang.org/issues/10314\" rel=\"nofollow noreferrer\">bugreport #10314</a> for details. It confirms what I&#39;ve written."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482953623, "post_id": 41367725, "comment_id": 69938677, "body": "1. It is called \u201cscope\u201d and has nothing to do with \u201cnamespaces,\u201d that usually refers the <code>Module</code> nesting. 2. Methods do introduce new scope, while <code>proc</code>s/<code>lambda</code>s <b>do not</b>; try: <code>x = 1; \u03bb = -&gt;(y = x) { puts local_variables }</code>. 3. In <code>y = x</code>, <code>x</code> is a RHO and must be resolved by the outermost scope. 4. I have no idea, why Matz thinks this behaviour is OK, but fine, MINSWAN."}, {"owner": {"reputation": 633, "user_id": 5107759, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/33e659c0770221780a6fd21960909b6d?s=128&d=identicon&r=PG", "display_name": "joanbm", "link": "https://stackoverflow.com/users/5107759/joanbm"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482954685, "post_id": 41367725, "comment_id": 69939122, "body": "I&#39;m sorry but this is word nitpicking. The main point persists - argument definition overshadows local variables. I&#39;d fix the answer with correct terms."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482954761, "post_id": 41367725, "comment_id": 69939151, "body": "Also, the bug you linked has a little relation to my question: this was breaking change in methods; lambdas behave this way always. That say, in <code>2.1.10</code>, <code>def x; 1; end; def foo(x = x); puts x; end; foo</code> successfully prints <code>1</code>, while my example still fails."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482955826, "post_id": 41367725, "comment_id": 69939606, "body": "If <code>Binding#local_variable_get</code> would work, <code>x = x</code> would indeed work as well. There are apparently three different bindings, one in outer scope, one inside block parameters definitions (sic!) and one inside block itself."}, {"owner": {"reputation": 633, "user_id": 5107759, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/33e659c0770221780a6fd21960909b6d?s=128&d=identicon&r=PG", "display_name": "joanbm", "link": "https://stackoverflow.com/users/5107759/joanbm"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482956010, "post_id": 41367725, "comment_id": 69939683, "body": "It is related, as it concerns name clash between argument name and existing local variable name. In updated example, you dodge with method definition instead of local variable, as in OP. If original example kept, you would receive undefined local variable x error. Btw. Ruby 2.1 is close to EOL."}, {"owner": {"reputation": 633, "user_id": 5107759, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/33e659c0770221780a6fd21960909b6d?s=128&d=identicon&r=PG", "display_name": "joanbm", "link": "https://stackoverflow.com/users/5107759/joanbm"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482956248, "post_id": 41367725, "comment_id": 69939792, "body": "I think you still dont understand. <code>Binding#local_variable_get</code> would work, because it works around name conflict. <code>x = 1; orig = binding; foo = -&gt; (x = orig.local_variable_get(:x)) {p x }; foo.call  # 1</code> ."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482956862, "post_id": 41367725, "comment_id": 69940041, "body": "Ah, being explicitly declared in the outermost scope it indeed would work."}], "tags": [], "owner": {"reputation": 633, "user_id": 5107759, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/33e659c0770221780a6fd21960909b6d?s=128&d=identicon&r=PG", "display_name": "joanbm", "link": "https://stackoverflow.com/users/5107759/joanbm"}, "is_accepted": true, "score": 3, "last_activity_date": 1482954734, "last_edit_date": 1482954734, "creation_date": 1482949697, "answer_id": 41367725, "question_id": 41367302, "link": "https://stackoverflow.com/questions/41367302/lambda-local-variable-default-value-fails-to-use-the-closured-local-variable/41367725#41367725", "title": "Lambda local variable default value fails to use the closured local variable", "body": "<pre><code>\u03bb = -&gt;(x = x) {\u2026}\n</code></pre>\n\n<p>In above code <code>x</code> argument identifier overshadows current scope local variable of the same name, so default value already refers to this argument and not original <code>x</code>.</p>\n\n<p>For default value you may use distinct local variable name, instance variable or if insist, get outer <code>x</code> through <code>Binding#local_variable_get</code>.</p>\n"}], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 41367725, "answer_count": 1, "score": -2, "last_activity_date": 1483005928, "creation_date": 1482947820, "last_edit_date": 1482957464, "question_id": 41367302, "link": "https://stackoverflow.com/questions/41367302/lambda-local-variable-default-value-fails-to-use-the-closured-local-variable", "title": "Lambda local variable default value fails to use the closured local variable", "body": "<p>Consider the following piece of code:</p>\n\n<pre><code>x = 1\n\u03bb = -&gt;(x = x) { puts \"[#{x}]\"; x = 2; puts \"[#{x}]\" }\n</code></pre>\n\n<p>I would expect that <em>the value of the topmost level local variable <code>x</code></em> will be used as a default value for the lambda\u2019s local variable <code>x</code>. That said, the code above should be more or less equivalent to:</p>\n\n<pre><code>\u03bb = -&gt;(x = 1) { puts \"[#{x}]\"; x = 2; puts \"[#{x}]\" }\n</code></pre>\n\n<p>Unfortunately, that is not the case: <code>(x = x)</code> is not treated that way and lambda\u2019s local <code>x</code> is being initially set to <code>nil</code>:</p>\n\n<pre><code>\u03bb.()\n#\u21d2\u00a0[]\n#  [2]\n</code></pre>\n\n<p>Why the RHO in <code>(x = x)</code> is not taken from the outermost <code>binding</code>?</p>\n"}, {"tags": ["ruby", "lambda"], "comments": [{"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 1, "creation_date": 1482944673, "post_id": 41366310, "comment_id": 69934517, "body": "Did you really search it before posting? <a href=\"http://stackoverflow.com/questions/16699595/how-to-use-truly-local-variables-in-ruby-proc-lambda\">Here you go</a>"}, {"owner": {"reputation": 63, "user_id": 7350745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afeb8386ae6b060fcf47f4370618c8e?s=128&d=identicon&r=PG", "display_name": "Surfrider", "link": "https://stackoverflow.com/users/7350745/surfrider"}, "reply_to_user": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 0, "creation_date": 1482945006, "post_id": 41366310, "comment_id": 69934684, "body": "Yes, however there is no answer to my question. I can use ; to declare the variable as local, but then the initial value won&#39;t be visible in the lambda. I was looking for something like C++ blocks behaviour."}, {"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 1, "creation_date": 1482945721, "post_id": 41366310, "comment_id": 69935020, "body": "You can pass <code>x</code> in the lambda if you declare lambda as <code>foo = lambda |y| do</code>. In that way, <code>y</code> won&#39;t conflict with outer variable <code>x</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 1, "creation_date": 1482949203, "post_id": 41367035, "comment_id": 69936688, "body": "Having said that, on the whole it&#39;s considered good style to not shadow outer variables in blocks even if it is a block-local variable."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1482957707, "post_id": 41367035, "comment_id": 69940404, "body": "The <code>|;x|</code> method is a solution to this, but it&#39;s highly irregular and best avoided. Shadowing names is a problem that should be avoided, not paved over with tricks. That&#39;s really intended as a last-resort for situations where there&#39;s no other option."}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 1, "creation_date": 1482957719, "post_id": 41367035, "comment_id": 69940406, "body": "Wow just wow, Ruby never keeps surprising me with unknown features."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1482993932, "post_id": 41367035, "comment_id": 69950613, "body": "@tadman I spent 10 minutes trying to imagine the situation \u201cwhere there&#39;s no other option, but shadowing an outer variable,\u201d and frankly I did not succeed :)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1482994225, "post_id": 41367035, "comment_id": 69950727, "body": "@mudasobwa I can think of a few: ERB-like scripting wrappers where you&#39;re making scandalous use of <code>eval</code> and other trickery, or <code>instance_eval</code> like situations where you rebind the block scope. In other words, dark sorcery."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1482994377, "post_id": 41367035, "comment_id": 69950783, "body": "@tadman o_O I was under an impression that <i>I am</i> a freak inventing weird solutions here :)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1482995616, "post_id": 41367035, "comment_id": 69951274, "body": "@mudasobwa It&#39;s nice that Ruby gives you a way out of a jam in those situations, it makes it more feature complete. Just because you <i>can</i> do something doesn&#39;t mean you should, but it&#39;s nice to have that option."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 7, "last_activity_date": 1482971543, "last_edit_date": 1482971543, "creation_date": 1482946638, "answer_id": 41367035, "question_id": 41366310, "link": "https://stackoverflow.com/questions/41366310/local-variables-in-blocks/41367035#41367035", "title": "local variables in blocks", "body": "<h1>Block local variables</h1>\n\n<p>I agree it's not very googleable if you don't know the exact term. Here you go :</p>\n\n<pre><code>x = 1\n\nfoo = lambda do\n  x = 2\nend\n\nfoo.call\n\np x # =&gt; 2\n\nx = 1\n\nfoo = lambda do |;x|\n  x = 2\nend\n\nfoo.call\n\np x # =&gt; 1\n</code></pre>\n\n<p>It's been available since Ruby 1.9, but I don't come across it often (if at all).\nIt's described <a href=\"https://docs.ruby-lang.org/en/2.3.0/syntax/calling_methods_rdoc.html#label-Block+Local+Arguments\" rel=\"nofollow noreferrer\">here</a>, and it's called \"block-local variable\" or \"block-local argument\" :</p>\n\n<blockquote>\n  <p>You may also declare block-local arguments to a block using ';' in the\n  block arguments list. Assigning to a block-local argument will not\n  override local arguments outside the block in the caller's scope</p>\n</blockquote>\n\n<h1>Alternative</h1>\n\n<p>@EliSadoff and @tadman make a very valid point in comments.</p>\n\n<p>There's a good reason those block local variables aren't used often : it's usually not a good idea to shadow an outer variable in a block. It might make the code harder to read, harder to understand and harder to use.</p>\n\n<p>With Ruby blocks, outer and block variables are often related, but not equivalent : </p>\n\n<ul>\n<li><code>filename</code> as outer variable, <code>file</code> as block variable with <code>IO.open</code></li>\n<li><code>array</code> as outer variable, <code>element</code> as block variable with <code>Array#each</code></li>\n<li><code>strings</code> as outer variable, <code>string</code> as block variable with <code>Array#map</code></li>\n</ul>\n\n<p>If you need a <a href=\"https://en.wikipedia.org/wiki/Free_variables_and_bound_variables\" rel=\"nofollow noreferrer\">bound variable</a> and <code>x</code> is already used as an outer variable, just use <code>y</code>, <code>i</code>, <code>z</code>, <code>m</code>, <code>n</code> or <code>whatever</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482972037, "post_id": 41367237, "comment_id": 69945158, "body": "Interesting, as always. At least it is consistent with the other feature/bug <code>a=a #=&gt; nil</code> when <code>a</code> is undefined. The interpreter is nice enough to say &quot;warning: circular argument reference - x&quot;, though."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482994024, "post_id": 41367237, "comment_id": 69950649, "body": "@EricDuminil \u201cThe interpreter is nice enough to say \u2018warning: circular argument reference - x\u2019\u201d\u2014starting with 2.2 and because of mostly unrelated <a href=\"https://bugs.ruby-lang.org/issues/10314\" rel=\"nofollow noreferrer\">breaking change</a> :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1482947519, "creation_date": 1482947519, "answer_id": 41367237, "question_id": 41366310, "link": "https://stackoverflow.com/questions/41366310/local-variables-in-blocks/41367237#41367237", "title": "local variables in blocks", "body": "<p>Blocks are not closures.</p>\n\n<p>To achieve the behaviour you are looking for (get an access to the outermost variable and be free in changing it,) one might do the following:</p>\n\n<pre><code>x = 1\nfoo = -&gt;(y = x) { puts y; y = 2; puts y }\nfoo.()\nputs x\n#\u21d2 1\n#  2\n#  1\n</code></pre>\n\n<p>It\u2019s unclear why one can\u2019t use the same name for the block local variable, though.</p>\n\n<pre><code>foo = -&gt;(x = x) { puts x; x = 2; puts x }\n#\u21d2\u00a0   # nil ?! WHY?\n#  2\n</code></pre>\n\n<p>I would consider the latter being a bug in ruby interpreter.</p>\n"}], "owner": {"reputation": 63, "user_id": 7350745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afeb8386ae6b060fcf47f4370618c8e?s=128&d=identicon&r=PG", "display_name": "Surfrider", "link": "https://stackoverflow.com/users/7350745/surfrider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1482971543, "creation_date": 1482943626, "question_id": 41366310, "link": "https://stackoverflow.com/questions/41366310/local-variables-in-blocks", "title": "local variables in blocks", "body": "<p>In this example</p>\n\n<pre><code>x = 1\n\nfoo = lambda do\n  x = 2\nend\n\nfoo.call\n</code></pre>\n\n<p>foo will change the value of x. Is it possible to hide the value of x so that it stays the same before and after the proc call?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "session", "capistrano", "sidekiq"], "answers": [{"comments": [{"owner": {"reputation": 5645, "user_id": 394241, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3053d95e25ab78a2c696b6e24c7dd8cf?s=128&d=identicon&r=PG", "display_name": "daveomcd", "link": "https://stackoverflow.com/users/394241/daveomcd"}, "edited": false, "score": 0, "creation_date": 1482948661, "post_id": 41366917, "comment_id": 69936431, "body": "where exactly do i put this?"}, {"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "reply_to_user": {"reputation": 5645, "user_id": 394241, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3053d95e25ab78a2c696b6e24c7dd8cf?s=128&d=identicon&r=PG", "display_name": "daveomcd", "link": "https://stackoverflow.com/users/394241/daveomcd"}, "edited": false, "score": 1, "creation_date": 1482948995, "post_id": 41366917, "comment_id": 69936596, "body": "Oh! Sorry I forgot to mention. You can add this line in your <code>routes.rb</code>, just before you mount the sidekiq web interface (<code>mount Sidekiq::Web =&gt; &#39;&#47;sidekiq&#39;</code>)."}], "tags": [], "owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "is_accepted": true, "score": 1, "last_activity_date": 1482946071, "creation_date": 1482946071, "answer_id": 41366917, "question_id": 41366071, "link": "https://stackoverflow.com/questions/41366071/how-do-i-set-my-new-secret-key-base-for-sidekiq-in-rails/41366917#41366917", "title": "How do I set my new secret key base for Sidekiq in Rails?", "body": "<p>You can do the following to share Rails' secret key base with Sidekiq web interface:</p>\n\n<pre><code>Sidekiq::Web.set :session_secret, Rails.application.secrets[:secret_key_base]\n</code></pre>\n"}], "owner": {"reputation": 5645, "user_id": 394241, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3053d95e25ab78a2c696b6e24c7dd8cf?s=128&d=identicon&r=PG", "display_name": "daveomcd", "link": "https://stackoverflow.com/users/394241/daveomcd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "accepted_answer_id": 41366917, "answer_count": 1, "score": 0, "last_activity_date": 1482946071, "creation_date": 1482942641, "question_id": 41366071, "link": "https://stackoverflow.com/questions/41366071/how-do-i-set-my-new-secret-key-base-for-sidekiq-in-rails", "title": "How do I set my new secret key base for Sidekiq in Rails?", "body": "<p>I am using the following gems in my application.</p>\n\n<pre><code>gem 'activerecord-session_store'\ngem 'sidekiq'\ngem 'sidekiq-unique-jobs'\ngem 'sidekiq-cron'\ngem 'sinatra', require: false\ngem 'capistrano-sidekiq', github: 'seuros/capistrano-sidekiq'\n</code></pre>\n\n<p>I recently started using <code>activerecord-session_store</code> and in the process I remember having to update my <code>secret_key_base</code> for my application.  Now when I try to make changes through the SideKiq admin panel I always get a blank white page that says \"forbidden\".  I'm guessing that my session is not being shared correctly? How can I set up SideKiq to use the same secret_key_base as my application?</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1482948238, "post_id": 41366011, "comment_id": 69936219, "body": "@sagarpandya82 how this might be a duplicate of the question, that <b>is linked in the very first sentence</b>?!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482948457, "post_id": 41366011, "comment_id": 69936331, "body": "@mu-is-too-short the question which is now marked as duplicate is <b>linked in the very first sentence</b>."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1482949238, "post_id": 41366011, "comment_id": 69936711, "body": "@mudasobwa despite the link appearing in the question I still thought it a duplicate. But I guess I have been overruled by the Community, which is fair enough."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1482949293, "post_id": 41366011, "comment_id": 69936743, "body": "@sagarpandya82 you have been overruled by me personally :)"}], "answers": [{"tags": [], "owner": {"reputation": 1105, "user_id": 391122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/63c655bc5282d3f343574aef29de460a?s=128&d=identicon&r=PG", "display_name": "Jared", "link": "https://stackoverflow.com/users/391122/jared"}, "is_accepted": false, "score": 0, "last_activity_date": 1482943167, "creation_date": 1482943167, "answer_id": 41366191, "question_id": 41366011, "link": "https://stackoverflow.com/questions/41366011/brackets-method-taking-an-array-as-the-argument/41366191#41366191", "title": "Brackets [...] method taking an array as the argument", "body": "<p>If it is a hash you can have the key be an array.  So you can look up via that.  In your examples you are trying to do something similar on <code>b</code> but it has no matching keys to your array param.</p>\n\n<pre><code>foo = {['bar'] =&gt; 'value'}\nfoo[['bar']]\n   =&gt; \"value\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6391, "user_id": 2909897, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LMSiW.jpg?s=128&g=1", "display_name": "mbigras", "link": "https://stackoverflow.com/users/2909897/mbigras"}, "is_accepted": false, "score": 0, "last_activity_date": 1482947411, "last_edit_date": 1482947411, "creation_date": 1482946125, "answer_id": 41366932, "question_id": 41366011, "link": "https://stackoverflow.com/questions/41366011/brackets-method-taking-an-array-as-the-argument/41366932#41366932", "title": "Brackets [...] method taking an array as the argument", "body": "<p>Going off @Jared's answer, the important point is a hash's key can be an array. Another way to say this is a hash's <code>[]</code> method can take an array as an argument.</p>\n\n<p>Also from another perspective: an array's index cannot be an array. Another way to say this is an array's <code>[]</code> method cannot take an array as an argument.  </p>\n\n<p>Now the examples above make sense.</p>\n\n<pre><code>[11] pry(main)&gt; a = %w( foo bar baz )\n=&gt; [\"foo\", \"bar\", \"baz\"]\n[12] pry(main)&gt; a[[1,2]]\nTypeError: no implicit conversion of Array into Integer\nfrom (pry):11:in `[]'\n[13] pry(main)&gt; a[['foo', 'bar']]\nTypeError: no implicit conversion of Array into Integer\nfrom (pry):12:in `[]'\n</code></pre>\n\n<p>As mentioned above, this is an error because an array takes an integer as an index, not an array.</p>\n\n<pre><code>[14] pry(main)&gt; b = { foo: 42, bar: \"dolphins\", baz: \"towels\" }\n=&gt; {:foo=&gt;42, :bar=&gt;\"dolphins\", :baz=&gt;\"towels\"}\n[15] pry(main)&gt; b[[:foo, :bar]]\n=&gt; nil\n[16] pry(main)&gt; b[[\"dolphins\"]]\n=&gt; nil\n</code></pre>\n\n<p>This isn't an error because a hash's key can be an array. However, the keys <code>[:foo, :bar]</code> and <code>[\"dolphins\"]</code> haven't been defined so they return <code>nil</code></p>\n\n<p>Another more illustrative example is:</p>\n\n<pre><code>[1] pry(main)&gt; h = { foo: 42, bar: \"cats\" }\n=&gt; {:foo=&gt;42, :bar=&gt;\"cats\"}\n[2] pry(main)&gt; h[[:foo, :bar]]\n=&gt; nil\n[3] pry(main)&gt; h[[:foo, :bar]] = \"dogs\"\n=&gt; \"dogs\"\n[4] pry(main)&gt; h[[:foo, :bar]]\n=&gt; \"dogs\"\n[5] pry(main)&gt; h\n=&gt; {:foo=&gt;42, :bar=&gt;\"cats\", [:foo, :bar]=&gt;\"dogs\"}\n</code></pre>\n\n<p>In <code>[3]</code> we define the key <code>[:foo, :bar]</code> in the hash <code>h</code> to have the value <code>\"dogs\"</code> so in <code>[4]</code> that's what gets returned, and in <code>[5]</code> we can see the key-value pair inside the hash.</p>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1482947934, "last_edit_date": 1482947934, "creation_date": 1482947202, "answer_id": 41367165, "question_id": 41366011, "link": "https://stackoverflow.com/questions/41366011/brackets-method-taking-an-array-as-the-argument/41367165#41367165", "title": "Brackets [...] method taking an array as the argument", "body": "<h1>Receiver is a Hash</h1>\n\n<p>Receiver could be a Hash, with Arrays as keys</p>\n\n<h1>Splat the parameter</h1>\n\n<p>You could also splat the array :</p>\n\n<pre><code>a = %w( foo bar baz )\na[*[1,2]]\n#=&gt; [\"bar\", \"baz\"]\n</code></pre>\n\n<p>This syntax is equivalent to <code>a[1,2]</code> and means <code>take 2 values beginning at index 1</code></p>\n\n<h1>Define a custom class and [] method</h1>\n\n<p>You could also define a custom class and a <code>[]</code> method, accepting any object :</p>\n\n<pre><code>class MyObject\n  def self.[](argument)\n    \"MyObject[] has been called with an #{argument.class}\"\n    # do something with argument\n  end\nend\n\nputs MyObject[[1,2,3]]    #=&gt; MyObject[] has been called with an Array\nputs MyObject[Object.new] #=&gt; MyObject[] has been called with an Object\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1482948617, "creation_date": 1482948617, "answer_id": 41367488, "question_id": 41366011, "link": "https://stackoverflow.com/questions/41366011/brackets-method-taking-an-array-as-the-argument/41367488#41367488", "title": "Brackets [...] method taking an array as the argument", "body": "<p>This is ruby. <code>Whatever#[]</code> is just a method. Consider <code>Hash</code> class, defining class method <a href=\"https://ruby-doc.org/core-2.3.0/Hash.html#method-c-5B-5D\" rel=\"nofollow noreferrer\"><code>Hash#[]</code></a>. It is used for constructing a <code>Hash</code> instance out of an array of 2-sized arrays:</p>\n\n<pre><code>Hash[[[:foo, 42]]]\n#\u21d2\u00a0{ :foo =&gt; 42 }\n</code></pre>\n\n<p>Also, <code>Hash</code> itself might have arrays as keys:</p>\n\n<pre><code>hash = { [1, 2, 3] =&gt; :foo }\nhash[[1, 2, 3]]\n#\u21d2 :foo\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 1, "last_activity_date": 1482969116, "last_edit_date": 1482969116, "creation_date": 1482960999, "answer_id": 41370062, "question_id": 41366011, "link": "https://stackoverflow.com/questions/41366011/brackets-method-taking-an-array-as-the-argument/41370062#41370062", "title": "Brackets [...] method taking an array as the argument", "body": "<p><code>[]</code> is just another method.</p>\n\n<p>Unlike other languages, Ruby operators are just method and any method can take any object as argument, including an array. </p>\n\n<pre><code>class A\n  def [](key)\n    p key\n  end\n  def example(key)\n    p key\n  end \nend\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>a = A.new\n\na[1] # =&gt; 1\na[[1, 2, 3]] # =&gt; [1, 2, 3]\n\na.[](1) # =&gt; 1\na.[]([1, 2, 3]) # =&gt; [1, 2, 3]\n\na.example(1) # =&gt; 1\na.example([1, 2, 3]) # =&gt;  [1, 2, 3]\n\na.send(:'[]', 1) # =&gt; 1\na.send(:'[]', [1, 2, 3]) # =&gt; [1, 2, 3]\n\na.send(:example, 1) # =&gt; 1\na.send(:example, [1, 2, 3]) # =&gt; [1, 2, 3]\n</code></pre>\n\n<p>Other operator methods in Ruby are</p>\n\n<ul>\n<li><code>def []=(key, value)</code></li>\n<li><code>def +(other)</code></li>\n<li><code>def -(other)</code></li>\n<li><code>def *(other)</code></li>\n<li><code>def /(other)</code></li>\n<li><code>def %(other)</code></li>\n<li><code>def &amp;(other)</code></li>\n<li><code>def |(other)</code></li>\n<li><code>def ^(other)</code></li>\n<li><code>def ~(other)</code></li>\n<li><code>def ==(other)</code></li>\n<li><code>def ===(other)</code></li>\n<li><code>def &lt;=&gt;(other)</code></li>\n<li><code>def &lt;=(other)</code></li>\n<li><code>def &gt;=(other)</code></li>\n<li><code>def &lt;(other)</code></li>\n<li><code>def &gt;(other)</code></li>\n<li><code>def &lt;&lt;(other)</code></li>\n<li><code>def !</code></li>\n<li><code>def ~</code></li>\n<li><code>def +@</code> as in <code>+a</code></li>\n<li><code>def -@</code> as in <code>-a</code></li>\n</ul>\n"}], "owner": {"reputation": 6391, "user_id": 2909897, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LMSiW.jpg?s=128&g=1", "display_name": "mbigras", "link": "https://stackoverflow.com/users/2909897/mbigras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 41370062, "answer_count": 5, "score": 1, "last_activity_date": 1482969116, "creation_date": 1482942373, "last_edit_date": 1495541784, "question_id": 41366011, "link": "https://stackoverflow.com/questions/41366011/brackets-method-taking-an-array-as-the-argument", "title": "Brackets [...] method taking an array as the argument", "body": "<p>I read in <a href=\"https://stackoverflow.com/questions/20361770/double-square-brackets-in-ruby\">another answer</a> that the <code>[]</code> method can take an array as an argument.</p>\n\n<p>Both the examples given in the linked post don't illustrate what the actual result is from using this technique.</p>\n\n<p>I tried some examples which also don't provide much information:</p>\n\n<pre><code>[11] pry(main)&gt; a = %w( foo bar baz )\n=&gt; [\"foo\", \"bar\", \"baz\"]\n[12] pry(main)&gt; a[[1,2]]\nTypeError: no implicit conversion of Array into Integer\nfrom (pry):11:in '[]'\n[13] pry(main)&gt; a[['foo', 'bar']]\nTypeError: no implicit conversion of Array into Integer\nfrom (pry):12:in '[]'\n[14] pry(main)&gt; b = { foo: 42, bar: \"dolphins\", baz: \"towels\" }\n=&gt; {:foo=&gt;42, :bar=&gt;\"dolphins\", :baz=&gt;\"towels\"}\n[15] pry(main)&gt; b[[:foo, :bar]]\n=&gt; nil\n[16] pry(main)&gt; b[[\"dolphins\"]]\n=&gt; nil\n</code></pre>\n\n<p>What does it mean for the <code>[]</code> to take an array as an argument? What context is this technique used?</p>\n\n<p>Would appreciate some runnable examples that will help me understand why all my examples return either <code>nil</code> or an error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1482941059, "post_id": 41364975, "comment_id": 69932641, "body": "If you want it done on the client you have to use javascript"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 7068409, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b6d842dc40dba7077f68f7aeadab2c32?s=128&d=identicon&r=PG&f=1", "display_name": "HAYATO SHIBA", "link": "https://stackoverflow.com/users/7068409/hayato-shiba"}, "edited": false, "score": 0, "creation_date": 1482967230, "post_id": 41365859, "comment_id": 69943851, "body": "I see! Thank you for your advise!"}], "tags": [], "owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "is_accepted": true, "score": 0, "last_activity_date": 1482941817, "last_edit_date": 1495540423, "creation_date": 1482941817, "answer_id": 41365859, "question_id": 41364975, "link": "https://stackoverflow.com/questions/41364975/date-select-in-rails-how-do-i-get-the-selected-value/41365859#41365859", "title": "date_select in rails , How do I get the selected value?", "body": "<p>That's a client side matter, you should handle it using javascript. This may help you: <a href=\"https://stackoverflow.com/questions/5234052/form-days-value-change-with-respect-to-the-month\">Form days value change with respect to the month</a>.</p>\n"}], "owner": {"reputation": 131, "user_id": 7068409, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b6d842dc40dba7077f68f7aeadab2c32?s=128&d=identicon&r=PG&f=1", "display_name": "HAYATO SHIBA", "link": "https://stackoverflow.com/users/7068409/hayato-shiba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 41365859, "answer_count": 1, "score": 0, "last_activity_date": 1482942289, "creation_date": 1482938629, "last_edit_date": 1482942289, "question_id": 41364975, "link": "https://stackoverflow.com/questions/41364975/date-select-in-rails-how-do-i-get-the-selected-value", "title": "date_select in rails , How do I get the selected value?", "body": "<p>My view file is below.</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n    &lt;%= f.label :deadline , class:\"form-label\"  %&gt;&lt;br /&gt;\n    &lt;%= f.date_select( :deadline , use_month_numbers: true , start_year: (Time.now.year) , end_year: (Time.now.year+1) , start_month: (Time.now.month) , end_month: (12) , start_day: (Time.now.day) , end_day: (days_in_month(Time.now.month)) , default: Date.new(Time.now.year , Time.now.month , Time.now.day) , date_separator: '/' ) %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>days_in_month(Time.now.month) is helper method.</p>\n\n<pre><code>def days_in_month(month, year = Time.now.year)\n   common_year_days_in_month = [nil, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]\n   return 29 if month == 2 &amp;&amp; Date.gregorian_leap?(year)\n   common_year_days_in_month[month]\nend\n</code></pre>\n\n<p>In this case , when user selects 'month', 'day' doesn't change.\nFor example, in 2016-12-28, The page shows 2016/12/28 in default, and the end_day is 31 because 12 month has 31 days. But although user selects 11 month , end_day is 31 because 12 month has 31 days. in the case , I want to show 30 in end_day. Please help me...</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "carrierwave", "image-uploading"], "comments": [{"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1482940104, "post_id": 41364235, "comment_id": 69932098, "body": "add full controller code and your model too. Also logs can be helpfull"}, {"owner": {"reputation": 13, "user_id": 7064045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b3a90e115a345101f87f782d253ccb0?s=128&d=identicon&r=PG&f=1", "display_name": "Milou", "link": "https://stackoverflow.com/users/7064045/milou"}, "reply_to_user": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483346125, "post_id": 41364235, "comment_id": 70052434, "body": "@sig thanks, will do"}], "owner": {"reputation": 13, "user_id": 7064045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b3a90e115a345101f87f782d253ccb0?s=128&d=identicon&r=PG&f=1", "display_name": "Milou", "link": "https://stackoverflow.com/users/7064045/milou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483346079, "creation_date": 1482935947, "last_edit_date": 1483346079, "question_id": 41364235, "link": "https://stackoverflow.com/questions/41364235/photo-preview-is-shown-but-photo-is-not-saved-in-form-using-carrierwave-and-pre", "title": "Photo preview is shown but photo is not saved in form: using Carrierwave and preview photo with JS", "body": "<p>I'm trying to update a profile picture from a user through a (edit)-form. I want to show the user which photo it is trying to upload, so I've used JS to preview the selected photo. The problem is that the preview is showing, but the new photo isn't saved through the form.</p>\n\n<p>Any ideas on what I might have missed?</p>\n\n<p><code>edit.html.erb</code></p>\n\n<pre><code>&lt;%= f.inputs do %&gt;\n &lt;% if @user.photo? %&gt;\n  &lt;div id=\"photo_edit\"&gt;\n    &lt;img id=\"img_prev\" class=\"profile_photo_edit\" src=\"&lt;%= current_user.photo %&gt;\"&gt;\n     &lt;label id=\"photo-edit-button\"&gt;\n      &lt;input type='file' onchange=\"readURL(this);\" /&gt;\n      &lt;%= f.file_field :photo %&gt;\n      &lt;%= f.hidden_field :photo_cache %&gt;\n      &lt;span&gt;Wijzig foto&lt;/span&gt;\n     &lt;/label&gt;\n  &lt;/div&gt;\n &lt;% else %&gt;\n  &lt;div id=\"photo_edit\"&gt;\n   &lt;%= image_tag \"PICA.jpg\", :id =&gt; \"img_prev\", :class =&gt; \"profile_photo_edit\"%&gt;\n    &lt;label id=\"photo-edit-button\"&gt;\n     &lt;input type='file' onchange=\"readURL(this);\" /&gt;\n     &lt;%= f.file_field :photo %&gt;\n     &lt;%= f.hidden_field :photo_cache %&gt;\n     &lt;span&gt;Wijzig foto&lt;/span&gt;\n    &lt;/label&gt;\n   &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><code>photo-preview.js</code></p>\n\n<pre><code>function readURL(input) {\n  if (input.files &amp;&amp; input.files[0]) {\n    var reader = new FileReader();\n\n      reader.onload = function (e) {\n        $('#img_prev')\n        .attr('src', e.target.result)\n        .width(100)\n        .height(100);\n      };\n\n        reader.readAsDataURL(input.files[0]);\n      }\n    }\n</code></pre>\n\n<p><code>users_controller.rb</code></p>\n\n<pre><code>    class Profile::UsersController &lt; ApplicationController\n      skip_before_filter :verify_authenticity_token\n      before_action :correct_user,   only: [:edit, :update]\n\n\n      def index\n\n      # pagination\n      @users = User.order(:name)\n\n      query = params[:search].presence || \"*\"\n      @results = User.search params[:search], page: params[:page], per_page: 9\n\n      # @results = User.search params[:search], where: {id: {not:         current_user.id}}\n    end\n\n\n    def create\n      @user = User.new(user_params)\n\n      if @user.save\n        redirect_to :action =&gt; 'show'\n      else\n        render :action =&gt; 'edit'\n      end\n    end\n\n    def new\n      @user = current_user\n    end\n\n    def show\n      @user = User.find(params[:id])\n      map\n      @competences = @user.competences.all\n    end\n\n    def edit\n      @user = User.find(params[:id])\n      @profiles = Profile.all\n      @locations = Location.all\n      @positions = Position.all\n      @competences = Competence.all\n    end\n\n    def update\n      @user = User.find(params[:id])\n\n      if @user.update_attributes(user_params)\n\n        print \"--------\"\n        @bla = []\n        @usercompetence = @user.competences\n\n          # Insert / add expertises\n          for competence in params[:expertises]\n            print competence\n\n            if competence.blank?\n              next\n            end\n\n            print \"\\n\"\n            comp_object = nil\n\n            if Competence.exists?(id: competence)\n              comp_object = Competence.find(competence)\n            elsif Competence.exists?(name: competence, user_id: current_user.id)\n              comp_object = Competence.where(name: competence, user_id: current_user.id).first()\n            else\n              comp_object = Competence.new(name: competence, user_id: current_user.id, category: \"expertise\")\n              comp_object.save\n            end\n\n            print \"adding...\"\n            print comp_object[:name]\n            print comp_object[:category]\n            print \"\\n\"\n            @bla &lt;&lt; comp_object\n\n            unless @usercompetence.include?(comp_object)\n              @usercompetence &lt;&lt; comp_object\n            end\n          end\n\n          # Insert / add expertises\n          for competence in params[:competenties]\n            print competence\n\n            if competence.blank?\n              next\n            end\n\n            print \"\\n\"\n            comp_object = nil\n\n            if Competence.exists?(id: competence)\n              comp_object = Competence.find(competence)\n            elsif Competence.exists?(name: competence, user_id: current_user.id)\n              comp_object = Competence.where(name: competence, user_id: current_user.id).first()\n            else\n              comp_object = Competence.new(name: competence, user_id: current_user.id, category: \"competence\")\n              comp_object.save\n            end\n\n            print \"adding...\"\n            print comp_object[:name]\n            print comp_object[:category]\n            print \"\\n\"\n            @bla &lt;&lt; comp_object\n\n            unless @usercompetence.include?(comp_object)\n              @usercompetence &lt;&lt; comp_object\n            end\n          end\n\n          # Delete competences from user\n          print \"--------\"\n          for competence in @usercompetence\n            print \"Checking..\"\n            print competence[:name]\n            unless @bla.include?(competence)\n              print \"Delete...\"\n              @usercompetence.delete(competence)\n            end\n          end\n          print \"-------------\"\n\n          @user.save\n\n          redirect_to :action =&gt; 'show'\n\n        end\n      end\n\n      def destroy\n        Profile.find(params[:id]).destroy\n        redirect_to :action =&gt; 'new'\n      end\n\n      private\n\n      def user_params\n        params.require(:user).permit(:first_name, :last_name, :current_position, :position_description, :email, :phonenumber, :linkedin, :skype, :location_id, :location_specs, :photo, :photo_cache)\n      end\n\n\n      def map\n        @user = User.find(params[:id])\n        if @user.location_id\n          @location = Location.find(@user.location_id)\n        end\n        @hash = Gmaps4rails.build_markers(@location) do |location, marker|\n          marker.lat location.latitude\n          marker.lng location.longitude\n        end\n      end\n\n      def correct_user\n        @user = User.find(params[:id])\n        redirect_to(root_url) unless @user == current_user\n      end\n\n    end\n</code></pre>\n\n<p>user.rb</p>\n\n<pre><code>    class User &lt; ApplicationRecord\n      # Include default devise modules. Others available are:\n      # :confirmable, :lockable, :timeoutable and :omniauthable\n      devise :database_authenticatable, :registerable,\n      :recoverable, :rememberable, :trackable, :validatable\n\n      mount_uploader :photo, PhotoUploader\n\n      searchkick\n      paginates_per 6\n\n      before_save :generate_competence?\n\n      belongs_to :location\n      has_one :profile, dependent: :destroy\n      has_and_belongs_to_many :competences\n\n      def search_data\n        attributes.merge(\n          competence_name: competences.map(&amp;:name),\n          location_name: location(&amp;:name)\n          )\n      end\n    end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "prawn"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1482936050, "post_id": 41364119, "comment_id": 69929795, "body": "the solution I would use it to determine if the chart can fit in the remaining space and if not then add a page and render there. e.g. current cursor position + chart height &gt; bottom of page"}, {"owner": {"reputation": 393, "user_id": 1763639, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pJH8i.jpg?s=128&g=1", "display_name": "adavia", "link": "https://stackoverflow.com/users/1763639/adavia"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1482936820, "post_id": 41364119, "comment_id": 69930236, "body": "What is bottom of page? Can you show me with some code if possible?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1483022148, "post_id": 41364119, "comment_id": 69965370, "body": "I have added an &quot;Answer&quot; more to answer your comment than you question but it should help with both"}], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 1763639, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pJH8i.jpg?s=128&g=1", "display_name": "adavia", "link": "https://stackoverflow.com/users/1763639/adavia"}, "edited": false, "score": 0, "creation_date": 1482942539, "post_id": 41365429, "comment_id": 69933456, "body": "Yes i get undefined method `chart&#39; for #&lt;Prawn::Document:0xb006b084&gt; when using g.chart"}, {"owner": {"reputation": 2594, "user_id": 2628223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dbHga.jpg?s=128&g=1", "display_name": "BigRon", "link": "https://stackoverflow.com/users/2628223/bigron"}, "reply_to_user": {"reputation": 393, "user_id": 1763639, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pJH8i.jpg?s=128&g=1", "display_name": "adavia", "link": "https://stackoverflow.com/users/1763639/adavia"}, "edited": false, "score": 0, "creation_date": 1482945243, "post_id": 41365429, "comment_id": 69934809, "body": "OK, I think I have that figured out. You&#39;re going to want to copy from line 7 to line 63 from <a href=\"https://github.com/ddengler/prawn-grouping/blob/master/lib/prawn/grouping.rb\" rel=\"nofollow noreferrer\">this file in the grouping gem</a> into your <code>survey_pdf.rb</code>. Then remove the grouping-gem from your app and re-run. If this works (pretty sure it will); I&#39;ll explain and update my answer"}, {"owner": {"reputation": 393, "user_id": 1763639, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pJH8i.jpg?s=128&g=1", "display_name": "adavia", "link": "https://stackoverflow.com/users/1763639/adavia"}, "edited": false, "score": 0, "creation_date": 1482947930, "post_id": 41365429, "comment_id": 69936063, "body": "So i tried what you said, but i am not seeing any difference with this code. The chart should be jumping to the next page and is not."}, {"owner": {"reputation": 2594, "user_id": 2628223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dbHga.jpg?s=128&g=1", "display_name": "BigRon", "link": "https://stackoverflow.com/users/2628223/bigron"}, "reply_to_user": {"reputation": 393, "user_id": 1763639, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pJH8i.jpg?s=128&g=1", "display_name": "adavia", "link": "https://stackoverflow.com/users/1763639/adavia"}, "edited": false, "score": 0, "creation_date": 1482948757, "post_id": 41365429, "comment_id": 69936484, "body": "rather than <code>group do |g|</code> do this: <code>group :too_tall =&gt; lambda { start_new_page } do |g|</code>. This will force it to start a new page per <a href=\"https://github.com/ddengler/prawn-grouping#options\" rel=\"nofollow noreferrer\">this example</a>"}, {"owner": {"reputation": 393, "user_id": 1763639, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pJH8i.jpg?s=128&g=1", "display_name": "adavia", "link": "https://stackoverflow.com/users/1763639/adavia"}, "edited": false, "score": 0, "creation_date": 1482950027, "post_id": 41365429, "comment_id": 69937083, "body": "Same thing.. perhaps moving the chart into a span block or something similar?"}, {"owner": {"reputation": 2594, "user_id": 2628223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dbHga.jpg?s=128&g=1", "display_name": "BigRon", "link": "https://stackoverflow.com/users/2628223/bigron"}, "reply_to_user": {"reputation": 393, "user_id": 1763639, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pJH8i.jpg?s=128&g=1", "display_name": "adavia", "link": "https://stackoverflow.com/users/1763639/adavia"}, "edited": false, "score": 0, "creation_date": 1482950104, "post_id": 41365429, "comment_id": 69937114, "body": "Yes, maybe a span. In my similar use case my content is in a Prawn Table and works great. Is it still doubling up the content, too?"}, {"owner": {"reputation": 691, "user_id": 2144199, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/c42ZL.jpg?s=128&g=1", "display_name": "larz", "link": "https://stackoverflow.com/users/2144199/larz"}, "edited": false, "score": 0, "creation_date": 1594382872, "post_id": 41365429, "comment_id": 111114070, "body": "@BigRon how I use it with a table in a &quot;group&quot; context? I try something like this: <code>closing_table = make_table([....</code> and then <code>group.closing_table.draw </code> but this is not working"}], "tags": [], "owner": {"reputation": 2594, "user_id": 2628223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dbHga.jpg?s=128&g=1", "display_name": "BigRon", "link": "https://stackoverflow.com/users/2628223/bigron"}, "is_accepted": false, "score": 1, "last_activity_date": 1482949608, "last_edit_date": 1482949608, "creation_date": 1482940242, "answer_id": 41365429, "question_id": 41364119, "link": "https://stackoverflow.com/questions/41364119/rails-prawn-chart-not-rendered-completely-at-the-bottom-of-the-page/41365429#41365429", "title": "Rails prawn chart not rendered completely at the bottom of the page", "body": "<p><strong>For a similar issue I used the <a href=\"https://github.com/ddengler/prawn-grouping\" rel=\"nofollow noreferrer\">prawn-grouping gem</a></strong></p>\n\n<p>It pre-renders whatever you place in a <code>group</code> block to test whether it fits on the current page. If not, it skips to the next page and renders.</p>\n\n<p>In your case you would do something like:</p>\n\n<pre><code>def questions\n  @survey.questions.each do |question|\n    group :too_tall =&gt; lambda { start_new_page } do |g|\n      g.text \"#{question.title}\", size: 20\n      g.text \"Answers #{question.answers.size}\", size: 15\n      if [\"single\", \"select\"].include? question.question_type.prefix\n        if question.answers.choice_counter.any?\n          g.chart choices: question.answers.choice_counter\n        end\n      end\n      if question.question_type.prefix == \"image\"\n        if question.answers.image_counter.any?\n          g.chart images: question.answers.image_counter\n        end\n      end\n      if question.question_type.prefix == \"multiple\"\n        if question.answers.multiple_choice_counter.any?\n          g.chart choices: question.answers.multiple_choice_counter\n        end\n      end\n      if question.question_type.prefix == \"raiting\"\n        move_down 5\n        if question.answers.any?\n          g.text_box \"Average rating\", size: 12, width: 120, :at =&gt; [0,  cursor - 2]\n          g.text_box \"#{average_rating(question.answers.rating_average)}\", size: 12, width: 120, :at =&gt; [4 * 30,  cursor - 2]\n        else\n          g.text_box \"Average rating\", size: 12, width: 120, :at =&gt; [0,  cursor - 2]\n          g.text_box \"0\", size: 12, width: 120, :at =&gt; [4 * 30,  cursor - 2]\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p><em>disclaimer:</em> I've never used <strong>squid</strong>  so the only piece I'm not sure of is <code>g.chart</code> let me know if you have issues there and I will try to figure it out.</p>\n\n<p><strong>Update for squid</strong></p>\n\n<p>The <code>prawn-grouping</code> gem doesn't know about the <code>squid</code> methods (like <code>chart</code>). So we can extract the logic from the <code>prawn-grouping</code> gem and add it directly in your <code>survey_pdf.rb</code>. Copy lines 7-63 from <a href=\"https://github.com/ddengler/prawn-grouping/blob/master/lib/prawn/grouping.rb\" rel=\"nofollow noreferrer\">this file</a>, and remove <code>prawn-grouping</code> gem from your app.</p>\n\n<p><em>if you are curious why this works...</em></p>\n\n<p><code>Squid</code> uses the <code>Prawn::Document.extensions</code> method to force <code>Prawn::Document</code> to inherit the squid methods. You can see that in the squid gem code <a href=\"https://github.com/Fullscreen/squid/blob/master/lib/squid.rb#L37\" rel=\"nofollow noreferrer\">here on line 37</a>.</p>\n\n<p>For <code>prawn-grouping</code> to work it creates a new <code>Prawn::Document</code> as part of the <code>group</code> method. You can see that <a href=\"https://github.com/ddengler/prawn-grouping/blob/master/lib/prawn/grouping.rb#L55\" rel=\"nofollow noreferrer\">here on line 55</a>. The problem was that the <code>Prawn::Document</code> instantiated via the <code>prawn-grouping</code> gem wasn't inheriting the <code>squid</code> methods... but your <code>SurveyPdf</code> instance of <code>Prawn::Document</code> does inherit the <code>squid</code> methods, so by adding the <code>grouping</code> logic into your <code>SurveyPdf</code> class, now the <code>Prawn::Document</code> instantiated in your <code>group</code> method will work.</p>\n"}, {"comments": [{"owner": {"reputation": 393, "user_id": 1763639, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pJH8i.jpg?s=128&g=1", "display_name": "adavia", "link": "https://stackoverflow.com/users/1763639/adavia"}, "edited": false, "score": 0, "creation_date": 1483022770, "post_id": 41381748, "comment_id": 69965722, "body": "Well i fix it using something similar if (842 - cursor) + 250 &gt; 842 start_new_page otherwise stay_in_same_page"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 393, "user_id": 1763639, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pJH8i.jpg?s=128&g=1", "display_name": "adavia", "link": "https://stackoverflow.com/users/1763639/adavia"}, "edited": false, "score": 0, "creation_date": 1483023998, "post_id": 41381748, "comment_id": 69966412, "body": "@adavia glad you got it working. Sorry it took a bit to get back to you I have never used <code>squid</code> before and had to do a little source review to determine how <code>chart</code> was implemented before I could pose a reasonable answer."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 0, "last_activity_date": 1483022116, "creation_date": 1483022116, "answer_id": 41381748, "question_id": 41364119, "link": "https://stackoverflow.com/questions/41364119/rails-prawn-chart-not-rendered-completely-at-the-bottom-of-the-page/41381748#41381748", "title": "Rails prawn chart not rendered completely at the bottom of the page", "body": "<p>To answer the question in your comment as to determining page size I will run through a few useful methods too long for a comment: </p>\n\n<pre><code>d = Prawn::Document.new\nd.y #full page height\nd.margin_box.bottom #actually top since prawn starts at the bottom\nd.margin_box.absolute_bottom #actual top with margins included\nd.margin_box.top #usable page height\nd.margin_box.absolute_top #same as #y \nd.cursor #where you are vertically on the page\n</code></pre>\n\n<p>So you can use some basic math to determine fit:</p>\n\n<pre><code>#this is all chart does excepting chart calls #draw \n#which we don't want to do until we determine if it fits \nc = Squid::Graph.new(d, choices: question.answers.choice_counter) \n\n#determine if the chart will fit vertically \n#if not start a new page and move to the top\nunless d.cursor + c.height &lt; d.margin_box.top\n   d.start_new_page\n   d.move_cursor_to(0)\nend\n\n#draw the chart onto the appropriate page\nc.draw\n</code></pre>\n\n<p>Hope this helps in some way </p>\n"}], "owner": {"reputation": 393, "user_id": 1763639, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pJH8i.jpg?s=128&g=1", "display_name": "adavia", "link": "https://stackoverflow.com/users/1763639/adavia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "accepted_answer_id": 41381748, "answer_count": 2, "score": 2, "last_activity_date": 1483022116, "creation_date": 1482935557, "question_id": 41364119, "link": "https://stackoverflow.com/questions/41364119/rails-prawn-chart-not-rendered-completely-at-the-bottom-of-the-page", "title": "Rails prawn chart not rendered completely at the bottom of the page", "body": "<p>I am creating a pdf report in order to show some data using the \"squid\" gem. This would allow me to display charts in my pdf.\nThe only issue i found is that when the chart does not fit at the bottom of the page then it looks rendered partially which does not look good at all. Any idea how can i fix this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/wOKHy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wOKHy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code i am using to render the charts</p>\n\n<pre><code>require 'squid'\n\nclass SurveyPdf &lt; Prawn::Document\n  def initialize(survey, view)\n    super()\n    font \"#{Rails.root}/app/assets/fonts/roboto-condensed.ttf\"\n\n    @survey = survey\n    @view = view\n    questions\n  end\n\n  def questions\n    @survey.questions.each do |question|\n      text \"#{question.title}\", size: 20\n      text \"Answers #{question.answers.size}\", size: 15\n      if [\"single\", \"select\"].include? question.question_type.prefix\n        if question.answers.choice_counter.any?\n          chart choices: question.answers.choice_counter\n        end\n      end\n      if question.question_type.prefix == \"image\"\n        if question.answers.image_counter.any?\n          chart images: question.answers.image_counter\n        end\n      end\n      if question.question_type.prefix == \"multiple\"\n        if question.answers.multiple_choice_counter.any?\n          chart choices: question.answers.multiple_choice_counter\n        end\n      end\n      if question.question_type.prefix == \"raiting\"\n        move_down 5\n        if question.answers.any?\n          text_box \"Average rating\", size: 12, width: 120, :at =&gt; [0,  cursor - 2]\n          text_box \"#{average_rating(question.answers.rating_average)}\", size: 12, width: 120, :at =&gt; [4 * 30,  cursor - 2]\n        else\n          text_box \"Average rating\", size: 12, width: 120, :at =&gt; [0,  cursor - 2]\n          text_box \"0\", size: 12, width: 120, :at =&gt; [4 * 30,  cursor - 2]\n        end\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 2923, "user_id": 783912, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/98e9b626cf9e9e74ae50c190da325a5e?s=128&d=identicon&r=PG&f=1", "display_name": "FlyingFoX", "link": "https://stackoverflow.com/users/783912/flyingfox"}, "edited": false, "score": 0, "creation_date": 1485019993, "post_id": 41363946, "comment_id": 70754856, "body": "What should your if condition do?"}], "answers": [{"tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": false, "score": 0, "last_activity_date": 1482935061, "creation_date": 1482935061, "answer_id": 41364003, "question_id": 41363946, "link": "https://stackoverflow.com/questions/41363946/how-to-add-if-condition-inside-this-helper-method/41364003#41364003", "title": "How to add if condition inside this helper method?", "body": "<p>You need to build a html string separately:</p>\n\n<pre><code>def published_comment\n  html = \"&lt;li&gt;\n    &lt;div id='comment_#{@comment.anchor}' class='comment #{@comment.state}' data-comment-id='#{@comment.to_param}'&gt;\n      &lt;div&gt;\n        #{ avatar }\n        #{ userbar }\n        &lt;div class='cbody'&gt;#{ @comment.content }&lt;/div&gt;\n        #{ reply }\n  \"\n\n  html &lt;&lt;  approved_comment if  controller.try(:current_user).try(:admin?)\n\n\n  html &lt;&lt;  \"&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class='form_holder'&gt;&lt;/div&gt;\n    #{ children }\n  &lt;/li&gt;\"\n\n  html\nend\n</code></pre>\n\n<p>But better move this html to a partial and call it from a helper if you need.</p>\n\n<pre><code>def published_comment(comment)\n  render 'published_comment', locals: { comment: comment }\nend\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7324230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773de78207413aa704b7d2ce93aafa47?s=128&d=identicon&r=PG&f=1", "display_name": "Nitesh K", "link": "https://stackoverflow.com/users/7324230/nitesh-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1482992204, "creation_date": 1482934758, "last_edit_date": 1482992204, "question_id": 41363946, "link": "https://stackoverflow.com/questions/41363946/how-to-add-if-condition-inside-this-helper-method", "title": "How to add if condition inside this helper method?", "body": "<p>I am not able to give the if condition inside this method.</p>\n\n<pre><code>def published_comment\n            \"&lt;li&gt;\n              &lt;div id='comment_#{@comment.anchor}' class='comment #{@comment.state}' data-comment-id='#{@comment.to_param}'&gt;\n                &lt;div&gt;\n                  #{ avatar }\n                  #{ userbar }\n                  &lt;div class='cbody'&gt;#{ @comment.content }&lt;/div&gt;\n                  #{ reply }\n\n                  #{ if controller.try(:current_user).try(:admin?) }\n                    #{ approved_comment } \n                  #{ end } \n\n                &lt;/div&gt;\n              &lt;/div&gt;\n              &lt;div class='form_holder'&gt;&lt;/div&gt;\n              #{ children }\n            &lt;/li&gt;\"\n          end\n</code></pre>\n"}, {"tags": ["ruby", "string-interpolation"], "answers": [{"comments": [{"owner": {"reputation": 1538, "user_id": 655650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/maO3T.jpg?s=128&g=1", "display_name": "Tass", "link": "https://stackoverflow.com/users/655650/tass"}, "edited": false, "score": 0, "creation_date": 1482936279, "post_id": 41364182, "comment_id": 69929915, "body": "This is the answer."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 8, "last_activity_date": 1482935763, "creation_date": 1482935763, "answer_id": 41364182, "question_id": 41363820, "link": "https://stackoverflow.com/questions/41363820/whats-the-difference-between-var-and-var-in-ruby/41364182#41364182", "title": "What&#39;s the difference between &quot;#@{var}&quot; and &quot;@#{var}&quot; in Ruby?", "body": "<p>It's the <code>#{(expression)}</code> that's significant.</p>\n\n<p>If the expression is <code>#{name}</code> then that's substituting the variable <code>name</code> which in all your examples comes from the parameters input into the method.</p>\n\n<p>If the expression is <code>#{@name}</code> then that's substituting the variable <code>@name</code> which is defined in the fourth line of your methods.</p>\n\n<p><code>@#{name}</code> is not a special construct. It's just the string <code>@</code> followed by the contents of the variable <code>name</code>.</p>\n\n<p>The reason it didn't work in your second example is that you simply haven't defined a variable <code>vendor</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 1, "creation_date": 1482946573, "post_id": 41364795, "comment_id": 69935416, "body": "Wow, did not know about &quot;#@a &quot; interpolation, but figured out why it could be unintuitive (included it in your example)."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 1, "creation_date": 1482947545, "post_id": 41364795, "comment_id": 69935863, "body": "Yes, I think &quot;#@a&quot; is mostly used in bugs :)"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1482946840, "last_edit_date": 1482946840, "creation_date": 1482937976, "answer_id": 41364795, "question_id": 41363820, "link": "https://stackoverflow.com/questions/41363820/whats-the-difference-between-var-and-var-in-ruby/41364795#41364795", "title": "What&#39;s the difference between &quot;#@{var}&quot; and &quot;@#{var}&quot; in Ruby?", "body": "<p>Here are all the examples I could think of :</p>\n\n<pre><code>@a = \"hello\"\n\nstrings =[ \n  \"@a world\",\n  \"@{a} world\",\n  \"#a world\",\n  \"#{@a} world\",\n  \"#@a world\",\n  \"#@aworld\", # ! Will not output anything (no space after \"@a\", and @aworld isn't defined ) !\n  \"@#{@a} world\"\n]\n\nputs strings\n</code></pre>\n\n<p>It outputs : </p>\n\n<pre><code>@a world\n@{a} world\n#a world\nhello world\nhello world\n\n@hello world\n</code></pre>\n\n<p>But :</p>\n\n<pre><code>puts \"@#{a} world\"\n</code></pre>\n\n<p>throws an exception :</p>\n\n<pre><code>undefined local variable or method `a' for main:Object (NameError)\n</code></pre>\n\n<p><code>a</code> needs to be a defined variable or a method :</p>\n\n<pre><code>class Test\n  attr_accessor :a\n\n  def greetings\n    puts \"#{a} world\"\n  end\nend\n\nt   = Test.new\nt.a = \"hello\"\nt.greetings # hello world\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5238930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e611027a9ead0eb9d64fd16bab6da29f?s=128&d=identicon&r=PG&f=1", "display_name": "El0", "link": "https://stackoverflow.com/users/5238930/el0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 41364182, "answer_count": 2, "score": 1, "last_activity_date": 1482946840, "creation_date": 1482934297, "question_id": 41363820, "link": "https://stackoverflow.com/questions/41363820/whats-the-difference-between-var-and-var-in-ruby", "title": "What&#39;s the difference between &quot;#@{var}&quot; and &quot;@#{var}&quot; in Ruby?", "body": "<p>I am quite new to Ruby and always assumed these two notations were an identical way to interpolate instance variables until I noticed the difference in the example code below for the 'vendor' parameter.</p>\n\n<pre><code>class Component\n    def  initialize(name, version)\n         @vendor = \"vendor\"\n         @name = name\n         @version = version\n         puts  \"#{@vendor}-@#{name}-@#{version}\" \n    end \nend\n\nConfiguredComponent.new(\"param1\", \"param2\")\n</code></pre>\n\n<p>=> this works</p>\n\n<pre><code>class Component\n    def  initialize(name, version)\n         @vendor = \"vendor\"\n         @name = name\n         @version = version\n         puts  \"@#{vendor}-@#{name}-@#{version}\" \n    end \nend\n\nConfiguredComponent.new(\"param1\", \"param2\")\n</code></pre>\n\n<p>=> using @#{vendor} notation does't work => <strong>:in 'initialize': undefined local variable or method `vendor' for # (NameError)</strong></p>\n\n<pre><code>  class Component\n     def  initialize(name, version)\n        @vendor = \"vendor\"\n        @name = name\n        @version = version\n        puts  \"#{@vendor}-#{@name}-#{@version}\" \n     end \n  end\n\n  Component.new(\"param1\", \"param2\")\n</code></pre>\n\n<p>=> this also works</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "rspec"], "comments": [{"owner": {"reputation": 1073, "user_id": 4911868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NNOca.jpg?s=128&g=1", "display_name": "Rakesh Nair", "link": "https://stackoverflow.com/users/4911868/rakesh-nair"}, "edited": false, "score": 0, "creation_date": 1482934176, "post_id": 41363759, "comment_id": 69928756, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12685599/check-https-status-code-ruby\">check https status code ruby</a>"}, {"owner": {"reputation": 1572, "user_id": 5306470, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9M5cV.jpg?s=128&g=1", "display_name": "Daniel Springer", "link": "https://stackoverflow.com/users/5306470/daniel-springer"}, "edited": false, "score": 0, "creation_date": 1482934252, "post_id": 41363759, "comment_id": 69928806, "body": "Ruby! <a href=\"http://stackoverflow.com/questions/5908017/check-if-url-exists-in-ruby\" title=\"check if url exists in ruby\">stackoverflow.com/questions/5908017/check-if-url-exists-in-r&zwnj;&#8203;uby</a>"}], "answers": [{"comments": [{"owner": {"reputation": 330, "user_id": 2687094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfee4dc3b59ff2c7af2f29d76df10f85?s=128&d=identicon&r=PG&f=1", "display_name": "yed", "link": "https://stackoverflow.com/users/2687094/yed"}, "edited": false, "score": 0, "creation_date": 1520886909, "post_id": 41364727, "comment_id": 85491840, "body": "Making the test a request spec doesn&#39;t change the underlying default behavior, it will still throw an exception."}], "tags": [], "owner": {"reputation": 490, "user_id": 4835347, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jYSX21F2zsc/AAAAAAAAAAI/AAAAAAAAAeo/MJZfozW2Ml8/photo.jpg?sz=128", "display_name": "Igor Springer", "link": "https://stackoverflow.com/users/4835347/igor-springer"}, "is_accepted": false, "score": 0, "last_activity_date": 1482937777, "creation_date": 1482937777, "answer_id": 41364727, "question_id": 41363759, "link": "https://stackoverflow.com/questions/41363759/how-to-test-a-url-which-doesnt-exist-in-rspec/41364727#41364727", "title": "How to test a url which doesn&#39;t exist in Rspec?", "body": "<p>The most appropriate place for it is <a href=\"https://www.relishapp.com/rspec/rspec-rails/docs/request-specs/request-spec\" rel=\"nofollow noreferrer\">request spec</a> (<code>spec/requests</code> subfolder). There the above snippet should work as expected.</p>\n"}, {"tags": [], "owner": {"reputation": 380, "user_id": 4781518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jtiKY.jpg?s=128&g=1", "display_name": "ydaniju", "link": "https://stackoverflow.com/users/4781518/ydaniju"}, "is_accepted": false, "score": 0, "last_activity_date": 1482941907, "creation_date": 1482941907, "answer_id": 41365886, "question_id": 41363759, "link": "https://stackoverflow.com/questions/41363759/how-to-test-a-url-which-doesnt-exist-in-rspec/41365886#41365886", "title": "How to test a url which doesn&#39;t exist in Rspec?", "body": "<p>To achieve this, you can create a route to match all paths not defined using this:</p>\n\n<pre><code>get '*path', to: \"controller#action\"\n</code></pre>\n\n<p>The <code>controller</code> and <code>action</code> above denote the controller and action you want all requests for routes not listed should go. Here is how the controller action could be</p>\n\n<pre><code>#controller/action\n\ndef action\n  render(:file =&gt; \"#{Rails.root}/public/404.html\", status: 404)\nend\n</code></pre>\n\n<h3>Note</h3>\n\n<p>Make sure the route is placed at the bottom of your route. If not, all requests will end there.</p>\n"}, {"tags": [], "owner": {"reputation": 330, "user_id": 2687094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfee4dc3b59ff2c7af2f29d76df10f85?s=128&d=identicon&r=PG&f=1", "display_name": "yed", "link": "https://stackoverflow.com/users/2687094/yed"}, "is_accepted": false, "score": 0, "last_activity_date": 1520887173, "creation_date": 1520887173, "answer_id": 49244061, "question_id": 41363759, "link": "https://stackoverflow.com/questions/41363759/how-to-test-a-url-which-doesnt-exist-in-rspec/49244061#49244061", "title": "How to test a url which doesn&#39;t exist in Rspec?", "body": "<p>The actual answer was covered in the post <a href=\"https://stackoverflow.com/a/14141836/2687094\">here</a>.</p>\n\n<p>You need to change the following settings in test.rb:</p>\n\n<pre><code>consider_all_requests_local = false\nconfig.action_dispatch.show_exceptions = true\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7349250, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/617d0dd88a18061b290be90e330743e0?s=128&d=identicon&r=PG&f=1", "display_name": "Karim", "link": "https://stackoverflow.com/users/7349250/karim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 716, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1520887173, "creation_date": 1482934056, "last_edit_date": 1482942674, "question_id": 41363759, "link": "https://stackoverflow.com/questions/41363759/how-to-test-a-url-which-doesnt-exist-in-rspec", "title": "How to test a url which doesn&#39;t exist in Rspec?", "body": "<p>I want to validate that <strong>my url in my web application</strong> returns 404 Not found. I know it doesn't exist, but I need to confirm that via tests by Rspec. How? This doesn't work:</p>\n\n<pre><code>it \"404\" do\n  get \"/some_url_404\"\n  expect(response.status).to eq 404\nend\n</code></pre>\n\n<p>The test itself fails with:</p>\n\n<p>ActionController::RoutingError:\n       No route matches [GET] \"/some_url_404\"</p>\n\n<p><strong>update</strong></p>\n\n<p>the answer hasn't been given yet. </p>\n"}, {"tags": ["ruby", "stack-overflow", "ruby-on-rails-5", "method-missing"], "answers": [{"comments": [{"owner": {"reputation": 545, "user_id": 7009068, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d4dcec8dac0d44459b1a411be4c9df94?s=128&d=identicon&r=PG", "display_name": "Kalsan", "link": "https://stackoverflow.com/users/7009068/kalsan"}, "edited": false, "score": 0, "creation_date": 1483091622, "post_id": 41393025, "comment_id": 69989993, "body": "This is a bug in JRuby 9.1.5.0 that appears to be fixed in JRuby 9.1.6.0"}], "tags": [], "owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "is_accepted": true, "score": 0, "last_activity_date": 1483086347, "creation_date": 1483086347, "answer_id": 41393025, "question_id": 41363626, "link": "https://stackoverflow.com/questions/41363626/rails-method-missing-leads-to-stackoverflowerror/41393025#41393025", "title": "Rails: method_missing leads to StackOverflowError", "body": "<p>Possibly solved in <a href=\"https://github.com/rails/rails/issues/27481\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/issues/27481</a>.\nSeems like a jruby bug.</p>\n"}], "owner": {"reputation": 545, "user_id": 7009068, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d4dcec8dac0d44459b1a411be4c9df94?s=128&d=identicon&r=PG", "display_name": "Kalsan", "link": "https://stackoverflow.com/users/7009068/kalsan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 41393025, "answer_count": 1, "score": 1, "last_activity_date": 1483086347, "creation_date": 1482933594, "last_edit_date": 1482935727, "question_id": 41363626, "link": "https://stackoverflow.com/questions/41363626/rails-method-missing-leads-to-stackoverflowerror", "title": "Rails: method_missing leads to StackOverflowError", "body": "<p>When triggering a call to method_missing on a Rails server running in development mode, it dies with a <code>StackOverflowError</code>. This is a Rails5 on JRuby environment. We are not using multi-threading here.</p>\n\n<p>The behavior can be summarized as follows:</p>\n\n<ol>\n<li>The class in which the StackOverflow occurs was written by ourselves. Implementing <code>def method_missing</code> and raising from there results in correct behavior (e.g. <code>fail 'oh noes.'</code> will print the expected error).</li>\n<li>Calling super(*args) in the <code>method_missing</code> implemented will result in a <code>StackOverflowError</code> again.</li>\n<li>Calling <code>debugger</code> right above <code>super</code> works and typing <code>next</code> reveals that the following calls are:\n\n<ul>\n<li><code>gems/actionpack-5.0.1.rc2/lib/action_controller/metal/rescue.rb:22</code>\n\n<ul>\n<li><code>request.env['action_dispatch.show_detailed_exceptions'] ||= show_detailed_exceptions?</code></li>\n</ul></li>\n<li><code>gems/actionpack-5.0.1.rc2/lib/action_controller/metal/rescue.rb:23</code>\n\n<ul>\n<li><code>rescue_with_handler(exception) || raise</code></li>\n</ul></li>\n<li>[StackOverflow]</li>\n</ul></li>\n<li>In the debug shell (as in point 3), any attempt to get a trace via <code>backtrace</code> or <code>info stack</code> will result in a StackOverflow.</li>\n<li>None of this happens when the server is started in test or production environment.</li>\n</ol>\n\n<p>We saw that some code was removed in Rails in <a href=\"https://github.com/rails/rails/commit/6b543166f7b0fd5712ffe831dad31d34f6de5dcd\" rel=\"nofollow noreferrer\">this commit</a>. Indeed, putting the deleted code back in (for testing purposes only) resolves the problem.</p>\n\n<p>Do you think this is a rails bug?</p>\n"}, {"tags": ["sql", "ruby", "self-join", "sequel"], "answers": [{"tags": [], "owner": {"reputation": 11331, "user_id": 132053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f183bcc4176b308c9edabe79299e448f?s=128&d=identicon&r=PG", "display_name": "Jeremy Evans", "link": "https://stackoverflow.com/users/132053/jeremy-evans"}, "is_accepted": true, "score": 1, "last_activity_date": 1483027138, "creation_date": 1483027138, "answer_id": 41383091, "question_id": 41363472, "link": "https://stackoverflow.com/questions/41363472/is-it-possible-to-execute-a-self-join-in-sequel/41383091#41383091", "title": "Is it possible to execute a self join in Sequel?", "body": "<p>You just need to alias the table during the join:</p>\n\n<pre><code>class Publication &lt; Sequel::Model\n  dataset_module do\n    def including_similar_publications\n      select{[publications[:id], publications[:body], similar_publication[:id].as(:similar_publication_id), similar_publication[:body].as(:similar_body)]}.\n        left_join(Sequel[:publications].as(:similar_publication), :id=&gt;:publication_id)\n    end\n  end\nend \n</code></pre>\n"}], "owner": {"reputation": 456, "user_id": 3122311, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/679c944afa134ee19cbf571de55aae15?s=128&d=identicon&r=PG", "display_name": "Pedro Vin&#237;cius", "link": "https://stackoverflow.com/users/3122311/pedro-vin%c3%adcius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 41383091, "answer_count": 1, "score": 0, "last_activity_date": 1483027138, "creation_date": 1482933037, "last_edit_date": 1482933066, "question_id": 41363472, "link": "https://stackoverflow.com/questions/41363472/is-it-possible-to-execute-a-self-join-in-sequel", "title": "Is it possible to execute a self join in Sequel?", "body": "<p>I'm working in a publications management application. By the business logic, a publication can belongs to another publication if its texts have a similarity level equal or higher than 75%. So, in the database, I created a self relation on the <code>publications</code> table.</p>\n\n<p>So far, I have the following query that works perfectly:</p>\n\n<pre><code>SELECT \n    publications.id, publications.body, \n    similar_publications.id similar_id, similar_publications.body similar_body\nFROM publications\nLEFT JOIN publications similar_publications\n  ON similar_publications.id = publications.publication_id\nWHERE publications.id = &lt;an-id-here&gt;;\n</code></pre>\n\n<p>The problem is that I want to \"convert\" this query to Sequel's DSL, in order to simply call my model in a way like so: <code>Publication.including_similar_publications.where('publications.id = ?', 1)</code></p>\n\n<p>I know I need to create this method into my Model. My doubt is: how? Is there something similar to <code>ActiveRecord</code> named scopes in Sequel? Another problem is that because my query is a <code>SELF JOIN</code>, I need to use aliasing on <code>LEFT JOIN</code>... Does Sequel permit that I use aliases the way I exposed in my query? If yes, how? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "event-handling", "transitions", "state-machine"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 6784318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qMLN0.jpg?s=128&g=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/6784318/mike-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1482952743, "creation_date": 1482952743, "answer_id": 41368405, "question_id": 41362413, "link": "https://stackoverflow.com/questions/41362413/how-to-handle-error-in-event-machine-using-transitions-gem-on-rails/41368405#41368405", "title": "How to handle error in event machine using transitions gem on rails?", "body": "<p>The Transitions gem has a nice <code>guard</code> feature. Add a simple logical test like <code>can_be_delivered?</code> and try this:</p>\n\n<pre><code>event :deliver do\n  transitions :to =&gt; :delivered, :from =&gt; [:editing, :pending], guard: [:can_be_delivered?]\nend\n</code></pre>\n"}], "owner": {"reputation": 759, "user_id": 5266581, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-4WBTC_1yMB8/AAAAAAAAAAI/AAAAAAAAACI/pCGef6nYJik/photo.jpg?sz=128", "display_name": "Engr.Tanbir Hasan", "link": "https://stackoverflow.com/users/5266581/engr-tanbir-hasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 41368405, "answer_count": 1, "score": 0, "last_activity_date": 1482952743, "creation_date": 1482928958, "question_id": 41362413, "link": "https://stackoverflow.com/questions/41362413/how-to-handle-error-in-event-machine-using-transitions-gem-on-rails", "title": "How to handle error in event machine using transitions gem on rails?", "body": "<p>I am working on event machine (transitions gem) in rails 4.2 , I wrote a method named <code>send_data</code> and when state changed from pending to deliver, the <code>send_data</code> will be fired.</p>\n\n<pre><code>def send_data\n    data = { 'remote_id' =&gt; order.remote_id,\n             'items' =&gt; order.line_items\n           }\n    SendLineItemsToWebshop.call(data)        \n  end\n</code></pre>\n\n<p><code>SendLineItemsToWebshop</code> is an another class which calls <code>call</code> method and waiting for some response, if response come , then event will be fired(state will be changed) , otherwise, state will be same.</p>\n\n<pre><code>require 'bunny'\nrequire 'thread'\nclass SendLineItemsToWebshop\n  def self.call(data)\n    conn = Bunny.new(automatically_recover: false)\n    conn.start\n    channel = conn.create_channel\n    response = call_client(channel, data)\n    channel.queue(ENV['BLISS_RPC_QUEUE_NAME']).pop\n    channel.close\n    conn.close\n    self.response(response)\n  end\n\n  def self.call_client(channel, data)\n    client = RpcClient.new(channel, ENV['BLISS_RPC_QUEUE_NAME'])\n    client.call(data)\n  end\n\n  def self.response(response)\n    return response\n    JSON.parse response\n  end\nend\n</code></pre>\n\n<p>But problem is that when event <code>deliver</code> is called, it does not check <code>send_data</code>'s response comes or not, it changes the state. Here is me deliver event:</p>\n\n<pre><code>event :deliver do\n      transitions :to =&gt; :delivered, :from =&gt; [:editing, :pending] , on_transition: [ :send_data ]\n    end\n</code></pre>\n\n<p>But I want that if response is false or nil, transition state will not be changed. State will be changed only when response comes true.\nPlease help me about this issue.</p>\n"}, {"tags": ["ruby", "selenium", "cucumber", "capybara"], "comments": [{"owner": {"reputation": 1007, "user_id": 6090706, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/NbSpn.png?s=128&g=1", "display_name": "Kostas Andrianos", "link": "https://stackoverflow.com/users/6090706/kostas-andrianos"}, "edited": false, "score": 0, "creation_date": 1482936704, "post_id": 41362293, "comment_id": 69930162, "body": "I think this might do it for you, assuming you exclude the value printing part! <a href=\"http://stackoverflow.com/q/2603617/6090706\">stackoverflow.com/q/2603617/6090706</a>"}, {"owner": {"reputation": 3, "user_id": 7349740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7cd6a4975d2002ded483b0110332c18?s=128&d=identicon&r=PG&f=1", "display_name": "Blapmeister", "link": "https://stackoverflow.com/users/7349740/blapmeister"}, "reply_to_user": {"reputation": 1007, "user_id": 6090706, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/NbSpn.png?s=128&g=1", "display_name": "Kostas Andrianos", "link": "https://stackoverflow.com/users/6090706/kostas-andrianos"}, "edited": false, "score": 0, "creation_date": 1483002085, "post_id": 41362293, "comment_id": 69954215, "body": "Thanks for your comment! I prefer not to use code I don&#39;t understand (or seems overcomplicated) so I won&#39;t be going with this. Maybe simply printing the xpath in the log will do :-)"}, {"owner": {"reputation": 1007, "user_id": 6090706, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/NbSpn.png?s=128&g=1", "display_name": "Kostas Andrianos", "link": "https://stackoverflow.com/users/6090706/kostas-andrianos"}, "edited": false, "score": 0, "creation_date": 1483002835, "post_id": 41362293, "comment_id": 69954670, "body": "It&#39;s best not to use code you don&#39;t understand but, if you try to understand it you&#39;ll learn one or two things to use in the future"}], "answers": [{"comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1482972859, "post_id": 41364234, "comment_id": 69945347, "body": "Constants most definitely are objects in Ruby, it&#39;s just that the user has already called the <code>#[]</code> method on the constant Hash and retrieved the value for the given key so there is no reference to the constant passed to the method"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1483060953, "post_id": 41364234, "comment_id": 69981130, "body": "Constants are <i>not</i> objects. E.g. see section 6.2.1 of the ISO Ruby Language Specification which clearly says (<b>bold</b> emphasis mine): &quot;A variable is denoted by a name, and <b>refers to</b> an object, which is called the value of the variable. <b>A variable itself is not an object</b>.&quot; Or, see the book <i>The Ruby Programming Language</i> co-authored by matz himself (<b>bold</b> emphasis mine): &quot;every <b>value</b> is an object&quot;. Note: it says every <i>value</i>, variables aren&#39;t values. Constants are kinds of variables. Why does <code>Module#constants</code> return an <code>Array</code> of <code>Symbol</code>s and not an <code>Array</code> of <code>Constants</code>?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1483061164, "post_id": 41364234, "comment_id": 69981176, "body": "Because it can&#39;t! It can&#39;t return an <code>Array</code> of <code>Constant</code>s, because constants aren&#39;t objects and arrays must contain objects. Why do <code>Module#const_get</code>, <code>Module#const_set</code>, <code>Module#const_defined?</code>, <code>Module#const_get</code>, <code>Module#deprecate_constant</code>, <code>Module#private_constant</code>, <code>Module#public_constant</code>, and <code>Module#remove_const</code>, take a <code>Symbol</code> representing the name of the constant as an argument instead of simply the constant directly? Because methods can only take objects as arguments and constants aren&#39;t objects. I don&#39;t know why this is so controversial. Constants and variables aren&#39;t objects"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1483061271, "post_id": 41364234, "comment_id": 69981202, "body": "in <i>any</i> major mainstream language. There are only very few languages where variables and/or constants are objects, so I really don&#39;t understand why the statement that constants aren&#39;t objects in Ruby causes such confusion: that&#39;s how almost all languages work, that&#39;s what the spec says, that&#39;s what Ruby&#39;s creator says."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1483064970, "post_id": 41364234, "comment_id": 69981984, "body": "Yes - technically you are correct, the actual constant variable itself is not an object - the constant refers to an object, and yes the OPs question as written didn&#39;t fully make sense - however from what (s)he wanted the log to look like `&quot;Filling field &#39;Username&#39; with value &#39;DOX02703&#39;.&quot;&#39; it&#39;s pretty obvious they didn&#39;t want the actual &quot;constant&quot; they wanted the object the constant referred to  available in the method - which was gone because they had already indexed into the hash.  So yes -- technically you are correct the constant variable name is not an object - just what it refers to is."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1482935936, "creation_date": 1482935936, "answer_id": 41364234, "question_id": 41362293, "link": "https://stackoverflow.com/questions/41362293/ruby-how-to-use-constant-name-instead-of-its-value/41364234#41364234", "title": "Ruby: how to use constant name instead of its value", "body": "<p>Constants aren't objects in Ruby. Since you can only pass objects as arguments, and only call methods on objects (and objects are the only values, and method calls are the only way to do something), it is simply not possible to pass a constant as an argument or ask it for its name.</p>\n\n<p>The only thing you <em>can</em> do is pass the <em>name</em> of the constant as an argument instead of or in addition to the object the constant points to.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7349740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7cd6a4975d2002ded483b0110332c18?s=128&d=identicon&r=PG&f=1", "display_name": "Blapmeister", "link": "https://stackoverflow.com/users/7349740/blapmeister"}, "edited": false, "score": 0, "creation_date": 1483001659, "post_id": 41364964, "comment_id": 69953997, "body": "I&#39;ve experimented with this a little but can&#39;t get it to work. To set param I would have to concatenate values, leading to the issue where it will look for xpath &quot;LoginPage::FIELDS[&#39;Username&#39;]&quot; instead of the constant. My Ruby experience (overall programming experience too) is little so I could be misunderstanding."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1482938578, "creation_date": 1482938578, "answer_id": 41364964, "question_id": 41362293, "link": "https://stackoverflow.com/questions/41362293/ruby-how-to-use-constant-name-instead-of-its-value/41364964#41364964", "title": "Ruby: how to use constant name instead of its value", "body": "<p>You could use a String with <a href=\"https://ruby-doc.org/core-2.3.1/Module.html#method-i-const_get\" rel=\"nofollow noreferrer\">const_get</a> :</p>\n\n<pre><code>class LoginPage # &lt;Base\n  FIELDS = {\n    'Username' =&gt; '//form[@id=\"login\"]//input[@name=\"j_username\"]',\n  }\nend\n\ndef get_constant_from_string(param)\n  puts \"Parameter is #{param}\"\n  Object.const_get(param) if param.is_a?(String)\nend\n\nget_constant_from_string(LoginPage::FIELDS)\n# Parameter is {\"Username\"=&gt;\"//form[@id=\\\"login\\\"]//input[@name=\\\"j_username\\\"]\"}\n# method returns nil\n\nputs get_constant_from_string(\"LoginPage::FIELDS\")['Username']\n# Parameter is LoginPage::FIELDS\n# //form[@id=\"login\"]//input[@name=\"j_username\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7349740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7cd6a4975d2002ded483b0110332c18?s=128&d=identicon&r=PG&f=1", "display_name": "Blapmeister", "link": "https://stackoverflow.com/users/7349740/blapmeister"}, "edited": false, "score": 0, "creation_date": 1483001547, "post_id": 41371904, "comment_id": 69953939, "body": "Looks great but I&#39;m afraid this won&#39;t work for me. I got this message at first as we don&#39;t define constants in base.rb: <code>uninitialized constant Base::FIELDS (NameError)</code> After adding &quot;FIELDS + {}&quot; in base.rb I get <code>InvalidSelectorError: Unable to locate an element with the xpath expression   because of the following error</code>. (as there is no constant &#39;Username&#39; in base.rb) How is this supposed to know in what Page class to look for the constant? Would I need def fill_field in each Page object instead of in base.rb?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 3, "user_id": 7349740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7cd6a4975d2002ded483b0110332c18?s=128&d=identicon&r=PG&f=1", "display_name": "Blapmeister", "link": "https://stackoverflow.com/users/7349740/blapmeister"}, "edited": false, "score": 0, "creation_date": 1483004958, "post_id": 41371904, "comment_id": 69955949, "body": "@Blapmeister as long as you&#39;re calling fill_field on an object of the Page class which was derived from Base then <code>self.class::FIELDS</code> should refer to the FIELDS constant in the Page class since that is the actual class of the object, and all access to the constant will need to be of the form <code>self.class::FIELDS</code>. If you&#39;re calling it on a pure object of the Base class (not a class derived from Base) it won&#39;t work"}, {"owner": {"reputation": 3, "user_id": 7349740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7cd6a4975d2002ded483b0110332c18?s=128&d=identicon&r=PG&f=1", "display_name": "Blapmeister", "link": "https://stackoverflow.com/users/7349740/blapmeister"}, "edited": false, "score": 0, "creation_date": 1483007619, "post_id": 41371904, "comment_id": 69957467, "body": "Thanks a lot Thomas! Got it to work this way, see setup below. The only things bothering me now is that I have to put def fill_field on each page object. Previously the page objects contained no classes, only constants. But as the actual functionality is still in base.rb I don&#39;t think this is an issue."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1482973867, "creation_date": 1482973867, "answer_id": 41371904, "question_id": 41362293, "link": "https://stackoverflow.com/questions/41362293/ruby-how-to-use-constant-name-instead-of-its-value/41371904#41371904", "title": "Ruby: how to use constant name instead of its value", "body": "<p>Essentially there is no difference between calling</p>\n\n<pre><code>@pg.fill_field(LoginPage::FIELDS['Username'], $login_name)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>username = LoginPage::FIELDS['Username']\n@pg.fill_field(username, $login_name)\n</code></pre>\n\n<p>it's just that the first one doesn't mention the temporary variable.  Either way the only thing passed through to the method is the value associated with the 'Username' key in the hash.  Looking at your class structure it seems like you have a number of 'Page' classes that inherit from base, and you're expecting fill_field to use the FIELDS constant from the class that inherited it.  In that case you probably want</p>\n\n<pre><code>def fill_field(field, value)\n  find(:xpath, self.class::FIELDS[field], wait: 15).set(value)\n\n  logger(\"Filling field '\" + field + \"' with value '\" + value + \"'.\")\nend\n</code></pre>\n\n<p>and calling it as</p>\n\n<pre><code>@pg.fill_field('Username', $login_name)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7349740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7cd6a4975d2002ded483b0110332c18?s=128&d=identicon&r=PG&f=1", "display_name": "Blapmeister", "link": "https://stackoverflow.com/users/7349740/blapmeister"}, "is_accepted": false, "score": 0, "last_activity_date": 1483008179, "creation_date": 1483008179, "answer_id": 41378049, "question_id": 41362293, "link": "https://stackoverflow.com/questions/41362293/ruby-how-to-use-constant-name-instead-of-its-value/41378049#41378049", "title": "Ruby: how to use constant name instead of its value", "body": "<p>Working solution based on Thomas Walpole's comment:</p>\n\n<p><code>Base.rb</code>:</p>\n\n<pre><code>def find_field(field)\n    @fieldToFill = find(:xpath, self.class::FIELDS[field], wait: 15)\nend\n\ndef set_value(value)\n    @fieldToFill.set(value)\nend\n\ndef fill_field_log(field, value)\n    logger(\"Filling field '\" + field + \"' with value '\" + value + \"'.\")           \nend\n</code></pre>\n\n<p><code>LoginPage.rb</code>:</p>\n\n<pre><code>def fill_field(field, value)\n    find_field(field)\n    set_value(value)\n    fill_field_log(field, value)\nend\n</code></pre>\n\n<p><code>test_steps.rb</code>:</p>\n\n<pre><code>Given(/^a user is on the login page$/) do\n    @pg = Base.new\n    @lp = LoginPage.new\n    @pg.visit_loginpage\nend\n\nAnd(/^logs in as user \"([^\"]*)\"$/) do |userName|\n    $login_name = search_excel('testdata/accounts.xlsx', userName, 1)\n    login_password = search_excel('testdata/accounts.xlsx', userName, 2)\n\n    @lp.fill_field('Username', $login_name)\n    @lp.fill_field('Password', login_password)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7349740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7cd6a4975d2002ded483b0110332c18?s=128&d=identicon&r=PG&f=1", "display_name": "Blapmeister", "link": "https://stackoverflow.com/users/7349740/blapmeister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 0, "accepted_answer_id": 41371904, "answer_count": 4, "score": 0, "last_activity_date": 1483008179, "creation_date": 1482928509, "last_edit_date": 1482929665, "question_id": 41362293, "link": "https://stackoverflow.com/questions/41362293/ruby-how-to-use-constant-name-instead-of-its-value", "title": "Ruby: how to use constant name instead of its value", "body": "<p>I am new to automating tests using Ruby (in combination with Selenium) and struggling to use the name of a constant instead of its value in my test_steps.rb. </p>\n\n<p>I'm using the 3 files below:</p>\n\n<p><code>LoginPage.rb</code>:</p>\n\n<pre><code>class LoginPage &lt; Base\n\n  FIELDS = {\n    'Username' =&gt; '//form[@id=\"login\"]//input[@name=\"j_username\"]',\n  }\n</code></pre>\n\n<p><code>Base.rb</code>:</p>\n\n<pre><code>def fill_field(field, value)\n  find(:xpath, field, wait: 15).set(value)\n  #logger(\"Filling field with xpath '\" + field + \"' with value '\" +\n             value + \"'.\") &gt; this works fine but prints the xpath\n\n  p \"field: \" + field\n  log = field.scan(/\\w+(?:'\\w+)*/).last\n  logger(\"Filling field '\" + log + \"' with value '\" + value + \"'.\")\n</code></pre>\n\n<p>test_steps.rb:</p>\n\n<pre><code>And(/^logs in as user \"([^\"]*)\"$/) do |userName|\n  $login_name = search_excel('testdata/accounts.xlsx', userName, 1)\n  @pg.fill_field(LoginPage::FIELDS['Username'], $login_name)\n</code></pre>\n\n<p>When executing the scenario I see this in my command prompt:</p>\n\n<pre><code>Given a user is on the oCRM login page # features/step_definitions/test_steps.rb:13\n\"field: //form[@id=\\\"login\\\"]//input[@name=\\\"j_username\\\"]\"\n28/12/2016 13:03:50 Filling field 'j_username' with value 'D0X02703'.\n</code></pre>\n\n<p>Note that the line in <code>Base.rb</code> prints the value for the constant matching \"field\" </p>\n\n<pre><code>'//form[@id=\"login\"]//input[@name=\"j_username\"]'\n</code></pre>\n\n<p>I would like it to print the constant itself: <code>\"LoginPage::FIELDS['Username']\"</code>. The target is to print this in my logging: </p>\n\n<pre><code>\"Filling field 'Username' with value 'DOX02703'.\"\n</code></pre>\n\n<p>I've tried printing <code>\"field.name\"</code>, <code>\"field.value\"</code> and played around with <code>local_variables</code>, but no success yet. Help would be very welcome!</p>\n\n<p>Also tried the other way around with definition below but ofcourse then it won't pick up the constant value and look for xpath <code>\"LoginPage::FIELDS['Username']\"</code>:</p>\n\n<pre><code>  def fill_fields(page, type, field, value)\n            find(:xpath, page + \"::\" + type + \"['\" + field + \"']\", wait: 15).set(value)\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 3, "creation_date": 1482928373, "post_id": 41362199, "comment_id": 69925586, "body": "Did you\u2026 <i>read</i> the errors?"}, {"owner": {"reputation": 2227, "user_id": 3942186, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/OnOyW.jpg?s=128&g=1", "display_name": "Emna Ayadi", "link": "https://stackoverflow.com/users/3942186/emna-ayadi"}, "reply_to_user": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 0, "creation_date": 1482933752, "post_id": 41362199, "comment_id": 69928529, "body": "Yes but i&#39;m beginner in ruby i don&#39;t know how to deal with those files ! So that i&#39;m asking"}], "answers": [{"comments": [{"owner": {"reputation": 2227, "user_id": 3942186, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/OnOyW.jpg?s=128&g=1", "display_name": "Emna Ayadi", "link": "https://stackoverflow.com/users/3942186/emna-ayadi"}, "edited": false, "score": 0, "creation_date": 1483010162, "post_id": 41362296, "comment_id": 69958813, "body": "This is the new error : You have one or more invalid gemspecs that need to be fixed. The gemspec at /home/emna/Gemfile/Gemfile.gemspec is not valid. Please fix this gemspec. The validation error was &#39;&quot; Put your gem&#39;s website or public repo URL here.&quot; is not a URI&#39;"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2227, "user_id": 3942186, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/OnOyW.jpg?s=128&g=1", "display_name": "Emna Ayadi", "link": "https://stackoverflow.com/users/3942186/emna-ayadi"}, "edited": false, "score": 1, "creation_date": 1483010829, "post_id": 41362296, "comment_id": 69959160, "body": "What do expect me to do, save for <b>repeat the error message</b>?! Please <b>put a valid URI in place of \u201cPut your gem&#39;s website or public repo URL here.\u201d string</b>, or just comment this line out."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1482928519, "creation_date": 1482928519, "answer_id": 41362296, "question_id": 41362199, "link": "https://stackoverflow.com/questions/41362199/i-couldnt-install-the-bundle-in-ruby/41362296#41362296", "title": "I couldn&#39;t install the bundle in ruby", "body": "<p>You should modify the template generated for you by <code>bundle gem ...</code> according to the suggestions in error message you\u2019ve got:</p>\n\n<pre><code>The validation error was '\"FIXME\" or \"TODO\" is not an author'\n</code></pre>\n\n<p>That said, open <code>Gemfile.gemspec</code> with the editor of your choice and fix the lines, having <code>FIXME</code> and/or <code>TODO</code> content.</p>\n\n<p>Also, in ruby world we tend to name gems in all lowercase (while yours is named with capitalized <code>G</code>.)</p>\n"}], "owner": {"reputation": 2227, "user_id": 3942186, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/OnOyW.jpg?s=128&g=1", "display_name": "Emna Ayadi", "link": "https://stackoverflow.com/users/3942186/emna-ayadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "accepted_answer_id": 41362296, "answer_count": 1, "score": -4, "last_activity_date": 1483008476, "creation_date": 1482928161, "last_edit_date": 1483008476, "question_id": 41362199, "link": "https://stackoverflow.com/questions/41362199/i-couldnt-install-the-bundle-in-ruby", "title": "I couldn&#39;t install the bundle in ruby", "body": "<p>I have a problem when trying to install the bundle in ruby. i try to update it after creating the Gemfile </p>\n\n<p>I have used this command : </p>\n\n<blockquote>\n  <p>bundle gem GEM_NAME</p>\n</blockquote>\n\n<pre><code>emna@tarek-Vostro-3902:~/Gemfile$ ls -l\ntotal 32\ndrwxrwxr-x 2 emna emna 4096 Dec 28 13:11 bin\n-rw-rw-r-- 1 emna emna 3238 Dec 28 13:11 CODE_OF_CONDUCT.md\n-rw-rw-r-- 1 emna emna   92 Dec 28 13:11 Gemfile\n-rw-rw-r-- 1 emna emna 1428 Dec 28 13:11 Gemfile.gemspec\ndrwxrwxr-x 3 emna emna 4096 Dec 28 13:11 lib\n-rw-rw-r-- 1 emna emna  117 Dec 28 13:11 Rakefile\n-rw-rw-r-- 1 emna emna 1400 Dec 28 13:11 README.md\ndrwxrwxr-x 2 emna emna 4096 Dec 28 13:11 spec\nemna@tarek-Vostro-3902:~/Gemfile$ bundle update\nThe gemspec at /home/emna/Gemfile/Gemfile.gemspec is not valid. Please fix this gemspec.\nThe validation error was '\"FIXME\" or \"TODO\" is not an author'\nemna@tarek-Vostro-3902:~/Gemfile$ echo 'gem \"rspec\"' &gt;&gt; Gemfile\nemna@tarek-Vostro-3902:~/Gemfile$ bundle install\nYou have one or more invalid gemspecs that need to be fixed.\nThe gemspec at /home/emna/Gemfile/Gemfile.gemspec is not valid. Please fix this gemspec.\nThe validation error was '\"FIXME\" or \"TODO\" is not an author'\nemna@tarek-Vostro-3902:~/Gemfile$ bundle exec rspec\nbundler: command not found: rspec\nInstall missing gem executables with `bundle install`\nemna@tarek-Vostro-3902:~/Gemfile$ ls\nbin  CODE_OF_CONDUCT.md  Gemfile  Gemfile.gemspec  lib  Rakefile  README.md  spec\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/W2Q9J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W2Q9J.png\" alt=\"enter image description here\"></a>\nThis is an update for the same question, i added the file </p>\n\n<blockquote>\n  <p>Gemfile.gemspec</p>\n</blockquote>\n\n<pre><code>    # coding: utf-8\nlib = File.expand_path('../lib', __FILE__)\n$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)\nrequire 'Gemfile/version'\n\nGem::Specification.new do |spec|\n  spec.name          = \"Gemfile\"\n  spec.version       = Gemfile::VERSION\n  spec.authors       = [\"TODO: Write your name\"]\n  spec.email         = [\"TODO: Write your email address\"]\n\n  spec.summary       = %q{TODO: Write a short summary, because Rubygems requires one.}\n  spec.description   = %q{TODO: Write a longer description or delete this line.}\n  spec.homepage      = \"TODO: Put your gem's website or public repo URL here.\"\n\n  # Prevent pushing this gem to RubyGems.org. To allow pushes either set the 'allowed_push_host'\n  # to allow pushing to a single host or delete this section to allow pushing to any host.\n  if spec.respond_to?(:metadata)\n    spec.metadata['allowed_push_host'] = \"TODO: Set to 'http://mygemserver.com'\"\n  else\n    raise \"RubyGems 2.0 or newer is required to protect against \" \\\n      \"public gem pushes.\"\n  end\n\n  spec.files         = `git ls-files -z`.split(\"\\x0\").reject do |f|\n    f.match(%r{^(test|spec|features)/})\n  end\n  spec.bindir        = \"exe\"\n  spec.executables   = spec.files.grep(%r{^exe/}) { |f| File.basename(f) }\n  spec.require_paths = [\"lib\"]\n\n  spec.add_development_dependency \"bundler\", \"~&gt; 1.13\"\n  spec.add_development_dependency \"rake\", \"~&gt; 10.0\"\n  spec.add_development_dependency \"rspec\", \"~&gt; 3.0\"\nend\n~                                                                                                                                                                                 \n~  \n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 0, "creation_date": 1482927422, "post_id": 41361938, "comment_id": 69925045, "body": "Try <code>&quot;I like dogs.&quot;[0..-2]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7349691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11adaf2c5c27ec6f0918502f3fb11bd?s=128&d=identicon&r=PG&f=1", "display_name": "Robi", "link": "https://stackoverflow.com/users/7349691/robi"}, "edited": false, "score": 0, "creation_date": 1482928392, "post_id": 41362049, "comment_id": 69925596, "body": "Actually I need to apply it into whole text so has to be gsub. The correct then will be .gsub(&quot;.&quot;, &quot;  .&quot;) ?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 11, "user_id": 7349691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11adaf2c5c27ec6f0918502f3fb11bd?s=128&d=identicon&r=PG&f=1", "display_name": "Robi", "link": "https://stackoverflow.com/users/7349691/robi"}, "edited": false, "score": 0, "creation_date": 1482928649, "post_id": 41362049, "comment_id": 69925730, "body": "What is the problem with <i>testing your approach</i>? Yes, to apply this change to the whole text, <code>gsub(&#39;.&#39;, &#39; .&#39;)</code> would be fine."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1482928945, "last_edit_date": 1482928945, "creation_date": 1482927587, "answer_id": 41362049, "question_id": 41361938, "link": "https://stackoverflow.com/questions/41361938/how-to-get-rid-of-dot-in-ruby/41362049#41362049", "title": "How to get rid of &#39;dot&#39; in Ruby", "body": "<p>I assume you want to update the dot if and only it\u2019s trailing in the whole sentence. <code>gsub</code> approach won\u2019t work as is here, since it will substitute all the appearances of dots everywhere.</p>\n\n<p>The regular expression would do, though:</p>\n\n<pre><code>input = 'I like dogs.'\ninput.sub(/\\.\\z/, '') #\u21d2 to get rid of it\ninput.sub(/\\.\\z/, ' .') #\u21d2 to insert a space before it\n</code></pre>\n\n<p><code>\\z</code> matcher here matches the end of the string.</p>\n\n<p>To substitute all the dots in the string:</p>\n\n<pre><code>input.delete('.') #\u21d2 to get rid of it\ninput.gsub('.', ' .') #\u21d2 to insert a space \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11718, "user_id": 1827631, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/I24JN.png?s=128&g=1", "display_name": "hirolau", "link": "https://stackoverflow.com/users/1827631/hirolau"}, "is_accepted": false, "score": 1, "last_activity_date": 1482959305, "creation_date": 1482959305, "answer_id": 41369721, "question_id": 41361938, "link": "https://stackoverflow.com/questions/41361938/how-to-get-rid-of-dot-in-ruby/41369721#41369721", "title": "How to get rid of &#39;dot&#39; in Ruby", "body": "<p>If you only want to get rid of it at the end of the sentence the most rubyish way would be:</p>\n\n<pre><code>a = 'I like dogs.'\np a.chomp('.') #=&gt; \"I like dogs\"\n#modify a by using:\na.chomp!('.')\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7349691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11adaf2c5c27ec6f0918502f3fb11bd?s=128&d=identicon&r=PG&f=1", "display_name": "Robi", "link": "https://stackoverflow.com/users/7349691/robi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1482959305, "creation_date": 1482927227, "last_edit_date": 1482948475, "question_id": 41361938, "link": "https://stackoverflow.com/questions/41361938/how-to-get-rid-of-dot-in-ruby", "title": "How to get rid of &#39;dot&#39; in Ruby", "body": "<p>I want to get rid of 'dot' after the end of the sentence or move the dot with the space  e.g  <code>'I like dogs.'</code> into <code>'I like dogs or i like dogs .'</code></p>\n\n<p>Will this code be correct? </p>\n\n<pre><code>.gsub(\".\", \"  \") \n</code></pre>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 0, "creation_date": 1482926748, "post_id": 41361757, "comment_id": 69924648, "body": "Hey pal, could you explain what that code does? I&#39;m new to Ruby, thanks."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 0, "creation_date": 1482927024, "post_id": 41361757, "comment_id": 69924802, "body": "I think your user model has_many roles. It means, it can contain an array of roles objects. This line pushes the first role at the end of the roles array in the first user."}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1482927618, "post_id": 41361757, "comment_id": 69925171, "body": "<code>id</code> is not necessarily <code>1</code> though if the seeds have been run a couple of times. Better to get the <code>user</code> from <code>user = User.create(...)</code>"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1482927661, "post_id": 41361757, "comment_id": 69925202, "body": "Well, I used the ids the user provided in the question."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1482927693, "last_edit_date": 1482927693, "creation_date": 1482926650, "answer_id": 41361757, "question_id": 41361696, "link": "https://stackoverflow.com/questions/41361696/populate-join-table-using-seeds-rb/41361757#41361757", "title": "Populate join table using seeds.rb", "body": "<p>Try something like</p>\n\n<pre><code>User.first.roles &lt;&lt; Role.first\n</code></pre>\n"}], "owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482927693, "creation_date": 1482926429, "question_id": 41361696, "link": "https://stackoverflow.com/questions/41361696/populate-join-table-using-seeds-rb", "title": "Populate join table using seeds.rb", "body": "<p>In my rails app I have three tables: <code>users</code>, <code>roles</code>, and <code>users_roles</code>.</p>\n\n<p>In my <code>seeds.rb</code> file I have the following ruby code:</p>\n\n<pre><code># create super admin role\nRole.create!([{name: \"Super Admin\", description: \"Super Admin (can do anything)\"}])\n# create user\nUser.create!([{name: \"Cameron\", email: \"cameron.drysdale@example.com\", password_digest: \"$2a$10$k4FPOZlVmy.hIM5z1scFYeFc8cNcVGpq..MU0529LlSGylEqYLaqC\"}])\n# make user super admin\nUser::HABTM_Roles.create!([{user_id: 1, role_id: 1}])\n</code></pre>\n\n<p>However it fails on that last line: <code>User::HABTM_Roles.create!</code></p>\n\n<p>How do I add the data into the join table?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "redis", "sidekiq"], "answers": [{"comments": [{"owner": {"reputation": 3154, "user_id": 5409748, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DQWhS.jpg?s=128&g=1", "display_name": "Jai Kumar Rajput", "link": "https://stackoverflow.com/users/5409748/jai-kumar-rajput"}, "edited": false, "score": 0, "creation_date": 1482921397, "post_id": 41360142, "comment_id": 69921739, "body": "Thanks for suggestion, but if I need to manage from my application how can I handle ? any idea ??"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1482921208, "creation_date": 1482921208, "answer_id": 41360142, "question_id": 41359969, "link": "https://stackoverflow.com/questions/41359969/start-sidekiq-automatically-if-it-is-not-in-running-state-rails/41360142#41360142", "title": "Start Sidekiq automatically if it is not in running state - Rails", "body": "<p>It shouldn't be your applications responsibility to start external programs.</p>\n\n<p>Install and use a server monitoring tool like <a href=\"https://github.com/bluepill-rb/bluepill\" rel=\"nofollow noreferrer\">bluepill</a> or <a href=\"http://godrb.com/\" rel=\"nofollow noreferrer\">god</a> to ensure all dependencies are up and running.</p>\n"}, {"comments": [{"owner": {"reputation": 3154, "user_id": 5409748, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DQWhS.jpg?s=128&g=1", "display_name": "Jai Kumar Rajput", "link": "https://stackoverflow.com/users/5409748/jai-kumar-rajput"}, "edited": false, "score": 0, "creation_date": 1482921609, "post_id": 41360157, "comment_id": 69921872, "body": "Thanks for your answer nitisha it solves my half problem of running sidekiq from my controller but it create a big problem that kills my  rails application :("}, {"owner": {"reputation": 101, "user_id": 6782155, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/702888966529438/picture?type=large", "display_name": "Nitisha", "link": "https://stackoverflow.com/users/6782155/nitisha"}, "reply_to_user": {"reputation": 3154, "user_id": 5409748, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DQWhS.jpg?s=128&g=1", "display_name": "Jai Kumar Rajput", "link": "https://stackoverflow.com/users/5409748/jai-kumar-rajput"}, "edited": false, "score": 0, "creation_date": 1482923858, "post_id": 41360157, "comment_id": 69923041, "body": "install and use a server monitoring tool"}], "tags": [], "owner": {"reputation": 101, "user_id": 6782155, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/702888966529438/picture?type=large", "display_name": "Nitisha", "link": "https://stackoverflow.com/users/6782155/nitisha"}, "is_accepted": true, "score": 6, "last_activity_date": 1482925350, "last_edit_date": 1482925350, "creation_date": 1482921259, "answer_id": 41360157, "question_id": 41359969, "link": "https://stackoverflow.com/questions/41359969/start-sidekiq-automatically-if-it-is-not-in-running-state-rails/41360157#41360157", "title": "Start Sidekiq automatically if it is not in running state - Rails", "body": "<p>You can check sidekiq and redis server running or not running by :</p>\n\n<pre><code>  def redis_connected?\n    !!Sidekiq.redis(&amp;:info) rescue false\n  end\n\n  def sidekiq_connected?\n    ps = Sidekiq::ProcessSet.new\n    ps.size &gt; 0 ? true : false \n  end\n</code></pre>\n\n<p>and you can also start from your controller but this is not a good way because it will start sidekiq but kill rails server.</p>\n\n<pre><code>  def start_sidekiq\n    system \"redis-server &amp;\" if !redis_connected?\n    system \"bundle exec sidekiq -d\" if !sidekiq_connected?\n    flash[:sidekiq_notification]=\"Starting server... Please refresh after few seconds\"\n    redirect_to :back\n  end\n</code></pre>\n\n<p>or install and use a server monitoring tool</p>\n"}, {"tags": [], "owner": {"reputation": 888, "user_id": 3355934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd10fc1565fa16a700c6e50d478b07ff?s=128&d=identicon&r=PG", "display_name": "unkmas", "link": "https://stackoverflow.com/users/3355934/unkmas"}, "is_accepted": false, "score": 1, "last_activity_date": 1482921293, "creation_date": 1482921293, "answer_id": 41360168, "question_id": 41359969, "link": "https://stackoverflow.com/questions/41359969/start-sidekiq-automatically-if-it-is-not-in-running-state-rails/41360168#41360168", "title": "Start Sidekiq automatically if it is not in running state - Rails", "body": "<p>I believe, that this is a wrong way to do it.</p>\n\n<p>I suggest you to setup a monitorring system, which will automatically start your failing workers - you can use <a href=\"http://godrb.com/\" rel=\"nofollow noreferrer\" title=\"God\">God</a>, <a href=\"https://mmonit.com/monit/\" rel=\"nofollow noreferrer\" title=\"Monit\">Monit</a> or whatever you like.</p>\n\n<p>However, if you <strong><em>realy</em></strong> need it, you can perform system calls from ruby - just wrap it in `` or <code>%x{}</code> (for example <code>%x{ bundle exec sidekiq }</code>)</p>\n"}], "owner": {"reputation": 3154, "user_id": 5409748, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DQWhS.jpg?s=128&g=1", "display_name": "Jai Kumar Rajput", "link": "https://stackoverflow.com/users/5409748/jai-kumar-rajput"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 3, "accepted_answer_id": 41360157, "answer_count": 3, "score": 5, "last_activity_date": 1482925350, "creation_date": 1482920648, "question_id": 41359969, "link": "https://stackoverflow.com/questions/41359969/start-sidekiq-automatically-if-it-is-not-in-running-state-rails", "title": "Start Sidekiq automatically if it is not in running state - Rails", "body": "<p>I'm using <code>redis server</code> and <code>sidekiq</code> for my <strong>cron jobs</strong> but some time <code>sidekiq</code> kills automatically at backend.</p>\n\n<p>I want to restart <code>sidekiq</code> from my controller's action or automatically when it kills down without stoping my rails application server.</p>\n\n<p>Please suggest me how can I manage this problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2460, "user_id": 3940126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0222b0a3b16a79649265eabba7e05add?s=128&d=identicon&r=PG&f=1", "display_name": "slowjack2k", "link": "https://stackoverflow.com/users/3940126/slowjack2k"}, "edited": false, "score": 0, "creation_date": 1482919366, "post_id": 41359540, "comment_id": 69920602, "body": "Can you also add the part of your code, which uses this method?"}, {"owner": {"reputation": 43225, "user_id": 297087, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/17b3a5816f0647e9b0f7c49d60f93e7b?s=128&d=identicon&r=PG", "display_name": "Salil", "link": "https://stackoverflow.com/users/297087/salil"}, "edited": false, "score": 0, "creation_date": 1482919513, "post_id": 41359540, "comment_id": 69920677, "body": "Though this is not answer to your question as per the ruby standards you can replace <code>if-else-end</code> with just <code>data.body.include? url</code>"}, {"owner": {"reputation": 140, "user_id": 2742961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fde25d7ea8df799a9a6833b5e637b5d3?s=128&d=identicon&r=PG&f=1", "display_name": "PieterB", "link": "https://stackoverflow.com/users/2742961/pieterb"}, "reply_to_user": {"reputation": 2460, "user_id": 3940126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0222b0a3b16a79649265eabba7e05add?s=128&d=identicon&r=PG&f=1", "display_name": "slowjack2k", "link": "https://stackoverflow.com/users/3940126/slowjack2k"}, "edited": false, "score": 0, "creation_date": 1482919708, "post_id": 41359540, "comment_id": 69920774, "body": "@slowjack2k this part is defined in a model, I use this code in a controller like this project.validate_installation"}, {"owner": {"reputation": 140, "user_id": 2742961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fde25d7ea8df799a9a6833b5e637b5d3?s=128&d=identicon&r=PG&f=1", "display_name": "PieterB", "link": "https://stackoverflow.com/users/2742961/pieterb"}, "reply_to_user": {"reputation": 43225, "user_id": 297087, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/17b3a5816f0647e9b0f7c49d60f93e7b?s=128&d=identicon&r=PG", "display_name": "Salil", "link": "https://stackoverflow.com/users/297087/salil"}, "edited": false, "score": 0, "creation_date": 1482919752, "post_id": 41359540, "comment_id": 69920803, "body": "@Salil thank you for the tip!"}, {"owner": {"reputation": 2460, "user_id": 3940126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0222b0a3b16a79649265eabba7e05add?s=128&d=identicon&r=PG&f=1", "display_name": "slowjack2k", "link": "https://stackoverflow.com/users/3940126/slowjack2k"}, "edited": false, "score": 0, "creation_date": 1482920414, "post_id": 41359540, "comment_id": 69921177, "body": "Maybe you run into an exception. You can catch it via <code>rescue =&gt; e; Rails.logger.error &quot;Error : #{e}&quot;</code>  at the end of your method."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1482921487, "post_id": 41359540, "comment_id": 69921795, "body": "When there is a 500 server error and the <i>We&#39;re sorry, but something went wrong</i> message is shown on a website then Rails logs the error and a stack trace into the servers log file. What is the exact error message? Please post the error message with the stack trace."}, {"owner": {"reputation": 140, "user_id": 2742961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fde25d7ea8df799a9a6833b5e637b5d3?s=128&d=identicon&r=PG&f=1", "display_name": "PieterB", "link": "https://stackoverflow.com/users/2742961/pieterb"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1482921699, "post_id": 41359540, "comment_id": 69921922, "body": "@spickermann this problem only occurs when I run this code on my production machine on DigitalOcean. It doesn&#39;t generate an error, that&#39;s the whole problem. Other errors are shown just fine, but it seems more like a timeout problem or something."}, {"owner": {"reputation": 140, "user_id": 2742961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fde25d7ea8df799a9a6833b5e637b5d3?s=128&d=identicon&r=PG&f=1", "display_name": "PieterB", "link": "https://stackoverflow.com/users/2742961/pieterb"}, "edited": false, "score": 0, "creation_date": 1482922312, "post_id": 41359540, "comment_id": 69922203, "body": "It&#39;s a virtual machine so yes I have acces, but as I told before I can see the activity in the log, but there aren&#39;t any errors generated when I go to the page with that uses this method."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1482923331, "post_id": 41359540, "comment_id": 69922734, "body": "When there is no error in the application log, is there an error in the web server&#39;s log (unicorn, puma, apache, or whatever you use)?"}, {"owner": {"reputation": 140, "user_id": 2742961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fde25d7ea8df799a9a6833b5e637b5d3?s=128&d=identicon&r=PG&f=1", "display_name": "PieterB", "link": "https://stackoverflow.com/users/2742961/pieterb"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1482927311, "post_id": 41359540, "comment_id": 69924984, "body": "@spickermann yes, thanks, found an error in the nginx logs:    upstream prematurely closed connection while reading response header from upstream"}], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 2742961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fde25d7ea8df799a9a6833b5e637b5d3?s=128&d=identicon&r=PG&f=1", "display_name": "PieterB", "link": "https://stackoverflow.com/users/2742961/pieterb"}, "edited": false, "score": 0, "creation_date": 1482920267, "post_id": 41359714, "comment_id": 69921094, "body": "I have added require and restarted the server, no luck. The log files work fine, other info and errors are logged correctly"}, {"owner": {"reputation": 884, "user_id": 1675491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LeqdU.jpg?s=128&g=1", "display_name": "Sandeep Kapil", "link": "https://stackoverflow.com/users/1675491/sandeep-kapil"}, "reply_to_user": {"reputation": 140, "user_id": 2742961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fde25d7ea8df799a9a6833b5e637b5d3?s=128&d=identicon&r=PG&f=1", "display_name": "PieterB", "link": "https://stackoverflow.com/users/2742961/pieterb"}, "edited": false, "score": 0, "creation_date": 1482920854, "post_id": 41359714, "comment_id": 69921446, "body": "@PieterB I have updated the answer. I think you need to make class method as you are calling it as project.validate_installation  Just add self with method name"}], "tags": [], "owner": {"reputation": 884, "user_id": 1675491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LeqdU.jpg?s=128&g=1", "display_name": "Sandeep Kapil", "link": "https://stackoverflow.com/users/1675491/sandeep-kapil"}, "is_accepted": false, "score": 1, "last_activity_date": 1482920641, "last_edit_date": 1482920641, "creation_date": 1482919696, "answer_id": 41359714, "question_id": 41359540, "link": "https://stackoverflow.com/questions/41359540/ror-validate-string-on-website-no-error/41359714#41359714", "title": "RoR - Validate string on website, no error", "body": "<p>Try to include </p>\n\n<pre><code>require 'httparty'\n</code></pre>\n\n<p>Restart rails server</p>\n\n<pre><code>rails s\n</code></pre>\n\n<p>Also check the permission of log folder, why it is not writing error in log folder\nAlso try: Use self keyword as you are calling it as class method</p>\n\n<pre><code>def self.validate_installation\n  data  = HTTParty.get(self.website)\n  url = \"http://www.smartnotif.com/sn.js\"\n  if data.body.include? url\n    return true\n  else\n    return false\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 140, "user_id": 2742961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fde25d7ea8df799a9a6833b5e637b5d3?s=128&d=identicon&r=PG&f=1", "display_name": "PieterB", "link": "https://stackoverflow.com/users/2742961/pieterb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1482921598, "creation_date": 1482919028, "last_edit_date": 1482921598, "question_id": 41359540, "link": "https://stackoverflow.com/questions/41359540/ror-validate-string-on-website-no-error", "title": "RoR - Validate string on website, no error", "body": "<p>In my Ruby on Rails app I have build a function to validate if a piece of javascript is added to a certain website. When I run this code I don't get any errors in my log, but my app says:</p>\n\n<p>We're sorry, but something went wrong.\nIf you are the application owner check the logs for more information.</p>\n\n<p>But when I check the logs I don't see any errors. The code I have used is the following:</p>\n\n<pre><code>def validate_installation\n  data  = HTTParty.get(self.website)\n  url = \"http://www.smartnotif.com/sn.js\"\n  if data.body.include? url\n    return true\n  else\n    return false\n  end\nend\n</code></pre>\n\n<p>When I run this code on my local development machine it runs fine, but when I try to runs this production machine on DigitalOcean I have this problem with the same code, no errors.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongoid"], "comments": [{"owner": {"reputation": 912, "user_id": 6507620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nI75J.jpg?s=128&g=1", "display_name": "Abhay Dixit", "link": "https://stackoverflow.com/users/6507620/abhay-dixit"}, "edited": false, "score": 0, "creation_date": 1482919773, "post_id": 41359519, "comment_id": 69920815, "body": "Person.where(Age: 42).first"}, {"owner": {"reputation": 912, "user_id": 6507620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nI75J.jpg?s=128&g=1", "display_name": "Abhay Dixit", "link": "https://stackoverflow.com/users/6507620/abhay-dixit"}, "edited": false, "score": 0, "creation_date": 1482919803, "post_id": 41359519, "comment_id": 69920829, "body": "If not exist then try this so it will create and return: Person.where(Age: 42).first_or_create"}], "answers": [{"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1482925249, "last_edit_date": 1482925249, "creation_date": 1482919084, "answer_id": 41359556, "question_id": 41359519, "link": "https://stackoverflow.com/questions/41359519/mongoid-querys-equal-operator/41359556#41359556", "title": "Mongoid query&#39;s equal operator", "body": "<p>What about just :</p>\n\n<pre><code>Person.where(Age: 42).first\n</code></pre>\n\n<p>?</p>\n"}, {"tags": [], "owner": {"reputation": 2351, "user_id": 1238111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xLdRX.jpg?s=128&g=1", "display_name": "Shamsul Haque", "link": "https://stackoverflow.com/users/1238111/shamsul-haque"}, "is_accepted": true, "score": 0, "last_activity_date": 1482919541, "last_edit_date": 1482919541, "creation_date": 1482919158, "answer_id": 41359575, "question_id": 41359519, "link": "https://stackoverflow.com/questions/41359519/mongoid-querys-equal-operator/41359575#41359575", "title": "Mongoid query&#39;s equal operator", "body": "<p>Try it:-</p>\n\n<pre><code>Person.where(:age =&gt; 42).first\n</code></pre>\n\n<p>It will query the <code>Person</code> having <code>age = 42</code></p>\n\n<p>OR</p>\n\n<p>Query in this way:-</p>\n\n<pre><code>Person.find_by age: 42\n</code></pre>\n\n<p>The find_by method finds the first record matching with this condition</p>\n\n<p><a href=\"http://guides.rubyonrails.org/active_record_querying.html\" rel=\"nofollow noreferrer\">See the documentation</a></p>\n"}], "owner": {"reputation": 105, "user_id": 3146542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d83228d0b7e595ba1f6873abd9ac889?s=128&d=identicon&r=PG&f=1", "display_name": "marouane18", "link": "https://stackoverflow.com/users/3146542/marouane18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "accepted_answer_id": 41359575, "answer_count": 2, "score": 1, "last_activity_date": 1482925249, "creation_date": 1482918943, "last_edit_date": 1482920592, "question_id": 41359519, "link": "https://stackoverflow.com/questions/41359519/mongoid-querys-equal-operator", "title": "Mongoid query&#39;s equal operator", "body": "<p>I want to get the first 42 years old person in my database.</p>\n\n<p>How can i make this query works :</p>\n\n<pre><code>Person.where(:Age.eq =&gt; 42).first\n</code></pre>\n\n<p>Instead of getting the query's result, I got :</p>\n\n<pre><code>undefined method `eq' for :Age:Symbol\n</code></pre>\n"}, {"tags": ["ruby", "bundler"], "comments": [{"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1483090460, "post_id": 41359249, "comment_id": 69989475, "body": "did you consider reading the <code>gemfile.lock</code> and reverse-engineering the <code>gemfile</code>? Bundler is designed to use gemfiles, I don&#39;t recommend you fight it."}, {"owner": {"reputation": 937, "user_id": 107464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b83f65b720896d40f0c648e55649a85f?s=128&d=identicon&r=PG", "display_name": "agate", "link": "https://stackoverflow.com/users/107464/agate"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1483343138, "post_id": 41359249, "comment_id": 70051434, "body": "@Myst I am trying either reverse gemfile.lock -&gt; gemfile OR bundle install directly via gemfile.lock. It&#39;s because I only have Gemfile.lock right now. The Gemfile will <code>require</code> some external Gemfile in another repo. So when I build my docker image. I only have the generated Gemfile.lock. What should I do?"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1483422142, "post_id": 41359249, "comment_id": 70080185, "body": "maybe download a local copy every time you run the script?"}], "answers": [{"comments": [{"owner": {"reputation": 937, "user_id": 107464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b83f65b720896d40f0c648e55649a85f?s=128&d=identicon&r=PG", "display_name": "agate", "link": "https://stackoverflow.com/users/107464/agate"}, "edited": false, "score": 0, "creation_date": 1483089102, "post_id": 41360297, "comment_id": 69988946, "body": "Thanks! I tried this before. But I got <code>Could not locate Gemfile</code> error."}], "tags": [], "owner": {"reputation": 888, "user_id": 3355934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd10fc1565fa16a700c6e50d478b07ff?s=128&d=identicon&r=PG", "display_name": "unkmas", "link": "https://stackoverflow.com/users/3355934/unkmas"}, "is_accepted": false, "score": 1, "last_activity_date": 1482921705, "creation_date": 1482921705, "answer_id": 41360297, "question_id": 41359249, "link": "https://stackoverflow.com/questions/41359249/how-to-install-gems-based-on-gemfile-lock-without-gemfile/41360297#41360297", "title": "How to install gems based on Gemfile.lock (without Gemfile)", "body": "<p>You can use <a href=\"http://bundler.io/v1.3/man/bundle-install.1.html#DEPLOYMENT-MODE\" rel=\"nofollow noreferrer\">deployment mode</a> of a bundler.</p>\n"}, {"comments": [{"owner": {"reputation": 937, "user_id": 107464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b83f65b720896d40f0c648e55649a85f?s=128&d=identicon&r=PG", "display_name": "agate", "link": "https://stackoverflow.com/users/107464/agate"}, "edited": false, "score": 0, "creation_date": 1483088447, "post_id": 41362282, "comment_id": 69988657, "body": "I saw this solution in other thread. But when I try to use it. I got error: <code>Could not locate Gemfile</code>"}], "tags": [], "owner": {"reputation": 791, "user_id": 5120006, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/VLzrM.jpg?s=128&g=1", "display_name": "Cent", "link": "https://stackoverflow.com/users/5120006/cent"}, "is_accepted": false, "score": 0, "last_activity_date": 1482928463, "creation_date": 1482928463, "answer_id": 41362282, "question_id": 41359249, "link": "https://stackoverflow.com/questions/41359249/how-to-install-gems-based-on-gemfile-lock-without-gemfile/41362282#41362282", "title": "How to install gems based on Gemfile.lock (without Gemfile)", "body": "<p>With only <code>gemfile.lock</code>, you can run</p>\n\n<pre><code>bundle install --deployment \n</code></pre>\n\n<p>The only catch is that this command installs gems to the vendor/bundle instead of your normal gem bundle path. it is so because it is expected to be used only in production.</p>\n\n<p>It works well all the same though.</p>\n"}, {"comments": [{"owner": {"reputation": 937, "user_id": 107464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b83f65b720896d40f0c648e55649a85f?s=128&d=identicon&r=PG", "display_name": "agate", "link": "https://stackoverflow.com/users/107464/agate"}, "edited": false, "score": 0, "creation_date": 1483089062, "post_id": 41365082, "comment_id": 69988921, "body": "I know I can do that. But I am trying to build a docker image. Which I hope I can re-use my local Gemfile.lock. So that I don&#39;t have to manually add bunch of gem install commands."}], "tags": [], "owner": {"reputation": 95, "user_id": 6129289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qXEXx.png?s=128&g=1", "display_name": "LBarry", "link": "https://stackoverflow.com/users/6129289/lbarry"}, "is_accepted": false, "score": 0, "last_activity_date": 1482939009, "creation_date": 1482939009, "answer_id": 41365082, "question_id": 41359249, "link": "https://stackoverflow.com/questions/41359249/how-to-install-gems-based-on-gemfile-lock-without-gemfile/41365082#41365082", "title": "How to install gems based on Gemfile.lock (without Gemfile)", "body": "<p>Have you tried simply running the gem install directly in your terminal? That way you won't need to use a Gemfile at all. </p>\n\n<p>For example, with the devise gem, you can just run <code>$ gem install devise</code> in your terminal and that will install the devise gem without adding it to your Gemfile.</p>\n"}], "owner": {"reputation": 937, "user_id": 107464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b83f65b720896d40f0c648e55649a85f?s=128&d=identicon&r=PG", "display_name": "agate", "link": "https://stackoverflow.com/users/107464/agate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1007, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1483423490, "creation_date": 1482917974, "last_edit_date": 1483423490, "question_id": 41359249, "link": "https://stackoverflow.com/questions/41359249/how-to-install-gems-based-on-gemfile-lock-without-gemfile", "title": "How to install gems based on Gemfile.lock (without Gemfile)", "body": "<p>Usually, people will use <code>bundle install</code> to install gems. But it require Gemfile and Gemfile.lock(optional).</p>\n\n<p>My situation is a little different. I only have Gemfile.lock. So how can I install all these gems based on <code>bundle</code> command.</p>\n\n<p>I tried <code>bundle install --deployment</code>. But I got <strong>Could not locate Gemfile</strong> error.</p>\n\n<hr>\n\n<p>OK. I asked this question in bundler github issues. Their member gave me a good answer: <a href=\"https://github.com/bundler/bundler/issues/5293#issuecomment-269978731\" rel=\"nofollow noreferrer\">https://github.com/bundler/bundler/issues/5293#issuecomment-269978731</a></p>\n\n<p>For summary -- <strong>I CAN NOT DO THAT</strong></p>\n\n<p>I gave up to run <code>bundle install</code> with Gemfile.lock only. But I still need to solve my problem. And in my Gemfile, I don't have any special options like groups, platforms, install conditionals. So I wrote a <a href=\"https://rubygems.org/gems/gemfile_lock_to_gemfile\" rel=\"nofollow noreferrer\">script(gem)</a> to revert the Gemfile.lock to Gemfile for my docker image.</p>\n\n<p>[SOLVED]</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482918837, "post_id": 41358669, "comment_id": 69920357, "body": "Do you have an example of a few CSV lines? It might also be caused by unclosed quotes."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5603403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e45dee607eb4a677482dababf1933e08?s=128&d=identicon&r=PG&f=1", "display_name": "Uhraya", "link": "https://stackoverflow.com/users/5603403/uhraya"}, "edited": false, "score": 0, "creation_date": 1482919837, "post_id": 41359679, "comment_id": 69920842, "body": "Yes, I have done that. The test I ran with the test file worked with no problems."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 13, "user_id": 5603403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e45dee607eb4a677482dababf1933e08?s=128&d=identicon&r=PG&f=1", "display_name": "Uhraya", "link": "https://stackoverflow.com/users/5603403/uhraya"}, "edited": false, "score": 0, "creation_date": 1482919893, "post_id": 41359679, "comment_id": 69920872, "body": "Could please upload a few lines, with the exact same encoding and newlines as your problematic file?"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1482919553, "creation_date": 1482919553, "answer_id": 41359679, "question_id": 41358669, "link": "https://stackoverflow.com/questions/41358669/ruby-csv-format-error-when-reading-files-with-cr-cl-lf/41359679#41359679", "title": "Ruby CSV Format Error when reading files with CR / CL / LF", "body": "<p>Did you specify a custom column separator <code>|</code> ?</p>\n\n<pre><code>string = \"670|FirstDataaset|Uppertreet 5|GB|1000|Blue|98764-6547|0374-453534|HU-0973409745|example@example.de\"\n\nrequire 'csv'\n\np CSV.parse(string, :col_sep =&gt; \"|\")\n# =&gt; [[\"670\", \"FirstDataaset\", \"Uppertreet 5\", \"GB\", \"1000\", \"Blue\", \"98764-6547\", \"0374-453534\", \"HU-0973409745\", \"example@example.de\"]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 339, "user_id": 4948806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nikpC.jpg?s=128&g=1", "display_name": "kamal patwa", "link": "https://stackoverflow.com/users/4948806/kamal-patwa"}, "is_accepted": false, "score": 1, "last_activity_date": 1482923682, "creation_date": 1482923682, "answer_id": 41360909, "question_id": 41358669, "link": "https://stackoverflow.com/questions/41358669/ruby-csv-format-error-when-reading-files-with-cr-cl-lf/41360909#41360909", "title": "Ruby CSV Format Error when reading files with CR / CL / LF", "body": "<p>Since the is a file that you are trying to open, you can do this</p>\n\n<pre><code>CSV.foreach(file_path,:col_sep =&gt; '|') do |row|\n   # whatever you wanna do\nend \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5603403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e45dee607eb4a677482dababf1933e08?s=128&d=identicon&r=PG&f=1", "display_name": "Uhraya", "link": "https://stackoverflow.com/users/5603403/uhraya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1482923682, "creation_date": 1482915903, "last_edit_date": 1482919212, "question_id": 41358669, "link": "https://stackoverflow.com/questions/41358669/ruby-csv-format-error-when-reading-files-with-cr-cl-lf", "title": "Ruby CSV Format Error when reading files with CR / CL / LF", "body": "<p>I am having a problem reading a .csv file in ruby.</p>\n\n<p>The file format I get for the File is the following:</p>\n\n<pre><code>UTF-8 Unicode text, with CR, LF line terminators\n</code></pre>\n\n<p>The Error I get is this:</p>\n\n<pre><code>/usr/local/lib/ruby/1.8/csv.rb:607:in `get_row': CSV::IllegalFormatError (CSV::IllegalFormatError)\n</code></pre>\n\n<p>I tried converting the file to</p>\n\n<pre><code>UTF-8 Unicode text, with CRLF, CR line terminators\n</code></pre>\n\n<p>with no change.</p>\n\n<p>Converting to ASCII yields the same results.</p>\n\n<p>Does anyone have experience with this and can offer a solution?</p>\n\n<p>EDIT:\nAs requested a sample line of the csv</p>\n\n<pre><code>670|FirstDataaset|Uppertreet 5|GB|1000|Blue|98764-6547|0374-453534|HU-0973409745|example@example.de\n</code></pre>\n\n<p>It is not the Data, I checked by copy pasting it into a new file and using that for a Test file (not a viable option as a solution, just to confirm the data is not the problem)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "factory-bot"], "comments": [{"owner": {"reputation": 106, "user_id": 3583143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1d00bae34156c54aa6cbb7eb53ba9d0?s=128&d=identicon&r=PG&f=1", "display_name": "iSunRise", "link": "https://stackoverflow.com/users/3583143/isunrise"}, "edited": false, "score": 0, "creation_date": 1482917326, "post_id": 41358658, "comment_id": 69919522, "body": "You should use <code>belongs_to</code> association instead of <code>has_one</code>. However, it&#39;s impossible to say exactly, since you don&#39;t show your models."}], "answers": [{"tags": [], "owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "is_accepted": true, "score": 3, "last_activity_date": 1482918882, "creation_date": 1482918882, "answer_id": 41359500, "question_id": 41358658, "link": "https://stackoverflow.com/questions/41358658/factorygirl-i-cant-express-the-association-of-1-on-1-has-one-with-rspec/41359500#41359500", "title": "Factorygirl , I can&#39;t express the association of 1 on 1 (has_one) with rspec", "body": "<p>The ids are nil because the records are not persisted. When you use <code>build</code> method, it does not save a record in the database. If a record is not saved, it cannot have ID. Use <code>create</code> method instead.</p>\n\n<p>Try this:</p>\n\n<pre><code>factory :deciding do\n   after(:build) do |deciding|\n    deciding.asking ||= create(:asking)\n    deciding.undertaking ||= create(:undertaking)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 7068409, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b6d842dc40dba7077f68f7aeadab2c32?s=128&d=identicon&r=PG&f=1", "display_name": "HAYATO SHIBA", "link": "https://stackoverflow.com/users/7068409/hayato-shiba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 41359500, "answer_count": 1, "score": 0, "last_activity_date": 1482918882, "creation_date": 1482915858, "question_id": 41358658, "link": "https://stackoverflow.com/questions/41358658/factorygirl-i-cant-express-the-association-of-1-on-1-has-one-with-rspec", "title": "Factorygirl , I can&#39;t express the association of 1 on 1 (has_one) with rspec", "body": "<p>I want to test #create in Decidingscontroller , and Deciding model has undertaking_id column in association with Undertaking model , and has asking_id column in association with Asking model. \nSo, My factories/decidings.rb is below.</p>\n\n<pre><code>    factory :deciding do\n       after(:build) do |deciding|\n        deciding.asking ||=build(:asking, deciding: deciding)\n        deciding.undertaking ||=build(:undertaking, deciding: deciding)\n      end\n    end\n</code></pre>\n\n<p>and My spec/controllers/decidings_controller_spec.rb is below.</p>\n\n<pre><code>     RSpec.describe DecidingsController, type: :controller do\n      describe '#create' do\n       before do\n         @deciding=build(:deciding)\n       end\n       context 'correct_user login' do\n         before do \n             login_user(@deciding.asking.user)\n         end\n         it 'creates with deciding +1' do\n           expect{post :create , undertaking_id: @deciding.undertaking_id , asking_id: @deciding.asking_id}.to change(Deciding , :count).by(1)\n         end\n      end\n    end\n   end\n</code></pre>\n\n<p>but @deciding in this case is below.</p>\n\n<pre><code>    #&lt;Deciding id: nil, asking_id: nil, undertaking_id: nil, created_at: nil, updated_at: nil&gt;\n</code></pre>\n\n<p>so I can't create test because undertaking_id and asking_id is nil.\nWhy is undertaking_id and asking_id nil? Please help me...\nAnyway , My factories/asking.rb  is below.</p>\n\n<pre><code>   FactoryGirl.define do\n    factory :asking do\n      association :user\n      sequence(:content){|i| \"\u304a\u9858\u3044\u3057\u307e\u3059#{i}\"}\n   end\n  end\n</code></pre>\n"}, {"tags": ["ruby", "logstash", "logstash-grok", "logstash-configuration"], "comments": [{"owner": {"reputation": 421, "user_id": 6064984, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--3y_6NlDDlg/AAAAAAAAAAI/AAAAAAAAB0A/8CJKYEZhG8k/photo.jpg?sz=128", "display_name": "Jeeva N", "link": "https://stackoverflow.com/users/6064984/jeeva-n"}, "edited": false, "score": 0, "creation_date": 1482918747, "post_id": 41356652, "comment_id": 69920314, "body": "How it will be duplicate, its about the time format time to millisecond before applying the difference.  There, it was said like apply the difference and convert the seconds to millisecond. i thing both have some difference"}], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 6064984, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--3y_6NlDDlg/AAAAAAAAAAI/AAAAAAAAB0A/8CJKYEZhG8k/photo.jpg?sz=128", "display_name": "Jeeva N", "link": "https://stackoverflow.com/users/6064984/jeeva-n"}, "edited": false, "score": 0, "creation_date": 1482918403, "post_id": 41356885, "comment_id": 69920134, "body": "Yes, separator between the seconds and milliseconds is the problem, Thanks @akuhn"}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 1, "last_activity_date": 1482908169, "creation_date": 1482908169, "answer_id": 41356885, "question_id": 41356652, "link": "https://stackoverflow.com/questions/41356652/how-to-find-time-difference-in-milliseconds-from-two-datetime-stamp-field-using/41356885#41356885", "title": "How to find time difference in milliseconds from two datetime stamp field using ruby", "body": "<p>Use <code>to_f</code></p>\n\n<pre><code>millisec = 1000 * (response_time.to_f - request_time.to_f)\n</code></pre>\n\n<p>The timestamps must have this format though,</p>\n\n<pre><code>\"2016-12-27 18:35:13.833\"\n</code></pre>\n\n<p>Notice the <code>.</code> separator between seconds and milliseconds!</p>\n"}], "owner": {"reputation": 421, "user_id": 6064984, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--3y_6NlDDlg/AAAAAAAAAAI/AAAAAAAAB0A/8CJKYEZhG8k/photo.jpg?sz=128", "display_name": "Jeeva N", "link": "https://stackoverflow.com/users/6064984/jeeva-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1601, "favorite_count": 1, "closed_date": 1482908436, "accepted_answer_id": 41356885, "answer_count": 1, "score": 3, "last_activity_date": 1482908169, "creation_date": 1482907181, "last_edit_date": 1482907344, "question_id": 41356652, "link": "https://stackoverflow.com/questions/41356652/how-to-find-time-difference-in-milliseconds-from-two-datetime-stamp-field-using", "closed_reason": "Duplicate", "title": "How to find time difference in milliseconds from two datetime stamp field using ruby", "body": "<p>I need to get time difference from two time stamp fields,\ni.e.,\nMy input :\n \"requestTime\" => \"2016-12-27 18:35:13:833\",\n \"responseTime\" => \"2016-12-27 18:35:13:834\",</p>\n\n<p>I Need to get time diff as 1 milliseconds as a result.</p>\n\n<p>I used this code :</p>\n\n<pre><code> event['time_difference']= (Time.parse(event['responseTime']).to_i) - (Time.parse(event['requestTime']).to_i)\n</code></pre>\n\n<p>I got result as 0 seconds for above input. </p>\n"}, {"tags": ["javascript", "php", "ruby-on-rails", "ruby", "client-server"], "comments": [{"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 1, "creation_date": 1482906880, "post_id": 41356233, "comment_id": 69914839, "body": "Can you give a concrete example? That really depends and differs from case to case."}, {"owner": {"reputation": 2176, "user_id": 4756398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/327d9051425cf0168c13dcbeb992925a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Davenport", "link": "https://stackoverflow.com/users/4756398/jeff-davenport"}, "reply_to_user": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1482907168, "post_id": 41356233, "comment_id": 69914960, "body": "I am not looking for a specific case, I am just wondering, if I truly have the option to use client or server side methods on the same object without any harm, which should I be using?"}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 2, "creation_date": 1482907360, "post_id": 41356233, "comment_id": 69915044, "body": "Guess my answer is then. Whatever you prefer and makes sense for your project. Maybe this question is better for <a href=\"http://softwareengineering.stackexchange.com\">softwareengineering.stackexchange.com</a>"}, {"owner": {"reputation": 6198, "user_id": 839601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6db99aa846a8217f7e2aba6fa198e7c?s=128&d=identicon&r=PG", "display_name": "gnat", "link": "https://stackoverflow.com/users/839601/gnat"}, "reply_to_user": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1482909730, "post_id": 41356233, "comment_id": 69915980, "body": "@akuhn when referring other sites, it is often helpful to point that <a href=\"http://meta.stackexchange.com/tags/cross-posting/info\">cross-posting is frowned upon</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2176, "user_id": 4756398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/327d9051425cf0168c13dcbeb992925a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Davenport", "link": "https://stackoverflow.com/users/4756398/jeff-davenport"}, "edited": false, "score": 1, "creation_date": 1482908010, "post_id": 41356771, "comment_id": 69915307, "body": "Thank you for mentioning validation, I&#39;ve never heard about this term before"}, {"owner": {"reputation": 2176, "user_id": 4756398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/327d9051425cf0168c13dcbeb992925a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Davenport", "link": "https://stackoverflow.com/users/4756398/jeff-davenport"}, "edited": false, "score": 0, "creation_date": 1482908405, "post_id": 41356771, "comment_id": 69915446, "body": "Can you explain exactly what you mean by &quot;All three levels have to produce the same result for a piece of data&quot;, so by that you mean, if I have a method on the server side that does something, I must have something on the client side that does the same thing?"}, {"owner": {"reputation": 1406, "user_id": 1743049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iY3ih.jpg?s=128&g=1", "display_name": "vothaison", "link": "https://stackoverflow.com/users/1743049/vothaison"}, "reply_to_user": {"reputation": 2176, "user_id": 4756398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/327d9051425cf0168c13dcbeb992925a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Davenport", "link": "https://stackoverflow.com/users/4756398/jeff-davenport"}, "edited": false, "score": 0, "creation_date": 1482909135, "post_id": 41356771, "comment_id": 69915737, "body": "Well, you must have done email validation for a thousand times. On client you have Javascript regex to validate the email string. This improves UX, users can quickly fix there input mistake. When validation passed, you post the data to server. On server, when you receive the email string, you have server code to validate that email again, because you should never trust what we get from client. When server validation passed, you put the data to database. There you might have some constraints or triggers, or store procedures to validate the email string again."}], "tags": [], "owner": {"reputation": 1406, "user_id": 1743049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iY3ih.jpg?s=128&g=1", "display_name": "vothaison", "link": "https://stackoverflow.com/users/1743049/vothaison"}, "is_accepted": true, "score": 4, "last_activity_date": 1482907721, "creation_date": 1482907721, "answer_id": 41356771, "question_id": 41356233, "link": "https://stackoverflow.com/questions/41356233/how-can-i-determine-to-use-server-code-or-client-code/41356771#41356771", "title": "How can I determine to use server code or client code", "body": "<p>Take validation as an example. A normal system <strong>should</strong> have (at least) 3 level of validation:</p>\n\n<ul>\n<li>Client</li>\n<li>Server</li>\n<li>Database</li>\n</ul>\n\n<p>All three levels have to produce the same result for a piece of data. \nClient validation just helps improving UX, not substitutes for Server and Database validation. </p>\n"}], "owner": {"reputation": 2176, "user_id": 4756398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/327d9051425cf0168c13dcbeb992925a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Davenport", "link": "https://stackoverflow.com/users/4756398/jeff-davenport"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "closed_date": 1482952244, "accepted_answer_id": 41356771, "answer_count": 1, "score": 0, "last_activity_date": 1482907721, "creation_date": 1482904899, "last_edit_date": 1482905780, "question_id": 41356233, "link": "https://stackoverflow.com/questions/41356233/how-can-i-determine-to-use-server-code-or-client-code", "closed_reason": "Needs more focus", "title": "How can I determine to use server code or client code", "body": "<p>I understand that anything that does <em>not</em> pertain to the UI should be always done on the server side. </p>\n\n<p>In this situation, There is a Server object passed as a client Object, the methods that I am wondering about are perfectly fine to be manipulated by anyone. </p>\n\n<p>In cases like this, should I always be using client-side methods on the object to take some of the load off the server and keep the server code short? Or should I be re-obtaining the object from the server and use server-side methods on the object whenever possible to make sure that the returned results are always the same? What is the rails way?</p>\n\n<p>I am not concerned about which way will take longer to do, but which way is best?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "redmine", "gem-bundler"], "answers": [{"tags": [], "owner": {"reputation": 42, "user_id": 3759132, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wojtw.jpg?s=128&g=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3759132/akshay"}, "is_accepted": false, "score": -2, "last_activity_date": 1482925851, "creation_date": 1482925851, "answer_id": 41361536, "question_id": 41356086, "link": "https://stackoverflow.com/questions/41356086/gemextbuilderror-error-failed-to-build-gem-native-extension-on-cenos-6-5/41361536#41361536", "title": "Gem::Ext::BuildError: ERROR: Failed to build gem native extension. on CenOS 6.5", "body": "<p>first run</p>\n\n<pre><code>gem install bundler\n</code></pre>\n\n<p>It installs the newer bundler and solves the native extension dependencies</p>\n\n<p>then run</p>\n\n<pre><code>bundle install \n</code></pre>\n\n<p>it should solve the your issue</p>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 7348388, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kdlCO2iQkHg/AAAAAAAAAAI/AAAAAAAABj4/1EzBTxUxNqA/photo.jpg?sz=128", "display_name": "Johnson", "link": "https://stackoverflow.com/users/7348388/johnson"}, "edited": false, "score": 1, "creation_date": 1482973562, "post_id": 41368000, "comment_id": 69945485, "body": "I see... That means Ruby 2.4 do not support JSON 1.8.3. Then, is there any information that stable(?) gems list following ruby version? I wanna know searching keyword to do myself."}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "reply_to_user": {"reputation": 87, "user_id": 7348388, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kdlCO2iQkHg/AAAAAAAAAAI/AAAAAAAABj4/1EzBTxUxNqA/photo.jpg?sz=128", "display_name": "Johnson", "link": "https://stackoverflow.com/users/7348388/johnson"}, "edited": false, "score": 0, "creation_date": 1482998401, "post_id": 41368000, "comment_id": 69952449, "body": "Well, each gem implements their own compatibility mechanisms. To be sure, you have to read the documentation, try it or ask the maintainers. You can also google for &quot;[gemname] ruby 2.4&quot; or &quot;[gemname] [error message]&quot;. As for the json gem, they support Ruby 2.4 <a href=\"https://github.com/flori/json/blob/master/CHANGES.md#2015-09-11-200\" rel=\"nofollow noreferrer\">since json 2.0</a>. The required changes <a href=\"https://github.com/flori/json/issues/308\" rel=\"nofollow noreferrer\">were backported to the 1.8 branch</a> but are not released yet."}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 3, "last_activity_date": 1482950927, "creation_date": 1482950927, "answer_id": 41368000, "question_id": 41356086, "link": "https://stackoverflow.com/questions/41356086/gemextbuilderror-error-failed-to-build-gem-native-extension-on-cenos-6-5/41368000#41368000", "title": "Gem::Ext::BuildError: ERROR: Failed to build gem native extension. on CenOS 6.5", "body": "<p>Ruby 2.4 is very new. In fact, it was released only 3 days ago. </p>\n\n<p>Since there are several impirtant internal changes in Ruby 2.4, it is quite likely that many gems (and Redmine itself) are not yet compatible with this version of Ruby.</p>\n\n<p>From your error message, it does indeed seem that the JSON gem needs to be adapted in order to handle some changes in Ruby 2.4 regarding whole numbers.</p>\n\n<p>You should use an older version of Ruby for now, e.g. Ruby 2.3.3. As you can see on <a href=\"http://www.redmine.org/projects/redmine/wiki/RedmineInstall#Ruby-interpreter\" rel=\"nofollow noreferrer\">http://www.redmine.org/projects/redmine/wiki/RedmineInstall#Ruby-interpreter</a>, Redmine requires specific Ruby versions depending on the version of Redmine.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 4187416, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tm7MR-oHSY4/AAAAAAAAAAI/AAAAAAAAPqk/9BJuIszatGc/photo.jpg?sz=128", "display_name": "Titzi", "link": "https://stackoverflow.com/users/4187416/titzi"}, "is_accepted": false, "score": 0, "last_activity_date": 1485518939, "last_edit_date": 1495539981, "creation_date": 1485518939, "answer_id": 41893665, "question_id": 41356086, "link": "https://stackoverflow.com/questions/41356086/gemextbuilderror-error-failed-to-build-gem-native-extension-on-cenos-6-5/41893665#41893665", "title": "Gem::Ext::BuildError: ERROR: Failed to build gem native extension. on CenOS 6.5", "body": "<p>I had the same issue right now.\nTo solve it install the latest version of <code>bundler</code> and <code>rmagick</code> manually using <code>gem install</code> update all other packages with <code>gem update</code> and <code>bundle update</code>.\nThis solved this dependency issue of <code>json 1.8.3</code> and <code>ruby 2.4</code>.</p>\n\n<p>But I run in some more problems afterwords.\nIt seams like <code>ruby 2.4</code> does some changes in the interpretation of number which means it is not compatible with <code>rail 4.x</code> anymore <a href=\"https://stackoverflow.com/questions/41504106/ruby-2-4-and-rails-4-0-8-stack-level-too-deep-systemstackerror\">(see this post)</a>.\nUpdating <code>rails</code> and its dependencies seems to be not possibles yet as redmine needs <code>protected_attributes</code> which depends on\n      <code>activemodel (&lt; 5.0, &gt;= 4.0.1)</code> and <code>rails 5.x</code> depends on\n      <code>activemodel 5.x</code>.</p>\n\n<p>It is always bad if an update breaks backward compatibility especially for programming language :(</p>\n"}, {"comments": [{"owner": {"reputation": 2715, "user_id": 1723857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a484360304f8cd53cdffc60746038d98?s=128&d=identicon&r=PG", "display_name": "kenlukas", "link": "https://stackoverflow.com/users/1723857/kenlukas"}, "edited": false, "score": 0, "creation_date": 1568649775, "post_id": 57959458, "comment_id": 102332897, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href=\"/review/low-quality-posts/24063571\">From Review</a>"}, {"owner": {"reputation": 25, "user_id": 765194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jFKyr.jpg?s=128&g=1", "display_name": "icarus", "link": "https://stackoverflow.com/users/765194/icarus"}, "reply_to_user": {"reputation": 2715, "user_id": 1723857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a484360304f8cd53cdffc60746038d98?s=128&d=identicon&r=PG", "display_name": "kenlukas", "link": "https://stackoverflow.com/users/1723857/kenlukas"}, "edited": false, "score": 0, "creation_date": 1568651768, "post_id": 57959458, "comment_id": 102333682, "body": "ok, i will elaborate more from now on, but it seems to be a simple thing that doesn&#39;t need an explanation."}], "tags": [], "owner": {"reputation": 25, "user_id": 765194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jFKyr.jpg?s=128&g=1", "display_name": "icarus", "link": "https://stackoverflow.com/users/765194/icarus"}, "is_accepted": false, "score": -1, "last_activity_date": 1568651951, "last_edit_date": 1568651951, "creation_date": 1568645712, "answer_id": 57959458, "question_id": 41356086, "link": "https://stackoverflow.com/questions/41356086/gemextbuilderror-error-failed-to-build-gem-native-extension-on-cenos-6-5/57959458#57959458", "title": "Gem::Ext::BuildError: ERROR: Failed to build gem native extension. on CenOS 6.5", "body": "<p>it seems that the json gem is having a bug with newer ruby version (2.4+), that <a href=\"https://makandracards.com/makandra/74544-how-to-fix-json-1-8-3-with-ruby-2-5\" rel=\"nofollow noreferrer\">answer</a> from makandracards is proposing a simple and easy solution.</p>\n\n<p>the answer is about updating the version of json gem to tackle the bug and successfully install the gem. so, it updates the json gem with --conservative option.</p>\n\n<p><code>bundle update json --conservative</code></p>\n"}], "owner": {"reputation": 87, "user_id": 7348388, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kdlCO2iQkHg/AAAAAAAAAAI/AAAAAAAABj4/1EzBTxUxNqA/photo.jpg?sz=128", "display_name": "Johnson", "link": "https://stackoverflow.com/users/7348388/johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1758, "favorite_count": 0, "accepted_answer_id": 41368000, "answer_count": 4, "score": 4, "last_activity_date": 1568651951, "creation_date": 1482904150, "last_edit_date": 1490017277, "question_id": 41356086, "link": "https://stackoverflow.com/questions/41356086/gemextbuilderror-error-failed-to-build-gem-native-extension-on-cenos-6-5", "title": "Gem::Ext::BuildError: ERROR: Failed to build gem native extension. on CenOS 6.5", "body": "<p>Installing Redmine.\nI've tried,</p>\n\n<pre><code>bundle install --without development test postgresql sqlite\n</code></pre>\n\n<p>, but error.</p>\n\n<p>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.</p>\n\n<pre><code>current directory:\n/usr/local/lib/ruby/gems/2.4.0/gems/json-1.8.3/ext/json/ext/generator\n/usr/local/bin/ruby -r ./siteconf20161228-21055-1dxe9y9.rb extconf.rb\ncreating Makefile\n\ncurrent directory:\n/usr/local/lib/ruby/gems/2.4.0/gems/json-1.8.3/ext/json/ext/generator\nmake \"DESTDIR=\" clean\n\ncurrent directory:\n/usr/local/lib/ruby/gems/2.4.0/gems/json-1.8.3/ext/json/ext/generator\nmake \"DESTDIR=\"\ncompiling generator.c\ngenerator.c: In function \u2018generate_json\u2019:\ngenerator.c:861: error: \u2018rb_cFixnum\u2019 undeclared (first use in this\nfunction)\ngenerator.c:861: error: (Each undeclared identifier is reported only\nonce\ngenerator.c:861: error: for each function it appears in.)\ngenerator.c:863: error: \u2018rb_cBignum\u2019 undeclared (first use in this\nfunction)\nAt top level:\ncc1: warning: unrecognized command line option \"-Wno-self-assign\"\ncc1: warning: unrecognized command line option\n\"-Wno-constant-logical-operand\"\ncc1: warning: unrecognized command line option\n\"-Wno-parentheses-equality\"\ncc1: warning: unrecognized command line option\n\"-Wno-tautological-compare\"\nmake: *** [generator.o] error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in\n/usr/local/lib/ruby/gems/2.4.0/gems/json-1.8.3 for inspection.\nResults logged to\n/usr/local/lib/ruby/gems/2.4.0/extensions/x86_64-linux/2.4.0-static/json-1.8.3/gem_make.out\n\nAn error occurred while installing json (1.8.3), and Bundler\ncannot continue.\nMake sure that `gem install json -v '1.8.3'` succeeds before\nbundling.\n</code></pre>\n\n<p>So, I've tried <code>gem install json -v '1.8.3</code>, but I couldn't solve it.</p>\n\n<p>Would you mind just read this problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 1454, "user_id": 6509507, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/IU0E8.jpg?s=128&g=1", "display_name": "Blackcoat77", "link": "https://stackoverflow.com/users/6509507/blackcoat77"}, "is_accepted": false, "score": 0, "last_activity_date": 1482901165, "creation_date": 1482901165, "answer_id": 41355594, "question_id": 41355155, "link": "https://stackoverflow.com/questions/41355155/rubygems-environment-variables-messed-up/41355594#41355594", "title": "RubyGems environment variables messed up :(", "body": "<p>Nothing is wrong. I can see that you are using <code>rbenv</code>, and that your <code>global ruby version is 2.3.1</code> </p>\n\n<p>If you run in your terminal:</p>\n\n<pre><code>gem env home\n</code></pre>\n\n<p>It will return something like:</p>\n\n<pre><code>/Users/matthewsmith/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0\n</code></pre>\n\n<p>Apparently this line of code above tells that you have global rbenv <code>version 2.3.1</code>, and within <code>li/ruby/gems</code> folder you also have installed ruby <code>version 2.3.0</code></p>\n\n<p>In this folder <code>.rbenv/versions/</code> will be all ruby versions you will about to install, or they are already installed.</p>\n\n<p>When I install different ruby version let's say <code>2.3.0</code> I would do like this:</p>\n\n<pre><code>rbenv install 2.3.0  # install ruby version 2.3.0 using rbenv\nrbenv local 2.3.0    # set ruby 2.3.0 to local project. It writes that version to a .ruby-version in your current directory\nruby -v              # check your version to confirm that is 2.3.0 for a local project\ngem install bundler\nbundle install\n</code></pre>\n\n<p>Other options for installing ruby version are: <code>SHELL</code> and <code>GLOBAL</code></p>\n\n<pre><code>rbenv shell 2.3.0    # Will temporarily change your Ruby version on your current shell. This sets the RBENV_VERSION environment variable in your terminal session.\n\nrbenv global 2.3.1   # This will also change your Ruby version, but only the one you are using whenever no other version is specified, e.g. via a .ruby-version file or RBENV_VERSION variable.\n</code></pre>\n\n<p><strong>NOTE!</strong> <strong><em>You don't need sudo to install gems.</em></strong> Typically, the Ruby versions will be installed and writeable by your user. No extra privileges are required to install gems.</p>\n\n<p><a href=\"https://github.com/rbenv/rbenv#how-it-works\" rel=\"nofollow noreferrer\">reference</a></p>\n\n<p>I hope it helps</p>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 4152275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5cb3b4c5a463fb088738d8828e1ae2?s=128&d=identicon&r=PG&f=1", "display_name": "Ancy Abraham", "link": "https://stackoverflow.com/users/4152275/ancy-abraham"}, "is_accepted": true, "score": 3, "last_activity_date": 1482917517, "creation_date": 1482917517, "answer_id": 41359134, "question_id": 41355155, "link": "https://stackoverflow.com/questions/41355155/rubygems-environment-variables-messed-up/41359134#41359134", "title": "RubyGems environment variables messed up :(", "body": "<p>if there are multiple versions installed, project dependent version must be set as default. </p>\n\n<p>To handle multiple projects with different dependencies, gemset can be used. RVM support gemset. Alternatives are available for rbenv also.</p>\n"}], "owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 41359134, "answer_count": 2, "score": 0, "last_activity_date": 1482917517, "creation_date": 1482897642, "question_id": 41355155, "link": "https://stackoverflow.com/questions/41355155/rubygems-environment-variables-messed-up", "title": "RubyGems environment variables messed up :(", "body": "<p>Please see below the print out from <code>gem env</code>. It appears as the INSTALLATION DIRECTORY, USER INSTALLATION DIRECTORY and GEM PATHS are screwed up. I attempted to install ruby version 2.3.0 for another project and switch over to that. I uninstalled ruby version 2.3.0 and switch back to ruby version 2.3.1. I noticed these RubyGems environment variables got screwed up some how :( Everywhere you see '2.3.0', I think it's wrong.</p>\n\n<pre><code>RubyGems Environment:\n  - RUBYGEMS VERSION: 2.5.1\n  - RUBY VERSION: 2.3.1 (2016-04-26 patchlevel 112) [x86_64-darwin15]\n  - INSTALLATION DIRECTORY: /Users/matthewsmith/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0\n  - USER INSTALLATION DIRECTORY: /Users/matthewsmith/.gem/ruby/2.3.0\n  - RUBY EXECUTABLE: /Users/matthewsmith/.rbenv/versions/2.3.1/bin/ruby\n  - EXECUTABLE DIRECTORY: /Users/matthewsmith/.rbenv/versions/2.3.1/bin\n  - SPEC CACHE DIRECTORY: /Users/matthewsmith/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /Users/matthewsmith/.rbenv/versions/2.3.1/etc\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-15\n  - GEM PATHS:\n     - /Users/matthewsmith/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0\n     - /Users/matthewsmith/.gem/ruby/2.3.0\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /Users/matthewsmith/.rbenv/versions/2.3.1/bin\n     - /Users/matthewsmith/.rbenv/libexec\n     - /Users/matthewsmith/.rbenv/plugins/ruby-build/bin\n     - /Users/matthewsmith/.nvm/versions/node/v4.5.0/bin\n     - /Users/matthewsmith/.rbenv/shims\n     - /Users/matthewsmith/.rbenv/bin\n     - /usr/local/bin\n     - /usr/bin\n     - /bin\n     - /usr/sbin\n     - /sbin\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1454, "user_id": 6509507, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/IU0E8.jpg?s=128&g=1", "display_name": "Blackcoat77", "link": "https://stackoverflow.com/users/6509507/blackcoat77"}, "is_accepted": true, "score": 1, "last_activity_date": 1482898132, "creation_date": 1482898132, "answer_id": 41355204, "question_id": 41355093, "link": "https://stackoverflow.com/questions/41355093/dblocalsync-doesnt-work-after-updating-ruby-2-2-2-to-2-3-3/41355204#41355204", "title": "&quot;db:local:sync&quot; doesn&#39;t work after updating ruby 2.2.2 to 2.3.3", "body": "<p>Check your <code>app/bin</code> folder. If you open <code>bundle</code> file from <code>bin</code> folder, and the first line is <code>#!/usr/bin/env ruby.exe</code>, try replacing it with:</p>\n\n<pre><code>#!/usr/bin/env ruby\n</code></pre>\n\n<p>If that doesn't work check <code>rails</code> file from the same folder, and do the same like mentioned above.</p>\n"}], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 41355204, "answer_count": 1, "score": 0, "last_activity_date": 1482898132, "creation_date": 1482897086, "question_id": 41355093, "link": "https://stackoverflow.com/questions/41355093/dblocalsync-doesnt-work-after-updating-ruby-2-2-2-to-2-3-3", "title": "&quot;db:local:sync&quot; doesn&#39;t work after updating ruby 2.2.2 to 2.3.3", "body": "<p>I updated ruby version of my rails project from <code>2.2.2</code> to <code>2.3.3</code>, and the project itself works fine.</p>\n\n<p>But when I tried to pull the database from remote by using <code>capistrano-db-tasks</code>, it ends up with a error <code>env: ruby.exe: No such file or directory</code> like this:</p>\n\n<pre><code>$ bundle exec cap production db:local:sync\nLoading local database config\nenv: ruby.exe: No such file or directory\n</code></pre>\n\n<p>This is my environmentail info:</p>\n\n<pre><code>% cat .ruby-version\n2.3.3\n% ruby -v\nruby 2.3.3p222 (2016-11-21 revision 56859) [x86_64-darwin16]\n</code></pre>\n\n<p>Where should I set the ruby path for the task?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "hash"], "answers": [{"comments": [{"owner": {"reputation": 210, "user_id": 3456978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/717526bc961e5fee52fab86322b52568?s=128&d=identicon&r=PG&f=1", "display_name": "user3456978", "link": "https://stackoverflow.com/users/3456978/user3456978"}, "edited": false, "score": 1, "creation_date": 1482898484, "post_id": 41355072, "comment_id": 69912262, "body": "This doesn&#39;t quite work. department_id is null, while follower_id works accordingly. If I switch their positions, so follower_id is first, then follower_id is null and department_id is what it should be. It reads like it should work, I&#39;m attempting to troubleshoot it on my end more."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 210, "user_id": 3456978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/717526bc961e5fee52fab86322b52568?s=128&d=identicon&r=PG&f=1", "display_name": "user3456978", "link": "https://stackoverflow.com/users/3456978/user3456978"}, "edited": false, "score": 1, "creation_date": 1482899099, "post_id": 41355072, "comment_id": 69912406, "body": "@user3456978 delete commas where they are not needed (see the edit) :)"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 2, "last_activity_date": 1482899086, "last_edit_date": 1482899086, "creation_date": 1482896803, "answer_id": 41355072, "question_id": 41355062, "link": "https://stackoverflow.com/questions/41355062/iterate-over-an-array-of-hashes-to-create-data-in-rails/41355072#41355072", "title": "iterate over an array of hashes to create data in rails", "body": "<p><code>shoe_array</code> is an array of hashes, so you should iterate over each hash, and access each key-value pair:</p>\n\n<pre><code>shoe_array.each do |hash|\n  department_id = hash[:department_id]\n  follower_id   = hash[:follower_id]\n  user_id       = 1\n\n  Relationship.create!(\n    department_id: department_id,\n    follower_id:   follower_id,\n    user_id:       user_id\n  )\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 210, "user_id": 3456978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/717526bc961e5fee52fab86322b52568?s=128&d=identicon&r=PG&f=1", "display_name": "user3456978", "link": "https://stackoverflow.com/users/3456978/user3456978"}, "edited": false, "score": 0, "creation_date": 1482899872, "post_id": 41355112, "comment_id": 69912546, "body": "Creating an array of arrays is also a valid solution. So in shoe_array.map we are going invoking each hash from the array once and in &amp;:values we are extracting the hash values of department_id and follower_id into an array. So we now have an array of the values from the hash. We can then iterate over the array of arrays with our two values. Thanks for sharing!"}, {"owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "reply_to_user": {"reputation": 210, "user_id": 3456978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/717526bc961e5fee52fab86322b52568?s=128&d=identicon&r=PG&f=1", "display_name": "user3456978", "link": "https://stackoverflow.com/users/3456978/user3456978"}, "edited": false, "score": 1, "creation_date": 1482906073, "post_id": 41355112, "comment_id": 69914498, "body": "added an update. just got a notification that I got downvoted for whatever reason."}, {"owner": {"reputation": 210, "user_id": 3456978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/717526bc961e5fee52fab86322b52568?s=128&d=identicon&r=PG&f=1", "display_name": "user3456978", "link": "https://stackoverflow.com/users/3456978/user3456978"}, "edited": false, "score": 0, "creation_date": 1482906809, "post_id": 41355112, "comment_id": 69914811, "body": "Who knows why. The updated version looks like the best solution. It&#39;s concise, clear and takes advantage of our previous nomenclature."}], "tags": [], "owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "is_accepted": false, "score": 1, "last_activity_date": 1482905952, "last_edit_date": 1482905952, "creation_date": 1482897294, "answer_id": 41355112, "question_id": 41355062, "link": "https://stackoverflow.com/questions/41355062/iterate-over-an-array-of-hashes-to-create-data-in-rails/41355112#41355112", "title": "iterate over an array of hashes to create data in rails", "body": "<p>Change your iteration to</p>\n\n<pre><code>shoe_array.each do |shoe|\n  department_id = shoe[:department_id]\n  follower_id = shoe[:follower_id]\n</code></pre>\n\n<p>An example that can use <code>|n, k|</code> would be either a hash or an array of arrays.  If you want to go down that route, you can call <code>values</code> on each hash in the array (assuming that the hash is consistent, meaning <code>department_id</code> always comes first before <code>follower_id</code>)</p>\n\n<pre><code>ids = shoe_array.map(&amp;:values) # [[8, 31], [9, 41], [4, 49], [2, 58], [5, 36], [9, 63], [2, 52], [23, 26], [5, 52], [6, 30]]\n</code></pre>\n\n<p>Then you can just use your old code or refactor to</p>\n\n<pre><code>ids.each do |department_id, follower_id|\n  Relationship.create!(\n    department_id: department_id,\n    follower_id: follower_id,\n    user_id: 1\n  )\nend\n</code></pre>\n\n<p>Take note though that you are iterating over the array twice and will be less efficient compared to the first one.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Another option is use the array elements as is.</p>\n\n<pre><code>shoe_array.each do |attributes|\n  relationship = Relationship.new(attributes)\n  relationship.user_id = 1\n  relationship.save!\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 210, "user_id": 3456978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/717526bc961e5fee52fab86322b52568?s=128&d=identicon&r=PG&f=1", "display_name": "user3456978", "link": "https://stackoverflow.com/users/3456978/user3456978"}, "edited": false, "score": 0, "creation_date": 1482910067, "post_id": 41356608, "comment_id": 69916138, "body": "Very cool. I wasn&#39;t aware we could directly .create with a hash or array of hashes, although another answer does the same with .new. We might also consider shortening it slightly with  Relationship.create!(shoe_array.map(&amp;:merge!({user_id: 1}))"}], "tags": [], "owner": {"reputation": 43225, "user_id": 297087, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/17b3a5816f0647e9b0f7c49d60f93e7b?s=128&d=identicon&r=PG", "display_name": "Salil", "link": "https://stackoverflow.com/users/297087/salil"}, "is_accepted": false, "score": 2, "last_activity_date": 1482907483, "last_edit_date": 1482907483, "creation_date": 1482906922, "answer_id": 41356608, "question_id": 41355062, "link": "https://stackoverflow.com/questions/41355062/iterate-over-an-array-of-hashes-to-create-data-in-rails/41356608#41356608", "title": "iterate over an array of hashes to create data in rails", "body": "<p>According the documentation you can <a href=\"http://apidock.com/rails/ActiveRecord/Base/create/class\" rel=\"nofollow noreferrer\">create</a> records from an array of hashes:</p>\n\n<p>Following should work (You can use <code>create!</code> as well as <code>create</code>)</p>\n\n<pre><code>shoe_array = [{:department_id=&gt;8, :follower_id=&gt;31}, {:department_id=&gt;9, :follower_id=&gt;41}, {:department_id=&gt;4, :follower_id=&gt;49}, {:department_id=&gt;2, :follower_id=&gt;58}, {:department_id=&gt;5, :follower_id=&gt;36}, {:department_id=&gt;9, :follower_id=&gt;63}, {:department_id=&gt;2, :follower_id=&gt;52}, {:department_id=&gt;23, :follower_id=&gt;26}, {:department_id=&gt;5, :follower_id=&gt;52}, {:department_id=&gt;6, :follower_id=&gt;30}]\n\nRelationship.create!(shoe_array.map{|arr| arr.merge!({user_id: 1})})\n</code></pre>\n"}], "owner": {"reputation": 210, "user_id": 3456978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/717526bc961e5fee52fab86322b52568?s=128&d=identicon&r=PG&f=1", "display_name": "user3456978", "link": "https://stackoverflow.com/users/3456978/user3456978"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 1, "accepted_answer_id": 41355072, "answer_count": 3, "score": 0, "last_activity_date": 1482907483, "creation_date": 1482896676, "last_edit_date": 1495539961, "question_id": 41355062, "link": "https://stackoverflow.com/questions/41355062/iterate-over-an-array-of-hashes-to-create-data-in-rails", "title": "iterate over an array of hashes to create data in rails", "body": "<p>I have an array of hashes that I am trying to seed into a database.</p>\n\n<pre><code>shoe_array = [{:department_id=&gt;8, :follower_id=&gt;31}, {:department_id=&gt;9, :follower_id=&gt;41}, {:department_id=&gt;4, :follower_id=&gt;49}, {:department_id=&gt;2, :follower_id=&gt;58}, {:department_id=&gt;5, :follower_id=&gt;36}, {:department_id=&gt;9, :follower_id=&gt;63}, {:department_id=&gt;2, :follower_id=&gt;52}, {:department_id=&gt;23, :follower_id=&gt;26}, {:department_id=&gt;5, :follower_id=&gt;52}, {:department_id=&gt;6, :follower_id=&gt;30}]\n\n\nshoe_array.each do |n, k|\n  department_id = n,\n  follower_id = k,\n  user_id = 1\n\n  Relationship.create!(department_id: department_id,\n                       follower_id: follower_id,\n                       user_id: user_id)\nend\n</code></pre>\n\n<p>I'm only getting null values for both <code>department_id</code> and <code>follower_id</code>. <code>user_id</code> is working.</p>\n\n<p>I have tried using <code>\"#{n}\"</code> and <code>\"#{k}\"</code>, to get the key values set to department and follower ids. I've also tried iterating over the array only using <code>.each do |a|</code> and setting <code>department_id: a['department_id'], follower_id a['follower_id']</code></p>\n\n<p>as seen here: <a href=\"https://stackoverflow.com/questions/26724347/iterate-through-array-of-hashes-in-ruby\">iterate through array of hashes in ruby</a> and here :<a href=\"https://stackoverflow.com/questions/23718284/how-do-i-iterate-over-an-array-of-hashes-and-return-the-values-in-a-single-strin\">How do I iterate over an array of hashes and return the values in a single string?</a></p>\n\n<p>but I'm only still getting null values. How can I get my values into the database?</p>\n"}, {"tags": ["ruby", "for-loop"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1482918614, "post_id": 41354911, "comment_id": 69920234, "body": "The infamous &quot;goto fail&quot; feature."}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1482946235, "post_id": 41354911, "comment_id": 69935272, "body": "@Stefan I think heartbleed had a similar issue with missing curly braces. The last company I worked for required them to be there. I like the shortness of excluding them though, and I do TDD so I&#39;m very unlikely to get caught by an unexpected bug like that."}], "answers": [{"comments": [{"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1482895262, "post_id": 41354931, "comment_id": 69911662, "body": "This is quite nice, although I find it a little unusual to read. Will it appear more natural the more I use it?"}, {"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "reply_to_user": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 3, "creation_date": 1482895283, "post_id": 41354931, "comment_id": 69911664, "body": "@BrandonIbbotson Yes it will. The <code>for</code> loop really never needs to be used in ruby."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 2, "creation_date": 1482895290, "post_id": 41354931, "comment_id": 69911666, "body": "@BrandonIbbotson absolutely. This is the conventional way to iterate over a collection in Ruby"}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1482895344, "post_id": 41354931, "comment_id": 69911674, "body": "Perfect &amp; thank you! I&#39;ll mark your answer as accepted after 10 minutes (assuming nobody else comes along and writes a better answer) ;)"}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1482896904, "post_id": 41354931, "comment_id": 69911957, "body": "After 10 minutes of using this, it actually looks extremely nice."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 1, "creation_date": 1482896997, "post_id": 41354931, "comment_id": 69911971, "body": "@BrandonIbbotson yep :) Also, use <code>{}</code> for one liner, if you need to do something more complex inside the block, use <code>do</code> <code>end</code> block, inside of which you can use new line to do new operation while being in the same iteration"}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1482897079, "post_id": 41354931, "comment_id": 69911983, "body": "Thanks for a tip. I was aware there was a slight difference between the two kinds of blocks."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1482937022, "post_id": 41354931, "comment_id": 69930361, "body": "@AndreyDeineko: the <b>real</b> idiomatic way to run a counter would be <code>10.times do</code>. Or <code>1.upto(10) do</code>. No need to involve a range here :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1482937089, "post_id": 41354931, "comment_id": 69930405, "body": "@AndreyDeineko: you can do multiline blocks with <code>{}</code>, no problem. In some cases, it&#39;s even preferred! There is a difference between <code>{}</code> and <code>do end</code>, but it&#39;s not that. :)"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1482939901, "post_id": 41354931, "comment_id": 69931996, "body": "@SergioTulentsev yea, both points are as usual very good - thanks!"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 8, "last_activity_date": 1482897099, "last_edit_date": 1482897099, "creation_date": 1482895143, "answer_id": 41354931, "question_id": 41354911, "link": "https://stackoverflow.com/questions/41354911/is-it-possible-to-write-a-single-statement-for-loop-in-two-lines-with-ruby/41354931#41354931", "title": "Is it possible to write a single-statement for loop in two lines with Ruby?", "body": "<p>Sure, you're looking for <code>each</code>, <a href=\"https://ruby-doc.org/core-2.3.3/Range.html#method-i-each\" rel=\"nofollow noreferrer\">Range#<code>each</code></a> in this particular case:</p>\n\n<pre><code>(1..10).each { |number| puts number }\n</code></pre>\n\n<p>For more complex iterations use <code>do</code> - <code>end</code> block syntax. For example</p>\n\n<pre><code>(1..10).each do |number|\n  puts number\n  some_method_call(number)\n  Rails.logger.info(\"The #{number} is used\")\n  something_else\nend\n</code></pre>\n\n<p>To find more check out <a href=\"https://ruby-doc.org\" rel=\"nofollow noreferrer\">Ruby documentation</a>, in particular, see <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html\" rel=\"nofollow noreferrer\">Enumerable</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": false, "score": 2, "last_activity_date": 1482907883, "last_edit_date": 1495539929, "creation_date": 1482907883, "answer_id": 41356807, "question_id": 41354911, "link": "https://stackoverflow.com/questions/41354911/is-it-possible-to-write-a-single-statement-for-loop-in-two-lines-with-ruby/41356807#41356807", "title": "Is it possible to write a single-statement for loop in two lines with Ruby?", "body": "<p>There is an even shorter syntax. </p>\n\n<p>If you are just calling one method on each object you can use <code>&amp;</code> syntax.</p>\n\n<pre><code>(1..3).collect(&amp;:odd?) # =&gt; [true, false, true]\n</code></pre>\n\n<p>This is the same as</p>\n\n<pre><code>(1..3).collect { |each| each.odd? } # =&gt; [true, false, true]\n</code></pre>\n\n<p>This is the preferred way of writing loops in Ruby. </p>\n\n<p>You'll quickly get used to both <code>&amp;</code> and <code>{}</code> block syntax and the enumeration methods defined in <code>Enumerable</code> module. Some useful methods are</p>\n\n<ul>\n<li><code>each</code> which evaluates the block for each element</li>\n<li><code>collect</code> which create new array with the result from each block </li>\n<li><code>detect</code> which returns the first element for which block results true</li>\n<li><code>select</code> which create new array with elements for which block results true</li>\n<li><code>inject</code> which applies \"folding\" operation, eg <code>sum = (1..10).inject { |a, b| a + b }</code></li>\n</ul>\n\n<p>Fun fact, style guides for production code usually ban <code>for</code> loops at all because of a subtle but dangerous scoping issue. See more here, <a href=\"https://stackoverflow.com/a/41308451/24468\">https://stackoverflow.com/a/41308451/24468</a></p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 3, "last_activity_date": 1482936291, "creation_date": 1482936291, "answer_id": 41364323, "question_id": 41354911, "link": "https://stackoverflow.com/questions/41354911/is-it-possible-to-write-a-single-statement-for-loop-in-two-lines-with-ruby/41364323#41364323", "title": "Is it possible to write a single-statement for loop in two lines with Ruby?", "body": "<p>There is a vanishingly tiny number of cases, where any self-respecting Ruby programmer would even write an explicit loop <em>at all</em>. The number of cases where that loop is a <code>for</code> loop is exactly zero. There is no \"more idiomatic\" way to write a <code>for</code> loop, because <code>for</code> loops are non-idiomatic, period.</p>\n"}], "owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1239, "favorite_count": 0, "accepted_answer_id": 41354931, "answer_count": 3, "score": 3, "last_activity_date": 1482936291, "creation_date": 1482895041, "question_id": 41354911, "link": "https://stackoverflow.com/questions/41354911/is-it-possible-to-write-a-single-statement-for-loop-in-two-lines-with-ruby", "title": "Is it possible to write a single-statement for loop in two lines with Ruby?", "body": "<p>Often when programming in Ruby, I find myself writing small <strong>for loops</strong> with a single statement in the body. For example...</p>\n\n<pre><code>for number in 1..10\n  puts number\nend\n</code></pre>\n\n<p>In other languages like <code>C</code>, <code>Java</code> or <code>Kotlin</code> (for example), I'd be able to write the same code in two lines. For example...</p>\n\n<pre><code>// Kotlin\nfor (number in 1..10)\n    println(number)\n</code></pre>\n\n<p>In the above example, the ending of the loop body is inferred due to the lack of curly braces.</p>\n\n<p><strong>Does Ruby have a way to imitate this \"single-statement\" style of \"for loop\"?</strong></p>\n\n<p>Here are some of [my options/your potential replies], along with my thoughts on them.</p>\n\n<ul>\n<li><blockquote>\n  <p>You could append <code>; end</code> to the body to end it on the same line.</p>\n</blockquote>\n\n<p>This is true, and pretty sufficient, but I'd like to know if there's a more <em>idiomatic</em> approach.</p></li>\n<li><blockquote>\n  <p>This seems unnecessarily picky. Why would you ever want to do this?</p>\n</blockquote>\n\n<p>You may think I'm being too picky. You may also think what I'm trying to do is un-idiomatic (if that's even a word). I totally understand, but I'd still love to know if it's do-able!</p>\n\n<p>Doing this could let us write code that's <em>even just a tiny</em> bit nicer to read. And for programmers, <strong>readability <em>matters</em></strong>.</p></li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "http"], "comments": [{"owner": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "edited": false, "score": 1, "creation_date": 1482893649, "post_id": 41354728, "comment_id": 69911344, "body": "do you mean on a page rendered from one of you controllers you would like to automatically open up 3 new windows or tabs, each containing the links to pdf?   You will need to use Javascript to do so, and you might run into issues with the browser stopping / complaining about the page trying to open multiple windows."}, {"owner": {"reputation": 95, "user_id": 5595821, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/10153389990789164/picture?type=large", "display_name": "Ayaz Uddin", "link": "https://stackoverflow.com/users/5595821/ayaz-uddin"}, "reply_to_user": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "edited": false, "score": 0, "creation_date": 1482893924, "post_id": 41354728, "comment_id": 69911392, "body": "this link for example: <a href=\"http://localhost:3000/pdf/1.pdf\" rel=\"nofollow noreferrer\">localhost:3000/pdf/1.pdf</a> would render a view. i just need to open a bunch of these links at the same time."}], "answers": [{"tags": [], "owner": {"reputation": 863, "user_id": 1461018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c8c2888d9ace73d7a9769e82d6e69b?s=128&d=identicon&r=PG", "display_name": "Hossam Khamis", "link": "https://stackoverflow.com/users/1461018/hossam-khamis"}, "is_accepted": true, "score": 1, "last_activity_date": 1482893988, "creation_date": 1482893988, "answer_id": 41354801, "question_id": 41354728, "link": "https://stackoverflow.com/questions/41354728/open-a-url-link-in-a-new-tab-from-a-rails-controller/41354801#41354801", "title": "open a url link in a new tab from a Rails controller", "body": "<p>you should respond with a <code>javascript</code> file.</p>\n\n<pre><code>&lt;% id_array.each do |id| %&gt;\n   window.open('&lt;%= \"http://localhost:3000/pdf/#{id}.pdf\" %&gt;', '_blank');\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 4152275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5cb3b4c5a463fb088738d8828e1ae2?s=128&d=identicon&r=PG&f=1", "display_name": "Ancy Abraham", "link": "https://stackoverflow.com/users/4152275/ancy-abraham"}, "is_accepted": false, "score": 5, "last_activity_date": 1482918366, "creation_date": 1482918366, "answer_id": 41359366, "question_id": 41354728, "link": "https://stackoverflow.com/questions/41354728/open-a-url-link-in-a-new-tab-from-a-rails-controller/41359366#41359366", "title": "open a url link in a new tab from a Rails controller", "body": "<p>Can open files in new browser window using send_file method. Use :disposition => 'inline'</p>\n\n<p>Eg: send_file \"#{Rails.root}/pdf/id.pdf\",:filename => 'id.pdf', :type => 'application/pdf', :disposition => 'inline'</p>\n"}], "owner": {"reputation": 95, "user_id": 5595821, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/10153389990789164/picture?type=large", "display_name": "Ayaz Uddin", "link": "https://stackoverflow.com/users/5595821/ayaz-uddin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2616, "favorite_count": 0, "accepted_answer_id": 41354801, "answer_count": 2, "score": 2, "last_activity_date": 1482918366, "creation_date": 1482893470, "question_id": 41354728, "link": "https://stackoverflow.com/questions/41354728/open-a-url-link-in-a-new-tab-from-a-rails-controller", "title": "open a url link in a new tab from a Rails controller", "body": "<p>I've been trying to open multiple pdf's in new tabs automatically from my rails controller, but nothing has worked so far so I'm back to square one. If anyone could help, it would be much appreciated! Below is an example of what I'm trying to do. </p>\n\n<pre><code>id_array = [1,2,3]\n\nid_array.each do |id|\n  // I want to open each of these three links in a new browser tab\n  http://localhost:3000/pdf/id.pdf\nend\n</code></pre>\n\n<p>Cheers!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1482889919, "post_id": 41354277, "comment_id": 69910589, "body": "Not that long at all. You should see some of my Rspecs!"}, {"owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "edited": false, "score": 0, "creation_date": 1482889974, "post_id": 41354277, "comment_id": 69910602, "body": "there&#39;s a lot of <code>undertaking=Undertaking.find(params[:undertaking_id])</code>. you can probably change that to another <code>before_action</code> call.  You may also want to consider eager loading stuff but from a quick read of your code, you&#39;re only working on 1 record of undertaking/asking on each action so eager loading will have a small effect."}, {"owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "edited": false, "score": 1, "creation_date": 1482890092, "post_id": 41354277, "comment_id": 69910631, "body": "oh and rspec tests are usually longer than the files they&#39;re testing because of stubs/mocks and expectations so don&#39;t sweat it."}, {"owner": {"reputation": 131, "user_id": 7068409, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b6d842dc40dba7077f68f7aeadab2c32?s=128&d=identicon&r=PG&f=1", "display_name": "HAYATO SHIBA", "link": "https://stackoverflow.com/users/7068409/hayato-shiba"}, "edited": false, "score": 0, "creation_date": 1482890810, "post_id": 41354277, "comment_id": 69910761, "body": "Oh ,thank you for your comment! I feel relieved! and I see! I fix undertaking=Undertaking.find(params[:undertaking_id]) ! Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 7068409, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b6d842dc40dba7077f68f7aeadab2c32?s=128&d=identicon&r=PG&f=1", "display_name": "HAYATO SHIBA", "link": "https://stackoverflow.com/users/7068409/hayato-shiba"}, "edited": false, "score": 0, "creation_date": 1482890718, "post_id": 41354311, "comment_id": 69910744, "body": "Oh , that&#39;s very long!! Thank you , I feel relieved!"}, {"owner": {"reputation": 715, "user_id": 6341982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10206246890437893/picture?type=large", "display_name": "Luiz Henrique", "link": "https://stackoverflow.com/users/6341982/luiz-henrique"}, "edited": false, "score": 0, "creation_date": 1484197122, "post_id": 41354311, "comment_id": 70412909, "body": "Good to know about size of controller tests"}, {"owner": {"reputation": 609, "user_id": 3891844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf945cc749dae8c0d8e397df058acdde?s=128&d=identicon&r=PG", "display_name": "Nondv", "link": "https://stackoverflow.com/users/3891844/nondv"}, "edited": false, "score": 0, "creation_date": 1538823602, "post_id": 41354311, "comment_id": 92285554, "body": "do you still have 8500 lines in your controller?"}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 4, "last_activity_date": 1482890145, "last_edit_date": 1482890145, "creation_date": 1482889583, "answer_id": 41354311, "question_id": 41354277, "link": "https://stackoverflow.com/questions/41354277/is-rspec-controller-test-usually-too-long/41354311#41354311", "title": "Is Rspec controller test usually too long?", "body": "<p>I would not worry about long controller and spec files in Rails.</p>\n\n<p>These files tend to get very long and the usual advice of keeping classes and methods short does not necessarily apply for controllers and their specs.</p>\n\n<p>For example, in our production system <code>user_controller.rb</code> is 8500 lines long and the corresponding <code>user_controller_spec.rb</code> is 7000 lines long.</p>\n\n<p>This is the length of our top 10 controllers</p>\n\n<pre><code>1285 app/controllers/*********_controller.rb\n1430 app/controllers/***********_controller.rb\n1444 app/controllers/****_controller.rb\n1950 app/controllers/****_controller.rb\n1994 app/controllers/********_controller.rb\n2530 app/controllers/***********_controller.rb\n2697 app/controllers/*********_controller.rb\n2998 app/controllers/*****_controller.rb\n3134 app/controllers/application_controller.rb\n8737 app/controllers/users_controller.rb\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 7068409, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b6d842dc40dba7077f68f7aeadab2c32?s=128&d=identicon&r=PG&f=1", "display_name": "HAYATO SHIBA", "link": "https://stackoverflow.com/users/7068409/hayato-shiba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 41354311, "answer_count": 1, "score": 2, "last_activity_date": 1482890145, "creation_date": 1482889235, "question_id": 41354277, "link": "https://stackoverflow.com/questions/41354277/is-rspec-controller-test-usually-too-long", "title": "Is Rspec controller test usually too long?", "body": "<p>My spec/controllers/decidings_controller_spec.rb is below.</p>\n\n<pre><code>RSpec.describe DecidingsController, type: :controller do\n describe '#create' do\n     before do\n       @deciding=build(:deciding_consenting_false)\n     end\n     context 'correct_user login' do\n         before do \n             login_user(@deciding.asking.user)\n         end\n         it 'creates with deciding +1' do\n           expect{post :create , undertaking_id: @deciding.undertaking_id , asking_id: @deciding.asking_id}.to change(Deciding , :count).by(1)\n         end\n         it 'redirects to undertking' do\n             post :create , undertaking_id: @deciding.undertaking_id , asking_id: @deciding.asking_id\n             expect(response).to redirect_to @deciding.undertaking\n         end\n     end\n     context 'incorrect_user login' do\n         before do \n             @user=create(:user)\n             login_user(@user)\n         end\n         it 'creates with deciding 0' do\n           expect{post :create , undertaking_id: @deciding.undertaking_id , asking_id: @deciding.asking_id}.to change(Deciding , :count).by(0)\n         end\n         it 'redirects to undertking' do\n             post :create , undertaking_id: @deciding.undertaking_id , asking_id: @deciding.asking_id\n             expect(response).to redirect_to root_path\n         end\n     end\nend\ndescribe '#destroy' do\n    context 'before deciding consent' do\n        before do\n            @deciding=create(:deciding_consenting_false)\n        end\n        context 'correct_user login' do\n            before do\n               login_user(@deciding.asking.user)\n            end\n            it 'destroy with deciding -1' do\n                expect{delete :destroy , undertaking_id: @deciding , asking_id: @deciding}.to change(Deciding , :count).by(-1)\n            end\n            it 'redirects undertaking show' do\n                delete :destroy , undertaking_id: @deciding.undertaking_id , asking_id: @deciding.asking_id\n                expect(response).to redirect_to @deciding.undertaking\n            end\n        end\n        context 'incorrect_user login' do\n            before do\n                user=create(:user)\n                login_user(user)\n            end\n            it 'destroy with deciding -1' do\n                expect{delete :destroy , undertaking_id: @deciding , asking_id: @deciding}.to change(Deciding , :count).by(0)\n            end\n            it 'redirects undertaking show' do\n                delete :destroy , undertaking_id: @deciding.undertaking_id , asking_id: @deciding.asking_id\n                expect(response).to redirect_to root_path\n            end\n        end\n    end\n    context ' if after deciding consent( should #before_consent)' do\n        before do\n            @deciding=create(:deciding_consenting_true)\n        end\n        context 'correct_user login' do\n            before do\n               login_user(@deciding.asking.user)\n            end\n            it 'destroy with deciding 0' do\n                expect{delete :destroy , undertaking_id: @deciding , asking_id: @deciding}.to change(Deciding , :count).by(0)\n            end\n            it 'redirects undertaking show' do\n                delete :destroy , undertaking_id: @deciding.undertaking_id , asking_id: @deciding.asking_id\n                expect(response).to redirect_to root_path\n            end\n        end\n    end\n end\n describe '#consent' do\n    context 'correct_user login' do\n        before do\n            @deciding=create(:deciding_consenting_false)\n            login_user(@deciding.undertaking.user)\n        end\n        it 'consenting changes true' do\n            patch :consent , undertaking_id: @deciding.undertaking_id\n            @deciding.reload\n            expect(@deciding.consenting).to eq true\n        end\n        it 'redirect_to undertaking' do\n            patch :consent , undertaking_id: @deciding.undertaking_id\n            expect(response).to redirect_to @deciding.undertaking\n        end  \n    end\n    context 'asking user login' do\n        before do\n            @deciding=create(:deciding_consenting_false)\n            login_user(@deciding.asking.user)\n        end\n        it 'consenting not changes true' do\n            patch :consent , undertaking_id: @deciding.undertaking_id\n            @deciding.reload\n            expect(@deciding.consenting).to eq false               \n        end\n        it 'redirect_to root' do\n            patch :consent , undertaking_id: @deciding.undertaking_id\n            expect(response).to redirect_to root_path\n        end\n    end\n    context 'incorrect_user login' do\n        before do\n            @deciding=create(:deciding_consenting_false)\n            @user=create(:user)\n            login_user(@user)\n        end\n        it 'consenting not changes true' do\n            patch :consent , undertaking_id: @deciding.undertaking_id\n            @deciding.reload\n            expect(@deciding.consenting).to eq false           \n        end\n        it 'redirect_to root' do\n            patch :consent , undertaking_id: @deciding.undertaking_id\n            expect(response).to redirect_to root_path\n        end\n    end\nend\ndescribe '#deciding_cancel' do\n    context 'correct_user login' do\n        context 'asking user login' do\n            context 'should #after_consent' do\n                before do\n                    @deciding=create(:deciding_consenting_true)\n                    login_user(@deciding.asking.user)\n                end\n\n            end\n            context 'should not before consent' do\n                before do\n                    @deciding=create(:deciding_consenting_false)\n                    login_user(@deciding.asking.user)\n                end                   \n            end\n            context 'should #before_finish' do\n                before do\n                    @deciding=create(:deciding_consenting_true)\n                    login_user(@deciding.asking.user)\n                end\n\n            end\n            context 'should not before finish' do\n                before do\n                    @deciding=create(:deciding_after_finish)\n                    login_user(@deciding.asking.user)\n                end                   \n            end\n        end\n        context 'undertaking user login' do\n        end\n    end\n    context 'incorrect_user login' do\n        before do\n            @user=create(:user)\n        end\n    end\nend\n\n\ndescribe '#deciding_cancel' do\n    context 'correct_user login' do\n    end\n    context 'incorrect_user login' do\n    end\nend\ndescribe '#deciding_cancel' do\n    context 'correct_user login' do\n    end\n    context 'incorrect_user login' do\n    end\nend\n</code></pre>\n\n<p>end</p>\n\n<p>My Decidingscontroller has many before_action for conditional branching. so My spec file becomes too long.\nIs there other way in this case? If there is other way to make the program short, please tell me.</p>\n\n<p>Anyway, My controllers/decidings_controller.rb is below. </p>\n\n<pre><code>   class DecidingsController &lt; ApplicationController\n\n#correct_user?\nbefore_action :authenticate_user! \nbefore_action :asking_user!, only: [:create , :destroy , :asking_finish , :finish_cancel ]\nbefore_action :undertaking_user!, only: [:consent , :undertaking_finish]\nbefore_action :asking_or_undertaking_user! , only: [:deciding_cancel,:deciding_cancel_consent , :deciding_cancel_refuse]\nbefore_action :reverse_user! ,only: [:deciding_cancel_consent , :deciding_cancel_refuse]\n\n#\u6d41\u308c\nbefore_action :before_consent , only: [:destroy]\nbefore_action :after_consent , only: [:deciding_cancel ,:deciding_cancel_consent , :deciding_cancel_refuse, :undertaking_finish , :asking_finish , :finish_cancel ]\nbefore_action :before_finish , only: [:deciding_cancel ,:deciding_cancel_consent , :deciding_cancel_refuse]\nbefore_action :after_deciding_cancel , only: [:deciding_cancel_consent , :deciding_cancel_refuse]\nbefore_action :after_undertaking_finish , only: [:asking_finish , :finish_cancel]\n\n\ndef create\n    asking=Asking.find(params[:asking_id])\n    undertaking=Undertaking.find(params[:undertaking_id])\n    deciding=Deciding.new(asking_id: asking.id , undertaking_id: undertaking.id)\n    if deciding.save\n        flash[:success] = \"\u5951\u7d04\u4f5c\u6210\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\"\n        redirect_to undertaking\n    else\n        flash[:alert] = \"\u5951\u7d04\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\"\n        redirect_to undertaking\n    end\nend\ndef destroy\n  asking=Asking.find(params[:asking_id])\n  undertaking=Undertaking.find(params[:undertaking_id])\n  asking.deciding.destroy\n  flash[:info]='\u5951\u7d04\u7533\u3057\u8fbc\u307f\u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u307e\u3057\u305f\u3002'\n  redirect_to undertaking\nend\ndef consent\n    undertaking=Undertaking.find(params[:undertaking_id])\n    if undertaking.deciding\n        undertaking.deciding.update(consenting: true)\n        flash[:success] = \"\u5951\u7d04\u304c\u6210\u7acb\u3057\u307e\u3057\u305f\u3002\"\n        redirect_to undertaking\n    else\n        redirect_to root_path\n    end\nend\ndef deciding_cancel\n    undertaking=Undertaking.find(params[:undertaking_id])\n    undertaking.deciding.update(cancel: true , cancel_userid: current_user.id)\n    flash[:success] = \"\u9014\u4e2d\u7d42\u4e86\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002\"\n    redirect_to undertaking\nend\ndef deciding_cancel_consent\n    undertaking=Undertaking.find(params[:undertaking_id])\n    undertaking.deciding.destroy        \n    flash[:success] = \"\u5951\u7d04\u304c\u9014\u4e2d\u7d42\u4e86\u3055\u308c\u307e\u3057\u305f\u3002\"\n    redirect_to undertaking\nend\ndef deciding_cancel_refuse\n    undertaking=Undertaking.find(params[:undertaking_id])\n    undertaking.deciding.update(cansel: false , cansel_userid: nil)       \n    flash[:success] = \"\u5951\u7d04\u306e\u9014\u4e2d\u7d42\u4e86\u3092\u5374\u4e0b\u3057\u307e\u3057\u305f\u3002\"\n    redirect_to undertaking\nend\ndef undertaking_finish\n    undertaking=Undertaking.find(params[:undertaking_id])\n    undertaking.deciding.update(finish_undertaking: true)\n    flash[:success] = \"\u7d0d\u54c1\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\"\n    redirect_to undertaking\nend\ndef finish_cancel\n    undertaking=Undertaking.find(params[:undertaking_id])\n    undertaking.deciding.update(finish_undertaking: false)\n    flash[:success] = \"\u518d\u7d0d\u54c1\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002\"\n    redirect_to undertaking\nend\ndef asking_finish\n    undertaking=Undertaking.find(params[:undertaking_id])\n    undertaking.deciding.update(finish_asking: true)\n    flash[:success] = \"\u7d0d\u54c1\u304c\u6210\u7acb\u3057\u307e\u3057\u305f\u3002\"\n    redirect_to asking\nend\n\n\nprivate\n\ndef asking_user!\n    asking=Asking.find(params[:asking_id])\n    unless asking.user==current_user\n        redirect_to root_path\n    end\nend\ndef undertaking_user!\n    undertaking=Undertaking.find(params[:undertaking_id])\n    unless undertaking.user==current_user\n        redirect_to root_path\n    end\nend     \ndef asking_or_undertaking_user!\n    undertaking=Undertaking.find(params[:undertaking_id])\n    unless current_user==undertaking.user || current_user==undertaking.asking.user\n      refirect_to root_path\n    end\nend\ndef reverse_user!\n     undertaking=Undertaking.find(params[:undertaking_id])\n     if current_user.id == undertaking.deciding.cansel_userid\n         refirect_to root_path\n     end\nend\n\ndef before_consent\n    undertaking=Undertaking.find(params[:undertaking_id])\n    if undertaking.deciding.consenting\n        redirect_to root_path\n    end\nend\n\n\ndef after_consent\n    asking=Asking.find(params[:asking_id])\n    unless asking.deciding.consenting\n        redirect_to root_path\n    end\nend\n\ndef before_finish\n    undertaking=Undertaking.find(params[:undertaking_id])\n    if undertaking.deciding.finish_undertaking\n        redirect_to root_path\n    end\nend\n\ndef after_deciding_cancel\n    undertaking=Undertaking.find(params[:undertaking_id])\n    unless undertaking.deciding.cancel\n        redirect_to root_path\n    end\nend\n\ndef after_undertaking_finish\n    undertaking=Undertaking.find(params[:undertaking_id])\n    unless undertaking.deciding.finish_undertaking\n        redirect_to root_path\n    end\nend    \n</code></pre>\n\n<p>end</p>\n\n<p>Please help me...</p>\n"}, {"tags": ["c++", "ruby", "homebrew", "package-managers"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1482889687, "post_id": 41354198, "comment_id": 69910559, "body": "<code>system</code> will not be aware of your <code>bash_profile</code>, so maybe <code>testbrew</code> is not getting added to the <code>PATH</code> like it does regularly. Maybe trying passing an absolute path. See <a href=\"http://stackoverflow.com/questions/28555822/how-do-i-make-rubys-system-call-aware-of-my-bash-profile-aliases\" title=\"how do i make rubys system call aware of my bash profile aliases\">stackoverflow.com/questions/28555822/&hellip;</a>"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1482889969, "post_id": 41354198, "comment_id": 69910601, "body": "@maxple but then how does the second <code>system()</code> call work in the same situation?  The second one works just fine and <code>bin.install</code> is able to copy it into the required directory"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1482893198, "creation_date": 1482893198, "answer_id": 41354699, "question_id": 41354198, "link": "https://stackoverflow.com/questions/41354198/building-a-c-formula-for-homebrew/41354699#41354699", "title": "Building a C++ formula for homebrew", "body": "<p>Your argument <code>\"-o testbrew\"</code> is wrong. That parses as <code>-o</code> with the option <code>\" testbrew\"</code> <em>including</em> the space. This is only possible because <code>system</code> with mutiple arguments bypasses the normal shell parsing, you're directly responsible for correctly splitting arguments.</p>\n\n<p>You've broken the other arguments out correctly. I'd recommend doing it that way:</p>\n\n<pre><code>\"-o\", \"testbrew\"\n</code></pre>\n"}], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 41354699, "answer_count": 1, "score": 0, "last_activity_date": 1482893198, "creation_date": 1482888416, "question_id": 41354198, "link": "https://stackoverflow.com/questions/41354198/building-a-c-formula-for-homebrew", "title": "Building a C++ formula for homebrew", "body": "<p>I have very very little experience with Ruby and I was trying to build a simple homebrew formula.  I had a simple test project with the following structure </p>\n\n<pre><code>.\n\u251c\u2500\u2500 Makefile\n\u2514\u2500\u2500 test.cpp\n\n0 directories, 2 files\n</code></pre>\n\n<p>And then I have the following <code>.rb</code> formula file</p>\n\n<pre><code>class Testbrew &lt; Formula\n  desc \"\"\n  homepage \"\"\n  url \"\"\n  version \"\"\n  head \"\"\n  sha256 \"\"\n\n  def install\n    # system \"make\"\n    # system(\"g++ -std=c++14 -O3 test.cpp -o testbrew\")\n    system \"g++\", \"-std=c++14\",\n           \"-O3\",\n           \"-Wall\",\n           \"-Werror\",\n           \"-Wextra\",\n           \"-pedantic\",\n           \"-Wvla\",\n           \"test.cpp\",\n           \"-o testbrew\"\n    bin.install \"testbrew\"\n    ohai(\"Done!\")\n  end\nend\n</code></pre>\n\n<p>The confusing part here is that the first two commented lines of <code>system</code> work to install the package but the third does not, any idea why?  If I try the third line I get the error </p>\n\n<pre><code>==&gt; g++ -std=c++14 -O3 -Wall -Werror -Wextra -pedantic -Wvla test.cpp -o testbrew\nError: No such file or directory - testbrew\n</code></pre>\n\n<p>Also as a followup, are there certain things that the function call <code>system()</code> does not allow the user to do?  i.e. are there any security restrictions imposed (for example with <code>ptrace</code>)?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation"], "answers": [{"comments": [{"owner": {"reputation": 4587, "user_id": 1098873, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/47fe800ed32c2009b4f83d129e8657f9?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/1098873/eric"}, "edited": false, "score": 1, "creation_date": 1482903154, "post_id": 41354216, "comment_id": 69913541, "body": "Unfortunately you are referring here to ActiveRecord validations, but I am using <a href=\"https://github.com/dry-rb/dry-validation\" rel=\"nofollow noreferrer\">github.com/dry-rb/dry-validation</a> instead so this isn&#39;t a solution."}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "reply_to_user": {"reputation": 4587, "user_id": 1098873, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/47fe800ed32c2009b4f83d129e8657f9?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/1098873/eric"}, "edited": false, "score": 0, "creation_date": 1482905579, "post_id": 41354216, "comment_id": 69914317, "body": "Oh bummer, sorry about that!"}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": false, "score": 1, "last_activity_date": 1482906204, "last_edit_date": 1482906204, "creation_date": 1482888627, "answer_id": 41354216, "question_id": 41354118, "link": "https://stackoverflow.com/questions/41354118/how-can-i-use-a-custom-predicate-to-validate-multiple-fields-with-dry-validation/41354216#41354216", "title": "How can I use a custom predicate to validate multiple fields with dry-validation?", "body": "<p>Update\u2014this is for ActiveRecords rather than <code>dry-validation</code> gem.</p>\n\n<p>See this tutorial, <a href=\"http://guides.rubyonrails.org/active_record_validations.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/active_record_validations.html</a></p>\n\n<p>Quoting from the tutorial,</p>\n\n<blockquote>\n  <p>You can also create methods that verify the state of your models and add messages to the errors collection when they are invalid. You must then register these methods by using the <code>validate</code> (API) class method, passing in the symbols for the validation methods' names.</p>\n</blockquote>\n\n<pre><code>class Invoice &lt; ApplicationRecord\n  validate :discount_cannot_be_greater_than_total_value\n\n  def discount_cannot_be_greater_than_total_value\n    if discount &gt; total_value\n      errors.add(:discount, \"can't be greater than total value\")\n    end\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1510, "user_id": 5347939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd08586af8e2395aad85311b2c49a02e?s=128&d=identicon&r=PG", "display_name": "zhisme", "link": "https://stackoverflow.com/users/5347939/zhisme"}, "edited": false, "score": 1, "creation_date": 1590486671, "post_id": 41359744, "comment_id": 109690462, "body": "Link has become incorrect.  permanent link is <a href=\"https://dry-rb.org/gems/dry-validation/0.13/high-level-rules/\" rel=\"nofollow noreferrer\">dry-rb.org/gems/dry-validation/0.13/high-level-rules</a>"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 1510, "user_id": 5347939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd08586af8e2395aad85311b2c49a02e?s=128&d=identicon&r=PG", "display_name": "zhisme", "link": "https://stackoverflow.com/users/5347939/zhisme"}, "edited": false, "score": 0, "creation_date": 1590486994, "post_id": 41359744, "comment_id": 109690643, "body": "@zhisme: Updated. Thank you very much!"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1590486979, "last_edit_date": 1590486979, "creation_date": 1482919805, "answer_id": 41359744, "question_id": 41354118, "link": "https://stackoverflow.com/questions/41354118/how-can-i-use-a-custom-predicate-to-validate-multiple-fields-with-dry-validation/41359744#41359744", "title": "How can I use a custom predicate to validate multiple fields with dry-validation?", "body": "<p>It seems that <a href=\"https://dry-rb.org/gems/dry-validation/0.13/high-level-rules/\" rel=\"nofollow noreferrer\">this \"High-level Rules\" example</a> could help you :</p>\n\n<pre><code>schema = Dry::Validation.Schema do\n  required(:barcode).maybe(:str?)\n\n  required(:job_number).maybe(:int?)\n\n  required(:sample_number).maybe(:int?)\n\n  rule(barcode_only: [:barcode, :job_number, :sample_number]) do |barcode, job_num, sample_num|\n    barcode.filled? &gt; (job_num.none? &amp; sample_num.none?)\n  end\nend\n</code></pre>\n\n<p><code>barcode_only</code> checks 3 attributes at a time.</p>\n\n<p>So your code could be :</p>\n\n<pre><code>  rule(valid_address: [:line1, :city, :state, :zip]) do |line, city, state, zip|\n    # some boolean logic based on line, city, state and zip\n  end\n</code></pre>\n"}], "owner": {"reputation": 4587, "user_id": 1098873, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/47fe800ed32c2009b4f83d129e8657f9?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/1098873/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 990, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1590486979, "creation_date": 1482887567, "question_id": 41354118, "link": "https://stackoverflow.com/questions/41354118/how-can-i-use-a-custom-predicate-to-validate-multiple-fields-with-dry-validation", "title": "How can I use a custom predicate to validate multiple fields with dry-validation?", "body": "<p>I have an address form that I want to validate as a whole rather than validating each input on its own. I can only tell if the address is valid by passing the line1, city, state, zip to the custom predicate method so that it can check them as a unit.</p>\n\n<p>How can I do this? I only see how to validate individual fields.</p>\n"}, {"tags": ["ruby", "methods", "dynamic"], "answers": [{"comments": [{"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1482888731, "post_id": 41354148, "comment_id": 69910378, "body": "Thanks! I haven&#39;t considered this possibility."}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 3, "last_activity_date": 1482887870, "creation_date": 1482887870, "answer_id": 41354148, "question_id": 41354090, "link": "https://stackoverflow.com/questions/41354090/associating-a-block-to-a-method-after-defining-it/41354148#41354148", "title": "Associating a block to a method after defining it", "body": "<p>Yes, just redefine it with</p>\n\n<pre><code>self.class.send(:define_method, method_name, &amp;block)\n</code></pre>\n\n<p>Methods can be redefined as many times as you want.</p>\n"}], "owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15, "favorite_count": 0, "accepted_answer_id": 41354148, "answer_count": 1, "score": 1, "last_activity_date": 1482887870, "creation_date": 1482887290, "question_id": 41354090, "link": "https://stackoverflow.com/questions/41354090/associating-a-block-to-a-method-after-defining-it", "title": "Associating a block to a method after defining it", "body": "<p>This is much more a curiosity than something I am living in a real situation. </p>\n\n<p>Let's assume I need to define a method at a certain point of my program, using</p>\n\n<pre><code>self.class.send(:define_method, method_name)\n</code></pre>\n\n<p>without a block.</p>\n\n<p>It happens that at this point I still don't know exactly what this method must do. In other words, I don't have a block of code to associate with this method.</p>\n\n<p>My question is: <strong>Is there some way to create this association afterwards? A way to say 'Hey, from now on this method shall execute this block here?</strong></p>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1482886790, "post_id": 41353988, "comment_id": 69910056, "body": "You need at least one more tag, as what you&#39;ve posted is not pure Ruby."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1482908314, "post_id": 41353988, "comment_id": 69915413, "body": "This is covered (admittedly lightly) here: <a href=\"http://www.sinatrarb.com/intro.html#Accessing%20the%20Request%20Object\" rel=\"nofollow noreferrer\">sinatrarb.com/intro.html#Accessing%20the%20Request%20Object</a>"}], "answers": [{"comments": [{"owner": {"reputation": 694, "user_id": 5179678, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HDDwl.jpg?s=128&g=1", "display_name": "mgul", "link": "https://stackoverflow.com/users/5179678/mgul"}, "edited": false, "score": 0, "creation_date": 1482887286, "post_id": 41354064, "comment_id": 69910129, "body": "Thank you, I&#39;ll read more about streams and more particularly in ruby, I think that&#39;s the term that was missing in my google queries. Happy new year!"}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "reply_to_user": {"reputation": 694, "user_id": 5179678, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HDDwl.jpg?s=128&g=1", "display_name": "mgul", "link": "https://stackoverflow.com/users/5179678/mgul"}, "edited": false, "score": 1, "creation_date": 1482887577, "post_id": 41354064, "comment_id": 69910177, "body": "You&#39;re welcome! They are not always called streams in Ruby. Good starting points are <code>IO</code> and <code>Enumerable</code> and <code>Enumerable::Lazy</code>"}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 6, "last_activity_date": 1482888154, "last_edit_date": 1482888154, "creation_date": 1482886994, "answer_id": 41354064, "question_id": 41353988, "link": "https://stackoverflow.com/questions/41353988/content-of-variable-changing-after-read-in-ruby/41354064#41354064", "title": "Content of variable changing after read in ruby", "body": "<p><code>request.body</code> is an input stream.</p>\n\n<p>Streams are a basic data structure in computing where data is provided in sequence and has to be consumed in sequence. For example data sent over the internet is a stream. </p>\n\n<p>Stream processing is very powerful because it allows you process data that is bigger than a machine's memory, for example movies on Netflix are streamed to your computer so they never have to store the entire movie but the current frames only.</p>\n\n<p>Typically streams can only be read once. If you want to access the stream data more than once you have to buffer it. Which is what you're doing with <code>body = request.body.read</code>, well done!</p>\n\n<p>Some streams are rewindable. As it happens the <code>request.body</code> in Sinatra is rewindable, so you can rewind it to the begin and read it all again. </p>\n\n<pre><code>request.body.read\nrequest.body.rewind\nrequest.body.read # =&gt; returns the content again\n</code></pre>\n"}], "owner": {"reputation": 694, "user_id": 5179678, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HDDwl.jpg?s=128&g=1", "display_name": "mgul", "link": "https://stackoverflow.com/users/5179678/mgul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 41354064, "answer_count": 1, "score": 2, "last_activity_date": 1482888154, "creation_date": 1482886189, "last_edit_date": 1482886891, "question_id": 41353988, "link": "https://stackoverflow.com/questions/41353988/content-of-variable-changing-after-read-in-ruby", "title": "Content of variable changing after read in ruby", "body": "<p>I am new to ruby (started yesterday) and I'm playing a bit with sinatra to build an API. I encountered an issue which left me without clue:</p>\n\n<pre><code>post '/login' do\n    if request.body.read.length == 0\n       halt 400 # bad request \n    else\n        body = JSON.parse(request.body.read)\n    end\nend\n</code></pre>\n\n<p>When I executed this code, I had an error because I tried to parse an empty string with <code>body = JSON.parse(request.body.read)</code>. In fact, I had to save <code>request.body.read</code> in another variable to use it twice (or more), because it's like <code>request.body</code> gets \"consumed\" after the first use.</p>\n\n<p>This reminds me of borrows with rust, but here I wasn't expecting that and can't express it on google to find any documentation. <em>Can anyone explain me what happened and why <code>request.body</code> is readable only one time?</em></p>\n\n<p>For people who have the same problem (we never know), here's the fix:</p>\n\n<pre><code>post '/login' do\n    body = request.body.read\n\n    if body.length == 0\n        halt 400 # bad request\n    else\n        body_json = JSON.parse(body)\n    end\nend\n</code></pre>\n\n<p>I heard about IO objects but I still can't go further in my researches.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "shopify", "internal-server-error"], "comments": [{"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1482888988, "post_id": 41353970, "comment_id": 69910440, "body": "what does the error say?  Could you post the error output or screenshot?"}, {"owner": {"reputation": 1, "user_id": 7347730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382058b4827ed6391cec0923a4e1b6f?s=128&d=identicon&r=PG&f=1", "display_name": "univesta.angel", "link": "https://stackoverflow.com/users/7347730/univesta-angel"}, "reply_to_user": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1482890276, "post_id": 41353970, "comment_id": 69910663, "body": "@RockwellRice sorry bout that, I&#39;ve just added the logs"}, {"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1482891808, "post_id": 41353970, "comment_id": 69910978, "body": "It looks like it is looking for a shop using the id, but it seems from your description that id is meant for a product, is that correct? Can you share the link to the tutorial?"}, {"owner": {"reputation": 1, "user_id": 7347730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382058b4827ed6391cec0923a4e1b6f?s=128&d=identicon&r=PG&f=1", "display_name": "univesta.angel", "link": "https://stackoverflow.com/users/7347730/univesta-angel"}, "reply_to_user": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1482894129, "post_id": 41353970, "comment_id": 69911439, "body": "@RockwellRice this is the tutorial <a href=\"https://www.youtube.com/watch?v=DB48N8rRHFw\" rel=\"nofollow noreferrer\">youtube.com/watch?v=DB48N8rRHFw</a> ...i added and changed some codes"}], "owner": {"reputation": 1, "user_id": 7347730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382058b4827ed6391cec0923a4e1b6f?s=128&d=identicon&r=PG&f=1", "display_name": "univesta.angel", "link": "https://stackoverflow.com/users/7347730/univesta-angel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482890227, "creation_date": 1482886051, "last_edit_date": 1482890227, "question_id": 41353970, "link": "https://stackoverflow.com/questions/41353970/internal-server-error-500-shopify-app", "title": "Internal Server Error (500) Shopify app", "body": "<p>I followed a tutorial to build an app that displays all the products and some of its details. I have managed to successfully do this part. the problem is that when I click on a link to show the description of the product on another page, it gives a (500) internal server error</p>\n\n<p>Here is the code:</p>\n\n<p>home_controller.rb:</p>\n\n<pre><code>class HomeController &lt; ShopifyApp::AuthenticatedController\n\n  def index\n    @products = ShopifyAPI::Product.find(:all, params: { limit: 10 })\n  end\n\n  def show\n    @products = ShopifyAPI::Product.find(params[:id])\n  end\nend\n</code></pre>\n\n<p>index.html.erb:</p>\n\n<pre><code>&lt;% content_for :javascript do %&gt;\n  &lt;script type=\"text/javascript\"&gt;\n    ShopifyApp.ready(function(){\n      ShopifyApp.Bar.initialize({\n        title: \"Home\",\n        icon: \"&lt;%= asset_path('favicon.ico') %&gt;\"\n      });\n    });\n  &lt;/script&gt;\n&lt;% end %&gt;\n\n&lt;h2&gt;Products&lt;/h2&gt;\n\n&lt;ul&gt;\n  &lt;% @products.each do |product| %&gt;\n    &lt;p&gt;\n      &lt;b&gt;&lt;%= product.title %&gt;&lt;br&gt;&lt;/b&gt;\n      ID: &lt;%= product.id %&gt;&lt;br&gt;\n      Vendor: &lt;%= product.vendor %&gt;&lt;br&gt;\n      Created at: &lt;%= product.created_at %&gt;&lt;br&gt;\n    &lt;/p&gt;\n    &lt;li&gt;&lt;%= link_to 'Show description', home_show_path(product) %&gt;&lt;/li&gt;\n    &lt;br&gt;&lt;br&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>show.html.erb:</p>\n\n<pre><code>&lt;h1&gt;&lt;%= @product.title %&gt;&lt;/h1&gt;\n&lt;p&gt;Description: &lt;%= @product.body_html %&gt;&lt;/p&gt;\n</code></pre>\n\n<p>heroku logs:</p>\n\n<pre><code>2016-12-28T01:01:25.028806+00:00 app[web.1]: I, [2016-12-28T01:01:25.028728 #4]  INFO -- : [6a2e2c9e-b81e-4ad4-91fc-465c54f339f4] Processing by HomeController#index as HTML\n2016-12-28T01:01:25.028921+00:00 app[web.1]: I, [2016-12-28T01:01:25.028865 #4]  INFO -- : [6a2e2c9e-b81e-4ad4-91fc-465c54f339f4]   Parameters: {\"hmac\"=&gt;\"df343ac1be8d47fc346c85012e46870a3d1d2c7d593259d6a7e5e2e4be2a60d6\", \"protocol\"=&gt;\"https://\", \"shop\"=&gt;\"gels-store.myshopify.com\", \"timestamp\"=&gt;\"1482886883\"}\n2016-12-28T01:01:25.099398+00:00 app[web.1]: D, [2016-12-28T01:01:25.099299 #4] DEBUG -- : [6a2e2c9e-b81e-4ad4-91fc-465c54f339f4]   Shop Load (1.4ms)  SELECT  \"shops\".* FROM \"shops\" WHERE \"shops\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n2016-12-28T01:01:25.550140+00:00 app[web.1]: I, [2016-12-28T01:01:25.550053 #4]  INFO -- : [6a2e2c9e-b81e-4ad4-91fc-465c54f339f4]   Rendered home/index.html.erb within layouts/embedded_app (7.2ms)\n2016-12-28T01:01:25.542213+00:00 app[web.1]: I, [2016-12-28T01:01:25.542094 #4]  INFO -- : [6a2e2c9e-b81e-4ad4-91fc-465c54f339f4]   Rendering home/index.html.erb within layouts/embedded_app\n2016-12-28T01:01:25.553973+00:00 app[web.1]: I, [2016-12-28T01:01:25.553914 #4]  INFO -- : [6a2e2c9e-b81e-4ad4-91fc-465c54f339f4]   Rendered layouts/_flash_messages.html.erb (0.8ms)\n2016-12-28T01:01:25.554749+00:00 app[web.1]: I, [2016-12-28T01:01:25.554669 #4]  INFO -- : [6a2e2c9e-b81e-4ad4-91fc-465c54f339f4] Completed 200 OK in 526ms (Views: 13.7ms | ActiveRecord: 21.7ms)\n2016-12-28T01:01:25.569551+00:00 heroku[router]: at=info method=GET path=\"/?hmac=df343ac1be8d47fc346c85012e46870a3d1d2c7d593259d6a7e5e2e4be2a60d6&amp;protocol=https%3A%2F%2F&amp;shop=gels-store.myshopify.com&amp;timestamp=1482886883\" host=angelstore.herokuapp.com request_id=6a2e2c9e-b81e-4ad4-91fc-465c54f339f4 fwd=\"222.127.11.170\" dyno=web.1 connect=0ms service=544ms status=200 bytes=3372\n2016-12-28T01:01:29.415828+00:00 app[web.1]: I, [2016-12-28T01:01:29.415735 #4]  INFO -- : [67b7923f-112d-499e-8ee4-76afe17220ab] Started GET \"/home/show.7867909648\" for 222.127.11.170 at 2016-12-28 01:01:29 +0000\n2016-12-28T01:01:29.417488+00:00 app[web.1]: I, [2016-12-28T01:01:29.417421 #4]  INFO -- : [67b7923f-112d-499e-8ee4-76afe17220ab] Processing by HomeController#show as\n2016-12-28T01:01:29.426318+00:00 app[web.1]: D, [2016-12-28T01:01:29.426226 #4] DEBUG -- : [67b7923f-112d-499e-8ee4-76afe17220ab]   Shop Load (2.6ms)  SELECT  \"shops\".* FROM \"shops\" WHERE \"shops\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n2016-12-28T01:01:29.601847+00:00 app[web.1]: I, [2016-12-28T01:01:29.601755 #4]  INFO -- : [67b7923f-112d-499e-8ee4-76afe17220ab] Completed 500 Internal Server Error in 184ms (ActiveRecord: 2.6ms)\n2016-12-28T01:01:29.603340+00:00 app[web.1]: F, [2016-12-28T01:01:29.603284 #4] FATAL -- : [67b7923f-112d-499e-8ee4-76afe17220ab]\n2016-12-28T01:01:29.603452+00:00 app[web.1]: F, [2016-12-28T01:01:29.603370 #4] FATAL -- : [67b7923f-112d-499e-8ee4-76afe17220ab] ActiveResource::ResourceNotFound (Failed.  Response code = 404.  Response message = Not Found.):\n2016-12-28T01:01:29.603537+00:00 app[web.1]: F, [2016-12-28T01:01:29.603474 #4] FATAL -- : [67b7923f-112d-499e-8ee4-76afe17220ab]\n2016-12-28T01:01:29.603653+00:00 app[web.1]: F, [2016-12-28T01:01:29.603603 #4] FATAL -- : [67b7923f-112d-499e-8ee4-76afe17220ab] app/controllers/home_controller.rb:13:in `show'\n2016-12-28T01:01:29.617184+00:00 heroku[router]: at=info method=GET path=\"/home/show.7867909648\" host=angelstore.herokuapp.com request_id=67b7923f-112d-499e-8ee4-76afe17220ab fwd=\"222.127.11.170\" dyno=web.1 connect=0ms service=191ms status=500 bytes=1669\n2016-12-28T01:17:34.584890+00:00 app[web.1]: I, [2016-12-28T01:17:34.584834 #4]  INFO -- : [a590ebad-6c05-440b-b645-603cd8bfc079] Processing by HomeController#index as HTML\n2016-12-28T01:17:34.582622+00:00 app[web.1]: I, [2016-12-28T01:17:34.582517 #4]  INFO -- : [a590ebad-6c05-440b-b645-603cd8bfc079] Started GET \"/?hmac=0357daa86308275954f0df7389e33ab87eb55cdb9091a99466912e12cd5a523f&amp;protocol=https%3A%2F%2F&amp;shop=gels-store.myshopify.com&amp;timestamp=1482887853\" for 222.127.11.170 at 2016-12-28 01:17:34 +0000\n2016-12-28T01:17:34.589609+00:00 app[web.1]: D, [2016-12-28T01:17:34.589524 #4] DEBUG -- : [a590ebad-6c05-440b-b645-603cd8bfc079]   Shop Load (1.4ms)  SELECT  \"shops\".* FROM \"shops\" WHERE \"shops\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n2016-12-28T01:17:34.585031+00:00 app[web.1]: I, [2016-12-28T01:17:34.584976 #4]  INFO -- : [a590ebad-6c05-440b-b645-603cd8bfc079]   Parameters: {\"hmac\"=&gt;\"0357daa86308275954f0df7389e33ab87eb55cdb9091a99466912e12cd5a523f\", \"protocol\"=&gt;\"https://\", \"shop\"=&gt;\"gels-store.myshopify.com\", \"timestamp\"=&gt;\"1482887853\"}\n2016-12-28T01:17:35.028248+00:00 heroku[router]: at=info method=GET path=\"/?hmac=0357daa86308275954f0df7389e33ab87eb55cdb9091a99466912e12cd5a523f&amp;protocol=https%3A%2F%2F&amp;shop=gels-store.myshopify.com&amp;timestamp=1482887853\" host=angelstore.herokuapp.com request_id=a590ebad-6c05-440b-b645-603cd8bfc079 fwd=\"222.127.11.170\" dyno=web.1 connect=1ms service=441ms status=200 bytes=3372\n2016-12-28T01:17:35.008395+00:00 app[web.1]: I, [2016-12-28T01:17:35.008284 #4]  INFO -- : [a590ebad-6c05-440b-b645-603cd8bfc079]   Rendering home/index.html.erb within layouts/embedded_app\n2016-12-28T01:17:35.011436+00:00 app[web.1]: I, [2016-12-28T01:17:35.011355 #4]  INFO -- : [a590ebad-6c05-440b-b645-603cd8bfc079]   Rendered home/index.html.erb within layouts/embedded_app (2.7ms)\n2016-12-28T01:17:35.013398+00:00 app[web.1]: I, [2016-12-28T01:17:35.013331 #4]  INFO -- : [a590ebad-6c05-440b-b645-603cd8bfc079]   Rendered layouts/_flash_messages.html.erb (0.3ms)\n2016-12-28T01:17:35.014512+00:00 app[web.1]: I, [2016-12-28T01:17:35.014462 #4]  INFO -- : [a590ebad-6c05-440b-b645-603cd8bfc079] Completed 200 OK in 429ms (Views: 6.2ms | ActiveRecord: 1.4ms)\n2016-12-28T01:49:25.658231+00:00 app[web.1]: I, [2016-12-28T01:49:25.658126 #4]  INFO -- : [793b1499-9bcb-4150-ba39-2973ac73500c] Started GET \"/?hmac=9da8f8d814183cb0ac7802880e8848e4bce51c2d864406998d7b8b3f5bc95022&amp;protocol=https%3A%2F%2F&amp;shop=gels-store.myshopify.com&amp;timestamp=1482889764\" for 222.127.11.170 at 2016-12-28 01:49:25 +0000\n2016-12-28T01:49:25.659753+00:00 app[web.1]: I, [2016-12-28T01:49:25.659678 #4]  INFO -- : [793b1499-9bcb-4150-ba39-2973ac73500c] Processing by HomeController#index as HTML\n2016-12-28T01:49:25.659835+00:00 app[web.1]: I, [2016-12-28T01:49:25.659776 #4]  INFO -- : [793b1499-9bcb-4150-ba39-2973ac73500c]   Parameters: {\"hmac\"=&gt;\"9da8f8d814183cb0ac7802880e8848e4bce51c2d864406998d7b8b3f5bc95022\", \"protocol\"=&gt;\"https://\", \"shop\"=&gt;\"gels-store.myshopify.com\", \"timestamp\"=&gt;\"1482889764\"}\n2016-12-28T01:49:25.671459+00:00 app[web.1]: D, [2016-12-28T01:49:25.671165 #4] DEBUG -- : [793b1499-9bcb-4150-ba39-2973ac73500c]   Shop Load (5.5ms)  SELECT  \"shops\".* FROM \"shops\" WHERE \"shops\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n2016-12-28T01:49:26.119086+00:00 heroku[router]: at=info method=GET path=\"/?hmac=9da8f8d814183cb0ac7802880e8848e4bce51c2d864406998d7b8b3f5bc95022&amp;protocol=https%3A%2F%2F&amp;shop=gels-store.myshopify.com&amp;timestamp=1482889764\" host=angelstore.herokuapp.com request_id=793b1499-9bcb-4150-ba39-2973ac73500c fwd=\"222.127.11.170\" dyno=web.1 connect=1ms service=465ms status=200 bytes=3372\n2016-12-28T01:49:26.107927+00:00 app[web.1]: I, [2016-12-28T01:49:26.107802 #4]  INFO -- : [793b1499-9bcb-4150-ba39-2973ac73500c]   Rendering home/index.html.erb within layouts/embedded_app\n2016-12-28T01:49:26.109971+00:00 app[web.1]: I, [2016-12-28T01:49:26.109899 #4]  INFO -- : [793b1499-9bcb-4150-ba39-2973ac73500c]   Rendered home/index.html.erb within layouts/embedded_app (1.9ms)\n2016-12-28T01:49:26.111276+00:00 app[web.1]: I, [2016-12-28T01:49:26.111176 #4]  INFO -- : [793b1499-9bcb-4150-ba39-2973ac73500c]   Rendered layouts/_flash_messages.html.erb (0.2ms)\n2016-12-28T01:49:26.111884+00:00 app[web.1]: I, [2016-12-28T01:49:26.111817 #4]  INFO -- : [793b1499-9bcb-4150-ba39-2973ac73500c] Completed 200 OK in 452ms (Views: 4.2ms | ActiveRecord: 5.5ms)\n2016-12-28T01:49:26.522691+00:00 heroku[router]: at=info method=GET path=\"/assets/application-cbbb5732d70d7094ddba7a7ba5746b6e55093adf1a04b07303a293e1e378e91a.js\" host=angelstore.herokuapp.com request_id=e239ea0c-3fc5-4af6-9262-85765448fd2e fwd=\"222.127.11.170\" dyno=web.1 connect=0ms service=8ms status=304 bytes=48\n2016-12-28T01:49:35.375345+00:00 app[web.1]: I, [2016-12-28T01:49:35.375220 #4]  INFO -- : [985ea4ca-52de-405d-9dd2-9811f0c0455b] Started GET \"/home/show.7867909648\" for 222.127.11.170 at 2016-12-28 01:49:35 +0000\n2016-12-28T01:49:35.376624+00:00 app[web.1]: I, [2016-12-28T01:49:35.376568 #4]  INFO -- : [985ea4ca-52de-405d-9dd2-9811f0c0455b] Processing by HomeController#show as\n2016-12-28T01:49:35.380593+00:00 app[web.1]: D, [2016-12-28T01:49:35.380522 #4] DEBUG -- : [985ea4ca-52de-405d-9dd2-9811f0c0455b]   Shop Load (1.4ms)  SELECT  \"shops\".* FROM \"shops\" WHERE \"shops\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n2016-12-28T01:49:35.542679+00:00 app[web.1]: I, [2016-12-28T01:49:35.542574 #4]  INFO -- : [985ea4ca-52de-405d-9dd2-9811f0c0455b] Completed 500 Internal Server Error in 166ms (ActiveRecord: 1.4ms)\n2016-12-28T01:49:35.544843+00:00 app[web.1]: F, [2016-12-28T01:49:35.544775 #4] FATAL -- : [985ea4ca-52de-405d-9dd2-9811f0c0455b]\n2016-12-28T01:49:35.544921+00:00 app[web.1]: F, [2016-12-28T01:49:35.544862 #4] FATAL -- : [985ea4ca-52de-405d-9dd2-9811f0c0455b] ActiveResource::ResourceNotFound (Failed.  Response code = 404.  Response message = Not Found.):\n2016-12-28T01:49:35.544984+00:00 app[web.1]: F, [2016-12-28T01:49:35.544930 #4] FATAL -- : [985ea4ca-52de-405d-9dd2-9811f0c0455b]\n2016-12-28T01:49:35.545049+00:00 app[web.1]: F, [2016-12-28T01:49:35.544997 #4] FATAL -- : [985ea4ca-52de-405d-9dd2-9811f0c0455b] app/controllers/home_controller.rb:13:in `show'\n2016-12-28T01:49:35.551115+00:00 heroku[router]: at=info method=GET path=\"/home/show.7867909648\" host=angelstore.herokuapp.com request_id=985ea4ca-52de-405d-9dd2-9811f0c0455b fwd=\"222.127.11.170\" dyno=web.1 connect=0ms service=174ms status=500 bytes=1669\n</code></pre>\n"}, {"tags": ["ruby", "ubuntu-16.04", "serverspec"], "comments": [{"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1482930836, "post_id": 41353960, "comment_id": 69926917, "body": "You are not actually using serverspec at all in that code. You should probably remove it. However, you are using specinfra for the docker backend."}], "answers": [{"tags": [], "owner": {"reputation": 1365, "user_id": 4894399, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tY1Cz7EDNxc/AAAAAAAAAAI/AAAAAAAABb4/3Qa15VP4_ZY/photo.jpg?sz=128", "display_name": "Szymon Szypulski", "link": "https://stackoverflow.com/users/4894399/szymon-szypulski"}, "is_accepted": false, "score": 1, "last_activity_date": 1482926473, "creation_date": 1482926473, "answer_id": 41361712, "question_id": 41353960, "link": "https://stackoverflow.com/questions/41353960/dockerfile-test-require-directive-unable-to-find-the-correct-module/41361712#41361712", "title": "Dockerfile test require directive unable to find the correct module", "body": "<p>I'm not sure if it's right approach, Serverspec should only verify your environment, which should be configured by some kind of configuration management (Chef, Puppet, etc..).</p>\n\n<p>However, looks like you are including wrong gem/file. You should replace second line with <code>require \"docker-api\"</code>. <code>Docker::Image</code> is a class from <a href=\"https://github.com/swipely/docker-api/blob/master/lib/docker/image.rb\" rel=\"nofollow noreferrer\"><code>docker-api</code> gem</a>. Gem has to be installed before running tests.</p>\n"}], "owner": {"reputation": 298, "user_id": 246488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3af93ff8cfe7847d0caabefc71e2a639?s=128&d=identicon&r=PG", "display_name": "William", "link": "https://stackoverflow.com/users/246488/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1482934221, "creation_date": 1482885795, "last_edit_date": 1482934221, "question_id": 41353960, "link": "https://stackoverflow.com/questions/41353960/dockerfile-test-require-directive-unable-to-find-the-correct-module", "title": "Dockerfile test require directive unable to find the correct module", "body": "<p>I am trying to write a basic test of an Ubuntu 16.04 docker image.\nMy testing environment is Ubuntu 16.04 also and I have installed the <code>ruby-serverspec</code> package.</p>\n\n<pre><code>require \"serverspec\"\nrequire \"docker_image\"\n\ndescribe \"Dockerfile\" do\n  before(:all) do\n    image = Docker::Image.build_from_dir('..')\n\n    set :os, family: :debian\n    set :backend, :docker\n    set :docker_image, image.id\n  end\n\n  it \"installs the right version of Ubuntu\" do\n    expect(os_version).to include(\"Ubuntu 14\")\n  end\n\n  def os_version\n    command(\"lsb_release -a\").stdout\n  end\nend\n</code></pre>\n\n<p>This is a deliberately failing test for now, as it checks for Ubuntu 14, but it is not even reaching the failure.</p>\n\n<pre><code>$ rspec /test/spec/localhost/my_spec.rb    \n/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- docker_image (LoadError)\n    from /usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from /test/spec/localhost/my_spec.rb:4:in `&lt;top (required)&gt;'\n    from /usr/lib/ruby/vendor_ruby/rspec/core/configuration.rb:1361:in `load'\n    from /usr/lib/ruby/vendor_ruby/rspec/core/configuration.rb:1361:in `block in load_spec_files'\n    from /usr/lib/ruby/vendor_ruby/rspec/core/configuration.rb:1359:in `each'\n    from /usr/lib/ruby/vendor_ruby/rspec/core/configuration.rb:1359:in `load_spec_files'\n    from /usr/lib/ruby/vendor_ruby/rspec/core/runner.rb:106:in `setup'\n    from /usr/lib/ruby/vendor_ruby/rspec/core/runner.rb:92:in `run'\n    from /usr/lib/ruby/vendor_ruby/rspec/core/runner.rb:78:in `run'\n    from /usr/lib/ruby/vendor_ruby/rspec/core/runner.rb:45:in `invoke'\n    from /usr/bin/rspec:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>I am unaware of how to require the <code>Docker::Image</code> class module correctly.\nThe search path is still a black art to me. How can I get this test to fail as expected?</p>\n"}, {"tags": ["python", "ruby", "performance", "fork"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1482882065, "post_id": 41353532, "comment_id": 69909152, "body": "Is it a penalty per fork layer, like would it be double if in another sub-fork? Does that penalty go away if the parent process exits? Does this apply inside of threads?"}, {"owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1482882169, "post_id": 41353532, "comment_id": 69909170, "body": "@tadman Cool questions. It is not a penalty per fork layer; the next-level fork has the exact same execution time as the first fork. I&#39;ll check the rest of the scenarios if I can."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1482882689, "post_id": 41353532, "comment_id": 69909266, "body": "I&#39;m observing the same behaviour as you with Ruby 2.3.3 on macOS 10.12, but can&#39;t reproduce it on Fedora. This is likely an issue with the time code on macOS, so it might be worth filing a bug report. I believe this is isolated to time-related functions for some reason."}, {"owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1482882797, "post_id": 41353532, "comment_id": 69909291, "body": "@tadman Subsequent deeper layers of forking all experience the exact same penalty, and the penalty does not change depending on whether the parent process exits or not. Regarding Fedora: that matches the Ubuntu behavior I mentioned, so I would expect all Linux distros to avoid the penalty encountered on macOS / OS X."}, {"owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1482883729, "post_id": 41353532, "comment_id": 69909486, "body": "@tadman I updated with a test script in Python that (I believe) shows the &quot;fork penalty&quot; is exclusive to Ruby. My Python is only so-so, and so I may have drawn a bad conclusion; I added the python tag to the question to see if any Python experts object to my test."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1482892599, "post_id": 41353532, "comment_id": 69911125, "body": "Can you find any other functions other than time-related which exhibit this behaviour? It&#39;s probably a simple thing in the Ruby C code, but a very quirky one."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 1, "creation_date": 1482952839, "post_id": 41353532, "comment_id": 69938353, "body": "I can also reproduce this behavior on Ruby 2.0.0p648 on OSX 10.12.1 compared to Ruby 2.0.0p598 on CentOS 7.2.1511. What&#39;s more, it consistently differs by year in <code>Time.utc</code>. 1972-2017: slow (5s). 1970-1971: medium (2.5s). 1950-1969, 2018-2040: fast (0.1s, no difference). No difference in other code like <code>File.exists?</code> (syscalls) or large string concat (heavy allocations). I have no idea what to make of this."}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "reply_to_user": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1482965275, "post_id": 41353532, "comment_id": 69943294, "body": "@thatotherguy I get similar results with Ruby 2.4. The dates are interesting though: 1970 is the UNIX epoch, 1972 is (<a href=\"https://github.com/ruby/ruby/blob/v2_4_0/time.c#L1140-L1141\" rel=\"nofollow noreferrer\">according to the Ruby source</a>) when the first leap-second occurred, and leap-seconds (again <a href=\"https://github.com/ruby/ruby/blob/v2_4_0/time.c#L1094-L1096\" rel=\"nofollow noreferrer\">according to the Ruby source</a>) are known 6 months in advance, so that would be into 2017 but not 2018. I still can\u2019t see how this would differ between the parent process and a forked child though."}, {"owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1482965713, "post_id": 41353532, "comment_id": 69943417, "body": "@matt I&#39;m with you \u2013 I saw that the dates are related to leap seconds, but I&#39;m still confused as to why the main/fork processes would differ. I experimented with IO pipes but couldn&#39;t find a relationship."}], "answers": [{"tags": [], "owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "is_accepted": true, "score": 6, "last_activity_date": 1482972493, "last_edit_date": 1495541423, "creation_date": 1482972493, "answer_id": 41371753, "question_id": 41353532, "link": "https://stackoverflow.com/questions/41353532/why-is-time-utc-slower-in-a-forked-process-in-ruby-on-os-x-and-not-in-python/41371753#41371753", "title": "Why is Time.utc slower in a forked process in Ruby on OS X (and not in Python)?", "body": "<p>As it turns out, the slowdown is due in approximately equal measure to two function calls in <code>time.c</code>, in the function <code>gmtime_with_leapsecond</code>. The two functions are <code>tzset</code> and <code>localtime_r</code>.</p>\n\n<p>That discovery led me to the question <a href=\"https://stackoverflow.com/questions/27932330/why-is-tzset-a-lot-slower-after-forking-on-mac-os-x\">Why is tzset() a lot slower after forking on Mac OS X?</a>, of which the current question might reasonably be said to be a duplicate.</p>\n\n<p>There are two answers there, neither accepted, which point to root causes involving either</p>\n\n<ul>\n<li>the \"async-signal-safe\"-ness of <code>tzset</code> and <code>localtime</code>/<code>localtime_r</code>, or</li>\n<li>Apple's use of a passive notification registry that invalidates when <code>fork</code>'d.</li>\n</ul>\n\n<p>The fact that the slowdown only occurs in years with no known leap seconds (as discovered by user <a href=\"https://stackoverflow.com/users/1899640/that-other-guy\">that other guy</a>) is obviously due to the fact that Ruby doesn't call <code>gmtime_with_leapsecond</code> when it knows that the year has no leap seconds.</p>\n\n<p>I'm not sure why there is no such slowdown in Python. One possible explanation is that my test script using <code>fork</code> and <code>utcnow</code> may not be creating a child process that calls <code>tzset</code> or <code>localtime</code>/<code>localtime_r</code>.</p>\n"}], "owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 1, "accepted_answer_id": 41371753, "answer_count": 1, "score": 8, "last_activity_date": 1549751249, "creation_date": 1482881884, "last_edit_date": 1549751249, "question_id": 41353532, "link": "https://stackoverflow.com/questions/41353532/why-is-time-utc-slower-in-a-forked-process-in-ruby-on-os-x-and-not-in-python", "title": "Why is Time.utc slower in a forked process in Ruby on OS X (and not in Python)?", "body": "<p>I saw the question <a href=\"https://stackoverflow.com/questions/38844392/why-does-process-fork-make-stuff-slower-in-ruby-on-os-x\">Why does Process.fork make stuff slower in Ruby on OS X?</a> and was able to determine that <code>Process.fork</code> does <em>not</em> actually make tasks, in general, slower. </p>\n\n<p>However, it does seem to make <code>Time.utc</code>, in particular, much slower.</p>\n\n<pre><code>require 'benchmark'\n\ndef do_stuff\n  50000.times { Time.utc(2016) }\nend\n\nputs \"main: #{Benchmark.measure { do_stuff }}\"\n\nProcess.fork do\n  puts \"fork: #{Benchmark.measure { do_stuff }}\"\nend\n</code></pre>\n\n<p>Here are some results:</p>\n\n<pre><code>main:   0.100000   0.000000   0.100000 (  0.103762)\nfork:   0.530000   3.210000   3.740000 (  3.765203)\n\nmain:   0.100000   0.000000   0.100000 (  0.104218)\nfork:   0.540000   3.280000   3.820000 (  3.858817)\n\nmain:   0.100000   0.000000   0.100000 (  0.102956)\nfork:   0.520000   3.280000   3.800000 (  3.831084)\n</code></pre>\n\n<p>One clue might be that the above takes place on OS X, whereas on Ubuntu, there doesn't seem to be a difference:</p>\n\n<pre><code>main:   0.100000   0.070000   0.170000 (  0.166505)\nfork:   0.090000   0.070000   0.160000 (  0.169578)\n\nmain:   0.090000   0.080000   0.170000 (  0.167889)\nfork:   0.100000   0.060000   0.160000 (  0.169160)\n\nmain:   0.100000   0.070000   0.170000 (  0.170839)\nfork:   0.100000   0.070000   0.170000 (  0.176146)\n</code></pre>\n\n<p>Can anyone explain this oddity?</p>\n\n<p><strong>Further investigation:</strong></p>\n\n<p><a href=\"https://stackoverflow.com/users/87189/tadman\">@tadman</a> suggested that it might be a bug in the macOS / OS X time code, so I wrote a similar test in Python:</p>\n\n<pre><code>from timeit import timeit\nfrom os import fork\n\nprint timeit(\"datetime.datetime.utcnow()\", setup=\"import datetime\")\n\nif fork() == 0:\n  print timeit(\"datetime.datetime.utcnow()\", setup=\"import datetime\")\nelse:\n  pass\n</code></pre>\n\n<p>Again, on Ubuntu, the benchmarks are the same for the forked/main processes. On OS X, however, the forked process is now slightly <em>faster</em> than the main process, which is the <em>opposite</em> of the behavior in Ruby.</p>\n\n<p>This leads me to believe that the source of the \"fork penalty\" is in the Ruby implementation and not in the OS X time implementation.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1482878986, "post_id": 41353159, "comment_id": 69908240, "body": "What does this snippet do? It&#39;s hard to understand without any explanation."}, {"owner": {"reputation": 115, "user_id": 960288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6dfe9dc8993736732c13702e51728084?s=128&d=identicon&r=PG", "display_name": "Jeff V", "link": "https://stackoverflow.com/users/960288/jeff-v"}, "reply_to_user": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1482879789, "post_id": 41353159, "comment_id": 69908460, "body": "Its from a section of a method that returns an instance of <code>Net::HTTP</code>.  The class methods <code>Proxy</code> and <code>SOCKSProxy</code> (from socksify gem) work like Net:HTTP but pass traffic through a specified proxy server."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1482882962, "post_id": 41353159, "comment_id": 69909320, "body": "Those aren&#39;t class names, they are method calls. You can see that easily because they take arguments, and method calls are the only things in Ruby allowed to take arguments."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 960288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6dfe9dc8993736732c13702e51728084?s=128&d=identicon&r=PG", "display_name": "Jeff V", "link": "https://stackoverflow.com/users/960288/jeff-v"}, "edited": false, "score": 0, "creation_date": 1482880308, "post_id": 41353191, "comment_id": 69908636, "body": "Thanks, this is what I was looking for."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1482881883, "post_id": 41353191, "comment_id": 69909104, "body": "You can also do things like <code>case proxy_uri.scheme</code> with a clause like <code>when &#47;\\Asocks&#47;</code>. Using <code>\\A</code> is preferable to <code>^</code> since it anchors to beginning of string, not beginning of line which can be a huge deal in some cases. You should also be able to use <code>send</code> with arguments being either <code>:SOCKSProxy</code> or <code>:Proxy</code>. The <code>Net::HTTP</code> library is extremely quirky and uses capitals in all sorts of inappropriate ways."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 2, "last_activity_date": 1482881926, "last_edit_date": 1482881926, "creation_date": 1482879168, "answer_id": 41353191, "question_id": 41353159, "link": "https://stackoverflow.com/questions/41353159/ruby-conditional-class-name/41353191#41353191", "title": "Ruby conditional class name", "body": "<p>There's not much more to DRY, except the parameters :</p>\n\n<pre><code>params = [ proxy_uri.host, proxy_uri.port, http_proxy_user(proxy_uri), http_proxy_pass(proxy_uri) ]\n\nif proxy_uri.scheme =~ /\\Asocks/\n  Net::HTTP.SOCKSProxy(*params)\nelse\n  Net::HTTP.Proxy(*params)\nend\n</code></pre>\n\n<p>If you want to be fancy (untested):</p>\n\n<pre><code>params       = [ proxy_uri.host, proxy_uri.port, http_proxy_user(proxy_uri), http_proxy_pass(proxy_uri) ]\nproxy_method = proxy_uri.scheme =~ /\\Asocks/ ? :SOCKSProxy : :Proxy\nproxy        = Net::HTTP.method(proxy_method).call(params)\n</code></pre>\n\n<p>Note that <code>Net::HTTP.SOCKSProxy</code> and <code>Net::HTTP.Proxy</code> are capitalized methods, not classes.</p>\n"}, {"comments": [{"owner": {"reputation": 1007, "user_id": 6090706, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/NbSpn.png?s=128&g=1", "display_name": "Kostas Andrianos", "link": "https://stackoverflow.com/users/6090706/kostas-andrianos"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482879621, "post_id": 41353223, "comment_id": 69908404, "body": "How can I format it to look like code? I&#39;m on my smartphone"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482879727, "post_id": 41353223, "comment_id": 69908437, "body": "Edited. On a smartphone, I think you could add a newline a 4 spaces as indent."}], "tags": [], "owner": {"reputation": 1007, "user_id": 6090706, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/NbSpn.png?s=128&g=1", "display_name": "Kostas Andrianos", "link": "https://stackoverflow.com/users/6090706/kostas-andrianos"}, "is_accepted": false, "score": -1, "last_activity_date": 1482879650, "last_edit_date": 1482879650, "creation_date": 1482879378, "answer_id": 41353223, "question_id": 41353159, "link": "https://stackoverflow.com/questions/41353159/ruby-conditional-class-name/41353223#41353223", "title": "Ruby conditional class name", "body": "<p>You could do</p>\n\n<pre><code>proxy_uri.scheme =~ /^socks/ ? Net::HTTP.SOCKSProxy(proxy_uri.host, proxy_uri.port, http_proxy_user(proxy_uri), http_proxy_pass(proxy_uri)) : Net::HTTP.Proxy(proxy_uri.host, proxy_uri.port, http_proxy_user(proxy_uri), http_proxy_pass(proxy_uri))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": false, "score": 1, "last_activity_date": 1482881079, "creation_date": 1482881079, "answer_id": 41353445, "question_id": 41353159, "link": "https://stackoverflow.com/questions/41353159/ruby-conditional-class-name/41353445#41353445", "title": "Ruby conditional class name", "body": "<p><code>SOCKSProxy</code> and <code>Proxy</code> are function names on the <code>Net::HTTP</code> module.</p>\n\n<p>This is that one weird trick to make a factory function look like a constructor. Ruby enforces class names to start with uppercase and variable to start with with lowercase, but methods are free to use either including module functions. See also <code>Array</code> class vs global <code>Array</code> function (which defined as a module function on <code>Kernel</code> which is included in <code>Object</code> and thus becomes a private method that's always available).</p>\n\n<p>Thus try this,</p>\n\n<pre><code>Net::HTTP.method(proxy_uri.scheme =~ /^socks/ ? :SOCKSProxy, :Proxy).call(...) \n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 960288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6dfe9dc8993736732c13702e51728084?s=128&d=identicon&r=PG", "display_name": "Jeff V", "link": "https://stackoverflow.com/users/960288/jeff-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 41353191, "answer_count": 3, "score": -1, "last_activity_date": 1482881926, "creation_date": 1482878936, "question_id": 41353159, "link": "https://stackoverflow.com/questions/41353159/ruby-conditional-class-name", "title": "Ruby conditional class name", "body": "<p>I have this snippet, but I'm looking for a way to make this more ruby like, DRY, etc.</p>\n\n<pre><code>if proxy_uri.scheme =~ /^socks/\n  Net::HTTP.SOCKSProxy(proxy_uri.host, proxy_uri.port, http_proxy_user(proxy_uri), http_proxy_pass(proxy_uri))\nelse\n  Net::HTTP.Proxy(proxy_uri.host, proxy_uri.port, http_proxy_user(proxy_uri), http_proxy_pass(proxy_uri))\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "unique"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1482877355, "post_id": 41352888, "comment_id": 69907737, "body": "Anything in the errors? I mean, that&#39;s kind of the first place to look."}, {"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 0, "creation_date": 1482994829, "post_id": 41352888, "comment_id": 69950950, "body": "Could it be possible that the ID of the duplicate object isn&#39;t changed?"}], "answers": [{"tags": [], "owner": {"reputation": 5178, "user_id": 2577840, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1520578334/picture?type=large", "display_name": "Micha\u0142 M\u0142o\u017aniak", "link": "https://stackoverflow.com/users/2577840/micha%c5%82-m%c5%82o%c5%baniak"}, "is_accepted": false, "score": 0, "last_activity_date": 1482882880, "creation_date": 1482882880, "answer_id": 41353656, "question_id": 41352888, "link": "https://stackoverflow.com/questions/41352888/what-can-cause-activerecordrecordinvalid-on-a-field-with-no-uniqueness-constra/41353656#41353656", "title": "What can cause ActiveRecord::RecordInvalid on a field with no uniqueness constraint?", "body": "<p>It would be much easier to pinpoint actual problem if you could show your code and also Rails version. But if you are looking for general answer, the general answer is that <code>RecordInvalid</code> is raised by bang methods, mainly <code>save!</code> and <code>validate!</code> and other methods that calls those two underneath like <code>create!</code>, <code>update!</code>. This exception is raised by those methods when validation fails. And validation can fail from million of reasons that depends on your validation setup.</p>\n\n<p>This exception can also be raised when those methods are called on invalid associated records.</p>\n\n<p>I also think that validation may fail when you defined your own validation and return false.</p>\n"}], "owner": {"reputation": 8066, "user_id": 4272549, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1hvwh.jpg?s=128&g=1", "display_name": "123", "link": "https://stackoverflow.com/users/4272549/123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482882880, "creation_date": 1482877203, "question_id": 41352888, "link": "https://stackoverflow.com/questions/41352888/what-can-cause-activerecordrecordinvalid-on-a-field-with-no-uniqueness-constra", "title": "What can cause ActiveRecord::RecordInvalid on a field with no uniqueness constraint?", "body": "<p>I have a <code>copy</code> method that duplicates an object, and then changes some of it's attributes.  When saving this, it gives me an <code>ActiveRecord::RecordInvalid</code> error on <code>Name</code>.  However, the name attribute does not have a uniqueness constraint, so this should not be failing.</p>\n\n<p>Furthermore, the name HAS been changed so it is unique, and debugging the method indicates this is the case.  How can I be getting this error on a field that doesn't have a uniqueness constraint, and IS unique?</p>\n\n<p>I've seen a bunch of questions about this related to RSpec, but this is not in a testing environment, so it's not a DB problem.</p>\n\n<p>I realize I haven't posted code - I'm looking for general answers on what could possibly cause something like this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "conditional", "whitelist"], "answers": [{"comments": [{"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1482879640, "post_id": 41352544, "comment_id": 69908412, "body": "nince, but you&#39;ll have to use match in Ruby &lt; 2.4  since match? doesn&#39;t exist in previous versions"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1482900942, "post_id": 41352544, "comment_id": 69912851, "body": "That is correct <code>match?</code> was recently introduced in Ruby 2.4. If you are on an older version just use <code>match</code> instead."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482918568, "post_id": 41352544, "comment_id": 69920218, "body": "Nice. If you just need a boolean as an answer, the advantage of using <code>any?</code> is also that it stops as soon as a string is found."}, {"owner": {"reputation": 121, "user_id": 5970657, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6c262d316a232bfbc12892f8dc8fb7fe?s=128&d=identicon&r=PG&f=1", "display_name": "Fatin Cooper", "link": "https://stackoverflow.com/users/5970657/fatin-cooper"}, "edited": false, "score": 0, "creation_date": 1482979863, "post_id": 41352544, "comment_id": 69946749, "body": "Thank it seems I was trying to do something that you can&#39;t do."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 4, "last_activity_date": 1482876565, "last_edit_date": 1482876565, "creation_date": 1482874927, "answer_id": 41352544, "question_id": 41352497, "link": "https://stackoverflow.com/questions/41352497/passing-string-as-a-condition-of-a-method-in-ruby/41352544#41352544", "title": "passing string as a condition of a method in ruby", "body": "<p>An conditional as argument to <code>include?</code> is not possible, because <code>include?</code> accepts only a string argument.</p>\n\n<p>But you can write something like this:</p>\n\n<pre><code>['hello', 'world', 'new york', 'place'].any? { |word|\n  \"hello everyone in the house\".include?(word)\n}\n</code></pre>\n\n<p>Or you could generate a regexp from your strings:</p>\n\n<pre><code>\"hello eveyone in the house\".match?(\n  /#{['hello', 'world', 'new york', 'place'].join('|')}/\n)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1482901249, "post_id": 41352694, "comment_id": 69912926, "body": "That doesn&#39;t work for whitelisted terms that consist of several words (like <code>new york</code> in this example). Because in the sentence <code>new york</code>  would be splitted to <code>[&#39;new&#39;, &#39;york&#39;]</code> and that does not intersect with the array <code>[</code>new york<code>]</code>."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1482918369, "last_edit_date": 1482918369, "creation_date": 1482875896, "answer_id": 41352694, "question_id": 41352497, "link": "https://stackoverflow.com/questions/41352497/passing-string-as-a-condition-of-a-method-in-ruby/41352694#41352694", "title": "passing string as a condition of a method in ruby", "body": "<p>Another possibility would to <a href=\"https://ruby-doc.org/core-2.3.0/String.html#method-i-split\" rel=\"nofollow noreferrer\">split</a> the words and use <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/set/rdoc/Set.html#method-i-26\" rel=\"nofollow noreferrer\">set intersection</a> :</p>\n\n<pre><code>sentence  = \"hello everyone in the house\"\nwhitelist = %w(hello world new-york place)\n\nfound_words = sentence.split &amp; whitelist\np found_words        # =&gt; [\"hello\"]\np found_words.empty? # =&gt; false\n</code></pre>\n\n<p><strong>WARNING :</strong> It only works if the whitelist doesn't contain any string with multiple words. e.g. <code>new york</code> in the original question.</p>\n\n<p>For a more robust solution, see @spickermann's answer.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1482886526, "post_id": 41353241, "comment_id": 69910014, "body": "Try putting &quot;helllo&quot; at the end of <code>a</code> to see how that affects the results. As it is, @spickerman&#39;s method bails after processing &quot;hello&quot;, whereas the others keep going."}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1482887376, "post_id": 41353241, "comment_id": 69910143, "body": "You compile <code>N</code> regular expressions, move the <code>Regexp.union</code> out of the loop and it might be fastest."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1482901591, "post_id": 41353241, "comment_id": 69913003, "body": "I am not surprised by this outcome. Building regexp and starting the &quot;regexp engine&quot; is extremely expensive compared to simple string operations and string comparisons. It is only worth it for simple use cases like this, the longer the texts, the more complex the condition or the more often you reuse the same regexp the more a regexp pays off."}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1482880161, "last_edit_date": 1482880161, "creation_date": 1482879516, "answer_id": 41353241, "question_id": 41352497, "link": "https://stackoverflow.com/questions/41352497/passing-string-as-a-condition-of-a-method-in-ruby/41353241#41353241", "title": "passing string as a condition of a method in ruby", "body": "<p>Did some benchmarking to test the speed and to my surprise the first solution of spickerman is the fastest by far in MRI Ruby 2.3.0 on a windows box, followed by intersection while my own solution with Regexp.union ends up last :(</p>\n\n<pre><code>require 'benchmark' \n\ns = \"hello everyone in the house\"\na = ['hello', 'world', 'new york', 'place']\n\nN = 10_000\n\nBenchmark.bmbm do |x| \n  x.report(\"Union         \") { N.times { s.match(Regexp.union(a)) }}\n  x.report(\"Union and scan\") { N.times { s.scan(Regexp.union(a)) }}\n  x.report(\"Interpollation\") { N.times { s.match(/#{a.join('|')}/)}}\n  x.report(\"intersect     \") { N.times { s.split &amp; a }}\n  x.report(\"block         \") { N.times { a.any? { |word| s.include?(word)}}}\nend \n\nRehearsal --------------------------------------------------\nUnion            0.110000   0.000000   0.110000 (  0.116051)\nUnion and scan   0.124000   0.000000   0.124000 (  0.121038)\nInterpollation   0.110000   0.000000   0.110000 (  0.105943)\nintersect        0.015000   0.000000   0.015000 (  0.018456)\nblock            0.000000   0.000000   0.000000 (  0.001908)\n----------------------------------------- total: 0.359000sec\n\n                     user     system      total        real\nUnion            0.109000   0.000000   0.109000 (  0.111704)\nUnion and scan   0.125000   0.000000   0.125000 (  0.119122)\nInterpollation   0.109000   0.000000   0.109000 (  0.105288)\nintersect        0.016000   0.000000   0.016000 (  0.017283)\nblock            0.000000   0.000000   0.000000 (  0.001764)\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 5970657, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6c262d316a232bfbc12892f8dc8fb7fe?s=128&d=identicon&r=PG&f=1", "display_name": "Fatin Cooper", "link": "https://stackoverflow.com/users/5970657/fatin-cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 41352544, "answer_count": 3, "score": 3, "last_activity_date": 1482918369, "creation_date": 1482874553, "question_id": 41352497, "link": "https://stackoverflow.com/questions/41352497/passing-string-as-a-condition-of-a-method-in-ruby", "title": "passing string as a condition of a method in ruby", "body": "<p>Is there a way to create a condition through string manipulation. here is the code where I attempted to pass a string as a condition into <strong>include?</strong> method.</p>\n\n<pre><code>\"hello eveyone in the house\".include?(%w('hello' 'world' 'new\\ york'    'place').join(\" || \").to_s)\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "database-design", "query-optimization"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1482873851, "post_id": 41352287, "comment_id": 69906606, "body": "Why are cause and effect not related (e.g. a casue has many effects)? this would make the logic much easier just pull a cause and then determine duration to its effects. e.g a butterflies wings might be the cause and the effect might be a tsunami but I doubt the effect would be a nuclear explosion. Right now the disparate relationship of cause to effect may have nothing to do with one another based on your question. What if an effect took months to occur from a cause? Right now you are attributing that effect to the newest cause not the appropriate one"}, {"owner": {"reputation": 31022, "user_id": 1141918, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JU2sZ.png?s=128&g=1", "display_name": "emersonthis", "link": "https://stackoverflow.com/users/1141918/emersonthis"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1482875437, "post_id": 41352287, "comment_id": 69907132, "body": "@engineersmnky The models I described in the question are simplified. The relationship between the real-lief models is more ambiguous. I probably <i>could</i> do as you say and associate them directly with one-another... but it&#39;s not so clear in real-life which one actually relates to another. My real example is more like this: Model 1 = Beer. Model 2 = Urination. Drinking beer is definitely correlated with urination. But it feels awkward for the Beer model to hasOne Urination. Nevertheless, I want to show ave time after drinking beer until urinating. Does this help?"}, {"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1482923691, "post_id": 41352287, "comment_id": 69922962, "body": "if you are afraid of data sets grow maybe you should do calculations in DB. Modern DBs designed for this."}, {"owner": {"reputation": 31022, "user_id": 1141918, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JU2sZ.png?s=128&g=1", "display_name": "emersonthis", "link": "https://stackoverflow.com/users/1141918/emersonthis"}, "reply_to_user": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1482976436, "post_id": 41352287, "comment_id": 69946036, "body": "@sig Can you clarify what you mean? I&#39;m not afraid of the data growth. I&#39;m looking for an efficient way to calculate."}, {"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483000815, "post_id": 41352287, "comment_id": 69953522, "body": "i meant that u should do all calculations on DB side, with sql"}, {"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483001054, "post_id": 41352287, "comment_id": 69953659, "body": "in that case you dont need to return dataset to ruby and do some manipulations. Calculate all you need with sql and return result of calculations to your rails app."}, {"owner": {"reputation": 31022, "user_id": 1141918, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JU2sZ.png?s=128&g=1", "display_name": "emersonthis", "link": "https://stackoverflow.com/users/1141918/emersonthis"}, "reply_to_user": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483031821, "post_id": 41352287, "comment_id": 69970719, "body": "@sig I&#39;m totally open to this approach. But I don&#39;t know how to match each cause with each effect using SQL"}, {"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483085226, "post_id": 41352287, "comment_id": 69987467, "body": "can you provide table structure(schema)?"}, {"owner": {"reputation": 31022, "user_id": 1141918, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JU2sZ.png?s=128&g=1", "display_name": "emersonthis", "link": "https://stackoverflow.com/users/1141918/emersonthis"}, "reply_to_user": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483108718, "post_id": 41352287, "comment_id": 69997702, "body": "@sig For the purposes of this question you can assume that each table has only 3 columns: updated_at (timestamp), created_at (timestamp) and user_id (foreign key). The average I&#39;m calculating is for specific users."}, {"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483137276, "post_id": 41352287, "comment_id": 70009586, "body": "i can assume a lot of sings... but question will become more abstract. For me its looks quiet simple. One sql query, smtn like: select causes limit n join effects return average(effect.time - cause.time). All calculations will be done on database side, so you dont need to return dataset from DB to ruby and create a lot of ruby objects after, and you dont need to write any ruby&#39;s logic. Also aggregation in DB is more faster than in ruby."}, {"owner": {"reputation": 31022, "user_id": 1141918, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JU2sZ.png?s=128&g=1", "display_name": "emersonthis", "link": "https://stackoverflow.com/users/1141918/emersonthis"}, "reply_to_user": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483178297, "post_id": 41352287, "comment_id": 70017443, "body": "@sig the &quot;assumption&quot; about the columns exactly matches my schema. I have one other column that specifics the <code>type</code> of the cause / effect. I omitted it so as to keep the example minimal. Will your SQL query return the same results as the ActiveRecord version suggested below? <code>effect.time - cause.time</code> looks like it&#39;s calculating something slightly different..."}, {"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483178927, "post_id": 41352287, "comment_id": 70017597, "body": "its not a query, its a &quot;query plan&quot;"}, {"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483182118, "post_id": 41352287, "comment_id": 70018269, "body": "assume that such a query can be written ;)"}, {"owner": {"reputation": 31022, "user_id": 1141918, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JU2sZ.png?s=128&g=1", "display_name": "emersonthis", "link": "https://stackoverflow.com/users/1141918/emersonthis"}, "reply_to_user": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483187469, "post_id": 41352287, "comment_id": 70019488, "body": "@sig ok great. Can you submit an answer showing how to do it? In case it isn&#39;t clear, this is exactly what I want to do. I just don&#39;t know how to do it with SQL. Specifically the part &quot;effect.time - cause.time&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483137531, "post_id": 41403441, "comment_id": 70009674, "body": "ActiveRecord is slow"}, {"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483138708, "post_id": 41403441, "comment_id": 70010042, "body": "btw its can be one-to-many or many-to-many. Its not described in question"}, {"owner": {"reputation": 667, "user_id": 6141597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d52107448cce3dc1010f66ceb534270?s=128&d=identicon&r=PG&f=1", "display_name": "abax", "link": "https://stackoverflow.com/users/6141597/abax"}, "reply_to_user": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1483150850, "post_id": 41403441, "comment_id": 70012664, "body": "@sig, I agree, just made an assumption there"}], "tags": [], "owner": {"reputation": 667, "user_id": 6141597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d52107448cce3dc1010f66ceb534270?s=128&d=identicon&r=PG&f=1", "display_name": "abax", "link": "https://stackoverflow.com/users/6141597/abax"}, "is_accepted": false, "score": 0, "last_activity_date": 1483136746, "creation_date": 1483136746, "answer_id": 41403441, "question_id": 41352287, "link": "https://stackoverflow.com/questions/41352287/how-to-efficiently-calculate-average-time-between-events-in-two-tables/41403441#41403441", "title": "How to efficiently calculate average time between events in two tables", "body": "<p>What is being encouraged in the comments is setting up an <a href=\"http://guides.rubyonrails.org/association_basics.html#choosing-between-belongs-to-and-has-one\" rel=\"nofollow noreferrer\">ActiveRecord association</a> between Cause and Effect.</p>\n\n<pre><code>class Cause &lt; ActiveRecord::Base\n  has_one :effect\nend\n\nclass Effect &lt; ActiveRecord::Base\n  belongs_to :cause\nend\n</code></pre>\n\n<p>Then you can do things like:</p>\n\n<pre><code>beer = Cause.first\nbeer.effect\n# =&gt; Urination\n</code></pre>\n\n<p>and rework Cause:</p>\n\n<pre><code>class Cause &lt; ActiveRecord::Base\n  has_one :effect\n\n  def time_til_effect # instance method\n    self.effect.created_at - self.created_at\n  end\nend\n\nbeer.time_til_effect\n# =&gt; 30 minutes\n</code></pre>\n\n<p>You could then add a class method to Cause which will return the average time across all instances of Cause:</p>\n\n<pre><code>def self.average_time_til_effect # class method\n  cause_effect_times = Cause.all.map { |cause| cause.time_til_effect }\n  cause_effect_times.inject(:+) / cause_effect_times.length\nend\n</code></pre>\n\n<p>You could go further by adding a parameter to the class method limiting its scope to the latest (x) Causes.</p>\n\n<p>After saying all of that, I think the biggest takeaway is going to be checking out all of the ActiveRecord associations, they are really powerful and provide a ton of utility. </p>\n"}], "owner": {"reputation": 31022, "user_id": 1141918, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JU2sZ.png?s=128&g=1", "display_name": "emersonthis", "link": "https://stackoverflow.com/users/1141918/emersonthis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1483465644, "creation_date": 1482873161, "last_edit_date": 1483465644, "question_id": 41352287, "link": "https://stackoverflow.com/questions/41352287/how-to-efficiently-calculate-average-time-between-events-in-two-tables", "title": "How to efficiently calculate average time between events in two tables", "body": "<p>I have two tables/models:</p>\n\n<ul>\n<li>causes</li>\n<li>effects</li>\n</ul>\n\n<p>Both have timestamps from when they were created.</p>\n\n<p>I want to show: \"Average time after cause until effect\"</p>\n\n<p>To do this by hand, I would look at the last 10-20 Effect records, and then for each I would look for the newest Cause record that is older then the given Effect. I would then average the time difference of each.</p>\n\n<p><strong>What is the most elegant way to calculate this programmatically?</strong></p>\n\n<p>I'm worried that as the data set grows, this could become very expensive to calculate if I don't set it up in a smart way. </p>\n\n<p>In case it's relevant, I'm using Ruby 2.x + Rails 4.2 + MySQL/SqLite3 but an acceptable answer can be general / pseudo-code. In other words, I don't need you to write the query for me. Just help me figure out the smartest design pattern.</p>\n\n<p><strong>Update</strong></p>\n\n<p>I'm working on an approach inspired by the comments and the first answer...</p>\n\n<p>I'm adding a <code>last_cause</code> column to the Effect table that contains the ID of the most recent Cause.</p>\n"}, {"tags": ["ruby", "algorithm", "big-o"], "comments": [{"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 1, "creation_date": 1482872391, "post_id": 41352130, "comment_id": 69906047, "body": "That wouldn&#39;t be O(n^2) it would be O(4n) but as coefficients are ignored this is O(n). This isn&#39;t a particularly bad algorithm. Array subtraction in ruby is O(2n) to the best of my belief."}, {"owner": {"reputation": 901, "user_id": 3007294, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc770b97c7c648be73003e9435424bac?s=128&d=identicon&r=PG&f=1", "display_name": "user3007294", "link": "https://stackoverflow.com/users/3007294/user3007294"}, "reply_to_user": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1482872587, "post_id": 41352130, "comment_id": 69906119, "body": "Thanks Eli! I believe O(1) and O(log n) are would be better than this? I don&#39;t think there&#39;s a way to incorporate that into this though?"}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 1, "creation_date": 1482872732, "post_id": 41352130, "comment_id": 69906176, "body": "It is more accurate to describe the complexity in terms of two variables, since the complexity is dependent on the length of two independent arrays. The source code for set difference (from the <a href=\"https://ruby-doc.org/core-2.3.0/Array.html\" rel=\"nofollow noreferrer\">Ruby 2.3 docs</a>) appears to show that the difference operation is O(mn)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1482873113, "post_id": 41352130, "comment_id": 69906333, "body": "Your method is fine provided you consider <code>[1,1,2]</code> and <code>[1,2]</code> to contain the same elements. If so, just make the body of the method <code>array_one - array_two).empty? &amp;&amp; (array_two - array_one).empty?</code>, which, being the last statement executed, will return <code>true</code> or <code>false</code>. btw, &quot;lackluster&quot; (or &quot;lacklustre&quot;) is one word."}, {"owner": {"reputation": 901, "user_id": 3007294, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc770b97c7c648be73003e9435424bac?s=128&d=identicon&r=PG&f=1", "display_name": "user3007294", "link": "https://stackoverflow.com/users/3007294/user3007294"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1482874137, "post_id": 41352130, "comment_id": 69906699, "body": "@CarySwoveland thanks for the info!"}, {"owner": {"reputation": 901, "user_id": 3007294, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc770b97c7c648be73003e9435424bac?s=128&d=identicon&r=PG&f=1", "display_name": "user3007294", "link": "https://stackoverflow.com/users/3007294/user3007294"}, "reply_to_user": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1482874192, "post_id": 41352130, "comment_id": 69906717, "body": "Also, thanks @JoelCornett for the O(mn) reference!"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1482875262, "post_id": 41352130, "comment_id": 69907072, "body": "You could solve this other ways such as <code>[one,two].map(&amp;:uniq).sort_by(&amp;:size).reverse.reduce(:-).emp&zwnj;&#8203;ty?</code> or <code>((one &amp; two).uniq - one).empty?</code> but your solution is definitely sufficient"}], "answers": [{"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482881074, "post_id": 41352674, "comment_id": 69908876, "body": "This is wrong, and the algorithm appears to be much faster than O(mn)"}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1482881930, "post_id": 41352674, "comment_id": 69909117, "body": "Yes, it appears I was wrong. <code>O(m+n)</code> might be a better guess, but @EricDuminil has the right idea by using profiling for verification. I assume that <code>ary_make_hash(...)</code> is O(n) and that <code>st_lookup(...)</code> and <code>rb_ary_push(...)</code> are both O(1)."}, {"owner": {"reputation": 3448, "user_id": 138040, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd38ac80d6691eeff461df116da204d4?s=128&d=identicon&r=PG", "display_name": "PetrosB", "link": "https://stackoverflow.com/users/138040/petrosb"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482914634, "post_id": 41352674, "comment_id": 69918089, "body": "@EricDuminil The algorithm appears to be faster because on average hash search is O(1) but its (worst case) complexity is still O(n). As an exercise you can look into the hash function code and try to find an example where the running time will increase polynomially."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482926043, "post_id": 41352674, "comment_id": 69924228, "body": "@PetrosB: The burden of proof is on you. Please don&#39;t just leave it as an exercise."}, {"owner": {"reputation": 3448, "user_id": 138040, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd38ac80d6691eeff461df116da204d4?s=128&d=identicon&r=PG", "display_name": "PetrosB", "link": "https://stackoverflow.com/users/138040/petrosb"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482927002, "post_id": 41352674, "comment_id": 69924786, "body": "@EricDuminil I don&#39;t need to prove anything. I&#39;m just saying that your example is naive enough to be a proof on its own. You reminded me of a teapot: <a href=\"https://en.wikipedia.org/wiki/Russell&#39;s_teapot\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Russell&#39;s_teapot</a>"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482927074, "post_id": 41352674, "comment_id": 69924835, "body": "You&#39;re sitting on the wrong side of this argument ;)"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482932053, "post_id": 41352674, "comment_id": 69927557, "body": "The confusion comes from &quot;This operation in general takes O(n) time&quot;. This sentence is wrong IMHO. Your edit is better, but contradicts the 1st paragraph."}, {"owner": {"reputation": 3448, "user_id": 138040, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd38ac80d6691eeff461df116da204d4?s=128&d=identicon&r=PG", "display_name": "PetrosB", "link": "https://stackoverflow.com/users/138040/petrosb"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482935559, "post_id": 41352674, "comment_id": 69929532, "body": "@EricDuminil I&#39;m sorry but I can&#39;t do anything else to convince you if you don&#39;t want to."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482937152, "post_id": 41352674, "comment_id": 69930448, "body": "Can&#39;t we just agree on &quot;hash lookup is O(1) on average with a (very rare) worst case of O(n)&quot;?"}], "tags": [], "owner": {"reputation": 3448, "user_id": 138040, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd38ac80d6691eeff461df116da204d4?s=128&d=identicon&r=PG", "display_name": "PetrosB", "link": "https://stackoverflow.com/users/138040/petrosb"}, "is_accepted": false, "score": 3, "last_activity_date": 1488926177, "last_edit_date": 1488926177, "creation_date": 1482875822, "answer_id": 41352674, "question_id": 41352130, "link": "https://stackoverflow.com/questions/41352130/how-to-determine-big-o-comparing-two-arrays-in-ruby/41352674#41352674", "title": "How to determine Big O comparing two arrays in Ruby", "body": "<p>Let the size of first and second array be m and n respectively. Looking at <code>rb_ary_diff</code>'s source code (see Joel Cornett's comment above), there's a <code>for</code> loop which runs O(m) times. Inside the loop there's a call that seems to search the hash. This operation in general takes O(n) time. Thus, assuming that all other calls are asymptotically faster than O(mn), then the overall difference function complexity is O(mn). Calling this function twice followed by an emptyness check results in your algorithm being O(mn).</p>\n\n<p>On average hash search is constant, i.e., O(1), which means that in this case your algorithm performs in O(n). Still, hash search worst case complexity is O(n) meaning your algorithm is O(mn). It's a good exercise to find an example which demonstrates this.</p>\n"}, {"comments": [{"owner": {"reputation": 901, "user_id": 3007294, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc770b97c7c648be73003e9435424bac?s=128&d=identicon&r=PG&f=1", "display_name": "user3007294", "link": "https://stackoverflow.com/users/3007294/user3007294"}, "edited": false, "score": 0, "creation_date": 1482892308, "post_id": 41352766, "comment_id": 69911069, "body": "Thanks so much for the in-depth response Eric! Good call on the refactoring notes as well. This makes a lot more sense now. Appreciate it!"}, {"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1482895458, "post_id": 41352766, "comment_id": 69911708, "body": "It&#39;s also worthwhile noting, that O(n+m) is linear time. Great explanation on the whole!"}, {"owner": {"reputation": 3448, "user_id": 138040, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd38ac80d6691eeff461df116da204d4?s=128&d=identicon&r=PG", "display_name": "PetrosB", "link": "https://stackoverflow.com/users/138040/petrosb"}, "edited": false, "score": 0, "creation_date": 1482915658, "post_id": 41352766, "comment_id": 69918609, "body": "Your benchmark is not complete because it does not include cases where the worst case scenario is exhibited. Can you please built one such case? That would be very interesting and maybe difficult. But this difficulty does not rule out the possibility that it exists. So no, time complexity is O(mn)."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 3448, "user_id": 138040, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd38ac80d6691eeff461df116da204d4?s=128&d=identicon&r=PG", "display_name": "PetrosB", "link": "https://stackoverflow.com/users/138040/petrosb"}, "edited": false, "score": 0, "creation_date": 1482925984, "post_id": 41352766, "comment_id": 69924186, "body": "@PetrosB This would be surprising. Do you have any reference for your claim? &quot;Chapter 7&quot; of <a href=\"http://patshaughnessy.net/ruby-under-a-microscope\" rel=\"nofollow noreferrer\">patshaughnessy.net/ruby-under-a-microscope</a> deals extensively with hash tables. Hashing entries is O(n), with occasional rehashing when bins become too big. Retrieving a value is O(1). The only slow example in the chapter is with custom Object where hash method is defined to be constant."}, {"owner": {"reputation": 3448, "user_id": 138040, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd38ac80d6691eeff461df116da204d4?s=128&d=identicon&r=PG", "display_name": "PetrosB", "link": "https://stackoverflow.com/users/138040/petrosb"}, "edited": false, "score": 0, "creation_date": 1482926772, "post_id": 41352766, "comment_id": 69924659, "body": "Again, retrieving a value in worst case is O(n). You can google it. Also, the book from the link is closed. It&#39;d be good if you could give something that everyones has access to."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482926962, "post_id": 41352766, "comment_id": 69924765, "body": "&quot;Ruby under a microscope&quot; is the bible for documentation on Ruby internals. Please don&#39;t tell me to use google, and please provide a reference to your claim."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482927007, "post_id": 41352766, "comment_id": 69924789, "body": "See my update. If you don&#39;t disable the hash method, you&#39;ll be fine."}, {"owner": {"reputation": 3448, "user_id": 138040, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd38ac80d6691eeff461df116da204d4?s=128&d=identicon&r=PG", "display_name": "PetrosB", "link": "https://stackoverflow.com/users/138040/petrosb"}, "edited": false, "score": 0, "creation_date": 1482927462, "post_id": 41352766, "comment_id": 69925069, "body": "I think you&#39;re confused. An algorithm&#39;s time complexity has nothing to do with a language&#39;s internals. My reference to you would be one of the numerous undergraduate texts on the subject. And of course, a little bit of willingness."}, {"owner": {"reputation": 3448, "user_id": 138040, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd38ac80d6691eeff461df116da204d4?s=128&d=identicon&r=PG", "display_name": "PetrosB", "link": "https://stackoverflow.com/users/138040/petrosb"}, "edited": false, "score": 0, "creation_date": 1482934387, "post_id": 41352766, "comment_id": 69928899, "body": "No! The question asks for a given algorithm its time complexity and this answer is based on 3 test cases and their actual CPU times as well as on the implementation language&#39;s internal details! This is wrong. We&#39;re talking about big O, thus, the way the language is implemented is completely irrelevant. In any case, since the OP accepts this answer that&#39;s just fine with me."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 7, "last_activity_date": 1482942617, "last_edit_date": 1482942617, "creation_date": 1482876363, "answer_id": 41352766, "question_id": 41352130, "link": "https://stackoverflow.com/questions/41352130/how-to-determine-big-o-comparing-two-arrays-in-ruby/41352766#41352766", "title": "How to determine Big O comparing two arrays in Ruby", "body": "<h1>Short answer</h1>\n\n<p><strong>O(n+m)</strong> on average</p>\n\n<p>The worst case is O(nm), but it only happens if you really want to make it happen (see last paragraph).</p>\n\n<p>If <code>array_one</code> is chosen to be bigger than <code>array_two</code>, O(m+n) is just O(n), so this algorithm runs in linear time on average.</p>\n\n<h1>Alternative</h1>\n\n<p>Another shorter way to check would be :</p>\n\n<pre><code>one = [1, \"taco\", 3, 2, :piece, 4, 5, 5, 5, 5]\ntwo = [:piece, 2, 5, 4, 1, \"taco\", 3]\n\nputs Set[*one] == Set[*two] #=&gt; true\n# or\nputs one.to_set == two.to_set #=&gt; true\n</code></pre>\n\n<h1>Small refactoring</h1>\n\n<pre><code>return true if x\nreturn false\n</code></pre>\n\n<p>is equivalent to just</p>\n\n<pre><code>x\n</code></pre>\n\n<p>So your code can be written :</p>\n\n<pre><code>def same_elements?(array_one, array_two)\n  (array_one - array_two).empty? &amp;&amp; (array_two - array_one).empty?\nend\n</code></pre>\n\n<h1>Benchmark</h1>\n\n<p>I created one array with 1E6 elements, half of which are random numbers between 0 and 199999 (for collisions), the other half being plain Ruby objects.</p>\n\n<p>The other array is just the first one, shuffled randomly.</p>\n\n<pre><code>N = 1_000_000\n\none = (1..N).map{rand &lt; 0.5 ? rand(N/5) : Object.new}\ntwo = one.sort_by{rand}\n</code></pre>\n\n<p>It takes 1 min to compare the sets, and <a href=\"https://github.com/marcandre/fruity\" rel=\"nofollow noreferrer\">fruity</a> reports that set comparison is about 20% faster than the OP's method.</p>\n\n<p>For smaller arrays of integers, the OP's method was a bit faster.</p>\n\n<p>Note: code proposed by @engineersmnky in comments was reported to have similar speed than the other methods.</p>\n\n<h1>Time complexity</h1>\n\n<p>Your code is surely <em>not</em> <code>O(nm)</code> when used with usual Arrays.</p>\n\n<p>Approximate times are :</p>\n\n<ul>\n<li>1s for 1E4</li>\n<li>8s for 1E5</li>\n<li>160s for 1E6</li>\n</ul>\n\n<p>Looking at <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-2D\" rel=\"nofollow noreferrer\"><code>rb_ary_diff</code></a> in <code>array.c</code>, it's no wonder all the methods described above run in the same time : they basically work the same.</p>\n\n<p><code>rb_ary_diff</code> creates a hash table for <code>array_two</code> ( in O(m)), and iterates over each element of <code>array_one</code> (in O(n)), looking for the value in the hash table (O(1) on average). The whole operation would be O(n+m) on average.</p>\n\n<p>This <a href=\"http://blog.flatironlabs.com/post/83827497166/ruby-array-set-intersection-a-rails-use-case-and\" rel=\"nofollow noreferrer\">blog post</a> analyses <a href=\"https://ruby-doc.org/core-2.3.3/Array.html#method-i-26\" rel=\"nofollow noreferrer\">set intersection</a>, which is implemented in a very similar way.</p>\n\n<p>Doing it twice doesn't change anything, so the overall time complexity stays O(n+m).</p>\n\n<h1>Looking for O(mn)</h1>\n\n<p>One way to make this algorithm O(mn) is to completely disable the hash method. There's no reason to do so, except to prove that it's a very bad idea.</p>\n\n<p>With 10_000 KeyObjects :</p>\n\n<pre><code>class KeyObject &lt; Object\nend\n</code></pre>\n\n<p>the set comparison takes less than 1 s.</p>\n\n<p>With 10_000 KeyObjects :</p>\n\n<pre><code>class KeyObject &lt; Object\n  def hash\n    1\n  end\nend\n</code></pre>\n\n<p>the set comparison takes more than 14 mins!</p>\n\n<p>The probability that 2 distinct, random Ruby objects have the same hash is about 1E-20. Strictly speaking, the worst case for this algorithm is O(mn), but it will <strong>never</strong> happen if you don't go looking for it. Finding a collision with 2 elements isn't trivial, finding a collision with 1E6 elements is not going to happen by chance.</p>\n"}], "owner": {"reputation": 901, "user_id": 3007294, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc770b97c7c648be73003e9435424bac?s=128&d=identicon&r=PG&f=1", "display_name": "user3007294", "link": "https://stackoverflow.com/users/3007294/user3007294"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1322, "favorite_count": 0, "accepted_answer_id": 41352766, "answer_count": 2, "score": 4, "last_activity_date": 1488926177, "creation_date": 1482872203, "last_edit_date": 1488926151, "question_id": 41352130, "link": "https://stackoverflow.com/questions/41352130/how-to-determine-big-o-comparing-two-arrays-in-ruby", "title": "How to determine Big O comparing two arrays in Ruby", "body": "<p>My algorithm skills are lackluster. I created a method to see if two arrays contain the same elements (duplicates don't matter):</p>\n\n<pre><code>one = [1, \"taco\", 3, 2, :piece, 4, 5, 5, 5, 5]\ntwo = [:piece, 2, 5, 4, 1, \"taco\", 3]\n\ndef same_elements?(array_one, array_two)\n  return true if ( (array_one - array_two).empty? &amp;&amp; (array_two - array_one).empty? )\n  return false\nend\n\nsame_elements?(one, two)\n</code></pre>\n\n<p>This returns true (which is correct). The problem is, I am not sure what the efficiency of this algorithm is. My first guess is O(n^2) since we have to check both a-b and b-a. I know that O(n^2) is pretty terrible. Is there a more efficient way to do this? </p>\n"}, {"tags": ["ruby", "heroku", "deployment", "sinatra"], "answers": [{"comments": [{"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1482885047, "post_id": 41352222, "comment_id": 69909719, "body": "Well, I had already taken gem &#39;dbm&#39; out of my Gemfile. But you gave me an idea. In fact, I was just copying the yaml/dbm dependency from something I found online and didn&#39;t really know why I might need it. So I removed it from task_store.rb and redeployed, and now it works! See <a href=\"http://simple-to-do.herokuapp.com/\" rel=\"nofollow noreferrer\">simple-to-do.herokuapp.com</a>"}], "tags": [], "owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "is_accepted": true, "score": 1, "last_activity_date": 1482872715, "creation_date": 1482872715, "answer_id": 41352222, "question_id": 41351742, "link": "https://stackoverflow.com/questions/41351742/how-can-i-deploy-this-ruby-sinatra-app-to-heroku/41352222#41352222", "title": "How can I deploy this Ruby/Sinatra app to Heroku?", "body": "<p>Remove <code>gem 'dbm'</code> from your Gemfile.</p>\n\n<p>That dbm gem only works with jruby and you don't need it since you are using yaml/dbm.</p>\n"}], "owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 41352222, "answer_count": 1, "score": 0, "last_activity_date": 1482872715, "creation_date": 1482870165, "last_edit_date": 1482872537, "question_id": 41351742, "link": "https://stackoverflow.com/questions/41351742/how-can-i-deploy-this-ruby-sinatra-app-to-heroku", "title": "How can I deploy this Ruby/Sinatra app to Heroku?", "body": "<p>I'm trying to do my <em>very first</em> Ruby/Sinatra deploy (yay!), a <a href=\"https://github.com/SangerGroup/todo\" rel=\"nofollow noreferrer\">\"to do list\" app</a> website to Heroku. The code runs fine in Windows and Ubuntu environments </p>\n\n<p><a href=\"https://i.stack.imgur.com/gRmLh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gRmLh.png\" alt=\"My humble app\"></a></p>\n\n<p>but I'm having trouble actually successfully deploying.</p>\n\n<p>I tried following <a href=\"https://devcenter.heroku.com/articles/getting-started-with-ruby#introduction\" rel=\"nofollow noreferrer\">this tutorial</a> using my own code.  When I execute <code>sudo git push heroku master</code>, I'm told the app is deployed to Heroku, but when I go to the URL it gives, it's not running. I might need help with <a href=\"https://github.com/SangerGroup/todo/blob/master/Procfile\" rel=\"nofollow noreferrer\">my (one-line) Procfile</a>. Also, a \"warning\" (does that mean deployment didn't happen?) says I didn't declare my Ruby version. I tried using <code>rvm 2.2.5</code> and putting <code>gem 'ruby', '2.2.5'</code> in my <a href=\"https://github.com/SangerGroup/todo/blob/master/Gemfile\" rel=\"nofollow noreferrer\">Gemfile</a>, but the bundler won't install if I declare a Ruby version (it says I don't have that version of Ruby installed, which I certainly seem to).</p>\n\n<pre><code>sudo git push heroku master\nCounting objects: 5, done.\nCompressing objects: 100% (4/4), done.\nWriting objects: 100% (5/5), 419 bytes | 0 bytes/s, done.\nTotal 5 (delta 3), reused 1 (delta 0)\nremote: Compressing source files... done.\nremote: Building source:\nremote: \nremote: -----&gt; Ruby app detected\nremote: -----&gt; Compiling Ruby/Rack\nremote: -----&gt; Using Ruby version: ruby-2.2.6\nremote: -----&gt; Installing dependencies using bundler 1.13.6\nremote:        Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin -j4 --deployment\nremote:        Warning: the running version of Bundler (1.13.6) is older than the version that created the lockfile (1.13.7). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\nremote:        Fetching gem metadata from https://rubygems.org/.........\nremote:        Fetching version metadata from https://rubygems.org/.\nremote:        Using diff-lcs 1.2.5\nremote:        Using rack 1.6.5\nremote:        Using rspec-support 3.5.0\nremote:        Using ruby 0.1.0\nremote:        Using tilt 2.0.5\nremote:        Using bundler 1.13.6\nremote:        Using rspec-core 3.5.4\nremote:        Using rspec-expectations 3.5.0\nremote:        Using rspec-mocks 3.5.0\nremote:        Using rack-protection 1.5.3\nremote:        Using sinatra 1.4.7\nremote:        Bundle complete! 7 Gemfile dependencies, 11 gems now installed.\nremote:        Gems in the groups development and test were not installed.\nremote:        Bundled gems are installed into ./vendor/bundle.\nremote:        Bundle completed (1.79s)\nremote:        Cleaning up the bundler cache.\nremote:        Warning: the running version of Bundler (1.13.6) is older than the version that created the lockfile (1.13.7). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\nremote:        Removing dbm (0.5)\nremote: -----&gt; Detecting rake tasks\nremote: \nremote: ###### WARNING:\nremote:        You have not declared a Ruby version in your Gemfile.\nremote:        To set your Ruby version add this line to your Gemfile:\nremote:        ruby '2.2.6'\nremote:        # See https://devcenter.heroku.com/articles/ruby-versions for more information.\nremote: \nremote: -----&gt; Discovering process types\nremote:        Procfile declares types     -&gt; web\nremote:        Default types for buildpack -&gt; console, rake\nremote: \nremote: -----&gt; Compressing...\nremote:        Done: 17.3M\nremote: -----&gt; Launching...\nremote:        Released v5\nremote:        https://gentle-sea-73583.herokuapp.com/ deployed to Heroku\nremote: \nremote: Verifying deploy... done.\nTo https://git.heroku.com/gentle-sea-73583.git\n   995b763..014acd8  master -&gt; master\n</code></pre>\n\n<p>I also tried executing <code>sudo heroku run ruby todo.rb</code> (<a href=\"https://github.com/SangerGroup/todo/blob/master/todo.rb\" rel=\"nofollow noreferrer\"><code>todo.rb</code></a> is my server app), and I get this:</p>\n\n<pre><code>sudo heroku run ruby todo.rb\nRunning ruby todo.rb on \u2b22 gentle-sea-73583... up, run.3103 (Free)\n/app/vendor/ruby-2.2.6/lib/ruby/2.2.0/yaml/dbm.rb:2:in `require': cannot load such file -- dbm (LoadError)\n    from /app/vendor/ruby-2.2.6/lib/ruby/2.2.0/yaml/dbm.rb:2:in `&lt;top (required)&gt;'\n    from /app/lib/task_store.rb:2:in `require'\n    from /app/lib/task_store.rb:2:in `&lt;top (required)&gt;'\n    from todo.rb:7:in `require'\n    from todo.rb:7:in `&lt;main&gt;'\n</code></pre>\n\n<p>Maybe I need to set up YAML on Heroku somehow? I don't see how though...</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "nginx", "unicorn"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1482868324, "post_id": 41351171, "comment_id": 69904348, "body": "I think this is off-topic for Stack Overflow and would fit better on <a href=\"https://superuser.com/\">superuser.com</a>"}, {"owner": {"reputation": 2682, "user_id": 4072843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tKkUM.jpg?s=128&g=1", "display_name": "Castaglia", "link": "https://stackoverflow.com/users/4072843/castaglia"}, "edited": false, "score": 0, "creation_date": 1482881694, "post_id": 41351171, "comment_id": 69909047, "body": "Where, exactly, are you setting <code>client_max_body_size</code>?  Per <a href=\"http://stackoverflow.com/questions/36781508/still-getting-413-request-entity-too-large-even-after-client-max-body-size-100m\">this StackOverflow post</a>, it could be that that settings needs to appear in <i>other</i> <code>nginx</code> config files."}, {"owner": {"reputation": 510, "user_id": 6412088, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/1770376769864611/picture?type=large", "display_name": "Andrey Drozdov", "link": "https://stackoverflow.com/users/6412088/andrey-drozdov"}, "edited": false, "score": 0, "creation_date": 1482928371, "post_id": 41351171, "comment_id": 69925583, "body": "<code>server { client_max_body_size 20m; }</code>. File is located in <code>&#47;etc&#47;nginx&#47;sites-available&#47;my_site</code> (it&#39;s included in main nginx settings file)"}], "owner": {"reputation": 510, "user_id": 6412088, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/1770376769864611/picture?type=large", "display_name": "Andrey Drozdov", "link": "https://stackoverflow.com/users/6412088/andrey-drozdov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482879793, "creation_date": 1482867416, "last_edit_date": 1482879793, "question_id": 41351171, "link": "https://stackoverflow.com/questions/41351171/nginx-unicorn-entity-is-to-large", "title": "nginx + unicorn Entity is to large", "body": "<p>On my test server I have nginx + unicorn set up. And nginx <code>client_max_body_size</code> is set to <code>20M</code>. But she user uploads file more then 1mb it return error <code>413 Entity is too large. nginx</code>. </p>\n\n<p>So, I don't quite understand what make this problem?</p>\n\n<p>Is there any possibly to unicorn limit upload?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I'am getting 500 error when user send POST method request (specifically large).</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 3, "creation_date": 1482866047, "post_id": 41350802, "comment_id": 69903452, "body": "<code>profile_path</code> is a method"}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1482866705, "post_id": 41350802, "comment_id": 69903703, "body": "<a href=\"http://guides.rubyonrails.org/routing.html#path-and-url-helpers\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/routing.html#path-and-url-helpers</a>"}, {"owner": {"reputation": 5358, "user_id": 2399861, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5fbe887e0a643cd477ba3f14fa528f84?s=128&d=identicon&r=PG", "display_name": "Ruby Racer", "link": "https://stackoverflow.com/users/2399861/ruby-racer"}, "edited": false, "score": 0, "creation_date": 1482867438, "post_id": 41350802, "comment_id": 69904001, "body": "Don&#39;t confuse profiles with profile"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1482867692, "post_id": 41350802, "comment_id": 69904104, "body": "more importantly why do you think <code>profile_path</code> is a variable set to a string? Where did this idea come from?"}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1482867540, "creation_date": 1482867540, "answer_id": 41351200, "question_id": 41350802, "link": "https://stackoverflow.com/questions/41350802/how-does-rails-profile-path-in-link-to-accept-an-argument-even-though-its-a-s/41351200#41351200", "title": "How does Rails&#39; profile_path in #link_to accept an argument even though it&#39;s a string?", "body": "<p><code>profile_path</code> isn't just a variable set to a string. </p>\n\n<p><code>profile_path</code> is a <a href=\"http://guides.rubyonrails.org/routing.html#path-and-url-helpers\" rel=\"nofollow noreferrer\">path helper <em>method</em></a> that accepts arguments and returns a string.</p>\n"}], "owner": {"reputation": 7599, "user_id": 6730305, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/g0QG2.jpg?s=128&g=1", "display_name": "stackjlei", "link": "https://stackoverflow.com/users/6730305/stackjlei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482867540, "creation_date": 1482865637, "question_id": 41350802, "link": "https://stackoverflow.com/questions/41350802/how-does-rails-profile-path-in-link-to-accept-an-argument-even-though-its-a-s", "title": "How does Rails&#39; profile_path in #link_to accept an argument even though it&#39;s a string?", "body": "<p>From the <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to\" rel=\"nofollow noreferrer\">docs</a>, If <code>profile_path</code> is just a variable that = the string <code>\"/profiles/\"</code> how can it accept an argument like <code>@profile</code>? Is this part of Rails magic?</p>\n\n<pre><code>link_to \"Profile\", profile_path(@profile)\n# =&gt; &lt;a href=\"/profiles/1\"&gt;Profile&lt;/a&gt;\n</code></pre>\n"}, {"tags": ["ruby", "azure", "templates", "ruby-on-rails-5", "postmark"], "answers": [{"comments": [{"owner": {"reputation": 3680, "user_id": 667599, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ada89120dd5904b53d9acfcfdad90ab0?s=128&d=identicon&r=PG", "display_name": "Throoze", "link": "https://stackoverflow.com/users/667599/throoze"}, "edited": false, "score": 0, "creation_date": 1482868951, "post_id": 41351331, "comment_id": 69904620, "body": "I&#39;m sorry, but this is not the case, especially because I have two templates: one that finishes in <code>html.erb</code> and the other in <code>text.erb</code>. This is normal when it comes to mailer templates. For now, my workaround is including <code>ActionView::Helpers::AssetTagHelper</code> in the controller, loading the file in a <code>File</code> instance, reading it and passing it to <code>ERB</code> as explained in <a href=\"http://stackoverflow.com/a/14351129/667599\">this answer</a>. Anyways, thanks for your help :)."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1482868158, "last_edit_date": 1495542289, "creation_date": 1482868158, "answer_id": 41351331, "question_id": 41350673, "link": "https://stackoverflow.com/questions/41350673/add-support-for-rendering-views-to-a-rails-api-only-application/41351331#41351331", "title": "Add support for rendering views to a rails api only application", "body": "<p>Looking at the docs for <code>render_to_string</code>, it looks like the path doesn't need to include <code>.html.erb</code>, so maybe removing that will fix it.</p>\n\n<p>You can see <a href=\"https://stackoverflow.com/a/20726120/2981429\">here</a> for some example code:</p>\n\n<p>In your case, it would be:</p>\n\n<pre><code>   render_to_string(\n       partial: '/transfer_mailer/transfer',\n        locals: {\n            :@body =&gt; @body,\n            :@campaign =&gt; @campaign,\n            :@chat =&gt; @chat\n        },\n       layout: false\n    )\n</code></pre>\n\n<p>Also make sure the partial filename  starts with an underscore, even though you don't include it with <code>render_to_string</code> or <code>render</code> calls. </p>\n"}, {"tags": [], "owner": {"reputation": 20467, "user_id": 4989676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP8H6.jpg?s=128&g=1", "display_name": "Peter Pan", "link": "https://stackoverflow.com/users/4989676/peter-pan"}, "is_accepted": false, "score": 0, "last_activity_date": 1482917771, "creation_date": 1482917771, "answer_id": 41359194, "question_id": 41350673, "link": "https://stackoverflow.com/questions/41350673/add-support-for-rendering-views-to-a-rails-api-only-application/41359194#41359194", "title": "Add support for rendering views to a rails api only application", "body": "<p>There is the other way to use <code>render_to_string</code> for resolving your issue. Please see the code below.</p>\n\n<pre><code>@body = XXX\n@campaign = YYY\n@chat = ZZZ\nhtml = render_to_string(\n  file: 'transfer_mailer/transfer.html.erb'\n)\n</code></pre>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 3680, "user_id": 667599, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ada89120dd5904b53d9acfcfdad90ab0?s=128&d=identicon&r=PG", "display_name": "Throoze", "link": "https://stackoverflow.com/users/667599/throoze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1507, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1482917771, "creation_date": 1482865023, "question_id": 41350673, "link": "https://stackoverflow.com/questions/41350673/add-support-for-rendering-views-to-a-rails-api-only-application", "title": "Add support for rendering views to a rails api only application", "body": "<p>I built an api only rails app, but since i'm using a 3rd party email service, I need to be able to render the email template into a string to pass it to the mailing service wrapper gem. So far any attempt to render templates into a string returns an empty string, and i suspect it is because the application is configured to be API only. Ho do I add support to rendering templates into a string?</p>\n\n<p>If this is not the case, please let me know. I'm using postmark mail service. <code>postmark-rails</code> gem, which integrates into standard rails mailers didn't work at all, and plain <code>postmark</code> gem (which uses postmark API instead of postmark SMTP server) works fine, but now my problem is producing the proper html for the email.</p>\n\n<p>this is what I'm trying:</p>\n\n<pre><code>html = render_to_string(\n            partial: \"transfer_mailer/transfer.html.erb\",\n            locals: {\n                :@body =&gt; @body,\n                :@campaign =&gt; @campaign,\n                :@chat =&gt; @chat\n                }\n        )\n</code></pre>\n\n<p>but it returns empty string.</p>\n\n<p>My setup involves <code>Rails 5.0.1</code>, <code>ruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-linux]</code>, <code>Sidekiq 4.2.7</code>, and in production im using <code>nginx/1.10.2</code> and <code>Phusion Passenger 5.1.1</code>. Production environment is deployed in an azure virtual machine, and I added both inbound and outbound rules for allowing traffic through ports 25, 465, 2525, and 587.</p>\n\n<p>Any help would be really appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf", "wkhtmltopdf"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4566774, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52aef73f5327f3862074493086358ec4?s=128&d=identicon&r=PG&f=1", "display_name": "ValeMarz", "link": "https://stackoverflow.com/users/4566774/valemarz"}, "edited": false, "score": 0, "creation_date": 1482924938, "post_id": 41352809, "comment_id": 69923578, "body": "got it. Thank you @arpie!"}], "tags": [], "owner": {"reputation": 301, "user_id": 2544072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1cd13f617f26cfdb405b4fae505b409?s=128&d=identicon&r=PG&f=1", "display_name": "brianarpie", "link": "https://stackoverflow.com/users/2544072/brianarpie"}, "is_accepted": true, "score": 0, "last_activity_date": 1482876620, "creation_date": 1482876620, "answer_id": 41352809, "question_id": 41350424, "link": "https://stackoverflow.com/questions/41350424/bad-wkhtmltopdfs-path-bundler-command-not-found-which/41352809#41352809", "title": "Bad wkhtmltopdf&#39;s path: bundler: command not found: which", "body": "<p>It looks like the wkhtmltopdf gem does not support the Windows operating system. I found this in the source code:</p>\n\n<pre><code>suffix = case RbConfig::CONFIG['host_os']\nwhen /linux/\n  (RbConfig::CONFIG['host_cpu'] == 'x86_64') ? 'linux_amd64' : 'linux_x86'\nwhen /darwin/\n  'darwin_x86'\nelse\n  raise \"Invalid platform. Must be running on linux or intel-based Mac OS.\"\nend\n</code></pre>\n\n<p>The other hint is the fact you received: <code>command not found: which</code>. <code>which</code> is a Unix command to identify the location of executables, not available for Windows. Sorry</p>\n"}, {"comments": [{"owner": {"reputation": 2050, "user_id": 5695646, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-nEigl1xsDV4/AAAAAAAAAAI/AAAAAAAAANE/WGykpWYiogM/photo.jpg?sz=128", "display_name": "Yshmarov", "link": "https://stackoverflow.com/users/5695646/yshmarov"}, "edited": false, "score": 0, "creation_date": 1575174731, "post_id": 45597932, "comment_id": 104474493, "body": "how about suggesting a more generic answer, than a path on your PC?"}], "tags": [], "owner": {"reputation": 327, "user_id": 7974208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Y3GJNTwk_es/AAAAAAAAAAI/AAAAAAAAARg/J0AdlD1l2RY/photo.jpg?sz=128", "display_name": "Abdul Wahed", "link": "https://stackoverflow.com/users/7974208/abdul-wahed"}, "is_accepted": false, "score": 0, "last_activity_date": 1502302548, "creation_date": 1502302548, "answer_id": 45597932, "question_id": 41350424, "link": "https://stackoverflow.com/questions/41350424/bad-wkhtmltopdfs-path-bundler-command-not-found-which/45597932#45597932", "title": "Bad wkhtmltopdf&#39;s path: bundler: command not found: which", "body": "<p>this worked for me</p>\n\n<pre><code>exe_path: 'C://Program Files/wkhtmltopdf/bin/wkhtmltopdf.exe'\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4566774, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52aef73f5327f3862074493086358ec4?s=128&d=identicon&r=PG&f=1", "display_name": "ValeMarz", "link": "https://stackoverflow.com/users/4566774/valemarz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 0, "accepted_answer_id": 41352809, "answer_count": 2, "score": 0, "last_activity_date": 1594146543, "creation_date": 1482863780, "last_edit_date": 1594146543, "question_id": 41350424, "link": "https://stackoverflow.com/questions/41350424/bad-wkhtmltopdfs-path-bundler-command-not-found-which", "title": "Bad wkhtmltopdf&#39;s path: bundler: command not found: which", "body": "<p>I'm using the wkhtmltopdf gem in Rails on Windows but it does not work. I get this error:\n&quot;Bad wkhtmltopdf's path: bundler: command not found: which&quot;.\nIt works with exe but i don't want use exe_path, i just want to use the gem.\nThis is my wkhtmltopdf config file:</p>\n<pre><code># WickedPDF Global Configuration\n#\n# Use this to set up shared configuration options for your entire application.\n# Any of the configuration options shown here can also be applied to single\n# models by passing arguments to the `render :pdf` call.\n#\n# To learn more, check out the README:\n#\n# https://github.com/mileszs/wicked_pdf/blob/master/README.md\n\nWickedPdf.config = {\n  # Path to the wkhtmltopdf executable: This usually isn't needed if using\n  # one of the wkhtmltopdf-binary family of gems.\n  # exe_path: 'C:\\Program Files\\wkhtmltopdf\\bin\\wkhtmltopdf.exe'\n  \n}\n</code></pre>\n<p>I'm also using the gem 'wicked_pdf' gem 'wkhtmltopdf-binary'</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1482862917, "post_id": 41350006, "comment_id": 69902116, "body": "You would be better off pulling out this search functionality into its own class, say <code>StudentSuperSearch</code>, then its validity could be a flag on the instance itself (e.g. <code>@student_search = StudentSuperSearch.new(params[:super_search]); if @student_search.valid? ....</code>)"}, {"owner": {"reputation": 392, "user_id": 6501880, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff5b8edeac79e94ecde386dae8f33398?s=128&d=identicon&r=PG&f=1", "display_name": "MageeWorld", "link": "https://stackoverflow.com/users/6501880/mageeworld"}, "edited": false, "score": 0, "creation_date": 1482863001, "post_id": 41350006, "comment_id": 69902159, "body": "What have you tried regarding your error flag?  You could use a return to send a sprecific setting - you could check the length of @students - if it&#39;s not zero it should have been a valid search?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 392, "user_id": 6501880, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff5b8edeac79e94ecde386dae8f33398?s=128&d=identicon&r=PG&f=1", "display_name": "MageeWorld", "link": "https://stackoverflow.com/users/6501880/mageeworld"}, "edited": false, "score": 0, "creation_date": 1482863413, "post_id": 41350006, "comment_id": 69902364, "body": "@MageeWorld a valid search could return zero results. For example a search for a student named &#39;Zaphod Beeblebrox&#39; would be a valid search by name but probably won&#39;t return any students."}, {"owner": {"reputation": 438, "user_id": 5356066, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fbc5de86d0f92b9fcef669e6337a127d?s=128&d=identicon&r=PG&f=1", "display_name": "ineedahero", "link": "https://stackoverflow.com/users/5356066/ineedahero"}, "edited": false, "score": 0, "creation_date": 1482863471, "post_id": 41350006, "comment_id": 69902391, "body": "Valid searches could return zero students. What I tried doing was just return the string &quot;invalid&quot; when I encounter an invalid search query. It&#39;s a bit odd setting @students equal to the string &quot;invalid&quot;, but it actually seems to work. Not entirely satisfied with this solution, so I&#39;ll continue reading here to see what other ideas there are."}, {"owner": {"reputation": 392, "user_id": 6501880, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff5b8edeac79e94ecde386dae8f33398?s=128&d=identicon&r=PG&f=1", "display_name": "MageeWorld", "link": "https://stackoverflow.com/users/6501880/mageeworld"}, "edited": false, "score": 0, "creation_date": 1482863659, "post_id": 41350006, "comment_id": 69902466, "body": "If there are search criteria that are invalid - you should determine that before performing the search don&#39;t you think?  Determine if valid search criteria has been entered and if not, then render the search page again with the error message? (That&#39;s what I&#39;d do).  How will they know their input was wrong if they aren&#39;t told?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1482863839, "post_id": 41350006, "comment_id": 69902537, "body": "@ineedahero what if any objections did you have to my suggested solution? This will remove the business logic of searching from the model and allow a very flexible way of handling the response to an invalid search"}, {"owner": {"reputation": 2230, "user_id": 6337957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1177d893bf3115edf0119cf56e7220?s=128&d=identicon&r=PG", "display_name": "Greg Navis", "link": "https://stackoverflow.com/users/6337957/greg-navis"}, "edited": false, "score": 1, "creation_date": 1482863902, "post_id": 41350006, "comment_id": 69902562, "body": "I greatly recommend making a model <code>StudentSearch</code> backed by Active Model. You&#39;ll be able to specify validations run prior to executing search (just like Active Record validations before database operations). Please take a look at <a href=\"http://guides.rubyonrails.org/active_model_basics.html\" rel=\"nofollow noreferrer\">The Rails Guides</a> for details."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1482864130, "post_id": 41350463, "comment_id": 69902643, "body": "Maybe a custom error, <code>class SearchError &lt; StandardError;end</code>, just in case some part of the code stack throws an <code>ArgumentError</code> you don&#39;t want this catch to swallow it up"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 1, "last_activity_date": 1482864544, "last_edit_date": 1482864544, "creation_date": 1482863996, "answer_id": 41350463, "question_id": 41350006, "link": "https://stackoverflow.com/questions/41350006/ruby-on-rails-model-tell-controller-that-search-query-was-invalid/41350463#41350463", "title": "Ruby on Rails: Model tell Controller that search query was invalid?", "body": "<p>You could throw an exception in model, and catch it in controller :</p>\n\n<pre><code># controller\n  def search\n    begin\n      @students = Student.super_search(params[:super_search])\n      # check if not empty\n      # paginate\n\n    rescue ArgumentError\n      # set flash error or warning\n      # display expected syntax\n      # redirect back to search\n    end\n  end\n\n# model\n  def self.super_search(super_search)\n    if super_search =~ /MY_SPECIAL_REGEX/\n      # get and return search results\n    else\n      raise ArgumentError, \"Invalid query\"\n    end\n  end\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 5356066, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fbc5de86d0f92b9fcef669e6337a127d?s=128&d=identicon&r=PG&f=1", "display_name": "ineedahero", "link": "https://stackoverflow.com/users/5356066/ineedahero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 41350463, "answer_count": 1, "score": 1, "last_activity_date": 1482864544, "creation_date": 1482861892, "question_id": 41350006, "link": "https://stackoverflow.com/questions/41350006/ruby-on-rails-model-tell-controller-that-search-query-was-invalid", "title": "Ruby on Rails: Model tell Controller that search query was invalid?", "body": "<p>When I get a search query, my model checks to make sure it's in the right format. If it's not, I want, instead of displaying the search results, to display a message saying \"bad search format\". How do I do this?</p>\n\n<p>Controller:</p>\n\n<pre><code>  def search\n    @students = Student.super_search(params[:super_search])\n\n   # if (INVALID_FLAG == true) ???\n   #   make error message...   ???\n     if (@students.present?)\n       @students = @students.paginate(page: params[:page])\n    end\n  end\n</code></pre>\n\n<p>And my model:</p>\n\n<pre><code>  def self.super_search(super_search)\n    if super_search =~ /MY_SPECIAL_REGEX/\n      # get and return search results\n    else\n      # set INVALID_FLAG\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby", "geometry", "geospatial", "rgeo"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482861481, "post_id": 41349388, "comment_id": 69901467, "body": "Interesting, but I have no idea where this could come from. cloning <a href=\"https://github.com/rgeo/rgeo\" rel=\"nofollow noreferrer\">github.com/rgeo/rgeo</a> and using <code>git grep -A5 &quot;overlaps?&quot;</code> doesn&#39;t show much information. Did you try it with another srid?"}, {"owner": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482863107, "post_id": 41349388, "comment_id": 69902214, "body": "@EricDuminil - Just tried it with srid 4326 - same result. Moreover, I would think that if the intersection is a line, then what would mean a touching, not overlapping intersection, no matter what the coordinate space?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482863430, "post_id": 41349388, "comment_id": 69902369, "body": "True. You might have to calculate the intersection and checks manually if the result is empty, a (multi-)point, a (multi-)linestring or a (multi-)polygon."}, {"owner": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482864472, "post_id": 41349388, "comment_id": 69902792, "body": "@EricDuminil Kind of defeats the purpose of using a library"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482864690, "post_id": 41349388, "comment_id": 69902888, "body": "Sure, but if the lib fails..."}, {"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1483541066, "post_id": 41349388, "comment_id": 70138562, "body": "Just out of wonder, what version of Ruby and RGeo are you using?"}, {"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1483541195, "post_id": 41349388, "comment_id": 70138675, "body": "Because using Ruby 2.4.0 and RGeo 0.5.3, <code>RGeo::Geos.factory(:srid =&gt; 3857)</code> itself returns <code>nil</code>, so it seems like there might be some lib errors."}, {"owner": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "reply_to_user": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1483545569, "post_id": 41349388, "comment_id": 70141662, "body": "@EliSadoff Ruby 2.3.0, RGeo 0.5.3. If you&#39;re not able to load the factory it may be that you don&#39;t have the underlying GEOS lib installed. You can check by doing <code>RGeo::Geos.supported?</code>"}], "answers": [{"comments": [{"owner": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "edited": false, "score": 0, "creation_date": 1483215900, "post_id": 41405970, "comment_id": 70026431, "body": "I thought you were on to something, so I redid examples 2-3 with rounded values (see edits above), but unfortunately I&#39;m getting the same results."}], "tags": [], "owner": {"reputation": 130, "user_id": 4979706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DsAYM.png?s=128&g=1", "display_name": "Jadh4v", "link": "https://stackoverflow.com/users/4979706/jadh4v"}, "is_accepted": false, "score": 0, "last_activity_date": 1483165167, "last_edit_date": 1483165167, "creation_date": 1483164831, "answer_id": 41405970, "question_id": 41349388, "link": "https://stackoverflow.com/questions/41349388/problems-with-rgeo-intersection-functions/41405970#41405970", "title": "Problems with RGeo intersection functions", "body": "<p>In the first example, you have provided some floating point numbers for two polygons. What makes you think that they touch and do not overlap? How can you tell? In a generic case, you cannot say in absolute terms (without using tolerances) if two line segments overlap exactly or not. You can provide lines that have rounded coordinates, in which case an argument can be made for the same.</p>\n\n<p>Use of floating-point numbers is a form of discretization of the real number space. This causes inconsistent results when using different algorithms or methods to compute the same result. For example, consider an intersection of three lines in 2D space such that they are supposed to intersect at the same point. Now compute the intersection point, independently, three times using a different pair of lines each time. You are likely to get similar but unequal answers each time.</p>\n\n<p>I haven't used RGeo, but is there a way to adjust tolerances when computing intersection geometries? Try reducing the tolerance value (make that threshold smaller). This will allow the function to compute the geometry without merging points that are too close to each other.</p>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "edited": false, "score": 1, "creation_date": 1483661594, "post_id": 41469455, "comment_id": 70199948, "body": "My pleasure. I love Ruby, GIS and big bounties :)"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 5, "last_activity_date": 1483571271, "last_edit_date": 1495541785, "creation_date": 1483549481, "answer_id": 41469455, "question_id": 41349388, "link": "https://stackoverflow.com/questions/41349388/problems-with-rgeo-intersection-functions/41469455#41469455", "title": "Problems with RGeo intersection functions", "body": "<h1>Short answer</h1>\n\n<p>Unfortunately, it <a href=\"https://stackoverflow.com/a/33900068/6419007\">seems</a> that you cannot expect reliable and correct output from <code>touches?</code> and <code>overlaps?</code> when using Float coordinates.</p>\n\n<p>It doesn't depend on RGeo or GEOS versions (or for that matter, <a href=\"https://en.wikipedia.org/wiki/JTS_Topology_Suite\" rel=\"nofollow noreferrer\">JTS</a>, the project on which GEOS is based).</p>\n\n<p>If you need information about the position of two polygons, you could use <a href=\"http://www.rubydoc.info/github/dazuma/rgeo/RGeo/Feature/Geometry:distance\" rel=\"nofollow noreferrer\"><code>Geometry#distance</code></a> and check that it is smaller than a given epsilon.</p>\n\n<p><a href=\"http://www.rubydoc.info/github/dazuma/rgeo/RGeo/Feature/Geometry#intersection-instance_method\" rel=\"nofollow noreferrer\"><code>Geometry#intersection</code></a> is a bit more reliable than <code>touches?</code> and <code>overlaps?</code>, but it isn't guaranteed to work with every example either.</p>\n\n<hr>\n\n<h1>Is it a precision problem?</h1>\n\n<h3>Theory</h3>\n\n<p><code>touches?</code> is by definition very sensitive : polygons have to share a point or a line on their border, but shouldn't have any common interior points.</p>\n\n<ul>\n<li>If they're too far away from each other, they don't have any point in common, and <code>touches?</code> is false.</li>\n<li>If they're too close, their intersection is a polygon, and <code>touches?</code> is false.</li>\n</ul>\n\n<h3>Sensitivity analysis</h3>\n\n<p>How sensitive is it exactly?</p>\n\n<p>Let's consider two polygons, one just above the other :</p>\n\n<p><a href=\"https://i.stack.imgur.com/BTvNO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BTvNO.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))\nPOLYGON((0 1, 0 2, 1 2, 1 1, 0 1))\n</code></pre>\n\n<p>We could move the lower border of the upper polygon by an epsilon, and see which influence it has :</p>\n\n<pre><code>require 'rgeo'\n\nepsilon = 1E-15\n\ndeltas = [-epsilon, 0, epsilon]\n\ndeltas.each do |delta|\n  puts \"--------------------------------\"\n  puts \"Delta : #{delta}\\n\\n\"\n  simple1 = 'POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))'\n  simple2 = \"POLYGON((0 #{1+delta}, 0 2, 1 2, 1 #{1+delta}, 0 #{1+delta}))\"\n\n  puts \"Polygon #1 : #{simple1}\\n\"\n  puts \"Polygon #2 : #{simple2}\\n\\n\"\n\n  poly_1 = RGeo::Geos.factory(:srid =&gt; 4326).parse_wkt(simple1)\n  poly_2 = RGeo::Geos.factory(:srid =&gt; 4326).parse_wkt(simple2)\n\n  puts \"Intersection : #{poly_1.intersection poly_2}\"\n  puts\n\n  puts \"Distance between polygons :\"\n  puts format('%.30f\u00b0', poly_1.distance(poly_2))\n  puts\n\n  puts \"Overlaps? : #{poly_1.overlaps? poly_2}\"\n  puts \"Touches? : #{poly_1.touches? poly_2}\"\nend\n</code></pre>\n\n<p>It outputs :</p>\n\n<pre><code>--------------------------------\nDelta : -1.0e-15\n\nPolygon #1 : POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))\nPolygon #2 : POLYGON((0 0.999999999999999, 0 2, 1 2, 1 0.999999999999999, 0 0.999999999999999))\n\nIntersection : POLYGON ((0.0 0.999999999999999, 0.0 1.0, 1.0 1.0, 1.0 0.999999999999999, 0.0 0.999999999999999))\n\nDistance between polygons :\n0.000000000000000000000000000000\u00b0\n\nOverlaps? : true\nTouches? : false\n--------------------------------\nDelta : 0\n\nPolygon #1 : POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))\nPolygon #2 : POLYGON((0 1, 0 2, 1 2, 1 1, 0 1))\n\nIntersection : LINESTRING (0.0 1.0, 1.0 1.0)\n\nDistance between polygons :\n0.000000000000000000000000000000\u00b0\n\nOverlaps? : false\nTouches? : true\n--------------------------------\nDelta : 1.0e-15\n\nPolygon #1 : POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))\nPolygon #2 : POLYGON((0 1.000000000000001, 0 2, 1 2, 1 1.000000000000001, 0 1.000000000000001))\n\nIntersection : GEOMETRYCOLLECTION EMPTY\n\nDistance between polygons :\n0.000000000000001110223024625157\u00b0\n\nOverlaps? : false\nTouches? : false\n</code></pre>\n\n<p>Those are well behaved polygons, with</p>\n\n<ul>\n<li>sides parallel to the axes</li>\n<li>same size</li>\n<li>a shared side over the whole length</li>\n</ul>\n\n<p>A difference of <code>1E-15</code> of a degree (about <a href=\"https://en.wikipedia.org/wiki/%C3%85ngstr%C3%B6m\" rel=\"nofollow noreferrer\">1 \u00c5ngstr\u00f6m</a>) is enough to completely change the results, and both <code>overlaps?</code> and <code>touches?</code> switch between <code>true</code> and <code>false</code>.</p>\n\n<p>The intersection is either empty, a line or a polygon, but at least the results seem consistent between <code>intersection</code>, <code>overlaps?</code> and <code>touches?</code>.</p>\n\n<p>In your case, having more complex polygons with tilted sides makes the problem harder. When calculating intersection of two segments, it's hard to maintain 1-\u00c5ngstr\u00f6m accuracy!</p>\n\n<h1>Is it a problem with RGeo?</h1>\n\n<p><a href=\"https://github.com/rgeo/rgeo\" rel=\"nofollow noreferrer\">RGeo</a> uses <a href=\"https://trac.osgeo.org/geos/\" rel=\"nofollow noreferrer\">GEOS</a>, which is a C++ port of <a href=\"https://sourceforge.net/projects/jts-topo-suite/\" rel=\"nofollow noreferrer\">JTS (Java Topology Suite)</a>.</p>\n\n<p>In order to check that the problem isn't specific to RGeo or GEOS, I calculated \nExample 1 with JTS 1.14 :</p>\n\n<pre><code>WKTReader wktReader = new WKTReader();\nString wkt1 = \"POLYGON ((-8226874.27782158 4962626.76394919, -8223358.174520462 4961756.817075645, -8223358.174520462 4960289.557693501, -8224471.369428394 4960289.557693501, -8226874.27782158 4962253.674727506, -8226874.27782158 4962626.76394919))\";\nString wkt2 = \"POLYGON ((-8224757.546680832 4960523.476563589, -8225269.1002275925 4959296.105368667, -8226993.791361805 4959219.668340384, -8226420.900079966 4961883.087589158, -8224757.546680832 4960523.476563589))\";\nPolygon poly1 = (Polygon) wktReader.read(wkt1);\nPolygon poly2 = (Polygon) wktReader.read(wkt2);\nSystem.out.println(\"Intersection : \" + poly1.intersection(poly2));\nSystem.out.println(\"Overlaps?    : \" + poly1.overlaps(poly2));\nSystem.out.println(\"Intersects?  : \" + poly1.intersects(poly2));\nSystem.out.println(\"Touches?     : \" + poly1.touches(poly2));\nshowMatrixWith(poly1, poly2);\n</code></pre>\n\n<p>It outputs :</p>\n\n<pre><code>Intersection : LINESTRING (-8224757.546680832 4960523.476563589, -8225598.074380083 4961210.51680879)\nOverlaps?    : true\nIntersects?  : true\nTouches?     : false\n\n212\n101\n212\n</code></pre>\n\n<p>The intersection is the exact same as in your example, <code>intersects?</code> and <code>touches?</code>\n output the same wrong results as RGeo.</p>\n\n<h1>Why are results inconsistent?</h1>\n\n<p>Why do <code>intersection</code> and <code>touches?</code> return inconsistend results?</p>\n\n<h3>DE-9IM</h3>\n\n<p><code>touches?</code>, <code>intersects?</code>, <code>overlaps?</code> and other predicates are derived from <a href=\"https://en.wikipedia.org/wiki/DE-9IM\" rel=\"nofollow noreferrer\">the Dimensionally Extended nine-Intersection Model (DE-9IM)</a>. It's a matrix describing the dimensions of intersection between interiors, boundaries and exteriors of geometries.</p>\n\n<p>This matrix is calculated on line 72 of <code>src/operation/relate/RelateComputer.cpp</code> in GEOS :</p>\n\n<pre><code>IntersectionMatrix* RelateComputer::computeIM()\n</code></pre>\n\n<p>The algorithm seems to <a href=\"https://stackoverflow.com/a/33900068/6419007\">require exact noding</a>, which isn't the case in any of your examples.</p>\n\n<p>All the tests that I could find for JTS used integers coordinates, even a test called \"complex polygons touching\" :</p>\n\n<pre><code>  # line 477 in jts-1.14/testxml/general/TestFunctionAA.xml\n  &lt;desc&gt;mAmA - complex polygons touching&lt;/desc&gt;\n  &lt;a&gt;\n    MULTIPOLYGON(\n      (\n        (100 200, 100 180, 120 180, 120 200, 100 200)),\n      (\n        (60 240, 60 140, 220 140, 220 160, 160 160, 160 180, 200 180, 200 200, 160 200,\n        160 220, 220 220, 220 240, 60 240),\n        (80 220, 80 160, 140 160, 140 220, 80 220)),\n      (\n        (280 220, 240 180, 260 160, 300 200, 280 220)))\n  &lt;/a&gt;\n  &lt;b&gt;\n    MULTIPOLYGON(\n      (\n        (80 220, 80 160, 140 160, 140 220, 80 220),\n        (100 200, 100 180, 120 180, 120 200, 100 200)),\n      (\n        (220 240, 220 220, 160 220, 160 200, 220 200, 220 180, 160 180, 160 160, 220 160,\n        220 140, 320 140, 320 240, 220 240),\n        (240 220, 240 160, 300 160, 300 220, 240 220)))\n  &lt;/b&gt;\n</code></pre>\n\n<p>There's not a single test case where predicates are calculated for floating-point coordinates.</p>\n\n<p>Note that even though <code>wkt_3</code> and <code>wkt_4</code> have rounded coordinates in your example, calculating their differences create polygons with inexact coordinates : <code>x1</code> of <code>diff_a</code> is <code>-8243077.837796713</code>.</p>\n\n<h3>Geometry#intersection</h3>\n\n<p><code>Geometry#intersection</code> is calculated on line 670 of <code>src/operation/overlay/OverlayOp.cpp</code> in GEOS :</p>\n\n<pre><code>void OverlayOp::computeOverlay(OverlayOp::OpCode opCode)\n</code></pre>\n\n<p>Comments in the code seems to indicate that exact noding isn't required, and there are multiple if statements to check if the results appear correct.</p>\n\n<p>This method seems to be more robust than <code>RelateComputer::computeIM</code>.</p>\n\n<h1>Using GeometryPrecisionReducer?</h1>\n\n<p>With <code>GeometryPrecisionReducer</code> and a <code>PrecisionModel</code>, it becomes possible to specify a grid of allowable points for all Geometries. </p>\n\n<p><code>GeometryPrecisionReducer</code> is implemented in GEOS, but isn't available in RGeo.\nTests in JTS with your first example have shown that it doesn't solve your problem anyway : inexact coordinates are snapped to the closest point on the grid. Every point is moved a bit to the north/south/east or west, which changes the slopes of every side.</p>\n\n<p>It also changes the boundaries and their intersections. Depending on the <code>PrecisionModel</code>, the intersection for your first example could be empty, a line or a polygon.</p>\n"}], "owner": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 1, "accepted_answer_id": 41469455, "answer_count": 2, "score": 4, "last_activity_date": 1483571271, "creation_date": 1482859122, "last_edit_date": 1483545394, "question_id": 41349388, "link": "https://stackoverflow.com/questions/41349388/problems-with-rgeo-intersection-functions", "title": "Problems with RGeo intersection functions", "body": "<p>I'm getting strange/incorrect results from RGeo polygon intersection functions (Ruby 2.3.0, RGeo 0.5.3)</p>\n\n<h2>EXAMPLE 1:</h2>\n\n<p>I have two polygons which I believe share a boundary but do not share any internal space (i.e. they <a href=\"http://postgis.org/docs/ST_Touches.html\" rel=\"nofollow noreferrer\">touch</a> but do not <a href=\"http://postgis.org/docs/ST_Overlaps.html\" rel=\"nofollow noreferrer\">overlap</a>):</p>\n\n<pre><code>wkt_1 = \"POLYGON ((-8226874.27782158 4962626.76394919, -8223358.174520462 4961756.817075645, -8223358.174520462 4960289.557693501, -8224471.369428394 4960289.557693501, -8226874.27782158 4962253.674727506, -8226874.27782158 4962626.76394919))\"\nwkt_2 = \"POLYGON ((-8224757.546680832 4960523.476563589, -8225269.1002275925 4959296.105368667, -8226993.791361805 4959219.668340384, -8226420.900079966 4961883.087589158, -8224757.546680832 4960523.476563589))\"\npoly_1 = RGeo::Geos.factory(:srid =&gt; 3857).parse_wkt(wkt_1)\npoly_2 = RGeo::Geos.factory(:srid =&gt; 3857).parse_wkt(wkt_2)\n</code></pre>\n\n<p>When we check the intersection between them, it returns a line, as expected for geometries sharing only a boundary:</p>\n\n<pre><code>poly_1.intersection poly_2\n=&gt; #&lt;RGeo::Geos::CAPILineStringImpl:0x3fc0249af168 \"LINESTRING (-8224757.546680832 4960523.476563589, -8225598.074380083 4961210.51680879)\"&gt;\n</code></pre>\n\n<p>However, when running the following checks, we get the opposite of what's expected:</p>\n\n<pre><code>poly_1.overlaps? poly_2\n=&gt; true\npoly_1.touches? poly_2\n=&gt; false\n</code></pre>\n\n<h2>EXAMPLE 2:</h2>\n\n<p>We take two legitimately overlapping polygons:</p>\n\n<pre><code>wkt_3 = \"POLYGON ((-8243237.0 4970203.0, -8243237.0 4968735.0, -8242123.0 4968735.0, -8242123.0 4970203.0, -8243237.0 4970203.0))\"\nwkt_4 = \"POLYGON ((-8244765.0 4966076.0, -8244765.0 4964608.0, -8243652.0 4964608.0, -8243652.0 4966076.0, -8242680.0 4969362.0, -8244765.0 4966076.0))\"\npoly_3 = RGeo::Geos.factory(:srid =&gt; 3857).parse_wkt(wkt_3)\npoly_4 = RGeo::Geos.factory(:srid =&gt; 3857).parse_wkt(wkt_4)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/6x9xx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6x9xx.png\" alt=\"enter image description here\"></a></p>\n\n<p>And calculate the differences in both directions:</p>\n\n<pre><code>diff_a = poly_3.difference poly_4\n=&gt; #&lt;RGeo::Geos::CAPIPolygonImpl:0x3fe3fca26028 \"POLYGON ((-8243077.837796713 4968735.0, -8243237.0 4968735.0, -8243237.0 4970203.0, -8242123.0 4970203.0, -8242123.0 4968735.0, -8242865.466828971 4968735.0, -8242680.0 4969362.0, -8243077.837796713 4968735.0))\"&gt;\ndiff_b = poly_4.difference poly_3\n=&gt; #&lt;RGeo::Geos::CAPIPolygonImpl:0x3fe3fd1dda28 \"POLYGON ((-8242865.466828971 4968735.0, -8243652.0 4966076.0, -8243652.0 4964608.0, -8244765.0 4964608.0, -8244765.0 4966076.0, -8243077.837796713 4968735.0, -8242865.466828971 4968735.0))\"&gt;\n</code></pre>\n\n<p>Now we check the remainder polygons against their subtractors:</p>\n\n<pre><code>diff_b.touches? poly_3\n=&gt; true\ndiff_b.overlaps? poly_3\n=&gt; false\n</code></pre>\n\n<p>This is good.</p>\n\n<pre><code>diff_a.touches? poly_4\n=&gt; false\ndiff_a.overlaps? poly_4\n=&gt; true\n</code></pre>\n\n<p>This is IMPOSSIBLE- There's no way the remainder of a polygon subtracted from another should be able to overlap that polygon!</p>\n\n<p>And why is it only happening in one direction?</p>\n\n<h2>EXAMPLE 3:</h2>\n\n<p>The weirdness continues. Let's now get the intersection of poly_3 and poly_4</p>\n\n<pre><code>intersection_a = poly_3.intersection poly_4\n=&gt; #&lt;RGeo::Geos::CAPIPolygonImpl:0x3fd1084ece88 \"POLYGON ((-8242865.724520766 4968734.582337743, -8243078.32501591 4968734.582337743, -8242680.062418439 4969362.301390027, -8242865.724520766 4968734.582337743))\"&gt;\n</code></pre>\n\n<p>Now since this is what should have been subtracted from poly_3 to give us diff_a, diff_a should therefore intersect with intersection_a in exactly the same way as that it intersects with poly_4 (the subtractor). </p>\n\n<p>Except it doesn't:</p>\n\n<pre><code>diff_a.touches? poly_4\n=&gt; false\ndiff_a.touches? intersection_a\n=&gt; true\ndiff_a.intersection poly_4\n=&gt; #&lt;RGeo::Geos::CAPILineStringImpl:0x3fe3f98fb854 \"LINESTRING (-8242680.0 4969362.0, -8243077.837796713 4968735.0)\"&gt;\ndiff_a.intersection intersection_a\n=&gt; #&lt;RGeo::Geos::CAPIMultiLineStringImpl:0x3fe3fca157b4 \"MULTILINESTRING ((-8242865.466828971 4968735.0, -8242680.0 4969362.0), (-8242680.0 4969362.0, -8243077.837796713 4968735.0))\"&gt;\n</code></pre>\n\n<p>Worse, neither of those two intersection results make sense. It should be a single, 2-segmented line, which neither of those are.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482859415, "post_id": 41349339, "comment_id": 69900554, "body": "Maybe <code>&#47;^# section\\s+\\d+.*?(?=^# section\\s+\\d|\\z)&#47;m</code>. Or <code>&#47;^# section\\s*\\d+.*(?:\\R(?!# section\\s+\\d).*)*&#47;</code>"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1483006639, "post_id": 41349339, "comment_id": 69956904, "body": "I think the splitting approaches below should work for you. Please accept the one that works best for you."}], "answers": [{"comments": [{"owner": {"reputation": 682, "user_id": 2014905, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/09f1059060a2a998cfeb08531cdffe92?s=128&d=identicon&r=PG&f=1", "display_name": "kklw", "link": "https://stackoverflow.com/users/2014905/kklw"}, "edited": false, "score": 1, "creation_date": 1482903869, "post_id": 41349449, "comment_id": 69913784, "body": "Is there a way to generalise the header for the section(eg # some_header)? I tried [^#]# [\\s\\S]+?(?=#) but it is not splitting the section."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 1, "last_activity_date": 1482918133, "last_edit_date": 1482918133, "creation_date": 1482859422, "answer_id": 41349449, "question_id": 41349339, "link": "https://stackoverflow.com/questions/41349339/split-markdown-by-each-section-using-ruby-regex/41349449#41349449", "title": "Split markdown by each section using ruby regex", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.3.3/Enumerable.html#method-i-slice_before\" rel=\"nofollow noreferrer\">slice_before</a> instead of a big regex :</p>\n\n<pre><code>markup = \"# section 1\\n\\n\n## 1.1\\n\nblah\\n\n# section 2\\n\\n\n## 2.1\\n\\n\n### 2.2\\n\n# section 3\\n\n## 3.1\\n\\n \"\n\np markup.each_line.slice_before(/# section \\d+/).map(&amp;:join)\n#=&gt; [\"# section 2\\n\\n\\n## 1.1\\n\\nblah\\n\\n\", \"# section 2\\n\\n\\n## 2.1\\n\\n\\n### 2.2\\n\\n\", \"# section 3\\n\\n## 3.1\\n\\n \"]\n</code></pre>\n\n<p>If you want to generalise the method for any header, you can just use :</p>\n\n<pre><code>p markup.each_line.slice_before(/^# /).map(&amp;:join)\n</code></pre>\n\n<p>If you want to iterate over every line in each section, you can remove join :</p>\n\n<pre><code>markup.each_line.slice_before(/^# /).each do |section|\n  section.each do |line|\n    # do something with line\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1482869989, "post_id": 41350706, "comment_id": 69905059, "body": "Good one! Perhaps <code>&#47;(?=# section\\s+\\d+\\n$)&#47;</code>?"}, {"owner": {"reputation": 682, "user_id": 2014905, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/09f1059060a2a998cfeb08531cdffe92?s=128&d=identicon&r=PG&f=1", "display_name": "kklw", "link": "https://stackoverflow.com/users/2014905/kklw"}, "edited": false, "score": 0, "creation_date": 1482903926, "post_id": 41350706, "comment_id": 69913794, "body": "Is there a way to generalise the header for the section(eg # some_header)? I tried [^#]# [\\s\\S]+?(?=#) ."}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1482906745, "post_id": 41350706, "comment_id": 69914786, "body": "Not sure I understand, updated with a variant that matches any heading."}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 2, "last_activity_date": 1482906713, "last_edit_date": 1482906713, "creation_date": 1482865213, "answer_id": 41350706, "question_id": 41349339, "link": "https://stackoverflow.com/questions/41349339/split-markdown-by-each-section-using-ruby-regex/41350706#41350706", "title": "Split markdown by each section using ruby regex", "body": "<p>Try this,</p>\n\n<pre><code>string.split(/(?=^# )/)\n</code></pre>\n\n<p>And if you want to split at any heading from <code>#</code> through <code>###</code></p>\n\n<pre><code>string.split(/(?=^#+ )/)\n</code></pre>\n\n<p>How does this work?</p>\n\n<ul>\n<li><code>^</code> matches the begin of the line</li>\n<li><code>(?=...)</code> is a lookahead match</li>\n<li>No need to match line endings</li>\n</ul>\n"}], "owner": {"reputation": 682, "user_id": 2014905, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/09f1059060a2a998cfeb08531cdffe92?s=128&d=identicon&r=PG&f=1", "display_name": "kklw", "link": "https://stackoverflow.com/users/2014905/kklw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 41350706, "answer_count": 2, "score": 0, "last_activity_date": 1482918133, "creation_date": 1482858912, "last_edit_date": 1482904245, "question_id": 41349339, "link": "https://stackoverflow.com/questions/41349339/split-markdown-by-each-section-using-ruby-regex", "title": "Split markdown by each section using ruby regex", "body": "<p>I have this markdown as string:</p>\n\n<pre><code># section 1\\n\\n\nany type of valid markdown text. /notations here\\n \nSample text for testing:\nabcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ\n0123456789 _+-.,!@$%^&amp;*();\\/|&lt;&gt;\"'\n12345 -98.7 3.141 .6180 9,000 +42\n555.123.4567    +1-(800)-555-2468\nfoo@demo.net    bar.ba@test.co.uk\nwww.demo.com    http://foo.co.uk/\nhttp://regexr.com/foo.html?q=bar\nhttps://mediatemple.net\n- list 1\n- list 2\n[www.asdf.com](some description)\n\n## sec 1.1\\n blah\\n\n# header 2\\n\\n\n## 2.1\\n\\n\n### 2.2\\n\n# some_section\\n\n## 3.1\\n\\n\n</code></pre>\n\n<p>I would like to split the string by section, eg the output should be a list of 3 entries of string. The first entry should be '# section 1\\n\\n ## 1.1\\n blah\\n'.</p>\n\n<p>The regex i'm using is /[^#]# [\\s\\S]+?(?=#)/ . How do I match a string without ' #' at the end? And my regex is matching the whole string instead of the output i need. </p>\n\n<p>Sample at <a href=\"http://regexr.com/3ev83\" rel=\"nofollow noreferrer\">http://regexr.com/3ev83</a> . Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "repository"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482858925, "post_id": 41349320, "comment_id": 69900317, "body": "Did you try anything? What do you mean &quot;on a computer&quot;? Is it a different &quot;server&quot; than where your Rails is installed? Which protocols are installed? ssh/samba/ftp?"}, {"owner": {"reputation": 369, "user_id": 7202721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/662c84635c9bc1a42f111f690d01bfcc?s=128&d=identicon&r=PG&f=1", "display_name": "ChadTheDev", "link": "https://stackoverflow.com/users/7202721/chadthedev"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482860092, "post_id": 41349320, "comment_id": 69900834, "body": "The rails app is going to be hosted on heroku, the target computer is physically located in the restaurant and it&#39;s running windows . As for protocols installed I&#39;m not sure. I haven&#39;t tried anything because I&#39;m not sure where to start. Is it possible to set the target folder up as a repository then have my rails app push files into it? Sorry if this seems vague I&#39;m just at a bit of a dead end @EricDuminil"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1482862889, "post_id": 41349320, "comment_id": 69902097, "body": "<code>File.open(..., &#39;w&#39;)</code> is a good place to start. What&#39;s the problem?"}, {"owner": {"reputation": 2230, "user_id": 6337957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1177d893bf3115edf0119cf56e7220?s=128&d=identicon&r=PG", "display_name": "Greg Navis", "link": "https://stackoverflow.com/users/6337957/greg-navis"}, "edited": false, "score": 0, "creation_date": 1482864377, "post_id": 41349320, "comment_id": 69902745, "body": "@ChadTheDev, one option is to write a separate program (can be in Ruby) that will run on Windows on connect to the server regularly to download the files. I&#39;m not sure how large these files will be but the server can expose an endpoint (preferably requiring authentication with a token) that will return the data either as an archive or JSON (<code>{&quot;file1.txt&quot;:&quot;content&quot;, ...}</code>). @ChadTheDev, would this work?"}, {"owner": {"reputation": 369, "user_id": 7202721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/662c84635c9bc1a42f111f690d01bfcc?s=128&d=identicon&r=PG&f=1", "display_name": "ChadTheDev", "link": "https://stackoverflow.com/users/7202721/chadthedev"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1482864985, "post_id": 41349320, "comment_id": 69903007, "body": "I&#39;m not asking how to write the file I&#39;m asking the best way to push these files into a directory on a different computer @Tadman"}, {"owner": {"reputation": 369, "user_id": 7202721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/662c84635c9bc1a42f111f690d01bfcc?s=128&d=identicon&r=PG&f=1", "display_name": "ChadTheDev", "link": "https://stackoverflow.com/users/7202721/chadthedev"}, "edited": false, "score": 0, "creation_date": 1482865456, "post_id": 41349320, "comment_id": 69903219, "body": "So basically I create an API that returns the data needed to make these text files then write a separate program that regularly makes calls to this API, then that program can write the file and drop it into the target folder. Also to answer your question these txt files will be small probably 1000 characters at most"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1482869108, "post_id": 41349320, "comment_id": 69904679, "body": "@ChadTheDev What methods are available? Can you <code>rsync</code> it? Can you dump it on a shared drive? You&#39;ve given very little information on the parameters here."}, {"owner": {"reputation": 369, "user_id": 7202721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/662c84635c9bc1a42f111f690d01bfcc?s=128&d=identicon&r=PG&f=1", "display_name": "ChadTheDev", "link": "https://stackoverflow.com/users/7202721/chadthedev"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1482918671, "post_id": 41349320, "comment_id": 69920270, "body": "@tadman Apologies for the ambiguity of the question part of the problem i think is I&#39;m not entirely sure what I&#39;m asking, I&#39;ll try to explain. I have a rails app running an online order system for a restaurant. When this app creates an order it needs to drop a text file into a directory named OLO located on a computer in the basement of this restaurant. The target computer is running windows and i can install any software necessary to assist"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1482919309, "post_id": 41349320, "comment_id": 69920572, "body": "Use a shared drive. Figure out how. Then the rest is simply a matter of writing a file."}, {"owner": {"reputation": 369, "user_id": 7202721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/662c84635c9bc1a42f111f690d01bfcc?s=128&d=identicon&r=PG&f=1", "display_name": "ChadTheDev", "link": "https://stackoverflow.com/users/7202721/chadthedev"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1483305086, "post_id": 41349320, "comment_id": 70043325, "body": "@tadman the problem with using a shared drive is in the purpose of these text files. These text files are live orders, once they get dropped into the correct directory on the computer running our POS system the POS will read these these files and make an order. Then once the ticket gets closed out the POS system will delete the order file. What I&#39;m really looking for is a way to sync a directory in my rails app with the OLO directory on the computer running the POS system so that anytime either system adds or removes a file it syncs. Is there a way to set this up?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1483340316, "post_id": 41349320, "comment_id": 70050499, "body": "You&#39;re really over-thinking this here. <b>Make a file on a shared drive</b>. If you need a back-up, make two files. Shared drive support is built into Windows, it&#39;s not even hard. Everything else will end up being a regrettable hack by comparison."}], "owner": {"reputation": 369, "user_id": 7202721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/662c84635c9bc1a42f111f690d01bfcc?s=128&d=identicon&r=PG&f=1", "display_name": "ChadTheDev", "link": "https://stackoverflow.com/users/7202721/chadthedev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482858799, "creation_date": 1482858799, "question_id": 41349320, "link": "https://stackoverflow.com/questions/41349320/pushing-a-file-into-a-specific-folder-on-a-computer-from-ruby-on-rails", "title": "Pushing a file into a specific folder on a computer from ruby on rails", "body": "<p>I have a rails app for online orders at a restaurant, I need to push a txt file into a specific folder on the computer running our POS. So basically when a user submits an order the rails app needs to create a txt file and drop that into a directory on the in house computer at said restaurant. </p>\n\n<p>how would I go about doing this? </p>\n"}, {"tags": ["ruby", "elasticsearch", "logstash", "devops"], "comments": [{"owner": {"reputation": 7181, "user_id": 1338588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/j4Fva.jpg?s=128&g=1", "display_name": "Kulasangar", "link": "https://stackoverflow.com/users/1338588/kulasangar"}, "edited": false, "score": 0, "creation_date": 1482858451, "post_id": 41348946, "comment_id": 69900103, "body": "What&#39;s the ES version you&#39;re using?"}, {"owner": {"reputation": 15576, "user_id": 677561, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/95077e3dc8c640d554cfa97da3dc6131?s=128&d=identicon&r=PG&f=1", "display_name": "Alain Collins", "link": "https://stackoverflow.com/users/677561/alain-collins"}, "edited": false, "score": 0, "creation_date": 1482860707, "post_id": 41348946, "comment_id": 69901081, "body": "I would suggest that you check for exceptions: begin                   event.instance_variable_set(:@data,remove_dots(event.to_hash&zwnj;&#8203;))                 rescue Exception =&gt; e                   event[&#39;logstash_ruby_exception&#39;] = &#39;field dot cleanup: &#39; + e.message                 end"}, {"owner": {"reputation": 189, "user_id": 3756159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2fc3e71f6d699ecab66e264f4c542d2?s=128&d=identicon&r=PG&f=1", "display_name": "adgon92", "link": "https://stackoverflow.com/users/3756159/adgon92"}, "reply_to_user": {"reputation": 7181, "user_id": 1338588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/j4Fva.jpg?s=128&g=1", "display_name": "Kulasangar", "link": "https://stackoverflow.com/users/1338588/kulasangar"}, "edited": false, "score": 0, "creation_date": 1482876907, "post_id": 41348946, "comment_id": 69907604, "body": "@Kulasangar I use ES version 2.3.1."}, {"owner": {"reputation": 189, "user_id": 3756159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2fc3e71f6d699ecab66e264f4c542d2?s=128&d=identicon&r=PG&f=1", "display_name": "adgon92", "link": "https://stackoverflow.com/users/3756159/adgon92"}, "reply_to_user": {"reputation": 15576, "user_id": 677561, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/95077e3dc8c640d554cfa97da3dc6131?s=128&d=identicon&r=PG&f=1", "display_name": "Alain Collins", "link": "https://stackoverflow.com/users/677561/alain-collins"}, "edited": false, "score": 0, "creation_date": 1482877565, "post_id": 41348946, "comment_id": 69907802, "body": "@AlainCollins I tried to add your code as follows <code>code =&gt; &quot;         begin             event.instance_variable_set(:@data,remove_dots(event.to_hash&zwnj;&#8203;)) rescue Exception =&gt; e             event[&#39;logstash_ruby_exception&#39;] = &#39;field dot cleanup: &#39; + e.message         end     &quot;</code> but SyntaxError is reported: <code>SyntaxError: (ruby filter code):3: syntax error, unexpected tASSOC             event.instance_variable_set(:@data,remove_dots(event.to_hash&zwnj;&#8203;)) rescue Exception =&gt; e</code> - &quot;=&gt;&quot; cannot be parsed"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 3756159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2fc3e71f6d699ecab66e264f4c542d2?s=128&d=identicon&r=PG&f=1", "display_name": "adgon92", "link": "https://stackoverflow.com/users/3756159/adgon92"}, "edited": false, "score": 0, "creation_date": 1482877378, "post_id": 41349323, "comment_id": 69907747, "body": "I am sorry but this won&#39;t help. I knew about it and that is why I added recursive filter that replaces dots with &quot;-&quot;. I&#39;ve added more details to my question."}], "tags": [], "owner": {"reputation": 7181, "user_id": 1338588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/j4Fva.jpg?s=128&g=1", "display_name": "Kulasangar", "link": "https://stackoverflow.com/users/1338588/kulasangar"}, "is_accepted": false, "score": 0, "last_activity_date": 1482858816, "creation_date": 1482858816, "answer_id": 41349323, "question_id": 41348946, "link": "https://stackoverflow.com/questions/41348946/logstash-to-elasticsearch-keys-with-dots/41349323#41349323", "title": "Logstash to elasticsearch. Keys with dots", "body": "<p>If you're using the ES version 2.0 it could be a version issue where ES doesn't pick up fields which contains <code>.</code> dots.</p>\n\n<p>According to this response in this <a href=\"https://discuss.elastic.co/t/field-name-cannot-contain/33251/3\" rel=\"nofollow noreferrer\">thread</a>:</p>\n\n<blockquote>\n  <p>Field names cannot contain the . character in Elasticsearch 2.0.</p>\n</blockquote>\n\n<p>As a work around you might have to <code>mutate</code> (rename) your field names into something like <code>_ or -</code> instead of using the <code>.</code> dot. This <a href=\"https://github.com/elastic/elasticsearch/issues/15951\" rel=\"nofollow noreferrer\">ticket</a> pretty much explains this issue, where as <code>.</code> dots can be used in the ES versions which are after 2.0. Hope it helps!</p>\n"}], "owner": {"reputation": 189, "user_id": 3756159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2fc3e71f6d699ecab66e264f4c542d2?s=128&d=identicon&r=PG&f=1", "display_name": "adgon92", "link": "https://stackoverflow.com/users/3756159/adgon92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 602, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482876762, "creation_date": 1482857204, "last_edit_date": 1482876762, "question_id": 41348946, "link": "https://stackoverflow.com/questions/41348946/logstash-to-elasticsearch-keys-with-dots", "title": "Logstash to elasticsearch. Keys with dots", "body": "<p>I'm facing a problem with logstash configuration. You can find my logstash configuration below. </p>\n\n<p>Ruby filter removes every dot - \".\" from my fields. It seems that every works fine - the result of data filtration is correct but elasticsearch magically responds with: <code>\"status\"=&gt;400, \"error\"=&gt;{\"type\"=&gt;\"mapper_parsing_exception\", \"reason\"=&gt;\"Field name [/ConsumerAdminWebService/getConsumerTransactions.call] cannot contain '.'\"}</code> where <code>getConsumerTransactions.call</code> is one of my field key. </p>\n\n<pre><code>input {\n  http_poller {\n    urls =&gt; {\n      uatBackend1 =&gt; {\n        method =&gt; get\n        url =&gt; \"http://some-url/\"\n        headers =&gt; {\n          Accept =&gt; \"application/json\"\n        }\n      }\n    }\n    request_timeout =&gt; 60\n    # Run every 30 seconds\n    schedule =&gt; { cron =&gt; \"* * * * * UTC\"}\n    codec =&gt; \"json\"\n    metadata_target =&gt; \"http_poller_metadata\"\n }\n}\nfilter {\n  ruby {\n    init =&gt; \"\n      def remove_dots hash\n          new = Hash.new\n          hash.each { |k,v|\n              if v.is_a? Hash\n                  v = remove_dots(v)\n              end\n              new[ k.gsub('.','_') ] = v\n              if v.is_a? Array\n                  v.each { |elem|\n                      if elem.is_a? Hash\n                          elem = remove_dots(elem)\n                      end\n                      new[ k.gsub('.','_') ] = elem\n                  } unless v.nil?\n              end\n          } unless hash.nil?\n          return new\n      end\n  \"\n  code =&gt; \"\n      event.instance_variable_set(:@data,remove_dots(event.to_hash))\n  \"\n }\n}\noutput {\n  elasticsearch {\n    hosts =&gt; localhost\n  }\n}\n</code></pre>\n\n<p>I'm afraid that this line of code is not correct: <code>event.instance_variable_set(:@data,remove_dots(event.to_hash))</code> - result data is somehow pinned to the event but the original data persists unchanged and is delivered to Elasticsearch api.</p>\n\n<p>I suppose some clarifications are required here:</p>\n\n<ul>\n<li>I use ES version > 2.0 so dots are not allowed </li>\n<li>Ruby filter should replace dots with \"_\" and it works great - resulting data is fully correct however ES replies with mentioned error. I suspect that filter does not replace event data but simply adds a new filed to Event object. ES then still reads primal data not the updated one.</li>\n</ul>\n\n<p>To be honest Ruby is a magic to me :)</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 100, "user_id": 2425565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cc6f8733d6c5a8b795a5e3fb0a9f7df?s=128&d=identicon&r=PG", "display_name": "Omkar", "link": "https://stackoverflow.com/users/2425565/omkar"}, "is_accepted": true, "score": 0, "last_activity_date": 1484031348, "creation_date": 1484031348, "answer_id": 41562856, "question_id": 41347940, "link": "https://stackoverflow.com/questions/41347940/rails-link-to-on-overlay-div/41562856#41562856", "title": "rails link_to on overlay div", "body": "<p>Sorry, I can't comment because of my reputation. Can you provide me two more things?</p>\n\n<ol>\n<li>Rendered HTML code in browser. You can get it by doing \"Inspect Element\" in browser.</li>\n<li>JavaScript/JQuery/CoffeeScript associated with <code>$(\".text-overlay\")</code>. Remove <code>event.preventDefault()</code>. I have used JQuery Syntax. If you are using some other library then find syntax for the same and remove.</li>\n</ol>\n"}], "owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 41562856, "answer_count": 1, "score": 0, "last_activity_date": 1484031348, "creation_date": 1482852809, "question_id": 41347940, "link": "https://stackoverflow.com/questions/41347940/rails-link-to-on-overlay-div", "title": "rails link_to on overlay div", "body": "<p>I have a div structured like so:</p>\n\n<pre><code>          &lt;% @posts.each do |post| %&gt;\n            &lt;!-- Shot --&gt;\n            &lt;div class=\"col-xs-12 col-sm-6 col-md-4 col-lg-3\"&gt;\n              &lt;div class=\"shot shot-minimal\"&gt;\n                &lt;div class=\"shot-preview\"&gt;\n                  &lt;a class=\"img\" href=\"shot-gallery.html\"&gt;&lt;img src=\"http://rwdtow.stdout.in/img/avatar-icon.png\" alt=\"\"&gt;&lt;/a&gt;\n\n                  &lt;a class=\"text-overlay\"&gt;\n                      &lt;span class=\"heading\"&gt;&lt;%= post.tite %&gt;&lt;/span&gt;\n                      &lt;span class=\"desc\"&gt;&lt;%= post.shortdescription %&gt;&lt;/span&gt;\n                    &lt;time datetime=\"2016-02-04 22:30\"&gt;7 hours ago&lt;/time&gt;\n                  &lt;/a&gt;\n                &lt;/div&gt;\n\n                &lt;div class=\"shot-detail\"&gt;\n                  &lt;div class=\"shot-info\"&gt;\n                    &lt;p&gt;&lt;%= post.title %&gt;&lt;/p&gt;\n                  &lt;/div&gt;\n\n                  &lt;ul class=\"shot-stats\"&gt;\n                    &lt;li&gt;&lt;i class=\"fa fa-eye\"&gt;&lt;/i&gt;&lt;span&gt;6.3k&lt;/span&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;a class=\"like\" href=\"#\"&gt;&lt;i class=\"fa fa-heart\"&gt;&lt;/i&gt;&lt;span&gt;1.2k&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;\n                  &lt;/ul&gt;\n                &lt;/div&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n            &lt;!-- END Shot --&gt;\n          &lt;% end %&gt;\n</code></pre>\n\n<p>In the above div i have an overlay:</p>\n\n<pre><code>              &lt;a class=\"text-overlay\"&gt;\n                  &lt;span class=\"heading\"&gt;&lt;%= post.tite %&gt;&lt;/span&gt;\n                  &lt;span class=\"desc\"&gt;&lt;%= post.shortdescription %&gt;&lt;/span&gt;\n                &lt;time datetime=\"2016-02-04 22:30\"&gt;7 hours ago&lt;/time&gt;\n              &lt;/a&gt;\n</code></pre>\n\n<p>So i placed a link_to with the overlay, so the text overlays, the text is clickable:</p>\n\n<pre><code>              &lt;%= link_to post, class:\"text-overlay\" do %&gt;        \n                  &lt;span class=\"heading\"&gt;&lt;%= post.tite %&gt;&lt;/span&gt;\n                  &lt;span class=\"desc\"&gt;&lt;%= post.shortdescription %&gt;&lt;/span&gt;\n                &lt;time datetime=\"2016-02-04 22:30\"&gt;7 hours ago&lt;/time&gt;\n              &lt;% end %&gt;\n</code></pre>\n\n<p>The overlay works correct, but when i click on it, it does not take me to the show action for the post. Heres how my final code looks:</p>\n\n<pre><code>      &lt;% @posts.each do |post| %&gt;\n        &lt;!-- Shot --&gt;\n        &lt;div class=\"col-xs-12 col-sm-6 col-md-4 col-lg-3\"&gt;\n          &lt;div class=\"shot shot-minimal\"&gt;\n            &lt;div class=\"shot-preview\"&gt;\n              &lt;a class=\"img\" href=\"shot-gallery.html\"&gt;&lt;img src=\"http://rwdtow.stdout.in/img/avatar-icon.png\" alt=\"\"&gt;&lt;/a&gt;\n\n              &lt;%= link_to post, class:\"text-overlay\" do %&gt;        \n               &lt;span class=\"heading\"&gt;&lt;%= post.tite %&gt;&lt;/span&gt;\n               &lt;span class=\"desc\"&gt;&lt;%= post.shortdescription %&gt;&lt;/span&gt;\n               &lt;time datetime=\"2016-02-04 22:30\"&gt;7 hours ago&lt;/time&gt;\n              &lt;% end %&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"shot-detail\"&gt;\n              &lt;div class=\"shot-info\"&gt;\n                &lt;p&gt;&lt;%= post.title %&gt;&lt;/p&gt;\n              &lt;/div&gt;\n\n              &lt;ul class=\"shot-stats\"&gt;\n                &lt;li&gt;&lt;i class=\"fa fa-eye\"&gt;&lt;/i&gt;&lt;span&gt;6.3k&lt;/span&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a class=\"like\" href=\"#\"&gt;&lt;i class=\"fa fa-heart\"&gt;&lt;/i&gt;&lt;span&gt;1.2k&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;\n              &lt;/ul&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;!-- END Shot --&gt;\n      &lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "soap", "savon"], "answers": [{"tags": [], "owner": {"reputation": 865, "user_id": 1439147, "user_type": "registered", "accept_rate": 8, "profile_image": "https://i.stack.imgur.com/DEX2c.jpg?s=128&g=1", "display_name": "Anbazhagan p", "link": "https://stackoverflow.com/users/1439147/anbazhagan-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1482904909, "last_edit_date": 1495541784, "creation_date": 1482904909, "answer_id": 41356236, "question_id": 41347578, "link": "https://stackoverflow.com/questions/41347578/savon-gem-soap-error-encoding-violation-of-encoding-rules/41356236#41356236", "title": "savon gem SOAP-ERROR: Encoding: Violation of encoding rules", "body": "<p>I had a couple of problems with my xml, the filter inside the filters is wrong, inside filters i needed to have complex_filter and also while generating camel_case turned to camelCase which showed http 500 error.</p>\n\n<p>For generating arrays of items i followed a comment from this answer <a href=\"https://stackoverflow.com/questions/17345486/how-to-generate-repeating-xml-elements-in-savon\">How to generate repeating xml elements in Savon?</a></p>\n\n<p>This link i followed\n<a href=\"https://github.com/savonrb/gyoku/blob/master/spec/gyoku/hash_spec.rb\" rel=\"nofollow noreferrer\">https://github.com/savonrb/gyoku/blob/master/spec/gyoku/hash_spec.rb</a></p>\n"}], "owner": {"reputation": 865, "user_id": 1439147, "user_type": "registered", "accept_rate": 8, "profile_image": "https://i.stack.imgur.com/DEX2c.jpg?s=128&g=1", "display_name": "Anbazhagan p", "link": "https://stackoverflow.com/users/1439147/anbazhagan-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482904909, "creation_date": 1482851394, "last_edit_date": 1482857977, "question_id": 41347578, "link": "https://stackoverflow.com/questions/41347578/savon-gem-soap-error-encoding-violation-of-encoding-rules", "title": "savon gem SOAP-ERROR: Encoding: Violation of encoding rules", "body": "<p>I am using savon version-2 gem for soap requests, and for authorization and few other urls I didn't face problem, but for particular endpoint I need to search the date range from and to which needs to be passed inside item so the problem is first item get replaced by second how do i avoid this</p>\n\n<pre><code>client = Savon.client(wsdl: \"http://www.sss.ss/api/v2_soap/?wsdl\", log_level: :debug, pretty_print_xml: true, log: true)\nsession = client.call(:login, message: {username: 'sss', apiKey: 'sss'})\nresult = client.call(:sales_order_list, message: {sessionId: session.body[:login_response][:login_return], filters: {filter: {item: {key: 'created_at', value: {key: 'from', value: '2016-12-27 00:00:00'}}, item: {key: 'created_at', value: {key: 'to', value: '2016-12-27 23:59:59'}} }}})\n</code></pre>\n\n<p>the xml generated is like with the to value only and i get the error:  </p>\n\n<blockquote>\n  <p>SOAP-ERROR: Encoding: Violation of encoding rules</p>\n</blockquote>\n\n<p>I think overwriting items is the problem How do i send 2 items inside filter</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "stripe-payments"], "comments": [{"owner": {"reputation": 21, "user_id": 7343493, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wm7yZxFejwA/AAAAAAAAAAI/AAAAAAAAABU/fJWgND_labU/photo.jpg?sz=128", "display_name": "Ravindra Singh", "link": "https://stackoverflow.com/users/7343493/ravindra-singh"}, "edited": false, "score": 0, "creation_date": 1482909294, "post_id": 41347514, "comment_id": 69915811, "body": "Can any one help me what should I do full fill my requirement?"}], "answers": [{"tags": [], "owner": {"reputation": 481, "user_id": 1987297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1c89e587af4353239a77a03242d390?s=128&d=identicon&r=PG", "display_name": "Spiff", "link": "https://stackoverflow.com/users/1987297/spiff"}, "is_accepted": false, "score": 0, "last_activity_date": 1482913510, "creation_date": 1482913510, "answer_id": 41358095, "question_id": 41347514, "link": "https://stackoverflow.com/questions/41347514/getting-zero-fee-in-stripe-balance-transaction-api-response/41358095#41358095", "title": "Getting Zero fee in Stripe Balance Transaction API Response", "body": "<p>You don't want to look at the transfer and its balance transaction here to get the fees. This is an automatic transfer between accounts from a destination payment so there is no fee linked to it.</p>\n\n<p>You need to retrieve the original charge in <code>source_transaction</code> and then look at this charge's own <code>balance_transaction</code> and <code>application_fee</code> objects.</p>\n\n<p>You can even use the expand feature to do this in one API call:\n<a href=\"https://stripe.com/docs/api#expanding_objects\" rel=\"nofollow noreferrer\">https://stripe.com/docs/api#expanding_objects</a></p>\n\n<p>Regarding the total count I suspect you want the number of transactions for this user, then you need to look at this when listing all transfers to this account and add the following optional parameter to the request:</p>\n\n<pre><code>:include =&gt; ['total_count']\n</code></pre>\n\n<p>This would only work if you don't create manual transfers to the connected account on top of destination charges though.</p>\n"}], "owner": {"reputation": 21, "user_id": 7343493, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wm7yZxFejwA/AAAAAAAAAAI/AAAAAAAAABU/fJWgND_labU/photo.jpg?sz=128", "display_name": "Ravindra Singh", "link": "https://stackoverflow.com/users/7343493/ravindra-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 794, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561784780, "creation_date": 1482851085, "last_edit_date": 1561784780, "question_id": 41347514, "link": "https://stackoverflow.com/questions/41347514/getting-zero-fee-in-stripe-balance-transaction-api-response", "title": "Getting Zero fee in Stripe Balance Transaction API Response", "body": "<p>I am using <code>Stripe</code> API for receiving the contribution from multiple user. So I want to generate statement for our customer so they can see what exact amount, fee deduction, transaction count etc. </p>\n\n<p>After looked into Stripe API I found there are two API(<code>Stripe::Transfer</code> and <code>Stripe::BalanceTransaction</code>) these can be used to fullfil my requirement.</p>\n\n<p>So as per documentation <a href=\"https://stripe.com/docs/api#transfers\" rel=\"nofollow noreferrer\">Stripe API </a> I am calling <code>Stripe::Transfer</code>  API and this API returning correct response like below</p>\n\n<pre><code>transfer = #&lt;Stripe::Transfer:0x3f997455ac88 id=tr_1xxxxxxxxxxxxxx&gt;    JSON: {\n\"id\": \"tr_1xxxxxxxxxxxxxxxxx\",\n\"object\": \"transfer\",\n\"amount\": 9510,\n\"amount_reversed\": 0,\n\"application_fee\": null,\n\"balance_transaction\": \"txn_123\",\n\"created\": 1477485158,\n\"currency\": \"usd\",\n\"date\": 1477485158,\n\"description\": null,\n\"destination\": \"acct_xxxxxxxxxxxxxx\",\n\"destination_payment\": \"py_xxxxxxxxxxx\",\n\"failure_code\": null,\n\"failure_message\": null,\n\"livemode\": false,\n\"metadata\": {},\n\"method\": \"standard\",\n\"recipient\": null,\n\"reversals\": {\"object\":\"list\",\"data\":[],\"has_more\":false,\"total_count\":0,\"url\":\"/v1/transfers/tr_xx/reversals\"},\n\"reversed\": false,\n\"source_transaction\": \"ch_xxxxxxxxx\",\n\"source_type\": \"card\",\n\"statement_descriptor\": null,\n\"status\": \"paid\",\n\"type\": \"stripe_account\"\n}\n</code></pre>\n\n<p>I am calling Stripe::BalanceTransaction API to get the details particular transfer's transactions</p>\n\n<pre><code>balance_transaction_id = transfer.balance_transaction\nStripe::BalanceTransaction.retrieve(balance_transaction_id)\n</code></pre>\n\n<p>Getting below response</p>\n\n<pre><code>#&lt;Stripe::BalanceTransaction:0x3f9974f2f1c8 id=txn_123&gt; JSON: {\n\"id\": \"txn_123\",\n\"object\": \"balance_transaction\",\n\"amount\": -9510,\n\"available_on\": 1478044800,\n\"created\": 1477485158,\n\"currency\": \"usd\",\n\"description\": null,\n\"fee\": 0,\n\"fee_details\": [\n\n],\n\"net\": -9510,\n\"source\": \"tr_xxxxxxxx\",\n\"sourced_transfers\": {\"object\":\"list\",\"data\":  [],\"has_more\":false,\"total_count\":0,\"url\":\"/v1/transfers?  source_transaction=tr_xxxx\"},\n\"status\": \"available\",\n\"type\": \"transfer\"\n}\n</code></pre>\n\n<p>I setup application fee(2%) and this showing correct on Stripe Dashboard but in the above response I am getting <code>fee</code> is <code>0</code></p>\n\n<p>So how can I get <code>fee</code> and <code>total_count</code> values in this response?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "terminal", "rubymine"], "answers": [{"tags": [], "owner": {"reputation": 1637, "user_id": 4415902, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5f4d39ddb78671645241c0cae6a5d7ce?s=128&d=identicon&r=PG&f=1", "display_name": "atlascoder", "link": "https://stackoverflow.com/users/4415902/atlascoder"}, "is_accepted": false, "score": 18, "last_activity_date": 1482848789, "creation_date": 1482848789, "answer_id": 41346963, "question_id": 41346962, "link": "https://stackoverflow.com/questions/41346962/rubymine-terminal-uses-wrong-rvm-and-no-history-in-rails-console/41346963#41346963", "title": "RubyMine Terminal uses wrong RVM and no history in rails console", "body": "<p>The key thing is that after updating RubyMine, the Terminal starts opening without proper RVM initialization. All what is needed is:</p>\n\n<p>change setting <strong>Shell path: <code>/bin/bash</code> -> <code>/bin/bash --login</code></strong> </p>\n\n<p><a href=\"https://i.stack.imgur.com/2pHdq.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/2pHdq.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1637, "user_id": 4415902, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5f4d39ddb78671645241c0cae6a5d7ce?s=128&d=identicon&r=PG&f=1", "display_name": "atlascoder", "link": "https://stackoverflow.com/users/4415902/atlascoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1482848789, "creation_date": 1482848789, "question_id": 41346962, "link": "https://stackoverflow.com/questions/41346962/rubymine-terminal-uses-wrong-rvm-and-no-history-in-rails-console", "title": "RubyMine Terminal uses wrong RVM and no history in rails console", "body": "<p>After updating RubyMine I've got working environment with right Settings and <code>rvm current</code> returned <code>2.2.4</code> version as expected. But Rails was running always under another version (<code>2.3.1</code>).</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "string", "split"], "comments": [{"owner": {"reputation": 3445, "user_id": 2396502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R6e2l.png?s=128&g=1", "display_name": "Peaceful", "link": "https://stackoverflow.com/users/2396502/peaceful"}, "edited": false, "score": 0, "creation_date": 1482847095, "post_id": 41346530, "comment_id": 69894768, "body": "split is not defined for lists. It is defined only for strings."}, {"owner": {"reputation": 47, "user_id": 7280760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6654a786d6980db2021a8ac66fc892a?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin Rao T", "link": "https://stackoverflow.com/users/7280760/ashwin-rao-t"}, "reply_to_user": {"reputation": 3445, "user_id": 2396502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R6e2l.png?s=128&g=1", "display_name": "Peaceful", "link": "https://stackoverflow.com/users/2396502/peaceful"}, "edited": false, "score": 0, "creation_date": 1482847238, "post_id": 41346530, "comment_id": 69894840, "body": "Then what should i use to split it into 2 different lines?"}, {"owner": {"reputation": 47, "user_id": 7280760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6654a786d6980db2021a8ac66fc892a?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin Rao T", "link": "https://stackoverflow.com/users/7280760/ashwin-rao-t"}, "reply_to_user": {"reputation": 3445, "user_id": 2396502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R6e2l.png?s=128&g=1", "display_name": "Peaceful", "link": "https://stackoverflow.com/users/2396502/peaceful"}, "edited": false, "score": 0, "creation_date": 1482847409, "post_id": 41346530, "comment_id": 69894919, "body": "I am really sorry for giving you half question. I want this in Ruby"}, {"owner": {"reputation": 3445, "user_id": 2396502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R6e2l.png?s=128&g=1", "display_name": "Peaceful", "link": "https://stackoverflow.com/users/2396502/peaceful"}, "edited": false, "score": 0, "creation_date": 1482847501, "post_id": 41346530, "comment_id": 69894956, "body": "Okay. I deleted my answer then."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482848053, "post_id": 41346530, "comment_id": 69895214, "body": "See <a href=\"https://ideone.com/uW57E8\" rel=\"nofollow noreferrer\">ideone.com/uW57E8</a>, you do not need to split the items, you need to <i>access</i> them with indices, or using <code>.first</code>/<code>.last</code>. A list is already split, why split it again?"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482848615, "post_id": 41346530, "comment_id": 69895511, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/310634/what-is-the-right-way-to-iterate-through-an-array-in-ruby\">What is the &quot;right&quot; way to iterate through an array in Ruby?</a>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1482883140, "post_id": 41346530, "comment_id": 69909356, "body": "This question makes no sense. An array has no lines. You cannot split it into lines because the idea of &quot;line&quot; doesn&#39;t even make sense in the context of arrays. Lines are related to text, not arrays."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1482855550, "post_id": 41346805, "comment_id": 69898750, "body": "<a href=\"https://ruby-doc.org/core-2.2.3/IO.html#method-i-puts\" rel=\"nofollow noreferrer\"><code>IO#puts</code></a> with an <code>Array</code> will already put each element on its own line without the need to iterate using <code>#each</code>."}, {"owner": {"reputation": 1407, "user_id": 2570280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cv9du.png?s=128&g=1", "display_name": "Cahit Gungor", "link": "https://stackoverflow.com/users/2570280/cahit-gungor"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1482869897, "post_id": 41346805, "comment_id": 69905023, "body": "@engineersmnky I update the answer according to your comment"}], "tags": [], "owner": {"reputation": 1407, "user_id": 2570280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cv9du.png?s=128&g=1", "display_name": "Cahit Gungor", "link": "https://stackoverflow.com/users/2570280/cahit-gungor"}, "is_accepted": false, "score": 4, "last_activity_date": 1482869837, "last_edit_date": 1482869837, "creation_date": 1482848178, "answer_id": 41346805, "question_id": 41346530, "link": "https://stackoverflow.com/questions/41346530/unable-to-split-the-statement-into-multiple-lines-from-an-array-in-ruby/41346805#41346805", "title": "Unable to split the statement into multiple lines from an array in Ruby", "body": "<p>You can iterate over the array.</p>\n\n<pre><code>stmtAry = [\"Statement1\", \"Statement2\"]\nstmtAry.each{|i| puts i}\n</code></pre>\n\n<p>You can directly output each statement without iterating on them if you don't need any other operation other than printing out.</p>\n\n<pre><code>stmtAry = [\"Statement1\", \"Statement2\"]\nputs stmtAry\n</code></pre>\n\n<p>Both codes provides the same output:</p>\n\n<p>Output:</p>\n\n<pre><code>Statement1 \nStatement2 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 3, "last_activity_date": 1482849178, "last_edit_date": 1482849178, "creation_date": 1482848860, "answer_id": 41346982, "question_id": 41346530, "link": "https://stackoverflow.com/questions/41346530/unable-to-split-the-statement-into-multiple-lines-from-an-array-in-ruby/41346982#41346982", "title": "Unable to split the statement into multiple lines from an array in Ruby", "body": "<p>It doesn't go much shorter :</p>\n\n<pre><code>puts statement\n# Statement1\n# Statement2\n</code></pre>\n\n<p>From the <a href=\"https://ruby-doc.org/core-2.2.2/IO.html#method-i-puts\" rel=\"nofollow noreferrer\"><code>puts</code> documentation</a> :</p>\n\n<blockquote>\n  <p>If called with an array argument, writes each element on a new line.</p>\n</blockquote>\n\n<p>If you want to get just one string from your array, you could use <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-join\" rel=\"nofollow noreferrer\">Array#join</a>, which is the opposite of <a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-split\" rel=\"nofollow noreferrer\">String#split</a> :</p>\n\n<pre><code>statement.join(\"\\n\")\n</code></pre>\n\n<p>It returns one string :</p>\n\n<pre><code>\"Statement1\\nStatement2\"\n</code></pre>\n\n<p>when displayed with puts :</p>\n\n<pre><code>Statement1\nStatement2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1482862677, "post_id": 41347759, "comment_id": 69901997, "body": "you could also use <code>Array.public_method_defined?(:split) #=&gt; false</code> this will tell you if that class or an instance of that class has a method defined by name (excludes private and protected methods)."}], "tags": [], "owner": {"reputation": 21, "user_id": 7343493, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wm7yZxFejwA/AAAAAAAAAAI/AAAAAAAAABU/fJWgND_labU/photo.jpg?sz=128", "display_name": "Ravindra Singh", "link": "https://stackoverflow.com/users/7343493/ravindra-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1482852074, "creation_date": 1482852074, "answer_id": 41347759, "question_id": 41346530, "link": "https://stackoverflow.com/questions/41346530/unable-to-split-the-statement-into-multiple-lines-from-an-array-in-ruby/41347759#41347759", "title": "Unable to split the statement into multiple lines from an array in Ruby", "body": "<p>Your are trying call <code>split</code> method of Array class but Array class doesn't have this method.</p>\n\n<p>You can check whether method is existed in calling class or not by using this way</p>\n\n<pre><code>statement = [\"Statement1\", \"Statement2\"]\nstatement.methods\n[:inspect, :to_s, :to_a, :to_h, :to_ary, :frozen?, :==, :eql?, :hash, :[], :[]=, :at, :fetch, :first, :last, :concat, :&lt;&lt;, :push, :pop, :shift, :unshift, :insert, :each, :each_index, :reverse_each, :length, :size, :empty?, :find_index, :index, :rindex, :join, :reverse, :reverse!, :rotate, :rotate!, :sort, :sort!, :sort_by!, :collect, :collect!, :map, :map!, :select, :select!, :keep_if, :values_at, :delete, :delete_at, :delete_if, :reject, :reject!, :zip, :transpose, :replace, :clear, :fill, :include?, :&lt;=&gt;, :slice, :slice!, :assoc, :rassoc, :+, :*, :-, :&amp;, :|, :uniq, :uniq!, :compact, :compact!, :flatten, :flatten!, :count, :shuffle!, :shuffle, :sample, :cycle, :permutation, :combination, :repeated_permutation, :repeated_combination, :product, :take, :take_while, :drop, :drop_while, :bsearch, :any?, :pack, :entries, :sort_by, :grep, :find, :detect, :find_all, :flat_map, :collect_concat, :inject, :reduce, :partition, :group_by, :all?, :one?, :none?, :min, :max, :minmax, :min_by, :max_by, :minmax_by, :member?, :each_with_index, :each_entry, :each_slice, :each_cons, :each_with_object, :chunk, :slice_before, :slice_after, :slice_when, :lazy, :nil?, :===, :=~, :!~, :class, :singleton_class, :clone, :dup, :itself, :taint, :tainted?, :untaint, :untrust, :untrusted?, :trust, :freeze, :methods, :singleton_methods, :protected_methods, :private_methods, :public_methods, :instance_variables, :instance_variable_get, :instance_variable_set, :instance_variable_defined?, :remove_instance_variable, :instance_of?, :kind_of?, :is_a?, :tap, :send, :public_send, :respond_to?, :extend, :display, :method, :public_method, :singleton_method, :define_singleton_method, :object_id, :to_enum, :enum_for, :equal?, :!, :!=, :instance_eval, :instance_exec, :__send__, :__id__]\n</code></pre>\n\n<p>So there is no <code>split</code>  method in this above response that's why your are getting this error.</p>\n\n<p>So if you face any issue in future like this and it would help you.</p>\n"}], "owner": {"reputation": 47, "user_id": 7280760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6654a786d6980db2021a8ac66fc892a?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin Rao T", "link": "https://stackoverflow.com/users/7280760/ashwin-rao-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 821, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1482869837, "creation_date": 1482847015, "last_edit_date": 1482847590, "question_id": 41346530, "link": "https://stackoverflow.com/questions/41346530/unable-to-split-the-statement-into-multiple-lines-from-an-array-in-ruby", "title": "Unable to split the statement into multiple lines from an array in Ruby", "body": "<p>I want to split the statement array into 2 different lines in RUBY:</p>\n\n<pre><code>statement = [\"Statement1\", \"Statement2\"]\n</code></pre>\n\n<p>This is how I am splitting the array</p>\n\n<pre><code>result = statement.split(\", \")\n</code></pre>\n\n<p>The output what I want is:</p>\n\n<pre><code>Statement1\nStatement2\n</code></pre>\n\n<p>But I am getting the error as:</p>\n\n<pre><code>undefined method `split' for [\"Statement1\", \"Statement2\"]:Array (NoMethodError)\n</code></pre>\n\n<p>Can someone please help me? \nThanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite"], "comments": [{"owner": {"reputation": 5251, "user_id": 903842, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfe7b10dbda86c6cb930c1ae40abfc2c?s=128&d=identicon&r=PG", "display_name": "Nimir", "link": "https://stackoverflow.com/users/903842/nimir"}, "edited": false, "score": 0, "creation_date": 1482845971, "post_id": 41346217, "comment_id": 69894237, "body": "it might help to add the code/command you used to test db is empty?"}, {"owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "edited": false, "score": 1, "creation_date": 1482851398, "post_id": 41346217, "comment_id": 69896866, "body": "i think what you are looking for is to fill your database with seed content <code>bundle exec rake db:seed</code>"}, {"owner": {"reputation": 93, "user_id": 5990280, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a9a1aa7bd8a127769c03c10c171a9aa0?s=128&d=identicon&r=PG&f=1", "display_name": "keerthana", "link": "https://stackoverflow.com/users/5990280/keerthana"}, "reply_to_user": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "edited": false, "score": 0, "creation_date": 1482901907, "post_id": 41346217, "comment_id": 69913107, "body": "@sa77 Thank you very much! That solved it! Also, I&#39;m curious to know what the problem had been and what does <code>bundle exec rake db:seed</code> mean?"}, {"owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "edited": false, "score": 0, "creation_date": 1482902025, "post_id": 41346217, "comment_id": 69913147, "body": "<code>bundle exec rake db:seed</code> fills up your database with initial data (seed data) for your database. you can define your seed data in <code>db&#47;seeds.rb</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7752, "user_id": 1087469, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/84cd9fd20832381fc78084aac4cb4b6c?s=128&d=identicon&r=PG", "display_name": "leifg", "link": "https://stackoverflow.com/users/1087469/leifg"}, "is_accepted": false, "score": 1, "last_activity_date": 1482847772, "creation_date": 1482847772, "answer_id": 41346714, "question_id": 41346217, "link": "https://stackoverflow.com/questions/41346217/bundle-exec-rake-dbmigrate-worked-but-development-sqlite3-is-empty/41346714#41346714", "title": "bundle exec rake db:migrate worked, but development.sqlite3 is empty", "body": "<p>So <code>bundle exec rake db:test:prepare</code> probably sets your environment to test.</p>\n\n<p>That would be the reason why you'll end up with a working test database.</p>\n\n<p>If you want to have the data in the development database, you need to set the environment to development.</p>\n\n<p>Try <code>RACK_ENV=development bundle exec rake db:test:prepare</code>.</p>\n\n<p>Although the cleaner solution is to create a seed file. See: <a href=\"http://edgeguides.rubyonrails.org/active_record_migrations.html#migrations-and-seed-data\" rel=\"nofollow noreferrer\">http://edgeguides.rubyonrails.org/active_record_migrations.html#migrations-and-seed-data</a> </p>\n"}], "owner": {"reputation": 93, "user_id": 5990280, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a9a1aa7bd8a127769c03c10c171a9aa0?s=128&d=identicon&r=PG&f=1", "display_name": "keerthana", "link": "https://stackoverflow.com/users/5990280/keerthana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1482942855, "creation_date": 1482845791, "last_edit_date": 1482942855, "question_id": 41346217, "link": "https://stackoverflow.com/questions/41346217/bundle-exec-rake-dbmigrate-worked-but-development-sqlite3-is-empty", "title": "bundle exec rake db:migrate worked, but development.sqlite3 is empty", "body": "<p>I'm new to RoR. The following line executed normally:</p>\n\n<pre><code>bundle exec rake db:migrate  \n</code></pre>\n\n<p>Output showed that it is migrated. <code>development.sqlite3</code> and <code>production.sqlite3</code> were created but empty, although schema.rb was written properly. The users table was successfully created, but without any records. Also I executed:</p>\n\n<pre><code>bundle exec rake db:test:prepare  \n</code></pre>\n\n<p><code>test.sqlite3</code> is created and also written properly. This is the content of the file inside the migration file:</p>\n\n<pre><code>class CreateUsers &lt; ActiveRecord::Migration\n def change\n  create_table :users do |t|\n   t.string :name\n   t.string :email\n\n   t.timestamps\n  end\n end\nend\n</code></pre>\n\n<p>Kindly help me solve the problem. Let me know if any other details need to be specified.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1482845763, "post_id": 41346165, "comment_id": 69894144, "body": "Is &quot;Expected response to be a , but was &lt;200&gt;&quot; the full error?"}, {"owner": {"reputation": 131, "user_id": 7068409, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b6d842dc40dba7077f68f7aeadab2c32?s=128&d=identicon&r=PG&f=1", "display_name": "HAYATO SHIBA", "link": "https://stackoverflow.com/users/7068409/hayato-shiba"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1482846718, "post_id": 41346165, "comment_id": 69894583, "body": "Sorry, there is &quot;Failure/Error: expect(response).to redirect_to root_path&quot;  above the error."}, {"owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "edited": false, "score": 0, "creation_date": 1482851581, "post_id": 41346165, "comment_id": 69896953, "body": "<code>visit</code> is a capybara method used in integration/feature specs with rspec, <code>get</code> is generally used for controller/routing specs. these are DSL to make the tests more readable.. in the background, visit does a GET request to the route"}, {"owner": {"reputation": 131, "user_id": 7068409, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b6d842dc40dba7077f68f7aeadab2c32?s=128&d=identicon&r=PG&f=1", "display_name": "HAYATO SHIBA", "link": "https://stackoverflow.com/users/7068409/hayato-shiba"}, "edited": false, "score": 0, "creation_date": 1482882222, "post_id": 41346165, "comment_id": 69909180, "body": "Oh,I see! Thank you for your precise summary!"}], "answers": [{"comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1482862640, "post_id": 41347483, "comment_id": 69901979, "body": "The article linked to explains it perfectly, and the Capybara::DSL methods shouldn&#39;t be included/available in your controller specs at all."}, {"owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1482862885, "post_id": 41347483, "comment_id": 69902095, "body": "I would agree that they write better than me"}, {"owner": {"reputation": 131, "user_id": 7068409, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b6d842dc40dba7077f68f7aeadab2c32?s=128&d=identicon&r=PG&f=1", "display_name": "HAYATO SHIBA", "link": "https://stackoverflow.com/users/7068409/hayato-shiba"}, "edited": false, "score": 0, "creation_date": 1482882276, "post_id": 41347483, "comment_id": 69909190, "body": "I didn&#39;t see it... Thank you!"}], "tags": [], "owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "is_accepted": true, "score": 3, "last_activity_date": 1482850955, "last_edit_date": 1592644375, "creation_date": 1482850955, "answer_id": 41347483, "question_id": 41346165, "link": "https://stackoverflow.com/questions/41346165/rspec-and-capybara-what-is-the-difference-between-visit-and-get/41347483#41347483", "title": "Rspec and Capybara , what is the difference between visit and get", "body": "<blockquote>\n<p>Capybara, being an acceptance test framework, does not expose low-level details like a request or response object. In order to access a web page using Capybara, the developer needs to use the method visit (instead of get). To read the accessed page body, the developer must use page instead of manipulating the response.</p>\n</blockquote>\n<p>you can read more &quot;<a href=\"http://blog.plataformatec.com.br/2012/06/improving-the-integration-between-capybara-and-rspec/\" rel=\"nofollow noreferrer\">Improving the integration between Capybara and RSpec</a>&quot;</p>\n<p>I hope that this helps</p>\n"}], "owner": {"reputation": 131, "user_id": 7068409, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b6d842dc40dba7077f68f7aeadab2c32?s=128&d=identicon&r=PG&f=1", "display_name": "HAYATO SHIBA", "link": "https://stackoverflow.com/users/7068409/hayato-shiba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1477, "favorite_count": 0, "accepted_answer_id": 41347483, "answer_count": 1, "score": 1, "last_activity_date": 1482850955, "creation_date": 1482845530, "last_edit_date": 1495541784, "question_id": 41346165, "link": "https://stackoverflow.com/questions/41346165/rspec-and-capybara-what-is-the-difference-between-visit-and-get", "title": "Rspec and Capybara , what is the difference between visit and get", "body": "<p>My spec/controllers/undertakings_controller_spec.rb is below.</p>\n\n<pre><code> RSpec.describe UndertakingsController, type: :controller do\n     describe 'redirect with home due to login user' do\n      subject {current_path}\n      it 'can get with authenticate undertaking user' do\n        login_user @undertaking.user\n         #get :show , id: @undertaking\n         visit undertaking_path(@undertaking)\n         expect(response).to redirect_to root_path\n      end\n    end\nend\n</code></pre>\n\n<p>This has error (Expected response to be a , but was &lt;200>).\nBut when I change ( visit undertaking_path(@undertaking) ) to ( get :show , id: @undertaking ) , this does not have the error. What is the difference between visit and get? I read  </p>\n\n<p><a href=\"https://stackoverflow.com/questions/11090038/rspec-and-capybara-difference-between-visit-and-get-methods-with-regards-to-th\">Rspec and capybara, difference between visit and get methods, with regards to the current_path object</a></p>\n\n<p>but I can't understand the error in this case. Please help me.</p>\n\n<p>Anyway, My controllers/undertakings_controller.rb is below.</p>\n\n<pre><code>      class UndertakingsController &lt; ApplicationController\n         before_action :undertaking_not_have_comment , only: [:show]\n         def show\n           @undertaking=Undertaking.find(params[:id])\n           @asking=@undertaking.asking\n           @comment=Comment.new do |c|\n            c.user=current_user\n           end\n         end\n\n         private\n         def undertaking_not_have_comment\n             @undertaking=Undertaking.find(params[:id])\n             if current_user == @undertaking.user\n               unless @undertaking.comments.count &gt; 0\n               redirect_to root_path\n             end\n         end\n       end\n</code></pre>\n"}, {"tags": ["ruby", "sass", "rubygems"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1482845585, "post_id": 41346119, "comment_id": 69894075, "body": "Tried this: <a href=\"http://www.microsoftfixit.net/the-connection-has-been-broken-due-to-keep-alive-activity-detecting-a-failure-while-the-operation-was-in-progress/\" rel=\"nofollow noreferrer\">microsoftfixit.net/&hellip;</a> ?"}, {"owner": {"reputation": 983, "user_id": 2671891, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/rdyRi.jpg?s=128&g=1", "display_name": "Hamid Ghorashi", "link": "https://stackoverflow.com/users/2671891/hamid-ghorashi"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1482846188, "post_id": 41346119, "comment_id": 69894349, "body": "This doesn&#39;t work. I guess the problem is all about proxy setting or something. I connected to the Internet though an ISA server."}], "owner": {"reputation": 983, "user_id": 2671891, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/rdyRi.jpg?s=128&g=1", "display_name": "Hamid Ghorashi", "link": "https://stackoverflow.com/users/2671891/hamid-ghorashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482845357, "creation_date": 1482845357, "question_id": 41346119, "link": "https://stackoverflow.com/questions/41346119/raising-error-while-installing-sass", "title": "Raising error while installing sass", "body": "<p>I've installed ruby 2.3.3 on my system. Now, I'm trying to install sass but the following error is raising:</p>\n\n<pre><code>C:\\&gt;gem -v\n2.5.2\n\nC:\\&gt;gem install sass\nERROR:  While executing gem ... (Errno::ENETRESET)\nThe connection has been broken due to keep-alive\ne while the operation was in progress. - recvfrom(2)\n</code></pre>\n\n<p>Does anyone know how to fix it?</p>\n"}, {"tags": ["ruby", "parsing", "design-patterns", "data-processing"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482849360, "post_id": 41345852, "comment_id": 69895882, "body": "Do you have an example for params and endpoint, and what should be returned by the method?"}], "answers": [{"comments": [{"owner": {"reputation": 10306, "user_id": 228521, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1ce2f9acebdd4b2b56766a565fcf6ef7?s=128&d=identicon&r=PG", "display_name": "Amit Erandole", "link": "https://stackoverflow.com/users/228521/amit-erandole"}, "edited": false, "score": 0, "creation_date": 1482845870, "post_id": 41346114, "comment_id": 69894186, "body": "So are you suggesting I separate each kind of parsing strategy into its own type expressed as a lambda? Then I pipe the results as an array into a query pipeline etc? Is that what is happening here?"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1482846102, "last_edit_date": 1482846102, "creation_date": 1482845342, "answer_id": 41346114, "question_id": 41345852, "link": "https://stackoverflow.com/questions/41345852/what-programming-patterns-or-strategy-should-i-use-to-deal-with-small-inconsiste/41346114#41346114", "title": "What programming patterns or strategy should I use to deal with small inconsistencies in data processing?", "body": "<pre><code>plain = %i|limit skip asc desc| # plain values\nbuilt = { include: -&gt;(input) { build_references(input) } } # procs\n\nquery = (plain | built).map do |p|\n  case p\n  when Symbol then params[p]\n  when Array  then p.last.(params[p.first])\n  end\nend.reject(&amp;:blank?).map(&amp;:to_query).join(\"&amp;\")\n\n[endpoint, query].join\n</code></pre>\n\n<p>Basically, you have two types of parameters: those you are to pass through as is (like <code>:limit</code>,) and those, you are to transform (like <code>:include</code>.)</p>\n\n<p>Former are just passed through, latter are transformed using the list of lambdas specified in the very beginning of this snippet.</p>\n\n<p>Since you were using <code>to_query</code> in the original question, I suggest you use <code>rails</code>, hence you have <code>blank?</code> method on hand and there is no need to explicitly check for empty strings and/or zeroes.</p>\n\n<p>In the last step, we reject blanks and join everything with an ampersand.</p>\n"}], "owner": {"reputation": 10306, "user_id": 228521, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1ce2f9acebdd4b2b56766a565fcf6ef7?s=128&d=identicon&r=PG", "display_name": "Amit Erandole", "link": "https://stackoverflow.com/users/228521/amit-erandole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 41346114, "answer_count": 1, "score": 0, "last_activity_date": 1482846102, "creation_date": 1482844295, "question_id": 41345852, "link": "https://stackoverflow.com/questions/41345852/what-programming-patterns-or-strategy-should-i-use-to-deal-with-small-inconsiste", "title": "What programming patterns or strategy should I use to deal with small inconsistencies in data processing?", "body": "<p>In the ruby gem I am writing I have to take in as input certain known query parameters and massage them into a query string and then use that constructed (url) string as a rest endpoint to retrieve that data.</p>\n\n<p>Now there are some weird inconsistencies in inputs coming in and I am forking my code to normalize inputs into a consistent output.</p>\n\n<pre><code>   def build_query(params, endpoint)\n      limit      = Hash[limit:      params[:limit]   ||  0]\n      skip       = Hash[skip:       params[:skip]    ||  0]\n      asc        = Hash[asc:        params[:asc]     || \"\"]\n      desc       = Hash[desc:       params[:desc]    || \"\"]\n\n      query = [limit, skip, asc, desc].select { |hash| hash.values.none? { |val| val == '' || val == 0 } }\n      encoded = query.map{ |q| q.to_query }.join(\"&amp;\")\n\n      references = build_references(params[:include]) || \"\"\n\n      query_string = references.empty? ? \"#{endpoint}#{encoded}\" : \"#{endpoint}#{references}&amp;#{encoded}\"\n    end\n</code></pre>\n\n<p>You will see above that the <code>references</code> piece of the <code>params</code> are not handled the same way as the rest of the parameters. There are more slightly inconsistent edge cases coming soon. And the only way I know how to deal with these is to keep forking my code inside this function. It's going to get messy soon!</p>\n\n<p>So how should I now refactor this code? Where should I go from here to manage this complexity? Should I use collaborating objects (<code>ParamsBuilder</code> or <code>QueryManager</code>) and some kind of polymorphism strategy?</p>\n\n<p>I would like to keep my code simple and functional as much as possible.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongoid"], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 0, "last_activity_date": 1482843372, "creation_date": 1482843372, "answer_id": 41345643, "question_id": 41345576, "link": "https://stackoverflow.com/questions/41345576/how-to-query-a-field-by-name-on-mongoid/41345643#41345643", "title": "How to query a field by name on mongoid?", "body": "<p>You can make use of <code>send</code></p>\n\n<pre><code>Test.where(name: \"Depeche Mode\").send(@desired_field.to_sym)\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 3146542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d83228d0b7e595ba1f6873abd9ac889?s=128&d=identicon&r=PG&f=1", "display_name": "marouane18", "link": "https://stackoverflow.com/users/3146542/marouane18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 41345643, "answer_count": 1, "score": 0, "last_activity_date": 1482916395, "creation_date": 1482843071, "last_edit_date": 1482916395, "question_id": 41345576, "link": "https://stackoverflow.com/questions/41345576/how-to-query-a-field-by-name-on-mongoid", "title": "How to query a field by name on mongoid?", "body": "<p>How can I get the same query's result :</p>\n\n<pre><code>Test.where(name: \"Depeche Mode\").first.last_connection_date\n</code></pre>\n\n<p>Changing <code>last_connection_date</code> by a String</p>\n\n<pre><code>@desired_field = \"last_connection_date\"\nTest.where(name: \"Depeche Mode\").first.(@desired_field)\n</code></pre>\n"}, {"tags": ["ruby", "html", "forms"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1482844916, "post_id": 41345499, "comment_id": 69893769, "body": "What do you mean by &quot;does not work&quot;? Does it not send any request? Does it not send the params? Or wrong params?"}, {"owner": {"reputation": 17065, "user_id": 175981, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b357ab54946a2be4d19c8a9aab2a09d6?s=128&d=identicon&r=PG", "display_name": "Chris Peters", "link": "https://stackoverflow.com/users/175981/chris-peters"}, "edited": false, "score": 0, "creation_date": 1482845337, "post_id": 41345499, "comment_id": 69893957, "body": "Why are you opening 2 separate forms like that?"}], "answers": [{"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 33, "user_id": 7207339, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/fxAPe.jpg?s=128&g=1", "display_name": "Daniel Gomez Firmat", "link": "https://stackoverflow.com/users/7207339/daniel-gomez-firmat"}, "edited": false, "score": 0, "creation_date": 1482845456, "post_id": 41346067, "comment_id": 69894012, "body": "Although you don&#39;t need to add that first form tag to make it work."}], "tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 0, "last_activity_date": 1482845177, "creation_date": 1482845177, "answer_id": 41346067, "question_id": 41345499, "link": "https://stackoverflow.com/questions/41345499/uploading-a-picture-form/41346067#41346067", "title": "Uploading a picture &lt;form&gt;", "body": "<p>I think when you do this:</p>\n\n<pre><code>&lt;form accept-charset=\"UTF-8\" action=\"/projects\" method=\"post\"&gt;\n&lt;%= form_for(@project, html: { multipart: true }) do |f| %&gt;\n</code></pre>\n\n<p>you are opening a <code>&lt;form&gt;</code> tag in the first statement. When you render another form using rails helper <code>form_for</code>, it gets nested inside the first form. This is my guess from the limited question description.</p>\n\n<p>You can try doing:</p>\n\n<pre><code>&lt;form accept-charset=\"UTF-8\" action=\"/projects\" method=\"post\"&gt;&lt;/form&gt;\n&lt;%= form_for(@project, html: { multipart: true }) do |f| %&gt;\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7207339, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/fxAPe.jpg?s=128&g=1", "display_name": "Daniel Gomez Firmat", "link": "https://stackoverflow.com/users/7207339/daniel-gomez-firmat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 41346067, "answer_count": 1, "score": 0, "last_activity_date": 1482845177, "creation_date": 1482842762, "question_id": 41345499, "link": "https://stackoverflow.com/questions/41345499/uploading-a-picture-form", "title": "Uploading a picture &lt;form&gt;", "body": "<p>I'm trying to add a picture uploader to my form and although I got it working I dont understand something.</p>\n\n<p>So the form works when I have it like this:</p>\n\n<pre><code>&lt;%= form_for(@project, html: { multipart: true }) do |f| %&gt; \n</code></pre>\n\n<p>But it does not when I add this:</p>\n\n<pre><code>&lt;form accept-charset=\"UTF-8\" action=\"/projects\" method=\"post\"&gt;\n&lt;%= form_for(@project, html: { multipart: true }) do |f| %&gt;\n</code></pre>\n\n<p>What am I missing out?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 463, "user_id": 3527552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001213035230/picture?type=large", "display_name": "Tushar Pal", "link": "https://stackoverflow.com/users/3527552/tushar-pal"}, "edited": false, "score": 0, "creation_date": 1482842167, "post_id": 41345303, "comment_id": 69892524, "body": "it might be a problem with the environment please crosscheck in the environment folder of config is the any production.rb present or not?"}, {"owner": {"reputation": 239, "user_id": 6270878, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-oocS_3xNWtE/AAAAAAAAAAI/AAAAAAAAADM/cColmDJee7s/photo.jpg?sz=128", "display_name": "Prakash Bhavnath", "link": "https://stackoverflow.com/users/6270878/prakash-bhavnath"}, "reply_to_user": {"reputation": 463, "user_id": 3527552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001213035230/picture?type=large", "display_name": "Tushar Pal", "link": "https://stackoverflow.com/users/3527552/tushar-pal"}, "edited": false, "score": 0, "creation_date": 1482842379, "post_id": 41345303, "comment_id": 69892619, "body": "production.rb present in /config/environments/ directory. &quot; No such file or directory&quot; occurs due to &#39;nohup&#39; command"}, {"owner": {"reputation": 463, "user_id": 3527552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001213035230/picture?type=large", "display_name": "Tushar Pal", "link": "https://stackoverflow.com/users/3527552/tushar-pal"}, "edited": false, "score": 0, "creation_date": 1482842752, "post_id": 41345303, "comment_id": 69892794, "body": "did you try this nohup rake jobs:work RAILS_ENV=production"}, {"owner": {"reputation": 239, "user_id": 6270878, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-oocS_3xNWtE/AAAAAAAAAAI/AAAAAAAAADM/cColmDJee7s/photo.jpg?sz=128", "display_name": "Prakash Bhavnath", "link": "https://stackoverflow.com/users/6270878/prakash-bhavnath"}, "reply_to_user": {"reputation": 463, "user_id": 3527552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001213035230/picture?type=large", "display_name": "Tushar Pal", "link": "https://stackoverflow.com/users/3527552/tushar-pal"}, "edited": false, "score": 0, "creation_date": 1482843018, "post_id": 41345303, "comment_id": 69892919, "body": "Hey thanks, it&#39;s working fine."}, {"owner": {"reputation": 463, "user_id": 3527552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001213035230/picture?type=large", "display_name": "Tushar Pal", "link": "https://stackoverflow.com/users/3527552/tushar-pal"}, "edited": false, "score": 0, "creation_date": 1482843289, "post_id": 41345303, "comment_id": 69893039, "body": "approve my answer below if agree"}], "answers": [{"tags": [], "owner": {"reputation": 617, "user_id": 4244982, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/hYZVT.jpg?s=128&g=1", "display_name": "sheepdog", "link": "https://stackoverflow.com/users/4244982/sheepdog"}, "is_accepted": false, "score": 11, "last_activity_date": 1482846091, "last_edit_date": 1482846091, "creation_date": 1482843078, "answer_id": 41345579, "question_id": 41345303, "link": "https://stackoverflow.com/questions/41345303/rails-rake-task-execute-in-rails-env-production-with-nohup/41345579#41345579", "title": "Rails &#39;rake task&#39; execute in \u2018RAILS_ENV=production&#39; with nohup", "body": "<p>Set the environment variable before the <code>nohup</code> command.  </p>\n\n<pre><code>RAILS_ENV=production nohup rake jobs:work\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 463, "user_id": 3527552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001213035230/picture?type=large", "display_name": "Tushar Pal", "link": "https://stackoverflow.com/users/3527552/tushar-pal"}, "is_accepted": false, "score": 4, "last_activity_date": 1482843251, "creation_date": 1482843251, "answer_id": 41345619, "question_id": 41345303, "link": "https://stackoverflow.com/questions/41345303/rails-rake-task-execute-in-rails-env-production-with-nohup/41345619#41345619", "title": "Rails &#39;rake task&#39; execute in \u2018RAILS_ENV=production&#39; with nohup", "body": "<p>Try this one </p>\n\n<pre><code>  nohup rake jobs:work RAILS_ENV=production\n</code></pre>\n\n<p>I have commented the solution above as well</p>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 4, "last_activity_date": 1482858623, "creation_date": 1482858623, "answer_id": 41349286, "question_id": 41345303, "link": "https://stackoverflow.com/questions/41345303/rails-rake-task-execute-in-rails-env-production-with-nohup/41349286#41349286", "title": "Rails &#39;rake task&#39; execute in \u2018RAILS_ENV=production&#39; with nohup", "body": "<p>If you need <code>nohup</code> functionality, you should also consider <a href=\"https://www.howtoforge.com/linux_screen\" rel=\"nofollow noreferrer\">screen</a>.</p>\n\n<pre><code>RAILS_ENV=production screen -L rake jobs:work\n</code></pre>\n\n<p>It starts a new terminal which isn't bound to your current session.</p>\n\n<p>To come back to your normal terminal, type <code>Ctrl+a</code> and then <code>d</code>. You can now log out safely without terminating the <code>rake</code> task.</p>\n\n<p>As a bonus, you automatically get a log file in <code>screenlog.0</code>.</p>\n\n<p>You can come back to your rake process by typing :</p>\n\n<pre><code>screen -r\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 6270878, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-oocS_3xNWtE/AAAAAAAAAAI/AAAAAAAAADM/cColmDJee7s/photo.jpg?sz=128", "display_name": "Prakash Bhavnath", "link": "https://stackoverflow.com/users/6270878/prakash-bhavnath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2290, "favorite_count": 2, "answer_count": 3, "score": 6, "last_activity_date": 1482858623, "creation_date": 1482841978, "last_edit_date": 1482842553, "question_id": 41345303, "link": "https://stackoverflow.com/questions/41345303/rails-rake-task-execute-in-rails-env-production-with-nohup", "title": "Rails &#39;rake task&#39; execute in \u2018RAILS_ENV=production&#39; with nohup", "body": "<p>I have <code>rake</code> task which continuously need to be active. Whenever I ran it by command  </p>\n\n<pre><code>RAILS_ENV=production rake jobs:abc   \n</code></pre>\n\n<p>it works fine but when I close terminal <code>rake</code> job get stopped.So I found other solution on it by using <code>nohup</code> to run it in background.</p>\n\n<p>I execute command:  </p>\n\n<pre><code>nohup RAILS_ENV=production rake jobs:work &amp;\n</code></pre>\n\n<p>but it gives error:</p>\n\n<blockquote>\n  <p>nohup: failed to run command \u2018RAILS_ENV=production\u2019: No such file or directory</p>\n</blockquote>\n\n<p>Please suggest, to way execute <code>rake</code> task in a production environment.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482858688, "post_id": 41345253, "comment_id": 69900219, "body": "Did you write anything for the mail parsing part?"}, {"owner": {"reputation": 73, "user_id": 5691295, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/9eb2cc2181a5118441f02ae37142450d?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar Nikhil", "link": "https://stackoverflow.com/users/5691295/kumar-nikhil"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482915919, "post_id": 41345253, "comment_id": 69918739, "body": "No, Actually I didn&#39;t get how to parse?"}], "owner": {"reputation": 73, "user_id": 5691295, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/9eb2cc2181a5118441f02ae37142450d?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar Nikhil", "link": "https://stackoverflow.com/users/5691295/kumar-nikhil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482842535, "creation_date": 1482841796, "last_edit_date": 1482842535, "question_id": 41345253, "link": "https://stackoverflow.com/questions/41345253/rails-application-for-parsing-content-and-filter-only-the-reply-part-using-gmail", "title": "Rails Application for parsing content and filter only the reply part using gmail gem", "body": "<p>What I want to do is using scheduler task which checks for the incoming emails periodically and Parse the content and filter only the reply part of comments using gmail gem.I wrote scheduler task but I am not getting how to parse the content and filter only reply parts?</p>\n\n<p>I have created rake task like this: </p>\n\n<pre><code>namespace :mail_comment do\n  desc \"TODO\"\n  task reply_to_comments: :environment do\n\n  end\n end\n</code></pre>\n\n<p>I have used whenever gem for that and inside schedule.rb, I wrote</p>\n\n<pre><code>every 1.day do\n  rake \"mail_comment:reply_to_comments\"\nend\n</code></pre>\n\n<p>Could anyone please help me regarding this doubt? Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1482841510, "creation_date": 1482841510, "answer_id": 41345178, "question_id": 41344950, "link": "https://stackoverflow.com/questions/41344950/not-able-to-place-csv-data-in-a-hash/41345178#41345178", "title": "Not able to place csv data in a Hash", "body": "<p>First of all, you are collecting strings into an array (see <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-inspect\" rel=\"nofollow noreferrer\"><code>String#inspect</code></a>):</p>\n\n<pre><code>file_details &lt;&lt; row.inspect\n</code></pre>\n\n<p>After that you call (sic!) <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\"><code>String#[]</code></a> on that strings:</p>\n\n<pre><code>x['PPS_Id'] #\u21d2\u00a0\"PPS_Id\", because string contains this substring\n</code></pre>\n\n<p>That said, your code has nothing but errors. You might achieve what you want with:</p>\n\n<pre><code>csv = CSV.parse(File.read(\"filename.CSV\"), col_sep: \"\\s\")\ncsv[1..-1].to_h\n#\u21d2 {\n#    \"123\" =&gt; \"100\",\n#   \"1234\" =&gt; \"150\"\n# }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1482842248, "post_id": 41345202, "comment_id": 69892557, "body": "<code>Hash[*[[&quot;PPS_Id&quot;, &quot;Amount&quot;], [&quot;123&quot;, &quot;100&quot;], [&quot;1234&quot;, &quot;150&quot;]].flatten] =&gt; {&quot;PPS_Id&quot;=&gt;&quot;Amount&quot;, &quot;123&quot;=&gt;&quot;100&quot;, &quot;1234&quot;=&gt;&quot;150&quot;}</code>"}], "tags": [], "owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "is_accepted": false, "score": 1, "last_activity_date": 1482841934, "last_edit_date": 1482841934, "creation_date": 1482841596, "answer_id": 41345202, "question_id": 41344950, "link": "https://stackoverflow.com/questions/41344950/not-able-to-place-csv-data-in-a-hash/41345202#41345202", "title": "Not able to place csv data in a Hash", "body": "<p>Using <code>inspect</code> will save your CSV rows as strings, so obviously you won't be able get what you need. Instead try this:</p>\n\n<pre><code>file_details = CSV.read(\"filename.csv\")\n</code></pre>\n\n<p>Read CSV directly will create an 2D array that you can then iterate over, which will look like this: <code>[[\"PPS_Id\", \"Amount\"], [\"123\", \"100\"], [\"1234\", \"150\"]]</code></p>\n\n<p>From there you can slightly modify your approach:</p>\n\n<pre><code>file_details.each do |key, value|\n  file_details_hash[key] = value\nend\n</code></pre>\n\n<p>To receive a hash like this: <code>{\"PPS_Id\"=&gt;\"Amount\", \"123\"=&gt;\"100\", \"1234\"=&gt;\"150\"}</code></p>\n"}, {"comments": [{"owner": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "edited": false, "score": 0, "creation_date": 1482916248, "post_id": 41347314, "comment_id": 69918914, "body": "I rather ended using the below code, using your logic:    <code>CSV.foreach(&quot;filename.CSV&quot;, headers: false) do |row| file_details[row[0]] = row[1] end</code>"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 1, "last_activity_date": 1482850271, "creation_date": 1482850271, "answer_id": 41347314, "question_id": 41344950, "link": "https://stackoverflow.com/questions/41344950/not-able-to-place-csv-data-in-a-hash/41347314#41347314", "title": "Not able to place csv data in a Hash", "body": "<h1>Your code, modified to work</h1>\n\n<p>You need to specify the column separator for your csv, and remove <code>inspect</code>.</p>\n\n<pre><code>require 'csv'\n\nfile_details = []\nCSV.foreach(\"filename.CSV\", headers: true, col_sep: \"\\s\" ) do |row|\n  file_details &lt;&lt; row\nend\n\nfile_details_hash = Hash.new\nfile_details.each { |x|\n  file_details_hash[x['PPS_Id']] = x['Amount']\n}\n\np file_details_hash\n#=&gt; {\"123\"=&gt;\"100\", \"1234\"=&gt;\"150\"}\n</code></pre>\n\n<p>It now returns what you expected to get.</p>\n\n<h1>Shorter solution</h1>\n\n<p>Read the csv, drop the first line (header) and convert to a Hash :</p>\n\n<pre><code>p CSV.read(\"filename.CSV\", col_sep: \"\\s\").drop(1).to_h\n#=&gt; {\"123\"=&gt;\"100\", \"1234\"=&gt;\"150\"}\n</code></pre>\n"}], "owner": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 1, "accepted_answer_id": 41347314, "answer_count": 3, "score": 3, "last_activity_date": 1482850271, "creation_date": 1482840622, "last_edit_date": 1482841329, "question_id": 41344950, "link": "https://stackoverflow.com/questions/41344950/not-able-to-place-csv-data-in-a-hash", "title": "Not able to place csv data in a Hash", "body": "<p>I have a CSV file with two columns:</p>\n\n<pre><code>PPS_Id Amount\n123    100\n1234   150\n</code></pre>\n\n<p>I read data from this file and insert in a array using the code below:</p>\n\n<pre><code>CSV.foreach(\"filename.CSV\", headers: true) do |row|\n  file_details &lt;&lt; row.inspect # hash\nend\n</code></pre>\n\n<p>I am then trying to push the data in the <code>file_details</code> into a hash with <code>PPS_Id</code> as key and <code>Amount</code> as Value, I am using the code below:</p>\n\n<pre><code>file_details_hash = Hash.new\n\nfile_details.each { |x|  \n  file_details_hash[x['PPS_Id']] = x['Amount']\n}\n</code></pre>\n\n<p>But when I print the result I get nothing just <code>{\"PPS_Id\"=&gt;\"Amount\"}</code></p>\n\n<p>Can you please help</p>\n"}, {"tags": ["ruby", "cucumber", "watir-webdriver"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7345567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPAQ2.jpg?s=128&g=1", "display_name": "mahesh", "link": "https://stackoverflow.com/users/7345567/mahesh"}, "edited": false, "score": 0, "creation_date": 1482841302, "post_id": 41344875, "comment_id": 69892085, "body": "Hi!! Thank you for the response."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 3, "user_id": 7345567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPAQ2.jpg?s=128&g=1", "display_name": "mahesh", "link": "https://stackoverflow.com/users/7345567/mahesh"}, "edited": false, "score": 1, "creation_date": 1482857688, "post_id": 41344875, "comment_id": 69899755, "body": "You&#39;re welcome. If you want to thank the answerer, and if the answer resolves your problem, please consider accepting the answer."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1482840345, "creation_date": 1482840345, "answer_id": 41344875, "question_id": 41344585, "link": "https://stackoverflow.com/questions/41344585/cucumber-using-ruby/41344875#41344875", "title": "Cucumber using Ruby", "body": "<p>As you said, it doesn't work because <code>@obj</code> are 2 different Ruby objects in two different files.</p>\n\n<p>You could set a <code>default_count</code> for <code>Count::RowCount</code>. (Note that I changed the case to the standard Ruby one).</p>\n\n<pre><code>module Count\n  class RowCount\n    class &lt;&lt; self\n      attr_accessor :default_count\n    end\n\n    # constructor method \n    def initialize(cnt = RowCount.default_count) \n      @count = cnt \n    end \n    # instance method \n    def print_count \n      @row_value =  @count \n      puts \"#{@count}\" \n      puts \"#{@row_value}\" \n      return @count   \n    end \n  end \nend\n\n# file1.rb\n@obj = Count::RowCount.new(10)\n@obj.print_count\n# 10\n# 10\n\n# Set the default count to 5 for any future RowCount :\nCount::RowCount.default_count = 5\n\n# file2.rb\n@obj = Count::RowCount.new\n@obj.print_count\n# 5\n# 5\n\n# It's still possible to override the default value\n@obj = Count::RowCount.new(15)\n@obj.print_count\n# 15\n# 15\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7345567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPAQ2.jpg?s=128&g=1", "display_name": "mahesh", "link": "https://stackoverflow.com/users/7345567/mahesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1482841020, "creation_date": 1482839127, "last_edit_date": 1482841020, "question_id": 41344585, "link": "https://stackoverflow.com/questions/41344585/cucumber-using-ruby", "title": "Cucumber using Ruby", "body": "<p>I am working on Automation using watir-webdriver.\nThere are 3 ruby files, lets name is as File1.rb, File2.rb and Commnn_file.rb</p>\n\n<p>The scenario is as follows:\nI compute the count value in File1.rb, say count=10 and pass it on to Commnn_file.rb. I have written a class within a module which will hold the value computed in File1.rb.</p>\n\n<p>Now, I want to retrieve the count value in File2.rb file. How can I do this?</p>\n\n<p>Below is the code snippet:</p>\n\n<h2>Commnn_file.rb</h2>\n\n<pre><code>module Count    \n class Row_count \n   # constructor method \n   def initialize(cnt) \n     @count = cnt \n   end \n   # instance method \n   def printCount \n     @row_value =  @count \n     puts \"#{@count}\" \n     puts \"#{@row_value}\" \n     return @count   \n   end \n end \nend\n</code></pre>\n\n<h2>File1.rb</h2>\n\n<pre><code>And(/^I print the row count$/) do\n  include Web_url\n  @obj = Web_url::Row_count\n  puts \"Step 2 count\"\n  # puts @obj\n  obj.printCount()\nend\n</code></pre>\n\n<h2>File2.rb</h2>\n\n<pre><code>And(/^I print the row count$/) do\n  include Count #Count is the module name\n  @obj = Web_url::Row_count\n  puts \"Step 2 count\"\n  # puts @obj\n  obj.printCount()\nend\n</code></pre>\n\n<p>In the above code, the value that is set in File1.rb is not available in File2.rb, which is because every time the object gets instantiated, re-initializes the value.</p>\n\n<p>Can anyone suggest any alternative way of resolving this issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 0, "creation_date": 1482838528, "post_id": 41344288, "comment_id": 69890792, "body": "Use save! on your method and you&#39;ll get a traceback. Post it here if you still didn&#39;t get an idea how to fix it"}], "answers": [{"comments": [{"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 1, "creation_date": 1482843207, "post_id": 41344468, "comment_id": 69893011, "body": "It&#39;s good practice to use self if you are assigning the data to object you can omit self if you are reading the data"}, {"owner": {"reputation": 209, "user_id": 7345475, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EU9d1AHEGnc/AAAAAAAAAAI/AAAAAAAAACg/v2D77bHu9bk/photo.jpg?sz=128", "display_name": "Stephen Lee", "link": "https://stackoverflow.com/users/7345475/stephen-lee"}, "edited": false, "score": 0, "creation_date": 1482874704, "post_id": 41344468, "comment_id": 69906900, "body": "@DeepakMahakale this is what I got in return... I don&#39;t think this works.. <code>Validation failed: Password can&#39;t be blank, Password is too short (minimum is 8 characters) Application Frames All Frames Post#add_interested_user app&#47;models&#47;post.rb, line 182 PostsController#interested app&#47;controllers&#47;posts_controller.rb, line 141 </code>"}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 0, "last_activity_date": 1482838617, "creation_date": 1482838617, "answer_id": 41344468, "question_id": 41344288, "link": "https://stackoverflow.com/questions/41344288/cannot-save-a-record-using-has-many-through-in-rails-5/41344468#41344468", "title": "cannot save a record using has many through in rails 5", "body": "<p>Change this method You don't need to save a through record</p>\n\n<pre><code># add interested user\ndef add_interested_user(user)\n  self.interested_users &lt;&lt; user\nend\n</code></pre>\n"}], "owner": {"reputation": 209, "user_id": 7345475, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EU9d1AHEGnc/AAAAAAAAAAI/AAAAAAAAACg/v2D77bHu9bk/photo.jpg?sz=128", "display_name": "Stephen Lee", "link": "https://stackoverflow.com/users/7345475/stephen-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1482838617, "creation_date": 1482837925, "last_edit_date": 1482838447, "question_id": 41344288, "link": "https://stackoverflow.com/questions/41344288/cannot-save-a-record-using-has-many-through-in-rails-5", "title": "cannot save a record using has many through in rails 5", "body": "<p>I and not able to find why the record cannot be saved into the database...Help me find what I did wrong in my models and controllers.</p>\n\n<h2>User.rb</h2>\n\n<pre><code>has_many :interested_users_lists\nhas_many :interested_posts, through: :interested_users_lists\naccepts_nested_attributes_for :interested_users_lists, :interested_posts\n</code></pre>\n\n<p>...etc</p>\n\n<h2>InterestedUsersList.rb</h2>\n\n<pre><code>class InterestedUsersList &lt; ApplicationRecord\n    # belongs_to :post\n    # belongs_to :users \n    belongs_to :interested_post, class_name: 'Post'    \n    belongs_to :interested_user, class_name: 'User' \nend\n</code></pre>\n\n<h2>Post.rb</h2>\n\n<pre><code>belongs_to :owner, :class_name =&gt; \"User\", :foreign_key =&gt; \"user_id\", touch: true\nhas_many :interested_users_lists, dependent: :destroy\nhas_many :interested_users, through: :interested_users_lists\naccepts_nested_attributes_for :interested_users_lists, :interested_users\n</code></pre>\n\n<p>etc...\nmethod I used:</p>\n\n<pre><code>  # add interested user\n  def add_interested_user(user)\n   puts \"this is user id:  #{user.id} \"\n   interestedUser = self.interested_users_lists.build(user_id: user.id)\n   interestedUser.save\n   puts \"this is #{interested_users_lists.first.user_id} \"\n  end\n</code></pre>\n\n<h2>Migration file</h2>\n\n<pre><code>class CreateInterestedUsersLists &lt; ActiveRecord::Migration[5.0]\n  def change\n    create_table :interested_users_lists do |t|\n      t.integer :user_id\n      t.integer :post_id\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<h2>posts_controller.rb</h2>\n\n<pre><code>def interested\n @post.add_interested_user(current_user) #cannot be saved...\nend\n...\nprivate\n def post_params\n  params.require(:post).permit(:subject, :price, :category, :street_address, :city, :state, :zip, :condition, :payment_method, :content, post_attachments_attributes: [:id, :post_id, :avatar], \n                                interested_users_lists_attributes: [:id, :post_id, :user_id])\nend\n</code></pre>\n\n<p>development log</p>\n\n<pre><code>  Post Load (0.1ms)  SELECT  \"posts\".* FROM \"posts\" WHERE \"posts\".\"id\" = ? ORDER BY \"posts\".\"created_at\" DESC LIMIT ?  [[\"id\", 1], [\"LIMIT\", 1]]\nthis is user id:  2\n\n   **(0.0ms)  begin transaction\n   (0.1ms)  rollback transaction** _why???_\n\n  InterestedUsersList Load (0.1ms)  SELECT \"interested_users_lists\".* FROM \"interested_users_lists\" WHERE \"interested_users_lists\".\"post_id\" = ?  [[\"post_id\", 1]]\nthis is 2\nRedirected to http://localhost:3000/users/posts/2\nCompleted 302 Found in 77ms (ActiveRecord: 4.9ms)\n\n\nStarted GET \"/users/posts/2\" for ::1 at 2016-12-27 03:04:33 -0800\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "unix", "carrierwave"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1482836256, "post_id": 41343739, "comment_id": 69889678, "body": "Can you access the image if you paste <code>http:&#47;&#47;localhost:3000&#47;Users&#47;nick&#47;CODE&#47;work&#47;biz&#47;parser&#47;public&zwnj;&#8203;&#47;uploads&#47;advert_imag&zwnj;&#8203;e&#47;images&#47;374&#47;micro_3&zwnj;&#8203;117094366.jpg</code> in your browser?"}, {"owner": {"reputation": 13, "user_id": 7182543, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0DXgnp_p1Is/AAAAAAAAAAI/AAAAAAAAADY/rcY_K7cfo-8/photo.jpg?sz=128", "display_name": "Nikita Miloserdov", "link": "https://stackoverflow.com/users/7182543/nikita-miloserdov"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1482837829, "post_id": 41343739, "comment_id": 69890446, "body": "I can&#39;t, but if I type this link <code>&#47;Users&#47;nick&#47;CODE&#47;work&#47;biz&#47;parser&#47;public\u200c\u200b&#47;uploads&#47;advert_ima&zwnj;&#8203;g\u200c\u200be&#47;images&#47;374&#47;micr&zwnj;&#8203;o_3\u200c\u200b117094366.jpg</code> I can see the image."}, {"owner": {"reputation": 109, "user_id": 1495438, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b74a7028e55f89ef38b735f0a5dad148?s=128&d=identicon&r=PG", "display_name": "scs", "link": "https://stackoverflow.com/users/1495438/scs"}, "edited": false, "score": 0, "creation_date": 1482911555, "post_id": 41343739, "comment_id": 69916877, "body": "As you are accessing using application URL, full path of file will not work. Can you check if following URL is accessible. <a href=\"http://localhost:3000/uploads/advert_image/images/374/micro_3117094366.jpg\" rel=\"nofollow noreferrer\">localhost:3000/uploads/advert_image/images/374/&hellip;</a>"}], "owner": {"reputation": 13, "user_id": 7182543, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0DXgnp_p1Is/AAAAAAAAAAI/AAAAAAAAADY/rcY_K7cfo-8/photo.jpg?sz=128", "display_name": "Nikita Miloserdov", "link": "https://stackoverflow.com/users/7182543/nikita-miloserdov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482847184, "creation_date": 1482835848, "last_edit_date": 1482847184, "question_id": 41343739, "link": "https://stackoverflow.com/questions/41343739/render-images-from-enother-project-cause-404not-found-error", "title": "Render images from enother project cause 404(not found) error", "body": "<p>Hello I have to separate projects, <strong>images_project</strong> and <strong>site_project</strong>. <strong>site_project</strong> should render images from <strong>images_project</strong> only in development environment from <em>local machine</em>. In production it does by SDN.</p>\n\n<p>I share <strong>images_project</strong> path from secrets in 'praser_path'.</p>\n\n<p>I added images path to assets config in <strong>site_project</strong>:</p>\n\n<pre><code># config/initializers/assets.rb\n\nif Rails.env.development? &amp;&amp; Rails.application.secrets.parser_path\n   # share parser images for admin\n   Rails.application.config.assets.paths.push(\n     File.join( Rails.application.secrets.parser_path, 'public', 'uploads')\n   )\n  Rails.application.config.assets.precompile += %w( advert_image/** )\nend\n</code></pre>\n\n<p>My model looks for images in local machine </p>\n\n<pre><code># model/image.rb\n\ndef file_url(size=nil)\n  if Rails.env.development? &amp;&amp; Rails.application.secrets.parser_path\n    File.join( Rails.application.secrets.parser_path, 'public', file.url(size))\n  else\n    REMOTE_HOST + file.url(size)\n  end\nend\n</code></pre>\n\n<p>But when a page with my images renders it processes 404 for all images with this error:</p>\n\n<blockquote>\n  <p><a href=\"http://localhost:3000/Users/nick/CODE/work/biz/parser/public/uploads/advert_image/images/374/micro_3117094366.jpg\" rel=\"nofollow noreferrer\">http://localhost:3000/Users/nick/CODE/work/biz/parser/public/uploads/advert_image/images/374/micro_3117094366.jpg</a>\n  Failed to load resource: the server responded with a status of 404\n  (Not Found)</p>\n</blockquote>\n\n<p>I know that the follow link is bad and images is in \n<code>file:///Users/nick/CODE/work/biz/parser/public/uploads/advert_image/images/374/micro_3117094366.jpg</code>\nWhat should I do to get around the server and render images straight from local machine?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 1, "creation_date": 1482833173, "post_id": 41342563, "comment_id": 69888074, "body": "Strong parameters is wrong, take a look here at the second example with nested attributes <a href=\"http://api.rubyonrails.org/classes/ActionController/StrongParameters.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActionController/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7345221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115bfbadf53f851551b404cd6a3badc4?s=128&d=identicon&r=PG&f=1", "display_name": "Kratz", "link": "https://stackoverflow.com/users/7345221/kratz"}, "edited": false, "score": 0, "creation_date": 1482841716, "post_id": 41343058, "comment_id": 69892313, "body": "(byebug) prodinfo_params Unpermitted parameters: producttype, subcategories &lt;ActionController::Parameters {&quot;brandname&quot;=&gt;&quot;Dettol&quot;} permitted: true&gt;"}, {"owner": {"reputation": 2799, "user_id": 3772982, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/91362482c60ebfba88fbdbde79c5fac6?s=128&d=identicon&r=PG&f=1", "display_name": "margo", "link": "https://stackoverflow.com/users/3772982/margo"}, "reply_to_user": {"reputation": 11, "user_id": 7345221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115bfbadf53f851551b404cd6a3badc4?s=128&d=identicon&r=PG&f=1", "display_name": "Kratz", "link": "https://stackoverflow.com/users/7345221/kratz"}, "edited": false, "score": 0, "creation_date": 1482843490, "post_id": 41343058, "comment_id": 69893118, "body": "That error message is giving you a clue - add the unpermitted parameters to the permitted parameters. Also look at the params hash to see how the form parameters should be formatted."}], "tags": [], "owner": {"reputation": 2799, "user_id": 3772982, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/91362482c60ebfba88fbdbde79c5fac6?s=128&d=identicon&r=PG&f=1", "display_name": "margo", "link": "https://stackoverflow.com/users/3772982/margo"}, "is_accepted": false, "score": 0, "last_activity_date": 1482833183, "creation_date": 1482833183, "answer_id": 41343058, "question_id": 41342563, "link": "https://stackoverflow.com/questions/41342563/one-form-three-tables-in-ruby-on-rails/41343058#41343058", "title": "One form three tables in ruby on rails", "body": "<p>It would be helpful if you described what is happening other than saying the producttype and subcategory aren't saving. Look in the logs when you save and I suspect you'll see a message regarding the association attributes not being permitted.</p>\n\n<p>The productinfo_params in the controller needs to permit the attributes of the associations e.g.</p>\n\n<pre><code>def prodinfo_params\n  params.require(:brandname).permit(:brandname, producttypes_attributes: [:content, subcategory_attributes: [:content]]) )\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7345221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115bfbadf53f851551b404cd6a3badc4?s=128&d=identicon&r=PG&f=1", "display_name": "Kratz", "link": "https://stackoverflow.com/users/7345221/kratz"}, "edited": false, "score": 0, "creation_date": 1482842559, "post_id": 41344345, "comment_id": 69892704, "body": "undefined local variable or method `builder&#39; for #&lt;#&lt;Class:0x007fbcb86d8f90&gt;:0x007fbcadde2120&gt;"}, {"owner": {"reputation": 1692, "user_id": 1846073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa52c8a9c7d545a7dae0d1683949627?s=128&d=identicon&r=PG", "display_name": "abo-elleef", "link": "https://stackoverflow.com/users/1846073/abo-elleef"}, "reply_to_user": {"reputation": 11, "user_id": 7345221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115bfbadf53f851551b404cd6a3badc4?s=128&d=identicon&r=PG&f=1", "display_name": "Kratz", "link": "https://stackoverflow.com/users/7345221/kratz"}, "edited": false, "score": 0, "creation_date": 1482843117, "post_id": 41344345, "comment_id": 69892968, "body": "you should move it up to be inside the first nested attributes ,  i updated my answer to include the full nested objects"}], "tags": [], "owner": {"reputation": 1692, "user_id": 1846073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa52c8a9c7d545a7dae0d1683949627?s=128&d=identicon&r=PG", "display_name": "abo-elleef", "link": "https://stackoverflow.com/users/1846073/abo-elleef"}, "is_accepted": false, "score": 0, "last_activity_date": 1482843304, "last_edit_date": 1482843304, "creation_date": 1482838110, "answer_id": 41344345, "question_id": 41342563, "link": "https://stackoverflow.com/questions/41342563/one-form-three-tables-in-ruby-on-rails/41344345#41344345", "title": "One form three tables in ruby on rails", "body": "<p>also need to update his second builder object in template</p>\n\n<p>as subcategory is nested form productType not from brandname</p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n    &lt;%= f.fields_for :producttype do |builder| %&gt;\n      &lt;div class=\"control-label col-sm-2\"&gt;\n        &lt;%= builder.label :content, \"Type Of Product\" %&gt;&lt;br /&gt;\n      &lt;/div&gt;\n      &lt;div class=\"col-sm-8\"&gt;\n        &lt;%= builder.text_field :content, class: \"form-control\", placeholder: \"Enter Product Type\" %&gt;\n      &lt;/div&gt;\n\n      &lt;div class=\"form-group\"&gt;\n        &lt;%= builder.fields_for :subcategories do |cat_builder| %&gt;\n          &lt;div class=\"control-label col-sm-2\"&gt;\n            &lt;%= cat_builder.label :content, \"Sub Category\" %&gt;&lt;br /&gt;\n          &lt;/div&gt;\n          &lt;div class=\"col-sm-8\"&gt;\n            &lt;%= cat_builder.text_field :content, class: \"form-control\", placeholder: \"Enter Sub Category\" %&gt;\n          &lt;/div&gt;\n        &lt;% end %&gt;\n       &lt;/div&gt;\n    &lt;% end %&gt;\n &lt;/div&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7345221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115bfbadf53f851551b404cd6a3badc4?s=128&d=identicon&r=PG&f=1", "display_name": "Kratz", "link": "https://stackoverflow.com/users/7345221/kratz"}, "is_accepted": true, "score": 0, "last_activity_date": 1483094496, "creation_date": 1483094496, "answer_id": 41394847, "question_id": 41342563, "link": "https://stackoverflow.com/questions/41342563/one-form-three-tables-in-ruby-on-rails/41394847#41394847", "title": "One form three tables in ruby on rails", "body": "<pre><code>&lt;%= form_for(@brandname, :html =&gt; {class: \"form-horizontal\", role: \"form\", :multipart =&gt; true}) do |f| %&gt;\n      &lt;div class=\"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= f.label :brandname %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= f.text_field :brandname, class: \"form-control\", placeholder: \"Enter Brand Name\" %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=\"form-group\"&gt;\n        &lt;%= f.fields_for :producttypes do |builder| %&gt;\n          &lt;div class=\"control-label col-sm-2\"&gt;\n            &lt;%= builder.label :producttype, \"Type Of Product\" %&gt;&lt;br /&gt;\n          &lt;/div&gt;\n          &lt;div class=\"col-sm-8\"&gt;\n            &lt;%= builder.text_field :producttype, class: \"form-control\", placeholder: \"Enter Product Type\" %&gt;\n          &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=\"form-group\"&gt;\n          &lt;%= builder.fields_for :subcategories do |builder_sub| %&gt;\n            &lt;div class=\"control-label col-sm-2\"&gt;\n              &lt;%= builder_sub.label :subcategory, \"Sub Category\" %&gt;&lt;br /&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-sm-8\"&gt;\n              &lt;%= builder_sub.text_field :subcategory, class: \"form-control\", placeholder: \"Enter Sub Category\" %&gt;\n            &lt;/div&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>Params:</p>\n\n<pre><code>params.require(:brandname).permit(:brandname, producttypes_attributes: [:id, :brandname_id, :producttype, subcategories_attributes: [:id, :producttype_id, :subcategory]])\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7345221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115bfbadf53f851551b404cd6a3badc4?s=128&d=identicon&r=PG&f=1", "display_name": "Kratz", "link": "https://stackoverflow.com/users/7345221/kratz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 41394847, "answer_count": 3, "score": -1, "last_activity_date": 1483094496, "creation_date": 1482831305, "question_id": 41342563, "link": "https://stackoverflow.com/questions/41342563/one-form-three-tables-in-ruby-on-rails", "title": "One form three tables in ruby on rails", "body": "<p>I want to create a single form to save data to 3 tables. 3 tables are connected with one to many relation.</p>\n\n<p>I am able to save data to brandname but not to producttype and sub category.</p>\n\n<p>below is the code:</p>\n\n<pre><code>&lt;%= form_for(@brandname, :html =&gt; {class: \"form-horizontal\", role: \"form\"}) do |f| %&gt;\n      &lt;div class=\"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= f.label :brandname %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= f.text_field :brandname, class: \"form-control\", placeholder: \"Enter Brand Name\" %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=\"form-group\"&gt;\n        &lt;%= f.fields_for :producttype do |builder| %&gt;\n          &lt;div class=\"control-label col-sm-2\"&gt;\n            &lt;%= builder.label :content, \"Type Of Product\" %&gt;&lt;br /&gt;\n          &lt;/div&gt;\n          &lt;div class=\"col-sm-8\"&gt;\n            &lt;%= builder.text_field :content, class: \"form-control\", placeholder: \"Enter Product Type\" %&gt;\n          &lt;/div&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"form-group\"&gt;\n        &lt;%= f.fields_for :subcategories do |builder| %&gt;\n          &lt;div class=\"control-label col-sm-2\"&gt;\n            &lt;%= builder.label :content, \"Sub Category\" %&gt;&lt;br /&gt;\n          &lt;/div&gt;\n          &lt;div class=\"col-sm-8\"&gt;\n            &lt;%= builder.text_field :content, class: \"form-control\", placeholder: \"Enter Sub Category\" %&gt;\n          &lt;/div&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"form-group\"&gt;\n        &lt;div class=\"col-sm-offset-2 col-sm-10\"&gt;\n          &lt;%= f.submit(@brandname.new_record? ? \"Add\" : \"Save\", class: 'btn btn-primary btn-lg') %&gt;\n          &lt;%= link_to \"Cancel\", new_brandname_path, class: \"btn btn-default btn-lg active\" %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;      \n    &lt;% end %&gt;\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>  def new\n    @brandname   = Brandname.new\n    @brandname.producttypes.build\n    producttype.subcategories.build\n  end\n\n  def create\n    @brandname = Brandname.new(prodinfo_params)\n    if @brandname.save\n      flash[:success] = \"ProductInfo Created Successfully\"\n      redirect_to root_path\n    else\n      render 'new'\n    end\n  end\n\n  private\n  def prodinfo_params\n    params.require(:brandname).permit(:brandname, :producttype, :subcategory )\n    # producttype_attributes: [:producttype]\n  end\n\nModel:\n\nBrandname:\n\nclass Brandname &lt; ApplicationRecord\n  has_many :producttypes, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :producttypes\nend\n\nProducttype:\n\nclass Producttype &lt; ApplicationRecord\n  belongs_to :brandname\n  has_many :subcategories, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :subcategories\nend\n\n\nSub Category:\n\nclass Subcategory &lt; ApplicationRecord\n  belongs_to :producttype\nend\n</code></pre>\n\n<p>Can someone help me with this?</p>\n"}, {"tags": ["arrays", "ruby", "select", "filter"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1482830776, "post_id": 41341839, "comment_id": 69886892, "body": "Hint: what does <code>h.values</code> return? Can you really compare that to zero?"}], "answers": [{"comments": [{"owner": {"reputation": 10306, "user_id": 228521, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1ce2f9acebdd4b2b56766a565fcf6ef7?s=128&d=identicon&r=PG", "display_name": "Amit Erandole", "link": "https://stackoverflow.com/users/228521/amit-erandole"}, "edited": false, "score": 0, "creation_date": 1482828756, "post_id": 41341871, "comment_id": 69885969, "body": "I am getting <code>undefined method zero?</code>"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 3, "last_activity_date": 1482891711, "last_edit_date": 1482891711, "creation_date": 1482828548, "answer_id": 41341871, "question_id": 41341839, "link": "https://stackoverflow.com/questions/41341839/how-do-i-filter-out-hashes-from-an-array-of-hashes/41341871#41341871", "title": "How do I filter out hashes from an array of hashes?", "body": "<p>You have an array of hashes, so you have to operate on each hash.</p>\n\n<pre><code>params.reject { |hash| hash.any? { |_, v| [0, ''].include?(v) }}\n#=&gt; [{:limit=&gt;5}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 4, "creation_date": 1482829682, "post_id": 41342078, "comment_id": 69886371, "body": "second option is better, since any string (if it does not start with integer) converted to Integer is <code>0</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 1, "creation_date": 1482872738, "post_id": 41342078, "comment_id": 69906178, "body": "@Andrey, that&#39;s like saying, &quot;the second option is better because one plus one doesn&#39;t equal three&quot;. Always one for understatement, eh? (Good point, though.)"}], "tags": [], "owner": {"reputation": 10306, "user_id": 228521, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1ce2f9acebdd4b2b56766a565fcf6ef7?s=128&d=identicon&r=PG", "display_name": "Amit Erandole", "link": "https://stackoverflow.com/users/228521/amit-erandole"}, "is_accepted": false, "score": 0, "last_activity_date": 1482829430, "creation_date": 1482829430, "answer_id": 41342078, "question_id": 41341839, "link": "https://stackoverflow.com/questions/41341839/how-do-i-filter-out-hashes-from-an-array-of-hashes/41342078#41342078", "title": "How do I filter out hashes from an array of hashes?", "body": "<p>I found two ways to do this:</p>\n\n<pre><code>filtered = params.reject { |hash| hash.values.any? { |v| v.to_i == 0 } }\n</code></pre>\n\n<p>and</p>\n\n<pre><code>filtered = params.select { |hash| hash.values.none? { |val| val == '' || val == 0 } }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1482830446, "post_id": 41342304, "comment_id": 69886719, "body": "this solution does not take into account empty string part of the OP. Once it does (after your potential edit) it won&#39;t be any different from what OP already has."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1482830580, "post_id": 41342304, "comment_id": 69886782, "body": "<code>0 &amp;&amp; &#39;&#39;</code> is <b><i>always</i></b> evaluated to <code>&#39;&#39;</code> - see the problem here? :)"}, {"owner": {"reputation": 655, "user_id": 5715918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b2aca8bacf3913e5001a83bf96eb28?s=128&d=identicon&r=PG&f=1", "display_name": "rohin-arka", "link": "https://stackoverflow.com/users/5715918/rohin-arka"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1482830987, "post_id": 41342304, "comment_id": 69886993, "body": "Umm thanks for pointing. I think <code>params.reject { |key| key.values.include?(0) || key.values.include?(&quot;&quot;) }</code>"}], "tags": [], "owner": {"reputation": 655, "user_id": 5715918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b2aca8bacf3913e5001a83bf96eb28?s=128&d=identicon&r=PG&f=1", "display_name": "rohin-arka", "link": "https://stackoverflow.com/users/5715918/rohin-arka"}, "is_accepted": false, "score": 0, "last_activity_date": 1482831015, "last_edit_date": 1482831015, "creation_date": 1482830369, "answer_id": 41342304, "question_id": 41341839, "link": "https://stackoverflow.com/questions/41341839/how-do-i-filter-out-hashes-from-an-array-of-hashes/41342304#41342304", "title": "How do I filter out hashes from an array of hashes?", "body": "<p>Using reject with include will also solve this problem.</p>\n\n<pre><code> params.reject { |key| key.values.include?(0) || key.values.include?(\"\") }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1482855645, "post_id": 41344591, "comment_id": 69898798, "body": "I&#39;m a little confused. Doesn&#39;t the asker want to return an array? IMO, that last line has been whupped with an ugly stick. Since you need the local variable anyway, wouldn&#39;t two lines be better?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1482857514, "post_id": 41344591, "comment_id": 69899672, "body": "I cannot think of any good reason to have an array of 1-pair hashes in comparison to just one hash. The last line might not be the most beautiful, but it isn&#39;t easy to retrieve a value from an hash array. And no, we don&#39;t need <code>h</code>, we just need <code>h[:limit]</code> but only if <code>h</code> is found."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1482864030, "post_id": 41344591, "comment_id": 69902616, "body": "Eric, one situation where one might want an array of size-one hashes, rather than a hash, is when there are duplicate keys: if <code>params = [{ limit: 5 }, { limit: &#39;&#39; }]</code> you would return an empty hash, but wouldn&#39;t the asker expect <code>[{ limit: 5 }]</code>?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1482878587, "post_id": 41344591, "comment_id": 69908132, "body": "I think it&#39;s a solution looking for a problem. You could use default values, or not blindly override values with empty ones."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 2, "last_activity_date": 1482839139, "creation_date": 1482839139, "answer_id": 41344591, "question_id": 41341839, "link": "https://stackoverflow.com/questions/41341839/how-do-i-filter-out-hashes-from-an-array-of-hashes/41344591#41344591", "title": "How do I filter out hashes from an array of hashes?", "body": "<p>Instead of having an array of hashes with only one pair of <code>|key,value|</code>, you could just merge all the hashes to get one big hash.</p>\n\n<p>It becomes easier to remove the unwanted values, and it also becomes easier to extract information :</p>\n\n<pre><code>params = [{ limit: 5 }, { skip: 0 }, { asc: '' }, { desc: '' }]\n\nhash = params.inject(&amp;:merge).reject{|_, value| value == 0 || value == '' }\n# =&gt; {:limit=&gt;5}\n\nhash[:limit]\n# =&gt; 5\n</code></pre>\n\n<p>With an array of hashes, you'd have to write :</p>\n\n<pre><code>(h = array_of_hashes.find{|h| h.keys.include?(:limit)} ) &amp;&amp; h[:limit]\n#=&gt; 5\n</code></pre>\n"}], "owner": {"reputation": 10306, "user_id": 228521, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1ce2f9acebdd4b2b56766a565fcf6ef7?s=128&d=identicon&r=PG", "display_name": "Amit Erandole", "link": "https://stackoverflow.com/users/228521/amit-erandole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 855, "favorite_count": 0, "accepted_answer_id": 41344591, "answer_count": 4, "score": 1, "last_activity_date": 1482891711, "creation_date": 1482828384, "last_edit_date": 1482832092, "question_id": 41341839, "link": "https://stackoverflow.com/questions/41341839/how-do-i-filter-out-hashes-from-an-array-of-hashes", "title": "How do I filter out hashes from an array of hashes?", "body": "<p>I have <code>params</code> that looks like this:</p>\n\n<pre><code>params = [{:limit=&gt;5}, {:skip=&gt;0}, {:asc=&gt;\"\"}, {:desc=&gt;\"\"}]\n</code></pre>\n\n<p>I want to remove the hash elements whose value is <code>0</code> or an empty string. I tried doing:</p>\n\n<pre><code>params.reject { |h| h.values !== 0 }\n</code></pre>\n\n<p>but this gives me a syntax error</p>\n\n<p>Also tried:</p>\n\n<pre><code>params.select { |h| h.values != 0 || h.values != \"\" }\n</code></pre>\n\n<p>but this gives me nothing. What am I doing wrong?</p>\n"}, {"tags": ["ruby", "switch-statement"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1482849691, "post_id": 41341510, "comment_id": 69896060, "body": "Just out of curiosity: why would you expect the third <code>when</code> case to execute because its condition evaluates to true? Why not any of the other cases? Because by your own reasoning, <i>all</i> of them evaluate to true, since e.g. <code>&quot;stringA&quot;</code> evaluates to true (in fact, everything except <code>nil</code> and <code>false</code> evaluates to true)."}, {"owner": {"reputation": 15, "user_id": 2030349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a39dcc9fb3dde6139b33851a0f79914?s=128&d=identicon&r=PG", "display_name": "SystemShock", "link": "https://stackoverflow.com/users/2030349/systemshock"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1483074951, "post_id": 41341510, "comment_id": 69984088, "body": "@J&#246;rgWMittag Because I thought that, once it reached <code>when</code> it did something like check <code>&quot;stringA&quot; == &quot;stringA&quot;</code> and since that would evaluate to true, it would run the code for that <code>when</code>. By that analogy I tried the <code>.any?</code> case since by itself it evaluates to true. But yeah, not understanding what Ruby does in the <code>when</code> condition is the reason I was stuck"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1483091374, "post_id": 41341510, "comment_id": 69989890, "body": "But by your <i>own</i> logic it would then check <code>true == &quot;stringA&quot;</code>, which is false. And that is actually pretty much exactly what happens, except the method is <code>===</code> not <code>==</code>."}, {"owner": {"reputation": 15, "user_id": 2030349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a39dcc9fb3dde6139b33851a0f79914?s=128&d=identicon&r=PG", "display_name": "SystemShock", "link": "https://stackoverflow.com/users/2030349/systemshock"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1483517030, "post_id": 41341510, "comment_id": 70123444, "body": "Yes, but I didn&#39;t know it checked <code>true ==(=) &quot;stringA&quot;</code>, I thought if the evaluation of the <code>when</code> condition <i>by itself</i>  was <code>true</code> it would run the block."}], "answers": [{"comments": [{"owner": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "reply_to_user": {"reputation": 15, "user_id": 2030349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a39dcc9fb3dde6139b33851a0f79914?s=128&d=identicon&r=PG", "display_name": "SystemShock", "link": "https://stackoverflow.com/users/2030349/systemshock"}, "edited": false, "score": 0, "creation_date": 1482830572, "post_id": 41341640, "comment_id": 69886778, "body": "@SystemShock please be aware that this is NOT the same thing you tried to use though! <code>someArray.any? { |x| x.include?(type) }</code> will check if any of the strings in the array INCLUDE the type (&quot;abcstringX&quot; does include &quot;stringX&quot;), while <code>when *some_array</code> checks whether any of the strings in some_array are EQUAL to type (&quot;abcstringX&quot; is not equal to &quot;stringX&quot;)."}, {"owner": {"reputation": 15, "user_id": 2030349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a39dcc9fb3dde6139b33851a0f79914?s=128&d=identicon&r=PG", "display_name": "SystemShock", "link": "https://stackoverflow.com/users/2030349/systemshock"}, "reply_to_user": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "edited": false, "score": 0, "creation_date": 1482831140, "post_id": 41341640, "comment_id": 69887075, "body": "@Ninigi Ah, OK, thanks for the clarification. Thought it would working like that. But *some_array works for me here since it&#39;ll be checking exact strings against one another."}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 4, "last_activity_date": 1482827548, "creation_date": 1482827548, "answer_id": 41341640, "question_id": 41341510, "link": "https://stackoverflow.com/questions/41341510/any-inside-a-case-block-not-evaluating-as-expected/41341640#41341640", "title": ".any? inside a case block not evaluating as expected", "body": "<p>Use <code>*</code> operator</p>\n\n<pre><code>value = \"stringX\"\nsome_array = [\"stringX\", \"string1\", \"string2\"]\n\ncase type\nwhen \"stringA\"\n  puts \"a\"\nwhen \"stringB\"\n  puts \"b\"\nwhen *some_array # notice the * before the variable name!\n  puts \"x\"\nwhen \"stringC\"\n  puts \"c\"\nend\n</code></pre>\n\n<p>How does this work?</p>\n\n<p><code>when *some_array</code> checks whether <code>value</code> is an element in <code>some_array</code></p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 2030349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a39dcc9fb3dde6139b33851a0f79914?s=128&d=identicon&r=PG", "display_name": "SystemShock", "link": "https://stackoverflow.com/users/2030349/systemshock"}, "edited": false, "score": 0, "creation_date": 1482828734, "post_id": 41341661, "comment_id": 69885957, "body": "Yeah, leave it, pretty useful. Thanks."}], "tags": [], "owner": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "is_accepted": false, "score": 0, "last_activity_date": 1482828473, "last_edit_date": 1482828473, "creation_date": 1482827672, "answer_id": 41341661, "question_id": 41341510, "link": "https://stackoverflow.com/questions/41341510/any-inside-a-case-block-not-evaluating-as-expected/41341661#41341661", "title": ".any? inside a case block not evaluating as expected", "body": "<p>EDIT: I will not delete the answer, because I think there might be something in it you didn't know before, but it does not work for your usecase. For that you should look at mudasobwas answer</p>\n\n<p>It does not quite work this way, because basically the case statement will compare the given object with the object(s) passed to <code>when</code>, about similar to this:</p>\n\n<pre><code>if type == \"stringA\"\n  # ...\nelsif type == \"stringB\"\n  # ...\n</code></pre>\n\n<p>and so on, unless you use an empty case statement.</p>\n\n<pre><code>case\nwhen type == \"stringA\"\n# ...\n</code></pre>\n\n<p>This is similar to an if elsif statement though, so you don't really see that very often.\nIn your case however, we can make use of <a href=\"https://endofline.wordpress.com/2011/01/21/the-strange-ruby-splat/\" rel=\"nofollow noreferrer\">Ruby's splat operator</a></p>\n\n<pre><code>case type\nwhen \"stringA\"\n  puts \"a\"\nwhen \"stringB\"\n  puts \"b\"\nwhen *someArray\n  puts \"x\"\nwhen \"stringC\"\n  puts \"c\"\n</code></pre>\n\n<p>Ruby's case statement can take multiple arguments with <code>when</code> which kind of works like an \"or\"</p>\n\n<pre><code>case \"A\"\nwhen \"B\"\n  puts \"B\"\nwhen \"C\", \"A\"\n  puts \"C or A\"\nend\n# =&gt; C or A\n</code></pre>\n\n<p>and the splat operator will fan out your array:</p>\n\n<pre><code>p [\"a\", \"b\"]\n# =&gt; [\"a\", \"b\"]\n\np *[\"a\", \"b\"]\n# =&gt; \"a\"\n# =&gt; \"b\"\n\np \"a\", \"b\"\n# =&gt; \"a\"\n# =&gt; \"b\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "edited": false, "score": 0, "creation_date": 1482828303, "post_id": 41341775, "comment_id": 69885759, "body": "omg you are right! The question was about the strings in the array INCLUDING the type... I should learn to read questions xD"}, {"owner": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "edited": false, "score": 0, "creation_date": 1482828660, "post_id": 41341775, "comment_id": 69885918, "body": "Oh and apparently answers too... You didn&#39;t see it either, but still provided the only real answer ^^"}, {"owner": {"reputation": 15, "user_id": 2030349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a39dcc9fb3dde6139b33851a0f79914?s=128&d=identicon&r=PG", "display_name": "SystemShock", "link": "https://stackoverflow.com/users/2030349/systemshock"}, "edited": false, "score": 0, "creation_date": 1482828774, "post_id": 41341775, "comment_id": 69885982, "body": "Think that&#39;ll be useful to me pretty soon. Thanks."}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1482828850, "post_id": 41341775, "comment_id": 69886017, "body": "Using a block is a nice combo breaker!"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1482828149, "creation_date": 1482828149, "answer_id": 41341775, "question_id": 41341510, "link": "https://stackoverflow.com/questions/41341510/any-inside-a-case-block-not-evaluating-as-expected/41341775#41341775", "title": ".any? inside a case block not evaluating as expected", "body": "<p>For this particular case one should use the brilliant answer by @akuhn</p>\n\n<p>Whether you need to put <em>any random condition</em> inside the <code>case</code>, you can do it using <code>Proc#===</code>:</p>\n\n<pre><code>type = \"stringX\"\nsomeArray = [\"stringX\", \"string1\", \"string2\"]\n\ncase type\nwhen \"stringA\" then puts \"a\"\nwhen \"stringB\" then puts \"b\"\n#    \u21d3\u21d3\u21d3\u21d3\u21d3\u21d3\u21d3\u21d3 HERE\nwhen -&gt;(type) { someArray.any? { |x| x.include?(type) } }\n  puts \"x\"\nwhen \"stringC\" then puts \"c\"\nend\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 2030349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a39dcc9fb3dde6139b33851a0f79914?s=128&d=identicon&r=PG", "display_name": "SystemShock", "link": "https://stackoverflow.com/users/2030349/systemshock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 41341640, "answer_count": 3, "score": 1, "last_activity_date": 1482828473, "creation_date": 1482826890, "last_edit_date": 1482827574, "question_id": 41341510, "link": "https://stackoverflow.com/questions/41341510/any-inside-a-case-block-not-evaluating-as-expected", "title": ".any? inside a case block not evaluating as expected", "body": "<p>I have the following situation:</p>\n\n<pre><code>type = \"stringX\"\nsomeArray = [\"stringX\", \"string1\", \"string2\"]\n\ncase type\nwhen \"stringA\"\n  puts \"a\"\nwhen \"stringB\"\n  puts \"b\"\nwhen someArray.any? { |x| x.include?(type) }\n  puts \"x\"\nwhen \"stringC\"\n  puts \"c\"\nend\n</code></pre>\n\n<p>What I was expecting to happen was that it would go through the <code>case</code> and once it evaluates the <code>.any?</code> method as true (because by itself it does evaluate to true), it would <code>puts</code> \"x\". However, that's not what's happening here, it just goes through the rest of the <code>case</code> and reaches a <code>raise</code> somewhere below that.</p>\n\n<p>I'm wondering what's going on here?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3.2", "friendly-id"], "answers": [{"comments": [{"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "edited": false, "score": 0, "creation_date": 1482826458, "post_id": 41341391, "comment_id": 69884972, "body": "Thanks for sharing the link. What can I have as a sequence_separator so that the slug is user friendly?"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1482834744, "post_id": 41341391, "comment_id": 69888866, "body": "I think configuring it to <code>&#39;&#39;</code> Empty string will work."}, {"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1482972147, "post_id": 41341391, "comment_id": 69945178, "body": "@JagdeepSingh When I am keeping the separator empty I start getting duplicate index creation errors. The output is something like this: arun-kumar2, instead of arun-kumar-2."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1482990094, "post_id": 41341391, "comment_id": 69949137, "body": "What about &#39;-&#39; (Single hyphen) ?"}, {"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1483065693, "post_id": 41341391, "comment_id": 69982146, "body": "@JagdeepSingh, the string separator defaults to &#39;-&#39;."}], "tags": [], "owner": {"reputation": 9540, "user_id": 254936, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5744827a6042af02213a6094d6146111?s=128&d=identicon&r=PG", "display_name": "TK-421", "link": "https://stackoverflow.com/users/254936/tk-421"}, "is_accepted": true, "score": 1, "last_activity_date": 1482826206, "creation_date": 1482826206, "answer_id": 41341391, "question_id": 41341317, "link": "https://stackoverflow.com/questions/41341317/slug-generated-having-two-hyphens-at-the-end-in-rails-3-2-using-friendly-id/41341391#41341391", "title": "Slug generated having two hyphens at the end in rails 3.2 using friendly id?", "body": "<p>See this issue, and the linked docs:</p>\n\n<p><a href=\"https://github.com/norman/friendly_id/issues/170\" rel=\"nofollow noreferrer\">https://github.com/norman/friendly_id/issues/170</a></p>\n\n<blockquote>\n  <p>The \"--\" is used to separate the slug from the sequence. This allows\n  you to have a slug with a number in it.</p>\n</blockquote>\n\n<p>You can configure <code>sequence_separator</code>.</p>\n"}], "owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 41341391, "answer_count": 1, "score": 0, "last_activity_date": 1482826206, "creation_date": 1482825776, "question_id": 41341317, "link": "https://stackoverflow.com/questions/41341317/slug-generated-having-two-hyphens-at-the-end-in-rails-3-2-using-friendly-id", "title": "Slug generated having two hyphens at the end in rails 3.2 using friendly id?", "body": "<p>I am using <a href=\"https://github.com/norman/friendly_id/tree/4.0.10.1\" rel=\"nofollow noreferrer\">friendly_id 4.0.10.1</a> gem for generating slug. I am using two columns to generate slug: <strong>first_name</strong> and <strong>last_name</strong>. </p>\n\n<p>The <strong>last_name</strong> value can be empty. The problem arises in these cases:</p>\n\n<pre><code>   first_name  last_name  slug\n1. Arun          Kumar    arun-kumar\n2. Arun          Kumar    arun-kumar--2\n3. Arun          Kumar    arun-kumar--3\n</code></pre>\n\n<p>I am expecting the slug to be like this: <strong>arun-kumar-2</strong>, <strong>arun-kumar-3</strong>.</p>\n\n<p>I do not want those double hyphens to appear at the end. How to avoid that?</p>\n"}, {"tags": ["ruby", "metaprogramming", "dsl"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1482825291, "post_id": 41341156, "comment_id": 69884523, "body": "check out <a href=\"https://ruby-doc.org/core-2.3.3/BasicObject.html#method-i-method_missing\" rel=\"nofollow noreferrer\"><code>method_missing</code></a> :)"}], "answers": [{"comments": [{"owner": {"reputation": 3542, "user_id": 5381547, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/jFcfu.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/5381547/viktor"}, "edited": false, "score": 0, "creation_date": 1482830167, "post_id": 41341553, "comment_id": 69886580, "body": "Awesome! One more question: how do I make <code>with_prefix</code> nested?"}, {"owner": {"reputation": 3542, "user_id": 5381547, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/jFcfu.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/5381547/viktor"}, "edited": false, "score": 0, "creation_date": 1482837115, "post_id": 41341553, "comment_id": 69890116, "body": "This answer totally deserves bounty"}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "reply_to_user": {"reputation": 3542, "user_id": 5381547, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/jFcfu.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/5381547/viktor"}, "edited": false, "score": 0, "creation_date": 1482838839, "post_id": 41341553, "comment_id": 69890923, "body": "Excited to hear you find it useful!"}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 5, "last_activity_date": 1482838868, "last_edit_date": 1482838868, "creation_date": 1482827121, "answer_id": 41341553, "question_id": 41341156, "link": "https://stackoverflow.com/questions/41341156/dynamically-generate-prefixes-for-method-names/41341553#41341553", "title": "Dynamically generate prefixes for method names", "body": "<p>Try this,</p>\n\n<pre><code>class Module\n  def with_prefix(prefix, &amp;block)\n    m = Module.new\n    m.instance_eval(&amp;block)\n    m.methods(false).each do |name|\n      define_method \"#{prefix}_#{name}\", &amp;m.method(name)\n      module_function \"#{prefix}_#{name}\" unless self.is_a?(Class)\n    end\n  end\nend\n\nclass A\n  with_prefix :pref do\n    with_prefix :and do\n      def foo\n        puts \"foo called\"\n      end\n\n      def bar\n        puts \"bar called\"\n      end\n    end\n  end\nend\n\nA.new.pref_and_foo\nA.new.pref_and_bar\n</code></pre>\n\n<p>How does this work?</p>\n\n<ul>\n<li>We define a new function <code>with_prefix</code> on the superclass of all classes</li>\n<li>This function takes a name and a block</li>\n<li>Evaluate the block in the context of an anonymous module. </li>\n<li>This executes the <code>def</code> statements on the anonymous module rather than the class</li>\n<li>Enumerate over all functions of that module</li>\n<li>Create prefixed methods for each of those functions</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1482865877, "last_edit_date": 1482865877, "creation_date": 1482865490, "answer_id": 41350764, "question_id": 41341156, "link": "https://stackoverflow.com/questions/41341156/dynamically-generate-prefixes-for-method-names/41350764#41350764", "title": "Dynamically generate prefixes for method names", "body": "<p>You could use the callback method <a href=\"http://ruby-doc.org/core-2.3.0/Module.html#method-i-included\" rel=\"nofollow noreferrer\">Module#included</a> and the class methods <a href=\"http://ruby-doc.org/core-2.3.0/Module.html#method-i-instance_methods\" rel=\"nofollow noreferrer\">Method#instance_methods</a>, <a href=\"http://ruby-doc.org/core-2.3.0/Module.html#method-i-alias_method\" rel=\"nofollow noreferrer\">Method#alias_method</a>, <a href=\"http://ruby-doc.org/core-2.3.0/Module.html#method-i-remove_method\" rel=\"nofollow noreferrer\">Module#remove_method</a> and <a href=\"http://ruby-doc.org/core-2.3.3/Object.html#method-i-send\" rel=\"nofollow noreferrer\">Object#send</a> as follows.</p>\n\n<pre><code>module Bar\n  def self.included(klass)\n    klass.instance_methods(false).each do |m|\n      klass.send :alias_method, \"pref_#{m.to_s}\".to_sym, m\n      klass.send :remove_method, m\n    end\n  end\nend\n\nclass Foo\n  def foo\n    puts 'hi'\n  end\n\n  def bar\n    puts 'ho'\n  end\n\n  include Bar\nend\n\nFoo.instance_methods.select { |m| [:foo, :bar, :pref_foo, :pref_bar].include?(m) } \n  #=&gt; [:pref_foo, :pref_bar] \n\nFoo.new.pref_foo\n  #=&gt; \"hi\"\n\nFoo.new.foo\n  #=&gt; NoMethodError: undefined method `foo' for #&lt;Foo:0x007fdecb0633d8&gt;\n</code></pre>\n\n<p><code>send</code> must be used because <code>alias_method</code> and <code>remove_method</code> are private class methods. The statement <code>include Bar</code> obviously must follow the definitions of the instance methods in <code>Foo</code>.</p>\n\n<p>As the question is (sic), \"I want to automatically prepend a prefix to my instance method names...\", the prefix must be hard-wired.</p>\n"}], "owner": {"reputation": 3542, "user_id": 5381547, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/jFcfu.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/5381547/viktor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 821, "favorite_count": 1, "accepted_answer_id": 41341553, "answer_count": 2, "score": 1, "last_activity_date": 1484226022, "creation_date": 1482824981, "last_edit_date": 1484226022, "question_id": 41341156, "link": "https://stackoverflow.com/questions/41341156/dynamically-generate-prefixes-for-method-names", "title": "Dynamically generate prefixes for method names", "body": "<p>Let's say we have a bunch of methods with typical prefixes.</p>\n\n<pre><code>def pref_foo\n  # code\nend\n\ndef pref_bar\n  # code\nend\n</code></pre>\n\n<p>I want to learn how to automatically prepend those prefixes to my method names (like how it's done in Rails: <code>Model.find_by_smth</code>). </p>\n\n<p>In other words I want to create some scope <code>pref_</code>, that takes methods and prepends <code>pref_</code> to their names, so my method <code>foo</code> is becoming available as <code>pref_foo</code>.</p>\n\n<hr>\n\n<pre><code>module Bar\n  # definition of some wrapper `pref_`\nend\n\nclass Foo\n  include Bar\n\n  &lt;some wrapper from Bar&gt; do\n    def foo\n      puts 'What does a computer scientist wear on Halloween?'\n    end\n\n    def bar\n      puts 'A bit-mask.'\n    end\n  end\nend\n\nfoo = Foo.new\n\nfoo.pref_foo # =&gt; \"What does a computer scientist wear on Halloween?\"\nfoo.pref_bar # =&gt; \"A bit-mask.\"\n</code></pre>\n"}, {"tags": ["mysql", "ruby", "ruby-on-rails-3.2", "database-performance", "friendly-id"], "comments": [{"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1482823073, "post_id": 41340651, "comment_id": 69883642, "body": "You should edit your title and question, lakh (= 100,000) is not used outside of India."}, {"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "reply_to_user": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1482823146, "post_id": 41340651, "comment_id": 69883676, "body": "@MichaelKohl thanks I have changed it to 1 million."}, {"owner": {"reputation": 888, "user_id": 3355934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd10fc1565fa16a700c6e50d478b07ff?s=128&d=identicon&r=PG", "display_name": "unkmas", "link": "https://stackoverflow.com/users/3355934/unkmas"}, "edited": false, "score": 0, "creation_date": 1482829411, "post_id": 41340651, "comment_id": 69886262, "body": "How your slugs are generated? I think it will be better, if you will update batch of users in a single query."}, {"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "reply_to_user": {"reputation": 888, "user_id": 3355934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd10fc1565fa16a700c6e50d478b07ff?s=128&d=identicon&r=PG", "display_name": "unkmas", "link": "https://stackoverflow.com/users/3355934/unkmas"}, "edited": false, "score": 0, "creation_date": 1482829521, "post_id": 41340651, "comment_id": 69886303, "body": "@unkmas Do you think the approach defined in Method 2 is fine, should I run multiple rake tasks to finish it quickly will that create any issues?"}, {"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "reply_to_user": {"reputation": 888, "user_id": 3355934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd10fc1565fa16a700c6e50d478b07ff?s=128&d=identicon&r=PG", "display_name": "unkmas", "link": "https://stackoverflow.com/users/3355934/unkmas"}, "edited": false, "score": 0, "creation_date": 1482829825, "post_id": 41340651, "comment_id": 69886430, "body": "@unkmas I am using <a href=\"https://github.com/norman/friendly_id/tree/4.0.10.1\" rel=\"nofollow noreferrer\">friendly_id</a> gem for generating slugs."}, {"owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "edited": false, "score": 1, "creation_date": 1482834921, "post_id": 41340651, "comment_id": 69888958, "body": "I suggest to use an <code>ActiveRecord::Base.transaction</code>-Block around the line <code>users.each {|u| u.save!; i+=1;}</code> of your rake task. So the database doesn&#39;t have to write each single update (<code>u.save!</code>). Instead it would combine all updates of a batch in a single commit. Be aware, in case of an exception in <code>u.save!</code> there would be no update for the current batch."}, {"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "reply_to_user": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "edited": false, "score": 0, "creation_date": 1482835025, "post_id": 41340651, "comment_id": 69889012, "body": "@guitarman thanks, will try this out."}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1482862935, "post_id": 41340651, "comment_id": 69902125, "body": "What version are you using?  5.6 can add the column with little fuss; 5.7 further improves things."}, {"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "reply_to_user": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1482899209, "post_id": 41340651, "comment_id": 69912428, "body": "@RickJames I use version: 5.5. :("}], "answers": [{"comments": [{"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "edited": false, "score": 0, "creation_date": 1482899907, "post_id": 41350600, "comment_id": 69912551, "body": "Thanks Rick, I have updated my question with <code>SHOW CREATE TABLE</code>."}, {"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "edited": false, "score": 0, "creation_date": 1482900058, "post_id": 41350600, "comment_id": 69912597, "body": "I am not using offset in my querying( as I read in a blog that it takes more time than normal <code>limit</code> operator used in <code>mysql</code> ) as I have given a condition to select only those users for whom slug is not generated."}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "reply_to_user": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "edited": false, "score": 1, "creation_date": 1482902897, "post_id": 41350600, "comment_id": 69913464, "body": "But it takes time to skip over more and more already-slugged rows.  <a href=\"http://mysql.rjweb.org/doc.php/pagination\" rel=\"nofollow noreferrer\"><i>More</i></a> on remembering where you left off."}, {"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "edited": false, "score": 0, "creation_date": 1482907035, "post_id": 41350600, "comment_id": 69914905, "body": "What do you suggest now seeing my case above in the question as I need to generate slug from user&#39;s firstname and lastname? I guess this cannot be done through procedures. The above slug generation is a one time process which I have to do as it is a new feature addition, for new users it will be added as and when the users log in again."}, {"owner": {"reputation": 47988, "user_id": 267540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2v58W.jpg?s=128&g=1", "display_name": "e4c5", "link": "https://stackoverflow.com/users/267540/e4c5"}, "edited": false, "score": 1, "creation_date": 1482967229, "post_id": 41350600, "comment_id": 69943849, "body": "Rick I was saying your answer is the right one and the OP should accept it"}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "reply_to_user": {"reputation": 47988, "user_id": 267540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2v58W.jpg?s=128&g=1", "display_name": "e4c5", "link": "https://stackoverflow.com/users/267540/e4c5"}, "edited": false, "score": 0, "creation_date": 1482967374, "post_id": 41350600, "comment_id": 69943907, "body": "@e4c5 - Thanks.  (I thought you might be referring to some of the comments.)"}], "tags": [], "owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "is_accepted": true, "score": 2, "last_activity_date": 1482953486, "last_edit_date": 1482953486, "creation_date": 1482864676, "answer_id": 41350600, "question_id": 41340651, "link": "https://stackoverflow.com/questions/41340651/generating-slug-for-users-in-a-table-with-1-million-users-in-a-short-time-withou/41350600#41350600", "title": "Generating slug for users in a table with 1 million users in a short time without affecting db performance in Rails?", "body": "<p>In a situation like this, all-purpose 3rd party software can only get in the way.  You would be better off going down to the SQL to do the work.</p>\n\n<p>If the \"slug\" is a simple sequence number, then adding an <code>AUTO_INCREMENT</code> would be the obvious solution, and a permanent solution.  That is, all future additions would have the slug automatically generated.  That could be done with one statement:</p>\n\n<pre><code>ALTER TABLE t\n    ADD COLUMN slug INT UNSIGNED AUTO_INCREMENT,\n    INDEX(slug);\n</code></pre>\n\n<p>It would possibly be better for <code>slug</code> to be the <code>PRIMARY KEY</code>  (Please provide <code>SHOW CREATE TABLE</code>.)  But that would probably require a serious lock on the table; so a plain index is better.  Test it.  It may be \"fast enough\".</p>\n\n<p>The next thought is <code>pt-online-schema-change</code> (see Percona.com), which is a special tool for effectively doing <code>ALTERs</code> with nearly zero impact.  It involves adding a <code>TRIGGER</code> to capture writes, and chunking of the copying.  The slight impact comes with the \"last little bit\" needs to be copied.  The final <code>RENAME TABLE real TO old, new TO real;</code> is atomic and essentially instantaneous.  It even dynamically tunes the \"sleep\".  It is an excellent tool with many years of experience put into it.</p>\n\n<p>But, ptosc may not work for adding something as critical as the <code>PRIMARY KEY</code>, hence my suggestion (above) of a plain <code>INDEX</code>.</p>\n\n<p>Setting the values (via <code>UPDATE</code>), one chunk at a time, is the right way to go.  I have written on <a href=\"http://mysql.rjweb.org/doc.php/deletebig#deleting_in_chunks\" rel=\"nofollow noreferrer\"><em>chunking tips</em></a>; that was aimed at <code>DELETE</code>, but can be adapted to <code>UPDATE</code>.</p>\n\n<p>Without knowing what is \"under the covers\" in <code>find_in_batches()</code>, I cannot say that it is good or bad.  I do know that <code>OFFSET</code> is almost always bad; \"remembering where you left off\" is usually much better.  But it is hard to do that if you don't already have a <code>UNIQUE</code> or <code>PRIMARY</code> key.  <code>PRIMARY</code> is better because of its clustering.  (Please provide <code>SHOW CREATE TABLE</code>, so I don't have to make guesses.)</p>\n\n<p>If your sample code starts over at the beginning of the table each time, then it is as bad as using <code>OFFSET</code> -- each iteration will be slower than the previous because it is skipping over more and more rows.</p>\n\n<p>After adding a column, be sure to check all references to the table -- <code>SELECT *</code> will now have one more column (one reason for not using <code>*</code>).  <code>UPDATEs</code> and <code>INSERTs</code> may work with the missing column, but you need to check.</p>\n\n<p><strong>Update</strong></p>\n\n<p>There were two steps -- add the <code>slug</code> column, and populate it.  You have done the first step.</p>\n\n<p>To do the second step, I recommend stepping through the table 100 rows at a time, using the <code>AUTO_INCREMENT PRIMARY KEY</code>.  100 is low enough to be not-too-invasive.  The AI PK will cover the entire table, and is efficient so that you don't need a slow <code>OFFSET</code> or search for un-slugged set.  I discuss efficient chunking <a href=\"http://mysql.rjweb.org/doc.php/deletebig#deleting_in_chunks\" rel=\"nofollow noreferrer\"><em>here</em></a>.  It is written with <code>DELETE</code> in mind, but the techniques apply to <code>UPDATE</code>.</p>\n"}], "owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 41350600, "answer_count": 1, "score": 0, "last_activity_date": 1482953486, "creation_date": 1482822721, "last_edit_date": 1482900292, "question_id": 41340651, "link": "https://stackoverflow.com/questions/41340651/generating-slug-for-users-in-a-table-with-1-million-users-in-a-short-time-withou", "title": "Generating slug for users in a table with 1 million users in a short time without affecting db performance in Rails?", "body": "<p>I want to add a column to my users table and generate slug for all of them. The problem is I have over 1 million users in my DB.</p>\n\n<p>I have seen various blogs explaining different methods but I do not want to take risk by doing it in my production DB. </p>\n\n<p><strong>Methods that I found:</strong></p>\n\n<ol>\n<li><p>The below method suggests to add the code to <strong>generate slug in migration</strong> file itself.</p>\n\n<pre><code>class AddStatusToUser &lt; ActiveRecord::Migration\n  class User &lt; ActiveRecord::Base\n  end\n\n  def up\n    add_column :users, :status, :string\n    User.find_each do |user|\n      user.status = 'active'\n      user.save!\n    end\n  end\n\n  def down\n    remove_column :users, :status\n  end\nend\n</code></pre></li>\n<li><p>I have written this method which is run by a <strong>rake</strong> task:\nThe problem with the below one is that it has been running 4 days in which only 400 000 slugs have been generated so far. I wanted to do it quickly, but do not know how. </p></li>\n</ol>\n\n<p><strong><a href=\"http://apidock.com/rails/v3.1.0/ActiveRecord/Batches/find_in_batches\" rel=\"nofollow noreferrer\">find_in_batches</a></strong>:</p>\n\n<blockquote>\n  <p>Yields each batch of records that was found by the find options as an\n  array. The size of each batch is set by the :batch_size option; the\n  default is 1000.</p>\n  \n  <p>You can control the starting point for the batch processing by\n  supplying the :start option. This is especially useful if you want\n  multiple workers dealing with the same processing queue. You can make\n  worker 1 handle all the records between id 0 and 10,000 and worker 2\n  handle from 10,000 and beyond (by setting the :start option on that\n  worker).</p>\n  \n  <p>It\u2019s not possible to set the order. That is automatically set to\n  ascending on the primary key (\u201cid ASC\u201d) to make the batch ordering\n  work. This also mean that this method only works with integer-based\n  primary keys. You can\u2019t set the limit either, that\u2019s used to control\n  the batch sizes.</p>\n</blockquote>\n\n<p>In order to avoid DB performance issues I have given a sleep time of 2 seconds after every slug generation for 1000 users. Should I remove the sleep method? Should I just run <code>User.find_each(&amp;:save)</code> or method 1?</p>\n\n<pre><code>task :add_slug_to_all_users =&gt; :environment do\n  i=0\n  batchSize = 1000\n  puts \"started at :#{Time.now}\"\n  # find_in_batches method provides the users in batches of 1000 \n  # so that the update is not triggered for all the rows at once which may lock the table completely.\n  User.where(\"slug is null and email is not null\").find_in_batches(batch_size: batchSize) do |users|\n    sleep(2)\n    users.each {|u| u.save!; i+=1;} \n    puts \"updated #{i} records at: #{Time.now}\"\n  end\n  puts \"Completed the Task at: #{Time.now}\\n\"\nend\n</code></pre>\n\n<p><strong>Update 1</strong>: I am using <a href=\"https://github.com/norman/friendly_id/tree/4.0.10.1\" rel=\"nofollow noreferrer\">friendly_id</a> gem to generate slugs.</p>\n\n<p><strong>Update 2</strong>: I have run <code>SHOW CREATE TABLE users</code> and I got this:</p>\n\n<pre><code>CREATE TABLE `users` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `first_name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,\n  `last_name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,\n  `p_views` int(11) DEFAULT '0',\n  `p_desc` text COLLATE utf8_unicode_ci,\n  `p_title` text COLLATE utf8_unicode_ci,\n  `created_at` datetime DEFAULT NULL,\n  `updated_at` datetime DEFAULT NULL,\n  `t_zone` varchar(255) COLLATE utf8_unicode_ci DEFAULT 'UTC',\n  `college` varchar(500) COLLATE utf8_unicode_ci DEFAULT NULL,\n  `degree` text COLLATE utf8_unicode_ci,\n  `p_no` varchar(15) COLLATE utf8_unicode_ci DEFAULT NULL,\n  `slug` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `unique_phone_number` (`p_no`),\n  UNIQUE KEY `index_users_on_phone_no` (`p_no`),\n  UNIQUE KEY `index_users_on_slug` (`slug`),\n  KEY `use_index_on_college` (`college`(255))\n) ENGINE=InnoDB AUTO_INCREMENT=2194 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci |\n</code></pre>\n\n<p>Please note that I have removed most of the fields from the above result. The column <code>slug</code> stores the combination of <strong>first_name</strong> and <strong>last_name</strong> in a url friendly manner.</p>\n\n<p>For e.g. if a user's name is:</p>\n\n<pre><code>id first_name   last_name\n1  Arun         Kumar\n2  Arun         Kumar\n</code></pre>\n\n<p>The <strong>slug</strong> generated would look like this:</p>\n\n<pre><code>id slug\n1  arun-kumar\n2  arun-kumar1\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "edited": false, "score": 0, "creation_date": 1482824556, "post_id": 41340581, "comment_id": 69884220, "body": "Hi, could you add the <code>post_params</code> method and the request (console output), so you can make sure that the teams parameter is sent correctly? Because your models and the controller seems to be right."}, {"owner": {"reputation": 409, "user_id": 4172408, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/PKGS3.png?s=128&g=1", "display_name": "AthleteInAction", "link": "https://stackoverflow.com/users/4172408/athleteinaction"}, "reply_to_user": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "edited": false, "score": 0, "creation_date": 1482824728, "post_id": 41340581, "comment_id": 69884283, "body": "def post_params       params.require(:post).permit(:title, :body, :teams) end"}, {"owner": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "edited": false, "score": 0, "creation_date": 1482824887, "post_id": 41340581, "comment_id": 69884344, "body": "Does it give you an error, or does it return just fine but no post created?"}, {"owner": {"reputation": 409, "user_id": 4172408, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/PKGS3.png?s=128&g=1", "display_name": "AthleteInAction", "link": "https://stackoverflow.com/users/4172408/athleteinaction"}, "reply_to_user": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "edited": false, "score": 0, "creation_date": 1482824937, "post_id": 41340581, "comment_id": 69884364, "body": "It creates the post perfectly, just no &quot;PostMembership&quot;"}, {"owner": {"reputation": 409, "user_id": 4172408, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/PKGS3.png?s=128&g=1", "display_name": "AthleteInAction", "link": "https://stackoverflow.com/users/4172408/athleteinaction"}, "reply_to_user": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "edited": false, "score": 0, "creation_date": 1482825032, "post_id": 41340581, "comment_id": 69884405, "body": "Right now I am thinking I can only create a PostMembership after the post has been created, unless I can find a way to create them both simultaneously."}, {"owner": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "edited": false, "score": 0, "creation_date": 1482825061, "post_id": 41340581, "comment_id": 69884419, "body": "Ok, I think we need the params here, could you put <code>p params</code> in <code>def create</code> and post the console output (or whatever debug method you prefer) :)"}, {"owner": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "reply_to_user": {"reputation": 409, "user_id": 4172408, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/PKGS3.png?s=128&g=1", "display_name": "AthleteInAction", "link": "https://stackoverflow.com/users/4172408/athleteinaction"}, "edited": false, "score": 0, "creation_date": 1482825120, "post_id": 41340581, "comment_id": 69884447, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/131549/discussion-between-ninigi-and-athleteinaction\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 4172408, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/PKGS3.png?s=128&g=1", "display_name": "AthleteInAction", "link": "https://stackoverflow.com/users/4172408/athleteinaction"}, "edited": false, "score": 0, "creation_date": 1482825970, "post_id": 41341322, "comment_id": 69884780, "body": "Yup, came to the exact same solution. Thanks again!"}], "tags": [], "owner": {"reputation": 1281, "user_id": 3232523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u6WFs.png?s=128&g=1", "display_name": "Ninigi", "link": "https://stackoverflow.com/users/3232523/ninigi"}, "is_accepted": true, "score": 1, "last_activity_date": 1482825801, "last_edit_date": 1495542825, "creation_date": 1482825801, "answer_id": 41341322, "question_id": 41340581, "link": "https://stackoverflow.com/questions/41340581/rails-has-many-through-creating-record-with-relationship/41341322#41341322", "title": "Rails has_many through creating record with relationship", "body": "<p>There is a caveat in <a href=\"https://stackoverflow.com/questions/16549382/how-to-permit-an-array-with-strong-parameters\">using arrays in strong parameters</a>, so you need to change your post_params method:</p>\n\n<pre><code>def post_params\n  params.require(:post).permit(:title, :body, teams: [])\nend\n</code></pre>\n\n<p>That's not quite the end of it though, because now your Post.new receives an array of ids for the teams association, which should throw <code>AssociationTypeMismatch</code>. So we need to change your create method a tiny little bit:</p>\n\n<pre><code>def create\n  @post = Post.new(post_params.except(:teams))\n  # ...\n</code></pre>\n\n<p>everything else looks like it should be working :)</p>\n"}], "owner": {"reputation": 409, "user_id": 4172408, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/PKGS3.png?s=128&g=1", "display_name": "AthleteInAction", "link": "https://stackoverflow.com/users/4172408/athleteinaction"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 41341322, "answer_count": 1, "score": 1, "last_activity_date": 1482825801, "creation_date": 1482822392, "last_edit_date": 1482824666, "question_id": 41340581, "link": "https://stackoverflow.com/questions/41340581/rails-has-many-through-creating-record-with-relationship", "title": "Rails has_many through creating record with relationship", "body": "<p>I have a \"posts\" model, a \"teams\" model, and a \"post_memberships\" model. I want \"posts\" to be related to many \"teams\" and \"teams\" to be related to many \"posts\". I have everything set up properly (i think), but I am unsure of how to create a \"post\" record with multiple teams related to it.</p>\n\n<pre><code>    class Post &lt; ApplicationRecord\n\n        has_many :post_memberships\n        has_many :teams,through: :post_memberships\n    end\n\n    class Team &lt; ApplicationRecord\n\n    has_many :post_memberships\n    has_many :posts,through: :post_memberships\n\nend\n\n    class PostMembership &lt; ApplicationRecord\n\n    belongs_to :team\n    belongs_to :post\n\nend\n</code></pre>\n\n<p>My \"post\" form sends a multiple select field of team_id's to the create action in the posts_controller:</p>\n\n<pre><code>    def create\n        @post = Post.new(post_params)\n        if post_params[:teams]\n          post_params[:teams].each do |id|\n\n            @post.teams &lt;&lt; Team.find(id)\n\n          end\n        end\n\n        respond_to do |format|\n          if @post.save\n            format.html { redirect_to @post, notice: 'Post was successfully created.' }\n            format.json { render :show, status: :created, location: @post }\n          else\n            format.html { render :new }\n            format.json { render json: @post.errors, status: :unprocessable_entity }\n          end\n        end\n      end\n\ndef post_params\n      params.require(:post).permit(:title, :body, :teams)\n    end\n</code></pre>\n\n<p>I cannot seem to create a \"Post\" with a \"PostMembership\".</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1239, "user_id": 2134398, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c858429a7d7289246899d678137e7ea0?s=128&d=identicon&r=PG", "display_name": "Arif", "link": "https://stackoverflow.com/users/2134398/arif"}, "edited": false, "score": 0, "creation_date": 1482821716, "post_id": 41340322, "comment_id": 69883141, "body": "I don&#39;t want to search between dates instead I just want to query between times i.e records only between 7am and 9am every day"}, {"owner": {"reputation": 2230, "user_id": 6337957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1177d893bf3115edf0119cf56e7220?s=128&d=identicon&r=PG", "display_name": "Greg Navis", "link": "https://stackoverflow.com/users/6337957/greg-navis"}, "edited": false, "score": 0, "creation_date": 1483003054, "post_id": 41340322, "comment_id": 69954796, "body": "what&#39;s your database?"}, {"owner": {"reputation": 1239, "user_id": 2134398, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c858429a7d7289246899d678137e7ea0?s=128&d=identicon&r=PG", "display_name": "Arif", "link": "https://stackoverflow.com/users/2134398/arif"}, "reply_to_user": {"reputation": 2230, "user_id": 6337957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1177d893bf3115edf0119cf56e7220?s=128&d=identicon&r=PG", "display_name": "Greg Navis", "link": "https://stackoverflow.com/users/6337957/greg-navis"}, "edited": false, "score": 0, "creation_date": 1483343395, "post_id": 41340322, "comment_id": 70051513, "body": "I&#39;m using Postgresql"}], "answers": [{"comments": [{"owner": {"reputation": 2230, "user_id": 6337957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1177d893bf3115edf0119cf56e7220?s=128&d=identicon&r=PG", "display_name": "Greg Navis", "link": "https://stackoverflow.com/users/6337957/greg-navis"}, "edited": false, "score": 0, "creation_date": 1483432689, "post_id": 41341393, "comment_id": 70084828, "body": "This seems to be incorrect as <code>Time</code> in Ruby is a date <i>and</i> time. I tested it&#39;s incorrect locally. The generated query is <code>SELECT &quot;teachers&quot;.* FROM &quot;teachers&quot; WHERE (&quot;teachers&quot;.&quot;created_at&quot; BETWEEN $1 AND $2)</code> and <code>[[&quot;created_at&quot;, 2017-01-03 06:00:00 UTC], [&quot;created_at&quot;, 2017-01-03 08:00:00 UTC]]</code> are substituted. Your query selects orders places <i>today</i> between 7 am and 9 am. @Arif needs orders places on <i>any</i> day."}], "tags": [], "owner": {"reputation": 1594, "user_id": 2681997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qgKiM.jpg?s=128&g=1", "display_name": "Ajay Barot", "link": "https://stackoverflow.com/users/2681997/ajay-barot"}, "is_accepted": false, "score": 1, "last_activity_date": 1482826221, "creation_date": 1482826221, "answer_id": 41341393, "question_id": 41340322, "link": "https://stackoverflow.com/questions/41340322/rails-4-activerecord-querying-between-times/41341393#41341393", "title": "Rails 4 ActiveRecord Querying Between Times", "body": "<p>Try this </p>\n\n<pre><code>Order.where(order_date: Time.parse(\"7am\")..Time.parse(\"9am\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 352, "user_id": 3849241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X7Hpj.jpg?s=128&g=1", "display_name": "Yuri Karpovich", "link": "https://stackoverflow.com/users/3849241/yuri-karpovich"}, "is_accepted": false, "score": 1, "last_activity_date": 1482828281, "creation_date": 1482828281, "answer_id": 41341807, "question_id": 41340322, "link": "https://stackoverflow.com/questions/41340322/rails-4-activerecord-querying-between-times/41341807#41341807", "title": "Rails 4 ActiveRecord Querying Between Times", "body": "<p>Use MySql <code>HOUR</code> function:</p>\n\n<pre><code>Order.where(\"HOUR(order_date) between 7 and 9\")\n</code></pre>\n\n<p>Pay attention to the Time Zone you are using while querying!</p>\n"}, {"tags": [], "owner": {"reputation": 526, "user_id": 2137705, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a5d9cdd2fba8d8efa06195796bf0d06c?s=128&d=identicon&r=PG", "display_name": "Charlie", "link": "https://stackoverflow.com/users/2137705/charlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1482881147, "last_edit_date": 1482881147, "creation_date": 1482880338, "answer_id": 41353352, "question_id": 41340322, "link": "https://stackoverflow.com/questions/41340322/rails-4-activerecord-querying-between-times/41353352#41353352", "title": "Rails 4 ActiveRecord Querying Between Times", "body": "<p>As an example, this will search for orders between now and 1 month ago:</p>\n\n<pre><code>Order.where('order_date &lt; ?', Time.now).where('order_date &gt; ?', Time.now - 1.month)\n</code></pre>\n\n<p>Use <code>Time#parse</code> if you need to convert a string like <code>\"9am\"</code> into an object.</p>\n\n<pre><code>irb(main):006:0&gt; Time.parse('9 AM')\n=&gt; 2016-12-27 09:00:00 -0700\n</code></pre>\n\n<p>The final code would probably look something like this:</p>\n\n<pre><code>morning = Time.parse('9 AM')\n# 2016-12-27 09:00:00 -0700\n\nnight = Time.parse('10 PM')\n# 2016-12-27 22:00:00 -0700\n\nOrder.where('order_date &gt; ?', morning).where('order_date &lt; ?', night)\n\n\nOrder Load (0.2ms)  SELECT `orders`.* FROM `orders ` WHERE (order_date &gt; '2016-12-27 16:00:00.000000') AND (order_date &lt; '2016-12-28 05:00:00.000000')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2230, "user_id": 6337957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1177d893bf3115edf0119cf56e7220?s=128&d=identicon&r=PG", "display_name": "Greg Navis", "link": "https://stackoverflow.com/users/6337957/greg-navis"}, "is_accepted": false, "score": 2, "last_activity_date": 1483361583, "creation_date": 1483361583, "answer_id": 41427223, "question_id": 41340322, "link": "https://stackoverflow.com/questions/41340322/rails-4-activerecord-querying-between-times/41427223#41427223", "title": "Rails 4 ActiveRecord Querying Between Times", "body": "<h1>Method 1: <code>EXTRACT</code></h1>\n\n<p>You can use <code>EXTRACT</code> to get the hour from <code>order_date</code>:</p>\n\n<pre><code>Order.where('EXTRACT(hour FROM order_date) BETWEEN ? AND ?', 7, 20)\n</code></pre>\n\n<p>Note that I specified <code>20</code> (8 pm) as the upper range. If I used <code>21</code> then <code>order_date</code> with a time component of 21:30 would match which is not what we want.</p>\n\n<p>You can wrap the query above in a scope:</p>\n\n<pre><code>class Order &lt; ActiveRecord::Base\n  scope :between, -&gt; (start_hour, end_hour) {\n    where('EXTRACT(hour FROM order_date) BETWEEN ? AND ?', start_hour, end_hour - 1)\n  }\nend\n</code></pre>\n\n<p>There are also some other concerns you may like to address, for example checking <code>start_hour</code> and <code>end_hour</code> for valid values (e.g an hour of -1 is invalid).</p>\n\n<p>This method is simple but is limited to full hours (you can add minutes and seconds but the method would become convoluted).</p>\n\n<h1>Method 2: Explicit cast to <code>time</code></h1>\n\n<p><code>Time</code> in Ruby stores both a date <em>and</em> time. For example:</p>\n\n<pre><code>Time.parse('15:30:45') # =&gt; 2017-01-02 15:30:45 +0100\n</code></pre>\n\n<p>You can pass <code>Time</code> to PostgreSQL and cast it to Postgres <code>time</code> type explicitly:</p>\n\n<pre><code>class Order &lt; ActiveRecord::Base\n  scope :between, -&gt; (start_time, end_time) {\n    where('order_date::time BETWEEN ?::time AND ?::time', start_time, end_time)\n  }\nend\n</code></pre>\n\n<p>The advantage of this method is flexibility. The downside is a bit more complexity in handling the time in the UI. The scope expects a pair of <code>Time</code> objects. There are many ways to obtain them, for example: <code>Time.parse('12:17')</code>.</p>\n"}], "owner": {"reputation": 1239, "user_id": 2134398, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c858429a7d7289246899d678137e7ea0?s=128&d=identicon&r=PG", "display_name": "Arif", "link": "https://stackoverflow.com/users/2134398/arif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1314, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1483361583, "creation_date": 1482821180, "last_edit_date": 1483002284, "question_id": 41340322, "link": "https://stackoverflow.com/questions/41340322/rails-4-activerecord-querying-between-times", "title": "Rails 4 ActiveRecord Querying Between Times", "body": "<p>I have an orders table with <code>order_date</code> datetime column. Need a query that fetches records across all dates within a specific time range. </p>\n\n<p>Example: fetch orders across all dates between 7am ET and 9am ET.</p>\n\n<p>Something like:</p>\n\n<pre><code>Order.where('time(order_date) BETWEEN ? AND ?', '7am', '9am')\n</code></pre>\n\n<p>start and end times are coming from text fields where user can enter 2am, 3pm, 6am etc string values</p>\n"}, {"tags": ["ruby", "shell", "puppet"], "comments": [{"owner": {"reputation": 28476, "user_id": 6862601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ppP5k.jpg?s=128&g=1", "display_name": "codeforester", "link": "https://stackoverflow.com/users/6862601/codeforester"}, "edited": false, "score": 0, "creation_date": 1482819030, "post_id": 41339850, "comment_id": 69882207, "body": "Did you try printing what those variables expand to when called from inside puppet class?"}, {"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1482841467, "post_id": 41339850, "comment_id": 69892175, "body": "How is this being used inside Puppet?"}, {"owner": {"reputation": 43, "user_id": 6763774, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gcEHsjl422M/AAAAAAAAAAI/AAAAAAAAAJ0/vX_KA0wjHvU/photo.jpg?sz=128", "display_name": "Eman", "link": "https://stackoverflow.com/users/6763774/eman"}, "reply_to_user": {"reputation": 28476, "user_id": 6862601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ppP5k.jpg?s=128&g=1", "display_name": "codeforester", "link": "https://stackoverflow.com/users/6862601/codeforester"}, "edited": false, "score": 0, "creation_date": 1482987546, "post_id": 41339850, "comment_id": 69948362, "body": "@codeforester I add this to my code. cmd = &quot;#{rndc} #{cmd_arg} #{zone} in #{view}&quot; logger.debug(&quot;cmd: #{cmd}&quot;) #run the command cmd_result = eval &quot;%x(#{cmd})&quot; logger.debug(&quot;Node_Name=#{hostname} View=#{view} Zone=#{zone} api_link= #{api_link} Auth_token=#{auth_token} rndc=[#{cmd_result}]&quot;)"}, {"owner": {"reputation": 43, "user_id": 6763774, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gcEHsjl422M/AAAAAAAAAAI/AAAAAAAAAJ0/vX_KA0wjHvU/photo.jpg?sz=128", "display_name": "Eman", "link": "https://stackoverflow.com/users/6763774/eman"}, "edited": false, "score": 0, "creation_date": 1482987551, "post_id": 41339850, "comment_id": 69948364, "body": "The result in log is  D, [2016-12-29T12:52:13.851190 #28224] DEBUG -- : cmd: /home/system/bind/sbin/rndc zonestatus tikusxxyz.my in internal D, [2016-12-29T12:52:13.854864 #28224] DEBUG -- : cmd_result:  D, [2016-12-29T12:52:13.904924 #28224] DEBUG -- : Node_Name=dnsvnode1 View=internal Zone=tikusxxyz.my api_link= <a href=\"http://dnsvplatform:3030/api/v1/nodes/dns/views/zones/update_status\" rel=\"nofollow noreferrer\">dnsvplatform:3030/api/v1/nodes/dns/views/zones/update_status</a> Auth_token=Token iCDDAftiii2hzpnQMCrK2gtt rndc=[]"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6763774, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gcEHsjl422M/AAAAAAAAAAI/AAAAAAAAAJ0/vX_KA0wjHvU/photo.jpg?sz=128", "display_name": "Eman", "link": "https://stackoverflow.com/users/6763774/eman"}, "edited": false, "score": 0, "creation_date": 1483507509, "post_id": 41450978, "comment_id": 70119552, "body": "but I can excute external command right? I mean if I want to run a bash or even python it would be no problem with exec resource type right?"}], "tags": [], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "is_accepted": true, "score": 0, "last_activity_date": 1483471936, "creation_date": 1483471936, "answer_id": 41450978, "question_id": 41339850, "link": "https://stackoverflow.com/questions/41339850/puppet-run-ruby-script-with-execute-shell-command-and-variable-not-working/41450978#41450978", "title": "puppet run ruby script with execute shell command and variable not working.", "body": "<p>You are (I think) trying to run ruby code from Puppet.</p>\n\n<p>Puppet uses a DSL <em>written</em> in ruby. I suggest you get started <a href=\"https://learn.puppet.com/\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 43, "user_id": 6763774, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gcEHsjl422M/AAAAAAAAAAI/AAAAAAAAAJ0/vX_KA0wjHvU/photo.jpg?sz=128", "display_name": "Eman", "link": "https://stackoverflow.com/users/6763774/eman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 41450978, "answer_count": 1, "score": -1, "last_activity_date": 1483471936, "creation_date": 1482818690, "question_id": 41339850, "link": "https://stackoverflow.com/questions/41339850/puppet-run-ruby-script-with-execute-shell-command-and-variable-not-working", "title": "puppet run ruby script with execute shell command and variable not working.", "body": "<p>my code </p>\n\n<pre><code>cmd_result = %x(\"#{rndc}\" \"#{cmd_arg}\" \"#{zone}\" in \"#{view}\")\n\nputs \"#{$?.exitstatus}\"\nputs cmd_result\n</code></pre>\n\n<p>does not return any output and the exit status is 1. when run with puppet. </p>\n\n<p>but if I ran it manually it works normally. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "aws-cognito"], "answers": [{"tags": [], "owner": {"reputation": 312, "user_id": 7342775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hFauK.jpg?s=128&g=1", "display_name": "Rob Devereux", "link": "https://stackoverflow.com/users/7342775/rob-devereux"}, "is_accepted": true, "score": 1, "last_activity_date": 1482825786, "creation_date": 1482825786, "answer_id": 41341320, "question_id": 41339536, "link": "https://stackoverflow.com/questions/41339536/awscognitoidentityerrorsnotauthorizedexception-exception-invalid-login-to/41341320#41341320", "title": "Aws::CognitoIdentity::Errors::NotAuthorizedException Exception: Invalid login token", "body": "<p>If you're using User Pools then the idp identifier in your Logins map should not be \"www.amazon.com\". The logins map should look like this:</p>\n\n<p><code>Logins: {<br>\n'cognito-idp.&lt;region&gt;.amazonaws.com/&lt;YOUR_USER_POOL_ID&gt;': &lt;IdToken&gt;<br>\n}</code></p>\n\n<p>This page doesn't provide a Ruby example, but you should refer to it to get the idea:\n<a href=\"http://docs.aws.amazon.com/cognito/latest/developerguide/amazon-cognito-integrating-user-pools-with-identity-pools.html\" rel=\"nofollow noreferrer\">http://docs.aws.amazon.com/cognito/latest/developerguide/amazon-cognito-integrating-user-pools-with-identity-pools.html</a></p>\n"}], "owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "accepted_answer_id": 41341320, "answer_count": 1, "score": 3, "last_activity_date": 1482825786, "creation_date": 1482816734, "question_id": 41339536, "link": "https://stackoverflow.com/questions/41339536/awscognitoidentityerrorsnotauthorizedexception-exception-invalid-login-to", "title": "Aws::CognitoIdentity::Errors::NotAuthorizedException Exception: Invalid login token", "body": "<p>I am working with a <code>Rails application</code>, and i am using <code>amazon cognito</code> for <code>single sign on</code>, i have created an identity provider that is linked to my user pool, now i am trying to get <code>identity_id</code> from my cognito identity using the code as said in <a href=\"http://docs.aws.amazon.com/sdkforruby/api/Aws/CognitoIdentity/Types/GetIdInput.html#logins-instance_method\" rel=\"nofollow noreferrer\">doc</a> </p>\n\n<pre><code>cognitoidentity = Aws::CognitoIdentity::Client.new(region: 'us-east-1',)\n\ncognitoidentity.get_id({identity_pool_id: \"us-east-1:XXXXXXXXXXXXXXXXX\", logins: { \"www.amazon.com\" =&gt; &lt;Access token got from #admin_initiate_auth method&gt;}})\n</code></pre>\n\n<p>I am getting this error:</p>\n\n<blockquote>\n  <p>Aws::CognitoIdentity::Errors::NotAuthorizedException Exception:\n  Invalid login token</p>\n</blockquote>\n\n<p>I don't know what i am doing wrong.</p>\n\n<p>Please help</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1482839276, "post_id": 41340273, "comment_id": 69891147, "body": "Andrey, do you have a blog sharing your knowledge/experience? you are almost in every rails/activerecord related posts and you always offer great solutions -))"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 1, "creation_date": 1482892362, "post_id": 41340273, "comment_id": 69911080, "body": "@marmeladze thanks for this compliment - I am glad to know I help! But I am still noob, just a little less noob, than those, whose questions I answer :) But maybe someday I&#39;ll start a blog ;)"}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1483022020, "post_id": 41340273, "comment_id": 69965307, "body": "PG::UndefinedTable: ERROR: missing FROM-clause entry for table &quot;bookings&quot; LINE 1: ...erties&quot;.&quot;user_id&quot; WHERE &quot;users&quot;.&quot;id&quot; = $1 AND &quot;bookings&quot;... ^ : SELECT &quot;rooms&quot;.* FROM &quot;rooms&quot; INNER JOIN &quot;properties&quot; ON &quot;properties&quot;.&quot;id&quot; = &quot;rooms&quot;.&quot;property_id&quot; INNER JOIN &quot;users&quot; ON &quot;users&quot;.&quot;id&quot; = &quot;properties&quot;.&quot;user_id&quot; WHERE &quot;users&quot;.&quot;id&quot; = $1 AND &quot;bookings&quot;.&quot;check_in&quot; = $2"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 2, "last_activity_date": 1482820944, "creation_date": 1482820944, "answer_id": 41340273, "question_id": 41339351, "link": "https://stackoverflow.com/questions/41339351/getting-child-values-of-2nd-or-3rd-level-has-many-rails/41340273#41340273", "title": "Getting child values of 2nd or 3rd level has_many rails", "body": "<p>Join tables while querying.</p>\n\n<p>To get a set of rooms for particular user:</p>\n\n<pre><code>Room.joins(property: :user)\n    .where(\n      users:    { id: id_of_particular_user },\n      bookings: { check_in: Time.zone.now.beginning_of_day }\n    )\n</code></pre>\n"}], "owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1483112940, "creation_date": 1482815632, "last_edit_date": 1483112940, "question_id": 41339351, "link": "https://stackoverflow.com/questions/41339351/getting-child-values-of-2nd-or-3rd-level-has-many-rails", "title": "Getting child values of 2nd or 3rd level has_many rails", "body": "<p>This is how the model is structured.</p>\n\n<pre><code>User has_many :properties\n\nProperty has_many :rooms\n\nRoom has_many :bookings\n\nBooking belongs_to :Room\n</code></pre>\n\n<p>The <code>booking</code> has a table attribute called <code>check_in</code>. So for getting all booked rooms for a user I can do below</p>\n\n<p>create an array of rooms and loop through each\n    rooms=[]</p>\n\n<p>then for each room do below code</p>\n\n<p>This will work for querying from room level</p>\n\n<pre><code>room.bookings.where(\"check_in == ?\", Time.zone.now.beginning_of_day) \n</code></pre>\n\n<p>I can create few loops and get the result. But is there an efficient way to do this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1482810812, "post_id": 41338764, "comment_id": 69880237, "body": "Which part do you not understand?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1482815811, "post_id": 41338764, "comment_id": 69881248, "body": "A better way is <code>string.gsub(&#47;[a-z]&#47;i){|s| (s.ord + number).chr}</code>."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1482837855, "post_id": 41338764, "comment_id": 69890458, "body": "@sawa. Your &quot;better&quot; way has the disadvantage of not looping from &#39;z&#39; to &#39;a&#39; again. <code>W</code> + 5 is <code>B</code> in the above code, it becomes `\\` with your code."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1482838567, "post_id": 41338764, "comment_id": 69890808, "body": "You are probably right. In that case, the OP can play around with some modulo operations (<code>%</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 370, "user_id": 4437907, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7f924f25038dfd1641190572c75e7b53?s=128&d=identicon&r=PG&f=1", "display_name": "davidtaylorjr", "link": "https://stackoverflow.com/users/4437907/davidtaylorjr"}, "edited": false, "score": 0, "creation_date": 1482813843, "post_id": 41339025, "comment_id": 69880791, "body": "That was extremely helpful! Thank you!"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1482814102, "post_id": 41339025, "comment_id": 69880836, "body": "point 5 is because <code>&#39;z&#39;.next #=&gt; &#39;aa&#39;</code> etc"}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1482814121, "post_id": 41339025, "comment_id": 69880843, "body": "Ah, yes, of course. :)"}, {"owner": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "edited": false, "score": 0, "creation_date": 1482820105, "post_id": 41339025, "comment_id": 69882589, "body": "<code>(i.ord + number).chr</code> runs out of alphabet if i is toward the end(&quot;z&quot; for instance) and number is large enough(say 3)."}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "reply_to_user": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "edited": false, "score": 0, "creation_date": 1482821839, "post_id": 41339025, "comment_id": 69883189, "body": "@seph Yeah, that&#39;s why I said &quot;something like&quot;. ;-) If you go over 122, you have to use <code>(97 + sum % 122).chr</code>."}], "tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": true, "score": 2, "last_activity_date": 1482814170, "last_edit_date": 1482814170, "creation_date": 1482813124, "answer_id": 41339025, "question_id": 41338764, "link": "https://stackoverflow.com/questions/41338764/ruby-caesar-cipher-explanation/41339025#41339025", "title": "Ruby Caesar Cipher Explanation", "body": "<ol>\n<li><p>Initialize an empty string:</p>\n\n<p><code>caesar_string = \"\"</code></p></li>\n<li><p>Iterate over each character in the string (note that <code>string.each_char</code> would be preferred nowadays):</p>\n\n<p><code>string.scan (/./) do |i|</code></p>\n\n<p>Note that all Ruby style guides discourage the space between the method call and the opening parenthesis.</p></li>\n<li><p>For each letter, check if its lowercase form is in the range from \"a\" to \"z\". </p>\n\n<p><code>if (\"a\"..\"z\").include? (i.downcase)</code></p>\n\n<p>Note that defining that range outside the loop (i.e. <code>LOWERCASE_LETTERS = (\"a\"...\"z\")</code> would be better, since it avoids generating a throwaway range object on every iteration). </p></li>\n<li><p>Shift the letter <code>number</code> times:</p>\n\n<p><code>number.times {i = i.next}</code></p>\n\n<p>This works because <code>\"a\".next == \"b\"</code> The same could have been achieved with something like <code>(i.ord + number).chr</code> though without all the iterations.</p></li>\n<li><p>The character is added to the previously initialized <code>caesar_string</code>.</p>\n\n<p><code>caesar_string &lt;&lt; i[-1]</code></p>\n\n<p>The author is only using the last character of the string (<code>[-1]</code>) since <code>\"z\".next == \"aa\"</code>.</p></li>\n<li><p>The string is returned.</p>\n\n<p><code>return caesar_string</code></p>\n\n<p>Note that the use of <code>return</code> here is both unnecessary and not idiomatic.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 7325129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658e1ee0fb4e65dfe2b5689a2fc69810?s=128&d=identicon&r=PG&f=1", "display_name": "Rhys", "link": "https://stackoverflow.com/users/7325129/rhys"}, "is_accepted": false, "score": 2, "last_activity_date": 1482816007, "last_edit_date": 1482816007, "creation_date": 1482813809, "answer_id": 41339099, "question_id": 41338764, "link": "https://stackoverflow.com/questions/41338764/ruby-caesar-cipher-explanation/41339099#41339099", "title": "Ruby Caesar Cipher Explanation", "body": "<pre><code>string.scan (/./)\n</code></pre>\n\n<p>will create and array of each character in the string and then iterate over each character.</p>\n\n<pre><code>if (\"a\"..\"z\").include? (i.downcase) \n</code></pre>\n\n<p>The above statement uses a <code>Range</code> to create an array of letters of the alphabet and allows the method to only shift characters of the alphabet and skip numbers and punctuation characters that shouldn't be shifted.</p>\n\n<pre><code>number.times {i = i.next}\n</code></pre>\n\n<p>This shifts the letter 5 times to the right. However, If the <code>i</code> is <code>\"z\"</code> the <code>i.next</code> will return <code>\"ae\"</code> so the next line </p>\n\n<pre><code>caesar_string &lt;&lt; i[-1]\n</code></pre>\n\n<p>takes only the last character in the string and cuts off the \"a\" in this edge case. </p>\n\n<p>On most cases <code>i</code> will be a single character and [-1] is the only character so it works for both cases. The <code>&lt;&lt;</code> operator shovels the character onto the end of <code>caesar_string</code> to rebuild the string one character at a time. </p>\n\n<pre><code>return caesar_string\n</code></pre>\n\n<p>When the <code>string.scan (/./) do |i|</code> block has finished, the <code>caesar_string</code> is returned.</p>\n"}], "owner": {"reputation": 370, "user_id": 4437907, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7f924f25038dfd1641190572c75e7b53?s=128&d=identicon&r=PG&f=1", "display_name": "davidtaylorjr", "link": "https://stackoverflow.com/users/4437907/davidtaylorjr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1466, "favorite_count": 1, "closed_date": 1482841644, "accepted_answer_id": 41339025, "answer_count": 2, "score": 1, "last_activity_date": 1592847057, "creation_date": 1482810608, "last_edit_date": 1592847057, "question_id": 41338764, "link": "https://stackoverflow.com/questions/41338764/ruby-caesar-cipher-explanation", "closed_reason": "Needs more focus", "title": "Ruby Caesar Cipher Explanation", "body": "<p>This code works perfectly, but can anybody explains this how? I am new to the Ruby programming.\nHere is the code:</p>\n<pre><code>def caesar_cipher (string, number)\n    caesar_string = &quot;&quot;\n\n    string.scan (/./) do |i|\n      if (&quot;a&quot;..&quot;z&quot;).include? (i.downcase) # Identify letters only.\n        number.times {i = i.next}\n      end\n      caesar_string &lt;&lt; i[-1]\n    end\n    return caesar_string\n\n\n  end\n\n\n  print &quot;What would you like to encrypt?&quot;\n  text = gets.chomp\n\n  puts caesar_cipher( text, 5 )\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "pg"], "comments": [{"owner": {"reputation": 863, "user_id": 1461018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c8c2888d9ace73d7a9769e82d6e69b?s=128&d=identicon&r=PG", "display_name": "Hossam Khamis", "link": "https://stackoverflow.com/users/1461018/hossam-khamis"}, "edited": false, "score": 0, "creation_date": 1482810156, "post_id": 41338584, "comment_id": 69880157, "body": "Would you add the model code here (the validations part) ?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5698737, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50f6037b793223ea6da0e86c0742b1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Laurie", "link": "https://stackoverflow.com/users/5698737/laurie"}, "edited": false, "score": 0, "creation_date": 1482902788, "post_id": 41338860, "comment_id": 69913428, "body": "Thank you! I can&#39;t believe I forgot that! I so thought that I had it there"}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 2, "last_activity_date": 1482811438, "creation_date": 1482811438, "answer_id": 41338860, "question_id": 41338584, "link": "https://stackoverflow.com/questions/41338584/rails-throwing-activerecordstatementinvalid-pgnotnullviolation-error/41338860#41338860", "title": "Rails throwing ActiveRecord::StatementInvalid PG::NotNullViolation: ERROR", "body": "<p>The problem is you have only added database level not null validation.</p>\n\n<p>Add model level validation as well and you will get well formatted error message</p>\n\n<pre><code>validates :date, presence: true\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5698737, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50f6037b793223ea6da0e86c0742b1c7?s=128&d=identicon&r=PG&f=1", "display_name": "Laurie", "link": "https://stackoverflow.com/users/5698737/laurie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482811438, "creation_date": 1482808562, "question_id": 41338584, "link": "https://stackoverflow.com/questions/41338584/rails-throwing-activerecordstatementinvalid-pgnotnullviolation-error", "title": "Rails throwing ActiveRecord::StatementInvalid PG::NotNullViolation: ERROR", "body": "<p>I recently added bootstrap-datepicker-rails. Now when I try to save a record and I do not enter a date, I receive the active record error above.  I have validations set up - why wont it throw a more user friendly error? How can I get this to provide a user friendly error? I am using rails 4.2.7 and ruby 2.3.1.</p>\n"}]