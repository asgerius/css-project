[{"tags": ["ruby-on-rails", "ruby", "oauth", "office365api"], "comments": [{"owner": {"reputation": 630, "user_id": 1602244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c8890d2536fe3e3b8c05d7afb368047?s=128&d=identicon&r=PG", "display_name": "aconnelly", "link": "https://stackoverflow.com/users/1602244/aconnelly"}, "edited": false, "score": 0, "creation_date": 1574305253, "post_id": 58964761, "comment_id": 104188023, "body": "Office 365 was down world wide. If your setup was previously working it could be related to that.  <a href=\"https://www.nzherald.co.nz/business/news/article.cfm?c_id=3&amp;objectid=12286870\" rel=\"nofollow noreferrer\">nzherald.co.nz/business/news/&hellip;</a>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574313853, "post_id": 58964761, "comment_id": 104190094, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 839104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d50b4c70c375267036ba35bfaf84135?s=128&d=identicon&r=PG", "display_name": "Louie", "link": "https://stackoverflow.com/users/839104/louie"}, "is_accepted": false, "score": 0, "last_activity_date": 1574448284, "creation_date": 1574448284, "answer_id": 59000035, "question_id": 58964761, "link": "https://stackoverflow.com/questions/58964761/omniauth-office365-gem-permission-error-from-outlook-rest-api/59000035#59000035", "title": "omniauth-office365 gem permission error from Outlook rest API", "body": "<p>Issue was with the gem strategy omniauth-office365.  I followed <a href=\"https://docs.microsoft.com/en-us/graph/tutorials/ruby?tutorial-step=3\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/graph/tutorials/ruby?tutorial-step=3</a> and added that strategy and was able to authenticate..</p>\n"}], "owner": {"reputation": 19, "user_id": 839104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d50b4c70c375267036ba35bfaf84135?s=128&d=identicon&r=PG", "display_name": "Louie", "link": "https://stackoverflow.com/users/839104/louie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574448284, "creation_date": 1574290959, "last_edit_date": 1574347809, "question_id": 58964761, "link": "https://stackoverflow.com/questions/58964761/omniauth-office365-gem-permission-error-from-outlook-rest-api", "title": "omniauth-office365 gem permission error from Outlook rest API", "body": "<p>Hello All implementing basic office 365 integration to contacts from a rails application.  I have already connected with google using omniauth-google-oauth2 and google-api-client.  I am following <a href=\"https://docs.microsoft.com/en-us/outlook/rest/ruby-tutorial\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/outlook/rest/ruby-tutorial</a> for app setup and am using the strategy omniauth-office365 as I did previously.  It appears I have all setup right but when I authenticate I get the following error :\n<a href=\"https://i.stack.imgur.com/QbxuS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QbxuS.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have my settings in accordance to the docs, I dont know what I am missing..</p>\n\n<p>The basic usage at this moment is just to authenticate which I have added the code below to omniauth.rb:</p>\n\n<p>`</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n     provider :office365, '$myid', '$mykey',\n           {:scope =&gt; 'mail.read, User.read, profile,openid'}\nend\n</code></pre>\n\n<p>I added a route to my routes.rb:</p>\n\n<pre><code>  get 'auth/:provider/callback', to: 'contacts#contact_integrations'\n\n  get 'auth/failure', to: redirect('/')\n</code></pre>\n\n<p>In my controller I added :</p>\n\n<pre><code>  def contact_integrations\n    access_token = request.env[\"omniauth.auth\"]\n  end\n</code></pre>\n\n<p>In a view I added a link to :</p>\n\n<pre><code>&lt;%= link_to 'Outlook', \"/auth/office365\" %&gt;\n</code></pre>\n\n<p>I did the above method with google and it worked fine, of course I added more code to get what I needed from the API but the upfront authentication was obtained.  If I click the link I get the expected login/authenticate screens from office365, but it returns the permissions error shown in the image even though it is set to be able to access all accounts.</p>\n"}, {"tags": ["ruby", "callback", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 2359095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e988dbf73fedd87df75029e7eb4c760a?s=128&d=identicon&r=PG", "display_name": "Lauren", "link": "https://stackoverflow.com/users/2359095/lauren"}, "is_accepted": false, "score": 0, "last_activity_date": 1574352555, "creation_date": 1574352555, "answer_id": 58979163, "question_id": 58964409, "link": "https://stackoverflow.com/questions/58964409/active-record-callbacks-stopped-working-consistently-after-upgrading-to-rails-5/58979163#58979163", "title": "Active Record Callbacks stopped working consistently after upgrading to Rails 5", "body": "<p>This ended up being a problem with puma workers. I set puma_workers to 1 in my deploy.rb file, and now everything is working fine.</p>\n"}], "owner": {"reputation": 63, "user_id": 2359095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e988dbf73fedd87df75029e7eb4c760a?s=128&d=identicon&r=PG", "display_name": "Lauren", "link": "https://stackoverflow.com/users/2359095/lauren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574352555, "creation_date": 1574289139, "question_id": 58964409, "link": "https://stackoverflow.com/questions/58964409/active-record-callbacks-stopped-working-consistently-after-upgrading-to-rails-5", "title": "Active Record Callbacks stopped working consistently after upgrading to Rails 5", "body": "<p>I recently upgraded an app from Rails 4.2 to 5.2. This app includes several active record callbacks, where the user enters a value or clicks a button and a callback is issued to continue on with the program. After the upgrade, these callbacks are no longer working consistently in production. Locally things work fine, but once deployed (using capistrano) it regularly takes 3-6 tries to get a callback to go through. Here is my callback class:</p>\n\n<pre><code>module CallAfterCommit\n  def self.included(base)\n    base.after_commit :notify_commit # piggyback off active_record hook.\n    base.include(InstanceMethods)\n    base.extend(ClassMethods)\n  end\n\n  ##\n  # Instance methods for CallAfterCommit mixin.\n  module InstanceMethods\n    ##\n    # Takes a callback that will be called whenever any instance of this model with the same id is committed. The instance\n    # this method is called on must have an id set.\n    def add_after_commit_callback(&amp;block)\n      raise \"#{self} does not have an id yet, so it could not add callback\" if id.nil?\n\n      self.class.add_after_commit_callback(id, &amp;block)\n    end\n\n    ##\n    # Removes instances of callback to be called when a model with this id is committed.\n    def remove_after_commit_callback(callback)\n      self.class.remove_after_commit_callback(id, callback)\n    end\n\n    ##\n    # Returns true if the callback is registered for the model's id, and returns false otherwise.\n    def after_commit_callback?(callback)\n      self.class.after_commit_callback?(id, callback)\n    end\n\n    private\n\n    def notify_commit\n      self.class._notify_commit(id)\n    end\n  end\n\n  ##\n  # Class methods for CallAfterCommit mixin.\n  module ClassMethods\n    ##\n    # Add a callback to a set of callbacks for the given id. to be called after any instance with that id is committed.\n    # Returns the callback as a proc, which can be used to remove the after commit callback\n    def add_after_commit_callback(id, &amp;block)\n      raise ArgumentError, \"Cannot add callback. No record of id #{id} exists for #{self}.\" unless exists?(id)\n      raise ArgumentError, \"Cannot add callback. Callback already exists for #{id}.\" if after_commit_callback?(id, block)\n\n      registered_callbacks[id] ||= []\n      registered_callbacks[id] |= [block]\n\n      block\n    end\n\n    ##\n    #  Removes the callback for a given id. Raises an error if the callback cannot be removed.\n    def remove_after_commit_callback(id, callback)\n      raise \"Could not remove callback because it is not registered for id #{id}\" unless after_commit_callback?(id, callback)\n\n      registered_callbacks[id].delete(callback)\n      # Remove the hash entry to the empty array, so we don't collect every id ever listened to.\n      registered_callbacks.delete(id) if registered_callbacks[id].empty?\n    end\n\n    ##\n    # Returns true if the callback is registered for the given id, and returns false otherwise.\n    def after_commit_callback?(id, callback)\n      !registered_callbacks[id].nil? &amp;&amp; registered_callbacks[id].include?(callback)\n    end\n\n    ##\n    #  Execute all the callbacks registered for this id.\n    def _notify_commit(id)\n      registered_callbacks[id]&amp;.each(&amp;:call)\n    end\n\n    private\n\n    ##\n    # Returns a hash of ids to an array of callbacks\n    def registered_callbacks\n      # hash of ids to an array of callbacks\n      @registered_callbacks ||= {}\n    end\n  end\nend\n</code></pre>\n\n<p>And here is one of the places that uses said callback:</p>\n\n<pre><code>module WaitForUserSimple\n  def self.included(base)\n    base.after_initialize :setup_new_instance, if: :new_record? # piggyback off active_record hook.\n  end\n\n  ##\n  # Receive message from the user. Expects params to have a key for :user_choice and looks for 'ok' or 'quit'\n  def receive_user_data(params)\n    logger.info 'received user data'\n    details.user_choice = params[:user_choice]\n    details.save!\n  end\n\n  def stop\n    logger.info 'Stopping simple user step'\n    receive_user_data(user_choice: 'quit')\n  end\n\n  private\n\n  def setup_new_instance\n    # We need this detail when we initialize, because we watch it when waiting for the user.\n    self.details ||= SimpleUserStepDetail.new(test_step: self)\n  end\n\n  def run_test_step\n    event = Concurrent::Event.new # Use this to let us know if there has been a save since we reloaded the details.\n\n    callback = details.add_after_commit_callback do\n      logger.info(\"Callback called. Setting event for #{self}\")\n      event.set\n    end\n\n    while details.reload.user_choice.nil?\n      logger.info(\"#{self} waiting for details to be saved\")\n      event.wait\n      event.reset\n      logger.info(\"#{self} notified that event was saved. Checking details.\")\n    end\n\n    details.remove_after_commit_callback(callback)\n    logger.info(\"Got user choice: #{details.user_choice}\")\n    details.user_choice == 'ok'\n  end\nend\n</code></pre>\n\n<p>There are no error messages or logging statements to show what is going on. Does anyone have any suggestions on what may be going wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1574300989, "post_id": 58964230, "comment_id": 104187038, "body": "While I feel like this question is probably an opinion based question (and the 2 current answers start with &quot;In my opinion&quot; and &quot;it depends&quot;), I will leave a link to this tidbit about <a href=\"https://guides.rubyonrails.org/routing.html#shallow-nesting\" rel=\"nofollow noreferrer\">shallow nesting</a> in the rails guide on routing with my VTC"}], "answers": [{"tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 1, "last_activity_date": 1574289529, "creation_date": 1574289529, "answer_id": 58964502, "question_id": 58964230, "link": "https://stackoverflow.com/questions/58964230/trying-to-understand-when-to-use-nested-routes-vs-when-not/58964502#58964502", "title": "Trying to understand when to use nested routes vs. when not", "body": "<p>I'm not sure if this answer is more like an opinion, but I'd say yes - keep it simple. </p>\n\n<p>To create a post you need a <code>:blog_id</code> so a nested resource is one way to do it. Other would be <code>POST /post</code> and pass the <code>:blog_id</code> in the POST params. </p>\n\n<p>Both seem perfectly fine, and it's up to you to design your API. The biggest rule: keep it consistent. </p>\n\n<p>That being said - I can't recall single API that I was using, which used the nested resources for the create/update methods. It seems awkward: if I create a post - why one attribute of it (<code>blog_id</code>) should go in the path, and rest should be sent as params? </p>\n\n<p>On the other hand nested resources work great for the read methods: \n<code>/post/1/comments</code> instead of <code>/comments?post_id=1</code> </p>\n\n<p>Is has more natural fell to it - access resource <code>/post/1</code> and subresources as a sub path <code>/post/1/author</code>, <code>/post/1/tags</code> </p>\n\n<p>But create resources directly <code>POST /tags</code>, <code>post /comments</code> with the attributes passed on as params. </p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12212177"}, "edited": false, "score": 0, "creation_date": 1574348427, "post_id": 58964547, "comment_id": 104208822, "body": "<code>post_id</code> is actually something else. I will rename it so it doesn&#39;t cause this type of confusion."}], "tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 0, "last_activity_date": 1574289810, "creation_date": 1574289810, "answer_id": 58964547, "question_id": 58964230, "link": "https://stackoverflow.com/questions/58964230/trying-to-understand-when-to-use-nested-routes-vs-when-not/58964547#58964547", "title": "Trying to understand when to use nested routes vs. when not", "body": "<p>As always, it depends. It's ok to do what you want, it's also ok to have the update nested inside the other model (it's confusing that you have \"blog_id\" on the route and your helpers are \"post_id\" and \"id\" but you call \"id\" to find a post and \"site_id\" which is not defined (??)).</p>\n\n<p>Rails route helpers will automatically create the update nested inside the site if you do something like:</p>\n\n<pre><code>resources :blogs do\n  resources :posts\nend\n</code></pre>\n\n<p>You don't really need the blog_id, but you can use that as an extra filtering measure: if you have the blog_id, you can do <code>@post = @blog.posts.find(...)</code> instead of <code>@post = Post.find(...)</code>.</p>\n\n<p>Is it needed? no, but it gives you context and consistency on your routes (really opinionable of course).</p>\n\n<p>(Why are you permitting post_id??)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12212177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574289810, "creation_date": 1574288186, "question_id": 58964230, "link": "https://stackoverflow.com/questions/58964230/trying-to-understand-when-to-use-nested-routes-vs-when-not", "title": "Trying to understand when to use nested routes vs. when not", "body": "<p>I have the following models:</p>\n\n<pre><code>class Blog &lt; ApplicationRecord\n  has_many :posts\nend\n\nclass Post &lt; ApplicationRecord\n  belongs_to :blog\nend\n</code></pre>\n\n<p>Right now I have only two routes:</p>\n\n<ul>\n<li><code>/blogs/:blog_id/posts</code> - to create a post</li>\n<li><code>/posts/id:</code> - to update a post</li>\n</ul>\n\n<p>I'm not sure if I should change the second one to also accept a <code>:blog_id</code>. The update method (on the controller) doesn't need to use the site to update a post:</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n  before_action :set_site, only: [:create]\n  before_action :set_post, only: [:update]\n\n  PERMITED_POST_PARAMS = [\n    :post_id,\n    :title,\n    :url,\n    :body\n  ].freeze\n\n  def create\n    @post = @site.posts.build(post_params)\n\n    if @post.save\n      render json: @post, status: :created\n    else\n      render json: @post.errors, status: :unprocessable_entity\n    end\n  end\n\n  def update\n    if @post.update(post_params)\n      render json: @post\n    else\n      render json: @post.errors, status: :unprocessable_entity\n    end\n  end\n\n  private\n\n  def post_params\n    params.require(:post).permit(*PERMITED_POST_PARAMS)\n  end\n\n  def set_post\n    @post = Post.find(id)\n  end\n\n  def set_site\n    @site = Site.find(site_id)\n  end\n\n  def post_id\n    params[:post_id]\n  end\n\n  def id\n    params[:id]\n  end\nend\n</code></pre>\n\n<p>My question is: is it ok to do what I'm doing, or it a bad practice?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ruby", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1574281701, "post_id": 58962289, "comment_id": 104180805, "body": "Is this from <code>bundle exec</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1574281679, "creation_date": 1574281679, "answer_id": 58962838, "question_id": 58962289, "link": "https://stackoverflow.com/questions/58962289/how-to-disable-ruby-bundler-text-output/58962838#58962838", "title": "How to disable ruby bundler text output?", "body": "<p>Easy way is to tell it to keep quiet about what it's doing:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>bundle install --quiet\n</code></pre>\n\n<p>You may want to redirect it to a file in case something happens and it couldn't install gems:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>bundle install &gt; /tmp/bundle-install.out\n</code></pre>\n\n<p>Where you can inspect that if things go awry.</p>\n"}], "owner": {"reputation": 3536, "user_id": 5314903, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/63b7f28e96e254a2618902d079e06dba?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5314903/alex-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574281679, "creation_date": 1574279434, "question_id": 58962289, "link": "https://stackoverflow.com/questions/58962289/how-to-disable-ruby-bundler-text-output", "title": "How to disable ruby bundler text output?", "body": "<p>Whenever I run a ruby script through bundler it always gives me output similar to:</p>\n\n<pre><code>Fetching gem metadata from https://foo.bar.com/........\n...\nUsing ...\nFetching ...\nInstalling ...\n....\nBundle complete! 19 Gemfile dependencies, 145 gems now installed.\nUse `bundle info [gemname]` to see where a bundled gem is installed.\n</code></pre>\n\n<p>How can I disable this in bundler so that it just shows the output of the actual script being run?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "babeljs", "webpacker"], "comments": [{"owner": {"reputation": 10071, "user_id": 771838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0169a78f851962058d63337ad0147d6?s=128&d=identicon&r=PG", "display_name": "rossta", "link": "https://stackoverflow.com/users/771838/rossta"}, "edited": false, "score": 0, "creation_date": 1574275261, "post_id": 58960925, "comment_id": 104177728, "body": "What&#39;s in your <code>babel.config.js</code>? This would be what determines how babel processes jsx. It would need to be similar to the template provided by the rails webpacker react installer (did you use that?) <a href=\"https://github.com/rails/webpacker/blob/master/lib/install/examples/react/babel.config.js\" rel=\"nofollow noreferrer\">github.com/rails/webpacker/blob/master/lib/install/examples/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 4078, "user_id": 10549165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Redsx.png?s=128&g=1", "display_name": "Chris B.", "link": "https://stackoverflow.com/users/10549165/chris-b"}, "edited": false, "score": 1, "creation_date": 1574275293, "post_id": 58960925, "comment_id": 104177743, "body": "Looks like babel is not interpreting JSX properly. Please post your <code>webpack.config.js</code> and/or <code>.babelrc</code> files."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574275615, "post_id": 58960925, "comment_id": 104177888, "body": "Welcome to Stack Overflow! Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. See: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">How to create a Minimal, Reproducible Example</a>.&quot;"}], "owner": {"reputation": 1, "user_id": 12405768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f11a8dd2eca0f559af58cfeb2a5251?s=128&d=identicon&r=PG&f=1", "display_name": "granttnarg", "link": "https://stackoverflow.com/users/12405768/granttnarg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1510, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574273824, "creation_date": 1574273824, "question_id": 58960925, "link": "https://stackoverflow.com/questions/58960925/uncaught-error-module-build-failed-from-node-modules-babel-loader-lib-index", "title": "Uncaught Error: Module build failed (from ./node_modules/babel-loader/lib/index.js):", "body": "<p>I'm trying to add some react components to work in a Ruby on Rails set up, I had these working in a previous version of the program but had some other issues...  since re-setting everything up in rails 5.1 and webpack template I seem to be having some issues with a babel error. </p>\n\n<p>the error below ..</p>\n\n<p>I'm quite new to working with react so any push in the right direction would be great. I've seen similar issues other people were having with versions of babel and webpack not be compatible but I'm not exactly sure how to change my webpack or babel config in a rails set up or if that necessary for my setup?</p>\n\n<pre><code>Uncaught Error: Module build failed (from ./node_modules/babel-loader/lib/index.js):\nSyntaxError: /Users/worktime/code/granttnarg/Lets-Practice-Again/app/javascript/packs/dashboard.jsx: Unexpected token (35:13)\n\n  33 |   render(){\n  34 |     let autoCompleteList = this.state.autoCompleteResults.map((response, index) =&gt; {\n&gt; 35 |       return &lt;div key={index} className=\"row show-page\"&gt;\n     |              ^\n  36 |               &lt;div id=\"search-results\" className=\"container\"&gt;\n  37 |               &lt;a href={\"songs/\" + response.id}&gt;\n  38 |                 &lt;div className=\"card-product index-card\"key={index}&gt;\n    at Parser.raise (Users/worktime/code/granttnarg/Lets-Practice-Again/node_modules/@babel/parser/lib/index.js:6930)```\n\nMy package.json looks like this :\n\n``` {\n  \"name\": \"Lets-Practice-Again\",\n  \"private\": true,\n  \"dependencies\": {\n    \"@babel/preset-react\": \"^7.7.0\",\n    \"@rails/webpacker\": \"^4.2.0\",\n    \"babel-plugin-transform-react-remove-prop-types\": \"^0.4.24\",\n    \"bootstrap\": \"^4.3.1\",\n    \"cloudinary-react\": \"^1.2.1\",\n    \"jquery\": \"^3.4.1\",\n    \"popper.js\": \"^1.16.0\",\n    \"prop-types\": \"^15.7.2\",\n    \"react\": \"^16.12.0\",\n    \"react-dom\": \"^16.12.0\",\n    \"vue\": \"^2.6.10\",\n    \"vue-loader\": \"^15.7.2\",\n    \"vue-template-compiler\": \"^2.6.10\"\n  },\n  \"devDependencies\": {\n    \"webpack-dev-server\": \"^3.9.0\"\n  }\n}```\n\n\n</code></pre>\n"}, {"tags": ["ruby", "facebook-graph-api"], "answers": [{"tags": [], "owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1574363090, "creation_date": 1574363090, "answer_id": 58982056, "question_id": 58960862, "link": "https://stackoverflow.com/questions/58960862/how-to-use-a-nested-request-with-insights-in-the-facebook-api/58982056#58982056", "title": "How to use a nested request with insights in the Facebook API", "body": "<p>So, surprisingly, Facebook DOES return insights with my call. Sometimes. No explanation why, but I tried with two accounts and got on one account insights and the other not.\nMaybe it has something to do with the insights returned with this call have a shorter lifespan, so you can't get insights for older ads. Not sure. Not going to read through the million of pages.</p>\n\n<p>My solution, for whoever is interested.\nI made a call to adaccount insights directly, and specified the level as 'ad' so ir will return insights for all the account ads. I also requested the 'ad_id'. Later I was able to match the results returned with this call to the previous call I mentioned by comparing the ad ID, and merge the results.</p>\n\n<pre><code>ad_account.insights(\n    fields: ['ad_id', 'spend', 'impressions', 'clicks', 'ctr', 'cpc'], \n    level: 'ad',\n    time_range: {\n        since: date_since,\n        until: date_until\n    }\n).to_json\n</code></pre>\n"}], "owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574363090, "creation_date": 1574273550, "last_edit_date": 1574275754, "question_id": 58960862, "link": "https://stackoverflow.com/questions/58960862/how-to-use-a-nested-request-with-insights-in-the-facebook-api", "title": "How to use a nested request with insights in the Facebook API", "body": "<p>I am trying to include insights in a single call to Facebook ads API using Ruby. I researched this and got the following call:</p>\n\n<pre><code>params = {\n    'time_range': {\n        'since': '2019-08-01',\n        'until': '2019-08-31',\n    }\n}\n\nad_account.campaigns(\n    fields: [\n        'adsets{\n            id,\n            insights{spend, impressions, clicks, ctr, cpc},\n            adcreatives{id, object_story_spec, image_url, object_type}\n        }'\n    ],\n    params: params\n).to_json\n</code></pre>\n\n<p>My response:</p>\n\n<pre><code>[\n    {\n        \"adsets\"=&gt;{\n            \"data\"=&gt;[\n                {\n                    \"id\"=&gt;\"xxxxxxxxx\",\n                    \"adcreatives\"=&gt;{\n                        \"data\"=&gt;\n                            [\n                                {\n                                    \"id\"=&gt;\"xxxxxxxxxxxxxx\",\n                                    \"object_story_spec\"=&gt;{\n                                        ...\n                                    },\n                                    \"image_url\"=&gt; \"https://scontent.xx.fbcdn.net/v/xxxxxx\",\n                                    \"object_type\"=&gt;\"SHARE\"\n                                }\n                            ],\n                            \"paging\"=&gt;{\n                                \"cursors\"=&gt;{\n                                    \"before\"=&gt;\"xxxxxx\",\n                                    \"after\"=&gt;\"xxxxxxx\"\n                                }\n                            }\n                        }\n                    }\n                ],\n                ...\n</code></pre>\n\n<p>So by levels, I am able to get all the <code>campaigns</code>, then the <code>adsets</code> inside them, and the <code>adcreatives</code> inside the <code>adsets</code>, but not the <code>insights</code>.</p>\n\n<p>Am I doing something wrong? Does anyone have any experience with this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1574273539, "post_id": 58960818, "comment_id": 104176904, "body": "No. Not without converting the range into an array. This is a textbook X&amp;Y question though - ask about the problem you are trying to solve instead of your idea of the solution."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574275802, "post_id": 58960818, "comment_id": 104177977, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. Did you research this? Where? If it didn&#39;t help tell us why. What did you try? If you didn&#39;t try, why not? If you did, what did you do? We&#39;d like to see your minimal attempt to solve it."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1574322863, "post_id": 58960818, "comment_id": 104193525, "body": "<i>&quot;I imagine something similar to: ...&quot;</i> \u2013 that should work just fine with date instances instead of integers."}], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1574274660, "post_id": 58960947, "comment_id": 104177432, "body": "Note that the resulting value is no longer a range, but an array."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1574280713, "post_id": 58960947, "comment_id": 104180349, "body": "I don&#39;t know Rails but I&#39;m curious about that method. Being an <code>Enumerable</code> method it should work with an object of any class that includes <code>Enumerable</code>, such as <code>Array</code>, <code>Range</code> and <code>Set</code>. What about <code>Hash</code>? Would it take a key-value pair as argument and return an array of all other key-value pairs in the hash?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1574282745, "post_id": 58960947, "comment_id": 104181259, "body": "@CarySwoveland For hashes it takes the key to remove and returns a copy of the hash without the given keys. Similar to <code>slice</code> but inverted. For arrays, ranges and sets it returns an array since they don&#39;t define their own <code>reject</code> or return an array from <code>reject</code> already. <a href=\"https://github.com/rails/rails/blob/09a2979f75c51afb797dd60261a8930f84144af8/activesupport/lib/active_support/core_ext/enumerable.rb#L127-L135\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1106, "user_id": 6454624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-54Cw2TNXh84/AAAAAAAAAAI/AAAAAAAAAC4/Ivxon84Rp4k/photo.jpg?sz=128", "display_name": "Adim", "link": "https://stackoverflow.com/users/6454624/adim"}, "is_accepted": true, "score": 3, "last_activity_date": 1574274562, "last_edit_date": 1574274562, "creation_date": 1574273900, "answer_id": 58960947, "question_id": 58960818, "link": "https://stackoverflow.com/questions/58960818/is-there-a-way-to-delete-a-date-in-a-range-of-dates/58960947#58960947", "title": "Is there a way to delete a date in a range of dates?", "body": "<p>ActiveSupport provides the <a href=\"https://api.rubyonrails.org/classes/Enumerable.html#method-i-without\" rel=\"nofollow noreferrer\"><code>Enumerable#without</code></a> method. In your case, you can achieve this by:</p>\n\n<pre><code>dates.without(date)\n</code></pre>\n"}], "owner": {"reputation": 419, "user_id": 11993344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2450bb2dd119ad08846627702e7f96b1?s=128&d=identicon&r=PG&f=1", "display_name": "techquestion", "link": "https://stackoverflow.com/users/11993344/techquestion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 58960947, "answer_count": 1, "score": 0, "last_activity_date": 1574274562, "creation_date": 1574273338, "question_id": 58960818, "link": "https://stackoverflow.com/questions/58960818/is-there-a-way-to-delete-a-date-in-a-range-of-dates", "title": "Is there a way to delete a date in a range of dates?", "body": "<p>I have a range of dates and a date:</p>\n\n<ul>\n<li><code>dates</code>==> <code>Wed, 20 Nov 2019...Sat, 30 Nov 2019:Range</code></li>\n<li><code>date</code> ==> <code>Wed, 20 Nov 2019</code></li>\n</ul>\n\n<p><strong>Is there a way to eliminate the <code>date</code> from the <code>dates</code> range?</strong></p>\n\n<p>For reference, I imagine something similar to:</p>\n\n<pre><code>[1, 2, 7, 4, 5] - [7] which results in =&gt; [1, 2, 4, 5]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574271636, "post_id": 58960274, "comment_id": 104175895, "body": "What is <code>&quot;#{metric}_score&quot;</code>? What is <code>&quot;#{metric}_count&quot;</code>? Where those come from?"}, {"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574271689, "post_id": 58960274, "comment_id": 104175931, "body": "They are integer values created when I loop through the scores"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574271711, "post_id": 58960274, "comment_id": 104175938, "body": "They are strings in the first place."}, {"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574272147, "post_id": 58960274, "comment_id": 104176170, "body": "updated my code with how those values are tallied"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574276259, "post_id": 58960274, "comment_id": 104178182, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. We can&#39;t run the code."}, {"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574277011, "post_id": 58960274, "comment_id": 104178512, "body": "@theTinMan Sorry, I guess I didn&#39;t think running the code was required.  I was only asking how to set a variable dynamically.  Not sure how you could run the code, or why you would even need to, without having the data which I have no real way to provide here."}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 2, "creation_date": 1574273093, "post_id": 58960404, "comment_id": 104176658, "body": "Good answer. You actually can&#39;t define new local variables dynamically even if you use eval or binding.local_variable_set since both run in a separate context and the local variable will just be set there. <a href=\"https://ruby-doc.org/core-2.5.1/Binding.html#method-i-local_variable_set\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.1/&hellip;</a>"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1574272221, "last_edit_date": 1574272221, "creation_date": 1574271812, "answer_id": 58960404, "question_id": 58960274, "link": "https://stackoverflow.com/questions/58960274/how-to-use-a-dynamically-created-string-that-matches-a-local-variable-as-that-va/58960404#58960404", "title": "How to use a dynamically created string that matches a local variable as that variable", "body": "<p>Do not do this. Assemble a hash instead with</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>scores =\n  metrics.each_with_object({}) do |metric, acc|\n    if survey.has_questions_for_metric?(metric)\n      acc[\"#{metric}_adjusted_score\"] = ...\n    end\n  end\n</code></pre>\n\n<p>Local variables have a lot of limitations, including but not limited to scoping issues; with local variables, you\u2019d need to tackle with <code>binding</code> and the code soo would become a nightmare to support, even despite it\u2019s somewhat possible.</p>\n\n<hr>\n\n<p>The block updating scores might be simplified to:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>survey_scores.\n      each_with_object(Hash.new { |h, k| h[k] = {} }) do |ss|\n  %w[value_one value_two value_three].each do |metric, acc|\n    next unless ss.survey.has_questions_for_metric?(metric)\n\n    acc[metric][\"#{metric}_count\"] += 1\n    acc[metric][\"#{metric}_score\"] +=\n      ss.public_send(\"#{metric}_score\")\n  end\nend\n\n</code></pre>\n"}], "owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 58960404, "answer_count": 1, "score": 0, "last_activity_date": 1574276176, "creation_date": 1574271360, "last_edit_date": 1574276176, "question_id": 58960274, "link": "https://stackoverflow.com/questions/58960274/how-to-use-a-dynamically-created-string-that-matches-a-local-variable-as-that-va", "title": "How to use a dynamically created string that matches a local variable as that variable", "body": "<p>I have an array set:</p>\n\n<pre><code>metrics = ['value_one', 'value_two', 'value_three', 'value_four', 'value_five']\n</code></pre>\n\n<p>I then iterate the gathered scores and sum the values of each metric:</p>\n\n<pre><code>survey_scores.each do |ss|\n  if ss.survey.has_questions_for_metric?('value_one')\n    value_one_count += 1\n    value_one_score += ss.value_one_score\n  end\n  if ss.survey.has_questions_for_metric?('value_two')\n    value_two_count += 1\n    value_two_score += ss.value_two_score\n  end\n  if ss.survey.has_questions_for_metric?('value_three')\n    value_three_count += 1\n    value_three_score += ss.value_three_score\n  end\n  if ss.survey.has_questions_for_metric?('value_four')\n    value_four_count += 1\n    value_four_score += ss.value_four_score\n  end\n  if ss.survey.has_questions_for_metric?('value_five')\n    value_five_count += 1\n    value_five_score += ss.value_five_score\n  end\nend   \n</code></pre>\n\n<p>I want to retrieve those values so I can add the weights to them and I want to do this dynamically instead of writing five <code>if</code>/<code>else</code> statements that are doing the same thing. I'm using:</p>\n\n<pre><code>metrics.each do |metric|\n  if survey.has_questions_for_metric?(metric)\n    puts \"#{metric}_adjusted_score\"\n    \"#{metric}_adjusted_score\" = \"#{metric}_score\" / \"#{metric}_count\"\n  end\nend\n</code></pre>\n\n<p>but this throws a syntax error </p>\n\n<pre><code>syntax error, unexpected '=', expecting keyword_end\n</code></pre>\n\n<p>pointing to the equals sign.  I assume it is reading these as strings that mean nothing, but I'm not sure.  If I output to a log it shows the correct variable text <code>value_one_adjusted_score</code> etc.,  but I need it to be equal to the value of that variable which is set when I go through all the scores.</p>\n\n<p>I haven't found a solution that would allow me to access variables in a dynamic way.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1574267256, "post_id": 58958567, "comment_id": 104173461, "body": "Add a required argument to the method and you&#39;ll notice the difference. eg. <code>def oldmtd(value); &quot;old method with value: #{value}&quot;; end</code> (replace the semicolons with newline characters)."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1574268999, "post_id": 58958567, "comment_id": 104174483, "body": "Also note that your example doesn&#39;t work at all if you do it inside a class with instance methods. They only appear equivalent in this case because you&#39;re using global functions"}], "answers": [{"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": true, "score": 7, "last_activity_date": 1574274914, "last_edit_date": 1574274914, "creation_date": 1574266994, "answer_id": 58958988, "question_id": 58958567, "link": "https://stackoverflow.com/questions/58958567/difference-between-alias-foo-bar-and-just-foo-bar/58958988#58958988", "title": "Difference between alias foo bar and just foo = bar", "body": "<p>With <code>newmtd = oldmtd</code> you are not assigning a new variable to a function; you are assigning a variable to the <em>result</em> of a function, that is, a string. In Python terms: <code>newmtd = oldmtd()</code></p>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1574267859, "post_id": 58959033, "comment_id": 104173833, "body": "<code>alias</code> and <code>alias_method</code> have different use-cases. You want to use <code>alias</code> to statically alias methods and <code>alias_method</code> to dynamically alias methods. An advantage of <code>alias</code> is that it&#39;s picked up by RDoc, while <code>alias_method</code> isn&#39;t. Check out the Ruby style guide. <a href=\"https://github.com/rubocop-hq/ruby-style-guide#alias-method-lexically\" rel=\"nofollow noreferrer\">github.com/rubocop-hq/ruby-style-guide#alias-method-lexicall&zwnj;&#8203;y</a>"}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1574268383, "post_id": 58959033, "comment_id": 104174122, "body": "pretty sure RDoc can handle non-variable <code>alias_method</code> calls"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1574267163, "creation_date": 1574267163, "answer_id": 58959033, "question_id": 58958567, "link": "https://stackoverflow.com/questions/58958567/difference-between-alias-foo-bar-and-just-foo-bar/58959033#58959033", "title": "Difference between alias foo bar and just foo = bar", "body": "<p>Alias allows you to call an object with a different name. When you do variable assignment, you will assign it the value of whatever is returned by the right side of the <code>=</code> operator.</p>\n\n<p>When you redefine the original method, you also redefine the aliased method because it still calls the original method for which it has been aliased.</p>\n\n<p>However if you are aliasing a method, you probably want to use <code>alias_method</code> instead.  See <a href=\"https://stackoverflow.com/questions/4763121/should-i-use-alias-or-alias-method\">this question</a> for more on this.</p>\n\n<p>As for when or why to use alias, see <a href=\"https://stackoverflow.com/questions/56511244/when-should-i-use-an-alias-method-ruby\">answers to this question</a>. </p>\n"}], "owner": {"reputation": 142, "user_id": 3937816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05669dc8750d13cff68b6d6dcc103c0?s=128&d=identicon&r=PG&f=1", "display_name": "\u041f\u0430\u0432\u0435\u043b \u041a\u0430\u0439\u0433\u043e\u0440\u043e\u0434\u043e\u0432", "link": "https://stackoverflow.com/users/3937816/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb-%d0%9a%d0%b0%d0%b9%d0%b3%d0%be%d1%80%d0%be%d0%b4%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 58958988, "answer_count": 2, "score": 4, "last_activity_date": 1574274914, "creation_date": 1574265621, "question_id": 58958567, "link": "https://stackoverflow.com/questions/58958567/difference-between-alias-foo-bar-and-just-foo-bar", "title": "Difference between alias foo bar and just foo = bar", "body": "<p>While learning ruby with tutorial on rubylearning i got to 'using alias' part of it.\nI cant understand what is the difference between using alias like in example:</p>\n\n<pre><code>def oldmtd  \n  \"old method\"  \nend  \nalias newmtd oldmtd  \ndef oldmtd  \n  \"old improved method\"  \nend  \nputs oldmtd  \nputs newmtd\n</code></pre>\n\n<p>with output</p>\n\n<pre><code>old improved method\nold method\n</code></pre>\n\n<p>and just assigning a new variable to this function, like:</p>\n\n<pre><code>def oldmtd  \n  \"old method\"  \nend  \nnewmtd = oldmtd  \ndef oldmtd  \n  \"old improved method\"  \nend  \nputs oldmtd  \nputs newmtd\n</code></pre>\n\n<p>with the same output:</p>\n\n<pre><code>old improved method\nold method\n</code></pre>\n\n<p>Please, tell me what is actual difference and when it is correct to use 'alias'?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 1, "creation_date": 1574263941, "post_id": 58957812, "comment_id": 104171417, "body": "What do you want to achieve by this refactoring?"}, {"owner": {"reputation": 663, "user_id": 5110480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/210fea696d0260204d18a7a7d54bf2dd?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Mesta", "link": "https://stackoverflow.com/users/5110480/mahesh-mesta"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1574264301, "post_id": 58957812, "comment_id": 104171628, "body": "Reduce the time complexity each caused by the map and compact together"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1574271429, "post_id": 58957812, "comment_id": 104175794, "body": "Have you tested this code and ensured that it actually works before refactoring? I can imagine <code>.count.map</code> being problematic since <code>.count</code> creates a count query and returns an integer - yet you&#39;re calling map on it like it was a collection."}], "answers": [{"tags": [], "owner": {"reputation": 174, "user_id": 888892, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b074afab17e5e321061d3de660dffaaa?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/888892/stephen"}, "is_accepted": false, "score": 0, "last_activity_date": 1574276795, "last_edit_date": 1574276795, "creation_date": 1574264356, "answer_id": 58958148, "question_id": 58957812, "link": "https://stackoverflow.com/questions/58957812/is-there-a-way-to-refactor-the-following-code-in-ruby/58958148#58958148", "title": "Is there a way to Refactor the following code in ruby", "body": "<p>Step one for me would be to move the <code>where</code> clause and <code>group</code> to a named scope. That will reduce the initial segment:</p>\n\n<pre><code>Reviewing.where(reviewing_status_condition(employee_ids)).group(:employee_id).count\n</code></pre>\n\n<p>to something more like:</p>\n\n<pre><code>Reviewing.reviewing_count(reviewing_status_condition(employee_ids))\n</code></pre>\n\n<p>which is not a lot shorter but does significantly improve the separation of the implementation from execution.</p>\n\n<p>Step two depends on what version of Ruby you are using. Pre 2.7 the correct way to do the <code>map</code> and <code>compact</code> step you are doing is what you have or could be done with <code>select</code> and <code>map</code> instead but Ruby 2.7 introduces <code>filter_map</code> which is a single step combination of what you have here.</p>\n\n<p>See \"<a href=\"https://stackoverflow.com/questions/3371518/in-ruby-is-there-an-array-method-that-combines-select-and-map/56565188#56565188\">In Ruby, is there an Array method that combines &#39;select&#39; and &#39;map&#39;?</a>\" for more details on <code>filter_map</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 663, "user_id": 5110480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/210fea696d0260204d18a7a7d54bf2dd?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Mesta", "link": "https://stackoverflow.com/users/5110480/mahesh-mesta"}, "edited": false, "score": 0, "creation_date": 1574268749, "post_id": 58958152, "comment_id": 104174336, "body": "Is there no possibility to rather reduce the use of map and then compact with just one enumerator method that will solve the issue?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 663, "user_id": 5110480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/210fea696d0260204d18a7a7d54bf2dd?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Mesta", "link": "https://stackoverflow.com/users/5110480/mahesh-mesta"}, "edited": false, "score": 0, "creation_date": 1574270323, "post_id": 58958152, "comment_id": 104175209, "body": "@MaheshMesta I&#39;ve added <a href=\"https://stackoverflow.com/a/58959967/3982562\">another answer</a> addressing this in Ruby."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1574271965, "post_id": 58958152, "comment_id": 104176076, "body": "Good answer. Spending time trying to fix the iteration in Ruby is most likely a complete waste of time as the issue is really going to be pulling the all the data out of the database in the first place."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 6, "last_activity_date": 1574271880, "last_edit_date": 1574271880, "creation_date": 1574264363, "answer_id": 58958152, "question_id": 58957812, "link": "https://stackoverflow.com/questions/58957812/is-there-a-way-to-refactor-the-following-code-in-ruby/58958152#58958152", "title": "Is there a way to Refactor the following code in ruby", "body": "<p>Instead of solving this issue in Ruby you could also opt to let your database handle the problem. However to do this you first need to know what your query is going to be, I would go for something like:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT reviewings.employee_id\nFROM reviewings\nWHERE ...\nGROUP BY reviewings.employee_id\nHAVING COUNT(reviewings.id) &gt;= &lt;your value&gt;\n</code></pre>\n\n<p>This can be achieved with the following code:</p>\n\n<pre><code>reviewings = Reviewing.arel_table\n\nemployee_ids = Reviewing\n               .where(reviewing_status_condition(employee_ids))\n               .group(:employee_id)\n               .having(reviewings[:id].count.gteq(@cycle.min_required_anon_feedback))\n               .pluck(:employee_id)\n</code></pre>\n\n<p>By limiting the data returned from the database you can leave out the data manipulation on the Ruby side.</p>\n\n<p>If you'd like to know more about arel I suggest checking out their <a href=\"https://www.rubydoc.info/gems/arel/file/README.md\" rel=\"nofollow noreferrer\">readme</a>.</p>\n\n<hr>\n\n<p>Let me add a fun comparison. Let's say you'll order some pizzas.</p>\n\n<ul>\n<li><p>You are currently doing the following: You call your pizza place and ask them to send one of every pizza. When the pizzas arrive at your home you and your comrades need to figure out what pizzas to keep and which ones to throw away before eating them.</p></li>\n<li><p>I'm suggesting: Look at the menu and figure out what pizzas you need up front. Order only what you need. When the pizzas arrive at your home all decisions are already made and handled (assuming a correct delivery) and you can simply enjoy your pizza. </p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1574270571, "last_edit_date": 1574270571, "creation_date": 1574270185, "answer_id": 58959967, "question_id": 58957812, "link": "https://stackoverflow.com/questions/58957812/is-there-a-way-to-refactor-the-following-code-in-ruby/58959967#58959967", "title": "Is there a way to Refactor the following code in ruby", "body": "<p>Assuming you can't change the data supply like suggested in <a href=\"https://stackoverflow.com/a/58958152/3982562\">my other answer</a>. I would change your <code>.map{...}.compact</code> to <code>.select{...}.keys</code>, since it better communicates what you are trying to achieve with your code. You are filtering/selecting certain employee ids based upon reviewing count.</p>\n\n<pre><code>reviewings_count_per_employee = Reviewing.where(reviewing_status_condition(employee_ids)).group(:employee_id).count\n</code></pre>\n\n\n\n<pre><code>employee_ids = reviewings_count_per_employee\n               .select { |_id, count| count &gt;= @cycle.min_required_anon_feedback }\n               .keys\n</code></pre>\n\n<p>I'm not sure if this reduces the time complexity, but it certainly improves readability. I wouldn't worry to much about time complexity as long as you're in the linear realm of things. If <code>select</code> is <code>O(N)</code> and <code>keys</code> is <code>O(N)</code> then you end up with <code>O(2N)</code> which is not really an issue. If you want to keep your code <code>O(N)</code> the following does the trick.</p>\n\n<pre><code>employee_ids = []\nreviewings_count_per_employee.each do |id, count| \n  employee_ids &lt;&lt; id if count &gt;= @cycle.min_required_anon_feedback\nend\n</code></pre>\n\n<p>However I personally find the solution with <code>select</code> more readable than the <code>each</code> solution. And although this might save some CPU load, your brain has to  work harder to understand what you've written in 6-12 months time when you revisit your code.</p>\n"}], "owner": {"reputation": 663, "user_id": 5110480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/210fea696d0260204d18a7a7d54bf2dd?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Mesta", "link": "https://stackoverflow.com/users/5110480/mahesh-mesta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1574276795, "creation_date": 1574263320, "question_id": 58957812, "link": "https://stackoverflow.com/questions/58957812/is-there-a-way-to-refactor-the-following-code-in-ruby", "title": "Is there a way to Refactor the following code in ruby", "body": "<p>I have written a piece of code and need to refactor it. </p>\n\n<pre><code>Reviewing.where(reviewing_status_condition(employee_ids)).group(:employee_id).count.map{ \n|employee_id, reviewings_count_per_employee|\n    employee_id if reviewings_count_per_employee &gt;= @cycle.min_required_anon_feedback\n  }.compact\n</code></pre>\n\n<p>Can anyone help with this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 17424, "user_id": 278842, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/df6877d3f05e542ca5975b4670600f2e?s=128&d=identicon&r=PG", "display_name": "Christopher Oezbek", "link": "https://stackoverflow.com/users/278842/christopher-oezbek"}, "edited": false, "score": 1, "creation_date": 1574262957, "post_id": 58957579, "comment_id": 104170732, "body": "Hi Ernani, welcome to SO. To understand the question, you should describe what kind of environment you are looking at. For instance: Do you want to do this on the command line or as a animated picture."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1574264376, "post_id": 58957579, "comment_id": 104171681, "body": "Answering the question stated: yes, there is a way to make it happen. One just needs to write a code to accomplish the task."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1574276852, "post_id": 58957579, "comment_id": 104178430, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. We appreciate that you might be new, but we do expect evidence of the effort you&#39;ve put into this. Where did you search? Why didn&#39;t it help? If it did, where is the code you wrote to test what you learned? If you didn&#39;t write code, why not? If you did, what is the minimal code that demonstrates the problem you encountered, along with the explanation of the problem, and the minimal input data and the expected result? Without that it&#39;s hard to help you."}, {"owner": {"reputation": 53, "user_id": 12388267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDOJR8bN_EURKbdOUy0eHYj0bBcWSFycRou2kBE1A=k-s128", "display_name": "Ernani Rocha", "link": "https://stackoverflow.com/users/12388267/ernani-rocha"}, "edited": false, "score": 0, "creation_date": 1574277003, "post_id": 58957579, "comment_id": 104178505, "body": "thanks for the feedback guys :)"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1574270243, "post_id": 58958493, "comment_id": 104175150, "body": "I didn&#39;t know about <code>print &quot;\\r&quot;</code>. That&#39;s interesting."}, {"owner": {"reputation": 2458, "user_id": 2662227, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/NbVEU.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2662227/matt"}, "edited": false, "score": 0, "creation_date": 1574272863, "post_id": 58958493, "comment_id": 104176555, "body": "What specifically does <code>\\r</code> do? It&#39;s hard to Google even when searching for &quot;backslash r&quot;"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 2458, "user_id": 2662227, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/NbVEU.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2662227/matt"}, "edited": false, "score": 1, "creation_date": 1574273045, "post_id": 58958493, "comment_id": 104176639, "body": "@Matt it&#39;s linux &quot;carriage return&quot; see  <a href=\"http://man7.org/linux/man-pages/man7/ascii.7.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man7/ascii.7.html</a>  so it will return to beginning but without a new line."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1574279898, "post_id": 58958493, "comment_id": 104179972, "body": "In the midst of time typewriters evolved into <a href=\"https://en.wikipedia.org/wiki/Teleprinter\" rel=\"nofollow noreferrer\">teleprinters</a> which in turn were modified to provide a rudamentary input-output device for early computers. For output, after each line was printed it was necessary--as on a typewriter--to move the carriage back to the beginning of the line (carriage return) and also to rotate the platen (line feed) so that the next line would not overprint the last one."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 3, "last_activity_date": 1574276894, "last_edit_date": 1574276894, "creation_date": 1574265335, "answer_id": 58958493, "question_id": 58957579, "link": "https://stackoverflow.com/questions/58957579/make-words-move-in-real-time-in-ruby-on-in-the-terminal/58958493#58958493", "title": "Make words move in real time in ruby on in the terminal", "body": "<p>If you want this to just print on the terminal this should work.  Write this in a file called <code>lovex.rb</code></p>\n\n<pre><code># lovex.rb\nlove = 'LOVE'\nprint love\n[*0..4].reverse.each do |i|\n  sleep 1\n  love = love.gsub('X','')\n  love.insert(i, 'X')\n  print \"\\r\"\n  if i &gt; 0\n    print love\n  else\n    print 'LOVE'\n  end\nend\n</code></pre>\n\n<p>Then in your terminal just run:</p>\n\n<pre><code>ruby lovex.rb\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1574293557, "post_id": 58964415, "comment_id": 104185294, "body": "Nice refactor!  However I would have probably added an option for the letter to &quot;shuffle&quot; in place of <code>X</code> and named the method <code>word_line_dance</code> :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1574293874, "post_id": 58964415, "comment_id": 104185359, "body": "@lacostenycoder, thanks for the suggestions. I renamed the method."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1574293937, "post_id": 58964415, "comment_id": 104185374, "body": "Also, I could not figure out why adding <code>puts &quot;\\rLOVE&quot;</code> to the end of the script leaves <code>LOVEE</code> on the line.  Any clue?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1574295978, "post_id": 58964415, "comment_id": 104185845, "body": "@lacostenycoder, are you sure? If <code>def a; print &quot;\\rcat&quot;; puts &quot;\\rdog&quot;; end</code>, <code>a</code> prints <code>&quot;cat&quot;</code> then overprints <code>&quot;dog&quot;</code>, followed by a newline."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1574358605, "post_id": 58964415, "comment_id": 104214644, "body": "@lacostenycoder, instead of <code>puts &quot;\\rLOVE&quot;</code> as the last line, try <code>puts &quot;\\rQ&quot;</code>. After the loop ends the line is seen to be <code>&quot;LOVEE&quot;</code>. Now <code>puts &quot;\\rQ&quot;</code> is executed. The carriage return causes the write pointer to move to the beginning of the same line. It does not, however, erase what is displayed on the line. Next, <code>&quot;Q&quot;</code> is displayed at the beginning of the line, overwritting <code>&quot;L&quot;</code>, causing <code>&quot;QOVEE&quot;</code> to appear. Lastly a newline, or <i>line feed</i>, <code>&quot;\\n&quot;</code> causes the display pointer to move to the next line and (unlike its affect on a teleprinter) also performs a carriage return."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1574293844, "last_edit_date": 1574293844, "creation_date": 1574289155, "answer_id": 58964415, "question_id": 58957579, "link": "https://stackoverflow.com/questions/58957579/make-words-move-in-real-time-in-ruby-on-in-the-terminal/58964415#58964415", "title": "Make words move in real time in ruby on in the terminal", "body": "<p>I've taken @lacostenycoder's idea and implemented it in a slightly different way.</p>\n\n<pre><code>def word_line_boogie(word, ntimes, delay)\n  enum = (0.upto(word.size)).map do |i|\n    (\"\\r\"+word.dup).insert(-i-1,'X')\n  end.cycle\n  ntimes.times do\n    print enum.next\n    sleep delay\n  end\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>word_line_boogie('LOVE', 10, 1)\n</code></pre>\n\n<p>displays</p>\n\n<pre><code>LOVEX\nLOVXE\nLOXVE\nLXOVE\nXLOVE\nLOVEX\nLOVXE\nLOXVE\nLXOVE\nXLOVE\n</code></pre>\n\n<p>except all but the first word is overwrites the previous one. </p>\n\n<p>For <code>word = 'LOVE'</code>,</p>\n\n<pre><code>enum\n  #=&gt; #&lt;Enumerator: [\"\\rLOVEX\", \"\\rLOVXE\", \"\\rLOXVE\",\n  #                  \"\\rLXOVE\", \"\\rXLOVE\"]:cycle&gt;\n10.times.map { enum.next }\n  #=&gt; [\"\\rLOVEX\", \"\\rLOVXE\", \"\\rLOXVE\", \"\\rLXOVE\", \"\\rXLOVE\",\n  #    \"\\rLOVEX\", \"\\rLOVXE\", \"\\rLOXVE\", \"\\rLXOVE\", \"\\rXLOVE\"] \n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 12388267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDOJR8bN_EURKbdOUy0eHYj0bBcWSFycRou2kBE1A=k-s128", "display_name": "Ernani Rocha", "link": "https://stackoverflow.com/users/12388267/ernani-rocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 58958493, "answer_count": 2, "score": -1, "last_activity_date": 1574293844, "creation_date": 1574262608, "last_edit_date": 1574272616, "question_id": 58957579, "link": "https://stackoverflow.com/questions/58957579/make-words-move-in-real-time-in-ruby-on-in-the-terminal", "title": "Make words move in real time in ruby on in the terminal", "body": "<p>Is there a way words move/animate letters moving in time? For example:</p>\n\n<pre><code>LOVEX\n</code></pre>\n\n<p>I want to X to move between the other letters like.</p>\n\n<pre><code>LOVXE\nLOXVE\nLXOVE\n</code></pre>\n\n<p>but with one condition: I don't want to output new lines or entering new words, I want it to be on the same word in a single line so it looks kind of like a gif.</p>\n"}, {"tags": ["ruby", "time-complexity"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574261880, "post_id": 58957252, "comment_id": 104170010, "body": "Time complexity for both is obviously <code>O(N)</code>."}, {"owner": {"reputation": 663, "user_id": 5110480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/210fea696d0260204d18a7a7d54bf2dd?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Mesta", "link": "https://stackoverflow.com/users/5110480/mahesh-mesta"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574262312, "post_id": 58957252, "comment_id": 104170304, "body": "Sorry I dont think I have much context. Could you elaborate especially for map"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574262452, "post_id": 58957252, "comment_id": 104170392, "body": "<code>Enumerable#map</code> performs exactly one operation per element. Hence the complexity is in proportion to a number of elements."}], "answers": [{"tags": [], "owner": {"reputation": 541, "user_id": 12244608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rP6EG.jpg?s=128&g=1", "display_name": "TedTran2019", "link": "https://stackoverflow.com/users/12244608/tedtran2019"}, "is_accepted": false, "score": 2, "last_activity_date": 1574264794, "last_edit_date": 1574264794, "creation_date": 1574263383, "answer_id": 58957841, "question_id": 58957252, "link": "https://stackoverflow.com/questions/58957252/time-complexity-for-map-and-compact-methods-in-ruby/58957841#58957841", "title": "Time Complexity for map and compact methods in Ruby", "body": "<p>O(N), with no other alternatives. </p>\n\n<p>All map does is apply your block of code onto every element of the array, pushing each result into a new array, then returning the new array.</p>\n\n<p>All compact does is go through every element of the array, putting non-nil elements into a new array then returning said new array. </p>\n\n<p>Source code for Array #each, #map, #compact, and #compact!</p>\n\n<pre><code>rb_ary_each(VALUE ary)\n{\n    long i;\n    ary_verify(ary);\n    RETURN_SIZED_ENUMERATOR(ary, 0, 0, ary_enum_length);\n    for (i=0; i&lt;RARRAY_LEN(ary); i++) {\n    rb_yield(RARRAY_AREF(ary, i));\n    }\n}\n\nrb_ary_collect(VALUE ary)\n{\n    long i;\n    VALUE collect;\n\n    RETURN_SIZED_ENUMERATOR(ary, 0, 0, ary_enum_length);\n    collect = rb_ary_new2(RARRAY_LEN(ary));\n    for (i = 0; i &lt; RARRAY_LEN(ary); i++) {\n        rb_ary_push(collect, rb_yield(RARRAY_AREF(ary, i)));\n    }\n    return collect;\n}\n\nrb_ary_compact(VALUE ary)\n{\n    ary = rb_ary_dup(ary);\n    rb_ary_compact_bang(ary);\n    return ary;\n}\n\nrb_ary_compact_bang(VALUE ary)\n{\n    VALUE *p, *t, *end;\n    long n;\n\n    rb_ary_modify(ary);\n    p = t = (VALUE *)RARRAY_CONST_PTR_TRANSIENT(ary); /* WB: no new reference */\n    end = p + RARRAY_LEN(ary);\n\n    while (t &lt; end) {\n    if (NIL_P(*t)) t++;\n    else *p++ = *t++;\n    }\n    n = p - RARRAY_CONST_PTR_TRANSIENT(ary);\n    if (RARRAY_LEN(ary) == n) {\n    return Qnil;\n    }\n    ary_resize_smaller(ary, n);\n\n    return ary;\n}\n</code></pre>\n\n<p>Basically what Aleksei Matiushkin said.</p>\n"}], "owner": {"reputation": 663, "user_id": 5110480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/210fea696d0260204d18a7a7d54bf2dd?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Mesta", "link": "https://stackoverflow.com/users/5110480/mahesh-mesta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574264794, "creation_date": 1574261763, "question_id": 58957252, "link": "https://stackoverflow.com/questions/58957252/time-complexity-for-map-and-compact-methods-in-ruby", "title": "Time Complexity for map and compact methods in Ruby", "body": "<p>I want to know how to calculate the time complexity of the ruby map and compact method. In any case what would be the actual big O notations for them</p>\n"}, {"tags": ["ruby", "google-calendar-api", "icalendar"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1574262039, "post_id": 58957052, "comment_id": 104170132, "body": "I bet it\u2019d be faster and more appropriate to ask in <code>icalendar</code> issue tracker."}], "answers": [{"tags": [], "owner": {"reputation": 2322, "user_id": 11869748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qh4YQ.jpg?s=128&g=1", "display_name": "ZektorH", "link": "https://stackoverflow.com/users/11869748/zektorh"}, "is_accepted": false, "score": 0, "last_activity_date": 1574267834, "last_edit_date": 1592644375, "creation_date": 1574267834, "answer_id": 58959259, "question_id": 58957052, "link": "https://stackoverflow.com/questions/58957052/events-imported-by-url-to-google-calendar-appear-as-busy-private/58959259#58959259", "title": "Events imported by URL to Google Calendar appear as busy &amp; private", "body": "<p>This is a problem with the icalendar ruby gem.</p>\n<p>I've created a sample ICS file like this:</p>\n<pre><code>BEGIN:VCALENDAR\nPRODID:-//Google Inc//Google Calendar 70.9054//EN\nVERSION:2.0\nCALSCALE:GREGORIAN\nMETHOD:PUBLISH\nX-WR-CALNAME:email@domain.com\nX-WR-TIMEZONE:Europe/Madrid\nBEGIN:VEVENT\nDTSTART:20191120T160000Z\nDTEND:20191120T170000Z\nDTSTAMP:20191120T162746Z\nUID:&lt;id&gt;@domain.com\nCLASS:PUBLIC\nCREATED:20191120T162722Z\nDESCRIPTION:busy\nLAST-MODIFIED:20191120T162722Z\nLOCATION:\nSEQUENCE:0\nSTATUS:CONFIRMED\nSUMMARY:event 1\nTRANSP:OPAQUE\nEND:VEVENT\nBEGIN:VEVENT\nDTSTART:20191120T173000Z\nDTEND:20191120T183000Z\nDTSTAMP:20191120T162746Z\nUID:&lt;another-id&gt;@domain.com\nCLASS:PRIVATE\nCREATED:20191120T162733Z\nDESCRIPTION:private\nLAST-MODIFIED:20191120T162733Z\nLOCATION:\nSEQUENCE:0\nSTATUS:CONFIRMED\nSUMMARY:event 2\nTRANSP:TRANSPARENT\nEND:VEVENT\nEND:VCALENDAR\n</code></pre>\n<h1>Events</h1>\n<h2>Event 1</h2>\n<ul>\n<li>CLASS:PUBLIC</li>\n<li>TRANSP:OPAQUE</li>\n</ul>\n<p>Meaning that it's a public event and I will be considered &quot;Busy&quot; during it.</p>\n<h2>Event 2</h2>\n<ul>\n<li>CLASS:PRIVATE</li>\n<li>TRANSP:TRANSPARENT</li>\n</ul>\n<p>Meaning that it's a private event and I will be considered &quot;Free&quot; during it.</p>\n<h1>Solution</h1>\n<p>I'd recommend you head to the <a href=\"https://github.com/icalendar/icalendar/issues\" rel=\"nofollow noreferrer\">library's Issue Tracker</a> and file a bug report there.</p>\n"}], "owner": {"reputation": 35, "user_id": 7245279, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QMSS4yyCsYc/AAAAAAAAAAI/AAAAAAAAAFU/KoPcqLoPs8s/photo.jpg?sz=128", "display_name": "Alex Damian", "link": "https://stackoverflow.com/users/7245279/alex-damian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 514, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574267834, "creation_date": 1574261163, "question_id": 58957052, "link": "https://stackoverflow.com/questions/58957052/events-imported-by-url-to-google-calendar-appear-as-busy-private", "title": "Events imported by URL to Google Calendar appear as busy &amp; private", "body": "<p>Attempting to import by URL the following <code>ics</code> data by calling an endpoint on an API I'm working on. Google does import the events at the required time and date, but their title is <code>busy</code> and status <code>Private</code> even though the events contain <code>CLASS:PUBLIC</code>. Using <a href=\"https://github.com/icalendar/icalendar\" rel=\"nofollow noreferrer\">icalendar ruby gem</a> to build the ical data.</p>\n\n<p>Also, the API responds with <code>Content-Type: text/calendar</code> header. Trying to import the data below through a file format works fine. The problem is in the URL import. Did not try Outlook/iCalendar. No solutions from other stackoverflow threads worked so far.</p>\n\n<p>Any thoughts as to what might be the problem? </p>\n\n<pre><code>BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:icalendar-ruby\nCALSCALE:GREGORIAN\nMETHOD:PUBLISH\nBEGIN:VEVENT\nDTSTAMP:20191120T143449Z\nUID:4a22a9b7-8b20-487b-a4fb-bc0b6ff90adf\nDTSTART:20191121T070000\nDTEND:20191121T130000\nCLASS:PUBLIC\nSUMMARY:7a Driver\nEND:VEVENT\nBEGIN:VEVENT\nDTSTAMP:20191120T143449Z\nUID:5eda6340-bfec-417e-869a-d5f1af2ba433\nDTSTART:20191122T070000\nDTEND:20191122T130000\nCLASS:PUBLIC\nSUMMARY:7a Driver\nEND:VEVENT\nEND:VCALENDAR\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "hstore"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1574262519, "post_id": 58956960, "comment_id": 104170442, "body": "Its because ActiveRecord is built around the relational model and not json/hstore which are relatively new. <code>store_accessor</code> is really just delegation and has nothing to do with how AR builds queries."}], "answers": [{"comments": [{"owner": {"reputation": 2909, "user_id": 52924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22110fd9975ce385b01a037a6035dbdf?s=128&d=identicon&r=PG", "display_name": "Thiago Diniz", "link": "https://stackoverflow.com/users/52924/thiago-diniz"}, "edited": false, "score": 0, "creation_date": 1574277943, "post_id": 58961272, "comment_id": 104178974, "body": "Thanks for mentioning the anti-pattern I was not familiar with. I guess my example doesn&#39;t fit the user case in my current project."}, {"owner": {"reputation": 2909, "user_id": 52924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22110fd9975ce385b01a037a6035dbdf?s=128&d=identicon&r=PG", "display_name": "Thiago Diniz", "link": "https://stackoverflow.com/users/52924/thiago-diniz"}, "edited": false, "score": 1, "creation_date": 1574277989, "post_id": 58961272, "comment_id": 104178997, "body": "Another take on this: if AR is responsible for building queries and you are deliberately informing that is a hstore and the name of the key, why not build this query in an ORM manner?"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 2, "last_activity_date": 1574275236, "creation_date": 1574275236, "answer_id": 58961272, "question_id": 58956960, "link": "https://stackoverflow.com/questions/58956960/why-activerecordstore-store-acessor-doesnt-reflect-on-the-resulting-sql-when/58961272#58961272", "title": "Why ActiveRecord::Store.store_acessor doesn&#39;t reflect on the resulting SQL when querying", "body": "<p>ActiveRecord is not built to actually care about the contents of hstore, json or array columns. AR is built around the relational model with tables and columns. Columns on the table correspond to attributes in the model.</p>\n\n<p>Hstore, json and array types are relatively new database features and not definitely not polyglot. The implementation varies per database. In ActiveRecord the support for these columns is actually provided by the database driver and not the framework itself.</p>\n\n<p><code>store_accessor</code> just creates a getter/setter and sets up dirty tracking for the attribute in the model. It does not \"explicitly tell\" AR that thats something in a hstore column - remember AR gives zero fawks about the contents of a hstore column. </p>\n\n<p>In fact I would say that if your are using it this way its a very telling sign that you have fallen victim to the <a href=\"https://www.2ndquadrant.com/en/blog/postgresql-anti-patterns-unnecessary-jsonhstore-dynamic-columns/\" rel=\"nofollow noreferrer\">JSON/hstore anti-pattern</a>.</p>\n"}], "owner": {"reputation": 2909, "user_id": 52924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22110fd9975ce385b01a037a6035dbdf?s=128&d=identicon&r=PG", "display_name": "Thiago Diniz", "link": "https://stackoverflow.com/users/52924/thiago-diniz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574275236, "creation_date": 1574260881, "question_id": 58956960, "link": "https://stackoverflow.com/questions/58956960/why-activerecordstore-store-acessor-doesnt-reflect-on-the-resulting-sql-when", "title": "Why ActiveRecord::Store.store_acessor doesn&#39;t reflect on the resulting SQL when querying", "body": "<p>Consider  this class:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class UsersMigration &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table(:users) do |t|\n      t.hstore  :settings\n    end\n  end\nend\n\nclass User &lt; ActiveRecord::Base\n  store_accessor :settings, :privileges, :colors\nend\n</code></pre>\n\n<p>When doing this Query:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>User.where(privileges: 'Admin')\n</code></pre>\n\n<p>It results in this error:\n<code>ActiveRecord::StatementInvalid (PG::UndefinedColumn: ERROR:  column users.privileges does not exist)</code>\nand is right because the column is actually settings</p>\n\n<p>In order to make the query we have to do this: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>User.where(\"settings-&gt;'privileges' = 'Admin'\")\n</code></pre>\n\n<p>If the model already has explicit serialization to an hstore column why the first query doesn't result in the following SQL:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT  \"user\".* FROM \"users\" WHERE (settings-&gt;'privileges' = 'Admin')\n</code></pre>\n"}, {"tags": ["ruby", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 4994144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/airdN.jpg?s=128&g=1", "display_name": "Ehteshaam", "link": "https://stackoverflow.com/users/4994144/ehteshaam"}, "is_accepted": false, "score": 1, "last_activity_date": 1574260680, "creation_date": 1574260680, "answer_id": 58956883, "question_id": 58956866, "link": "https://stackoverflow.com/questions/58956866/uriinvalidurierror-in-bundle-config/58956883#58956883", "title": "URI::InvalidURIError in bundle config", "body": "<p>Look for mirror in ~/.bundle/config\nClean it up.\nSet the mirror again.\nRun bundle install.</p>\n"}], "owner": {"reputation": 31, "user_id": 4994144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/airdN.jpg?s=128&g=1", "display_name": "Ehteshaam", "link": "https://stackoverflow.com/users/4994144/ehteshaam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1574260680, "creation_date": 1574260638, "question_id": 58956866, "link": "https://stackoverflow.com/questions/58956866/uriinvalidurierror-in-bundle-config", "title": "URI::InvalidURIError in bundle config", "body": "<p>Getting below error while running bundle config\nSimilar error on bundle install</p>\n\n<pre><code>\n[ec2-user@683b415616c8 platform-bootstrap-omnibus]$ bundle config\nSettings are listed in order of priority. The top value will be used.\nmirror.https://rubygems.org/: \"https://ehteshaam.kazi/\n/home/ec2-user/.rvm/rubies/ruby-2.4.2/lib/ruby/2.4.0/uri/rfc3986_parser.rb:67:in `split': bad URI(is not URI?): https://rubygems.org/: \"https://ehteshaam.kazi/ (URI::InvalidURIError)\n    from /home/ec2-user/.rvm/rubies/ruby-2.4.2/lib/ruby/2.4.0/uri/rfc3986_parser.rb:73:in `parse'\n    from /home/ec2-user/.rvm/rubies/ruby-2.4.2/lib/ruby/2.4.0/uri/common.rb:231:in `parse'\n    from /home/ec2-user/.rvm/rubies/ruby-2.4.2/lib/ruby/2.4.0/uri/common.rb:737:in `URI'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/settings.rb:456:in `normalize_uri'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/settings.rb:307:in `key_for'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/settings.rb:199:in `pretty_values_for'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/cli/config.rb:109:in `block in show_pretty_values_for'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/vendor/thor/lib/thor/shell.rb:68:in `with_padding'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/cli/config.rb:108:in `show_pretty_values_for'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/cli/config.rb:66:in `block in confirm_all'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/cli/config.rb:64:in `each'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/cli/config.rb:64:in `confirm_all'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/cli/config.rb:21:in `run'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/cli.rb:481:in `config'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/vendor/thor/lib/thor.rb:387:in `dispatch'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/cli.rb:27:in `dispatch'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/vendor/thor/lib/thor/base.rb:466:in `start'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/cli.rb:18:in `start'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/exe/bundle:30:in `block in &lt;top (required)&gt;'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/lib/bundler/friendly_errors.rb:124:in `with_friendly_errors'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/gems/bundler-1.17.1/exe/bundle:22:in `&lt;top (required)&gt;'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/bin/bundle:23:in `load'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/bin/bundle:23:in `&lt;main&gt;'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/bin/ruby_executable_hooks:15:in `eval'\n    from /home/ec2-user/.rvm/gems/ruby-2.4.2/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\n\n</code></pre>\n\n<p>The mirror seems to be set correctly</p>\n\n<pre><code>\n[ec2-user@683b415616c8 platform-bootstrap-omnibus]$ bundle config mirror\nSettings for `mirror` in order of priority. The top value will be used\nSet for the current user (/home/ec2-user/.bundle/config): \"https://rubygems.org https://xyzusername:pqrpassword@artifactory.someenvironmenbt.platform.somecompany.com/artifactory/api/gems/virtual-rubygems\"\n\n</code></pre>\n\n<p>The problem was there were multiple mirror set with errors in it.\ncleaned up ~/.bundle/config and set the mirror again. This solved the issue.</p>\n"}, {"tags": ["ruby", "openssl", "rubygems", "centos7"], "comments": [{"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 1, "creation_date": 1574259654, "post_id": 58955909, "comment_id": 104168623, "body": "Why do you use <code>sudo</code> when installing gems? Probably <code>su</code> env uses some older ruby version. Try without it..."}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1574259676, "post_id": 58955909, "comment_id": 104168634, "body": "You can test by <code>sudo ruby -v</code>"}, {"owner": {"reputation": 95, "user_id": 11389702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/El3XH.jpg?s=128&g=1", "display_name": "Lewis Farnworth", "link": "https://stackoverflow.com/users/11389702/lewis-farnworth"}, "reply_to_user": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1574419009, "post_id": 58955909, "comment_id": 104235591, "body": "I did consult with a colleague, and he suggested the same idea... However, I could still not use gem to install openSSL, it simply gave me the same error message.   I tried gem update, then tried again... I&#39;m thinking it might be a gem versioning issue... Will try that line of reasoning and get back to you on that one. Thanks :)"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 11389702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/El3XH.jpg?s=128&g=1", "display_name": "Lewis Farnworth", "link": "https://stackoverflow.com/users/11389702/lewis-farnworth"}, "edited": false, "score": 0, "creation_date": 1574417118, "post_id": 58956571, "comment_id": 104234569, "body": "Hello, thank you for your input.. I spoken to a colleague, who did suggest the same thing... However, I tried to install the same version as both super user and normal user, and still had the same problem :/"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "reply_to_user": {"reputation": 95, "user_id": 11389702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/El3XH.jpg?s=128&g=1", "display_name": "Lewis Farnworth", "link": "https://stackoverflow.com/users/11389702/lewis-farnworth"}, "edited": false, "score": 0, "creation_date": 1574432140, "post_id": 58956571, "comment_id": 104242338, "body": "But why do you install gems with <code>sudo</code>, is there a special need for that?"}, {"owner": {"reputation": 95, "user_id": 11389702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/El3XH.jpg?s=128&g=1", "display_name": "Lewis Farnworth", "link": "https://stackoverflow.com/users/11389702/lewis-farnworth"}, "edited": false, "score": 0, "creation_date": 1574439882, "post_id": 58956571, "comment_id": 104246573, "body": "I simply tried sudo as doing it as the current user didn&#39;t work.... I was under the impression that sudo might have fixed it... To no avail :/"}], "tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 0, "last_activity_date": 1574259785, "creation_date": 1574259785, "answer_id": 58956571, "question_id": 58955909, "link": "https://stackoverflow.com/questions/58955909/unable-to-install-ruby-openssl/58956571#58956571", "title": "Unable to install Ruby OpenSSL", "body": "<p>Try installing gems without <code>sudo</code>. I did such test locally</p>\n\n<pre><code>$ ruby -v\nruby 2.6.0p0 (2018-12-25 revision 66547) [x86_64-linux] \n$ sudo ruby -v\nsudo: ruby: command not found\n</code></pre>\n\n<p>Probably your superuser env is not using the same ruby version as your current user's env.</p>\n"}], "owner": {"reputation": 95, "user_id": 11389702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/El3XH.jpg?s=128&g=1", "display_name": "Lewis Farnworth", "link": "https://stackoverflow.com/users/11389702/lewis-farnworth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574259785, "creation_date": 1574257744, "question_id": 58955909, "link": "https://stackoverflow.com/questions/58955909/unable-to-install-ruby-openssl", "title": "Unable to install Ruby OpenSSL", "body": "<p>So, I just updated Ruby version on a CentOS 7 box, to allow for the use of OpenSSL, using this guide:\n<a href=\"https://www.server-world.info/en/note?os=CentOS_7&amp;p=ruby23\" rel=\"nofollow noreferrer\">https://www.server-world.info/en/note?os=CentOS_7&amp;p=ruby23</a></p>\n\n<p>However, the version is now set to 2.3.8 as per: </p>\n\n<pre><code>$ ruby -v\nruby 2.3.8p459 (2018-10-18 revision 65136) [x86_64-linux]\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>$ which ruby\n/opt/rh/rh-ruby23/root/usr/bin/ruby\n$ which gem\n/opt/rh/rh-ruby23/root/usr/bin/gem\n</code></pre>\n\n<p>BUT, gem throws the same error as before hand:</p>\n\n<pre><code>$ sudo gem install openssl\nERROR:  Error installing openssl:\n        openssl requires Ruby version &gt;= 2.3.0.\n</code></pre>\n\n<p>Any ideas? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 173, "user_id": 10442723, "user_type": "registered", "profile_image": "https://graph.facebook.com/1867306933351812/picture?type=large", "display_name": "Aman Relan", "link": "https://stackoverflow.com/users/10442723/aman-relan"}, "edited": false, "score": 0, "creation_date": 1574258817, "post_id": 58955881, "comment_id": 104168070, "body": "You would do that in the post model rather than in the user model, so go to post.rb and add it to that file referring to the user."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8532831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0641d322d981f910d9d268ef0c5eec?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8532831/daniel"}, "edited": false, "score": 0, "creation_date": 1574258058, "post_id": 58955961, "comment_id": 104167585, "body": "Ah, obviously. Thanks!"}, {"owner": {"reputation": 33, "user_id": 8532831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0641d322d981f910d9d268ef0c5eec?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8532831/daniel"}, "edited": false, "score": 0, "creation_date": 1574261580, "post_id": 58955961, "comment_id": 104169810, "body": "Is there also a way to use this in the PostsController, rather than in the model itself? Defining the complete_referral! as self.complete_referral! and creating the private method you posted in the PostsController yields in <code>undefined local variable or method user for  Did you mean? super</code>"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 33, "user_id": 8532831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0641d322d981f910d9d268ef0c5eec?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8532831/daniel"}, "edited": false, "score": 0, "creation_date": 1574262767, "post_id": 58955961, "comment_id": 104170614, "body": "Do you have a relation between <code>Post</code> and <code>User</code>? How is it called?"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1574257903, "creation_date": 1574257903, "answer_id": 58955961, "question_id": 58955881, "link": "https://stackoverflow.com/questions/58955881/run-model-method-after-user-creates-a-object-in-controller/58955961#58955961", "title": "Run model method after user creates a object in controller", "body": "<p>You need to define the callback in the <code>Post</code> class, e.g.</p>\n\n<pre><code>class Post &lt; ApplicationRecord\n  after_create :complete_referral!\n  # ...\n\n  private\n  def complete_referral!\n    user.complete_referral!\n  end\nend\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 8532831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0641d322d981f910d9d268ef0c5eec?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8532831/daniel"}, "edited": false, "score": 0, "creation_date": 1574262442, "post_id": 58956889, "comment_id": 104170385, "body": "Thanks! It seem that i would like to use something like unless current_user with the after_create and unfortunately that doesn&#39;t quite work. How would you approach this, but instead of using the Post model using the PostsController?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 33, "user_id": 8532831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0641d322d981f910d9d268ef0c5eec?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8532831/daniel"}, "edited": false, "score": 0, "creation_date": 1574262832, "post_id": 58956889, "comment_id": 104170659, "body": "I&#39;m not sure I understand what you are asking. <code>@post = User.find(some_param).referred_posts.new(post_params)</code> is something you would do in your <code>PostsController#create method</code>. If you wanted to do this conditionally if there is a current user you can do <code>@post = current_user  ? current_user.referred_posts.new(post_params) : Post.new(post_params)</code>."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 3, "last_activity_date": 1574262265, "last_edit_date": 1574262265, "creation_date": 1574260690, "answer_id": 58956889, "question_id": 58955881, "link": "https://stackoverflow.com/questions/58955881/run-model-method-after-user-creates-a-object-in-controller/58956889#58956889", "title": "Run model method after user creates a object in controller", "body": "<p>You could also use an <a href=\"https://guides.rubyonrails.org/association_basics.html#association-callbacks\" rel=\"nofollow noreferrer\">association callback</a>:</p>\n\n<pre><code>class Post &lt; ApplicationRecord\n  belongs_to :referrer, class_name: 'User', optional: true\nend\n\nclass User &lt; ApplicationRecord\n  has_many :referred_posts, \n    class_name: 'Post', \n    foreign_key: 'referrer_id',\n    after_add: :complete_referral!\nend\n</code></pre>\n\n<p>The callback is then called when you create a post from the association:</p>\n\n<pre><code>@post = User.find(some_param).referred_posts.new(post_params)\n</code></pre>\n\n<p>The reason I would use this instead of a regular callback is that it does not create a hard dependency from Post to User that you have to address in all your tests when you just want to create a post record. </p>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1574263076, "post_id": 58957555, "comment_id": 104170816, "body": "You kind of defeat the whole point of your argument by not checking the return value of save in the example."}, {"owner": {"reputation": 33, "user_id": 8532831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0641d322d981f910d9d268ef0c5eec?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8532831/daniel"}, "edited": false, "score": 0, "creation_date": 1574263123, "post_id": 58957555, "comment_id": 104170848, "body": "Thank you this worked like a charm! Managed to add this to the controller and now it runs the complete_referral! only on user&#39;s that have been referred <code>current_user.complete_referral! unless (current_user &amp;&amp; current_user.referred_by_id.nil?)</code>"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1574264259, "post_id": 58957555, "comment_id": 104171605, "body": "@max definitely good point, of course I simply extended the OP&#39;s example, I am assuming they have error handling in their code as well (and simplified the code for this example --also a referral system is in general more complicated). But I edited the code accordingly."}], "tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": false, "score": 1, "last_activity_date": 1574264255, "last_edit_date": 1574264255, "creation_date": 1574262542, "answer_id": 58957555, "question_id": 58955881, "link": "https://stackoverflow.com/questions/58955881/run-model-method-after-user-creates-a-object-in-controller/58957555#58957555", "title": "Run model method after user creates a object in controller", "body": "<p>The other answers use callbacks, and I love callbacks in my models, <em>if</em> the callbacks are necessary to keep my data in a correct state. In this case I would prefer to do this in the controller, because <em>only if</em> a post is saved through the controller (by a user), do we want to call <code>complete_referral!</code> <em>on the user</em>, not when we create a post in the tests or in the console (or on import etc.etc.)</p>\n\n<p>So in that case in the <code>PostsController</code> we write </p>\n\n<pre><code>def create\n  @post = current_user.posts.build(post_params)\n  if @post.save\n    current_user.complete_referral! \n  end \nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8532831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0641d322d981f910d9d268ef0c5eec?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8532831/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 58955961, "answer_count": 3, "score": 1, "last_activity_date": 1574264255, "creation_date": 1574257646, "last_edit_date": 1574257957, "question_id": 58955881, "link": "https://stackoverflow.com/questions/58955881/run-model-method-after-user-creates-a-object-in-controller", "title": "Run model method after user creates a object in controller", "body": "<p>I'm looking for help with a problem I'm facing. I have a referral program and i would like to run a method when the user who was referred creates a <code>Post</code>. In my <code>user.rb</code> file I have:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def complete_referral!\n  update(referral_completed_at: Time.zone.now)\nend\n</code></pre>\n\n<p>And my <code>PostsController</code> has:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create\n  @post = current_user.posts.build(post_params)\n  @post.save\nend\n</code></pre>\n\n<p>Some ideas I've tried was trying to run the complete_referral! method on <code>post.rb</code> like so:</p>\n\n<p><code>after_create :complete_referral!</code></p>\n\n<p>but that just raised an <code>undefined method complete_referral!' for #&lt;Post:0x00007ff65b0514d8&gt;</code> error.</p>\n\n<p>Any ideas would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "helper"], "comments": [{"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "edited": false, "score": 0, "creation_date": 1574248641, "post_id": 58952910, "comment_id": 104162016, "body": "Without giving you the exact code, I&#39;d start by thinking what does those queries do and if there are alternatives ways to do it (by looking what you have here, I can say definetely there are). Try to encapsulate the logic in a scope on <code>Checkresult</code> and then you&#39;ll see the refactor."}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 2, "creation_date": 1574254567, "post_id": 58953839, "comment_id": 104165447, "body": "Instead of <code>.map(&amp;:id)</code> you can just use <code>.ids</code>."}, {"owner": {"reputation": 29, "user_id": 12290999, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDmzLvcm7Jf-yw-DNg4r-FozcY9YkPXdiMLfJnb=k-s128", "display_name": "the Xavi", "link": "https://stackoverflow.com/users/12290999/the-xavi"}, "edited": false, "score": 0, "creation_date": 1574258418, "post_id": 58953839, "comment_id": 104167823, "body": "Thank you that helped me alot. I used the line where the if statement is at last. Didnt know that worked. Now i have a 3 liner that works and i dont have redundant code."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 2, "last_activity_date": 1574251003, "creation_date": 1574251003, "answer_id": 58953839, "question_id": 58952910, "link": "https://stackoverflow.com/questions/58952910/how-do-i-make-my-code-for-my-helper-more-slim/58953839#58953839", "title": "How do i make my code for my helper more slim?", "body": "<p>You can simplify this code by limiting the <code>if</code> condition to the part that actually varies, rather than repeating a larger section of code.</p>\n\n<p>Also (a minor point), you can use <code>Symbol#to_proc</code> to shorted the <code>map</code> syntax:</p>\n\n<pre><code>def most_recent_checkresult_ids\n  check_results = Checkresult.select(:check_id, \"MAX(id) as id\")\n  check_results = check_results.where(check_id: @check_ids) if @check_ids\n\n  check_results.group(:check_id).map(&amp;:id)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1574255272, "creation_date": 1574255272, "answer_id": 58955107, "question_id": 58952910, "link": "https://stackoverflow.com/questions/58952910/how-do-i-make-my-code-for-my-helper-more-slim/58955107#58955107", "title": "How do i make my code for my helper more slim?", "body": "<p>You do not need stateful class and a ton of helpers.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class OverallStatus\n  def self.ok?(check_ids = nil)\n    ids = Checkresult.select(:check_id, \"MAX(id) as id\")\n    ids = ids.where(check_id: check_ids) unless check_ids.nil?\n\n    not Checkresult.where(id: ids, status: false).exists?\n  end\nend\n</code></pre>\n\n<p>And use it as</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>OverallStatus.ok?([1, 2, 3])\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 12290999, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDmzLvcm7Jf-yw-DNg4r-FozcY9YkPXdiMLfJnb=k-s128", "display_name": "the Xavi", "link": "https://stackoverflow.com/users/12290999/the-xavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58953839, "answer_count": 2, "score": 1, "last_activity_date": 1574255272, "creation_date": 1574248071, "question_id": 58952910, "link": "https://stackoverflow.com/questions/58952910/how-do-i-make-my-code-for-my-helper-more-slim", "title": "How do i make my code for my helper more slim?", "body": "<p>First of all i am new to asking questions on stackoverflow. If you downvote this question please let me know why and how i can change it.</p>\n\n<p>So i am working on a status webpage for our intern services.</p>\n\n<p>This is the code i have and to be clear i want to make the method \"most_recent_checkresult_ids\" more slim: </p>\n\n<pre><code>\n  1 class OverallStatus\n  2   def initialize(check_ids)\n  3     @check_ids = check_ids\n  4   end\n  5\n  6   def ok?\n  7     !not_ok?\n  8   end\n  9\n 10   def not_ok?\n 11     Checkresult.where(id: most_recent_checkresult_ids).where(status: false).exists?\n 12   end\n 13\n 14\n 15\n 16   private\n 17\n 18   def most_recent_checkresult_ids\n 19     if @check_ids == nil\n 20    Checkresult\n 21     .select(:check_id, \"MAX(id) as id\")\n 22     .group(:check_id)\n 23     .map { |cr| cr.id }\n 24     else\n 25    Checkresult\n 26     .select(:check_id, \"MAX(id) as id\")\n 27     .where(check_id: @check_ids)\n 28     .group(:check_id)\n 29     .map { |cr| cr.id }\n 30     end\n 31   end\n 32 end\n\n</code></pre>\n\n<p>How could i do that? I dont want redundant code and i know there is a way to shorten it but i dont know how.</p>\n"}, {"tags": ["ruby", "error-handling", "rspec", "stderr", "argv"], "comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1574250384, "post_id": 58952503, "comment_id": 104162997, "body": "You did not write for which line you get the error message, but if you really run the program by <code>ruby collector.rb</code>, <code>ARGV</code> will be empty and <code>Collector::initialize</code> is called with zero arguments."}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1574271704, "last_edit_date": 1574271704, "creation_date": 1574247365, "answer_id": 58952670, "question_id": 58952503, "link": "https://stackoverflow.com/questions/58952503/ruby-rspec-fails-when-try-to-test-stderr-output/58952670#58952670", "title": "Ruby: RSpec fails when try to test STDERR output", "body": "<p>Backquotes in ruby run a command in a separate process. When you test <code>to_output...to_stderr</code> you test it on the parent process (RSpec), not the child process (ruby).</p>\n\n<p>In order to test child process stderr, you can use <a href=\"https://docs.ruby-lang.org/en/2.5.0/Open3.html#method-c-popen3\" rel=\"nofollow noreferrer\"><code>Open3.popen3</code></a> that gives you access to process stderr.</p>\n\n<p>Try sth like this (not tested):</p>\n\n<pre><code>require 'open3'\n\nspecify do\n  Open3.popen3(\"ruby #{exec}\") do |_stdin, _stdout, stderr|\n    expect(stderr.read.strip).to eq('wrong number of arguments (given 0, expected 1)')\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 58952670, "answer_count": 1, "score": 2, "last_activity_date": 1574271704, "creation_date": 1574246832, "last_edit_date": 1574247384, "question_id": 58952503, "link": "https://stackoverflow.com/questions/58952503/ruby-rspec-fails-when-try-to-test-stderr-output", "title": "Ruby: RSpec fails when try to test STDERR output", "body": "<p>I have <code>collector.rb</code> file with something like this:</p>\n\n<pre><code>class Collector\n  def initialize(input)\n    raise ArgumentError, 'must be positive integer' unless input.to_i.positive?\n  end\n  # more code...\nend\n\nbegin\n  Collector.new(*ARGV).do_something\nrescue ArgumentError =&gt; e\n  warn e.message\nend\n</code></pre>\n\n<p>So when I do <code>$ ruby collector.rb</code> in terminal, I get <code>wrong number of arguments (given 0, expected 1)</code> as expected <a href=\"https://docs.ruby-lang.org/en/2.6.0/syntax/exceptions_rdoc.html\" rel=\"nofollow noreferrer\">from Ruby docs</a></p>\n\n<p>In my test file I have:</p>\n\n<pre><code>require 'rspec'\nrequire './collector'\n\nRSpec.describe Collector do\n  let(:exec) { File.expand_path('../collector.rb', File.dirname(__FILE__)) }\n\n  describe 'input in console' do\n    context 'when wrong number of arguments' do\n      specify { expect {`ruby #{exec} `}.to output('wrong number of arguments (given 0, expected 1)').to_stderr }\n    end\n  end\nend\n</code></pre>\n\n<p>At the moment my test is failing as it cannot detect any output to <code>STDERR</code> although I'm following recommendation <a href=\"https://relishapp.com/rspec/rspec-expectations/docs/built-in-matchers/output-matcher#output-to-stderr-matcher\" rel=\"nofollow noreferrer\">from here</a>\n<strong>What am I doing wrong here, please?</strong> I'd be happy for any hint how to fix my code.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "enums", "ruby-on-rails-5", "enumeration"], "comments": [{"owner": {"reputation": 1339, "user_id": 6295641, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tXMWi.jpg?s=128&g=1", "display_name": "Karthick Nagarajan", "link": "https://stackoverflow.com/users/6295641/karthick-nagarajan"}, "edited": false, "score": 0, "creation_date": 1574243511, "post_id": 58951296, "comment_id": 104158918, "body": "Hi @haseeb Ahmad what is the error you got?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574243702, "post_id": 58951296, "comment_id": 104159036, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. We want to see the minimal code necessary to demonstrate the problem you&#39;re having. Currently we can&#39;t imagine the code, or the database, or what you&#39;ve tried, so you have to help us help you."}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 1339, "user_id": 6295641, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tXMWi.jpg?s=128&g=1", "display_name": "Karthick Nagarajan", "link": "https://stackoverflow.com/users/6295641/karthick-nagarajan"}, "edited": false, "score": 0, "creation_date": 1574244447, "post_id": 58951296, "comment_id": 104159491, "body": "@karthicknagarajan i update the question"}], "answers": [{"comments": [{"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1574245490, "post_id": 58951976, "comment_id": 104160150, "body": "Model.first.status also returns nil"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1574245523, "post_id": 58951976, "comment_id": 104160173, "body": "It have Awaiting Review in database but when I do Model.first.status it returns nil"}, {"owner": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "reply_to_user": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1574245735, "post_id": 58951976, "comment_id": 104160308, "body": "@HaseebAhmad Just updated my answer, let me know if you have any other query or issue"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1574245922, "post_id": 58951976, "comment_id": 104160436, "body": "Thank you.... but in others also nil to capitalize issue...how can I fix that?"}, {"owner": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "reply_to_user": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1574246153, "post_id": 58951976, "comment_id": 104160581, "body": "@HaseebAhmad Just updated my answer, just use the last approach and it should work, just update the hash string values to what&#39;s there in the table for each status!"}, {"owner": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "reply_to_user": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1574274060, "post_id": 58951976, "comment_id": 104177163, "body": "@HaseebAhmad Please accept the answer if it helped you resolve the issue."}], "tags": [], "owner": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1574246431, "last_edit_date": 1574246431, "creation_date": 1574245310, "answer_id": 58951976, "question_id": 58951296, "link": "https://stackoverflow.com/questions/58951296/how-to-integrate-enum-on-existing-attributes-rails/58951976#58951976", "title": "How to integrate enum on existing attributes rails", "body": "<p>Your issue is, you are trying to do this <code>Model.status</code>, it won't return anything, because <code>status</code> is an instance method, not class method, if you want to see all the statuses, do this</p>\n\n<pre><code>Model.statuses\n</code></pre>\n\n<p>It returns a hash, if you want to fetch status of a Model object, here's an example</p>\n\n<pre><code>Model.first.status\n</code></pre>\n\n<p>And, by default, enum expects an integer column, so if you define enum like this</p>\n\n<pre><code>enum status: [:active,:closed,:pending,:awaiting_review]\n</code></pre>\n\n<p>Then, the value in table would be <code>0, 1, 2, 3</code> for each respectively.</p>\n\n<p>So you might want to migrate <code>status</code> column to <code>integer</code> and then write a rake task to update the existing values to the new ones according to the enum values!</p>\n\n<p>In your case, you say <code>awaiting_review</code> is returning nil because your existing value was <code>awaiting review</code>, i.e., without the underscore. For a quick fix, define this method in your model</p>\n\n<pre><code>def status\n  if self.read_attribute_before_type_cast(:status) == 'Awaiting Review'\n    'Awaiting Review'\n  else\n    super\n  end\nend\n</code></pre>\n\n<p>To use the above approach for every case, define your enum like this instead</p>\n\n<pre><code>enum status: { active: 'active', closed: 'closed', pending: 'pending', awaiting_review: 'Awaiting Review' }\n</code></pre>\n\n<p>Change the string hash values according to what is saved in your table</p>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574246431, "creation_date": 1574243348, "last_edit_date": 1574245469, "question_id": 58951296, "link": "https://stackoverflow.com/questions/58951296/how-to-integrate-enum-on-existing-attributes-rails", "title": "How to integrate enum on existing attributes rails", "body": "<p>I want to use <code>enum</code> on existing date.\nThere is column <code>status</code> in table containing thousands of records.</p>\n\n<p>Issue is that records in my db are in capital like <strong>Active</strong>,<strong>Pending</strong>,<strong>Awaiting Review</strong>,<strong>Closed</strong> etc </p>\n\n<p>Now I define an enum </p>\n\n<pre><code>enum status: [:active,:closed,:pending,:awaiting_review]\n</code></pre>\n\n<p>How its not working due to capital reason and underscore instead of space. </p>\n\n<p>When I do <code>Model.first.status</code> it return nil </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "mocking"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1574240408, "creation_date": 1574240408, "answer_id": 58950358, "question_id": 58950058, "link": "https://stackoverflow.com/questions/58950058/rspec-nomethoderror-in-broken-mock/58950358#58950358", "title": "RSpec NoMethodError in broken mock", "body": "<p>I would try to use <a href=\"https://relishapp.com/rspec/rspec-mocks/docs/working-with-legacy-code/any-instance\" rel=\"nofollow noreferrer\"><code>allow_any_instance_of</code></a>:</p>\n\n<pre><code>allow_any_instance_of(ApplicationController).to receive(:maintenance_mode_active).and_return(false)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1106, "user_id": 6454624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-54Cw2TNXh84/AAAAAAAAAAI/AAAAAAAAAC4/Ivxon84Rp4k/photo.jpg?sz=128", "display_name": "Adim", "link": "https://stackoverflow.com/users/6454624/adim"}, "is_accepted": false, "score": 0, "last_activity_date": 1574240517, "creation_date": 1574240517, "answer_id": 58950394, "question_id": 58950058, "link": "https://stackoverflow.com/questions/58950058/rspec-nomethoderror-in-broken-mock/58950394#58950394", "title": "RSpec NoMethodError in broken mock", "body": "<p>Since the stub is happening in the maintenance mode controller itself, you should try:</p>\n\n<pre><code>controller.stub(:maintenance_mode_active).and_return(false)\n</code></pre>\n\n<p><code>allow_any_instance_of</code> or <code>expect_any_instance_of</code> is considered an anti-pattern for a number of reasons. You can read more about this <a href=\"https://relishapp.com/rspec/rspec-mocks/docs/working-with-legacy-code/any-instance\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1574240517, "creation_date": 1574239480, "last_edit_date": 1574240444, "question_id": 58950058, "link": "https://stackoverflow.com/questions/58950058/rspec-nomethoderror-in-broken-mock", "title": "RSpec NoMethodError in broken mock", "body": "<p>In <code>ApplicationController</code> I've got method which results I want to test in a <code>maintenance_mode_controller_specs</code>. How to create mock <code>maintenance_mode_active</code> method which will return false in specs?</p>\n\n<p><code>ApplicationController.rb</code></p>\n\n<pre><code>def maintenance_mode_active\n  # ...\n\n  feature_flag.active\nend\n</code></pre>\n\n<p><code>maintenance_mode_controller_spec</code></p>\n\n<pre><code>context 'when maintenance mode is inactive' do\n  let(:application_controller) { instance_double(ApplicationController) }\n\n  before do\n    allow(ApplicationController).to receive(:new).and_return(application_controller)\n    allow(application_controller).to receive(:maintenance_mode_active).and_return(false)\n  end\n\n  it 'redirect to root page' do\n    get :maintenance_mode\n    expect(response).to have_http_status(:redirect)\n  end\nend\n</code></pre>\n\n<p>with specs above I've got an error: </p>\n\n<blockquote>\n  <p>Failure/Error: feature_flag.active</p>\n  \n  <p>NoMethodError:\n         undefined method `active' for nil:NilClass\n         Did you mean?  acts_like?</p>\n</blockquote>\n\n<p>Which means mock doesn't worked.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actionmailer"], "comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1574254318, "post_id": 58949322, "comment_id": 104165288, "body": "Is it the full error stack?"}], "answers": [{"tags": [], "owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "is_accepted": false, "score": 0, "last_activity_date": 1574335719, "creation_date": 1574335719, "answer_id": 58973920, "question_id": 58949322, "link": "https://stackoverflow.com/questions/58949322/how-to-send-s3-secured-file-as-an-attachment-in-email-in-ruby-on-rails/58973920#58973920", "title": "How to send S3 secured file as an attachment in email in Ruby on Rails", "body": "<p>I was able to solve the issue after using \"require 'open-uri'\" in the UserMailer.</p>\n"}], "owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1574335719, "creation_date": 1574236690, "last_edit_date": 1574246526, "question_id": 58949322, "link": "https://stackoverflow.com/questions/58949322/how-to-send-s3-secured-file-as-an-attachment-in-email-in-ruby-on-rails", "title": "How to send S3 secured file as an attachment in email in Ruby on Rails", "body": "<p>I am using Ruby on Rails application and need to send an email with an attachment of S3 secured file.</p>\n\n<p>Below is my sample Mailer</p>\n\n<pre><code>class UserMailer &lt; ApplicationMailer\n  default from: 'notifications@example.com'\n\n  def welcome_email(s3_obj)\n    attachments['sample.csv'] = open(s3_obj.presigned_url(:get, expires_in: 60)).read\n    mail(to: \"galet@gmail.com\", subject: 'Welcome to My Awesome Site')\n  end  \nend\n</code></pre>\n\n<p>I am getting error as follows when I execute <code>UserMailer.welcome_email(s3_obj).deliver_now</code></p>\n\n<blockquote>\n  <p>WARN: Errno::ENOENT: No such file or directory @ rb_sysopen</p>\n</blockquote>\n\n<p>How to add S3 secured file as an email attachment in Rails? Also I want to send the original file name</p>\n"}, {"tags": ["mysql", "ruby", "ruby-on-rails-4", "mysql2", "libmysql"], "comments": [{"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 0, "creation_date": 1574234404, "post_id": 58948492, "comment_id": 104154333, "body": "did you try &quot;sudo apt-update &amp;&amp; sudo apt-get install libmysqlclient-dev&quot; ?"}, {"owner": {"reputation": 21, "user_id": 9252705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FIivb.jpg?s=128&g=1", "display_name": "Umair Liaqat", "link": "https://stackoverflow.com/users/9252705/umair-liaqat"}, "reply_to_user": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 0, "creation_date": 1574240323, "post_id": 58948492, "comment_id": 104157028, "body": "yes I did. I tried &quot;sudo apt-get update&quot; and &quot;sudo apt-get install libmysqlclient-dev &quot; but of no use."}, {"owner": {"reputation": 173, "user_id": 10442723, "user_type": "registered", "profile_image": "https://graph.facebook.com/1867306933351812/picture?type=large", "display_name": "Aman Relan", "link": "https://stackoverflow.com/users/10442723/aman-relan"}, "edited": false, "score": 0, "creation_date": 1574258570, "post_id": 58948492, "comment_id": 104167918, "body": "@UmairLiaquat , try using <code>sudo apt-get install mysql-server</code> followed by <code>sudo mysql_secure_installation</code> and then follow the instructions, later on access mysql using <code>mysql -u root -p followed by password</code>"}, {"owner": {"reputation": 21, "user_id": 9252705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FIivb.jpg?s=128&g=1", "display_name": "Umair Liaqat", "link": "https://stackoverflow.com/users/9252705/umair-liaqat"}, "reply_to_user": {"reputation": 173, "user_id": 10442723, "user_type": "registered", "profile_image": "https://graph.facebook.com/1867306933351812/picture?type=large", "display_name": "Aman Relan", "link": "https://stackoverflow.com/users/10442723/aman-relan"}, "edited": false, "score": 0, "creation_date": 1574260727, "post_id": 58948492, "comment_id": 104169272, "body": "@AmanRelan Unable to locate package mysql-server"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1574402632, "post_id": 58948492, "comment_id": 104228409, "body": "Try <a href=\"https://stackoverflow.com/a/55917381/3784008\"><code>default-libmysqlclient-dev</code></a>, and if that does not work then <a href=\"https://askubuntu.com/q/124017/308872\">reset your apt sources</a> and try again with both package names."}, {"owner": {"reputation": 173, "user_id": 10442723, "user_type": "registered", "profile_image": "https://graph.facebook.com/1867306933351812/picture?type=large", "display_name": "Aman Relan", "link": "https://stackoverflow.com/users/10442723/aman-relan"}, "edited": false, "score": 0, "creation_date": 1574770308, "post_id": 58948492, "comment_id": 104341460, "body": "@UmairLiaquat do this first then <code>sudo apt-get update &amp;&amp; sudo apt-get dist-upgrade</code> and then do <code>sudo apt-get install mysql-server</code> followed by <code>sudo mysql_secure_installation</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1671, "user_id": 3427659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/3KKqj.jpg?s=128&g=1", "display_name": "Kamal Panhwar", "link": "https://stackoverflow.com/users/3427659/kamal-panhwar"}, "is_accepted": false, "score": 1, "last_activity_date": 1578574519, "last_edit_date": 1578574519, "creation_date": 1578393220, "answer_id": 59626677, "question_id": 58948492, "link": "https://stackoverflow.com/questions/58948492/unable-to-locate-package-libmysqlclient-dev/59626677#59626677", "title": "Unable to locate package libmysqlclient-dev", "body": "<p>To give you proper answer as I found that all comments are to the point, but I wanted to check if really such issue exists. So I spin up new ubuntu server 16.04 and used following commands to installd mysql gem. I used rvm to install ruby</p>\n\n<pre><code>sudo apt-get update\nsudo apt-get install mysql-server\nsudo apt-get install software-properties-common\nsudo apt-add-repository -y ppa:rael-gc/rvm\nsudo apt-get update\nsudo apt-get install rvm\n</code></pre>\n\n<p>Now relogin to terminal to rvm command can start with its environment</p>\n\n<pre><code>rvm install ruby 2.6.3\n</code></pre>\n\n<p>Now I used <code>ruby -version</code> to check I am using same version as you were so got response <code>ruby 2.6.3p62 (2019-04-16 revision 67580) [x86_64-linux]</code> Now I used following command to install gem. If it succeed then rails will be also installed.</p>\n\n<pre><code>gem install mysql2 -v '0.5.2' --source 'https://rubygems.org/'\n</code></pre>\n\n<p>But I am getting same error as yours, now let us solve it as it is saying us how to solve error. This error is already giving me information what should I do. It told me to install following package</p>\n\n<pre><code>apt-get install libmysqlclient-dev\n</code></pre>\n\n<p>And now I tried again and it worked. Hope it will resolve your issue.  If you still have issue, than you can try by removing mysql packages you install and reinstall using these commands.</p>\n"}], "owner": {"reputation": 21, "user_id": 9252705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FIivb.jpg?s=128&g=1", "display_name": "Umair Liaqat", "link": "https://stackoverflow.com/users/9252705/umair-liaqat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3150, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1578574519, "creation_date": 1574233283, "question_id": 58948492, "link": "https://stackoverflow.com/questions/58948492/unable-to-locate-package-libmysqlclient-dev", "title": "Unable to locate package libmysqlclient-dev", "body": "<p>ruby 2.6.3\nUbuntu 16.04\nUnable to locate package libmysqlclient-dev</p>\n\n<p>description:\nFetching mysql2 0.5.2\nInstalling mysql2 0.5.2 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.</p>\n\n<p>To solve this I ran following.</p>\n\n<p>gem install mysql2 -v '0.5.2' --source '<a href=\"https://rubygems.org/\" rel=\"nofollow noreferrer\">https://rubygems.org/</a>'</p>\n\n<p>Then got the following error.\nmysql client is missing. You may need to 'apt-get install libmysqlclient-dev'</p>\n\n<p>now I am stuck and found no solution working. tried google and all other option but no suggestion is working for me.\nUnable to locate package libmysqlclient-dev</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "capistrano"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 4, "creation_date": 1574231629, "post_id": 58947682, "comment_id": 104153245, "body": "<code>condition &amp;&amp; info(&quot;exiting&quot;) &amp;&amp; exit</code>."}, {"owner": {"reputation": 541, "user_id": 12244608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rP6EG.jpg?s=128&g=1", "display_name": "TedTran2019", "link": "https://stackoverflow.com/users/12244608/tedtran2019"}, "edited": false, "score": 0, "creation_date": 1574232692, "post_id": 58947682, "comment_id": 104153613, "body": "Or you could put info &quot;some message&quot; and exit into a function, then do function if condition."}, {"owner": {"reputation": 90, "user_id": 12359143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HKvnk.jpg?s=128&g=1", "display_name": "mike watawski", "link": "https://stackoverflow.com/users/12359143/mike-watawski"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574240332, "post_id": 58947682, "comment_id": 104157033, "body": "This is what i need sir @AlekseiMatiushkin, Thank you"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 541, "user_id": 12244608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rP6EG.jpg?s=128&g=1", "display_name": "TedTran2019", "link": "https://stackoverflow.com/users/12244608/tedtran2019"}, "edited": false, "score": 2, "creation_date": 1574241658, "post_id": 58947682, "comment_id": 104157820, "body": "@TedTran2019 or simply <code>(info(&quot;exiting&quot;) &amp;&amp; exit) if condition</code>. The dedicated function looks a bit of overhead here."}], "answers": [{"tags": [], "owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "is_accepted": false, "score": 0, "last_activity_date": 1574652058, "creation_date": 1574652058, "answer_id": 59024832, "question_id": 58947682, "link": "https://stackoverflow.com/questions/58947682/one-liner-for-exit-with-message-in-capistrano/59024832#59024832", "title": "one-liner for exit with message in capistrano", "body": "<p>To exit from Capistrano in a 1 line and including the message you can do something like this </p>\n\n<p><code>(info(\"Your message here ... \") &amp;&amp; exit) if condition</code>  </p>\n\n<p>I hope that this will help </p>\n"}], "owner": {"reputation": 90, "user_id": 12359143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HKvnk.jpg?s=128&g=1", "display_name": "mike watawski", "link": "https://stackoverflow.com/users/12359143/mike-watawski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574652058, "creation_date": 1574229609, "question_id": 58947682, "link": "https://stackoverflow.com/questions/58947682/one-liner-for-exit-with-message-in-capistrano", "title": "one-liner for exit with message in capistrano", "body": "<p>It is possible to have a one liner condition for exit with message?</p>\n\n<pre><code>if condition\n  info \"some message\"\n  exit\nend\n</code></pre>\n"}, {"tags": ["java", "ruby", "jdbc", "driver", "jruby"], "comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 1, "creation_date": 1574234281, "post_id": 58946749, "comment_id": 104154284, "body": "Of course, the answer of DavidFlorenz correctly shows how to fix your problem, but to answer your question, why you get this error message: Constants in Ruby are identifiers which start  with an upper case letter. At the time you want to run <code>DriverManager.registerDriver</code>, Ruby sees the constant <code>DriverManager</code>, and obviously has not seen a definition for this constant yet."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 3956692, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/720397335/picture?type=large", "display_name": "Joshua Hedges", "link": "https://stackoverflow.com/users/3956692/joshua-hedges"}, "edited": false, "score": 0, "creation_date": 1574254447, "post_id": 58947293, "comment_id": 104165368, "body": "Thanks! It&#39;s so weird that it worked fine for like two days without this line of code and then stopped working."}], "tags": [], "owner": {"reputation": 1344, "user_id": 5527433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e16269120119b4936ba017928b4a643b?s=128&d=identicon&r=PG&f=1", "display_name": "David Florez", "link": "https://stackoverflow.com/users/5527433/david-florez"}, "is_accepted": true, "score": 1, "last_activity_date": 1574227606, "creation_date": 1574227606, "answer_id": 58947293, "question_id": 58946749, "link": "https://stackoverflow.com/questions/58946749/why-does-the-error-uninitialized-constant-drivermanager-occur-in-previously-fu/58947293#58947293", "title": "Why does the error &quot;Uninitialized constant DriverManager&quot; occur in previously functioning code?", "body": "<p>You probably need to import the DriverManager class </p>\n\n<pre><code>java_import 'java.sql.DriverManager'\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 3956692, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/720397335/picture?type=large", "display_name": "Joshua Hedges", "link": "https://stackoverflow.com/users/3956692/joshua-hedges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 58947293, "answer_count": 1, "score": 0, "last_activity_date": 1574227606, "creation_date": 1574224457, "last_edit_date": 1574225111, "question_id": 58946749, "link": "https://stackoverflow.com/questions/58946749/why-does-the-error-uninitialized-constant-drivermanager-occur-in-previously-fu", "title": "Why does the error &quot;Uninitialized constant DriverManager&quot; occur in previously functioning code?", "body": "<p>I'm working with jruby and I'm making calls to a DB2/BIGSQL database via the db2jcc4.jar file. I was making connections perfectly fine both inserts and selects, and then all of a sudden I started getting the error \"uninitialized constant DriverManager.\"</p>\n\n<p>The file db2jcc4.jar is readable and has the correct permissions. I even went back to a previously working, earlier version of the code and I get the same error. The only notable change is that the server was restarted. </p>\n\n<pre><code>require 'java'\n\njava_import 'com.ibm.db2.jcc.DB2Driver'\njava_import 'java.util.Properties'\n\nurl = \"jdbc:db2://SERVER-REMOVED:PORT_REMOVED/BIGSQL\"\noutput, rset, stmt, conn = nil\n\nbegin\n  properties = java.util.Properties.new\n  properties['user'] = 'USER REMOVED'\n  properties['password'] = 'PASSWORD REMOVED'\n\n  # Load driver class\n  driver = DB2Driver.new\n\n  DriverManager.registerDriver driver #this comes out to nil\n  regDrivers = DriverManager.getDrivers\n  conn = DriverManager.get_connection url, properties\n  ...\n</code></pre>\n\n<p>Any idea what happened?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 2394970, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1bf447cf1afc783b4b4e6ecd9ab292f7?s=128&d=identicon&r=PG", "display_name": "lost9123193", "link": "https://stackoverflow.com/users/2394970/lost9123193"}, "edited": false, "score": 0, "creation_date": 1574212919, "post_id": 58945204, "comment_id": 104148824, "body": "Thanks I updated my question. I have an initialize method. Is there a way I can bypass the initialize method and call the method? I get the error that I need to initialize it"}, {"owner": {"reputation": 893, "user_id": 3394889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c58b23ce03f0e71522820d13404d5a?s=128&d=identicon&r=PG&f=1", "display_name": "The Wizard", "link": "https://stackoverflow.com/users/3394889/the-wizard"}, "reply_to_user": {"reputation": 7358, "user_id": 2394970, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1bf447cf1afc783b4b4e6ecd9ab292f7?s=128&d=identicon&r=PG", "display_name": "lost9123193", "link": "https://stackoverflow.com/users/2394970/lost9123193"}, "edited": false, "score": 0, "creation_date": 1574213244, "post_id": 58945204, "comment_id": 104148895, "body": "You can pass in some values to initialize it (I have updated my answer to include some dummy values). To call it without initialising it, you will need to change this method to a class method (using the self. definition)"}, {"owner": {"reputation": 893, "user_id": 3394889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c58b23ce03f0e71522820d13404d5a?s=128&d=identicon&r=PG&f=1", "display_name": "The Wizard", "link": "https://stackoverflow.com/users/3394889/the-wizard"}, "reply_to_user": {"reputation": 7358, "user_id": 2394970, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1bf447cf1afc783b4b4e6ecd9ab292f7?s=128&d=identicon&r=PG", "display_name": "lost9123193", "link": "https://stackoverflow.com/users/2394970/lost9123193"}, "edited": false, "score": 0, "creation_date": 1574213363, "post_id": 58945204, "comment_id": 104148924, "body": "This is discussed here too: <a href=\"https://stackoverflow.com/questions/13067831/calling-ruby-method-without-instantiating-class\" title=\"calling ruby method without instantiating class\">stackoverflow.com/questions/13067831/&hellip;</a>"}], "tags": [], "owner": {"reputation": 893, "user_id": 3394889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c58b23ce03f0e71522820d13404d5a?s=128&d=identicon&r=PG&f=1", "display_name": "The Wizard", "link": "https://stackoverflow.com/users/3394889/the-wizard"}, "is_accepted": true, "score": 1, "last_activity_date": 1574212979, "last_edit_date": 1574212979, "creation_date": 1574212409, "answer_id": 58945204, "question_id": 58945171, "link": "https://stackoverflow.com/questions/58945171/rspec-nomethoderror-from-nested-module/58945204#58945204", "title": "Rspec &quot;NoMethodError&quot; from nested module", "body": "<p>The definition of <code>pick_animals</code> is an <strong>instance method</strong>.</p>\n\n<p>To call it, you will need to instantiate an object of the class using the <code>new</code> method as shown below. I have passed in random values to your initializer (1, [1,2]) however you can set them as you like.: </p>\n\n<pre><code>number_of_animals = 1\nids = [1,2]\nAnimalSanctuary::AnimalInspector::AnimalPicker.new(number_of_animals, ids).pick_animals(\"Dog\")\n</code></pre>\n\n<p>Otherwise, to call it the way you are calling it, you will need to redefine it as a <strong>class method</strong> by using <code>self.pick_animals</code> as shown below:</p>\n\n<pre><code>module AnimalSanctuary\n  module AnimalInspector\n    class AnimalPicker\n\n     ...\n     def self.pick_animals(animal)\n     end \n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4047, "user_id": 3775217, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/G0bqn.jpg?s=128&g=1", "display_name": "user3775217", "link": "https://stackoverflow.com/users/3775217/user3775217"}, "is_accepted": false, "score": 0, "last_activity_date": 1574227276, "creation_date": 1574227276, "answer_id": 58947217, "question_id": 58945171, "link": "https://stackoverflow.com/questions/58945171/rspec-nomethoderror-from-nested-module/58947217#58947217", "title": "Rspec &quot;NoMethodError&quot; from nested module", "body": "<p>yeah <code>pick_animals</code> is an instance method.</p>\n\n<p>you can use the following in your rspec</p>\n\n<pre><code>expect_any_instance_of(nimalSanctuary::AnimalInspector::AnimalPicker).to receive(:pick_animals).with(\"dogs\").to_eq(\"Dog\")\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 7358, "user_id": 2394970, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1bf447cf1afc783b4b4e6ecd9ab292f7?s=128&d=identicon&r=PG", "display_name": "lost9123193", "link": "https://stackoverflow.com/users/2394970/lost9123193"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 58945204, "answer_count": 2, "score": 0, "last_activity_date": 1574227276, "creation_date": 1574212109, "last_edit_date": 1574212843, "question_id": 58945171, "link": "https://stackoverflow.com/questions/58945171/rspec-nomethoderror-from-nested-module", "title": "Rspec &quot;NoMethodError&quot; from nested module", "body": "<p>I'm running into a weird error:</p>\n\n<p>Class:</p>\n\n<pre><code>module AnimalSanctuary\n  module AnimalInspector\n    class AnimalPicker\n\n   def initialize(number_of_animals, ids)\n     @number_of_animals = number_of_animals\n     @ids = ids\n    end\n\n     ...\n     def pick_animals(animal)\n     end \n  end\nend\n</code></pre>\n\n<p>test: </p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe AnimalSanctuary::AnimalInspector::AnimalPicker do\n  describe \".pick_animals\" do\n    context \"pick an available animal\" do\n      it \"returns animal name\" do\n        expect(AnimalSanctuary::AnimalInspector::AnimalPicker.pick_animals(\"Dog\")).to eq(\"Dog\")\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I get the following error: </p>\n\n<pre><code>NoMethodError:\n       undefined method `pick_animals' for AnimalSanctuary::AnimalInspector::AnimalPicker:Class\n</code></pre>\n\n<p>Rspec calls the class but not the method which has stumped me. Am I doing something wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "carrierwave"], "answers": [{"tags": [], "owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "is_accepted": true, "score": 0, "last_activity_date": 1574209164, "creation_date": 1574209164, "answer_id": 58944817, "question_id": 58944780, "link": "https://stackoverflow.com/questions/58944780/ruby-on-rails-carrierwave-associate-model-id-with-a-different-model-foreign/58944817#58944817", "title": "Ruby on Rails: CarrierWave - Associate model.id with a different model (foreign key)", "body": "<p>I'm able to access the property on the model like so:</p>\n\n<p><code>#{model.property.id}</code></p>\n\n<p>Model referring to Brochure. Brochure has access to the <code>property</code> since it <code>belongs_to</code></p>\n"}], "owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 58944817, "answer_count": 1, "score": 0, "last_activity_date": 1574209164, "creation_date": 1574208866, "question_id": 58944780, "link": "https://stackoverflow.com/questions/58944780/ruby-on-rails-carrierwave-associate-model-id-with-a-different-model-foreign", "title": "Ruby on Rails: CarrierWave - Associate model.id with a different model (foreign key)", "body": "<p>I have a model for Brochures. Brochures belong to a property. Properties allow the uploading of brochures (pdf files).</p>\n\n<p>Brochure Model:</p>\n\n<pre><code>class Brochure &lt; ApplicationRecord\n  belongs_to :property\n\n  mount_uploader :document, BrochuresUploader\nend\n</code></pre>\n\n<p>Inside my <code>properties_controller</code> file and <code>update</code> method, after the property update, it's calling:</p>\n\n<pre><code>def update\n    find_property\n    authorize! :update, @property\n\n\n...\n    if @property.update(property_params)\n      brochure_service = BrochureService.new(@property)\n      brochure_service.add_brochures(params[:property][:brochures], [])\n      brochure_service.remove_marked_brochures\n\n      flash[:notice] = \"Listing edited successfully\"\n      redirect_to action: :show\n    ...\n</code></pre>\n\n<p>So it's calling a Brochure service method:</p>\n\n<pre><code>  def add_brochures(new_brochures, removed_brochures)\n\n    new_brochures&amp;.pop\n\n    removed_brochures = removed_brochures&amp;.split(',')\n\n    new_brochures&amp;.each do |brochure|\n      next if removed_brochures.include?(brochure.original_filename)\n      @property.brochures.create(document: brochure)\n    end\n  end\n</code></pre>\n\n<p>The <code>BrochureUploader</code> that inherits <code>CarrerWave::Uploader::base</code> has this method:</p>\n\n<pre><code>  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n</code></pre>\n\n<p>The problem here is the <code>model.id</code></p>\n\n<p>When brochures are uploaded, they get put inside a incrementing folder name like <code>1</code> <code>2</code> <code>3</code>.</p>\n\n<p>They're supposed to be put in a folder based on the property ID, like <code>57</code>.</p>\n\n<p>I'm not sure how to pass that property id into this uploader.</p>\n\n<p>If you need any more information, let me know </p>\n"}, {"tags": ["ruby", "rvm"], "answers": [{"tags": [], "owner": {"reputation": 826, "user_id": 4055731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qrW44.jpg?s=128&g=1", "display_name": "Evelin Ponce", "link": "https://stackoverflow.com/users/4055731/evelin-ponce"}, "is_accepted": true, "score": 1, "last_activity_date": 1574207355, "creation_date": 1574207355, "answer_id": 58944596, "question_id": 58944595, "link": "https://stackoverflow.com/questions/58944595/can%c2%b4t-install-a-new-version-of-ruby-using-rvm-in-mojave/58944596#58944596", "title": "Can&#180;t install a new version of ruby using rvm in Mojave", "body": "<p>I remembered that in the last weeks I upgraded mysql from 5.6 to 5.7 so in the bash file I had some mysql5.6 configurations blocking the ruby installation. Only what I need to do was delete from bash profile the lines related with mysql5.6</p>\n\n<p>Open bash file</p>\n\n<pre><code>nano .bash_profile\n</code></pre>\n\n<p>Delete </p>\n\n<blockquote>\n  <p>LDFLAGS=\"-L/usr/local/opt/mysql@5.6/lib\"</p>\n</blockquote>\n\n<p>Reload bash or open other terminal</p>\n\n<pre><code>source ~/.bash_profile\n</code></pre>\n"}], "owner": {"reputation": 826, "user_id": 4055731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qrW44.jpg?s=128&g=1", "display_name": "Evelin Ponce", "link": "https://stackoverflow.com/users/4055731/evelin-ponce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 58944596, "answer_count": 1, "score": 2, "last_activity_date": 1574207355, "creation_date": 1574207355, "question_id": 58944595, "link": "https://stackoverflow.com/questions/58944595/can%c2%b4t-install-a-new-version-of-ruby-using-rvm-in-mojave", "title": "Can&#180;t install a new version of ruby using rvm in Mojave", "body": "<p>I tried to install a new version of ruby using RVM,\n<code>rvm install 2.5.0</code>\nbut during configure process the installation fails</p>\n\n<pre><code>Error running \u2018./configure --prefix=/Users/evelinponce/.rvm/rubies/ruby-2.5.0 --with-openssl-dir=/usr/local/opt/openssl/bin/openssl --with-opt-dir=/usr/local/opt/libyaml:/usr/local/opt/libksba:/usr/local/opt/readline:/usr/local/opt/zlib:/usr/local/opt/openssl@1.1 --disable-install-doc --enable-shared\u2019,\nplease read /Users/evelinponce/.rvm/log/1574200398_ruby-2.5.0/configure.log\nThere has been an error while running configure. Halting the installation.\n</code></pre>\n\n<p>configure.log</p>\n\n<pre><code>...\nchecking whether CFLAGS is valid... yes\nchecking whether LDFLAGS is valid... no\nconfigure: error: something wrong with LDFLAGS=\"-L/usr/local/opt/mysql@5.6/lib\"\n</code></pre>\n\n<p>RVM version: rvm 1.29.9</p>\n"}, {"tags": ["arrays", "ruby", "algorithm"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1574206237, "post_id": 58944325, "comment_id": 104147240, "body": "How about <code>[20, 20, 21, 21, 21, 21].map { |n| [n] }</code>? I doubt that this is what you want, but it is a way of suggesting that your criteria are incomplete."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1574244046, "post_id": 58944325, "comment_id": 104159235, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. Did you research this? Where? If it didn&#39;t help tell us why. What did you try? If you didn&#39;t try, why not? If you did, what did you do? We&#39;d like to see your minimal attempt to solve it."}, {"owner": {"reputation": 14204, "user_id": 4723795, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/980705688614873/picture?type=large", "display_name": "xenteros", "link": "https://stackoverflow.com/users/4723795/xenteros"}, "edited": false, "score": 0, "creation_date": 1574254938, "post_id": 58944325, "comment_id": 104165665, "body": "Could you show us what have you done so far?"}], "answers": [{"comments": [{"owner": {"reputation": 614, "user_id": 4389250, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-F8rJHdQAUgY/AAAAAAAAAAI/AAAAAAAAAJQ/114BANdH3Hs/photo.jpg?sz=128", "display_name": "Sebastian Delgado", "link": "https://stackoverflow.com/users/4389250/sebastian-delgado"}, "edited": false, "score": 0, "creation_date": 1574207590, "post_id": 58944525, "comment_id": 104147586, "body": "thanks you, worked wonders!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1574208193, "last_edit_date": 1574208193, "creation_date": 1574206898, "answer_id": 58944525, "question_id": 58944325, "link": "https://stackoverflow.com/questions/58944325/ruby-split-array-in-sub-arrays-that-contain-only-different-values/58944525#58944525", "title": "Ruby Split array in sub arrays that contain only different values", "body": "<p>I assume you want to have the minimum number of subarrays.</p>\n\n<pre><code>arr = [20, 20, 21, 21, 21, 21, 22, 23, 22]\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>h = arr.each_with_object(Hash.new(0)) { |n,h| h[n] += 1 }\n  #=&gt; {20=&gt;2, 21=&gt;4, 22=&gt;2, 23=&gt;1} \na = Array.new(h.values.max) { Array.new { [] } }\n  #=&gt; [[], [], [], []] \nh.each { |n,freq| freq.times { |i| a[i] &lt;&lt; n } }\na #=&gt; [[20, 21, 22, 23], [20, 21, 22], [21], [21]]\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>h.values.max\n  #=&gt; 4\n</code></pre>\n\n<p>tells us we need at least 4 subarrays (for <code>21</code>). <code>4</code> is clearly sufficient as we simply allocate each group of equal elements to different subarrays.</p>\n\n<p>See the form of <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a> that takes a default value and <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-c-new\" rel=\"nofollow noreferrer\">Array::new</a>.</p>\n\n<p>If <code>h = Hash.new(0)</code>, then if <code>h</code> does not have a key <code>k</code>, <code>h[k]</code> returns the default value, here zero. When <code>h[k] += 1</code> is executed Ruby's first step is to convert that expression to:</p>\n\n<pre><code>h[k] = h[k] + 1\n</code></pre>\n\n<p>If <code>h</code> does not have a key <code>k</code> the expression <code>h[k]</code> on the right of the equality returns zero.</p>\n\n<p>A variant (after computing <code>h</code>) is the following:</p>\n\n<pre><code>h.each_with_object([]) do |(n,freq),a|\n  freq.times { |i| i &gt;= a.size ? a &lt;&lt; [n] : a[i] &lt;&lt; n }\nend\n  #=&gt; [[20, 21, 22, 23], [20, 21, 22], [21], [21]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1107, "user_id": 768510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbb042e9d1b60b4835b0480624864364?s=128&d=identicon&r=PG", "display_name": "Thomas Nadin", "link": "https://stackoverflow.com/users/768510/thomas-nadin"}, "is_accepted": false, "score": 1, "last_activity_date": 1574210308, "last_edit_date": 1574210308, "creation_date": 1574209344, "answer_id": 58944843, "question_id": 58944325, "link": "https://stackoverflow.com/questions/58944325/ruby-split-array-in-sub-arrays-that-contain-only-different-values/58944843#58944843", "title": "Ruby Split array in sub arrays that contain only different values", "body": "<p><strong>Update</strong>: I've just re-read your example and it doesn't appear your wanting what I've suggested below.</p>\n\n<p>Sounds like you're wanting a <code>Enumerable#chunk_while</code> that also gives you the current chunk. Assuming you're using a <a href=\"https://www.igvita.com/2009/02/04/ruby-19-internals-ordered-hash/\" rel=\"nofollow noreferrer\">modern version of Ruby (>= 1.9)</a> I believe you can rely on the keys below being ordered:</p>\n\n<pre><code>def chunk_while_uniq(enum)\n  return [] if enum.empty?\n\n  groups = enum.each_with_object([{}]) do |e, acc|\n    if acc.last.has_key? e\n      acc.push({ e =&gt; true })\n    else\n      acc.last[e] = true\n    end\n  end\n\n  groups.map(&amp;:keys)\nend\n\np chunk_while_uniq([20, 21, 21, 20, 20, 21, 21, 21])\np chunk_while_uniq([:test, :test, :new, :diff, :test, :test])\n</code></pre>\n\n<p>The above will work with anything that can be compared, not just numbers.</p>\n\n<p><a href=\"https://repl.it/repls/FittingAlphanumericSubversion\" rel=\"nofollow noreferrer\">https://repl.it/repls/FittingAlphanumericSubversion</a></p>\n"}], "owner": {"reputation": 614, "user_id": 4389250, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-F8rJHdQAUgY/AAAAAAAAAAI/AAAAAAAAAJQ/114BANdH3Hs/photo.jpg?sz=128", "display_name": "Sebastian Delgado", "link": "https://stackoverflow.com/users/4389250/sebastian-delgado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1574260955, "accepted_answer_id": 58944525, "answer_count": 2, "score": -2, "last_activity_date": 1574254911, "creation_date": 1574205396, "last_edit_date": 1574254911, "question_id": 58944325, "link": "https://stackoverflow.com/questions/58944325/ruby-split-array-in-sub-arrays-that-contain-only-different-values", "closed_reason": "Needs more focus", "title": "Ruby Split array in sub arrays that contain only different values", "body": "<p>I have an array of the following form:</p>\n\n<pre><code>[20, 20, 21, 21, 21, 21]\n</code></pre>\n\n<p>I'm trying to find a way to split the array in sub arrays that contain only different values.\nFor example:</p>\n\n<pre><code>[[20,21], [20,21], [21], [21]]\n</code></pre>\n\n<p>This example only contains two different values but irl the main array could contain multiple different values.</p>\n\n<p>Another example would be [20, 20, 21, 21, 21, 21, 22] => [[20,21,22], [20,21], [21], [21]]</p>\n\n<p>It's important that if the main array has for example 6 elements, the resultant sub arrays in total would equal that quantity. </p>\n\n<p>I've been playing <strong>combination, permutation and group_by</strong> but haven't been able to accomplish this.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574244086, "post_id": 58944244, "comment_id": 104159261, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. Did you research this? Where? If it didn&#39;t help tell us why. What did you try? If you didn&#39;t try, why not? If you did, what did you do? We&#39;d like to see your minimal attempt to solve it."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1574206083, "post_id": 58944314, "comment_id": 104147201, "body": "Good one! ...or <code>{ |a,b| a+b }</code>."}, {"owner": {"reputation": 541, "user_id": 12244608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rP6EG.jpg?s=128&g=1", "display_name": "TedTran2019", "link": "https://stackoverflow.com/users/12244608/tedtran2019"}, "edited": false, "score": 1, "creation_date": 1574209426, "post_id": 58944314, "comment_id": 104148051, "body": "Damn, that&#39;s really clean. Nice job"}, {"owner": {"reputation": 275, "user_id": 8333125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0027d7ab229778444c062f2c23a690d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rajkumar P", "link": "https://stackoverflow.com/users/8333125/rajkumar-p"}, "edited": false, "score": 1, "creation_date": 1574245327, "post_id": 58944314, "comment_id": 104160042, "body": "<code>array.each_slice(2).map {|v| v.reduce(:+)}</code>"}, {"owner": {"reputation": 17, "user_id": 11777043, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-STyOBSv2fRs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfVi8f7jHgAOZjZNzaGg8eG691P_Q/photo.jpg?sz=128", "display_name": "lcchatter", "link": "https://stackoverflow.com/users/11777043/lcchatter"}, "edited": false, "score": 1, "creation_date": 1574260784, "post_id": 58944314, "comment_id": 104169319, "body": "Working Great, thanks Rajagopalan"}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": true, "score": 3, "last_activity_date": 1574207056, "last_edit_date": 1574207056, "creation_date": 1574205336, "answer_id": 58944314, "question_id": 58944244, "link": "https://stackoverflow.com/questions/58944244/how-to-join-two-nested-subarrays-inside-multidimensional-array-elements-in-rub/58944314#58944314", "title": "How to join two nested subarrays (inside multidimensional array) elements in Ruby?", "body": "<p>Use <code>each_slice</code></p>\n\n<pre><code> p array.each_slice(2).map {|v| v.flatten}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11777043, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-STyOBSv2fRs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfVi8f7jHgAOZjZNzaGg8eG691P_Q/photo.jpg?sz=128", "display_name": "lcchatter", "link": "https://stackoverflow.com/users/11777043/lcchatter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1574258576, "accepted_answer_id": 58944314, "answer_count": 1, "score": 0, "last_activity_date": 1574314423, "creation_date": 1574204872, "last_edit_date": 1574314423, "question_id": 58944244, "link": "https://stackoverflow.com/questions/58944244/how-to-join-two-nested-subarrays-inside-multidimensional-array-elements-in-rub", "closed_reason": "Needs more focus", "title": "How to join two nested subarrays (inside multidimensional array) elements in Ruby?", "body": "<p>In a big array of arrays, I need to join every two arrays, \nIf I have the following array</p>\n\n<pre><code>array = [[\"string1\",\"string2\"],[\"string3\",\"string4\"],[\"string5\",\"string6\"],[\"string7\",\"string8\"]...........]\n</code></pre>\n\n<p>I need the following output as result</p>\n\n<pre><code>#  [[\"string1\",\"string2\", \"string3\",\"string4\"],[\"string5\",\"string6\",\"string7\",\"string8\"]...........]\n</code></pre>\n"}, {"tags": ["ruby", "model", "ruby-on-rails-5", "rails-activerecord", "entity-relationship"], "answers": [{"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1574200722, "post_id": 58943377, "comment_id": 104145418, "body": "Thanks, but can you fill in the rest of the &quot;...&quot;s?  The statement should return &quot;displays&quot; but as you have it, it&#39;s returning &quot;locations&quot;."}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1574202197, "post_id": 58943377, "comment_id": 104146011, "body": "No they cannot.  There is no relationship from user to any of the other entities, it is purely just a where clause param.  Administrator has_many locations, which has_many displays."}], "tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": false, "score": 0, "last_activity_date": 1574200342, "creation_date": 1574200342, "answer_id": 58943377, "question_id": 58943353, "link": "https://stackoverflow.com/questions/58943353/how-do-i-rewrite-this-line-to-avoid-the-activerecordassociationscollectio/58943377#58943377", "title": "How do I rewrite this line to avoid the &quot;#&lt;ActiveRecord::Associations::CollectionProxy []&quot; error?", "body": "<p>You're calling <code>displays</code> on <code>locations</code> and not <code>location</code>.</p>\n\n<p>You might be looking for something like:</p>\n\n<p><code>current_user.locations.joins(:displays).where(displays: { user: user }) ...</code></p>\n"}, {"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1574261614, "post_id": 58944637, "comment_id": 104169831, "body": "Thanks for this breakdown.  ULtimately I went with your one-line solution, &quot;Display.where(location_id: current_user.locations.pluck(:id), user: user).includes(:administrator)&quot;.  Putting some of it on different lines made the formatting nice."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 1, "last_activity_date": 1574211559, "last_edit_date": 1574211559, "creation_date": 1574207624, "answer_id": 58944637, "question_id": 58943353, "link": "https://stackoverflow.com/questions/58943353/how-do-i-rewrite-this-line-to-avoid-the-activerecordassociationscollectio/58944637#58944637", "title": "How do I rewrite this line to avoid the &quot;#&lt;ActiveRecord::Associations::CollectionProxy []&quot; error?", "body": "<p>You could add a class method to your <code>Location</code> model to achieve the result you want.</p>\n\n<pre><code>class Location &lt; ApplicationRecord\n  has_many :displays, dependent: :destroy\n\n  def self.displays\n    Display.where(location_id: select(:id))\n  end\nend\n</code></pre>\n\n<p>Which should allow you to use:</p>\n\n<pre><code>@displays = current_user.locations.displays.where(user: user).includes(:administrator)\n</code></pre>\n\n<hr>\n\n<p>If you don't want to add a helper to your model, you could change up your record fetching technique.</p>\n\n<pre><code>location_ids = current_user.locations.pluck(:id)\n@displays = Display.where(location_id: location_ids, user: user).includes(:administrator)\n</code></pre>\n\n<p>For a single line you can simply merge the above lines together. However I would go for the multi-line solution, since this line will get pretty long.</p>\n\n<pre><code>@displays = Display.where(location_id: current_user.locations.pluck(:id), user: user).includes(:administrator)\n</code></pre>\n\n<hr>\n\n<p>In both these scenario there is no need to <code>flatten</code> or call <code>uniq</code> on the result.</p>\n\n<p>You might want to swap <code>select(:id)</code> out for <code>pluck(:id)</code> or vice versa. The difference being that <code>select</code> will create a subquery. While <code>pluck</code> first performs a query only fetching the location ids, then use them to create a new query. This does produce an additional query, but might be faster since the queries are less complex.</p>\n\n<p>You also might be able to use the following scope instead of a class method:</p>\n\n<pre><code>scope :displays, -&gt; { Display.where(location_id: select(:id)) }\n</code></pre>\n\n<p>The reason I've used a class method is for definition/consistency reasons. Let me quote the <a href=\"https://www.wordnik.com/words/scope\" rel=\"nofollow noreferrer\">definition of \"scope\"</a> from the GNU version of the Collaborative International Dictionary of English:</p>\n\n<blockquote>\n  <p><em>noun</em> That at which one aims; the thing or end to which the mind directs its view; that which is purposed to be reached or accomplished; hence, ultimate design, aim, or purpose; intention; drift; object.</p>\n</blockquote>\n\n<p>From the above we can conclude that scopes should add restrictions on the current scope to narrow the aim of the result. Scopes should therefore only return restricted versions of the current scope. Since <code>displays</code> returns a completely new scope, with a different resulting records (instances of <code>Display</code> instead of <code>Location</code>) I've opted for a class method instead. (Although usage is the same.)</p>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 58944637, "answer_count": 2, "score": 0, "last_activity_date": 1574211559, "creation_date": 1574200222, "question_id": 58943353, "link": "https://stackoverflow.com/questions/58943353/how-do-i-rewrite-this-line-to-avoid-the-activerecordassociationscollectio", "title": "How do I rewrite this line to avoid the &quot;#&lt;ActiveRecord::Associations::CollectionProxy []&quot; error?", "body": "<p>I have these models ...</p>\n\n<pre><code>class Administrator &lt; ApplicationRecord\n    ...\n    has_many :locations\n\n\nclass Location &lt; ApplicationRecord\n    ...\n    has_many :displays, :dependent =&gt; :destroy\n</code></pre>\n\n<p>I had this code that is meant to retrieve all displays subject to certain criteria ...</p>\n\n<pre><code>  @displays = []\n  current_user.locations.each do |location|\n    @displays = (@displays + location.displays.where(:user =&gt; user).includes(:administrator)).uniq\n  end\n</code></pre>\n\n<p>I wanted to find a slick Rails way to simplify the above into a one liner, so I tried this</p>\n\n<pre><code>  @displays = current_user.locations.displays.where(:user =&gt; user).includes(:administrator).flatten.uniq\n</code></pre>\n\n<p>but this results in an error</p>\n\n<pre><code>undefined method `displays' for #&lt;ActiveRecord::Associations::CollectionProxy []&gt;\n</code></pre>\n\n<p>Is there a way to rewrite my intiial block in a single line?</p>\n"}, {"tags": ["ruby", "hash", "ruby-hash"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1574200309, "post_id": 58943314, "comment_id": 104145214, "body": "What happens if they have a different value for the <code>value</code> key?"}, {"owner": {"reputation": 27, "user_id": 6709519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed2ad6900309f9311defb12706733b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Avinaba GHOSH HAJRA", "link": "https://stackoverflow.com/users/6709519/avinaba-ghosh-hajra"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1574201145, "post_id": 58943314, "comment_id": 104145598, "body": "Then this will also be merged to array like revenue. But in my application only one key&#39;s value (revenue) will be different. But my approach should be generic for all the other keys value and revenue."}, {"owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "edited": false, "score": 0, "creation_date": 1574201425, "post_id": 58943314, "comment_id": 104145725, "body": "Does the final order matter in the collect arrays?"}, {"owner": {"reputation": 27, "user_id": 6709519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed2ad6900309f9311defb12706733b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Avinaba GHOSH HAJRA", "link": "https://stackoverflow.com/users/6709519/avinaba-ghosh-hajra"}, "edited": false, "score": 0, "creation_date": 1574201815, "post_id": 58943314, "comment_id": 104145853, "body": "No..ordering does not matter"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1574216452, "post_id": 58943314, "comment_id": 104149542, "body": "Avinaba, I don&#39;t follow your first comment. Can the array also contain the hash <code>{ :key =&gt; &#39;Foo&#39;, :value =&gt; 2, :revenue =&gt; 6 }</code>? If yes, what would be your desired result? If no, your example would have been clearer if you had excluded the key <code>:value</code>."}, {"owner": {"reputation": 27, "user_id": 6709519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed2ad6900309f9311defb12706733b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Avinaba GHOSH HAJRA", "link": "https://stackoverflow.com/users/6709519/avinaba-ghosh-hajra"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1574238767, "post_id": 58943314, "comment_id": 104156200, "body": "@Cary It can. Then the result would be   <code>{ :key =&gt; &#39;Foo&#39;, :value =&gt; [1,2], :revenue =&gt; [2,4,6] }</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1574239830, "post_id": 58943314, "comment_id": 104156723, "body": "In that case you should have explained that in your question and modified your example to cover that case. It\u2019s a little late to do that now, however. Note you are creating extra work for yourself later by having <code>:value=&gt;1</code> in one case and <code>:value =&gt;[2,3]</code> in another. It would be better for the value of <code>:value</code> to always be an array, even when it contains a single element (<code>:value=&gt;[1]</code>)."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574244136, "post_id": 58943314, "comment_id": 104159293, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. Did you research this? Where? If it didn&#39;t help tell us why. What did you try? If you didn&#39;t try, why not? If you did, what did you do? We&#39;d like to see your minimal attempt to solve it."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1574260779, "post_id": 58943314, "comment_id": 104169316, "body": "Is the <code>:key =&gt; &#39;Bar&#39;</code> and <code>:key =&gt; &#39;bar&#39;</code> part a typo? Or do you want to compare the keys case-insensitive?"}], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1574212600, "post_id": 58943727, "comment_id": 104148743, "body": "Alternatively use <code>.group_by { |foo| foo.slice(:key, :value) }</code> then change <code>map</code> to <code>.map { |foo, foos| foo.merge revenue: foos.map { |foo| foo[:revenue] } }</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1574232268, "post_id": 58943727, "comment_id": 104153466, "body": "That can be a different answer @3limin4t0r. Just updated to use <code>values_at</code> with the <code>slice</code> hint."}, {"owner": {"reputation": 27, "user_id": 6709519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed2ad6900309f9311defb12706733b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Avinaba GHOSH HAJRA", "link": "https://stackoverflow.com/users/6709519/avinaba-ghosh-hajra"}, "edited": false, "score": 0, "creation_date": 1574238670, "post_id": 58943727, "comment_id": 104156160, "body": "But if the number of keys in hash is not limited to 3. If It is 10 or 15 or many more. But it should merge based on the value contain through :key. Then what should be the approach. @Sebastian Palma"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 0, "last_activity_date": 1574232233, "last_edit_date": 1574232233, "creation_date": 1574202039, "answer_id": 58943727, "question_id": 58943314, "link": "https://stackoverflow.com/questions/58943314/ruby-group-hashes-based-on-matching-keys-and-store-the-value-of-non-matching-key/58943727#58943727", "title": "Ruby group hashes based on matching keys and store the value of non matching keys in an array", "body": "<p>You can try grouping by <code>key</code> and <code>value</code> and then map the <code>revenue</code> values:</p>\n\n<pre><code>foos\n  .group_by { |e| e.values_at(:key, :value) }\n  .map do |(key, value), values|\n    { key: key, value: value, revenue: values.map { |e| e[:revenue] } }\n  end\n# [{:key=&gt;\"Foo\", :value=&gt;1, :revenue=&gt;[2, 4]}, {:key=&gt;\"Bar\", :value=&gt;2, :revenue=&gt;[7]}, {:key=&gt;\"bar\", :value=&gt;2, :revenue=&gt;[9]}, {:key=&gt;\"Zampa\", :value=&gt;4, :revenue=&gt;[9]}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 0, "last_activity_date": 1574244436, "creation_date": 1574244436, "answer_id": 58951661, "question_id": 58943314, "link": "https://stackoverflow.com/questions/58943314/ruby-group-hashes-based-on-matching-keys-and-store-the-value-of-non-matching-key/58951661#58951661", "title": "Ruby group hashes based on matching keys and store the value of non matching keys in an array", "body": "<p>use reduce</p>\n\n<pre><code>result=foos.group_by { |x| x[:key] }.values.map do |arr|\n  arr.reduce do |h1, h2|\n    h1.merge(h2) do |k, v1, v2|\n      k.eql?(:revenue) ? [v1, v2] : v1\n    end\n  end\nend\n</code></pre>\n\n<p>p result</p>\n\n<pre><code>[{:key=&gt;\"Foo\", :value=&gt;1, :revenue=&gt;[2, 4]}, {:key=&gt;\"bar\", :value=&gt;2, :revenue=&gt;[7, 9]}, {:key=&gt;\"Zampa\", :value=&gt;4, :revenue=&gt;9}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1574326849, "post_id": 58956204, "comment_id": 104195604, "body": "Your answer is more clear and detailed, so I hope OP clarifies what really is expecting and can accept your answer."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1574260033, "last_edit_date": 1574260033, "creation_date": 1574258659, "answer_id": 58956204, "question_id": 58943314, "link": "https://stackoverflow.com/questions/58943314/ruby-group-hashes-based-on-matching-keys-and-store-the-value-of-non-matching-key/58956204#58956204", "title": "Ruby group hashes based on matching keys and store the value of non matching keys in an array", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.6.5/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\"><code>group_by</code></a> to group the <code>foos</code> array by <code>:key</code>. However I would first <a href=\"https://ruby-doc.org/core-2.6.5/String.html#method-i-downcase\" rel=\"nofollow noreferrer\"><code>downcase</code></a> the <code>:key</code> value, since you want <code>'Bar'</code> and <code>'bar'</code> to end up in the same group.</p>\n\n<pre><code># We first need to unify the keys of the hashes before we can start\n# grouping. 'Bar' != 'bar' so they would be split up in two separate\n# groups. Judging from the output you don't want this.\nfoos.each { |foo| foo[:key].downcase! }\n\n# Now that all keys are downcased we can group based upon the value of\n# the :key key.\ngrouped_foos = foos.group_by { |foo| foo[:key] }\n\n# Now we need to map over the resulting hash and create a single result\n# for each group.\ngrouped_foos.transform_values! do |foos|\n  # First I'll transform the structure of `foos`, from:\n  #\n  #     [{a: 1, b: 2}, {a: 3, b: 4}]\n  #\n  # into:\n  #\n  #     [[:a, 1], [:b, 2], [:a, 3], [:b, 4]]\n  #\n  tmp = foos.flat_map(&amp;:to_a)\n\n  # Then I'll group the above structure based upon the first value in\n  # each array, simultaneously removing the first element. Resulting in:\n  #\n  #     {a: [[1], [3]], b: [[2], [4]]}\n  #\n  tmp = tmp.group_by(&amp;:shift)\n\n  # We now need to flatten the values by one level. Resulting in:\n  #\n  #     {a: [1, 3], b: [2, 4]}\n  #\n  tmp.transform_values! { |values| values.flatten(1) }\n\n  # The next step is remove duplicate values. We currently have:\n  #\n  #     {key: ['foo', 'foo'], value: [1, 1], revenue: [2, 4]}\n  #\n  # whereas we want:\n  #\n  #     {key: ['foo'], value: [1], revenue: [2, 4]}\n  #\n  tmp.transform_values!(&amp;:uniq)\n\n  # Lastly if the array only contains a single value we want to use the\n  # value instead of an array. Transforming the above structure into:\n  #\n  #     {key: 'foo', value: 1, revenue: [2, 4]}\n  #\n  tmp.transform_values! { |head, *tail| tail.empty? ? head : [head, *tail] }\n\n  # Finally we need to return our new hash.\n  tmp \nend\n</code></pre>\n\n<p>Combining the above steps we get the following result:</p>\n\n<pre><code>foos.each { |foo| foo[:key].downcase! }\ngrouped_foos = foos.group_by { |foo| foo[:key] }\n\ngrouped_foos.transform_values! do |foos|\n  foos.flat_map(&amp;:to_a).group_by(&amp;:shift)\n      .transform_values { |values| values.flatten(1).uniq }\n      .transform_values { |head, *tail| tail.empty? ? head : [head, *tail] }\nend\n</code></pre>\n\n<p>If you don't want to modify the (capitalisation of the) original <code>foos</code> structure you'll have to replace:</p>\n\n<pre><code>foos.each { |foo| foo[:key].downcase! }\n# with\nunified_keys = foos.map(&amp;:dup).each { |foo| foo[:key] = foo[:key].downcase }\n</code></pre>\n\n<p>Then use the new <code>unified_keys</code> structure from that point on.</p>\n\n<p>The above solution produces the following result:</p>\n\n<pre><code>grouped_foos\n#=&gt; {\"foo\"  =&gt;{:key=&gt;\"foo\",   :value=&gt;1, :revenue=&gt;[2, 4]},\n#    \"bar\"  =&gt;{:key=&gt;\"bar\",   :value=&gt;2, :revenue=&gt;[7, 9]},\n#    \"zampa\"=&gt;{:key=&gt;\"zampa\", :value=&gt;4, :revenue=&gt;9}}\n</code></pre>\n\n<p>You can get the result you want by requesting the values of the <code>grouped_foos</code>:</p>\n\n<pre><code>grouped_foos.values\n#=&gt; [{:key=&gt;\"foo\",   :value=&gt;1, :revenue=&gt;[2, 4]},\n#    {:key=&gt;\"bar\",   :value=&gt;2, :revenue=&gt;[7, 9]},\n#    {:key=&gt;\"zampa\", :value=&gt;4, :revenue=&gt;9}]\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6709519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed2ad6900309f9311defb12706733b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Avinaba GHOSH HAJRA", "link": "https://stackoverflow.com/users/6709519/avinaba-ghosh-hajra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "closed_date": 1574266661, "accepted_answer_id": 58943727, "answer_count": 3, "score": 0, "last_activity_date": 1574260033, "creation_date": 1574200035, "question_id": 58943314, "link": "https://stackoverflow.com/questions/58943314/ruby-group-hashes-based-on-matching-keys-and-store-the-value-of-non-matching-key", "closed_reason": "Needs more focus", "title": "Ruby group hashes based on matching keys and store the value of non matching keys in an array", "body": "<p>Need to achieve the given output based on the following hash value</p>\n\n<pre><code>foos = [ { :key =&gt; 'Foo', :value =&gt; 1, :revenue =&gt; 2 },\n         { :key =&gt; 'Foo', :value =&gt; 1, :revenue =&gt; 4 },\n         { :key =&gt; 'Bar', :value =&gt; 2, :revenue =&gt; 7 },\n         { :key =&gt; 'bar', :value =&gt; 2, :revenue =&gt; 9 },\n         { :key =&gt; 'Zampa', :value =&gt; 4, :revenue =&gt; 9 }]\n</code></pre>\n\n<p>Output should be :</p>\n\n<pre><code>{ :key =&gt; 'Foo', :value =&gt; 1, :revenue =&gt; [2,4] } #Merging row 1 &amp; 2 as they share same :key 'Foo'\n{ :key =&gt; 'Bar', :value =&gt; 2, :revenue =&gt; [7,9] } #Merging row 3 &amp; 4 as they share same :key 'Bar'\n{ :key =&gt; 'Zampa', :value =&gt; 4, :revenue =&gt; 9 } \n</code></pre>\n\n<p>Merging should be based on the value of the <strong>:Key</strong> field \nHow to achieve this in ruby as I am new to ruby.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 0, "last_activity_date": 1574247902, "last_edit_date": 1574247902, "creation_date": 1574201666, "answer_id": 58943646, "question_id": 58942867, "link": "https://stackoverflow.com/questions/58942867/how-to-get-collection-users-with-collection-tasks-inside/58943646#58943646", "title": "How to get collection users with collection tasks inside?", "body": "<p>To select rows from the joined table just specify the name of the table and the column:</p>\n\n<pre><code>SELECT \n  users.id,\n  users.name,\n  tasks.id AS task_id, \n  tasks.name AS task_name\nFROM \n  users\nLEFT OUTER JOIN \n  tasks ON tasks.user_id = users.id\n</code></pre>\n\n<p>Since SQL is tabular the result is a list of rows and columns:</p>\n\n<pre><code> id |   name   | task_id | task_name \n----+----------+---------+-----------\n  2 | Xzbdulia |       1 | Cleaning\n  2 | Xzbdulia |       2 | Laundry\n  2 | Xzbdulia |       3 | Coding\n  3 | Elly     |       4 | Cleaning\n  3 | Elly     |       5 | Laundry\n  3 | Elly     |       6 | Coding\n  4 | Lewis    |       7 | Cleaning\n  4 | Lewis    |       8 | Laundry\n  4 | Lewis    |       9 | Coding\n  5 | Hang     |      10 | Cleaning\n  5 | Hang     |      11 | Laundry\n  5 | Hang     |      12 | Coding\n</code></pre>\n\n<p>If you really want to rough it and do this as a raw sql query and handle processing the results yourself you can do:</p>\n\n<pre><code>sql = &lt;&lt;~SQL\n  SELECT\n    users.id,\n    users.name,\n    tasks.id AS task_id,\n    tasks.name AS task_name\n  FROM\n    users\n  LEFT OUTER JOIN\n    tasks ON tasks.user_id = users.id;\nSQL\nresults = User.connection.execute(sql).each_with_object({}) do |row, memo|\n  id = row[\"id\"]\n  memo[id] ||= {\n    id: id,\n    name: row[\"name\"],\n    tasks: []\n  }\n  memo[id][:tasks].push({\n    id: row[\"task_id\"],\n    name: row[\"task_name\"]\n  }) unless row[\"task_id\"].nil?\nend.values\n\n</code></pre>\n\n<pre><code>[{:id=&gt;2, :name=&gt;\"Xzbdulia\", :tasks=&gt;[{:id=&gt;1, :name=&gt;\"Cleaning\"}, {:id=&gt;2, :name=&gt;\"Laundry\"}, {:id=&gt;3, :name=&gt;\"Coding\"}]}, {:id=&gt;3, :name=&gt;\"Elly\", :tasks=&gt;[{:id=&gt;4, :name=&gt;\"Cleaning\"}, {:id=&gt;5, :name=&gt;\"Laundry\"}, {:id=&gt;6, :name=&gt;\"Coding\"}]}, {:id=&gt;4, :name=&gt;\"Lewis\", :tasks=&gt;[{:id=&gt;7, :name=&gt;\"Cleaning\"}, {:id=&gt;8, :name=&gt;\"Laundry\"}, {:id=&gt;9, :name=&gt;\"Coding\"}]}, {:id=&gt;5, :name=&gt;\"Hang\", :tasks=&gt;[{:id=&gt;10, :name=&gt;\"Cleaning\"}, {:id=&gt;11, :name=&gt;\"Laundry\"}, {:id=&gt;12, :name=&gt;\"Coding\"}]}]\n</code></pre>\n\n<p>But whats the point when you can just use ActiveRecord and ActiveModel::Serializers::JSON and do this in two lines:</p>\n\n<pre><code>@users = User.includes(:tasks).select(:id, :name)\n             .as_json(only: [:id, :name], include: { tasks: { only: [:id, :name]} })\n</code></pre>\n\n<p>Yeah it does two queries ands selects a few more columns on tasks but I doubt there will be any really noticeable performance difference plus its a lot more maintainable. There are better things to spend your time on like tests.</p>\n"}], "owner": {"reputation": 36, "user_id": 8466400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gNtOd.jpg?s=128&g=1", "display_name": "Volodymyr Babiy", "link": "https://stackoverflow.com/users/8466400/volodymyr-babiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 58943646, "answer_count": 1, "score": 1, "last_activity_date": 1574247902, "creation_date": 1574197933, "last_edit_date": 1574247587, "question_id": 58942867, "link": "https://stackoverflow.com/questions/58942867/how-to-get-collection-users-with-collection-tasks-inside", "title": "How to get collection users with collection tasks inside?", "body": "<p>User has_many tasks\nTask belongs_to user\n(Task has key user_id)</p>\n\n<p>I`m trying make sql query</p>\n\n<pre><code>User.find_by_sql(\"\n  SELECT \n    users.id, \n    users.name, \n    tasks # &lt;-- how can I get collection tasks inside each users?\n  FROM users\n  JOIN tasks\n    ON tasks.user_id = users.id\n\")\n</code></pre>\n\n<p>I would like to get next response</p>\n\n<pre><code>[\n  {\n    id: 1,\n    name: Jon,\n    tasks: [ # &lt;- collection, please\n      { id: 1, user_id: 1, title: ... },\n      { id: 2, user_id: 1, title: ... }\n    ]\n  },\n  {\n    id: 2,\n    name: Sofia,\n    tasks: [ # &lt;- collection, please\n      { id: 3, user_id: 2, title: ... },\n      { id: 4, user_id: 2, title: ... }\n    ]\n]\n</code></pre>\n\n<p>If use ActiveRecord, it be <code>User.includes(:tasks)</code></p>\n\n<p>How can I get collection tasks inside each users? (sql)\nIs it possible?</p>\n"}, {"tags": ["sql", "ruby", "windows"], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 5316226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PwpJ8.jpg?s=128&g=1", "display_name": "IsolatePy", "link": "https://stackoverflow.com/users/5316226/isolatepy"}, "is_accepted": false, "score": 1, "last_activity_date": 1574194991, "creation_date": 1574194991, "answer_id": 58942253, "question_id": 58941561, "link": "https://stackoverflow.com/questions/58941561/how-to-create-a-snipping-tool-that-works-like-winv-clipboard-history/58942253#58942253", "title": "How to create a snipping tool that works like Win+V clipboard history?", "body": "<p>Using lightshot software its simple and easy\nyou can also use this to upload your screenshots in cloud\n<a href=\"https://app.prntscr.com/en/index.html\" rel=\"nofollow noreferrer\">https://app.prntscr.com/en/index.html</a></p>\n"}], "owner": {"reputation": 41, "user_id": 7792605, "user_type": "registered", "profile_image": "https://graph.facebook.com/1402594266430185/picture?type=large", "display_name": "Dennis Bakkerud Johnsen", "link": "https://stackoverflow.com/users/7792605/dennis-bakkerud-johnsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574194991, "creation_date": 1574191798, "question_id": 58941561, "link": "https://stackoverflow.com/questions/58941561/how-to-create-a-snipping-tool-that-works-like-winv-clipboard-history", "title": "How to create a snipping tool that works like Win+V clipboard history?", "body": "<p>Guys\nI work in IT support and have very little coding experience. I use a lot of tools during the day and if I where to alter any of them I would alter the snipping tool. I use it for taking snapshots of error-messages etc. that pops up on our clients computers. Every time I take a snapshot I have to choose to give it a name and have it saved in some folder. Doesn't seems so frustrating right? Well I probably take 15-30 of those a day, often while being on the phone and remote controlling some clients computer, i save snapshots with names I cannot remember and it chugs up space making it hard to find the correct snapshots later when I need it for troubleshooting and logging. What I need is a simple snipping tool that works like Win+V, clipboard history, id like my snipping tool to snap pictures and be logged in av archive much like the copy/cut history in my clipboard. That way I can scroll down and find correct image without searching through file explorer. How can I begin to do this, should I find an open source snipping tool out there and try editing it or should I just start from scratch? If so, what language should I write in and how to know where to begin?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 10255, "user_id": 1155142, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c680db41999d478ca34d1a77a470e30d?s=128&d=identicon&r=PG", "display_name": "gabrielhilal", "link": "https://stackoverflow.com/users/1155142/gabrielhilal"}, "edited": false, "score": 0, "creation_date": 1574190707, "post_id": 58941226, "comment_id": 104140984, "body": "if you change <code>resources :metrics</code> to <code>resource :metrics</code> you remove the <code>id</code> from the route... it depends how your UI is designed, but I would probably use nested attributes in that case and only update the post"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1574197062, "post_id": 58941226, "comment_id": 104143786, "body": "This is the basic problem that GraphQL seeks to solve. But as gabrielhilal has suggested: nested attributes is probably the easiest way to solve this issue. You may have to customise the code to handle the create or update scenarios."}], "answers": [{"tags": [], "owner": {"reputation": 18, "user_id": 10114589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc0b62a65f681085fe19707ba5dc3e6?s=128&d=identicon&r=PG&f=1", "display_name": "Yarrabhumi", "link": "https://stackoverflow.com/users/10114589/yarrabhumi"}, "is_accepted": false, "score": 0, "last_activity_date": 1574226556, "creation_date": 1574226556, "answer_id": 58947097, "question_id": 58941226, "link": "https://stackoverflow.com/questions/58941226/what-would-be-the-proper-way-to-create-a-create-or-update-route-on-rails/58947097#58947097", "title": "What would be the proper way to create a create OR update route on Rails", "body": "<p>Instead of putting a route, change the code in POST method like\n<code>metric = Metric.where(field_name: '#{value}').first_or_create</code> then assign values to metric object.\n(or)\n<code>metric = Metric.where(field_name: '#{value}').first_or_initialize</code>then assign values to metric object.\nThis will check the metric table for a specific record if found one then <code>.first</code> will work and it will update the details else <code>.initialize</code> (or) <code>.create</code> will work and it will create a new Metric record.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12212177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574226556, "creation_date": 1574190435, "question_id": 58941226, "link": "https://stackoverflow.com/questions/58941226/what-would-be-the-proper-way-to-create-a-create-or-update-route-on-rails", "title": "What would be the proper way to create a create OR update route on Rails", "body": "<p>I have the following models:</p>\n\n<pre><code>class Post &lt; ApplicationRecord\n  has_one :metric\nend\n\nclass Metric &lt; ApplicationRecord\n  belongs_to :post\nend\n</code></pre>\n\n<p>and I would like to create an endpoint to either create OR update a metric, through the Post. I would like to understand what would be the proper HTTP verb to be used, and how to properly create the route. Right now I have the following route:</p>\n\n<pre><code>resources :posts, only: [] do\n  resources :metrics, only: [:create, :update]\nend\n</code></pre>\n\n<p>But that's not really what I'm trying to achieve because to update a metric I need to know the id of the metric.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "abstract"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 2, "creation_date": 1574182505, "post_id": 58938792, "comment_id": 104136860, "body": "Association methods are called on model instances and not the class itself. <code>Classroom.first.students</code> works while <code>Classroom.students</code> will give you a NoMethodError. I&#39;m guessing your doing something strange here like assigning an instance of a class to a constant."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1574181576, "post_id": 58938856, "comment_id": 104136319, "body": "Prefer <code>public_send</code> over <code>send</code>"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1574182101, "post_id": 58938856, "comment_id": 104136653, "body": "Oh, yes! Definitely that&#39;s much better option. Thank you."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1574187569, "post_id": 58938856, "comment_id": 104139434, "body": "It&#39;s also worth noting that it&#39;s absolutely critical that these two string arguments are not arbitrary user parameters and that they <b>must be whitelisted</b>. Failing to do this could expose you to huge security risks because it allows fairly arbitrary method calls in your application."}], "tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 4, "last_activity_date": 1574182227, "last_edit_date": 1574182227, "creation_date": 1574181267, "answer_id": 58938856, "question_id": 58938792, "link": "https://stackoverflow.com/questions/58938792/how-to-access-an-instance-relation-using-strings-in-ruby-on-rails/58938856#58938856", "title": "How to access an instance relation using strings in Ruby on Rails?", "body": "<p>Use <a href=\"https://apidock.com/ruby/Object/public_send\" rel=\"nofollow noreferrer\">Object.public_send</a>, like this:</p>\n\n<pre><code>'Classroom'.constantize.public_send('students').public_send('first')\n</code></pre>\n\n<p>Edit: original answer suggested using <code>send</code> instead of <code>public_send</code>. The difference is that the former will call even the private methods, so it's less safe to use than the latter. </p>\n"}], "owner": {"reputation": 29, "user_id": 11223205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe68ff9d6b575ba48dd321569f00140d?s=128&d=identicon&r=PG", "display_name": "Tetsuo", "link": "https://stackoverflow.com/users/11223205/tetsuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1574182227, "creation_date": 1574181100, "question_id": 58938792, "link": "https://stackoverflow.com/questions/58938792/how-to-access-an-instance-relation-using-strings-in-ruby-on-rails", "title": "How to access an instance relation using strings in Ruby on Rails?", "body": "<p>Supose I have a class named <code>Classroom</code> and I have another class named <code>Student</code>.\nFrom their relationship I can access Student by using <code>Classroom.students</code> which returns an array of students.</p>\n\n<p>Now, taking that in consideration, if I assign <code>'Classroom'</code> to a variable and call it with <code>variable.constantize</code> it will return the Class from where I can query normally. </p>\n\n<p>eg: \n</p>\n\n<pre><code>[1] pry(main)&gt; variable = 'Classroom'\n[2] pry(main)&gt; variable.constantize.students\n=&gt; [#&lt;Student id: 1, name: 'Foo Smith'&gt;, &lt;Student id: 2, name: 'Bar Obama'&gt;]\n</code></pre>\n\n<p>All of that works for me but I have no idea on how to access students if the key name is also stored as a string. This works if I'm trying to access a <code>Classroom</code> field but for relations it seems to be impossible.</p>\n\n<p>eg: \n</p>\n\n<pre><code>[1] pry(main)&gt; variable = 'Classroom'\n[2] pry(main)&gt; class_key = 'name'\n[3] pry(main)&gt; relation_key = 'students'\n[4] pry(main)&gt; variable.constantize.first[class_key]\n=&gt; \"Happy Classroom\"\n[5] pry(main)&gt; variable.constantize.first[key]\n=&gt; nil\n</code></pre>\n\n<p>There's also another case in which the string is a method from the class.</p>\n\n<p>What I wanted to do <em>(mock code)</em>:\n</p>\n\n<pre><code>[1] pry(main)&gt; variable = 'Classroom'\n[2] pry(main)&gt; method = 'last'\n[3] pry(main)&gt; variable.constantize[method]\n=&gt; &lt;#Classroom id: 3, name: 'Dubious Classroom'&gt;\n</code></pre>\n\n<p>Any of those are feasible in Ruby?\nThanks!</p>\n"}, {"tags": ["ruby", "rubygems", "ruby-on-rails-5", "ruby-ripper"], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1574191421, "post_id": 58939496, "comment_id": 104141296, "body": "This often happens when you do an operating system update that breaks some compiled extensions. Look for &quot;.bundle&quot; in the error messages for that hint. It&#39;s also worth noting that a later point version of Ruby 2.5 may work here, the Ruby core team will do their utmost to make sure that supported versions of Ruby run on current operating systems."}], "tags": [], "owner": {"reputation": 61, "user_id": 1006998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154642e4d933b09830cfc7ecbc0919d4?s=128&d=identicon&r=PG", "display_name": "Rob Lucas", "link": "https://stackoverflow.com/users/1006998/rob-lucas"}, "is_accepted": false, "score": 1, "last_activity_date": 1574183600, "creation_date": 1574183600, "answer_id": 58939496, "question_id": 58938093, "link": "https://stackoverflow.com/questions/58938093/ruby-ripper-bundle-incompatible-library-version-errors-after-system-restore-from/58939496#58939496", "title": "Ruby ripper.bundle incompatible library version errors after system restore from backup", "body": "<p>Managed to get around this in the end just by upgrading Ruby from 2.5.0 to 2.6.5</p>\n"}], "owner": {"reputation": 61, "user_id": 1006998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154642e4d933b09830cfc7ecbc0919d4?s=128&d=identicon&r=PG", "display_name": "Rob Lucas", "link": "https://stackoverflow.com/users/1006998/rob-lucas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574183600, "creation_date": 1574179012, "question_id": 58938093, "link": "https://stackoverflow.com/questions/58938093/ruby-ripper-bundle-incompatible-library-version-errors-after-system-restore-from", "title": "Ruby ripper.bundle incompatible library version errors after system restore from backup", "body": "<p>After having to restore my whole system from a backup I'm having trouble with my Ruby gems. In particular, I get \"incompatible library version\" errors in relation to <code>ripper.bundle</code>.</p>\n\n<p>Have tried:</p>\n\n<ol>\n<li>Reinstalling rbenv via homebrew</li>\n<li>Reinstalling Ruby via rbenv</li>\n<li>Reinstalling OpenSSL</li>\n</ol>\n\n<p>The end of the traceback:</p>\n\n<pre><code> 1: from /Users/misteruser/Sites/asite/vendor/bundle/gems/activesupport-5.2.2.1/lib/active_support/dependencies.rb:291:in `block in require'\n /Users/misteruser/Sites/asite/vendor/bundle/gems/activesupport-5.2.2.1/lib/active_support/dependencies.rb:291:in `require': incompatible library version - /Users/misteruser/.rbenv/versions/2.5.0/lib/ruby/2.5.0/x86_64-darwin18/ripper.bundle (LoadError)\n</code></pre>\n"}, {"tags": ["ruby", "sass", "permissions", "compass-sass", "codekit"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9138310, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZNAeaDepbC8/AAAAAAAAAAI/AAAAAAAAABQ/9Nucnr0mcZ0/photo.jpg?sz=128", "display_name": "Asaad Mahmood", "link": "https://stackoverflow.com/users/9138310/asaad-mahmood"}, "edited": false, "score": 0, "creation_date": 1574275150, "post_id": 58940659, "comment_id": 104177680, "body": "And how do I do that?"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 45, "user_id": 9138310, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZNAeaDepbC8/AAAAAAAAAAI/AAAAAAAAABQ/9Nucnr0mcZ0/photo.jpg?sz=128", "display_name": "Asaad Mahmood", "link": "https://stackoverflow.com/users/9138310/asaad-mahmood"}, "edited": false, "score": 0, "creation_date": 1574277896, "post_id": 58940659, "comment_id": 104178946, "body": "@AsaadMahmood I don&#39;t know. You didn&#39;t include any info in your question to indicate what you&#39;re running to get this error"}, {"owner": {"reputation": 45, "user_id": 9138310, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZNAeaDepbC8/AAAAAAAAAAI/AAAAAAAAABQ/9Nucnr0mcZ0/photo.jpg?sz=128", "display_name": "Asaad Mahmood", "link": "https://stackoverflow.com/users/9138310/asaad-mahmood"}, "edited": false, "score": 0, "creation_date": 1574297229, "post_id": 58940659, "comment_id": 104186158, "body": "I get this error when compiling through &quot;Codekit&quot; <a href=\"https://codekitapp.com/\" rel=\"nofollow noreferrer\">codekitapp.com</a>."}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1574188101, "creation_date": 1574188101, "answer_id": 58940659, "question_id": 58937978, "link": "https://stackoverflow.com/questions/58937978/codekit-file-permission-issues-read-only-file-system-dir-s-mkdir-sass-cac/58940659#58940659", "title": "Codekit file permission issues (Read-only file system @ dir_s_mkdir - /.sass-cache)", "body": "<p><code>/.sass-cache</code> would be a Sass cache directory at the <em>root of your file system</em>. It should not be trying to create that directory there.</p>\n\n<p>However this Ruby is getting run, it's not running with the right working directory, or needs to be passed a base path to run in.</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 9138310, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZNAeaDepbC8/AAAAAAAAAAI/AAAAAAAAABQ/9Nucnr0mcZ0/photo.jpg?sz=128", "display_name": "Asaad Mahmood", "link": "https://stackoverflow.com/users/9138310/asaad-mahmood"}, "is_accepted": true, "score": 0, "last_activity_date": 1574506521, "creation_date": 1574506521, "answer_id": 59006847, "question_id": 58937978, "link": "https://stackoverflow.com/questions/58937978/codekit-file-permission-issues-read-only-file-system-dir-s-mkdir-sass-cac/59006847#59006847", "title": "Codekit file permission issues (Read-only file system @ dir_s_mkdir - /.sass-cache)", "body": "<p>In Catalina, the disk root where Ruby Sass attempts to write that cache is now read-only, so it fails.</p>\n\n<p>I used Bourbon instead. I also created some of the mixins that were in compass myself.</p>\n"}, {"comments": [{"owner": {"reputation": 461, "user_id": 1014927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBN9H.png?s=128&g=1", "display_name": "sagesolutions", "link": "https://stackoverflow.com/users/1014927/sagesolutions"}, "edited": false, "score": 0, "creation_date": 1588600990, "post_id": 59300639, "comment_id": 108952888, "body": "For versions 3.12.1+, Dart Sass is now the default sass compiler. You will still need to add <code>sass_options = { :cache_location =&gt; &#39;&#47;tmp&#47;sass_cache&#39; }</code> in your config.rb with Dart Sass."}], "tags": [], "owner": {"reputation": 91, "user_id": 1360753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57bc1541aba8a0b517d97c84ac8fea7d?s=128&d=identicon&r=PG", "display_name": "Julien Menichini", "link": "https://stackoverflow.com/users/1360753/julien-menichini"}, "is_accepted": false, "score": 2, "last_activity_date": 1576140237, "creation_date": 1576140237, "answer_id": 59300639, "question_id": 58937978, "link": "https://stackoverflow.com/questions/58937978/codekit-file-permission-issues-read-only-file-system-dir-s-mkdir-sass-cac/59300639#59300639", "title": "Codekit file permission issues (Read-only file system @ dir_s_mkdir - /.sass-cache)", "body": "<p>Ruby Sass is deprecated.\nIn Codekit 3 you should use libsass compiler instead.\nLibsass is not available if you use Compass.\nIf so, you can set the cache location path in the config.rb:</p>\n\n<p>sass_options = { :cache_location => '/tmp/sass_cache' }</p>\n"}], "owner": {"reputation": 45, "user_id": 9138310, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZNAeaDepbC8/AAAAAAAAAAI/AAAAAAAAABQ/9Nucnr0mcZ0/photo.jpg?sz=128", "display_name": "Asaad Mahmood", "link": "https://stackoverflow.com/users/9138310/asaad-mahmood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1381, "favorite_count": 0, "accepted_answer_id": 59006847, "answer_count": 3, "score": 2, "last_activity_date": 1576140237, "creation_date": 1574178651, "question_id": 58937978, "link": "https://stackoverflow.com/questions/58937978/codekit-file-permission-issues-read-only-file-system-dir-s-mkdir-sass-cac", "title": "Codekit file permission issues (Read-only file system @ dir_s_mkdir - /.sass-cache)", "body": "<p>Getting the following error:</p>\n\n<pre><code>Compiling failed with this error: Errno::EROFS on line [\"239\"] of /System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/lib/ruby/2.6.0/fileutils.rb: Read-only file system @ dir_s_mkdir - /.sass-cache\nRun with --trace to see the full backtrace\n</code></pre>\n\n<p>Really painful, any help would be appreciated.</p>\n\n<p>Happened after my update to Mac OS Catalina.\nCurrently on 10.15.1 (19B88).</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1574178454, "post_id": 58937856, "comment_id": 104134352, "body": "You may use <code>end.tap { |v| puts v.inspect }</code>. <a href=\"https://ruby-doc.org/core/Object.html#method-i-tap\" rel=\"nofollow noreferrer\"><code>Object#tap</code></a>. It yields the value to the block and returns it."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1574178707, "post_id": 58937856, "comment_id": 104134508, "body": "What do you mean with &quot;console&quot;? Are you referring to irb? Or would you like to have a breakpoint somewhere with byebug/pry and check out the previous value? Reason for asking is because all of these tools come with their own inspection tools/commands."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1574179132, "post_id": 58937856, "comment_id": 104134755, "body": "I don\u2019t understand the question but perhaps you are looking for <code>x = if something..end</code> or <code>x = method</code>."}, {"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 0, "creation_date": 1574179151, "post_id": 58937856, "comment_id": 104134765, "body": "byebug it&#39;s not an option for you? if not you can take a look to Binding class"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1574188115, "post_id": 58937856, "comment_id": 104139743, "body": "&quot;The way ruby works gives the impression that every expression returns a value <b>and</b> it is saved somewhere.&quot; This is not really true in any practical sense. Ruby compiles your code into bytecode, which operates on an internal stack. The returned value exists only on the stack and there&#39;s no way to access it unless you e.g. assign it to a variable."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1574189154, "post_id": 58937856, "comment_id": 104140251, "body": "A small point regarding &quot;,,,if no return is found...&quot;. <code>return</code> returns the last expression evaluated, so you don&#39;t need the proviso. For example, <code>return 7</code> causes the method to return <code>7</code>; <code>return</code> on a line by else (which would be unusual) returns the name of the method (a symbol)."}, {"owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1574189237, "post_id": 58937856, "comment_id": 104140295, "body": "@JordanRunning you can say &quot;saved&quot; is just pushed into the stack, so this is what I meant. You say there&#39;s no way of accessing it (I understand you mean from with in ruby, of course), then that&#39;s the answer. Like <code>_</code> in the irb or even the global <code>$_</code>, there might have been some magic for <code>pop;copy;push</code> hence the question."}, {"owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1574189451, "post_id": 58937856, "comment_id": 104140380, "body": "@CarySwoveland <code>return</code> by itself is just <code>return nil</code> not that unusual. For Example, this worsk: <code>if true; 1; else; 2;end.tap {}</code> this however does not: <code>if true; 1; else; return 2; end.tap{}</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1574193396, "post_id": 58937856, "comment_id": 104142176, "body": "@estani, ah, yes, <code>nil</code>, not the method name. It&#39;s not unusual for a method to return <code>nil</code> or to see <code>return nil</code>, but, as I said, it&#39;s unusual for <code>return</code> to appear on a line by itself, even though, as you point out, it&#39;s equivalent to <code>return nil</code>. My point, however, is that the method returns the result of the last value computed, regardless of whether it is on a line that includes <code>return</code>."}], "answers": [{"comments": [{"owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "edited": false, "score": 0, "creation_date": 1574183227, "post_id": 58938334, "comment_id": 104137284, "body": "thanks! please fix the colon, so it&#39;s complete. I guess it means you cannot access the stored value, but only tap into the last method (that&#39;s why if there&#39;s a returned involved it doesn&#39;t work, right?)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "edited": false, "score": 0, "creation_date": 1574238760, "post_id": 58938334, "comment_id": 104156195, "body": "@estani there&#39;s no special variable in Ruby holding the result of the last expression evaluated. But you can nonetheless add <code>tap</code> to the method&#39;s last expression and print its result. Or replace the method temporarily with one that prints it&#39;s return value (see 2nd example)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "edited": false, "score": 1, "creation_date": 1574239407, "post_id": 58938334, "comment_id": 104156515, "body": "@estani Ruby allows you to hook into the script execution via <code>TracePoint</code> (see 3rd example)"}, {"owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "edited": false, "score": 0, "creation_date": 1574241649, "post_id": 58938334, "comment_id": 104157817, "body": "So ruby does hold all those values! <code>tp.return_value</code> is exactly what I&#39;ve been looking for! Thanks!"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 2, "last_activity_date": 1574239426, "last_edit_date": 1574239426, "creation_date": 1574179701, "answer_id": 58938334, "question_id": 58937856, "link": "https://stackoverflow.com/questions/58937856/is-it-possible-to-get-the-value-that-will-be-returned-from-a-function-if-its-no/58938334#58938334", "title": "Is it possible to get the value that will be returned from a function if it&#39;s not stored in a variable?", "body": "<p><em>[based on <a href=\"https://stackoverflow.com/questions/58937856/is-it-possible-to-get-the-value-that-will-be-returned-from-a-function-if-its-no/58938334#comment104134352_58937856\">Aleksei Matiushkin's comment</a>]</em></p>\n\n<hr>\n\n<p>In Ruby, control expressions have a return value.</p>\n\n<p>Your method merely returns the result of the <a href=\"https://ruby-doc.org/core-2.6.5/doc/syntax/control_expressions_rdoc.html#label-if+Expression\" rel=\"nofollow noreferrer\"><code>if</code> expression</a>. And you can inspect it via <a href=\"https://ruby-doc.org/core-2.6.5/Object.html#method-i-tap\" rel=\"nofollow noreferrer\"><code>tap</code></a>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def foo(b)\n  if b\n    123\n  else\n    456\n  end.tap { |result| p result: result }\nend\n\nfoo(true)\n# prints {:result=&gt;123}\n#=&gt; 123\n\nfoo(false)\n# prints {:result=&gt;456}\n#=&gt; 456\n</code></pre>\n\n<hr>\n\n<p>If you have more complicated situation without a single last expression, e.g.:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class C\n  def foo(b)\n    return 123 if b\n    456\n  end\nend\n</code></pre>\n\n<p>You could use refinements to replace the method:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module M\n  refine C do\n    def foo(*)\n      super.tap { |result| p result: result }\n    end\n  end\nend\n</code></pre>\n\n<p>Usage:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>using M\n\nc = C.new\n\nc.foo(true)\n# prints {:result=&gt;123}\n#=&gt; 123\n\nc.foo(false)\n# prints {:result=&gt;456}\n#=&gt; 456\n</code></pre>\n\n<hr>\n\n<p>Yet another approach is to use <a href=\"https://ruby-doc.org/core-2.6.5/TracePoint.html\" rel=\"nofollow noreferrer\"><code>TracePoint</code></a> to hook into the execution:</p>\n\n<pre><code>def foo(b)             # 1\n  return 123 if b      # 2\n  456                  # 3\nend                    # 4\n\nTracePoint.trace(:return) do |tp|\n  puts \"method `#{tp.method_id}' returned #{tp.return_value.inspect} on line ##{tp.lineno}\"\nend\n\nfoo(true)\nfoo(false)\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>method `foo' returned 123 on line #2\nmethod `foo' returned 456 on line #4\n</code></pre>\n\n<p>Note that this prints the return value of all method calls. You might want to limit it to <code>tp.method_id == :foo</code></p>\n"}], "owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 58938334, "answer_count": 1, "score": 2, "last_activity_date": 1574239426, "creation_date": 1574178245, "question_id": 58937856, "link": "https://stackoverflow.com/questions/58937856/is-it-possible-to-get-the-value-that-will-be-returned-from-a-function-if-its-no", "title": "Is it possible to get the value that will be returned from a function if it&#39;s not stored in a variable?", "body": "<p>I'm debugging a method that looks like this</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def method\n  if something\n   \"a\"\n  elsif somethingelse\n   \"b\"\n  #elseif ...\n  else\n   \"z\"\n  end\n  # the current return value is ???\nend\n</code></pre>\n\n<p>The way ruby works gives the impression that every expression returns a value <strong>and</strong> it is saved somewhere. And the last one is going to be returned at the end of the method (if no <code>return</code> is found).</p>\n\n<p>In the case above, the if condition returns a string (which is stored somewhere?) and at the end of the method, since nothing else changed, that string is returned.</p>\n\n<p>Is it possible to access that value? (a little like <code>_</code> in the console, that returns the result from the last command)</p>\n"}, {"tags": ["ruby", "ubuntu", "server", "nohup", "codio"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6415506, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000038503695/picture?type=large", "display_name": "Larry R. Irwin", "link": "https://stackoverflow.com/users/6415506/larry-r-irwin"}, "is_accepted": false, "score": 0, "last_activity_date": 1574178610, "creation_date": 1574178610, "answer_id": 58937965, "question_id": 58937683, "link": "https://stackoverflow.com/questions/58937683/how-do-i-use-nohup-command-in-ubuntu-box-to-get-my-ruby-server-to-run-in-the-bac/58937965#58937965", "title": "How do I use nohup command in ubuntu box to get my ruby server to run in the background", "body": "<p>I've found that nohup can be a bit problematic. It is better to either set your server up as a service (like mysqld, sshd, etc.) or to use \"at\" to kick it off.\nIf the command works when you run it in the foreground (without nohup) then running it with \"at\" will work since it applies the current environment to the command and has \"atd\" as a parent process that won't go away when you log off (which sometimes breaks nohup when it tries to re-assign the parent process):</p>\n\n<pre><code>at now\nat&gt; make serve &gt;&gt;/var/log/rubyserver.log 2&gt;&amp;1\nat&gt; ^D\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12054427, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-O__NFY4joJ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2Xir2uLTcm-rDLE-ZT0Auh_jEFQ/photo.jpg?sz=128", "display_name": "user12054427", "link": "https://stackoverflow.com/users/12054427/user12054427"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574178610, "creation_date": 1574177790, "question_id": 58937683, "link": "https://stackoverflow.com/questions/58937683/how-do-i-use-nohup-command-in-ubuntu-box-to-get-my-ruby-server-to-run-in-the-bac", "title": "How do I use nohup command in ubuntu box to get my ruby server to run in the background", "body": "<h2>My make serve command runs my jupyter-book fine with make serve</h2>\n\n<pre><code>codio@anita-doctor:~/workspace/Introduction-to-Data-Science/IntroBook$ make serve\nbundle exec guard\nConfiguration file: _config.yml\n15:21:53 - INFO - Jekyll building...\n15:21:54 - INFO - Jekyll build completed in 0.75s /home/codio/workspace/Introduction-to-Data- \nScience/IntroBook \u2192 _site\n15:21:54 - INFO - Jekyll watching and serving using jekyll at 0.0.0.0:4000/jupyter-book\n15:21:54 - INFO - Jekyll watching\n15:21:54 - INFO - LiveReload is waiting for a browser to connect.\n15:21:54 - INFO - Guard is now watching at '/home/codio/workspace/Introduction-to-Data- \nScience/IntroBook'\nServer address: http://0.0.0.0:4000/jupyter-book/\nServer running... press ctrl-c to stop.\n/home/codio/anaconda/lib/ruby/gems/2.6.0/gems/guard-2.14.2/lib/guard/jobs/pry_wrapper.rb:279: \nwarning: method Pry#input_array is deprecated. Use Pry#inp\nut_ring instead\n[1] guard(main)&gt;\n</code></pre>\n\n<hr>\n\n<h2>So I tried using this nohup command to run it in the background</h2>\n\n<pre><code> codio@anita-doctor:~/workspace/Introduction-to-Data-Science/IntroBook$ nohup make serve &gt;/dev/null \n 2&gt;&amp;1 &amp;\n [2] 2135\n [1]   Done               nohup make serve &lt; /dev/null &gt; /dev/null 2&gt;&amp;1\n</code></pre>\n\n<hr>\n\n<p>This command or type of commands usually does nothing. I believe I may be close. But, the nohup commands do not seem to allow the ruby 'make serve' command to work. My goal is to host the server, as I did in the first line of code with the make serve command from my ubuntu box, in the background. Any help would be appreciated. </p>\n"}, {"tags": ["ruby", "instance-variables"], "comments": [{"owner": {"reputation": 302, "user_id": 3476715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fbb398b5801ea1209385207d33c6269?s=128&d=identicon&r=PG", "display_name": "shanecav", "link": "https://stackoverflow.com/users/3476715/shanecav"}, "edited": false, "score": 0, "creation_date": 1574179962, "post_id": 58936943, "comment_id": 104135245, "body": "See <a href=\"https://stackoverflow.com/questions/21122691/attr-accessor-on-class-variables\" title=\"attr accessor on class variables\">stackoverflow.com/questions/21122691/&hellip;</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1574180446, "post_id": 58936943, "comment_id": 104135532, "body": "<code>attr_accessor</code> creates getter and setter methods that can be sent to <i>instances</i> of the class to retrieve or set the values of that instance\u2019s instance variables. <code>@starting</code> and <code>@finished</code> are <i>class</i> instance variables. To create accessor for those variables your need to execute <code>attr_accessor</code> in <code>Run</code>s singleton class: <code>class &lt;&lt; self; attr_accessor :starting, finished; end</code>. (Try it.)"}], "answers": [{"tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 2, "last_activity_date": 1574182067, "creation_date": 1574182067, "answer_id": 58939077, "question_id": 58936943, "link": "https://stackoverflow.com/questions/58936943/ruby-how-to-access-instance-variables-from-classes-with-self-methods/58939077#58939077", "title": "Ruby - How to access instance variables from classes with &quot;self&quot; methods?", "body": "<blockquote>\n  <p>All of the methods in Run have self before them, meaning that I don't have to do run = Run.new and I can just do Run.starting</p>\n</blockquote>\n\n<p>There's much more to it than this. In your case you're calling class methods. If you did <code>runner = Runner.new</code> - then you'd be calling instance methods (those are defined without <code>self</code>.</p>\n\n<p>In general, if you need \"the thing\" to hold some kind of state (like <code>@running = true</code>) then you'd rather want to instantiate an object, and call those methods. </p>\n\n<p>Now, <code>@whatever</code> are instance variables, and you don't have the access to them in class methods. </p>\n\n<pre><code>class Run\n   attr_reader :running\n   def start\n      @running = true\n   end\n\n   def stop\n      @running = false\n   end\nend\n\nrunner = Run.new\nrunner.running # nil\nrunner.start\nrunner.running # true\nrunner.stop \nrunner.running # false\n</code></pre>\n\n<p>I'd recommend you doing some tutorial or basic level book on rails programming, find a chapter about objects and classes. Do some exercises. </p>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1574185387, "last_edit_date": 1574185387, "creation_date": 1574184371, "answer_id": 58939690, "question_id": 58936943, "link": "https://stackoverflow.com/questions/58936943/ruby-how-to-access-instance-variables-from-classes-with-self-methods/58939690#58939690", "title": "Ruby - How to access instance variables from classes with &quot;self&quot; methods?", "body": "<p>In Ruby instance variables are just lexical variables scoped to an instance of a class. Since they are scoped to the instance they always act like a private variable.</p>\n\n<p>If you want to provide access to an instance variable from the outside you create setter and getter methods. Thats what <code>attr_accessor</code> does.</p>\n\n<pre><code>class Person\n  attr_accessor :name\n\n  def initialize(name:)\n    @name = name\n  end\n\n  def hello\n    \"Hello my name is #{@name}\"\n  end\nend\n\njohn = Person.new(name: 'John')\njohn.name = \"John Smith\"\nputs john.hello # \"Hello my name is John Smith\"\nputs john.name # \"John Smith\"\n</code></pre>\n\n<p>Methods defined with <code>def self.foo</code> are class methods which are also referred to as singleton methods. You can't access variables belonging to an instance from inside a class method since the recipient when calling the method is the class itself and not an instance of the class.</p>\n\n<p>Ruby also has class variables which are shared by a class and its subclasses:</p>\n\n<pre><code>class Person\n  @@count = 0\n\n  def initialize\n    self.class.count += 1\n  end\n\n  def self.count\n    @@count\n  end\n  def self.count=(value)\n    @@count = value\n  end\nend\n\nclass Student &lt; Person\nend\n\nPerson.new\nStudent.new\nputs Person.count # 2 - wtf!\n</code></pre>\n\n<p>And class instance variables that are not shared with subclasses:</p>\n\n<pre><code>class Person\n  @count = 0 # sets an instance variable in the eigenclass\n\n  def initialize\n    self.class.count += 1\n  end\n\n  def self.count\n    @count\n  end\n  def self.count=(value)\n    @count = value\n  end\nend\n\nclass Student &lt; Person\n  @count = 0 # sets its own class instance variable\nend\n\nPerson.new\nStudent.new\nputs Person.count # 1\n</code></pre>\n\n<p>Class variables are not used as often and usually hold references to things like database connections or configuration which is shared by all instances of a class.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1574260863, "creation_date": 1574260863, "answer_id": 58956954, "question_id": 58936943, "link": "https://stackoverflow.com/questions/58936943/ruby-how-to-access-instance-variables-from-classes-with-self-methods/58956954#58956954", "title": "Ruby - How to access instance variables from classes with &quot;self&quot; methods?", "body": "<p>You can't access instance variables from outside the instance. That is the whole point of instance variables.</p>\n\n<p>The only thing you can access from outside the instance are (public) methods.</p>\n\n<p>However, you can create a public method that returns the instance variable. Such a method is called an <em>attribute reader</em> in Ruby, other languages may call it a <em>getter</em>. In Ruby, an attribute reader is typically named the same as the instance variable, but in your case that is not possible since there are already methods with the names <code>starting</code> and <code>finished</code>. Therefore, we have to find some other names for the attribute readers:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Run\n  def self.starting?\n    @starting\n  end\n\n  def self.finished?\n    @finished\n  end\nend\n</code></pre>\n\n<p>Since this is a common operation, there are helper methods which generate those methods for you, for example <a href=\"https://ruby-doc.org/core/Module.html#method-i-attr_reader\" rel=\"nofollow noreferrer\"><code>Module#attr_reader</code></a>. However, they also assume that the name of the attribute reader method is the same as the name of the instance variable, so if you were to use this helper method, it would overwrite the methods you have already written!</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class &lt;&lt; Run\n  attr_reader :starting, :finished\nend\n</code></pre>\n\n<p>When you do this, you will get warnings (you always have warning turned on when developing, do you?) telling you that you have overwritten your existing methods:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>run.rb:19: warning: method redefined; discarding old starting\nrun.rb:2: warning: previous definition of starting was here\nrun.rb:19: warning: method redefined; discarding old finished\nrun.rb:5: warning: previous definition of finished was here\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 10480674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/krkYd.png?s=128&g=1", "display_name": "Domani Tomlindo", "link": "https://stackoverflow.com/users/10480674/domani-tomlindo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1434, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1574260863, "creation_date": 1574175658, "question_id": 58936943, "link": "https://stackoverflow.com/questions/58936943/ruby-how-to-access-instance-variables-from-classes-with-self-methods", "title": "Ruby - How to access instance variables from classes with &quot;self&quot; methods?", "body": "<p>Sorry that I have no clue how to title this, I'm having a hard time looking this up <strong>because</strong> I don't know how to say this. Anyway...</p>\n\n<p>Let's say I have a class that looks like this for example:</p>\n\n<pre><code>class Run\n    def self.starting\n        print \"starting...\"\n    end\n    def self.finished\n        print \"Finished!\"\n    end\nend\n</code></pre>\n\n<p>All of the methods in <code>Run</code> have <code>self</code> before them, meaning that I don't have to do <code>run = Run.new</code> and I can just do <code>Run.starting</code>. Now let's say that I wanted to add some instance variables...</p>\n\n<pre><code>class Run\n    attr_accessor :starting, :finished\n    def self.starting\n        print \"starting...\"\n        @starting = true\n        @finished = false\n    end\n    def self.finished\n        print \"finished!\"\n        @starting = false\n        @finished = true\n    end\nend\n</code></pre>\n\n<p>What if I wanted to access those instance variables from outside the class? I know that something like <code>print \"#{Run.finished}\"</code> or <code>print \"#{Run.starting}\"</code> won't do anything. Can I do that without <code>run = Run.new</code>? Or should I just remove <code>self</code> and then use <code>run = Run.new</code>? (Sorry if this question is a mess.)</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1574175750, "post_id": 58936797, "comment_id": 104132602, "body": "Of course. It&#39;s o obvious now! I was just typing it the same way as &quot;to receive&quot;, without much thinking."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1574175798, "post_id": 58936797, "comment_id": 104132642, "body": "@user1934428 that&#39;s the problem with those DSLs \u2013 easy to read but kind of tricky to write."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1574176482, "post_id": 58936797, "comment_id": 104133072, "body": "@Only that in this case, it was not really tricky.Just my ability to think logically had gone for a short walk, while I was writing the code."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 4, "last_activity_date": 1574196892, "last_edit_date": 1574196892, "creation_date": 1574175256, "answer_id": 58936797, "question_id": 58936765, "link": "https://stackoverflow.com/questions/58936765/rspec-allow-silently-terminates-it-block/58936797#58936797", "title": "RSpec &quot;allow&quot; silently terminates &quot;it&quot; block", "body": "<p>You have a line:</p>\n\n<pre><code>allow(String).to receive(:broken?).and return(false)\n</code></pre>\n\n<p>This calls <code>allow(String).to(receive(:broken?).and(return(false)))</code></p>\n\n<p>So you call <code>return</code> keyword that silently ends the example.</p>\n\n<p>You should call  <a href=\"https://relishapp.com/rspec/rspec-mocks/docs/configuring-responses/returning-a-value\" rel=\"nofollow noreferrer\"><code>and_return</code></a> not <code>and return</code> (note the underscore instead of a space).</p>\n"}], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 58936797, "answer_count": 1, "score": 1, "last_activity_date": 1574196892, "creation_date": 1574175171, "last_edit_date": 1574175390, "question_id": 58936765, "link": "https://stackoverflow.com/questions/58936765/rspec-allow-silently-terminates-it-block", "title": "RSpec &quot;allow&quot; silently terminates &quot;it&quot; block", "body": "<p>I have an RSpec test like this:</p>\n\n<pre><code>RSpec.describe 'outer' do\n  describe 'inner' do\n    context 'context' do\n      it 'my test' do\n        puts \":::: BEFORE\"\n        allow(String).to receive(:broken?).and return(false)\n        puts \":::: AFTER\"\n        expect(0).to eq(1) # Won't be executed\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Of course in my own test, I do not use <code>allow</code> on a <code>String</code>, but on one of my classes, but the effect is the same: When I run this code, <em>BEFORE</em> is printed, but <em>AFTER</em> is not printed (nor is anything else executed which would come after the <code>allow</code>. The effect is, as if the <code>allow</code> would terminate the test. There is no error message; RSpec just says \"1 example, 0 failures\".</p>\n\n<p>Other things worth to mention:</p>\n\n<p>The RSpec mocking is configured with <code>mocks.verify_partial_doubles = true</code>, but the effect is the same, independent on whether we specify with <code>allow</code> an existing method or (as in my example) a non-existing one.</p>\n\n<p>Warnings are turned on, with <code>config.warnings = true</code>.</p>\n\n<p>Any idea why <code>allow</code> might show this behaviour?</p>\n"}, {"tags": ["ruby", "performance"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1574169747, "post_id": 58934816, "comment_id": 104128950, "body": "Printing strings should be blazing fast. Maybe the objects you&#39;re printing are not strings and it&#39;s their <code>to_s</code> method which takes so long?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1574170050, "post_id": 58934816, "comment_id": 104129129, "body": "@Stefan isn&#39;t it <code>inspect</code> actually?"}, {"owner": {"reputation": 1, "user_id": 12397756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e0860de5236a2ec95f6afdd1174bfa2?s=128&d=identicon&r=PG&f=1", "display_name": "JQuist", "link": "https://stackoverflow.com/users/12397756/jquist"}, "edited": false, "score": 0, "creation_date": 1574170095, "post_id": 58934816, "comment_id": 104129154, "body": "We use mechanize to look through the individual webpages but the only thing we print out is the URL to the page. How does the speed at which <code>to_s</code> completes vary depending on the object?  We use the <code>.uri</code> parser in mechanize to get the links."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1574172367, "post_id": 58934816, "comment_id": 104130484, "body": "@JQuist can you show some code? Preferably a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1574173258, "post_id": 58934816, "comment_id": 104131065, "body": "@MarekLipka <code>p</code> calls <code>inspect</code> whereas <code>puts</code> calls <code>to_s</code>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1574186567, "post_id": 58934816, "comment_id": 104138929, "body": "&quot;How does the speed at which to_s completes vary depending on the object?&quot; Simple objects like numbers are relatively straight forward to cast. Then you have arrays and hashes which are slightly more complex and then you have complex objects like a Nokogiri XML document where <code>to_s</code> has to convert the whole document tree to a XML string."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1574260173, "post_id": 58934816, "comment_id": 104168930, "body": "What happens when you redirect the output of the program to a file? What happens when you redirect to <code>&#47;dev&#47;null</code>? What measurements do you have that prove that it is Ruby being slow and not the console?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1574402409, "post_id": 58934816, "comment_id": 104228362, "body": "&quot;Severe performance hit&quot; requires a code sample to reproduce the issue. Vague explanations are not helpful. Voted to close as the question should be updated to include desired behavior, a specific problem or error, and the shortest code necessary to reproduce the problem."}, {"owner": {"reputation": 1532, "user_id": 1364241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/NS4zd.jpg?s=128&g=1", "display_name": "Spons", "link": "https://stackoverflow.com/users/1364241/spons"}, "edited": false, "score": 0, "creation_date": 1574853608, "post_id": 58934816, "comment_id": 104376155, "body": "@JQuist I&#39;ve hit the same issue in the past, and had figure it had something to do with the thing install (Specific build pack on heroku, which we worked with) on my server and specifically related to something in the range of selenium, web drivers, scraping area.. Never figure out what caused the issue. But we remove all Puts from our code and move onto logging into our database, probably any external logger would work!"}], "owner": {"reputation": 1, "user_id": 12397756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e0860de5236a2ec95f6afdd1174bfa2?s=128&d=identicon&r=PG&f=1", "display_name": "JQuist", "link": "https://stackoverflow.com/users/12397756/jquist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574168719, "creation_date": 1574168719, "question_id": 58934816, "link": "https://stackoverflow.com/questions/58934816/ruby-severe-performance-hit-when-using-puts", "title": "Ruby: Severe performance hit when using &#39;puts&#39;", "body": "<p>In our Ruby web scraper, when using the 'puts' command for troubleshooting the method takes several minutes longer to complete compared to when nothing is outputted into the console. This is despite only outputting a couple of hundred (less than a thousand) strings. I understand that a method takes longer to complete if it has a larger quantity of tasks to complete, but it feels a bit absurd for the length to essentially double. Especially when you take into account that a lot of time (both when using puts and not using puts) is just waiting to not get locked out after a fetch request.</p>\n\n<p>The 'puts' command is used in a loop but the number of outputs are only in the hundreds.</p>\n\n<p>Is it supposed to be this way? If so, why?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "performance", "jruby"], "comments": [{"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1574171043, "post_id": 58930227, "comment_id": 104129719, "body": "Are you deploying/running on windows? This ticket seems related: <a href=\"https://github.com/jruby/jruby/issues/5857\" rel=\"nofollow noreferrer\">github.com/jruby/jruby/issues/5857</a>"}, {"owner": {"reputation": 2601, "user_id": 27449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d169c3fa650d41a7aaa124ad0cdd9095?s=128&d=identicon&r=PG", "display_name": "Alexander Malfait", "link": "https://stackoverflow.com/users/27449/alexander-malfait"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1574172657, "post_id": 58930227, "comment_id": 104130658, "body": "@nathanvda, no, we&#39;re deploying on Linux. Performance is comparable on Windows (running on my local machine in production mode)"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1574180634, "post_id": 58930227, "comment_id": 104135680, "body": "Which library do you use to render the views: erb/haml/slim? If the above ticket was not relevant, I would propose opening a ticket on jruby github as they are very responsive."}, {"owner": {"reputation": 2601, "user_id": 27449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d169c3fa650d41a7aaa124ad0cdd9095?s=128&d=identicon&r=PG", "display_name": "Alexander Malfait", "link": "https://stackoverflow.com/users/27449/alexander-malfait"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1574344290, "post_id": 58930227, "comment_id": 104206116, "body": "@nathanvda We&#39;re using haml! I don&#39;t think it&#39;s basic haml issue, we can render a table with 10000 rows in 15ms. It&#39;s more a combination things like link_to and render :partial appearing to be &quot;a bit&quot; slower, adding up to slower request times. It&#39;s hard to file a bug report at JRuby for this, I think."}], "owner": {"reputation": 2601, "user_id": 27449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d169c3fa650d41a7aaa124ad0cdd9095?s=128&d=identicon&r=PG", "display_name": "Alexander Malfait", "link": "https://stackoverflow.com/users/27449/alexander-malfait"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574154422, "creation_date": 1574154422, "question_id": 58930227, "link": "https://stackoverflow.com/questions/58930227/performance-regression-upgrading-rails-2-3-to-5-2-and-jruby-1-7-to-jruby-9-2", "title": "Performance regression upgrading Rails 2.3 to 5.2 and JRuby 1.7 to JRuby 9.2", "body": "<p>We have an app that was initially created in 2008 on Rails 2.3. This app runs on top of JRuby version 1.7, in Ruby 1.8 compatibility mode. </p>\n\n<p>This is a largish app with 350 controllers and 450 models.</p>\n\n<p>We're (finally) upgrading the app to Rails 5.2, upgrading JRuby to latest version 9.2.8.0.</p>\n\n<p>We're now noticing a significant performance regression compared to the old app, running on the same server and database. Most requests are 30% to 200% slower than in the Rails 2.3 version.</p>\n\n<p>The slowdown seems to be linear to the amount of data rendered. I.e. when we render a large table of data, the request may take 3000ms vs 1000ms on the old version, even when there is no DB access happening in the view. When rendering a request with little data, the slowdown is much less pronounced.</p>\n\n<p>For instance, Rails 2.3 will render a certain \"heavy\" page in 3 sec:</p>\n\n<p><code>Completed in 2962ms (View: 1565, DB: 1384)</code></p>\n\n<p>Compared to 7 sec for the new version:</p>\n\n<p><code>Completed 200 OK in 7254ms (Views: 5808.5ms | ActiveRecord: 1389.3ms)</code></p>\n\n<p>The DB access time is very similar, but the \"view\" time is much much higher.</p>\n\n<p>We've tried running our app on MRI Ruby, and it's 3 times faster than on JRuby 9. Unfortunately, we make extensive use of Java libraries in our code, so we can't easily switch to MRI.</p>\n\n<p>Some questions:</p>\n\n<p>Is JRuby still a viable option for Rails 5, is anyone using it with good performance? </p>\n\n<p>I couldn't find a recommendation which JDK to run JRuby on. \nWe're now running on OpenJDK 8. I've briefly tried OpenJDK 13 but that seemed even slower.\nIs there a recommended version?</p>\n\n<p>We're using these options: <code>JRUBY_OPTS=-J-Xmx4g -XX:ReservedCodeCacheSize=300M --server</code>.\nAny recommendations on other options that may improve performance?</p>\n\n<p>We've used \"Datadog\" to produce flame-graphs of our requests, which confirms that most of the time is spent rendering views outside of data access, but we can't really tell what is costing time in the view. We've tried attaching JVisualVM to the app in sampling mode, but it's very hard to get useful metrics out of this. Is there a better way of profiling JRuby on Rails applications?</p>\n"}, {"tags": ["ruby", "rubygems", "google-api-client"], "answers": [{"tags": [], "owner": {"reputation": 180, "user_id": 8659405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ICOCH.gif?s=128&g=1", "display_name": "J.R. Bob Dobbs", "link": "https://stackoverflow.com/users/8659405/j-r-bob-dobbs"}, "is_accepted": false, "score": 0, "last_activity_date": 1574206908, "creation_date": 1574206908, "answer_id": 58944526, "question_id": 58929268, "link": "https://stackoverflow.com/questions/58929268/aliasing-the-module-in-google-api-client-gem/58944526#58944526", "title": "Aliasing the Module in Google-API-client Gem", "body": "<p><a href=\"https://github.com/googleapis/google-api-ruby-client#authorization-using-api-keys\" rel=\"nofollow noreferrer\">from the documentation</a></p>\n\n<p>The link above is the necessary detail regarding Authorization for an API key.  </p>\n\n<p>If you're like me, and this subject is new to you, there are three topics that you need to understand:  </p>\n\n<ol>\n<li>Authentication</li>\n<li>Authorization</li>\n<li>Accounting</li>\n</ol>\n\n<p>The documentation for the google-api-client gem is robust enough to answer a lot of questions, however, my answer here is hopefully enough to get you pointed in the right direction. </p>\n\n<p>I'm leaving the question up, in case anyone else needs some guidance regarding this same subject.</p>\n"}], "owner": {"reputation": 180, "user_id": 8659405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ICOCH.gif?s=128&g=1", "display_name": "J.R. Bob Dobbs", "link": "https://stackoverflow.com/users/8659405/j-r-bob-dobbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574206908, "creation_date": 1574150872, "last_edit_date": 1574178360, "question_id": 58929268, "link": "https://stackoverflow.com/questions/58929268/aliasing-the-module-in-google-api-client-gem", "title": "Aliasing the Module in Google-API-client Gem", "body": "<ol>\n<li><p>Summarize the problem: </p>\n\n<ul>\n<li>Being relatively new to Ruby/Gems and developing in general, some concepts evade me  </li>\n<li>I'm learning about the google-api-client Gem, and am attempting to understand the Basic Usage, and want to know how a developer knows which class to use, when instantiating an ojbect, during the \"aliasing of the module\" portion:</li>\n</ul></li>\n</ol>\n\n<blockquote>\n  <p>To use an API, include the corresponding generated file and instantiate the service. For example to use the Drive API:</p>\n</blockquote>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'google/apis/drive_v2'\n\nDrive = Google::Apis::DriveV2 # Alias the module\ndrive = Drive::DriveService.new # why is ::DriveService used here?\n#etc\n</code></pre>\n\n<ol start=\"2\">\n<li>Describe what I've tried:  \n\n<ul>\n<li>I've searched through the reference documentation for the <a href=\"https://googleapis.dev/ruby/google-api-client/latest/index.html\" rel=\"nofollow noreferrer\">google-api-client</a> for a clue about the \"decision\" to instantiate <code>drive</code> with <code>::DriveService.new</code></li>\n<li>The best reason I've come up with is: <code>DriveService</code> is instantiated because it is the \"BaseService\" of the \"DriveV2\" Class.... but I'm reaching for straws with this logic. </li>\n</ul></li>\n</ol>\n\n<p>My specific question is:  </p>\n\n<h3>How does a developer using APIs and this Google-API-client Gem know which object to instantiate?</h3>\n\n<p>I have to imagine there's a more elegant \"way\" to determine which object to instantiate at this point of accessing an API than digging through the documentation of the Gem....I mean...the \"BaseService\" information is coming from the documentation for this specific Gem.....    </p>\n\n<p>Maybe this is a matter of me losing \"scope\" per say by the Google API and the ambiguously named Gem maintained by Google...    </p>\n\n<p>But then again...if I'm using this Gem...then this documentation would always apply, because I wouldn't be able to use this Gem if it wasn't a Google-API....</p>\n"}, {"tags": ["ruby", "export-to-csv"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574151585, "post_id": 58929026, "comment_id": 104118826, "body": "What is <code>constructor</code>?"}, {"owner": {"reputation": 121, "user_id": 12233204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db5498409582cbfe165dc22a0c02c41?s=128&d=identicon&r=PG&f=1", "display_name": "abracadabrax", "link": "https://stackoverflow.com/users/12233204/abracadabrax"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574152198, "post_id": 58929026, "comment_id": 104119132, "body": "my bad, got mixed up with JS. It should be <code>initialize</code>"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 12233204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db5498409582cbfe165dc22a0c02c41?s=128&d=identicon&r=PG&f=1", "display_name": "abracadabrax", "link": "https://stackoverflow.com/users/12233204/abracadabrax"}, "edited": false, "score": 0, "creation_date": 1574173346, "post_id": 58933745, "comment_id": 104131120, "body": "Thanks. My issue is that I&#39;d like to have instances only define their own &quot;converter&quot; which would be the block that manipulates/converts/strips data from the original CSV to the format and columns to write in the new CSV file. The only way that I could do that, I think, is with a lambda. But I don&#39;t know how to make that lambda have access to both the original CSV object, and the transformed CSV object to write out. Your suggesstion essentially wraps it all into one method, and instances inheriting from it would have to reimplement it all from scratch, unless I&#39;m missing something?"}, {"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "reply_to_user": {"reputation": 121, "user_id": 12233204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db5498409582cbfe165dc22a0c02c41?s=128&d=identicon&r=PG&f=1", "display_name": "abracadabrax", "link": "https://stackoverflow.com/users/12233204/abracadabrax"}, "edited": false, "score": 0, "creation_date": 1574184876, "post_id": 58933745, "comment_id": 104138115, "body": "What I posted was example code of how to eliminate reading / writing the file several times. I added another option, hopefully one of these three will point you in the right direction. What you want to do is definitely possible, but if you want to avoid reading/writing files in the intermediate steps, then your classes should probably not deal with files at all, but only with the data they are responsible for."}, {"owner": {"reputation": 121, "user_id": 12233204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db5498409582cbfe165dc22a0c02c41?s=128&d=identicon&r=PG&f=1", "display_name": "abracadabrax", "link": "https://stackoverflow.com/users/12233204/abracadabrax"}, "edited": false, "score": 0, "creation_date": 1574325106, "post_id": 58933745, "comment_id": 104194637, "body": "Thank you. I ended up doing something similar, but I didn&#39;t use converters because I also needed side effects (increment some counters, etc). I did however create functions that take a <code>row</code> and processes it. One of the functions transforms the data, and this one returns an array of fields which I can shovel into target. This gives me a cleaner API, as the base class implements all the logic of opening and writing to files etc, while its children only focus on the transformations. Ideally, I&#39;d have this class return a <code>CSV::Table</code> and handle the file IO somewhere else, but alas."}], "tags": [], "owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "is_accepted": true, "score": 1, "last_activity_date": 1574184721, "last_edit_date": 1574184721, "creation_date": 1574165150, "answer_id": 58933745, "question_id": 58929026, "link": "https://stackoverflow.com/questions/58929026/how-to-observe-a-stream-in-rubys-csv-module/58933745#58933745", "title": "How to &quot;observe&quot; a stream in Ruby&#39;s CSV module?", "body": "<p>I can recommend one of two approaches, depending on your needs and personal taste.</p>\n\n<p>I have intentionally distilled the code to just its bare minimum (without your wrapping class), for clarity.</p>\n\n<h3>1. Simple read-modify-write loop</h3>\n\n<p>Since you do not want to slurp the file, use <code>CSV::Foreach</code>. For example, for a quick debugging session, do:</p>\n\n<pre><code>CSV.foreach \"source.csv\", headers: true do |row|\n  row[\"name\"] = row[\"name\"].upcase\n  row[\"new column\"] = \"new value\"\n  p row\nend\n</code></pre>\n\n<p>And if you wish to write to file during that same iteration:</p>\n\n<pre><code>require 'csv'\n\ncsv_options = { headers: true }\n\n# Open the target file for writing\nCSV.open(\"target.csv\", \"wb\") do |target|\n  # Add a header\n  target &lt;&lt; %w[new header column names]\n\n  # Iterate over the source CSV rows\n  CSV.foreach \"source.csv\", **csv_options do |row|\n    # Mutate and add columns\n    row[\"name\"] = row[\"name\"].upcase\n    row[\"new column\"] = \"new value\"\n\n    # Push the new row to the target file\n    target &lt;&lt; row\n  end\nend\n</code></pre>\n\n<h3>2. Using <code>CSV::Converters</code></h3>\n\n<p>There is a built in functionality that might be helpful - <code>CSV::Converters</code> - (see the <code>:converters</code> definition in the <a href=\"https://ruby-doc.org/stdlib-2.6.4/libdoc/csv/rdoc/CSV.html#method-c-new\" rel=\"nofollow noreferrer\"><code>CSV::New</code></a> documentation)</p>\n\n<pre><code>require 'csv'\n\n# Register a converter in the options hash\ncsv_options = { headers: true, converters: [:stripper] }\n\n# Define a converter\nCSV::Converters[:stripper] = lambda do |value, field|\n  value ? value.to_s.strip : value\nend\n\nCSV.open(\"target.csv\", \"wb\") do |target|\n  # same as above\n\n  CSV.foreach \"source.csv\", **csv_options do |row|\n    # same as above - input data will already be converted\n    # you can do additional things here if needed\n  end\nend\n</code></pre>\n\n<h3>3. Separate input and output from your converter classes</h3>\n\n<p>Based on your comment, and since you want to minimize I/O and iterations, perhaps extracting the read/write operations from the responsibility of the transformers might be of interest. Something like this.</p>\n\n<pre><code>require 'csv'\n\nclass NameCapitalizer\n  def self.call(row)\n    row[\"name\"] = row[\"name\"].upcase\n  end\nend\n\nclass EmailRemover\n  def self.call(row)\n    row.delete 'email'\n  end\nend\n\ncsv_options = { headers: true }\nconverters = [NameCapitalizer, EmailRemover]\n\nCSV.open(\"target.csv\", \"wb\") do |target|\n  CSV.foreach \"source.csv\", **csv_options do |row|\n    converters.each { |c| c.call row }\n    target &lt;&lt; row\n  end\nend\n</code></pre>\n\n<p>Note that the above code still does not handle the header, in case it was changed. You will probably have to reserve the last row (after all transformations) and prepend its <code>#headers</code> to the output CSV.</p>\n\n<p>There are probably plenty other ways to do it, but the CSV class in Ruby does not have the cleanest interface, so I try to keep code that deals with it as simple as I can.</p>\n"}], "owner": {"reputation": 121, "user_id": 12233204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db5498409582cbfe165dc22a0c02c41?s=128&d=identicon&r=PG&f=1", "display_name": "abracadabrax", "link": "https://stackoverflow.com/users/12233204/abracadabrax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 58933745, "answer_count": 1, "score": 2, "last_activity_date": 1574184721, "creation_date": 1574149883, "last_edit_date": 1574152213, "question_id": 58929026, "link": "https://stackoverflow.com/questions/58929026/how-to-observe-a-stream-in-rubys-csv-module", "title": "How to &quot;observe&quot; a stream in Ruby&#39;s CSV module?", "body": "<p>I am writing a class that takes a CSV files, transforms it, and then writes the new data out.</p>\n\n<pre><code>module Transformer\n  class Base\n    def initialize(file)\n      @file = file\n    end\n\n    def original_data(&amp;block)\n      opts = { headers: true }\n      CSV.open(file, 'rb', opts, &amp;block)\n    end\n\n    def transformer\n      # complex manipulations here like modifying columns, picking only certain\n      # columns to put into new_data, etc but simplified to `+10` to keep\n      # example concise\n      -&gt; { |row| new_data &lt;&lt; row['some_header'] + 10 }\n    end\n\n    def transformed_data\n      self.original_data(self.transformer) \n    end\n\n    def write_new_data\n      CSV.open('new_file.csv', 'wb', opts) do |new_data|\n        transformed_data\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>What I'd like to be able to do is:</p>\n\n<ul>\n<li>Look at the transformed data without writing it out (so I can test that it transforms the data correctly, and I don't <em>need</em> to write it to file right away: maybe I want to do more manipulation before writing it out)</li>\n<li>Don't slurp all the file at once, so it works no matter the size of the original data</li>\n<li>Have this as a base class with an empty <code>transformer</code> so that instances only need to implement their own transformers but the behavior for reading and writing is given by the base class.</li>\n</ul>\n\n<p>But obviously the above doesn't work because I don't really have a reference to <code>new_data</code> in <code>transformer</code>.</p>\n\n<p>How could I achieve this elegantly?</p>\n"}, {"tags": ["ruby", "api", "zoho"], "answers": [{"comments": [{"owner": {"reputation": 373, "user_id": 11569643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bXzIvjTet4U/AAAAAAAAAAI/AAAAAAAAAA8/sytsco5Y2S8/photo.jpg?sz=128", "display_name": "Yeahprettymuch", "link": "https://stackoverflow.com/users/11569643/yeahprettymuch"}, "edited": false, "score": 0, "creation_date": 1574146875, "post_id": 58928009, "comment_id": 104116889, "body": "Thank you so much!! Since it looks like my response is paginated - would you also know how to scroll through the pages using <code>pp</code>? Atm it only seems to be displaying page 1."}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "reply_to_user": {"reputation": 373, "user_id": 11569643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bXzIvjTet4U/AAAAAAAAAAI/AAAAAAAAAA8/sytsco5Y2S8/photo.jpg?sz=128", "display_name": "Yeahprettymuch", "link": "https://stackoverflow.com/users/11569643/yeahprettymuch"}, "edited": false, "score": 0, "creation_date": 1574164837, "post_id": 58928009, "comment_id": 104126217, "body": "See my edits to the answer. It is not tested code, but this is how I assume it should work based on the docs and source code. Give it a try."}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 1, "last_activity_date": 1574164784, "last_edit_date": 1574164784, "creation_date": 1574145564, "answer_id": 58928009, "question_id": 58927398, "link": "https://stackoverflow.com/questions/58927398/displaying-json-output-from-an-api-call-in-ruby-using-vscode/58928009#58928009", "title": "Displaying JSON output from an API call in Ruby using VScode", "body": "<p>Ruby does not print anything unless you tell it to. For debugging there is a pretty printing method available called <code>pp</code>, which is decent for trying to print structured data.</p>\n\n<p>In this case, if you want to output the records that your <code>get</code> method returns, you would do:</p>\n\n<pre><code>pp ZohoHub.connection.get 'Leads'\n</code></pre>\n\n<p>To get the next page you can look at <a href=\"https://github.com/rikas/zoho_hub/blob/master/lib/zoho_hub/connection.rb\" rel=\"nofollow noreferrer\">the source code</a>, and you will see the <code>get</code> request has an additional Hash parameter.</p>\n\n<pre><code>def get(path, params = {})\n</code></pre>\n\n<p>Then you have to read <a href=\"https://www.zoho.com/crm/developer/docs/api/get-records.html\" rel=\"nofollow noreferrer\">the Zoho API documentation for get</a>, and you will see that the page is requested using the <code>page</code> param.</p>\n\n<p>Therefore we can finally piece it together:</p>\n\n<pre><code>pp ZohoHub.connection.get('Leads', page: NNN)\n</code></pre>\n\n<p>Where <code>NNN</code> is the number of the page you want to request.</p>\n"}], "owner": {"reputation": 373, "user_id": 11569643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bXzIvjTet4U/AAAAAAAAAAI/AAAAAAAAAA8/sytsco5Y2S8/photo.jpg?sz=128", "display_name": "Yeahprettymuch", "link": "https://stackoverflow.com/users/11569643/yeahprettymuch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58928009, "answer_count": 1, "score": 0, "last_activity_date": 1574164784, "creation_date": 1574142349, "question_id": 58927398, "link": "https://stackoverflow.com/questions/58927398/displaying-json-output-from-an-api-call-in-ruby-using-vscode", "title": "Displaying JSON output from an API call in Ruby using VScode", "body": "<p>For context, I'm someone with zero experience in Ruby - I just asked my Senior Dev to copy-paste me some of his Ruby code so I could try to work with some APIs that he ended up putting off because he was too busy.</p>\n\n<p>So I'm using an API wrapper called <code>zoho_hub</code>, used as a wrapper for Zoho APIs (<a href=\"https://github.com/rikas/zoho_hub/blob/master/README.md\" rel=\"nofollow noreferrer\">https://github.com/rikas/zoho_hub/blob/master/README.md</a>).</p>\n\n<p>My IDE is VSCode. </p>\n\n<p>I execute the entire length of the code, and I'm faced with this: </p>\n\n<p><code>[Done] exited with code=0 in 1.26 seconds</code></p>\n\n<p>The API is supposed to return a paginated list of records, but I don't see anything outputted in VSCode, despite the fact that no error is being reflected. The last 2 lines of my code are:</p>\n\n<pre><code>ZohoHub.connection.get 'Leads'\np \"testing\"\n</code></pre>\n\n<p>I use the dummy string \"testing\" to make sure that it's being executed up till the very end, and it does get printed.</p>\n\n<p>This has been baffling me for hours now - is my response actually being outputted somewhere, and I just can't see it??</p>\n"}, {"tags": ["ruby", "watir"], "answers": [{"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1574219301, "post_id": 58935849, "comment_id": 104150083, "body": "Works like a charm! Thank you very much!"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1574219477, "post_id": 58935849, "comment_id": 104150119, "body": "Gave the reference to this answer there <a href=\"https://stackoverflow.com/questions/58920198/selenium-webdriver-in-ruby-preventing-the-test-from-closing-the-browser-window/58946043#58946043\" title=\"selenium webdriver in ruby preventing the test from closing the browser window\">stackoverflow.com/questions/58920198/&hellip;</a>"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1574268979, "post_id": 58935849, "comment_id": 104174472, "body": "@Rajagopalan, wouldn&#39;t that question need an answer that is translated to pure Selenium-WebDriver?"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1574305952, "post_id": 58935849, "comment_id": 104188174, "body": "Watir is implementing this `  selenium_args = Capabilities.new(browser, *args).to_args` to achieve but I don&#39;t know how to bring it in selenium directly. Perhaps, If you write an answer there, it would be good."}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 1, "last_activity_date": 1574172209, "creation_date": 1574172209, "answer_id": 58935849, "question_id": 58926616, "link": "https://stackoverflow.com/questions/58926616/chrome-detach-option-is-no-longer-working/58935849#58935849", "title": "Chrome detach option is no longer working", "body": "<p>You can pass Chrome Options using the following format:</p>\n\n<pre><code>browser = Watir::Browser.new(\n  :chrome,\n  'goog:chromeOptions' =&gt; {detach: true}\n)\n</code></pre>\n"}], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 58935849, "answer_count": 1, "score": 1, "last_activity_date": 1574172209, "creation_date": 1574137386, "question_id": 58926616, "link": "https://stackoverflow.com/questions/58926616/chrome-detach-option-is-no-longer-working", "title": "Chrome detach option is no longer working", "body": "<p>There is a question for Ruby Selenium Binding here</p>\n\n<p><a href=\"https://stackoverflow.com/questions/58920198/selenium-webdriver-in-ruby-preventing-the-test-from-closing-the-browser-window\">Selenium WebDriver in Ruby: Preventing the test from closing the browser window at end</a></p>\n\n<p>He was trying to not to close the window of Chrome after the execution but it's not working. I have had the solution for this problem, the given below program works fine earlier, but now it's not working</p>\n\n<pre><code>require 'watir'\ncaps = Selenium::WebDriver::Remote::Capabilities.chrome(chrome_options: {detach: true})\nb = Watir::Browser.new :chrome, desired_capabilities: caps\nb.goto('www.google.co.uk')\n</code></pre>\n\n<p>When I execute this program, this program is giving the warning of </p>\n\n<pre><code>2019-11-19 09:33:37 WARN Watir [\"use_capabilities\"] You can pass values directly into Watir::Browser opt without needing to use :desired_capabilities\n</code></pre>\n\n<p>But I don't know how to use this <code>Watir::Browser opt</code>. Any help is appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "tcp", "tcpclient"], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 3, "last_activity_date": 1574137359, "creation_date": 1574137359, "answer_id": 58926613, "question_id": 58926560, "link": "https://stackoverflow.com/questions/58926560/how-to-get-ip-address-of-the-request-comming-in-ruby-tcp-server/58926613#58926613", "title": "How to get Ip address of the request comming in Ruby TCP server?", "body": "<p>See <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/socket/rdoc/IPSocket.html#method-i-peeraddr\" rel=\"nofollow noreferrer\"><code>IPSocket#peeraddr</code></a>.</p>\n\n<pre><code>p client.peeraddr(false)[3]\n</code></pre>\n\n<p>Or a bit more legibly:</p>\n\n<pre><code>address_family, port, hostname, numeric_address = client.peeraddr(false)\np numeric_address\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2566, "user_id": 1578898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13d8e2260005e30e823d507385019735?s=128&d=identicon&r=PG", "display_name": "vidur punj", "link": "https://stackoverflow.com/users/1578898/vidur-punj"}, "is_accepted": false, "score": 1, "last_activity_date": 1574224271, "last_edit_date": 1574224271, "creation_date": 1574143937, "answer_id": 58927691, "question_id": 58926560, "link": "https://stackoverflow.com/questions/58926560/how-to-get-ip-address-of-the-request-comming-in-ruby-tcp-server/58927691#58927691", "title": "How to get Ip address of the request comming in Ruby TCP server?", "body": "<pre><code>require 'socket'\nputs \"Starting the Server...................\"\nserver = TCPServer.new 53492 # Server bound to port 53492\nloop do\n  Thread.start(server.accept) do |client|\n    # client = server.accept # Wait for a client to connect\n    # client.puts \"Hello you are there!\"\n    p \"Client address = #{client.peeraddr[3]}\"  ## Answer\n    result = ''\n    ansiString = client.recv(100).chomp\n    p \"String = #{ansiString}\"\n   begin\n  #  How to get the request IP adress here\n    rescue Errno::EPIPE\n      puts \"Connection broke!\"\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2566, "user_id": 1578898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13d8e2260005e30e823d507385019735?s=128&d=identicon&r=PG", "display_name": "vidur punj", "link": "https://stackoverflow.com/users/1578898/vidur-punj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "closed_date": 1574143968, "accepted_answer_id": 58926613, "answer_count": 2, "score": 1, "last_activity_date": 1574224271, "creation_date": 1574136948, "question_id": 58926560, "link": "https://stackoverflow.com/questions/58926560/how-to-get-ip-address-of-the-request-comming-in-ruby-tcp-server", "closed_reason": "Duplicate", "title": "How to get Ip address of the request comming in Ruby TCP server?", "body": "<p>I have made a coded to receive the TCP request in Ruby, but I am not able to get the Ip addresss of the coming request.<br>\nMy code is as:</p>\n\n<pre><code> require 'socket'\nputs \"Starting the Server...................\"\nserver = TCPServer.new 53492 # Server bound to port 53492\nloop do\n  Thread.start(server.accept) do |client|\n    # client = server.accept # Wait for a client to connect\n    # client.puts \"Hello you are there!\"\n    result = ''\n    ansiString = client.recv(100).chomp\n    p \"String = #{ansiString}\"\n   begin\n  #  How to get the request IP adress here\n    rescue Errno::EPIPE\n      puts \"Connection broke!\"\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "amazon-ec2", "directory", "chef-infra", "knife"], "answers": [{"comments": [{"owner": {"reputation": 489, "user_id": 7507925, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10212060276686137/picture?type=large", "display_name": "Cdhippen", "link": "https://stackoverflow.com/users/7507925/cdhippen"}, "edited": false, "score": 0, "creation_date": 1574186480, "post_id": 58939525, "comment_id": 104138893, "body": "So would I have to have like two different recipes run one after the other instead of trying to do it all in one recipe?"}], "tags": [], "owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "is_accepted": false, "score": 0, "last_activity_date": 1574183735, "creation_date": 1574183735, "answer_id": 58939525, "question_id": 58926023, "link": "https://stackoverflow.com/questions/58926023/knife-bootstrap-no-such-file-or-directory-dir-initialize-from-recipe-that-pu/58939525#58939525", "title": "knife bootstrap &quot;No such file or directory @ dir_initialize&quot; from recipe that puts files to site-packages from local directory", "body": "<p>you are mixing ruby code with chef dsl. it behaves differently then you expect, as the ruby code that surrounds\\wraps chef dsl gets executed at <a href=\"https://stackoverflow.com/a/54178543/1184717\">compile time and not on convergence time</a> as you expect.</p>\n"}], "owner": {"reputation": 489, "user_id": 7507925, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10212060276686137/picture?type=large", "display_name": "Cdhippen", "link": "https://stackoverflow.com/users/7507925/cdhippen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574183735, "creation_date": 1574132622, "question_id": 58926023, "link": "https://stackoverflow.com/questions/58926023/knife-bootstrap-no-such-file-or-directory-dir-initialize-from-recipe-that-pu", "title": "knife bootstrap &quot;No such file or directory @ dir_initialize&quot; from recipe that puts files to site-packages from local directory", "body": "<p>I've got a default.rb file in the cookbook that I'm trying to bootstrap an ec2 instance with and I'm trying to move site-packages from my local virtual environment that I've been building with onto a server via this chef cookbook.</p>\n\n<p>The reason for this is that our organization is very strict about how packages can be put onto production nodes, so I have to actually physically move over any libraries I want to use. There might very well be a better way to accomplish what I'm trying to do and I'm very open for suggestions, but currently, the issue I'm running into is that I don't know how to reference the local directory in the foreach loop, so it keeps trying to reference the folder on the server, but it for some reason I guess hasn't been created yet even though my code to look there comes after the code to move it there.</p>\n\n<p>Overall I'm confused by the error and would appreciate any explanation that can be given for why it's acting like the folder doesn't exist when the first block of code should have moved that folder there.</p>\n\n<p>My code for this default.rb file is below:</p>\n\n<pre><code>#\n# Cookbook:: &lt;cookbook_name&gt;\n# Recipe:: default\n#\n\ninclude_recipe \"yum-epel\"\n\n# install packages\nfor dir in [\"connector_1\", \"connector_2\", \"connector_3\", \"json_logger\", \"connector_4\", \"site-packages\"] do\n  remote_directory \"/usr/lib/python2.7/site-packages/#{dir}\" do\n    source \"app_packages/#{dir}\"\n    files_mode \"0655\"\n    mode \"0755\"\n  end\nend\n\n# install required site packages\n\nDir.foreach('/usr/lib/python2.7/site-packages/site-packages/') do |dir|\n  next if not dir.end_with?('.dist-info')\n    remote_directory \"/usr/lib/python2.7/#{dir}\" do\n      source \"app_packages/site-packages/#{dir}\"\n      files_mode \"0655\"\n      mode \"0755\"\n    end\nend\n\nremote_directory \"/home/app-automation/bin/app_deployment\" do\n  source \"app_deployment\"\n  files_owner \"app-automation\"\n  files_group \"app-automation\"\n  files_mode \"0660\"\n  owner \"app-automation\"\n  group \"app-automation\"\n  mode \"0770\"\nend\n</code></pre>\n"}, {"tags": ["ruby", "bash", "fastlane"], "comments": [{"owner": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "edited": false, "score": 2, "creation_date": 1574127218, "post_id": 58925354, "comment_id": 104112074, "body": "Does <code>check.size</code> return <code>4</code>? If not then there might be a trailing character that can be chopped. Example <code>&quot;true\\n&quot;.chomp</code>"}, {"owner": {"reputation": 5005, "user_id": 1550974, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/EH53Y.jpg?s=128&g=1", "display_name": "Khant Thu Linn", "link": "https://stackoverflow.com/users/1550974/khant-thu-linn"}, "reply_to_user": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "edited": false, "score": 0, "creation_date": 1574127683, "post_id": 58925354, "comment_id": 104112158, "body": "Very strange. I write puts(check.size) and it show 123."}, {"owner": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "edited": false, "score": 1, "creation_date": 1574127924, "post_id": 58925354, "comment_id": 104112199, "body": "I suspect &#39;check&#39; contains trailing whitespaces. You could verify with  <code>check.split(&#47;(.)&#47;)</code>. And to remove whitespace <code>check.gsub(&#47;\\s&#47;,&#39;&#39;)</code>"}, {"owner": {"reputation": 5005, "user_id": 1550974, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/EH53Y.jpg?s=128&g=1", "display_name": "Khant Thu Linn", "link": "https://stackoverflow.com/users/1550974/khant-thu-linn"}, "reply_to_user": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "edited": false, "score": 0, "creation_date": 1574128136, "post_id": 58925354, "comment_id": 104112238, "body": "omg it is returning me directory.  /  U  s  e  r  s  /  k  h  a  n  t  t  h  u  l  i  n  n  /  D  o  c  u  m  e  n  t  s  /  R  e  a  c  t  N  a  t  i  v  e  /  N  U  S  T  i  m  e  s  h  e  e  t  /  a  n  d  r  o  i  d   /  U  s  e  r  s  /  k  h  a  n  t  t  h  u  l  i  n  n  /  D  o  c  u  m  e  n  t  s  /  R  e  a  c  t  N  a  t  i  v  e  /  N  U  S  T  i  m  e  s  h  e  e  t   t  r  u  e  How shall I check the last &#39;true&#39; ?"}, {"owner": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "edited": false, "score": 2, "creation_date": 1574128342, "post_id": 58925354, "comment_id": 104112269, "body": "<code>check.gsub(&#47;\\s&#47;,&#39;&#39;)[-4..-1] == true</code>"}, {"owner": {"reputation": 5005, "user_id": 1550974, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/EH53Y.jpg?s=128&g=1", "display_name": "Khant Thu Linn", "link": "https://stackoverflow.com/users/1550974/khant-thu-linn"}, "reply_to_user": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "edited": false, "score": 1, "creation_date": 1574128548, "post_id": 58925354, "comment_id": 104112299, "body": "woo..aweseome! it solves now. thanks bro"}, {"owner": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "edited": false, "score": 1, "creation_date": 1574129237, "post_id": 58925354, "comment_id": 104112416, "body": "Or for better performance <code>check.delete(&quot;\\s&quot;)[-4..-1]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 1540898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046dc82526c7cb4c60d8e70c6f4d4615?s=128&d=identicon&r=PG", "display_name": "s.bernard", "link": "https://stackoverflow.com/users/1540898/s-bernard"}, "is_accepted": false, "score": 1, "last_activity_date": 1574131762, "creation_date": 1574131762, "answer_id": 58925932, "question_id": 58925354, "link": "https://stackoverflow.com/questions/58925354/pass-variable-from-bash-to-ruby-fastlane/58925932#58925932", "title": "Pass variable from bash to ruby (Fastlane)", "body": "<p>You should probably strip your result first: <code>check = sh('bash ./Check_Detached.sh').strip</code>.</p>\n"}], "owner": {"reputation": 5005, "user_id": 1550974, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/EH53Y.jpg?s=128&g=1", "display_name": "Khant Thu Linn", "link": "https://stackoverflow.com/users/1550974/khant-thu-linn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574131762, "creation_date": 1574126821, "question_id": 58925354, "link": "https://stackoverflow.com/questions/58925354/pass-variable-from-bash-to-ruby-fastlane", "title": "Pass variable from bash to ruby (Fastlane)", "body": "<p>I have simple bash function like this.</p>\n\n<pre><code>jq -e '.expo.isDetached' &lt;app.json\n</code></pre>\n\n<p>I call that sh file in my ruby (Fastlane) like this.</p>\n\n<pre><code>check = sh('bash ./Check_Detached.sh')\nputs(check)\n</code></pre>\n\n<p>If I print check, it is 'true'.</p>\n\n<p>But if I check 'true' or something, it is never correct.</p>\n\n<pre><code>if check == 'true'\n</code></pre>\n\n<p>I think the way how I pass variable from bash function to ruby (Fastlane) is wrong. How shall I do?</p>\n"}, {"tags": ["ruby", "shopify", "liquid"], "comments": [{"owner": {"reputation": 237, "user_id": 11646984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ff6640b5cae830884c696847f80d67?s=128&d=identicon&r=PG&f=1", "display_name": "someoneuseless", "link": "https://stackoverflow.com/users/11646984/someoneuseless"}, "edited": false, "score": 0, "creation_date": 1574130361, "post_id": 58925191, "comment_id": 104112625, "body": "I think this is a liquid code more than a js problem, you might want to change liquid code in product-template. But change like that will be quite complicate since if Blue had size 9, 11 I believe you will still see option 9, 11 with Red"}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 5595104, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh6.googleusercontent.com/-9rh5WaKU_VQ/AAAAAAAAAAI/AAAAAAAAABY/ZNlfJuumvUE/photo.jpg?sz=128", "display_name": "jonhendrix", "link": "https://stackoverflow.com/users/5595104/jonhendrix"}, "is_accepted": false, "score": 0, "last_activity_date": 1592468914, "last_edit_date": 1592468914, "creation_date": 1592405832, "answer_id": 62431986, "question_id": 58925191, "link": "https://stackoverflow.com/questions/58925191/shopify-hide-unavailable-option-variants/62431986#62431986", "title": "Shopify Hide unavailable option variants", "body": "<p>I've just spend most of the day on this, and have come up with the following, which seems to work nicely on the site I'm developing. </p>\n\n<p>The answer I came up with involves editing the assets/theme.js file. At present, the code below <strong>disables</strong> the select options which are not relevant by checking them against the available variant combinations, but you could easily adapt the below to hide them and then show them instead with CSS. </p>\n\n<p><strong>assets/theme.js</strong></p>\n\n<ol>\n<li>The _hideUnavailableOptions method below needs to be added to the Variants.prototype object.</li>\n<li><p>You then need to call the method from two different places, see below.</p>\n\n<pre><code>_hideUnavailableOptions: function() {\n  const option1 = document.getElementById(\"SingleOptionSelector-0\");\n  const option2 = document.getElementById(\"SingleOptionSelector-1\");\nif (option2) {\n  const secondOptions = option2.options;      \n  const variants = this.product.variants;\n  let possibles = [];\n  variants.forEach((variant) =&gt; {\n    if (variant.options.includes(option1.value)) {\n    possibles.push(variant.options)\n  }\n })\n for (let option of secondOptions) {\n    const value = option.value;\n    let flag = false;\n    possibles.forEach((possible) =&gt; {\n     if (possible.includes(value)) {\n     flag = true;\n    }\n  })\n  if (flag === false) {\n    option.removeAttribute('selected');\n    option.setAttribute('disabled', 'disabled');\n  } else {\n   option.removeAttribute('disabled');\n  }\n } option2.querySelector(':not([disabled=\"disabled\"])').setAttribute('selected', 'selected');\n }\n},\n</code></pre></li>\n</ol>\n\n<p>Call the method as follows:</p>\n\n<pre><code>function Variants(options) {\n\n  //stuff before this, then...\n\n  this.enableHistoryState = options.enableHistoryState;\n  this._hideUnavailableOptions();  //N.B. this MUST be before the next line\n  this.currentVariant = this._getVariantFromOptions(); \n}\n</code></pre>\n\n<p>...and again, call the method from Variants.prototype._onSelectChange() - make sure it's the first line in there...</p>\n\n<pre><code>_onSelectChange: function() {\n    let hideUnavailable = this._hideUnavailableOptions(); //N.B. this MUST be before the next line\n    var variant = this._getVariantFromOptions();\n\n    //lots more stuff follows...\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6331750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/744cf7b8bb4132146b3fb87adfedb6a2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Jackson", "link": "https://stackoverflow.com/users/6331750/peter-jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 602, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592468914, "creation_date": 1574125188, "question_id": 58925191, "link": "https://stackoverflow.com/questions/58925191/shopify-hide-unavailable-option-variants", "title": "Shopify Hide unavailable option variants", "body": "<p>Using the Debut theme in Shopify, I have a product with variants that are not compatible. At present they show as unavailable but I want to hide them totally so that only valid options show with each other. So as example if I have Red, Blue, Green shoes and have sizes 9,10,11. But can only get Red shoes in Size 10. I don't want to see options for 9 or 11 ever.</p>\n\n<p>Online someone pointed to theme.js and the code below, but I'm not sure what to change.</p>\n\n<p>Thanks</p>\n\n<pre><code>$(this.singleOptionSelector, this.$container).on(\n  'change',\n  this._onSelectChange.bind(this)\n);\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["ruby", "amazon-s3", "aws-sdk", "aws-sdk-ruby"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3727304, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000782662539/picture?type=large", "display_name": "bluedisk", "link": "https://stackoverflow.com/users/3727304/bluedisk"}, "is_accepted": false, "score": 0, "last_activity_date": 1588146249, "creation_date": 1588146249, "answer_id": 61496666, "question_id": 58922392, "link": "https://stackoverflow.com/questions/58922392/stub-response-for-aws-s3-ruby-sdk/61496666#61496666", "title": "Stub response for AWS S3 Ruby SDK", "body": "<p>make a stub_responses using list_objects_v2, not list_objects\nit'll work</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    s3_client = Aws::S3::Client.new(stub_responses: true)\n    stubbed_objs = {\n      contents: [\n        { key: 'image.jpeg' },\n        { key: 'test/image.jpeg' },\n        { key: 'test/backup_2019-03-01T143129.sql.gz' },\n        { key: 'test/backup_2019-04-01T143129.sql.gz' },\n        { key: 'test/backup_2019-05-01T143129.sql.gz' },\n        { key: 'test/image2.jpeg' },\n        { key: 'backup_2019-06-01T143129.sql.gz' },\n        { key: 'backup_2019-07-01T143129.sql.gz' },\n        { key: 'backup_2019-08-01T143129.sql.gz' }\n      ]\n    }\n    s3_client.stub_responses(:list_objects_v2, stubbed_objs)\n</code></pre>\n"}], "owner": {"reputation": 973, "user_id": 3462026, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/583615379/picture?type=large", "display_name": "Fdo", "link": "https://stackoverflow.com/users/3462026/fdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1588146249, "creation_date": 1574108726, "question_id": 58922392, "link": "https://stackoverflow.com/questions/58922392/stub-response-for-aws-s3-ruby-sdk", "title": "Stub response for AWS S3 Ruby SDK", "body": "<p>I'm looking for a way to test my code that relies on AWS S3. I found the <a href=\"https://aws.amazon.com/blogs/developer/advanced-client-stubbing-in-the-aws-sdk-for-ruby-version-3/\" rel=\"nofollow noreferrer\">Advanced Client Stubbing tutorial</a> but I was only able to find the correct way to stub <code>list_objects</code> from the <code>Aws::S3::Client</code> directly.</p>\n\n<p>I don't want to refactor my code because I'm using the SDK with <code>Aws::S3::Resource</code> (a more OOP way):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>s3_resource = Aws::S3::Resource.new(options)\nobjs = s3_resource.bucket(bucket_name).objects\n</code></pre>\n\n<p>The only way to successfully get the stubbed response I've been able to find so far is:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>s3_client = Aws::S3::Client.new(stub_responses: true)\nstubbed_objs = {\n  contents: [\n    { key: 'image.jpeg' },\n    { key: 'test/image.jpeg' },\n    { key: 'test/backup_2019-03-01T143129.sql.gz' },\n    { key: 'test/backup_2019-04-01T143129.sql.gz' },\n    { key: 'test/backup_2019-05-01T143129.sql.gz' },\n    { key: 'test/image2.jpeg' },\n    { key: 'backup_2019-06-01T143129.sql.gz' },\n    { key: 'backup_2019-07-01T143129.sql.gz' },\n    { key: 'backup_2019-08-01T143129.sql.gz' }\n  ]\n}\ns3_client.stub_responses(:list_objects, stubbed_objs)\nres = s3_client.list_objects({ bucket: \"examplebucket\" })\n\n# Check the stubbed response\nres.contents.map(&amp;:key)\n# =&gt; [\"image.jpeg\", \"test/image.jpeg\", \"test/backup_2019-03-01T143129.sql.gz\", \"test/backup_2019-04-01T143129.sql.gz\", \"test/backup_2019-05-01T143129.sql.gz\", \"test/image2.jpeg\", \"backup_2019-06-01T143129.sql.gz\", \"backup_2019-07-01T143129.sql.gz\", \"backup_2019-08-01T143129.sql.gz\"]\n</code></pre>\n\n<p>I've tried passing the <code>Aws::S3::Client</code> to the <code>Aws::S3::Resource</code> initializer, but I'm not getting the response objects from the stubs:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>s3_client = Aws::S3::Client.new(stub_responses: true)\n\n...\n\ns3_resource = Aws::S3::Resource.new({ client: s3_client })\nobjs = s3_resource.bucket(bucket_name).objects\n# =&gt; Returns 0 objects\n</code></pre>\n\n<p>I'm thinking <code>s3_resource.bucket(bucket_name).objects</code> makes multiple calls and that's why it's failing, or maybe the stubbed response format is different when using a <code>Aws::S3::Resource</code> vs direct <code>Aws::S3::Client</code> call. </p>\n\n<p>Either way, any help with this is appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "edited": false, "score": 0, "creation_date": 1574119385, "post_id": 58924353, "comment_id": 104110300, "body": "thank you. that&#39;s much cleaner than what I came up with. I realize I forgot to include some code in my question. resulted in downvotes."}], "tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": true, "score": 1, "last_activity_date": 1574119113, "creation_date": 1574119113, "answer_id": 58924353, "question_id": 58922320, "link": "https://stackoverflow.com/questions/58922320/ruby-on-rails-create-array-from-activerecord-query/58924353#58924353", "title": "Ruby on Rails : create array from activerecord query", "body": "<p>You can do something like:</p>\n\n<pre><code>properties.group_by(&amp;:user).each do |user,  properties|\n  UserMailer.send_email(user, properties).deliver_later\nend\n</code></pre>\n\n<p>In each iteration you will have user and array of user's properties.</p>\n"}], "owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 58924353, "answer_count": 1, "score": 0, "last_activity_date": 1574119113, "creation_date": 1574108455, "last_edit_date": 1574119051, "question_id": 58922320, "link": "https://stackoverflow.com/questions/58922320/ruby-on-rails-create-array-from-activerecord-query", "title": "Ruby on Rails : create array from activerecord query", "body": "<p>I have a query to find properties by a certain criteria. I'm including the Users table in the query so I can have access to the property owner (user_id) and send them an email about the property.</p>\n\n<pre><code>@testproperties.users.each do |property|\n  UserMailer.with(property: property, user: property.user).check_listing.deliver\n  property.update_columns(property_reminder_date: Time.now )\nend\n</code></pre>\n\n<p>This works fine, except since I'm looping through properties, if a user has more than 1 property, they will receive X amount of emails. I want to bundle this by users.</p>\n\n<p>So if a user has 2 properties, I want to send the mailer the user and their multiple properties. they will receive 1 email instead of two. and the email view will be fed an array of properties.</p>\n\n<p>But I'm not sure how to do this. I need to loop over users and have their properties connected to them. </p>\n\n<p>Edit:</p>\n\n<p>if I do a query like:</p>\n\n<pre><code>      @testusers = User.joins(:properties)\n      .where(\"properties.updated_at &lt; :date\", date: 30.days.ago)\n      .where(\"properties.property_reminder_date &lt; :date OR properties.property_reminder_date IS NULL\", date: 30.days.ago)\n      .where('properties.id NOT IN (SELECT DISTINCT(property_id) FROM transactions)')\n</code></pre>\n\n<p>This will give me the users I need to email to, however, accessing each user's properties shows ALL properties rather than the ones I need based on my SQL queries.</p>\n\n<p>Edit again:</p>\n\n<p>I was able to achieve what I wanted in a really messy way:</p>\n\n<pre><code>      @testusers = User.joins(:properties)\n      .where(\"properties.updated_at &lt; :date\", date: 30.days.ago)\n      .where(\"properties.property_reminder_date &lt; :date OR properties.property_reminder_date IS NULL\", date: 30.days.ago)\n      .where('properties.id NOT IN (SELECT DISTINCT(property_id) FROM transactions)')\n      @testusers = @testusers.uniq\n\n      @testusers.each do |user|\n        propertyList = user.properties.active.has_not_updated\n        UserMailer.with(properties: propertyList, user: user).check_listing.deliver\n        propertyList.each do |property|\n          property.update_columns(property_reminder_date: Time.now )\n        end\n      end\n</code></pre>\n\n<p>Property model:</p>\n\n<pre><code>...\n   scope :active, -&gt; { where('expires_at &gt;= ?', Time.now) }\n  scope :has_not_updated, -&gt; {active.where(\"updated_at &lt; :date\", date: 30.days.ago).where(\"property_reminder_date &lt; :date OR property_reminder_date IS NULL\", date: 30.days.ago).where('id NOT IN (SELECT DISTINCT(property_id) FROM transactions)') }\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 2958, "user_id": 3597730, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d76b8f632aeb1d920d79d7dd5ab63097?s=128&d=identicon&r=PG", "display_name": "ruby_newbie", "link": "https://stackoverflow.com/users/3597730/ruby-newbie"}, "edited": false, "score": 0, "creation_date": 1574105092, "post_id": 58921397, "comment_id": 104104366, "body": "I think this was answered here: <a href=\"https://stackoverflow.com/questions/5903589/passing-through-parameters-during-devise-login\" title=\"passing through parameters during devise login\">stackoverflow.com/questions/5903589/&hellip;</a>.  Let me know if that helps you.  If not perhaps add a bit of detail to the questions around what specifically you want to use the param for ect."}, {"owner": {"reputation": 126, "user_id": 8953049, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/df18f175aa59f31651ffc7cb7b00bcde?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/8953049/victor"}, "reply_to_user": {"reputation": 2958, "user_id": 3597730, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d76b8f632aeb1d920d79d7dd5ab63097?s=128&d=identicon&r=PG", "display_name": "ruby_newbie", "link": "https://stackoverflow.com/users/3597730/ruby-newbie"}, "edited": false, "score": 0, "creation_date": 1574105606, "post_id": 58921397, "comment_id": 104104626, "body": "@ruby_newbie Users want to share their products to facebook but a logged in user cannot see until they are logged in. Which raises another problem about the OpenGraph for facebook not being able to see the title of product. My goal is when I share, to pass a param, and then when facebook redirects it uses that param and I do a db look up and fill In the OG tags."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1574105939, "post_id": 58921397, "comment_id": 104104818, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. It&#39;s important to show us what you tried, and tell us why it didn&#39;t work. We also need just enough code to reproduce the problem in the question itself."}, {"owner": {"reputation": 2958, "user_id": 3597730, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d76b8f632aeb1d920d79d7dd5ab63097?s=128&d=identicon&r=PG", "display_name": "ruby_newbie", "link": "https://stackoverflow.com/users/3597730/ruby-newbie"}, "edited": false, "score": 0, "creation_date": 1574106370, "post_id": 58921397, "comment_id": 104105010, "body": "You should be able to infer the answer from the other question I linked.  If not, read the Tin Man&#39;s link and reformat the question accordingly."}, {"owner": {"reputation": 126, "user_id": 8953049, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/df18f175aa59f31651ffc7cb7b00bcde?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/8953049/victor"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574106470, "post_id": 58921397, "comment_id": 104105052, "body": "@theTinMan The question is how to get something to redirect using Devise to also pass in parameters. Note: I do not manually specify &quot;redirect_to&quot;, the system does it automatically."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1574185995, "post_id": 58921397, "comment_id": 104138663, "body": "<a href=\"https://github.com/plataformatec/devise/wiki/How-To:-Redirect-back-to-current-page-after-sign-in,-sign-out,-sign-up,-update\" rel=\"nofollow noreferrer\">github.com/plataformatec/devise/wiki/&hellip;</a>"}], "owner": {"reputation": 126, "user_id": 8953049, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/df18f175aa59f31651ffc7cb7b00bcde?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/8953049/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574106271, "creation_date": 1574104525, "last_edit_date": 1574106271, "question_id": 58921397, "link": "https://stackoverflow.com/questions/58921397/how-to-use-redirection-with-parameters-with-devise-authentication-in-rails", "title": "How to use redirection with parameters with Devise authentication in Rails", "body": "<p>A user can share a link in their profile and if a person is not logged in it will redirect them to the login page - this is working.</p>\n\n<p>I want to pass in some sort of parameter to the login page. </p>\n\n<p>For example, if the original URL is:</p>\n\n<pre><code>https://mywebsite.com/users/product/24?randomid=500\n</code></pre>\n\n<p>and the user is not logged it will redirect them to:</p>\n\n<pre><code>https://mywebsite.com/login\n</code></pre>\n\n<p>Can the parameter <code>randomid</code> get passed along, such as: </p>\n\n<pre><code>https://mywebsite.com/login&amp;?randomid=500\n</code></pre>\n\n<p>I am using Devise for the authentication and this is what the routes file looks like: </p>\n\n<pre><code>devise_for :users,\n           path: '',\n           controllers: {sessions: 'sessions'},\n           path_names: {\n               sign_in: 'login',\n               sign_out: 'logout',\n               sign_up: 'signup'\n   }\n</code></pre>\n\n<p>I don't specify the redirection manually, it does it automatically.</p>\n"}, {"tags": ["javascript", "html", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574107535, "post_id": 58920620, "comment_id": 104105510, "body": "Welcome to Stack Overflow! A couple things... we don&#39;t care what your experience level is, we just want well-researched and well-asked questions, that show that you put in the preliminary effort to try to solve it. So, don&#39;t apologize, just do your work up front. Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot; as it explains exactly how to do those things."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 1878664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21f53cfa409da80640e8f3a6e50b3691?s=128&d=identicon&r=PG", "display_name": "Tensai", "link": "https://stackoverflow.com/users/1878664/tensai"}, "is_accepted": false, "score": 0, "last_activity_date": 1574124715, "creation_date": 1574124715, "answer_id": 58925115, "question_id": 58920620, "link": "https://stackoverflow.com/questions/58920620/how-to-adjust-javascript-for-modal-window/58925115#58925115", "title": "How to adjust JavaScript for modal window", "body": "<p><code>getElementById</code> will only ever return the first element that matches the given id. It is generally assumed that each ID given to an element is unique. That is what is happening.</p>\n\n<p>If you need to have a unique modal for each post, then you could append each id of the modal with the id of the post, this ensures they are unique.</p>\n\n<p>You should also get rid of all the global variable for <code>modal</code>, <code>button</code>, <code>span</code>, since they are only ever referencing the same element.</p>\n\n<p>Give your <code>&lt;button&gt;</code> and <code>onclick</code> attribute and call a function and pass in the unique id of the post, that should let you locate all the appropriate elements for that post.</p>\n\n<p><code>&lt;button id=\"myBtn_&lt;%= post.id %&gt;\" onclick=\"showModal(&lt;%= post.id %&gt;);\"&gt;Open Modal&lt;/button&gt;</code></p>\n\n<pre><code>function showModal(id) {\n  var modal = document.getElementById(\"myModal_\" + id);\n  var btn = document.getElementById(\"myBtn_\" + id);\n  // show your modal and anything else that happens on click\n}\n</code></pre>\n\n<p>You should update <code>span</code> to be similarly selectable instead of just having a class.</p>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 11, "user_id": 12393171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tuOZa.jpg?s=128&g=1", "display_name": "Frey", "link": "https://stackoverflow.com/users/12393171/frey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574124715, "creation_date": 1574100862, "last_edit_date": 1574107409, "question_id": 58920620, "link": "https://stackoverflow.com/questions/58920620/how-to-adjust-javascript-for-modal-window", "title": "How to adjust JavaScript for modal window", "body": "<p>I need to  make a modal window appear when I click on the button. I wrote a post view and added a button and a W3Schools <a href=\"https://www.w3schools.com/howto/howto_css_modals.asp\" rel=\"nofollow noreferrer\">script</a> to display the modal window. It turned out something like:</p>\n\n<pre><code>&lt;% @posts.each do |post| %&gt;\n       &lt;div class=\"row\"&gt;\n         &lt;div class=\"leftcolumn\"&gt;\n           &lt;div class=\"card\"&gt;\n         &lt;h2 lang=\"ru\"&gt;&lt;%= post.title %&gt;&lt;/h2&gt;\n         &lt;p lang=\"ru\"&gt;&lt;%= post.body %&gt;&lt;/p&gt;\n         &lt;button id=\"myBtn\"&gt;Open Modal&lt;/button&gt; &lt;!-- taken from the site --&gt;\n\n         &lt;!-- The Modal --&gt;\n         &lt;div id=\"myModal\" class=\"modal\"&gt;\n\n           &lt;!-- Modal content --&gt;\n           &lt;div class=\"modal-content\"&gt;\n             &lt;span class=\"close\"&gt;&amp;times;&lt;/span&gt;\n             &lt;p&gt;&lt;%= post.translation %&gt;&lt;/p&gt;\n           &lt;/div&gt;\n\n         &lt;/div&gt;\n       &lt;/div&gt;\n     &lt;/div&gt;\n   &lt;/div&gt;\n &lt;% end %&gt;\n\n &lt;script&gt;\n     // Get the modal\n     var modal = document.getElementById(\"myModal\");\n\n     // Get the button that opens the modal\n     var btn = document.getElementById(\"myBtn\");\n\n     // Get the &lt;span&gt; element that closes the modal\n     var span = document.getElementsByClassName(\"close\")[0];\n\n     // When the user clicks on the button, open the modal\n     btn.onclick = function () {\n         modal.style.display = \"block\";\n     }\n\n     // When the user clicks on &lt;span&gt; (x), close the modal\n     span.onclick = function () {\n         modal.style.display = \"none\";\n     }\n\n     // When the user clicks anywhere outside of the modal, close it\n     window.onclick = function (event) {\n         if (event.target == modal) {\n             modal.style.display = \"none\";\n         }\n     }\n &lt;/script&gt;\n</code></pre>\n\n<p>Everything works fine, but only for the very first post. The script processes only the very first button. I think I know why this happens, but how do I fix it? It seems that <code>getElementById</code> is taken here when creating variables.</p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "selenium-chromedriver", "rubymine"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1574101519, "post_id": 58920198, "comment_id": 104102736, "body": "I hope you figure out a good solution. If you need an immediate workaround you can call <code>loop { sleep 1 }</code> to prevent the program from ending."}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1574130703, "post_id": 58920198, "comment_id": 104112699, "body": "Welcome to SO. Please take the time to read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It will help you craft solid questions that will hopefully get useful answers.  Interesting issue to solve, but it feels like you are trading one set of problems for another IMHO."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1574132458, "post_id": 58920198, "comment_id": 104113030, "body": "@orde his questions are pretty clear. He can&#39;t be more clearer than this."}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1574132687, "post_id": 58920198, "comment_id": 104113082, "body": "OK...so post an answer :)"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1574134883, "post_id": 58920198, "comment_id": 104113567, "body": "Yes, I am going to post an answer."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1574137467, "post_id": 58920198, "comment_id": 104114121, "body": "@rvanderclute I posted the question here in WATIR(which is a wrapper for ruby selenium binding). I have had the solution for this problem but it&#39;s not working now. Please see my question here <code>https:&#47;&#47;stackoverflow.com&#47;questions&#47;58926616&#47;chrome-detach-o&zwnj;&#8203;ption-is-no-longer-w&zwnj;&#8203;orking</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 0, "last_activity_date": 1574219428, "creation_date": 1574219428, "answer_id": 58946043, "question_id": 58920198, "link": "https://stackoverflow.com/questions/58920198/selenium-webdriver-in-ruby-preventing-the-test-from-closing-the-browser-window/58946043#58946043", "title": "Selenium WebDriver in Ruby: Preventing the test from closing the browser window at end", "body": "<p>@JustinKo has posted an answer here</p>\n\n<p><a href=\"https://stackoverflow.com/questions/58926616/chrome-detach-option-is-no-longer-working/58935849#58935849\">Chrome detach option is no longer working</a></p>\n\n<p>You can pass Chrome Options using the following format:</p>\n\n<pre><code>    browser = Watir::Browser.new(\n      :chrome,\n      'goog:chromeOptions' =&gt; {detach: true}\n    )\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12392993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c06dd3628b6093fef75ac08253c1984?s=128&d=identicon&r=PG&f=1", "display_name": "rvanderclute", "link": "https://stackoverflow.com/users/12392993/rvanderclute"}, "edited": false, "score": 0, "creation_date": 1574437132, "post_id": 58976707, "comment_id": 104245156, "body": "hmmm, this one is not working for me either. See above example code, now that I have even the vaguest idea to show."}, {"owner": {"reputation": 3, "user_id": 12392993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c06dd3628b6093fef75ac08253c1984?s=128&d=identicon&r=PG&f=1", "display_name": "rvanderclute", "link": "https://stackoverflow.com/users/12392993/rvanderclute"}, "edited": false, "score": 0, "creation_date": 1574438399, "post_id": 58976707, "comment_id": 104245818, "body": "But thank you very much for posting an answer :D I did not anticipate getting any responses, and have been quite busy!"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "reply_to_user": {"reputation": 3, "user_id": 12392993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c06dd3628b6093fef75ac08253c1984?s=128&d=identicon&r=PG&f=1", "display_name": "rvanderclute", "link": "https://stackoverflow.com/users/12392993/rvanderclute"}, "edited": false, "score": 0, "creation_date": 1574438794, "post_id": 58976707, "comment_id": 104246014, "body": "@rvanderclute, the code you listed is different. It has &quot;goog:chrome_options&quot; where it needs to be &quot;goog:chromeOptions&quot;. Can you try again?"}, {"owner": {"reputation": 3, "user_id": 12392993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c06dd3628b6093fef75ac08253c1984?s=128&d=identicon&r=PG&f=1", "display_name": "rvanderclute", "link": "https://stackoverflow.com/users/12392993/rvanderclute"}, "edited": false, "score": 0, "creation_date": 1574452555, "post_id": 58976707, "comment_id": 104252183, "body": "hahahahahahaha that worked!! thank you so much :D I tend to get crosseyed sometimes."}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 1, "last_activity_date": 1574344788, "creation_date": 1574344788, "answer_id": 58976707, "question_id": 58920198, "link": "https://stackoverflow.com/questions/58920198/selenium-webdriver-in-ruby-preventing-the-test-from-closing-the-browser-window/58976707#58976707", "title": "Selenium WebDriver in Ruby: Preventing the test from closing the browser window at end", "body": "<p>You can use the <code>:desired_capabilities</code> to set this flag:</p>\n\n<pre><code>caps = Selenium::WebDriver::Remote::Capabilities.chrome(\"goog:chromeOptions\" =&gt; {detach: true})\ndriver = Selenium::WebDriver.for :chrome, desired_capabilities: caps\n</code></pre>\n\n<p>Note that old examples will be using \"chromeOptions\", but for newer Chrome versions, it will need to be \"goog:chromeOptions\".</p>\n"}], "owner": {"reputation": 3, "user_id": 12392993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c06dd3628b6093fef75ac08253c1984?s=128&d=identicon&r=PG&f=1", "display_name": "rvanderclute", "link": "https://stackoverflow.com/users/12392993/rvanderclute"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 701, "favorite_count": 0, "accepted_answer_id": 58976707, "answer_count": 2, "score": 0, "last_activity_date": 1574452629, "creation_date": 1574098899, "last_edit_date": 1574452629, "question_id": 58920198, "link": "https://stackoverflow.com/questions/58920198/selenium-webdriver-in-ruby-preventing-the-test-from-closing-the-browser-window", "title": "Selenium WebDriver in Ruby: Preventing the test from closing the browser window at end", "body": "<p>I appear to be having the exact <em>opposite</em> problem many other people have - in that my Selenium tests in Ruby will close the browser window at test end, no matter what the end result is. Pass or fail, it will always close the browser. I would like to stop this.</p>\n\n<p>Context:</p>\n\n<p>Previously I coded tests in Java using IntelliJ IDEA. Browser windows for Selenium tests in this case would NOT close at all period unless you used driver.quit(). This is actually quite useful as it means that the browser window would stay open if the test failed - which meant I could look at where it stopped in the browser and help figure out why it failed. This was also useful for test <em>writing</em> as it meant that I could essentially pick up where I left off to write the next block instead of having to keep a parallel tab going in another browser by hand to get the next set of selectors in the given screen.</p>\n\n<p>I've found in Ruby using RubyMine that the browser will close when the test ends in any capacity. This is a bit of a problem. While technically I could take a screencap on failure, it'd mean that I'd have a harder time retracing why it failed (back button on browser, typing in fields to work out if a quirk in our UI caused it, etc). And of course, screencaps take up hard drive space. ;)</p>\n\n<p>I've tried the detach=true (and True) command switch for Chrome and that has not worked.</p>\n\n<p>Setup:</p>\n\n<ul>\n<li>IDE: RubyMine</li>\n<li>Gems: selenium-webdriver</li>\n<li>Browser: Chrome, using ChromeDriver. (In Ruby this just involves using WebDriver)</li>\n<li>OS: OSX</li>\n</ul>\n\n<p>Not headless, using no other frameworks/testing environments. It is quite literally a few lines of setup and then hitting the run button in RubyMine in a bog-standard .rb.</p>\n\n<p>Summary:</p>\n\n<p>I haven't been able to find any existing questions here or in other places online for Ruby specifically for keeping a Selenium test in RubyMine from closing the window on test end. \"Test end\" in this case refers to success (reaching the end of the .rb) or failure (Tracebacks, in this case). I would prefer that the window would stay open until it'd hit a driver.quit line. Is there any way I can set this up? </p>\n\n<p>Thank you very much. I hope this isn't redundant. I also hope this will help other testers in the future :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 1509089, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7149dfb87c431b32c449adaf0f4da892?s=128&d=identicon&r=PG", "display_name": "Patrick A.", "link": "https://stackoverflow.com/users/1509089/patrick-a"}, "edited": false, "score": 0, "creation_date": 1574096784, "post_id": 58919571, "comment_id": 104100540, "body": "Thank you, that worked. Intuitively, you would think you need the file to exist. But you do not. That was the trick, thank you."}], "tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": true, "score": 1, "last_activity_date": 1574096430, "creation_date": 1574096430, "answer_id": 58919571, "question_id": 58919395, "link": "https://stackoverflow.com/questions/58919395/rails-3-redirect-a-public-file-to-an-external-path/58919571#58919571", "title": "Rails 3 redirect a public file to an external path", "body": "<p>Add a route:</p>\n\n<pre><code>get 'publicfile.html', to: redirect('https://someonelsesste.com/publicfile.html')\n</code></pre>\n\n<p><a href=\"https://guides.rubyonrails.org/routing.html#redirection\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/routing.html#redirection</a></p>\n\n<p>Make sure you DON'T have that <code>publicfile.html</code> file on your public folder, or it will be served before reaching the router.</p>\n"}], "owner": {"reputation": 93, "user_id": 1509089, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7149dfb87c431b32c449adaf0f4da892?s=128&d=identicon&r=PG", "display_name": "Patrick A.", "link": "https://stackoverflow.com/users/1509089/patrick-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 58919571, "answer_count": 1, "score": 0, "last_activity_date": 1574146987, "creation_date": 1574095851, "last_edit_date": 1574146987, "question_id": 58919395, "link": "https://stackoverflow.com/questions/58919395/rails-3-redirect-a-public-file-to-an-external-path", "title": "Rails 3 redirect a public file to an external path", "body": "<p>Using Rails 3 and Ruby 1.9.3, I'm trying to redirect a file in my public folder to an external URL.</p>\n\n<p>This is because this file is going to be managed by another party.</p>\n\n<p>I'm unsure how to accomplish this.</p>\n\n<p>But I need for a file like this:</p>\n\n<pre><code>mysite.com/publicfile.html\n</code></pre>\n\n<p>to redirect to:</p>\n\n<pre><code>someoneelsessite.com/publicfile.html\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubocop"], "comments": [{"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 0, "creation_date": 1574094810, "post_id": 58918904, "comment_id": 104099486, "body": "I&#39;ve set as table (coping and paste how you say there) and it works for me. Maybe is something with your .rubocop.yml. And even reading rubocop documentation it should generate that. I&#39;ve tried with ruby 2.6.3 and rubocop version 0.76.0"}, {"owner": {"reputation": 133, "user_id": 9274947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18477a9ff9523f04783fdac2dca5b5a7?s=128&d=identicon&r=PG&f=1", "display_name": "kaimcg", "link": "https://stackoverflow.com/users/9274947/kaimcg"}, "reply_to_user": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 0, "creation_date": 1574095281, "post_id": 58918904, "comment_id": 104099766, "body": "Thanks for the reply. We are on ruby 2.3.7 which could be the cause."}, {"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 1, "creation_date": 1574095632, "post_id": 58918904, "comment_id": 104099940, "body": "I&#39;ve tried with ruby 2.3.7 and rubocop 0.76.0 and it also works (I also like this format so I will add to my project ^^)"}, {"owner": {"reputation": 133, "user_id": 9274947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18477a9ff9523f04783fdac2dca5b5a7?s=128&d=identicon&r=PG&f=1", "display_name": "kaimcg", "link": "https://stackoverflow.com/users/9274947/kaimcg"}, "reply_to_user": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 1, "creation_date": 1574096789, "post_id": 58918904, "comment_id": 104100543, "body": "Would you be able to share your rubocop.yml with me?"}, {"owner": {"reputation": 133, "user_id": 9274947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18477a9ff9523f04783fdac2dca5b5a7?s=128&d=identicon&r=PG&f=1", "display_name": "kaimcg", "link": "https://stackoverflow.com/users/9274947/kaimcg"}, "reply_to_user": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 1, "creation_date": 1574099500, "post_id": 58918904, "comment_id": 104101869, "body": "Figured it out. I am inheriting a style-guide that has EnforcedLastArgumentHashStyle: ignore_implicit but I needed to change it to   EnforcedLastArgumentHashStyle: always_inspect"}, {"owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 1, "creation_date": 1587448092, "post_id": 58918904, "comment_id": 108507485, "body": "Note that Ruby 2.3 support is being dropped, so it&#39;s about time to upgrade. :-)"}], "owner": {"reputation": 133, "user_id": 9274947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18477a9ff9523f04783fdac2dca5b5a7?s=128&d=identicon&r=PG&f=1", "display_name": "kaimcg", "link": "https://stackoverflow.com/users/9274947/kaimcg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1574094135, "creation_date": 1574094135, "question_id": 58918904, "link": "https://stackoverflow.com/questions/58918904/rubocop-enforcedcolonstyle-table-not-applying-to-method-call-with-arguments", "title": "Rubocop EnforcedColonStyle: table not applying to method call with arguments", "body": "<p>We would like rubocop to align the arguments of a method call. </p>\n\n<p>I tried using </p>\n\n<pre><code>Layout/AlignHash:\n  EnforcedColonStyle: table\n</code></pre>\n\n<p>but it's not aligning the arguments: </p>\n\n<pre><code># What it's doing\nmodel.update_all(\n  month: nil,\n  year: nil,\n  quarter: nil,\n  on: nil,\n)\n\n# What we want it to do\nmodel.update_all(\n  month:   nil,\n  year:    nil,\n  quarter: nil,\n  on:      nil,\n)\n</code></pre>\n\n<p>Any solutions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actionmailer"], "answers": [{"comments": [{"owner": {"reputation": 1020, "user_id": 5278152, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FssLuWM9mnk/AAAAAAAAAAI/AAAAAAAAC4M/yFo3atAiKJs/photo.jpg?sz=128", "display_name": "Sergio Gonzalez", "link": "https://stackoverflow.com/users/5278152/sergio-gonzalez"}, "edited": false, "score": 2, "creation_date": 1589513767, "post_id": 58920158, "comment_id": 109330862, "body": "I was in the exact same situation and this was the issue! Installed and started the redis-server service in my WSL environment and it worked. Thanks!"}], "tags": [], "owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "is_accepted": true, "score": 11, "last_activity_date": 1587141113, "last_edit_date": 1587141113, "creation_date": 1574098730, "answer_id": 58920158, "question_id": 58918869, "link": "https://stackoverflow.com/questions/58918869/ruby-on-rails-operation-now-in-progress-connect2-would-block/58920158#58920158", "title": "Ruby on Rails: Operation now in progress - connect(2) would block", "body": "<p>The production server is running Ubuntu and they already installed <code>redis-server</code>.</p>\n\n<p>I had not installed that locally. (I'm using Ubuntu through Windows WSL)</p>\n\n<pre><code>sudo apt install redis-server\n</code></pre>\n\n<p>I can now access the web interface.</p>\n"}], "owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4029, "favorite_count": 0, "accepted_answer_id": 58920158, "answer_count": 1, "score": 3, "last_activity_date": 1587141113, "creation_date": 1574094018, "last_edit_date": 1574098655, "question_id": 58918869, "link": "https://stackoverflow.com/questions/58918869/ruby-on-rails-operation-now-in-progress-connect2-would-block", "title": "Ruby on Rails: Operation now in progress - connect(2) would block", "body": "<p>I'm working on a site someone else made. There is a production version.</p>\n\n<p>I'm trying to send emails to users whose properties haven't been updated in 30 days.</p>\n\n<p>Everything works until I try to use <code>deliver_later</code>. The reason I'm using <code>deliver_later</code> is because <code>deliver_now</code> results in an issue of sending too many emails per second. I'm currently using Mailtrap for testing, but I assume I will run into that sort of issue on production.</p>\n\n<p>So I opted to wait 1 second for each email:</p>\n\n<pre><code>      @testproperties = Property.has_not_updated.includes(:user)\n      @testproperties.each do |property|\n          UserMailer.with(property: property, user: property.user).check_listing.deliver_later(wait:1.seconds)\n      end\n</code></pre>\n\n<p>This results in <code>IO::EINPROGRESSWaitWritable</code> <code>Operation now in progress - connect(2) would block</code></p>\n\n<p>And nothing sends.</p>\n\n<p>I'm not sure how to solve this issue.</p>\n\n<p>Edit:\nI can see on the production site that I can visit the route /sidekiq. The routes file has this block:</p>\n\n<pre><code>  authenticate :user, lambda { |u| u.admin? } do\n    mount Sidekiq::Web =&gt; '/sidekiq'\n  end\n</code></pre>\n\n<p>I can view the web interface and see all the jobs. It's all working there. But I need to access development version running on <code>localhost:3000</code>.</p>\n\n<p>Trying to access this locally still results in:</p>\n\n<p><code>Operation now in progress - connect(2) would block</code></p>\n\n<pre><code>  #  # Socket#connect\n  def connect_nonblock(addr, exception: true)\n    __connect_nonblock(addr, exception)\n  end\nend\n</code></pre>\n\n<p>Sidekiq.rb:</p>\n\n<pre><code>require 'sidekiq'\n\nunless Rails.env.test?\n  host = 'localhost'\n  port = '6379'\n  namespace = 'sitename'\n\n  Sidekiq.configure_server do |config|\n    config.redis = { url: \"redis://#{host}:#{port}\", namespace: namespace }\n    schedule_file = \"config/schedule.yml\"\n    if File.exists?(schedule_file)\n      Sidekiq::Cron::Job.load_from_hash YAML.load_file(schedule_file)\n    end\n    config.server_middleware do |chain|\n      chain.add Sidekiq::Status::ServerMiddleware, expiration: 30.minutes\n    end\n    config.client_middleware do |chain|\n      chain.add Sidekiq::Status::ClientMiddleware, expiration: 30.minutes\n    end\n  end\n\n  Sidekiq.configure_client do |config|\n    config.redis = { url: \"redis://#{host}:#{port}\", namespace: namespace }\n    config.client_middleware do |chain|\n      chain.add Sidekiq::Status::ClientMiddleware, expiration: 30.minutes\n    end\n  end\nend\n</code></pre>\n\n<p>for cable.yml:</p>\n\n<pre><code>development:\n  adapter: async\n  url: redis://localhost:6379/1\n  channel_prefix: sitename_dev\n\ntest:\n  adapter: async\n\nproduction:\n  adapter: redis\n  url: redis://localhost:6379/1\n  channel_prefix: sitename_production\n\n</code></pre>\n"}, {"tags": ["ruby", "multidimensional-array", "hash", "rspec"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1574093420, "post_id": 58916914, "comment_id": 104098694, "body": "<i>&quot;eql actually doesn&#39;t properly compare hashes&quot;</i> that depends how you want to compare. For most scenario&#39;s this is the preferred behaviour. Since the order of key-value pairs doesn&#39;t matter in most circumstances. The <a href=\"https://ruby-doc.org/core-2.6.5/Hash.html#method-i-3D-3D\" rel=\"nofollow noreferrer\">documentation</a> states <i>&quot;Equality\u2014Two hashes are equal if they each contain the same number of keys and if each key-value pair is equal to (according to <code>Object#==</code>) the corresponding elements in the other hash.&quot;</i> But guessing by the question you also want to compare the order of the keys?"}, {"owner": {"reputation": 555, "user_id": 383678, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f97d9dab966a4ac3efa541128f08a8bc?s=128&d=identicon&r=PG", "display_name": "andser", "link": "https://stackoverflow.com/users/383678/andser"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1574095024, "post_id": 58916914, "comment_id": 104099618, "body": "Yes. I want to compare the order of hashes too."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1574096134, "post_id": 58919347, "comment_id": 104100203, "body": "Once you already use early returns, it makes sense to <code>break false</code> not <code>next false</code> to <i>indeed</i> early return."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574096218, "post_id": 58919347, "comment_id": 104100255, "body": "@AlekseiMatiushkin True, but I leave iteration up to the <code>all?</code> method, which should stop iterating upon hitting the first falsy value."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574096383, "post_id": 58919347, "comment_id": 104100336, "body": "I doubt I follow. You don\u2019t leave anything if <code>a.size != b.size</code>. And if this happened for the first key, while the hash has 1B keys, with everything else equal, <code>break</code> will return immediately, while your <code>next</code> will iterate it 1B times. I do not write ruby, and frankly, I cannot say I like ruby, but <code>break</code> from there is one of the best features ever."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574096975, "post_id": 58919347, "comment_id": 104100621, "body": "@AlekseiMatiushkin What I&#39;m trying to say is that <code>all?</code> is responsible for iteration, for this reason I&#39;m using <code>next</code> instead of <code>break</code>. It&#39;s the job of <code>all?</code> to return as soon as the first falsy value is hit. This can be seen here: <code>[1, *1..10].zip(0..10).all? { |a, b| p [a, b]; a == b }</code> where only <code>[1, 0]</code> is printed, meaning it doesn&#39;t iterate the full collection when a falsy value is hit."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574097275, "post_id": 58919347, "comment_id": 104100760, "body": "Once again. Let\u2019s say we have 2 hashes, each having a billion keys. The first key has two subkeys, of different size. Version with <code>break</code> requires 1 iteration, <code>next</code> will iterate the whole billion."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574097745, "post_id": 58919347, "comment_id": 104101013, "body": "They both would result in the same amount of iterations, since <code>all?</code> stops iterating when a falsy value is returned. If the first key has two subkeys that are different sizes <code>next false</code> also stops iteration because <code>false</code> is a falsy value, stopping the <code>all?</code> iteration. However they both would iterate all keys due to the <code>zip</code> call in there. I&#39;ll add a slightly optimized version without the use of <code>zip</code>."}, {"owner": {"reputation": 555, "user_id": 383678, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f97d9dab966a4ac3efa541128f08a8bc?s=128&d=identicon&r=PG", "display_name": "andser", "link": "https://stackoverflow.com/users/383678/andser"}, "edited": false, "score": 0, "creation_date": 1574165326, "post_id": 58919347, "comment_id": 104126490, "body": "@3limin4t0r Thanks! Interesting implementation. This code works perfect."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 1, "last_activity_date": 1574100452, "last_edit_date": 1574100452, "creation_date": 1574095701, "answer_id": 58919347, "question_id": 58916914, "link": "https://stackoverflow.com/questions/58916914/how-to-compare-two-multidimensional-hashes-regarding-to-elements-order/58919347#58919347", "title": "How to compare two multidimensional hashes regarding to elements order", "body": "<p>I would use something like this:</p>\n\n<pre><code>compare = proc do |a, b|\n  next a == b unless a.is_a?(Hash) &amp;&amp; b.is_a?(Hash)\n  next false  unless a.size == b.size\n\n  a.keys.zip(b.keys).all?(compare) &amp;&amp; a.values.zip(b.values).all?(compare)\nend\n</code></pre>\n\n<p>In the above context you can't swap out <code>proc</code> for <code>lambda</code>. Reason being that a proc implicitly does array decomposition and a lambda doesn't. (You could use <code>compare.([a, b])</code> without it breaking, which you can't do when using a lambda.)</p>\n\n<p>I'm personally a fan of guard clauses, mostly because I find them clearer than one large expression.</p>\n\n<p>This solution checks the order of both the order and values.</p>\n\n<pre><code>compare.({{a: 1, b: 2} =&gt; 1}, {{b: 2, a: 1} =&gt; 1}) #=&gt; false\ncompare.({a: {b: 2, c: 3}}, {a: {c: 3, b: 2}})     #=&gt; false\ncompare.({a: {b: 2, c: 3}}, {a: {b: 2, c: 3}})     #=&gt; true\n</code></pre>\n\n<p>ps. If you're using a Ruby version under 2.5.0 you'll have to use <code>.all?(&amp;compare)</code> instead (notice the <code>&amp;</code>).</p>\n"}], "owner": {"reputation": 555, "user_id": 383678, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f97d9dab966a4ac3efa541128f08a8bc?s=128&d=identicon&r=PG", "display_name": "andser", "link": "https://stackoverflow.com/users/383678/andser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 58919347, "answer_count": 1, "score": 0, "last_activity_date": 1574100452, "creation_date": 1574087701, "question_id": 58916914, "link": "https://stackoverflow.com/questions/58916914/how-to-compare-two-multidimensional-hashes-regarding-to-elements-order", "title": "How to compare two multidimensional hashes regarding to elements order", "body": "<p>I stuck in such problem. I have 2 hashes that I trying to compare in rspec tests:</p>\n\n<pre><code>describe 'sort tests' do\n  let(:actual) do\n    {\n      1 =&gt; { users: { 1 =&gt; { id: 1,\n                             accounts: [1],\n                             profit: 10,\n                             revenue: 1,\n                             loss: 9 },\n                      2 =&gt; { id: 2,\n                             accounts: [2, 3, 6],\n                             profit: -24,\n                             revenue: 6,\n                             loss: -30 } },\n             total_profit: -14,\n             total_revenue: 7,\n             total_loss: -21 },\n      2 =&gt; { users: { 3 =&gt; { id: 3,\n                             accounts: [4, 5],\n                             profit: 27,\n                             revenue: 9,\n                             loss: 18 } },\n             total_profit: 27,\n             total_revenue: 9,\n             total_loss: 18 }\n    }\n  end\n  let(:expected) do\n    {\n      1 =&gt; { users: { 2 =&gt; { id: 2,\n                             accounts: [2, 3, 6],\n                             profit: -24,\n                             revenue: 6,\n                             loss: -30 },\n                      1 =&gt; { id: 1,\n                             accounts: [1],\n                             profit: 10,\n                             revenue: 1,\n                             loss: 9 } },\n             total_profit: -14,\n             total_revenue: 7,\n             total_loss: -21 },\n      2 =&gt; { users: { 3 =&gt; { id: 3,\n                             accounts: [4, 5],\n                             profit: 27,\n                             revenue: 9,\n                             loss: 18 } },\n             total_profit: 27,\n             total_revenue: 9,\n             total_loss: 18 }\n    }\n  end\n\n  it 'sort' do\n    def mysort(data)\n      data.each do |_, partner|\n        partner[:users].sort_by { |_k, user| user[:loss] }.to_h\n        partner\n      end\n      data.sort_by { |_, partner| partner[:total_loss] }.to_h\n    end\n    expect(mysort(actual)).to eql expected\n    # expect(Digest::MD5.hexdigest(Marshal::dump(mysort(actual)))).to eql Digest::MD5.hexdigest(Marshal::dump(expected))\n  end\nend\n</code></pre>\n\n<p>Tests are passing. But, If I uncomment the md5 check it will raise an error that hashes are different:</p>\n\n<pre><code>expected: \"155d27d209f286fb1fc9ebeb0dcd6d3d\"\n     got: \"255df98d4fc8166d0d8ffc7227ffd351\"\n</code></pre>\n\n<p>So, eql actually doesn't properly compare hashes and there's a bug in mysort function:</p>\n\n<pre><code>def mysort(data)\n  data.each do |_, partner|\n    partner[:users] = partner[:users].sort_by { |_k, user| user[:loss] }.to_h\n    partner\n  end\n  data.sort_by { |_, partner| partner[:total_loss] }.to_h\nend\n</code></pre>\n\n<p>Now it's sorting ok, but only comparing md5 checksums helps to understand that hashes are equal or not :(</p>\n\n<p>How to compare hashes right without this hack?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-api", "google-translate"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1574087515, "post_id": 58916608, "comment_id": 104095226, "body": "Are you using a gem for the api?  If so, which one?"}, {"owner": {"reputation": 150, "user_id": 3805610, "user_type": "registered", "profile_image": "https://graph.facebook.com/1216846708/picture?type=large", "display_name": "user3805610", "link": "https://stackoverflow.com/users/3805610/user3805610"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1574087686, "post_id": 58916608, "comment_id": 104095321, "body": "@lacostenycoder Yes gem &#39;google-cloud&#39; &amp; gem &#39;google-cloud-translate&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 150, "user_id": 3805610, "user_type": "registered", "profile_image": "https://graph.facebook.com/1216846708/picture?type=large", "display_name": "user3805610", "link": "https://stackoverflow.com/users/3805610/user3805610"}, "edited": false, "score": 0, "creation_date": 1574092068, "post_id": 58918041, "comment_id": 104097904, "body": "I still have the same error ArgumentError: unknown keyword: project_id The google translate documentation is saying that it should be project not project_id.  <a href=\"https://cloud.google.com/translate/docs/quickstart-client-libraries\" rel=\"nofollow noreferrer\">cloud.google.com/translate/docs/quickstart-client-libraries</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 150, "user_id": 3805610, "user_type": "registered", "profile_image": "https://graph.facebook.com/1216846708/picture?type=large", "display_name": "user3805610", "link": "https://stackoverflow.com/users/3805610/user3805610"}, "edited": false, "score": 0, "creation_date": 1574093385, "post_id": 58918041, "comment_id": 104098679, "body": "I don&#39;t see where that documentation says anything about <code>project</code> vs <code>project_id</code>? And regardless, that documentation appears to be for the <code>v2</code> API - which I have explained above how you can hopefully keep backwards-compatible support for, without downgrading the library. That website also shows how to keep using the <code>v2</code> API, exactly as I stated above: <a href=\"https://cloud.google.com/translate/docs/reference/libraries/v2/ruby\" rel=\"nofollow noreferrer\">cloud.google.com/translate/docs/reference/libraries/v2/ruby</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 150, "user_id": 3805610, "user_type": "registered", "profile_image": "https://graph.facebook.com/1216846708/picture?type=large", "display_name": "user3805610", "link": "https://stackoverflow.com/users/3805610/user3805610"}, "edited": false, "score": 0, "creation_date": 1574093841, "post_id": 58918041, "comment_id": 104098937, "body": "Digging a little deeper actually, I see the syntax for the <code>v3</code> API has changed significantly. You can see the usage <a href=\"https://github.com/googleapis/google-cloud-ruby/blob/194aa0c6f8ebac5d36e7b96ec886daa719b5a45a/google-cloud-translate/OVERVIEW.md#translating-texts\" rel=\"nofollow noreferrer\">here</a> in the documentation."}, {"owner": {"reputation": 150, "user_id": 3805610, "user_type": "registered", "profile_image": "https://graph.facebook.com/1216846708/picture?type=large", "display_name": "user3805610", "link": "https://stackoverflow.com/users/3805610/user3805610"}, "edited": false, "score": 1, "creation_date": 1574093930, "post_id": 58918041, "comment_id": 104098990, "body": "Thanks a lot it worked with translate = Google::Cloud::Translate.new version: :v2, project_id: &quot;my_project&quot; I&#39;ll go through the documentation for V3! thanks a lot for your precious help !"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 150, "user_id": 3805610, "user_type": "registered", "profile_image": "https://graph.facebook.com/1216846708/picture?type=large", "display_name": "user3805610", "link": "https://stackoverflow.com/users/3805610/user3805610"}, "edited": false, "score": 0, "creation_date": 1574093941, "post_id": 58918041, "comment_id": 104098998, "body": "....OR, alternatively, if all else fails, you could just downgrade the library. You never actually stated (nor confirmed) that the error was caused by a library upgrade; this was my own assumption after taking the time to dig though documentation. But for future readers, this could be a vitally important piece of information to reveal."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 1, "last_activity_date": 1574091650, "last_edit_date": 1574091650, "creation_date": 1574091229, "answer_id": 58918041, "question_id": 58916608, "link": "https://stackoverflow.com/questions/58916608/rails-google-translate-api-argumenterror-unknown-keyword-project/58918041#58918041", "title": "Rails - Google Translate API : ArgumentError: unknown keyword: project", "body": "<p><code>project</code> was an alias for <code>project_id</code>. It was <a href=\"https://github.com/googleapis/google-cloud-ruby/commit/0f0990512533212cfeadea1e0d10b9e43217af09#diff-02d42d98f76560a0630fc17bc45da9c5L73\" rel=\"nofollow noreferrer\">deprecated</a> since version <a href=\"https://github.com/googleapis/google-cloud-ruby/blob/master/google-cloud-translate/CHANGELOG.md#110--2017-11-14\" rel=\"nofollow noreferrer\"><code>1.1.0</code></a> of the library.</p>\n\n<p>Your code presumably stopped working because you updated the library to <a href=\"https://rubygems.org/gems/google-cloud-translate/versions/2.0.0\" rel=\"nofollow noreferrer\">version <code>2.0.0</code></a> (or above) - since <a href=\"https://github.com/googleapis/google-cloud-ruby/commit/0f0990512533212cfeadea1e0d10b9e43217af09#diff-02d42d98f76560a0630fc17bc45da9c5R174\" rel=\"nofollow noreferrer\">here, in this PR</a>, support for the <code>project</code> parameter was fully dropped.</p>\n\n<p>To fix this error, simply rename <code>project</code> to <code>project_id</code>.</p>\n\n<p>Also take note of any other potentially-breaking changes <a href=\"https://github.com/googleapis/google-cloud-ruby/blob/master/google-cloud-translate/CHANGELOG.md#200--2019-10-28\" rel=\"nofollow noreferrer\">here, in the CHANGELOG</a>. As shown in that link, you may wish to temporarily use <code>version: :v2</code> to help ease the migration if there are further complications.</p>\n"}], "owner": {"reputation": 150, "user_id": 3805610, "user_type": "registered", "profile_image": "https://graph.facebook.com/1216846708/picture?type=large", "display_name": "user3805610", "link": "https://stackoverflow.com/users/3805610/user3805610"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 58918041, "answer_count": 1, "score": 1, "last_activity_date": 1574091650, "creation_date": 1574086690, "last_edit_date": 1574088758, "question_id": 58916608, "link": "https://stackoverflow.com/questions/58916608/rails-google-translate-api-argumenterror-unknown-keyword-project", "title": "Rails - Google Translate API : ArgumentError: unknown keyword: project", "body": "<p>I have this code that was working on my rails app that is using google Translate API, but on my last commit to heroku I got the error </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>ArgumentError: unknown keyword: project \n</code></pre>\n\n<p>It seems that my google analytics is not working neither. Don't know what is causing the error. Maybe you have a hint ? </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>translate = Google::Cloud::Translate.new project: \"my_project\"\ndescription_translation = translate.translate params[:description], to: 'en'\nupdate_attribute(:description, description_translation)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "trailblazer"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11700023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097ce507d0f4576425922c138cd1fdb?s=128&d=identicon&r=PG&f=1", "display_name": "Jessie Scinor", "link": "https://stackoverflow.com/users/11700023/jessie-scinor"}, "edited": false, "score": 0, "creation_date": 1574100160, "post_id": 58919129, "comment_id": 104102176, "body": "From the first example I receive &quot;The result is #&quot;, I inspected it with pry and here is output &quot; &lt;Result:true #&lt;Trailblazer::Context::IndifferentAccess:0x0000562ccde78358 @wrapped_options={:params=&gt;&quot;array&quot;}, @mutable_options={}, @aliases={}&gt;&quot;"}, {"owner": {"reputation": 26, "user_id": 12392079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51df5f3897c9e998501c0075b3e956c1?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Diaz", "link": "https://stackoverflow.com/users/12392079/jose-diaz"}, "reply_to_user": {"reputation": 29, "user_id": 11700023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097ce507d0f4576425922c138cd1fdb?s=128&d=identicon&r=PG&f=1", "display_name": "Jessie Scinor", "link": "https://stackoverflow.com/users/11700023/jessie-scinor"}, "edited": false, "score": 0, "creation_date": 1574101487, "post_id": 58919129, "comment_id": 104102726, "body": "So, in your operation, according to the <a href=\"http://trailblazer.to/gems/operation/2.0/#state-and-result\" rel=\"nofollow noreferrer\">docs</a> you need to write to the <code>options</code> object the result of your operation, and then use it wherever you need to.   In this case your operation could do something like <code>options[&#39;search_word&#39;] = search_word.downcase</code> and then in the template <code>The result is &lt;%= model[&#39;search_word&#39;] %&gt;</code>"}, {"owner": {"reputation": 29, "user_id": 11700023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097ce507d0f4576425922c138cd1fdb?s=128&d=identicon&r=PG&f=1", "display_name": "Jessie Scinor", "link": "https://stackoverflow.com/users/11700023/jessie-scinor"}, "edited": false, "score": 0, "creation_date": 1574102565, "post_id": 58919129, "comment_id": 104103192, "body": "In this case empty value of &#39;search_word&#39;: &lt;Result:true #&lt;Trailblazer::Context::IndifferentAccess:0x000055bd7cbdb8b8 @wrapped_options={:params=&gt;&quot;array&quot;}, @mutable_options={&quot;search_word&quot;=&gt;nil}, @aliases={}&gt; &gt;"}, {"owner": {"reputation": 29, "user_id": 11700023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097ce507d0f4576425922c138cd1fdb?s=128&d=identicon&r=PG&f=1", "display_name": "Jessie Scinor", "link": "https://stackoverflow.com/users/11700023/jessie-scinor"}, "edited": false, "score": 0, "creation_date": 1574103011, "post_id": 58919129, "comment_id": 104103405, "body": "One more question: to make some custom of this output I need to create logic in custom cell method? and then invoke it in view?"}, {"owner": {"reputation": 26, "user_id": 12392079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51df5f3897c9e998501c0075b3e956c1?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Diaz", "link": "https://stackoverflow.com/users/12392079/jose-diaz"}, "reply_to_user": {"reputation": 29, "user_id": 11700023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097ce507d0f4576425922c138cd1fdb?s=128&d=identicon&r=PG&f=1", "display_name": "Jessie Scinor", "link": "https://stackoverflow.com/users/11700023/jessie-scinor"}, "edited": false, "score": 0, "creation_date": 1574103615, "post_id": 58919129, "comment_id": 104103668, "body": "Yes, if you mean presentation logic, you can create a method in the cell and then invoke it in the template"}], "tags": [], "owner": {"reputation": 26, "user_id": 12392079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51df5f3897c9e998501c0075b3e956c1?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Diaz", "link": "https://stackoverflow.com/users/12392079/jose-diaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1574094942, "creation_date": 1574094942, "answer_id": 58919129, "question_id": 58916446, "link": "https://stackoverflow.com/questions/58916446/how-to-pass-a-return-value-of-operation-to-view/58919129#58919129", "title": "How to pass a return value of operation to view?", "body": "<p>According to the <a href=\"http://trailblazer.to/gems/cells/getting-started.html#gemscellsgetting-startedmd-343\" rel=\"nofollow noreferrer\">docs</a>, it seems like you have two options.</p>\n\n<ol>\n<li>Pass the result of your operation as the <strong>\"model\"</strong> and access it via the model variable that is accessible in the cell's template.</li>\n</ol>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    class SearchController &lt; ApplicationController\n      def index\n        search_word = params[:text]\n        if search_word.present?\n          result = Search::Operation::Show.(params: search_word)\n          render html: cell(Search::Cell::Show, result)\n        else\n          render html: cell(Search::Cell::Index)\n        end\n      end \n    end\n</code></pre>\n\n<p>And then in your template, assuming you're using ERB:</p>\n\n<pre><code>    &lt;h1&gt; Hello! &lt;/h1&gt;\n    The result is &lt;%= model %&gt;\n    &lt;a href=\"/search\"&gt;Return back&lt;/a&gt;\n</code></pre>\n\n<ol start=\"2\">\n<li>Pass the result of your operation within the context and access it through a method defined in the cell class.</li>\n</ol>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    class SearchController &lt; ApplicationController\n      def index\n        search_word = params[:text]\n        if search_word.present?\n          result = Search::Operation::Show.(params: search_word)\n          render html: cell(Search::Cell::Show, nil, result: result)\n        else\n          render html: cell(Search::Cell::Index)\n        end\n      end \n    end\n</code></pre>\n\n<p>And then in your cell class:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    module Search::Cell\n      class Show &lt; Trailblazer::Cell\n        def my_result\n          #here is the logic you need to do with your result\n          context[:result]\n        end\n      end\n    end\n</code></pre>\n\n<p>And then in your template, assuming you're using ERB:</p>\n\n<pre><code>    &lt;h1&gt; Hello! &lt;/h1&gt;\n    The result is &lt;%= my_result %&gt;\n    &lt;a href=\"/search\"&gt;Return back&lt;/a&gt;\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11700023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097ce507d0f4576425922c138cd1fdb?s=128&d=identicon&r=PG&f=1", "display_name": "Jessie Scinor", "link": "https://stackoverflow.com/users/11700023/jessie-scinor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 58919129, "answer_count": 1, "score": 0, "last_activity_date": 1574094942, "creation_date": 1574086164, "last_edit_date": 1574093064, "question_id": 58916446, "link": "https://stackoverflow.com/questions/58916446/how-to-pass-a-return-value-of-operation-to-view", "title": "How to pass a return value of operation to view?", "body": "<p>I've been spent a lot of time and still trying figure out how to pass a result(return) of operation to my view. As regarding documentation I created cell, operation and view folders inside concepts folder. I'm working with Search app, here is my cell/show.rb</p>\n\n<pre><code>module Search::Cell\n  class Show &lt; Trailblazer::Cell\n  end\nend\n</code></pre>\n\n<p>Here is view/show.rb</p>\n\n<pre><code>&lt;h1&gt; Hello! &lt;/h1&gt;\n#how to pass result here?\n&lt;a href=\"/search\"&gt;Return back&lt;/a&gt;\n</code></pre>\n\n<p>My operation/show.rb</p>\n\n<pre><code>require \"trailblazer/operation\"\n\nmodule Search::Operation\n  class Show &lt; Trailblazer::Operation\n    step    :hello_world!\n    fail    :log_error\n\n    def hello_world!(options, search_word)\n      puts \"Hello, Trailblazer!\"\n      search_word = search_word[:params]\n      search_word.downcase!\n      true\n    end\n\n    def log_error\n      p \"Some error happened!!\"\n      true\n    end\n  end\nend\n</code></pre>\n\n<p>And search_controller.rb</p>\n\n<pre><code>class SearchController &lt; ApplicationController\n  def index\n    search_word = params[:text]\n    if search_word.present?\n      Search::Operation::Show.(params: search_word)\n      render html: cell(Search::Cell::Show).()\n    else\n      render html: cell(Search::Cell::Index).()\n    end\n  end \nend\n</code></pre>\n\n<p>Which variable or method should I use to pass result from operation (hello_world! method to view? I tried different things (heard some about ctx variable also tried instance variable like in common rails app) and debugging a lot with pry and didn't solve it. Please, help me!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3775, "user_id": 5268235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lval0.jpg?s=128&g=1", "display_name": "Minato", "link": "https://stackoverflow.com/users/5268235/minato"}, "edited": false, "score": 0, "creation_date": 1574083668, "post_id": 58915535, "comment_id": 104092886, "body": "can&#39;t you use some thing like a <code>where in</code> in RoR, like <code>@some_obj = SomeModel.where(&quot;somefield in (?)&quot;, [1,2,3,4])</code>?"}, {"owner": {"reputation": 13790, "user_id": 740018, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f3fa30f9aa9c60557a2e64ac73efee30?s=128&d=identicon&r=PG", "display_name": "Leem", "link": "https://stackoverflow.com/users/740018/leem"}, "reply_to_user": {"reputation": 3775, "user_id": 5268235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lval0.jpg?s=128&g=1", "display_name": "Minato", "link": "https://stackoverflow.com/users/5268235/minato"}, "edited": false, "score": 0, "creation_date": 1574083738, "post_id": 58915535, "comment_id": 104092936, "body": "I need an answer with precondtion of raw SQL like mentioned in question. Whether using Rails API to filter out is out of the scope of my question due to legacy reasons I just have to use raw SQl difficult to explain why here.."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1574092138, "post_id": 58915535, "comment_id": 104097955, "body": "You can use ActiveRecord&#39;s <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/Quoting.html#method-i-quote\" rel=\"nofollow noreferrer\"><code>quote</code></a> to escape the strings yourself."}], "answers": [{"comments": [{"owner": {"reputation": 13790, "user_id": 740018, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f3fa30f9aa9c60557a2e64ac73efee30?s=128&d=identicon&r=PG", "display_name": "Leem", "link": "https://stackoverflow.com/users/740018/leem"}, "edited": false, "score": 0, "creation_date": 1574084141, "post_id": 58915636, "comment_id": 104093209, "body": "Tried your answer, it misses the single quotation mark. e.g. <code>(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;)</code>"}], "tags": [], "owner": {"reputation": 320, "user_id": 5335319, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U9fp3QBq450/AAAAAAAAAAI/AAAAAAAAB30/LF1pqAG9JpI/photo.jpg?sz=128", "display_name": "Denis Bolomier", "link": "https://stackoverflow.com/users/5335319/denis-bolomier"}, "is_accepted": false, "score": 0, "last_activity_date": 1574084195, "last_edit_date": 1574084195, "creation_date": 1574083519, "answer_id": 58915636, "question_id": 58915535, "link": "https://stackoverflow.com/questions/58915535/convert-my-string-to-comma-based-elements/58915636#58915636", "title": "convert my string to comma based elements", "body": "<pre><code>value_list = \"('#{my_str.split(\",\").join(\"','\")}')\"\n</code></pre>\n\n<p>But this is a very bad way to query. You better use:</p>\n\n<pre><code>Model.where(value: my_str.split(\",\"))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 3, "creation_date": 1574084769, "post_id": 58915891, "comment_id": 104093577, "body": "The word &quot;safe&quot; might giving of the wrong vibe here. Since I could still drop the database with an input like: <code>&quot;a,b&#39;); DROP DATABASE x;&quot;</code>"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 2, "creation_date": 1574084967, "post_id": 58915891, "comment_id": 104093685, "body": "Yes, good remark, changed and clarified. Exactly why I proposed to use <code>where</code> instead. But maybe the OP is well aware what kind of data the <code>my_str</code> can contain."}], "tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": false, "score": 2, "last_activity_date": 1574084824, "last_edit_date": 1574084824, "creation_date": 1574084329, "answer_id": 58915891, "question_id": 58915535, "link": "https://stackoverflow.com/questions/58915535/convert-my-string-to-comma-based-elements/58915891#58915891", "title": "convert my string to comma based elements", "body": "<p>To split the string you can just do </p>\n\n<pre><code>  my_str.split(\",\")\n  =&gt; [\"a\", \"b\", \"c\"]\n</code></pre>\n\n<p>The easiest way to use that in a query, is using <code>where</code> as follows: </p>\n\n<pre><code>  Post.where(value: my_str.split(\",\")) \n</code></pre>\n\n<p>This will just work as expected. But, I understand you want to be able to build the SQL-string yourself, so then you need to do something like </p>\n\n<pre><code>  quoted_values_str = my_str.split(\",\").map{|x| \"'#{x}'\"}.join(\",\")\n   =&gt; \"'a','b','c'\"\n  sql = \"\"SELECT * from my_table WHERE value IN (#{quoted_values_str})\"\n</code></pre>\n\n<p>Note that this is a naive approach: normally you should also escape quotes if they should be contained inside your strings, and makes you vulnerable for sql injection. Using <code>where</code> will handle all those edge cases correctly for you. </p>\n"}, {"comments": [{"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1574085056, "post_id": 58916027, "comment_id": 104093743, "body": "Should you not limit your answer to demonstrate the use of <code>join</code>? Why do we need methods? How are these relevant?"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1574086054, "post_id": 58916027, "comment_id": 104094336, "body": "I don&#39;t think this answers the question, it might be related to OP&#39;s title, but neither of the two methods you have posted bring the OP&#39;s input to the desired output (<code>&quot;a,b,c&quot;</code> =&gt; <code>&quot;(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;)&quot;</code>)"}], "tags": [], "owner": {"reputation": 2050, "user_id": 5695646, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-nEigl1xsDV4/AAAAAAAAAAI/AAAAAAAAANE/WGykpWYiogM/photo.jpg?sz=128", "display_name": "Yshmarov", "link": "https://stackoverflow.com/users/5695646/yshmarov"}, "is_accepted": false, "score": -3, "last_activity_date": 1574085391, "last_edit_date": 1574085391, "creation_date": 1574084793, "answer_id": 58916027, "question_id": 58915535, "link": "https://stackoverflow.com/questions/58915535/convert-my-string-to-comma-based-elements/58916027#58916027", "title": "convert my string to comma based elements", "body": "<p>couple of use cases:</p>\n\n<pre><code>  def full_name\n    [last_name, first_name].join(' ')\n  end\n</code></pre>\n\n<p>or</p>\n\n<pre><code>  def address_line\n      [address[:country], address[:city], address[:street], address[:zip]].join(', ')\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1574098632, "creation_date": 1574098632, "answer_id": 58920133, "question_id": 58915535, "link": "https://stackoverflow.com/questions/58915535/convert-my-string-to-comma-based-elements/58920133#58920133", "title": "convert my string to comma based elements", "body": "<p>The string can be manipulated directly; there is no need to convert it to an array, modify the array then join the elements.</p>\n\n<pre><code>str = \"a,b,c\"\n\n\"(%s)\" % str.gsub(/([^,]+)/, \"'\\\\1'\")\n  #=&gt; \"('a','b','c')\"\n</code></pre>\n\n<p>The regular expression reads, \"match one or more characters other than commas and save to capture group 1. <code>\\\\1</code> retrieves the contents of capture group 1 in the formation of <code>gsub</code>'s replacement string.</p>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 1, "last_activity_date": 1574100546, "creation_date": 1574100546, "answer_id": 58920551, "question_id": 58915535, "link": "https://stackoverflow.com/questions/58915535/convert-my-string-to-comma-based-elements/58920551#58920551", "title": "convert my string to comma based elements", "body": "<p>Under no circumstances should you reinvent the wheel for this. Rails has built-in methods for constructing SQL strings, and you should use them. In this case, you want <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Sanitization/ClassMethods.html#method-i-sanitize_sql_for_conditions\" rel=\"nofollow noreferrer\"><code>sanitize_sql_for_assignment</code></a> (aliased to <code>sanitize_sql</code>):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>my_str = \"a,b,c\"\n\nconditions = sanitize_sql([\"value IN (?)\", my_str.split(\",\")])\n# =&gt; value IN ('a','b','c')\n\nquery = \"SELECT * from my_table WHERE #{conditions}\"\n</code></pre>\n\n<p>This will give you the result you want while also protecting you from SQL injection attacks (and other errors related to badly formed SQL).</p>\n\n<p>The correct usage may depend what version of Rails you're using, but this method exists as far back as Rails 2.0 so it will definitely work even with a legacy app; just consult the docs for the version of Rails you're using.</p>\n"}], "owner": {"reputation": 13790, "user_id": 740018, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f3fa30f9aa9c60557a2e64ac73efee30?s=128&d=identicon&r=PG", "display_name": "Leem", "link": "https://stackoverflow.com/users/740018/leem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1574100546, "creation_date": 1574083231, "question_id": 58915535, "link": "https://stackoverflow.com/questions/58915535/convert-my-string-to-comma-based-elements", "title": "convert my string to comma based elements", "body": "<p>I am working on a legacy Rails project that relies on Ruby version 1.8</p>\n\n<p>I have a string looks like this:</p>\n\n<pre><code>my_str = \"a,b,c\"\n</code></pre>\n\n<p>I would like to convert it to </p>\n\n<pre><code>value_list = \"('a','b','c')\"\n</code></pre>\n\n<p>so that I can directly use it in my SQL statement like:</p>\n\n<pre><code>\"SELECT * from my_table WHERE value IN #{value_list}\"\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>my_str.split(\",\")\n</code></pre>\n\n<p>but it returns \"abc\" :(</p>\n\n<p>How to convert it to what I need?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-6"], "answers": [{"comments": [{"owner": {"reputation": 598, "user_id": 1019579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3iQz.jpg?s=128&g=1", "display_name": "bsvin33t", "link": "https://stackoverflow.com/users/1019579/bsvin33t"}, "edited": false, "score": 1, "creation_date": 1574083898, "post_id": 58915667, "comment_id": 104093046, "body": "I think, raising a custom error for the invalid object and adding an appropriate HTTP handler for the error might just allow them to avoid exposing HTTP related details to the model. WDYT?"}, {"owner": {"reputation": 1578, "user_id": 6003161, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4baeef3d0ff8d4dec06271c9b0125922?s=128&d=identicon&r=PG&f=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/6003161/pants"}, "edited": false, "score": 0, "creation_date": 1574089233, "post_id": 58915667, "comment_id": 104096228, "body": "You make a good point, however there are far more HTTP error codes than those provided. How do you suggest I then leverage that to add more HTTP codes?"}, {"owner": {"reputation": 1578, "user_id": 6003161, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4baeef3d0ff8d4dec06271c9b0125922?s=128&d=identicon&r=PG&f=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/6003161/pants"}, "edited": false, "score": 0, "creation_date": 1574089672, "post_id": 58915667, "comment_id": 104096482, "body": "EDIT to above: I also want to log these errors, so I can&#39;t really just let Rails handle the response when it catches an exception."}, {"owner": {"reputation": 19325, "user_id": 67505, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/094c0ec476b95ed7619d6a4cb918da78?s=128&d=identicon&r=PG", "display_name": "Chen Kinnrot", "link": "https://stackoverflow.com/users/67505/chen-kinnrot"}, "edited": false, "score": 0, "creation_date": 1574168558, "post_id": 58915667, "comment_id": 104128285, "body": "Raise you own errors, catch them and set the response code"}], "tags": [], "owner": {"reputation": 19325, "user_id": 67505, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/094c0ec476b95ed7619d6a4cb918da78?s=128&d=identicon&r=PG", "display_name": "Chen Kinnrot", "link": "https://stackoverflow.com/users/67505/chen-kinnrot"}, "is_accepted": false, "score": 1, "last_activity_date": 1574083603, "creation_date": 1574083603, "answer_id": 58915667, "question_id": 58915192, "link": "https://stackoverflow.com/questions/58915192/anyway-to-add-an-http-status-code-on-activerecord-validations/58915667#58915667", "title": "Anyway to add an HTTP status code on ActiveRecord validations?", "body": "<p>To do what you want, <strong>which I don't recommend</strong></p>\n\n<p>You'll need to write some extra code, the default behavior is 422, to change it, you can add code that asks what errors does the model has a respond accordingly, or figure out a way to monkey patch the built in rails code that responds with 422.</p>\n\n<p>see <a href=\"https://github.com/rails/rails/blob/41bbd7cd0e4e950ea5a366f78b26b32ed6bd0644/activerecord/lib/active_record/railtie.rb\" rel=\"nofollow noreferrer\">relevant rails code</a> line 25</p>\n\n<p>Anyway it's a bit of code smell (what you are currently trying to achieve), the model should not be aware of anything related to HTTP, so maybe the translation isn't the proper place for status codes (it wouldn't change if you are on another human spoken language)</p>\n"}], "owner": {"reputation": 1578, "user_id": 6003161, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4baeef3d0ff8d4dec06271c9b0125922?s=128&d=identicon&r=PG&f=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/6003161/pants"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574083603, "creation_date": 1574082163, "question_id": 58915192, "link": "https://stackoverflow.com/questions/58915192/anyway-to-add-an-http-status-code-on-activerecord-validations", "title": "Anyway to add an HTTP status code on ActiveRecord validations?", "body": "<p>I'm using locale to configure error messages coming from my Rails API server, was wondering if there is anyway to also attach HTTP status codes?</p>\n\n<p>For instance:</p>\n\n<p>say I have a model:</p>\n\n<p>email.rb</p>\n\n<pre><code>class Email &lt; ApplicationRecord\n  validates_presence_of :email_address\n  validates :email_address, allow_blank: true, format: { with: URI::MailTo::EMAIL_REGEXP }, uniqueness: {case_sensitive: false }\nend\n\n</code></pre>\n\n<p>I have the config set up like so:</p>\n\n<p>en.yml</p>\n\n<pre><code>en:\n  activerecord:\n    attributes:\n      email:\n        email_address: Email address\n    errors:\n      messages:\n        record_invalid: \"%{errors}\"\n        # I want to do something like this\n        blank:\n          message: is required.\n          status_code: 422\n        taken:\n          message: is already taken.\n          status_code: 409\n</code></pre>\n\n<p>Programmatically is fine too, I just want to return the appropriate HTTP status code, 422, 409, 404, 401 etc. when applicable. </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nginx", "passenger"], "answers": [{"tags": [], "owner": {"reputation": 600, "user_id": 740326, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b6be565dc21f521acf0193ee63ab9d0a?s=128&d=identicon&r=PG", "display_name": "Piotrek Oko\u0144ski", "link": "https://stackoverflow.com/users/740326/piotrek-oko%c5%84ski"}, "is_accepted": false, "score": 0, "last_activity_date": 1587494454, "creation_date": 1587494454, "answer_id": 61350768, "question_id": 58913788, "link": "https://stackoverflow.com/questions/58913788/nginxpassenger-rails-running-threads-get-killed-when-used-along-with-passenge/61350768#61350768", "title": "(Nginx+Passenger) Rails running Threads get killed when used along with passenger_max_requests setting", "body": "<p>You are using Threads incorrectly, server won't wait for a Thread to finish. If you need to perform heavy weight calculations, use background jobs. For example ActiveJob with Sidekiq.</p>\n"}], "owner": {"reputation": 302, "user_id": 8804557, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wKYuDt4B25k/AAAAAAAAAAI/AAAAAAAAAAo/hq7tT3lfEf8/photo.jpg?sz=128", "display_name": "Amogh Hegde", "link": "https://stackoverflow.com/users/8804557/amogh-hegde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1587494454, "creation_date": 1574077306, "question_id": 58913788, "link": "https://stackoverflow.com/questions/58913788/nginxpassenger-rails-running-threads-get-killed-when-used-along-with-passenge", "title": "(Nginx+Passenger) Rails running Threads get killed when used along with passenger_max_requests setting", "body": "<p>My Nginx+Passenger settings are the following:</p>\n\n<pre><code>passenger_max_pool_size 6;\npassenger_max_requests 600;\n</code></pre>\n\n<p>And in my Rails Controller i use threads to do excel imports in the following manner:</p>\n\n<pre><code>t = Thread.new do\n @json_response = Import::Admin.create_admin_user params\nend\n</code></pre>\n\n<p>The problem that i encounter is after the process serves 600 requests (which is the limit set to avoid memory leaks) it shuts down the process even if the above mentioned thread is alive and running on it.</p>\n"}, {"tags": ["ruby", "chef-infra", "cookbook"], "answers": [{"tags": [], "owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "is_accepted": false, "score": 0, "last_activity_date": 1574183215, "creation_date": 1574183215, "answer_id": 58939394, "question_id": 58913473, "link": "https://stackoverflow.com/questions/58913473/how-to-assign-a-batch-command-output-to-chef-recipe-attribute/58939394#58939394", "title": "How to Assign a batch command output to Chef recipe attribute", "body": "<p>you can run the a command as a part of the cookbook execution and assign the values to a node attributes using <a href=\"https://docs.chef.io/dsl_recipe.html#shell-out\" rel=\"nofollow noreferrer\"><code>shell_out</code></a></p>\n\n<p>for instance, it will look something like</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>ruby_block 'foo' do\n  block do\n    cmd = \"your command here\"\n    shell = Mixlib::ShellOut.new(cmd).run_command\n    stdout = shell.stdout\n    node.default['my_key'] = stdout\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9871766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/061a5a6c376f372c717286b8ef711737?s=128&d=identicon&r=PG&f=1", "display_name": "Sankareswar", "link": "https://stackoverflow.com/users/9871766/sankareswar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574183215, "creation_date": 1574076147, "question_id": 58913473, "link": "https://stackoverflow.com/questions/58913473/how-to-assign-a-batch-command-output-to-chef-recipe-attribute", "title": "How to Assign a batch command output to Chef recipe attribute", "body": "<p>I have a windows command to check the directory which is updated recently .</p>\n\n<pre><code>for /f \"delims=\" %a in (' dir C:\\Users\\Username\\cookbooks /ad /od /b ') do set \"Last=%a\";\necho %Last%;\n</code></pre>\n\n<p>I would like to assign output of above command to a Chef recipe attribute/cookbook attribute.</p>\n\n<p>I did tried to directly execute above command in a batch resource and assign output but failed.\nIs there a way to do so in Chef cookbook attribute ?</p>\n"}, {"tags": ["ruby", "github", "github-actions"], "answers": [{"tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": true, "score": 0, "last_activity_date": 1574073596, "creation_date": 1574073596, "answer_id": 58912699, "question_id": 58912698, "link": "https://stackoverflow.com/questions/58912698/github-actions-setting-gem-username-from-secrets-please-cgi-escape-your-userna/58912699#58912699", "title": "Github actions, setting gem username from secrets: Please CGI escape your usernames and passwords before setting them for authentication", "body": "<p>The ENV only needs one <code>$</code>: </p>\n\n<pre><code>bundle config gems.example.eu gems:${GEMS_PASSWORD}\n</code></pre>\n\n<p>The double <code>$</code> as copied from the previous CI's configuration was perhaps an string interpolation feature.</p>\n"}], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 58912699, "answer_count": 1, "score": 0, "last_activity_date": 1602008775, "creation_date": 1574073596, "last_edit_date": 1602008775, "question_id": 58912698, "link": "https://stackoverflow.com/questions/58912698/github-actions-setting-gem-username-from-secrets-please-cgi-escape-your-userna", "title": "Github actions, setting gem username from secrets: Please CGI escape your usernames and passwords before setting them for authentication", "body": "<p>I'm trying to setup Github actions to run our specs however we use a private gem server which requires a password. I have <a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions/creating-and-using-encrypted-secrets\" rel=\"nofollow noreferrer\">added a secret</a> and then <a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions/using-environment-variables\" rel=\"nofollow noreferrer\">set a ENV</a> to the value of the secret.</p>\n\n<p>However I get the following error from bundler:</p>\n\n<blockquote>\n  <p>\"Please CGI escape your usernames and passwords before setting them for authentication\".</p>\n</blockquote>\n\n<p>I can see there this happens in the <a href=\"https://github.com/bundler/bundler/commit/0611c4bea9a5da42f668af64ae31d7628c640c5e\" rel=\"nofollow noreferrer\">bundler source</a>. It seems to be an issue with the URI. </p>\n\n<p>I do not get this error when following the same procedure locally or on our current CI server.</p>\n\n<p>This is the workflow:</p>\n\n<pre><code>name: Ruby\n\non: [push]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v1\n    - name: Set up Ruby 2.6\n      uses: actions/setup-ruby@v1\n      with:\n        ruby-version: 2.6.x\n    - name: Build and test with RSpec\n      env:\n        gems_password: '${{ secrets.GEMS_PASSWORD }}'\n      run: |        \n        gem install bundler\n        bundle config gems.example.eu gems:$${GEMS_PASSWORD}\n        bundle install\n        bundle exec rspec\n</code></pre>\n"}, {"tags": ["ruby", "ubuntu", "rubygems", "jekyll"], "answers": [{"tags": [], "owner": {"reputation": 4449, "user_id": 7681659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bc1a3b7231505d61b7f80642bc1a14?s=128&d=identicon&r=PG&f=1", "display_name": "ashmaroli", "link": "https://stackoverflow.com/users/7681659/ashmaroli"}, "is_accepted": false, "score": 0, "last_activity_date": 1574092591, "creation_date": 1574092591, "answer_id": 58918488, "question_id": 58912631, "link": "https://stackoverflow.com/questions/58912631/jekyll-not-starting/58918488#58918488", "title": "Jekyll not starting", "body": "<p>The <code>validate_data</code> method was introduced in Jekyll 3.1.0\nSo, you'll have to update your Jekyll version.</p>\n\n<p>Moreover, Jekyll 3.0.0 was released in October 2015. There has been numerous security fixes since then. Therefore, I strongly recommend updating Jekyll to at least <code>v3.8.6</code>. You can do so by running the following command:</p>\n\n<pre><code>gem install jekyll --version 3.8.6\n</code></pre>\n\n<p>Or simply install the latest release (<code>v4.0.0</code>) by running:</p>\n\n<pre><code>gem update jekyll\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9214361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b69122220d45d58ad6f74dd4e166df92?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Kozel", "link": "https://stackoverflow.com/users/9214361/ilya-kozel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574092591, "creation_date": 1574073406, "question_id": 58912631, "link": "https://stackoverflow.com/questions/58912631/jekyll-not-starting", "title": "Jekyll not starting", "body": "<p>I use ubuntu 19.04. </p>\n\n<p>jekyll v 3.0\nWhat am I doing wrong</p>\n\n<pre><code>ilya@ilya-TM1701:~/Desktop/prsng.ru$ bundle exec jekyll s \n/var/lib/gems/2.5.0/gems/jekyll-3.0.0/lib/jekyll/hooks.rb:54: warning: constant ::Fixnum is   deprecated\nConfiguration file: /home/ilya/Desktop/prsng.ru/_config.yml\n        Source: /home/ilya/Desktop/prsng.ru\n   Destination: /home/ilya/Desktop/prsng.ru/_site\nIncremental build: disabled. Enable with --incremental\n  Generating... \n     AutoPages: Disabled/Not configured in site.config.\nbundler: failed to load command: jekyll (/usr/local/bin/jekyll)\nNoMethodError: undefined method `validate_data!' for #&lt;Jekyll:Page @name=\"index.html\"&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 7417, "user_id": 1058406, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/03646b5d15e5136fa6928eb8d7434994?s=128&d=identicon&r=PG", "display_name": "Irfan DANISH", "link": "https://stackoverflow.com/users/1058406/irfan-danish"}, "edited": false, "score": 1, "creation_date": 1574086334, "post_id": 58911948, "comment_id": 104094487, "body": "I&#39;m voting to close this question as off-topic because it is asking for solution."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 2803930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07b6f4e3ee819b13c58a8c887860328?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Garg", "link": "https://stackoverflow.com/users/2803930/ashish-garg"}, "edited": false, "score": 0, "creation_date": 1574159254, "post_id": 58912968, "comment_id": 104122957, "body": "Its not creating the output file for me."}], "tags": [], "owner": {"reputation": 541, "user_id": 12244608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rP6EG.jpg?s=128&g=1", "display_name": "TedTran2019", "link": "https://stackoverflow.com/users/12244608/tedtran2019"}, "is_accepted": false, "score": 4, "last_activity_date": 1574077570, "last_edit_date": 1574077570, "creation_date": 1574074602, "answer_id": 58912968, "question_id": 58911948, "link": "https://stackoverflow.com/questions/58911948/is-it-possible-to-create-a-single-executable-file-of-a-ruby-on-rails-project/58912968#58912968", "title": "Is it possible to create a single executable file of a Ruby on Rails project?", "body": "<p>Yes you can, using <a href=\"https://github.com/pmq20/ruby-packer\" rel=\"nofollow noreferrer\">the gem ruby-packer</a>.</p>\n\n<ul>\n<li><p>Compiling a Rails application</p>\n\n<ol>\n<li>rails new yours</li>\n<li>cd yours</li>\n<li>rubyc bin/rails</li>\n<li>./a.out server (or a.exe server on Windows)</li>\n</ol></li>\n</ul>\n"}], "owner": {"reputation": 87, "user_id": 2803930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07b6f4e3ee819b13c58a8c887860328?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Garg", "link": "https://stackoverflow.com/users/2803930/ashish-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "closed_date": 1574086334, "answer_count": 1, "score": 0, "last_activity_date": 1574077570, "creation_date": 1574071050, "last_edit_date": 1574072580, "question_id": 58911948, "link": "https://stackoverflow.com/questions/58911948/is-it-possible-to-create-a-single-executable-file-of-a-ruby-on-rails-project", "closed_reason": "Needs details or clarity", "title": "Is it possible to create a single executable file of a Ruby on Rails project?", "body": "<p>How to create a single executable file for any rails project.</p>\n"}, {"tags": ["ruby", "double-splat"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1574069887, "post_id": 58910632, "comment_id": 104085232, "body": "<code>execute(query, **abilities)</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 12290, "user_id": 228370, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a3f87affc7032e0af7cc4ce2ddb08ce9?s=128&d=identicon&r=PG", "display_name": "23tux", "link": "https://stackoverflow.com/users/228370/23tux"}, "edited": false, "score": 0, "creation_date": 1574071819, "post_id": 58911243, "comment_id": 104086331, "body": "unfortunately, I can&#39;t alter the definition of <code>#execute</code> because it&#39;s inside a gem, and I don&#39;t want to monkey patch it"}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": false, "score": 0, "last_activity_date": 1574068594, "creation_date": 1574068594, "answer_id": 58911243, "question_id": 58910632, "link": "https://stackoverflow.com/questions/58910632/make-ruby-object-respond-to-double-splat-operator/58911243#58911243", "title": "Make Ruby object respond to double splat operator **", "body": "<p>If you specify the API to <code>execute</code> in such a way that it accepts anything that supports <code>to_h</code>, then you have a solution:</p>\n\n<pre><code>def execute(query, args = {})\n  args = args.to_h\n  ...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1574071986, "creation_date": 1574071986, "answer_id": 58912190, "question_id": 58910632, "link": "https://stackoverflow.com/questions/58910632/make-ruby-object-respond-to-double-splat-operator/58912190#58912190", "title": "Make Ruby object respond to double splat operator **", "body": "<p>You can implement <code>to_hash</code>: (or define it as an alias for <code>to_h</code>)</p>\n\n<pre><code>class MyClass\n  def to_hash\n    { a: 1, b: 2 }\n  end\nend\n\ndef foo(**kwargs)\n  p kwargs: kwargs\nend\n\nfoo(MyClass.new)\n#=&gt; {:kwargs=&gt;{:a=&gt;1, :b=&gt;2}}\n</code></pre>\n"}], "owner": {"reputation": 12290, "user_id": 228370, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a3f87affc7032e0af7cc4ce2ddb08ce9?s=128&d=identicon&r=PG", "display_name": "23tux", "link": "https://stackoverflow.com/users/228370/23tux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 58912190, "answer_count": 2, "score": 1, "last_activity_date": 1574071986, "creation_date": 1574066200, "question_id": 58910632, "link": "https://stackoverflow.com/questions/58910632/make-ruby-object-respond-to-double-splat-operator", "title": "Make Ruby object respond to double splat operator **", "body": "<p>I have a library that has an <code>#execute</code> method like this</p>\n\n<pre><code>def execute(query, **args)\n  # ...\nend\n</code></pre>\n\n<p>I have a class that generates the data for <code>args</code> (which has a lot of logic depending on user abilities)</p>\n\n<pre><code>class Abilities\n  def to_h\n    { user: user } # and a lot more data\n  end\nend\n</code></pre>\n\n<p>Now when I'm using <code>#execute</code> I always have to remember to use <code>#to_h</code>, which is pretty annoying and leads to mistakes when someone forgets it:</p>\n\n<pre><code>execute(query, abilities.to_h)\n</code></pre>\n\n<p>So I was wondering if my <code>Abilities</code> class could somehow respond to the <code>**</code> (double splat) operator, so that I can simply pass the object:</p>\n\n<pre><code>execute(query, abilities)\n</code></pre>\n\n<p>When I try to call it like this, it throws an error:</p>\n\n<pre><code>ArgumentError: wrong number of arguments (given 2, expected 1)\n</code></pre>\n\n<p>So, is there any way to make my <code>Abilities</code> class behave like a <code>Hash</code>? I could derive it like this <code>Abilities &lt; Hash</code> but then I have all the Hash logic on it, which seems pretty dirty.</p>\n"}, {"tags": ["ruby", "build", "plist", "fastlane"], "comments": [{"owner": {"reputation": 470, "user_id": 10326010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PUlXC.jpg?s=128&g=1", "display_name": "rcarba", "link": "https://stackoverflow.com/users/10326010/rcarba"}, "edited": false, "score": 0, "creation_date": 1574077138, "post_id": 58910608, "comment_id": 104089365, "body": "Can you try with set_info_plist_value? <a href=\"https://docs.fastlane.tools/actions/set_info_plist_value/\" rel=\"nofollow noreferrer\">docs.fastlane.tools/actions/set_info_plist_value</a>"}, {"owner": {"reputation": 442, "user_id": 3671893, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/100001276005114/picture?type=large", "display_name": "Ansar Samad", "link": "https://stackoverflow.com/users/3671893/ansar-samad"}, "reply_to_user": {"reputation": 470, "user_id": 10326010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PUlXC.jpg?s=128&g=1", "display_name": "rcarba", "link": "https://stackoverflow.com/users/10326010/rcarba"}, "edited": false, "score": 0, "creation_date": 1574077504, "post_id": 58910608, "comment_id": 104089565, "body": "it will add a new key value on the bottom of the xml only , not updating the existing url"}, {"owner": {"reputation": 470, "user_id": 10326010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PUlXC.jpg?s=128&g=1", "display_name": "rcarba", "link": "https://stackoverflow.com/users/10326010/rcarba"}, "edited": false, "score": 0, "creation_date": 1574077694, "post_id": 58910608, "comment_id": 104089661, "body": "It updates it if it exists"}, {"owner": {"reputation": 442, "user_id": 3671893, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/100001276005114/picture?type=large", "display_name": "Ansar Samad", "link": "https://stackoverflow.com/users/3671893/ansar-samad"}, "reply_to_user": {"reputation": 470, "user_id": 10326010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PUlXC.jpg?s=128&g=1", "display_name": "rcarba", "link": "https://stackoverflow.com/users/10326010/rcarba"}, "edited": false, "score": 0, "creation_date": 1574077828, "post_id": 58910608, "comment_id": 104089741, "body": "ok , then it couldnt find the exisitng key within the items &gt; assets . while am trying the set command it add new entry on the bottom"}], "owner": {"reputation": 442, "user_id": 3671893, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/100001276005114/picture?type=large", "display_name": "Ansar Samad", "link": "https://stackoverflow.com/users/3671893/ansar-samad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574147783, "creation_date": 1574066091, "last_edit_date": 1574147783, "question_id": 58910608, "link": "https://stackoverflow.com/questions/58910608/fastlane-command-to-update-url-and-bundle-identifier", "title": "Fastlane command to update url and bundle identifier", "body": "<p>How can i update the url and bundle-identifier for the below plist using fastlane ?\nWhile using the update_info_plist command from fastlane its asking for a block , i dont understand what it is.</p>\n\n<pre><code>  &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n&lt;plist version=\"1.0\"&gt;\n&lt;dict&gt;\n    &lt;key&gt;items&lt;/key&gt;\n    &lt;array&gt;\n        &lt;dict&gt;\n            &lt;key&gt;assets&lt;/key&gt;\n            &lt;array&gt;\n                &lt;dict&gt;\n                    &lt;key&gt;kind&lt;/key&gt;\n                    &lt;string&gt;software-package&lt;/string&gt;\n                    &lt;key&gt;url&lt;/key&gt;\n                    &lt;string&gt;https://server/cache/app.ipa&lt;/string&gt;\n                &lt;/dict&gt;\n            &lt;/array&gt;\n            &lt;key&gt;metadata&lt;/key&gt;\n            &lt;dict&gt;\n                &lt;key&gt;bundle-identifier&lt;/key&gt;\n                &lt;string&gt;com.demo&lt;/string&gt;\n                &lt;key&gt;bundle-version&lt;/key&gt;\n                &lt;string&gt;1.0&lt;/string&gt;\n                &lt;key&gt;kind&lt;/key&gt;\n                &lt;string&gt;software&lt;/string&gt;\n                &lt;key&gt;title&lt;/key&gt;\n                &lt;string&gt;CavionNovus&lt;/string&gt;\n            &lt;/dict&gt;\n        &lt;/dict&gt;\n    &lt;/array&gt;\n&lt;/dict&gt;\n&lt;/plist&gt;\n</code></pre>\n"}, {"tags": ["ruby", "activerecord", "sinatra", "sinatra-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10740512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9035455bc3b1332eb87ceba73323f77e?s=128&d=identicon&r=PG&f=1", "display_name": "rTaylor", "link": "https://stackoverflow.com/users/10740512/rtaylor"}, "edited": false, "score": 0, "creation_date": 1574096490, "post_id": 58910208, "comment_id": 104100392, "body": "You look like a master at this. I&#39;m not sure how to implement this. I attempted this and did not get it to work either."}, {"owner": {"reputation": 39, "user_id": 10740512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9035455bc3b1332eb87ceba73323f77e?s=128&d=identicon&r=PG&f=1", "display_name": "rTaylor", "link": "https://stackoverflow.com/users/10740512/rtaylor"}, "edited": false, "score": 0, "creation_date": 1574146766, "post_id": 58910208, "comment_id": 104116841, "body": "I have a share, message, and user model. I&#39;ve attempted to add a few multiple user.ids to the share.user_ids in the action controller. None of these attempts are works. I&#39;m not really sure how to access the users and messages. Before I know that has_many :messages gave the user the user.messages methods."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 39, "user_id": 10740512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9035455bc3b1332eb87ceba73323f77e?s=128&d=identicon&r=PG&f=1", "display_name": "rTaylor", "link": "https://stackoverflow.com/users/10740512/rtaylor"}, "edited": false, "score": 0, "creation_date": 1574151871, "post_id": 58910208, "comment_id": 104118966, "body": "See <a href=\"https://www.sitepoint.com/master-many-to-many-associations-with-activerecord/\" rel=\"nofollow noreferrer\">sitepoint.com/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/5120703/creating-a-many-to-many-relationship-in-rails/5120734\" title=\"creating a many to many relationship in rails\">stackoverflow.com/questions/5120703/&hellip;</a>. If it doesn&#39;t help, come back with new questions :)"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1574064184, "creation_date": 1574064184, "answer_id": 58910208, "question_id": 58910060, "link": "https://stackoverflow.com/questions/58910060/active-record-has-many-messages-not-saving-records-properly/58910208#58910208", "title": "Active Record has_many :messages not saving records properly", "body": "<p>You need to have has-and-belongs-to-many relationship between users and messages to implement sharing multiple messages to multiple users. Create an additional record, e.g. <code>MessageShare</code> and do has many to it from both sides:</p>\n\n<pre><code>class MessageShare &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :message\nend\n\nclass Message &lt; ActiveRecord::Base\n  has_many :message_shares\nend\n\nclass User &lt; ActiveRecord::Base\n  has_many :message_shares\nend\n</code></pre>\n\n<p><code>message_shares</code> table should have <code>user_id</code> and <code>message_id</code> integer columns.</p>\n"}], "owner": {"reputation": 39, "user_id": 10740512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9035455bc3b1332eb87ceba73323f77e?s=128&d=identicon&r=PG&f=1", "display_name": "rTaylor", "link": "https://stackoverflow.com/users/10740512/rtaylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574064184, "creation_date": 1574063496, "last_edit_date": 1574063978, "question_id": 58910060, "link": "https://stackoverflow.com/questions/58910060/active-record-has-many-messages-not-saving-records-properly", "title": "Active Record has_many :messages not saving records properly", "body": "<p>I'm building a sinatra app with Active record. The idea is to essentially have a custom email app. Here I have the models User and Message. A <code>User has_many :messages</code> and a <code>Message belongs_to :user</code>. This may be where I have the issue. I also have it set up for a <code>Message belongs_to :user</code> and <code>has_many :users</code>. \nhere are the models  </p>\n\n<p>Now when I create a message in the action controller I am attempting to use the shove methods to put the new message in a user's messages array. If I attempt to \"share\" this message with multiple users at once with all the user's id's in <code>params( @user = User.find(id)</code> and then <code>user.messages &lt;&lt; @new_message)</code> the last user will have the message stored in it's .messages array. However only the last one to be iterated. </p>\n\n<pre><code>class Message &lt; ActiveRecord::Base\n   belongs_to :user \n   has_many :users\nend  \n</code></pre>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    validates :username, presence: true, uniqueness: true\n    has_secure_password\n    has_many :messages  \nend\n</code></pre>\n\n<p>The idea is the writer \"owns\" the message but can share it with many users. Here are the tables </p>\n\n<pre><code>class CreateUsers &lt; ActiveRecord::Migration\n  def change \n    create_table :users do |t|\n      t.string :username \n      t.string :email \n      t.string :password_digest\n    end\n  end\nend\n</code></pre>\n\n<pre><code>class CreateMessages &lt; ActiveRecord::Migration\n  def change \n    create_table :messages do |t| \n          t.string :message \n           t.string :author\n           t.integer :user_id \n           t.integer :user_ids\n           t.integer :share_id\n           t.string :title \n           t.timestamps\n  end\nend \nend\n</code></pre>\n\n<pre><code># action controller \n new_params = {}\n      new_params[:message] = params[\"message\"]\n      new_params[:title] = params[\"title\"]\n      new_params[:author] = params[\"author\"]\n      new_params[:user_id] = params[\"user_id\"] \n      @message = Message.create(new_params)\n      # @share = Share.create \n      # @message.share_id = @share.id\n      response.map do  |x| \n\n        x.messages &lt;&lt; @message \n        x.save!\n      end \n      @all = User.all \n\n      @user = User.find_by(username: @message.author) \n      erb :\"/user/sent\" \n</code></pre>\n\n<p>I am fairly sure this is because my associations are not set up properly. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "fastjsonapi"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 9136318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba32997bd40a5a809cab469bb731d16?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/9136318/rahul"}, "edited": false, "score": 0, "creation_date": 1574078996, "post_id": 58910251, "comment_id": 104090347, "body": "let say not_allowed_attributes has name and email for other roles again I need to define a block to that attribute, can it be implemented in such a way that it should check and it should attach the attribute otherwise it should not."}, {"owner": {"reputation": 1106, "user_id": 6454624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-54Cw2TNXh84/AAAAAAAAAAI/AAAAAAAAAC4/Ivxon84Rp4k/photo.jpg?sz=128", "display_name": "Adim", "link": "https://stackoverflow.com/users/6454624/adim"}, "reply_to_user": {"reputation": 89, "user_id": 9136318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba32997bd40a5a809cab469bb731d16?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/9136318/rahul"}, "edited": false, "score": 0, "creation_date": 1574081755, "post_id": 58910251, "comment_id": 104091850, "body": "Can you show what not_allowed_attributes looks like?"}, {"owner": {"reputation": 89, "user_id": 9136318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba32997bd40a5a809cab469bb731d16?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/9136318/rahul"}, "edited": false, "score": 0, "creation_date": 1574174358, "post_id": 58910251, "comment_id": 104131697, "body": "Hi nwocha, thanks for the response I have edit the questions, actucally for role1 not_allowed_attributes = [&quot;phone&quot;] and for role2 not_allowed_attributes = [&quot;email&quot;] is it possible to reject attributes in serializer class."}], "tags": [], "owner": {"reputation": 1106, "user_id": 6454624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-54Cw2TNXh84/AAAAAAAAAAI/AAAAAAAAAC4/Ivxon84Rp4k/photo.jpg?sz=128", "display_name": "Adim", "link": "https://stackoverflow.com/users/6454624/adim"}, "is_accepted": false, "score": 0, "last_activity_date": 1574064434, "creation_date": 1574064434, "answer_id": 58910251, "question_id": 58908858, "link": "https://stackoverflow.com/questions/58908858/how-to-reject-the-attributes-in-fastjson-api/58910251#58910251", "title": "How to reject the attributes in fastjson_api?", "body": "<p>You can use the <a href=\"https://github.com/Netflix/fast_jsonapi#conditional-attributes\" rel=\"nofollow noreferrer\">conditional attributes</a> of FastJSONAPI, by passing in a Proc. I'm not exactly clear how your code implements roles, but let's assume you have an <code>admin</code> role and you want to display the phone when the user is an admin. The code below should work for that use case:</p>\n\n<pre><code>class CustomerSerializer\n  include FastJsonapi::ObjectSerializer\n  attributes :name, :email, :phone  \n  attribute :phone, if: Proc.new { |record| record.admin? }\nend\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 9136318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba32997bd40a5a809cab469bb731d16?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/9136318/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574174115, "creation_date": 1574057466, "last_edit_date": 1574174115, "question_id": 58908858, "link": "https://stackoverflow.com/questions/58908858/how-to-reject-the-attributes-in-fastjson-api", "title": "How to reject the attributes in fastjson_api?", "body": "<p>I'm started using fastjson_api, I have implemented attribute-based control in my project how do reject the attributes when I'm returning the JSON data.<br>\nFor Example:-<br>\nI have a customer table where it has customer name, email, phone, address\nFor some roles, I may give access to phone number and for some, I'll not give them access<br>\n<code>not_allowed_attributes = [\"phone\"]</code>  </p>\n\n<pre><code>class CustomerSerializer\n  include FastJsonapi::ObjectSerializer\n  attributes :name, :email, :phone  \n  attribute :phone do |object|\n    unless not_allowed_attributes.include?\"phone\"\n      object.phone\n    end\n  end\nend\n</code></pre>\n\n<p>But It is not a dynamic way of implementing, so whenever there is changed in not_allowed_attributes it should dynamically filter out the attributes from the JSON response.<br>\nFor role1 not_allowed_attributes = [\"email\",\"phone\"]<br>\nfor role2 not_allowed_attributes = [\"phone\"]  </p>\n\n<p>not_allowed_attributes I'll send it in params for the serializer and there is it possible to remove the attributes based on their role. </p>\n"}, {"tags": ["ruby", "bundler"], "comments": [{"owner": {"reputation": 2470, "user_id": 1013142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd97eb9f014330c6063dfadb77bbd5de?s=128&d=identicon&r=PG", "display_name": "Sudipta Mondal", "link": "https://stackoverflow.com/users/1013142/sudipta-mondal"}, "edited": false, "score": 0, "creation_date": 1574054347, "post_id": 58908306, "comment_id": 104079111, "body": "you need to go through a tutorial for <code>GIT</code> - Have a look at this <a href=\"https://www.railstutorial.org/book/beginning#sec-version_control\" rel=\"nofollow noreferrer\">LINK</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9132378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de66aeb9c113365f5fb3e8e18910d007?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Dakota", "link": "https://stackoverflow.com/users/9132378/xavier-dakota"}, "edited": false, "score": 0, "creation_date": 1574272351, "post_id": 58908372, "comment_id": 104176266, "body": "Ok so the git clone worked and I was able to get into the directory. Then I do sub1 and I get this."}, {"owner": {"reputation": 1, "user_id": 9132378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de66aeb9c113365f5fb3e8e18910d007?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Dakota", "link": "https://stackoverflow.com/users/9132378/xavier-dakota"}, "edited": false, "score": 0, "creation_date": 1574272422, "post_id": 58908372, "comment_id": 104176320, "body": "I try bundle install I get the original error message about the outdated bundler"}, {"owner": {"reputation": 1, "user_id": 9132378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de66aeb9c113365f5fb3e8e18910d007?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Dakota", "link": "https://stackoverflow.com/users/9132378/xavier-dakota"}, "edited": false, "score": 0, "creation_date": 1574272456, "post_id": 58908372, "comment_id": 104176329, "body": "This is what I have in my gem file.exe"}, {"owner": {"reputation": 1, "user_id": 9132378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de66aeb9c113365f5fb3e8e18910d007?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Dakota", "link": "https://stackoverflow.com/users/9132378/xavier-dakota"}, "edited": false, "score": 0, "creation_date": 1574272503, "post_id": 58908372, "comment_id": 104176361, "body": "source &#39;<a href=\"https://rubygems.org\" rel=\"nofollow noreferrer\">rubygems.org</a>&#39; gem &#39;nokogiri&#39; gem &#39;rack&#39;, &#39;~&gt; 2.0.1&#39; gem &#39;rspec&#39;   gem &#39;bootstrap-sass&#39;, &#39;~&gt; 3.3&#39;, &#39;&gt;= 3.3.7&#39; gem &#39;sass-rails&#39;, &#39;&gt;= 3.2&#39; gem &#39;rails&#39;, &#39;4.2.5&#39; gem &#39;uglifier&#39;, &#39;&gt;= 1.3.0&#39; gem &#39;coffee-rails&#39;, &#39;~&gt; 4.1.0&#39; gem &#39;jquery-rails&#39; gem &#39;turbolinks&#39; gem &#39;jbuilder&#39;, &#39;~&gt; 2.0&#39; gem &#39;sdoc&#39;, &#39;~&gt; 0.4.0&#39;, group: :doc  group :development, :test do   gem &#39;sqlite3&#39;, &#39;~&gt; 1.3.0&#39;   gem &#39;byebug&#39; end  group :development do   gem &#39;web-console&#39;, &#39;~&gt; 2.0&#39;   gem &#39;spring&#39; end  group :production do   gem &#39;pg&#39;,             &#39;0.17.1&#39;   gem &#39;rails_12factor&#39;, &#39;0.0.2&#39; end"}, {"owner": {"reputation": 379, "user_id": 4454498, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b2b339daa2a73cb8c0ee537b3e6de80d?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Condron", "link": "https://stackoverflow.com/users/4454498/ryan-condron"}, "reply_to_user": {"reputation": 1, "user_id": 9132378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de66aeb9c113365f5fb3e8e18910d007?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Dakota", "link": "https://stackoverflow.com/users/9132378/xavier-dakota"}, "edited": false, "score": 0, "creation_date": 1574301902, "post_id": 58908372, "comment_id": 104187266, "body": "the command is subl (with an l), you may need to add it to your system path. The bundler message may just be a friendly reminder that there is a new version. If it is bombing about an SSL issue, you need to update RubyGems with the command <code>gem update --system</code>"}], "tags": [], "owner": {"reputation": 379, "user_id": 4454498, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b2b339daa2a73cb8c0ee537b3e6de80d?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Condron", "link": "https://stackoverflow.com/users/4454498/ryan-condron"}, "is_accepted": false, "score": 0, "last_activity_date": 1574054401, "creation_date": 1574054401, "answer_id": 58908372, "question_id": 58908306, "link": "https://stackoverflow.com/questions/58908306/how-to-upload-projects-from-github-onto-my-current-text-editor-which-is-sublime/58908372#58908372", "title": "How to upload projects from github onto my current text editor which is sublime", "body": "<p>You need to ensure you have git installed and use the clone command, to clone the repository using the git command in your command-line / console application or using GitHub desktop. Then you open your project using sublime or any editor of your choice.</p>\n\n<pre><code>git clone &lt;repo URL here&gt;\ncd &lt;project&gt;\nsubl .\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9132378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de66aeb9c113365f5fb3e8e18910d007?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Dakota", "link": "https://stackoverflow.com/users/9132378/xavier-dakota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574054401, "creation_date": 1574053949, "question_id": 58908306, "link": "https://stackoverflow.com/questions/58908306/how-to-upload-projects-from-github-onto-my-current-text-editor-which-is-sublime", "title": "How to upload projects from github onto my current text editor which is sublime", "body": "<p>$ ruby -v\nruby 2.3.3p222 (2016-11-21 revision 56859) [i386-mingw32]</p>\n\n<p>$ gem -v\n2.5.2</p>\n\n<p>$ bundle -v\nBundler version 2.0.2</p>\n\n<p>So I'm not sure how to get my work on github from my command line. Is there something specific that I have to type from my text editor?</p>\n\n<p>I keep getting a bundler message saying this</p>\n\n<p>Current Bundler version:\n    bundler (2.0.2)\nThis Gemfile requires a different version of Bundler.\nPerhaps you need to update Bundler by running <code>gem install bundler</code>?</p>\n\n<p>and then this:</p>\n\n<p>Successfully installed bundler-2.0.2\nParsing documentation for bundler-2.0.2\nDone installing documentation for bundler after 8 seconds\n1 gem installed</p>\n\n<p>ok good now bundle install</p>\n\n<p>Back to the original error message\nplease help I just want to get started lol</p>\n"}, {"tags": ["ruby", "winapi"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 8088049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45659d5bad51628e1ffcfacff971baf7?s=128&d=identicon&r=PG&f=1", "display_name": "Andrek", "link": "https://stackoverflow.com/users/8088049/andrek"}, "edited": false, "score": 0, "creation_date": 1574084253, "post_id": 58911225, "comment_id": 104093268, "body": "Thanks for your answer, it is so useful, i&#39;m trying to use GetMessage() but i have some problems passing MSG pointer, if someone can help me i would appreciate it. I edited the main post to add the code."}, {"owner": {"reputation": 85, "user_id": 8088049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45659d5bad51628e1ffcfacff971baf7?s=128&d=identicon&r=PG&f=1", "display_name": "Andrek", "link": "https://stackoverflow.com/users/8088049/andrek"}, "edited": false, "score": 0, "creation_date": 1574164035, "post_id": 58911225, "comment_id": 104125744, "body": "Maybe knowing the size of MSG could be useful, can you tell me it?"}, {"owner": {"reputation": 4915, "user_id": 11128312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ufn85.jpg?s=128&g=1", "display_name": "Strive Sun", "link": "https://stackoverflow.com/users/11128312/strive-sun"}, "reply_to_user": {"reputation": 85, "user_id": 8088049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45659d5bad51628e1ffcfacff971baf7?s=128&d=identicon&r=PG&f=1", "display_name": "Andrek", "link": "https://stackoverflow.com/users/8088049/andrek"}, "edited": false, "score": 0, "creation_date": 1574218729, "post_id": 58911225, "comment_id": 104149981, "body": "@Andrek Do you mean <code>sizeof(MSG)</code>? Its value is 28."}, {"owner": {"reputation": 85, "user_id": 8088049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45659d5bad51628e1ffcfacff971baf7?s=128&d=identicon&r=PG&f=1", "display_name": "Andrek", "link": "https://stackoverflow.com/users/8088049/andrek"}, "edited": false, "score": 0, "creation_date": 1574262590, "post_id": 58911225, "comment_id": 104170490, "body": "I really don&#39;t know what to do, i&#39;m passing to my GetMessage a 28 bytesize string but it keeps stuck, well thanks a lot :)."}], "tags": [], "owner": {"reputation": 4915, "user_id": 11128312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ufn85.jpg?s=128&g=1", "display_name": "Strive Sun", "link": "https://stackoverflow.com/users/11128312/strive-sun"}, "is_accepted": true, "score": 1, "last_activity_date": 1574068529, "creation_date": 1574068529, "answer_id": 58911225, "question_id": 58907483, "link": "https://stackoverflow.com/questions/58907483/how-to-disable-mouse-with-ruby-win32api/58911225#58911225", "title": "How to disable mouse with Ruby Win32API", "body": "<p>Your code lack a message loop.</p>\n\n<p>Please refer: <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/ms644988(v=vs.85)?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">MouseProc callback function</a></p>\n\n<blockquote>\n  <p>An application-defined or library-defined callback function used with\n  the SetWindowsHookEx function. The system calls this function whenever\n  an application calls the <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getmessage?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">GetMessage</a> or <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-peekmessagea?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">PeekMessage</a> function and there\n  is a mouse message to be processed.</p>\n</blockquote>\n\n<p><strong>Why must SetWindowsHookEx be used with a windows message queue?</strong></p>\n\n<blockquote>\n  <p>As <a href=\"https://stackoverflow.com/a/7460728/11128312\">Hans</a> said that, the low-level hooks, <code>WH_KEYBOARD_LL</code> and\n  <code>WH_MOUSE_LL</code> are different from all the other hooks. They don't\n  require a <code>DLL</code> to be injected into the target process. Instead,\n  Windows calls your hook callback directly, inside your own process. To\n  make that work, a message loop is required. There is no other\n  mechanism for Windows to make callbacks on your main thread, the\n  callback can only occur when you've called <code>Get/PeekMessage()</code> so that\n  Windows is in control.</p>\n  \n  <p>A global hook like <code>WH_KEYBOARD</code> is very different. It requires a\n  <code>DLL</code> and the callback occurs within the process that processes the\n  keyboard message. You need some kind of inter-process communication to\n  let your own program be aware of this. Named pipes are the usual\n  choice. Which otherwise of course requires that this injected process\n  pumps a message loop. It wouldn't get keyboard messages otherwise.</p>\n  \n  <p>Favor a low-level hook, they are much easier to get going. But do pump\n  or it won't work. And beware of timeouts, if you're not responsive\n  enough then Windows will kill your hook without notice.</p>\n</blockquote>\n\n<p>If you need to use <code>WH_MOUSE</code> globally, please inject the DLL.\nIf you don't want to use DLL, please use <code>WH_MOUSE_LL</code> instead of <code>WH_MOUSE</code>.</p>\n\n<p>For more details ,please refer : <a href=\"https://stackoverflow.com/questions/12253585/use-wh-mouse-globally-without-dll\">Use WH_MOUSE globally without DLL</a></p>\n\n<p>This is C++ code and works. Because I am not familiar with Ruby, I cannot provide modified Ruby code.</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nHHOOK mouseHook;\n\nLRESULT __stdcall MouseHookCallback(int nCode, WPARAM wParam, LPARAM lParam)\n{\n    if (nCode &gt;= 0)\n    {\n        switch (wParam)\n        {\n        case WM_MOUSEWHEEL :\n            return 1;\n        case WM_LBUTTONDOWN:\n            return 1;\n        case WM_LBUTTONUP:\n            return 1;\n        case WM_MOUSEMOVE:\n            return 1;\n        }\n    }\n    return CallNextHookEx(mouseHook, nCode, wParam, lParam);\n}\n\nvoid SetHook()\n{\n    if (!(mouseHook = SetWindowsHookEx(WH_MOUSE_LL, MouseHookCallback, NULL, 0)))\n    {\n        cout &lt;&lt; \"Failed to install mouse hook!\" &lt;&lt; endl;\n    }\n}\n\nvoid ReleaseHook()\n{\n    UnhookWindowsHookEx(mouseHook);\n}\n\nint WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)\n{\n    SetHook();\n    MSG msg;\n\n    while (GetMessage(&amp;msg, NULL, 0, 0))\n    {\n        TranslateMessage(&amp;msg);\n        DispatchMessage(&amp;msg);\n    }\n    return msg.wParam;\n}\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 8088049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45659d5bad51628e1ffcfacff971baf7?s=128&d=identicon&r=PG&f=1", "display_name": "Andrek", "link": "https://stackoverflow.com/users/8088049/andrek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 58911225, "answer_count": 1, "score": 0, "last_activity_date": 1574088351, "creation_date": 1574046225, "last_edit_date": 1574088351, "question_id": 58907483, "link": "https://stackoverflow.com/questions/58907483/how-to-disable-mouse-with-ruby-win32api", "title": "How to disable mouse with Ruby Win32API", "body": "<p>I'm trying to do something like this but only with the mouse:</p>\n\n<pre><code>require 'win32api'\nBlockInput = Win32API.new(\"user32\", \"BlockInput\", [\"I\"], \"I\")\n\nBlockInput.call(1)\nsleep 5\nBlockInput.call(0)\n</code></pre>\n\n<p>I'm trying to use <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-setwindowshookexa?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">SetWindowsHookEx</a> but it say that work but nothing happens, i can continue moving and clicking my mouse, this is the code:</p>\n\n<pre><code>require 'win32/api'\n\n# SetWindowsHookEx CONSTANTS\nWH_MOUSE = 7\nWH_MOUSE_LL = 14\n\n# MouseProc or LowLevelMouseProc CONSTANTS\nWM_MOUSEMOVE = 0x0200\nWM_LBUTTONDOWN = 0x0201\nWM_LBUTTONUP = 0x0202\nWM_MOUSEWHEEL = 0x020A\nWM_MOUSEHWHEEL = 0x020E\nWM_RBUTTONDOWN = 0x0204\nWM_RBUTTONUP = 0x0205\n\nSetWindowsHookEx = Win32::API.new('SetWindowsHookEx', ['I', 'K', 'L', 'I'], 'L', 'user32')\nCallNextHookEx = Win32::API.new('CallNextHookEx', ['I', 'I', 'L', 'P'], 'I', 'user32')\nUnhookWindowsHookEx = Win32::API.new('UnhookWindowsHookEx', ['I'], 'I', 'user32')\nGetCurrentThreadId = Win32::API.new('GetCurrentThreadId', ['V'], 'I', 'kernel32')\n\nMouseProc = Win32::API::Callback.new('ILP', 'L') do |nCode, wParam, lParam|\n    # https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/ms644988(v=vs.85)\n    if nCode &lt; 0 # If nCode is less than zero, the hook procedure must return the value returned by CallNextHookEx.\n        return CallNextHookEx.call(0, nCode, wParam, lParam)\n    elsif wParam == WM_MOUSEMOVE or wParam == WM_LBUTTONDOWN or wParam == WM_LBUTTONUP\n        # If the hook procedure processed the message, it may return a nonzero value to prevent the system from\n        # passing the message to the rest of the hook chain or the target window procedure.\n        return 1\n    else\n        # If nCode is greater than or equal to zero, and the hook procedure did not process the message,\n        # it is highly recommended that you call CallNextHookEx and return the value it returns;\n        # otherwise, other applications that have installed WH_MOUSE_LL hooks will not receive hook\n        # notifications and may behave incorrectly as a result.\n        return CallNextHookEx.call(0, nCode, wParam, lParam)\n    end\nend\n\nthreadID = GetCurrentThreadId.call\nhMod = nil\n# If the function succeeds, the return value is the handle to the hook procedure.\np hhk = SetWindowsHookEx.call(WH_MOUSE, MouseProc, hMod, threadID) #=&gt; 166134929 (Good)\n# But nothing happens, i can continue moving and clicking my mouse.\nsleep 5\np UnhookWindowsHookEx.call(hhk) #=&gt; 1 (Good)\n</code></pre>\n\n<p>if someone knows how to do it or how to do it in another way I would greatly appreciate it.</p>\n\n<p><strong>Edit</strong>: I'm running the code with admin access on Windows 7 (32 Bits)</p>\n\n<p>I'm trying to use GetMessage() following <a href=\"https://stackoverflow.com/users/11128312/strive-sun-msft\">Strive Sun - MSFT</a>'s answer but i have some problems passing MSG pointer</p>\n\n<pre><code>GetMessage = Win32::API.new('GetMessage', ['P', 'L', 'L', 'L'], 'I', 'user32')\npoint = [0, 0].pack('LL')\nhwnd = uint = wparam = lparam = dword = 0\nbuf = [hwnd, uint, wparam, lparam, dword, point, dword].pack('JIL2Sa8S')\n# J &gt; hwnd, I &gt; uint, L2 &gt; wparam lparam, S &gt; dword, a8 &gt; point\nGetMessage.call(buf, nil, 0, 0) #=&gt; Stuck, i need to use Manager Task to close it.\n</code></pre>\n"}, {"tags": ["ruby", "string", "encryption", "caesar-cipher"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11836193"}, "edited": false, "score": 0, "creation_date": 1574053058, "post_id": 58908027, "comment_id": 104078831, "body": "THANK YOU very much @Amadan for your detailed explanation. They help me to understanding the logic behind better. I really appreciate your help!!!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574058093, "post_id": 58908027, "comment_id": 104080244, "body": "@FuriousCodeNinja then mark the answer as correct with a greeny right below the answer score. You are obliged to mark answers that solved the issue here on SO."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11836193"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574059483, "post_id": 58908027, "comment_id": 104080727, "body": "@AlekseiMatiushkin Thanks for letting me know!  I have marked this answer green. Cheers"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 3, "last_activity_date": 1574055242, "last_edit_date": 1574055242, "creation_date": 1574051745, "answer_id": 58908027, "question_id": 58907376, "link": "https://stackoverflow.com/questions/58907376/simple-cipher-ruby-from-exercism/58908027#58908027", "title": "Simple Cipher - Ruby from Exercism", "body": "<blockquote>\n  <p>@key = key is if key is matched. ALPHABET is randomized (with .sample method) and joined. Randomised joined alphabets are then iterated 100 times and a new array is returned (with map method).</p>\n</blockquote>\n\n<p><code>@key = key</code> if <code>key</code> is not falsy (<code>nil</code> or <code>false</code>); otherwise, iterate <code>100</code> times and collect a random character from <code>ALPHABET</code>; then join the resulting 100-element array into a string and assign the <em>string</em> to <code>@key</code>. Nothing is <em>returned</em>.</p>\n\n<blockquote>\n  <p>ord method - convert a character to its ASCII value. <code>a = 'a'.ord</code> . Why is this character selected? Not z or other characters?</p>\n</blockquote>\n\n<p>Because <code>\"a\"</code> starts the alphabetic sequence in Unicode (In ASCII too, but <code>.ord</code> in this case operates on Unicode), with value <code>97</code>. But we're interested in the position of the character in the alphabet, not in Unicode. Think of it this way: It's 20:37, and you're listening to opera. The performance started at <code>19:00</code>. How long have you been listening to it? You subtract <code>20:37 - 19:00</code>, to get to the answer (1 hour, 37 minutes). Same way, to know that <code>'c'</code> is the #2 character (in English we'd say 3rd, but Ruby starts counting from 0, so <code>'a'</code> is #0, <code>'c'</code> is #2), you subtract the position of <code>'a'</code> from the position of <code>'c'</code>: <code>99 - 97</code>. You would not subtract <code>23:00</code> or any other time from <code>20:37</code>, because that doesn't make any sense in finding out how long you've been listening; same reason why we use <code>'a'.ord</code>, and not <code>'z'</code> or another character.</p>\n\n<blockquote>\n  <p>.zip method - this method is used to compare original plain text characters and encryption characters.</p>\n</blockquote>\n\n<p>No, it just makes a new array, by pairing up each element from <code>text.chars</code> with a corresponding one from <code>@key.chars</code>. There is no comparison going on.</p>\n\n<blockquote>\n  <p>I have a trouble understanding this ALPHABET[(char.ord - a + key.ord - a) % ALPHABET.length] part. ALPHABET original plain text and encryption key text characters are converted into ASCII values with .ord method. Why a value is subtracted from those values? Why use % operator and ALPHABET.length?</p>\n</blockquote>\n\n<p>See above regarding why <code>a</code>. </p>\n\n<p>This cipher works by offsetting each character by the number of spaces corresponding to the alphabet position of the appropriate character in the key. <code>%</code> will wrap things around so that the result is always a valid index of <code>ALPHABET</code>. For example, if <code>char.ord - a + key.ord - a</code> happen to go over the length of <code>ALPHABET</code>, then it would wrap around to the start. For example, if you get <code>29</code> in the above calculation, you'd normally get <code>nil</code> for <code>ALPHABET[29]</code> since there's no letter #29; but <code>29 % 26</code> is <code>3</code>, and <code>ALPHABET[3]</code> is valid.</p>\n\n<blockquote>\n  <p>Part 3 In this part, decode method, code is used. Code is the secret key shared between two parties (sender and receiver). But why ALPHABET[char.ord - key.ord]? Characters ascii - key ascii value will provide the decrypted plain text. I do not understand how it works?</p>\n</blockquote>\n\n<p>What is shifted can be unshifted; this is what decoding looks like. Where before we were adding up the positions of the two characters \u2014 <code>(char.ord - a) + (key.ord - a)</code> \u2014 now we're subtracting them: <code>(char.ord - a) - (key.ord - a)</code>. Do a bit of math, and you'll see that the two <code>a</code> will cancel each other in this subtraction, so <code>(char.ord - a) - (key.ord - a)</code> is equivalent to <code>char.ord - key.ord</code>.</p>\n\n<p>Before, we had a concern the addition might go over the size of the alphabet. Here one might be concerned that the subtraction might go negative. But Ruby has our back now: <code>ALPHABET[-3]</code> in Ruby means \"3rd element from the end\", and is thus equivalent to <code>ALPHABET[23]</code>; no need for <code>%</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11836193"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 58908027, "answer_count": 1, "score": 4, "last_activity_date": 1574055242, "creation_date": 1574045323, "question_id": 58907376, "link": "https://stackoverflow.com/questions/58907376/simple-cipher-ruby-from-exercism", "title": "Simple Cipher - Ruby from Exercism", "body": "<p>I am currently studying Ruby and have attempted Simple Cipher challenge. I am now studying the following solution and am trying to reverse engineer to understand the thought process behind of this solution. The following is the link for the solution. I will detail my understanding of each code snippet. If they are not right, could you please correct me? Thanks!\n<a href=\"https://exercism.io/tracks/ruby/exercises/simple-cipher/solutions/b200c3d9f10e497bbe2ca0d826df2661\" rel=\"nofollow noreferrer\">https://exercism.io/tracks/ruby/exercises/simple-cipher/solutions/b200c3d9f10e497bbe2ca0d826df2661</a></p>\n\n<pre><code>class Cipher\n  ALPHABET = [*'a'..'z']\n\n  attr_reader :key\n\n  def initialize(key = nil)\n    @key = key || 100.times.map { ALPHABET.sample }.join\n    fail ArgumentError, 'invalid chars in key' unless valid?(@key)\n  end\n\n  def encode(text)\n    a = 'a'.ord\n    text.chars.zip(@key.chars).map do |char, key|\n      ALPHABET[(char.ord - a + key.ord - a) % ALPHABET.length]\n    end.join\n  end\n\n  def decode(code)\n    code.chars.zip(@key.chars).map do |char, key|\n      ALPHABET[char.ord - key.ord]\n    end.join\n  end\n\nprivate\n\n  def valid?(key)\n    !key.empty? &amp;&amp; key !~ /[^a-z]/\n  end\n\nend\n</code></pre>\n\n<p><strong><em>Part 1</em></strong> </p>\n\n<p>@key = key is if key is matched.\nALPHABET is randomized (with .sample method) and joined. Randomised joined alphabets are then iterated 100 times and a new array is returned (with map method). </p>\n\n<p>To handle invalid key error, fail ArgumentError is used.</p>\n\n<pre><code>  def initialize(key = nil)\n    @key = key || 100.times.map { ALPHABET.sample }.join\n    fail ArgumentError, 'invalid chars in key' unless valid?(@key)\n  end\n</code></pre>\n\n<p><strong><em>Part 2</em></strong> \nI understand that the purpose of this code is to convert the plain text into encrypted text. However, I am struggling to some part of the following code.</p>\n\n<pre><code>def encode(text)\n    a = 'a'.ord\n    text.chars.zip(@key.chars).map do |char, key|\n      ALPHABET[(char.ord - a + key.ord - a) % ALPHABET.length]\n    end.join\n  end\n</code></pre>\n\n<ol>\n<li><strong>.ord method</strong> - convert a character to its ASCII value. a = 'a'.ord . <em>Why is this character selected? Not z or other characters?</em></li>\n<li><strong>.chars method</strong> - text string is separated into each individual character with .chars method. .chars more efficient than .split since it parses the underlying bytes to return the string's characters (I have read .chars vs .split difference on the stackover flow).</li>\n<li><strong>.zip method</strong> - this method is used to compare original plain text characters and encryption characters. </li>\n<li><strong>.map method</strong> - This method is called with a block and returns encrpyted text.</li>\n<li><p>Inside <strong>.map method block</strong>, there are two arguments: char and key. char represents character from the original plain text and key represents encrypted key character. </p></li>\n<li><p>I have a trouble understanding this <code>ALPHABET[(char.ord - a + key.ord - a) % ALPHABET.length]</code> part. \nALPHABET original plain text and encryption key text characters are converted into ASCII values with .ord method. Why a value is subtracted from those values? Why use % operator and ALPHABET.length? </p></li>\n<li><strong>.join method</strong> - I guess .join is used to join the transformed encrypted characters. Is my understanding correct? </li>\n</ol>\n\n<p><strong>Part 3</strong> \nIn this part, decode method, code is used. Code is the secret key shared between two parties (sender and receiver). But why <code>ALPHABET[char.ord - key.ord]</code>? Characters ascii - key ascii value will provide the decrypted plain text. I do not understand how it works?</p>\n\n<pre><code>def decode(code)\n    code.chars.zip(@key.chars).map do |char, key|\n      ALPHABET[char.ord - key.ord]\n    end.join\nend\n</code></pre>\n\n<p><strong>Part 4</strong> \nprivate method is used to separate this chunk of code from other classes. Valid method is to verify the key. There are two conditions: key must not be empty or must be lowercase alphabets.</p>\n\n<pre><code>private\n\n  def valid?(key)\n    !key.empty? &amp;&amp; key !~ /[^a-z]/\n  end\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 121, "user_id": 9307315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b3ace3056b20a7f022ab9acb7b5112?s=128&d=identicon&r=PG&f=1", "display_name": "sobczi", "link": "https://stackoverflow.com/users/9307315/sobczi"}, "edited": false, "score": 0, "creation_date": 1574045277, "post_id": 58907366, "comment_id": 104077300, "body": "If you want to use select option you should rather use <code>select</code> and <code>option</code> tags"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1574065499, "post_id": 58907366, "comment_id": 104083134, "body": "You could also check out the cocoon gem. It helps with adding fields to a form dynamically.  <a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">github.com/nathanvda/cocoon</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 10878022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a88465c0d3d68c42870178df3b1a836?s=128&d=identicon&r=PG&f=1", "display_name": "Saravanakumar Thevar", "link": "https://stackoverflow.com/users/10878022/saravanakumar-thevar"}, "is_accepted": false, "score": 1, "last_activity_date": 1595982920, "last_edit_date": 1595982920, "creation_date": 1574046523, "answer_id": 58907506, "question_id": 58907366, "link": "https://stackoverflow.com/questions/58907366/how-can-i-create-a-select-option-that-i-can-select-from-an-array-in-the-javascri/58907506#58907506", "title": "How can I create a select option that I can select from an array in the Javascript?", "body": "<p>I cant understand your question clearly but I think this is what you are looking for .\nGiving you an example of which you can safely extrapolate. Cheers.</p>\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;select id=&quot;sltGas&quot; onchange=&quot;alert(this.options[this.selectedIndex].text);&quot;&gt;\n  &lt;option&gt;Hello&lt;/option&gt;\n&lt;/select&gt;\n&lt;input type=&quot;text&quot; id=&quot;txtGas&quot; name=&quot;txtGas&quot;&gt;&lt;input type=&quot;button&quot; name=&quot;btnAdd&quot; id=&quot;addBtn&quot; value=&quot;ADD&quot; onclick=&quot;addGas();&quot;&gt;\n&lt;script type=&quot;text/javascript&quot;&gt;\nvar sltGas = document.getElementById(&quot;sltGas&quot;);\nalert(sltGas.options[sltGas.selectedIndex].text);\n\nfunction addGas()\n{\n var txtGas = document.getElementById(&quot;txtGas&quot;);\n var option = document.createElement(&quot;option&quot;); \n option.text = txtGas.value; \n option.value = 2;\n sltGas.add(option) \n}\n&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1574081582, "last_edit_date": 1574081582, "creation_date": 1574081060, "answer_id": 58914853, "question_id": 58907366, "link": "https://stackoverflow.com/questions/58907366/how-can-i-create-a-select-option-that-i-can-select-from-an-array-in-the-javascri/58914853#58914853", "title": "How can I create a select option that I can select from an array in the Javascript?", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>$('#gas_analyte_btn').click(function(){\r\n  let value = $(this).siblings('input[type=\"text\"]').val();\r\n  if (value.length &gt; 0) {\r\n    $('#myselect').append($('&lt;option&gt;'+value+'&lt;/option&gt;'))\r\n                  .val(value); // selects the new value\r\n  }\r\n});</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js\"&gt;&lt;/script&gt;\r\n\r\n&lt;div class=\"row\" id=\"gas_analyte1\"&gt;\r\n  &lt;div class=\"col-md-3\"&gt;\r\n    &lt;select id=\"myselect\"&gt;\r\n      &lt;option&gt;Helium&lt;/option&gt;\r\n      &lt;option&gt;Hydrogen&lt;/option&gt;\r\n      &lt;option&gt;Oxygen&lt;/option&gt;\r\n    &lt;/select&gt;\r\n  &lt;/div&gt;\r\n  &lt;div class=\"add_option\"&gt;\r\n    &lt;input type=\"text\"/&gt;\r\n    &lt;button id=\"gas_analyte_btn\"&gt;Add Option&lt;/button&gt;\r\n  &lt;/div&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Also you can programatically create HTML elements and fragments using jQuery or just the vanilla DOM instead of that completely unreadable string concatenation concoction:</p>\n\n<pre><code>var id = i.toString();\nvar $in = $('&lt;input&gt;').attr({ \n  name: 'search[gas_analyte'+i+']',\n  id: 'search_gas_analyte'+i\n});\n# ...\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 11876193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e8d60ef1c541d619b23743be3ba1e4?s=128&d=identicon&r=PG&f=1", "display_name": "YLim", "link": "https://stackoverflow.com/users/11876193/ylim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1595982920, "creation_date": 1574045209, "last_edit_date": 1574067670, "question_id": 58907366, "link": "https://stackoverflow.com/questions/58907366/how-can-i-create-a-select-option-that-i-can-select-from-an-array-in-the-javascri", "title": "How can I create a select option that I can select from an array in the Javascript?", "body": "<pre><code>&lt;div class=\"row\" id=\"gas_analyte1\"&gt;\n              &lt;div class=\"col-md-3\"&gt;\n                Gas Analyte 1&lt;br&gt;\n                &lt;%= f.select :gas_analyte, @Gases, {include_blank: 'Select Gas', size:15},{style: \"width:150px;\",class: \"gas_search\"} %&gt;&lt;br&gt;              \n              &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><code>@Gases</code> is an array of gases such as carbon monoxide that is created in the controller.</p>\n\n<p>In Javascript, if a user clicks on the add button, I would like to add another select box to the input page so I have this so far</p>\n\n<pre><code>$('#gas_analyte_btn').click(function(){\n    $('#gas_analytes').append('&lt;div id=\"gas_analyte'+(i).toString()+'\" class=\"row\"&gt;&lt;div class=\"col-md-3\"&gt;Gas Analyte '+(i).toString()+'&lt;br&gt;&lt;input size=\"15\" type=\"text\" name=\"search[gas_analyte'+(i).toString()+']\" id=\"search_gas_analyte'+(i).toString()+'\" /&gt;\n});\n</code></pre>\n\n<p>The problem I having is that the javascript created a Textarea and not a select option. How can I create a select option that I can select from <code>@Gases</code> in the Javascript? </p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 1, "creation_date": 1574037823, "post_id": 58906614, "comment_id": 104075941, "body": "What does <code>which rails</code> show?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1574042269, "post_id": 58906614, "comment_id": 104076778, "body": "Also, how exactly did you update Ruby? If you are accessing Ruby through shims or bash functions, your terminal might be stale or you might be in a similar in-between state."}, {"owner": {"reputation": 23, "user_id": 12388736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBwFcdOsS42X_sOy8J5CNllZ3hpEIPRf1_kmXhP=k-s128", "display_name": "Brian Nicholls", "link": "https://stackoverflow.com/users/12388736/brian-nicholls"}, "edited": false, "score": 0, "creation_date": 1574309788, "post_id": 58906614, "comment_id": 104189080, "body": "<code>which rails</code> shows usr/bin/rails"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12388736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBwFcdOsS42X_sOy8J5CNllZ3hpEIPRf1_kmXhP=k-s128", "display_name": "Brian Nicholls", "link": "https://stackoverflow.com/users/12388736/brian-nicholls"}, "edited": false, "score": 0, "creation_date": 1574309421, "post_id": 58907146, "comment_id": 104188996, "body": "rvm list showed <code># Default ruby not set. Try &#39;rvm alias create default &lt;ruby&gt;&#39;.</code>  I tried your suggestion, and got some errors: <code>Warning! Executable &#39;ruby&#39; missing, something went wrong with this ruby installation!</code> <code>Warning! Executable &#39;gem&#39; missing, something went wrong with this ruby installation! </code>Warning! Executable &#39;irb&#39; missing, something went wrong with this ruby installation!`"}], "tags": [], "owner": {"reputation": 2562, "user_id": 4344085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ilSIn.jpg?s=128&g=1", "display_name": "Khanh Pham", "link": "https://stackoverflow.com/users/4344085/khanh-pham"}, "is_accepted": false, "score": 1, "last_activity_date": 1574043198, "creation_date": 1574043198, "answer_id": 58907146, "question_id": 58906614, "link": "https://stackoverflow.com/questions/58906614/ruby-v-shows-2-6-3-but-terminal-says-im-running-2-3-7-when-trying-to-run-rail/58907146#58907146", "title": "Ruby -v shows 2.6.3, but Terminal says I&#39;m running 2.3.7 when trying to run rails console", "body": "<p>Because in your local development, you had some <code>ruby</code> versions which was installed, and it set <code>ruby 2.3.7</code> as default.</p>\n\n<p>If you installed <code>ruby</code> via <code>rvm</code>, you can check and list all <code>ruby</code> versions in your local via command:</p>\n\n<p><code>rvm list</code></p>\n\n<p>For examples:</p>\n\n<pre><code>   ruby-2.6.0 [ x86_64 ]\n=* ruby-2.6.2 [ x86_64 ]\n   ruby-2.6.3 [ x86_64 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n</code></pre>\n\n<p>As you see, you can use this command as bellow to set default <code>ruby</code> to use.</p>\n\n<p><code>rvm use 2.6.3 --default</code></p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 12388736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBwFcdOsS42X_sOy8J5CNllZ3hpEIPRf1_kmXhP=k-s128", "display_name": "Brian Nicholls", "link": "https://stackoverflow.com/users/12388736/brian-nicholls"}, "is_accepted": false, "score": 0, "last_activity_date": 1574310344, "creation_date": 1574310344, "answer_id": 58967297, "question_id": 58906614, "link": "https://stackoverflow.com/questions/58906614/ruby-v-shows-2-6-3-but-terminal-says-im-running-2-3-7-when-trying-to-run-rail/58967297#58967297", "title": "Ruby -v shows 2.6.3, but Terminal says I&#39;m running 2.3.7 when trying to run rails console", "body": "<p>I had to run <code>rvm implode</code> , then re-install rvm. Then I followed the instructions found here: <a href=\"https://stackoverflow.com/questions/38194032/how-to-update-ruby-version-2-0-0-to-the-latest-version-in-mac-osx-yosemite\">How to update Ruby Version 2.0.0 to the latest version in Mac OSX Yosemite?</a></p>\n\n<p>Thank you!</p>\n"}], "owner": {"reputation": 23, "user_id": 12388736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBwFcdOsS42X_sOy8J5CNllZ3hpEIPRf1_kmXhP=k-s128", "display_name": "Brian Nicholls", "link": "https://stackoverflow.com/users/12388736/brian-nicholls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574310344, "creation_date": 1574037446, "question_id": 58906614, "link": "https://stackoverflow.com/questions/58906614/ruby-v-shows-2-6-3-but-terminal-says-im-running-2-3-7-when-trying-to-run-rail", "title": "Ruby -v shows 2.6.3, but Terminal says I&#39;m running 2.3.7 when trying to run rails console", "body": "<p>I just updated ruby, and running <code>ruby -v</code> in terminal shows: <code>ruby 2.6.3p62 (2019-04-16 revision 67580) [x86_64-darwin18]</code></p>\n\n<p>However, when trying to run <code>rails console</code>, I get the error:</p>\n\n<pre><code>Rails 6 requires Ruby 2.5.0 or newer.\n\nYou're running\n  ruby 2.3.7p456 (2018-03-28 revision 63024) [universal.x86_64-darwin18]\n\nPlease upgrade to Ruby 2.5.0 or newer to continue.\n</code></pre>\n\n<p>Which is the version I just (allegedly) updated from. Any help is greatly appreciated.</p>\n"}, {"tags": ["ruby", "bundler", "guard", "gemfile", "gemspecs"], "comments": [{"owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "edited": false, "score": 0, "creation_date": 1574051974, "post_id": 58906196, "comment_id": 104078594, "body": "The error seems clear. Where is your .gemspec in relation to wherever you&#39;re running Guard from, and what&#39;s in your Guardfile?"}, {"owner": {"reputation": 123, "user_id": 8803235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ddcb53281b3e564ec74ce682084e44?s=128&d=identicon&r=PG&f=1", "display_name": "AER", "link": "https://stackoverflow.com/users/8803235/aer"}, "reply_to_user": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "edited": false, "score": 0, "creation_date": 1574069937, "post_id": 58906196, "comment_id": 104085264, "body": "Hello @ToddA.Jacobs, I edited my question for you can see in GitHub repo .gemspec,Guardfile and gemfile setup files. Thanks"}, {"owner": {"reputation": 123, "user_id": 8803235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ddcb53281b3e564ec74ce682084e44?s=128&d=identicon&r=PG&f=1", "display_name": "AER", "link": "https://stackoverflow.com/users/8803235/aer"}, "reply_to_user": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "edited": false, "score": 0, "creation_date": 1574116561, "post_id": 58906196, "comment_id": 104109344, "body": "Someone else have any idea about how to fix this issue? Thanks in advance"}], "owner": {"reputation": 123, "user_id": 8803235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ddcb53281b3e564ec74ce682084e44?s=128&d=identicon&r=PG&f=1", "display_name": "AER", "link": "https://stackoverflow.com/users/8803235/aer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574069836, "creation_date": 1574033244, "last_edit_date": 1574069836, "question_id": 58906196, "link": "https://stackoverflow.com/questions/58906196/error-guard-will-not-detect-changes-to-your-gemfile-ruby-gem", "title": "Error: Guard will not detect changes to your Gemfile (Ruby gem)", "body": "<p>I am trying to use Guard as a help for make Test Driven Development using <code>Vim</code> in Linux Shell. For add Guard dependecy, i added this to my <code>.gemspec</code> file:</p>\n\n<pre><code>spec.add_development_dependency \"guard\"\n\nspec.add_development_dependency \"guard-rspec\"\n\nspec.add_development_dependency \"guard-bundler\"\n</code></pre>\n\n<p>Then, in Command Line, i executed this:</p>\n\n<pre><code>sudo bin/setup\n\nbundle exec guard init\n</code></pre>\n\n<p>Then for update <code>Bundle</code> gems and dependencies, i updated Bundle for take in count Guard files:</p>\n\n<pre><code>sudo bundle install\n</code></pre>\n\n<p>When i tried to use Guard with <code>bundle exec guard</code>, i got this error:</p>\n\n<pre><code>/usr/lib/ruby/vendor_ruby/did_you_mean/version.rb:2: warning: already initialized constant DidYouMean::VERSION\n/var/lib/gems/2.6.0/gems/did_you_mean-1.3.1/lib/did_you_mean/version.rb:2: warning: previous definition of VERSION was here\n/usr/lib/ruby/vendor_ruby/did_you_mean/jaro_winkler.rb:63: warning: already initialized constant DidYouMean::JaroWinkler::WEIGHT\n/var/lib/gems/2.6.0/gems/did_you_mean-1.3.1/lib/did_you_mean/jaro_winkler.rb:63: warning: previous definition of WEIGHT was here\n</code></pre>\n\n<p>And for Guard output this warning:</p>\n\n<pre><code> Error: Guard will not detect changes to your Gemfile!\n&gt; [#] \n&gt; [#]   Solution: move the Gemfile to a watched directory and symlink it back.\n</code></pre>\n\n<p>I am searching a solution for this problem in <code>guard</code> public repository in Github, but until now i was unable to fix it.</p>\n\n<p>Version of <code>Ruby</code> i am using : <code>ruby 2.6.5</code></p>\n\n<p>Version of <code>guard</code>: <code>2.16.1</code></p>\n\n<p><code>Bundler</code> version : 2.0.2</p>\n\n<p><a href=\"https://github.com/Alien-97/Gemfile\" rel=\"nofollow noreferrer\">Here you can see Gemfile,Guardfile and gemspec</a></p>\n\n<p>Any help would be appreciated, thanks.</p>\n"}, {"tags": ["ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1574033275, "post_id": 58906066, "comment_id": 104075072, "body": "See this <a href=\"https://cirw.in/blog/constant-lookup\" rel=\"nofollow noreferrer\">article on constant lookup</a>. BTW, it&#39;s confusing, if not problematic, to use method names that are the same as the names of core methods (here <code>call</code>)."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 5, "creation_date": 1574033896, "post_id": 58906066, "comment_id": 104075190, "body": "Defining <code>module B</code> inside of <code>module A</code> is actually different than defining <code>module A::B</code> straight-up. The wrapping implies a search scope that doesn&#39;t exist when you do it your other way."}, {"owner": {"reputation": 5071, "user_id": 326039, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c388f6c1fd2bf8c651678e14b78aefa7?s=128&d=identicon&r=PG", "display_name": "Zag zag..", "link": "https://stackoverflow.com/users/326039/zag-zag"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1574082369, "post_id": 58906066, "comment_id": 104092157, "body": "I agree with @tadman&#39;s comment, and I added another example to be sure the code is ISO with the working <code>FOO</code> one. The only difference is that, I replaced <code>FOO</code> by <code>const_get(:FOO)</code>. And it is no longer working. So I think the trouble comes from <code>const_get</code> method IMO."}], "answers": [{"comments": [{"owner": {"reputation": 5071, "user_id": 326039, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c388f6c1fd2bf8c651678e14b78aefa7?s=128&d=identicon&r=PG", "display_name": "Zag zag..", "link": "https://stackoverflow.com/users/326039/zag-zag"}, "edited": false, "score": 0, "creation_date": 1574288058, "post_id": 58944352, "comment_id": 104183486, "body": "I undersand better with your explanation. But then, how (in pure meta-programming) I can create a module with a constant, and a sub-module, and get the constant through a class method? Is it not possible?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 5071, "user_id": 326039, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c388f6c1fd2bf8c651678e14b78aefa7?s=128&d=identicon&r=PG", "display_name": "Zag zag..", "link": "https://stackoverflow.com/users/326039/zag-zag"}, "edited": false, "score": 0, "creation_date": 1574289788, "post_id": 58944352, "comment_id": 104184076, "body": "I&#39;m not sure I follow. If <code>module A; FOO = 1; module B; def self.b; &quot;FOO=#{FOO}&quot;; end; end; end</code> then <code>A::B.b #=&gt; &quot;FOO=1&quot;</code>. Is that what you mean? As I write my dog is pulling my pant leg, telling me it&#39;s time for a walk. I&#39;ll check in later."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1574205632, "creation_date": 1574205632, "answer_id": 58944352, "question_id": 58906066, "link": "https://stackoverflow.com/questions/58906066/fetch-dynamically-a-defined-constant/58944352#58944352", "title": "Fetch dynamically a defined constant", "body": "<p>We can use the method <a href=\"https://ruby-doc.org/core-2.6.3/Module.html#method-c-nesting\" rel=\"nofollow noreferrer\">Module::nesting</a> to better understand what is going on here.</p>\n\n<pre><code>module A\n  FOO = 42\n  module B\n    puts \"Module.nesting = #{Module.nesting}\"\n    def self.call\n      FOO\n    end\n  end\nend\n</code></pre>\n\n<p>displays</p>\n\n<pre><code>Module.nesting = [A::B, A]\n</code></pre>\n\n<p>This tells us that, when executing <code>A::B.call</code>, in searching for the value of <code>FOO</code>, Ruby first looks in module <code>A::B</code>, does not find it, then searches in module <code>A</code> where she does find it.</p>\n\n<p>Your third code fragment also creates a nested module <code>A::B</code>:</p>\n\n<pre><code>module A\n  FOO = 42\n  module B\n    puts \"Module.nesting = #{Module.nesting}\"\n    def self.a_method\n      const_get(:FOO)\n    end\n  end\nend\n</code></pre>\n\n<p>displays</p>\n\n<pre><code>Module.nesting = [A::B, A]\n</code></pre>\n\n<p><code>A::B.a_method</code> executes <code>A::B.const_get(:FOO)</code>. The doc for <a href=\"https://ruby-doc.org/core-2.6.3/Module.html#method-i-const_get\" rel=\"nofollow noreferrer\">Module#const_get</a> states, \"Checks for a constant with the given name in mod.\" Therefore, if it fails to find the constant in the module that is its receiver it gives up without examining any modules within which the given module is nested. </p>\n\n<p>Your second code fragment is similar to the third in that it fails to find the value of <code>FOO</code> because of the behaviour of <code>const_get</code>.</p>\n"}], "owner": {"reputation": 5071, "user_id": 326039, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c388f6c1fd2bf8c651678e14b78aefa7?s=128&d=identicon&r=PG", "display_name": "Zag zag..", "link": "https://stackoverflow.com/users/326039/zag-zag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1574205632, "creation_date": 1574031999, "last_edit_date": 1574061260, "question_id": 58906066, "link": "https://stackoverflow.com/questions/58906066/fetch-dynamically-a-defined-constant", "title": "Fetch dynamically a defined constant", "body": "<p>According to Ruby <code>const_get</code>'s documentation, this method returns value for a constant.</p>\n\n<p>So to reproduce the following behavior:</p>\n\n<pre><code>module A\n  FOO = 42\n\n  module B\n    def self.call\n      FOO\n    end\n  end\nend\n\nA::B.call # =&gt; 42\n</code></pre>\n\n<p>I wrote this code:</p>\n\n<pre><code>A = Module.new\nA.const_set(:FOO, 42)\nA.const_set(:B, Module.new do\n  def self.call\n    const_get(:FOO)\n  end\nend)\n</code></pre>\n\n<p>But when I call the method, I've got a <code>NameError</code> exception:</p>\n\n<pre><code>A::B.call # =&gt; exception\n# NameError (uninitialized constant A::B::FOO)\n# Did you mean?  A::FOO\n</code></pre>\n\n<p>It looks like <code>FOO</code> and <code>const_get(:FOO)</code> are not exactly the same.</p>\n\n<p>Is there another way to find the <code>FOO</code> constant looking recursively in the parents modules?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I also have this trouble with <code>const_get</code> doing directly:</p>\n\n<pre><code>module A\n  FOO = 42\n\n  module B\n    def self.a_method\n      const_get(:FOO)\n    end\n  end\nend\n\nA::B.a_method # =&gt; exception\n# NameError (uninitialized constant A::B::FOO)\n# Did you mean?  A::FOO\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2347, "user_id": 1625253, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iBQwX.jpg?s=128&g=1", "display_name": "Simon Franzen", "link": "https://stackoverflow.com/users/1625253/simon-franzen"}, "edited": false, "score": 0, "creation_date": 1574033211, "post_id": 58905985, "comment_id": 104075058, "body": "I think this code looks good. Can you show more of your controller class?"}, {"owner": {"reputation": 2347, "user_id": 1625253, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iBQwX.jpg?s=128&g=1", "display_name": "Simon Franzen", "link": "https://stackoverflow.com/users/1625253/simon-franzen"}, "edited": false, "score": 4, "creation_date": 1574033432, "post_id": 58905985, "comment_id": 104075098, "body": "Show your models as well. Check if you really have an author with ID 2 in your database. In new rails version belongs_to relations are per default mandatory. <code>belongs_to :class, optional: true</code> skips this"}], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 10864518, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PjqGuA7MMNY/AAAAAAAAAAI/AAAAAAAAF0I/HPkliFqFwxo/photo.jpg?sz=128", "display_name": "Levi Miller", "link": "https://stackoverflow.com/users/10864518/levi-miller"}, "is_accepted": true, "score": 0, "last_activity_date": 1574461628, "creation_date": 1574461628, "answer_id": 59002564, "question_id": 58905985, "link": "https://stackoverflow.com/questions/58905985/error-in-the-association-of-two-models-must-exists/59002564#59002564", "title": "Error in the association of two models. (# must exists)", "body": "<p>The <code>Author must exist</code> error indicates that your new post is failing a validation: the presence of a value for the <code>author_id</code> attribute which links a post to an author. This validation comes bundled by default with the <code>belongs_to</code> association helper method (and can be disabled as per Simon Franzen's comment above: <code>belongs_to: model, optional: true</code>. </p>\n\n<p>Since you're permitting the <code>author_id</code> key in <code>post_params</code>, the weak link in the chain is either your <code>post#create</code> controller action or your <code>_form.html.erb</code> view. A couple of suggestions for <code>post#create</code>, and <code>_form.html.erb</code>, respectively:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create\n  post = Post.create(post_params)\n  redirect_to post\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;%= form_with model: @post do |form| %&gt;\n  ...\n  &lt;%= form.label :author %&gt;\n  &lt;%= form.collection_select :author_id, Author.all, :id, :name %&gt;\n  ...\n  &lt;%= form.submit \"Create Post\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>We need more of the code for your post controller actions and form view to give a more precise answer.</p>\n"}], "owner": {"reputation": 93, "user_id": 12274081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0Sb30wxuTys/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-hHDKdk2bthA8tdaQ1vGtEA5RrQ/photo.jpg?sz=128", "display_name": "SsPay", "link": "https://stackoverflow.com/users/12274081/sspay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 59002564, "answer_count": 1, "score": 0, "last_activity_date": 1574461628, "creation_date": 1574031190, "question_id": 58905985, "link": "https://stackoverflow.com/questions/58905985/error-in-the-association-of-two-models-must-exists", "title": "Error in the association of two models. (# must exists)", "body": "<p>I want to be able to choose an author when creating a post. I have a Post and Author model. In the author's model, I prescribed <code>has_many :posts</code>, and in the Post model <code>belongs_to :author</code>. In the form view, created a list of authors <code>&lt;%= form.collection_select(:author_id, Author.all, :id, :last_name, class:'form-control' ) %&gt;</code>. In the post controller I prescribed: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    def post_params\n       params.require(:post).permit(:name, :title, :content, :picture, :author_id)\n    end\n</code></pre>\n\n<p>schema.rb:</p>\n\n<pre><code>  create_table \"posts\", force: :cascade do |t|\n    t.string \"name\"\n    t.string \"title\"\n    t.text \"content\"\n    t.datetime \"created_at\", precision: 6, null: false\n    t.datetime \"updated_at\", precision: 6, null: false\n    t.integer \"author_id\"\n    t.index [\"author_id\"], name: \"index_posts_on_author_id\"\n  end\n</code></pre>\n\n<p>But when creating a post, I get an error:\n<code>Author must exist</code></p>\n\n<p>logs:</p>\n\n<pre><code>Started POST \"/posts\" for ::1 at 2019-11-18 00:51:40 +0200\nProcessing by PostsController#create as HTML\n  Parameters: {\"authenticity_token\"=&gt;\"68iOabMzXQPuvC83f5Oe3kQEl5rFeQLQNCuMjvtRZgfdArdvMs79gKs8MeTNzBcsN0dRjTdRVCFkIrvZqixY1g==\", \"post\"=&gt;{\"author_id\"=&gt;\"2\", \"name\"=&gt;\"SomeName\", \"title\"=&gt;\"SomeTitle\", \"content\"=&gt;\"SomeContent\"}, \"commit\"=&gt;\"Submit\"}\n  Rendering posts/new.html.erb within layouts/application\n  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT \"authors\".* FROM \"authors\"[0m\n  \u21b3 app/views/posts/_form.html.erb:16\n  Rendered posts/_form.html.erb (Duration: 8.2ms | Allocations: 2071)\n  Rendered posts/new.html.erb within layouts/application (Duration: 9.1ms | Allocations: 2157)\nCompleted 200 OK in 34ms (Views: 30.4ms | ActiveRecord: 0.2ms | Allocations: 13745)```\n\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1574026890, "post_id": 58905337, "comment_id": 104073657, "body": "Welcome to SO! Please investigate what tags are defined as rather than attach them willie-nillie. <a href=\"https://stackoverflow.com/questions/tagged/happy\">happy</a> is a YACC parser generator for the Hascal language, which has nothing to do with your question."}, {"owner": {"reputation": 3, "user_id": 12388099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c34ba255c1e0601aa7af7723c7581986?s=128&d=identicon&r=PG&f=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/12388099/maverick"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574028465, "post_id": 58905337, "comment_id": 104074106, "body": "Oh sorry! I was going to delete that but got distracted and forgot to."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12388099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c34ba255c1e0601aa7af7723c7581986?s=128&d=identicon&r=PG&f=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/12388099/maverick"}, "edited": false, "score": 0, "creation_date": 1574028403, "post_id": 58905464, "comment_id": 104074096, "body": "Thank you for this. I am new to learning ruby and wanted to see how to incorporate methods together for simplicity and this helped out a lot."}], "tags": [], "owner": {"reputation": 14340, "user_id": 2612259, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/70fec6995fdcaebf6362e10bd501f34f?s=128&d=identicon&r=PG", "display_name": "nPn", "link": "https://stackoverflow.com/users/2612259/npn"}, "is_accepted": true, "score": 0, "last_activity_date": 1574028126, "last_edit_date": 1574028126, "creation_date": 1574026763, "answer_id": 58905464, "question_id": 58905337, "link": "https://stackoverflow.com/questions/58905337/happy-birthday-method-simple-way/58905464#58905464", "title": "Happy birthday method -- simple way", "body": "<p>It seems like a small modification to the second method would do what you want. </p>\n\n<pre><code>def happy_birthday(birthday_kids, age_appropriate = false)\n  birthday_kids.each do |kid,age|\n    if (age &lt; 13 || !age_appropriate) \n      puts \"Happy Birthday #{kid}! You are now #{age} years old!\"\n    else\n      puts \"#{kid} you are too old for this.\"\n    end \n  end \nend\n</code></pre>\n\n<p>If this method were part of a class,  the class itself could hold the info as to how it should greet.</p>\n\n<pre><code>class BirthdayGreeter\n  def initialize(age_appropriate = false)\n    @age_appropriate = age_appropriate\n  end\n\n  def happy_birthday(birthday_kids)\n    birthday_kids.each do |kid,age|\n      if (age &lt; 13 || !@age_appropriate) \n        puts \"Happy Birthday #{kid}! You are now #{age} years old!\"\n      else\n        puts \"#{kid} you are too old for this.\"\n      end\n    end \n  end \nend\n\n\ngreeter = BirthdayGreeter.new\ngreeter_age_appropriate = BirthdayGreeter.new(true)\n\ngreeter.happy_birthday(kids)\ngreeter_age_appropriate.happy_birthday(kids)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1574033109, "creation_date": 1574033109, "answer_id": 58906181, "question_id": 58905337, "link": "https://stackoverflow.com/questions/58905337/happy-birthday-method-simple-way/58906181#58906181", "title": "Happy birthday method -- simple way", "body": "<p>There are a number of ways to do it.</p>\n\n<p>One way, which changes only one line of code, is this:</p>\n\n<pre><code>if age &lt; 13 \n  happy_birthday([[kid, age]].to_h)\n</code></pre>\n\n<p>This works because a hash <code>{name =&gt; age}</code> is interchangable with an array of tuples <code>[[name, age]]</code> for the purposes of iteration.</p>\n\n<p>Another approach which is a little more idiomatic would be to use <a href=\"https://apidock.com/ruby/Enumerable/partition\" rel=\"nofollow noreferrer\"><code>Enumerable#partition</code></a>:</p>\n\n<pre><code>def age_appropriate_birthday(birthday_kids)\n  young, old = birthday_kids.parititon { |name, age| age &lt; 13 }\n  happy_birthday(young)\n  old.each { |name, age| puts \"#{kid} you are too old for this.\" }\nend\n</code></pre>\n\n<p>I'm assuming that you don't want to modify your <code>happy_birthday</code> method. If you are ok with doing that, then the approach given by nPn works also.</p>\n"}], "owner": {"reputation": 3, "user_id": 12388099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c34ba255c1e0601aa7af7723c7581986?s=128&d=identicon&r=PG&f=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/12388099/maverick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 58905464, "answer_count": 2, "score": 0, "last_activity_date": 1574033786, "creation_date": 1574025819, "last_edit_date": 1574033786, "question_id": 58905337, "link": "https://stackoverflow.com/questions/58905337/happy-birthday-method-simple-way", "title": "Happy birthday method -- simple way", "body": "<p>Can I make the second method of code simpler by incorporating the first method into my second method?</p>\n\n<pre><code>def happy_birthday(birthday_kids)\n  # add your code snippet here!\n  birthday_kids.each do |kids_name, age|\n    puts \"Happy Birthday #{kids_name}! You are now #{age} years old!\"\n  end\nend\n\ndef age_appropriate_birthday(birthday_kids)\n  birthday_kids.each do |kid,age|\n    if age &lt; 13 \n      puts \"Happy Birthday #{kid}! You are now #{age} years old!\"\n    else\n      puts \"You are too old for this.\"\n    end \n  end \nend\n</code></pre>\n"}, {"tags": ["sql", "ruby"], "comments": [{"owner": {"reputation": 188041, "user_id": 10676716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/arsQA.jpg?s=128&g=1", "display_name": "GMB", "link": "https://stackoverflow.com/users/10676716/gmb"}, "edited": false, "score": 4, "creation_date": 1574025731, "post_id": 58905301, "comment_id": 104073356, "body": "mysql &lt;&gt; sql-server &lt;&gt; postgresql. I removed the conflicting tags, please just add the revelant one."}, {"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 1, "creation_date": 1574027124, "post_id": 58905301, "comment_id": 104073726, "body": "Why <i>would</i> you want this behaviour? If you don&#39;t want the product deleted then you have to turn cascading (or the RDBMS equivalent functionality) off, however, a <code>FOREIGN KEY</code> that references a foreign key that doesn&#39;t exist is an untrusted foreign key, and therefore a <i>pointless</i> <code>FOREIGN KEY</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574027234, "post_id": 58905301, "comment_id": 104073758, "body": "The behavior you&#39;re seeing is by design. Not removing the products will result in orphaned records which can waste space and make a database inefficient or worse, return wrong results. I&#39;d recommend reading some database design tutorials."}, {"owner": {"reputation": 31386, "user_id": 9661424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnnvz.png?s=128&g=1", "display_name": "sticky bit", "link": "https://stackoverflow.com/users/9661424/sticky-bit"}, "edited": false, "score": 0, "creation_date": 1574027462, "post_id": 58905301, "comment_id": 104073829, "body": "Maybe you want a linking table for products and farms, so that a product can independently exist with none, one, or more than one farm producing it? Or is every product special to a farm? In that case it doesn&#39;t make sense to keep the product if the farm goes down. There&#39;s no one to produce it anymore."}, {"owner": {"reputation": 861, "user_id": 425281, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/2f4b46fc38ea6e686de02924c72414ea?s=128&d=identicon&r=PG", "display_name": "arivero", "link": "https://stackoverflow.com/users/425281/arivero"}, "edited": false, "score": 0, "creation_date": 1574027979, "post_id": 58905301, "comment_id": 104073969, "body": "most sql databases allow other behaviours, for instance you cour try ON DELETE SET NULL"}], "owner": {"reputation": 11, "user_id": 12388288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd649a41aad0d373e00fba5d21b4b374?s=128&d=identicon&r=PG&f=1", "display_name": "weinbecher", "link": "https://stackoverflow.com/users/12388288/weinbecher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574027124, "creation_date": 1574025582, "last_edit_date": 1574027124, "question_id": 58905301, "link": "https://stackoverflow.com/questions/58905301/how-to-keep-an-entry-in-the-database-when-deleting-a-row-with-foreign-key", "title": "How to keep an entry in the database when deleting a row with foreign key", "body": "<p>I have my database setup like this:</p>\n\n<pre><code>CREATE TABLE farms\n(\n  id SERIAL8 primary key,\n  name VARCHAR(255) not null,\n  address VARCHAR(255),\n  phone_num VARCHAR(255)\n);\n\nCREATE TABLE products\n(\n  id SERIAL8 primary key,\n  name VARCHAR(255) not null,\n  description VARCHAR(255),\n  stock FLOAT,\n  cost FLOAT,\n  price FLOAT,\n  farm_id INT8 references farms(id)\n)\n</code></pre>\n\n<p>The issue that I have is when I delete a farm, it's also deleting all of the products that are available in that farm, but I only want to delete the farm, and not the product.</p>\n\n<p>This is the method I have that deletes the farm</p>\n\n<pre><code>  def delete\n    sql = \"DELETE FROM farms WHERE id = $1\"\n    values = [@id]\n    SqlRunner.run(sql, values)\n  end\n</code></pre>\n\n<p>Is the problem with how I'm building the tables, or is my SQL statement incorrect?</p>\n"}, {"tags": ["ruby", "operation"], "comments": [{"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "edited": false, "score": 1, "creation_date": 1574025905, "post_id": 58905279, "comment_id": 104073398, "body": "You can find a similar example in this questions: <a href=\"https://stackoverflow.com/questions/31331287/no-method-error-ruby-calculator\" title=\"no method error ruby calculator\">stackoverflow.com/questions/31331287/&hellip;</a> or <a href=\"https://stackoverflow.com/questions/38649405/making-ruby-calculator-run-continuously\" title=\"making ruby calculator run continuously\">stackoverflow.com/questions/38649405/&hellip;</a> or <a href=\"https://stackoverflow.com/questions/25572500/why-isnt-this-ruby-calculator-working-as-intended\" title=\"why isnt this ruby calculator working as intended\">stackoverflow.com/questions/25572500/&hellip;</a>"}, {"owner": {"reputation": 53, "user_id": 12388267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDOJR8bN_EURKbdOUy0eHYj0bBcWSFycRou2kBE1A=k-s128", "display_name": "Ernani Rocha", "link": "https://stackoverflow.com/users/12388267/ernani-rocha"}, "reply_to_user": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "edited": false, "score": 0, "creation_date": 1574029950, "post_id": 58905279, "comment_id": 104074433, "body": "Thanks so much @knut, but is there a way to convert &quot;+&quot; into a operator, but using gets?"}], "answers": [{"tags": [], "owner": {"reputation": 930, "user_id": 3577922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eURpm.jpg?s=128&g=1", "display_name": "Masa Sakano", "link": "https://stackoverflow.com/users/3577922/masa-sakano"}, "is_accepted": true, "score": 2, "last_activity_date": 1574058602, "creation_date": 1574058602, "answer_id": 58909053, "question_id": 58905279, "link": "https://stackoverflow.com/questions/58905279/ruby-get-a-operator-and-make-it-work-as-one/58909053#58909053", "title": "Ruby Get a operator and make it work as one", "body": "<p>In Ruby an operator is basically a method.  Do this:</p>\n\n<pre><code>puts num1.to_i.public_send(op.chomp, num2.to_i)\n</code></pre>\n\n<p>With <a href=\"https://docs.ruby-lang.org/en/2.6.0/Object.html#method-i-public_send\" rel=\"nofollow noreferrer\"><code>Object#public_send</code></a>, you can send a (public) method specified either with String or Symbol.\nNote if your Ruby version is old, you may need replace <code>public_send</code> with <code>send</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 12388267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDOJR8bN_EURKbdOUy0eHYj0bBcWSFycRou2kBE1A=k-s128", "display_name": "Ernani Rocha", "link": "https://stackoverflow.com/users/12388267/ernani-rocha"}, "edited": false, "score": 0, "creation_date": 1574102318, "post_id": 58914016, "comment_id": 104103079, "body": "<code>num1 = 2 num2 = 3 op = +  puts (num1 op.public_send num2)</code>   Thanks so much for taking the time.  Why my code above won&#180;t work?"}, {"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "reply_to_user": {"reputation": 53, "user_id": 12388267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDOJR8bN_EURKbdOUy0eHYj0bBcWSFycRou2kBE1A=k-s128", "display_name": "Ernani Rocha", "link": "https://stackoverflow.com/users/12388267/ernani-rocha"}, "edited": false, "score": 0, "creation_date": 1574104632, "post_id": 58914016, "comment_id": 104104116, "body": "Why should it? I guess there are some newlines missing. You can replace it with a semicolon. I guess you look for <code>num1 = 2 ; num2 = 3 ; op = &#39;+&#39; ; puts num1.public_send(op, num2)</code> Error 1: plus must be a string. Error 2: <code>public_send</code>is a method of Integer (here num1). - Bus this is a new question."}], "tags": [], "owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "is_accepted": false, "score": 0, "last_activity_date": 1574078085, "creation_date": 1574078085, "answer_id": 58914016, "question_id": 58905279, "link": "https://stackoverflow.com/questions/58905279/ruby-get-a-operator-and-make-it-work-as-one/58914016#58914016", "title": "Ruby Get a operator and make it work as one", "body": "<p>As you can see in other answers, you can use <code>send</code> (or <code>public_send</code>) to call a method.</p>\n\n<p>There is one problem: <code>gets</code> includes a newline (e.g. <code>+\\n</code>). The <code>to_i</code> method can handle this. <code>send</code> tries to find a methos with the newline (and will not find it). So you have to remove the newline from operator (using the <code>strip</code>-method.</p>\n\n<p>So the complete example:</p>\n\n<pre><code>puts \"Tell me a number\"\nnum1 = gets\nputs \"Tell me an another number\"\nnum2 = gets\nputs \"Tell me an operator\"\nop = gets\n\nputs num1.to_i.send( op.strip,  num2.to_i)\n</code></pre>\n\n<p>I would recommend to convert the values immediate after reading it, it makes life easier later:</p>\n\n<pre><code>puts \"Tell me a number\"\nnum1 = gets.to_i\nputs \"Tell me an another number\"\nnum2 = gets.to_i\nputs \"Tell me an operator\"\nop = gets.strip\n\nputs num1.public_send( op,  num2)\n</code></pre>\n\n<p>Be aware, there is no check for valid operators. When you enter</p>\n\n<pre><code>1\n2\nu\n</code></pre>\n\n<p>you get a <code>undefined method 'u' for 1:Integer (NoMethodError)</code>-error.</p>\n"}], "owner": {"reputation": 53, "user_id": 12388267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDOJR8bN_EURKbdOUy0eHYj0bBcWSFycRou2kBE1A=k-s128", "display_name": "Ernani Rocha", "link": "https://stackoverflow.com/users/12388267/ernani-rocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58909053, "answer_count": 2, "score": 0, "last_activity_date": 1574078085, "creation_date": 1574025421, "question_id": 58905279, "link": "https://stackoverflow.com/questions/58905279/ruby-get-a-operator-and-make-it-work-as-one", "title": "Ruby Get a operator and make it work as one", "body": "<p>Noob to the extreme here. </p>\n\n<p>How can I make this operator work?</p>\n\n<pre><code>puts \"Tell me a number\"\nnum1 = gets\nputs \"Tell me an another number\"\nnum2 = gets\nputs \"Tell me an operator\"\nop = gets\n\nputs num1.to_i op num2.to_i\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 12274081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0Sb30wxuTys/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-hHDKdk2bthA8tdaQ1vGtEA5RrQ/photo.jpg?sz=128", "display_name": "SsPay", "link": "https://stackoverflow.com/users/12274081/sspay"}, "edited": false, "score": 0, "creation_date": 1574021364, "post_id": 58904635, "comment_id": 104072105, "body": "Nothing changed :("}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 93, "user_id": 12274081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0Sb30wxuTys/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-hHDKdk2bthA8tdaQ1vGtEA5RrQ/photo.jpg?sz=128", "display_name": "SsPay", "link": "https://stackoverflow.com/users/12274081/sspay"}, "edited": false, "score": 0, "creation_date": 1574022035, "post_id": 58904635, "comment_id": 104072303, "body": "Can you add the whole you&#39;re getting and the lines of code where it&#39;s produced?"}, {"owner": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 2, "creation_date": 1574023780, "post_id": 58904635, "comment_id": 104072834, "body": "Once you do what @SebastianPalma suggests, then you have to change your params to this: <code>params.require(:post).permit(:name, :title, :content, :picture, :author_id)</code>"}, {"owner": {"reputation": 93, "user_id": 12274081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0Sb30wxuTys/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-hHDKdk2bthA8tdaQ1vGtEA5RrQ/photo.jpg?sz=128", "display_name": "SsPay", "link": "https://stackoverflow.com/users/12274081/sspay"}, "edited": false, "score": 0, "creation_date": 1574025526, "post_id": 58904635, "comment_id": 104073304, "body": "I did so, but now instead of the names of the authors, their id is listed."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1574025757, "post_id": 58904635, "comment_id": 104073364, "body": "What do you mean?"}, {"owner": {"reputation": 93, "user_id": 12274081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0Sb30wxuTys/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-hHDKdk2bthA8tdaQ1vGtEA5RrQ/photo.jpg?sz=128", "display_name": "SsPay", "link": "https://stackoverflow.com/users/12274081/sspay"}, "edited": false, "score": 0, "creation_date": 1574026381, "post_id": 58904635, "comment_id": 104073521, "body": "Your decision helped me, thanks. Just earlier, when creating a post, the names of the authors were displayed in the list, and it was convenient to choose. And right now instead of them their id."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1574024700, "last_edit_date": 1574024700, "creation_date": 1574020832, "answer_id": 58904635, "question_id": 58904513, "link": "https://stackoverflow.com/questions/58904513/error-in-association-of-two-models-associationtypemismatch/58904635#58904635", "title": "Error in association of two models (AssociationTypeMismatch)", "body": "<p>You need to pass the id when constructing the select tag.</p>\n\n<p>Try: </p>\n\n<pre><code>&lt;%= form.select :author, Author.pluck(:id, :first_name) %&gt;\n</code></pre>\n\n<p>Which creates a selector where the value is the author <code>id</code> and the text is the author <code>first_name</code>.</p>\n\n<p>As stated also by @Chiperific in the comments, you need to update your <code>post_params</code> to allow an <code>author_id</code> instead of an <code>author</code>.</p>\n"}], "owner": {"reputation": 93, "user_id": 12274081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0Sb30wxuTys/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-hHDKdk2bthA8tdaQ1vGtEA5RrQ/photo.jpg?sz=128", "display_name": "SsPay", "link": "https://stackoverflow.com/users/12274081/sspay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 58904635, "answer_count": 1, "score": 1, "last_activity_date": 1574024700, "creation_date": 1574019983, "last_edit_date": 1574023849, "question_id": 58904513, "link": "https://stackoverflow.com/questions/58904513/error-in-association-of-two-models-associationtypemismatch", "title": "Error in association of two models (AssociationTypeMismatch)", "body": "<p>I want to be able to choose an author when creating a post. I have a Post and Author model. In the author's model, I prescribed <code>has_many :posts</code>, and in the Post model <code>belongs_to :author</code>. In the form view, created a list of authors <code>&lt;%= form.select(:author, Author.all.collect {|p| [ p.first_name] }) %&gt;</code> In the post controller I prescribed:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    def post_params\n      params.require(:post).permit(:title, :content, :picture, :author)\n    end\n</code></pre>\n\n<p>However, when creating a post I get an error <code>ActiveRecord::AssociationTypeMismatch in PostsController#create</code> <code>Author(#70151313190260) expected, got \"AuthorName\" which is an instance of String(#47111701634520)</code> </p>\n\n<p>UPD.\nAll that i'm getting:</p>\n\n<pre><code>Started POST \"/posts\" for ::1 at 2019-11-17 22:39:33 +0200\nProcessing by PostsController#create as HTML\n  Parameters: {\"authenticity_token\"=&gt;\"o8rcT1Jo/seI+zs+CRa6Ro3Wu14oz7OJ9zE0OLgtjkWVAOVJ05VeRM17Je27STO0/pV9Sdrn5XinOANv6VCwlA==\", \"post\"=&gt;{\"author\"=&gt;\"4\", \"title\"=&gt;\"TitleName\", \"content\"=&gt;\"SomeContent\"}, \"commit\"=&gt;\"Submit\"}\nCompleted 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms | Allocations: 842)\n\n\n\nActiveRecord::AssociationTypeMismatch (Author(#69935628031800) expected, got \"4\" which is an instance of String(#47189092695520)):\n\napp/controllers/posts_controller.rb:27:in `create'\n</code></pre>\n\n<p>def create in post_controller:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create\n    @post = Post.new(post_params)\n    respond_to do |format|\n      if @post.save\n        format.html { redirect_to @post, notice: 'Post was successfully created.' }\n        format.json { render :show, status: :created, location: @post }\n      else\n        format.html { render :new }\n        format.json { render json: @post.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n#before action\ndef set_post\n  @post = Post.find(params[:id])\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1574019863, "post_id": 58904370, "comment_id": 104071700, "body": "Welcome, Alex! You say Ruby 2.5.1, but your logs show Ruby 2.5.0 being used."}, {"owner": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1574019874, "post_id": 58904370, "comment_id": 104071705, "body": "Also, does this question help: <a href=\"https://stackoverflow.com/questions/55030300/rails-server-dies-with-eafnosupport-windows-10-ruby-2-4-rails-4-2-thin\" title=\"rails server dies with eafnosupport windows 10 ruby 2 4 rails 4 2 thin\">stackoverflow.com/questions/55030300/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 12387953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd78869eee8c66dac6ed276c5f15a406?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/12387953/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1574136139, "creation_date": 1574136139, "answer_id": 58926456, "question_id": 58904370, "link": "https://stackoverflow.com/questions/58904370/fail-to-start-rails-project-address-incompatible-with-the-requested-protocol/58926456#58926456", "title": "Fail to start Rails project address incompatible with the requested protocol", "body": "<p>SOLVED:\nIn order to run the app on windows 10 the running  server has to be  switched to Puma and forcing it to IPv6 \n\ufeff</p>\n\n<ul>\n<li>gem 'puma' </li>\n<li>bundle</li>\n<li>bundle install</li>\n<li>rails s -b[::]</li>\n</ul>\n"}], "owner": {"reputation": 69, "user_id": 12387953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd78869eee8c66dac6ed276c5f15a406?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/12387953/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574136139, "creation_date": 1574019064, "last_edit_date": 1574020254, "question_id": 58904370, "link": "https://stackoverflow.com/questions/58904370/fail-to-start-rails-project-address-incompatible-with-the-requested-protocol", "title": "Fail to start Rails project address incompatible with the requested protocol", "body": "<p>I am failing to run a Rails project. </p>\n\n<p>The project was developed on Mac OS and I am trying to run it on Windows 10</p>\n\n<p>Getting the error: </p>\n\n<pre><code>C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/em/pure_ruby.rb:1054:in `bind': An address incompatible with the requested protocol was used. - bind(2) for [::1]:3000 (Errno::EAFNOSUPPORT)\n</code></pre>\n\n<p>Using:</p>\n\n<ul>\n<li><p>ruby '2.5.1'</p></li>\n<li><p>rails '5.2.0'</p></li>\n</ul>\n\n<pre><code>Traceback (most recent call last):\n31: from bin/rails:4:in `&lt;main&gt;'\n30: from bin/rails:4:in `require'\n29: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n28: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/command.rb:46:in `invoke'\n27: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/command/base.rb:65:in `perform'\n26: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/thor-0.20.0/lib/thor.rb:387:in `dispatch'\n25: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\n24: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\n23: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/commands/server/server_command.rb:142:in `perform'\n22: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/commands/server/server_command.rb:142:in `tap'\n21: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/commands/server/server_command.rb:147:in `block in perform'\n20: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/commands/server/server_command.rb:53:in `start'\n19: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/rack-2.0.5/lib/rack/server.rb:297:in `start'\n18: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/rack-2.0.5/lib/rack/handler/thin.rb:22:in `run'\n17: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/thin-1.7.2/lib/thin/server.rb:162:in `start'\n16: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/thin-1.7.2/lib/thin/backends/base.rb:73:in `start'\n15: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/eventmachine.rb:196:in `run'\n14: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/em/pure_ruby.rb:144:in `run_machine'\n13: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/em/pure_ruby.rb:547:in `run'\n12: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/em/pure_ruby.rb:547:in `loop'\n11: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/em/pure_ruby.rb:551:in `block in run'\n10: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/em/pure_ruby.rb:568:in `run_timers'\n 9: from C:/Ruby25/lib/ruby/2.5.0/set.rb:774:in `each'\n 8: from C:/Ruby25/lib/ruby/2.5.0/set.rb:774:in `each'\n 7: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/em/pure_ruby.rb:571:in `block in run_timers'\n 6: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/eventmachine.rb:1546:in `event_callback'\n 5: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/thin1.7.2/lib/thin/backends/base.rb:63:in `block in start'\n 4: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/thin1.7.2/lib/thin/backends/tcp_server.rb:16:in `connect'\n 3: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/eventmachine.rb:532:in `start_server'\n 2: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/em/pure_ruby.rb:185:in `start_tcp_server'\n 1: from C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/em/pure_ruby.rb:1054:in `start_server' C:/Ruby25/lib/ruby/gems/2.5.0/gems/eventmachine-1.2.7-x86-mingw32/lib/em/pure_ruby.rb:1054:in `bind': An address incompatible with the requested protocol was used. - bind(2) for [::1]:3000 (Errno::EAFNOSUPPORT)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1574016065, "post_id": 58903409, "comment_id": 104070577, "body": "You can maybe check <code>self.class.instance_methods.include?(sym)</code> inside the method missing. Or, you could define <code>address</code> somewhere else other than on the global scope"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1574017465, "post_id": 58903409, "comment_id": 104070990, "body": "Try your code in a file, not in REPL. It works pretty fine as is unless tweaks are set by IRB/Pry (the global scope functions all of a sudden become defined as private methods <i>of <code>Object</code></i>.)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574017577, "post_id": 58903409, "comment_id": 104071034, "body": "<i>Sidenote:</i> you effectively discard the ability to pass and handle the block to the missing method. The correct signature is <code>method_missing(m, *args, &amp;\u03bb)</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1574031391, "post_id": 58903409, "comment_id": 104074741, "body": "<code>name</code> and <code>address</code> are both instance methods of <code>Person</code>. Therefore, for <code>p = Person.new</code>, <code>p.name</code> and <code>p.address</code> obviously return <code>&quot;My name is Person&quot;</code> and <code>&quot;address&quot;</code>.  If you want <code>p.address</code> to return something else you must change the method <code>address</code>. I really don&#39;t understand what you are trying to do."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1574032140, "post_id": 58903409, "comment_id": 104074873, "body": "I guess you could add <code>class Person; def address; &quot;#{super} not defined on #{self}&quot;; end; end</code>. Then <code>Person.new.address</code> displays  <code>&quot;address not defined on #&lt;Person:0x00005a2398d02b20&gt;&quot;</code>, but seems like unneeded complexity."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4121317, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lN9Jwhjb2dQ/AAAAAAAAAAI/AAAAAAAAAEQ/AdNOV_JQvy8/photo.jpg?sz=128", "display_name": "annonymous", "link": "https://stackoverflow.com/users/4121317/annonymous"}, "edited": false, "score": 0, "creation_date": 1574092577, "post_id": 58904390, "comment_id": 104098232, "body": "The above code is an just an example. My main pblm is   p = Person.new     p.address  &lt;/br&gt;     this should call method_missing only. that is the method lookup should happen within   Person scope only."}], "tags": [], "owner": {"reputation": 14340, "user_id": 2612259, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/70fec6995fdcaebf6362e10bd501f34f?s=128&d=identicon&r=PG", "display_name": "nPn", "link": "https://stackoverflow.com/users/2612259/npn"}, "is_accepted": false, "score": 0, "last_activity_date": 1574019151, "creation_date": 1574019151, "answer_id": 58904390, "question_id": 58903409, "link": "https://stackoverflow.com/questions/58903409/prevent-methods-lookup-in-ancestor-chainmethod-missing/58904390#58904390", "title": "Prevent methods lookup in ancestor chain(method_missing)", "body": "<p>As @AlekseiMatiushkin says the code works fine in a file.  If you really need it to work the way you want in irb, you could define address as a class method</p>\n\n<pre><code>def self.address \n  p \"address\" \nend \n</code></pre>\n\n<p>then missing_method will not find it as an instance method of Object, but you can still call <code>address</code> as if it were a global function.</p>\n"}], "owner": {"reputation": 21, "user_id": 4121317, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lN9Jwhjb2dQ/AAAAAAAAAAI/AAAAAAAAAEQ/AdNOV_JQvy8/photo.jpg?sz=128", "display_name": "annonymous", "link": "https://stackoverflow.com/users/4121317/annonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574019151, "creation_date": 1574013166, "last_edit_date": 1574014224, "question_id": 58903409, "link": "https://stackoverflow.com/questions/58903409/prevent-methods-lookup-in-ancestor-chainmethod-missing", "title": "Prevent methods lookup in ancestor chain(method_missing)", "body": "<p>i have a code as below <br/></p>\n\n<pre><code>def address \n  p \"address\" \nend \n\nclass Person \n  def method_missing(sym, *args) \n     \"#{sym} not defined on #{self}\" \n  end\n\n  def name \n    \"My name is Person\" \n  end\nend\n\np = Person.new \np.name # =&gt; My name is Person \np.address # =&gt; expected output is 'address not defined on # &lt;Person:0x007fb2bb022fe0&gt;' but actual output is 'address' \n</code></pre>\n\n<p>I want to leverage method_missing. But lexical scoping comes to play here. So method_missing becomes obsolete. any workaround?</p>\n"}, {"tags": ["ruby", "selenium", "while-loop"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1574011405, "post_id": 58902681, "comment_id": 104069172, "body": "Kind of a shot in the dark without a working example, but a couple of questions come to mind.  Is there a limit to the number of times that &quot;Load More&quot; is displayed or can be clicked?  Otherwise, it&#39;s an infinite loop.  And why not collect/map the first 24 links or data into an array, then click &quot;Load More&quot;, and append the next 24 links/data into the array?  Repeat til whenever you want to break..."}], "answers": [{"tags": [], "owner": {"reputation": 624, "user_id": 7188109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f0d98756028ef12c8cdbf8d89a2a259?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 D\u0105browski", "link": "https://stackoverflow.com/users/7188109/pawe%c5%82-d%c4%85browski"}, "is_accepted": false, "score": 0, "last_activity_date": 1574011533, "creation_date": 1574011533, "answer_id": 58903149, "question_id": 58902681, "link": "https://stackoverflow.com/questions/58902681/is-there-another-way-to-only-get-last-loaded-data-using-while-loop-in-ruby/58903149#58903149", "title": "Is there another way to only get last loaded data using while loop in Ruby", "body": "<p>You know how many records are loaded each time you hit the load more button so you can easily access only new records in the <code>seller_url</code> array:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>items_per_page = 24\n\nwhile driver.page_source.include? \"Load more\"\n  # ...\n\n  seller_url = wait.until {\n    element = driver.find_elements(:css, \".desktop__itemOneFourth___2t71A .styles__link___9msaS:nth-child(1)\")\n  }\n\n  seller_url.last(items_per_page).each do |line|\n    # do stuff\n  end\n\n  pages_loaded += 1\nend\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 2112204, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/6e131ead37a7d2311b317f1a3c61a167?s=128&d=identicon&r=PG", "display_name": "Ruel Nopal", "link": "https://stackoverflow.com/users/2112204/ruel-nopal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574011533, "creation_date": 1574008582, "last_edit_date": 1574008926, "question_id": 58902681, "link": "https://stackoverflow.com/questions/58902681/is-there-another-way-to-only-get-last-loaded-data-using-while-loop-in-ruby", "title": "Is there another way to only get last loaded data using while loop in Ruby", "body": "<p>I'm doing a web scraping with a dynamic website that has a <strong>\"Load more\"</strong> button. Though I solve the load more problems by using a while loop. It has another challenge when I try to scrape the data it just keeps multiplying. So the first batch of data is 24 data when I scrape the second batch it also scrapes the first batch so it scrape 48 data with only 24 new data being added and soon.</p>\n\n<p>heres my code.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>        require \"selenium-webdriver\"\n\n        driver = Selenium::WebDriver.for :chrome\n        url =\"https://www.example.com/categories/car-parts\"\n\n        driver.navigate.to \"#{url}\"\n        wait = Selenium::WebDriver::Wait.new(:timeout =&gt; 20)\n\n        while driver.page_source.include? \"Load more\"\n\n            load_more = wait.until {\n              load_more_element = driver.find_element(css: \".styles__loadMore___yYAF4\")\n            }\n            sleep 3\n            load_more.click()\n            puts \"load_more\"\n            sleep 3\n\n            seller_url = wait.until {\n          element = driver.find_elements(:css, \".desktop__itemOneFourth___2t71A .styles__link___9msaS:nth-child(1)\")\n\n        }\n            seller_url.each do |line|\n                seller_uri = line.attribute(\"href\")\n                seller_hand = seller_uri[/https:\\/\\/www.example.com(.*\\/([.\\w+]+))/i]\n\n                seller_handle =  seller_hand.gsub(\"https://www.example.com/\", \"\")\n\n                seller = Seller.new\n                seller.seller_url = seller_uri\n                seller.seller_handle = seller_handle\n\n                seller.save\n                puts seller_handle\n            end\n\n            puts seller_url.size\n            sleep 3\n</code></pre>\n\n<p>What I want is that i continues to load but i want to scrape the last loaded batch minus all the previous batch.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1574012806, "post_id": 58902582, "comment_id": 104069586, "body": "You can&#39;t because you&#39;re not using the <code>conversations</code> table at any moment. Try with <code>User.joins(:sender_conversations, :recipient_conversations).order(&#39;conversations.created_at&#39;)</code>."}, {"owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1574013500, "post_id": 58902582, "comment_id": 104069776, "body": "@SebastianPalma joining causes the query to return no results. really lost on this one. essentially, i just need to query all users that have a conversation thread going, whether they&#39;re the sender or receiver"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1574014104, "post_id": 58902582, "comment_id": 104069940, "body": "Yes, you&#39;re right. Try a theta join using the <code>IN</code> clause <code>User.joins(&#39;INNER JOIN conversations ON users.id IN (conversations.sender_id, conversations.recipient_id)&#39;).order(&#39;conversations.created_a&zwnj;&#8203;t&#39;)</code>."}, {"owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1574014359, "post_id": 58902582, "comment_id": 104070022, "body": "@SebastianPalma you save me again. that worked. I don&#39;t know if I mentioned, but I&#39;m tasked with finishing an already started rails project after having zero experience with ruby and ruby on rails. and their design choices are horrible. do you want to put an answer so I can mark as accepted?"}], "answers": [{"comments": [{"owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "edited": false, "score": 0, "creation_date": 1574014882, "post_id": 58903648, "comment_id": 104070210, "body": "many thanks, sir. I did notice that if I change the order to use &quot;asc&quot; instead, the results are a bit funky. For instance, I&#39;m getting an order on a few rows like <code>nov 17,2019 1:11PM</code>,  <code>nov 17,2019 11:01AM</code>, <code>nov 17,2019 1:11PM</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "edited": false, "score": 0, "creation_date": 1574015150, "post_id": 58903648, "comment_id": 104070293, "body": "You&#39;re welcome ;). Is that wrong? Are these values from the users or conversations rows?"}, {"owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "edited": false, "score": 0, "creation_date": 1574015397, "post_id": 58903648, "comment_id": 104070378, "body": "when the order is <code>.order(&#39;conversations.updated_at desc&#39;)</code> , it&#39;s correct. but when changed to <code>.order(&#39;conversations.updated_at asc&#39;)</code>, the 11:01AM should come before the 1:11PM rows. not sure why it&#39;s doing that. and this is from the conversations table. the <code>updated_at</code> column."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "edited": false, "score": 0, "creation_date": 1574015739, "post_id": 58903648, "comment_id": 104070485, "body": "That&#39;s because you&#39;re accessing the conversations from each user. Every pair of conversations (recipient, sender) are sorted by the order you specify with <code>order</code>. If you need to access the conversations columns, you should start from that table and then include users."}, {"owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "edited": false, "score": 1, "creation_date": 1574015942, "post_id": 58903648, "comment_id": 104070547, "body": "I did think that made more sense, but I wasn&#39;t sure how. If there are 4 rows in the conversations table, there still may be 6 users i&#39;d have to grab since it&#39;s focused on the sender and receiver foreign key columns. I&#39;ll keep what I have no and get rid of the time. hehe. thanks again"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 1, "last_activity_date": 1574014578, "creation_date": 1574014578, "answer_id": 58903648, "question_id": 58902582, "link": "https://stackoverflow.com/questions/58902582/order-query-by-row-from-another-table-ruby-rails/58903648#58903648", "title": "Order query by row from another table (ruby rails)", "body": "<p>You can try with a custom <code>INNER JOIN</code> using the <code>IN</code> clause to check both <code>conversations</code>' columns:</p>\n\n<pre><code>User.joins('INNER JOIN conversations c ON users.id IN (c.sender_id, c.recipient_id)')\n    .order('c.created_at')\n</code></pre>\n"}], "owner": {"reputation": 964, "user_id": 9200273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LsHMe.jpg?s=128&g=1", "display_name": "good_afternoon", "link": "https://stackoverflow.com/users/9200273/good-afternoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 58903648, "answer_count": 1, "score": 1, "last_activity_date": 1574014578, "creation_date": 1574007846, "question_id": 58902582, "link": "https://stackoverflow.com/questions/58902582/order-query-by-row-from-another-table-ruby-rails", "title": "Order query by row from another table (ruby rails)", "body": "<p>I have somewhat of a convoluted setup.</p>\n\n<p>I am querying all users that have a thread (<code>Conversations</code>) of messages.</p>\n\n<p>My User model has a <code>has_many</code> relation on two columns in <code>Conversation</code></p>\n\n<pre><code>  has_many :sender_conversations, class_name: 'Conversation', foreign_key: \"sender_id\", dependent: :destroy\n  has_many :recipient_conversations, class_name: 'Conversation', foreign_key: \"recipient_id\", dependent: :destroy\n</code></pre>\n\n<p>I needed a way to get the latest conversation since any user can have multiple threads.</p>\n\n<p>To achieve this, I have the following methods on the user model:</p>\n\n<pre><code> def conversations\n   sender_conversations.or(recipient_conversations)\n  end\n\n  def latest_conversation\n    conversations.order(updated_at: :desc).first\n  end\n</code></pre>\n\n<p>Conversation model:</p>\n\n<pre><code>class Conversation &lt; ApplicationRecord\n  ...\n\n  belongs_to :sender, foreign_key: :sender_id, class_name: 'User'\n  belongs_to :recipient, foreign_key: :recipient_id, class_name: 'User'\n\n  ...\n\n  validates :sender_id, uniqueness: { scope: [:recipient_id, :property_id] }\n\n  scope :between, -&gt;(sender_id, recipient_id) do\n    where(sender_id: sender_id, recipient_id: recipient_id).or(\n      where(sender_id: recipient_id, recipient_id: sender_id)\n    )\n  end\n...\n</code></pre>\n\n<p>The controller action is querying users that have either a <code>sender_id</code> or <code>recipient_id</code></p>\n\n<pre><code>def users_with_existing_conversations\n    authorize! :users_with_existing_conversations, Conversation\n\n    @users = User.accessible_by(current_ability, :index_conversations)\n\n    @users = @users.where(id: Conversation.select(:sender_id))\n                    .or(@users.where(id: Conversation.select(:recipient_id)))\n\n\n    ...\n\n\n\n\n  end\n</code></pre>\n\n<p>Then finally, in the view, I'm looping through</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt;\n  &lt;tr class=\"table__row\" onclick=\"window.location.href = '/conversations?user_id=&lt;%= user.id %&gt;'\"&gt;\n    &lt;td&gt;&lt;%= user.name %&gt;(&lt;%= user.id %&gt;)&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.surname %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.email %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.company_name.present? ? user.company_name : \"N/A\" %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.role.capitalize %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.created_at.try(:strftime, '%b %d, %Y') %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.latest_conversation.updated_at.localtime.strftime('%b %d, %Y at %l:%M %p') %&gt;&lt;/td&gt;\n    &lt;td class=\"table__more\"&gt;\n      &lt;%= link_to \"Show details\", conversations_path(user_id: user.id), class: 'table__row__details button button--tertiary button--tertiary-small' %&gt;\n    &lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>Now what I can't figure out is how to order these rows by the <code>latest_conversation</code> which is the <code>updated_at</code> column.</p>\n\n<p>So I have a users table I'm querying, but I want to order the query by their relation with the conversations table's <code>updated_at</code> column.</p>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 3, "creation_date": 1574003872, "post_id": 58901929, "comment_id": 104067078, "body": "What&#39;s the way you&#39;re currently parsing it, and what&#39;s the specific problem with it? How would you measure &quot;best&quot;?"}, {"owner": {"reputation": 49, "user_id": 9913264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KXb4D.jpg?s=128&g=1", "display_name": "Maneesha Cd", "link": "https://stackoverflow.com/users/9913264/maneesha-cd"}, "reply_to_user": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1574004867, "post_id": 58901929, "comment_id": 104067295, "body": "I tried smarter_csv and Rcsv gems. But it also taking long time."}, {"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 4, "creation_date": 1574004885, "post_id": 58901929, "comment_id": 104067300, "body": "Please give a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to explain the problem."}, {"owner": {"reputation": 49, "user_id": 9913264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KXb4D.jpg?s=128&g=1", "display_name": "Maneesha Cd", "link": "https://stackoverflow.com/users/9913264/maneesha-cd"}, "reply_to_user": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1574005190, "post_id": 58901929, "comment_id": 104067384, "body": "For Eg: I have a csv file containing record of students in a school with the mark they obtained. I have to write a ruby program to find the students with mark obtained above 70. The file size is 1 GB"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574005505, "post_id": 58901929, "comment_id": 104067491, "body": "How do you parse it <b>now</b> so that it\u2019s too slow etc?"}, {"owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "edited": false, "score": 4, "creation_date": 1574005544, "post_id": 58901929, "comment_id": 104067505, "body": "Ruby provides an excellent library CSV for working with, you guessed it csv files. I would investigate the foreach and filter and parse methods provided."}, {"owner": {"reputation": 49, "user_id": 9913264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KXb4D.jpg?s=128&g=1", "display_name": "Maneesha Cd", "link": "https://stackoverflow.com/users/9913264/maneesha-cd"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1574006093, "post_id": 58901929, "comment_id": 104067653, "body": "@AlekseiMatiushkin I tried to parse it  using smarter_csv and Rcsv gems."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574028633, "post_id": 58901929, "comment_id": 104074149, "body": "Please don&#39;t ask us what&#39;s the best way, as that is determined by your environment. Are you going to import the data into a database? If so, DBMs have very efficient tools for importing CSV that are much faster than anything you could write in Ruby. Are you importing it into Excel? The same is true of Excel. I&#39;d recommend showing what you tried and we can help improve it. I&#39;d load the CSV into a database and work from there as a DBM is designed for this purpose."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574028683, "post_id": 58901929, "comment_id": 104074166, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 14340, "user_id": 2612259, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/70fec6995fdcaebf6362e10bd501f34f?s=128&d=identicon&r=PG", "display_name": "nPn", "link": "https://stackoverflow.com/users/2612259/npn"}, "is_accepted": true, "score": 2, "last_activity_date": 1574028951, "last_edit_date": 1574028951, "creation_date": 1574024989, "answer_id": 58905226, "question_id": 58901929, "link": "https://stackoverflow.com/questions/58901929/best-way-to-parse-large-csv-files-in-ruby/58905226#58905226", "title": "Best way to parse large CSV files in ruby", "body": "<p>You don't specifically say,  but I think most people commenting feel this is likely to be a homework question.  If so you should read \"<a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\">How do I ask and answer homework questions?</a>\". If not read \"<a href=\"https://stackoverflow.com/help\">How do I ask a good question?</a>\". </p>\n\n<p>As G4143 stated in the comment Ruby has an excellent <a href=\"https://ruby-doc.org/stdlib-2.6.1/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">CSV class</a> which should fit your needs.</p>\n\n<p>Here are a couple of quick examples using <code>foreach</code> which the documentation describes as being intended as the primary method for reading CSV files. The method reads one line at a time from the file so it should work well with large files.  Here is a basic example of how you might filter out a subset of Csv records using it,  but I would encourage you to read the CSV class documentation and follow-up with more specific questions, showing what you have tried so far if you have trouble.</p>\n\n<p>The basic idea is to start with an empty array, use <code>foreach</code> to get each row and if that row meets your filtering criteria, added to the initially empty filtered results array.</p>\n\n<p>test.csv:</p>\n\n<pre><code>a, b, c\n1,2,3\n\n\n4,5,6 \n</code></pre>\n\n<hr>\n\n<pre><code>require 'csv'    \n\nfiltered = []\nCSV.foreach(\"test.csv\") do |row|\n    filtered &lt;&lt; row if row[0] == \"1\"\nend\nfiltered\n=&gt; [[\"1\", \"2\", \"3\"]]\n</code></pre>\n\n<hr>\n\n<p>In the case where the first line of the file is a \"header\" you can pass in an option to treat it as such:</p>\n\n<pre><code>require 'csv' \n\nfiltered = []\nCSV.foreach(\"test.csv\", :headers =&gt; true) do |row|\n    filtered &lt;&lt; row if row[\"a\"] == \"1\"\nend\nfiltered\n=&gt; [#&lt;CSV::Row \"a\":\"1\" \" b\":\"2\" \" c\":\"3\"&gt;]\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 9913264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KXb4D.jpg?s=128&g=1", "display_name": "Maneesha Cd", "link": "https://stackoverflow.com/users/9913264/maneesha-cd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 1, "accepted_answer_id": 58905226, "answer_count": 1, "score": 0, "last_activity_date": 1574028951, "creation_date": 1574003778, "question_id": 58901929, "link": "https://stackoverflow.com/questions/58901929/best-way-to-parse-large-csv-files-in-ruby", "title": "Best way to parse large CSV files in ruby", "body": "<p>What is the best way to parse a large CSV file in ruby. My CSV file is almost 1 GB. I want to filter the data in CSV according to some conditions.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "ruby-2.6"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 8, "creation_date": 1574001328, "post_id": 58901276, "comment_id": 104066421, "body": "This doesn&#39;t seem possible. Exactly which line of code was the <code>NameError</code> on?"}, {"owner": {"reputation": 4695, "user_id": 2010395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21eeefdd026a25479f662be94e0460c?s=128&d=identicon&r=PG", "display_name": "Serhii Nadolynskyi", "link": "https://stackoverflow.com/users/2010395/serhii-nadolynskyi"}, "edited": false, "score": 1, "creation_date": 1574021315, "post_id": 58901276, "comment_id": 104072092, "body": "Once I had messed up with Zero-width space(<a href=\"https://en.wikipedia.org/wiki/Zero-width_space\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Zero-width_space</a>) Try to clear @current_admin ||= &#39;yana&#39; row completely and retype it again."}, {"owner": {"reputation": 1690, "user_id": 3034747, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac87bcd269dafa9171c0bcb5baa209ac?s=128&d=identicon&r=PG", "display_name": "Yana Agun Siswanto", "link": "https://stackoverflow.com/users/3034747/yana-agun-siswanto"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1574044042, "post_id": 58901276, "comment_id": 104077083, "body": "@Casper I probably messed up. The error was on <code>@current_admin ||= &#39;yana&#39;</code>. I have edited the code to remove unnecessary context. However, I might be doing it wrong. I updated the question with the diff from the source code."}, {"owner": {"reputation": 1690, "user_id": 3034747, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac87bcd269dafa9171c0bcb5baa209ac?s=128&d=identicon&r=PG", "display_name": "Yana Agun Siswanto", "link": "https://stackoverflow.com/users/3034747/yana-agun-siswanto"}, "reply_to_user": {"reputation": 4695, "user_id": 2010395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21eeefdd026a25479f662be94e0460c?s=128&d=identicon&r=PG", "display_name": "Serhii Nadolynskyi", "link": "https://stackoverflow.com/users/2010395/serhii-nadolynskyi"}, "edited": false, "score": 0, "creation_date": 1574044270, "post_id": 58901276, "comment_id": 104077137, "body": "@SerhiiNadolynskyi thank you. That probably the problem. I have fixed it. I followed the coding style used in authlogic instead. However, how did you debug it so that you get into the conclusion that Zero-width space is the problem?"}, {"owner": {"reputation": 4695, "user_id": 2010395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21eeefdd026a25479f662be94e0460c?s=128&d=identicon&r=PG", "display_name": "Serhii Nadolynskyi", "link": "https://stackoverflow.com/users/2010395/serhii-nadolynskyi"}, "edited": false, "score": 0, "creation_date": 1574763606, "post_id": 58901276, "comment_id": 104337885, "body": "@YanaAgunSiswanto I do not remember how exactly I figured that out. Probably I saw some difference in <code>git diff</code> or something like that."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1574017947, "creation_date": 1574017947, "answer_id": 58904193, "question_id": 58901276, "link": "https://stackoverflow.com/questions/58901276/what-is-the-difference-between-var-123-and-return-var-if-definedvar/58904193#58904193", "title": "What is the difference between &quot;@var ||= 123&quot; and &quot;return @var if defined?(@var); @var = 123&quot;?", "body": "<p>I have no idea about Heroku glitches, but here is the answer on what exactly is the difference.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@current_admin ||= 42\n</code></pre>\n\n<p>The line above is the exact equivalent of <code>@current_admin = @current_admin || 42</code>. That said, the value will be reset to <code>42</code> when <code>@current_admin</code> is <code>falsey</code>, aka _either <code>false</code> or <code>nil</code>. </p>\n\n<p><code>@defined</code> would reset the value if and only this instance variable <em>was not previously declared within current scope</em>. Even <code>nil</code> would stay as is if it was explicitly set before.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>defined? @current_admin\n#\u21d2 nil\n@current_admin = nil\ndefined? @current_admin\n#\u21d2 \"instance-variable\"\n</code></pre>\n"}], "owner": {"reputation": 1690, "user_id": 3034747, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac87bcd269dafa9171c0bcb5baa209ac?s=128&d=identicon&r=PG", "display_name": "Yana Agun Siswanto", "link": "https://stackoverflow.com/users/3034747/yana-agun-siswanto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574043960, "creation_date": 1573999649, "last_edit_date": 1574043960, "question_id": 58901276, "link": "https://stackoverflow.com/questions/58901276/what-is-the-difference-between-var-123-and-return-var-if-definedvar", "title": "What is the difference between &quot;@var ||= 123&quot; and &quot;return @var if defined?(@var); @var = 123&quot;?", "body": "<p>I'm using ruby 2.6.5 on my local machine. I also use the same ruby version on heroku machine.</p>\n\n<p>However i got weird error on using heroku.</p>\n\n<p>if i defined a method like:</p>\n\n<pre><code>def current_admin\n  @current_admin ||= 'yana'\nend\n</code></pre>\n\n<p>It works perfectly on my machine, on heroku it will raise a NameError:</p>\n\n<pre><code>NameError (`@` is not allowed as an instance variable name)\n</code></pre>\n\n<p>however when i do:</p>\n\n<pre><code>def current_admin\n  return @current_admin if defined?(@current_admin)\n  @current_admin = 'yana'\nend\n</code></pre>\n\n<p>It works on both machine.</p>\n\n<p>What exactly is the difference that cause first syntax fails on heroku?</p>\n\n<p><strong>* Update *</strong></p>\n\n<p>The diff i made to make it work on heroku.</p>\n\n<pre><code>   def current_account\n-    @current_account ||= AccountSession.find\n+    return @current_account if defined? @current_account\n+\n+    @current_account = AccountSession.find\n   end\n</code></pre>\n"}, {"tags": ["ruby", "ruby-hash"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 2, "creation_date": 1574003302, "post_id": 58901215, "comment_id": 104066927, "body": "Unrelated, but keeping everything in a hash may not be the best approach. It might be a good idea to encapsulate behavior like this into classes and avoid an arbitrary number of conditionals scattered throughout your code."}, {"owner": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1574004604, "post_id": 58901215, "comment_id": 104067214, "body": "Thanks, Dave. I will keep that mind. In this project I&#39;m storing data mostly in hashes and arrays to get better at using them. In a future project, I&#39;ll focus more on classes."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1574029270, "post_id": 58901215, "comment_id": 104074301, "body": "Don&#39;t embed trailing <code>if</code> into the array. It&#39;s hard to decipher what you&#39;re doing and will insert nil if the test fails resulting in inconsistent data types you&#39;ll have to guard against later."}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "edited": false, "score": 0, "creation_date": 1574006423, "post_id": 58901779, "comment_id": 104067779, "body": "Thanks Amr. This is helpful. Is there a way to do this without setting every other value in <code>player[:skills]</code> to <code>nil</code>? I&#39;d like each unaffected value to remain equal to <code>0</code>."}, {"owner": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "edited": false, "score": 0, "creation_date": 1574006983, "post_id": 58901779, "comment_id": 104067946, "body": "I tried the following: <code>player[:skills] = player[:skills].map { |skill, mod| [skill, ([player[:caste], player[:sub][:skill]].include?(skill.to_s) ? mod += 2 : mod = 0)] }.to_h</code> which causes the same problem as before, but manages to set every unaffected value to <code>0</code>."}, {"owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "reply_to_user": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "edited": false, "score": 0, "creation_date": 1574072464, "post_id": 58901779, "comment_id": 104086676, "body": "Your code is fine you just forget to write it as <code>player[:caste][:skill]</code> you write it <code>player[:caste]</code> that is why it didn&#39;t give you the required output. Sorry for late response @Richard"}], "tags": [], "owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "is_accepted": false, "score": 0, "last_activity_date": 1574002709, "creation_date": 1574002709, "answer_id": 58901779, "question_id": 58901215, "link": "https://stackoverflow.com/questions/58901215/why-is-only-one-value-in-my-hash-being-changed/58901779#58901779", "title": "Why is only one value in my hash being changed?", "body": "<p>Change the code to be something like this:</p>\n\n<pre><code>player = {\n caste: {skill: \"athletics\"},\n sub: {skill: \"endurance\"},\n skills: {acrobatics: 0, athletics: 0, engineering: 0, endurance: 0, heal: 0, \n history: 0, influence: 0, insight: 0, magicka: 0, perception: 0, riding: 0, \n stealth: 0, streetwise: 0, thievery: 0},\n}\n\nplayer[:skills] = player[:skills].map do |skill, mod|\n  [skill, (mod += 2 if [player[:caste][:skill], player[:sub][:skill]].include? \n  (skill.to_s))]\nend.to_h\n</code></pre>\n\n<p>The reason your code didn't work because map return the last line as a result for the current iteration, So in the <code>athletics</code> case the last line which is</p>\n\n<pre><code>[skill, (mod += 2 if skill.to_s == player[:sub][:skill])]\n</code></pre>\n\n<p>will be false which will be <code>nil</code> that's why only <code>endurance</code> case works.</p>\n\n<p>hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "edited": false, "score": 0, "creation_date": 1574018903, "post_id": 58902840, "comment_id": 104071434, "body": "Thanks for the well thought out explanation. I was able to follow both examples, but your first example using a ternary statement does not account for <code>player[:sub][:skill]</code>. I tried a few variations on: <code>[skill, skill.to_s == (player[:caste][:skill] || player[:sub][:skill]) ? mod + 2 : mod]</code> without success. Do you have any suggestions? I would like to do it this way if possible."}, {"owner": {"reputation": 14340, "user_id": 2612259, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/70fec6995fdcaebf6362e10bd501f34f?s=128&d=identicon&r=PG", "display_name": "nPn", "link": "https://stackoverflow.com/users/2612259/npn"}, "reply_to_user": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "edited": false, "score": 1, "creation_date": 1574020402, "post_id": 58902840, "comment_id": 104071865, "body": "I added a section that does what you want (at least I think it does).  In the end it is not very different than what I posted at the end, but harder to follow"}], "tags": [], "owner": {"reputation": 14340, "user_id": 2612259, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/70fec6995fdcaebf6362e10bd501f34f?s=128&d=identicon&r=PG", "display_name": "nPn", "link": "https://stackoverflow.com/users/2612259/npn"}, "is_accepted": true, "score": 1, "last_activity_date": 1574020102, "last_edit_date": 1574020102, "creation_date": 1574009551, "answer_id": 58902840, "question_id": 58901215, "link": "https://stackoverflow.com/questions/58901215/why-is-only-one-value-in-my-hash-being-changed/58902840#58902840", "title": "Why is only one value in my hash being changed?", "body": "<p>When I run your code I get this as the result.</p>\n\n<pre><code>{:acrobatics=&gt;nil, :athletics=&gt;nil, :engineering=&gt;nil, :endurance=&gt;2, :heal=&gt;nil, :history=&gt;nil, :influence=&gt;nil, :insight=&gt;nil, :magicka=&gt;nil, :perception=&gt;nil, :riding=&gt;nil, :stealth=&gt;nil, :streetwise=&gt;nil, :thievery=&gt;nil}\n</code></pre>\n\n<p>That's because map returns last statement executed. In addition you actually only set a value for skill when it's matches the sub skill otherwise, it is set to nil.</p>\n\n<p>So whats happening in your code is that each iteration is returning the following which is the result of the last statement in the block passed into map.</p>\n\n<pre><code>[:acrobatics, nil]\n[:athletics, nil]\n[:engineering, nil]\n[:endurance, 2]\n[:heal, nil]\n[:history, nil]\n[:influence, nil]\n[:insight, nil]\n[:magicka, nil]\n[:perception, nil]\n[:riding, nil]\n[:stealth, nil]\n[:streetwise, nil]\n[:thievery, nil]\n</code></pre>\n\n<p>The final result being an array that looks like this.</p>\n\n<pre><code>[[:acrobatics, nil], [:athletics, nil], [:engineering, nil], [:endurance, 2], [:heal, nil], [:history, nil], [:influence, nil], [:insight, nil], [:magicka, nil], [:perception, nil], [:riding, nil], [:stealth, nil], [:streetwise, nil], [:thievery, nil]]\n</code></pre>\n\n<p>Which is finally mapped to a new hash </p>\n\n<pre><code>{:acrobatics=&gt;nil, :athletics=&gt;nil, :engineering=&gt;nil, :endurance=&gt;2, :heal=&gt;nil, :history=&gt;nil, :influence=&gt;nil, :insight=&gt;nil, :magicka=&gt;nil, :perception=&gt;nil, :riding=&gt;nil, :stealth=&gt;nil, :streetwise=&gt;nil, :thievery=&gt;nil}\n</code></pre>\n\n<p>The reason you get all those nil's is because in your statements the result of the case were the if statement is not true is nil.\nFor example:</p>\n\n<pre><code>[skill (mod += 2 if skill.to_s == player[:caste][:skill])]\n</code></pre>\n\n<p>will return <code>[the_skill, nil]</code> for the cases were <code>skill.to_s == player[:caste][:skill]</code> is not true</p>\n\n<p>To see what's happening try this in irb.</p>\n\n<pre><code>x = 0\n=&gt; 0\nx += 1 if false\n=&gt; nil\nx += 1 if true\n=&gt; 1 \n</code></pre>\n\n<p>You could get past that using something like this.</p>\n\n<pre><code>[skill, skill.to_s == player[:caste][:skill] ? mod + 2 : mod ]\n</code></pre>\n\n<p>or using the above example:</p>\n\n<pre><code>x = 0\n=&gt; 0\nx =  false ? x + 1 : x \n=&gt; 0\nx =  true ? x + 1 : x\n=&gt; 1\n</code></pre>\n\n<p>The following modified version of your code should work.</p>\n\n<pre><code>player[:skills] = player[:skills].map do |skill, mod|\n  [skill, skill.to_s == player[:caste][:skill] || skill.to_s == player[:sub][:skill] ? mod + 2 : mod ]\nend.to_h\n</code></pre>\n\n<p>However, here is a slightly more verbose, but hopefully much easier to follow way to accomplish what you want to do and allows for added modifications in the future with out the code getting too confusing.</p>\n\n<pre><code>player = {\n  caste: {skill: \"athletics\"},\n  sub: {skill: \"endurance\"},\n  skills: {acrobatics: 0, athletics: 0, engineering: 0, endurance: 0, heal: 0, history: 0, influence: 0, insight: 0, magicka: 0, perception: 0, riding: 0, stealth: 0, streetwise: 0, thievery: 0},\n}\n\nplayer_caste_skill = player[:caste][:skill]\nplayer_sub_skill = player[:sub][:skill]\ncurrent_skills = player[:skills]\nupdated_skills = {}\ncurrent_skills.each_pair do |skill, prev_value| \n  new_value = prev_value \n  case skill.to_s\n    when player_caste_skill, player_sub_skill\n      new_value = prev_value + 2\n    when \"some_other_skill\"  \n      new_value = prev_value + 3\n  end\n  updated_skills[skill] = new_value\nend\nputs current_skills\nputs updated_skills\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1574014410, "post_id": 58903564, "comment_id": 104070043, "body": "Consider also to empty <code>:caste</code> and <code>:sub</code> hash after the increment. I considered <code>:caste</code> and <code>:sub</code> having just one element or their value not being an array, otherwise you need to loop over them."}, {"owner": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "edited": false, "score": 0, "creation_date": 1574019872, "post_id": 58903564, "comment_id": 104071703, "body": "There are a lot of things here that I didn&#39;t know about. Really compact as well. Thanks, iGian."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1574014074, "creation_date": 1574014074, "answer_id": 58903564, "question_id": 58901215, "link": "https://stackoverflow.com/questions/58901215/why-is-only-one-value-in-my-hash-being-changed/58903564#58903564", "title": "Why is only one value in my hash being changed?", "body": "<p>I'd set a default value (<a href=\"https://ruby-doc.org/core-2.6.5/Hash.html#method-i-default-3D\" rel=\"nofollow noreferrer\">Hash#default</a>) to the <code>player[:skill]</code> hash, just to avoid errors in case of missing key (it adds the key!!), allowing to add also a new key without the need to initialise to 0 each skill.</p>\n\n<pre><code>player[:skills].default = 0\n</code></pre>\n\n<p>Then scan the keys you need to increment in just one liner:</p>\n\n<pre><code>[:caste, :sub].each { |key| player.dig(key, :skill).to_sym.then { |skill| player[:skills][skill] += 2 } }\n</code></pre>\n\n<p><hr>\nThanks to the initialisation, your player can also be</p>\n\n<pre><code>player = {\n  caste: {skill: \"athletics\"},\n  sub: {skill: \"endurance\"},\n  skills: {}\n}\n</code></pre>\n\n<p>Returning a result like:</p>\n\n<pre><code>player #=&gt; {:caste=&gt;{:skill=&gt;\"athletics\"}, :sub=&gt;{:skill=&gt;\"endurance\"}, :skills=&gt;{:athletics=&gt;2, :endurance=&gt;2}}\n</code></pre>\n\n<p>Where:</p>\n\n<pre><code>player[:skills][:whatever] #=&gt; 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "edited": false, "score": 0, "creation_date": 1574019100, "post_id": 58904243, "comment_id": 104071486, "body": "Thanks, Aleksei. What&#39;s the function of the periods (<code>.</code>) in your example? I haven&#39;t seen this before."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1574018178, "creation_date": 1574018178, "answer_id": 58904243, "question_id": 58901215, "link": "https://stackoverflow.com/questions/58901215/why-is-only-one-value-in-my-hash-being-changed/58904243#58904243", "title": "Why is only one value in my hash being changed?", "body": "<p>I would iterate through defined skills rather than through skill values.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>player.\n  map { |_, h| h[:skill] }.\n  compact.\n  map(&amp;:to_sym).\n  each { |skill| player[:skills][skill] += 2 }\n</code></pre>\n\n<p>Now <code>player</code> is updated accordingly, as you might check by exaimning <code>player</code> with <code>p player</code> or like.</p>\n"}], "owner": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 58902840, "answer_count": 4, "score": 1, "last_activity_date": 1574020102, "creation_date": 1573999193, "question_id": 58901215, "link": "https://stackoverflow.com/questions/58901215/why-is-only-one-value-in-my-hash-being-changed", "title": "Why is only one value in my hash being changed?", "body": "<p>I'm making a simple RPG as a learning project, and am having an issue with part of the character creator. </p>\n\n<p>This code should determine what skill string is assigned to <code>player[:caste][:skill]</code> and <code>player[:sub][:skill]</code>, then increase each respective skill's value in <code>player[:skills]</code> by 2. This code should work regardless of what string is assigned to <code>player[:caste][:skill]</code> and <code>player[:sub][:skill]</code>, as long as it is equal to <code>player[:skills].to_s</code>. </p>\n\n<p>Currently, it is only applying the change to <code>player[:skills][:endurance]</code> but not <code>player[:skills][:athletics]</code>.</p>\n\n<pre><code>player = {\n  caste: {skill: \"athletics\"},\n  sub: {skill: \"endurance\"},\n  skills: {acrobatics: 0, athletics: 0, engineering: 0, endurance: 0, heal: 0, history: 0, influence: 0, insight: 0, magicka: 0, perception: 0, riding: 0, stealth: 0, streetwise: 0, thievery: 0},\n}\n\nplayer[:skills] = player[:skills].map do |skill, mod|\n  [skill, (mod += 2 if skill.to_s == player[:caste][:skill])]\n  [skill, (mod += 2 if skill.to_s == player[:sub][:skill])]\nend.to_h\n</code></pre>\n\n<p>In other words, my code is returning the following <code>player[:skills]</code> hash:</p>\n\n<pre><code>skills: {acrobatics: 0, athletics: 0, engineering: 0, endurance: 2, heal: 0, history: 0, influence: 0, insight: 0, magicka: 0, perception: 0, riding: 0, stealth: 0, streetwise: 0, thievery: 0}\n</code></pre>\n\n<p>but I want it to return:</p>\n\n<pre><code>skills: {acrobatics: 0, athletics: 2, engineering: 0, endurance: 2, heal: 0, history: 0, influence: 0, insight: 0, magicka: 0, perception: 0, riding: 0, stealth: 0, streetwise: 0, thievery: 0}\n</code></pre>\n\n<p>Please let me know if there is a simpler way to do this. I've also tried the following:</p>\n\n<pre><code>player[:skills] = player[:skills].map do |skill, mod|\n  [skill, (mod += 2 if skill.to_s == (player[:caste][:skill] || player[:sub][:skill]))]\nend.to_h\n</code></pre>\n\n<p>which only affects the skill found in <code>player[:caste][:skill]</code>.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 1, "creation_date": 1573995695, "post_id": 58900671, "comment_id": 104064980, "body": "Please next time ident your code, if not it&#39;s hard to read it"}, {"owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "edited": false, "score": 0, "creation_date": 1573999662, "post_id": 58900671, "comment_id": 104065990, "body": "Why, in read_secret, do you have File.open and File.foreach?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12386721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1048e1b5079e3a694f3315e772c54f85?s=128&d=identicon&r=PG&f=1", "display_name": "CapnBarnacles", "link": "https://stackoverflow.com/users/12386721/capnbarnacles"}, "edited": false, "score": 0, "creation_date": 1574002508, "post_id": 58901420, "comment_id": 104066718, "body": "Thank you, I really appreciate you taking the time out of your day to lend a helping hand"}], "tags": [], "owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "is_accepted": true, "score": 0, "last_activity_date": 1574000627, "creation_date": 1574000627, "answer_id": 58901420, "question_id": 58900671, "link": "https://stackoverflow.com/questions/58900671/how-can-i-make-my-randomly-generated-word-stay-the-same/58901420#58901420", "title": "How can I make my randomly generated word stay the same?", "body": "<p>Here's something to get you started. Please note that each function does only one thing. One creates the word list and the other returns a word from the word list. I helps if you can encapsulate one thing/action in a function.</p>\n\n<pre><code>def createWordList(filename)\n\n  words = []\n  # Make sure filename exists as a file\n  File.foreach(filename){|line|\n    words.push(line.chomp)\n  }\n\n  words\n\nend\n\ndef getRandWord(words)\n\n  words.sample\n\nend\n\n\nprint \"Enter filename: \"\nfilename = gets.chomp\n\nputs getRandWord(createWordList(filename))\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12386721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1048e1b5079e3a694f3315e772c54f85?s=128&d=identicon&r=PG&f=1", "display_name": "CapnBarnacles", "link": "https://stackoverflow.com/users/12386721/capnbarnacles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58901420, "answer_count": 1, "score": 0, "last_activity_date": 1574000627, "creation_date": 1573995406, "last_edit_date": 1573995658, "question_id": 58900671, "link": "https://stackoverflow.com/questions/58900671/how-can-i-make-my-randomly-generated-word-stay-the-same", "title": "How can I make my randomly generated word stay the same?", "body": "<p><code>enter code here</code>I'm making a simple word guessing game, but every time I submit my player guess the random word changes. I've tried a lot of solutions, but my submission form for the guess always refreshes the secret word. \nAny suggestions? Thanks!</p>\n\n<p>P.S sorry for my disgusting code formatting</p>\n\n<p>Here is my code:</p>\n\n<pre><code>formulate_secret(@@codeword)\n@vmessage = \"Welcome to Wheel of Fortune! To begin, type a letter:\"\n@results = \"...\"\n\nwhile @@tries &gt; 1\n  player_guess = params[:guess].to_s\n  eval_guess(player_guess)\n  break\nend\n\nerb :home, :locals =&gt; {:message =&gt; @message, :tries =&gt; @@tries, :response =&gt; response, :words =&gt; @words, :codeword =&gt; @@codeword, :vmessage =&gt; @vmessage, :wordtable =&gt; @wordtable, :guess =&gt; player_guess, :result =&gt; @results}\nend\n\n@@correct = false\n@vmessage = \"\"\n@results = \"\"\nwordtable = []\n@@tries = 10\n@result = []\n@@codeword = \"\"\n\ndef read_secret\n  wordtable = Array.new\n  file = File.open(\"wordfile.txt\") \n  File.foreach(\"wordfile.txt\") { |line| \n    line = line.strip\n    wordtable.push line }\n  file.close()\n  @wordtable = wordtable\nend\n\ndef formulate_secret(codeword)\n  read_secret\n  @result = []\n  5.times do\n    @result &lt;&lt; @wordtable[rand(@wordtable.length)]\n  end\n  @@codeword = @result.sample\nend\n\ndef eval_guess(player_guess)\n  @results = \"#{@@codeword}\"\n\n  if player_guess == \"\".to_s\n    \"\"\n  elsif \n    player_guess == @@codeword\n    @results = \"Congrats you did it!\"\n    @@correct = true\n  elsif player_guess != @@codeword &amp;&amp; !player_guess.nil?\n    @results = \"\"\n    @@tries -= 1\n  end\nend\n\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "capybara"], "comments": [{"owner": {"reputation": 258, "user_id": 10722733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15030ec5b43588e7a3f7c55345021964?s=128&d=identicon&r=PG&f=1", "display_name": "Clepsyd", "link": "https://stackoverflow.com/users/10722733/clepsyd"}, "edited": false, "score": 0, "creation_date": 1573992364, "post_id": 58899685, "comment_id": 104064150, "body": "Have you maybe tried <code>click_link</code> instead of <code>click_on</code> in your test?"}, {"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 0, "creation_date": 1573993799, "post_id": 58899685, "comment_id": 104064490, "body": "I can&#39;t see your &quot;create customer&quot; element there"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 258, "user_id": 10722733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15030ec5b43588e7a3f7c55345021964?s=128&d=identicon&r=PG&f=1", "display_name": "Clepsyd", "link": "https://stackoverflow.com/users/10722733/clepsyd"}, "edited": false, "score": 0, "creation_date": 1574016653, "post_id": 58899685, "comment_id": 104070752, "body": "@Clepsyd <code>click_on</code> is an alias for <code>click_link_or_button</code> so using just <code>click_link</code> wouldn&#39;t make any difference."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10547380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Pynj.jpg?s=128&g=1", "display_name": "MichaMichael", "link": "https://stackoverflow.com/users/10547380/michamichael"}, "edited": false, "score": 0, "creation_date": 1574034106, "post_id": 58903965, "comment_id": 104075230, "body": "I found a solution, it is in the question changes. Thank you so much for the detailed explanation and your time."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 3, "user_id": 10547380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Pynj.jpg?s=128&g=1", "display_name": "MichaMichael", "link": "https://stackoverflow.com/users/10547380/michamichael"}, "edited": false, "score": 0, "creation_date": 1574034206, "post_id": 58903965, "comment_id": 104075254, "body": "@MichaMichael  you\u2019re welcome - don\u2019t forget to accept the answer (the check mark) if it helped you so your question gets marked as answered"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1574016434, "creation_date": 1574016434, "answer_id": 58903965, "question_id": 58899685, "link": "https://stackoverflow.com/questions/58899685/rails-app-testing-with-rspec-and-capybara-i-get-error-capybaraelementnotfound/58903965#58903965", "title": "Rails app testing with RSpec and Capybara. I get Error Capybara::ElementNotFound", "body": "<p>You have a number of issues here. Firstly you're going to the page before the customer instance has been created, which means it won't be shown on the page. This is because <code>let</code> lazily evaluates - see <a href=\"https://relishapp.com/rspec/rspec-core/v/3-8/docs/helper-methods/let-and-let\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-core/v/3-8/docs/helper-methods/let-and-let</a> - and will only create the customer the first time customer is called in the test.</p>\n\n<pre><code>visit '/' # &lt;= no customer instance exists here\nclick_on customer.status.humanize # &lt;= customer instance actually created here\n</code></pre>\n\n<p>You can fix that by using the non lazily evaluated version <code>let!</code> which will always create a customer instance, or by calling <code>customer</code> before calling <code>visit</code></p>\n\n<p>Secondly, your test is modifying the customer instance in the DB, but never reloading the instance you have in memory (so the new status would never be seen)</p>\n\n<pre><code>expect(customer.reload).to have_status \"move_to_white_list\"\n</code></pre>\n\n<p>Thirdly, If you're using a driver that supports asynchronous behavior (any driver other than rack-test) there is no guarantee any side effects caused by the action methods (<code>click_on</code>, etc) will have completed before the method call returns. That means your expectation will most likely get called before the customer instances status has changed. To fix that the <code>have_status</code> matcher would need to be written to have retrying behavior (like all the Capybara provided matchers have) and to have the reloading behavior in the matcher too. This is a major reason why it's generally not a good idea to be verifying DB changes in system/feature tests, and instead stick to verifying changes in the UI.</p>\n"}], "owner": {"reputation": 3, "user_id": 10547380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Pynj.jpg?s=128&g=1", "display_name": "MichaMichael", "link": "https://stackoverflow.com/users/10547380/michamichael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 58903965, "answer_count": 1, "score": 0, "last_activity_date": 1574033486, "creation_date": 1573987495, "last_edit_date": 1574033486, "question_id": 58899685, "link": "https://stackoverflow.com/questions/58899685/rails-app-testing-with-rspec-and-capybara-i-get-error-capybaraelementnotfound", "title": "Rails app testing with RSpec and Capybara. I get Error Capybara::ElementNotFound", "body": "<blockquote>\n  <p>_customers_table.html.erb</p>\n</blockquote>\n\n<pre><code>&lt;table&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Name&lt;/th&gt;\n      &lt;th&gt;Phone number&lt;/th&gt;\n      &lt;th&gt;Description&lt;/th&gt;\n      &lt;th colspan=\"3\"&gt;&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n\n  &lt;tbody&gt;\n    &lt;% @customers.each do |customer| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= customer.name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= customer.phone_number %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= customer.description %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to customer.status.humanize, toggle_status_customer_path(customer), class: \"move-to-black\" %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Show', customer %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Edit', edit_customer_path(customer) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Destroy', customer, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p><br></p>\n\n<blockquote>\n  <p>creating_customer_spec.rb</p>\n</blockquote>\n\n<pre><code>require 'rails_helper'\n\ndescribe \"creating new customer\", type: :feature do\n  let(:customer) { customer = FactoryBot.create(:customer) }\n\n  it 'should create new customer' do\n    visit '/customers/new'\n    fill_in 'Name', with: customer.name\n    fill_in 'Phone number', with: customer.phone_number\n    click_button 'Create Customer'\n    expect(page).to have_content \"#{customer.name}\"\n  end\n\n  it 'should change customer status' do\n    visit '/'\n    click_on customer.status.humanize\n    expect(customer).to have_status \"move_to_white_list\"\n  end\nend\n</code></pre>\n\n<p><br>\nThe first example 'should create new customer' pass but I get error with the second one 'should change customer status'<br></p>\n\n<pre><code>Capybara::ElementNotFound:\n       Unable to find link or button \"Move to black list\"\n</code></pre>\n\n<p>The element exists and you can see it on the image.\nI would really appreciate if someone can help.<a href=\"https://i.stack.imgur.com/iN31m.png\" rel=\"nofollow noreferrer\">enter image description here</a> </p>\n\n<blockquote>\n  <p>I changed the second example, now it works.This is my mistake I didn\u2019t\n  explain it well, the \u201cblack list\u201d table is on a different view and\n  when the status changes, it moves to another page so actualy it's not\n  possible to find it there.</p>\n</blockquote>\n\n<pre><code>    require 'rails_helper'\n\ndescribe \"creating new customer\", type: :feature do\n  let!(:customer) { customer = FactoryBot.create(:customer) }\n\n  it 'should create new customer' do\n    visit '/customers/new'\n    fill_in 'Name', with: customer.name\n    fill_in 'Phone number', with: customer.phone_number\n    click_button 'Create Customer'\n    expect(page).to have_content \"#{customer.name}\"\n  end\n\n  it 'should change customer status' do\n    visit '/customers'\n    click_on customer.status.humanize\n    expect(page).to have_content \"Customer #{customer.name} moved to black list\"\n\n    visit '/black_list'\n    expect(customer.reload.status).to eq \"move_to_white_list\"\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "cmd"], "comments": [{"owner": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1573965551, "post_id": 58897138, "comment_id": 104059545, "body": "Does this question help: <a href=\"https://stackoverflow.com/questions/29073826/env-ruby-r-no-such-file-or-directory\" title=\"env ruby r no such file or directory\">stackoverflow.com/questions/29073826/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 12174261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b21084baa3aa930f0f3067d87c4dd28d?s=128&d=identicon&r=PG&f=1", "display_name": "Sk1993", "link": "https://stackoverflow.com/users/12174261/sk1993"}, "reply_to_user": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1573970707, "post_id": 58897138, "comment_id": 104060214, "body": "@Chiperific I tried that no unfortunately it does not."}, {"owner": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1573970953, "post_id": 58897138, "comment_id": 104060257, "body": "I can&#39;t tell from your question, does the app run successfully on localhost?"}, {"owner": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1573971039, "post_id": 58897138, "comment_id": 104060276, "body": "What about re-configuring Git as suggested here: <a href=\"https://stackoverflow.com/questions/52316594/heroku-usr-bin-env-ruby-exe-r-no-such-file-or-directory-problem\" title=\"heroku usr bin env ruby exe r no such file or directory problem\">stackoverflow.com/questions/52316594/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 12174261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b21084baa3aa930f0f3067d87c4dd28d?s=128&d=identicon&r=PG&f=1", "display_name": "Sk1993", "link": "https://stackoverflow.com/users/12174261/sk1993"}, "reply_to_user": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1574011796, "post_id": 58897138, "comment_id": 104069299, "body": "@Chiperific the app runs successfully on localhost tried reconfiguring it gives the same issue."}, {"owner": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1574018208, "post_id": 58897138, "comment_id": 104071238, "body": "Are you developing on a Mac or Windows machine?"}, {"owner": {"reputation": 11, "user_id": 12174261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b21084baa3aa930f0f3067d87c4dd28d?s=128&d=identicon&r=PG&f=1", "display_name": "Sk1993", "link": "https://stackoverflow.com/users/12174261/sk1993"}, "reply_to_user": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1574019910, "post_id": 58897138, "comment_id": 104071723, "body": "@Chiperific Windows 10"}, {"owner": {"reputation": 1201, "user_id": 8785865, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5b892309a47e8d4a61140a615f2b3337?s=128&d=identicon&r=PG&f=1", "display_name": "Aarthi", "link": "https://stackoverflow.com/users/8785865/aarthi"}, "edited": false, "score": 0, "creation_date": 1594963590, "post_id": 58897138, "comment_id": 111315638, "body": "How did you solve the issue @Sk1993?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12174261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b21084baa3aa930f0f3067d87c4dd28d?s=128&d=identicon&r=PG&f=1", "display_name": "Sk1993", "link": "https://stackoverflow.com/users/12174261/sk1993"}, "edited": false, "score": 0, "creation_date": 1574028710, "post_id": 58904607, "comment_id": 104074170, "body": "No spaces or funky characters are present in each file under <code>.&#47;bin&#47;</code> after the magic comment."}], "tags": [], "owner": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "is_accepted": false, "score": 0, "last_activity_date": 1574020602, "creation_date": 1574020602, "answer_id": 58904607, "question_id": 58897138, "link": "https://stackoverflow.com/questions/58897138/how-to-fix-cannot-deploy-app-on-heroku/58904607#58904607", "title": "How to fix &#39;Cannot deploy app on heroku&#39;?", "body": "<p>I'd put money on the fact you have an invisible <code>/r</code> in one of your files.</p>\n\n<p>Check out this answer: <a href=\"https://stackoverflow.com/a/29074011/1880203\">https://stackoverflow.com/a/29074011/1880203</a></p>\n\n<p>Open up every file in <code>./bin/</code> and make sure no spaces or funky characters are after the magic comment that should be in the top of every file:</p>\n\n<pre><code>#!/usr/bin/env ruby\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12174261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b21084baa3aa930f0f3067d87c4dd28d?s=128&d=identicon&r=PG&f=1", "display_name": "Sk1993", "link": "https://stackoverflow.com/users/12174261/sk1993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1574020602, "creation_date": 1573959807, "question_id": 58897138, "link": "https://stackoverflow.com/questions/58897138/how-to-fix-cannot-deploy-app-on-heroku", "title": "How to fix &#39;Cannot deploy app on heroku&#39;?", "body": "<p>I am trying to deploy ruby on rails application on heroku via cmd prompt the issue and error is displayed in the logs. It is giving application error.I am getting application error when I do <code>heroku open</code> on the command prompt window.How shall I solve this error. I also tried removing the issues related to the console on the localhost:3000 </p>\n\n<pre><code>   C:\\r5.1&gt;heroku logs --tail\n    2019-11-11T14:16:38.867063+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-11T14:16:43.692688+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 19801 -e production`\n    2019-11-11T14:16:46.394640+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-11T14:16:46.381024+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-11T14:16:46.254086+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-11T20:00:49.460823+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-11T20:00:59.165978+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 29263 -e production`\n    2019-11-11T20:01:04.157480+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-11T20:01:04.118816+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-11T20:01:03.964097+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-12T01:38:25.327629+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-12T01:38:29.528475+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 54505 -e production`\n    2019-11-12T01:38:31.443429+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-12T01:38:31.413452+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-12T01:38:31.355207+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-12T04:43:24.305277+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=obscure-beyond-78036.herokuapp.com request_id=c969b84f-8226-4b14-a7a7-0dcd2f1a7ecf fwd=\"73.244.194.180\" dyno= connect= service= status=503 bytes= protocol=https\n    2019-11-12T04:43:24.966438+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=obscure-beyond-78036.herokuapp.com request_id=98e6030c-5a7d-45b8-9463-b20378089873 fwd=\"73.244.194.180\" dyno= connect= service= status=503 bytes= protocol=https\n    2019-11-12T04:45:44.551206+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=obscure-beyond-78036.herokuapp.com request_id=c38f043e-1c13-4227-a0ee-926e96031e96 fwd=\"73.244.194.180\" dyno= connect= service= status=503 bytes= protocol=https\n    2019-11-12T04:45:44.724247+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=obscure-beyond-78036.herokuapp.com request_id=ca487a9b-815c-4198-881e-c1536624dcf0 fwd=\"73.244.194.180\" dyno= connect= service= status=503 bytes= protocol=https\n    2019-11-12T07:14:57.497429+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-12T07:15:01.920946+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 19445 -e production`\n    2019-11-12T07:15:04.382826+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-12T07:15:04.358062+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-12T07:15:04.270979+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-12T12:59:29.922938+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-12T12:59:34.199590+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 8495 -e production`\n    2019-11-12T12:59:36.058436+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-12T12:59:36.011599+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-12T12:59:36.058915+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-12T18:57:44.195820+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-12T18:57:49.089790+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 55812 -e production`\n    2019-11-12T18:57:50.902911+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-12T18:57:50.891004+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-12T18:57:50.829746+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-13T00:18:03.832712+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-13T00:18:11.709422+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 57129 -e production`\n    2019-11-13T00:18:14.447216+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-13T00:18:14.426285+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-13T00:18:14.353062+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-13T06:18:16.247724+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-13T06:18:21.126039+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 56369 -e production`\n    2019-11-13T06:18:23.030770+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-13T06:18:23.010262+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-13T06:18:22.964777+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-13T11:54:35.587058+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-13T11:54:43.164128+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 23216 -e production`\n    2019-11-13T11:54:45.221161+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-13T11:54:45.054350+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-13T11:54:45.198218+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-13T17:32:52.968441+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-13T17:32:57.483433+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 41627 -e production`\n    2019-11-13T17:32:59.635352+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-13T17:32:59.617603+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-13T17:32:59.529956+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-13T23:28:20.391491+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-13T23:28:25.383782+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 35541 -e production`\n    2019-11-13T23:28:26.768967+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-13T23:28:26.746187+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-13T23:28:26.710575+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-14T05:20:57.113772+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-14T05:21:02.360484+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 39866 -e production`\n    2019-11-14T05:21:04.955264+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-14T05:21:04.936109+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-14T05:21:04.867542+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-14T11:13:33.210556+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-14T11:13:37.194569+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 54606 -e production`\n    2019-11-14T11:13:39.024888+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-14T11:13:39.010502+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-14T11:13:38.967553+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-14T16:42:11.985194+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-14T16:42:16.369127+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 6489 -e production`\n    2019-11-14T16:42:18.158327+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-14T16:42:18.141167+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-14T16:42:18.091900+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-14T22:23:09.123597+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-14T22:23:13.156309+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 41127 -e production`\n    2019-11-14T22:23:14.623692+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-14T22:23:14.542462+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-14T22:23:14.601341+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-15T04:07:18.215176+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-15T04:07:24.144091+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 28727 -e production`\n    2019-11-15T04:07:26.088778+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-15T04:07:26.073282+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-15T04:07:26.028957+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-15T09:51:30.015825+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-15T09:51:35.432940+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 35443 -e production`\n    2019-11-15T09:51:38.061514+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-15T09:51:38.042995+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-15T09:51:37.986622+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-15T15:32:36.641076+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-15T15:32:43.318738+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 50057 -e production`\n    2019-11-15T15:32:45.191239+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-15T15:32:45.171631+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-15T15:32:45.136551+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-15T21:09:12.453945+00:00 heroku[web.1]: State changed from crashed to starting\n    2019-11-15T21:09:17.586328+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 32126 -e production`\n    2019-11-15T21:09:19.654985+00:00 heroku[web.1]: State changed from starting to crashed\n    2019-11-15T21:09:19.640167+00:00 heroku[web.1]: Process exited with status 127\n    2019-11-15T21:09:19.589960+00:00 app[web.1]: /usr/bin/env: \u2018ruby\\r\u2019: No such file or directory\n    2019-11-17T02:02:40.834466+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=obscure-beyond-78036.herokuapp.com request_id=27b9775c-9011-4343-b386-bc8575b3b574 fwd=\"73.244.194.180\" dyno= connect= service= status=503 bytes= protocol=https\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573971954, "post_id": 58896908, "comment_id": 104060418, "body": "Your definitions of the arrays don&#39;t make sense. If you run the assignment you&#39;ll get <code>undefined local variable or method </code>product_one_price_1&#39;`"}], "answers": [{"tags": [], "owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "is_accepted": true, "score": 1, "last_activity_date": 1573960880, "last_edit_date": 1573960880, "creation_date": 1573960034, "answer_id": 58897155, "question_id": 58896908, "link": "https://stackoverflow.com/questions/58896908/ruby-compile-a-hash-from-two-2d-arrays-with-appropriate-combinations/58897155#58897155", "title": "Ruby: compile a hash from two 2d arrays with appropriate combinations", "body": "<p>You can benefit from <code>zip</code> method, which will combine corresponding elements from two arrays<br>\n(<code>[0] - [0]</code>, <code>[1] - [1]</code> and so on)</p>\n\n<pre><code>result = product_names_array.zip(product_prices_array)\n  .flat_map { |names, prices| names.map { |name| [name, prices] }}\n  .to_h\n\nresult\n\n# output\n# product_one_prices: 11, 12, 13, 14\n# product_two_prices: 21, 22, 23, 24\n{\n  \"Product One A\"=&gt;[11, 12, 13, 14], \n  \"Product One B\"=&gt;[11, 12, 13, 14], \n  \"Product Two C\"=&gt;[21, 22, 23, 24], \n  \"Product Two D\"=&gt;[21, 22, 23, 24]\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12384950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/019e9303bec189667c96505a8601504a?s=128&d=identicon&r=PG&f=1", "display_name": "kty0mka", "link": "https://stackoverflow.com/users/12384950/kty0mka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 58897155, "answer_count": 1, "score": 0, "last_activity_date": 1573960880, "creation_date": 1573956372, "question_id": 58896908, "link": "https://stackoverflow.com/questions/58896908/ruby-compile-a-hash-from-two-2d-arrays-with-appropriate-combinations", "title": "Ruby: compile a hash from two 2d arrays with appropriate combinations", "body": "<p><strong>I have two 2d arrays:</strong></p>\n\n<pre><code>product_names_array = [product_one_names = [\"Product One A\", \"Product One B\"],\n                      product_two_names = [\"Product Two C\", \"Product Two D\"]]\nproduct_prices_array = [product_one_price = [product_one_price_1, product_one_price_2, product_one_price_3, product_one_price_4],\n                        product_two_price = [product_two_price_1, product_two_price_2, product_two_price_3, product_two_price_4]]\n</code></pre>\n\n<p>In the first 2D array, I have 2 sub-arrays (in reality there are 16 of them) - one for each product. Each of them lists different names for the same product (each product can have from 1 to 22 alternative names).</p>\n\n<p>In the second 2D array, I have 2 sub-arrays (in reality there are also 16 of them) - one per price list for each product. Each of them lists different prices (in reality, 10 price options) of the same product (which may have several names) from the corresponding sub-array in the previous 2D array.</p>\n\n<p><strong>From arrays I want to make such a hash:</strong></p>\n\n<pre><code>my_hash = {\"Product One A\" =&gt; [product_one_price_1, product_one_price_2, product_one_price_3, product_one_price_4],\n          \"Product One B\" =&gt; [product_one_price_1, product_one_price_2, product_one_price_3, product_one_price_4],\n          \"Product One C\" =&gt; [product_two_price_1, product_two_price_2, product_two_price_3, product_two_price_4],\n          \"Product Two D\" =&gt; [product_two_price_1, product_two_price_2, product_two_price_3, product_two_price_4]}\n</code></pre>\n\n<p>As you can see, each value from the arrays in the first 2D array creates all possible combinations with each corresponding array in the second 2D array.</p>\n\n<p><strong>Then I want to use the created hash like this:</strong></p>\n\n<pre><code>puts my_hash[\"Product One B\"[2]] # =&gt; product_one_price_3\n</code></pre>\n\n<p>(I doubt the correctness of this expression, so I will be grateful if you will help me here too...)</p>\n\n<p>I would also like to avoid defining new methods, because this code will be used in the plugin <a href=\"https://github.com/annikoff/redmine_plugin_computed_custom_field\" rel=\"nofollow noreferrer\">Computed Custom Field for Redmine</a>, and it does not accept def.</p>\n\n<p>I have already re-read a bunch of information about arrays and hashes in Ruby, well, so far I have not even come close to solving my problem. Any help would be helpful!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1573965779, "post_id": 58896793, "comment_id": 104059581, "body": "What about adding <code>:menu_items</code> separately in the <code>includes</code> statement: <code>@menus = Menu.includes(:menu_items, menu_items: [:variants])...</code>"}, {"owner": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1573965878, "post_id": 58896793, "comment_id": 104059592, "body": "My SQL isn&#39;t great, but I think you want <code>:menu_items</code> to <code>LEFT OUTER JOIN</code> on <code>:variants</code> so you get all <code>:menu_items</code> regardless of if they have a variant record. Maybe posting the SQL portion of the terminal output could help."}, {"owner": {"reputation": 253, "user_id": 1794386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f14461062705096cbe7dac2dbdd869ce?s=128&d=identicon&r=PG", "display_name": "jcjcjcjc", "link": "https://stackoverflow.com/users/1794386/jcjcjcjc"}, "reply_to_user": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1574030120, "post_id": 58896793, "comment_id": 104074479, "body": "Thanks @Chiperific, but unfortunately doing <code>Menu.includes(:menu_items, menu_items: [:variants])...</code> doesn&#39;t seem to help."}, {"owner": {"reputation": 253, "user_id": 1794386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f14461062705096cbe7dac2dbdd869ce?s=128&d=identicon&r=PG", "display_name": "jcjcjcjc", "link": "https://stackoverflow.com/users/1794386/jcjcjcjc"}, "reply_to_user": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "edited": false, "score": 0, "creation_date": 1574030213, "post_id": 58896793, "comment_id": 104074500, "body": "Added the SQL output as an edit above."}], "answers": [{"comments": [{"owner": {"reputation": 253, "user_id": 1794386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f14461062705096cbe7dac2dbdd869ce?s=128&d=identicon&r=PG", "display_name": "jcjcjcjc", "link": "https://stackoverflow.com/users/1794386/jcjcjcjc"}, "edited": false, "score": 0, "creation_date": 1574100674, "post_id": 58913521, "comment_id": 104102402, "body": "Doesn&#39;t seem to do it for me. In fact, the <code>visible: true</code> condition doesn&#39;t apply to either menu items or variants when doing this"}, {"owner": {"reputation": 36, "user_id": 9037613, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UfvEYsETWTE/AAAAAAAAAAI/AAAAAAAAAHE/uEYmAjlXEQQ/photo.jpg?sz=128", "display_name": "Kvr Ramya", "link": "https://stackoverflow.com/users/9037613/kvr-ramya"}, "reply_to_user": {"reputation": 253, "user_id": 1794386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f14461062705096cbe7dac2dbdd869ce?s=128&d=identicon&r=PG", "display_name": "jcjcjcjc", "link": "https://stackoverflow.com/users/1794386/jcjcjcjc"}, "edited": false, "score": 0, "creation_date": 1574160368, "post_id": 58913521, "comment_id": 104123652, "body": "@jcjcjcjc Are you using <code>visible_menu_items</code> and <code>visible_variants</code> instead of  <code>menu_items</code> and <code>variants</code> in the query. Can you post the SQL query from terminal."}], "tags": [], "owner": {"reputation": 36, "user_id": 9037613, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UfvEYsETWTE/AAAAAAAAAAI/AAAAAAAAAHE/uEYmAjlXEQQ/photo.jpg?sz=128", "display_name": "Kvr Ramya", "link": "https://stackoverflow.com/users/9037613/kvr-ramya"}, "is_accepted": false, "score": 0, "last_activity_date": 1574076327, "creation_date": 1574076327, "answer_id": 58913521, "question_id": 58896793, "link": "https://stackoverflow.com/questions/58896793/rails-query-with-nested-where-only-if-association-exists/58913521#58913521", "title": "Rails query with nested `where` only if association exists", "body": "<pre><code>  has_many :menu_items\n  has_many :visible_menu_items, -&gt; {where(visible: true)}, class_name: 'MenuItem'\n  ...\nend\n\nclass MenuItem &lt; ApplicationRecord\n  has_many :variants\n  has_many :visible_variants, -&gt; {where(visible: true)}, class_name: 'Variant'\n  ...\nend\n</code></pre>\n\n<p>Created associations can be used in the query.</p>\n\n<p><code>@menus = Menu.eager_load(visible_menu_items: [:visible_variants]).where(visible: true)</code></p>\n"}], "owner": {"reputation": 253, "user_id": 1794386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f14461062705096cbe7dac2dbdd869ce?s=128&d=identicon&r=PG", "display_name": "jcjcjcjc", "link": "https://stackoverflow.com/users/1794386/jcjcjcjc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574076327, "creation_date": 1573954760, "last_edit_date": 1574030185, "question_id": 58896793, "link": "https://stackoverflow.com/questions/58896793/rails-query-with-nested-where-only-if-association-exists", "title": "Rails query with nested `where` only if association exists", "body": "<p>In my Rails app, the data model describes a <code>menu</code> that has many <code>menu_items</code> and a <code>menu_item</code> that has many <code>variants</code>. Each of the tables has a boolean <code>visible</code> attribute.</p>\n\n<p>I'd like to query for all menus, menu items, and variants that are visible.</p>\n\n<p>I've currently got this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@menus = Menu.includes(menu_items: [:variants]).where({\n  visible: true,\n  menu_items: { visible: true },\n  variants: { visible: true }\n})\n</code></pre>\n\n<p>That filters out non-visible menus, non-visible menu_items, and non-visible variants. However, if a menu_item has no variants, it also gets filtered out.</p>\n\n<p>How can I achieve the filtering on <code>visible</code> without losing those menu_items that don't have any variants associated?</p>\n\n<p>Here's the SQL output below:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \"menus\".\"id\"                    AS t0_r0, \n       \"menus\".\"name\"                  AS t0_r1, \n       \"menus\".\"description\"           AS t0_r2, \n       \"menus\".\"visible\"               AS t0_r3, \n       \"menus\".\"created_at\"            AS t0_r4, \n       \"menus\".\"updated_at\"            AS t0_r5, \n       \"menu_items\".\"id\"               AS t1_r0, \n       \"menu_items\".\"name\"             AS t1_r1, \n       \"menu_items\".\"description\"      AS t1_r2, \n       \"menu_items\".\"position\"         AS t1_r3, \n       \"menu_items\".\"price\"            AS t1_r4, \n       \"menu_items\".\"dietary_notes\"    AS t1_r5, \n       \"menu_items\".\"visible\"          AS t1_r6, \n       \"menu_items\".\"menu_category_id\" AS t1_r7, \n       \"menu_items\".\"created_at\"       AS t1_r8, \n       \"menu_items\".\"updated_at\"       AS t1_r9, \n       \"variants\".\"id\"                 AS t2_r0, \n       \"variants\".\"name\"               AS t2_r1, \n       \"variants\".\"description\"        AS t2_r2, \n       \"variants\".\"dietary_notes\"      AS t2_r3, \n       \"variants\".\"visible\"            AS t2_r4, \n       \"variants\".\"menu_item_id\"       AS t2_r5, \n       \"variants\".\"created_at\"         AS t2_r6, \n       \"variants\".\"updated_at\"         AS t2_r7, \n       \"menu_categories\".\"id\"          AS t3_r0, \n       \"menu_categories\".\"name\"        AS t3_r1, \n       \"menu_categories\".\"position\"    AS t3_r2, \n       \"menu_categories\".\"description\" AS t3_r3, \n       \"menu_categories\".\"created_at\"  AS t3_r4, \n       \"menu_categories\".\"updated_at\"  AS t3_r5 \nFROM   \"menus\" \n       LEFT OUTER JOIN \"menu_items_menus\" \n                    ON \"menu_items_menus\".\"menu_id\" = \"menus\".\"id\" \n       LEFT OUTER JOIN \"menu_items\" \n                    ON \"menu_items\".\"id\" = \"menu_items_menus\".\"menu_item_id\" \n       LEFT OUTER JOIN \"variants\" \n                    ON \"variants\".\"menu_item_id\" = \"menu_items\".\"id\" \n       LEFT OUTER JOIN \"menu_categories\" \n                    ON \"menu_categories\".\"id\" = \"menu_items\".\"menu_category_id\" \nWHERE  \"menus\".\"visible\" = ? \n       AND \"menu_items\".\"visible\" = ? \n       AND \"variants\".\"visible\" = ? \n</code></pre>\n"}, {"tags": ["ruby", "zsh", "rbenv", "zshrc"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1573986697, "post_id": 58896403, "comment_id": 104062896, "body": "Try removing rbenv and reinstalling from scratch."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574002531, "post_id": 58896403, "comment_id": 104066724, "body": "You shouldn&#39;t need the last line; <code>.zshenv</code> is sourced automatically before <code>.zshrc</code> is."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1574002571, "post_id": 58896403, "comment_id": 104066736, "body": "Are you sure <code>rbenv</code> is, in fact, in <code>$HOME&#47;.rbenv&#47;bin</code>?"}, {"owner": {"reputation": 558, "user_id": 7820436, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PKC7Uo8Wv2Q/AAAAAAAAAAI/AAAAAAAAG1E/liX1WQbbwZU/photo.jpg?sz=128", "display_name": "Thomas Koppensteiner", "link": "https://stackoverflow.com/users/7820436/thomas-koppensteiner"}, "edited": false, "score": 0, "creation_date": 1576736982, "post_id": 58896403, "comment_id": 104997015, "body": "@ahrampy did any of the comments or my answer help you? Can you please give us feedback or accept the answer?"}], "answers": [{"comments": [{"owner": {"reputation": 14111, "user_id": 5783745, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Z5VSF.jpg?s=128&g=1", "display_name": "stevec", "link": "https://stackoverflow.com/users/5783745/stevec"}, "edited": false, "score": 1, "creation_date": 1591608921, "post_id": 59383409, "comment_id": 110110289, "body": "Funnily enough, I skipped straight to the brew doctor script <code>curl -fsSL https:&#47;&#47;github.com&#47;rbenv&#47;rbenv-installer&#47;raw&#47;master&#47;bin&#47;rben&zwnj;&#8203;v-doctor | bash</code> and it identified the one thing I had missed, saving a lot of time"}], "tags": [], "owner": {"reputation": 558, "user_id": 7820436, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PKC7Uo8Wv2Q/AAAAAAAAAAI/AAAAAAAAG1E/liX1WQbbwZU/photo.jpg?sz=128", "display_name": "Thomas Koppensteiner", "link": "https://stackoverflow.com/users/7820436/thomas-koppensteiner"}, "is_accepted": true, "score": 4, "last_activity_date": 1576624333, "creation_date": 1576624333, "answer_id": 59383409, "question_id": 58896403, "link": "https://stackoverflow.com/questions/58896403/zshenv2-command-not-found-rbenv/59383409#59383409", "title": ".zshenv:2: command not found: rbenv", "body": "<p>You need to add two things to your <code>PATH</code>.\nFirst <code>rbenv</code> itself and second the ruby <code>shims</code>.</p>\n\n<h1>Part 1 rbenv</h1>\n\n<h2>Installation</h2>\n\n<h3>Homebrew</h3>\n\n<p>If you installed <code>rbenv</code> with <code>brew</code>,\nthen the <code>rbenv</code> executable should be linked to <code>/usr/local/bin/rbenv</code>.</p>\n\n<p>See <a href=\"https://github.com/rbenv/rbenv#homebrew-on-macos\" rel=\"nofollow noreferrer\">homebrew installation documentation</a> for details.</p>\n\n<p>Please add <code>/usr/local/bin</code> to your path <code>PATH</code>, if it is missing.</p>\n\n<pre><code># in ~/.zshrc\n\nexport PATH=/usr/local/bin:$PATH\n</code></pre>\n\n<h3>Github Checkout</h3>\n\n<p>If you install <code>rbenv</code> via a Github checkout, then the <code>rbenv</code> executalbe should be stored in <code>~/.rbenv/bin</code>.</p>\n\n<p>See <a href=\"https://github.com/rbenv/rbenv#basic-github-checkout\" rel=\"nofollow noreferrer\">github installation documentation</a> for details.</p>\n\n<p>Please add <code>~/.rbenv/bin</code> to your path <code>PATH</code>, if it is missing.</p>\n\n<pre><code># in ~/.zshrc\n\nexport PATH=$HOME/.rbenv/bin:$PATH\n</code></pre>\n\n<h2>Verfiy</h2>\n\n<p>Please verify that <code>rbenv</code> is in your path by calling <code>which rbenv</code>.\nThe installation path should be returend.</p>\n\n<h1>Part 2 shims</h1>\n\n<p>Add the ruby <code>shims</code> to you path.</p>\n\n<pre><code># in ~/.zshrc\n\neval \"$(rbenv init -)\"\n</code></pre>\n\n<p>Instead of the <code>eval \"$(rbenv init -)\"</code> command you can also add the <code>shims</code> folder directly.</p>\n\n<pre><code># in ~/.zshrc\n\nexport RBENV_ROOT=$HOME/.rbenv\nexport PATH=$RBENV_ROOT/shims:/versions:$PATH\n</code></pre>\n\n<h1>Part 3 rbenv doctor</h1>\n\n<p>You might also run the <code>rbenv-doctor</code> script mentioned <a href=\"https://github.com/rbenv/rbenv#homebrew-on-macos\" rel=\"nofollow noreferrer\">here</a>,\nto check your installation.</p>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 9820894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jAw3X.png?s=128&g=1", "display_name": "thiagoBarbosa48", "link": "https://stackoverflow.com/users/9820894/thiagobarbosa48"}, "is_accepted": false, "score": -1, "last_activity_date": 1597324931, "creation_date": 1597324931, "answer_id": 63396147, "question_id": 58896403, "link": "https://stackoverflow.com/questions/58896403/zshenv2-command-not-found-rbenv/63396147#63396147", "title": ".zshenv:2: command not found: rbenv", "body": "<p>I had the same problem...\nwhen I ran ruby or rbenv, I got this error &quot;command not found&quot;</p>\n<p>try this:</p>\n<pre><code>echo 'export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;' &gt;&gt; ~/.zshenv\n\necho 'eval &quot;$(rbenv init - zsh)&quot;' &gt;&gt; ~/.zshenv\n\necho 'export PATH=&quot;$HOME/.rbenv/plugins/ruby-build/bin:$PATH&quot;' &gt;&gt; ~/.zshenv\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 3247010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b4d3975ce78cfc84429234684f6dac?s=128&d=identicon&r=PG&f=1", "display_name": "marzvrover", "link": "https://stackoverflow.com/users/3247010/marzvrover"}, "is_accepted": false, "score": 0, "last_activity_date": 1608103856, "creation_date": 1608103856, "answer_id": 65318935, "question_id": 58896403, "link": "https://stackoverflow.com/questions/58896403/zshenv2-command-not-found-rbenv/65318935#65318935", "title": ".zshenv:2: command not found: rbenv", "body": "<p>I had this same error. I could run <code>which rbenv</code> and <code>rbenv</code> just fine, but no matter what I would get <code>command not found: rbenv</code>. The issue was that I had <code>eval &quot;$(rbenv init -)&quot;</code> in my <code>~/.zshenv</code> and not my <code>~/.zshrc</code> file. You may still have the path to <code>rbenv</code> be added to <code>$PATH</code> within <code>~/.zshenv</code> for it to work.</p>\n"}], "owner": {"reputation": 58, "user_id": 12363366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d46c665c2fd94093612941775601f1?s=128&d=identicon&r=PG", "display_name": "ahrampy", "link": "https://stackoverflow.com/users/12363366/ahrampy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5430, "favorite_count": 1, "accepted_answer_id": 59383409, "answer_count": 3, "score": 2, "last_activity_date": 1608103856, "creation_date": 1573949500, "last_edit_date": 1573972075, "question_id": 58896403, "link": "https://stackoverflow.com/questions/58896403/zshenv2-command-not-found-rbenv", "title": ".zshenv:2: command not found: rbenv", "body": "<p>When switching from bash to zsh, I looked up how to resolve an issue with my rbenv folder not being used correctly by zsh and found this: </p>\n\n<pre><code>$ echo 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' &gt;&gt; ~/.zshenv\n$ echo 'eval \"$(rbenv init -)\"' &gt;&gt; ~/.zshenv\n$ echo 'source $HOME/.zshenv' &gt;&gt; ~/.zshrc\n$ exec $SHELL\n</code></pre>\n\n<p>I ran all of these and seem to be using the correct rbenv folder now, but I get this error message whenever I open a new iTerm window: </p>\n\n<pre><code>/Users/myname/.zshenv:2: command not found: rbenv\n</code></pre>\n\n<p>What am I doing wrong? Any help would be very appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4179, "user_id": 935676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITQRV.jpg?s=128&g=1", "display_name": "amoebe", "link": "https://stackoverflow.com/users/935676/amoebe"}, "edited": false, "score": 0, "creation_date": 1573945020, "post_id": 58895953, "comment_id": 104056567, "body": "What kind of answer are you looking for? I don&#39;t think there is a clear rule like &quot;have a most 3 nested attributes&quot;. It depends on how your app is structured, usually I would think the user is also overwhelmed by having to create so many things in one step."}], "answers": [{"tags": [], "owner": {"reputation": 2624, "user_id": 1880203, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5c7a5fcd85529e17f9aa86c1e9a5490e?s=128&d=identicon&r=PG", "display_name": "Chiperific", "link": "https://stackoverflow.com/users/1880203/chiperific"}, "is_accepted": false, "score": 1, "last_activity_date": 1573968424, "creation_date": 1573968424, "answer_id": 58897783, "question_id": 58895953, "link": "https://stackoverflow.com/questions/58895953/confused-about-using-or-not-using-nested-attributes/58897783#58897783", "title": "Confused about using or not using nested attributes", "body": "<p>I think you're making a leap you don't need to.</p>\n\n<blockquote>\n  <p>I don't like the idea that all the creation of the visitors, pageviews and metric are in the PostsController.</p>\n</blockquote>\n\n<p>They shouldn't be and don't have to be. In fact, they never are by default.</p>\n\n<p>Run <code>rails routes</code> in your console and you'll see each of those <code>has_many</code> models have their own controllers and views.</p>\n\n<p>It is very rare I have a web app with a model that doesn't have and use its own controller.</p>\n\n<p>A route like <code>/posts/:id/visitors</code> should point to <code>visitors#index</code>, not something like <code>posts#visitors</code></p>\n\n<p>If you're putting everything into one controller, I'd argue you aren't actually nesting, you're expanding.</p>\n\n<p>And I'd argue the point of relational databases is to have relationships, so limiting your relationships seems kinda self-limiting.</p>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1573988257, "last_edit_date": 1573988257, "creation_date": 1573987851, "answer_id": 58899730, "question_id": 58895953, "link": "https://stackoverflow.com/questions/58895953/confused-about-using-or-not-using-nested-attributes/58899730#58899730", "title": "Confused about using or not using nested attributes", "body": "<p>I don't think you have really grasped what nested attributes is used for in the first place. Its used when you need to CRUD a resource and its children in a single request.</p>\n\n<p>Its use is really dictated by the user experience requirements. Sometimes you actually need a single form like this very common order form example:</p>\n\n<pre><code>class Order\n  has_many :line_items\n  accepts_nested_attributes_for :line_items\nend\n\nclass LineItem\n  belongs_to :product\nend\n</code></pre>\n\n<pre><code>&lt;%= form_for(@order) do |f| %&gt;\n  &lt;%= f.fields_for(:line_items) do |ff| %&gt;\n    &lt;%= ff.number_field :quantity %&gt;\n    &lt;%= ff.collection_select :product_id, Product.all, :id, :name %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n\nclass OrdersController &lt; ApplicationController\n  # ...\n  def update\n    @order = Order.find(params[:id])\n    if @order.update(order_params)\n      # ..\n    else\n      # ...\n    end\n  end\n\n  private\n  def order_params\n    params.require(:order)\n          .permit(:line_items_attributes: [:quantity, :product_id, :_destroy])\n  end\nend\n\n</code></pre>\n\n<p>This is just that common checkout form where users can change the number of products in their cart. It lets the users manipulate multiple records at once in a plain old synchronous form. </p>\n\n<p>That said nested attributes is probably one of the most misused components of Rails though and everything beyond 1 level of nesting usually ends up in a hideous mess. Its also a very common misconception that it should be used to assign associations which should in most cases just by done by adding selects or checkboxes that point to the <code>_id</code> or <code>_ids</code> attributes created by the associations. </p>\n\n<p>If you are using it just to mosh everything into a single controller because \"I don't want to have too many classes. Waaah\" then yes its a huge anti-pattern.</p>\n\n<p>The alternative really is using AJAX to let the user CRUD child records without reloading the page.</p>\n\n<p>I would say that your example is not a good candidate for nested attributes. Are any of those associations actually even created by the user?</p>\n"}, {"tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": true, "score": 1, "last_activity_date": 1573993480, "creation_date": 1573993480, "answer_id": 58900411, "question_id": 58895953, "link": "https://stackoverflow.com/questions/58895953/confused-about-using-or-not-using-nested-attributes/58900411#58900411", "title": "Confused about using or not using nested attributes", "body": "<p>In data-modelling we sometimes split up stuff over different tables/models, and imho nested models/nested forms are mostly used where the nested model has no reason to exist without the parent and vice versa. E.g. a person with their addresses: when creating a person we immediately need to add their address because (for instance in a delivery situation) a person without an address makes no sense. </p>\n\n<p>Nested forms, where we can edit parent/child models as a whole, was popular and imho still has its benefit/place in some very specific situations (like the aforementioned example). </p>\n\n<p>But in most cases, where the creation of the parent is not dependant on the child, I rather prefer to use ajax calls. I present all the information on a page, but when adding a child I make sure it is immediately saved and stored in the database (using their own controller --while visiting the parent's show page for instance). </p>\n\n<p>I believe in most cases that the default/standard mega form is not the best UI/UX solution, and I believe that should be the main driver how to build your pages.</p>\n\n<p>Coming back to your example: these should never be shown in one huge form, nobody is going to edit a post, <em>and</em> the stats, right? Statistics are collected and shown, but hopefully never \"created\". Normally one tracks actual pageviews, visitors ...   </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12212177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 58900411, "answer_count": 3, "score": 2, "last_activity_date": 1573993480, "creation_date": 1573944571, "question_id": 58895953, "link": "https://stackoverflow.com/questions/58895953/confused-about-using-or-not-using-nested-attributes", "title": "Confused about using or not using nested attributes", "body": "<p>I would like to know the use cases for nested attributes. The pros and cons of using vs. not using it.</p>\n\n<p>I have a model that has a lot of <code>has_many</code> associations. Example:</p>\n\n<pre><code>class Post\n  has_many :visitors\n  has_many :pageviews\n  has_one  :metric\nend\n</code></pre>\n\n<p>Although I like the idea of just sending one request and having all of those things created with the correct associations, I don't like the idea that all the creation of the <code>visitors</code>, <code>pageviews</code> and <code>metric</code> are in the <code>PostsController</code>. I very much like the separation of concerns. Is there any clear rule that I should follow when dealing with nested attributes?</p>\n\n<p>Thank you.</p>\n"}]