[{"tags": ["ruby-on-rails", "ruby", "twitter"], "comments": [{"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1516838726, "post_id": 48433322, "comment_id": 83858709, "body": "What does <code>params[:number_of_tweets]</code> look like?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1516842150, "post_id": 48433322, "comment_id": 83859655, "body": "@dinjas: I assume <code>&quot;30&quot;</code>, from the online demo."}, {"owner": {"reputation": 11, "user_id": 5616014, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P9tvie6JgXE/AAAAAAAAAAI/AAAAAAAAAAA/QLhYakPeudo/photo.jpg?sz=128", "display_name": "Alexey", "link": "https://stackoverflow.com/users/5616014/alexey"}, "edited": false, "score": 0, "creation_date": 1516848650, "post_id": 48433322, "comment_id": 83861191, "body": "Yes. 30. But I&#39;m worried that tweets sometimes end in dots (...)."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1516848678, "post_id": 48433322, "comment_id": 83861196, "body": "are you sure the dots aren&#39;t in the official tweets? Sometimes people do this so they can write something across multiple tweets ...."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1516848688, "post_id": 48433322, "comment_id": 83861199, "body": "like this ....."}, {"owner": {"reputation": 11, "user_id": 5616014, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P9tvie6JgXE/AAAAAAAAAAI/AAAAAAAAAAA/QLhYakPeudo/photo.jpg?sz=128", "display_name": "Alexey", "link": "https://stackoverflow.com/users/5616014/alexey"}, "edited": false, "score": 0, "creation_date": 1516848840, "post_id": 48433322, "comment_id": 83861243, "body": "yes, I am sure. Phrases end randomly. You can try."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5616014, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P9tvie6JgXE/AAAAAAAAAAI/AAAAAAAAAAA/QLhYakPeudo/photo.jpg?sz=128", "display_name": "Alexey", "link": "https://stackoverflow.com/users/5616014/alexey"}, "edited": false, "score": 0, "creation_date": 1516914266, "post_id": 48447913, "comment_id": 83896731, "body": "Look at my update. I&#39;m sorry, but this does not work."}, {"owner": {"reputation": 11, "user_id": 5616014, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P9tvie6JgXE/AAAAAAAAAAI/AAAAAAAAAAA/QLhYakPeudo/photo.jpg?sz=128", "display_name": "Alexey", "link": "https://stackoverflow.com/users/5616014/alexey"}, "edited": false, "score": 0, "creation_date": 1516975838, "post_id": 48447913, "comment_id": 83918849, "body": "Andy, <b>tweet_mode: &quot;extended&quot;</b> does not work. Any ideas?"}, {"owner": {"reputation": 8279, "user_id": 262478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1526dcb784188b422544c6344ef223c2?s=128&d=identicon&r=PG", "display_name": "Andy Piper", "link": "https://stackoverflow.com/users/262478/andy-piper"}, "reply_to_user": {"reputation": 11, "user_id": 5616014, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P9tvie6JgXE/AAAAAAAAAAI/AAAAAAAAAAA/QLhYakPeudo/photo.jpg?sz=128", "display_name": "Alexey", "link": "https://stackoverflow.com/users/5616014/alexey"}, "edited": false, "score": 0, "creation_date": 1516977580, "post_id": 48447913, "comment_id": 83920033, "body": "That&#39;s weird - according to this Github issue <a href=\"https://github.com/sferik/twitter/issues/880#issuecomment-358485714\" rel=\"nofollow noreferrer\">github.com/sferik/twitter/issues/880#issuecomment-358485714</a> I thought that tweet_mode extended was supported. It might be the way I suggested accessing the text?"}], "tags": [], "owner": {"reputation": 8279, "user_id": 262478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1526dcb784188b422544c6344ef223c2?s=128&d=identicon&r=PG", "display_name": "Andy Piper", "link": "https://stackoverflow.com/users/262478/andy-piper"}, "is_accepted": false, "score": 0, "last_activity_date": 1516898459, "creation_date": 1516898459, "answer_id": 48447913, "question_id": 48433322, "link": "https://stackoverflow.com/questions/48433322/gem-twitter-parsing-returns-only-part-of-the-tweet/48447913#48447913", "title": "Gem &#39;twitter&#39;. Parsing returns only part of the tweet", "body": "<p>Try this:</p>\n\n<pre><code>@arr = []\nclient.search(\"@#{params[:twitter_acc]}\", result_type: \"recent\", tweet_mode: \"extended\")\n      .take(params[:number_of_tweets].to_i)\n      .collect do |tweet|\n  @arr &lt;&lt; tweet\n            .full_text\n            .gsub(\"@#{params[:twitter_acc]}\", \"\")\n            .gsub(\"RT :\", \"\")\n            .gsub(\"RT\", \"\")\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5616014, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P9tvie6JgXE/AAAAAAAAAAI/AAAAAAAAAAA/QLhYakPeudo/photo.jpg?sz=128", "display_name": "Alexey", "link": "https://stackoverflow.com/users/5616014/alexey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516914141, "creation_date": 1516836247, "last_edit_date": 1516914141, "question_id": 48433322, "link": "https://stackoverflow.com/questions/48433322/gem-twitter-parsing-returns-only-part-of-the-tweet", "title": "Gem &#39;twitter&#39;. Parsing returns only part of the tweet", "body": "<p>I am using the twitter gem. Please tell me why I get only a part of tweet when parsing? Take a look (<a href=\"https://masterpro.herokuapp.com/tweet_parser/index\" rel=\"nofollow noreferrer\">live demo</a>).</p>\n\n<p>For example:</p>\n\n<pre><code>Yeah, we don't want to hear from you. You've been yapping away for a million years. And by the w\u2026 \nThen, \u2018for balance\u2019 you need to also clearly and repe\u2026\nYou stated as fact that there would be a #Brexit dividend,\u2026\n</code></pre>\n\n<p>This is my code:</p>\n\n<p><strong>controller</strong></p>\n\n<pre><code>@arr = []\nclient.search(\"@#{params[:twitter_acc]}\", result_type: \"recent\")\n      .take(params[:number_of_tweets].to_i)\n      .collect do |tweet|\n  @arr &lt;&lt; tweet\n            .text\n            .gsub(\"@#{params[:twitter_acc]}\", \"\")\n            .gsub(\"RT :\", \"\")\n            .gsub(\"RT\", \"\")\nend\n</code></pre>\n\n<p><strong>view</strong></p>\n\n<pre><code>&lt;% @arr.uniq.each do |line| %&gt;\n  &lt;%= line %&gt;&lt;br&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How can I solve this problem?\nAny ideas?</p>\n\n<p>UPDATE</p>\n\n<p><a href=\"https://i.stack.imgur.com/e1BqQ.png\" rel=\"nofollow noreferrer\">Tweet_parser. Result screenshot</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1516840469, "post_id": 48433246, "comment_id": 83859242, "body": "Do you have any initializers that try to access the database? Also, it would be better if you dumped the stack trace in as a code block rather than a block quote, much easier to read that way."}, {"owner": {"reputation": 642, "user_id": 536325, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8ecf6741b66c675e0e5b5bd7bd1e4918?s=128&d=identicon&r=PG", "display_name": "Isaac Y", "link": "https://stackoverflow.com/users/536325/isaac-y"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1516844383, "post_id": 48433246, "comment_id": 83860220, "body": "You are a genius -- it was related to the initializers! I commented out those lines and it is now working. Also thanks for the tip regarding code block vs block quote..am new to this. Will keep it in mind for future posts :)"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1516847107, "post_id": 48433246, "comment_id": 83860833, "body": "I just walked through the stack trace to see if there was anything suspicious, initializers trying to access things is a common source of problems as they run while the app is starting up in order to run rake commands (such as <code>db:setup</code>). BTW, that SQL is what ActiveRecord uses to figure out table structure with PostgreSQL."}], "owner": {"reputation": 642, "user_id": 536325, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8ecf6741b66c675e0e5b5bd7bd1e4918?s=128&d=identicon&r=PG", "display_name": "Isaac Y", "link": "https://stackoverflow.com/users/536325/isaac-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516844139, "creation_date": 1516835673, "last_edit_date": 1516844139, "question_id": 48433246, "link": "https://stackoverflow.com/questions/48433246/setting-up-db-on-copied-rails-app-activerecordstatementinvalid-pgundefined", "title": "Setting up DB on copied Rails App: ActiveRecord::StatementInvalid: PG::UndefinedTable: ERROR: relation &quot;settings&quot; does not exist", "body": "<p>My old computer failed me so I copied my rails app onto a new computer for development. I created the postgresql database and tried running rake db:migrate but get the following error:</p>\n\n<pre><code>ActiveRecord::StatementInvalid: PG::UndefinedTable: ERROR:  relation \"settings\" does not exist LINE 5:                WHERE a.attrelid = '\"settings\"'::regclass\n                                          ^ :               SELECT a.attname, format_type(a.atttypid, a.atttypmod),\n                     pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod\n                FROM pg_attribute a LEFT JOIN pg_attrdef d\n                  ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n               WHERE a.attrelid = '\"settings\"'::regclass\n                 AND a.attnum &gt; 0 AND NOT a.attisdropped\n               ORDER BY a.attnum /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql_adapter.rb:822:in `async_exec' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql_adapter.rb:822:in `block in exec_no_cache' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/abstract_adapter.rb:373:in `block in log' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/notifications/instrumenter.rb:20:in `instrument' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/abstract_adapter.rb:367:in `log' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql_adapter.rb:822:in `exec_no_cache' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql/database_statements.rb:137:in `exec_query' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql_adapter.rb:976:in `column_definitions' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql/schema_statements.rb:187:in `columns' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/schema_cache.rb:93:in `block in prepare_default_proc' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/schema_cache.rb:44:in `yield' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/schema_cache.rb:44:in `columns' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/model_schema.rb:214:in `columns' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/model_schema.rb:223:in `columns_hash' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/dynamic_matchers.rb:64:in `block in valid?' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/dynamic_matchers.rb:64:in `each' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/dynamic_matchers.rb:64:in `all?' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/dynamic_matchers.rb:64:in `valid?' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/dynamic_matchers.rb:22:in `method_missing' /Users/username/Documents/OLD MACBOOK FILES/username/Rails/chester/lib/etsy_api.rb:17:in `&lt;module:EtsyAPI&gt;' /Users/username/Documents/OLD MACBOOK FILES/username/Rails/chester/lib/etsy_api.rb:1:in `&lt;top (required)&gt;' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `require' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `block in require' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:232:in `load_dependency' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `require' /Users/username/Documents/OLD MACBOOK FILES/username/Rails/chester/config/initializers/custom.rb:1:in `&lt;top (required)&gt;' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:241:in `load' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:241:in `block in load' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:232:in `load_dependency' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:241:in `load' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/engine.rb:648:in `block in load_config_initializer' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/notifications.rb:161:in `instrument' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/engine.rb:647:in `load_config_initializer' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/engine.rb:612:in `block (2 levels) in &lt;class:Engine&gt;' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/engine.rb:611:in `each' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/engine.rb:611:in `block in &lt;class:Engine&gt;' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:30:in `instance_exec' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:30:in `run' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:55:in `block in run_initializers' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:44:in `each' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:44:in `tsort_each_child' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:54:in `run_initializers' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/application.rb:300:in `initialize!' /Users/username/Documents/OLD MACBOOK FILES/username/Rails/chester/config/environment.rb:5:in `&lt;top (required)&gt;' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `require' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `block in require' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:232:in `load_dependency' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `require' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/application.rb:276:in `require_environment!' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/application.rb:379:in `block in run_tasks_blocks' /Users/username/.rvm/gems/ruby-2.2.5/gems/rake-11.3.0/exe/rake:27:in `&lt;top (required)&gt;' /Users/username/.rvm/gems/ruby-2.2.5/bin/ruby_executable_hooks:15:in `eval' /Users/username/.rvm/gems/ruby-2.2.5/bin/ruby_executable_hooks:15:in `&lt;main&gt;' PG::UndefinedTable: ERROR:  relation \"settings\" does not exist LINE 5:                WHERE a.attrelid = '\"settings\"'::regclass\n                                          ^ /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql_adapter.rb:822:in `async_exec' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql_adapter.rb:822:in `block in exec_no_cache' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/abstract_adapter.rb:373:in `block in log' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/notifications/instrumenter.rb:20:in `instrument' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/abstract_adapter.rb:367:in `log' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql_adapter.rb:822:in `exec_no_cache' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql/database_statements.rb:137:in `exec_query' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql_adapter.rb:976:in `column_definitions' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/postgresql/schema_statements.rb:187:in `columns' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/schema_cache.rb:93:in `block in prepare_default_proc' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/schema_cache.rb:44:in `yield' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/connection_adapters/schema_cache.rb:44:in `columns' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/model_schema.rb:214:in `columns' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/model_schema.rb:223:in `columns_hash' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/dynamic_matchers.rb:64:in `block in valid?' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/dynamic_matchers.rb:64:in `each' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/dynamic_matchers.rb:64:in `all?' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/dynamic_matchers.rb:64:in `valid?' /Users/username/.rvm/gems/ruby-2.2.5/gems/activerecord-4.1.4/lib/active_record/dynamic_matchers.rb:22:in `method_missing' /Users/username/Documents/OLD MACBOOK FILES/username/Rails/chester/lib/etsy_api.rb:17:in `&lt;module:EtsyAPI&gt;' /Users/username/Documents/OLD MACBOOK FILES/username/Rails/chester/lib/etsy_api.rb:1:in `&lt;top (required)&gt;' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `require' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `block in require' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:232:in `load_dependency' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `require' /Users/username/Documents/OLD MACBOOK FILES/username/Rails/chester/config/initializers/custom.rb:1:in `&lt;top (required)&gt;' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:241:in `load' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:241:in `block in load' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:232:in `load_dependency' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:241:in `load' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/engine.rb:648:in `block in load_config_initializer' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/notifications.rb:161:in `instrument' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/engine.rb:647:in `load_config_initializer' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/engine.rb:612:in `block (2 levels) in &lt;class:Engine&gt;' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/engine.rb:611:in `each' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/engine.rb:611:in `block in &lt;class:Engine&gt;' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:30:in `instance_exec' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:30:in `run' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:55:in `block in run_initializers' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:44:in `each' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:44:in `tsort_each_child' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/initializable.rb:54:in `run_initializers' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/application.rb:300:in `initialize!' /Users/username/Documents/OLD MACBOOK FILES/username/Rails/chester/config/environment.rb:5:in `&lt;top (required)&gt;' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `require' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `block in require' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:232:in `load_dependency' /Users/username/.rvm/gems/ruby-2.2.5/gems/activesupport-4.1.4/lib/active_support/dependencies.rb:247:in `require' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/application.rb:276:in `require_environment!' /Users/username/.rvm/gems/ruby-2.2.5/gems/railties-4.1.4/lib/rails/application.rb:379:in `block in run_tasks_blocks' /Users/username/.rvm/gems/ruby-2.2.5/gems/rake-11.3.0/exe/rake:27:in `&lt;top (required)&gt;' /Users/username/.rvm/gems/ruby-2.2.5/bin/ruby_executable_hooks:15:in `eval' /Users/username/.rvm/gems/ruby-2.2.5/bin/ruby_executable_hooks:15:in `&lt;main&gt;' Tasks: TOP =&gt; db:migrate =&gt; environment (See full trace by running task with --trace)\n</code></pre>\n\n<p>I also tried rake db:setup and other commands but got the same error. Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "simple-form", "simple-form-for"], "comments": [{"owner": {"reputation": 1145, "user_id": 3262916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abfd08a0e41f2c1b292d233100e5a4?s=128&d=identicon&r=PG", "display_name": "Ziv Galili", "link": "https://stackoverflow.com/users/3262916/ziv-galili"}, "edited": false, "score": 0, "creation_date": 1516838744, "post_id": 48432807, "comment_id": 83858712, "body": "as the answer said, when you use <code>build_licence</code> it adds a new empty license, thats why you dont see any data in it. all you need is to set <code>@company</code>, and i guess you do it on some other action - so you edit method should be empty and it should work"}], "answers": [{"tags": [], "owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "is_accepted": true, "score": 1, "last_activity_date": 1516834164, "creation_date": 1516834164, "answer_id": 48432992, "question_id": 48432807, "link": "https://stackoverflow.com/questions/48432807/how-to-fill-edit-forms-nested-inputs-simple-fields-for-rails-5/48432992#48432992", "title": "How to fill edit form&#39;s nested inputs ? ( simple_fields_for ) Rails 5", "body": "<p>You say it doesn't fill the model inputs... but you are using <code>build_license</code> which creates a new, empty one every time... even if one exists already... it will blow the existing one away.</p>\n\n<p>You might need to do something like:</p>\n\n<pre><code>def edit\n  // i get company id with before_action\n  @company.licence || @company.build_licence\nend\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 6427902, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f83980f84f1a426f857f220724a661f0?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Coders", "link": "https://stackoverflow.com/users/6427902/crazy-coders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "accepted_answer_id": 48432992, "answer_count": 1, "score": 0, "last_activity_date": 1516834164, "creation_date": 1516833213, "question_id": 48432807, "link": "https://stackoverflow.com/questions/48432807/how-to-fill-edit-forms-nested-inputs-simple-fields-for-rails-5", "title": "How to fill edit form&#39;s nested inputs ? ( simple_fields_for ) Rails 5", "body": "<p>i have a <code>nested</code> form. <code>New</code> method works well. But in my <code>edit</code> form nested inputs are empty. Here is my form : </p>\n\n<pre><code>  &lt;%= simple_form_for @company , url: admin_company_path(@company) do |f| %&gt;\n        &lt;%= f.simple_fields_for :licence do |p| %&gt;\n         &lt;%= p.input_field  :number  %&gt;  \n        &lt;% end %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>my company model : </p>\n\n<pre><code>  accepts_nested_attributes_for :licence\n  has_one :licence , inverse_of: :company , :dependent =&gt; :destroy\n</code></pre>\n\n<p>my licence model : </p>\n\n<pre><code>  belongs_to :company\n</code></pre>\n\n<p>my edit method in controller : </p>\n\n<pre><code>  def edit\n    // i get company id with before_action\n    @company.build_licence\n  end\n</code></pre>\n\n<p>my new method in controller  : </p>\n\n<pre><code>  def new\n    @company = Company.new\n    @company.build_licence\n  end\n</code></pre>\n\n<p>new/create methods work great with this code. But edit form does not fill nested model inputs.</p>\n"}, {"tags": ["ruby", "rename"], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 1, "last_activity_date": 1516833898, "creation_date": 1516833898, "answer_id": 48432947, "question_id": 48432477, "link": "https://stackoverflow.com/questions/48432477/simple-ruby-script-to-change-file-extension-in-a-directory/48432947#48432947", "title": "Simple ruby script to change file extension in a directory", "body": "<p>You can use <code>Dir.glob</code> and select the <code>*.htm</code> files, then rename their extension name from <code>htm</code> to <code>html</code>:</p>\n\n<pre><code>Dir.glob('*.htm').each { |file| File.rename(file, file.sub('htm', 'html')) }\n</code></pre>\n\n<p>Although also exists <a href=\"http://plasmasturm.org/code/rename/\" rel=\"nofollow noreferrer\"><code>rename</code></a>:</p>\n\n<pre><code>$ rename 's/htm/html/g' *\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9264553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d107117dbc15915628cee1372495be06?s=128&d=identicon&r=PG&f=1", "display_name": "aaaaaaaaaaaa3213", "link": "https://stackoverflow.com/users/9264553/aaaaaaaaaaaa3213"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 0, "closed_date": 1516835208, "answer_count": 1, "score": 0, "last_activity_date": 1516833898, "creation_date": 1516831620, "last_edit_date": 1516833386, "question_id": 48432477, "link": "https://stackoverflow.com/questions/48432477/simple-ruby-script-to-change-file-extension-in-a-directory", "closed_reason": "Duplicate", "title": "Simple ruby script to change file extension in a directory", "body": "<p>Could someone help me finishing this script to rename all  *.htm files to *.html in a given directory? Many thanks.</p>\n\n<pre><code>Dir.METHOD(\"*.htm\").each do |html_file|\n FileUtils.METHOD html_file, \"#{html_file.METHOD(/REGEX/,'.html')}\"\nend\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "node.js", "ruby", "reactjs"], "comments": [{"owner": {"reputation": 12919, "user_id": 5535040, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pcrdYg3eoyo/AAAAAAAAAAI/AAAAAAAAAGY/NXQ5lVKswiU/photo.jpg?sz=128", "display_name": "Chase DeAnda", "link": "https://stackoverflow.com/users/5535040/chase-deanda"}, "edited": false, "score": 1, "creation_date": 1516831210, "post_id": 48432324, "comment_id": 83855886, "body": "Yep, according to <a href=\"https://www.pluralsight.com/guides/ruby-ruby-on-rails/building-a-crud-interface-with-react-and-ruby-on-rails\" rel=\"nofollow noreferrer\">pluralsight.com/guides/ruby-ruby-on-rails/&hellip;</a> you need to create an api that you will hit from your React front-end."}, {"owner": {"reputation": 282, "user_id": 9209617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W7QGHJPml8k/AAAAAAAAAAI/AAAAAAAAM90/dTxZp6M2ajE/photo.jpg?sz=128", "display_name": "Shirley", "link": "https://stackoverflow.com/users/9209617/shirley"}, "edited": false, "score": 0, "creation_date": 1516831272, "post_id": 48432324, "comment_id": 83855917, "body": "You need to do it by API so you&#39;ll have to have two servers running."}, {"owner": {"reputation": 5986, "user_id": 2774284, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2138267e327072281350c2550b8598cc?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Haller-Roby", "link": "https://stackoverflow.com/users/2774284/jake-haller-roby"}, "edited": false, "score": 0, "creation_date": 1516832148, "post_id": 48432324, "comment_id": 83856311, "body": "While you do need to do it through an API, you definitely can accomplish this using a single server.  If you desire a separation of concerns, that&#39;s not a bad idea, but it&#39;s not necessary either."}, {"owner": {"reputation": 113, "user_id": 7225294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5910318dc4612ba173be4c7a10d807f0?s=128&d=identicon&r=PG", "display_name": "Szalbik", "link": "https://stackoverflow.com/users/7225294/szalbik"}, "edited": false, "score": 0, "creation_date": 1516832659, "post_id": 48432324, "comment_id": 83856576, "body": "If react is just V of MVC structure so there shouldn&#39;t be a way to pass data to component like passing to erb?"}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 7225294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5910318dc4612ba173be4c7a10d807f0?s=128&d=identicon&r=PG", "display_name": "Szalbik", "link": "https://stackoverflow.com/users/7225294/szalbik"}, "is_accepted": false, "score": 3, "last_activity_date": 1516835032, "creation_date": 1516835032, "answer_id": 48433156, "question_id": 48432324, "link": "https://stackoverflow.com/questions/48432324/passing-data-from-rails-controller-to-react-component/48433156#48433156", "title": "Passing data from rails controller to react component", "body": "<p>I find solution by my self. <a href=\"https://hackernoon.com/how-to-get-your-rails-data-into-your-react-component-with-webpacker-647dc63706c9\" rel=\"nofollow noreferrer\">https://hackernoon.com/how-to-get-your-rails-data-into-your-react-component-with-webpacker-647dc63706c9</a></p>\n\n<p>By adding content tag to view where I want to render react component and pass props as attributes.</p>\n\n<pre><code>&lt;%= content_tag :div,\n  id: \"appointments_data\",\n  data: @appointments.to_json do %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>then parse data and add it do props</p>\n\n<pre><code>document.addEventListener('DOMContentLoaded', () =&gt; {\n  const node = document.getElementById('appointments_data')\n  const data = JSON.parse(node.getAttribute('data'))\n  ReactDOM.render(\n    &lt;Appointments appointments={data} /&gt;,\n    document.body.appendChild(document.createElement('div')),\n  )\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 4, "last_activity_date": 1516854722, "creation_date": 1516854722, "answer_id": 48435722, "question_id": 48432324, "link": "https://stackoverflow.com/questions/48432324/passing-data-from-rails-controller-to-react-component/48435722#48435722", "title": "Passing data from rails controller to react component", "body": "<p>Here is another way:</p>\n\n<p>some_views.html.erb</p>\n\n<pre><code>&lt;%= javascript_tag do %&gt;\n  var appointments = &lt;%= raw(@appointments.to_json) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>some_react_components.js</p>\n\n<pre><code>document.addEventListener('DOMContentLoaded', () =&gt; {\n  const data = window.appointments\n  ReactDOM.render(\n    &lt;Appointments appointments={data} /&gt;,\n    document.body.appendChild(document.createElement('div')),\n  )\n})\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7225294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5910318dc4612ba173be4c7a10d807f0?s=128&d=identicon&r=PG", "display_name": "Szalbik", "link": "https://stackoverflow.com/users/7225294/szalbik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4030, "favorite_count": 4, "accepted_answer_id": 48435722, "answer_count": 2, "score": 3, "last_activity_date": 1516854722, "creation_date": 1516831015, "last_edit_date": 1516833652, "question_id": 48432324, "link": "https://stackoverflow.com/questions/48432324/passing-data-from-rails-controller-to-react-component", "title": "Passing data from rails controller to react component", "body": "<p>I'm trying to integrate rails with react via webpacker, but i dont know how to pass in example <code>@post = Post.all</code> from controller to react component props. I have to do this by api or there is other way?? </p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1516829305, "post_id": 48431835, "comment_id": 83854890, "body": "&quot;Huh?&quot; Please show <i>actual</i> input and current / <i>expected</i> output - the words after &quot;It&#39;s working&quot; are ambiguous. Also, a little bit of question formatting makes it a much more palatable read."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 1, "creation_date": 1516829741, "post_id": 48431835, "comment_id": 83855112, "body": "use <code>print</code> instead of <code>puts</code>"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1516830872, "post_id": 48431835, "comment_id": 83855682, "body": "Why not just use <code>String#reverse</code>?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1516831189, "post_id": 48431835, "comment_id": 83855874, "body": "You don&#39;t need the <code>to_s</code>."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "is_accepted": false, "score": 0, "last_activity_date": 1516834080, "last_edit_date": 1516834080, "creation_date": 1516829286, "answer_id": 48431882, "question_id": 48431835, "link": "https://stackoverflow.com/questions/48431835/reverse-a-string-while-keeping-it-in-a-single-line/48431882#48431882", "title": "Reverse a string while keeping it in a single line", "body": "<p>Try this:</p>\n\n<pre><code>\"Hi now it's going to be done!\".chars.inject([]) { |s, c| s.unshift(c) }.join\n</code></pre>\n\n<p>Or This is a little easier to follow:</p>\n\n<pre><code>string = 'Hi now it's going to be done!'\nstring.reverse!\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1516830438, "creation_date": 1516830438, "answer_id": 48432170, "question_id": 48431835, "link": "https://stackoverflow.com/questions/48431835/reverse-a-string-while-keeping-it-in-a-single-line/48432170#48432170", "title": "Reverse a string while keeping it in a single line", "body": "<p><code>puts</code> adds a newline to the end of the output if one isn't already present.</p>\n\n<p><code>print</code> does not. So do this:</p>\n\n<pre><code>while i &gt;=0\n  print string[i]\n  i=i-1\nend\nputs\n</code></pre>\n\n<p>The final <code>puts</code> is because you want any further printing to be on a new line.</p>\n"}], "owner": {"reputation": 5, "user_id": 5341731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc5c3cc411f0d370700b02d522249b3?s=128&d=identicon&r=PG&f=1", "display_name": "faaiz sam", "link": "https://stackoverflow.com/users/5341731/faaiz-sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1516845999, "creation_date": 1516829071, "last_edit_date": 1516845999, "question_id": 48431835, "link": "https://stackoverflow.com/questions/48431835/reverse-a-string-while-keeping-it-in-a-single-line", "title": "Reverse a string while keeping it in a single line", "body": "<p>I'm trying to reverse a string using the code:</p>\n\n<pre><code>puts(\"Hi now it's going to be done!\")\nstring = gets.chomp.to_s\ni = string.length\nwhile i &gt;= 0\n  puts(string[i])\n  i = i - 1\nend\n</code></pre>\n\n<p>It prints the string in backward order, but each word is on a single line. How can I keep all of them on a single line?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 12200, "user_id": 473040, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c2713a4959692f16d27d2553fb06cc4b?s=128&d=identicon&r=PG", "display_name": "equivalent8", "link": "https://stackoverflow.com/users/473040/equivalent8"}, "is_accepted": true, "score": 15, "last_activity_date": 1516828740, "creation_date": 1516828740, "answer_id": 48431754, "question_id": 48431753, "link": "https://stackoverflow.com/questions/48431753/memoization-caching-in-ruby-ruby-on-rails/48431754#48431754", "title": "Memoization &amp; caching in Ruby &amp; Ruby on Rails", "body": "<h3>Memoization</h3>\n\n<p>First let's answer the </p>\n\n<blockquote>\n  <p>Why is Application making multiple SQL calls <strong>even if I memoize the object</strong></p>\n</blockquote>\n\n<p>Yes we are memoizing the Policy object with <code>@policy ||= WorkPolicy.new</code> </p>\n\n<p>But we are not memoizing what that objects is calling. That mean we need to memoize the underlying object method call result. </p>\n\n<p>So if we did:</p>\n\n<pre><code>@work = Work.last\n@work.policy.able_to_delete?\n#=&gt; SELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 100] # sql call \n@work.policy.able_to_delete?\n#=&gt; SELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 100] # sql call \n@work.policy.able_to_delete?\n#=&gt; SELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 100] # sql call \n</code></pre>\n\n<p>... we would call multiple time the <code>comments.count</code></p>\n\n<p>But if we introduce another layer of memoization:</p>\n\n<p>So let's change this:</p>\n\n<pre><code>class WorkPolicy\n  # ...\n\n  def work_has_no_comments\n    work.comments.count &lt; 1\n  end\nend\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>class WorkPolicy\n  # ...\n\n  def work_has_no_comments\n    @work_has_no_comments ||= comments.count &lt; 1\n  end\nend\n\n\n@work = Work.last\n@work.policy.able_to_delete?\n#=&gt; SELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 100] # sql call \n@work.policy.able_to_delete?\n@work.policy.able_to_delete?\n</code></pre>\n\n<p>As you can see the SQL call on count is made only the first time and then result is returned from memory of the object state.</p>\n\n<h3>Caching</h3>\n\n<p>But our case of \"looping through multiple works\" this would not work because we are initializing 100 Work objects with 100 WorkPolicy objects </p>\n\n<p>Best way to understand it is by running this code in your <code>irb</code>: </p>\n\n<pre><code>class Foo\n  def x\n    @x ||= calculate\n  end\n\n  private\n\n  def calculate\n      sleep 2 # slow query\n      123\n  end\nend\n\nclass Bar\n  def y\n    @y ||= Foo.new\n  end\nend\n\np \"10 times calling same memoized object\\n\"\nbar = Bar.new\n10.times do\n  puts  bar.y.x\nend\n\np \"10 times initializing new object\\n\"\n\n10.times do\n  bar = Bar.new\n  puts  bar.y.x\nend\n</code></pre>\n\n<p>One way to deal with this is to use Rails cache</p>\n\n<pre><code>class WorkPolicy\n  # ...\n\n  def work_has_no_comments\n    Rails.cache.fetch [WorkPolicy, 'work_has_no_comments', @work] do\n      work.comments.count &lt; 1\n    end\n  end\nend\n\nclass Comment\n  belongs_to :work, touch: true    # `touch: true` will update the Work#updated_at each time new commend is added/changed, so that we drop the cache \nend\n</code></pre>\n\n<blockquote>\n  <p>Now this is just stupid example. I know this should be probably cached this by introducing on <code>Work#comments_count</code> method and do the cache the count of comments in there. I just want to to demonstrate the options.</p>\n</blockquote>\n\n<p>With caching like this in place, first time we run the <code>WorksController#index</code> we would get multiple SQL calls :</p>\n\n<pre><code>SELECT \"works\".* FROM \"works\"\nSELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 1]\nSELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 2]\nSELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 3]\nSELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 4]\n# ...\n</code></pre>\n\n<p>...but second, third,  call would look like:</p>\n\n<pre><code>SELECT \"works\".* FROM \"works\"\n# no count call\n</code></pre>\n\n<p>And if you add a new comment to the Work with id <code>3</code> :</p>\n\n<pre><code>SELECT \"works\".* FROM \"works\"\nSELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 3]\n</code></pre>\n\n<h3>Proper SQL</h3>\n\n<p>Now we are still not satisfied. We want that first run to be fast !\nProblem is our way of how we are calling our associations (Comments). We are Lazy loading them:</p>\n\n<pre><code>Work.limit(3).each {|w| w.comments }\n\n# =&gt; SELECT  \"works\".* FROM \"works\" WHERE  ORDER BY \"works\".\"id\" DESC LIMIT 10\n# =&gt; SELECT \"comments\".* FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  ORDER BY comments.created_at ASC  [[\"work_id\", 97]]\n# =&gt; SELECT \"comments\".* FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  ORDER BY comments.created_at ASC  [[\"work_id\", 98]]\n# =&gt; SELECT \"comments\".* FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  ORDER BY comments.created_at ASC  [[\"work_id\", 99]]\n</code></pre>\n\n<p>But if we eager load them:</p>\n\n<pre><code>  Work.limit(3).includes(:comments).map(&amp;:comments)\n\n  SELECT  \"works\".* FROM \"works\" WHERE \"works\".\"deleted_at\" IS NULL LIMIT 3\n  SELECT \"comments\".* FROM \"comments\" WHERE \"comments\".\"status\" = 'approved' AND \"comments\".\"work_id\" IN (97, 98, 99)  ORDER BY comments.created_at ASC\n</code></pre>\n\n<blockquote>\n  <p>Read more about <code>includes</code>, <code>joins</code> in <a href=\"http://blog.scoutapp.com/articles/2017/01/24/activerecord-includes-vs-joins-vs-preload-vs-eager_load-when-and-where\" rel=\"noreferrer\">http://blog.scoutapp.com/articles/2017/01/24/activerecord-includes-vs-joins-vs-preload-vs-eager_load-when-and-where</a></p>\n</blockquote>\n\n<p>So our code could be:</p>\n\n<pre><code>class WorksController &lt; ApplicationController\n  def index\n    @works = Work.all.includes(:comments)\n  end\nend\n\nclass WorkPolicy\n  # ...\n\n  def work_has_no_comments\n    work.comments.size &lt; 1        # we changed `count` to `size`\n  end\nend\n</code></pre>\n\n<p>Q: <em>Now wait a minute, isn't <code>comments.count</code> and <code>commets.size</code> the same ?</em></p>\n\n<p>Not really </p>\n\n<pre><code>10.times do\n  work.comments.size\nend  \n# SELECT \"comments\".* FROM \"comments\" WHERE \"comments\".\"work_id\" = $1    ORDER BY comments.created_at ASC  [[\"work_id\", 1]]\n</code></pre>\n\n<p>... loads all the comments to (something like) Array and does array calculation of the size (as if [].size)</p>\n\n<pre><code>10.times do\n  work.comments.count\nend\n# SELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 1]]\n# SELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 1]]\n# SELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 1]]\n# ...\n</code></pre>\n\n<p>...executes  <code>SELECT COUNT</code> which is much faster than loading \"all comments\" to calculate the size, but then when you need to execute this 10 times you are explicitly making 10 calls</p>\n\n<blockquote>\n  <p>Now I'm overexaturating with <code>work.comments.size</code> Rails is more clever in  determining if you just want just the <code>size</code>. In some cases it just executes <code>SELECT COUNT(*)</code> instead of \"load all comments to array\" and do [].size</p>\n</blockquote>\n\n<p>It's simmilar like <code>.pluck</code> vs <code>.map</code></p>\n\n<pre><code>scope = Work.limit(10)\nscope.pluck(:title)\n# SELECT  \"works\".\"title\" FROM \"works\" LIMIT 10\n# =&gt; ['foo', 'bar', ...]\nscope.pluck(:title)\n# SELECT  \"works\".\"title\" FROM \"works\" LIMIT 10\n# =&gt; ['foo', 'bar', ...]\n\nscope.map(&amp;:title)\n# SELECT  \"works\".* FROM \"works\" LIMIT 10\n# =&gt; ['foo', 'bar', ...]\nscope.map(&amp;:title)\n# =&gt; ['foo', 'bar', ...]\n</code></pre>\n\n<ul>\n<li><code>pluck</code> is faster as it only selects the <code>title</code> to array, but executes SQL call every time</li>\n<li><code>map</code> will cause Rails to evaluate the <code>SELECT *</code> in order to populate <code>title</code> to array, but then you can work with loaded objects </li>\n</ul>\n\n<h3>Conclusion</h3>\n\n<p>There is no silver bullet. It always depends on what you want to achive. </p>\n\n<p>One may argue that the \"optimize SQL\" solution works the best, but that's not true. You need to implement similar SQL optimization in every place where you are calling <code>work.policy.able_to_delete</code> which may be 10 or 100 places. <code>includes</code> may not be always good idea in terms of performance.</p>\n\n<p>Cache can get supper chained in terms of what event should drop what part of the cache. If you don't do it properly your website may be displaying \"out of date information\" ! In case of policy objects that is super dangerous.</p>\n\n<p>Memoization is not always flexible enough as you may  need to redesign large part of code base to achieve it and introduce too many layers of unnecessary abstraction </p>\n\n<blockquote>\n  <p>Not to mention that memoization is big No No in thread safe enviroments like Rubinius unless you sync your threads correctly. Don't worry you are fine with memoization (in 95% cases) if you use MRI, Rails &amp; Puma are Thread safe but that's different kind of \"thread safe\". You really need to do something stuppid for that to be an issue. This article is way too long to go into that topic. Google it!</p>\n</blockquote>\n\n<p>Really depends what your application (part of application) is aims for. My only recommendation is: Profile/benchmark your app ! Don't prematurely optimize. Use tools like New relic to discover what parts of your app are slow. </p>\n\n<p>Optimize gradually, don't build slow application and then In one sprint you will decide \"Right, lets optimize\" because you may find out that you made poor design choices and 50% of your App needs rewrite to be faster.</p>\n\n<h3>Other solutions not mentioned</h3>\n\n<p><strong>Counter Cache</strong></p>\n\n<ul>\n<li><a href=\"http://yerb.net/blog/2014/03/13/three-easy-steps-to-using-counter-caches-in-rails/\" rel=\"noreferrer\">http://yerb.net/blog/2014/03/13/three-easy-steps-to-using-counter-caches-in-rails/</a></li>\n<li><a href=\"http://guides.rubyonrails.org/association_basics.html\" rel=\"noreferrer\">http://guides.rubyonrails.org/association_basics.html</a> (search for \"counter cache\")</li>\n</ul>\n\n<p><strong>Database indexes</strong></p>\n\n<p>May sound of topic but lot of performance issues happens because your app has no DB indexes (or too many premature indexes) </p>\n\n<ul>\n<li><a href=\"http://www.rakeroutes.com/blog/increase-rails-performance-with-database-indexes/\" rel=\"noreferrer\">http://www.rakeroutes.com/blog/increase-rails-performance-with-database-indexes/</a></li>\n</ul>\n"}], "owner": {"reputation": 12200, "user_id": 473040, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c2713a4959692f16d27d2553fb06cc4b?s=128&d=identicon&r=PG", "display_name": "equivalent8", "link": "https://stackoverflow.com/users/473040/equivalent8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1727, "favorite_count": 5, "accepted_answer_id": 48431754, "answer_count": 1, "score": 5, "last_activity_date": 1516828740, "creation_date": 1516828740, "question_id": 48431753, "link": "https://stackoverflow.com/questions/48431753/memoization-caching-in-ruby-ruby-on-rails", "title": "Memoization &amp; caching in Ruby &amp; Ruby on Rails", "body": "<p><code>\nGiven application is looping through many fields\nWhy is Application making multiple SQL calls even if I memoize the object\n</code></p>\n\n<p>or</p>\n\n<p><code>\nGiven application is looping through many items\nHow to prevent application doing expensive calculation on every item\n</code></p>\n\n<h3>example Rails code</h3>\n\n<ul>\n<li>Work has many comments</li>\n<li>work can be deleted only if there are no comments OR if admin user</li>\n<li>our view interface will display \"delete work\" only if can be deleted</li>\n</ul>\n\n<blockquote>\n  <p>Note: we use Policy View Objects as described in <a href=\"http://www.eq8.eu/blogs/41-policy-objects-in-ruby-on-rails\" rel=\"noreferrer\">http://www.eq8.eu/blogs/41-policy-objects-in-ruby-on-rails</a></p>\n</blockquote>\n\n<pre><code>class WorksController &lt; ApplicationController\n  def index\n    @works = Work.all\n  end\nend\n\n&lt;% @works.each do |work| %&gt;\n   &lt;%= link_to(\"Delete work\", work, method: delete) if work.policy.able_to_delete?(current_user: current_user) %&gt;\n&lt;% end %&gt;\n\nclass Work &lt; ActiveRecord::Base\n  has_many :comments\n\n  def policy\n     @policy ||= WorkPolicy.new\n  end\nend\n\nclass Comment\n  belongs_to :work\nend\n\nclass WorkPolicy\n  attr_reader :work\n\n  def initialize(work)\n    @work = work\n  end\n\n  def able_to_delete?(current_user: nil)\n    work_has_no_comments || (current_user &amp;&amp; current_user.admin?)\n  end\n\n  private\n\n  def work_has_no_comments\n    work.comments.count &lt; 1\n  end\nend\n</code></pre>\n\n<p>Now let say we have 100 Works in DB</p>\n\n<p>This would result in multiple SQL calls:</p>\n\n<pre><code>SELECT \"works\".* FROM \"works\"\nSELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 1]\nSELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 2]\nSELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 3]\nSELECT COUNT(*) FROM \"comments\" WHERE \"comments\".\"work_id\" = $1  [[\"work_id\", 4]\n</code></pre>\n\n<blockquote>\n  <p>Note: recently I was explaining this example to a colleague, I think it's worth it to be documented for more developers</p>\n</blockquote>\n"}, {"tags": ["ruby", "sinatra", "yaml", "twilio", "twilio-twiml"], "comments": [{"owner": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "edited": false, "score": 0, "creation_date": 1516866218, "post_id": 48431360, "comment_id": 83866752, "body": "Since you are a paid customer, can you check if your request hits the TwiML server?"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "is_accepted": true, "score": 1, "last_activity_date": 1516907484, "creation_date": 1516907484, "answer_id": 48450256, "question_id": 48431360, "link": "https://stackoverflow.com/questions/48431360/twiml-exporting-to-sinatra-but-not-actually-sending-sms-messages/48450256#48450256", "title": "TwiML Exporting to Sinatra, but not actually sending SMS Messages", "body": "<p>I think I got it. Swapped out puts for .to_s Documentation Example here: <a href=\"https://www.twilio.com/docs/guides/how-to-receive-and-reply\" rel=\"nofollow noreferrer\">Receive &amp; Reply to SMS &amp; MMS</a></p>\n\n<pre><code>post '/message' do\n  from = params['From']\n  body = params['Body']\n  media_url = params['MediaUrl0']\n\n  if from == MY_NUMBER\n    twiml = send_to_contacts(body, media_url)\n  else\n    twiml = send_to_me(from, body, media_url)\n  end\n\n  content_type 'text/xml'\n  twiml.to_s\nend\n\ndef send_to_contacts(body, media_url = nil)\n  response = Twilio::TwiML::MessagingResponse.new do |r|\n    contacts_numbers.each do |num|\n      r.message to: num do |msg|\n        msg.body body\n        msg.media media_url unless media_url.nil?\n      end\n    end\n  end\n  response.to_s\nend\n\ndef send_to_me(from, body, media_url = nil)\n  name = contact_name(from)\n  body = \"#{name} (#{from}):\\n#{body}\"\n  response = Twilio::TwiML::MessagingResponse.new do |r|\n    r.message to: MY_NUMBER do |msg|\n      msg.body body\n      msg.media media_url unless media_url.nil?\n    end\n  end\n  response.to_s\nend\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 48450256, "answer_count": 1, "score": 0, "last_activity_date": 1516907484, "creation_date": 1516826973, "question_id": 48431360, "link": "https://stackoverflow.com/questions/48431360/twiml-exporting-to-sinatra-but-not-actually-sending-sms-messages", "title": "TwiML Exporting to Sinatra, but not actually sending SMS Messages", "body": "<p>I am having an issue with outbound SMS thru TwiML Message functions. I am able to see my post on my Sinatra server session here:</p>\n\n<pre><code>== Sinatra (v2.0.0) has taken the stage on 4567 for development with backup from WEBrick\n[2018-01-24 15:30:55] INFO  WEBrick::HTTPServer#start: pid=67403 port=4567\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;Response&gt;&lt;Message to=\"+1904XXXXXXX\"&gt;&lt;Body&gt;Text Message Test for Devotional App. Please reply.&lt;/Body&gt;&lt;/Message&gt;&lt;Message to=\"+1786XXXXXXX\"&gt;&lt;Body&gt;Text Message Test for Devotional App. Please reply.&lt;/Body&gt;&lt;/Message&gt;&lt;Message to=\"+1904XXXXXXX\"&gt;&lt;Body&gt;Text Message Test for Devotional App. Please reply.&lt;/Body&gt;&lt;/Message&gt;&lt;/Response&gt;\n\n50.235.219.155 - - [24/Jan/2018:15:31:16 -0500] \"POST /message HTTP/1.1\" 200 - 0.0022\n::1 - - [24/Jan/2018:15:31:16 EST] \"POST /message HTTP/1.1\" 200 0\n- -&gt; /message\n</code></pre>\n\n<p>I see the <a href=\"https://i.stack.imgur.com/47Kg8.png\" rel=\"nofollow noreferrer\">inbound logs here</a>, but nothing outbound. I have even elevated this to a paid account to make sure it wasn't a trail thing.</p>\n\n<p>This code is based on this <a href=\"https://www.twilio.com/blog/2014/10/broadcast-text-and-picture-messages-using-ruby-google-spreadsheets-twilio.html\" rel=\"nofollow noreferrer\">walkthru</a>.</p>\n\n<p>My full ruby code for the app is here:</p>\n\n<pre><code>require 'yaml'\nrequire 'open-uri'\nrequire 'sinatra'\nrequire 'twilio-ruby'\n\nMY_NUMBER = '+1904XXXXXXXX'\n\ndef spreadsheet_url\n  'contacts.yml'\nend\n\ndef sanitize(number)\n  \"+1\" + number.gsub(/^1|\\D/, \"\")\nend\n\ndef data_from_spreadsheet\n  file = open(spreadsheet_url).read\n  YAML.load(file)\nend\n\ndef contacts_from_spreadsheet\n  contacts = {}\n  data_from_spreadsheet.each do |entry|\n    name = entry['name']\n    number = entry['phone_number'].to_s\n    contacts[sanitize(number)] = name\n  end\n  contacts\nend\n\ndef contacts_numbers\n  contacts_from_spreadsheet.keys\nend\n\ndef contact_name(number)\n  contacts_from_spreadsheet[number]\nend\n\nget '/' do\n  \"Devotional Broadcast is Up &amp; Running!\"\nend\n\nget '/message' do\n  \"Things are Working!\"\nend\n\npost '/message' do\n  from = params['From']\n  body = params['Body']\n  media_url = params['MediaUrl0']\n\n  if from == MY_NUMBER\n    twiml = send_to_contacts(body, media_url)\n  else\n    twiml = send_to_me(from, body, media_url)\n  end\n\n  content_type 'text/xml'\n  puts twiml\nend\n\ndef send_to_contacts(body, media_url = nil)\n  response = Twilio::TwiML::MessagingResponse.new do |r|\n    contacts_numbers.each do |num|\n      r.message to: num do |msg|\n        msg.body body\n        msg.media media_url unless media_url.nil?\n      end\n    end\n  end\n  puts response\nend\n\ndef send_to_me(from, body, media_url = nil)\n  name = contact_name(from)\n  body = \"#{name} (#{from}):\\n#{body}\"\n  response = Twilio::TwiML::MessagingResponse.new do |r|\n    r.message to: MY_NUMBER do |msg|\n      msg.body body\n      msg.media media_url unless media_url.nil?\n    end\n  end\n  puts response\nend\n</code></pre>\n\n<p>Any help or insight would be great! Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "pagination", "will-paginate"], "comments": [{"owner": {"reputation": 652, "user_id": 1446728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tuCZn.jpg?s=128&g=1", "display_name": "Femi Oni", "link": "https://stackoverflow.com/users/1446728/femi-oni"}, "edited": false, "score": 0, "creation_date": 1516827322, "post_id": 48431347, "comment_id": 83853885, "body": "This is nothing to do with react; just do it as you&#39;d with any js code. also for rest APIs why are your putting so much relevant data in headers instead of the response JSON??"}], "answers": [{"comments": [{"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1516827603, "post_id": 48431485, "comment_id": 83854050, "body": "Ya that&#39;s how I&#39;m accessing the data in React. I tried that and they&#39;re just an empty object."}, {"owner": {"reputation": 282, "user_id": 9209617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W7QGHJPml8k/AAAAAAAAAAI/AAAAAAAAM90/dTxZp6M2ajE/photo.jpg?sz=128", "display_name": "Shirley", "link": "https://stackoverflow.com/users/9209617/shirley"}, "reply_to_user": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1516827694, "post_id": 48431485, "comment_id": 83854092, "body": "You&#39;re getting the correct body back though? Is accessing the links through headers really necessary? I&#39;m assuming you could just hit <code>&#47;movies?page2</code> directly if you&#39;re on page1."}, {"owner": {"reputation": 282, "user_id": 9209617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W7QGHJPml8k/AAAAAAAAAAI/AAAAAAAAM90/dTxZp6M2ajE/photo.jpg?sz=128", "display_name": "Shirley", "link": "https://stackoverflow.com/users/9209617/shirley"}, "reply_to_user": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 1, "creation_date": 1516827737, "post_id": 48431485, "comment_id": 83854110, "body": "Also, if you open inspector tools and look at the response in the network tab, you should see that response. Does it have the headers there?"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1516827826, "post_id": 48431485, "comment_id": 83854153, "body": "Ya I&#39;m able to get the data for the first page. Oh sweet they&#39;re there. How would one access those tho?"}, {"owner": {"reputation": 282, "user_id": 9209617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W7QGHJPml8k/AAAAAAAAAAI/AAAAAAAAM90/dTxZp6M2ajE/photo.jpg?sz=128", "display_name": "Shirley", "link": "https://stackoverflow.com/users/9209617/shirley"}, "reply_to_user": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1516828204, "post_id": 48431485, "comment_id": 83854356, "body": "Hm, I found <a href=\"https://stackoverflow.com/questions/38953864/how-to-get-headers-of-the-response-from-fetch\">this</a>. It may have something to do with the CORS from the Rails back end."}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1516828998, "post_id": 48431485, "comment_id": 83854721, "body": "Ya I found that too. :(  I put <code>expose: [&#39;Link&#39;]</code> in the cors.rb and <code>&#39;Access-Control-Expose-Headers&#39;: [&#39;Link&#39;],</code> in my application.rb"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "reply_to_user": {"reputation": 282, "user_id": 9209617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W7QGHJPml8k/AAAAAAAAAAI/AAAAAAAAM90/dTxZp6M2ajE/photo.jpg?sz=128", "display_name": "Shirley", "link": "https://stackoverflow.com/users/9209617/shirley"}, "edited": false, "score": 0, "creation_date": 1516829232, "post_id": 48431485, "comment_id": 83854851, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/163830/discussion-between-mike-heft-and-shirley\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 282, "user_id": 9209617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W7QGHJPml8k/AAAAAAAAAAI/AAAAAAAAM90/dTxZp6M2ajE/photo.jpg?sz=128", "display_name": "Shirley", "link": "https://stackoverflow.com/users/9209617/shirley"}, "is_accepted": false, "score": 3, "last_activity_date": 1516827546, "creation_date": 1516827546, "answer_id": 48431485, "question_id": 48431347, "link": "https://stackoverflow.com/questions/48431347/how-to-access-response-headers-in-react-from-rails-api-pagination-gem/48431485#48431485", "title": "how to access response headers in React from Rails api-pagination gem", "body": "<p>Are you accessing this data in React through a fetch request? Something like </p>\n\n<pre><code>fetch('url').then(res =&gt; {res.json()})\n</code></pre>\n\n<p>You should be able to access headers with <code>fetch('url').then(res =&gt; res.headers)</code>. You can then manipulate them or save them to state or whatever you want to do with them. Fetch API docs <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Response/headers\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "is_accepted": true, "score": 0, "last_activity_date": 1516831410, "creation_date": 1516831410, "answer_id": 48432428, "question_id": 48431347, "link": "https://stackoverflow.com/questions/48431347/how-to-access-response-headers-in-react-from-rails-api-pagination-gem/48432428#48432428", "title": "how to access response headers in React from Rails api-pagination gem", "body": "<p><code>response.headers.get('Link')</code> solved it!</p>\n"}, {"tags": [], "owner": {"reputation": 867, "user_id": 1471694, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/6b42ea2c253dfb6e1875edc2862f54f1?s=128&d=identicon&r=PG", "display_name": "Shakil", "link": "https://stackoverflow.com/users/1471694/shakil"}, "is_accepted": false, "score": 0, "last_activity_date": 1534388403, "creation_date": 1534388403, "answer_id": 51869024, "question_id": 48431347, "link": "https://stackoverflow.com/questions/48431347/how-to-access-response-headers-in-react-from-rails-api-pagination-gem/51869024#51869024", "title": "how to access response headers in React from Rails api-pagination gem", "body": "<p>This is a <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\" rel=\"nofollow noreferrer\">CORS</a> restriction.</p>\n\n<p>White list headers (by implementing <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Access-Control-Expose-Headers\" rel=\"nofollow noreferrer\">Access-Control-Expose-Headers</a> in the server) that you are using for pagination.</p>\n\n<p>Only then you can access any header on a CORS request.</p>\n\n<p>Please also note that, this restriction does not apply on requests from the same origin.</p>\n"}, {"comments": [{"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1613415558, "post_id": 66213503, "comment_id": 117063234, "body": "Nice. I&#39;ll give that a try next time. But this problem was with my understanding of how to use React with this gem <a href=\"https://github.com/davidcelis/api-pagination\" rel=\"nofollow noreferrer\">github.com/davidcelis/api-pagination</a>"}], "tags": [], "owner": {"reputation": 21, "user_id": 9582575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j-qZkkhe8eY/AAAAAAAAAAI/AAAAAAAALAE/RI1GJ61VoHw/photo.jpg?sz=128", "display_name": "Alagie F. Nget", "link": "https://stackoverflow.com/users/9582575/alagie-f-nget"}, "is_accepted": false, "score": 0, "last_activity_date": 1613413950, "creation_date": 1613413950, "answer_id": 66213503, "question_id": 48431347, "link": "https://stackoverflow.com/questions/48431347/how-to-access-response-headers-in-react-from-rails-api-pagination-gem/66213503#66213503", "title": "how to access response headers in React from Rails api-pagination gem", "body": "<p>What I did with in a similar situation was to add the following in my rails controller:</p>\n<p>response.header['my_attribute_name'] = my_value\nheaders['Access-Control-Expose-Headers'] = 'my_attribute_name'</p>\n<p>Then on the front-end I just used:</p>\n<p>response.headers.get(&quot;my_attribute_name&quot;)</p>\n<p>This solved my issue.</p>\n"}], "owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1007, "favorite_count": 1, "accepted_answer_id": 48432428, "answer_count": 4, "score": 1, "last_activity_date": 1613413950, "creation_date": 1516826923, "question_id": 48431347, "link": "https://stackoverflow.com/questions/48431347/how-to-access-response-headers-in-react-from-rails-api-pagination-gem", "title": "how to access response headers in React from Rails api-pagination gem", "body": "<p>So I got this gem to work in limiting the amounts returned in the JSON response. However I'm not sure how to access the links in the headers that let you get to the next and previous pages.\nHere is my controller:</p>\n\n<pre><code>def index\n    movies = Movie.all\n    paginate json: movies, per_page: 50\nend\n</code></pre>\n\n<p>This is the part of the readme for the gem that says you can access next and prev through the headers:</p>\n\n<pre><code>$ curl --include 'https://localhost:3000/movies?page=5'\nHTTP/1.1 200 OK\nLink: &lt;http://localhost:3000/movies?page=1&gt;; rel=\"first\",\n  &lt;http://localhost:3000/movies?page=173&gt;; rel=\"last\",\n  &lt;http://localhost:3000/movies?page=6&gt;; rel=\"next\",\n  &lt;http://localhost:3000/movies?page=4&gt;; rel=\"prev\"\nTotal: 4321\nPer-Page: 10\n# ...\n</code></pre>\n\n<p>I can see them in Postman, but have yet to find a way to access them in my React front end. Thank you for any help you're able to offer.\nThis is the url for the gem: <a href=\"https://github.com/davidcelis/api-pagination\" rel=\"nofollow noreferrer\">api-pagination gem</a></p>\n"}, {"tags": ["ruby", "variables", "methods"], "comments": [{"owner": {"reputation": 13, "user_id": 9259985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a41fabfcc74bf0fa873b618143c4ddbd?s=128&d=identicon&r=PG&f=1", "display_name": "user9259985", "link": "https://stackoverflow.com/users/9259985/user9259985"}, "edited": false, "score": 0, "creation_date": 1516826223, "post_id": 48431164, "comment_id": 83853329, "body": "new to this site too, and I have no idea why my loop code is all smushed together. It really doesn&#39;t matter anyway I guess."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516826458, "post_id": 48431164, "comment_id": 83853476, "body": "You need to indent with four spaces to get it to format properly, or highlight it and push the <code>{}</code> button to do that for you."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516901315, "post_id": 48431164, "comment_id": 83889885, "body": "People can be harsh judges here, but I wouldn&#39;t worry too much about it. In the long run it all works out."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9259985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a41fabfcc74bf0fa873b618143c4ddbd?s=128&d=identicon&r=PG&f=1", "display_name": "user9259985", "link": "https://stackoverflow.com/users/9259985/user9259985"}, "edited": false, "score": 0, "creation_date": 1516828395, "post_id": 48431279, "comment_id": 83854432, "body": "Hey, thanks for taking the time and all the extra info. I&#39;ll definitely look into it. The code works now and prints out the converted temp, but I&#39;m still not sure how to put the answer into a variable to be recalled later on in the program...  After the code is run, I&#39;d like to print out something like:  puts &quot;the converted variable is &quot; + def_result_variable      or something like that..."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 13, "user_id": 9259985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a41fabfcc74bf0fa873b618143c4ddbd?s=128&d=identicon&r=PG&f=1", "display_name": "user9259985", "link": "https://stackoverflow.com/users/9259985/user9259985"}, "edited": false, "score": 0, "creation_date": 1516901366, "post_id": 48431279, "comment_id": 83889924, "body": "The <a href=\"http://ruby-doc.com/docs/ProgrammingRuby/\" rel=\"nofollow noreferrer\">Programming Ruby</a> book is available online and is a great resource for getting started in Ruby. If you like that version there&#39;s a more up-to-date one available from the publisher that&#39;s worth buying."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 0, "last_activity_date": 1516826651, "creation_date": 1516826651, "answer_id": 48431279, "question_id": 48431164, "link": "https://stackoverflow.com/questions/48431164/assigning-a-method-result-to-a-variable-in-ruby/48431279#48431279", "title": "assigning a method result to a variable in ruby", "body": "<p>Remember that calls like <code>ctof temp</code> just initiate a method and then, as you're not putting the result anywhere, discard it immediately.</p>\n\n<p>To clean up this code let's organize it better:</p>\n\n<pre><code># Temperature conversion method\ndef ftoc(fahrenheit)\n  (fahrenheit.to_f - 32.0) * (5.0 / 9.0)\nend\n\n# User input method\ndef temperature_prompt!\n  puts \"Enter F for Fahrenheit and C for Celsius.\"\n  x = gets.chomp.downcase\n\n  case (x)\n  when \"f\"\n    puts \"Enter your temp:\"\n    temp = gets.chomp.to_i\n    ftoc temp\n  when \"c\"\n    puts \"Enter your temp:\"\n    temp = gets.chomp.to_i\n    ctof temp\n  else\n    puts \"That does not compute.\"\n  end\nend\n</code></pre>\n\n<p>Now you can make use of the fact that in Ruby things like <code>if</code> and <code>case</code> actually return values. In this case it's the value of the last thing to execute in each block, so that result isn't discarded, it's just passed along:</p>\n\n<pre><code>temp = temperature_prompt!\n</code></pre>\n\n<p>If you enter an invalid value you get the result of <code>puts</code> which is conveniently <code>nil</code>.</p>\n\n<p>Here's something to consider: Ruby is very good at parsing arbitrary text if you can describe the patterns. Here's a simple input routine:</p>\n\n<pre><code>def temperature_prompt!\n  puts \"Enter degrees (e.g. 8F, 2C)\"\n\n  case (input = gets.chomp.downcase)\n  when /(\\d+)f/\n    ftoc $1\n  when /(\\d+)c/\n    ctof $1\n  else\n    puts \"That does not compute.\"\n  end\nend\n</code></pre>\n\n<p>You could add to those patterns to allow things like <code>-2C</code> and <code>3.4\u00b0F</code> if you wanted.</p>\n"}], "owner": {"reputation": 13, "user_id": 9259985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a41fabfcc74bf0fa873b618143c4ddbd?s=128&d=identicon&r=PG&f=1", "display_name": "user9259985", "link": "https://stackoverflow.com/users/9259985/user9259985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 48431279, "answer_count": 1, "score": 0, "last_activity_date": 1516826657, "creation_date": 1516826135, "last_edit_date": 1516826469, "question_id": 48431164, "link": "https://stackoverflow.com/questions/48431164/assigning-a-method-result-to-a-variable-in-ruby", "title": "assigning a method result to a variable in ruby", "body": "<p>I'm sure it would be hard to find an easier question, but I'm a complete newbie. I have searched extensively and for some reason can't find the answer to this. Here's my code:</p>\n\n<pre><code>puts \"Enter F for Fahrenheit and C for Celsius.\"\n\nx = gets.chomp.downcase\n\ndef ftoc(fahrenheit)\n  (fahrenheit.to_f - 32.0) * (5.0 / 9.0)\nend\n\nif x == \"f\"\n  puts \"Enter your temp:\"\n  temp = gets.chomp.to_i\n  ftoc temp\nelsif x == \"c\"\n  puts \"Enter your temp:\"\n  temp = gets.chomp.to_i\n  ctof temp\nelse\n  puts \"That does not compute.\"\nend\n</code></pre>\n\n<p>I'm just trying to get the returned result of the method into a variable so I can use it elsewhere....</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516823385, "post_id": 48430449, "comment_id": 83851819, "body": "could you share your form code? i mean new.html.erb"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516823565, "post_id": 48430449, "comment_id": 83851926, "body": "paste code of <code>form</code> partial in your question"}, {"owner": {"reputation": 31, "user_id": 6557015, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a7e9f4616456a5095bbebca95fed3cf4?s=128&d=identicon&r=PG", "display_name": "Tysaic", "link": "https://stackoverflow.com/users/6557015/tysaic"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516823639, "post_id": 48430449, "comment_id": 83851983, "body": "@Gabbar The code is ready now."}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1516826467, "post_id": 48430449, "comment_id": 83853480, "body": "what does permission.rb look like? you probably need to change the <code>groups</code> to <code>group_id</code> or similar, or an <code>accepts_nested_attributes_for :groups</code>, but those are both just guesses without seeing permission.rb"}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516826571, "post_id": 48430449, "comment_id": 83853531, "body": "Please share code of your models or at least association declarations. Also, as @Gabbar pointed out, the actual form would be helpful. Association may be missing or broken in models, but from params I can see that the form needs fixes. In params, it passes [&quot;2&quot;] to &quot;groups&quot;- the array that contains ids that should go to &quot;group_ids&quot; attribute instead. Same with &quot;activities&quot;."}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "edited": false, "score": 0, "creation_date": 1516830451, "post_id": 48430449, "comment_id": 83855464, "body": "You pasted Activity twice and forgot Permission."}], "answers": [{"tags": [], "owner": {"reputation": 4543, "user_id": 3213605, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/a2HS8.jpg?s=128&g=1", "display_name": "PhilVarg", "link": "https://stackoverflow.com/users/3213605/philvarg"}, "is_accepted": false, "score": 0, "last_activity_date": 1516832162, "creation_date": 1516832162, "answer_id": 48432600, "question_id": 48430449, "link": "https://stackoverflow.com/questions/48430449/how-to-fix-the-creates-action-in-a-many-to-many-relationships-in-crud-rails/48432600#48432600", "title": "How to fix the create&#39;s action in a many to many relationships in CRUD Rails?", "body": "<p>The problem is your association between Permission and Group.</p>\n\n<p>Permission belongs_to Group, meaning there is a single group for each permission. But you've built it to expect multiple groups for each permission. The error is telling you there is no method <code>groups</code> on an instance of permission because there isnt; there is a <code>group</code> method</p>\n\n<p>in your show route, you're doing things correctly by calling <code>&lt;%= @permission.group.name %&gt;</code>, but in your edit route you call <code>@permission.groups</code> and your create route is failing because the strong params you've set up are expecting many group ids to come in <code>permit(groups: [])</code></p>\n\n<p>this line is breaking</p>\n\n<pre><code># def edit\n@groups_the_permissions_is_created = @permission.groups.pluck(:id)\n</code></pre>\n\n<p>and should be something like</p>\n\n<pre><code># def edit\n@groups_the_permissions_is_created = @permission.group.id\n</code></pre>\n\n<p>your strong params are breaking because you're permitting <code>group: []</code> but should be permitting a single <code>:group_id</code></p>\n"}], "owner": {"reputation": 31, "user_id": 6557015, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a7e9f4616456a5095bbebca95fed3cf4?s=128&d=identicon&r=PG", "display_name": "Tysaic", "link": "https://stackoverflow.com/users/6557015/tysaic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1516832162, "creation_date": 1516822968, "last_edit_date": 1516831065, "question_id": 48430449, "link": "https://stackoverflow.com/questions/48430449/how-to-fix-the-creates-action-in-a-many-to-many-relationships-in-crud-rails", "title": "How to fix the create&#39;s action in a many to many relationships in CRUD Rails?", "body": "<p>good afternoon dead stackoverflow's friends.</p>\n\n<p>My problem is when i want to created a many to many relationship in a scaffold with references inside in, the tables called activities and groups and the references table is permissions my error is in the actions create and edit.</p>\n\n<p>The error says : </p>\n\n<blockquote>\n  <p>unknown attribute 'groups' for Permission.</p>\n</blockquote>\n\n<pre><code>  # POST /permissions.json\n  def create\n    @permission = Permission.create(permission_params)\n</code></pre>\n\n<p>the hash is this : </p>\n\n<pre><code>{\"utf8\"=&gt;\"\u2713\",\n \"authenticity_token\"=&gt;\"e9KAgCvqlXJxfsHIUOhapwg7XTJM6x+uEyd229kO+GG6bHJ/iMjywC07u3fwMyzqMSYpm9zSTrbXASSI5TpFzg==\",\n \"permission\"=&gt;{\"groups\"=&gt;[\"2\"], \"activities\"=&gt;[\"1\"], \"c\"=&gt;\"0\", \"r\"=&gt;\"0\", \"u\"=&gt;\"1\", \"d\"=&gt;\"0\"},\n \"commit\"=&gt;\"Crear Permisos\"}\n</code></pre>\n\n<p>controller</p>\n\n<pre><code>class PermissionsController &lt; ApplicationController\n  before_action :set_permission, only: [:show, :edit, :update, :destroy]\n\n  # GET /permissions\n  # GET /permissions.json\n  def index\n    @permissions = Permission.all\n    @activity = Activity.all\n    @group = Group.all\n  end\n\n  # GET /permissions/1\n  # GET /permissions/1.json\n  def show\n    @activity = Activity.all\n    @group = Group.all\n  end\n\n  # GET /permissions/new\n  def new\n    @permission = Permission.new\n  end\n\n  # GET /permissions/1/edit\n  def edit\n    @permission = Permission.find_by(id: params[:id])\n    @all_groups = Group.all\n    @groups_the_permissions_is_created = @permission.groups.pluck(:id)\n    @activities_the_permissions_is_created = @permission.activities.pluck(:id)\n  end\n\n  # POST /permissions\n  # POST /permissions.json\n  def create\n    @permission = Permission.create(permission_params)\n\n\n    respond_to do |format|\n      if @permission.save\n        format.html { redirect_to @permission, notice: 'Permission was successfully created.' }\n        format.json { render :show, status: :created, location: @permission }\n      else\n        format.html { render :new }\n        format.json { render json: @permission.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /permissions/1\n  # PATCH/PUT /permissions/1.json\n  def update\n    respond_to do |format|\n      if @permission.update(permission_params)\n        format.html { redirect_to @permission, notice: 'Permission was successfully updated.' }\n        format.json { render :show, status: :ok, location: @permission }\n      else\n        format.html { render :edit }\n        format.json { render json: @permission.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /permissions/1\n  # DELETE /permissions/1.json\n  def destroy\n    @permission.destroy\n    respond_to do |format|\n      format.html { redirect_to permissions_url, notice: 'Permission was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_permission\n      @permission = Permission.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def permission_params\n      params.require(:permission).permit( :c, :r, :u, :d, :groups =&gt; [], :activities =&gt; [])\n    end\n\nend\n</code></pre>\n\n<p>schema</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 20180122191652) do\n\n  create_table \"activities\", force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"groups\", force: :cascade do |t|\n    t.string \"name\"\n    t.text \"description\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"memberships\", force: :cascade do |t|\n    t.integer \"user_id\"\n    t.integer \"group_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"group_id\"], name: \"index_memberships_on_group_id\"\n    t.index [\"user_id\"], name: \"index_memberships_on_user_id\"\n  end\n\n  create_table \"permissions\", force: :cascade do |t|\n    t.integer \"activity_id\"\n    t.integer \"group_id\"\n    t.boolean \"c\"\n    t.boolean \"r\"\n    t.boolean \"u\"\n    t.boolean \"d\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"activity_id\"], name: \"index_permissions_on_activity_id\"\n    t.index [\"group_id\"], name: \"index_permissions_on_group_id\"\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.string \"email\", default: \"\", null: false\n    t.string \"encrypted_password\", default: \"\", null: false\n    t.string \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.integer \"sign_in_count\", default: 0, null: false\n    t.datetime \"current_sign_in_at\"\n    t.datetime \"last_sign_in_at\"\n    t.string \"current_sign_in_ip\"\n    t.string \"last_sign_in_ip\"\n    t.string \"confirmation_token\"\n    t.datetime \"confirmed_at\"\n    t.datetime \"confirmation_sent_at\"\n    t.string \"unconfirmed_email\"\n    t.integer \"failed_attempts\", default: 0, null: false\n    t.string \"unlock_token\"\n    t.datetime \"locked_at\"\n    t.string \"name\", default: \"\", null: false\n    t.string \"work\", default: \"\", null: false\n    t.string \"bank\"\n    t.string \"type_of_bank_account\"\n    t.integer \"bank_account_number\", limit: 20\n    t.string \"email_paypal\"\n    t.integer \"identification_card\", limit: 8\n    t.integer \"phone_number\", limit: 20\n    t.integer \"house_number\", limit: 20\n    t.string \"skype\"\n    t.text \"abilities\"\n    t.text \"languages\"\n    t.string \"invitation_token\"\n    t.datetime \"invitation_created_at\"\n    t.datetime \"invitation_sent_at\"\n    t.datetime \"invitation_accepted_at\"\n    t.integer \"invitation_limit\"\n    t.integer \"invited_by_id\"\n    t.string \"invited_by_type\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"confirmation_token\"], name: \"index_users_on_confirmation_token\", unique: true\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n    t.index [\"invitation_token\"], name: \"index_users_on_invitation_token\", unique: true\n    t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n    t.index [\"unlock_token\"], name: \"index_users_on_unlock_token\", unique: true\n  end\n\nend\n</code></pre>\n\n<p>new.html.erb</p>\n\n<pre><code>&lt;h1 align=\"center\"&gt;Creaci\u00f3n de permisos&lt;/h1&gt;\n&lt;div class=\"col s12 m12 l12\"&gt;\n    &lt;div class=\"card\"&gt;\n        &lt;div class=\"card-content hoverable\"&gt;\n            &lt;%= render 'form', permission: @permission %&gt;\n            &lt;%= link_to 'Back', permissions_path , :class =&gt; 'waves-effect waves-light btn permissions-submit'%&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>show.html.erb</p>\n\n<pre><code>    &lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;strong&gt;Activity:&lt;/strong&gt;\n      &lt;%= @permission.activity.name %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;strong&gt;Group:&lt;/strong&gt;\n      &lt;%= @permission.group.name %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;strong&gt;C:&lt;/strong&gt;\n      &lt;%= @permission.c %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;strong&gt;R:&lt;/strong&gt;\n      &lt;%= @permission.r %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;strong&gt;U:&lt;/strong&gt;\n      &lt;%= @permission.u %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;strong&gt;D:&lt;/strong&gt;\n      &lt;%= @permission.d %&gt;\n    &lt;/p&gt;\n\n    &lt;%= link_to 'Edit', edit_permission_path(@permission) %&gt; |\n    &lt;%= link_to 'Back', permissions_path %&gt;\n\n_form.html.erb\n\n&lt;%= form_with(model: permission, local: true) do |form| %&gt;\n&lt;% if permission.errors.any? %&gt;\n&lt;div id=\"error_explanation\"&gt;\n  &lt;h2&gt;&lt;%= pluralize(permission.errors.count, \"error\") %&gt; prohibited this permission from being saved:&lt;/h2&gt;\n  &lt;ul&gt;\n    &lt;% permission.errors.full_messages.each do |message| %&gt;\n    &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n    &lt;% end %&gt;\n  &lt;/ul&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n&lt;span class=\"card-title\"&gt;&lt;i class=\"material-icons left\"&gt;assignment_ind&lt;/i&gt; Creaci\u00f3n de permisos&lt;/span&gt;\n&lt;%= form.label :Grupos %&gt;\n&lt;div class=\"field\"&gt;\n  &lt;p&gt;\n    &lt;%= form.collection_check_boxes :groups, Group.order(:name), :id, :name, :include_hidden =&gt; false%&gt;\n  &lt;/p&gt;\n&lt;/div&gt;\n&lt;%= form.label :Procesos%&gt;\n&lt;div class=\"field\"&gt;\n  &lt;%= form.collection_check_boxes :activities, Activity.order(:name), :id, :name, :include_hidden =&gt; false%&gt;\n&lt;/div&gt;\n&lt;div class=\"field\"&gt;\n  &lt;%= form.label :Permisos%&gt;\n&lt;/div&gt;\n&lt;div class=\"field\"&gt;\n  &lt;%= form.check_box :c, id: :permission_c%&gt;\n  &lt;%= form.label :c, :class =&gt; 'example-class' %&gt;\n  &lt;%= form.check_box :r, id: :permission_r %&gt;\n  &lt;%= form.label :r %&gt;\n  &lt;%= form.check_box :u, id: :permission_u %&gt;\n  &lt;%= form.label :u %&gt;\n  &lt;%= form.check_box :d, id: :permission_d %&gt;\n  &lt;%= form.label :d %&gt;\n&lt;/div&gt;\n&lt;div class=\"actions\"&gt;\n  &lt;%= form.submit 'Crear Permisos' , :class =&gt; 'waves-effect waves-light btn permissions-submit'%&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Assosiations:</p>\n\n<pre><code>class Activity &lt; ApplicationRecord\n    has_many :permissions\n    has_many :groups, through: :permissions\nend\n\nclass Group &lt; ApplicationRecord\n    has_many :memberships\n    has_many :users, through: :memberships \n    has_many :permissions\n    has_many :activities, through: :permissions\n    has_many :users, through: :memberships\n    validates :name, presence: true, uniqueness: true\nend\n\n\n\nclass Permission &lt; ApplicationRecord\n  belongs_to :activity\n  belongs_to :group\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "methods"], "comments": [{"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1516823699, "post_id": 48430086, "comment_id": 83852011, "body": "I don&#39;t think that <code>User.all.group_by(username: &#39;username&#39;)</code> does work? <code>group_by</code> is a method from <code>Enumerable</code> but it doesn&#39;t take any parameters, but can be called with a block e.g. <code>User.all.group_by { |u| u.username }</code>. It can be called as <code>User.all.group_by { ...</code> because the relation returned by <code>all</code> is implicitly converted into an array."}, {"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "reply_to_user": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1516823788, "post_id": 48430086, "comment_id": 83852060, "body": "@mikej It does work. How am I able to call it from the <code>testing</code> method?"}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1516823829, "post_id": 48430086, "comment_id": 83852094, "body": "Sounds like maybe you have some gem that&#39;s adding extra functionality on your project?"}, {"owner": {"reputation": 1761, "user_id": 3741320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10222536/picture?type=large", "display_name": "James Milani", "link": "https://stackoverflow.com/users/3741320/james-milani"}, "edited": false, "score": 0, "creation_date": 1516823984, "post_id": 48430086, "comment_id": 83852176, "body": "You&#39;ve defined your method as a Class method by defining it as <code>def self.testing</code>. Thus, when you call <code>self</code> inside of the method, it&#39;s referring to the <code>User</code> class itself, not an <code>instance</code> of the <code>User</code> class."}, {"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "reply_to_user": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1516824712, "post_id": 48430086, "comment_id": 83852558, "body": "@mikej No, try this in your Rails console. I guarantee that it waorks."}, {"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "reply_to_user": {"reputation": 1761, "user_id": 3741320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10222536/picture?type=large", "display_name": "James Milani", "link": "https://stackoverflow.com/users/3741320/james-milani"}, "edited": false, "score": 0, "creation_date": 1516824750, "post_id": 48430086, "comment_id": 83852575, "body": "@JamesMilani Yes, that&#39;s exactly my problem. How do I fix it?"}, {"owner": {"reputation": 1761, "user_id": 3741320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10222536/picture?type=large", "display_name": "James Milani", "link": "https://stackoverflow.com/users/3741320/james-milani"}, "edited": false, "score": 0, "creation_date": 1516824918, "post_id": 48430086, "comment_id": 83852654, "body": "If you are open to changing the method and how you call it, then you could write <code>def self.testing</code> as <code>v = self.all</code> and call it not as <code>User.all.testing</code>, but as <code>User.testing</code>. I imagine that would work..."}, {"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "reply_to_user": {"reputation": 1761, "user_id": 3741320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10222536/picture?type=large", "display_name": "James Milani", "link": "https://stackoverflow.com/users/3741320/james-milani"}, "edited": false, "score": 0, "creation_date": 1516825015, "post_id": 48430086, "comment_id": 83852702, "body": "@JamesMilani That would work, but would change the functionality of the method. Is there no way to make the current method work?"}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1516825231, "post_id": 48430086, "comment_id": 83852817, "body": "@jonhue I have been testing this from the console on a Rails 5.1.3 and there&#39;s no <code>group_by</code> method for me that takes parameters in the way you&#39;ve used it. That said assuming that method <i>does</i> work for you I&#39;ve written an answer explaining how to achieve what you&#39;re after."}, {"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "reply_to_user": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 1, "creation_date": 1516825899, "post_id": 48430086, "comment_id": 83853164, "body": "@mikej I&#39;m sorry, I had a mistake replicating the method here on StackOverflow. It obviously has to be <code>group_by { |user| user.username = &#39;username&#39; }</code>"}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 1, "creation_date": 1516825949, "post_id": 48430086, "comment_id": 83853185, "body": "All cool! mystery solved :D"}], "answers": [{"comments": [{"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "edited": false, "score": 0, "creation_date": 1516822907, "post_id": 48430321, "comment_id": 83851510, "body": "No, I actually mean <code>group_by</code>. I want to do the same as <code>User.all.group_by(username: &#39;username&#39;)</code>, but using the <code>testing</code> method. If <code>self</code> isn&#39;t the way to go, what is?"}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "reply_to_user": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "edited": false, "score": 0, "creation_date": 1516835240, "post_id": 48430321, "comment_id": 83857661, "body": "<code>self.all.group_by</code> assuming <code>self.class</code> is <code>User</code>"}], "tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": false, "score": 0, "last_activity_date": 1516822510, "creation_date": 1516822510, "answer_id": 48430321, "question_id": 48430086, "link": "https://stackoverflow.com/questions/48430086/ruby-get-result-of-previous-method-in-current-method/48430321#48430321", "title": "Ruby: Get result of previous method in current method", "body": "<p><code>self</code> is a kind of <code>ActiveRecord::Base</code> object, and thus doesn't have a <code>group_by</code> method. <code>group_by</code> is an Enumerable method. Perhaps you mean <code>group</code>, which is implemented in <code>ActiveRecord::QueryMethods</code>?</p>\n"}, {"comments": [{"owner": {"reputation": 1761, "user_id": 3741320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10222536/picture?type=large", "display_name": "James Milani", "link": "https://stackoverflow.com/users/3741320/james-milani"}, "edited": false, "score": 0, "creation_date": 1516823900, "post_id": 48430649, "comment_id": 83852131, "body": "Why down voting? This answer has merit."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 1, "creation_date": 1516824067, "post_id": 48430649, "comment_id": 83852210, "body": "Class methods <i>can</i> be used for scopes so <code>User.all.testing</code> would be valid: <a href=\"http://blog.plataformatec.com.br/2013/02/active-record-scopes-vs-class-methods/\" rel=\"nofollow noreferrer\">blog.plataformatec.com.br/2013/02/&hellip;</a>"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 3, "creation_date": 1516824302, "post_id": 48430649, "comment_id": 83852351, "body": "<code>scope</code> is just a fancy way of building a class method with a little extra stuff and [&quot;Using a class method is the preferred way to accept arguments for scopes.&quot;(<a href=\"http://guides.rubyonrails.org/active_record_querying.html#passing-in-arguments\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>)."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1516824390, "post_id": 48430649, "comment_id": 83852401, "body": "really nice and concise way of explaining it - thanks @muistooshort"}], "tags": [], "owner": {"reputation": 137, "user_id": 2098868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vSHA1.jpg?s=128&g=1", "display_name": "forchetan01", "link": "https://stackoverflow.com/users/2098868/forchetan01"}, "is_accepted": false, "score": 0, "last_activity_date": 1516824253, "last_edit_date": 1516824253, "creation_date": 1516823821, "answer_id": 48430649, "question_id": 48430086, "link": "https://stackoverflow.com/questions/48430086/ruby-get-result-of-previous-method-in-current-method/48430649#48430649", "title": "Ruby: Get result of previous method in current method", "body": "<p><code>self.testing</code> means this is a class method and can be used like <code>User.testing</code> NOT <code>User.all.testing</code> because <code>User.all</code> returns active record relation. </p>\n\n<p>Solution: Create scope in your model</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  scope :testing, -&gt; (username) { group_by(username: username) }\nend\n</code></pre>\n\n<p>Now you can use <code>User.all.testing</code></p>\n"}, {"comments": [{"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "edited": false, "score": 0, "creation_date": 1516825354, "post_id": 48430927, "comment_id": 83852870, "body": "Ah.. Didn&#39;t know that <code>all</code> carries across scopes!"}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "reply_to_user": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "edited": false, "score": 0, "creation_date": 1516825426, "post_id": 48430927, "comment_id": 83852897, "body": "@jonhue I&#39;ve just updated the answer with a link to the relevant bit of the Rails source. Check it out - it&#39;s pretty interesting and logical."}, {"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "edited": false, "score": 1, "creation_date": 1516825485, "post_id": 48430927, "comment_id": 83852929, "body": "Thanks for the reference! Makes sense."}], "tags": [], "owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "is_accepted": true, "score": 2, "last_activity_date": 1516826762, "last_edit_date": 1516826762, "creation_date": 1516825147, "answer_id": 48430927, "question_id": 48430086, "link": "https://stackoverflow.com/questions/48430086/ruby-get-result-of-previous-method-in-current-method/48430927#48430927", "title": "Ruby: Get result of previous method in current method", "body": "<p>As mentioned in the comments, I can't explain where this <code>group_by</code> method that accepts a parameter is coming from, but to make your <code>testing</code> method work the same as <code>User.all.group_by(username: 'username')</code> write it as </p>\n\n<pre><code>def self.testing\n  all.group_by(username: 'username')\nend\n</code></pre>\n\n<p>The use of <code>all</code> will create an ActiveRecord relation for you. Note that even though it says \"all\", if you do have any other scopes in effect these <a href=\"https://github.com/rails/rails/blob/1280ad6d19fa56e9bf6d6a261c1231326cb3d8c3/activerecord/lib/active_record/scoping/named.rb#L29\" rel=\"nofollow noreferrer\">will be carried across</a>. e.g. it would behave correctly for <code>User.where(some: value).testing</code>. If you call <code>testing</code> directly without any other scopes established i.e. <code>User.testing</code> then then default scope will be used.</p>\n"}], "owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 48430927, "answer_count": 3, "score": 0, "last_activity_date": 1516826762, "creation_date": 1516821597, "last_edit_date": 1516825922, "question_id": 48430086, "link": "https://stackoverflow.com/questions/48430086/ruby-get-result-of-previous-method-in-current-method", "title": "Ruby: Get result of previous method in current method", "body": "<p>The following illustrates my problem:</p>\n\n<pre><code>User.all.testing\n\ndef self.testing\n    v = self\n    v.group_by { |user| user.username = 'username' }\nend\n</code></pre>\n\n<p>leads to:</p>\n\n<blockquote>\n  <p>undefined method `group_by' for Class:0x8ca0558</p>\n</blockquote>\n\n<p>However:</p>\n\n<pre><code>User.all.group_by { |user| user.username = 'username' }\n</code></pre>\n\n<p>works.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 137, "user_id": 2098868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vSHA1.jpg?s=128&g=1", "display_name": "forchetan01", "link": "https://stackoverflow.com/users/2098868/forchetan01"}, "edited": false, "score": 2, "creation_date": 1516826060, "post_id": 48429967, "comment_id": 83853238, "body": "Can you please share what have written in your <code>User</code> model?"}, {"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1516869080, "post_id": 48429967, "comment_id": 83868132, "body": "Yes, I think your ruby version is not compatible with rails version. Try to downgrade ruby version to 2.3, it&#39;d be fine."}, {"owner": {"reputation": 151, "user_id": 4777226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/970bd4e0d39897d7c0c30f15e1124d6d?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4777226/jay"}, "edited": false, "score": 0, "creation_date": 1516909101, "post_id": 48429967, "comment_id": 83894148, "body": "I followed <a href=\"https://gorails.com/setup/ubuntu/16.04\" rel=\"nofollow noreferrer\">gorails.com/setup/ubuntu/16.04</a> to install ruby 2.5.0 and rails 5.1.4, so I believe they should be compatible?  The function &#39;find_for_database_authentication&#39; is not defined by me"}], "owner": {"reputation": 151, "user_id": 4777226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/970bd4e0d39897d7c0c30f15e1124d6d?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4777226/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 967, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516821106, "creation_date": 1516821106, "question_id": 48429967, "link": "https://stackoverflow.com/questions/48429967/typeerror-cannot-visit-integer-when-calling-user-find-for-database-authenticat", "title": "TypeError (Cannot visit Integer) when calling User.find_for_database_authentication(email: params[:email])", "body": "<p>I am using ruby 2.5 and rails 5.1.4, which should be compatible with each other. When im calling User.find_for_database_authentication(email: params[:email]), i got an error: TypeError (Cannot visit Integer) </p>\n\n<p>The param email was passed correctly. Anyone know what is this about? Thanks!</p>\n"}, {"tags": ["ruby", "rubygems", "gem-bundler"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 2, "creation_date": 1516822602, "post_id": 48429778, "comment_id": 83851323, "body": "The error is telling you specifically what the problem is. <code>The validation error was &#39;&quot;FIXME&quot; or &quot;TODO&quot; is not a description&#39;</code>."}, {"owner": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1516824207, "post_id": 48429778, "comment_id": 83852298, "body": "Ah.... Those are default strings that are put into the .gemspec file to remind you to do fill them in as needed.  My bad!  And thank you!"}], "owner": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517935322, "creation_date": 1516820363, "last_edit_date": 1516877096, "question_id": 48429778, "link": "https://stackoverflow.com/questions/48429778/how-to-fix-geminvalidspecificationexception-error-after-breaking-a-gem", "title": "How to fix &quot;Gem::InvalidSpecificationException&quot; error after breaking a gem?", "body": "<pre><code>Gem::Specification.new do |spec|\n  spec.name          = \"nba_schedule\"\n  spec.version       = NBA_Schedule::VERSION\n  spec.authors       = [\"TylerP33\"]\n  spec.email         = [\"tyler3321@gmail.com\"]\n\n  spec.summary       = %q{TODO: Write a short summary, because RubyGems \n  requires one.}\n  spec.description   = %q{TODO: Write a longer description or delete this \n  line.}\n  spec.homepage      = \"TODO: Put your gem's website or public repo URL \n  here.\"\n  spec.license       = \"MIT\"\n</code></pre>\n\n<p>So in the above .gemspec folder, I had changed my spec.version from <code>NbaSchedule::VERSION</code> to <code>NBA_Schedule::Version</code>, which is what you see below (it was just too ugly).</p>\n\n<p>Because <code>NbaSchedule</code> was used at the time of gem creation (used a command to stub out all the necessary gem files I would need to start one from scratch), it is giving me a lot of grief for changing it and I can't figure out why.  I have covered all the dependencies by changing them as needed.</p>\n\n<p>Am I missing something here?</p>\n\n<pre><code>/home/TylerP/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/bundler-\n1.16.0/lib/bundler/rubygems_integration.rb:65:in `rescue in validate': The \ngemspec at /mnt/c/Users/tyler/Desktop/nba_schedule/nba_schedule.gemspec is \nnot valid. Please fix this gemspec. (Gem::InvalidSpecificationException)\nThe validation error was '\"FIXME\" or \"TODO\" is not a description'\n</code></pre>\n\n<p>My error is above.</p>\n\n<p>I am fairly new to coding, period.  So I understand I may be missing something glaring but I would love to know why it is breaking if everything is cohesive and changed over.</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3", "aws-sdk"], "comments": [{"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1516841005, "post_id": 48429366, "comment_id": 83859381, "body": "Can you capture the actual request that&#39;s being sent?"}, {"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1516869628, "post_id": 48429366, "comment_id": 83868420, "body": "Please double-check your profile: <a href=\"https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/credentials.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/sdk-for-java/v1/developer-guide/&hellip;</a>  Check it out if these values were loaded"}], "owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516828249, "creation_date": 1516818730, "last_edit_date": 1516828249, "question_id": 48429366, "link": "https://stackoverflow.com/questions/48429366/ruby-aws-sdk-throws-a-missingsecurityheader", "title": "Ruby aws-sdk throws a MissingSecurityHeader", "body": "<p>My aws Profile looks like: </p>\n\n<pre><code>[my_aws_profile]\naws_access_key_id = XXXXXXXXXXXXXXXXXX\naws_secret_access_key = YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY\nregion = us-east-1\n</code></pre>\n\n<p>My call: </p>\n\n<pre><code>s3 = Aws::S3::Client.new(region: 'us-east-1', credentials: Aws::SharedCredentials.new(profile_name: 'my_aws_profile'))\n\ns3.put_object_acl(\n  bucket: $global_config['bucket'], key: someFile_key_json, grant_read: grant_read)\n</code></pre>\n\n<p>Rerturns</p>\n\n<pre><code>Aws::S3::Errors::MissingSecurityHeader: Your request was missing a required header\n</code></pre>\n\n<p>What am I doing wrong? ...\nHow do I fix this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516817504, "post_id": 48428882, "comment_id": 83848625, "body": "are you getting <code>@tags</code> in the <code>_form</code> partial?"}, {"owner": {"reputation": 23, "user_id": 7515591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-wx2PHmaAeDA/AAAAAAAAAAI/AAAAAAAAAM4/jDZjIrDgcbg/photo.jpg?sz=128", "display_name": "Gomathi", "link": "https://stackoverflow.com/users/7515591/gomathi"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516817641, "post_id": 48428882, "comment_id": 83848691, "body": "@Gabbar yes. I am using the partial form for both edit and create post"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516817683, "post_id": 48428882, "comment_id": 83848717, "body": "@are you using <code>acts_as_taggable</code> gem?"}, {"owner": {"reputation": 23, "user_id": 7515591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-wx2PHmaAeDA/AAAAAAAAAAI/AAAAAAAAAM4/jDZjIrDgcbg/photo.jpg?sz=128", "display_name": "Gomathi", "link": "https://stackoverflow.com/users/7515591/gomathi"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516817718, "post_id": 48428882, "comment_id": 83848738, "body": "@Gabbar No I haven&#39;t used any for this."}, {"owner": {"reputation": 621, "user_id": 1690384, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4187ec71a8ae5536ad9c319cb5535d14?s=128&d=identicon&r=PG", "display_name": "Junan Chakma", "link": "https://stackoverflow.com/users/1690384/junan-chakma"}, "edited": false, "score": 0, "creation_date": 1516817750, "post_id": 48428882, "comment_id": 83848752, "body": "Could you please add the <code>Post</code> model code? and is there any callback method in <code>Post</code> model?"}, {"owner": {"reputation": 23, "user_id": 7515591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-wx2PHmaAeDA/AAAAAAAAAAI/AAAAAAAAAM4/jDZjIrDgcbg/photo.jpg?sz=128", "display_name": "Gomathi", "link": "https://stackoverflow.com/users/7515591/gomathi"}, "reply_to_user": {"reputation": 621, "user_id": 1690384, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4187ec71a8ae5536ad9c319cb5535d14?s=128&d=identicon&r=PG", "display_name": "Junan Chakma", "link": "https://stackoverflow.com/users/1690384/junan-chakma"}, "edited": false, "score": 0, "creation_date": 1516817895, "post_id": 48428882, "comment_id": 83848834, "body": "@JunanChakma I have added Post model code"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516818239, "post_id": 48428882, "comment_id": 83849016, "body": "@GomathiN when do you get this error? i mean on submitting the form or on loading this new page?"}, {"owner": {"reputation": 23, "user_id": 7515591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-wx2PHmaAeDA/AAAAAAAAAAI/AAAAAAAAAM4/jDZjIrDgcbg/photo.jpg?sz=128", "display_name": "Gomathi", "link": "https://stackoverflow.com/users/7515591/gomathi"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516818296, "post_id": 48428882, "comment_id": 83849053, "body": "@Gabbar While submitting the form. I think it is on create action and while calling post_params. But I don&#39;t know what is the reason"}, {"owner": {"reputation": 621, "user_id": 1690384, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4187ec71a8ae5536ad9c319cb5535d14?s=128&d=identicon&r=PG", "display_name": "Junan Chakma", "link": "https://stackoverflow.com/users/1690384/junan-chakma"}, "edited": false, "score": 0, "creation_date": 1516818871, "post_id": 48428882, "comment_id": 83849359, "body": "Did you check what are you getting of <code>post_params[:tag_ids]</code> in <code>Post#create</code> while creating a <code>Post</code>?"}, {"owner": {"reputation": 23, "user_id": 7515591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-wx2PHmaAeDA/AAAAAAAAAAI/AAAAAAAAAM4/jDZjIrDgcbg/photo.jpg?sz=128", "display_name": "Gomathi", "link": "https://stackoverflow.com/users/7515591/gomathi"}, "reply_to_user": {"reputation": 621, "user_id": 1690384, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4187ec71a8ae5536ad9c319cb5535d14?s=128&d=identicon&r=PG", "display_name": "Junan Chakma", "link": "https://stackoverflow.com/users/1690384/junan-chakma"}, "edited": false, "score": 0, "creation_date": 1516819100, "post_id": 48428882, "comment_id": 83849480, "body": "@JunanChakma This is what i am getting at &quot;@post&quot; of create  #&lt;Post id: nil, topic_id: 12, user_id: nil, title: &quot;sjjdhjshj&quot;, content: &quot;jjxbcjxbcjx&quot;, created_at: nil, updated_at: nil, post_image_file_name: nil, post_image_content_type: nil, post_image_file_size: nil, post_image_updated_at: nil&gt;"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516822512, "post_id": 48428882, "comment_id": 83851272, "body": "@GomathiN could you try the modified answer given below and let me know for further guidance.thank you."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1516857281, "post_id": 48428882, "comment_id": 83863451, "body": "@GomathiN could you let me know if the modified answer below is working or not? feel free to accept answer, it it helped you, for future SO searcher"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8854975, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Nlkx9zTj0zs/AAAAAAAAAAI/AAAAAAAAABA/w__4ZBZsH3w/photo.jpg?sz=128", "display_name": "shakeel rauf", "link": "https://stackoverflow.com/users/8854975/shakeel-rauf"}, "reply_to_user": {"reputation": 23, "user_id": 7515591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-wx2PHmaAeDA/AAAAAAAAAAI/AAAAAAAAAM4/jDZjIrDgcbg/photo.jpg?sz=128", "display_name": "Gomathi", "link": "https://stackoverflow.com/users/7515591/gomathi"}, "edited": false, "score": 0, "creation_date": 1516877731, "post_id": 48429123, "comment_id": 83873411, "body": "then you should see followings link <a href=\"https://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/collection_select\" rel=\"nofollow noreferrer\">apidock.com/rails/ActionView/Helpers/FormOptionsHelper/&hellip;</a>"}], "tags": [], "owner": {"reputation": 17, "user_id": 8854975, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Nlkx9zTj0zs/AAAAAAAAAAI/AAAAAAAAABA/w__4ZBZsH3w/photo.jpg?sz=128", "display_name": "shakeel rauf", "link": "https://stackoverflow.com/users/8854975/shakeel-rauf"}, "is_accepted": false, "score": 0, "last_activity_date": 1516817900, "creation_date": 1516817900, "answer_id": 48429123, "question_id": 48428882, "link": "https://stackoverflow.com/questions/48428882/using-collection-select-in-rails/48429123#48429123", "title": "Using collection select in rails", "body": "<p>if you are using this scenario you have to make MANY TO MANY relation between these two models.</p>\n\n<blockquote>\n  <p>has_and_belongs_to_many :tags</p>\n</blockquote>\n\n<p>then in form you should use like</p>\n\n<blockquote>\n  <p>form.collection_select(:post, :tag_id, Tag.all, :id, :name_with_initial, prompt: true) </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7515591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-wx2PHmaAeDA/AAAAAAAAAAI/AAAAAAAAAM4/jDZjIrDgcbg/photo.jpg?sz=128", "display_name": "Gomathi", "link": "https://stackoverflow.com/users/7515591/gomathi"}, "edited": false, "score": 0, "creation_date": 1517147973, "post_id": 48429341, "comment_id": 83967062, "body": "I think Migration is enough for join table."}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 3, "last_activity_date": 1516822748, "last_edit_date": 1516822748, "creation_date": 1516818658, "answer_id": 48429341, "question_id": 48428882, "link": "https://stackoverflow.com/questions/48428882/using-collection-select-in-rails/48429341#48429341", "title": "Using collection select in rails", "body": "<p>You should have a join table with name <code>posts_tags.rb</code></p>\n\n<pre><code>class Post_Tag &lt; ApplicationRecord\n  belongs_to :tag\n  belongs_to :post\nend\n</code></pre>\n\n<p>so you have already some tags which you want to be selected with post and join table should be updated with <code>post_id</code> and <code>tag_id</code></p>\n\n<p>change this in your form_partial: -</p>\n\n<pre><code>&lt;%= select_tag \"tag_ids\", options_for_select(@tags,:id,:name),{}, multiple: true%&gt; &lt;br/&gt;&lt;br/&gt;\n</code></pre>\n\n<p>Note: - you should not use <code>form.collection_select(:tag_ids...)</code> Reason being <code>form_for</code> is used here for <code>@post</code> object and <code>tag_ids</code> is not attribute of <code>@post</code> object.</p>\n\n<p>so on submitting form you should get array of tag's ids in <code>params[:tag_ids]</code></p>\n\n<pre><code>  def create\n    @post = @topic.posts.new(post_params)\n    if @post.save\n      #create join table for tags that are associated with post\n      @post.tags &lt;&lt; Tag.find(params[:tag_ids]) \n      redirect_to topic_posts_path\n    else\n      render 'new'\n    end\n  end\n</code></pre>\n\n<p>so here you can get </p>\n\n<p><code>@post.tags</code> =>  which will return you collection of tags associated with the post</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7515591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-wx2PHmaAeDA/AAAAAAAAAAI/AAAAAAAAAM4/jDZjIrDgcbg/photo.jpg?sz=128", "display_name": "Gomathi", "link": "https://stackoverflow.com/users/7515591/gomathi"}, "edited": false, "score": 0, "creation_date": 1516820959, "post_id": 48429829, "comment_id": 83850390, "body": "Yes When I create a @tags variable in create action it works fine but how?"}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "reply_to_user": {"reputation": 23, "user_id": 7515591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-wx2PHmaAeDA/AAAAAAAAAAI/AAAAAAAAAM4/jDZjIrDgcbg/photo.jpg?sz=128", "display_name": "Gomathi", "link": "https://stackoverflow.com/users/7515591/gomathi"}, "edited": false, "score": 0, "creation_date": 1516821584, "post_id": 48429829, "comment_id": 83850759, "body": "Instance variables used in view need to be declared in controller action before renders. Error message was &quot;undefined method `map&#39; for nil:NilClass&quot; - I guess at some point .collection_select needed to call .map on @tags and @tags wasn&#39;t there."}], "tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": false, "score": 0, "last_activity_date": 1516820541, "creation_date": 1516820541, "answer_id": 48429829, "question_id": 48428882, "link": "https://stackoverflow.com/questions/48428882/using-collection-select-in-rails/48429829#48429829", "title": "Using collection select in rails", "body": "<p>The <code>@tags</code> variable is missing from your <code>create</code> action in controller - you have declared it in <code>new</code>, but not in <code>create</code>. It may cause error in view if save was unsucessful and action tries to re-render the form. </p>\n\n<p>Not sure if that's all, because I'm not sure where the error is thrown exactly. But as you said in one of the comments - it works when you use <code>Tag.all</code> instead of <code>@tags</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 7515591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-wx2PHmaAeDA/AAAAAAAAAAI/AAAAAAAAAM4/jDZjIrDgcbg/photo.jpg?sz=128", "display_name": "Gomathi", "link": "https://stackoverflow.com/users/7515591/gomathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1339, "favorite_count": 0, "accepted_answer_id": 48429341, "answer_count": 3, "score": 2, "last_activity_date": 1517146889, "creation_date": 1516816851, "last_edit_date": 1517146889, "question_id": 48428882, "link": "https://stackoverflow.com/questions/48428882/using-collection-select-in-rails", "title": "Using collection select in rails", "body": "<p>I am trying to create a simple blog application. In which each post can be associated with the tags. This is my view</p>\n\n<p><strong>_form.hmtl.erb</strong></p>\n\n<pre><code>&lt;%= form.collection_select(:tag_ids, @tags, :id, :name, {}, :multiple =&gt; true) %&gt; \n</code></pre>\n\n<p>This is my controller</p>\n\n<p><strong>posts_controller.rb</strong></p>\n\n<pre><code> def new\n    @post = @topic.posts.new\n    @tag = @post.tags.new\n    @tags = Tag.all\n  end\n\n  def create\n    @post = @topic.posts.new(post_params)\n    if @post.save\n      redirect_to topic_posts_path\n    else\n      render 'new'\n    end\n  end\n  def post_params\n    params.require(:post).permit(:title,:content,:post_image, tag_ids: [])\n  end\nend\n</code></pre>\n\n<p>Model <strong>Post.rb</strong>    </p>\n\n<pre><code> has_and_belongs_to_many :tags\n</code></pre>\n\n<p>I am getting an error while creating new post \"NoMethodError in Posts#create\", \"undefined method `map' for nil:NilClass\". I am not able to find where the error is.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "reactjs"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 2, "creation_date": 1516815530, "post_id": 48428535, "comment_id": 83847495, "body": "No, because JSX is Javascript, not HTML."}], "answers": [{"comments": [{"owner": {"reputation": 2015, "user_id": 4852449, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d154c373d3615bf42edf7aecaba3a9c?s=128&d=identicon&r=PG&f=1", "display_name": "cvdv", "link": "https://stackoverflow.com/users/4852449/cvdv"}, "edited": false, "score": 0, "creation_date": 1516818066, "post_id": 48428874, "comment_id": 83848932, "body": "thanks but that&#39;s actually what I am migrating away from"}], "tags": [], "owner": {"reputation": 3272, "user_id": 2389628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A4nuI.jpg?s=128&g=1", "display_name": "smallbutton", "link": "https://stackoverflow.com/users/2389628/smallbutton"}, "is_accepted": false, "score": 0, "last_activity_date": 1516816831, "creation_date": 1516816831, "answer_id": 48428874, "question_id": 48428535, "link": "https://stackoverflow.com/questions/48428535/is-there-a-way-to-render-a-react-component-in-erb-using-component/48428874#48428874", "title": "is there a way to render a React component in ERB using &lt;Component/&gt;?", "body": "<p>Try with <a href=\"https://github.com/shakacode/react_on_rails\" rel=\"nofollow noreferrer\">react on rails</a>. It is the closest you will get to. It gives you a <code>react_component</code> view helper that allows you to render components previously registered.</p>\n"}, {"tags": [], "owner": {"reputation": 90, "user_id": 7454401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb48b302f49bcb41fa2ce988bc309105?s=128&d=identicon&r=PG&f=1", "display_name": "Ning Ding", "link": "https://stackoverflow.com/users/7454401/ning-ding"}, "is_accepted": false, "score": 0, "last_activity_date": 1516822259, "creation_date": 1516822259, "answer_id": 48430260, "question_id": 48428535, "link": "https://stackoverflow.com/questions/48428535/is-there-a-way-to-render-a-react-component-in-erb-using-component/48430260#48430260", "title": "is there a way to render a React component in ERB using &lt;Component/&gt;?", "body": "<p>if you use something like <code>react-router</code> and define a routes jsx file, then you can simply do <code>&lt;div id=\"react-router\"&gt;&lt;/div&gt;</code> in your erb file not sure if this is what you are looking for.</p>\n"}], "owner": {"reputation": 2015, "user_id": 4852449, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d154c373d3615bf42edf7aecaba3a9c?s=128&d=identicon&r=PG&f=1", "display_name": "cvdv", "link": "https://stackoverflow.com/users/4852449/cvdv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1231, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1516822259, "creation_date": 1516815433, "last_edit_date": 1516818727, "question_id": 48428535, "link": "https://stackoverflow.com/questions/48428535/is-there-a-way-to-render-a-react-component-in-erb-using-component", "title": "is there a way to render a React component in ERB using &lt;Component/&gt;?", "body": "<p>instead of creating a div with an id and using ReactDOM to render it. For example, I am currently doing this:</p>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code>&lt;div id=\"home-page\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p><strong>HomePage.js</strong></p>\n\n<pre><code>import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Component1 from './components/Component1'\n\nclass HomePage extends React.Component {\n  ...\n  render() {\n    &lt;Component1/&gt;\n    &lt;Component2/&gt;\n  }\n}\n</code></pre>\n\n<p>But would prefer to do this:</p>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code>&lt;Component1/&gt;\n&lt;Component2/&gt;\n</code></pre>\n\n<p>Is this possible? I am able to do it with Vue.js but it doesn't appear to be possible with react.</p>\n"}, {"tags": ["mysql", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 608, "user_id": 5978922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HL51a.png?s=128&g=1", "display_name": "nerding_it", "link": "https://stackoverflow.com/users/5978922/nerding-it"}, "is_accepted": false, "score": 1, "last_activity_date": 1517563922, "creation_date": 1517563922, "answer_id": 48579628, "question_id": 48428529, "link": "https://stackoverflow.com/questions/48428529/ruby-and-mysql2-iterating-a-subset-of-rows-in-result-set/48579628#48579628", "title": "Ruby and mysql2- iterating a subset of rows in result set", "body": "<p>Ruby provides range operator in for loop, Probably you can use following code</p>\n\n<pre><code>for i in 5..8\n  puts rs.entries[i]\nend\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6496610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebc416f19cceb638268d8ec0867af591?s=128&d=identicon&r=PG&f=1", "display_name": "It&#39;sMojitoTime", "link": "https://stackoverflow.com/users/6496610/itsmojitotime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517563922, "creation_date": 1516815410, "question_id": 48428529, "link": "https://stackoverflow.com/questions/48428529/ruby-and-mysql2-iterating-a-subset-of-rows-in-result-set", "title": "Ruby and mysql2- iterating a subset of rows in result set", "body": "<p>I'm writing a Ruby script that accesses a MySQL database using the Mysql2 gem.</p>\n\n<p>After I get a set of results from a query, I want to examine a subset of the rows of the result set (e.g. rows 5 to 8) rather than the whole set.</p>\n\n<p>I know I can do this with a while loop, something like this:</p>\n\n<pre><code>db = Mysql2::Client.new(:host =&gt; \"myserver\", :username =&gt; \"user\", :password =&gt; \"pass\", :database =&gt; \"books\")\n\nrs = db.query \"select * from bookslist\"\n\ni = 5\nwhile i &lt;= 8\n    puts rs.entries[i]\n    i += 1\nend\n\ndb.close\n</code></pre>\n\n<p>But I'm aware this is probably not the best way to write this in Ruby. How can I make this more \"idiomatic\" Ruby code?</p>\n\n<p>(I know my other option is to modify the query to return only the data I want. I still want to know how to do this in Ruby)</p>\n"}, {"tags": ["ruby", "sequel", "sequel-gem"], "owner": {"reputation": 517, "user_id": 4200859, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/72fe764d26ac6cb9d3a5bbeaa45fc1be?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4200859/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516811977, "creation_date": 1516811977, "question_id": 48427496, "link": "https://stackoverflow.com/questions/48427496/sequel-gem-fatal-remaining-connection-slots-are-reserved-for-non-replication", "title": "Sequel gem - &quot;FATAL: remaining connection slots are reserved for non-replication superuser connections&quot;", "body": "<p>From googling, I know this error seems to be due to connections not being closed properly. However, the way the Sequel gem readme says to use a database is to open a connection using <code>@db = Sequel.connect('postgres://someaddress')</code> and then call various commands after that. I've read some people mention using a code block for the connection, but would that mean I just need to put a code block around my entire program? And won't a connection still get stuck open if there's an error somewhere?</p>\n\n<p>I've tried enabling the connection validator plugin as so:</p>\n\n<pre><code>@db = Sequel.connect('postgres://someaddress')\n@db.extension(:connection_validator)\n</code></pre>\n\n<p>But I'm still getting the same problem.</p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["ruby", "sign", "hmac"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516825175, "post_id": 48427354, "comment_id": 83852783, "body": "Can you provide an example (not using <i>any</i> private data) of PHP inputs and outputs and the corresponding output from Ruby of same?"}, {"owner": {"reputation": 304, "user_id": 647417, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Ec7Bw.png?s=128&g=1", "display_name": "4e4c52", "link": "https://stackoverflow.com/users/647417/4e4c52"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1516887400, "post_id": 48427354, "comment_id": 83879708, "body": "@tadman I edited the code above to show you how it&#39;s used. As you can see, the signatures mismatch. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 304, "user_id": 647417, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Ec7Bw.png?s=128&g=1", "display_name": "4e4c52", "link": "https://stackoverflow.com/users/647417/4e4c52"}, "edited": false, "score": 0, "creation_date": 1517218629, "post_id": 48456639, "comment_id": 83989422, "body": "Hello Damon, thanks for your input. The pack method is undefined for the String class (which key is). I tried with <code>[key].pack(&#39;H&#39;)</code> and <code>[key].pack(&#39;H*&#39;)</code> but the hex output still differs from the one I get with PHP."}], "tags": [], "owner": {"reputation": 657, "user_id": 173837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f64d2cef81f2322b0532187090f9406?s=128&d=identicon&r=PG", "display_name": "Damon", "link": "https://stackoverflow.com/users/173837/damon"}, "is_accepted": false, "score": 1, "last_activity_date": 1516948071, "creation_date": 1516948071, "answer_id": 48456639, "question_id": 48427354, "link": "https://stackoverflow.com/questions/48427354/ruby-hmac-signing-issue/48456639#48456639", "title": "Ruby HMAC signing issue", "body": "<p>The packing of the hex <strong>representation</strong> of the key back into a binary form is the bit you're missing.</p>\n\n<p>See this post for example: <a href=\"https://blog.bigbinary.com/2011/07/20/ruby-pack-unpack.html\" rel=\"nofollow noreferrer\">https://blog.bigbinary.com/2011/07/20/ruby-pack-unpack.html</a></p>\n\n<p>You'll want something like this:</p>\n\n<pre><code>signature = OpenSSL::HMAC.hexdigest(digest, key.pack('H'), message)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 2478563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/901870ee3344152d79a096356dce01d5?s=128&d=identicon&r=PG", "display_name": "Raffy", "link": "https://stackoverflow.com/users/2478563/raffy"}, "is_accepted": false, "score": 1, "last_activity_date": 1518729333, "creation_date": 1518729333, "answer_id": 48816404, "question_id": 48427354, "link": "https://stackoverflow.com/questions/48427354/ruby-hmac-signing-issue/48816404#48816404", "title": "Ruby HMAC signing issue", "body": "<p>I'm using this in my project:</p>\n\n<pre><code>bin_key = Array(keyTest).pack 'H*'\n@hmac = OpenSSL::HMAC.hexdigest(\"SHA512\", bin_key, msg).upcase\n</code></pre>\n\n<p>This works fine for me.</p>\n"}, {"comments": [{"owner": {"reputation": 304, "user_id": 647417, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Ec7Bw.png?s=128&g=1", "display_name": "4e4c52", "link": "https://stackoverflow.com/users/647417/4e4c52"}, "edited": false, "score": 1, "creation_date": 1518736251, "post_id": 48817063, "comment_id": 84639501, "body": "God I&#39;m ashamed... Thank you!"}, {"owner": {"reputation": 2231, "user_id": 1238868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9884f1eabc8587f2c9dfd2b1ccf9a6?s=128&d=identicon&r=PG", "display_name": "Michael Chaney", "link": "https://stackoverflow.com/users/1238868/michael-chaney"}, "reply_to_user": {"reputation": 304, "user_id": 647417, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Ec7Bw.png?s=128&g=1", "display_name": "4e4c52", "link": "https://stackoverflow.com/users/647417/4e4c52"}, "edited": false, "score": 1, "creation_date": 1518751643, "post_id": 48817063, "comment_id": 84643100, "body": "Don&#39;t feel bad, we&#39;ve all been there.  I figured it out because I used another method to calculate the actual hash, found that Ruby was correct (when using the actual key as above), and then worked to see why PHP was wrong."}], "tags": [], "owner": {"reputation": 2231, "user_id": 1238868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9884f1eabc8587f2c9dfd2b1ccf9a6?s=128&d=identicon&r=PG", "display_name": "Michael Chaney", "link": "https://stackoverflow.com/users/1238868/michael-chaney"}, "is_accepted": true, "score": 1, "last_activity_date": 1518732316, "creation_date": 1518732316, "answer_id": 48817063, "question_id": 48427354, "link": "https://stackoverflow.com/questions/48427354/ruby-hmac-signing-issue/48817063#48817063", "title": "Ruby HMAC signing issue", "body": "<p>You need to do this in Ruby:</p>\n\n<pre><code>hash = OpenSSL::HMAC.hexdigest(digest, [key].pack('H*'), message)\n</code></pre>\n\n<p>The real issue here is that your PHP code uses two variable names for the message.  You set <code>$message</code>, then use <code>$msg</code>, which means you're computing the hash for an undefined variable.</p>\n"}], "owner": {"reputation": 304, "user_id": 647417, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Ec7Bw.png?s=128&g=1", "display_name": "4e4c52", "link": "https://stackoverflow.com/users/647417/4e4c52"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 48817063, "answer_count": 3, "score": 1, "last_activity_date": 1518732316, "creation_date": 1516811556, "last_edit_date": 1516887348, "question_id": 48427354, "link": "https://stackoverflow.com/questions/48427354/ruby-hmac-signing-issue", "title": "Ruby HMAC signing issue", "body": "<p>I got an issue with HMAC. \nI have to sign a form before sending it to a bank. \nThey only provide an example in PHP in their documentation. </p>\n\n<p>I have a hex key to sign my data (e.g. <code>FCEBA61A884A938E7E7FE4F5C68AA7F4A349768EE5957DDFBE99C1D05A09CBACF1FCF0A7084CB2E4CBA95193176C4395DE7F39EA9DBEBEF0907D77192AAE3E8A</code>). </p>\n\n<p>In the PHP exemple, they do this with the key before signing the data:</p>\n\n<pre><code> $key = \"FCEBA61A884A938E7E7FE4F5C68AA7F4A349768EE5957DDFBE99C1D05A09CBACF1FCF0A7084CB2E4CBA95193176C4395DE7F39EA9DBEBEF0907D77192AAE3E8A\";\n $message = \"param1=a&amp;param2=b\";\n\n $binKey = pack('H*', $key);\n $signature = hash_hmac('sha512', $msg, $binKey);\n echo $signature;\n\n // =&gt; a3efb70368bee502ea57a1a4708cac8912a5172075ea8dec2de2770dfbb4c8fb587f03fdadc0ca4f9e1bb024cfda12866295b259f5fb4df2fe14d960874a68ab\n</code></pre>\n\n<p>I don't understand why they pack the key and if I should do something similar with my key.\nI did the following in my Ruby code: </p>\n\n<pre><code>key = \"FCEBA61A884A938E7E7FE4F5C68AA7F4A349768EE5957DDFBE99C1D05A09CBACF1FCF0A7084CB2E4CBA95193176C4395DE7F39EA9DBEBEF0907D77192AAE3E8A\"\nmessage = \"param1=a&amp;param2=b\"\n\ndigest = OpenSSL::Digest.new('sha512')\nsignature = OpenSSL::HMAC.hexdigest(digest, key, message)\n\nputs signature\n\n# =&gt; d817611845246640d1224a0874bf60fed0956a367aa3069b7947cbec56903bb5d8c54df170f5504c586dad55e4f879c70cf1a40526cfc9f35411195822c535ed\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "http-headers", "discourse"], "answers": [{"tags": [], "owner": {"reputation": 3725, "user_id": 582665, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f3449b02be5eb3699bce192b67de74f8?s=128&d=identicon&r=PG", "display_name": "mixkat", "link": "https://stackoverflow.com/users/582665/mixkat"}, "is_accepted": true, "score": 0, "last_activity_date": 1518533156, "last_edit_date": 1518533156, "creation_date": 1516837351, "answer_id": 48433488, "question_id": 48426793, "link": "https://stackoverflow.com/questions/48426793/adding-csp-header-by-merging-headers/48433488#48433488", "title": "Adding CSP header by merging headers", "body": "<p>My syntax was off and this is working fine now. Correct syntax is like:</p>\n\n<p><code>Rails.application.config.action_dispatch.default_headers.merge!({'Content-Security-Policy' =&gt; \"frame-ancestors *\"})\n</code></p>\n\n<p>Put it up on github in case someone wants to use it as a plugin: <a href=\"https://github.com/mkatrantzis/testDiscourseCSP\" rel=\"nofollow noreferrer\">https://github.com/mkatrantzis/testDiscourseCSP</a></p>\n"}], "owner": {"reputation": 3725, "user_id": 582665, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f3449b02be5eb3699bce192b67de74f8?s=128&d=identicon&r=PG", "display_name": "mixkat", "link": "https://stackoverflow.com/users/582665/mixkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 48433488, "answer_count": 1, "score": 0, "last_activity_date": 1518533156, "creation_date": 1516809949, "last_edit_date": 1516831394, "question_id": 48426793, "link": "https://stackoverflow.com/questions/48426793/adding-csp-header-by-merging-headers", "title": "Adding CSP header by merging headers", "body": "<p>I am trying to create a vary basic .rb plugin (based on the now obsolete in chrome) <a href=\"https://github.com/musketyr/discourse-allowall\" rel=\"nofollow noreferrer\">discourse-allowall\n</a> which will merge the CSP header to the default ones but cant get it to work. </p>\n\n<p>The below does not seem to do it.</p>\n\n<pre><code>Rails.application.config.action_dispatch.default_headers.merge!({'Content-Security-Policy' =&gt; \"frame-ancestors 'http://mylocal.com.localhost'\"})\n</code></pre>\n\n<p>I literally have 0 experience with ruby so need to know: </p>\n\n<ol>\n<li>If thats possible </li>\n<li>The correct syntax for defining the above header and merging it with the default ones</li>\n</ol>\n\n<p>NOTE: End goal is to allow for the application to be frameable by 2 specific domains.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "simple-form"], "comments": [{"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1516810749, "post_id": 48426690, "comment_id": 83844329, "body": "have you tried something like: <code>&lt;%= f.input :time_field, as: :time, html5: true %&gt;</code>"}, {"owner": {"reputation": 323, "user_id": 6942847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lntXq.jpg?s=128&g=1", "display_name": "mxvx", "link": "https://stackoverflow.com/users/6942847/mxvx"}, "reply_to_user": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1516812638, "post_id": 48426690, "comment_id": 83845663, "body": "That got me the format that I was looking for however there are no longer drop downs. Any idea of how to get them back?"}, {"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1516812770, "post_id": 48426690, "comment_id": 83845753, "body": "I am afraid that can not be achieved through it but you can always create  custom drop downs for the same purpose using rails form helper."}, {"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1516812906, "post_id": 48426690, "comment_id": 83845840, "body": "Also, selecting time through three different drop downs are more painful and probably not good for user experience. #advice"}], "answers": [{"tags": [], "owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "is_accepted": true, "score": 3, "last_activity_date": 1516812676, "creation_date": 1516812676, "answer_id": 48427716, "question_id": 48426690, "link": "https://stackoverflow.com/questions/48426690/rails-simple-for-for-time-with-12-hour-format/48427716#48427716", "title": "Rails : simple_for_for time with 12 hour format", "body": "<p>As per the <a href=\"https://github.com/plataformatec/simple_form#html-5-notice\" rel=\"nofollow noreferrer\">documentation</a></p>\n\n<blockquote>\n  <p>HTML 5 date / time inputs are not generated by Simple Form by default, so using date, time or datetime will all generate select boxes using normal Rails helpers. We believe browsers are not totally ready for these yet, but you can easily opt-in on a per-input basis by passing the html5 option:</p>\n</blockquote>\n\n<pre><code>&lt;%= f.input :time, as: :time, html5: true %&gt;\n</code></pre>\n\n<p>This should fix your problem.</p>\n"}], "owner": {"reputation": 323, "user_id": 6942847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lntXq.jpg?s=128&g=1", "display_name": "mxvx", "link": "https://stackoverflow.com/users/6942847/mxvx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 48427716, "answer_count": 1, "score": 1, "last_activity_date": 1516812676, "creation_date": 1516809682, "question_id": 48426690, "link": "https://stackoverflow.com/questions/48426690/rails-simple-for-for-time-with-12-hour-format", "title": "Rails : simple_for_for time with 12 hour format", "body": "<p>Is there a proper way to show 12-hour time in Rail's simple_for_for? I am currently using</p>\n\n<pre><code>&lt;%= f.input :time, :ampm =&gt; true, :minute_step =&gt; 5 %&gt;\n</code></pre>\n\n<p>however it only displays two drop downs, with the times displayed as  <b>01AM</b> in the first dropdown and <b>00</b> in the second.</p>\n\n<p>I would like it to have three drop downs, for hours, minutes, and am/pm. </p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "search", "psql"], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 4884870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495450c9feb246d7a77459d660a76c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Faisal Choura", "link": "https://stackoverflow.com/users/4884870/faisal-choura"}, "edited": false, "score": 0, "creation_date": 1516812746, "post_id": 48426587, "comment_id": 83845739, "body": "Thanks for the fast reply. This works but it even works when only one of the skills matches even though I would like it to only return results that match all the skills that are in the array. Do you think there&#39;s a way to make sure that happens ?"}], "tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": false, "score": 0, "last_activity_date": 1516809406, "creation_date": 1516809406, "answer_id": 48426587, "question_id": 48426251, "link": "https://stackoverflow.com/questions/48426251/use-all-strings-in-an-array-to-search-through-a-has-many-association/48426587#48426587", "title": "Use all strings in an array to search through a has_many association", "body": "<p>Try this one:</p>\n\n<pre><code>def find_profiles                                                                                                          \n  return Profile.all if skills.blank?                                                                                      \n\n  Profile.joins(:skills).where('skills.name_en IN (:skills) OR skills.name_ar IN (:skills)', skills: skills_array(skills))                     \nend \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 170, "user_id": 4884870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495450c9feb246d7a77459d660a76c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Faisal Choura", "link": "https://stackoverflow.com/users/4884870/faisal-choura"}, "edited": false, "score": 0, "creation_date": 1516831461, "post_id": 48426668, "comment_id": 83856007, "body": "This works perfectly. Can you please explain what&#39;s happening in the group() and having() method calls ?"}], "tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": true, "score": 1, "last_activity_date": 1516820109, "last_edit_date": 1516820109, "creation_date": 1516809617, "answer_id": 48426668, "question_id": 48426251, "link": "https://stackoverflow.com/questions/48426251/use-all-strings-in-an-array-to-search-through-a-has-many-association/48426668#48426668", "title": "Use all strings in an array to search through a has_many association", "body": "<p>Try this query:</p>\n\n<pre><code>def find_profiles\n  return Profile.all if skills.blank?\n\n  Profile.joins(:skills)\n         .where('skills.name_en IN (:skills) OR skills.name_ar IN (:skills)', skills: skills_array(skills))\n         .group('profiles.id')\n         .having('COUNT(skills.id) = ?', skills_array(skills).size)\nend\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 4884870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495450c9feb246d7a77459d660a76c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Faisal Choura", "link": "https://stackoverflow.com/users/4884870/faisal-choura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 1, "accepted_answer_id": 48426668, "answer_count": 2, "score": 0, "last_activity_date": 1516820109, "creation_date": 1516808341, "question_id": 48426251, "link": "https://stackoverflow.com/questions/48426251/use-all-strings-in-an-array-to-search-through-a-has-many-association", "title": "Use all strings in an array to search through a has_many association", "body": "<p>Im building a search field for my profile model, the search field takes in a list of skills separated by comas and find the profiles that have those skills. The code splits up the string by comas into multiple strings in an array. Now I am trying to find profiles that have all the skills in that array but I can't seem to wrap my head around it. I've tried playing around with PSQL code in where() but I can only seem to get it to work with 1 of the skills.</p>\n\n<p>I am following the advanced search guide by ryan bates.</p>\n\n<p>Profile.rb</p>\n\n<pre><code>class Profile &lt; ApplicationRecord\n  belongs_to :user, dependent: :destroy\n  has_many :educations\n  has_many :experiences\n  has_many :skills\n  has_many :awards\n  has_many :publications\n\n  def owner? user\n    if self.user == user\n      return true\n    else\n      return false\n    end\n  end\nend\n</code></pre>\n\n<p>business_search.rb</p>\n\n<pre><code>class BusinessSearch &lt; ApplicationRecord\n  def profiles\n    @profiles ||= find_profiles\n  end\n\n  private\n\n  def find_profiles\n    profiles = Profile.all\n    if self.skills.present?\n      profiles = profiles.joins(:skills)\n      skills_array(self.skills).each do |skill|\n        profiles = profiles.where('skills.name_en = :q or skills.name_ar = :q', q: skill)\n      end\n    end\n    profiles\n  end\n\n  def skills_array(skills)\n    return skills.split(/,/)\n  end\nend\n</code></pre>\n\n<p>business_search_controller.rb</p>\n\n<pre><code>class BusinessSearchesController &lt; ApplicationController\n  def new\n    @search = BusinessSearch.new\n  end\n\n  def create\n    @search = BusinessSearch.create!(search_params)\n    redirect_to @search\n  end\n\n  def show\n    search = BusinessSearch.find(params[:id])\n    @profiles = search.profiles\n  end\n\n  private\n\n  def search_params\n    params.require(:business_search).permit(:first_name, :education_field, :skills)\n  end\nend\n</code></pre>\n\n<p>Adavanced search view</p>\n\n<pre><code>&lt;h1&gt;Advanced Search&lt;/h1&gt;\n\n&lt;%= form_for @search do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :skills %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :skills %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;&lt;%= f.submit \"Search\" %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "dropdown", "nested-forms", "strong-parameters"], "comments": [{"owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1516809634, "post_id": 48425622, "comment_id": 83843489, "body": "Your select is named as <code>adcategory_ids</code> but you permit <code>adcategory_id</code>"}, {"owner": {"reputation": 198, "user_id": 4858713, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2b2655225f5ea52a8bb06f55fb54d0b0?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/4858713/charlie"}, "reply_to_user": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1516810786, "post_id": 48425622, "comment_id": 83844357, "body": "Thanks, but adding &quot;:adcategory_ids&quot; in the ...permit, throws an error &quot;unknown attribute &#39;adcategory_ids&#39; for Adcategory&quot;"}, {"owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1516811005, "post_id": 48425622, "comment_id": 83844538, "body": "Yes. I meant it has to be <code>adcategory_id</code> on form and in permit also. Why you called it in plural?"}, {"owner": {"reputation": 198, "user_id": 4858713, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2b2655225f5ea52a8bb06f55fb54d0b0?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/4858713/charlie"}, "reply_to_user": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1516812078, "post_id": 48425622, "comment_id": 83845274, "body": "Ok, changing to adcategory_id in the form works for the drop-down select, but still throwing error after save &quot;unknown attribute &#39;adcategory_id&#39; for Adcategory&quot;  No error when I remove adcategory_id from the strong parameters, obviously data will not save"}, {"owner": {"reputation": 505, "user_id": 5909738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jNscA.jpg?s=128&g=1", "display_name": "Tashows", "link": "https://stackoverflow.com/users/5909738/tashows"}, "edited": false, "score": 0, "creation_date": 1517313863, "post_id": 48425622, "comment_id": 84036566, "body": "Please post your adcategory model and adcategories table from schema"}], "owner": {"reputation": 198, "user_id": 4858713, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2b2655225f5ea52a8bb06f55fb54d0b0?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/4858713/charlie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516806325, "creation_date": 1516806325, "question_id": 48425622, "link": "https://stackoverflow.com/questions/48425622/rails-nested-categories-ancestry-gem-dropdown-select-is-not-saving-to-databa", "title": "Rails nested categories (Ancestry gem) - Dropdown select is not saving to database", "body": "<p>All working fine except new or edited Adcategory is not saving to database. \nMay be I'm missing something in the adcategories_controller strong parameters. \nAny help please?</p>\n\n<p><a href=\"https://i.stack.imgur.com/q7QY9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q7QY9.png\" alt=\"enter image description here\"></a></p>\n\n<p>#app/helpers/application_helper.rb</p>\n\n<pre><code>def nested_dropdown(adcategories)\nresult = []\nadcategories.map do |adcategory, sub_adcategories|\n    result &lt;&lt; [('- ' * adcategory.depth) + adcategory.name, adcategory.id]\n    result += nested_dropdown(sub_adcategories) unless sub_adcategories.blank?\nend\nresult\nend\n</code></pre>\n\n<p>_form.html.erb</p>\n\n<pre><code>&lt;%= f.select(:adcategory_ids, nested_dropdown(Adcategory.all.arrange), prompt: \"Adcategory\", selected: @adcategory ) %&gt;\n</code></pre>\n\n<p>adcategories_controller.rb</p>\n\n<pre><code>def new\n@adcategory = Adcategory.new\n@adcategories = Adcategory.all\nend\n\ndef edit\n@adcategories = Adcategory.all\nend\n\ndef create\n@adcategory = Adcategory.new(adcategory_params)\n\nrespond_to do |format|\n  if @adcategory.save\n    format.html { redirect_to @adcategory, notice: 'Adcategory was successfully created.' }\n    format.json { render :show, status: :created, location: @adcategory }\n  else\n    format.html { render :new }\n    format.json { render json: @adcategory.errors, status: :unprocessable_entity }\n  end\nend\nend\n\nprivate\n\ndef set_adcategory\n  @adcategory = Adcategory.find(params[:id])\nend\n\n\ndef adcategory_params\n  params.require(:adcategory).permit(:name, :parent_id, :adcategory_id )\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5.1"], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 7069011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AfPIn.jpg?s=128&g=1", "display_name": "ThorTL67", "link": "https://stackoverflow.com/users/7069011/thortl67"}, "is_accepted": false, "score": 0, "last_activity_date": 1516805672, "creation_date": 1516805672, "answer_id": 48425399, "question_id": 48425178, "link": "https://stackoverflow.com/questions/48425178/rails-5-1-4-validation-how-to-accept-blank-attributes-without-saving-them-to-th/48425399#48425399", "title": "Rails 5.1.4 Validation: How to accept blank attributes without saving them to the db?", "body": "<p>What that validation is doing is checking that the :name field has a value (if it does not have a value it will show the error message). </p>\n\n<p>If you wanted to allow a blank value then I'm pretty sure you would just need to remove that validation. If a blank value (ie a string of ' ') is being saved in your database then I would check the 'name' column (in the database) to see if null is allowed.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9026514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92c1e3397d4e4be58d4e69958cf4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Fly", "link": "https://stackoverflow.com/users/9026514/fly"}, "edited": false, "score": 0, "creation_date": 1516871674, "post_id": 48427968, "comment_id": 83869620, "body": "thank you for your answer! I don&#39;t get any errors while saving - my problem is, that I save lot&#39;s of empty fields into the DB and I don&#39;t want that. I want text fields that are nil/blank to be ignored when saving into the DB. Only text fields with content filled in should be saved."}, {"owner": {"reputation": 11, "user_id": 9026514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92c1e3397d4e4be58d4e69958cf4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Fly", "link": "https://stackoverflow.com/users/9026514/fly"}, "edited": false, "score": 0, "creation_date": 1516872355, "post_id": 48427968, "comment_id": 83870029, "body": "I read the official documentation and some other sources - I understand validations in general, I just couldn&#39;t find a solution that says &#39;accept empty fields but don&#39;t save it into the db&#39;"}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "reply_to_user": {"reputation": 11, "user_id": 9026514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92c1e3397d4e4be58d4e69958cf4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Fly", "link": "https://stackoverflow.com/users/9026514/fly"}, "edited": false, "score": 0, "creation_date": 1516878142, "post_id": 48427968, "comment_id": 83873695, "body": "You cannot save fields to a database. You save records. You want to save only part of a record and don\u2019t save the empty fields? This cannot be done.  If the problem is that you don\u2019t want to save records that have an empty field, check for empty fields before saving and don\u2019t save. If you put your controller and view we could help more."}, {"owner": {"reputation": 11, "user_id": 9026514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92c1e3397d4e4be58d4e69958cf4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Fly", "link": "https://stackoverflow.com/users/9026514/fly"}, "edited": false, "score": 0, "creation_date": 1516882314, "post_id": 48427968, "comment_id": 83876366, "body": "could you give me an code example for how to check for empty fields and then don&#39;t save them? since I&#39;m very new to rails I don&#39;t get all my code right at first attempt. my application is a little complex; there are currently 3 text fields where you can enter options and they get saved through an array (each field entry is one new record in the options table). But the user shouldn&#39;t necessarily have to save three options, two would be enough. so there is one text field left that saves a blank to the db when the form gets submitted."}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "reply_to_user": {"reputation": 11, "user_id": 9026514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92c1e3397d4e4be58d4e69958cf4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Fly", "link": "https://stackoverflow.com/users/9026514/fly"}, "edited": false, "score": 0, "creation_date": 1516886738, "post_id": 48427968, "comment_id": 83879286, "body": "Checking an empty field is easy. Just field.blank? will do the job. If your model has many fields you need to check, the empty_fields? method is just field_1.blank? or field_2.blank? or ..... or field_n.blank? Please put all the relevant code if you need more specific help."}, {"owner": {"reputation": 11, "user_id": 9026514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92c1e3397d4e4be58d4e69958cf4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Fly", "link": "https://stackoverflow.com/users/9026514/fly"}, "edited": false, "score": 0, "creation_date": 1516896174, "post_id": 48427968, "comment_id": 83886456, "body": "thank you very much, I will carefully work through your suggestions and see what I get."}], "tags": [], "owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1517073082, "last_edit_date": 1517073082, "creation_date": 1516813487, "answer_id": 48427968, "question_id": 48425178, "link": "https://stackoverflow.com/questions/48425178/rails-5-1-4-validation-how-to-accept-blank-attributes-without-saving-them-to-th/48427968#48427968", "title": "Rails 5.1.4 Validation: How to accept blank attributes without saving them to the db?", "body": "<p>Validations occur when saving to the database. So it is possible to accept empty fields even with your validation. But you must provide a value before saving. If you are getting an error it\u2019s because your application is trying to save the record. So your code is not doing what you say (accepting empty fields without saving). You are saving. </p>\n\n<p>The question is. Which line of code raises the error? Check your logs. </p>\n\n<p>Validations are explained here: <a href=\"http://guides.rubyonrails.org/v2.3.11/activerecord_validations_callbacks.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/v2.3.11/activerecord_validations_callbacks.html</a> (or any other version)</p>\n\n<p><strong>Edit 1</strong></p>\n\n<p>If you want to prevent this record from saving, but don\u2019t inform the user, you could define a method save_unless_empty</p>\n\n<pre><code>def save_unless_empty\n  if empty_fields? and new_record?\n    delete\n  else\n    save\n  end \nend\n</code></pre>\n\n<p>You must define the empty_fields? method so that you check the fields you need.</p>\n\n<p><strong>Edit 2</strong></p>\n\n<p>Thanks for adding the code. I see you are creating many options in the OptionsController#Create. This method is supposed to create only one option. You should create or update many options in VotingsController#create (or #update), given that all options belong to a voting object.</p>\n\n<p>Another issue: You are building a new option object in the form (@voting.options.build), but you are not using it (you should use fields_for :option, @voting.options.build do.... This could be inside the 3.times loop. Even better, this can be done in the controller, before showing the view</p>\n\n<p>And another one. Your validation regarding at least 2 options should be in the Voting model.</p>\n\n<p>Some refactoring (although a lot is still missing):</p>\n\n<p>In the view</p>\n\n<pre><code>&lt;%= form_with @voting do |form| %&gt;\n  &lt;%= form.label :vote %&gt;&lt;br&gt;\n  &lt;% @options.each do |option| %&gt;\n    &lt;%= form.fields_for option do |form_opt| %&gt;\n      &lt;%= form_opt.input_field :vote %&gt;&lt;br&gt;&lt;br&gt; #question: is vote really the name of the attribute in the option model? or should this be a check_box showing the option name?\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n  &lt;%= form.submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Then you should put the saving logic in VotingsController:</p>\n\n<pre><code>class VotingsController &lt; ApplicationController\n\n  def new\n    @voting = Voting.new\n    3.times do \n      @voting.options.build\n    end\n    @options = @voting.options\n  end\n\n  def edit\n    @voting = Voting.find_by(id: params[:id])\n    @options = @voting.options\n  end\n\n  def create\n    @voting = Voting.create_without_null_options(voting_params)\n    #etc\n  end\n\n  def edit\n    @voting = Voting.find_by(id: params[:id])\n    @voting.update_without_null_options(voting_params)\n    #etc\n  end\n\n  private\n    def voting_params\n      ...\n    end\n  end\n</code></pre>\n\n<p>In the Voting Model</p>\n\n<pre><code>def self.create_without_null_options params\n  #Create the voting without its options\n  @voting = Voting.create(params.except[:options_attributes])\n\n  #create options but save only non empty options\n  params[:options_attributes].each do |option_att|\n    @option = @voting.options.build(option_att)\n    @option.save_unless_empty\n  end\nend\n\ndef update_without_null_options params\n  #Save the voting without its options\n  update_attributes(params.except[:options_attributes])\n\n  #create options but save only non empty options\n  params[:options_attributes].each do |option_att|\n    @option = options.build(option_att)\n    @option.save_unless_empty\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 446, "user_id": 1397028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f3276d4e8c2092c45eb93f62263bc639?s=128&d=identicon&r=PG", "display_name": "rantingsonrails", "link": "https://stackoverflow.com/users/1397028/rantingsonrails"}, "is_accepted": false, "score": 0, "last_activity_date": 1516906131, "creation_date": 1516906131, "answer_id": 48449904, "question_id": 48425178, "link": "https://stackoverflow.com/questions/48425178/rails-5-1-4-validation-how-to-accept-blank-attributes-without-saving-them-to-th/48449904#48449904", "title": "Rails 5.1.4 Validation: How to accept blank attributes without saving them to the db?", "body": "<p>There is no such thing as saving specific database fields. An entire record is stored/received.</p>\n\n<p>If the name field is not required, remove the <code>validates :name, presence: true</code> on the model.</p>\n\n<p>If there's a default value that you want in your database instead of nil/\"\", you can set it in the migration; for example a single space</p>\n\n<pre><code>add_column :name, :string, :default =&gt; \" \"\n</code></pre>\n\n<p>If you need to preserve those records and modify that database column, you can use <code>change_column</code> in a new migration</p>\n\n<pre><code>change_column :users, :name, :string, :default =&gt; \" \"\n</code></pre>\n\n<p>I used users as an example table name, because from your code above I could not understand which table the name column was on.</p>\n"}], "owner": {"reputation": 11, "user_id": 9026514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92c1e3397d4e4be58d4e69958cf4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Fly", "link": "https://stackoverflow.com/users/9026514/fly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1033, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1517073082, "creation_date": 1516805065, "last_edit_date": 1516887487, "question_id": 48425178, "link": "https://stackoverflow.com/questions/48425178/rails-5-1-4-validation-how-to-accept-blank-attributes-without-saving-them-to-th", "title": "Rails 5.1.4 Validation: How to accept blank attributes without saving them to the db?", "body": "<p>I'm pretty new to Rails and I couldn't find a solution to this problem (I hope I haven't missed something obvious).</p>\n\n<p>how can I make my application accept blank fields, but not saving the empty value to the db?</p>\n\n<p>I mean, if I do </p>\n\n<pre><code>validates :name, presence: true\n</code></pre>\n\n<p>I will get an error message, that name can't be blank.\nBut I just want it to ignore blank/nil with not saving it into db.</p>\n\n<p>How would I do that?\n(I hope asked that question comprehensible, tell me if not)</p>\n\n<p><strong>Update:</strong></p>\n\n<p>ok, so here is my code:</p>\n\n<p>Models:</p>\n\n<pre><code>class Voting &lt; ApplicationRecord\n  has_many :options\n  accepts_nested_attributes_for :options\n  validates :content, presence: true    \nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>class Option &lt; ApplicationRecord\n  belongs_to :voting\n  validates_associated :voting\n\n  validates :vote, presence: { message: \"at least two Options required.\" }, if: :option_counter\n\n  def option_counter\n      voting.options.count &lt; 2\n  end    \nend\n</code></pre>\n\n<p>OptionsController:</p>\n\n<pre><code>class OptionsController &lt; ApplicationController\n  def index\n    @voting  = Voting.find(params[:voting_id])\n    @options = @voting.options\n  end\n\n  def create\n    @voting = Voting.find(params[:voting_id])\n    @option = @voting.options\n    @option.create(option_params)\n    if @voting.valid?\n      flash[:notice] = \"Voting created!\"\n      redirect_to voting_options_path\n    else\n      render 'votings/show'\n    end\n\n  end\n\n  private\n  def option_params\n    ...\n  end\nend\n</code></pre>\n\n<p>Views: votings/show.html.erb</p>\n\n<pre><code>&lt;strong&gt;Your Voting:&lt;/strong&gt;\n&lt;p&gt;&lt;%= @voting.content %&gt;&lt;/p&gt;\n\n&lt;% if @voting.errors.any? %&gt;\n    &lt;div&gt;\n        &lt;% @voting.errors.full_messages.each do |msg| %&gt;\n            &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n        &lt;% end %&gt;\n    &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;ul&gt;\n  &lt;%= form_with(model: [ @voting, @voting.options.build ], local: true) do |form| %&gt;\n      &lt;p&gt;\n        &lt;%= form.label :vote %&gt;&lt;br&gt;\n        &lt;% 3.times do %&gt;\n          &lt;input type=\"string\" name=\"option[][vote]\" /&gt;&lt;br&gt;&lt;br&gt;\n        &lt;% end %&gt;\n      &lt;/p&gt;\n      &lt;p&gt;\n        &lt;%= form.submit %&gt;\n      &lt;/p&gt;\n\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>I think, this should be the interesting stuff. I hope it helps to understand the situation.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "edited": false, "score": 1, "creation_date": 1516805668, "post_id": 48424865, "comment_id": 83840427, "body": "Can you describe more details about what actually you want to validate?"}, {"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "reply_to_user": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "edited": false, "score": 0, "creation_date": 1516806064, "post_id": 48424865, "comment_id": 83840760, "body": "@Tai sure. I updated the Question. The main question is , though is it possible to validate the way I did or do I have to write custom validation methods? Thank You :-)"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1516806328, "post_id": 48424865, "comment_id": 83840958, "body": "you&#39;ll have to do custom validators"}, {"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1516806436, "post_id": 48424865, "comment_id": 83841048, "body": "@Anthony Shit, I thought so ;-) Would have been to good to be true if it would work the way I wrote it above"}], "answers": [{"comments": [{"owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1516812035, "post_id": 48426377, "comment_id": 83845238, "body": "Have you tried it? Which Rails version are you using?"}, {"owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1516813802, "post_id": 48426377, "comment_id": 83846425, "body": "Yes, I tried. Rails 5.0.0. Validate it in Rails console."}, {"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 0, "creation_date": 1516887595, "post_id": 48426377, "comment_id": 83879846, "body": "Hey thanks for the effort but this is not working. When testing the model with unit tests and and setting up a valid instance of the model, the test fails."}, {"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 0, "creation_date": 1516887679, "post_id": 48426377, "comment_id": 83879901, "body": "@Anthony was right. When comparing data fielsd with each other inside validations you need to write custom validators."}], "tags": [], "owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "is_accepted": true, "score": 1, "last_activity_date": 1516808706, "creation_date": 1516808706, "answer_id": 48426377, "question_id": 48424865, "link": "https://stackoverflow.com/questions/48424865/comparing-database-fields-columns-with-each-other-inside-validations-in-ruby-on/48426377#48426377", "title": "Comparing database fields/columns with each other inside validations in Ruby on Rails", "body": "<p>You can do it using Rail's built-in validations. Try below code:</p>\n\n<pre><code>class DiabetesSetting &lt; ApplicationRecord\n  ...\n  validates_numericality_of :bs_min,    { less_than: :bs_max }\n  validates_numericality_of :bs_max,    { greater_than: :bs_min }\n  validates_numericality_of :bs_target, { less_than: :bs_max }\nend\n</code></pre>\n\n<p>Refer to following link for numerical validation: <a href=\"http://api.rubyonrails.org/classes/ActiveModel/Validations/HelperMethods.html#method-i-validates_numericality_of\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/classes/ActiveModel/Validations/HelperMethods.html#method-i-validates_numericality_of</a></p>\n"}], "owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 48426377, "answer_count": 1, "score": 1, "last_activity_date": 1516808706, "creation_date": 1516804157, "last_edit_date": 1516805964, "question_id": 48424865, "link": "https://stackoverflow.com/questions/48424865/comparing-database-fields-columns-with-each-other-inside-validations-in-ruby-on", "title": "Comparing database fields/columns with each other inside validations in Ruby on Rails", "body": "<p>I have the following model in Rails which manages a Diabetes Settings table:</p>\n\n<pre><code>class DiabetesSetting &lt; ApplicationRecord\n    belongs_to :user\n\n    validates :bs_min, :bs_max, :bs_target, :correction_number, numericality: { only_integer: true }\n    validates :correction_insulin, numericality: true\n    validates :bs_min {less_than: :bs_max }\n    validates :bs_max {greater_than: :bs_min}\n    validates :bs_target {less_than: :bs_max}\n\nend\n</code></pre>\n\n<p>My Question: Is something like this, to compare the fields of a database  with each other to validate, that when a new setting is created, one value is higher or lower than the other, possible in Rails or do I have to write custom validation methods for this? </p>\n\n<p>To clarify: bs_min is the mimmum value of a numerical range and bs_max the max value of a numerical range. They are both attributes inside the diabetes settings model. \nThe Question is if I can compare these values like I did or if I have to write custom methods to validate</p>\n\n<p>Thanks in advance for Your help</p>\n"}, {"tags": ["ruby", "sinatra", "frontend"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516804395, "post_id": 48424851, "comment_id": 83839463, "body": "In Ruby it&#39;s conventional to omit empty argument lists, so <code>abc()</code> should be <code>abc</code> both when defined and when called. Additionally, <code>begin</code> / <code>end</code> serve no purpose inside that method."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516804499, "post_id": 48424851, "comment_id": 83839548, "body": "If this is within Rails, where does that <code>abc</code> method get defined? If it&#39;s within a controller you&#39;ll need to flag it as a <code>helper_method</code>. If it&#39;s within a helper you may need to import it into the controller first."}, {"owner": {"reputation": 11666, "user_id": 614141, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/d8f8l.png?s=128&g=1", "display_name": "javing", "link": "https://stackoverflow.com/users/614141/javing"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516804996, "post_id": 48424851, "comment_id": 83839948, "body": "@tadman I am not sure I am a bit confused. Maybe there is no rails in here. How can i know if this is rails? I don&#39;t thing it&#39;s Rails I can&#39;t find the word rails anywhere in the project."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516805039, "post_id": 48424851, "comment_id": 83839979, "body": "I&#39;m just asking because you tagged this as Rails, but if it&#39;s just a regular Ruby project then you&#39;ll need to add the part where you call the <code>ERB</code> method to render things."}, {"owner": {"reputation": 11666, "user_id": 614141, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/d8f8l.png?s=128&g=1", "display_name": "javing", "link": "https://stackoverflow.com/users/614141/javing"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516805677, "post_id": 48424851, "comment_id": 83840435, "body": "@tadman I am trying this now <code>Hello &lt;% helper_method abc %&gt;</code> but it&#39;s throwing me an error saying: <code>undefined method </code>helper_method&#39; for #&lt;Sinatra::Application:0x00007fe3c6390268&gt;`"}, {"owner": {"reputation": 11666, "user_id": 614141, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/d8f8l.png?s=128&g=1", "display_name": "javing", "link": "https://stackoverflow.com/users/614141/javing"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516806002, "post_id": 48424851, "comment_id": 83840692, "body": "Also I tried adding <code>helper_method :abc</code> in the .rb file but that also tells me <code>undefined method </code>helper_method&#39; for #&lt;Sinatra::Application:0x00007fe3c6390268&gt;`"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516813881, "post_id": 48424851, "comment_id": 83846481, "body": "If this is Sinatra then <code>helper_method</code> doesn&#39;t apply, as that&#39;s for Rails."}], "answers": [{"tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": false, "score": 3, "last_activity_date": 1516809969, "last_edit_date": 1516809969, "creation_date": 1516808336, "answer_id": 48426248, "question_id": 48424851, "link": "https://stackoverflow.com/questions/48424851/how-to-render-a-value-from-an-rb-file-into-an-erb-file/48426248#48426248", "title": "How to render a value from an .rb file into an .erb file", "body": "<p>In Sinatra, register your method as a helper in .rb file:</p>\n\n<pre><code>helpers do \n  def abc\n    \"aaaaa\"\n  end \nend\n</code></pre>\n\n<p>Omit parentheses if your methods don't need arguments. Also, <code>begin/end</code> block isn't necessary here. \nYou can call your helper in .erb template:</p>\n\n<p><code>&lt;%= abc %&gt;</code> </p>\n\n<p>Don't forget <code>=</code> in the opening tag.</p>\n\n<p><a href=\"http://sinatrarb.com/intro.html\" rel=\"nofollow noreferrer\">http://sinatrarb.com/intro.html</a> section 'Helpers'.</p>\n"}, {"tags": [], "owner": {"reputation": 3249, "user_id": 1279355, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac7a44c55973edf3381ce916ee8eb100?s=128&d=identicon&r=PG", "display_name": "Sir l33tname", "link": "https://stackoverflow.com/users/1279355/sir-l33tname"}, "is_accepted": false, "score": 2, "last_activity_date": 1517227149, "creation_date": 1517227149, "answer_id": 48500761, "question_id": 48424851, "link": "https://stackoverflow.com/questions/48424851/how-to-render-a-value-from-an-rb-file-into-an-erb-file/48500761#48500761", "title": "How to render a value from an .rb file into an .erb file", "body": "<p>It's unclear what you want to achieve. But If you just want some text in your erb you can do something like this:</p>\n\n<pre><code>erb :myerb, locals: {text: \"aaaaa\", saved: false}\n</code></pre>\n\n<p>myerb.erb</p>\n\n<pre><code>&lt;% if saved %&gt;\n  Hello &lt;%= text %&gt;\n&lt;% endif %&gt;\n</code></pre>\n\n<p>This would also work for functions. </p>\n"}, {"tags": [], "owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "is_accepted": false, "score": 2, "last_activity_date": 1518109361, "creation_date": 1518109361, "answer_id": 48690958, "question_id": 48424851, "link": "https://stackoverflow.com/questions/48424851/how-to-render-a-value-from-an-rb-file-into-an-erb-file/48690958#48690958", "title": "How to render a value from an .rb file into an .erb file", "body": "<p>First of all, you need to be aware that a defined method inherently includes the functionality of a begin/end block so you don\u00b4t need to put them again. Assuming you are using sinatra, here is what I think you need:</p>\n\n<p>my.rb</p>\n\n<pre><code>require 'sinatra'\n\ndef abc\n  \"aaaa\"\nend\n\nget '/' do\n  erb :my, locals: {variable: abc}\nend\n</code></pre>\n\n<p>my.erb</p>\n\n<pre><code>&lt;html&gt;\n  &lt;body&gt;\n    &lt;p&gt;\n       Hello &lt;%= variable %&gt;\n    &lt;/p&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Run ruby my.rb and then open <a href=\"http://localhost:4567/\" rel=\"nofollow noreferrer\">http://localhost:4567/</a></p>\n"}], "owner": {"reputation": 11666, "user_id": 614141, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/d8f8l.png?s=128&g=1", "display_name": "javing", "link": "https://stackoverflow.com/users/614141/javing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1518109361, "creation_date": 1516804109, "last_edit_date": 1516809299, "question_id": 48424851, "link": "https://stackoverflow.com/questions/48424851/how-to-render-a-value-from-an-rb-file-into-an-erb-file", "title": "How to render a value from an .rb file into an .erb file", "body": "<p>I don't have much experience with Ruby all I wan't to do is render a value that I declare in an .rb file in an .erb file.</p>\n\n<p>In my .rb file I have this:</p>\n\n<pre><code>def abc()\n  begin\n     \"aaaaa\"\n  end\nend\n</code></pre>\n\n<p>In my .erb file I have this:</p>\n\n<pre><code>Hello &lt;% abc %&gt;\n</code></pre>\n\n<p>When I run the app I only see:</p>\n\n<blockquote>\n  <p>Hello</p>\n</blockquote>\n\n<p>But I expect to see:</p>\n\n<blockquote>\n  <p>Hello aaaa</p>\n</blockquote>\n\n<p>Anybody can give me a hand, I don't really know ruby at all. Also I have no idea if this is ruby or ruby on rails so sorry if the tag below is wrong.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516802811, "post_id": 48424326, "comment_id": 83838285, "body": "So to clarify, for example, if the record was the <i>third to be created</i> then <code>user.id_2 == 3</code>?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516802863, "post_id": 48424326, "comment_id": 83838322, "body": "Why do you need this? What is the real problem you&#39;re trying to solve? I suspect this could be an XY question."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516803147, "post_id": 48424326, "comment_id": 83838525, "body": "If I understand correctly, a more efficient query would be: <code>User.where(&#39;created_at &lt;= ?&#39;, created_at).count</code>. However, this is <i>not reliable</i> since there is no guarantee that the <code>created_at</code> values are unique - therefore the <code>id_2</code> may not be well-defined."}, {"owner": {"reputation": 599, "user_id": 5903989, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d4364dc9b6676df2c8f37c0c05d3d910?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/5903989/simon"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516803448, "post_id": 48424326, "comment_id": 83838722, "body": "@TomLord yes, I updated the question accordingly. I agree with the non-reliability of your previous comment, but I believe there must be a more straightforward way."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516804162, "post_id": 48424326, "comment_id": 83839282, "body": "My way <i>is</i> a little more straightforward, since the query is being performed in pure SQL rather than loading all records into memory, then querying in ruby. This will trigger a command like: <code>SELECT COUNT(*) FROM users WHERE (created_at &lt;= &#39;......&#39;)</code>. But again, I ask: Why are you doing this? What problem are you trying to solve? Are you asking the wrong question?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516804308, "post_id": 48424326, "comment_id": 83839397, "body": "<b>Maybe</b> you could add a new database column (as suggested below), but if the column values being compared against can <i>change</i>, then this will do more harm than good. I&#39;d need more information to provide any more of an answer."}, {"owner": {"reputation": 599, "user_id": 5903989, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d4364dc9b6676df2c8f37c0c05d3d910?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/5903989/simon"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516805273, "post_id": 48424326, "comment_id": 83840157, "body": "@TomLord updated question again. I have to send some data in a table with their consecutive numbering. I just wanted to ask about a possible more efficient approach to this, otherwise I just leave the code as it is."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516805900, "post_id": 48424326, "comment_id": 83840606, "body": "Your update still doesn&#39;t really explain what you&#39;re trying to do. Loop through <i>all</i> records, in order of <code>created_at</code>, and forward that data? Lookup specific records, according to their &quot;<code>created_at</code>-position&quot;? Doesn&#39;t the <code>id</code> column <i>pretty much</i> provide this information already, or is the issue that some records have been deleted?"}, {"owner": {"reputation": 599, "user_id": 5903989, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d4364dc9b6676df2c8f37c0c05d3d910?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/5903989/simon"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516806391, "post_id": 48424326, "comment_id": 83841009, "body": "@TomLord I would use the <code>id</code> column, but the value must be consecutive, also when records are deleted. Records are looked up (i.e. to retrieve a subset of them)"}, {"owner": {"reputation": 599, "user_id": 5903989, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d4364dc9b6676df2c8f37c0c05d3d910?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/5903989/simon"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516807094, "post_id": 48424326, "comment_id": 83841536, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/163807/discussion-between-simon-and-tom-lord\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 599, "user_id": 5903989, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d4364dc9b6676df2c8f37c0c05d3d910?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/5903989/simon"}, "edited": false, "score": 0, "creation_date": 1516803672, "post_id": 48424517, "comment_id": 83838886, "body": "What if I delete records? Does <code>auto_increment</code> imply that the indexes are recalculated after that, in order to match the <code>1..n</code> condition?"}, {"owner": {"reputation": 745, "user_id": 3033467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a33988a3dc0d009236304ff4ad8d615?s=128&d=identicon&r=PG&f=1", "display_name": "user3033467", "link": "https://stackoverflow.com/users/3033467/user3033467"}, "reply_to_user": {"reputation": 599, "user_id": 5903989, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d4364dc9b6676df2c8f37c0c05d3d910?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/5903989/simon"}, "edited": false, "score": 0, "creation_date": 1516804767, "post_id": 48424517, "comment_id": 83839775, "body": "I misundertood what you wanted. No, it would not be recalculated"}], "tags": [], "owner": {"reputation": 745, "user_id": 3033467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a33988a3dc0d009236304ff4ad8d615?s=128&d=identicon&r=PG&f=1", "display_name": "user3033467", "link": "https://stackoverflow.com/users/3033467/user3033467"}, "is_accepted": false, "score": 0, "last_activity_date": 1516803129, "creation_date": 1516803129, "answer_id": 48424517, "question_id": 48424326, "link": "https://stackoverflow.com/questions/48424326/consecutive-numbered-values-to-records-in-ruby-on-rails-according-to-sort-by-cre/48424517#48424517", "title": "Consecutive numbered values to records in Ruby on Rails according to sort by created_at", "body": "<p>If your database supports it, you probably should simply set you column to auto_increment</p>\n\n<pre><code>add_column :table_name, :id_2, :integer, auto_increment: true\n</code></pre>\n"}], "owner": {"reputation": 599, "user_id": 5903989, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d4364dc9b6676df2c8f37c0c05d3d910?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/5903989/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516804901, "creation_date": 1516802532, "last_edit_date": 1516804901, "question_id": 48424326, "link": "https://stackoverflow.com/questions/48424326/consecutive-numbered-values-to-records-in-ruby-on-rails-according-to-sort-by-cre", "title": "Consecutive numbered values to records in Ruby on Rails according to sort by created_at", "body": "<p>For a project my company is involved in, I need to forward some data according to their <strong><em>consecutive</em></strong> numbering according to their creation date(time). Some data is already stored.</p>\n\n<p>The only way I found up to now is to set a similar value as the <code>id</code> column for a model in Ruby on Rails. These values are consecutive starting from 1 (to <code>n</code>, with <code>n</code> being the number of records in the table), according to the values of another column.\nI don't want to override the default <code>id</code> column, of course.</p>\n\n<p>I just came up with the following code:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n...\ndef id_2\n  User.all.order(:created_at).index(self) + 1\nend\n</code></pre>\n\n<p>But I sense that there can be some better way to this approach, even database-oriented.</p>\n\n<p>Is there a more efficient implementation for this, instead of calling the whole contents of the table, as per the code?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23463, "user_id": 4379151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kOLJQ.jpg?s=128&g=1", "display_name": "Erik Kalkoken", "link": "https://stackoverflow.com/users/4379151/erik-kalkoken"}, "edited": false, "score": 1, "creation_date": 1516819388, "post_id": 48424150, "comment_id": 83849648, "body": "Try modulo, e.g. <code>wday % 7</code>"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 3565039, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/00ace7a5f68deedbaeb8cd5b21352537?s=128&d=identicon&r=PG&f=1", "display_name": "user3565039", "link": "https://stackoverflow.com/users/3565039/user3565039"}, "edited": false, "score": 0, "creation_date": 1516802754, "post_id": 48424226, "comment_id": 83838245, "body": "I need to use max_day_number = 7 for my example but that&#39;s perfect. I have not heard of modulo before - thanks - you have saved me a ton of time,"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 123, "user_id": 3565039, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/00ace7a5f68deedbaeb8cd5b21352537?s=128&d=identicon&r=PG&f=1", "display_name": "user3565039", "link": "https://stackoverflow.com/users/3565039/user3565039"}, "edited": false, "score": 0, "creation_date": 1516802920, "post_id": 48424226, "comment_id": 83838374, "body": "@user3565039 Why do you need max_day_number to be seven?"}, {"owner": {"reputation": 123, "user_id": 3565039, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/00ace7a5f68deedbaeb8cd5b21352537?s=128&d=identicon&r=PG&f=1", "display_name": "user3565039", "link": "https://stackoverflow.com/users/3565039/user3565039"}, "edited": false, "score": 0, "creation_date": 1516803052, "post_id": 48424226, "comment_id": 83838456, "body": "Because I want next_day(6) # =&gt; 0 not next_day(6) # =&gt; 1"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 123, "user_id": 3565039, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/00ace7a5f68deedbaeb8cd5b21352537?s=128&d=identicon&r=PG&f=1", "display_name": "user3565039", "link": "https://stackoverflow.com/users/3565039/user3565039"}, "edited": false, "score": 0, "creation_date": 1516803156, "post_id": 48424226, "comment_id": 83838534, "body": "@user3565039: ah! I messed up my snippet when editing. Thanks for noticing :)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1516808606, "post_id": 48424226, "comment_id": 83842721, "body": "The limit (<code>max_day_number</code>) is the number of days in a week, i.e. 7. It won&#39;t change :-)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1516810329, "post_id": 48424226, "comment_id": 83844018, "body": "@Stefan: classic case of &quot;off by 1&quot; error on my side :)"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1516803136, "last_edit_date": 1516803136, "creation_date": 1516802219, "answer_id": 48424226, "question_id": 48424150, "link": "https://stackoverflow.com/questions/48424150/incrementing-wday-in-rails/48424226#48424226", "title": "Incrementing wday in rails", "body": "<p>Use this weird little trick, the <a href=\"https://stackoverflow.com/q/3517238/125816\">modulo operator</a>:</p>\n\n<pre><code>def next_day(cur_day)\n  max_day_number = 7\n  (cur_day + 1) % max_day_number\nend\n\nnext_day(4) # =&gt; 5\nnext_day(5) # =&gt; 6\nnext_day(6) # =&gt; 0\n</code></pre>\n\n<p>It ensures that if value were to exceed the limit (<code>max_day_number</code>), it would instead just wrap around to 0 and start over.</p>\n"}], "owner": {"reputation": 123, "user_id": 3565039, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/00ace7a5f68deedbaeb8cd5b21352537?s=128&d=identicon&r=PG&f=1", "display_name": "user3565039", "link": "https://stackoverflow.com/users/3565039/user3565039"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "closed_date": 1516819850, "accepted_answer_id": 48424226, "answer_count": 1, "score": -2, "last_activity_date": 1516803136, "creation_date": 1516801940, "last_edit_date": 1516802732, "question_id": 48424150, "link": "https://stackoverflow.com/questions/48424150/incrementing-wday-in-rails", "closed_reason": "Needs details or clarity", "title": "Incrementing wday in rails", "body": "<p>I am dealing with week days (wday) in rails. i.e. the numbers 0,1,2,3,4,5,6</p>\n\n<p>Not dates, just days of the week.</p>\n\n<p>I need to translate Friday,Saturday,Sunday [4,5,6] into Saturday,Sunday,Monday [5,6,0]. If I just add 1 then I end up with [5,6,7] which is no good as day 7 does not exist. I need to wrap around the week end.</p>\n\n<p>Is there a simple way to do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "debugging", "visual-studio-code", "puma"], "comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 2, "creation_date": 1516800431, "post_id": 48423321, "comment_id": 83836671, "body": "When I was using Puma Dev I used <a href=\"https://github.com/Mon-Ouie/pry-remote\" rel=\"nofollow noreferrer\">Pry Remote</a> to debug. I&#39;m not sure how VSCode debugger works and if the two will play hand in hand (i.e. if you can use VSCode debugger from within Pry). Hopefully that either helps or steers you in some direction. You&#39;ve tagged Rails here - but if you could add a little more info on your setup to the question (and where VB comes into play), that&#39;d be dead handy :)"}], "owner": {"reputation": 1166, "user_id": 882223, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd45c3d279959bed4fc7ff575c7c885e?s=128&d=identicon&r=PG", "display_name": "Aref Aslani", "link": "https://stackoverflow.com/users/882223/aref-aslani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 948, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1516799419, "creation_date": 1516799419, "question_id": 48423321, "link": "https://stackoverflow.com/questions/48423321/how-to-debug-rails-apps-with-puma-dev-and-vscode", "title": "How to debug Rails apps with Puma Dev and VSCode", "body": "<p>I use <a href=\"https://github.com/puma/puma-dev\" rel=\"nofollow noreferrer\">Puma dev</a> as my dev server. How should I setup VSCode debugger with Puma Dev remote debug?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1516799099, "post_id": 48423100, "comment_id": 83835787, "body": "Add a validation for the field, then Rails will not do the insert"}], "answers": [{"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1516982877, "post_id": 48423243, "comment_id": 83923550, "body": "@kase - did this do the job for you?"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 3, "last_activity_date": 1516799112, "creation_date": 1516799112, "answer_id": 48423243, "question_id": 48423100, "link": "https://stackoverflow.com/questions/48423100/ruby-on-rails-create-with-wrong-data-type-it-will-change-to-0-automatically/48423243#48423243", "title": "Ruby on rails - create with wrong data type, it will change to 0 automatically", "body": "<p>If I'm reading this right, you'll just need to validate numericality in the relevant models. Read the docs for more info <a href=\"http://guides.rubyonrails.org/active_record_validations.html#numericality\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>So add:</p>\n\n<pre><code>class Group &lt; ApplicationRecord\n  ...\n  validates :status, numericality: { only_integer: true, allow_nil: true }\n  ...\nend\n\nclass User &lt; ApplicationRecord\n  ...\n  validates :status, numericality: { only_integer: true, allow_nil: true }\n  ...\nend\n</code></pre>\n\n<p>This will provide an error if the data type is incorrect, which you can handle as you've discussed.</p>\n\n<p>Hope that helps - let me know if you've any questions!</p>\n"}], "owner": {"reputation": 59, "user_id": 9133350, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/28f9f514983df63ae9f79e416647b268?s=128&d=identicon&r=PG&f=1", "display_name": "Kase", "link": "https://stackoverflow.com/users/9133350/kase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1516821838, "answer_count": 1, "score": 0, "last_activity_date": 1516799112, "creation_date": 1516798677, "question_id": 48423100, "link": "https://stackoverflow.com/questions/48423100/ruby-on-rails-create-with-wrong-data-type-it-will-change-to-0-automatically", "closed_reason": "Needs details or clarity", "title": "Ruby on rails - create with wrong data type, it will change to 0 automatically", "body": "<p><strong>Database</strong><br/>\ngroup-name = varchar<br/>\ngroup-status = int<br/>\nuser-name varchar<br/>\nuser-status = int</p>\n\n<p><strong>Normal POST Case</strong> (It is work perfectly.)<br/>\ngroup-name = \"Group Name\"<br/>\ngroup-status = 1<br/>\nuser-name \"Name\"<br/>\nuser-status = 0<br/></p>\n\n<p><strong>Special POST Case</strong> (It will change the wrong data type value to 0.)<br/>\ngroup-name = \"Group Name\"<br/>\ngroup-status = \"BBB\"<br/>\nuser-name \"Name\"<br/>\nuser-status = \"AAA\"<br/><br/>\nIt is because i want to get the \"AAA\" and \"BBB\" to handle the error by myself using rollback.</p>\n\n<hr/>\n\n<pre><code>Group.transaction do\n    group = Group.create(\n        name: params[\"group-name\"],\n        status: params[\"group-status\"]\n    )\n    user = User.create(\n        name: params[\"user-name\"],\n        status: params[\"user-status\"]\n    )\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml"], "comments": [{"owner": {"reputation": 766, "user_id": 1488591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4373e8b5ebf359cb601120389378406a?s=128&d=identicon&r=PG", "display_name": "kunashir", "link": "https://stackoverflow.com/users/1488591/kunashir"}, "edited": false, "score": 0, "creation_date": 1516794567, "post_id": 48421579, "comment_id": 83832954, "body": "Why are you not using rake task which will be started by cron. You can use gem &#39;whenever&#39; what this."}, {"owner": {"reputation": 29, "user_id": 7111093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b8363e10260b44b39ca23e5b72baddd?s=128&d=identicon&r=PG&f=1", "display_name": "Ins0maniac", "link": "https://stackoverflow.com/users/7111093/ins0maniac"}, "reply_to_user": {"reputation": 766, "user_id": 1488591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4373e8b5ebf359cb601120389378406a?s=128&d=identicon&r=PG", "display_name": "kunashir", "link": "https://stackoverflow.com/users/1488591/kunashir"}, "edited": false, "score": 0, "creation_date": 1516794852, "post_id": 48421579, "comment_id": 83833119, "body": "Yeah I&#39;ll try to use it but i need to compare movies anyway."}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 6662037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ca0c2c1656a101d57c981b1b25a32fe?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Khare", "link": "https://stackoverflow.com/users/6662037/abhinav-khare"}, "is_accepted": true, "score": 1, "last_activity_date": 1516795062, "creation_date": 1516795062, "answer_id": 48421935, "question_id": 48421579, "link": "https://stackoverflow.com/questions/48421579/ruby-on-rails-loop-using-api/48421935#48421935", "title": "Ruby on rails loop- using API", "body": "<p>here is one way...</p>\n\n<pre><code>    require 'open-uri'\n\n  @doc=Nokogiri::XML(open(\"http://www.kinoballada.info/repertuar/export/small/dzien/xml\"))\n    movie_array = []\n    @doc.css('dzien').each do |node|\n    children=node.children\n    movie_array &lt;&lt; children.css('tytul').inner_text\n    Movie.find_or_create_by(\n    :name =&gt; children.css('tytul').inner_text\n    )\n    end\n    movies_to_delete = Movie.where.not(name: movie_array)\n    movies_to_delete.destroy_all\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 7111093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b8363e10260b44b39ca23e5b72baddd?s=128&d=identicon&r=PG&f=1", "display_name": "Ins0maniac", "link": "https://stackoverflow.com/users/7111093/ins0maniac"}, "is_accepted": false, "score": 0, "last_activity_date": 1516796194, "creation_date": 1516796194, "answer_id": 48422283, "question_id": 48421579, "link": "https://stackoverflow.com/questions/48421579/ruby-on-rails-loop-using-api/48422283#48422283", "title": "Ruby on rails loop- using API", "body": "<p>Also- am I thinking right that my schedule.rb file when using Cron should look like that?</p>\n\n<pre><code>every 1.day, at '0:00' do\nrunner \"db:seeds\"\n</code></pre>\n\n<p>Simple as that?</p>\n"}], "owner": {"reputation": 29, "user_id": 7111093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b8363e10260b44b39ca23e5b72baddd?s=128&d=identicon&r=PG&f=1", "display_name": "Ins0maniac", "link": "https://stackoverflow.com/users/7111093/ins0maniac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 48421935, "answer_count": 2, "score": -2, "last_activity_date": 1516796194, "creation_date": 1516793820, "question_id": 48421579, "link": "https://stackoverflow.com/questions/48421579/ruby-on-rails-loop-using-api", "title": "Ruby on rails loop- using API", "body": "<p>I'm working on an app which works around API from one of the cinemas. So I'm using XML file from them which is updated every day (just a list of movies with simple details). I'm getting the data using Nokogiri (I'll probably need Cron so it will parse every day automatically) this way:</p>\n\n<pre><code>require 'open-uri'\n\n@doc=Nokogiri::XML(open(\"http://www.kinoballada.info/repertuar/export/small/dzien/xml\"))\n@doc.css('dzien').each do |node|\n    children=node.children\nMovie.create(\n    :name =&gt; children.css('tytul').inner_text\n)\n</code></pre>\n\n<p>dzien=day</p>\n\n<p>tytul=title </p>\n\n<p>Every day it should check the database.\nIf title is in database and in XML it does nothing. \nIf title is in database and not in XML it should delete this title from database.\nIf title is not in database and in XML it works creates new title in database.</p>\n\n<p>In simple words- the database contains the same titles as XML file.</p>\n\n<p>The problem is- I got no experience with Ruby or Rails and do not know how to use a loop and I need it for tomorrow so no time to catch up. Can anyone help me with the loop?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1516798164, "post_id": 48419920, "comment_id": 83835167, "body": "<i>&quot;I can&#39;t modify an initialized variable placed outside a block&quot;</i> - Huh? You <b>can</b> and you successfully <b>do</b>. With the <code>max_length</code> variable, that is. You just forgot to initialize <code>max_word</code> outside as well."}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 5, "last_activity_date": 1516790087, "last_edit_date": 1516790087, "creation_date": 1516789750, "answer_id": 48420197, "question_id": 48419920, "link": "https://stackoverflow.com/questions/48419920/replacing-a-variable-using-each-ruby/48420197#48420197", "title": "replacing a variable using .each ruby", "body": "<p>First of all, note that the easiest way to do this would be:</p>\n\n<pre><code>sentence.split(\" \").max_by(&amp;:length)\n</code></pre>\n\n<p>Your method, which can be slightly simplified to:</p>\n\n<pre><code>sentence.split(\" \").map {|word| [word.length, word]}.max[1]\n</code></pre>\n\n<p>also works, but in a more confusing way.</p>\n\n<p><a href=\"https://docs.ruby-lang.org/en/2.5.0/Array.html#method-i-3C-3D-3E\" rel=\"noreferrer\">Array comparison</a> works in an \u201celement-wise\u201d manner. So for example, <code>[2, \"foo\"] &gt; [1, \"bar\"]</code> because <code>2 &gt; 1</code>. This is why <code>max</code> works in this scenario: Because you're actually, indirectly, comparing the first element of each array.</p>\n\n<blockquote>\n  <p>Why can't I do the .each method in the same way I can do the for loop method?</p>\n</blockquote>\n\n<p>Because a variable defined within a block is only accessible within that block.</p>\n\n<p>This is a very common programming principle across virtually all languages, known as the <a href=\"https://en.wikipedia.org/wiki/Scope_(computer_science)\" rel=\"noreferrer\">scope of the variable</a>.</p>\n\n<pre><code>def longest_word(sentence)\n  max_length = 0\n  sentence.split(\" \").each do |word|\n    if word.length &gt; max_length\n      max_length = word.length\n      max_word = word  # &lt;--- The variable is defined IN A BLOCK (scope) here\n    end\n  end\n  return max_word      # &lt;--- So the variable does not exist out here\nend\n</code></pre>\n\n<p>A simple workaround (but as I mentioned above, this is not the actual solution I'd recommend!) is to initialise the variable outside the block:</p>\n\n<pre><code>def longest_word(sentence)\n  max_length = 0\n  max_word = nil   # &lt;--- The variable is defined OUTSIDE THE BLOCK (scope) here\n  sentence.split(\" \").each do |word|\n    if word.length &gt; max_length\n      max_length = word.length\n      max_word = word\n    end\n  end\n  return max_word  # &lt;--- So the variable exists here\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9261095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa974276b2578a22e7afce8c5bcd07c?s=128&d=identicon&r=PG&f=1", "display_name": "TravisHN", "link": "https://stackoverflow.com/users/9261095/travishn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 48420197, "answer_count": 1, "score": 1, "last_activity_date": 1516790087, "creation_date": 1516789000, "last_edit_date": 1516789306, "question_id": 48419920, "link": "https://stackoverflow.com/questions/48419920/replacing-a-variable-using-each-ruby", "title": "replacing a variable using .each ruby", "body": "<p>I am a beginner at Ruby and have been having some trouble figuring out why I can't modify an initialized variable placed outside a block. For example, I want to do the following (but without a for loop because I heard using it in Ruby can cause some nasty bugs):</p>\n\n<pre><code>sentence = \"short longest\"\n\ndef longest_word(sentence)\n  max_length = 0\n  for word in sentence.split(\" \")\n    if word.length &gt; max_length\n      max_length = word.length\n      max_word = word\n    end\n  end\n  return max_word\nend\n</code></pre>\n\n<p>What I tried:</p>\n\n<pre><code>def longest_word(sentence)\n    max_length = 0\n    sentence.split(\" \").each do |word|\n        if word.length &gt; max_length\n            max_length = word.length\n            max_word = word\n        end\n    end\n    return max_word\nend\n</code></pre>\n\n<p>I understand that you can use something like this:</p>\n\n<pre><code>def longest_word(sentence)\n\n     return sentence.split(\" \").each.map {|word| [word.length, word]}.max[1]\nend\n</code></pre>\n\n<p>as well but just wanted to figure out why I can't do the .each method in the same way I can do the for loop method. Any help would be appreciated!</p>\n"}, {"tags": ["ruby", "metaprogramming"], "answers": [{"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1516806147, "post_id": 48420171, "comment_id": 83840848, "body": "You aren&#39;t opening <code>Base::Child</code> at all. <code>B::Child</code> is a completely new class. Any subclass of <code>Base</code> will either need to completely redefine <code>Child</code> (as you do here) or not touch <code>Child</code> at all."}], "tags": [], "owner": {"reputation": 1469, "user_id": 1227960, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6c5f5b95e74dce0d8cbe095febd9e00?s=128&d=identicon&r=PG", "display_name": "kukrt", "link": "https://stackoverflow.com/users/1227960/kukrt"}, "is_accepted": false, "score": -1, "last_activity_date": 1516789661, "creation_date": 1516789661, "answer_id": 48420171, "question_id": 48419874, "link": "https://stackoverflow.com/questions/48419874/how-do-you-open-a-class-in-parental-class-without-affecting-to-other-sub-classed/48420171#48420171", "title": "how do you open a class in parental class without affecting to other sub-classed instances in ruby", "body": "<p>I think I figured it out.  Base should call <code>self.class::</code> on to the Child.new call</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class Base\n  class Child\n    def im\n      \"from base child\"\n    end\n  end\n\n  def initialize\n    @child = self.class::Child.new\n  end\n\n  def test\n    @child.im\n  end\nend\n\nclass A &lt; Base\nend\n\nclass B &lt; Base\n  class Child\n    def im\n      \"from b child\"\n    end\n  end\nend\n\nputs A.new.test\nputs B.new.test\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1469, "user_id": 1227960, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6c5f5b95e74dce0d8cbe095febd9e00?s=128&d=identicon&r=PG", "display_name": "kukrt", "link": "https://stackoverflow.com/users/1227960/kukrt"}, "edited": false, "score": 0, "creation_date": 1516945058, "post_id": 48425528, "comment_id": 83905262, "body": "never knew about &quot;inherited&quot; hook at all. super nice answer!"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1516806610, "last_edit_date": 1516806610, "creation_date": 1516806062, "answer_id": 48425528, "question_id": 48419874, "link": "https://stackoverflow.com/questions/48419874/how-do-you-open-a-class-in-parental-class-without-affecting-to-other-sub-classed/48425528#48425528", "title": "how do you open a class in parental class without affecting to other sub-classed instances in ruby", "body": "<p>What you want to do is very unconventional in Ruby because nested classes are not inherited.</p>\n\n<p>When you do the following</p>\n\n<pre><code>class B &lt; Base\n  class Child\n  end\nend\n</code></pre>\n\n<p>there are two possibilities: either you get the <code>Child</code> from <code>Base</code> or <code>Child</code> is not found and is considered a new constant. In this case, Ruby actually sees <code>Child</code> as a new constant (I'm guessing to prevent accidentally monkey patching the <code>Child</code> in the parent class) so you aren't opening <code>Base::Child</code> at all, you're defining an entirely separate class! Just try it:</p>\n\n<pre><code>B::Child == Base::Child\n# false!\n</code></pre>\n\n<p>If they were equal, which is what you get by specifying <code>Base::Child</code>, you get the problem you noted in your question: modifying <code>Child</code> in the subclass modifies it for all subclasses. But again, this is expected because <em>nested classes are not inherited</em>. Either there is only one <code>Child</code> that all subclasses share or each class has its own <code>Child</code> that is completely unrelated to <code>Base::Child</code>.</p>\n\n<p>However it is possible to make nested classes inherited by using metaprogramming and the <code>inherited</code> hook. Like I said, this is unconventional, so it will probably weird out other Rubyists who read your code. But if you really need to do it, here's how:</p>\n\n<pre><code>class Base\n  class Child\n    def im\n      \"from base child\"\n    end\n\n    def common\n      \"shared by all subclasses\"\n    end\n  end\n\n  def self.inherited subclass\n    # define a new Child class that inherits from Base::Child\n    subclass.const_set \"Child\", Class.new(self::Child)\n  end\n\n  def initialize\n    @child = self.class::Child.new\n  end\n\n  def test\n    puts @child.im\n    puts @child.common\n  end\nend\n\nclass A &lt; Base\n   # now this is opening Child, but not Base::Child! Rather A::Child &lt; Base::Child\n   class Child\n     def im\n       \"from a child\"\n     end\n   end\nend\n\nclass B &lt; Base\n  # same here, opening a subclass of Base::Child so we can make changes but still share behavior with Base::Child\n  class Child\n    def im\n      \"from b child\"\n    end\n  end\nend\n\nA.new.test\n# from a child\n# shared by all subclass\nB.new.test\n# from b child\n# shared by all subclasses\n</code></pre>\n"}], "owner": {"reputation": 1469, "user_id": 1227960, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6c5f5b95e74dce0d8cbe095febd9e00?s=128&d=identicon&r=PG", "display_name": "kukrt", "link": "https://stackoverflow.com/users/1227960/kukrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 48425528, "answer_count": 2, "score": 2, "last_activity_date": 1516806610, "creation_date": 1516788894, "question_id": 48419874, "link": "https://stackoverflow.com/questions/48419874/how-do-you-open-a-class-in-parental-class-without-affecting-to-other-sub-classed", "title": "how do you open a class in parental class without affecting to other sub-classed instances in ruby", "body": "<p>Let's say you have this Base class you need to extend.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class Base\n  class Child\n    def im\n      \"from base child\"\n    end\n  end\n\n  def initialize\n    @child = Child.new\n  end\n\n  def test\n    @child.im\n  end\nend\n</code></pre>\n\n<p>For a regular case, you just need to extend the Base class and add methods just for its class.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class A &lt; Base\n  # add methods \nend\n</code></pre>\n\n<p>However, if a sub-class wants to change behaviours of the parental inner class like this, it doesn't work.   I think it's because Base#initialize calls <code>Child.new</code>. (not B calls)</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class B &lt; Base\n  class Child\n    def im\n      \"from b child\"\n    end\n  end\nend\n\nputs B.new.test # \"from base child\"\n</code></pre>\n\n<p>If I change to <code>class Base::Child</code>, other sub-class instances will be affected.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class B &lt; Base\n  class Base::Child\n    def im\n      \"from b child\"\n    end\n  end\nend\n\nputs A.new.test # \"from b child\"\nputs B.new.test # \"from b child\"\n</code></pre>\n\n<p>If I wanted to have A and B behave like below, how should I open the inner class in class B? (or should I make changes in Base?)</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class B &lt; Base\n  class ????? Child\n    def im\n      \"from b child\"\n    end\n  end\nend\n\nputs A.new.test # \"from base child\"\nputs B.new.test # \"from b child\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6678463, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wIwPNMMl57k/AAAAAAAAAAI/AAAAAAAAAB8/EuQMX1H1Vps/photo.jpg?sz=128", "display_name": "jack asad", "link": "https://stackoverflow.com/users/6678463/jack-asad"}, "edited": false, "score": 0, "creation_date": 1516791169, "post_id": 48420132, "comment_id": 83830802, "body": "Ah thx for helping me. it&#39;s work. yeah since i&#39;m using CMS so the modifying is restricted"}, {"owner": {"reputation": 13, "user_id": 6678463, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wIwPNMMl57k/AAAAAAAAAAI/AAAAAAAAAB8/EuQMX1H1Vps/photo.jpg?sz=128", "display_name": "jack asad", "link": "https://stackoverflow.com/users/6678463/jack-asad"}, "edited": false, "score": 0, "creation_date": 1516851073, "post_id": 48420132, "comment_id": 83861748, "body": "I&#39;m really sorry if posted here again. If i want to reverse that condition, how you do that? ex: i want all the partial renders show up except on the root @michalvalasek"}, {"owner": {"reputation": 1133, "user_id": 1213844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K7BvS.png?s=128&g=1", "display_name": "michalvalasek", "link": "https://stackoverflow.com/users/1213844/michalvalasek"}, "reply_to_user": {"reputation": 13, "user_id": 6678463, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wIwPNMMl57k/AAAAAAAAAAI/AAAAAAAAAB8/EuQMX1H1Vps/photo.jpg?sz=128", "display_name": "jack asad", "link": "https://stackoverflow.com/users/6678463/jack-asad"}, "edited": false, "score": 0, "creation_date": 1516861945, "post_id": 48420132, "comment_id": 83865027, "body": "Just replace \u201cif\u201d with \u201cunless\u201d."}], "tags": [], "owner": {"reputation": 1133, "user_id": 1213844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K7BvS.png?s=128&g=1", "display_name": "michalvalasek", "link": "https://stackoverflow.com/users/1213844/michalvalasek"}, "is_accepted": true, "score": 0, "last_activity_date": 1516789573, "creation_date": 1516789573, "answer_id": 48420132, "question_id": 48419871, "link": "https://stackoverflow.com/questions/48419871/make-condition-to-hide-the-render-if-the-page-is-change-on-ror/48420132#48420132", "title": "Make condition to hide the render if the page is change on ROR", "body": "<p>You can use condition like this for the partial renders:</p>\n\n<pre><code>&lt;%= render('partials/header') if request.fullpath=='/' %&gt;\n</code></pre>\n\n<p>This will only render the partial if you're on the root page.</p>\n\n<p>It seems like you can't modify your controllers, but if that's an option for you, you should create a separate layout and use it in the appropriate controllers.</p>\n"}], "owner": {"reputation": 13, "user_id": 6678463, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wIwPNMMl57k/AAAAAAAAAAI/AAAAAAAAAB8/EuQMX1H1Vps/photo.jpg?sz=128", "display_name": "jack asad", "link": "https://stackoverflow.com/users/6678463/jack-asad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 48420132, "answer_count": 1, "score": 0, "last_activity_date": 1516789573, "creation_date": 1516788887, "question_id": 48419871, "link": "https://stackoverflow.com/questions/48419871/make-condition-to-hide-the-render-if-the-page-is-change-on-ror", "title": "Make condition to hide the render if the page is change on ROR", "body": "<p>I have default template on rails using camaleon CMS like this:</p>\n\n<pre><code>&lt;header id=\"header\"&gt;\n      &lt;div class=\"container\"&gt;\n        &lt;div class=\"logo text-center\"&gt;\n          &lt;%= link_to 'welcome' do %&gt;\n            &lt;%= image_tag('kopihub-logo.jpg', class: 'img-responsive') %&gt;\n          &lt;% end %&gt;\n          &lt;div class=\"spasi\"&gt;&lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n\n      &lt;!-- Partial Header --&gt;\n      &lt;%= render 'partials/header' %&gt;\n\n    &lt;/header&gt;\n\n\n    &lt;!-- Partial Section --&gt;\n    &lt;%= render 'partials/main' %&gt;\n\n\n    &lt;div class=\"container\"&gt;\n      &lt;%= yield %&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>I want to make condition if the pages is changed from the default (ex=  localhost:3000), then all the partials render will be hidden (not showing up on other pages, ex= localhost:3000/about will not showing all the partials render). It's difficult to create another views file since i'm using CMS and generate the pages automatically and will show up on yield section.\nCan anyone help me how to make that condition? Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 286, "user_id": 8735137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8858ce3c6545c51df9ce5466692d3680?s=128&d=identicon&r=PG&f=1", "display_name": "ishando", "link": "https://stackoverflow.com/users/8735137/ishando"}, "is_accepted": false, "score": 1, "last_activity_date": 1516791625, "last_edit_date": 1516791625, "creation_date": 1516789586, "answer_id": 48420138, "question_id": 48419678, "link": "https://stackoverflow.com/questions/48419678/ruby-on-rails-gsub-doesnt-work/48420138#48420138", "title": "Ruby on Rails gsub doesn&#39;t work", "body": "<p><code>\\'</code> is interpreted as the string to the right of the match, so it is doing what it should (see <a href=\"https://www.regular-expressions.info/replacecontext.html\" rel=\"nofollow noreferrer\">regex match context</a>). </p>\n\n<p>to do what you want you can do</p>\n\n<pre><code>gsub(\"'\",\"\\\\\\\\'\"}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>gsub(\"'\") { |s| \"\\\\'\" }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9259226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6994c22bb00aabf8e02e2eecc647eac?s=128&d=identicon&r=PG&f=1", "display_name": "Hasan", "link": "https://stackoverflow.com/users/9259226/hasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "closed_date": 1516791869, "answer_count": 1, "score": 0, "last_activity_date": 1516791625, "creation_date": 1516788330, "question_id": 48419678, "link": "https://stackoverflow.com/questions/48419678/ruby-on-rails-gsub-doesnt-work", "closed_reason": "Duplicate", "title": "Ruby on Rails gsub doesn&#39;t work", "body": "<pre><code>            txt = \"I'm happy :)\"     #This is input from user\n            txt = txt.gsub(\"'\",\"\\\\'\")\n            raise :test\n</code></pre>\n\n<p>I'm getting \"Im happy :)m happy :)\"</p>\n\n<p>I want to get this string variable's value is \"I\\'m happy :)\" (with one backslash)</p>\n\n<p>I'm using Rails. I will use this string variable to parameter for this situation I cannot use \"puts\" method. I tried many methods(%W(...), %(...)) to solve but I couldn't it yet.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "ancestry"], "answers": [{"tags": [], "owner": {"reputation": 43225, "user_id": 297087, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/17b3a5816f0647e9b0f7c49d60f93e7b?s=128&d=identicon&r=PG", "display_name": "Salil", "link": "https://stackoverflow.com/users/297087/salil"}, "is_accepted": false, "score": 1, "last_activity_date": 1516789020, "creation_date": 1516789020, "answer_id": 48419928, "question_id": 48419345, "link": "https://stackoverflow.com/questions/48419345/ancestry-how-to-create-categories-and-subcategories-from-the-array/48419928#48419928", "title": "ancestry: how to create categories and subcategories from the array?", "body": "<p>Assuming you are getting array of categories in a <code>categories</code>.</p>\n\n<pre><code>categories.each_with_index do |category, index|\n  if index.zero? \n    parent = Category.create!(name: category)\n  else\n    Category.create!(name: category, ancestry: parent.id)\n  end  \nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1285, "user_id": 6700665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h79ZZ.jpg?s=128&g=1", "display_name": "pan.goth", "link": "https://stackoverflow.com/users/6700665/pan-goth"}, "is_accepted": true, "score": 2, "last_activity_date": 1516791084, "creation_date": 1516791084, "answer_id": 48420644, "question_id": 48419345, "link": "https://stackoverflow.com/questions/48419345/ancestry-how-to-create-categories-and-subcategories-from-the-array/48420644#48420644", "title": "ancestry: how to create categories and subcategories from the array?", "body": "<p>For each csv row:</p>\n\n<ol>\n<li>Get an array of category names</li>\n<li>Get the root category name and remove it from array</li>\n<li>Find or create the root category by its name</li>\n</ol>\n\n<p>Then, for each category name remaining in the array:</p>\n\n<ol>\n<li>Find or create the child category by its name</li>\n<li>Set the category as the parent for next categories</li>\n</ol>\n\n<hr>\n\n<pre><code>csv.each do |row| # rows from the table\n  category_names = row[6].split('/')\n\n  root_category_name = category_names.shift\n\n  parent_category = Category.find_or_create_by!(name: root_category_name) # Finds or creates the root category\n\n  category_names.each do |category_name|\n    parent_category = Category.find_or_create_by!(name: category_name, parent: parent_category) # Finds or creates the child category, which is the root for next categories\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 48420644, "answer_count": 2, "score": 0, "last_activity_date": 1516791084, "creation_date": 1516787382, "last_edit_date": 1516788360, "question_id": 48419345, "link": "https://stackoverflow.com/questions/48419345/ancestry-how-to-create-categories-and-subcategories-from-the-array", "title": "ancestry: how to create categories and subcategories from the array?", "body": "<p>my array <code>category = [\"Components for PC\", \"Soft\", \"OS\"]</code><br>\nNumber of element can come in different.<br>\nThese array elements are created <code>Category</code> (from <strong>.csv</strong> file).\nIn array <code>category</code> I need <code>category[0]</code> was a parent, and <code>category[1]</code> - child category, but the parent <code>category[2]</code></p>\n\n<p>Components for PC => Soft => OS</p>\n\n<p>Use gem Ancestry</p>\n\n<p>For two elements of the works such code (though ugly):</p>\n\n<pre><code>last = nil\n\ncsv.each do |row| # rows from the table\n  base = row[6].split('/')[0] # first element\n  parent_category = Category.create!(name: base) if Category.where(name: base).first.nil? # Create a base category\n\n  row[6].split('/').each do |category| # \n    if Category.where(name: category).first.nil? # if the category does not exist\n      last = Category.create!(name: parent_category) if last == nil # create base Category\n      # if the base exists, create her child\n      child = Category.create!(name: category, ancestry: Category.where(name: base).first.id) if last != nil\n    end\n  end\nend\n</code></pre>\n\n<p>how to create categories and subcategories to any number of elements?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "rspec"], "owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516786361, "creation_date": 1516786361, "question_id": 48419015, "link": "https://stackoverflow.com/questions/48419015/rails-4-2-failing-to-stub-delayed-response-for-image-with-puffing-billy-imag", "title": "Rails 4.2 - Failing to stub delayed response for image with puffing billy - image not cached and new http connections are disabled", "body": "<p>I have rspec tests and I feel there is a bug with puffing billy or maybe I am misunderstanding the use of whitelists in the settings.</p>\n\n<p>Basically the test is about checking that, if a third party hosted image (on a service called Cloudinary) takes time to be downloaded by a page, then the user sees a loading spinner and after the image is finally loaded the spinner disappears and is not visible anymore.</p>\n\n<p>I'm sure billy is the root cause as</p>\n\n<ul>\n<li><p>if I don't use puffing billy (by removing billy: true) to stub/fake a 10 seconds response delay for the third party image, as you might guess, I see the image (using save_and_open_page to make sure) too soon and my test can't be implemented.</p></li>\n<li><p>if I use billy by using billy: true, then the image NEVER appears (checked it by save_and_open_page) and the spinner keeps turning as the actual stubbed image never shows up , it's like it was \"blocked\" by puffing billy... also making the test not doable :(</p></li>\n</ul>\n\n<p><strong>Puffing billy settings</strong></p>\n\n<pre><code>Capybara.configure do |config|\n    # we must force the value of the capybara server port. We have to do that because puffing-billy\n    # saves everything locally for a specific host and port. But, capybara starts your rack application\n    # on a new port each time you run your tests. The consequence is puffing-billy\n    # is not able to reuse the created cache files and tries to do all the API call again.\n    # source - kevin.disneur.me/archives/2015-03-05-end-to-end-tests-in-javascript.html\n    config.server_port = 60001\n    # source: comments in coderwall.com/p/jsutlq, enable to load save_and_open page with css and js\n    config.asset_host  = 'http://localhost:3000'\n  end\n\nrequire 'billy/capybara/rspec'\nBilly.configure do |c|\n  c.cache = true\n  c.cache_request_headers = false\n  c.persist_cache = true  \n  c.non_successful_cache_disabled = true\n  c.non_successful_error_level = :warn\n  c.whitelist = ['localhost', '127.0.0.1', 'https://res.cloudinary.com'] \n  c.ignore_cache_port = true\n  c.cache_path = \"spec/support/http_cache/billy/\"  \n  # Only set non_whitelisted_requests_disabled **temporarily**\n  # to false when first recording a 3rd party interaction. After\n  # the recording has been stored to cache_path, then set\n  # non_whitelisted_requests_disabled back to true.\n  c.non_whitelisted_requests_disabled = true  \nend\n</code></pre>\n\n<p><strong>The rspec test:</strong></p>\n\n<pre><code>context \"non signed in visitor\", js: true, billy: true do\n\ndescribe \"Spinner shows while waiting then disappears\" do               \n  it \"should work\" doproxy.stub(\"https://res.cloudinary.com/demo/image/upload/sample.jpg\").and_return(\n   Proc.new { |params, headers, body|\n     sleep 10\n    {code: 200}\n }\n   )\n\n   visit actual_deal_page_path(deal)\n\n# detect spinner\nexpect(page).to have_css('div#fullPageLoadingSpinner', visible: :visible)                   \n# check subsequent image elements not yet visible               \nexpect(page).to have_no_css(\"img[src*='https://res.cloudinary.com/demo/image/upload/sample.jpg']\")\n\n # then after 15 seconds, the cloudinary image finally is loaded and\n # the spinner disappears\nsleep 15     \nexpect(page).to have_css('div#fullPageLoadingSpinner', visible: :hidden)                    \nexpect(page).to have_css(\"img[src*='https://res.cloudinary.com/demo/image/upload/sample.jpg']\")\n     end                    \n  end           \nend\n</code></pre>\n\n<p><strong>The image in the view</strong></p>\n\n<pre><code>&lt;section  \n    id=\"introImg\"    \n    &lt;img      src=\"https://res.cloudinary.com/demo/image/upload/sample.jpg\" class=\"cld-responsive deal-page-bckdImgCover\"\n  &lt;/section&gt;\n</code></pre>\n\n<p>I have tried different variations on the settings, tried also to change https//res.cloudinary to res.cloudinary.com...nothing works</p>\n\n<p>Finally, I think it matters, I keep seeing in <strong>my tests logs</strong>:</p>\n\n<pre><code>puffing-billy: CACHE KEY for 'https://res.cloudinary.com:443/demo/image/upload/sample.jpg' is 'get_res.cloudinary.com_2c4fefdac8978387ee341535c534e21e2588ed76'\npuffing-billy: Connection to https://res.cloudinary.com:443/demo/image/upload/sample.jpg not cached and new http connections are disabled\npuffing-billy: CACHE KEY for 'https://res.cloudinary.com:443/demo/image/upload/sample.jpg' is 'get_res.cloudinary.com_2c4fefdac8978387ee341535c534e21e2588ed76'\npuffing-billy: Connection to https://res.cloudinary.com:443/demo/image/upload/sample.jpg not cached and new http connections are disabled\npuffing-billy: CACHE KEY for 'https://res.cloudinary.com:443/demo/image/upload/sample.jpg' is 'get_res.cloudinary.com_2c4fefdac8978387ee341535c534e21e2588ed76'\npuffing-billy: Connection to https://res.cloudinary.com:443/demo/image/upload/sample.jpg not cached and new http connections are disabled\npuffing-billy: CACHE KEY for 'https://res.cloudinary.com:443/demo/image/upload/sample.jpg' is 'get_res.cloudinary.com_2c4fefdac8978387ee341535c534e21e2588ed76'\npuffing-billy: Connection to https://res.cloudinary.com:443/demo/image/upload/sample.jpg not cached and new http connections are disabled\n</code></pre>\n\n<p>On these Test logs, first I don't quite understand why there are so many lines for the same resource and second, what does this message mean \"not cached and new http connections are disabled\". I tried other tickets with similar sounding issues such as #104 or <a href=\"https://github.com/oesmith/puffing-billy/issues/179\" rel=\"nofollow noreferrer\">#179</a> or, but my bug might be different...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos", "gitlab"], "comments": [{"owner": {"reputation": 1226, "user_id": 600525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ed3af96e4f24189f7b4df910f6c492?s=128&d=identicon&r=PG", "display_name": "James EJ", "link": "https://stackoverflow.com/users/600525/james-ej"}, "edited": false, "score": 1, "creation_date": 1524076884, "post_id": 48418835, "comment_id": 86829523, "body": "See <a href=\"https://gitlab.com/gitlab-org/gitlab-development-kit/blob/master/doc/howto/troubleshooting.md#charlock_holmes-07x-cannot-be-installed-on-macos-sierra\" rel=\"nofollow noreferrer\">gitlab.com/gitlab-org/gitlab-development-kit/blob/master/doc&zwnj;&#8203;/&hellip;</a> for the first part, which looks like it succeeded.  The second part looks similar to <a href=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/37361\" rel=\"nofollow noreferrer\">gitlab.com/gitlab-org/gitlab-ce/issues/37361</a>. Perhaps using the latest GitLab version or installing with <a href=\"https://gitlab.com/gitlab-org/gitlab-development-kit\" rel=\"nofollow noreferrer\">gitlab.com/gitlab-org/gitlab-development-kit</a> would help?"}], "answers": [{"tags": [], "owner": {"reputation": 2398, "user_id": 663045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238e9e291777947b5825e0b68065aa26?s=128&d=identicon&r=PG", "display_name": "GrokSrc", "link": "https://stackoverflow.com/users/663045/groksrc"}, "is_accepted": true, "score": 0, "last_activity_date": 1529685601, "creation_date": 1529685601, "answer_id": 50992297, "question_id": 48418835, "link": "https://stackoverflow.com/questions/48418835/install-gitlab-on-mac-os-10-12-failed-at-charlock-holmes-0-7-3/50992297#50992297", "title": "Install Gitlab on Mac OS 10.12 failed at &#39;Charlock_holmes (0.7.3)&#39;", "body": "<p>I had this problem today. What fixed it for me was updating icu4c, then re-installing ruby which will compile with the updated version. I use <code>ruby-install</code> and <code>chruby</code> so it was basically like this:</p>\n\n<p><code>\n$ brew upgrade icu4c\n$ chruby 2.3.4 # change to previous ruby (if necessary)\n$ rm -rf .rubies/ruby-2.4.4 # drop ruby compiled with old version of icu4c\n$ ruby-install ruby 2.4.4 # don't forget to restart your terminal after this completes\n$ ruby -e 'puts RUBY_VERSION'\n2.4.4\n$ bundle install # now it works!\n</code> </p>\n"}], "owner": {"reputation": 945, "user_id": 4772210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8YoEI.jpg?s=128&g=1", "display_name": "ibocon", "link": "https://stackoverflow.com/users/4772210/ibocon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "accepted_answer_id": 50992297, "answer_count": 1, "score": 0, "last_activity_date": 1529685601, "creation_date": 1516785788, "last_edit_date": 1516865111, "question_id": 48418835, "link": "https://stackoverflow.com/questions/48418835/install-gitlab-on-mac-os-10-12-failed-at-charlock-holmes-0-7-3", "title": "Install Gitlab on Mac OS 10.12 failed at &#39;Charlock_holmes (0.7.3)&#39;", "body": "<p>I want to install Gitlab on Mac OS X. Therefore I followed </p>\n\n<p><a href=\"https://github.com/WebEntity/Installation-guide-for-GitLab-on-OS-X\" rel=\"nofollow noreferrer\">Installation Guid for Gitlab on OS X</a></p>\n\n<p>However, I get into trouble when I install ruby gems by bundle.</p>\n\n<pre><code>bundle install --deployment --without development test mysql aws kerberos\n</code></pre>\n\n<p>resulted in,</p>\n\n<pre><code>Gem files will remain installed in /Users/git/gitlab/vendor/bundle/ruby/2.3.0/gems/charlock_holmes-0.7.3 for inspection.\nResults logged to /Users/git/gitlab/vendor/bundle/ruby/2.3.0/extensions/x86_64-darwin-16/2.3.0-static/charlock_holmes-0.7.3/gem_make.out\n\nAn error occurred while installing charlock_holmes (0.7.3), and Bundler cannot continue.\nMake sure that `gem install charlock_holmes -v '0.7.3'` succeeds before bundling.\n\nIn Gemfile:\n  gitlab_git was resolved to 10.5.0, which depends on\n    github-linguist was resolved to 4.7.6, which depends on\n      charlock_holmes\n</code></pre>\n\n<p>I tried <a href=\"https://github.com/brianmario/charlock_holmes/issues/117\" rel=\"nofollow noreferrer\">Unable to install version 0.7.3 on Mac OS Sierra</a> in order to install <strong>charlock_holmes</strong>.</p>\n\n<pre><code>gem install charlock_holmes -v 0.7.3 -- --with-cxxflags=-std=c++11\n</code></pre>\n\n<p>it resulted in successfully installed.</p>\n\n<pre><code>Building native extensions with: '--with-cxxflags=-std=c++11'\nThis could take a while...\nSuccessfully installed charlock_holmes-0.7.3\nParsing documentation for charlock_holmes-0.7.3\nDone installing documentation for charlock_holmes after 0 seconds\n1 gem installed\n</code></pre>\n\n<p>So I am confused why I can not keep install gems..</p>\n\n<hr>\n\n<p>I install all gems by</p>\n\n<blockquote>\n  <p>bundle install --no-deployment --without development test mysql aws kerberos</p>\n</blockquote>\n\n<p>However, I got in other error...</p>\n\n<blockquote>\n  <p>bundle exec rake gitlab:setup RAILS_ENV=production</p>\n</blockquote>\n\n<p>resulted in,</p>\n\n<pre><code>D, [2018-01-25T16:22:14.066436 #89351] DEBUG -- sentry: ** [Raven] compared with non class/module excluded from capture due to environment or should_capture callback\nrake aborted!\nTypeError: compared with non class/module\n</code></pre>\n"}, {"tags": ["ruby", "sequel"], "comments": [{"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1516785366, "post_id": 48418301, "comment_id": 83827064, "body": "What about parsing the query and determine whether it&#39;s a select query or something else? And yes, this is possible."}], "answers": [{"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 0, "last_activity_date": 1516799674, "creation_date": 1516799674, "answer_id": 48423404, "question_id": 48418301, "link": "https://stackoverflow.com/questions/48418301/how-restrict-sequel-ruby-to-allow-select-statement-only-fetch-method/48423404#48423404", "title": "How restrict Sequel ruby to allow SELECT statement only fetch method?", "body": "<p>This sounds like a dangerous thing. It is hard to properly sanitize input against all cases.\nJust think of procedures, dynamically craftet SQL, concatenated statements, PLSQL, up/downcase, SQL Variants, errors in your sanitizer, ...</p>\n\n<p>And you should never underestimate the creativity of malicious users.</p>\n\n<p>Best would be to handle this on the DB level and create read only user with the proper access rights.</p>\n"}], "owner": {"reputation": 79, "user_id": 9227197, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b3a69a8b93258722c50c18a118e3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Jurot King", "link": "https://stackoverflow.com/users/9227197/jurot-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516799674, "creation_date": 1516783954, "question_id": 48418301, "link": "https://stackoverflow.com/questions/48418301/how-restrict-sequel-ruby-to-allow-select-statement-only-fetch-method", "title": "How restrict Sequel ruby to allow SELECT statement only fetch method?", "body": "<p>I am letting my users execute sql queries in the app I am building. They can input database connection strings (mysq, pg, and other rdbms supported)\nIs there a way to allow SELECT statements only on fetch methos like this</p>\n\n<pre><code>   client = Sequel.connect \"mysql2://user:pass@hostname/some_db\"\n   client.fetch(\"SELECT * FROM sample_table\").all\n</code></pre>\n\n<p>and disallow the following</p>\n\n<pre><code>   client.fetch(\"DROP DATABASE some_db\").all\n   client.fetch(\"TRUNCATE some_table\").all\n   client.fetch(\"ALTER some_table\").all\n</code></pre>\n\n<p>and can I also get the tables and datatypes of each tables columns using sequel gem? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nginx", "tcp"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1516781333, "post_id": 48417548, "comment_id": 83824710, "body": "what&#39;s your unicorn.rb look like?"}, {"owner": {"reputation": 1171, "user_id": 1693541, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/ae68b37d5edb59b31eb357554929c4d5?s=128&d=identicon&r=PG", "display_name": "Braham Shakti", "link": "https://stackoverflow.com/users/1693541/braham-shakti"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1516781953, "post_id": 48417548, "comment_id": 83825037, "body": "Updated my question with <code>unicorn.rb</code>"}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1516784677, "post_id": 48417548, "comment_id": 83826608, "body": "And what&#39;s <code>Rails.application.config.database_configuration[&#39;production&#39;&zwnj;&#8203;][&#39;pool&#39;]</code> report (on your production node)"}, {"owner": {"reputation": 1171, "user_id": 1693541, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/ae68b37d5edb59b31eb357554929c4d5?s=128&d=identicon&r=PG", "display_name": "Braham Shakti", "link": "https://stackoverflow.com/users/1693541/braham-shakti"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1516786615, "post_id": 48417548, "comment_id": 83827877, "body": "It says nil and that is why added separate <code>pool</code> in next line. Also when I changed the worker from 6 to 20 it is now accepting 20 request. So is this going to block other user&#39;s request when I am the only one who is creating 20 request"}], "answers": [{"tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": false, "score": 2, "last_activity_date": 1516787603, "creation_date": 1516787603, "answer_id": 48419421, "question_id": 48417548, "link": "https://stackoverflow.com/questions/48417548/nginx-unicorn-rails-not-allowing-more-than-6-request-until-any-tcp-connectio/48419421#48419421", "title": "Nginx + Unicorn + Rails not allowing more than 6 request until any tcp connection is free", "body": "<p>Unicorn is a single-threaded application server. That means: a single unicorn worker process can handle only exactly one request at any time.</p>\n\n<p>Since you have configured the <code>worker_processes</code> count to 6 in your <code>unicorn.rb</code>, that's the exact number of concurrent requests your app can handle.</p>\n\n<p>To solve this, you can either increase the number of worker processes or (if your app is multi-thread capable) use a different application server which allows the use of multiple threads in a process, each of which then can handle a single requests. Common application servers for this kind of deployment are <a href=\"https://github.com/puma/puma\" rel=\"nofollow noreferrer\">Puma</a> and <a href=\"https://www.phusionpassenger.com/\" rel=\"nofollow noreferrer\">Passenger</a>.</p>\n"}], "owner": {"reputation": 1171, "user_id": 1693541, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/ae68b37d5edb59b31eb357554929c4d5?s=128&d=identicon&r=PG", "display_name": "Braham Shakti", "link": "https://stackoverflow.com/users/1693541/braham-shakti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516787603, "creation_date": 1516781232, "last_edit_date": 1516781929, "question_id": 48417548, "link": "https://stackoverflow.com/questions/48417548/nginx-unicorn-rails-not-allowing-more-than-6-request-until-any-tcp-connectio", "title": "Nginx + Unicorn + Rails not allowing more than 6 request until any tcp connection is free", "body": "<p>I have an application in Ruby on Rails running with unicorn and nginx. I have a few request which takes some time to process because of huge DB.</p>\n\n<p>Till 6 request I am able to browse my application with out any delay. When I ran <code>netstat -n | grep 'CONNECTED'</code> it says </p>\n\n<pre><code>unix  3      [ ]         STREAM     CONNECTED     37992166 /home/user/myapp/shared/sockets/unicorn.sock\nunix  3      [ ]         STREAM     CONNECTED     37989365 /home/user/myapp/shared/sockets/unicorn.sock\nunix  3      [ ]         STREAM     CONNECTED     37993053 /home/user/myapp/shared/sockets/unicorn.sock\nunix  3      [ ]         STREAM     CONNECTED     37992166 /home/user/myapp/shared/sockets/unicorn.sock\nunix  3      [ ]         STREAM     CONNECTED     37989335 /home/user/myapp/shared/sockets/unicorn.sock\nunix  3      [ ]         STREAM     CONNECTED     37993083 /home/user/myapp/shared/sockets/unicorn.sock\n</code></pre>\n\n<p>and when I ran <code>netstat -n | grep 'CONNECTING'</code> it shows nothing.</p>\n\n<p>But after 6 request when I ran the same command again apart from the above command it says</p>\n\n<pre><code>unix  3      [ ]         STREAM     CONNECTING     37989334 /home/user/myapp/shared/sockets/unicorn.sock\nunix  3      [ ]         STREAM     CONNECTING     37993089 /home/user/myapp/shared/sockets/unicorn.sock\n</code></pre>\n\n<p>Even when I tried to send request from Firefox it adds to the <code>CONNECTING</code> things and wait until the tcp is free if I am not wrong.</p>\n\n<p>Please help me what should I do to resolve this error. Thanks</p>\n\n<p>This is how my <code>unicorn.rb</code> looks like</p>\n\n<pre><code>working_directory \"/home/user/myapp/current\"\npid \"/home/user/myapp/shared/pids/unicorn.pid\"\nstderr_path \"/home/user/myapp/shared/log/unicorn.log\"\nstdout_path \"/home/user/myapp/shared/log/unicorn.log\"\n\nlisten \"/home/user/myapp/shared/sockets/unicorn.sock\", backlog: 64\nworker_processes 6\n\npreload_app true\n\ntimeout 600\n\nbefore_fork do |server, worker|\n  defined?(ActiveRecord::Base) &amp;&amp;\n    ActiveRecord::Base.connection.disconnect!\n\n    # Quit the old unicorn process\n    old_pid = \"#{server.config[:pid]}.oldbin\"\n    if File.exists?(old_pid) &amp;&amp; server.pid != old_pid\n      begin\n        Process.kill(\"QUIT\", File.read(old_pid).to_i)\n      rescue Errno::ENOENT, Errno::ESRCH\n        # someone else did our job for us\n      end\n    end\nend\n\nafter_fork do |server, worker|\n  if defined?(ActiveRecord::Base)\n    config = ActiveRecord::Base.configurations[Rails.env] ||\n            Rails.application.config.database_configuration[Rails.env]\n    config['pool']  = ENV['DB_POOL']  || ENV['RAILS_MAX_THREADS'] || 10\n    ActiveRecord::Base.establish_connection(config)\n  end\nend\n</code></pre>\n"}, {"tags": ["c#", "ruby", "multithreading", "concurrency"], "answers": [{"tags": [], "owner": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "is_accepted": true, "score": 1, "last_activity_date": 1516799352, "last_edit_date": 1516799352, "creation_date": 1516799048, "answer_id": 48423228, "question_id": 48416226, "link": "https://stackoverflow.com/questions/48416226/ruby-concurrency-timertask-change-execution-interval-from-within-the-task/48423228#48423228", "title": "Ruby-concurrency TimerTask, change execution_interval from within the task", "body": "<p>I think the scheduled task is here the wrong abstraction.<br>\nI would use an <a href=\"http://ruby-concurrency.github.io/concurrent-ruby/Concurrent/Async.html\" rel=\"nofollow noreferrer\">async</a> job. You could use something like this:</p>\n\n<pre><code>class AsyncLogic\n  include Concurrent::Async\n  def logic\n    # Change interval to infinity, since task may take a very long time\n    @timer.execution_interval = Infinity\n\n    puts \"Task doing job..\"\n\n    # Possibly long task\n    sleep 100\n\n    # Change interval back to normal\n    @timer.execution_interval = 0.25\n  end\nend\n\nasync_job = AsyncLogic.new\nloop do\n  job_state = async_job.async.logic      \n  until job_state.complete\n    # do something meaningful here\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 48423228, "answer_count": 1, "score": 1, "last_activity_date": 1517605544, "creation_date": 1516775807, "last_edit_date": 1517605544, "question_id": 48416226, "link": "https://stackoverflow.com/questions/48416226/ruby-concurrency-timertask-change-execution-interval-from-within-the-task", "title": "Ruby-concurrency TimerTask, change execution_interval from within the task", "body": "<p>In <a href=\"http://www.rubydoc.info/github/ruby-concurrency/concurrent-ruby/Concurrent/TimerTask\" rel=\"nofollow noreferrer\">ruby-concurrent</a> gem there is a Timer::Task class, which allows to create Timers run on specific intervals.</p>\n\n<p>Here is an example</p>\n\n<pre><code>Infinity = +1.0/0.0\n\n@timer = Concurrent::TimerTask.new(execution_interval: 0.25, \n                                       timeout_interval: Infinity) { logic }\n\n@timer.execute\n\ndef logic\n      # Change interval to infinity, since task may take a very long time\n      @timer.execution_interval = Infinity\n\n      puts \"Task doing job..\"\n\n      # Possibly long task\n      sleep 100\n\n      # Change interval back to normal\n      @timer.execution_interval = 0.25\nend\n</code></pre>\n\n<p>This is supposed to change execution_interval to infinity, since I don't know in advance how long will task take. As soon as task completes, I change execution_interval back to 0.25, and the task is supposed to run once again. However, in this example the task seems to run only once (second execution_interval change doesn't seem to have effect).</p>\n\n<p>I'm projecting the logic from C# Timers, where this works as expected.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "neo4j", "nosql"], "answers": [{"tags": [], "owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "is_accepted": true, "score": 0, "last_activity_date": 1516886147, "creation_date": 1516886147, "answer_id": 48443757, "question_id": 48415918, "link": "https://stackoverflow.com/questions/48415918/how-to-do-neo4j-parameter-safe-for-ruby-on-rails/48443757#48443757", "title": "How to do neo4j parameter safe for Ruby on Rails?", "body": "<p>For references, this was answered on <a href=\"https://github.com/neo4jrb/neo4j/issues/1474\" rel=\"nofollow noreferrer\">an issue</a> in the <code>neo4j</code> repo.  Copy/pasting here:</p>\n\n<p>There are a few things you could do.  The first thing that I would say is that you should never (or at least very rarely) inject data directly into a query string.  It can be:</p>\n\n<ul>\n<li>Buggy if you have inappropriate escaping of strings</li>\n<li>Slow because Neo4j can't optimize a query plan when the query string changes each time</li>\n<li>Unsecure if this data is coming from a user because they could produce Cypher injection attacks</li>\n</ul>\n\n<p>Ideally <code>sqlParametre</code> should be an array so that you can do this: </p>\n\n<pre><code>tablo = Word.query_as(:w).where('w.ad IN {ads}').params(ads: sqlParametre)\n# or as a shortcut:\ntablo = Word.query_as(:w).where('w.ad IN ?', sqlParametre)\n</code></pre>\n\n<p>But since you have an <code>ActiveNode</code> model you can also work at a higher level and replace lines 89 and 91 with this:</p>\n\n<pre><code>kayitSayisi = Word.as(:w).where(ad: sqlParametre).pluck('SUM(w)').first\n</code></pre>\n\n<p>Note for that last line that if <code>sqlParametre</code> is an array, the <code>neo4j</code> gem automatically detects that and creates the Cypher syntax <code>WHERE w.ad IN {param}</code> instead of <code>WHERE w.ad = {param}</code></p>\n"}], "owner": {"reputation": 11, "user_id": 9259226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6994c22bb00aabf8e02e2eecc647eac?s=128&d=identicon&r=PG&f=1", "display_name": "Hasan", "link": "https://stackoverflow.com/users/9259226/hasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 48443757, "answer_count": 1, "score": 1, "last_activity_date": 1516886147, "creation_date": 1516774558, "question_id": 48415918, "link": "https://stackoverflow.com/questions/48415918/how-to-do-neo4j-parameter-safe-for-ruby-on-rails", "title": "How to do neo4j parameter safe for Ruby on Rails?", "body": "<p>For example, the sentence is <code>\"I'm playing football\"</code></p>\n\n<p>The parameter needs to be <code>\"I\\'m playing football\"</code> with single quote to neo4j architecture...</p>\n\n<p>I tried <code>variable.html_safe</code> but unfortunatelly, it doesn't work.</p>\n\n<p>Runtime information:</p>\n\n<pre><code>Neo4j database version: neo4j 3.3.1\n\nneo4j gem version: 9.0.7\n\nneo4j-core gem version: 8.1.0\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "methods", "hash", "rspec"], "comments": [{"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1516769221, "post_id": 48414871, "comment_id": 83819708, "body": "are you using a factory to create the articles? If so please post"}, {"owner": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1516769797, "post_id": 48414871, "comment_id": 83819877, "body": "No, I tried to  create user and current_ma_user for destroy, the other test like create, update are ok"}, {"owner": {"reputation": 766, "user_id": 1488591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4373e8b5ebf359cb601120389378406a?s=128&d=identicon&r=PG", "display_name": "kunashir", "link": "https://stackoverflow.com/users/1488591/kunashir"}, "edited": false, "score": 0, "creation_date": 1516775521, "post_id": 48414871, "comment_id": 83821843, "body": "Can you show <code># .&#47;spec&#47;controllers&#47;articles_controller_spec.rb:172:in </code>block (4 levels) in &lt;top (required)&gt;&#39;` - this string (and another around this)"}, {"owner": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "reply_to_user": {"reputation": 766, "user_id": 1488591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4373e8b5ebf359cb601120389378406a?s=128&d=identicon&r=PG", "display_name": "kunashir", "link": "https://stackoverflow.com/users/1488591/kunashir"}, "edited": false, "score": 0, "creation_date": 1516777289, "post_id": 48414871, "comment_id": 83822653, "body": "@kunashir Pls see if the updated with line is enough or any info might help. Thanks"}, {"owner": {"reputation": 766, "user_id": 1488591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4373e8b5ebf359cb601120389378406a?s=128&d=identicon&r=PG", "display_name": "kunashir", "link": "https://stackoverflow.com/users/1488591/kunashir"}, "edited": false, "score": 1, "creation_date": 1516778139, "post_id": 48414871, "comment_id": 83823109, "body": "It seems like your <code>current_ma_user</code> in some place was defined like <code>Symbol</code> but you try to use it like object and call <code>role</code>. Try to analyze your backtrack for this error. May you make a gist with full trace and full code of controller"}, {"owner": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "reply_to_user": {"reputation": 766, "user_id": 1488591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4373e8b5ebf359cb601120389378406a?s=128&d=identicon&r=PG", "display_name": "kunashir", "link": "https://stackoverflow.com/users/1488591/kunashir"}, "edited": false, "score": 0, "creation_date": 1516795044, "post_id": 48414871, "comment_id": 83833233, "body": "@kunashir, I posted wrong comment in controller and now updated with the error. In controller expected current_ma_user.role to be &quot;a,m&quot; ,What I found relevant is line articles_controller_spec.rb line 172. I tried force defined method in current_ma_user hash and verified debugger confirmed the role will return &quot;a,m&quot; in .spec.rb but when check in controller.rb"}, {"owner": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "reply_to_user": {"reputation": 766, "user_id": 1488591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4373e8b5ebf359cb601120389378406a?s=128&d=identicon&r=PG", "display_name": "kunashir", "link": "https://stackoverflow.com/users/1488591/kunashir"}, "edited": false, "score": 0, "creation_date": 1516798596, "post_id": 48414871, "comment_id": 83835435, "body": "@kunashir I just added gist in question Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "edited": false, "score": 0, "creation_date": 1516795777, "post_id": 48421778, "comment_id": 83833719, "body": "I already added which result in debugger image. I just don&#39;t know how to pass the current_ma_user.role to controller to use it."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "reply_to_user": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "edited": false, "score": 0, "creation_date": 1516804611, "post_id": 48421778, "comment_id": 83839649, "body": "In the test, pass the role through params hash but you&#39;ll have to whitelisr it (don&#39;t forget) but even when you do that you still have to assign the current_ma_user and you must still define the role method on it. Try the above as a sanity check first then try passing the role through params"}, {"owner": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "edited": false, "score": 0, "creation_date": 1516806000, "post_id": 48421778, "comment_id": 83840691, "body": "How to whitelist or passing the role through params. I now use a global var like this     $xvars[&quot;current_ma_user&quot;] = current_ma_user in spec file and retrieve it later in controller: using          current_ma_user = $xvars[&quot;current_ma_user&quot;] then call current_ma_user.role and worked as expected. But like to know to use params instead of another global var for better."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "reply_to_user": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "edited": false, "score": 0, "creation_date": 1516826951, "post_id": 48421778, "comment_id": 83853705, "body": "<a href=\"http://edgeguides.rubyonrails.org/action_controller_overview.html#strong-parameters\" rel=\"nofollow noreferrer\">edgeguides.rubyonrails.org/&hellip;</a> try this link.  Also do you have a column for &quot;role&quot; in the users table?"}, {"owner": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "edited": false, "score": 0, "creation_date": 1516868314, "post_id": 48421778, "comment_id": 83867741, "body": "Yes, I have user[&quot;role&quot;] = &quot;a,m&quot;"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "reply_to_user": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "edited": false, "score": 1, "creation_date": 1516877078, "post_id": 48421778, "comment_id": 83873007, "body": "yes but where are you setting the <code>current_ma_user</code> in your controller? you need a line like this: <code>current_ma_user = User.find( params[:user_id])</code>."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "reply_to_user": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "edited": false, "score": 1, "creation_date": 1516877103, "post_id": 48421778, "comment_id": 83873034, "body": "and in your test you need to pass the user id to the params hash."}, {"owner": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "edited": false, "score": 0, "creation_date": 1516937035, "post_id": 48421778, "comment_id": 83903743, "body": "OK Here what I understand: the test file articles_controller_spec.rb need it&#39;s own data to work with controller. But in the real rails run those data like: current_ma_user, User are from it&#39;s source eg User from model and curren_ma_user from controller. However we pass the test data which need to have it (from made it up eg Factory) and pass through params as need but not all. Because in real dev or production not all data from params. That is my problem. So I only need params :id not current_ma_user and I can pass it through my other global hash to work in controller. Thanks"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "reply_to_user": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "edited": false, "score": 0, "creation_date": 1516937277, "post_id": 48421778, "comment_id": 83903794, "body": "&quot;Because in real dev or production not all data from params.&quot; where are you getting the curren_ma_user in the real production environment? ---&gt; what is the answer to this question?"}, {"owner": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "edited": false, "score": 0, "creation_date": 1516944532, "post_id": 48421778, "comment_id": 83905158, "body": "(In Controller) def current_ma_user @user ||= User.where(:auth_token =&gt; cookies[:auth_token]).first if cookies[:auth_token] end"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "reply_to_user": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "edited": false, "score": 0, "creation_date": 1516956869, "post_id": 48421778, "comment_id": 83909112, "body": "ok so in your test you will need to: (i) create a user and (ii) ensure that the the user&#39;s authentication token is set in the cookies hash"}], "tags": [], "owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "is_accepted": true, "score": 3, "last_activity_date": 1517179341, "last_edit_date": 1517179341, "creation_date": 1516794454, "answer_id": 48421778, "question_id": 48414871, "link": "https://stackoverflow.com/questions/48414871/how-to-pass-hash-method-rspec-to-controller/48421778#48421778", "title": "How to pass hash method rspec to controller", "body": "<p>This is where your error is coming from (in your controller):</p>\n\n<p><code>if current_ma_user.role.upcase.split(',').include?(\"A\") || current_ma_user == @article.user</code></p>\n\n<h2>Suggested Solutions</h2>\n\n<ul>\n<li><em>Where is current_ma_user defined in the controller?</em> (if it\u2019s not assigned, then it needs to be assigned <em>before</em> you call the role method on the current_ma_user variable.</li>\n</ul>\n\n<p>Try that and see how it goes.</p>\n\n<ul>\n<li>Do something like this:</li>\n</ul>\n\n<p><code>current_ma_user = User.find( params[:user_id])</code></p>\n\n<ul>\n<li><p>Now you seem to want to pass something into the params hash. Remember to white list whatever you decide to pass into params. Whether it is user id or roles id etc, or a roles string.</p></li>\n<li><p>When writing your tests, pass in the approrpiate values to the params hash. If you are passing in a <code>user_id</code> in your test, then you will have to make sure that a user is created in the test.</p></li>\n</ul>\n\n<p><code>delete :destroy, {:id =&gt; article.id.to_s, :user_id =&gt;  @current_ma_user.id  }, session: valid_session</code></p>\n\n<ul>\n<li><p>also perhaps in your spec file, in your test, put the current_ma_user in a before filter and make it an instance variable so it will be accessible to all your tests:</p>\n\n<p><code>before(:each) do\n      @current_ma_user = user.create( &lt;--- create the user with the \n      appropriate attributes here ---&gt;)\nend</code></p></li>\n</ul>\n\n<h2>Warning: Untested</h2>\n\n<p>I just typed it into the stack overflow editor.</p>\n"}], "owner": {"reputation": 1499, "user_id": 3528013, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100000891083311/picture?type=large", "display_name": "Prateep Kul", "link": "https://stackoverflow.com/users/3528013/prateep-kul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 48421778, "answer_count": 1, "score": -2, "last_activity_date": 1517179341, "creation_date": 1516768465, "last_edit_date": 1516798456, "question_id": 48414871, "link": "https://stackoverflow.com/questions/48414871/how-to-pass-hash-method-rspec-to-controller", "title": "How to pass hash method rspec to controller", "body": "<p>Using  Rails 5.1.4, Ruby 2.4.1, rspec</p>\n\n<p>Scenario:</p>\n\n<p>In article destroy allow only user current_ma_user with role \"a,m\"</p>\n\n<p>Then: </p>\n\n<p>Check if current_ma_user.role = \"a,m\"\n   or current_ma_user own article (@article.user)</p>\n\n<p>So I create current_ma_user as hash as well as user.\nThen call role to check what is user[role ]</p>\n\n<p>Problems:</p>\n\n<ol>\n<li><p>How to add new method to hash.</p></li>\n<li><p>How to pass that hash.method from rspec controller_spec to controller.</p></li>\n</ol>\n\n<p>Failures:</p>\n\n<pre><code>  1) ArticlesController DELETE #destroy destroys the requested article\n     Failure/Error: delete :destroy, params: {id: article.to_param}, session: valid_session, :current_ma_user.role =&gt; \"a,m\"\n\n     NoMethodError:\n       undefined method `role' for :current_ma_user:Symbol\n     # ./spec/controllers/articles_controller_spec.rb:172:in `block (4 levels) in &lt;top (required)&gt;'\n     # ./spec/controllers/articles_controller_spec.rb:171:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>This is the <a href=\"http://%3Cscript%20src=%22https://gist.github.com/kul1/c5bb17955ec133243597a40ce4e92198.js%22%3E%3C/script%3E\" rel=\"nofollow noreferrer\">gist</a></p>\n\n<p>articles_controller_spec.rb:</p>\n\n<pre><code>require 'rails_helper'\nRSpec.describe ArticlesController, type: :controller do\n\n    class Hash #patch to temp pass problem 1\n      def role\n        \"a,m\"  #Hard Code, need to call user[\"role\"] need code\n      end\n    end\n\n    user = {}\n    user[\"uid\"] = \"admin\"\n    user[\"provider\"] = \"Facebook\"\n    user[\"email\"] = \"1.0@kul.asia\"\n    user[\"role\"] = \"a,m\"\n\n    current_ma_user = user\n\n  describe \"DELETE #destroy\" do\n\n    it \"destroys the requested article\" do\n      article = Article.create! valid_attributes\n      expect {\n        delete :destroy, params: {id: article.to_param}, session: valid_session\n      }.to change(Article, :count).by(-1)\n    end\n\n    it \"redirects to the articles list\" do\n      article = Article.create! valid_attributes\n      delete :destroy, params: {id: article.to_param}, session: valid_session\n      expect(response).to redirect_to(articles_url)\n    end\n  end\nend\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>class ArticlesController &lt; ApplicationController   before_action :load_article, only: [:show, :destroy]\n\n  def destroy\n    if current_ma_user.role.upcase.split(',').include?(\"A\") || current_ma_user == @article.user\n    #if current_ma_user == @article.user\n      @article.destroy\n    end\n      redirect_to :action=&gt;'index'   end\n\n  private\n\n  def load_article\n    @article = Article.find(params[:id])   end\n\nend\n</code></pre>\n\n<p>Updated with line number:\n<a href=\"https://i.stack.imgur.com/L5Uu2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L5Uu2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Updated debug to show value of current_ma_user in .spec and controller\n<a href=\"https://i.stack.imgur.com/ogBsN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ogBsN.png\" alt=\"in spec\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/FitxN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FitxN.png\" alt=\"in controller\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1516833324, "post_id": 48414313, "comment_id": 83856899, "body": "Totally unrelated... but this case: <code>t.integer  &quot;UserID&quot;</code> is likely to confuse the hell out of rails (and possibly devs) at some point. rails assumes that a method that starts with a capital letter is a class-name, not a method/column name... rails standard would be to call this: <code>t.integer  &quot;user_id&quot;</code> instead :) or possibly even <code>t.references :user</code> (if you have a <code>User</code> class already). (Note: I understand if it&#39;s necessary for legacy reasons of course)"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8335053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TngqZ.jpg?s=128&g=1", "display_name": "Socha", "link": "https://stackoverflow.com/users/8335053/socha"}, "edited": false, "score": 0, "creation_date": 1516766415, "post_id": 48414453, "comment_id": 83819023, "body": "Thanks, @MarsAtomic I&#39;m reading the link you provided, that sounds like a reasonable solution but ideally, I&#39;d like to keep auto-generated ids (that happened to me with other models too that&#39;s why I&#39;d love to find a universal solution for not having to deal with this issue - ideally). Any idea what could be causing that?"}, {"owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "reply_to_user": {"reputation": 25, "user_id": 8335053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TngqZ.jpg?s=128&g=1", "display_name": "Socha", "link": "https://stackoverflow.com/users/8335053/socha"}, "edited": false, "score": 0, "creation_date": 1516772189, "post_id": 48414453, "comment_id": 83820562, "body": "@Socha Could not reproduce. My schema comes up clean using PG and Rails 5.1. Maybe related to friendly_id?"}, {"owner": {"reputation": 25, "user_id": 8335053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TngqZ.jpg?s=128&g=1", "display_name": "Socha", "link": "https://stackoverflow.com/users/8335053/socha"}, "edited": false, "score": 1, "creation_date": 1516781290, "post_id": 48414453, "comment_id": 83824688, "body": "It must have been some local db problem, I followed steps here <a href=\"https://stackoverflow.com/a/38666275/8335053\">stackoverflow.com/a/38666275/8335053</a> altering sequence in local postgres db table and I&#39;m not getting the error. I&#39;m going to accept your answer @MarsAtomic because it is a good solution and might help others too."}], "tags": [], "owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "is_accepted": true, "score": 1, "last_activity_date": 1516765068, "creation_date": 1516765068, "answer_id": 48414453, "question_id": 48414313, "link": "https://stackoverflow.com/questions/48414313/how-to-prevent-rails-from-inserting-id-integer-in-schema-rb-when-creating-a/48414453#48414453", "title": "How to prevent rails from inserting `id: :integer` in schema.rb when creating a table?", "body": "<p>Just add the argument <code>id: false</code> to your <code>create_table</code> call. Also, take note of the enclosing parentheses.</p>\n\n<p>Check out the <a href=\"https://apidock.com/rails/ActiveRecord/ConnectionAdapters/SchemaStatements/create_table\" rel=\"nofollow noreferrer\">API Dock reference</a> when you get the chance.</p>\n\n<pre><code>class CreateAgents &lt; ActiveRecord::Migration[5.0]\n  def change\n    create_table(:agents, id: false) do |t|\n      t.boolean :status\n      t.string :stripeId\n      t.integer :UserID\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>This is a nit-picky addition, but you probably want to enforce some consistency in your naming conventions. Either use \"Id\" or \"ID\" in your column names, but don't mix and match. It'll make your life easier.</p>\n"}], "owner": {"reputation": 25, "user_id": 8335053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TngqZ.jpg?s=128&g=1", "display_name": "Socha", "link": "https://stackoverflow.com/users/8335053/socha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1109, "favorite_count": 0, "accepted_answer_id": 48414453, "answer_count": 1, "score": 1, "last_activity_date": 1516768094, "creation_date": 1516764011, "last_edit_date": 1516768094, "question_id": 48414313, "link": "https://stackoverflow.com/questions/48414313/how-to-prevent-rails-from-inserting-id-integer-in-schema-rb-when-creating-a", "title": "How to prevent rails from inserting `id: :integer` in schema.rb when creating a table?", "body": "<p>Recently I started getting errors for certain models when creating new records:</p>\n\n<blockquote>\n  <p>PG::NotNullViolation: ERROR: null value in column \"id\" violates\n  not-null constraint</p>\n</blockquote>\n\n<p>This doesn't happen for all models, but only some of them and not always immediately. After some inspection I realized I get the error when 'id: :integer' appears in schema.rb file in the table creation line.</p>\n\n<p>This is an example of a migration that creates a non-error table:</p>\n\n<pre><code>class CreateArticles &lt; ActiveRecord::Migration[5.0]\n  def change\n    create_table :articles do |t|\n      t.string :main_title\n      t.boolean :published\n      t.string :short_title\n      t.text :a_body\n      t.string :a_image\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>This is what shows up in schema.rb:</p>\n\n<pre><code>create_table \"articles\", force: :cascade do |t|\n  t.string   \"main_title\"\n  t.boolean  \"published\"\n  t.string   \"short_title\"\n  t.text     \"a_body\"\n  t.string   \"a_image\"\n  t.datetime \"created_at\",         null: false\n  t.datetime \"updated_at\",         null: false\n  t.string   \"slug\"\n  t.string   \"a_meta_title\"\n  t.string   \"a_meta_description\"\n  t.string   \"a_other\"\n  t.string   \"a_comment\"\n  t.index [\"slug\"], name: \"index_articles_on_slug\", using: :btree\nend\n</code></pre>\n\n<p>Now when the same was done with 'agents':</p>\n\n<pre><code>class CreateAgents &lt; ActiveRecord::Migration[5.0]\n  def change\n    create_table :agents do |t|\n      t.boolean :status\n      t.string :stripeId\n      t.integer :UserID\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>But resulting part of the schema.rb file looks differently:</p>\n\n<pre><code>create_table \"agents\", id: :integer, force: :cascade do |t|\n  t.boolean  \"status\"\n  t.string   \"stripeId\"\n  t.integer  \"UserID\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n</code></pre>\n\n<p>As you can see, for no reason that I can detect, the 'id: :integer' gets added. I tried to change it to :serial, dumping my database, reloading schema (advice found in all similar Stack Overflow questions) but nothing helped. In the past, I used to set up a new model but that is not a scalable solution. Any advice would be greatly appreciated.</p>\n\n<p>I also noticed that errors only happen locally but never in production (I use Heroku).</p>\n\n<p>In case it's needed, models for comparison:</p>\n\n<p>Article Model:</p>\n\n<pre><code>class Article &lt; ApplicationRecord\n  extend FriendlyId\n  friendly_id :short_title, use: :slugged\nend\n</code></pre>\n\n<p>Agent Model:</p>\n\n<pre><code>class Agent &lt; ApplicationRecord\nend\n</code></pre>\n\n<p>I use:</p>\n\n<p>ruby 2.4.2p198 (2017-09-14 revision 59899)</p>\n\n<p>Rails 5.0.6</p>\n\n<p>psql (9.6.1, server 9.6.6)</p>\n\n<p><strong>Update:</strong>\nTo clarify what I'm looking for - I'd like to keep auto-generated ids, just prevent not-null violation error</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 2, "creation_date": 1516763976, "post_id": 48414251, "comment_id": 83818434, "body": "This has nothing to do with <a href=\"https://stackoverflow.com/questions/tagged/ruby-on-rails\">ruby-on-rails</a>. Your question also lacks a question. Please state what you want as the output, and how the output you are getting differs from it. Also, why are you &quot;curious to solve it this way&quot;? Would you be &quot;curious to solve it this way&quot; even if this way turns out to be completely wrong? (Not saying it&#39;s wrong yet, as I don&#39;t know what you&#39;re trying to do - but it certainly is unRubyish)"}, {"owner": {"reputation": 921, "user_id": 8557896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13337408e38f3a13b89e6f76f153dbf0?s=128&d=identicon&r=PG&f=1", "display_name": "vishal", "link": "https://stackoverflow.com/users/8557896/vishal"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1516764440, "post_id": 48414251, "comment_id": 83818530, "body": "@Amadan edited the question. I&#39;m new to ruby so just started off with a few basic programs. I know I&#39;m close to my desired output here but just making a small mistake somewhere and wanted to find it."}, {"owner": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 1, "creation_date": 1516764457, "post_id": 48414251, "comment_id": 83818533, "body": "I agree with Amadan. You say &quot;solve it this way&quot; but &quot;this way&quot; does not work. So now what? It&#39;s unclear at that point what sense your question can make. What constitutes a &quot;this way&quot; that also <i>does</i> work? If it works, it isn&#39;t &quot;this way&quot; \u2014 unless you state more precisely what &quot;this way&quot; means. If &quot;the aim of this program is to display how many times each element is repeated&quot; then <i>any</i> way that works should be acceptable."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1516764778, "post_id": 48414251, "comment_id": 83818627, "body": "What I&#39;m trying to get to is - <i>what is</i> your desired output? <code>[nil, 4, 2]</code> does not look anything like &quot;no of times an element is repeated in an array&quot;. What is <code>b</code> supposed to be? Also, it is probable that your error comes from misunderstanding what <code>i</code> is in <code>for i in a</code>, because you probably wouldn&#39;t write <code>a[i]</code> otherwise; but also <code>for ... in ...</code> is never ever used by Ruby programmers, and if you saw it in a book it&#39;s probably best to burn it."}, {"owner": {"reputation": 921, "user_id": 8557896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13337408e38f3a13b89e6f76f153dbf0?s=128&d=identicon&r=PG&f=1", "display_name": "vishal", "link": "https://stackoverflow.com/users/8557896/vishal"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1516765711, "post_id": 48414251, "comment_id": 83818855, "body": "<code>[nil,4,2]</code> was the o/p of <code>printb</code>  which i told was added for my reference anyway I have removed it as it is unnecessary here and what I get from your comment is using for loop is not a good practice in ruby? Just a beginner asking doubts @Amadan"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1516765887, "post_id": 48414251, "comment_id": 83818895, "body": "Though it doesn&#39;t answer your question, the two most common ways of doing this are 1) use a <i>counting hash</i> (the second form of <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a>): <code>a.each_with_object(Hash.new(0)) { |n,h| h[n]+=1 } #=&gt; {5=&gt;1, 2=&gt;2, 4=&gt;1, 1=&gt;1}</code> or 2) use <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerable#group_by</a>: <code>a.group_by(&amp;:itself).transform_values(&amp;:size) #=&gt; {5=&gt;1, 2=&gt;2, 4=&gt;1, 1=&gt;1}</code>. The latter is the compact form of <code>a.group_by { |n| n }.transform_values { |v| v.size }</code>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 2, "creation_date": 1516766218, "post_id": 48414251, "comment_id": 83818971, "body": "No worries, I answered in a bit more detail in an answer below. My main complaint was the fact that questions on StackOverflow need to be questions. Beginners&#39; doubts are welcome - but knowing how to ask is crucial to getting a good answer. &quot;You should use <code>each</code> instead of <code>for...in</code>&quot; is a part of my trying to help you with your future in Ruby; &quot;You should give as much information as possible in your question&quot; is a part of my trying to help you with your future on Stack Overflow."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1516767247, "post_id": 48414251, "comment_id": 83819220, "body": "Why or why were you in such a rush to select the first answer offered? Quick selections can discourage other answers and do not give those working on their answers enough time to finish before the checkmark has been awarded. There&#39;s no rush. Many here wait at least a couple of hours, some much longer. Incidentally, you can always withdraw the checkmark or change your selection if a better answer comes along."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1516766489, "post_id": 48414351, "comment_id": 83819040, "body": "This is very inefficient, as <code>a</code> is iterated once for each element of <code>b</code>. Other methods (see my comment on the question) conduct a single pass of <code>a</code>. Also <code>i</code> is a poor choice for the variable name as it normally is used to reference an index. I realize that the OP mistakenly thought it was an index, but that&#39;s no reason not to change it."}, {"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1516767000, "post_id": 48414351, "comment_id": 83819169, "body": "Thank you for your advice! Because he didn&#39;t put it in a context, I didn&#39;t care too much about OOP. I just wanted to correct his solution. In addition, for statement is just like a test to show the result."}], "tags": [], "owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "is_accepted": false, "score": 2, "last_activity_date": 1516764378, "creation_date": 1516764378, "answer_id": 48414351, "question_id": 48414251, "link": "https://stackoverflow.com/questions/48414251/the-number-of-same-elements-in-an-array/48414351#48414351", "title": "The number of same elements in an array", "body": "<pre><code>a = [5,2,4,1,2]\nb = a.uniq\n\nfor i in b\n  print i,\" appears \",a.count(i),\" times\\n\"\nend\nprint b\n</code></pre>\n\n<p>Result: </p>\n\n<pre><code>5 appears 1 times\n2 appears 2 times\n4 appears 1 times\n1 appears 1 times\n[5, 2, 4, 1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 3, "last_activity_date": 1516765746, "last_edit_date": 1516765746, "creation_date": 1516764936, "answer_id": 48414434, "question_id": 48414251, "link": "https://stackoverflow.com/questions/48414251/the-number-of-same-elements-in-an-array/48414434#48414434", "title": "The number of same elements in an array", "body": "<p>Here's a different way to do it, assuming I understand what \"it\" is (counting elements in an array):</p>\n\n<pre><code>a = [5,2,4,1,2]\ncounts = a.each_with_object(Hash.new(0)) do |element, counter|\n  counter[element] += 1\nend\n# =&gt; {5=&gt;1, 2=&gt;2, 4=&gt;1, 1=&gt;1}\n# i.e. one 5, two 2s, one 4, one 1.\ncounts.each do |element, count|\n  puts \"#{element} appears #{count} times\"\nend\n# =&gt; 5 appears 1 times\n# =&gt; 2 appears 2 times\n# =&gt; 4 appears 1 times\n# =&gt; 1 appears 1 times\n</code></pre>\n\n<p><code>Hash.new(0)</code> initialises a hash with a default value <code>0</code>. We iterate on <code>a</code> (while passing the hash as an additional object), so <code>element</code> will be each element of <code>a</code> in order, and <code>counter</code> will be our hash. We will increment the value of the hash indexed by the element by one; on the first go for each element, there won't be anything there, but our default value saves our bacon (and 0 + 1 is 1). The next time we encounter an element, it will increment whatever value already is present in the hash under that index.</p>\n\n<p>Having obtained a hash of elements and their counts, we can print them, of course, <code>puts</code> is same as <code>print</code> but automatically inserts a newline; and rather than using commas to print several things, it is much nicer to put the values directly into the printed string itself using the string interpolation syntax (<code>\"...#{...}...\")</code>.</p>\n\n<p>The problems in your code are as follows:</p>\n\n<ul>\n<li>[logic] <code>for i in a</code> will give you elements of <code>a</code>, not indices. Thus, <code>a[i]</code> will give you <code>nil</code> for the first element, not <code>5</code>, since <code>a[5]</code> is outside the list. This is why <code>1</code> is missing from your output: <code>a[1]</code> (i.e. <code>2</code>) is already in <code>b</code> when you try to process it.</li>\n<li>[style] <code>for ... in ...</code> is almost never seen in Ruby code, with strong preference to <code>each</code> and other methods of <code>Enumerable</code> module</li>\n<li>[performance] <code>a.count(i)</code> inside a loop increases your algorithmic complexity: <code>count</code> itself has to see the whole array, and you need to iterate the array to see <code>i</code>, which will be exponentially slower with huge arrays. The method above only has one loop, as access to hashes is very fast, and thus grows more or less linearly with the size of the array.</li>\n</ul>\n\n<p>The stylistic and performance problems are minor, of course; you won't see performance drop till you need to process really large arrays, and style errors won't make your code not work; however, if you're learning Ruby, you should aim to work with the language from the start, to get used to its idioms as you go along, as it will give you much stronger foundation than transplanting other languages' idioms onto it.</p>\n"}], "owner": {"reputation": 921, "user_id": 8557896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13337408e38f3a13b89e6f76f153dbf0?s=128&d=identicon&r=PG&f=1", "display_name": "vishal", "link": "https://stackoverflow.com/users/8557896/vishal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 48414434, "answer_count": 2, "score": -3, "last_activity_date": 1516768702, "creation_date": 1516763581, "last_edit_date": 1516768702, "question_id": 48414251, "link": "https://stackoverflow.com/questions/48414251/the-number-of-same-elements-in-an-array", "title": "The number of same elements in an array", "body": "<p>My aim is to display the number of identical elements in an array.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>a = [5, 2, 4, 1, 2]\nb = []\nfor i in a\n  unless b.include?(a[i])\n    b &lt;&lt; a[i]\n    print i,\" appears \",a.count(i),\" times\\n\"\n  end\nend\n</code></pre>\n\n<p>I get this output:</p>\n\n<pre><code>5 appears 1 times\n2 appears 2 times\n4 appears 1 times\n</code></pre>\n\n<p>The output misses <code>1</code>.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 3, "creation_date": 1516762278, "post_id": 48414066, "comment_id": 83818061, "body": "Nice one. But why does this work? An explanation (even a brief one) would add greatly to this answer."}], "tags": [], "owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "is_accepted": true, "score": 6, "last_activity_date": 1516769328, "last_edit_date": 1516769328, "creation_date": 1516762053, "answer_id": 48414066, "question_id": 48413867, "link": "https://stackoverflow.com/questions/48413867/delegating-to-a-method-defined-in-an-included-module/48414066#48414066", "title": "Delegating to a method defined in an included module", "body": "<p>You can still use <code>super</code>:</p>\n\n<pre><code>module Parent\n def name\n  \"parent\"\n end\nend\n\nclass Child \n  include Parent\n\n  def name\n   \"my parent is #{super}\"\n  end\nend\n\nChild.new.name # =&gt; \"my parent is parent\"\n</code></pre>\n\n<p>When including a module, ruby will add this module to inheritance chain.</p>\n\n<pre><code>Child.ancestors # =&gt; [Child, Parent, Object, Kernel, BasicObject]\n</code></pre>\n\n<p>Thus, calling <code>super</code> in <code>Child</code> will call the corresponding methods in its ancestors. </p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1516830386, "last_edit_date": 1516830386, "creation_date": 1516772065, "answer_id": 48415445, "question_id": 48413867, "link": "https://stackoverflow.com/questions/48413867/delegating-to-a-method-defined-in-an-included-module/48415445#48415445", "title": "Delegating to a method defined in an included module", "body": "<p>We are given the module <code>Parent</code>:</p>\n\n<pre><code>module Parent\n  def name\n    \"parent\"\n  end\nend\n</code></pre>\n\n<p>and the class <code>Child</code>:</p>\n\n<pre><code>class Child \n  include Parent    \n  def name\n    \"my parent is #{super}\"\n  end\nend\n</code></pre>\n\n<p>As @Tai points out, we can use <code>super</code> to obtain:</p>\n\n<pre><code>Child.new.name\n  #=&gt; \"my parent is parent\"\n</code></pre>\n\n<p>because</p>\n\n<pre><code>Child.ancestors\n  #=&gt; [Child, Parent, Object, Kernel, BasicObject]\n</code></pre>\n\n<p>In what sense is the module <code>Parent</code> the \"parent\" of the class <code>Child</code>? Yes, those are just words, but it is misleading.</p>\n\n<p>Now let's create another module and have <code>Child</code> include it.</p>\n\n<pre><code>module A\n  def name\n    \"A\"\n  end\nend\n\nChild.include A\nChild.new.name\n  #=&gt; \"my parent is A\"\n</code></pre>\n\n<p>because</p>\n\n<pre><code>Child.ancestors\n  #=&gt; [Child, A, Parent, Object, Kernel, BasicObject]\n</code></pre>\n\n<p>We see that it would been clearer to define <code>Class#name</code> as follows:</p>\n\n<pre><code>def name\n  \"the last module included is #{super}\"\nend\n</code></pre>\n\n<p>Let's try one more thing: using <a href=\"http://ruby-doc.org/core-2.5.0/Module.html#method-i-prepend\" rel=\"nofollow noreferrer\">Module#prepend</a>.</p>\n\n<pre><code>module B\n  def name\n    \"B\"\n  end\nend\n\nChild.prepend B\nChild.new.name\n  #=&gt; \"B\"\n</code></pre>\n\n<p><em>not</em> \"my parent is B\", because</p>\n\n<pre><code>Child.ancestors\n  #=&gt; [B, Child, A, Parent, Object, Kernel, BasicObject]\n</code></pre>\n\n<p>meaning that <code>B#name</code> (which does not call <code>super</code>) was executed (not <code>Child#name</code>). This means the results are meaningless if any modules have been prepended.</p>\n"}], "owner": {"reputation": 4616, "user_id": 284257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4e37ffbbf81653b797ec4cf995a23b1?s=128&d=identicon&r=PG", "display_name": "Sig", "link": "https://stackoverflow.com/users/284257/sig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 48414066, "answer_count": 2, "score": 1, "last_activity_date": 1516830386, "creation_date": 1516760570, "last_edit_date": 1516769751, "question_id": 48413867, "link": "https://stackoverflow.com/questions/48413867/delegating-to-a-method-defined-in-an-included-module", "title": "Delegating to a method defined in an included module", "body": "<p>Is there a way in Ruby (2.5) to call a method defined in an included module in the same way <code>super</code> works for inheritance?</p>\n\n<p>I mean, supposing I have the following</p>\n\n<pre><code>class Parent\n def name\n  \"parent\"\n end\nend\n\nclass Child &lt; Parent\n  def name\n   \"my parent is #{super}\"\n  end\nend\n</code></pre>\n\n<p>When I call <code>Child.new.name</code>, I get <code>my parent is parent</code>.</p>\n\n<p>How can I achieve the same in the following situation?</p>\n\n<pre><code>module Parent\n def name\n  \"parent\"\n end\nend\n\nclass Child \n  include Parent\n\n  def name\n   \"my parent is #{???}\"\n  end\nend\n</code></pre>\n\n<p>What should I replace <code>???</code> with?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested-attributes"], "comments": [{"owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 0, "creation_date": 1516768813, "post_id": 48413834, "comment_id": 83819604, "body": "Did you checked gem <code>cocoon</code>? <a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">github.com/nathanvda/cocoon</a>"}, {"owner": {"reputation": 329, "user_id": 1752251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/18234c3c6b04ac08d8afb1eeb2e20269?s=128&d=identicon&r=PG", "display_name": "Avinash", "link": "https://stackoverflow.com/users/1752251/avinash"}, "reply_to_user": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 0, "creation_date": 1516774820, "post_id": 48413834, "comment_id": 83821528, "body": "I know, you don&#39;t want to use javascript as well as accepts_nested_attributes_for. Why to generate object 10 times while you can build it dynamically. You can control it too. Do check the cocoon gem([<a href=\"https://github.com/nathanvda/cocoon]\" rel=\"nofollow noreferrer\">github.com/nathanvda/cocoon]</a>) as also mentioned by @Emu."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1516808019, "post_id": 48413834, "comment_id": 83842239, "body": "Your approach seems inherently flawed. You are building 10 blank exercises on the workout_routine record before getting to your form, and then you are creating 10 new exercises on the same workout_routine record in your create action. You should choose to do one or the other, not both."}], "answers": [{"comments": [{"owner": {"reputation": 510, "user_id": 8833196, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/0134ed1fe03621d083acf928a94fec19?s=128&d=identicon&r=PG&f=1", "display_name": "adam tropp", "link": "https://stackoverflow.com/users/8833196/adam-tropp"}, "edited": false, "score": 0, "creation_date": 1516762492, "post_id": 48413972, "comment_id": 83818110, "body": "Thank you, that is very helpful. However, one specification of the project was that I do not use accepts_nested_attributes_for, but instead use a custom writer. How would that code look if I instead have a custom writer like this:"}, {"owner": {"reputation": 510, "user_id": 8833196, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/0134ed1fe03621d083acf928a94fec19?s=128&d=identicon&r=PG&f=1", "display_name": "adam tropp", "link": "https://stackoverflow.com/users/8833196/adam-tropp"}, "edited": false, "score": 0, "creation_date": 1516762515, "post_id": 48413972, "comment_id": 83818114, "body": "def exercises_attributes=(exercise_attributes)     exercise_attributes.values.each do |exercise_attribute|       exercise = Exercise.find_or_create_by(exercise_attribute)       self.exercises &lt;&lt; exercise     end   end"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "reply_to_user": {"reputation": 510, "user_id": 8833196, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/0134ed1fe03621d083acf928a94fec19?s=128&d=identicon&r=PG&f=1", "display_name": "adam tropp", "link": "https://stackoverflow.com/users/8833196/adam-tropp"}, "edited": false, "score": 0, "creation_date": 1516762581, "post_id": 48413972, "comment_id": 83818129, "body": "Please edit your question to add the code for the custom writer, and indicate in what file it lives."}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 1, "last_activity_date": 1516761865, "last_edit_date": 1516761865, "creation_date": 1516761346, "answer_id": 48413972, "question_id": 48413834, "link": "https://stackoverflow.com/questions/48413834/is-there-a-way-to-create-an-unspecified-number-of-nested-resources-in-a-ror-form/48413972#48413972", "title": "Is there a way to create an unspecified number of nested resources in a ROR form?", "body": "<p>Yes, there is a way to do this using only Rails. In your WorkoutRoutine model, you need to reject exercises that are blank, like this:</p>\n\n<pre><code># models/workout_routine.rb\n\nclass WorkoutRoutine &lt; ApplicationRecord\n  has_many :exercises\n  accepts_nested_attributes_for :exercises, reject_if: lambda { |attributes| attributes[:name].blank? }\nend\n</code></pre>\n\n<p>Also, you can replace the 10 lines of identical code in your #new action with:</p>\n\n<pre><code>10.times { @workout_routine.exercises.build }\n</code></pre>\n"}], "owner": {"reputation": 510, "user_id": 8833196, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/0134ed1fe03621d083acf928a94fec19?s=128&d=identicon&r=PG&f=1", "display_name": "adam tropp", "link": "https://stackoverflow.com/users/8833196/adam-tropp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516764110, "creation_date": 1516760240, "last_edit_date": 1516764110, "question_id": 48413834, "link": "https://stackoverflow.com/questions/48413834/is-there-a-way-to-create-an-unspecified-number-of-nested-resources-in-a-ror-form", "title": "Is there a way to create an unspecified number of nested resources in a ROR form?", "body": "<p>I have a form to create a workout routine, and it can also create exercises as a nested attribute of a workout routine. I have it set to create 10 exercises. However, if the user does not fill out all 10 fields, it will create blank data for the remaining exercises. Is there a way for a ROR form to create any number of nested resources without creating any blank data? Please note that the solution must use only ruby/rails no javascript. Here is the code from the form: </p>\n\n<pre><code>&lt;%= f.label :exercise %&gt;&lt;br /&gt;\n&lt;%= f.collection_select :exercise_ids, Exercise.all, :id, :name %&gt;\n&lt;%= f.fields_for :exercises, workout_routine.exercises do |exercises_form| %&gt;\n  &lt;li&gt;\n    &lt;%= exercises_form.label :name %&gt;\n    &lt;%= exercises_form.text_field :name %&gt;\n\n    &lt;%= exercises_form.label :sets %&gt;\n    &lt;%= exercises_form.text_field :sets %&gt;\n\n    &lt;%= exercises_form.label :reps %&gt;\n    &lt;%= exercises_form.text_field :reps %&gt;\n\n    &lt;%= exercises_form.label :target %&gt;\n    &lt;%= exercises_form.text_field :target %&gt;\n  &lt;/li&gt; \n&lt;% end %&gt;\n</code></pre>\n\n<p></p>\n\n<p>and here is the code from the controller action: </p>\n\n<pre><code>def new\n  @workout_routine = WorkoutRoutine.new \n  @workout_routine.exercises.build \n  @workout_routine.exercises.build\n  @workout_routine.exercises.build\n  @workout_routine.exercises.build\n  @workout_routine.exercises.build\n  @workout_routine.exercises.build\n  @workout_routine.exercises.build\n  @workout_routine.exercises.build\n  @workout_routine.exercises.build\n  @workout_routine.exercises.build\nend\n\n\n\n\ndef create\n  @workout_routine = WorkoutRoutine.create(workout_routine_params)\n  if @workout_routine.save\n    redirect_to workout_routine_path(@workout_routine)\n  else\n    flash[:notice] = \"Workout Routine cannot have the same name as an existing routine\"\n    render :new\n  end\nend \n</code></pre>\n\n<p>Here is the custom writer method for adding nested attributes, located in workout_routine.rb: </p>\n\n<pre><code>def exercises_attributes=(exercise_attributes)\n  exercise_attributes.values.each do |exercise_attribute|\n    exercise = Exercise.find_or_create_by(exercise_attribute)\n    self.exercises &lt;&lt; exercise\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "test-first"], "comments": [{"owner": {"reputation": 1, "user_id": 8424989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecdb4122cda7c3b16aed7caa12656a89?s=128&d=identicon&r=PG&f=1", "display_name": "Yowza", "link": "https://stackoverflow.com/users/8424989/yowza"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1516836961, "post_id": 48413700, "comment_id": 83858183, "body": "Sorry it wasn&#39;t clear for you, Sawa. The question was &quot;Why am I getting an empty string instead of the translated word?&quot; SimpleLime answered it perfectly!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8424989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecdb4122cda7c3b16aed7caa12656a89?s=128&d=identicon&r=PG&f=1", "display_name": "Yowza", "link": "https://stackoverflow.com/users/8424989/yowza"}, "edited": false, "score": 0, "creation_date": 1516774784, "post_id": 48413787, "comment_id": 83821510, "body": "Thank you! your explanation was wonderfully clear and I totally see what you&#39;re talking about! I had forgotten that puts returns nil."}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": false, "score": 1, "last_activity_date": 1516763899, "last_edit_date": 1516763899, "creation_date": 1516759768, "answer_id": 48413787, "question_id": 48413700, "link": "https://stackoverflow.com/questions/48413700/test-first-ruby-04-pig-latin-getting-an-empty-string/48413787#48413787", "title": "Test-First-Ruby 04_pig_latin - getting an empty string", "body": "<p>Your <code>pigify</code> method is <a href=\"https://ruby-doc.org/core-2.4.0/Kernel.html#method-i-puts\" rel=\"nofollow noreferrer\"><code>puts</code></a>ing the strings to the terminal, but not returning them to the caller. The <code>puts</code> method will return <code>nil</code> and ruby returns the result of the last evaluated line in a method. In your <code>pigify</code>, in each <code>if/elsif/else</code> branch the last line evaluated is <code>puts</code>, so <code>pigify</code> is returning <code>nil</code>. Then you <code>join</code> all the <code>nil</code> values together and get a long string of spaces (or, in the case of a single word string, a blank string back) as your value.</p>\n\n<p>To fix this, simply remove the calls to <code>puts</code> in <code>pigify</code> and leave the strings:</p>\n\n<pre><code>def pigify(word)\n  vowels = [\"a\", \"e\", \"i\", \"o\", \"u\"]\n\n  if vowels.include? word[0].downcase\n    word + \"ay\"\n  # two cases for \"qu\"\n  elsif word[0..1] == \"qu\"\n    word[2..-1] + \"quay\"\n  elsif word[1..2] == \"qu\"\n    word[3..-1] + word[0..2] + \"ay\"\n  # for words that start with 3 consonants\n  elsif !(vowels.include? word[0]) &amp;&amp; !(vowels.include? word[1]) &amp;&amp; !(vowels.include? word[2])\n    word[3..-1] + word[0..2] + \"ay\"\n  # for words that start with 2 consonants\n  elsif !(vowels.include? word[0]) &amp;&amp; !(vowels.include? word[1]) # for 2\n    word[2..-1] + word[0..1] + \"ay\"\n  # for words that start with a single consonant\n  else\n    word[1..-1] + word[0] + \"ay\"\n  end\nend\n</code></pre>\n\n<p>Now the last line evaluated in each branch is the string being modified, so the modified string will be returned from the method.</p>\n"}], "owner": {"reputation": 1, "user_id": 8424989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecdb4122cda7c3b16aed7caa12656a89?s=128&d=identicon&r=PG&f=1", "display_name": "Yowza", "link": "https://stackoverflow.com/users/8424989/yowza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1516763899, "creation_date": 1516758973, "question_id": 48413700, "link": "https://stackoverflow.com/questions/48413700/test-first-ruby-04-pig-latin-getting-an-empty-string", "title": "Test-First-Ruby 04_pig_latin - getting an empty string", "body": "<p>I'm learning Ruby through Test-First-Ruby and I'm having a problem with some code I wrote for the program to translate words into pig latin. Instead of returning the translated word, I'm ending up with an empty string. Here in order are my code, the spec file to test it, and the failure/error code I get when I try to run the spec file in terminal (Mac OS 10.12, Ruby 2.5.0)</p>\n\n<p>Here's the code:</p>\n\n<pre><code>def translate(string)\narray = string.split(\" \")\npigged_array = array.map! {|x| pigify(x)}\nresult = pigged_array.join(\" \")\nreturn result\nend\n\ndef pigify(word)\nvowels = [\"a\", \"e\", \"i\", \"o\", \"u\"]\n\n  if vowels.include? word[0].downcase\n    puts word + \"ay\"\n\n # two cases for \"qu\"\n  elsif word[0..1] == \"qu\"\n    puts word[2..-1] + \"quay\"\n  elsif word[1..2] == \"qu\"\n    puts word[3..-1] + word[0..2] + \"ay\"\n\n# for words that start with 3 consonants\n  elsif !(vowels.include? word[0]) &amp;&amp; !(vowels.include? word[1]) &amp;&amp; !(vowels.include? word[2])\n    puts word[3..-1] + word[0..2] + \"ay\"\n\n# for words that start with 2 consonants\n  elsif !(vowels.include? word[0]) &amp;&amp; !(vowels.include? word[1]) # for 2\n    puts word[2..-1] + word[0..1] + \"ay\"\n\n# for words that start with a single consonant\n  else\n    puts word[1..-1] + word[0] + \"ay\"\n  end\nend\n</code></pre>\n\n<p>and here's the spec file:</p>\n\n<pre><code>require \"04_pig_latin\"\n\ndescribe \"#translate\" do\n  it \"translates a word beginning with a vowel\" do\n    s = translate(\"apple\")\n    expect(s).to eq(\"appleay\")\n  end\n\n  it \"translates a word beginning with a consonant\" do\n    s = translate(\"banana\")\n    expect(s).to eq(\"ananabay\")\n  end\n\n  it \"translates a word beginning with two consonants\" do\n    s = translate(\"cherry\")\n    expect(s).to eq(\"errychay\")\n  end\n\n  it \"translates two words\" do\n    s = translate(\"eat pie\")\n    expect(s).to eq(\"eatay iepay\")\n  end\n\n  it \"translates a word beginning with three consonants\" do\n    expect(translate(\"three\")).to eq(\"eethray\")\n  end\n\n  it \"counts 'sch' as a single phoneme\" do\n    s = translate(\"school\")\n    expect(s).to eq(\"oolschay\")\n  end\n\n  it \"counts 'qu' as a single phoneme\" do\n    s = translate(\"quiet\")\n    expect(s).to eq(\"ietquay\")\n  end\n\n  it \"counts 'qu' as a consonant even when it's preceded by a consonant\" do\n    s = translate(\"square\")\n    expect(s).to eq(\"aresquay\")\n  end\n\n  it \"translates many words\" do\n    s = translate(\"the quick brown fox\")\n    expect(s).to eq(\"ethay ickquay ownbray oxfay\")\n  end\n</code></pre>\n\n<p>and finally, here's the message I get when I run the spec file in terminal:</p>\n\n<pre><code>#translate\n\nappleay\n  #translates a word beginning with a vowel (FAILED - 1)\n\nFailures:\n\n  1) #translate translates a word beginning with a vowel\n     Failure/Error: expect(s).to eq(\"appleay\")\n\n       expected: \"appleay\"\n            got: \"\"\n\n       (compared using ==)\n     # ./spec/04_pig_latin_spec.rb:29:in `block (2 levels) in &lt;top \n(required)&gt;'\n\nFinished in 0.00168 seconds (files took 0.11091 seconds to load)\n1 example, 1 failure\n\nFailed examples:\n\nrspec ./spec/04_pig_latin_spec.rb:27 # #translate translates a word beginning with a vowel\n</code></pre>\n"}, {"tags": ["ruby", "amazon-s3", "aws-sdk", "pre-signed-url", "aws-sdk-ruby"], "comments": [{"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 1, "creation_date": 1516770836, "post_id": 48413626, "comment_id": 83820153, "body": "Permissions are <b>never</b> the cause with <code>SignatureDoesNotMatch</code> errors.  Expiration is checked first, then the signature, and only then are the permissions checked.  When the signature does not match, the permissions aren&#39;t checked because the request has already been deemed invalid so it wouldn&#39;t matter if the permissions had been correct.  This error is usually attributable to a copy/paste error in your secret key or an unhandled edge case bug in the SDK involving unusual characters in the URL."}, {"owner": {"reputation": 5407, "user_id": 482255, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/48fd95a45ad39216322b1b577104b8e1?s=128&d=identicon&r=PG", "display_name": "Msencenb", "link": "https://stackoverflow.com/users/482255/msencenb"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1516806674, "post_id": 48413626, "comment_id": 83841240, "body": "Thanks for the info, is there a list somewhere of unusual characters that can&#39;t be in the url? I do have spaces and parenthesis in the keys, but I can&#39;t imagine those being the issue (although I&#39;ll test it)."}, {"owner": {"reputation": 5407, "user_id": 482255, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/48fd95a45ad39216322b1b577104b8e1?s=128&d=identicon&r=PG", "display_name": "Msencenb", "link": "https://stackoverflow.com/users/482255/msencenb"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1516807346, "post_id": 48413626, "comment_id": 83841715, "body": "The list of accepted characters is here: <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMetadata.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/AmazonS3/latest/dev/UsingMetadata.html</a>. I did indeed have a colon in my key (which is on the special characters list), but changing that to not include a colon did not solve the issue."}, {"owner": {"reputation": 5407, "user_id": 482255, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/48fd95a45ad39216322b1b577104b8e1?s=128&d=identicon&r=PG", "display_name": "Msencenb", "link": "https://stackoverflow.com/users/482255/msencenb"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1516818532, "post_id": 48413626, "comment_id": 83849179, "body": "Gah! @Michael-sqlbot you were absolutely correct. Typo when setting my environment variable for the access key, was using a key from a different project."}], "owner": {"reputation": 5407, "user_id": 482255, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/48fd95a45ad39216322b1b577104b8e1?s=128&d=identicon&r=PG", "display_name": "Msencenb", "link": "https://stackoverflow.com/users/482255/msencenb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1216, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516758422, "creation_date": 1516758422, "question_id": 48413626, "link": "https://stackoverflow.com/questions/48413626/signaturedoesnotmatch-for-presigned-url-with-get-object", "title": "SignatureDoesNotMatch for presigned-url with get_object", "body": "<p>Pretty simple stuff (I thought). I'm attempting to create a pre-signed url that I can then use to download a file. The IAM user these keys correspond to have fullS3Acess until I can figure out why this signature isn't working. </p>\n\n<pre><code>  def presigned_url\n    document = Document.find(params[:id])\n\n    signer = get_presigner\n    signer.presigned_url(:get_object, bucket: ENV['S3_BUCKET_NAME'], key: document.s3_path)\n  end\n\n  def get_presigner\n    credentials = Aws::Credentials.new(\n        ENV['FULL_AWS_ACCESS_KEY_ID'],\n        ENV['FULL_AWS_SECRET_ACCESS_KEY']\n    )\n    client = Aws::S3::Client.new(\n        region: 'us-west-2',\n        credentials: credentials\n    )\n    Aws::S3::Presigner.new(client: client)\n  end\n</code></pre>\n\n<p>The url returned from the presigned_url method results in a SignatureDoesNotMatch error when I attempt to open it in a browser. Any ideas as to why that is true? I think I've ruled out permissions as the answer, as I've increased that user's IAM permissions to beyond where they should be. Any ideas?</p>\n"}, {"tags": ["ruby", "rvm", "homebrew"], "answers": [{"comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1516767807, "post_id": 48413864, "comment_id": 83819360, "body": "mac os has got ruby installed by default, it&#39;s shipped with new mac os."}, {"owner": {"reputation": 14471, "user_id": 735926, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b5fa39f5bc4b397eb7e55766eecd8c4?s=128&d=identicon&r=PG", "display_name": "bfontaine", "link": "https://stackoverflow.com/users/735926/bfontaine"}, "edited": false, "score": 0, "creation_date": 1518096738, "post_id": 48413864, "comment_id": 84370950, "body": "&quot;You have system Ruby installed via Brew. It&#39;s located at <code>&#47;usr&#47;bin&#47;ruby</code>&quot; -&gt; That\u2019s false. <code>&#47;usr&#47;bin&#47;ruby</code> is the system Ruby; Homebrew can\u2019t install anything at this location."}], "tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": true, "score": 0, "last_activity_date": 1518127372, "last_edit_date": 1518127372, "creation_date": 1516760555, "answer_id": 48413864, "question_id": 48413483, "link": "https://stackoverflow.com/questions/48413483/ruby-installed-in-multiple-locations-is-this-normal-on-macos/48413864#48413864", "title": "Ruby installed in multiple locations. Is this normal on macOS?", "body": "<p>Actually it's not really related to Ruby. It's more about shell and RVM.\nYou use <code>-a</code> options for <code>which</code>. \nFrom man:</p>\n\n<blockquote>\n  <p>-a      List all instances of executables found (instead of just the first one of each).</p>\n</blockquote>\n\n<p>So it's normal situation in your case. You have system Ruby installed via Brew. It's located at <code>/usr/bin/ruby</code>.</p>\n\n<p>Also you have Ruby installed via RVM. RVM modifies <code>$PATH</code> environment variable to you be able to run RVM's Ruby.</p>\n\n<p><strong>Updated:</strong></p>\n\n<p>I've mixed up. Ruby located at <code>/usr/bin/ruby</code> is shipped with Mac OS by itself rather than install via Brew.</p>\n"}], "owner": {"reputation": 125, "user_id": 8436499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v3TEc.png?s=128&g=1", "display_name": "vim_usr", "link": "https://stackoverflow.com/users/8436499/vim-usr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 48413864, "answer_count": 1, "score": 0, "last_activity_date": 1518127372, "creation_date": 1516757140, "last_edit_date": 1518096755, "question_id": 48413483, "link": "https://stackoverflow.com/questions/48413483/ruby-installed-in-multiple-locations-is-this-normal-on-macos", "title": "Ruby installed in multiple locations. Is this normal on macOS?", "body": "<p>I have macOS version 10.13.2 along with brew and brew cask installed. \nRecently I started programming in ruby and wanted to install a few new versions of ruby.  It was suggested to me to use rvm to handle multiple versions of ruby.</p>\n\n<p>If I run <code>rvm list</code> I get the following (which seems correct as far as the ruby versions go):</p>\n\n<pre><code>rvm rubies\nruby-2.3.3 [ x86_64 ]    \nruby-2.3.5 [ x86_64 ]    \nruby-2.4.0 [ x86_64 ]\n=* ruby-2.5.0 [ x86_64 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n</code></pre>\n\n<p>However, when I run <code>which -a ruby</code> I get the following:</p>\n\n<pre><code>/Users/vimusr/.rvm/rubies/ruby-2.5.0/bin/ruby\n/usr/bin/ruby\n</code></pre>\n\n<p>Is it normal for ruby to show up in 2 different locations?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "answers": [{"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": false, "score": 0, "last_activity_date": 1516767703, "creation_date": 1516767703, "answer_id": 48414764, "question_id": 48413241, "link": "https://stackoverflow.com/questions/48413241/database-connectivity-error-using-postgres/48414764#48414764", "title": "Database connectivity error? Using Postgres", "body": "<p>You can run seed rake task from the <code>spec_helper.rb</code> or whatever you're using, here is an example:</p>\n\n<pre><code>YOU_AWESOME_APP::Application.load_tasks\nRake::Task['db:seed'].invoke\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8661683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3935a2e058dd22d9d413dda082cb1bd?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/8661683/yosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1516767703, "creation_date": 1516755230, "question_id": 48413241, "link": "https://stackoverflow.com/questions/48413241/database-connectivity-error-using-postgres", "title": "Database connectivity error? Using Postgres", "body": "<p>I am trying to run tests using Rspec in test environment but my database is empty, apparently when I run my db:seed command it shows </p>\n\n<pre><code>&gt; $ rake RAILS_ENV=test db:seed \n&gt; Warning: method `create` already defined\n&gt; Warning: method `update` already defined   \nenvironment --&gt;   1.050000 &gt; 0.240000   1.290000 (  1.506180)   \ndb:load_config --&gt;   0.010000   0.010000   0.020000 (  0.009816)   \ndb:abort_if_pending_migrations --&gt;   0.010000   0.000000   0.010000 (  0.030057)\ndb:seed --&gt;   1.070000   0.250000   1.320000 (  1.547370)\n</code></pre>\n\n<p>If I check my seeds file its all empty. Let's say I created database with Coin in it and if I run it like this: </p>\n\n<pre><code>&gt; $ rails c Running via Spring preloader in process 4229 Loading test\n&gt; environment (Rails 5.1.4) \n[1] pry(main)&gt; Coin.all   Coin Load (0.5ms) \n&gt; SELECT \"coins\".* FROM \"coins\"\n&gt; =&gt; []\n</code></pre>\n\n<p>There is nothing in it. Whatever I run let's say </p>\n\n<pre><code>$ rake db:migrate\nWarning: method `create` already defined\nWarning: method `update` already defined\n  environment --&gt;   1.030000   0.200000   1.230000 (  1.409833)\n  db:load_config --&gt;   0.010000   0.000000   0.010000 (  0.009251)\n  db:schema:dump --&gt;   0.020000   0.010000   0.030000 (  0.150969)\n  db:_dump --&gt;   0.020000   0.010000   0.030000 (  0.151114)\n  db:migrate --&gt;   0.040000   0.020000   0.060000 (  0.219740)\n</code></pre>\n\n<p>That's all I get. </p>\n\n<p>How it suppose to look like is : </p>\n\n<pre><code>$ rails c\nWarning: method `create` already defined\nWarning: method `update` already defined\nRunning via Spring preloader in process 3940\nLoading development environment (Rails 5.1.4)\n[1] pry(main)&gt; Coin.all\n  Coin Load (2.8ms)  SELECT \"coins\".* FROM \"coins\"\n=&gt; [#&lt;Coin:0x007ff5313aa4e8\n  id: 1,\n  coin_id: \"btc\",\n  display_name: \"Bitcoin\",\n  price_btc: \"1\",\n</code></pre>\n\n<p>But it's only working in development environment. And I wanna make it work in test environment. I will really appreciate all the suggestions. Thanks!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 3076, "user_id": 1247505, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d368ffa8c6bc0815e173a15446128666?s=128&d=identicon&r=PG", "display_name": "Xavier", "link": "https://stackoverflow.com/users/1247505/xavier"}, "edited": false, "score": 0, "creation_date": 1516754251, "post_id": 48412808, "comment_id": 83816092, "body": "I had this exact error working with HTTP a couple weeks ago.  I nearly punched a hole in the wall.  Unfortunately Net::HTTP will sometimes (frequently) give you this <code>EOFError</code> for a lot of different reasons without explaining."}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "reply_to_user": {"reputation": 3076, "user_id": 1247505, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d368ffa8c6bc0815e173a15446128666?s=128&d=identicon&r=PG", "display_name": "Xavier", "link": "https://stackoverflow.com/users/1247505/xavier"}, "edited": false, "score": 0, "creation_date": 1516754363, "post_id": 48412808, "comment_id": 83816119, "body": "And did you get a solution?"}, {"owner": {"reputation": 3076, "user_id": 1247505, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d368ffa8c6bc0815e173a15446128666?s=128&d=identicon&r=PG", "display_name": "Xavier", "link": "https://stackoverflow.com/users/1247505/xavier"}, "edited": false, "score": 0, "creation_date": 1516754395, "post_id": 48412808, "comment_id": 83816134, "body": "I will post an answer with some thoughts"}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "reply_to_user": {"reputation": 3076, "user_id": 1247505, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d368ffa8c6bc0815e173a15446128666?s=128&d=identicon&r=PG", "display_name": "Xavier", "link": "https://stackoverflow.com/users/1247505/xavier"}, "edited": false, "score": 0, "creation_date": 1516766749, "post_id": 48412808, "comment_id": 83819107, "body": "Anyone else know what is going on?"}], "answers": [{"tags": [], "owner": {"reputation": 3076, "user_id": 1247505, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d368ffa8c6bc0815e173a15446128666?s=128&d=identicon&r=PG", "display_name": "Xavier", "link": "https://stackoverflow.com/users/1247505/xavier"}, "is_accepted": false, "score": 1, "last_activity_date": 1516755654, "creation_date": 1516755654, "answer_id": 48413306, "question_id": 48412808, "link": "https://stackoverflow.com/questions/48412808/post-request-with-http-net-results-in-eof-ruby-http-library/48413306#48413306", "title": "Post request with http/net results in EOF? Ruby http library", "body": "<p>Net::HTTP will give you that EOFError for a number of reasons you might not expect, many of which are actually legit (i.e., descriptive).  I find this to be annoying and difficult to debug.  If you Google \"ruby net http eoferror\" you get tons of SO questions with lots of variety.  When I tried out your code, I also received the EOFError, but when I inspected the response object, I noticed that the request was actually still performed (got a 404 error in my case).</p>\n\n<p>Generally, I use <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">HTTParty</a> because it's not as low-level as Net::HTTP and is generally easier to use.</p>\n\n<p>Here is an example of your code rewritten to use HTTParty:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def post(path, params)\n  url = URI.parse('http://www.jobcoin.company.com' + path)\n\n  response = HTTParty.post(url, params)\nend\n</code></pre>\n"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516755654, "creation_date": 1516751985, "question_id": 48412808, "link": "https://stackoverflow.com/questions/48412808/post-request-with-http-net-results-in-eof-ruby-http-library", "title": "Post request with http/net results in EOF? Ruby http library", "body": "<p>I am trying to make a post request which works on postman:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ukha2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ukha2.png\" alt=\"enter image description here\"></a></p>\n\n<p>The above works and when I check the list of transactions, it appears.</p>\n\n<p>However, this post request does not work when using Ruby's <code>http/net</code> library. What gives?</p>\n\n<pre><code> def post(path, params)\n    18:   url = URI.parse('http://www.jobcoin.company.com' + path)\n =&gt; 19:   binding.pry\n    20:   http = Net::HTTP.new(url.host, url.port)\n    21:   req = Net::HTTP::Post.new(url.request_uri)\n    22:   req.set_form_data(params)\n    23:\n    24:   binding.pry\n    25:   response = http.request(req)\n    26: end\n\n[1] pry(#&lt;JobcoinClient::Requests::Connection&gt;)&gt; url\n=&gt; #&lt;URI::HTTP:0x007fb4e622ec80 URL:http://www.jobcoin.company.com/protozoan/api/transactions&gt;\n</code></pre>\n\n<p>Here is what happens:</p>\n\n<pre><code>http.request(req)\n=&gt; EOFError: end of file reached\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 3076, "user_id": 1247505, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d368ffa8c6bc0815e173a15446128666?s=128&d=identicon&r=PG", "display_name": "Xavier", "link": "https://stackoverflow.com/users/1247505/xavier"}, "edited": false, "score": 0, "creation_date": 1516752100, "post_id": 48412821, "comment_id": 83815528, "body": "Curses, beat me to it by 5 seconds!"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 3076, "user_id": 1247505, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d368ffa8c6bc0815e173a15446128666?s=128&d=identicon&r=PG", "display_name": "Xavier", "link": "https://stackoverflow.com/users/1247505/xavier"}, "edited": false, "score": 0, "creation_date": 1516752132, "post_id": 48412821, "comment_id": 83815544, "body": "Try the next time :P"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 1, "last_activity_date": 1516752071, "creation_date": 1516752071, "answer_id": 48412821, "question_id": 48412790, "link": "https://stackoverflow.com/questions/48412790/rails-nestes-resources-wrong-id/48412821#48412821", "title": "Rails - nestes resources, wrong id", "body": "<p>Run</p>\n\n<pre><code>rails routes \n</code></pre>\n\n<p>to understand where you are wrong</p>\n\n<p>Anyway, the nested resource requires just <code>id</code>, so</p>\n\n<pre><code>edit_group_list_path(:group_id =&gt; @group.id, :id =&gt; elem.id)\n</code></pre>\n\n<p>Any other parameter is added in query string</p>\n"}, {"tags": [], "owner": {"reputation": 3076, "user_id": 1247505, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d368ffa8c6bc0815e173a15446128666?s=128&d=identicon&r=PG", "display_name": "Xavier", "link": "https://stackoverflow.com/users/1247505/xavier"}, "is_accepted": false, "score": 1, "last_activity_date": 1516752276, "creation_date": 1516752276, "answer_id": 48412845, "question_id": 48412790, "link": "https://stackoverflow.com/questions/48412790/rails-nestes-resources-wrong-id/48412845#48412845", "title": "Rails - nestes resources, wrong id", "body": "<p>As @Ursus said, the default behavior of nested resources in rails to to accept a plain <code>:id</code> parameter for the innermost resource, <code>/groups/:group_id/lists/:id</code>.  You can also simply pass in the objects directly instead of mapping to ID integers:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>edit_group_list_path(@group, elem)\n</code></pre>\n\n<p>You can read more about nested resources here: <a href=\"http://guides.rubyonrails.org/routing.html#nested-resources\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/routing.html#nested-resources</a></p>\n"}], "owner": {"reputation": 11, "user_id": 7400171, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/192288007906507/picture?type=large", "display_name": "batinex", "link": "https://stackoverflow.com/users/7400171/batinex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516752276, "creation_date": 1516751838, "question_id": 48412790, "link": "https://stackoverflow.com/questions/48412790/rails-nestes-resources-wrong-id", "title": "Rails - nestes resources, wrong id", "body": "<p>I have a Group model, which has many lists. </p>\n\n<p><strong>Group</strong></p>\n\n<pre><code>class Group &lt; ActiveRecord::Base\n  has_many :memberships\n  has_many :users, through: :memberships\n  has_many :lists\n  accepts_nested_attributes_for :lists\n  cattr_accessor :current_user\nend\n</code></pre>\n\n<p><strong>List</strong></p>\n\n<pre><code>class List &lt; ApplicationRecord\n  belongs_to :group\n  validates_presence_of :group_id\nend\n</code></pre>\n\n<p>I iterate over @group.lists</p>\n\n<pre><code>  &lt;% @group.lists.each do |elem| %&gt;\n&lt;p&gt;&lt;strong&gt;&lt;%= elem.title %&gt;&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;&lt;%= elem.body %&gt;&lt;/p&gt;\n&lt;%= link_to 'Delete list', [elem.group, elem], method: :delete,\n            data: {confirm: \"Are you sure?\"} %&gt;\n\n  &lt;%= link_to 'Update list', edit_group_list_path(:group_id =&gt; @group.id, :list_id =&gt; elem.id), method: :put %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>Delete method works good, but update method works wrong. Instead of creating links like <a href=\"http://localhost:3000/groups/9/lists/10/\" rel=\"nofollow noreferrer\">http://localhost:3000/groups/9/lists/10/</a> where group_id is 9 and list_id is 10, it's doing something like this\n<a href=\"http://localhost:3000/groups/9/lists/9/edit?list_id=15\" rel=\"nofollow noreferrer\">http://localhost:3000/groups/9/lists/9/edit?list_id=15</a></p>\n\n<p>Routes:</p>\n\n<pre><code>resources :groups do\nresources :lists\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 9, "creation_date": 1516748774, "post_id": 48412311, "comment_id": 83814461, "body": "With empty values it would require an extra operation, maybe like <code>[&quot;&quot;, &quot;22&quot;, &quot;14&quot;, &quot;18&quot;].reject(&amp;:empty?).map(&amp;:to_i)</code>."}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1516749035, "post_id": 48412311, "comment_id": 83814544, "body": "@SebastianPalma why dont you answer?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1516749150, "post_id": 48412311, "comment_id": 83814584, "body": "Question isn&#39;t well-formulated, I don&#39;t know what he has tried."}, {"owner": {"reputation": 1145, "user_id": 3262916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abfd08a0e41f2c1b292d233100e5a4?s=128&d=identicon&r=PG", "display_name": "Ziv Galili", "link": "https://stackoverflow.com/users/3262916/ziv-galili"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1516749881, "post_id": 48412311, "comment_id": 83814814, "body": "@SebastianPalma I&#39;m not sure he needs any special operation, as rails will convert empty string to <code>0</code> when you use <code>to_i</code> so <code>[&quot;&quot;, &quot;22&quot;, &quot;14&quot;, &quot;18&quot;].map(&amp;:to_i)</code> should be enough! (The result will be: <code>[0, 22, 14, 18]</code>, so if you don&#39;t want a <code>0</code> in the result, you do need the extra operation)"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1516750047, "post_id": 48412311, "comment_id": 83814877, "body": "I think maybe Integer#to_i is implemented in Ruby as in Rails, in both cases it returns 0, but the output added doesn&#39;t contain a 0 as first value, that&#39;s why, it lacks info."}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1516750304, "post_id": 48412311, "comment_id": 83814957, "body": "Core implements <code>String#to_i</code>"}, {"owner": {"reputation": 1145, "user_id": 3262916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abfd08a0e41f2c1b292d233100e5a4?s=128&d=identicon&r=PG", "display_name": "Ziv Galili", "link": "https://stackoverflow.com/users/3262916/ziv-galili"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1516750563, "post_id": 48412311, "comment_id": 83815044, "body": "@SebastianPalma oh i missed the wanted output :S"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1516750578, "post_id": 48412311, "comment_id": 83815051, "body": "You&#39;re right @JoshBrody, <code>String#to_i</code> I meant (as <code>&#39;&#39;</code> =&gt; string) C:"}], "answers": [{"tags": [], "owner": {"reputation": 1145, "user_id": 3262916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abfd08a0e41f2c1b292d233100e5a4?s=128&d=identicon&r=PG", "display_name": "Ziv Galili", "link": "https://stackoverflow.com/users/3262916/ziv-galili"}, "is_accepted": true, "score": 19, "last_activity_date": 1516750517, "creation_date": 1516750517, "answer_id": 48412592, "question_id": 48412311, "link": "https://stackoverflow.com/questions/48412311/convert-array-of-strings-to-an-array-of-integers/48412592#48412592", "title": "Convert array of strings to an array of integers", "body": "<p>To convert a string to number you have the <code>to_i</code> method.</p>\n\n<p>To convert an array of strings you need to go through the array items and apply <code>to_i</code> on them. You can achieve that with <code>map</code> or <code>map!</code> methods:</p>\n\n<pre><code>&gt; [\"\", \"22\", \"14\", \"18\"].map(&amp;:to_i)\n# Result: [0, 22, 14, 18]\n</code></pre>\n\n<p>Since don't want the <code>0</code> - just as @Sebastian Palma said in the comment, you will need to use an extra operation to remove the empty strings: (The following is his answer! Vote for his comment instead :D)</p>\n\n<pre><code>&gt; [\"\", \"22\", \"14\", \"18\"].reject(&amp;:empty?).map(&amp;:to_i)\n# Result: [22, 14, 18]\n</code></pre>\n\n<p>the difference between <code>map</code> and <code>map!</code> is that <code>map</code> will return a new array, while <code>map!</code> will change the original array. </p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 3, "last_activity_date": 1516781820, "creation_date": 1516781820, "answer_id": 48417704, "question_id": 48412311, "link": "https://stackoverflow.com/questions/48412311/convert-array-of-strings-to-an-array-of-integers/48417704#48417704", "title": "Convert array of strings to an array of integers", "body": "<p>You could select the strings containing digits using <a href=\"http://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-grep\" rel=\"nofollow noreferrer\"><code>grep</code></a>:</p>\n\n<pre><code>[\"\", \"22\", \"14\", \"18\"].grep(/\\d+/)\n#=&gt; [\"22\", \"14\", \"18\"]\n</code></pre>\n\n<p>And convert them via <a href=\"http://ruby-doc.org/core-2.5.0/String.html#method-i-to_i\" rel=\"nofollow noreferrer\"><code>to_i</code></a> by passing a block to <code>grep</code>:</p>\n\n<pre><code>[\"\", \"22\", \"14\", \"18\"].grep(/\\d+/, &amp;:to_i)\n#=&gt; [22, 14, 18]\n</code></pre>\n\n<p>Depending on your input, you might need a more restrictive pattern like <code>/\\A\\d+\\z/</code>.</p>\n"}], "owner": {"reputation": 1743, "user_id": 3689085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/cODh0.jpg?s=128&g=1", "display_name": "NothingToSeeHere", "link": "https://stackoverflow.com/users/3689085/nothingtoseehere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9354, "favorite_count": 0, "accepted_answer_id": 48412592, "answer_count": 2, "score": 9, "last_activity_date": 1516781820, "creation_date": 1516748703, "last_edit_date": 1516769523, "question_id": 48412311, "link": "https://stackoverflow.com/questions/48412311/convert-array-of-strings-to-an-array-of-integers", "title": "Convert array of strings to an array of integers", "body": "<p>I need to convert strings in an array representing numbers into integers.</p>\n\n<pre><code>[\"\", \"22\", \"14\", \"18\"]\n</code></pre>\n\n<p>into</p>\n\n<pre><code>[22, 14, 18]\n</code></pre>\n\n<p>How can I do this?</p>\n"}, {"tags": ["ruby", "rubocop"], "comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 3, "creation_date": 1516747879, "post_id": 48412100, "comment_id": 83814136, "body": "Why do you want to use Hash.new?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6596162"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1516968580, "post_id": 48412100, "comment_id": 83914983, "body": "I&#39;m fairly new to Ruby, but as far as my understanding goes both {} and Hash.new provide the same functionality. I simply choose the more aesthetically pleasing solution if that makes any sense."}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 3, "last_activity_date": 1516747845, "creation_date": 1516747845, "answer_id": 48412151, "question_id": 48412100, "link": "https://stackoverflow.com/questions/48412100/rubocop-complains-when-using-hash-new/48412151#48412151", "title": "RuboCop complains when using &#39;Hash.new&#39;", "body": "<p>You can disable the <a href=\"http://www.rubydoc.info/github/bbatsov/rubocop/Rubocop/Cop/Style/EmptyLiteral\" rel=\"nofollow noreferrer\"><code>Rubocop::Cop::Style::EmptyLiteral</code></a> cop within the rubocop.yml file:</p>\n\n<pre><code># .rubocop.yml\nStyle:\n  EmptyLiteral: false\n</code></pre>\n\n<p>Or if you want just to ignore a certain line:</p>\n\n<pre><code>hsh = Hash.new # rubocop:disable Style/EmptyLiteral\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "is_accepted": false, "score": 1, "last_activity_date": 1516895092, "creation_date": 1516895092, "answer_id": 48446759, "question_id": 48412100, "link": "https://stackoverflow.com/questions/48412100/rubocop-complains-when-using-hash-new/48446759#48446759", "title": "RuboCop complains when using &#39;Hash.new&#39;", "body": "<p>According to <a href=\"https://github.com/bbatsov/ruby-style-guide#literal-array-hash\" rel=\"nofollow noreferrer\">Ruby Style Guide</a> literal array and hash creation notation are preferred unless you need to pass parameters to their constructors. So, to follow the guide you should use <code>hash = {}</code> instead <code>hash = Hash.new</code>.</p>\n\n<p>I would follow the conventions in the guide, but in case that you do not want, you can disable the <a href=\"https://rubocop.readthedocs.io/en/latest/cops_style/#styleemptyliteral\" rel=\"nofollow noreferrer\">Style/EmptyLiteral cop</a>, as for any other cop, either locally or globally.</p>\n\n<h3>Globally</h3>\n\n<p>Add to you <code>rubocop.yml</code> file:</p>\n\n<pre><code>Style:\n  EmptyLiteral: false\n</code></pre>\n\n<h3>Locally</h3>\n\n<pre><code># rubocop:disable Style/EmptyLiteral\nhash = Hash.new \n# rubocop:enable Style/EmptyLiteral\n</code></pre>\n\n<p>or the short version for a single line:</p>\n\n<pre><code>hash = Hash.new # rubocop:disable Style/EmptyLiteral\n</code></pre>\n\n<hr>\n\n<p>For more information about how to configure Rubocop check <a href=\"https://github.com/bbatsov/rubocop/blob/master/manual/configuration.md\" rel=\"nofollow noreferrer\">its documentation</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6596162"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 48412151, "answer_count": 2, "score": 4, "last_activity_date": 1516895092, "creation_date": 1516747594, "last_edit_date": 1516769589, "question_id": 48412100, "link": "https://stackoverflow.com/questions/48412100/rubocop-complains-when-using-hash-new", "title": "RuboCop complains when using &#39;Hash.new&#39;", "body": "<p>RuboCop complains when I use <code>Hash.new</code>, and suggests that I instead use a hash literal. Is there a way to make RuboCop ignore uses of <code>Hash.new</code>? More specifically, can I edit my <code>.rubocop.yml</code> configuration to allow the use of <code>Hash.new</code> without raising any complaints?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "string", "neo4j"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1516747196, "post_id": 48411999, "comment_id": 83813859, "body": "&quot;Jane\\\\&#39;s very good...&quot; is, but using <code>puts</code>."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1516747448, "post_id": 48411999, "comment_id": 83813969, "body": "your first option solves it no?"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1516747616, "post_id": 48411999, "comment_id": 83814028, "body": "What are you typing into that provides the <code>&gt;&gt;</code> prompt?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1516747753, "post_id": 48411999, "comment_id": 83814082, "body": "Or <code>&#39;Jane\\\\\\&#39;s very good...&#39;</code>"}, {"owner": {"reputation": 11, "user_id": 9259226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6994c22bb00aabf8e02e2eecc647eac?s=128&d=identicon&r=PG&f=1", "display_name": "Hasan", "link": "https://stackoverflow.com/users/9259226/hasan"}, "edited": false, "score": 0, "creation_date": 1516748789, "post_id": 48411999, "comment_id": 83814467, "body": "I will use it to database inputs. When I use this this gives me an error; table = Word.query_as(:w).where(&quot;w.name IN[&quot;+sqlParameter+&quot;]&quot;)"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1516749132, "post_id": 48411999, "comment_id": 83814575, "body": "Out of curiosity (because I don&#39;t know much about this sort of thing), is <code>Word.query_as(:w).where(&quot;w.name IN[&quot;+sqlParameter+&quot;]&quot;)</code> an opportunity for SQL injection? Sorry if it&#39;s a not-smart question."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1516749594, "post_id": 48411999, "comment_id": 83814730, "body": "Why would you <code>where(&quot;w.name IN[&quot;+sqlParameter+&quot;]&quot;)</code> when you could <code>where(&quot;w.name IN ?&quot;, sqlParameter)</code>? Or is <code>sqlParameter</code> a column name or other identifier?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 2, "creation_date": 1516771394, "post_id": 48411999, "comment_id": 83820325, "body": "<a href=\"http://bobby-tables.com/\" rel=\"nofollow noreferrer\">bobby-tables.com</a> - Why not <code>Word.where(name: nameArray).sum(:recordcount)</code>?"}, {"owner": {"reputation": 11, "user_id": 9259226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6994c22bb00aabf8e02e2eecc647eac?s=128&d=identicon&r=PG&f=1", "display_name": "Hasan", "link": "https://stackoverflow.com/users/9259226/hasan"}, "edited": false, "score": 0, "creation_date": 1516774050, "post_id": 48411999, "comment_id": 83821199, "body": "I&#39;m using neo4j for this situation it doesn&#39;t work ):"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9259226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6994c22bb00aabf8e02e2eecc647eac?s=128&d=identicon&r=PG&f=1", "display_name": "Hasan", "link": "https://stackoverflow.com/users/9259226/hasan"}, "edited": false, "score": 0, "creation_date": 1516748439, "post_id": 48412103, "comment_id": 83814329, "body": "Thanks, but I will use it to database inputs. When I use this this gives me an error; table = Word.query_as(:w).where(&quot;w.name IN[&quot;+sqlParameter+&quot;]&quot;)"}, {"owner": {"reputation": 992, "user_id": 1040598, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d4aa83b606d76adae7b6631d586e2aad?s=128&d=identicon&r=PG", "display_name": "Felix Livni", "link": "https://stackoverflow.com/users/1040598/felix-livni"}, "reply_to_user": {"reputation": 11, "user_id": 9259226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6994c22bb00aabf8e02e2eecc647eac?s=128&d=identicon&r=PG&f=1", "display_name": "Hasan", "link": "https://stackoverflow.com/users/9259226/hasan"}, "edited": false, "score": 0, "creation_date": 1516756104, "post_id": 48412103, "comment_id": 83816617, "body": "You might want to post a different question re ActiveNode, which I&#39;m not familiar with. I&#39;m guessing you need to escape the sqlParameter to make the database happy. If ActiveNode gives you string interpolation like ActiveRecord, then I think you want <code>Word.query_as(:w).where(&quot;w.name in (?)&quot;, [sqlParameter])</code>. Note: Why are you using IN when you only have one value?"}, {"owner": {"reputation": 11, "user_id": 9259226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6994c22bb00aabf8e02e2eecc647eac?s=128&d=identicon&r=PG&f=1", "display_name": "Hasan", "link": "https://stackoverflow.com/users/9259226/hasan"}, "edited": false, "score": 0, "creation_date": 1516773168, "post_id": 48412103, "comment_id": 83820867, "body": "I try it but it didn&#39;t. It&#39;s only the part of my code. I re-edited my post maybe you can solve it."}], "tags": [], "owner": {"reputation": 992, "user_id": 1040598, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d4aa83b606d76adae7b6631d586e2aad?s=128&d=identicon&r=PG", "display_name": "Felix Livni", "link": "https://stackoverflow.com/users/1040598/felix-livni"}, "is_accepted": false, "score": 1, "last_activity_date": 1516747616, "creation_date": 1516747616, "answer_id": 48412103, "question_id": 48411999, "link": "https://stackoverflow.com/questions/48411999/how-to-put-a-backslash-before-single-quote-for-rails/48412103#48412103", "title": "How to put a backslash before single quote for Rails?", "body": "<p>You've got it right actually. The irb is just returning the escaped representation.</p>\n\n<p>e.g.</p>\n\n<pre><code>&gt;&gt; str = \"\\\\\"\n=&gt; \"\\\\\" \n\n&gt;&gt; str.length\n=&gt; 1 \n\n&gt;&gt; puts str\n\\\n=&gt; nil\n\n&gt;&gt; puts \"Jane\\\\'s very good...\"\n=&gt; Jane\\'s very good...\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9259226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6994c22bb00aabf8e02e2eecc647eac?s=128&d=identicon&r=PG&f=1", "display_name": "Hasan", "link": "https://stackoverflow.com/users/9259226/hasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516774091, "creation_date": 1516747080, "last_edit_date": 1516774091, "question_id": 48411999, "link": "https://stackoverflow.com/questions/48411999/how-to-put-a-backslash-before-single-quote-for-rails", "title": "How to put a backslash before single quote for Rails?", "body": "<p>I typed as below:</p>\n\n<pre><code>str = \"Jane\\'s very good...\"\n# =&gt; \"Jane's very good...\"\n\nstr = \"Jane\\\\'s very good...\"\n# =&gt; \"Jane\\\\'s very good...\"\n</code></pre>\n\n<p>How can I get <code>str</code> with single quotes like:</p>\n\n<pre><code>\"Jane\\'s very good...\"\n</code></pre>\n\n<p>I'm working with neo4j(NoSQL) architecture to social media words analysing;</p>\n\n<pre><code>words = txt.split(' ')\n                notIncludingWords = Array.new\n                sqlParameter=''\n                words.each do |word|\n                    if(Word.where(name:word).first.nil?)\n                       notIncludingWords.push(word)\n                    else\n                        sqlParameter+=\",'\"+word+\"'\"\n                    end\n                end\n                sqlParameter = sqlParameter[1..sqlParameter.length-1]\n</code></pre>\n\n<p>... (Transactions...)   </p>\n\n<pre><code>table = Word.query_as(:w).where(\"w.name IN[\"+sqlParameter+\"]\")\n\n                    RecordCount = table.return(\"SUM(w.recordcount) AS recordcount\").first.recordcount.to_f\n</code></pre>\n\n<p>...(Transactions)</p>\n\n<p>When I try ro run, it gives me an error;</p>\n\n<pre><code>Cypher error:\n  [36mNeo.ClientError.Statement.SyntaxError[0m: Invalid input '\u0131': expected whitespace, '.', node labels, '[', \"=~\", IN, STARTS, ENDS, CONTAINS, IS, '^', '*', '/', '%', '+', '-', '=', \"&lt;&gt;\", \"!=\", '&lt;', '&gt;', \"&lt;=\", \"&gt;=\", AND, XOR, OR, ',' or ']' (line 1, column 71 (offset: 70))\n\"MATCH (w:`Word`) WHERE (w.name IN['26','y\u0131l','\u00f6nce','bug\u00fcn','Hasan'\u0131n','do\u011fum','g\u00fcn\u00fcd\u00fcr']) RETURN SUM(w.recordcount) AS recordcount\"\n</code></pre>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1516747531, "post_id": 48411719, "comment_id": 83814000, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18335229/how-to-add-pry-when-developing-a-ruby-gem\">How to add &quot;pry&quot; when developing a Ruby gem</a>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1516747754, "post_id": 48411719, "comment_id": 83814083, "body": "what about installing it to the system (<code>gem install</code>) and removing the pry-related stuff (require, breakpoint) before building for distribution?"}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1516748153, "creation_date": 1516748153, "answer_id": 48412206, "question_id": 48411719, "link": "https://stackoverflow.com/questions/48411719/how-to-require-pry-during-development-of-a-ruby-gem/48412206#48412206", "title": "How to require pry during development of a ruby gem?", "body": "<p>You can install it to the system and use a boolean flag to conditionally require it and set breakpoints.</p>\n\n<p><code>gem install pry</code></p>\n\n<p>Then in code, something like this:</p>\n\n<pre><code>SET_BREAKPOINTS = ENV[\"SET_BREAKPOINTS\"] == \"true\"\n\nrequire 'pry' if SET_BREAKPOINTS\n\nbinding.pry if SET_BREAKPINTS\n</code></pre>\n\n<p>To turn breakpoints on, you can manipulate <code>env</code> through code:</p>\n\n<p><code>ENV[\"SET_BREAKPOINTS\"] = \"true\"</code></p>\n\n<p>or when calling a script from bash:</p>\n\n<pre><code>env SET_BREAKPOINTS=true irb -r 'your_gem' \n</code></pre>\n"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1334, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516752048, "creation_date": 1516745680, "last_edit_date": 1516752048, "question_id": 48411719, "link": "https://stackoverflow.com/questions/48411719/how-to-require-pry-during-development-of-a-ruby-gem", "title": "How to require pry during development of a ruby gem?", "body": "<p>I'm trying to develop a ruby gem for practice and I'm wondering how do I require pry during development and test runs? Is there anyway to require the gem only during development? I'm on Ruby and not Rails and I don't think I have any environment variables setup to rely on. Is there a conventional way to do this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/fvGIB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fvGIB.png\" alt=\"enter image description here\"></a></p>\n\n<p>and</p>\n\n<p><a href=\"https://i.stack.imgur.com/foNDH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/foNDH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Currently if I run code that hits the above line, I get this error:</p>\n\n<pre><code>NoMethodError: undefined method `pry' for #&lt;Binding:0x007f8d3287c4d8&gt;\n    from /Users/jwan/programming/interview_questions/gemini/jobcoin_client/lib/jobcoin_client/requests/connection.rb:18:in `post'\n</code></pre>\n\n<p>A few questions:</p>\n\n<ol>\n<li><p>How do I properly require pry so this line doesn't throw an error when developing a gem?</p></li>\n<li><p>I read Yahuda's post but I'm still unclear why adding dependencies in the gemspec vs adding dependencies in the Gemfile. What is the difference?</p></li>\n</ol>\n\n<p>Currently, after I make changes to the ruby gem, I have to run these series of commands. Is there anything more efficient that I can do?</p>\n\n<pre><code> gem build jobcoin_client.gemspec\nWARNING:  no homepage specified\nWARNING:  open-ended dependency on pry (&gt;= 0, development) is not recommended\n  if pry is semantically versioned, use:\n    add_development_dependency 'pry', '~&gt; 0'\nWARNING:  See http://guides.rubygems.org/specification-reference/ for help\n  Successfully built RubyGem\n  Name: jobcoin_client\n  Version: 0.1.0\n  File: jobcoin_client-0.1.0.gem\n\n$ gem install jobcoin_client\nSuccessfully installed jobcoin_client-0.1.0\nParsing documentation for jobcoin_client-0.1.0\nDone installing documentation for jobcoin_client after 0 seconds\n1 gem installed\n 05:45 PM   \n$ irb\nirb(main):001:0&gt; require 'jobcoin_client'\n=&gt; true\nirb(main):002:0&gt; require 'pry'\n=&gt; false\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "spring", "railstutorial.org"], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 9259523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32c7c088b285bfd9070be62ddc3d3337?s=128&d=identicon&r=PG", "display_name": "Bruce Jackson", "link": "https://stackoverflow.com/users/9259523/bruce-jackson"}, "is_accepted": true, "score": 7, "last_activity_date": 1516753296, "creation_date": 1516753296, "answer_id": 48412986, "question_id": 48411323, "link": "https://stackoverflow.com/questions/48411323/rails-5-1-4-test-throws-nameerror-only-when-testing-fails/48412986#48412986", "title": "Rails 5.1.4 test throws NameError only when testing fails", "body": "<p>I found this thread: <a href=\"https://github.com/seattlerb/minitest/issues/730\" rel=\"noreferrer\">https://github.com/seattlerb/minitest/issues/730</a>, which promises a fix to MiniTest. The fix will be available in a future Rails update, or now via Edge Rails.</p>\n\n<p>I added a temporary entry to my <code>Gemfile</code> to revert MiniTest to the previous stable version, </p>\n\n<pre><code># temporary fix to minitest 5.11.1 issue \ngem 'minitest', '~&gt;5.10.3'\n</code></pre>\n\n<p>and then ran </p>\n\n<pre><code>bundle update minitest\n</code></pre>\n\n<p>It seems to work (but I'm still getting failed tests).</p>\n\n<p>YMMV</p>\n"}, {"tags": [], "owner": {"reputation": 129, "user_id": 6780364, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/N9rjw.jpg?s=128&g=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6780364/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1516788914, "creation_date": 1516788914, "answer_id": 48419880, "question_id": 48411323, "link": "https://stackoverflow.com/questions/48411323/rails-5-1-4-test-throws-nameerror-only-when-testing-fails/48419880#48419880", "title": "Rails 5.1.4 test throws NameError only when testing fails", "body": "<p>I found a temporary fix for this thanks to this <a href=\"https://stackoverflow.com/questions/48229515/rails-minitest-crashing-when-tests-fail\">question</a></p>\n\n<p>I explicitely included the ministest gem and remove the minitest-reporters gem (have yet to verify if the problem persists with reporters included)</p>\n\n<pre><code>gem 'minitest', '5.10.3'\n</code></pre>\n\n<p>If you are working with pg in development, this might bring other errors.  The thread also suggested to pull the rails gem (in the gemfile) from git, this would avoid downgrading any gem.</p>\n"}], "owner": {"reputation": 129, "user_id": 6780364, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/N9rjw.jpg?s=128&g=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6780364/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 1, "accepted_answer_id": 48412986, "answer_count": 2, "score": 4, "last_activity_date": 1516788914, "creation_date": 1516743849, "question_id": 48411323, "link": "https://stackoverflow.com/questions/48411323/rails-5-1-4-test-throws-nameerror-only-when-testing-fails", "title": "Rails 5.1.4 test throws NameError only when testing fails", "body": "<p>When running rails test that fails, in a 5.1.4 rails app it throws the following NameError.</p>\n\n<pre><code>Traceback (most recent call last):\n27: from -e:1:in `&lt;main&gt;'\n26: from /Users/User/.rvm/rubies/ruby-2.5.0/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n25: from /Users/User/.rvm/rubies/ruby-2.5.0/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n24: from /Users/User/.rvm/gems/ruby-2.5.0/gems/spring-2.0.2/lib/spring/application/boot.rb:19:in `&lt;top (required)&gt;'\n23: from /Users/User/.rvm/gems/ruby-2.5.0/gems/spring-2.0.2/lib/spring/application.rb:135:in `run'\n22: from /Users/User/.rvm/gems/ruby-2.5.0/gems/spring-2.0.2/lib/spring/application.rb:135:in `loop'\n21: from /Users/User/.rvm/gems/ruby-2.5.0/gems/spring-2.0.2/lib/spring/application.rb:141:in `block in run'\n20: from /Users/User/.rvm/gems/ruby-2.5.0/gems/spring-2.0.2/lib/spring/application.rb:171:in `serve'\n19: from /Users/User/.rvm/gems/ruby-2.5.0/gems/spring-2.0.2/lib/spring/application.rb:171:in `fork'\n18: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:63:in `block in autorun'\n17: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:136:in `run'\n16: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:159:in `__run'\n15: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:159:in `map'\n14: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:159:in `block in __run'\n13: from /Users/User/.rvm/gems/ruby-2.5.0/gems/railties-5.1.4/lib/rails/test_unit/line_filtering.rb:9:in `run'\n12: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:319:in `run'\n11: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:347:in `with_info_handler'\n10: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:360:in `on_signal'\n 9: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:320:in `block in run'\n 8: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:320:in `each'\n 7: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:321:in `block (2 levels) in run'\n 6: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:334:in `run_one_method'\n 5: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:785:in `record'\n 4: from /Users/v/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:785:in `each'\n 3: from /Users/User/.rvm/gems/ruby-2.5.0/gems/minitest-5.11.1/lib/minitest.rb:786:in `block in record'\n 2: from /Users/User/.rvm/gems/ruby-2.5.0/gems/railties-5.1.4/lib/rails/test_unit/reporter.rb:23:in `record'\n 1: from /Users/User/.rvm/gems/ruby-2.5.0/gems/railties-5.1.4/lib/rails/test_unit/reporter.rb:70:in `format_rerun_snippet'\n/Users/User/.rvm/gems/ruby-2.5.0/gems/railties-5.1.4/lib/rails/test_unit/reporter.rb:70:in `method': undefined method       `test_should_get_help' for class `Minitest::Result' (NameError)\n</code></pre>\n\n<p>However, if the test passes, the minitest report is shown without error messages at all.\nI tried removing the minitest-reporters gem, but the NameError message does not go away.  Seems to be related to the spring server.\nI also tried shutting down all spring ps.\nRegarding <strong>`test_should_get_help'</strong> is a simple tests and despite deleting it, the error always puts the last written test in its place.</p>\n\n<p>This is the Gemfile</p>\n\n<pre><code>    source 'https://rubygems.org'\n\ngem 'rails',                   '5.1.4'\ngem 'bcrypt',                  '3.1.11'\ngem 'faker',                   '1.7.3'\ngem 'carrierwave',             '1.2.2'\ngem 'mini_magick',             '4.7.0'\ngem 'will_paginate',           '3.1.6'\ngem 'bootstrap-will_paginate', '1.0.0'\ngem 'bootstrap-sass',          '3.3.7'\ngem 'puma',                    '3.9.1'\ngem 'sass-rails',              '5.0.6'\ngem 'uglifier',                '3.2.0'\ngem 'coffee-rails',            '4.2.2'\ngem 'jquery-rails',            '4.3.1'\ngem 'turbolinks',              '5.0.1'\ngem 'jbuilder',                '2.7.0'\n\ngroup :development, :test do\n  gem 'sqlite3', '1.3.13'\n  gem 'byebug',  '9.0.6', platform: :mri\nend\n\ngroup :development do\n  gem 'web-console',           '3.5.1'\n  gem 'listen',                '3.1.5'\n  gem 'spring',                '2.0.2'\n  gem 'spring-watcher-listen', '2.0.1'\nend\n\ngroup :test do\n  gem 'rails-controller-testing', '1.0.2'\n  gem 'minitest-reporters',       '1.1.14'\n  gem 'guard',                    '2.14.1'\n  gem 'guard-minitest',           '2.4.6'\nend\n\ngroup :production do\n  gem 'pg',  '0.20.0'\n  gem 'fog', '1.42'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n"}, {"tags": ["ruby", "sinatra", "twilio", "ngrok"], "comments": [{"owner": {"reputation": 3624, "user_id": 5615038, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wW8mP.jpg?s=128&g=1", "display_name": "fangxing", "link": "https://stackoverflow.com/users/5615038/fangxing"}, "edited": false, "score": 0, "creation_date": 1516756510, "post_id": 48410712, "comment_id": 83816715, "body": "Try <code>::Twilio::TwiML::Response</code>."}, {"owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "reply_to_user": {"reputation": 3624, "user_id": 5615038, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wW8mP.jpg?s=128&g=1", "display_name": "fangxing", "link": "https://stackoverflow.com/users/5615038/fangxing"}, "edited": false, "score": 0, "creation_date": 1516796005, "post_id": 48410712, "comment_id": 83833860, "body": "Unfortunately, that did not work."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "is_accepted": true, "score": 5, "last_activity_date": 1516811712, "creation_date": 1516811712, "answer_id": 48427412, "question_id": 48410712, "link": "https://stackoverflow.com/questions/48410712/nameerror-uninitialized-constant-twiliotwimlresponse-possibly-from-old-ap/48427412#48427412", "title": "NameError - uninitialized constant Twilio::TwiML::Response (Possibly from old API Code?)", "body": "<p>Update:</p>\n\n<p>Twilio::TwiML::Response has been replaced by Twilio::TwiML::VoiceResponse &amp; Twilio::TwiML::MessagingResponse. It worked when I changed the code to this:</p>\n\n<pre><code>def send_to_contacts(body, media_url = nil)\n  response = Twilio::TwiML::MessagingResponse.new do |r|\n    contacts_numbers.each do |num|\n      r.message to: num do |msg|\n        msg.body body\n        msg.media media_url unless media_url.nil?\n      end\n    end\n  end\n  puts response\nend\n\ndef send_to_me(from, body, media_url = nil)\n  name = contact_name(from)\n  body = \"#{name} (#{from}):\\n#{body}\"\n  response = Twilio::TwiML::MessagingResponse.new do |r|\n    r.message to: MY_NUMBER do |msg|\n      msg.body body\n      msg.media media_url unless media_url.nil?\n    end\n  end\n  puts response\nend\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 48427412, "answer_count": 1, "score": 0, "last_activity_date": 1516811712, "creation_date": 1516741190, "question_id": 48410712, "link": "https://stackoverflow.com/questions/48410712/nameerror-uninitialized-constant-twiliotwimlresponse-possibly-from-old-ap", "title": "NameError - uninitialized constant Twilio::TwiML::Response (Possibly from old API Code?)", "body": "<p>I am in need of some help with setting up a Twilio SMS Broadcast App running on Sinatra. They build is based off this tutorial: <a href=\"https://www.twilio.com/blog/2014/10/broadcast-text-and-picture-messages-using-ruby-google-spreadsheets-twilio.html\" rel=\"nofollow noreferrer\">Send Mass SMS Broadcasts in Ruby\n</a></p>\n\n<p>When I make an HTTP POST I get this message in my Terminal when running Sinatra &amp; Ngrok.</p>\n\n<pre><code>NameError - uninitialized constant Twilio::TwiML::Response\nDid you mean?  Twilio::Response:\n    broadcast.rb:75:in `send_to_me'\n    broadcast.rb:53:in `block in &lt;main&gt;'\n</code></pre>\n\n<p>The code it is having an issue with is:</p>\n\n<pre><code>def send_to_contacts(body, media_url = nil)\n  response = Twilio::TwiML::Response.new do |r|\n    contacts_numbers.each do |num|\n      r.Message to: num do |msg|\n        msg.Body body\n        msg.Media media_url unless media_url.nil?\n      end\n    end\n  end\n  response.text\nend\n\ndef send_to_me(from, body, media_url = nil)\n  name = contact_name(from)\n  body = \"#{name} (#{from}):\\n#{body}\"\n  response = Twilio::TwiML::Response.new do |r|\n    r.Message to: MY_NUMBER do |msg|\n      msg.Body body\n      msg.Media media_url unless media_url.nil?\n    end\n  end\n  response.text\nend\n</code></pre>\n\n<p>I have noticed most new Twilio walkthrus are now using API Auths &amp; Tokens with an </p>\n\n<pre><code>@client = Twilio::REST::Client.new account_sid, auth_token\n</code></pre>\n\n<p>Is this something I need to be implementing? Any guidance on how I can migrate these two methods to that type of format and keep my features?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1516739961, "post_id": 48410359, "comment_id": 83810472, "body": "What if in the methods you add a <code>+= 1</code> counter? And then at the end see what the count is. That way you can verify the action succeeded as well."}, {"owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 1, "creation_date": 1516739963, "post_id": 48410359, "comment_id": 83810474, "body": "I&#39;m a bit confused. If your test adapts itself to always pass, then what is the point of the test?"}, {"owner": {"reputation": 1820, "user_id": 5830835, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/29a99125813cee34a6ecfe0d0e432eb1?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy Von Heiss ", "link": "https://stackoverflow.com/users/5830835/timmy-von-heiss"}, "reply_to_user": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 0, "creation_date": 1516741332, "post_id": 48410359, "comment_id": 83811187, "body": "@Drenmi i am going to check if the jobs have been added to the background job queue."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1516741691, "post_id": 48410359, "comment_id": 83811345, "body": "@TimmyVonHeiss Then why don&#39;t you write a test for precisely what you just said? Testing that &quot;the number of times a method was called == the number of scheduled jobs&quot; is an absurdly fuzzy test! I could make it pass with completely the wrong code!"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1516741747, "post_id": 48410359, "comment_id": 83811388, "body": "Tests that &quot;always pass&quot; are useless. If the behaviour changes, you should <i>want</i> your test to fail."}, {"owner": {"reputation": 1820, "user_id": 5830835, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/29a99125813cee34a6ecfe0d0e432eb1?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy Von Heiss ", "link": "https://stackoverflow.com/users/5830835/timmy-von-heiss"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516742083, "post_id": 48410359, "comment_id": 83811559, "body": "@TomLord I am going to count the number of jobs that are going to be scheduled (x) and then add a test that says (were x jobs scheduled?)... this will be on top of other tests... otherwise, if someone adds another job to be scheduled without a test, how do we test for that?"}, {"owner": {"reputation": 1820, "user_id": 5830835, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/29a99125813cee34a6ecfe0d0e432eb1?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy Von Heiss ", "link": "https://stackoverflow.com/users/5830835/timmy-von-heiss"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516742238, "post_id": 48410359, "comment_id": 83811632, "body": "@TomLord otherwise, say i have 4 tests, (were jobs # 1/2/3/4 scheduled?).. now someone adds job #5.. ?? i need a test to fail for that."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1516743009, "post_id": 48410359, "comment_id": 83811981, "body": "Okay, then do exactly that! Write a test to say <code>expect(number_of_scheduled_jobs).to eq 4</code>. And if someone adds job #5 to that method, the test fails. I don&#39;t see any need for a mechanism of <i>programatically determining</i> how many jobs were supposed to get scheduled."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 3, "creation_date": 1516743117, "post_id": 48410359, "comment_id": 83812034, "body": "This is a classic example of an XY problem: You&#39;re looking for an answer to the wrong question. A better question might, perhaps, be: How do I determine the number of <code>ActiveJob</code> jobs that got scheduled?"}, {"owner": {"reputation": 1820, "user_id": 5830835, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/29a99125813cee34a6ecfe0d0e432eb1?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy Von Heiss ", "link": "https://stackoverflow.com/users/5830835/timmy-von-heiss"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516747362, "post_id": 48410359, "comment_id": 83813935, "body": "@TomLord good point"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1516783474, "post_id": 48410359, "comment_id": 83825837, "body": "@TimmyVonHeiss what if you decide to extract some of the method calls into another method? A test that is counting method invocations will fail, because it is testing the <i>implementation</i> (i.e. <i>how</i> the method is working). Instead you should test the <i>behaviour</i> (i.e. <i>what</i> the method is doing). Regarding testing for changes: RSpec comes with a <a href=\"https://relishapp.com/rspec/rspec-expectations/v/3-7/docs/built-in-matchers/change-matcher\" rel=\"nofollow noreferrer\">change matcher</a>, e.g. <code>expect { schedule_jobs }.to change { scheduled_jobs_count }.by(4)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1516782770, "post_id": 48410598, "comment_id": 83825452, "body": "<code>self.class</code> is not needed \u2013 instance methods can directly access constants."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1516782932, "post_id": 48410598, "comment_id": 83825533, "body": "In this particular instance, you are precisely correct."}, {"owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 0, "creation_date": 1516794554, "post_id": 48410598, "comment_id": 83832943, "body": "The call to <code>#constantize</code> is also not needed, as you can just reference the constants in the array instead of using strings."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 0, "creation_date": 1516796295, "post_id": 48410598, "comment_id": 83834025, "body": "@Drenmi referencing the constants in the array could trigger Ruby&#39;s auto loading mechanism which might not be desired. I&#39;d use symbols."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1516821869, "post_id": 48410598, "comment_id": 83850926, "body": "I&#39;d use <code>JOBS = [:Bar]</code> and <code>JOBS.each { |job| Object.const_get(job).schedule! }</code>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1516829304, "post_id": 48410598, "comment_id": 83854887, "body": "Interesting. Is that a preference? Or, is there a specific benefit?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1516859533, "post_id": 48410598, "comment_id": 83864147, "body": "Kind of, I prefer pure Ruby solutions. <code>:Bar</code> is the way Ruby represents constants (try <code>Object.constants</code>) and <code>const_get</code> is a built-in method, too."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1516859892, "post_id": 48410598, "comment_id": 83864294, "body": "Excellent. I can appreciate steering towards pure Ruby. Thank you for the insight! Learn something new every day..."}, {"owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 1, "creation_date": 1516964048, "post_id": 48410598, "comment_id": 83912685, "body": "Not sure how referencing a class constant directly is somehow not &quot;pure Ruby&quot;. Do you also do <code>Object.const_get(:User).find(...)</code>? The autoloading is an interesting point. I think since that needs to be registered explicitly, the user would have some idea what they&#39;re doing. (Although this is not always the case.) One downside of using symbols or strings is you lose all features of your editor or IDE relating to refactoring, finding usages, etc."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 2, "last_activity_date": 1516811899, "last_edit_date": 1516811899, "creation_date": 1516740700, "answer_id": 48410598, "question_id": 48410359, "link": "https://stackoverflow.com/questions/48410359/is-it-possible-to-count-the-number-of-actions-inside-of-a-method/48410598#48410598", "title": "is it possible to count the number of actions inside of a method?", "body": "<p>What about doing something like:</p>\n\n<pre><code>class Foo\n\n  JOBS_TO_SCHEDULE = %w(\n    User\n    Activity\n    Event\n    Notify\n  ).freeze\n\n  def schedule_jobs\n    self.class::JOBS_TO_SCHEDULE.each do |job_to_schedule|\n      job_to_schedule.constantize.schedule!\n    end\n  end\n\nend\n</code></pre>\n\n<p>Then, you could always interrogate <code>Foo::JOBS_TO_SCHEDULE</code> to see how many jobs you expected to schedule.</p>\n\n<p><strong>Following up on the comments:</strong></p>\n\n<blockquote>\n  <p>The call to #constantize is also not needed, as you can just reference the constants in the array instead of using strings.</p>\n</blockquote>\n\n<p>Assume I have a class <code>Foo</code> like this:</p>\n\n<pre><code>class Foo\n\n  JOBS_TO_SCHEDULE = %w(\n    Baz\n  ).freeze\n\n  def schedule_jobs\n    JOBS_TO_SCHEDULE.each do |job_to_schedule|\n      puts job_to_schedule.class.name\n      job_to_schedule.schedule!\n    end\n  end\n\nend\n</code></pre>\n\n<p>And that I have a class, <code>Baz</code> like this:</p>\n\n<pre><code>class Baz\n\n  class &lt;&lt; self \n\n    def schedule!\n      puts \"scheduled!\"\n    end\n\n  end\n\nend\n</code></pre>\n\n<p>If I call <code>Foo.new.schedule_jobs</code> then I get:</p>\n\n<pre><code>&gt; Foo.new.schedule_jobs\nString\nNoMethodError: undefined method `schedule!' for \"Baz\":String\n</code></pre>\n\n<p>As can be seen, <code>job_to_schedule</code> is a <code>String</code> (because, that's what <code>%w()</code> does, creates an array of <code>String</code>s). So, I get the <code>NoMethodError</code> because <code>String</code> doesn't respond to <code>schedule!</code>.</p>\n\n<p>If, however, I include <code>constantize</code>, like this:</p>\n\n<pre><code>class Foo\n\n  JOBS_TO_SCHEDULE = %w(\n    Baz\n  ).freeze\n\n  def schedule_jobs\n    JOBS_TO_SCHEDULE.each do |job_to_schedule|\n      puts job_to_schedule.class.name\n      job_to_schedule.constantize.schedule!\n    end\n  end\n\nend\n</code></pre>\n\n<p>Then, when calling <code>Foo.new.schedule_jobs</code>, I get:</p>\n\n<pre><code>&gt; Foo.new.schedule_jobs\nString\nscheduled!\n</code></pre>\n\n<p>So, the call to <code>#constantize</code> <em>is</em> needed.</p>\n\n<p>Now, I <em>could</em> do this:</p>\n\n<pre><code>class Foo\n\n  JOBS_TO_SCHEDULE = [\n    Baz\n  ].freeze\n\n  def schedule_jobs\n    JOBS_TO_SCHEDULE.each do |job_to_schedule|\n      puts job_to_schedule.class.name\n      job_to_schedule.schedule!\n    end\n  end\n\nend\n</code></pre>\n\n<p>In which case, if I do <code>Foo.new.schedule_jobs</code>, I get:</p>\n\n<pre><code>&gt; Foo.new.schedule_jobs\nClass\nscheduled!\n</code></pre>\n\n<p>And all is good.</p>\n\n<blockquote>\n  <p>self.class is not needed \u2013 instance methods can directly access constants.</p>\n</blockquote>\n\n<p>Assume I have a class <code>Bar</code> like this:</p>\n\n<pre><code>class Bar &lt; Foo\nend\n</code></pre>\n\n<p>If I do <code>Bar.new.schedule_jobs</code>, then I get:</p>\n\n<pre><code>&gt; Bar.new.schedule_jobs\nString\nscheduled!\n</code></pre>\n\n<p>So, the comment is correct.</p>\n\n<blockquote>\n  <p>referencing the constants in the array could trigger Ruby's auto loading mechanism which might not be desired. I'd use symbols.</p>\n</blockquote>\n\n<p>If I have:</p>\n\n<pre><code>class Foo\n\n  JOBS_TO_SCHEDULE = [\n    :baz\n  ].freeze\n\n  def schedule_jobs\n    JOBS_TO_SCHEDULE.each do |job_to_schedule|\n      puts job_to_schedule.class.name\n      job_to_schedule.schedule!\n    end\n  end\n\nend\n</code></pre>\n\n<p>Then when I do <code>Foo.new.schedule_jobs</code>, I get:</p>\n\n<pre><code>&gt; Foo.new.schedule_jobs\nSymbol\nNoMethodError: undefined method `schedule!' for :baz:Symbol\n</code></pre>\n\n<p>As expected. And, naturally, this doesn't work either:</p>\n\n<pre><code>class Foo\n\n  JOBS_TO_SCHEDULE = [\n    :baz\n  ].freeze\n\n  def schedule_jobs\n    JOBS_TO_SCHEDULE.each do |job_to_schedule|\n      puts job_to_schedule.class.name\n      job_to_schedule.constantize.schedule!\n    end\n  end\n\nend\n</code></pre>\n\n<p>When I do <code>Foo.new.schedule_jobs</code>, I get:</p>\n\n<pre><code>&gt; Foo.new.schedule_jobs\nSymbol\nNoMethodError: undefined method `constantize' for :baz:Symbol\n</code></pre>\n\n<p>Because I'm trying to constantize a symbol. I <em>could</em> do:</p>\n\n<pre><code>class Foo\n\n  JOBS_TO_SCHEDULE = [\n    :baz\n  ].freeze\n\n  def schedule_jobs\n    JOBS_TO_SCHEDULE.each do |job_to_schedule|\n      puts job_to_schedule.class.name\n      job_to_schedule.to_s.camelize.constantize.schedule!\n    end\n  end\n\nend\n</code></pre>\n\n<p>In which case, when I do <code>Foo.new.schedule_jobs</code>, I get:</p>\n\n<pre><code>&gt; Foo.new.schedule_jobs\nSymbol\nscheduled!\n</code></pre>\n\n<p>And all is good again. (But, I had to do <code>.to_s.camelize</code>, which is some typing I'd rather avoid.)</p>\n"}], "owner": {"reputation": 1820, "user_id": 5830835, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/29a99125813cee34a6ecfe0d0e432eb1?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy Von Heiss ", "link": "https://stackoverflow.com/users/5830835/timmy-von-heiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 48410598, "answer_count": 1, "score": 1, "last_activity_date": 1516811899, "creation_date": 1516739750, "question_id": 48410359, "link": "https://stackoverflow.com/questions/48410359/is-it-possible-to-count-the-number-of-actions-inside-of-a-method", "title": "is it possible to count the number of actions inside of a method?", "body": "<p>i am not sure if 'action' is the right word to use, but suppose you have a method that looks something like this:</p>\n\n<pre><code>def schedule_jobs\n  User.schedule!      \n  Activity.schedule!      \n  Event.schedule!\n  Notify.schedule! \nend\n</code></pre>\n\n<p>What I am looking for is to run some kind of function on the schedule_jobs method that will return 4. </p>\n\n<p>I want it because I will create a test that says makes sure 4 jobs were scheduled, however, that would require me to manually change 4 to 5 when I add <code>Report.schedule!</code> next week. </p>\n"}, {"tags": ["mysql", "ruby", "multithreading"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516740132, "post_id": 48410325, "comment_id": 83810554, "body": "It&#39;s worth noting that if you&#39;re just getting started with Ruby the &quot;new&quot; hash notation is often less clutter: <code>Mysql2::Client.new(host: &#39;localhost&#39;, username: ...)</code> where <code>{ x: y }</code> is equivalent to <code>{ :x =&gt; y }</code>."}, {"owner": {"reputation": 15, "user_id": 6534812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c83c25a3d7b505a51d7b623f0346c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/6534812/ulysses"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516740484, "post_id": 48410325, "comment_id": 83810730, "body": "I made it, thanks. any advice about the open connection of mysql, and the threads are right?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516740718, "post_id": 48410325, "comment_id": 83810848, "body": "You&#39;ll also want to omit empty arguments, like <code>new()</code> becomes simply <code>new</code>."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6534812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c83c25a3d7b505a51d7b623f0346c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/6534812/ulysses"}, "edited": false, "score": 0, "creation_date": 1516748384, "post_id": 48410641, "comment_id": 83814311, "body": "thanks, when all the threads are finished i suppose that i need to close the connection?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 15, "user_id": 6534812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c83c25a3d7b505a51d7b623f0346c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/6534812/ulysses"}, "edited": false, "score": 0, "creation_date": 1516750922, "post_id": 48410641, "comment_id": 83815154, "body": "Unless you&#39;re creating and destroying a lot of threads that&#39;s not normally an issue, but if you are you should make an effort to close the connection on thread termination."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 665, "user_id": 10306509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEjY3.jpg?s=128&g=1", "display_name": "Ivan Olshansky", "link": "https://stackoverflow.com/users/10306509/ivan-olshansky"}, "edited": false, "score": 1, "creation_date": 1565287075, "post_id": 48410641, "comment_id": 101316152, "body": "@IvanOlshansky That should have been <code>Thread.current[:db]</code> and fixed. Thanks for pointing that out."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1565287059, "last_edit_date": 1565287059, "creation_date": 1516740888, "answer_id": 48410641, "question_id": 48410325, "link": "https://stackoverflow.com/questions/48410325/ruby-threads-and-mysql-connection/48410641#48410641", "title": "Ruby Threads and MySQL connection", "body": "<p>When doing multi-threaded code in Ruby you'll need to be careful about not sharing resources like database connections between threads unless the driver makes it abundantly clear that kind of operation is supported. The ones I'm familiar with don't, and Mysql2 is not thread safe that way.</p>\n\n<p>You can use <code>Thread[:db]</code> to store a local database connection per-thread, like:</p>\n\n<pre><code>def db\n  Thread.current[:db] ||= Mysql2::Client.new(...)\nend\n</code></pre>\n\n<p>Where then you can refer to it like this:</p>\n\n<pre><code>db.query(...)\n</code></pre>\n\n<p>That will automatically instantiate the connection as required.</p>\n\n<p>It's worth noting that <code>mysql2</code> is a low-level driver and isn't very pleasant to use. A higher level abstraction like <a href=\"http://sequel.jeremyevans.net\" rel=\"nofollow noreferrer\">Sequel</a> provides a number of significant benefits: Migrations, (optional) model layer, and a very robust query builder with support for placeholder values and easy escaping.</p>\n"}], "owner": {"reputation": 15, "user_id": 6534812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c83c25a3d7b505a51d7b623f0346c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/6534812/ulysses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 48410641, "answer_count": 1, "score": 1, "last_activity_date": 1565287059, "creation_date": 1516739640, "question_id": 48410325, "link": "https://stackoverflow.com/questions/48410325/ruby-threads-and-mysql-connection", "title": "Ruby Threads and MySQL connection", "body": "<p>I'm trying the Ruby Threads, i have a simple script that need to iterate a json for getting certain data, all works fine but in one moment the shell shows:</p>\n\n<pre><code>`_query': This connection is in use by: #&lt;Thread:0x00007f9c73973eb8@thread.rb:62 sleep&gt; (Mysql2::Error)\n</code></pre>\n\n<p>How can i close that connection that i need for the data.</p>\n\n<p>And the most important, the Threads are actually in the right way?</p>\n\n<p>This is the script, it will run with a crontab:</p>\n\n<pre><code>require 'firebase'\nrequire 'conekta'\nrequire 'json'\nrequire 'savon'\nrequire \"crack\"\nrequire 'active_support/core_ext/hash'  #from_xml \nrequire 'nokogiri'\nrequire 'xmlsimple'\nrequire 'mysql2'\n\nclass Cron  \n\n    def generate_activation_code(size = 10)\n        charset = %w{ 1 2 3 4 5 6 7 8 9 A B C D E F G H I J K L M N O P Q R S T U V W X Y Z}\n        (0...size).map{ charset.to_a[rand(charset.size)] }.join\n    end\n\n    def construct()\n        base_uri = 'FIREBASE_URL'\n        file = File.open(\"FIREBASE_CREDENTIALS\", \"rb\")\n        firebase = Firebase::Client.new(base_uri, file.read)\n        Conekta.locale = :es\n        Conekta.api_key = 'MY_KEY'\n        @response = firebase.get('users', nil)\n        @client = Savon.client(wsdl: 'MY_URL', ntlm: [\"user\", \"pass\"] , :convert_request_keys_to =&gt; :camelcase )\n        @client_mysql = Mysql2::Client.new(:host =&gt; \"localhost\", :username =&gt; \"root\", :password =&gt; \"\", :database =&gt; \"masaldo_api\")\n    end\n\n    def get_comision()\n        last_validity = @client_mysql.query(\"SELECT comision * 100 as comision FROM configuration\")\n        last_validity.each do |validityr|\n            @comision = validityr[\"comision\"]\n        end   \n    end\n\n    def create_transaction(sku, token, phone, userid, card)\n        validity = @client_mysql.query(\"SELECT precio * 100 as precio_total, vigencia, descripcion, precio as precio_base FROM bluesoft_services_validity WHERE sku='#{sku}'\")\n        validity.each do |row|\n            @vigencia = row[\"vigencia\"]\n            @descipcion = row[\"descripcion\"]\n            @precio = row[\"precio_total\"]\n            @precio_base = row[\"precio_base\"].to_i\n        end\n        if @vigencia.to_i &gt; 0\n            last_current = @client_mysql.query(\"SELECT * FROM transactions WHERE number='#{phone}' ORDER BY trandate DESC LIMIT 1\")                             \n            last_current.each do |last|\n                @trandate = last[\"trandate\"]\n                @trandate_result = @trandate.strftime(\"%Y%m%d %H:%M:%S\")                        \n            end              \n        end\n        @last_with_validty = (@trandate + (@vigencia).to_i.day).strftime(\"%Y-%m-%d\") \n        @today = (Time.now).strftime(\"%Y-%m-%d\") \n        if @last_with_validty == @today\n           conekta_charges = Conekta::Order.create({\n                            :currency =&gt; \"MXN\",\n                            :customer_info =&gt; {\n                                :customer_id =&gt; user['customer_id']\n                        },\n                        :line_items =&gt; [{\n                            :name =&gt; @descipcion,\n                            :unit_price =&gt; @precio.to_i,\n                            :quantity =&gt; 1\n                        },\n                        {\n                            :name =&gt; 'Comision de Recarga',\n                            :unit_price =&gt; @comision.to_i,\n                            :quantity =&gt; 1\n                        }],\n                            :charges =&gt; [{\n                                :payment_method =&gt; {\n                                    :type =&gt; \"card\",\n                                    :payment_source_id =&gt; user['fav_card']\n                            }\n                        }]\n                    })\n                    if conekta_charges['payment_status'] == 'paid'\n                        begin  \n                            response = @client.call(:venta, message: { 'sku' =&gt; 'TELCPA100MXN', 'fechaLocal' =&gt; '20180117 14:55:00', 'referencia' =&gt; '818181818181', 'monto' =&gt; '100', 'id_cadena' =&gt; '30', 'id_tienda' =&gt; '30', 'id_terminal' =&gt; '1', 'folio' =&gt; 'LUCOPCIHOW' })                        \n                            parameters = response.body\n                            parameters.each do |response, data|\n                                if data[:return][:respuesta][:codigo_respuesta] == 0\n                                    puts data[:return][:respuesta]\n                                else\n                                    puts data[:return][:respuesta]\n                                end\n                            end \n                        rescue Exception =&gt; e  \n                            puts e.message  \n                            puts e.backtrace.inspect  \n                        end \n                    end\n        end  \n    end\n\n    def init()\n        threads = []        \n        hash = @response.body\n        hash.each do |token , user|\n            threads &lt;&lt;  Thread.new do \n                #Check if user is current for transaction if not need to check agenda\n                if user['is_current']                   \n                    self.create_transaction(user['sku'], token, user['phoneNumber'], user['customer_id'], user['fav_card'])   \n                    user['addressBook'].each do |userid , user_address_book|\n                        if user['is_current']   \n                            replacements = { '+521' =&gt; '' }\n                            phone_number =  user_address_book['phoneNumber'].gsub(Regexp.union(replacements.keys), replacements)                                                    \n                            self.create_transaction(user_address_book['sku'], token, phone_number, user['customer_id'], user_address_book['fav_card'])\n                        end\n                    end\n                end\n            end            \n        end\n        threads.each { |t| t.join  }  \n    end\nend\n\nclassCron = Cron.new()\nclassCron.construct()\nclassCron.get_comision()\nclassCron.init()\n</code></pre>\n\n<p>Regards</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "internationalization"], "comments": [{"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 0, "creation_date": 1516738854, "post_id": 48409998, "comment_id": 83809912, "body": "Did you try restarting the server?"}, {"owner": {"reputation": 169, "user_id": 5455070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399d93a061baaf69edaed19dddf44920?s=128&d=identicon&r=PG&f=1", "display_name": "yakattack", "link": "https://stackoverflow.com/users/5455070/yakattack"}, "reply_to_user": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 0, "creation_date": 1516741041, "post_id": 48409998, "comment_id": 83811027, "body": "Yep I tried that, unfortunately didn&#39;t change anything."}, {"owner": {"reputation": 152, "user_id": 8427339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c30927640251ca31a1ed01cf4eb412b?s=128&d=identicon&r=PG&f=1", "display_name": "Tashi Dendup", "link": "https://stackoverflow.com/users/8427339/tashi-dendup"}, "edited": false, "score": 0, "creation_date": 1593269189, "post_id": 48409998, "comment_id": 110722964, "body": "See if this help <a href=\"https://stackoverflow.com/questions/808547/fully-custom-validation-error-message-with-rails\" title=\"fully custom validation error message with rails\">stackoverflow.com/questions/808547/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 5455070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399d93a061baaf69edaed19dddf44920?s=128&d=identicon&r=PG&f=1", "display_name": "yakattack", "link": "https://stackoverflow.com/users/5455070/yakattack"}, "edited": false, "score": 0, "creation_date": 1516741773, "post_id": 48410198, "comment_id": 83811403, "body": "Updating my locale file to this produced the following error message: &quot;Seller addresses street1 Addresses Street Line 1 can&#39;t be blank.&quot; I&#39;m starting to think you can&#39;t use .full_messages with locale file based i18n."}, {"owner": {"reputation": 535, "user_id": 3134957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qutnS.jpg?s=128&g=1", "display_name": "Anurag Aryan", "link": "https://stackoverflow.com/users/3134957/anurag-aryan"}, "reply_to_user": {"reputation": 169, "user_id": 5455070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399d93a061baaf69edaed19dddf44920?s=128&d=identicon&r=PG&f=1", "display_name": "yakattack", "link": "https://stackoverflow.com/users/5455070/yakattack"}, "edited": false, "score": 0, "creation_date": 1516742040, "post_id": 48410198, "comment_id": 83811539, "body": "@yakattack If you just want the message you can change the full_messages format to have just the <code>%{message}</code>."}], "tags": [], "owner": {"reputation": 535, "user_id": 3134957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qutnS.jpg?s=128&g=1", "display_name": "Anurag Aryan", "link": "https://stackoverflow.com/users/3134957/anurag-aryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1516742148, "last_edit_date": 1516742148, "creation_date": 1516739080, "answer_id": 48410198, "question_id": 48409998, "link": "https://stackoverflow.com/questions/48409998/trying-to-override-activerecord-field-and-model-name-with-rails-i18n/48410198#48410198", "title": "Trying to override ActiveRecord field and model name with Rails I18n", "body": "<p>You need to define i18n errors like this in your <code>errors.en.yml</code> file.</p>\n\n<pre><code>en:\n  activerecord:\n      attributes:\n      errors:\n        full_messages:\n          format: \"%{attribute} %{message}\"         # You can change your error format here.\n        models:\n        seller_address:\n          attributes:\n            name:\n              blank: 'Addresses Name can't be blank.'\n            street1:\n              blank: 'Addresses Street Line 1 can't be blank.'\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 5455070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399d93a061baaf69edaed19dddf44920?s=128&d=identicon&r=PG&f=1", "display_name": "yakattack", "link": "https://stackoverflow.com/users/5455070/yakattack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 441, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516742148, "creation_date": 1516738173, "question_id": 48409998, "link": "https://stackoverflow.com/questions/48409998/trying-to-override-activerecord-field-and-model-name-with-rails-i18n", "title": "Trying to override ActiveRecord field and model name with Rails I18n", "body": "<p>I'm using Rails 5.2.1, and trying to override the names of some ActiveRecord models and fields. </p>\n\n<p>I know that Rails is picking up the English locale file because when I add the following to <code>locales/en.yml</code>, my form labels are updated to the correct values:</p>\n\n<pre><code>en:\n  activerecord:\n    models:\n      seller_address: \"Address\"\n    attributes:\n      seller_address:\n        name: \"Name\"\n        street1: \"Street Line 1\"\n        postal_code: \"Postal Code\"\n</code></pre>\n\n<p>But when I call <code>@seller_address.errors.full_messages</code> I'm still seeing the old field and model values. For example, this:</p>\n\n<pre><code>Seller addresses name can't be blank\n\nSeller addresses street1 can't be blank\n\nSeller addresses postal code can't be blank\n</code></pre>\n\n<p>should be this:</p>\n\n<pre><code>Addresses Name can't be blank\n\nAddresses Street Line 1 can't be blank\n\nAddresses Postal Code can't be blank\n</code></pre>\n\n<p>What can I do to tell Rails to use my locale overrides for ActiveRecord validation error messages?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 4243, "user_id": 4638378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pGqPN.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4638378/brian"}, "edited": false, "score": 0, "creation_date": 1516738539, "post_id": 48409649, "comment_id": 83809748, "body": "I followed your steps and <code>foo.txt</code> is being created as expected. Did you put the auto-load additions into <code>config&#47;application.rb</code>? Maybe spring is causing an issue? Try <code>spring stop</code> before <code>rails console</code>."}, {"owner": {"reputation": 696, "user_id": 7314004, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/95806024183ca05eed5c8a100c610ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter H&#248;jlund Andersen", "link": "https://stackoverflow.com/users/7314004/peter-h%c3%b8jlund-andersen"}, "edited": false, "score": 0, "creation_date": 1516738681, "post_id": 48409649, "comment_id": 83809819, "body": "Try to run <code>$ bin&#47;rails r &#39;puts ActiveSupport::Dependencies.autoload_paths&#39;</code> in the console to see what paths is autoladed."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516741917, "post_id": 48409649, "comment_id": 83811464, "body": "To add things to the path use <code>Rails.root.join(&#39;scripts&#39;)</code> as it&#39;s cleaner than the version you have here."}, {"owner": {"reputation": 25, "user_id": 7872504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yky7p.jpg?s=128&g=1", "display_name": "C&#225;ssio Pagnoncelli", "link": "https://stackoverflow.com/users/7872504/c%c3%a1ssio-pagnoncelli"}, "reply_to_user": {"reputation": 696, "user_id": 7314004, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/95806024183ca05eed5c8a100c610ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter H&#248;jlund Andersen", "link": "https://stackoverflow.com/users/7314004/peter-h%c3%b8jlund-andersen"}, "edited": false, "score": 0, "creation_date": 1516755568, "post_id": 48409649, "comment_id": 83816459, "body": "I followed the suggestions. They appear in autoload_paths, as pointed out by @peter-andersen, but are not loaded. Stopping spring also didn&#39;t help."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 7872504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yky7p.jpg?s=128&g=1", "display_name": "C&#225;ssio Pagnoncelli", "link": "https://stackoverflow.com/users/7872504/c%c3%a1ssio-pagnoncelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1516756453, "creation_date": 1516756453, "answer_id": 48413401, "question_id": 48409649, "link": "https://stackoverflow.com/questions/48409649/rails-wont-load-custom-ruby-scripts/48413401#48413401", "title": "Rails won&#39;t load custom Ruby scripts", "body": "<p>Just found out.</p>\n\n<p>Turns out Rails loads classes and modules only when name <em>conforms</em> to the file name.</p>\n\n<p>For example, <code>scripts/schemes/foo_name.rb</code> contents to be</p>\n\n<pre><code>module FooName\n  # ...\nend\n</code></pre>\n\n<p>or</p>\n\n<pre><code>class FooName\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7872504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yky7p.jpg?s=128&g=1", "display_name": "C&#225;ssio Pagnoncelli", "link": "https://stackoverflow.com/users/7872504/c%c3%a1ssio-pagnoncelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516756453, "creation_date": 1516736754, "question_id": 48409649, "link": "https://stackoverflow.com/questions/48409649/rails-wont-load-custom-ruby-scripts", "title": "Rails won&#39;t load custom Ruby scripts", "body": "<p>So I just created a <code>/scripts</code> directory. Scripts are auto loaded with</p>\n\n<pre><code>config.autoload_paths += [\"#{Rails.root}/scripts\"]\nconfig.eager_load_paths += [\"#{Rails.root}/scripts\"]\n</code></pre>\n\n<h1>Problem</h1>\n\n<p>Also there are scripts within <code>scripts/schemes/*.rb</code> which should be run but they are not.</p>\n\n<p><em>Example</em>. Write a sample script <code>scripts/schemes/write.rb</code> with</p>\n\n<pre><code>File.open('foo.txt', 'w') do |f|\n  f.write('123')\nend\n</code></pre>\n\n<p>and go to the console, <code>rails console</code>. You'll see no file with be created whereas <code>foo.txt</code> was expected to be created.</p>\n\n<p>How can these files living in <code>scripts/schemes/</code> be executed at startup?</p>\n\n<h3>Failed attempts to solve the problem</h3>\n\n<ul>\n<li><p>Have <code>/scripts/main.rb</code> requiring (<code>require</code>) or loading (<code>load</code>) the files at <code>scripts/schemes/*.rb</code>. <em>Clarification: since files were already loaded in application.rb <code>autoload_paths</code> Rails will throw an error.</em></p></li>\n<li><p>Include <code>scripts/schemes</code> in <code>config.autoload_paths</code>. <em>Clarification: nothing changes.</em></p></li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "sphinx", "thinking-sphinx", "ruby-1.9.3"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1516736866, "post_id": 48409267, "comment_id": 83808833, "body": "change total_entries to count or length..."}, {"owner": {"reputation": 48, "user_id": 3469455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZFMH.jpg?s=128&g=1", "display_name": "shorepound", "link": "https://stackoverflow.com/users/3469455/shorepound"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1516737871, "post_id": 48409267, "comment_id": 83809395, "body": "I&#39;ve done that, and that&#39;s fine it does resolve the &#39;error&#39;. However, I am wondering why my results are not coming through. If I run <code>&gt;&gt; ids = Business.simple_search_for_ids_with_location(&#39;surf&#39;, &#39;atlantic beach&#39;, &#39;fl&#39;, {}, :per_page =&gt; 2500)</code> in the console I get an empty array. I know for a fact that there are businesses in that fit that search criteria."}, {"owner": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "edited": false, "score": 0, "creation_date": 1516779068, "post_id": 48409267, "comment_id": 83823608, "body": "Which version of Thinking Sphinx are you using, and which version were you using on 1.8.7? Also, can you share the Sphinx index definition for your Business model?"}, {"owner": {"reputation": 48, "user_id": 3469455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZFMH.jpg?s=128&g=1", "display_name": "shorepound", "link": "https://stackoverflow.com/users/3469455/shorepound"}, "edited": false, "score": 0, "creation_date": 1516805902, "post_id": 48409267, "comment_id": 83840609, "body": "Using 1.4.11 now was using 1.4 with ruby 1.8.7 here&#39;s the index: <a href=\"https://gist.github.com/shorepound/c7eefb49a75761324406e0e574b81b47\" rel=\"nofollow noreferrer\">gist.github.com/shorepound/c7eefb49a75761324406e0e574b81b47</a>"}, {"owner": {"reputation": 48, "user_id": 3469455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZFMH.jpg?s=128&g=1", "display_name": "shorepound", "link": "https://stackoverflow.com/users/3469455/shorepound"}, "edited": false, "score": 0, "creation_date": 1516806095, "post_id": 48409267, "comment_id": 83840786, "body": "I updated riddle from 1.3.3 to 1.5 and now I&#39;m getting an error: <code>ThinkingSphinx::SphinxError: index business_core: sort-by attribute &#39;business_name_sort&#39; not found</code>"}, {"owner": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "edited": false, "score": 0, "creation_date": 1516833978, "post_id": 48409267, "comment_id": 83857187, "body": "With the updated riddle, can you run <code>rake ts:rebuild</code> and then see if that helps with the search?"}, {"owner": {"reputation": 48, "user_id": 3469455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZFMH.jpg?s=128&g=1", "display_name": "shorepound", "link": "https://stackoverflow.com/users/3469455/shorepound"}, "reply_to_user": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "edited": false, "score": 0, "creation_date": 1516840609, "post_id": 48409267, "comment_id": 83859278, "body": "<code>rake ts:rebuild</code> aborted execution expired. @pat I thank you for helping me."}, {"owner": {"reputation": 48, "user_id": 3469455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZFMH.jpg?s=128&g=1", "display_name": "shorepound", "link": "https://stackoverflow.com/users/3469455/shorepound"}, "reply_to_user": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "edited": false, "score": 0, "creation_date": 1516841134, "post_id": 48409267, "comment_id": 83859416, "body": "Here&#39;s the trace <a href=\"https://gist.github.com/shorepound/c66b1a14a6c56a87053f8adad5c97434\" rel=\"nofollow noreferrer\">gist.github.com/shorepound/c66b1a14a6c56a87053f8adad5c97434</a> again @pat I am very grateful for your help."}, {"owner": {"reputation": 48, "user_id": 3469455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZFMH.jpg?s=128&g=1", "display_name": "shorepound", "link": "https://stackoverflow.com/users/3469455/shorepound"}, "edited": false, "score": 0, "creation_date": 1516842526, "post_id": 48409267, "comment_id": 83859740, "body": "I killed the pid for the searchd and successfully ran ts:rebuild, unfortunately, same error."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1516850366, "post_id": 48409267, "comment_id": 83861578, "body": "Sometimes you need to delete the application&#39;s /db/sphinx directory prior to running the rebuild (I don&#39;t think you&#39;re supposed to have to, but it&#39;s worked for me in the past)."}, {"owner": {"reputation": 48, "user_id": 3469455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZFMH.jpg?s=128&g=1", "display_name": "shorepound", "link": "https://stackoverflow.com/users/3469455/shorepound"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1516878807, "post_id": 48409267, "comment_id": 83874104, "body": "No luck, but thank you @BradWerth"}, {"owner": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "edited": false, "score": 1, "creation_date": 1516884907, "post_id": 48409267, "comment_id": 83878095, "body": "It seems from that gist you&#39;re using a very recent version of Sphinx. I&#39;m not sure if the TS/Riddle versions you&#39;re using will support that - you may need to downgrade (I&#39;d start with a 2.0.x release of Sphinx to see if that helps?). Also, can you share the output of a working rebuild run? And finally: is the consistent error now the business_name_sort not found one?"}, {"owner": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "edited": false, "score": 0, "creation_date": 1516884938, "post_id": 48409267, "comment_id": 83878116, "body": "Oh, and given this thread of comments is getting rather long - you&#39;re welcome to open up an issue in the TS repo if that&#39;s easier: <a href=\"https://github.com/pat/thinking-sphinx\" rel=\"nofollow noreferrer\">github.com/pat/thinking-sphinx</a>"}, {"owner": {"reputation": 48, "user_id": 3469455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZFMH.jpg?s=128&g=1", "display_name": "shorepound", "link": "https://stackoverflow.com/users/3469455/shorepound"}, "reply_to_user": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "edited": false, "score": 0, "creation_date": 1516888948, "post_id": 48409267, "comment_id": 83880829, "body": "@pat here&#39;s the rebuild output: <a href=\"https://gist.github.com/shorepound/3d1d3289f9c1bb2ecfd5f9b32d8b35a8\" rel=\"nofollow noreferrer\">gist.github.com/shorepound/3d1d3289f9c1bb2ecfd5f9b32d8b35a8</a> And yes the error is: <code>ThinkingSphinx::SphinxError (index business_core: sort-by attribute &#39;business_name_sort&#39; not found)</code>"}, {"owner": {"reputation": 48, "user_id": 3469455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZFMH.jpg?s=128&g=1", "display_name": "shorepound", "link": "https://stackoverflow.com/users/3469455/shorepound"}, "reply_to_user": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "edited": false, "score": 0, "creation_date": 1516899004, "post_id": 48409267, "comment_id": 83888437, "body": "Hey @pat, I did brew uninstall sphinx, downloaded 2.0.6 and installed, everything is now working. Thanks again, I really appreciate it."}], "answers": [{"tags": [], "owner": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "is_accepted": true, "score": 1, "last_activity_date": 1516933525, "creation_date": 1516933525, "answer_id": 48454964, "question_id": 48409267, "link": "https://stackoverflow.com/questions/48409267/sphinx-issue-with-ruby-1-9-3/48454964#48454964", "title": "Sphinx Issue with Ruby 1.9.3?", "body": "<p>The solution was found through some discussion in the comments above. A couple of thoughts that may help others who come across similar issues:</p>\n\n<ul>\n<li>If you're using Thinking Sphinx v1.x or 2.x, best to stick to old Sphinx versions. No higher than Sphinx v2.0.x is recommended.</li>\n<li>Make sure you run <code>rake ts:rebuild</code> when upgrading Thinking Sphinx, and certainly when upgrading Sphinx itself (its indices format often changes between minor releases).</li>\n<li>If you're able to upgrade to more recent versions of Ruby/Rails/Thinking Sphinx, that's always going to help for long-term maintenance (but understandably not always possible).</li>\n</ul>\n"}], "owner": {"reputation": 48, "user_id": 3469455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZFMH.jpg?s=128&g=1", "display_name": "shorepound", "link": "https://stackoverflow.com/users/3469455/shorepound"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 48454964, "answer_count": 1, "score": 1, "last_activity_date": 1516933525, "creation_date": 1516735221, "last_edit_date": 1516736704, "question_id": 48409267, "link": "https://stackoverflow.com/questions/48409267/sphinx-issue-with-ruby-1-9-3", "title": "Sphinx Issue with Ruby 1.9.3?", "body": "<p>I have recently moved a web app from ruby 1.8.7 to 1.9.3 and everything is going great, except for searching. Everything was working fine before bumping ruby. Here's my controller code:</p>\n\n<pre><code>ids = Business.simple_search_for_ids_with_location(@term, @city, @state, {}, :per_page =&gt; 2500)\n      @results = Business.paginate :conditions =&gt; { :id =&gt; ids }, :page =&gt; ActionController::Base.helpers.sanitize(params[:page]), :include =&gt; [:category]\n      @results = @results.sort{|a,b| a.name.downcase &lt;=&gt; b.name.downcase}\n      @count = @results.total_entries\n</code></pre>\n\n<p>And from my model:</p>\n\n<pre><code>def self.simple_search_for_ids_with_location(term, city, state, conditions={}, options={})\n  ids = Business.compact_search_for_ids(term, {:conditions =&gt; { :address_city =&gt; city, :address_state =&gt; state }.merge(conditions), :order =&gt; :business_name}.merge(options))\n  if state.blank?\n    by_state = Business.compact_search_for_ids(term, {:conditions =&gt; { :address_state =&gt; city }.merge(conditions), :order =&gt; :business_name}.merge(options))\n    ids += by_state\n  end\n  ids\nend\n\ndef self.compact_search_for_ids(*args)\n  search_for_ids(*args).compact\nend\n</code></pre>\n\n<p>When running in the browser I get <code>undefined method total_entries for []:Array</code></p>\n\n<p>And the offending line is <code>@count = @results.total_entries</code></p>\n\n<p>I have made sure that sphinx is installed and thinking_sphinx has indexed and is running.</p>\n\n<p>It appears that everything is working somewhat, but an empty array is being returned? Why would this have worked fine before?</p>\n\n<p>I appreciate any help I can get here, as I really don't want to go back to ruby 1.8.7. Thank you.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "rspec", "factory-bot"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1516764154, "post_id": 48409121, "comment_id": 83818468, "body": "I don&#39;t think it fixes anything but should <code>spec&#47;factories&#47;events.rb</code> be <code>spec&#47;factories&#47;products.rb</code>?"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1516798845, "post_id": 48409121, "comment_id": 83835616, "body": "Do you use spring? If so - try <code>spring stop</code> and see if the problems persist."}, {"owner": {"reputation": 458, "user_id": 3969195, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/yBppw.jpg?s=128&g=1", "display_name": "Keaton Burleson", "link": "https://stackoverflow.com/users/3969195/keaton-burleson"}, "edited": false, "score": 0, "creation_date": 1517256079, "post_id": 48409121, "comment_id": 84012920, "body": "I am having the same issue."}], "answers": [{"tags": [], "owner": {"reputation": 458, "user_id": 3969195, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/yBppw.jpg?s=128&g=1", "display_name": "Keaton Burleson", "link": "https://stackoverflow.com/users/3969195/keaton-burleson"}, "is_accepted": false, "score": 4, "last_activity_date": 1517256440, "creation_date": 1517256440, "answer_id": 48509177, "question_id": 48409121, "link": "https://stackoverflow.com/questions/48409121/error-factory-not-registered-after-switching-to-factory-bot/48509177#48509177", "title": "error factory not registered after switching to factory bot", "body": "<p>Okay I figured it out. The documentation isn't super clear, but when working with rails you don't use the <code>factory_bot</code> gem but instead you use the <code>factory_bot_rails</code> gem.</p>\n\n<p>Problem solved.</p>\n"}], "owner": {"reputation": 203, "user_id": 9226492, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1101789162a8e10b23e10edb2f56fadd?s=128&d=identicon&r=PG&f=1", "display_name": "jose1221", "link": "https://stackoverflow.com/users/9226492/jose1221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1200, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1517256440, "creation_date": 1516734662, "last_edit_date": 1516819997, "question_id": 48409121, "link": "https://stackoverflow.com/questions/48409121/error-factory-not-registered-after-switching-to-factory-bot", "title": "error factory not registered after switching to factory bot", "body": "<p>I have factory bot in spec_helper.rb</p>\n\n<pre><code>config.include FactoryBot::Syntax::Methods\n</code></pre>\n\n<p>So I updated the factory from FactoryGirl to FactoryBot as follows</p>\n\n<p>spec/factories/products.rb</p>\n\n<pre><code>FactoryBot.define do\n  factory :products do\n    id Faker::Number.between(100, 900)\n    ...more fields...\n  end\nend\n</code></pre>\n\n<p>and trying to use it in request spec as follows</p>\n\n<p>spec/request/products_request_spec.rb</p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe 'Products Request', type: :request do\n  let(:products) { FactoryBot.create(:products) }\n  let(:base_path) { '/products' }\n .....something here...\nend\n</code></pre>\n\n<p>When i try to run test i get <code>factory not registerd: products</code>. What is it i am doing wrong?</p>\n"}, {"tags": ["ruby", "facebook", "facebook-graph-api", "koala"], "answers": [{"tags": [], "owner": {"reputation": 308, "user_id": 9086002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zm5gtbIWGAs/AAAAAAAAAAI/AAAAAAAABI4/7Cq55B-Rrak/photo.jpg?sz=128", "display_name": "Patrick Lambe", "link": "https://stackoverflow.com/users/9086002/patrick-lambe"}, "is_accepted": true, "score": 1, "last_activity_date": 1516758796, "last_edit_date": 1516758796, "creation_date": 1516757653, "answer_id": 48413536, "question_id": 48408815, "link": "https://stackoverflow.com/questions/48408815/facebook-graph-api-send-page-post-with-tag-and-thumbnail/48413536#48413536", "title": "Facebook Graph API - Send page post with tag and thumbnail", "body": "<p>To tag a page, you format your message as <code>@[page-id]</code>, eg <code>message: \"Thanks to @[22092443056] for their help\"</code> would tag Starbucks. Your app needs to be whitelisted by Facebook in order to use this functionality. Apply here - <a href=\"https://developers.facebook.com/docs/apps/review\" rel=\"nofollow noreferrer\">https://developers.facebook.com/docs/apps/review</a></p>\n"}], "owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 48413536, "answer_count": 1, "score": 0, "last_activity_date": 1516758796, "creation_date": 1516733422, "last_edit_date": 1516733861, "question_id": 48408815, "link": "https://stackoverflow.com/questions/48408815/facebook-graph-api-send-page-post-with-tag-and-thumbnail", "title": "Facebook Graph API - Send page post with tag and thumbnail", "body": "<p>I would like to send a post to a page of mine that contains another page tagged, and also, I would like the preview post would be from a link, but that link wouldn't necessarily be on the subtitle (kinda like when you paste a link, and facebook creates a preview, then you delete the link from the subtitle but the preview is still there). Is it possible to do that with graph api?\nI'm using Koala gem for ruby and didn't find anything like that on documentation. Thanks in advance!</p>\n\n<p>EDIT: </p>\n\n<p>already found how to do the preview (using link param):</p>\n\n<pre><code>@page_graph.put_connections('782353325261674', 'feed', message: \"\", link: \"\")\n</code></pre>\n\n<p>but still don't know how to tag another page on message</p>\n"}, {"tags": ["ruby", "rbenv"], "comments": [{"owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "edited": false, "score": 1, "creation_date": 1516731261, "post_id": 48408109, "comment_id": 83805648, "body": "<a href=\"https://stackoverflow.com/questions/10940736/rbenv-not-changing-ruby-version\" title=\"rbenv not changing ruby version\">stackoverflow.com/questions/10940736/&hellip;</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1516733613, "post_id": 48408109, "comment_id": 83806971, "body": "<code>&#47;Users&#47;****&#47;.rvm&#47;gems&#47;ruby-2.2.3&#47;</code> -- There&#39;s the red flag. You&#39;re using <code>rbenv</code> and <code>rvm</code> at the same time. Don&#39;t do that."}], "answers": [{"comments": [{"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "edited": false, "score": 1, "creation_date": 1516733685, "post_id": 48408845, "comment_id": 83807013, "body": "Thank you! i just figured this out i was about to post the answer, seems like i had originally installed it via RVM like you said and i tried upgrading it using rbenv so it was conflicting, i ended up deleting rvm and changing my bash_profile like this <a href=\"https://stackoverflow.com/questions/10940736/rbenv-not-changing-ruby-version\" title=\"rbenv not changing ruby version\">stackoverflow.com/questions/10940736/&hellip;</a> suggested and it work"}], "tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": true, "score": 1, "last_activity_date": 1516733533, "creation_date": 1516733533, "answer_id": 48408845, "question_id": 48408109, "link": "https://stackoverflow.com/questions/48408109/i-upgraded-ruby-to-version-2-5-0-and-when-i-run-ruby-v-it-still-shows-an-older/48408845#48408845", "title": "I upgraded Ruby to version 2.5.0 and when i run ruby -v it still shows an older version", "body": "<p>From your path, it looks like you are using <code>rvm</code>. I think <code>rvm</code> and <code>rbenv</code> should not be both active on the same system. If you are going to use <code>rbenv</code> I suggest you disable <code>rvm</code>. You don't need to delete the <code>.rvm</code> directory containing <code>rvm</code>'s rubies, gems, etc., you just need to stop the <code>rvm</code> shell code from being loaded when the terminal window starts up. To do this, disable or remove the rvm-related code in your <code>.bashrc</code>, <code>.profile</code>, <code>.bash_profile</code>, <code>.zshrc</code>, etc., and use a new terminal window that starts up after that removal.</p>\n\n<p>I suspect the 2.2.3 version of Ruby is the <code>system</code> you see in the list. If you do a <code>which ruby</code>, you can see where it's located, and that will be a clue; if it's <code>/usr/bin/ruby</code>, then it's the system Ruby.</p>\n\n<p>As an aside, you can get a list of directories in the PATH one to a line by using this command:</p>\n\n<pre><code>echo $PATH | tr : \\\\n\n</code></pre>\n\n<p>This would be much easier to follow than the long line containing all the directories.</p>\n"}], "owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 1, "accepted_answer_id": 48408845, "answer_count": 1, "score": 1, "last_activity_date": 1516733533, "creation_date": 1516730577, "last_edit_date": 1516730947, "question_id": 48408109, "link": "https://stackoverflow.com/questions/48408109/i-upgraded-ruby-to-version-2-5-0-and-when-i-run-ruby-v-it-still-shows-an-older", "title": "I upgraded Ruby to version 2.5.0 and when i run ruby -v it still shows an older version", "body": "<p>I upgraded ruby from 2.2.3 using rbenv following these instructions </p>\n\n<pre><code>$ brew update\n$ brew install ruby-build\n$ brew install rbenv\n$ rbenv install 2.5.0\n$ rbenv global 2.5.0\n$ rbenv local 2.5.0\n</code></pre>\n\n<p>i restarted my terminal and my computer but when i run</p>\n\n<pre><code>ruby -v\n</code></pre>\n\n<p>it shows that i have </p>\n\n<pre><code>ruby 2.2.3p173 (2015-08-18 revision 51636) [x86_64-darwin14]\n</code></pre>\n\n<p>when i run rbenv version</p>\n\n<pre><code>  system\n  2.4.0\n  2.5.0 (set by /Users/****/.ruby-version)\n</code></pre>\n\n<p>it doesn't even show this version, i'm stuck on what i have to do to change this to point to the correct version.</p>\n\n<p>When i run </p>\n\n<pre><code>$echo $PATH\n</code></pre>\n\n<p>it shows </p>\n\n<pre><code>-bash: /usr/local/opt/imagemagick@6/bin:/Users/****/.rvm/gems/ruby-2.2.3/bin:/Users/****/.rvm/gems/ruby-2.2.3@global/bin:/Users/****/.rvm/rubies/ruby-2.2.3/bin:/Users/****/anaconda/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Users/****/.rvm/bin: No such file or directory\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "polymorphism", "uuid"], "comments": [{"owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "edited": false, "score": 1, "creation_date": 1516731668, "post_id": 48407541, "comment_id": 83805848, "body": "as you said you can use uuid in both the models, this seems a good solution."}, {"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 0, "creation_date": 1536826180, "post_id": 48407541, "comment_id": 91565630, "body": "Just for the record, these are related issues on official rails repo: <a href=\"https://github.com/rails/rails/issues/33407\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/33407</a> <a href=\"https://github.com/rails/rails/issues/33525\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/33525</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 0, "creation_date": 1536823762, "post_id": 50860923, "comment_id": 91564366, "body": "Rails join is not casting properly the uuid to string in my case. When i try to access the association"}], "tags": [], "owner": {"reputation": 81, "user_id": 4191133, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cyLGsPJwSYg/AAAAAAAAAAI/AAAAAAAAAAA/8SBmD4Vcsr8/photo.jpg?sz=128", "display_name": "Alfredo Roca Mas", "link": "https://stackoverflow.com/users/4191133/alfredo-roca-mas"}, "is_accepted": false, "score": 0, "last_activity_date": 1528989670, "creation_date": 1528989670, "answer_id": 50860923, "question_id": 48407541, "link": "https://stackoverflow.com/questions/48407541/polymorphic-association-rails-different-primary-keys-types-id-uuid/50860923#50860923", "title": "Polymorphic Association Rails : Different primary_keys types (id &amp; uuid)", "body": "<p>I had exactly the same problem. My solution modifies the type of the <code>_id</code> field to string.</p>\n\n<pre><code>def change\n  add_reference :ratings, :rater, polymorphic: true, index: true\n  change_column :ratings, :rater_id, :string\nend\n</code></pre>\n\n<p>I hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "is_accepted": false, "score": 1, "last_activity_date": 1536827288, "creation_date": 1536827288, "answer_id": 52309607, "question_id": 48407541, "link": "https://stackoverflow.com/questions/48407541/polymorphic-association-rails-different-primary-keys-types-id-uuid/52309607#52309607", "title": "Polymorphic Association Rails : Different primary_keys types (id &amp; uuid)", "body": "<p>Was facing same issue, there is no official solution yet, these two issues are open in rails repo about this:</p>\n\n<p><a href=\"https://github.com/rails/rails/issues/33407\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/issues/33407</a> </p>\n\n<p><a href=\"https://github.com/rails/rails/issues/33525\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/issues/33525</a> </p>\n\n<p>There is <a href=\"https://github.com/rails/rails/issues/33525#issuecomment-410964327\" rel=\"nofollow noreferrer\">a suggestion in one of these issues</a>, it didn't work for me(it was generating both joins, the default one generated by rails which causes failure and one which i defined).</p>\n\n<p>I ended up not using association at all, i defined a method to get the actual records properly with a custom query. I didn't need <code>dependent: destroy</code> otherwise i could have defined a before_destroy method too.</p>\n\n<p>Hope it helps someone.</p>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 7001546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59b8cd92a50f01aecb687030eba2b19a?s=128&d=identicon&r=PG", "display_name": "Jinbo", "link": "https://stackoverflow.com/users/7001546/jinbo"}, "is_accepted": false, "score": 2, "last_activity_date": 1594290319, "creation_date": 1594290319, "answer_id": 62812768, "question_id": 48407541, "link": "https://stackoverflow.com/questions/48407541/polymorphic-association-rails-different-primary-keys-types-id-uuid/62812768#62812768", "title": "Polymorphic Association Rails : Different primary_keys types (id &amp; uuid)", "body": "<p>Specify the type for the (polymorphic) foreign key in the options. Change <code>:string</code> to <code>:uuid</code> if required.</p>\n<pre><code>create_table :table_name do |t|\n  t.references :target, type: :string, polymorphic: true, null: false\nend\n</code></pre>\n<p>Then both string and integer <code>target_id</code>s are acceptable.</p>\n<p>Check the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/TableDefinition.html#method-i-references\" rel=\"nofollow noreferrer\">API docs</a>.</p>\n"}], "owner": {"reputation": 476, "user_id": 2878821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BQ1jZ.jpg?s=128&g=1", "display_name": "hatenine", "link": "https://stackoverflow.com/users/2878821/hatenine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1004, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1594290319, "creation_date": 1516728421, "question_id": 48407541, "link": "https://stackoverflow.com/questions/48407541/polymorphic-association-rails-different-primary-keys-types-id-uuid", "title": "Polymorphic Association Rails : Different primary_keys types (id &amp; uuid)", "body": "<p>I would like to define a polymorphic table. My problem being that one table's primary_key is of type <code>uuid(string)</code> and the other <code>id(integer)</code>.\nI thought maybe having a <code>model_able_id</code> and a <code>model_able_uuid</code> varying depending on the <code>model_type</code> but i cannot figure that out and it would probably break tons of activerecord features for polymorphic.</p>\n\n<p>Some other things i have thought of would be to use STI, but i'm still confused, and, of course, i could migrate ids to uuids and that'd sort me out (but i'd rather not).</p>\n"}, {"tags": ["ruby", "multithreading"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1516730415, "post_id": 48407429, "comment_id": 83805186, "body": "Try in JRuby, you&#39;ll likely notice improvements."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1516730438, "post_id": 48407429, "comment_id": 83805198, "body": "In MRI, only one ruby thread can run at any given time. It&#39;s called Global VM Lock (GVL)"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1516730852, "post_id": 48407429, "comment_id": 83805431, "body": "Did you consider that <code>arr = (0...1000000000).to_a</code> places a huge array into your memory and your computer might need to swap a lot to handle it? Furthermore, <code>arr.each_slice(...).to_a</code> will at least duplicate the memory usage again."}, {"owner": {"reputation": 71, "user_id": 3458580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9f2aa0d009f8dc3e6c9ccd6256b895?s=128&d=identicon&r=PG&f=1", "display_name": "user3458580", "link": "https://stackoverflow.com/users/3458580/user3458580"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1516731769, "post_id": 48407429, "comment_id": 83805914, "body": "@spickermann I did not because as long as I could see difference between multithreads and non-multithreads it was fine."}, {"owner": {"reputation": 71, "user_id": 3458580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9f2aa0d009f8dc3e6c9ccd6256b895?s=128&d=identicon&r=PG&f=1", "display_name": "user3458580", "link": "https://stackoverflow.com/users/3458580/user3458580"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1516732277, "post_id": 48407429, "comment_id": 83806203, "body": "@SergioTulentsev I did not know about GVL. I&#39;ll read about it. :)  Does it mean that multithreading is totally not possible in MRI? That sounds very limiting."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1516732942, "post_id": 48407429, "comment_id": 83806587, "body": "@user3458580: you can do I/O (to some extent) in parallel. But generally yes, multithreading in mri is seriously crippled."}], "answers": [{"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1516753396, "last_edit_date": 1516753396, "creation_date": 1516751632, "answer_id": 48412760, "question_id": 48407429, "link": "https://stackoverflow.com/questions/48407429/ruby-multithreading-each-thread-is-slow/48412760#48412760", "title": "Ruby multithreading each thread is slow", "body": "<p>You can speed up your example by using <a href=\"https://github.com/grosser/parallel\" rel=\"nofollow noreferrer\">parallel gem</a></p>\n\n<ol>\n<li>Install gem by running <code>gem install parallel</code> in terminal </li>\n<li><p>Run <code>irb</code>:</p>\n\n<pre><code>irb(main):006:0&gt; require 'parallel'\n=&gt; true\nirb(main):001:0&gt; arr = (0...100000000).to_a and 1\n=&gt; 1\nirb(main):002:0&gt; lambda { from = Time.now; arr.each{}; Time.now - from }.call\n=&gt; 7.424087\n\nirb(main):009:0&gt; arr.each_slice((arr.size / 8.0).round).to_a.map{|arrr| Thread.new{ lambda { from = Time.now; arrr.each{}; Time.now - from }.call }}.map(&amp;:join).map(&amp;:value)\n=&gt; [4.425176, 3.593438, 4.000537, 4.039098, 3.817529, 3.743535, 3.683716, 3.6868]\n\nirb(main):008:0&gt; Parallel.map(arr.each_slice((arr.size / 8.0).round).to_a, in_threads: 4) { |arrr| from = Time.now; arrr.each{}; Time.now - from }\n=&gt; [2.364945, 2.365872, 2.358072, 2.469698, 2.396479, 2.283937, 2.154116, 1.910335]\n\nirb(main):008:0&gt; Parallel.map(arr.each_slice((arr.size / 8.0).round).to_a, in_processes: 4) { |arrr| from = Time.now; arrr.each{}; Time.now - from }\n=&gt; [1.45764, 1.478868, 1.475091, 1.470171, 1.707919, 1.728389, 1.735843, 1.72616]\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 71, "user_id": 3458580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9f2aa0d009f8dc3e6c9ccd6256b895?s=128&d=identicon&r=PG&f=1", "display_name": "user3458580", "link": "https://stackoverflow.com/users/3458580/user3458580"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1516753396, "creation_date": 1516727969, "question_id": 48407429, "link": "https://stackoverflow.com/questions/48407429/ruby-multithreading-each-thread-is-slow", "title": "Ruby multithreading each thread is slow", "body": "<p>I was trying to use multithreading on processing a huge array of data, but it did not improve the performance at all. I tried to explore the issue, and it turned out each thread is taking approximately the same time as running the task without threading.</p>\n\n<p>Following is a simplified version I ran on <code>irb</code>.</p>\n\n<pre><code>arr = (0...1000000000).to_a and 1  # just to prevent irb from printing arr\n&gt;&gt; 1\n\nlambda { from = Time.now; arr.each{}; Time.now - from }.call\n&gt;&gt; 58.062952\n\narr.each_slice((arr.size / 8.0).round).to_a.map{|arrr| Thread.new{ lambda { from = Time.now; arrr.each{}; Time.now - from }.call }}.map(&amp;:join).map(&amp;:value)\n&gt;&gt; [56.541044, 46.74521, 47.887555, 49.059258, 55.008338, 55.687892, 55.997382, 55.404157]\n</code></pre>\n\n<p>As you can see, each thread took uncannily similar time as task without threading.</p>\n\n<p>Notice that these times are measured for the task itself inside each thread, so it has nothing to do with communication overhead.</p>\n\n<p>I tested with other size of arrays, and the results were similar - no significant difference to task without threading.</p>\n\n<p>I am very puzzled. I would appreciate to learn why this is happening.</p>\n"}, {"tags": ["ruby", "sqlite", "jruby"], "comments": [{"owner": {"reputation": 6788, "user_id": 454312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jNMNF.jpg?s=128&g=1", "display_name": "kares", "link": "https://stackoverflow.com/users/454312/kares"}, "edited": false, "score": 0, "creation_date": 1517135769, "post_id": 48406972, "comment_id": 83963455, "body": "maybe, you should specify in detail what kind of issues you&#39;ve managed to run into and how was your local env set up."}], "answers": [{"tags": [], "owner": {"reputation": 6788, "user_id": 454312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jNMNF.jpg?s=128&g=1", "display_name": "kares", "link": "https://stackoverflow.com/users/454312/kares"}, "is_accepted": true, "score": 1, "last_activity_date": 1517135739, "creation_date": 1517135739, "answer_id": 48485383, "question_id": 48406972, "link": "https://stackoverflow.com/questions/48406972/jruby-gemstash-and-sqlite3/48485383#48485383", "title": "JRuby, gemstash and sqlite3", "body": "<p>seems that (at least on master), the sqlite3 gem should only load under C-Ruby, while under JRuby jdbc-sqlite3 is expected to be loaded/used.</p>\n\n<p><a href=\"https://github.com/bundler/gemstash/blob/master/gemstash.gemspec#L48\" rel=\"nofollow noreferrer\">https://github.com/bundler/gemstash/blob/master/gemstash.gemspec#L48</a></p>\n\n<pre><code>if RUBY_PLATFORM == \"java\"\n  spec.add_runtime_dependency \"jdbc-sqlite3\", \"~&gt; 3.8\"\nelse\n  spec.add_runtime_dependency \"sqlite3\", \"~&gt; 1.3\"\nend\n</code></pre>\n\n<p><strike>however this gems do not provide the same low-level API, so you need to make sure they have proper JDBC style DB operations in place while under JVM.</strike></p>\n\n<p>UPDATE: since they're using Sequel, all should work fine under JRuby ...</p>\n"}], "owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 48485383, "answer_count": 1, "score": 0, "last_activity_date": 1517135739, "creation_date": 1516726331, "question_id": 48406972, "link": "https://stackoverflow.com/questions/48406972/jruby-gemstash-and-sqlite3", "title": "JRuby, gemstash and sqlite3", "body": "<p>I'm trying to run <a href=\"https://github.com/bundler/gemstash\" rel=\"nofollow noreferrer\">gemstash</a> with JRuby, but it seems to have a dependency with <code>sqlite3-1.3.13</code> which of course fails because it requires a C native extension. I've skimmed the projects issues in github and found nothing about it not beeing compatible with JRuby 9.1.14.0. Is there a workaround to the \"sqlite3 won't install in JRuby\" thing?</p>\n"}, {"tags": ["ruby", "linux", "amazon-web-services", "amazon-ec2", "fastlane"], "owner": {"reputation": 171, "user_id": 6785529, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a35111328fce1f43fb2b2d7ae0097ac6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/6785529/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1516724435, "creation_date": 1516724435, "question_id": 48406368, "link": "https://stackoverflow.com/questions/48406368/issue-installing-fastlane-on-amazon-linux-ec2-instance", "title": "Issue installing Fastlane on Amazon Linux EC2 instance", "body": "<p>I'm trying to install fastlane on an EC2 instance and have run into some problems. First, if I try to install fastlane right out of the gate (sudo gem install fastlane -NV) I get an error saying one of the prerequisites requires Ruby 2.1 or greater. So I installed Ruby 2.4 <code>sudo yum install ruby24</code> and made sure to change the default ruby version (2.0 -> 2.4). I tried installing fastlane again and got this error:</p>\n\n<p>mkmf.rb can't find header files for ruby at /usr/share/ruby/include/ruby.h\nERROR: Error installing fastlane:\nERROR: Failed to build gem native extension.</p>\n\n<p>It looks like this is a fairly common issue that is usually resolved by doing something like <code>yum install ruby-devel</code> but this doesn't fix it for me. My ruby-devel version is 2.0-0.3 which makes me think this is out of sync with my new Ruby version (although when I try to install ruby-devel it says it is up to date with the latest version). Also, /user/share/ruby/include doesn't exist and neither does the ruby.h file. I've tried a few different ways to get around this but all have been unsuccessful. If someone has an idea what I can do to get over this I'd really appreciate it! </p>\n"}, {"tags": ["ruby", "attr-accessor"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9213229"}, "edited": false, "score": 0, "creation_date": 1516724105, "post_id": 48406220, "comment_id": 83801235, "body": "Thank you. I&#39;ll get accept your answer when the time limit is up"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1516724370, "post_id": 48406220, "comment_id": 83801400, "body": "@Tiffx97 Note the indentation in this answer, two-spaces :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9213229"}, "edited": false, "score": 0, "creation_date": 1516724453, "post_id": 48406220, "comment_id": 83801460, "body": "One more question. When I try to print it out using &quot;put&quot; my respone is #&lt;Person:0x00000000d2b068&gt;"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516724750, "post_id": 48406220, "comment_id": 83801655, "body": "What do you expect <code>puts person1</code> to display? It&#39;s an instance of <code>Person</code>, so that&#39;s exactly what you see! If you go with the second approach (which I&#39;d generally recommend), then you also see the instance variables: <code>#&lt;Person:0x00007fcacb34ab00 @age=22, @name=&quot;Andre&quot;&gt;</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516724806, "post_id": 48406220, "comment_id": 83801699, "body": "If you want it to display something else, then you can define a custom <code>to_s</code> method on the class. But that&#39;s well beyond the scope of your original question :)"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 2, "last_activity_date": 1516724111, "last_edit_date": 1516724111, "creation_date": 1516724023, "answer_id": 48406220, "question_id": 48406105, "link": "https://stackoverflow.com/questions/48406105/ruby-wrong-number-of-arguments/48406220#48406220", "title": "Ruby wrong number of arguments", "body": "<p>This is what you're trying to do:</p>\n\n<pre><code>class Person \n  attr_accessor :name, :age\nend\n\nperson1 = Person.new\nperson1.name = \"Andre\"\nperson1.age  = 22\n</code></pre>\n\n<p>An <em>alternative</em> approach, for example, could be:</p>\n\n<pre><code>class Person \n  attr_accessor :name, :age\n\n  def initialize(name, age)\n    @name = name\n    @age = age\n  end\nend\n\nperson1 = Person.new(\"Andre\", 22)\n</code></pre>\n\n<p>The error you're seeing is because you defined (and then re-defined) an <code>initialize</code> method that is expecting one parameter:</p>\n\n<pre><code>def initialize(name)\n</code></pre>\n\n<p>and then tried to create an object without supplying a parameter:</p>\n\n<pre><code>person1 = Person.new\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9213229"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1326, "favorite_count": 0, "accepted_answer_id": 48406220, "answer_count": 1, "score": -2, "last_activity_date": 1516770569, "creation_date": 1516723703, "last_edit_date": 1516770569, "question_id": 48406105, "link": "https://stackoverflow.com/questions/48406105/ruby-wrong-number-of-arguments", "title": "Ruby wrong number of arguments", "body": "<p>I'm trying to to create my getters and setters using <code>attr_accessor</code>. I want to assign a value to my variables.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>class Person\n  def initialize(name)\n    attr_accessor :name\n  end\n\n  def initialize(age)\n    attr_accessor :age\n  end\nend\n\nperson1 = Person.new\nperson1.name = \"Andre\"\nperson1.age  = 22\n</code></pre>\n\n<p>I get some trouble though. My error is:</p>\n\n<pre><code>q5.rb:6:in `initialize': wrong number of arguments (given 0, expected 1) (ArgumentError)\n</code></pre>\n"}, {"tags": ["ruby", "regex", "match", "overlapping-matches"], "answers": [{"comments": [{"owner": {"reputation": 25126, "user_id": 578288, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5b2b185c814bb25f2f95a1152e58f033?s=128&d=identicon&r=PG", "display_name": "Rory O&#39;Kane", "link": "https://stackoverflow.com/users/578288/rory-okane"}, "edited": false, "score": 0, "creation_date": 1516728517, "post_id": 48407463, "comment_id": 83804144, "body": "This works, but <code>each_cons</code> eventually gets called with <code>4</code> in this example, which is too high. You should modify the code to use <code>(1..string.size)</code> and <code>each_cons(e)</code> instead. I also suggest renaming <code>|e|</code> to <code>|substr_length|</code> for clarity."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1516729144, "post_id": 48407463, "comment_id": 83804491, "body": "<code>combination(e)</code> instead of <code>each_cons(e)</code> works too."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1516731269, "post_id": 48407463, "comment_id": 83805656, "body": "@SagarPandya That includes &quot;ac&quot;."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1516733961, "post_id": 48407463, "comment_id": 83807145, "body": "Very minor: I suggest <code>each_char</code> rather than <code>chars</code> to avoid an unneeded temporary array."}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "edited": false, "score": 0, "creation_date": 1516739452, "post_id": 48407463, "comment_id": 83810200, "body": "No, what I&#39;m interested in is if there is a method or a Regex functionality to find overlapping matches of all possible lengths"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1516781198, "post_id": 48407463, "comment_id": 83824648, "body": "Asone, you certainly cannot do that with a single regex combined with a method like <code>String#scan</code>.  Regular expressions are simply not designed to do that sort of thing. With regards to a &quot;method&quot; that does that, do you mean a built-in method? (After all Sebatian could wrap what he has in a method.) If you mean a built-in method, it would have to be an instance method of the class <code>String</code>. Go through those methods and you won&#39;t find any that even come close to what you want to do."}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1516793045, "post_id": 48407463, "comment_id": 83832035, "body": "@CarySwoveland thanks, that&#39;s exactly what I was asking (It&#39;s really more of a regex question than a ruby question). It&#39;s a shame there&#39;s no nicer way to do it."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 3, "last_activity_date": 1516728695, "last_edit_date": 1516728695, "creation_date": 1516728105, "answer_id": 48407463, "question_id": 48405558, "link": "https://stackoverflow.com/questions/48405558/get-all-overlapping-matches-of-any-length/48407463#48407463", "title": "Get all overlapping matches of any length", "body": "<p>What about without regex?:</p>\n\n<pre><code>string = 'abc'\np (1..string.size).flat_map { |e| string.chars.each_cons(e).map(&amp;:join) }\n# [\"a\", \"b\", \"c\", \"ab\", \"bc\", \"abc\"]\n</code></pre>\n"}], "owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516771172, "creation_date": 1516722017, "last_edit_date": 1516771172, "question_id": 48405558, "link": "https://stackoverflow.com/questions/48405558/get-all-overlapping-matches-of-any-length", "title": "Get all overlapping matches of any length", "body": "<p>I'm trying to achieve:</p>\n\n<pre><code>'abc'.scan(regex) #=&gt; ['a', 'b', 'c', 'ab', 'bc', 'abc']\n</code></pre>\n\n<p>It can be done like this:</p>\n\n<pre><code>(1..'abc'.size).map {|l| 'abc'.scan /(?=(\\w{#{l}}))/}.flatten\n#=&gt; [\"a\", \"b\", \"c\", \"ab\", \"bc\", \"abc\"]\n</code></pre>\n\n<p>But I would like to do it in one regex expression.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "enums", "ruby-on-rails-5", "rails-admin"], "comments": [{"owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "edited": false, "score": 0, "creation_date": 1516722033, "post_id": 48405467, "comment_id": 83799713, "body": "What file are we looking at there? Knowing how you are laying things out can help us make recommendations for where things should go."}], "answers": [{"tags": [], "owner": {"reputation": 2298, "user_id": 5883753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b32d66e6c723279fdfc2a90b269a070c?s=128&d=identicon&r=PG&f=1", "display_name": "fongfan999", "link": "https://stackoverflow.com/users/5883753/fongfan999"}, "is_accepted": false, "score": 1, "last_activity_date": 1516722368, "creation_date": 1516722368, "answer_id": 48405654, "question_id": 48405467, "link": "https://stackoverflow.com/questions/48405467/rails-admin-use-html-in-enum/48405654#48405654", "title": "Rails Admin use Html in Enum", "body": "<p>You can use <a href=\"https://apidock.com/rails/String/html_safe\" rel=\"nofollow noreferrer\">html_safe</a></p>\n\n<pre><code>def self.available_icons\n  [\n    ['&lt;i class=\"fa fa-glass\" aria-hidden=\"true\"&gt;&lt;/i&gt;'.html_safe, \"fa-glass\"],\n    [\"&lt;i class='fa fa-music'&gt;&lt;/i&gt;\".html_safe, \"fa-music\"],\n    [\"&lt;i class='fa fa-search'&gt;&lt;/i&gt;\".html_safe, \"fa-search\"]\n  ]\nend\n</code></pre>\n"}], "owner": {"reputation": 665, "user_id": 4773859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d0e17759aaf6c044a55251ceab97ca?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Andreas", "link": "https://stackoverflow.com/users/4773859/markus-andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516722368, "creation_date": 1516721729, "question_id": 48405467, "link": "https://stackoverflow.com/questions/48405467/rails-admin-use-html-in-enum", "title": "Rails Admin use Html in Enum", "body": "<p>I want to display a field in the admin where the user can select some font awesome icons. So what I do at the moment is:</p>\n\n<pre><code>  field :icon, :enum do\n    enum do\n      Navitem.available_icons\n    end\n  end\n\ndef self.available_icons\n  [\n    ['&lt;i class=\"fa fa-glass\" aria-hidden=\"true\"&gt;&lt;/i&gt;',\"fa-glass\"],\n    [\"&lt;i class='fa fa-music'&gt;&lt;/i&gt;\",\"fa-music\"],\n    [\"&lt;i class='fa fa-search'&gt;&lt;/i&gt;\",\"fa-search\"]\n  ]\nend\n</code></pre>\n\n<p>But the HTML gets escaped and displayed as text.\nIs there a way I can output the html without escaping it?</p>\n\n<p>regards Markus</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "user-agent"], "comments": [{"owner": {"reputation": 13, "user_id": 9244274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s50gNQLc8d0/AAAAAAAAAAI/AAAAAAAAAGE/3xILK4ey0jY/photo.jpg?sz=128", "display_name": "jisanchez", "link": "https://stackoverflow.com/users/9244274/jisanchez"}, "edited": false, "score": 0, "creation_date": 1516721122, "post_id": 48405008, "comment_id": 83799047, "body": "Why do I need the client&#39;s User-Agent? I have to send it on an email body (which&#39;s already been sent, using SendGrid) after authentication attempt. I&#39;m using HTTPparty to create the requests."}, {"owner": {"reputation": 1364, "user_id": 4848006, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uFXUI.jpg?s=128&g=1", "display_name": "Neji Soltani", "link": "https://stackoverflow.com/users/4848006/neji-soltani"}, "edited": false, "score": 0, "creation_date": 1516721443, "post_id": 48405008, "comment_id": 83799247, "body": "you should improve your question but adding some code"}, {"owner": {"reputation": 13, "user_id": 9244274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s50gNQLc8d0/AAAAAAAAAAI/AAAAAAAAAGE/3xILK4ey0jY/photo.jpg?sz=128", "display_name": "jisanchez", "link": "https://stackoverflow.com/users/9244274/jisanchez"}, "reply_to_user": {"reputation": 1364, "user_id": 4848006, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uFXUI.jpg?s=128&g=1", "display_name": "Neji Soltani", "link": "https://stackoverflow.com/users/4848006/neji-soltani"}, "edited": false, "score": 0, "creation_date": 1516722180, "post_id": 48405008, "comment_id": 83799835, "body": "Thanks for the insight @NejiSoltani, I&#39;ll do add some code, not now because I have to go."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9244274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s50gNQLc8d0/AAAAAAAAAAI/AAAAAAAAAGE/3xILK4ey0jY/photo.jpg?sz=128", "display_name": "jisanchez", "link": "https://stackoverflow.com/users/9244274/jisanchez"}, "edited": false, "score": 0, "creation_date": 1516814767, "post_id": 48416899, "comment_id": 83847039, "body": "Thanks for the answer @djaszczurowski, I&#39;ve already solved it before reading this, but your answer was pretty close indeed. I had to read the <code>User-Agent</code> in <code>Client</code> and add the HTTP Header to the <code>HTTParty request</code> (don&#39;t know why isn&#39;t there by default), after that do the same in <code>Proxy</code>, and then only then I could read it at server side."}], "tags": [], "owner": {"reputation": 4103, "user_id": 4271125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VQnWR.jpg?s=128&g=1", "display_name": "djaszczurowski", "link": "https://stackoverflow.com/users/4271125/djaszczurowski"}, "is_accepted": true, "score": 3, "last_activity_date": 1516778531, "creation_date": 1516778531, "answer_id": 48416899, "question_id": 48405008, "link": "https://stackoverflow.com/questions/48405008/rails-5-how-to-get-user-agent-at-server-side/48416899#48416899", "title": "Rails 5 - How to get User-Agent at server side?", "body": "<p>You could read <code>User-Agent</code> HTTP header on <code>Proxy</code> and then pass it in the following POST from <code>Proxy</code> to <code>Server</code>. </p>\n\n<p>don't know how in rails-5, but in rails-4 (and I guess API has not changed) in order to read <code>User-Agent</code> header you do (in controller):\n<code>request.headers['User-Agent']</code></p>\n\n<p>I guess the best option would be to pass it (from <code>Proxy</code>) in POST request body to <code>Server</code></p>\n"}], "owner": {"reputation": 13, "user_id": 9244274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s50gNQLc8d0/AAAAAAAAAAI/AAAAAAAAAGE/3xILK4ey0jY/photo.jpg?sz=128", "display_name": "jisanchez", "link": "https://stackoverflow.com/users/9244274/jisanchez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2420, "favorite_count": 0, "accepted_answer_id": 48416899, "answer_count": 1, "score": 0, "last_activity_date": 1516824799, "creation_date": 1516720444, "last_edit_date": 1516824799, "question_id": 48405008, "link": "https://stackoverflow.com/questions/48405008/rails-5-how-to-get-user-agent-at-server-side", "title": "Rails 5 - How to get User-Agent at server side?", "body": "<p>I have the following system architecture:</p>\n\n<pre><code>Client (Web app) =&gt; Proxy(REST API) =&gt; Server (Web App + REST API)\n</code></pre>\n\n<p>First the <code>Client</code> sends a <code>POST request</code> to the <code>Proxy</code>, which sends a <code>POST</code> request to the Server.</p>\n\n<p><strong>Question :</strong> How could I get the client's User-Agent at server side?</p>\n\n<p>I'm kind of lost there.<br>\nThanks in advance!</p>\n\n<p><strong>EDIT: Solved.</strong>  Refer to my first answer in the accepted question, right now, I can't edit this question propperly (I'll do it as soon as I'm able to).</p>\n"}, {"tags": ["ruby", "selenium", "cucumber", "watir"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 3935009, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/9HCzb.jpg?s=128&g=1", "display_name": "Sanchit Saxena", "link": "https://stackoverflow.com/users/3935009/sanchit-saxena"}, "edited": false, "score": 0, "creation_date": 1516763907, "post_id": 48405249, "comment_id": 83818416, "body": "I just checked, Watir 4.0.2 is being used. This colspan or col_span attribute call must be internal as I am not calling this anywhere. What should I do in the above code to make it work?"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "reply_to_user": {"reputation": 151, "user_id": 3935009, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/9HCzb.jpg?s=128&g=1", "display_name": "Sanchit Saxena", "link": "https://stackoverflow.com/users/3935009/sanchit-saxena"}, "edited": false, "score": 0, "creation_date": 1516801983, "post_id": 48405249, "comment_id": 83837710, "body": "Is there a reason you want to use old versions of all of these gems? Cucumber, Watir and Selenium have all had much newer major versions released. With Watir/Selenium using older versions may result in driver incompatibilities (assuming you&#39;re running the latest browser versions). I would suggest upgrading first. Then I would suggest providing all of the code you are running so that we can reproduce the issue."}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": false, "score": 1, "last_activity_date": 1516721169, "creation_date": 1516721169, "answer_id": 48405249, "question_id": 48404716, "link": "https://stackoverflow.com/questions/48404716/undefined-method-col-span-for-class-watirtablecell-nameerror/48405249#48405249", "title": "Undefined method `col_span&#39; for class `Watir::TableCell&#39; (NameError)", "body": "<p>As of Watir v6.7, attribute methods are now just the attribute name in lowercase. They are no longer using snake case. </p>\n\n<p>In other words, you want to use <code>colspan</code> instead - eg:</p>\n\n<pre><code>browser.td.colspan\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8556098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7253b70be4a9ecd894f4b58a08b4fe9f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackRiver", "link": "https://stackoverflow.com/users/8556098/blackriver"}, "is_accepted": false, "score": 0, "last_activity_date": 1587926299, "creation_date": 1587926299, "answer_id": 61446104, "question_id": 48404716, "link": "https://stackoverflow.com/questions/48404716/undefined-method-col-span-for-class-watirtablecell-nameerror/61446104#61446104", "title": "Undefined method `col_span&#39; for class `Watir::TableCell&#39; (NameError)", "body": "<p>Try to install only watir instead of watir-webdrive. Then you require watir. When calling the class, use Watir in camelcase. To me it worked this way when calling chromedriver.exe:</p>\n\n<pre><code>require 'watir'\nbrowser = Watir::Browser.new\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3935009, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/9HCzb.jpg?s=128&g=1", "display_name": "Sanchit Saxena", "link": "https://stackoverflow.com/users/3935009/sanchit-saxena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1754, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1587926299, "creation_date": 1516719607, "last_edit_date": 1516777265, "question_id": 48404716, "link": "https://stackoverflow.com/questions/48404716/undefined-method-col-span-for-class-watirtablecell-nameerror", "title": "Undefined method `col_span&#39; for class `Watir::TableCell&#39; (NameError)", "body": "<p>I am fairly new to automation testing and was trying the following code.</p>\n\n<p>While trying to load firefox browser by the following code</p>\n\n<pre><code>@browser = Watir::Browser.new :firefox\n@browser.goto \"https://www.linkedin.com/\"\n\nWhen(/^I enter username as (.*?)$/) do |username|\n  @browser.element(:xpath =&gt; \"//[@id='login-email']\").set username\nend\n....\n.... and so on\n</code></pre>\n\n<p>I am getting the following on the first browser load line.</p>\n\n<blockquote>\n  <p>undefined method <code>col_span' for class</code>Watir::TableCell' (NameError)</p>\n</blockquote>\n\n<p>I am using Ruby (2.5), Cucumber(1.3.2), Watir(4.0.2) and Selenium-webdriver(2.53.4).</p>\n\n<p>Any help would be great. Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "automated-tests", "rspec-rails"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1516718889, "post_id": 48404317, "comment_id": 83797342, "body": "Can we see a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> please? What&#39;s in the rest of that test file? It looks like you&#39;re probably hitting the wrong endpoint!! <code>FactoryBot.create</code> does <i>not</i> call the controller action; instead, you need to <code>post :create</code> in the spec."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516718954, "post_id": 48404317, "comment_id": 83797399, "body": "For example, maybe you&#39;ve got a <code>before { ... }</code> block that&#39;s hitting the <code>SHOW</code> action of your controller -- so you&#39;re actually testing the wrong thing."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9257229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/464b41ad410b24bb3226b652d39e726a?s=128&d=identicon&r=PG&f=1", "display_name": "swilliams", "link": "https://stackoverflow.com/users/9257229/swilliams"}, "edited": false, "score": 0, "creation_date": 1516726628, "post_id": 48404706, "comment_id": 83802944, "body": "Hi Steve, this was really helpful, and it worked! Thanks for helping this ruby newbie ;)"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1516719589, "creation_date": 1516719589, "answer_id": 48404706, "question_id": 48404317, "link": "https://stackoverflow.com/questions/48404317/rspec-test-not-passing-expected-response-to-be-a-3xx-redirect-but-was-a-20/48404706#48404706", "title": "RSpec test not passing: Expected response to be a &lt;3XX: redirect&gt;, but was a &lt;200: OK&gt;", "body": "<p>You're not actually making a call to  your create action.  You have...</p>\n\n<pre><code>describe \"ads#create action\" do\n    it \"redirects to ads#show\" do\n      @ad = FactoryBot.create(:ad)\n      expect(response).to redirect_to ad_path(@ad)\n    end\nend  \n</code></pre>\n\n<p>Which is just using FactoryBot to create the ad.  You need to do actual call to the post action.</p>\n\n<pre><code>RSpec.describe AdsController, type: :controller do\n\n  let(:valid_attributes) {\n    (\"Add a hash of attributes valid for your ad\")\n  }\n\n  describe \"POST #create\" do\n    context \"with valid params\" do\n\n      it \"redirects to the created ad\" do\n        post :create, params: {ad: valid_attributes}\n        expect(response).to redirect_to(Ad.last)\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9257229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/464b41ad410b24bb3226b652d39e726a?s=128&d=identicon&r=PG&f=1", "display_name": "swilliams", "link": "https://stackoverflow.com/users/9257229/swilliams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "accepted_answer_id": 48404706, "answer_count": 1, "score": 2, "last_activity_date": 1516719589, "creation_date": 1516718373, "question_id": 48404317, "link": "https://stackoverflow.com/questions/48404317/rspec-test-not-passing-expected-response-to-be-a-3xx-redirect-but-was-a-20", "title": "RSpec test not passing: Expected response to be a &lt;3XX: redirect&gt;, but was a &lt;200: OK&gt;", "body": "<p>I have set the following test in my ads_controller.spec.rb file: </p>\n\n<pre><code>describe \"ads#create action\" do\n    it \"redirects to ads#show\" do\n      @ad = FactoryBot.create(:ad)\n      expect(response).to redirect_to ad_path(@ad)\n    end\nend  \n</code></pre>\n\n<p>to correspond to this action in my ads controller: </p>\n\n<pre><code>def create\n    @ad = current_user.ads.create(ad_params)\n    redirect_to ad_path(@ad)\nend \n</code></pre>\n\n<p>Once an ad is created, I want it to redirect to the show page for the just created ad. While this works in my browser, I clearly haven't structured my test right since I get the following error: </p>\n\n<pre><code>Failure/Error: expect(response).to redirect_to ad_path(@ad)\n   Expected response to be a &lt;3XX: redirect&gt;, but was a &lt;200: OK&gt;\n</code></pre>\n\n<p>I've tried to troubleshoot it for a while and not sure where I'm messing things up? Any ideas? Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "attachment", "mime", "multipart"], "answers": [{"tags": [], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1516724607, "creation_date": 1516724607, "answer_id": 48406440, "question_id": 48404228, "link": "https://stackoverflow.com/questions/48404228/how-to-turn-a-mimedata-attachment-block-from-raw-email-into-a-file-in-ruby/48406440#48406440", "title": "How to turn a mimedata attachment block from raw email into a file? (in ruby)", "body": "<p>This turned out to be easier than I thought.</p>\n\n<p>Algorithmically:</p>\n\n<ul>\n<li>get the block of text from that mimepart (ie without the mimepart boundaries)</li>\n<li>base64 decode it</li>\n<li>write the result of that out to filename.pdf</li>\n</ul>\n\n<p>So obvious that I didn't even try it!</p>\n\n<p>In Ruby, specifically: I'm sure you could do it much more tersely and safely than this.</p>\n\n<pre><code>text = File.read(\"/home/max/raw_email.txt\")\nboundary_line = text.grep(/boundary\\=mimepart/).first.chomp\nmimepart_divider = \"--#{boundary_line.split(\"boundary=\").last}\"\nmimeparts = text.split(mimepart_divider)\nmimepart = mimeparts.grep(/application\\/pdf/).first\nfilename = mimepart.grep(/filename\\=/).first.chomp.split(\"filename=\").last\nmimedata = mimepart.split(\"\\n\\n\").compact_blank.last\ndecoded = Base64.decode64(mimedata)\nFile.open(\"#{ENV['HOME']}/#{filename}\",\"w\"){|f| f.puts decoded}\n</code></pre>\n"}], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516724607, "creation_date": 1516718098, "last_edit_date": 1516722819, "question_id": 48404228, "link": "https://stackoverflow.com/questions/48404228/how-to-turn-a-mimedata-attachment-block-from-raw-email-into-a-file-in-ruby", "title": "How to turn a mimedata attachment block from raw email into a file? (in ruby)", "body": "<p>We audit our outgoing emails, so that later on we can access the raw email text.  For emails that had attachments, I can see a mimepart section like this:</p>\n\n<pre><code>--mimepart_5a65f317c19d2_24515571f0306fc12617a\nContent-Type: application/pdf; name=CMI-1Y-120628-38895.pdf\nContent-Transfer-Encoding: Base64\nContent-Disposition: attachment; filename=CMI-1Y-120628-38895.pdf\n\nJVBERi0xLjQKJeLjz9MKMyAwIG9iaiA8PC9UeXBlL1hPYmplY3QvQ29sb3JT\ncGFjZS9EZXZpY2VHcmF5L1N1YnR5cGUvSW1hZ2UvQml0c1BlckNvbXBvbmVu\ndCA4L1dpZHRoIDMwMC9MZW5ndGggNTI3My9IZWlnaHQgMjYwL0ZpbHRlci9G\nbGF0ZURlY29kZT4+c3RyZWFtCnic7Z15YA3XGsC/EEFQKrb2WVISUi2JrbFU\naWyxvKKx11LUUlu1SCyhPPqaerQo2nqW1kMVr9UnfUijqZ3aW2KLUGt5QcQS\nJDLvzjkz986ZOffec+XefHMbvz/izsw5kzM/NzNnzvIdADdS76PVI1qUducZ\n\n....about 800 lines of text like this...\n\nMCBuIAowMDAwMDM4MjczIDAwMDAwIG4gCjAwMDAwMzgzMTggMDAwMDAgbiAK\ndHJhaWxlcgo8PC9Sb290IDEyIDAgUi9JRCBbPGIyNjEwYmQyZmM3ZGQyZTI0\nNzQxYzg2M2VkOWU4NTBkPjwxY2JiNDIzYWZmMWVjY2U2MGRhNmJjMmE4ZjZl\nMTBjNT5dL0luZm8gMTMgMCBSL1NpemUgMTQ+PgpzdGFydHhyZWYKMzg0NTUK\nJSVFT0YK\n\n--mimepart_5a65f317c19d2_24515571f0306fc12617a\n</code></pre>\n\n<p>What I want to do is to give the admin looking at this email record the option to \"reconstruct\" the attachment.  So, when they click the \"View attachment\" button, i would use the data to build a file (with the filename from the headers above), then serve that back to them.</p>\n\n<p>The question is, how to turn this into a file?  The attachments in question are always PDF files, so if there's a solution which only works with pdfs then that's fine, but a more general solution would be preferred.</p>\n\n<p>I'm using Ruby on Rails, so there might be a function in ActiveMailer already to do this...</p>\n\n<p>EDIT:  In case anyone wants to try with some real data, I made a PDF which just has a bit of text in large letters, and attached it to an email.  The link below is to a text file with all the raw data from that email, with <code>text/plain</code>, <code>text/html</code> and <code>application/pdf</code> parts.   Your challenge is to turn the <code>application/pdf</code> mimepart into a pdf file, and tell me what it says (and more importantly, post an answer saying what you did).  thanks!</p>\n\n<p><a href=\"https://www.dropbox.com/s/u3kt5sdl6b44fms/raw_email.txt?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/u3kt5sdl6b44fms/raw_email.txt?dl=0</a> </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "scheduled-tasks", "scheduler"], "owner": {"reputation": 5443, "user_id": 818094, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f93ac57e4452df30894e5db2f589cf31?s=128&d=identicon&r=PG", "display_name": "Montells", "link": "https://stackoverflow.com/users/818094/montells"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "closed_date": 1516740828, "answer_count": 0, "score": 2, "last_activity_date": 1516805088, "creation_date": 1516717128, "last_edit_date": 1516805088, "question_id": 48403939, "link": "https://stackoverflow.com/questions/48403939/heroku-scheduler-winter-summer-time", "closed_reason": "Duplicate", "title": "Heroku scheduler winter, summer time", "body": "<p>I'm deploying RoR application in Heroku. </p>\n\n<p>Using, <strong>redis</strong>, <strong>sidekiq</strong> and <strong>sendgrid</strong> my application delivering some emails with daily reports at 7 am CET.</p>\n\n<p>For this purpose, I configured 6:00 AM UTC schedule invoking rake task who put the email in the sideqik mailers queue.</p>\n\n<p>I am having problems with daylight saving times. My emails are delivered differents time in summer vs winter.</p>\n\n<p><em>There is a way to fix this issue without change manually TZ every winter or summer?</em></p>\n\n<p><em>There is a way of set TZ which is aware of daylight saving times?</em></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundler", "continuous-deployment"], "comments": [{"owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "edited": false, "score": 0, "creation_date": 1516723827, "post_id": 48403721, "comment_id": 83801034, "body": "Is it ok to install this gem manual? Can that server connect to github?"}, {"owner": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "reply_to_user": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "edited": false, "score": 0, "creation_date": 1516727989, "post_id": 48403721, "comment_id": 83803820, "body": "I don&#39;t have control as of now as it is being done via chef recipes."}], "answers": [{"tags": [], "owner": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "is_accepted": false, "score": 1, "last_activity_date": 1516763013, "creation_date": 1516763013, "answer_id": 48414176, "question_id": 48403721, "link": "https://stackoverflow.com/questions/48403721/nomethoderror-undefined-method-spec-for-nilnilclass/48414176#48414176", "title": "NoMethodError: undefined method `spec&#39; for nil:NilClass", "body": "<p>The problem was with bunlder version</p>\n\n<p><code>+    12s     $ ssh -i /home/deploy/.ssh/internal -o StrictHostKeyChecking=no -o UserKnownHostsFile=/tmp/ey-ss-known-hosts20180123-28710-1k6s7ez -o PasswordAuthentication=no -o ServerAliveInterval=60 deploy@ec2-54-242-111-22.compute-1.amazonaws.com 'sh -l -c '\\''export GIT_SSH=\"/data/feed_champion/shared/config/feed_champion-ssh-wrapper\" &amp;&amp; export LANG=\"en_US.UTF-8\" &amp;&amp; unset RUBYOPT BUNDLE_PATH BUNDLE_FROZEN BUNDLE_WITHOUT BUNDLE_BIN BUNDLE_GEMFILE &amp;&amp; cd /data/feed_champion/releases/20180123225204 &amp;&amp; ruby -S bundle _1.7.9_ install --gemfile /data/feed_champion/releases/20180123225204/Gemfile --path /data/feed_champion/shared/bundled_gems --binstubs /data/feed_champion/releases/20180123225204/ey_bundler_binstubs --deployment --without test development'\\'</code></p>\n\n<p>The Gemfile.lock has <code>bundler (&gt;= 1.3.0)</code> as part of <code>rails</code> dependency.</p>\n\n<p>All I did to fix is explicitly added <code>bundler</code> gem with latest version <code>1.16.1</code></p>\n"}], "owner": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516763013, "creation_date": 1516716521, "question_id": 48403721, "link": "https://stackoverflow.com/questions/48403721/nomethoderror-undefined-method-spec-for-nilnilclass", "title": "NoMethodError: undefined method `spec&#39; for nil:NilClass", "body": "<p>Suddenly I started facing this error after having following gem during deployment on staging server(EngineYard). We use chef recipes for deployment.</p>\n\n<p><strong>Error log</strong></p>\n\n<pre><code>NoMethodError: undefined method `spec' for nil:NilClass\nDid you mean?  inspect\nAn error occurred while installing ecwid_api (0.2.2), and Bundler cannot\ncontinue.\nMake sure that `gem install ecwid_api -v '0.2.2'` succeeds before bundling.\nfrom /home/ey/.rvm/rubies/ruby-2.2.3/lib/ruby/gems/2.2.0/gems/engineyard-serverside-2.6.14/lib/engineyard-serverside/servers.rb:85:in `run_on_each!'\n</code></pre>\n\n<p><strong>Gemfile.lock - Part which looks problematic</strong></p>\n\n<pre><code>GIT\n  remote: https://github.com/ParthivPatel-BTC/ecwid_api.git\n  revision: 079b697157356612b993e42f1e71269024b7c376\n  specs:\n    ecwid_api (0.2.2)\n      faraday (= 0.12.2)\n      faraday_middleware (= 0.10.1)\n</code></pre>\n\n<p>Any idea how to fix this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": true, "score": 5, "last_activity_date": 1516713941, "creation_date": 1516713941, "answer_id": 48402860, "question_id": 48402478, "link": "https://stackoverflow.com/questions/48402478/unit-test-rspec-cannot-update-current-user-in-rails/48402860#48402860", "title": "Unit test (Rspec) cannot update `current_user` in Rails", "body": "<p>You may need to reload your resource in RSpec in order to see the change:</p>\n\n<pre><code>describe \"#test_feature\" do\n  it \"should test this feature\" do\n    sign_in @group_user\n    get :get_users, {name: \"darpan\"}\n    @group_user.reload   # Reloads information from the database\n    expect(@group_user.user_detail.name).to eq(\"darpan\")\n    sign_out @group_user\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 5118, "user_id": 609782, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/ae52db449f67c30243e5f6a7851882c2?s=128&d=identicon&r=PG", "display_name": "Darpan", "link": "https://stackoverflow.com/users/609782/darpan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 48402860, "answer_count": 1, "score": 0, "last_activity_date": 1516977337, "creation_date": 1516712708, "last_edit_date": 1516977337, "question_id": 48402478, "link": "https://stackoverflow.com/questions/48402478/unit-test-rspec-cannot-update-current-user-in-rails", "title": "Unit test (Rspec) cannot update `current_user` in Rails", "body": "<p>I have a unit test of this type - </p>\n\n<pre><code>describe \"#test_feature\" do\n  it \"should test this feature\" do\n    sign_in @group_user\n    get :get_users, {name: \"darpan\"}\n    expect(@group_user.user_detail.name).to eq(\"darpan\")\n    sign_out @group_user\n  end\nend\n</code></pre>\n\n<p>and function <code>get_users</code> is like this - </p>\n\n<pre><code>def get_users\n  quick_start = current_user.user_detail.quick_start\n  current_user.user_detail.update_attribute(:name, \"darpan\")\n  render :json =&gt; :ok\nend\n</code></pre>\n\n<p>Now, when I run above <code>rspec</code>, \n<code>current_user</code>'s <code>user_detail</code> gets updated(checked with <code>binding.pry</code>), but logged in user <code>@group_user</code>'s <code>user_detail</code> does not get updated. Hence my <code>expect</code> fails.</p>\n\n<p>What wrong am I doing in testing this function?</p>\n"}, {"tags": ["json", "ruby"], "comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1516711504, "post_id": 48401980, "comment_id": 83792181, "body": "So you have no problem with the whole JSON part? Then why ask about it?"}, {"owner": {"reputation": 1933, "user_id": 317275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6148dea2ea49459ba992c2e8ddd97f54?s=128&d=identicon&r=PG", "display_name": "SirLenz0rlot", "link": "https://stackoverflow.com/users/317275/sirlenz0rlot"}, "edited": false, "score": 0, "creation_date": 1516711980, "post_id": 48401980, "comment_id": 83792494, "body": "I don&#39;t think <code>entry[&#39;name&#39;][&#39;number&#39;]</code> is a thing in your data structure."}, {"owner": {"reputation": 778, "user_id": 2581843, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000141231384/picture?type=large", "display_name": "Sander Saelmans", "link": "https://stackoverflow.com/users/2581843/sander-saelmans"}, "edited": false, "score": 3, "creation_date": 1516712139, "post_id": 48401980, "comment_id": 83792595, "body": "What&#39;s the actual error you&#39;re getting? Or what is the output from <code>sanitize(number)</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 2165, "user_id": 1811752, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/sSedp.png?s=128&g=1", "display_name": "M&#225;t&#233;", "link": "https://stackoverflow.com/users/1811752/m%c3%a1t%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1516716749, "last_edit_date": 1516716749, "creation_date": 1516714578, "answer_id": 48403080, "question_id": 48401980, "link": "https://stackoverflow.com/questions/48401980/parsing-extracting-returning-json-as-hash/48403080#48403080", "title": "Parsing, Extracting &amp; Returning JSON as Hash", "body": "<p>You don't seem to have <code>number</code> or <code>name</code> extracted in any way. I think first you'll need to update your code to get those details. </p>\n\n<p>i.e. If <code>entry</code> is a JSON object (or rather was before parsing), you can do the following:</p>\n\n<pre><code>def contacts_from_spreadsheet\n  contacts = {}\n    data_from_spreadsheet.each do |entry|\n     contacts[sanitize(entry['number'])] = entry['name']\n  end\n  contacts\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "edited": false, "score": 0, "creation_date": 1516718366, "post_id": 48403798, "comment_id": 83796946, "body": "That worked! Thanks!  How would I be able to make data = (file_url.json) instead of having the static array within the method?"}, {"owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "edited": false, "score": 0, "creation_date": 1516722155, "post_id": 48403798, "comment_id": 83799812, "body": "<code>def spreadsheet_url       &#39;contacts.json&#39;   end&#39;      def contacts_from_spreadsheet     sample_data = open(spreadsheet_url)     sample_data.map{|e| {e[:number] =&gt; e[:name]}}.reduce Hash.new, :merge   end</code>"}, {"owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "reply_to_user": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "edited": false, "score": 0, "creation_date": 1516722820, "post_id": 48403798, "comment_id": 83800311, "body": "Sorry, but it is not clear enough. Could you provide question in your post and describe an issue?"}], "tags": [], "owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "is_accepted": false, "score": 1, "last_activity_date": 1516716733, "creation_date": 1516716733, "answer_id": 48403798, "question_id": 48401980, "link": "https://stackoverflow.com/questions/48401980/parsing-extracting-returning-json-as-hash/48403798#48403798", "title": "Parsing, Extracting &amp; Returning JSON as Hash", "body": "<p>You could create array of pairs (hashes) using <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-map\" rel=\"nofollow noreferrer\"><code>map</code></a> and then call <a href=\"https://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\"><code>reduce</code></a> to get a single hash.</p>\n\n<pre><code>data = [{\n    \"name\": \"Michael\",\n    \"number\": 9045555555\n},\n{\n    \"name\": \"Natalie\",\n    \"number\": 7865555555\n}]\n\ndata.map{|e| {e[:number] =&gt; e[:name]}}.reduce Hash.new, :merge\n</code></pre>\n\n<p>Result: <code>{9045555555=&gt;\"Michael\", 7865555555=&gt;\"Natalie\"}</code></p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "is_accepted": false, "score": 0, "last_activity_date": 1516729794, "creation_date": 1516729794, "answer_id": 48407916, "question_id": 48401980, "link": "https://stackoverflow.com/questions/48401980/parsing-extracting-returning-json-as-hash/48407916#48407916", "title": "Parsing, Extracting &amp; Returning JSON as Hash", "body": "<p>Not really keeping this function within JSON, but I have solved the problem. Here's what I used.</p>\n\n<pre><code>def data_from_spreadsheet\n  file = open(spreadsheet_url).read\n  YAML.load(file)\nend\n\ndef contacts_from_spreadsheet\n  contacts = {}\n  data_from_spreadsheet.each do |entry|\n    name = entry['name']\n    number = entry['phone_number'].to_s\n    contacts[sanitize(number)] = name\n  end\n  contacts\nend\n</code></pre>\n\n<p>This returned back clean array here:</p>\n\n<pre><code>{\"+19045555555\"=&gt;\"Michael\", \"+17865555555\"=&gt;\"Natalie\"}\n</code></pre>\n\n<p>Thanks everyone who added input!</p>\n"}], "owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1516729794, "creation_date": 1516711136, "last_edit_date": 1516716125, "question_id": 48401980, "link": "https://stackoverflow.com/questions/48401980/parsing-extracting-returning-json-as-hash", "title": "Parsing, Extracting &amp; Returning JSON as Hash", "body": "<p>I am trying to make a localized version of this app:  <a href=\"https://www.twilio.com/blog/2014/10/broadcast-text-and-picture-messages-using-ruby-google-spreadsheets-twilio.html\" rel=\"nofollow noreferrer\">SMS Broadcast Ruby App</a></p>\n\n<p>I have been able to get the JSON data from a local file &amp; sanitize the number as well as open the JSON data. However I have been unable to extract the values and pair them as a scrubbed hash. Here's what I have so far.</p>\n\n<pre><code>  def data_from_spreadsheet\n    file = open(spreadsheet_url).read\n    JSON.parse(file)\n  end\n\n  def contacts_from_spreadsheet\n    contacts = {}\n    data_from_spreadsheet.each do |entry|\n     puts entry['name']['number']\n     contacts[sanitize(number)] = name\n    end\n    contacts\n  end\n</code></pre>\n\n<p>Here's the JSON data sample I'm working with.</p>\n\n<pre><code>[\n {\n   \"name\": \"Michael\",\n   \"number\": 9045555555\n },\n {\n   \"name\": \"Natalie\",\n   \"number\": 7865555555\n }\n]\n</code></pre>\n\n<p>Here's how I would like the JSON to be expressed after the contacts_from_spreadsheet method.</p>\n\n<pre><code>{\n  '19045555555' =&gt; 'Michael', \n  '19045555555' =&gt; 'Natalie'\n}\n</code></pre>\n\n<p>Any help would be much appreciated. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "performance", "routing", "newrelic"], "comments": [{"owner": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "edited": false, "score": 0, "creation_date": 1516717439, "post_id": 48401680, "comment_id": 83796288, "body": "well, have you looked into your router?"}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "reply_to_user": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "edited": false, "score": 0, "creation_date": 1516770357, "post_id": 48401680, "comment_id": 83820022, "body": "Yes. And question has updated too."}, {"owner": {"reputation": 1971, "user_id": 3419341, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ameEV.jpg?s=128&g=1", "display_name": "anusha", "link": "https://stackoverflow.com/users/3419341/anusha"}, "edited": false, "score": 0, "creation_date": 1518291707, "post_id": 48401680, "comment_id": 84448578, "body": "@ShruthiR Did you find a solution to it? I am also facing the same issue. Please help me to figure it out."}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "edited": false, "score": 0, "creation_date": 1519278924, "post_id": 48401680, "comment_id": 84847353, "body": "Sorry, even I didn&#39;t get the solution."}, {"owner": {"reputation": 239, "user_id": 2091176, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/GsdtB.jpg?s=128&g=1", "display_name": "Jetblackstar", "link": "https://stackoverflow.com/users/2091176/jetblackstar"}, "edited": false, "score": 0, "creation_date": 1540483432, "post_id": 48401680, "comment_id": 92892329, "body": "I&#39;ve got a feeling its to do with ActionCable. I&#39;ve got the same and I&#39;m using ActionCable for a live update page."}], "owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1516770334, "creation_date": 1516710246, "last_edit_date": 1516770334, "question_id": 48401680, "link": "https://stackoverflow.com/questions/48401680/rails-5-how-to-fix-middleware-rack-actiondispatchroutingroutesetcall-issu", "title": "Rails 5 - How to fix Middleware/Rack/ActionDispatch::Routing::RouteSet#call issue?", "body": "<p>In rails 5, I am using NewRelic to monitor the application. In newrelic, instantly I am getting <code>Middleware/Rack/ActionDispatch::Routing::RouteSet#call</code> as most time consuming. I don't know why this issue is happening.</p>\n\n<p>In routes.rb,</p>\n\n<pre><code>devise_for :admins\nmount RailsAdmin::Engine =&gt; '/admin', as: 'rails_admin'\nscope :api do\nscope :v1 do\n  devise_for :users, controllers: {\n    registrations: 'users/registrations',\n    confirmations: 'users/confirmations',\n    sessions: 'users/sessions',\n    passwords: 'users/passwords'\n  }\n  get 'confirm_user_email', to: 'user_emails#confirm_email', as: :confirm_user_email\n  get 'forgot_password', to: 'landing_page#forgot_password'\n  post 'send_invitation', to: 'users#send_invitation', as: :send_invitation\n end\nend\nunless Rails.env.production?\n  mount LetterOpenerWeb::Engine, at: '/letter_opener'\nend\n\nrequire 'sidekiq/web'\nmount Sidekiq::Web =&gt; '/sidekiq'\nget \"*path\" =&gt; \"home#index\"\n\nmount ActionCable.server =&gt; '/cable'\n</code></pre>\n\n<p>Please help me to solve this issue.</p>\n"}, {"tags": ["ruby", "testing", "minitest"], "comments": [{"owner": {"reputation": 778, "user_id": 2581843, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000141231384/picture?type=large", "display_name": "Sander Saelmans", "link": "https://stackoverflow.com/users/2581843/sander-saelmans"}, "edited": false, "score": 0, "creation_date": 1516712446, "post_id": 48401427, "comment_id": 83792790, "body": "You could use the <code>Open3.popen3</code> method to execute your file using bash, and check for the stdout and the exit code in your test. However, I wouldn&#39;t advise this."}, {"owner": {"reputation": 6430, "user_id": 191059, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0f0027765c34ff1a3ef09689d8020bde?s=128&d=identicon&r=PG", "display_name": "emenegro", "link": "https://stackoverflow.com/users/191059/emenegro"}, "reply_to_user": {"reputation": 778, "user_id": 2581843, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000141231384/picture?type=large", "display_name": "Sander Saelmans", "link": "https://stackoverflow.com/users/2581843/sander-saelmans"}, "edited": false, "score": 0, "creation_date": 1516713224, "post_id": 48401427, "comment_id": 83793324, "body": "Thanks Sander. Anyway, what would you advise?"}], "answers": [{"tags": [], "owner": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "is_accepted": true, "score": 1, "last_activity_date": 1516718151, "creation_date": 1516718151, "answer_id": 48404246, "question_id": 48401427, "link": "https://stackoverflow.com/questions/48401427/test-cli-with-parameters/48404246#48404246", "title": "Test CLI with parameters", "body": "<p>nice diagram!</p>\n\n<p>you can either use helpers like aruba <a href=\"https://github.com/cucumber/aruba\" rel=\"nofollow noreferrer\">https://github.com/cucumber/aruba</a></p>\n\n<p>or dig into ruby internals in order to bend it to your will!</p>\n\n<pre><code># test.rb\npseudoIO = StringIO.new\n$stdout = pseudoIO\n\nputs \"hi #{ARGV.join(', ')}\"\n\nARGV.replace [\"file1\"]\n\nputs \"now its #{ARGV.join(', ')}\"\n\nabort \"captured: #{pseudoIO.string}\"\n</code></pre>\n\n<p>output should be</p>\n\n<pre><code>ruby text.rb \"whutup\"\n# =&gt; captured: hi whutup\n# =&gt; now its file1\n</code></pre>\n"}], "owner": {"reputation": 6430, "user_id": 191059, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0f0027765c34ff1a3ef09689d8020bde?s=128&d=identicon&r=PG", "display_name": "emenegro", "link": "https://stackoverflow.com/users/191059/emenegro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 48404246, "answer_count": 1, "score": 0, "last_activity_date": 1516718151, "creation_date": 1516709501, "last_edit_date": 1516712625, "question_id": 48401427, "link": "https://stackoverflow.com/questions/48401427/test-cli-with-parameters", "title": "Test CLI with parameters", "body": "<p>I assume this is very newbie stuff but I'm learning Ruby by doing, and I'm developing a small CLI tool that receives a couple of parameters in order to do its stuff properly. This is my current workflow:</p>\n\n<p><a href=\"https://i.stack.imgur.com/74e5B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/74e5B.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to test (using Minitest) all the possible flows:</p>\n\n<ul>\n<li>Exits with 0 and help message is shown if ARGV.count != 2</li>\n<li>Exits with 1 if first param is not correct</li>\n<li>Exits with 1 if second param is not correct</li>\n<li>Exits with 1 if both params are not correct</li>\n<li>Exits with 0 and does stuff if all params are correct</li>\n</ul>\n\n<p>Now, if I run tests the only thing I see is the help output as there is no parameter being passed. </p>\n\n<p>So, a couple of questions:</p>\n\n<ul>\n<li>How can I pass arguments to the main program in tests?</li>\n<li>How can I test the output? (I'm using <code>puts</code>)</li>\n</ul>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "mongoid"], "comments": [{"owner": {"reputation": 63390, "user_id": 2683814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16a4c2fb341c51388d5cdfcf0e956f6c?s=128&d=identicon&r=PG&f=1", "display_name": "s7vr", "link": "https://stackoverflow.com/users/2683814/s7vr"}, "edited": false, "score": 0, "creation_date": 1516887163, "post_id": 48401089, "comment_id": 83879555, "body": "Its only possible if you&#39;ve some kind of relationship between two collection."}, {"owner": {"reputation": 1596, "user_id": 1087841, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ca433142386fe814075e37027dccde0a?s=128&d=identicon&r=PG", "display_name": "Saad", "link": "https://stackoverflow.com/users/1087841/saad"}, "reply_to_user": {"reputation": 63390, "user_id": 2683814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16a4c2fb341c51388d5cdfcf0e956f6c?s=128&d=identicon&r=PG&f=1", "display_name": "s7vr", "link": "https://stackoverflow.com/users/2683814/s7vr"}, "edited": false, "score": 0, "creation_date": 1516887274, "post_id": 48401089, "comment_id": 83879630, "body": "The only thing that is common is that they have the same customer_id, but it could also be something like the customer created a new notification, or a new letter, and I would like to get the first created at of either."}], "answers": [{"comments": [{"owner": {"reputation": 1596, "user_id": 1087841, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ca433142386fe814075e37027dccde0a?s=128&d=identicon&r=PG", "display_name": "Saad", "link": "https://stackoverflow.com/users/1087841/saad"}, "edited": false, "score": 0, "creation_date": 1517311397, "post_id": 48496456, "comment_id": 84034978, "body": "Hey I have updated my question since lookup does not work with my version of mongo, I also did update the mongo version but the query was taking quite a long time."}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "reply_to_user": {"reputation": 1596, "user_id": 1087841, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ca433142386fe814075e37027dccde0a?s=128&d=identicon&r=PG", "display_name": "Saad", "link": "https://stackoverflow.com/users/1087841/saad"}, "edited": false, "score": 0, "creation_date": 1517364394, "post_id": 48496456, "comment_id": 84062350, "body": "The operator <code>$lookup</code> is available since MongoDB v3.2 (released in 2015, current version is v3.6), if your MongoDB version is older than v3.2, I strongly recommend to upgrade. If the aggregation query is taking a long time being performed on your server, then you should either 1) Consider re-designing your <a href=\"https://docs.mongodb.com/manual/data-modeling/\" rel=\"nofollow noreferrer\">document data model</a> to be more optimised for your use case 2) Scale up your servers (horizontally or vertically)."}], "tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": true, "score": 2, "last_activity_date": 1517211344, "creation_date": 1517211344, "answer_id": 48496456, "question_id": 48401089, "link": "https://stackoverflow.com/questions/48401089/combining-results-of-two-tables-in-mongoid-mongo/48496456#48496456", "title": "Combining results of two tables in mongoid/mongo", "body": "<blockquote>\n  <p>the customer created a new notification, or a new letter, and I would like to get the first created at of either.</p>\n</blockquote>\n\n<p>Let's address this first as a foundation. Given examples of document schema as below: </p>\n\n<p>Document schema in <code>Letter</code> collection: </p>\n\n<pre><code>{ _id: &lt;ObjectId&gt;,\n  customer_id: &lt;integer&gt;,\n  created_at: &lt;date&gt; }\n</code></pre>\n\n<p>And, document schema in <code>Notification</code> collection: </p>\n\n<pre><code>{ _id: &lt;ObjectId&gt;,\n  customer_id: &lt;integer&gt;,\n  created_at: &lt;date&gt; }\n</code></pre>\n\n<p>You can utilise <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/lookup/\" rel=\"nofollow noreferrer\">aggregation pipeline $lookup</a> to join the two collections. For example using <a href=\"https://docs.mongodb.com/manual/mongo/\" rel=\"nofollow noreferrer\">mongo shell</a> : </p>\n\n<pre><code>db.letter.aggregate([\n    {\"$group\":{\"_id\":\"$customer_id\", tmp1:{\"$max\":\"$created_at\"}}}, \n    {\"$lookup\":{from:\"notification\", \n              localField:\"_id\",\n              foreignField:\"customer_id\", \n              as:\"notifications\"}}, \n    {\"$project\":{customer_id:\"$_id\", \n               _id:0,\n               latest_letter:\"$tmp1\", \n               latest_notification: {\"$max\":\"$notifications.created_at\"}}},\n    {\"$addFields\":{\"latest\": \n                {\"$cond\":[{\"$gt\":[\"$latest_letter\", \"$latest_notification\"]}, \n                 \"$latest_letter\", \n                 \"$latest_notification\"]}}},\n    {\"$sort\":{latest:-1}}\n], {cursor:{batchSize:100}})\n</code></pre>\n\n<p>The output of the above <a href=\"https://docs.mongodb.com/manual/core/aggregation-pipeline/\" rel=\"nofollow noreferrer\">aggregation pipeline</a> is a list of customers in sorted order of <code>created_at</code> field from either <code>Letter</code> or <code>Notification</code>. Example output documents: </p>\n\n<pre><code>  {\n    \"customer_id\": 0,\n    \"latest_letter\": ISODate(\"2017-12-19T07:00:08.818Z\"),\n    \"latest_notification\": ISODate(\"2018-01-26T13:43:56.353Z\"),\n    \"latest\": ISODate(\"2018-01-26T13:43:56.353Z\")\n  },\n  {\n    \"customer_id\": 4,\n    \"latest_letter\": ISODate(\"2018-01-04T18:55:26.264Z\"),\n    \"latest_notification\": ISODate(\"2018-01-25T02:05:19.035Z\"),\n    \"latest\": ISODate(\"2018-01-25T02:05:19.035Z\")\n  }, ...\n</code></pre>\n\n<blockquote>\n  <p>What I want to know is how many active users were there per month</p>\n</blockquote>\n\n<p>To achieve this, you can just replace the last stage (<a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/sort/\" rel=\"nofollow noreferrer\">$sort</a>) of the above aggregation pipeline with <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/group/\" rel=\"nofollow noreferrer\">$group</a>. For example: </p>\n\n<pre><code>db.letter.aggregate([\n    {\"$group\":{\"_id\":\"$customer_id\", tmp1:{$max:\"$created_at\"}}}, \n    {\"$lookup\":{from:\"notification\", \n              localField:\"_id\",\n              foreignField:\"customer_id\", \n              as:\"notifications\"}}, \n    {\"$project\":{customer_id:\"$_id\", \n               _id:0,\n               latest_letter:\"$tmp1\", \n               latest_notification: {\"$max\":\"$notifications.created_at\"}}},\n    {\"$addFields\":{\"latest\": \n                {\"$cond\":[{\"$gt\":[\"$latest_letter\", \"$latest_notification\"]}, \n                 \"$latest_letter\", \n                 \"$latest_notification\"]}}},\n    {\"$group\":{_id:{month:{\"$month\": \"$latest\"}, \n                  year:{\"$year\": \"$latest\"}}, \n             active_users: {\"$sum\": \"$customer_id\"}\n            }\n    }\n],{cursor:{batchSize:10}})\n</code></pre>\n\n<p>Where the example output would be as below: </p>\n\n<pre><code>  {\n    \"_id\": {\n      \"month\": 10,\n      \"year\": 2017\n    },\n    \"active_users\": 9\n  },\n  {\n    \"_id\": {\n      \"month\": 1,\n      \"year\": 2018\n    },\n    \"active_users\": 18\n  },\n</code></pre>\n"}], "owner": {"reputation": 1596, "user_id": 1087841, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ca433142386fe814075e37027dccde0a?s=128&d=identicon&r=PG", "display_name": "Saad", "link": "https://stackoverflow.com/users/1087841/saad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 1, "accepted_answer_id": 48496456, "answer_count": 1, "score": 0, "last_activity_date": 1517311343, "creation_date": 1516708367, "last_edit_date": 1517311343, "question_id": 48401089, "link": "https://stackoverflow.com/questions/48401089/combining-results-of-two-tables-in-mongoid-mongo", "title": "Combining results of two tables in mongoid/mongo", "body": "<p>Hi guys what would be the best way to combine results of two mongoid queries. </p>\n\n<p>My issue is that I would like to know active users, A user can send a letter and a notification, both are separate table and a user if he sends either the letter or the notification is considered active. What I want to know is how many active users were there per month.</p>\n\n<p>right now what I can think of is doing this</p>\n\n<pre><code>Letter.collection.aggregate([\n                       { '$match': {}.merge(opts) },\n                       { '$sort': { 'created_at': 1 } },\n                       {\n                         '$group': {\n                           _id: '$customer_id',\n                           first_notif_sent: {\n                             '$first': {\n                               'day': { '$dayOfMonth': '$created_at' },\n                               'month': { '$month': '$created_at' },\n                               'year': { '$year': '$created_at' }\n                             }\n                           }\n                         }\n                       }])\nNotification.collection.aggregate([\n                       { '$match': {}.merge(opts) },\n                       { '$sort': { 'created_at': 1 } },\n                       {\n                         '$group': {\n                           _id: '$customer_id',\n                           first_notif_sent: {\n                             '$first': {\n                               'day': { '$dayOfMonth': '$created_at' },\n                               'month': { '$month': '$created_at' },\n                               'year': { '$year': '$created_at' }\n                             }\n                           }\n                         }\n                       }])\n</code></pre>\n\n<p>What I am looking for is to get the minimum of the dates and then combine the results and get the count. Right now I can get the results and loop over each of them and create a new list. But I wanted to know if there is a way to do it in mongo directly.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>For letters</p>\n\n<pre><code>  def self.get_active(tenant_id)\n    map = %{\n      function() {\n        emit(this.customer_id, new Date(this.created_at))\n      }\n    }\n\n    reduce = %{\n      function(key, values) {\n        return new Date(Math.min.apply(null, values))\n      }\n    }\n    where(tenant_id: tenant_id).map_reduce(map, reduce).out(reduce: \"#{tenant_id}_letter_notification\")\n  end\n</code></pre>\n\n<p>Notifications</p>\n\n<pre><code>def self.get_active(tenant_id)\n    map = %{\n      function() {\n        emit(this.customer_id, new Date(this.updated_at))\n      }\n    }\n\n    reduce = %{\n      function(key, values) {\n        return new Date(Math.min.apply(null, values))\n      }\n    }\n    where(tenant_id: tenant_id, transferred: true).map_reduce(map, reduce).out(reduce: \"#{tenant_id}_outgoing_letter_standing_order_balance\")\n  end\n</code></pre>\n\n<p>This is what I am thinking of going with, one of the reason is that, lookup does not work with my version of mongo.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "switch-statement", "case-statement"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1516711563, "post_id": 48401085, "comment_id": 83792225, "body": "What is an &quot;array key&quot;?"}, {"owner": {"reputation": 71, "user_id": 6809067, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/280f612d3632fc4a11032559f64b6121?s=128&d=identicon&r=PG&f=1", "display_name": "Thillai K", "link": "https://stackoverflow.com/users/6809067/thillai-k"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1516711894, "post_id": 48401085, "comment_id": 83792441, "body": "@Stefan I believe I should have referred that to as hash key"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1516720448, "post_id": 48401085, "comment_id": 83798520, "body": "@ThillaiK: why is your hash named &quot;array&quot;? :)"}, {"owner": {"reputation": 71, "user_id": 6809067, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/280f612d3632fc4a11032559f64b6121?s=128&d=identicon&r=PG&f=1", "display_name": "Thillai K", "link": "https://stackoverflow.com/users/6809067/thillai-k"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1516722798, "post_id": 48401085, "comment_id": 83800287, "body": "@SergioTulentsev, I have updated my question. Obliged :)"}], "answers": [{"tags": [], "owner": {"reputation": 925, "user_id": 321422, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3b9a520b2886d27afd9dbef703c6a9f0?s=128&d=identicon&r=PG", "display_name": "Ramses", "link": "https://stackoverflow.com/users/321422/ramses"}, "is_accepted": false, "score": 2, "last_activity_date": 1516708626, "creation_date": 1516708626, "answer_id": 48401167, "question_id": 48401085, "link": "https://stackoverflow.com/questions/48401085/alternative-for-case-when-statement-in-ruby/48401167#48401167", "title": "Alternative for case when statement in ruby", "body": "<p>You can assign the result of the case statement to a variable directly, like this:</p>\n\n<pre><code>@array1.each do |a1|\n  @array2[a1.field_id] = case a1.mapped_field\n    when 'value1'\n      value_1\n    when 'value2'\n      value_2\n    when 'value3'\n      value_3\n    when 'value4'\n      value_4\n    when 'value5'\n      value_4\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43225, "user_id": 297087, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/17b3a5816f0647e9b0f7c49d60f93e7b?s=128&d=identicon&r=PG", "display_name": "Salil", "link": "https://stackoverflow.com/users/297087/salil"}, "is_accepted": false, "score": 2, "last_activity_date": 1516708754, "creation_date": 1516708754, "answer_id": 48401205, "question_id": 48401085, "link": "https://stackoverflow.com/questions/48401085/alternative-for-case-when-statement-in-ruby/48401205#48401205", "title": "Alternative for case when statement in ruby", "body": "<p>You can use <code>then</code> as well</p>\n\n<pre><code>@array1.each do |a1|\n  @array2[a1.field_id] = case a1.mapped_field\n    when 'value1' then value_1\n    when 'value2' then value_2\n    when 'value3' then value_3\n    when 'value4' then value_4\n    when 'value5' then value_5\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 10, "last_activity_date": 1516709321, "last_edit_date": 1516709321, "creation_date": 1516708933, "answer_id": 48401260, "question_id": 48401085, "link": "https://stackoverflow.com/questions/48401085/alternative-for-case-when-statement-in-ruby/48401260#48401260", "title": "Alternative for case when statement in ruby", "body": "<p>Here's another alternative: not using the case/when at all.</p>\n\n<pre><code>mapping = {\n  'value1' =&gt; value_1,\n  'value2' =&gt; value_2,\n  ...\n}\n\n@array1.each do |a1|\n  @array2[a1.field_id] = mapping[a1.mapped_field]\nend\n</code></pre>\n\n<p>As a pleasant bonus, you now can build the mapping programmatically (by loading it from a file/database or something like that).</p>\n"}], "owner": {"reputation": 71, "user_id": 6809067, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/280f612d3632fc4a11032559f64b6121?s=128&d=identicon&r=PG&f=1", "display_name": "Thillai K", "link": "https://stackoverflow.com/users/6809067/thillai-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "accepted_answer_id": 48401260, "answer_count": 3, "score": 3, "last_activity_date": 1516722695, "creation_date": 1516708358, "last_edit_date": 1516722695, "question_id": 48401085, "link": "https://stackoverflow.com/questions/48401085/alternative-for-case-when-statement-in-ruby", "title": "Alternative for case when statement in ruby", "body": "<p>I am assigning a set of values based on the values of a hash.</p>\n\n<p>I have to assign values to another hash key based on the value of the incoming hash key.</p>\n\n<p>There are more than 10 keys in the incoming hash(so more than 10 cases).</p>\n\n<p>I want to minimize the code.  Is there any alternative method for this scenario to shorten the code.</p>\n\n<pre><code>@hash1.each do |h1|\n  case h1.mapped_field\n    when 'value1'\n      @hash2[h1.field_id] = value_1\n    when 'value2'\n      @hash2[h1.field_id] = value_2\n    when 'value3'\n      @hash2[h1.field_id] = value_3\n    when 'value4'\n      @hash2[h1.field_id] = value_4\n    when 'value5'\n      @hash2[h1.field_id] = value_5\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "edited": false, "score": 0, "creation_date": 1516706364, "post_id": 48400235, "comment_id": 83788689, "body": "<code>params[:recipients]</code> capture using that"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1516707463, "post_id": 48400235, "comment_id": 83789464, "body": "Submit the form, then look at the window where you started your server, and examine the server output.  You should see something like: <code>Parameters: {......}</code>.  Copy and paste that line into your question.  Rails assigns that Hash to the variable <code>params</code>, which is available in any of your action methods."}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1516710396, "post_id": 48400235, "comment_id": 83791371, "body": "By the way, in an action method you can always write <code>puts &quot;[ME]: #{some_variable}&quot;</code>, then look in the server window for the output."}, {"owner": {"reputation": 11, "user_id": 8855315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8cbd7085847b479af70046b757190c?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Nash", "link": "https://stackoverflow.com/users/8855315/mr-nash"}, "edited": false, "score": 0, "creation_date": 1516713275, "post_id": 48400235, "comment_id": 83793348, "body": "So how should the syntax be like?  <code>if params[:recipients] = Resources</code>"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1516714143, "post_id": 48400235, "comment_id": 83793967, "body": "@MrNash, You need to post the output I asked for in my first comment.  Post the output at the bottom of your question. If you do, we can tell you exactly what you need to do."}, {"owner": {"reputation": 11, "user_id": 8855315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8cbd7085847b479af70046b757190c?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Nash", "link": "https://stackoverflow.com/users/8855315/mr-nash"}, "reply_to_user": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1516714592, "post_id": 48400235, "comment_id": 83794282, "body": "@7stud here&#39;s the result  <code>Parameters: {&quot;utf8&quot;=&gt;&quot;\u2713&quot;, &quot;authenticity_token&quot;=&gt;&quot;YzFNk2cSNWU5DarWw4B1dMJYDX4mc==&quot;, &quot;broadcast&quot;=&gt;{&quot;subject&quot;=&gt;&quot;Test email&quot;, &quot;message&quot;=&gt;&quot;This is an organisation test email&quot;, &quot;recipients&quot;=&gt;&quot;Organisations&quot;, &quot;country_id&quot;=&gt;&quot;1&quot;, &quot;skill_id&quot;=&gt;&quot;&quot;, &quot;id&quot;=&gt;[&quot;&quot;, &quot;7&quot;, &quot;5&quot;, &quot;8&quot;]}, &quot;commit&quot;=&gt;&quot;Send&quot;}</code>"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1516716584, "post_id": 48400235, "comment_id": 83795689, "body": "@MrNash, See my answer, it was too long to type into a comment."}], "answers": [{"comments": [{"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1516707978, "post_id": 48400897, "comment_id": 83789794, "body": "Doesn&#39;t the syntax of the form elements preclude <code>form_tag()</code>?"}], "tags": [], "owner": {"reputation": 121, "user_id": 4847374, "user_type": "registered", "profile_image": "https://graph.facebook.com/1115016275191896/picture?type=large", "display_name": "Naman Wadhwa", "link": "https://stackoverflow.com/users/4847374/naman-wadhwa"}, "is_accepted": false, "score": 1, "last_activity_date": 1516707794, "creation_date": 1516707794, "answer_id": 48400897, "question_id": 48400235, "link": "https://stackoverflow.com/questions/48400235/how-can-i-capture-form-values-into-rails-controller/48400897#48400897", "title": "How can I capture form values into rails controller", "body": "<p>If you're using something like form_for(@model_name) helper, then params[:model_name][:recipients] will help you retrieve the desired value.</p>\n\n<p>Whereas if you're using form_tag helper, then you can get the same value using params[:recipient].</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8855315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8cbd7085847b479af70046b757190c?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Nash", "link": "https://stackoverflow.com/users/8855315/mr-nash"}, "edited": false, "score": 0, "creation_date": 1516784694, "post_id": 48403663, "comment_id": 83826623, "body": "this is the error I&#39;m getting when I use <code>form_data</code>  <code>NameError (undefined local variable or method </code>form_data&#39; for #&lt;Broadcast:0xd01a150&gt;):` but using <code>params[&quot;broadcast&quot;][&quot;recipient&quot;] == &quot;Organisations&quot;</code> seems to be working, thank you"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "reply_to_user": {"reputation": 11, "user_id": 8855315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8cbd7085847b479af70046b757190c?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Nash", "link": "https://stackoverflow.com/users/8855315/mr-nash"}, "edited": false, "score": 0, "creation_date": 1516801799, "post_id": 48403663, "comment_id": 83837579, "body": "@MrNash, In ruby, you can create a variable at will:  <i>To get that hash into a variable, you can write: <code>form_data = params[&quot;broadcast&quot;]</code></i>.  Was that in your code? You can&#39;t skip steps.  Because I suspected that you would not understand what this means:  <code>params[&quot;broadcast&quot;][&quot;recipient&quot;]</code>, I created an intermediate step to help you understand how to get information out of a nested hash."}], "tags": [], "owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "is_accepted": true, "score": 0, "last_activity_date": 1516761477, "last_edit_date": 1516761477, "creation_date": 1516716353, "answer_id": 48403663, "question_id": 48400235, "link": "https://stackoverflow.com/questions/48400235/how-can-i-capture-form-values-into-rails-controller/48403663#48403663", "title": "How can I capture form values into rails controller", "body": "<p>Okay, here is the hash:</p>\n\n<pre><code>{\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"YzFNk2cSNWU5DarWw4B1dMJYDX4mc==\",\n\"broadcast\"=&gt;{\"subject\"=&gt;\"Test email\", \n\"message\"=&gt;\"This is an organisation test email\",\n\"recipients\"=&gt;\"Organisations\",\n\"country_id\"=&gt;\"1\", \"skill_id\"=&gt;\"\", \"id\"=&gt;[\"\", \"7\", \"5\", \"8\"]}, \"commit\"=&gt;\"Send\"}\n</code></pre>\n\n<p>Rails assigns that hash to a variable named <code>params</code>:</p>\n\n<pre><code>params = {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"YzFNk2cSNWU5DarWw4B1dMJYDX4mc==\",\n    \"broadcast\"=&gt;{\"subject\"=&gt;\"Test email\", \n    \"message\"=&gt;\"This is an organisation test email\",\n    \"recipients\"=&gt;\"Organisations\",\n    \"country_id\"=&gt;\"1\", \"skill_id\"=&gt;\"\", \"id\"=&gt;[\"\", \"7\", \"5\", \"8\"]}, \"commit\"=&gt;\"Send\"}\n</code></pre>\n\n<p>Although it may be a little hard to make out, <code>params[\"broadcast\"]</code> has the value:</p>\n\n<pre><code>{\n\"subject\"=&gt;\"Test email\", \n\"message\"=&gt;\"This is an organisation test email\",\n\"recipients\"=&gt;\"Organisations\", \n\"country_id\"=&gt;\"1\", \n\"skill_id\"=&gt;\"\", \n\"id\"=&gt;[\"\", \"7\", \"5\", \"8\"]\n}\n</code></pre>\n\n<p>To get that hash into a variable, you can write:</p>\n\n<pre><code>form_data = params[\"broadcast\"]\n</code></pre>\n\n<p>That is equivalent to:</p>\n\n<pre><code>form_data = {\n    \"subject\"=&gt;\"Test email\", \n    \"message\"=&gt;\"This is an organisation test email\",\n    \"recipients\"=&gt;\"Organisations\", \n    \"country_id\"=&gt;\"1\", \n    \"skill_id\"=&gt;\"\", \n    \"id\"=&gt;[\"\", \"7\", \"5\", \"8\"]\n}\n</code></pre>\n\n<p>That hash contain's all the key/value pairs from your form.  Each key corresponds to the name attribute of one of the input fields in the form, and the value is the value of that input field.  You should look at the <code>Page Source</code> in your browser to examine the html created by your form. Locate the form in the html source and examine the name attribute of each input field.  Also, see the Rails Guide on <a href=\"http://guides.rubyonrails.org/form_helpers.html\" rel=\"nofollow noreferrer\">Binding a form to an Object</a> for some examples of the html created by your form.</p>\n\n<p>Finally, you can get the value of the \"recipient\" key in the <code>form_data</code> hash like this:</p>\n\n<pre><code>if form_data[\"recipient\"] == \"Organisations\"\n  ...\n  ...\nend\n</code></pre>\n\n<p>Because <code>form_data</code> is equivalent to <code>params[\"broadcast\"]</code>, you can substitute <code>params[\"broadcast\"]</code> in place of <code>form_data</code> in the if-statement, giving you:</p>\n\n<pre><code>   |&lt;--form_data----&gt;| \n   |                 |\nif params[\"broadcast\"][\"recipient\"] == \"Organisations\"\n  ...\n  ...\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8855315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8cbd7085847b479af70046b757190c?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Nash", "link": "https://stackoverflow.com/users/8855315/mr-nash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 48403663, "answer_count": 2, "score": 0, "last_activity_date": 1516761477, "creation_date": 1516705762, "question_id": 48400235, "link": "https://stackoverflow.com/questions/48400235/how-can-i-capture-form-values-into-rails-controller", "title": "How can I capture form values into rails controller", "body": "<pre><code>&lt;div class=\"col-md-10\"&gt;\n            &lt;%= f.radio_button :recipients, 'Resources', checked: true %&gt; Resources&lt;br /&gt;\n            &lt;%= f.radio_button :recipients, 'Organisations', checked: true %&gt; Organisations&lt;br /&gt;\n        &lt;br/&gt;\n        &lt;/br/&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I have this radio button in my form and I'd like the form  to be able to pass that into the model/controller if Organisations is selected then recipient will be Organisations. Please help I'm still new to Ruby</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1516714603, "post_id": 48399505, "comment_id": 83794290, "body": "You are getting a warning from where? Please show the server logs."}, {"owner": {"reputation": 1, "user_id": 8739117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70dcab3e290701c9462ae6279f95b95?s=128&d=identicon&r=PG&f=1", "display_name": "Mike J", "link": "https://stackoverflow.com/users/8739117/mike-j"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1516791624, "post_id": 48399505, "comment_id": 83831100, "body": "Sorry for late reply. Gem Bullet said, USE eager loading detected Brand =&gt; [: UnderwearNameAsc] Add to your finder:: includes =&gt; [: UnderwearNameAsc]."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8739117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70dcab3e290701c9462ae6279f95b95?s=128&d=identicon&r=PG&f=1", "display_name": "Mike J", "link": "https://stackoverflow.com/users/8739117/mike-j"}, "edited": false, "score": 0, "creation_date": 1516965152, "post_id": 48433704, "comment_id": 83913230, "body": "Sorry for late reply.  I practiced what you taught me, but an error has appeared. I tried to solve it myself, but I could not do it.  The error says that Association named &#39;underwear&#39; was not found on Underwear."}, {"owner": {"reputation": 1, "user_id": 8739117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70dcab3e290701c9462ae6279f95b95?s=128&d=identicon&r=PG&f=1", "display_name": "Mike J", "link": "https://stackoverflow.com/users/8739117/mike-j"}, "edited": false, "score": 0, "creation_date": 1516965209, "post_id": 48433704, "comment_id": 83913260, "body": "Thank you very much for your support!"}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 0, "last_activity_date": 1516839017, "creation_date": 1516839017, "answer_id": 48433704, "question_id": 48399505, "link": "https://stackoverflow.com/questions/48399505/how-can-i-include-group-method-when-using-group-collection/48433704#48433704", "title": "How can I include group method when using group collection?", "body": "<p>Bullet is pointing out that you have an <a href=\"https://www.sitepoint.com/silver-bullet-n1-problem/\" rel=\"nofollow noreferrer\">n+1 query problem</a>. It suggests that you change your has_many association within the Brand model by adding an <code>includes</code> to solve the problem, like this:</p>\n\n<pre><code>has_many :UnderwearNameAsc, -&gt; { includes(:underwear).order(UnderwearName: :asc) }, class_name: 'Underwear'\n</code></pre>\n\n<p>While you are at it, you really should change the names of your scopes and methods to snake_case in <a href=\"https://github.com/bbatsov/ruby-style-guide#snake-case-symbols-methods-vars\" rel=\"nofollow noreferrer\">standard Ruby style</a>. Otherwise Ruby will think those methods and scopes are constants. </p>\n\n<p>Also, I would just name your scope for what it is returning, not for a single attribute on that model. Finally, I'd use a scope separately and call it explicitly when you want the resources to be returned sorted.</p>\n\n<pre><code>has_many :underwear # Or has_many :underwears if Rails interprets the plural that way\nscope :sorted, -&gt; { includes(:underwear).order(underwear: {name: :asc} }\n</code></pre>\n\n<p>Then you can do:</p>\n\n<pre><code>Brand.all # Returns unsorted records\nBrand.all.sorted # Returns records sorted by underwear.name\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8739117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70dcab3e290701c9462ae6279f95b95?s=128&d=identicon&r=PG&f=1", "display_name": "Mike J", "link": "https://stackoverflow.com/users/8739117/mike-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516839017, "creation_date": 1516703517, "question_id": 48399505, "link": "https://stackoverflow.com/questions/48399505/how-can-i-include-group-method-when-using-group-collection", "title": "How can I include group method when using group collection?", "body": "<p>There are 4 models.(Fashion,FashionUnderwear,Underwear,Brand).Each user can select his own style from the fashion form.The fashion form has various item's drop boxes such as jeans and socks.I wanted to rearrange the items classified by brand in the Drop box alphabetically, so I used the scope.</p>\n\n<pre><code>#### Underwear dropbox\nAdidas\n  adidas underwear 1\n  adidas underwear 2\nNIKE\n  NIKE underwear 1\n  NIKE underwear 2\n  NIKE underwear 3\n</code></pre>\n\n<p>It worked well with the scope, but now I got a warning that you should include the scope.\nIn the code below, opening Fashions/new.html will give me a warning \"Please Include UnderwearNameAsc\".\nI studied various things and tried it, but in all cases using child models, I can not find a clue to solve.</p>\n\n<pre><code>### Fashion model\nhas_one :fashion_underwear\naccepts_nested_attributes_for :fashion_underwear\n\n### FashionUnderwear model(Intermediate table)\nbelongs_to :fashion\nbelongs_to :underwear\n\n### Underwear model\nhas_many :fashion_underwears\nbelongs_to :brand\n\nscope :UnderwearNameAsc, -&gt; { order(UnderwearName: :asc) }\n\n### Brand model\nhas_many :underwear\n\nhas_many :UnderwearNameAsc, -&gt; { order(UnderwearName: :asc) }, class_name: 'Underwear'\n\n### Fashions.controller\ndef new\n  @fashion = Fashion.new\n  @fashion.build_fashion_underwear\n  @brand = Brand.includes(:fashion_underwears).joins(:fashion_underwears).order(brand_name: :asc)\nend\n\n### Fashion/new.html\n= simple_form_for(@fashion) do |f|\n  = f.simple_fields_for :fashion_underwear do |p|\n    = p.input :underwear_id, collection: @brand, as: :grouped_select, group_method: :UnderwearNameAsc, group_label_method: :brand_name, label_method: :UnderwearName\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "nokogiri"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516702495, "post_id": 48399053, "comment_id": 83785998, "body": "Why not just ask the user to submit the various options, then generate this code on the server??"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516702526, "post_id": 48399053, "comment_id": 83786017, "body": "For example, <a href=\"https://github.com/railslove/rack-tracker#facebook\" rel=\"nofollow noreferrer\">this</a> was the first result from a quick google search; could that solve your problem?"}, {"owner": {"reputation": 829, "user_id": 2646969, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Tp2tE.jpg?s=128&g=1", "display_name": "Diego Somar", "link": "https://stackoverflow.com/users/2646969/diego-somar"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516703485, "post_id": 48399053, "comment_id": 83786757, "body": "Hello @TomLord, thanks your answer. I would not like to our system generate the code, because Facebook is always changing and always adding new features. But I know to filter the code with Nokogiri, maybe will be not possible... We&#39;ll thinking about your answer. Thanks man!"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1516704376, "post_id": 48399053, "comment_id": 83787370, "body": "It&#39;s really not practical to inspect the contents of arbitrary <code>&lt;script&gt;</code> tags; <i>especially</i> when &quot;features are always being added&quot;. My recommendation, as I say, would be to have the server generate the code. If facebook adds a new feature, you update the server code (e.g. the gem version) to support it."}, {"owner": {"reputation": 829, "user_id": 2646969, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Tp2tE.jpg?s=128&g=1", "display_name": "Diego Somar", "link": "https://stackoverflow.com/users/2646969/diego-somar"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1516704536, "post_id": 48399053, "comment_id": 83787475, "body": "You are right @TomLord, we will use your solution. Can you post an answer? Then I&#39;ll accepet."}], "answers": [{"comments": [{"owner": {"reputation": 829, "user_id": 2646969, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Tp2tE.jpg?s=128&g=1", "display_name": "Diego Somar", "link": "https://stackoverflow.com/users/2646969/diego-somar"}, "edited": false, "score": 0, "creation_date": 1516707246, "post_id": 48399968, "comment_id": 83789309, "body": "We are implementing this solution, but the unique problem is: The PIXEL_ID is dynamic. The users can put their own Facebook Pixel Code. But, in this gem, the Facebook Pixel Code is unique for all the system. In the config, we need to put the PIXEL_ID, but the system knows what is the pixel id in controller, when page loads. We are trying to change the code to put the pixel_id in the controller, but at the momento, without success. Do you know how to make it dynamic?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 829, "user_id": 2646969, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Tp2tE.jpg?s=128&g=1", "display_name": "Diego Somar", "link": "https://stackoverflow.com/users/2646969/diego-somar"}, "edited": false, "score": 0, "creation_date": 1516710378, "post_id": 48399968, "comment_id": 83791360, "body": "Look at the source code -- Under the hood, that library is using <a href=\"https://github.com/railslove/rack-tracker/blob/05265a3273944215f58992f34e9ad9dcb08ee5fc/lib/rack/tracker/facebook/template/facebook.erb\" rel=\"nofollow noreferrer\">this template file</a> to generate the script, given  bunch of options. You don&#39;t necessarily need to use that gem; it was, as I said, just the first result of my google search. Maybe there&#39;s a more suitable gem, or you could quite easily roll your own custom solution with that template as a guideline."}, {"owner": {"reputation": 829, "user_id": 2646969, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Tp2tE.jpg?s=128&g=1", "display_name": "Diego Somar", "link": "https://stackoverflow.com/users/2646969/diego-somar"}, "edited": false, "score": 0, "creation_date": 1516710672, "post_id": 48399968, "comment_id": 83791615, "body": "Before you reply I was looking for <a href=\"https://github.com/railslove/rack-tracker/blob/master/lib/rack/tracker/facebook_pixel/template/facebook_pixel.erb\" rel=\"nofollow noreferrer\">this template</a> trying to found a solution. But is not clear at the moment. I&#39;ll keep study a little bit more, but if you have some tip to me, I&#39;ll appreciate a lot."}, {"owner": {"reputation": 829, "user_id": 2646969, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Tp2tE.jpg?s=128&g=1", "display_name": "Diego Somar", "link": "https://stackoverflow.com/users/2646969/diego-somar"}, "edited": false, "score": 0, "creation_date": 1516713474, "post_id": 48399968, "comment_id": 83793505, "body": "There&#39;s a <a href=\"https://github.com/railslove/rack-tracker/pull/101\" rel=\"nofollow noreferrer\">change in progress</a> to allow the PIXEL_ID dynamic. Almost done as I see. I&#39;ll put the Facebook Script directly in the template and, when the change is finished, I&#39;ll change. Thanks for all your answers @TomLord"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 829, "user_id": 2646969, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Tp2tE.jpg?s=128&g=1", "display_name": "Diego Somar", "link": "https://stackoverflow.com/users/2646969/diego-somar"}, "edited": false, "score": 1, "creation_date": 1516718731, "post_id": 48399968, "comment_id": 83797200, "body": "If such a gem doesn&#39;t exist already, perhaps you could even package your mini library up as one, for others to use!"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 0, "last_activity_date": 1516704954, "creation_date": 1516704954, "answer_id": 48399968, "question_id": 48399053, "link": "https://stackoverflow.com/questions/48399053/nokogiri-how-to-allow-only-the-facebook-pixel-in-the-input-and-remove-all-html/48399968#48399968", "title": "Nokogiri: How to allow only the Facebook Pixel in the input and remove all HTML and scripts?", "body": "<p>It's really not practical to inspect the contents of arbitrary <code>&lt;script&gt;</code> tags; especially when \"features are always being added\" (so you don't even have well-defined acceptance criteria).</p>\n\n<p>My recommendation would be to have the server generate the code. If Facebook adds a new feature, you update the server code (e.g. the gem version) to support it.</p>\n\n<p><a href=\"https://github.com/railslove/rack-tracker#facebook\" rel=\"nofollow noreferrer\">This library</a>, for example, provides server-side generation of the Facebook pixel, given a hash of options.</p>\n"}], "owner": {"reputation": 829, "user_id": 2646969, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Tp2tE.jpg?s=128&g=1", "display_name": "Diego Somar", "link": "https://stackoverflow.com/users/2646969/diego-somar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 48399968, "answer_count": 1, "score": 0, "last_activity_date": 1516704954, "creation_date": 1516702174, "question_id": 48399053, "link": "https://stackoverflow.com/questions/48399053/nokogiri-how-to-allow-only-the-facebook-pixel-in-the-input-and-remove-all-html", "title": "Nokogiri: How to allow only the Facebook Pixel in the input and remove all HTML and scripts?", "body": "<p>I have a system which the users can put some codes in the HTML. For security reasons, we don't allow to put the <code>&lt;script&gt;</code> tag.</p>\n\n<p>Example, to insert the Google Analytics, we get the user <code>UA-CODE</code> and our system generates the Google Analytics Script.</p>\n\n<p>But to insert the Facebook Pixel is a little bit more complicated, because this software has many custom options, and the final code is always different. </p>\n\n<p>There's a way to get only the Facebook Pixel script in an input?</p>\n\n<p>The code is like that:</p>\n\n<pre><code>&lt;!-- Facebook Pixel Code --&gt;\n&lt;script&gt;\n!function(f,b,e,v,n,t,s)\n{if(f.fbq)return;n=f.fbq=function(){n.callMethod?\nn.callMethod.apply(n,arguments):n.queue.push(arguments)};\nif(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\nn.queue=[];t=b.createElement(e);t.async=!0;\nt.src=v;s=b.getElementsByTagName(e)[0];\ns.parentNode.insertBefore(t,s)}(window, document,'script',\n'https://connect.facebook.net/en_US/fbevents.js');\nfbq('init', 'XXXXXXXXXXXXXXX');\nfbq('track', 'PageView');\n&lt;/script&gt;\n&lt;noscript&gt;&lt;img height=\"1\" width=\"1\" style=\"display:none\"\nsrc=\"https://www.facebook.com/tr?id=1026290407456147&amp;ev=PageView&amp;noscript=1\"\n/&gt;&lt;/noscript&gt;\n&lt;!-- End Facebook Pixel Code --&gt;\n</code></pre>\n\n<p>If the user to put some extra scripts in this input field, I'd like to remove.</p>\n\n<pre><code>ruby -v: ruby 2.2.2p95\nrails -v: Rails 4.2.1\nnokogiri -v: Nokogiri (1.8.0)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "sidekiq", "rails-admin"], "owner": {"reputation": 53, "user_id": 8465859, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VC4VekZwgeg/AAAAAAAAAAI/AAAAAAAAJeU/BCTE4x5KNjk/photo.jpg?sz=128", "display_name": "\u0141ukasz Szmelc", "link": "https://stackoverflow.com/users/8465859/%c5%81ukasz-szmelc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1516700006, "creation_date": 1516700006, "question_id": 48398314, "link": "https://stackoverflow.com/questions/48398314/how-to-perform-export-action-from-rails-admin-with-sidekiq", "title": "How to perform export action from rails_admin with Sidekiq?", "body": "<p>I have a Rails 4.2.9 app that uses rails_admin gem to manage resources. The owner uses admin panel heavily and he would like to generate reports. The feature works locally but on staging and production I get <code>504 - gateway timeout</code>. </p>\n\n<p>I guess the problem is that a lot of objects is generated and therefore, the request takes too much time. That's why I would like to delegate the export action to background job. The problem is however, that I cannot find where the export action is performed in a code and I do not which part I should wrap in a worker. The only part that has something to do with exporting is located in <code>rails_admin/application_controller.rb</code> but I guess that's not it:</p>\n\n<pre><code>def log_info\n  params_to_log =\n    params.except(:authenticity_token).merge(current_user_id: current_user.try(:id)).to_s\n  Rails.logger.info(\"Generating admin report: #{params_to_log}\")\nend\n\ndef _authenticate!\n  log_info if action_name == \"export\" &amp;&amp; request.method == \"POST\"\n  instance_eval(&amp;RailsAdmin::Config.authenticate_with)\nend\n</code></pre>\n\n<p>I did some research on it and it seems like a common problem, but I was unable to find a solution. If you can answer my question or suggest better solutions, I would be extremely grateful.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "soap", "wsdl", "wadl"], "owner": {"reputation": 13, "user_id": 4646334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N6uQO.jpg?s=128&g=1", "display_name": "Elizaveta  Olehnovich", "link": "https://stackoverflow.com/users/4646334/elizaveta-olehnovich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516698059, "creation_date": 1516698059, "question_id": 48397710, "link": "https://stackoverflow.com/questions/48397710/generate-wadl-or-any-xml-documentation-for-ruby-on-rails-project", "title": "Generate WADL or any XML documentation for Ruby on rails project", "body": "<p>Is there possibility to generate WADL/WSDL from an existing Ruby on Rails project? Need to test the security\nOr to generate some kind of documentation for controllers\n<a href=\"https://github.com/austvik/wadlgen\" rel=\"nofollow noreferrer\">https://github.com/austvik/wadlgen</a> is too old and doesn't work</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 0, "creation_date": 1516699124, "post_id": 48397704, "comment_id": 83783765, "body": "I get a now method error for the julian day method in Rails. Do i need an additional gem for that I thought it is part of the ruby standard library."}, {"owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "reply_to_user": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 0, "creation_date": 1516699383, "post_id": 48397704, "comment_id": 83783934, "body": "It&#39;s in ruby 2 I think (1.9 might not have it). You can work out the current day other ways though if you need to. E.g. <code>de.created_at.to_i &#47; (60*60*24)</code>."}, {"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 1, "creation_date": 1516699642, "post_id": 48397704, "comment_id": 83784103, "body": "i am using 2.4 so it should have it. But still no method error. i used <code>strftime(%d.%m)</code> instead"}, {"owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "reply_to_user": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 1, "creation_date": 1516699756, "post_id": 48397704, "comment_id": 83784177, "body": "It seems <code>DateTime</code> has it but not <code>Time</code>. You could do <code>created_at.to_datetime.jd</code> but you&#39;ve sorted it anyway :)"}], "tags": [], "owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "is_accepted": true, "score": 2, "last_activity_date": 1516698040, "creation_date": 1516698040, "answer_id": 48397704, "question_id": 48397161, "link": "https://stackoverflow.com/questions/48397161/rendering-diary-entries-for-a-user-in-rails-depending-on-created-at/48397704#48397704", "title": "Rendering Diary entries for a user in Rails depending on created_at", "body": "<p>You could do it by iterating over the diary entries yourself and keeping track of the day for the current entry (rather than just <code>render @diary_entries</code>). Then when the day changes include your \"day\" row.</p>\n\n<p>For example:</p>\n\n<pre><code>&lt;tbody class=\"diary_entries\"&gt;\n  &lt;% current_day = nil %&gt;\n  &lt;% @diary_entries.each do |de| %&gt;\n    &lt;% if current_day != de.created_at.jd %&gt;\n      &lt;tr&gt;&lt;td&gt;&lt;%= de.created_at.strftime(\"%A\") %&gt;&lt;/td&gt;&lt;/tr&gt;\n      &lt;% current_day = de.created_at.jd %&gt;\n    &lt;% end %&gt;\n    &lt;%= render partial: 'diary_entry', locals: { diary_entry: de } %&gt;\n  &lt;% end %&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>I've used <a href=\"https://ruby-doc.org/stdlib-2.5.0/libdoc/date/rdoc/Date.html#method-i-jd\" rel=\"nofollow noreferrer\"><code>jd</code></a> to keep track of the current day so that it'll cope across year/month/week boundaries.</p>\n\n<p>Where it won't work as well is across pages. You'll always see a day at the top of a new page even if it isn't the first entry for that day (because earlier entries were on an earlier page). That might be desirable anyway or you could do a separate query to detect that situation.</p>\n"}], "owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 48397704, "answer_count": 1, "score": 1, "last_activity_date": 1516698040, "creation_date": 1516696073, "last_edit_date": 1516697012, "question_id": 48397161, "link": "https://stackoverflow.com/questions/48397161/rendering-diary-entries-for-a-user-in-rails-depending-on-created-at", "title": "Rendering Diary entries for a user in Rails depending on created_at", "body": "<p>I have the following controller action inside a users_controller.rb:</p>\n\n<pre><code>  def show\n    @user = User.find(params[:id])\n    redirect_to root_url and return unless @user.activated?\n    @diary_entries = @user.diary_entries.paginate(page: params[:page])\n  end\n</code></pre>\n\n<p>This controller leads to this view Show.html.erb:</p>\n\n<pre><code>&lt;% provide(:title, @user.name) %&gt;\n&lt;div class=\"row\"&gt;\n  &lt;aside class=\"col-sm-4\"&gt;\n    &lt;section class=\"user_info\"&gt;\n      &lt;h1&gt;\n        &lt;%= gravatar_for @user %&gt;\n        &lt;%= @user.name %&gt;\n\n      &lt;/h1&gt;\n    &lt;/section&gt;\n    &lt;/div&gt;\n  &lt;/aside&gt;\n  &lt;div class=\"col-md-8\"&gt;\n    &lt;% if @user.diary_entries.any? %&gt;\n  &lt;table class=\"table table-dark\"&gt;\n    &lt;h3 class=\"text-center\"&gt;My Diabetes Diary &lt;/h3&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n       &lt;th scope=\"col\"&gt;Time&lt;/th&gt;\n       &lt;th scope=\"col\"&gt;Bloodsugar&lt;/th&gt;\n       &lt;th scope=\"col\"&gt;Bread Units&lt;/th&gt;\n       &lt;th scope=\"col\"&gt;Injected Insulin&lt;/th&gt;\n       &lt;th scope=\"col\"&gt;Comment&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n\n    &lt;tbody class=\"diary_entries\"&gt;\n\n        &lt;%= render @diary_entries %&gt;\n    &lt;/tbody&gt;\n  &lt;/table&gt;\n\n    &lt;% end %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>This view renders the _diary_entry.html.erb partial via (render @diary_entries)</p>\n\n<pre><code>&lt;tr id=\"diary_entry-&lt;%= diary_entry.id %&gt;\"&gt;\n &lt;td&gt; &lt;span class=\"timestamp\"&gt;&lt;%= diary_entry.created_at.strftime(\"%d.%m.%Y %k:%M\") %&gt;&lt;/span&gt; &lt;/td&gt;\n  &lt;td&gt;&lt;span class=\"bloodsugar\"&gt;&lt;%= diary_entry.bloodsugar %&gt;&lt;/span&gt;&lt;/td&gt;\n &lt;td&gt; &lt;span class=\"carbohydrates\"&gt;&lt;%= diary_entry.carbohydrates %&gt;&lt;/span&gt;&lt;/td&gt;\n &lt;td&gt; &lt;span class=\"insulin\"&gt;&lt;%= diary_entry.insulin %&gt;&lt;/span&gt;&lt;/td&gt;\n &lt;td&gt; &lt;span class=\"comment\"&gt;&lt;%= diary_entry.comment %&gt;&lt;/span&gt;&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>My Question: Obviously I am rendering Diary Entries inside a table, which are previously retrieved from a Databse and belong to a user. Everything works fine. \nWhat I need now is that for every new day inside the diary I want a heading with the name of the day in one table row.<br> \nFor that to happen I need some logic inside the rendering process of the partial which is checking the created-at attribute of the newly rendered entry and comparing it with the prevoiusly rendered entry. If the newly rendered entry has the date of a new day then, befoer rendering the new entry write a heading and after that render the entry.<br></p>\n\n<p>Does anyone have any idea how to solve this? Maybe I am wrong and this logic should be implemented somewhere else (Create action of the Diary or Javascript)???<br></p>\n\n<p>Any help is higly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter-bootstrap", "activeadmin"], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 2560962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PqGBp.jpg?s=128&g=1", "display_name": "alpo", "link": "https://stackoverflow.com/users/2560962/alpo"}, "is_accepted": false, "score": -2, "last_activity_date": 1516890370, "creation_date": 1516890370, "answer_id": 48445209, "question_id": 48396120, "link": "https://stackoverflow.com/questions/48396120/active-admin-open-a-modal-after-clicking-on-an-action-item-link/48445209#48445209", "title": "active admin: open a modal after clicking on an action_item link", "body": "<pre><code>action_item only: :show do\n  link_to('Click Here', \"#\", data: {toggle: \"modal\", target: \"#modal\"})\nend\n</code></pre>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 990, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516890370, "creation_date": 1516691834, "question_id": 48396120, "link": "https://stackoverflow.com/questions/48396120/active-admin-open-a-modal-after-clicking-on-an-action-item-link", "title": "active admin: open a modal after clicking on an action_item link", "body": "<p>I have a action_item in activeadmin show page</p>\n\n<pre><code>action_item only: :show do\n  link_to ' Remove Dealer', \"/admin/users/#{user.id}/removedealer\"\nend\n</code></pre>\n\n<p>I want to make same action_item but open a bootstrap modal on its click.</p>\n\n<p>Normally we have a <code>&lt;%= link_to 'Click Here', \"#\", data: {toggle: \"modal\", target: \"#modal\"} %&gt;</code> for modals but how can I do that in activeadmin </p>\n"}, {"tags": ["ruby", "swagger", "swagger-ui", "grape-api"], "owner": {"reputation": 39, "user_id": 6588273, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Xzkdl.jpg?s=128&g=1", "display_name": "\u674e\u68a6\u9a70", "link": "https://stackoverflow.com/users/6588273/%e6%9d%8e%e6%a2%a6%e9%a9%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1516692510, "creation_date": 1516691544, "last_edit_date": 1516692510, "question_id": 48396042, "link": "https://stackoverflow.com/questions/48396042/how-to-show-parameters-of-grape-api-when-it-is-hash-or-array-and-the-inside-valu", "title": "How to show parameters of Grape API when it is hash or array and the inside value isn&#39;t defined with swagger doc", "body": "<p>I am using swagger doc to generate API document in grape api. API parameters are defined like:</p>\n\n<pre><code>desc \"Get results by query\"\n  params do\n    requires :type, type: String,  desc: \"search type\"\n    requires :body, type: Hash,    desc: \"query body\"\n    optional :user, type: Hash,    desc: \"support search as other user, otherwise search as current user\" do\n      requires :id,         type: String, desc: \"user id\"\n      requires :name,       type: String, desc: \"user name (dn)\"\n      requires :directory,  type: String, desc: \"directory user belongs to\"\n    end\n  end\n  post :query do\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/J8nLy.png\" rel=\"nofollow noreferrer\">The generated JSON</a> only shows the user related parameters. How can I define the hash parameters whose key is not restricted and could be generated in API document?</p>\n"}, {"tags": ["ruby", "attr-accessor"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1516693856, "post_id": 48395155, "comment_id": 83780723, "body": "1. Even when there are no getters we can always use <a href=\"https://ruby-doc.org/core-2.5.0/Object.html#method-i-instance_variable_get\" rel=\"nofollow noreferrer\">Object#instance_varaible_get</a> to obtain values of instance variables. 2. The OP made no mention of Java or Smalltalk and (like me) may know nothing of either. Why even mention them? 3. <a href=\"http://ruby-doc.org/core-2.4.0/Module.html#method-i-attr_reader\" rel=\"nofollow noreferrer\">Module#attr_reader</a> is a garden-variety Ruby method that merely saves us the trouble of writing getters. Why bring up metaprogramming, which is unnecessary and certainly beyond many readers&#39; knowledge."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 1, "last_activity_date": 1516687174, "creation_date": 1516687174, "answer_id": 48395155, "question_id": 48395033, "link": "https://stackoverflow.com/questions/48395033/clarification-on-ruby-class-method/48395155#48395155", "title": "Clarification on Ruby class method", "body": "<p>The <code>@unique</code> and <code>@index</code> are private instance variables. Inside the class, you always precede them with an <code>@</code>. Outside the class, they are completely unavailable<sup>[1]</sup>. <code>attr_reader</code> is a metaprogramming function in Ruby that constructs a getter. The following are equivalent.</p>\n\n<pre><code>attr_reader :unique, :index\n</code></pre>\n\n<p>and</p>\n\n<pre><code>def unique\n  @unique\nend\n\ndef index\n  @index\nend\n</code></pre>\n\n<p>The methods defined by <code>attr_reader</code> and co are public and thus can be accessed outside the class, using <code>object_name.unique</code> syntax. Like in many languages, they can also be accessed unqualified from within the class, so if you're inside the class scope, <code>unique</code> and <code>self.unique</code> will evaluate to the same thing (assuming there isn't a local variable called <code>unique</code> in scope). So your <code>unique.size</code> call is actually calling two methods. In Java, it would look like <code>getUnique().getSize()</code>, but Ruby lets us omit the parentheses in many cases.</p>\n\n<p>An important thing to remember about Ruby is that, in general, if you do <code>a.b</code> or <code>a.b = c</code>, you are <em>always</em> calling a method. Ruby instance variables (the things starting with <code>@</code>) are always private, so there's no way to directly access them outside the class. There's no <code>foo.bar</code> syntax to access a public instance variable like in Java or C++. <code>foo.bar</code> is always a method; it just might happen to be a method which accesses and returns the value of <code>@bar</code>.</p>\n\n<p>This is more in line with Smalltalk's view of OOP, where loosely coupled objects pass messages in order to exchange information. In such a model, it doesn't make sense to have direct access to someone else's data; all you can do is request it and wait for the response.</p>\n\n<hr>\n\n<p><sup>[1]</sup> Ignoring reflection features, which can bypass such rules.</p>\n"}, {"comments": [{"owner": {"reputation": 4275, "user_id": 5739288, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mRf6m.jpg?s=128&g=1", "display_name": "Iggy", "link": "https://stackoverflow.com/users/5739288/iggy"}, "edited": false, "score": 0, "creation_date": 1516744167, "post_id": 48395167, "comment_id": 83812484, "body": "Thanks for answering them! I need further clarification on #1: Is it correct to say that <code>:unique</code> gets its value from <code>@unique</code>, that this is possible because of Ruby&#39;s magic as long as <code>@my_var</code> is named the same as <code>attr_reader :my_var</code>?"}, {"owner": {"reputation": 180, "user_id": 6084148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SUTXn.jpg?s=128&g=1", "display_name": "max.underthesun", "link": "https://stackoverflow.com/users/6084148/max-underthesun"}, "reply_to_user": {"reputation": 4275, "user_id": 5739288, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mRf6m.jpg?s=128&g=1", "display_name": "Iggy", "link": "https://stackoverflow.com/users/5739288/iggy"}, "edited": false, "score": 0, "creation_date": 1516774524, "post_id": 48395167, "comment_id": 83821388, "body": "Yes @Iggy. This is correct. Ruby magic &quot;connecting&quot; for you <code>@my_var</code> and getter method defined by line <code>attr_reader :my_var</code>. Even more, if you for example define getter and setter with line <code>attr_accessor :some_name</code> ruby will actually create for you the variable <code>@some_name</code> at the moment you&#39;ll assign some value to it through the setter method (and you can use this variable accessing to it with <code>@some_name</code> in your class)."}], "tags": [], "owner": {"reputation": 180, "user_id": 6084148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SUTXn.jpg?s=128&g=1", "display_name": "max.underthesun", "link": "https://stackoverflow.com/users/6084148/max-underthesun"}, "is_accepted": true, "score": 4, "last_activity_date": 1516687401, "last_edit_date": 1516687401, "creation_date": 1516687277, "answer_id": 48395167, "question_id": 48395033, "link": "https://stackoverflow.com/questions/48395033/clarification-on-ruby-class-method/48395167#48395167", "title": "Clarification on Ruby class method", "body": "<ol>\n<li>In the context of the <code>initialize</code> method the <code>unique</code> is the same as <code>self.unique</code> and the <code>self</code> here is the instantiated object (<code>TextCompressor.new</code>)</li>\n</ol>\n\n<p><code>self.unique</code> in this case will return you the value of <code>@unique</code> variable</p>\n\n<ol start=\"2\">\n<li>The reason you can call <code>compressor.unique</code> and <code>compressor.index</code> is coming from <code>attr_reader :unique, :index</code>.\nThis line sets getters for you (getter is a method to query object for instance variable value).</li>\n</ol>\n"}], "owner": {"reputation": 4275, "user_id": 5739288, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mRf6m.jpg?s=128&g=1", "display_name": "Iggy", "link": "https://stackoverflow.com/users/5739288/iggy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 48395167, "answer_count": 2, "score": 0, "last_activity_date": 1516688678, "creation_date": 1516686632, "last_edit_date": 1516688678, "question_id": 48395033, "link": "https://stackoverflow.com/questions/48395033/clarification-on-ruby-class-method", "title": "Clarification on Ruby class method", "body": "<p>I found this class from Eloquent Ruby book.</p>\n\n<pre><code>class TextCompressor\n  attr_reader :unique, :index\n  def initialize( text )\n    @unique = []\n    @index = []\n    words = text.split\n    words.each do |word|\n      i = @unique.index( word )\n      if i\n        @index &lt;&lt; i\n      else\n        @unique &lt;&lt; word\n        @index &lt;&lt; unique.size - 1\n      end\n    end \n  end\nend\n</code></pre>\n\n<p>It works like this:</p>\n\n<pre><code>text = \"This specification is the spec for a specification\"\ncompressor = TextCompressor.new(text)\ncompressor.unique #=&gt; [\"This\", \"specification\", \"is\", \"the\", \"spec\", \"for\", \"a\"]\ncompressor.index #=&gt; [0, 1, 2, 3, 4, 5, 6, 1]\n</code></pre>\n\n<ol>\n<li>What is <code>unique</code> in <code>@index &lt;&lt; unique.size - 1</code>, and where did it get its value from?</li>\n<li>Are <code>compressor.unique</code> and <code>compressor.index</code> coming from <code>attr_reader :unique, :index</code>, or <code>@unique</code> and <code>@index</code>?</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "associations"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7042505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CtvkD.jpg?s=128&g=1", "display_name": "Khoj Badami", "link": "https://stackoverflow.com/users/7042505/khoj-badami"}, "edited": false, "score": 0, "creation_date": 1516686515, "post_id": 48394984, "comment_id": 83777517, "body": "Sheesh okay my bad. Pluralisation is important i guess!"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 3, "last_activity_date": 1516686643, "last_edit_date": 1516686643, "creation_date": 1516686379, "answer_id": 48394984, "question_id": 48394947, "link": "https://stackoverflow.com/questions/48394947/activerecordhasmanythroughassociationnotfounderror-issue-with-everything-as-pe/48394984#48394984", "title": "ActiveRecord::HasManyThroughAssociationNotFoundError issue with everything as per the Docs", "body": "<blockquote>\n  <p>through: :client_authorization_rule </p>\n</blockquote>\n\n<p>it should be client_authorization_rules</p>\n\n<pre><code>class Client &lt; ApplicationRecord\n\n  has_many :client_authorization_rules\n  has_many :projects, through: :client_authorization_rules\n\nend\n\nclass Project &lt; ApplicationRecord\n\n  has_many :client_authorization_rules\n  has_many :clients, through: :client_authorization_rules\n\nend\n</code></pre>\n\n<p>one more thing as a side note when you write <code>belongs_to :project</code> in rails 5 it automatically means thats <code>project_id</code> is required before save. so there is no sense of  <code>validates_presence_of :project</code></p>\n\n<pre><code>class ClientAuthorizationRule &lt; ApplicationRecord\n\n  belongs_to :project #it means that project_id required is true\n  belongs_to :client  #it means that client_id required is true\n\n  #validates_presence_of :project\n  #validates_presence_of :client\n\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43225, "user_id": 297087, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/17b3a5816f0647e9b0f7c49d60f93e7b?s=128&d=identicon&r=PG", "display_name": "Salil", "link": "https://stackoverflow.com/users/297087/salil"}, "is_accepted": false, "score": 3, "last_activity_date": 1516686404, "creation_date": 1516686404, "answer_id": 48394993, "question_id": 48394947, "link": "https://stackoverflow.com/questions/48394947/activerecordhasmanythroughassociationnotfounderror-issue-with-everything-as-pe/48394993#48394993", "title": "ActiveRecord::HasManyThroughAssociationNotFoundError issue with everything as per the Docs", "body": "<p>Following </p>\n\n<pre><code>class Client &lt; ApplicationRecord\n\n  has_many :client_authorization_rules\n  has_many :projects, through: :client_authorization_rule\n\nend\n\nclass Project &lt; ApplicationRecord\n\n  has_many :client_authorization_rules\n  has_many :clients, through: :client_authorization_rule\n\nend\n</code></pre>\n\n<p>Should be </p>\n\n<pre><code>class Client &lt; ApplicationRecord    \n  has_many :client_authorization_rules\n  has_many :projects, through: :client_authorization_rules    \nend\n\nclass Project &lt; ApplicationRecord    \n  has_many :client_authorization_rules\n  has_many :clients, through: :client_authorization_rules    \nend\n</code></pre>\n\n<p>Note :- <code>through: :client_authorization_rule</code> should be <code>through: :client_authorization_rules</code></p>\n"}], "owner": {"reputation": 95, "user_id": 7042505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CtvkD.jpg?s=128&g=1", "display_name": "Khoj Badami", "link": "https://stackoverflow.com/users/7042505/khoj-badami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 48394984, "answer_count": 2, "score": 0, "last_activity_date": 1516686643, "creation_date": 1516686198, "question_id": 48394947, "link": "https://stackoverflow.com/questions/48394947/activerecordhasmanythroughassociationnotfounderror-issue-with-everything-as-pe", "title": "ActiveRecord::HasManyThroughAssociationNotFoundError issue with everything as per the Docs", "body": "<p>Below are my models:</p>\n\n<pre><code>class Client &lt; ApplicationRecord\n\n  has_many :client_authorization_rules\n  has_many :projects, through: :client_authorization_rule\n\nend\n\nclass Project &lt; ApplicationRecord\n\n  has_many :client_authorization_rules\n  has_many :clients, through: :client_authorization_rule\n\nend\n\nclass ClientAuthorizationRule &lt; ApplicationRecord\n\n  belongs_to :project\n  belongs_to :client\n\n  validates_presence_of :project\n  validates_presence_of :client\n\nend\n</code></pre>\n\n<p>So, I have followed everything as per the docs: <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association</a></p>\n\n<p>The errors I am getting is when I do something like: </p>\n\n<pre><code>p.clients\n</code></pre>\n\n<p>Here \"p\" is a project. I cannot even access the \"clients\" method on the project without getting the following error:</p>\n\n<pre><code>ActiveRecord::HasManyThroughAssociationNotFoundError: Could not find the association :client_authorization_rule in model Project\n</code></pre>\n\n<p>Not sure what I am missing. Thanks. My Rails version is Rails 5.0.6 and ruby 2.2.3. Is this some known issue? I cant find any one with this issue. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "devise"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1516687053, "post_id": 48395060, "comment_id": 83777741, "body": "If I remove <code>before_action :authenticate_user!</code> I still get teh same error message."}, {"owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "reply_to_user": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1516688999, "post_id": 48395060, "comment_id": 83778510, "body": "Happy to help. If it worked you can accept the answer."}], "tags": [], "owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "is_accepted": true, "score": 1, "last_activity_date": 1516686742, "creation_date": 1516686742, "answer_id": 48395060, "question_id": 48394938, "link": "https://stackoverflow.com/questions/48394938/rspec-test-not-passing-on-my-users-controller-expected-response-to-be-a-3xx-r/48395060#48395060", "title": "RSpec test not passing on my users controller `Expected response to be a &lt;3XX: redirect&gt;, but was a &lt;200: OK&gt;`", "body": "<p>The issue you have is due to 2 </p>\n\n<pre><code>before_action :authenticate_user!\nbefore_action :authenticate_user!, except: [:show, :index]\n</code></pre>\n\n<p>Your filter is being override by second call to the same. In the second call you have <code>expect show</code> which will allow user to access page without login and hence your test will not pass as it is not being redirect to login page. Just remove <code>before_action :authenticate_user!, except: [:show, :index]</code> from controller and it will work for your test.</p>\n"}], "owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "accepted_answer_id": 48395060, "answer_count": 1, "score": 0, "last_activity_date": 1516686742, "creation_date": 1516686104, "question_id": 48394938, "link": "https://stackoverflow.com/questions/48394938/rspec-test-not-passing-on-my-users-controller-expected-response-to-be-a-3xx-r", "title": "RSpec test not passing on my users controller `Expected response to be a &lt;3XX: redirect&gt;, but was a &lt;200: OK&gt;`", "body": "<p>After looking at posts of people with similar error messages, I still can't work out why my RSpec test won't pass. When running my spec I'm getting the following error message:</p>\n\n<blockquote>\n  <blockquote>\n    <p>Failures:</p>\n  </blockquote>\n  \n  <p>1) UsersController GET #show when a user is not logged in redirects\n  to login\n       Failure/Error: expect(response).to redirect_to(new_user_session_path)</p>\n\n<pre><code>   Expected response to be a &lt;3XX: redirect&gt;, but was a &lt;200: OK&gt;\n   Response body:\n # ./spec/model/user_spec.rb:21:in `block (4 levels) in &lt;top (required)&gt;'\n</code></pre>\n  \n  <p>Finished in 0.25988 seconds (files took 5.02 seconds to load) 5\n  examples, 1 failure</p>\n  \n  <p>Failed examples:</p>\n  \n  <p>rspec ./spec/model/user_spec.rb:19 # UsersController GET #show when a\n  user is not logged in redirects to login\"</p>\n</blockquote>\n\n<hr>\n\n<p>Here is my user_spec file:</p>\n\n<pre><code>require 'rails_helper'\n\ndescribe UsersController, type: :controller do\n  let(:user) { User.create!(email: 'test@example.com', password: '1234567890') }\n\n  describe 'GET #show' do\n\n    context 'when a user is logged in' do\n        before do\n            sign_in user\n        end\n        it 'loads correct user details' do\n            get :show, params: { id: user.id }\n            expect(assigns(:user)).to eq user\n        end\n    end\n\n    context 'when a user is not logged in' do\n      it 'redirects to login' do\n        get :show, params: { id: user.id }\n        expect(response).to redirect_to(new_user_session_path)\n      end\n    end\n  end\n\nend\n</code></pre>\n\n<p>My rails_helper.rb:</p>\n\n<pre><code># This file is copied to spec/ when you run 'rails generate rspec:install'\nrequire 'spec_helper'\n\nENV['RAILS_ENV'] ||= 'test'\n  require File.expand_path('../../config/environment', __FILE__)\n  # Prevent database truncation if the environment is production\n  abort(\"The Rails environment is running in production mode!\") if Rails.env.production?\n  require 'rspec/rails'\n  # Add additional requires below this line. Rails is not loaded until this point!\n\n  # note: require 'devise' after require 'rspec/rails'\n  require 'devise'\n\nRSpec.configure do |config|\n  # For Devise &gt;= 4.1.0\n  config.include Devise::Test::ControllerHelpers, type: :controller\n  # Use the following instead if you are on Devise &lt;= 4.1.1\n  # config.include Devise::TestHelpers, :type =&gt; :controller\nend\n\n  # Requires supporting ruby files with custom matchers and macros, etc, in\n  # spec/support/ and its subdirectories. Files matching `spec/**/*_spec.rb` are\n  # run as spec files by default. This means that files in spec/support that end\n  # in _spec.rb will both be required and run as specs, causing the specs to be\n  # run twice. It is recommended that you do not name files matching this glob to\n  # end with _spec.rb. You can configure this pattern with the --pattern\n  # option on the command line or in ~/.rspec, .rspec or `.rspec-local`.\n  #\n  # The following line is provided for convenience purposes. It has the downside\n  # of increasing the boot-up time by auto-requiring all files in the support\n  # directory. Alternatively, in the individual `*_spec.rb` files, manually\n  # require only the support files necessary.\n  #\n  # Dir[Rails.root.join('spec/support/**/*.rb')].each { |f| require f }\n\n  # Checks for pending migrations and applies them before tests are run.\n  # If you are not using ActiveRecord, you can remove this line.\n\nActiveRecord::Migration.maintain_test_schema!\n\nRSpec.configure do |config|\n  # Remove this line if you're not using ActiveRecord or ActiveRecord fixtures\n  config.fixture_path = \"#{::Rails.root}/spec/fixtures\"\n\n  # If you're not using ActiveRecord, or you'd prefer not to run each of your\n  # examples within a transaction, remove the following line or assign false\n  # instead of true.\n  config.use_transactional_fixtures = true\n\n  # RSpec Rails can automatically mix in different behaviours to your tests\n  # based on their file location, for example enabling you to call `get` and\n  # `post` in specs under `spec/controllers`.\n  #\n  # You can disable this behaviour by removing the line below, and instead\n  # explicitly tag your specs with their type, e.g.:\n  #\n  #     RSpec.describe UsersController, :type =&gt; :controller do\n  #       # ...\n  #     end\n  #\n  # The different available types are documented in the features, such as in\n  # https://relishapp.com/rspec/rspec-rails/docs\n  config.infer_spec_type_from_file_location!\n\n  # Filter lines from Rails gems in backtraces.\n  config.filter_rails_from_backtrace!\n  # arbitrary gems may also be filtered via:\n  # config.filter_gems_from_backtrace(\"gem name\")\n\nend\n</code></pre>\n\n<p>My users_controller:</p>\n\n<pre><code> class UsersController &lt; ApplicationController\n    before_action :set_user, only: [:show, :edit, :update, :destroy]\n    before_action :authenticate_user!\n    before_action :authenticate_user!, except: [:show, :index]\n    load_and_authorize_resource\n  # GET /users\n  # GET /users.json\n  def index\n    @users = User.all\n  end\n\n  # GET /users/1\n  # GET /users/1.json\n  def show\n  end\n\n  # GET /users/new\n  def new\n    @user = User.new\n  end\n\n  # GET /users/1/edit\n  def edit\n  end\n\n  # POST /users\n  # POST /users.json\n  def create\n    @user = User.new(user_params)\n\n    respond_to do |format|\n      if @user.save\n        format.html { redirect_to @user, notice: 'User was successfully created.' }\n        format.json { render :show, status: :created, location: @user }\n      else\n        format.html { render :new }\n        format.json { render json: @user.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /users/1\n  # PATCH/PUT /users/1.json\n  def update\n    respond_to do |format|\n      if @user.update(user_params)\n        format.html { redirect_to @user, notice: 'User was successfully updated.' }\n        format.json { render :show, status: :ok, location: @user }\n      else\n        format.html { render :edit }\n        format.json { render json: @user.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /users/1\n  # DELETE /users/1.json\n  def destroy\n    @user.destroy\n    respond_to do |format|\n      format.html { redirect_to users_url, notice: 'User was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_user\n      @user = User.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def user_params\n      params.require(:user).permit(:first_name, :last_name)\n    end\nend\n</code></pre>\n\n<p>And routes:</p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users, path: '', path_names: { sign_in: 'login', sign_out: 'logout' }\n\n  resources :products do\n    resources :comments\n  end\n  resources :users\n\n  post 'simple_pages/thank_you'\n\n  get 'simple_pages/about'\n\n  get 'simple_pages/contact'\n\n  get 'simple_pages/thank_you'\n\n  get 'simple_pages/index'\n    root \"simple_pages#landing_page\"\n\n    resources :orders, only: [:index, :show, :create, :destroy]\n\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\nend\n</code></pre>\n"}, {"tags": ["mysql", "sql", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "edited": false, "score": 0, "creation_date": 1516684851, "post_id": 48394651, "comment_id": 83776936, "body": "I&#39;ll probably oust this because running the first line alone takes a little over 40 seconds to process (I tried using .select() and .pluck() with same runtime)"}], "tags": [], "owner": {"reputation": 3459, "user_id": 3185510, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/nlb4D.jpg?s=128&g=1", "display_name": "webster", "link": "https://stackoverflow.com/users/3185510/webster"}, "is_accepted": false, "score": 0, "last_activity_date": 1516684345, "creation_date": 1516684345, "answer_id": 48394651, "question_id": 48394460, "link": "https://stackoverflow.com/questions/48394460/selecting-distinct-values-from-each-column/48394651#48394651", "title": "Selecting Distinct Values from Each Column", "body": "<p>You could do this:</p>\n\n<pre><code>@info = User.distinct.select(:first_name, :last_name, :city, :state, :age)\n@first, @last, @city, @state, @age = [], [], [], [], []\n@info.map{ |i| @first&lt;&lt;i[0]; @last&lt;&lt;i[1]; @city&lt;&lt;i[2]; @state&lt;&lt;i[3], @age&lt;&lt;i[4] }\n@info = { 'first' =&gt; @first,\n          'last' =&gt; @last,\n          'city' =&gt; @city,\n          'state' =&gt; @state,\n          'age' =&gt; @age }\nrespond_with @info\n</code></pre>\n\n<p>Please try benchmarking before implementing this in production.</p>\n"}, {"tags": [], "owner": {"reputation": 3394, "user_id": 8772888, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/WGC00.png?s=128&g=1", "display_name": "ravioli", "link": "https://stackoverflow.com/users/8772888/ravioli"}, "is_accepted": false, "score": 2, "last_activity_date": 1516684661, "creation_date": 1516684661, "answer_id": 48394698, "question_id": 48394460, "link": "https://stackoverflow.com/questions/48394460/selecting-distinct-values-from-each-column/48394698#48394698", "title": "Selecting Distinct Values from Each Column", "body": "<p>Not sure how you want your final data to be output, but if you want to avoid multiple SQL statements, you can do something like this:</p>\n\n<pre><code>SELECT \nARRAY(SELECT DISTINCT(col1) FROM MyTable) AS col1_values,\nARRAY(SELECT DISTINCT(col2) FROM MyTable) AS col2_values\n</code></pre>\n\n<p>This will give you a single row with all the DISTINCT values for each \"colX\" you specify.  Just add on whatever additional columns you want to include.  The DISTINCT values in each column will be returned as an array.</p>\n\n<p>Performance will still be stinky, since I don't think you can avoid doing multiple distinct DISTINCT operations.</p>\n\n<p>Let me know if that's what you're looking for.</p>\n"}], "owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516684661, "creation_date": 1516683074, "last_edit_date": 1516684388, "question_id": 48394460, "link": "https://stackoverflow.com/questions/48394460/selecting-distinct-values-from-each-column", "title": "Selecting Distinct Values from Each Column", "body": "<p>Is there a way to get the Distinct values from each column in a MYSQL database without having to do multple <code>SELECT DISTINCT</code> statements for each column?</p>\n\n<p>Right now in my rails controller I'm using <code>.pluck()</code> to run:</p>\n\n<pre><code>@first = User.distinct.pluck(:first_name)\n@last = User.distinct.pluck(:last_name)\n@city = User.distinct.pluck(:city)\n@state = User.distinct.pluck(:state)\n@age = User.distinct.pluck(:age)\n\n@info = {\n        'first' =&gt; @first,\n        'last' =&gt; @last,\n        'city' =&gt; @city,\n        'state' =&gt; @state,\n        'age' =&gt; @age\n    }\n\nrespond_with @info\n</code></pre>\n\n<p>Which creates an object with my two unique arrays in it, however it takes about 7.7 seconds (my table has 3.2 million fully-populated rows) and runs two separate SQL queries.</p>\n\n<p>I tried this method, but this is giving me an array of each unique COMBINATION:</p>\n\n<pre><code>@info = User.distinct.select(:first_name, :last_name, :city, :state, :age)\n\nrespond_with @info\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "logging", "logrotate"], "comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 1, "creation_date": 1516693175, "post_id": 48394406, "comment_id": 83780337, "body": "Not sure, but did you try to pass 0 as second parameter?"}, {"owner": {"reputation": 1490, "user_id": 5003256, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MQcIp.jpg?s=128&g=1", "display_name": "SV Madhava Reddy", "link": "https://stackoverflow.com/users/5003256/sv-madhava-reddy"}, "edited": false, "score": 1, "creation_date": 1516714255, "post_id": 48394406, "comment_id": 83794039, "body": "<code>logger = Logger.new(&#39;logfile.log&#39;)</code> <a href=\"http://ruby-doc.org/stdlib-2.1.0/libdoc/logger/rdoc/Logger.html\" rel=\"nofollow noreferrer\">Please refer docs for more info</a>."}], "owner": {"reputation": 631, "user_id": 6508904, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bdd8276832406ed7148917eebcc08f04?s=128&d=identicon&r=PG&f=1", "display_name": "shakeel", "link": "https://stackoverflow.com/users/6508904/shakeel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516682711, "creation_date": 1516682711, "question_id": 48394406, "link": "https://stackoverflow.com/questions/48394406/disable-logrotation-ruby-logger", "title": "Disable logrotation ruby Logger", "body": "<p>I am using ruby Logger to log messages</p>\n\n<pre><code>logger = Logger.new('log/sql.log', 1, 500 * 1024 * 1024)\n</code></pre>\n\n<p>the age of file is 1 day and size of log file is 500MB. when it reaches 500MB, it will rotate log file and will keep 1 day age files. </p>\n\n<p>i have already configured Linux log rotation using crontab for all log files. Now i want to completely disabled log rotation which is causing by  ruby Logger.</p>\n\n<p>is there any way to do that ?</p>\n\n<p>Thanks</p>\n"}]