[{"tags": ["ruby-on-rails", "ruby", "nokogiri", "libxml2"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1440026250, "post_id": 32106704, "comment_id": 52108637, "body": "Welcome to Stack Overflow. <code>Cowardly refusing to &#39;sudo brew install&#39;</code> is an indicator that Brew doesn&#39;t like using <code>sudo</code>. In my experience, this isn&#39;t a Nokogiri problem, it&#39;s really a permissions problem on your system caused by needing to use <code>sudo</code>. Nokogiri is an innocent bystander."}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 5245267, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d5486faa4da81fa66e949eda96f434f1?s=128&d=identicon&r=PG&f=1", "display_name": "johnwj", "link": "https://stackoverflow.com/users/5245267/johnwj"}, "edited": false, "score": 0, "creation_date": 1440090452, "post_id": 32107045, "comment_id": 52140293, "body": "I followed all of the steps, but for some reason, I still can&#39;t install libxml2."}], "tags": [], "owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "is_accepted": false, "score": 0, "last_activity_date": 1440025801, "last_edit_date": 1440025801, "creation_date": 1440025560, "answer_id": 32107045, "question_id": 32106704, "link": "https://stackoverflow.com/questions/32106704/problems-installing-nokogiri-v-1-6-1-and-libxml2/32107045#32107045", "title": "Problems installing Nokogiri -v 1.6.1 and libxml2", "body": "<p>Sometimes installing Nokogiri is tricky as it has several dependencies, which is what happened in your case too.</p>\n\n<p>\"<a href=\"http://www.nokogiri.org/tutorials/installing_nokogiri.html#mac_os_x\" rel=\"nofollow\">Installing Nokogiri</a>\" is a step-by-step tutorial on how to install Nokogiri on your Mac OSX system.</p>\n"}, {"tags": [], "owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "is_accepted": false, "score": 0, "last_activity_date": 1482391192, "creation_date": 1482391192, "answer_id": 41277696, "question_id": 32106704, "link": "https://stackoverflow.com/questions/32106704/problems-installing-nokogiri-v-1-6-1-and-libxml2/41277696#41277696", "title": "Problems installing Nokogiri -v 1.6.1 and libxml2", "body": "<p>You need to install Package first </p>\n\n<pre><code>xcode-select --install\n</code></pre>\n\n<p>then </p>\n\n<pre><code>gem install nokogiri\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 5245267, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d5486faa4da81fa66e949eda96f434f1?s=128&d=identicon&r=PG&f=1", "display_name": "johnwj", "link": "https://stackoverflow.com/users/5245267/johnwj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 440, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1482391192, "creation_date": 1440023412, "last_edit_date": 1440102097, "question_id": 32106704, "link": "https://stackoverflow.com/questions/32106704/problems-installing-nokogiri-v-1-6-1-and-libxml2", "title": "Problems installing Nokogiri -v 1.6.1 and libxml2", "body": "<p>I'm running Mac OSX \"Yosemite\", and I've been trying to install Nokogiri 1.6.1, but I keep running into the error below. </p>\n\n<p>This is the error I ran into when I was trying to install Nokogiri 1.6.1:</p>\n\n<pre><code>sh-3.2# gem install nokogiri -v 1.6.1\nBuilding native extensions.  This could take a while...\nERROR:  Error installing nokogiri:\n    ERROR: Failed to build gem native extension.\n\n    /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby -r ./siteconf20150819-49747-fafnk9.rb extconf.rb\nExtracting libxml2-2.8.0.tar.gz into tmp/x86_64-apple-darwin14.4.0/ports/libxml2/2.8.0... OK\nRunning 'configure' for libxml2 2.8.0... OK\nRunning 'compile' for libxml2 2.8.0... OK\nRunning 'install' for libxml2 2.8.0... OK\nActivating libxml2 2.8.0 (from /Library/Ruby/Gems/2.0.0/gems/nokogiri-1.6.1/ports/x86_64-apple-darwin14.4.0/libxml2/2.8.0)...\nExtracting libxslt-1.1.26.tar.gz into tmp/x86_64-apple-darwin14.4.0/ports/libxslt/1.1.26... OK\nRunning 'configure' for libxslt 1.1.26... OK\nRunning 'compile' for libxslt 1.1.26... OK\nRunning 'install' for libxslt 1.1.26... OK\nActivating libxslt 1.1.26 (from /Library/Ruby/Gems/2.0.0/gems/nokogiri-1.6.1/ports/x86_64-apple-darwin14.4.0/libxslt/1.1.26)...\nchecking for libxml/parser.h... yes\nchecking for libxslt/xslt.h... yes\nchecking for libexslt/exslt.h... yes\nchecking for iconv_open() in iconv.h... no\nchecking for iconv_open() in -liconv... yes\nchecking for xmlParseDoc() in -lxml2... no\n-----\nlibxml2 is missing.  please visit http://nokogiri.org/tutorials/installing_nokogiri.html for help with installing dependencies.\n-----\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby\n    --with-zlib-dir\n    --without-zlib-dir\n    --with-zlib-include\n    --without-zlib-include=${zlib-dir}/include\n    --with-zlib-lib\n    --without-zlib-lib=${zlib-dir}/lib\n    --with-iconv-dir\n    --without-iconv-dir\n    --with-iconv-include\n    --without-iconv-include=${iconv-dir}/include\n    --with-iconv-lib\n    --without-iconv-lib=${iconv-dir}/lib\n    --with-xml2-dir\n    --without-xml2-dir\n    --with-xml2-include\n    --without-xml2-include=${xml2-dir}/include\n    --with-xml2-lib\n    --without-xml2-lib=${xml2-dir}/lib\n    --with-xslt-dir\n    --without-xslt-dir\n    --with-xslt-include\n    --without-xslt-include=${xslt-dir}/include\n    --with-xslt-lib\n    --without-xslt-lib=${xslt-dir}/lib\n    --with-libxslt-config\n    --without-libxslt-config\n    --with-pkg-config\n    --without-pkg-config\n    --with-libxml-2.0-config\n    --without-libxml-2.0-config\n    --with-libiconv-config\n    --without-libiconv-config\n    --with-iconvlib\n    --without-iconvlib\n    --with-xml2lib\n    --without-xml2lib\n\nextconf failed, exit code 1\n\nGem files will remain installed in /Library/Ruby/Gems/2.0.0/gems/nokogiri-1.6.1 for inspection.\nResults logged to /Library/Ruby/Gems/2.0.0/extensions/universal-darwin-14/2.0.0/nokogiri-1.6.1/gem_make.out\n</code></pre>\n\n<p>I tried everything on <a href=\"http://www.nokogiri.org/tutorials/installing_nokogiri.html\" rel=\"nofollow\">http://www.nokogiri.org/tutorials/installing_nokogiri.html</a>, but I have been unsuccessful. I tried to install libxml2 to install Nokogiri 1.6.1, but my terminal says:</p>\n\n<pre><code>Cowardly refusing to `sudo brew install` \n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1440024361, "creation_date": 1440024361, "answer_id": 32106846, "question_id": 32106647, "link": "https://stackoverflow.com/questions/32106647/how-to-query-multiple-databases-using-sequel/32106846#32106846", "title": "How to query multiple databases using Sequel", "body": "<p>You can do it a couple ways but I'd do it like this untested code:</p>\n\n<pre><code>%w[\n  sqlite://folder1/sub1/db1.db\n  sqlite://folder1/sub1/db2.db\n  sqlite://folder1/sub2/db1.db\n  sqlite://folder1/sub2/db2.db\n].map{ |dsn|\n  DB = Sequel.connect(dsn)\n  DB[:some_table].where('some' =&gt; 'value').all\n}\n</code></pre>\n\n<p>This iterates over the DSNs for each database, opens a connection and returns the result as an array of results.</p>\n\n<p>What those are is undefined since we have no idea what your table schemas are.</p>\n"}], "owner": {"reputation": 1072, "user_id": 2840647, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bbc7740efb4b280be4485f2f7c6c5742?s=128&d=identicon&r=PG&f=1", "display_name": "user2840647", "link": "https://stackoverflow.com/users/2840647/user2840647"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 32106846, "answer_count": 1, "score": 0, "last_activity_date": 1440024361, "creation_date": 1440023072, "last_edit_date": 1440023615, "question_id": 32106647, "link": "https://stackoverflow.com/questions/32106647/how-to-query-multiple-databases-using-sequel", "title": "How to query multiple databases using Sequel", "body": "<p>I have a project which contains multiple databases in a directory structure like this:</p>\n\n<pre><code>folder1\n|_ sub1\n  |_ db1\n  |_ db2\n|_ sub2\n  |_ db1\n  |_ d2\n</code></pre>\n\n<p>I would like to run one query against all the databases.  </p>\n\n<p>Is there a way to do this using Sequel, or would I need to traverse the directory and create a new database connection for each database, then run the query?</p>\n\n<p>Help appreciated.</p>\n"}, {"tags": ["ruby", "rspec", "rake", "testunit", "faker"], "comments": [{"owner": {"reputation": 2218, "user_id": 5129208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wfsc3HumFMQ/AAAAAAAAAAI/AAAAAAAAAGw/2TW94iOeLhQ/photo.jpg?sz=128", "display_name": "yez", "link": "https://stackoverflow.com/users/5129208/yez"}, "edited": false, "score": 0, "creation_date": 1440025703, "post_id": 32106597, "comment_id": 52108508, "body": "Did you add a require anywhere with your new filename? Seems that faker requires files here: <a href=\"https://github.com/stympy/faker/blob/master/lib/faker.rb#L160\" rel=\"nofollow noreferrer\">github.com/stympy/faker/blob/master/lib/faker.rb#L160</a>.  That might be a good place to add yours if you haven&#39;t."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "reply_to_user": {"reputation": 2218, "user_id": 5129208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wfsc3HumFMQ/AAAAAAAAAAI/AAAAAAAAAGw/2TW94iOeLhQ/photo.jpg?sz=128", "display_name": "yez", "link": "https://stackoverflow.com/users/5129208/yez"}, "edited": false, "score": 0, "creation_date": 1440025817, "post_id": 32106597, "comment_id": 52108534, "body": "Awesome, that is just what I needed, all my tests passed and I&#39;m ready for a pull request. Thank you!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "reply_to_user": {"reputation": 2218, "user_id": 5129208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wfsc3HumFMQ/AAAAAAAAAAI/AAAAAAAAAGw/2TW94iOeLhQ/photo.jpg?sz=128", "display_name": "yez", "link": "https://stackoverflow.com/users/5129208/yez"}, "edited": false, "score": 0, "creation_date": 1440027711, "post_id": 32106597, "comment_id": 52109030, "body": "If you would like to make this comment into an answer, I will accept."}], "answers": [{"tags": [], "owner": {"reputation": 2218, "user_id": 5129208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wfsc3HumFMQ/AAAAAAAAAAI/AAAAAAAAAGw/2TW94iOeLhQ/photo.jpg?sz=128", "display_name": "yez", "link": "https://stackoverflow.com/users/5129208/yez"}, "is_accepted": true, "score": 0, "last_activity_date": 1440092604, "creation_date": 1440092604, "answer_id": 32124882, "question_id": 32106597, "link": "https://stackoverflow.com/questions/32106597/nameerror-uninitialized-constant-when-trying-to-run-test-file/32124882#32124882", "title": "NameError: uninitialized constant when trying to run test file", "body": "<p>You need to require your <code>Faker::Shakespear</code> file somewhere in the code. Faker seems to have most requires here <a href=\"http://github.com/stympy/faker/blob/master/lib/faker.rb#L160\" rel=\"nofollow\">http://github.com/stympy/faker/blob/master/lib/faker.rb#L160</a> , that might be a good place to start.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "accepted_answer_id": 32124882, "answer_count": 1, "score": 2, "last_activity_date": 1440092604, "creation_date": 1440022830, "question_id": 32106597, "link": "https://stackoverflow.com/questions/32106597/nameerror-uninitialized-constant-when-trying-to-run-test-file", "title": "NameError: uninitialized constant when trying to run test file", "body": "<p>So I have written a new class for the faker gem. I want to submit a pull requests but the tests which I have written will not run due to a sneaky error.</p>\n\n<p>I'm using Rubymine to run these tests becuse <code>rake test</code> does not work properly on my machine probably because <code>Windows</code> <code>&lt;insert verb of choice&gt;</code> (thanks bill gates). </p>\n\n<p>Anyways, I can run the existing test files just fine, all of which pass. I can't however, run my test. I'm pretty sure it will pass on the faker gem's build, but the right thing to do is test.</p>\n\n<p>So without further ado, here is my class:</p>\n\n<pre><code>module Faker\n  class Shakespeare &lt; Base\n    class &lt;&lt; self\n\n\n\n      def hamlet_quote\n        hamlet.sample\n      end\n\n      def as_you_like_it_quote\n        as_you_like_it.sample\n      end\n\n      def king_richard_iii_quote\n        king_richard_iii.sample\n      end\n\n      def romeo_and_juliet_quote\n        romeo_and_juliet.sample\n      end\n\n      def hamlet\n          [\"To be, or not to be: that is the question.\",\n           \"Neither a borrower nor a lender be; For loan oft loses both itself and friend, and borrowing dulls the edge of husbandry.\",\n           \"This above all: to thine own self be true.\",\n           \"Though this be madness, yet there is method in 't.\",\n           \"That it should come to this!.\",\n           \"There is nothing either good or bad, but thinking makes it so.\",\n           \"What a piece of work is man! how noble in reason! how infinite in faculty! in form and moving how express and admirable! in action how like an angel! in apprehension how like a god! the beauty of the world, the paragon of animals! .\",\n           \"The lady doth protest too much, methinks.\",\n           \"In my mind's eye.\",\n           \"A little more than kin, and less than kind.\",\n           \"The play 's the thing wherein I'll catch the conscience of the king.\",\n           \"And it must follow, as the night the day, thou canst not then be false to any man.\",\n           \"Brevity is the soul of wit.\",\n           \"Doubt that the sun doth move, doubt truth to be a liar, but never doubt I love.\",\n           \"Rich gifts wax poor when givers prove unkind.\",\n           \"Do you think I am easier to be played on than a pipe?\",\n           \"I will speak daggers to her, but use none.\",\n           \"When sorrows come, they come not single spies, but in battalions.\"]\n      end\n\n\n      def as_you_like_it\n          [\"All the world 's a stage, and all the men and women merely players. They have their exits and their entrances; And one man in his time plays many parts.\",\n           \"Can one desire too much of a good thing?.\",\n           \"I like this place and willingly could waste my time in it.\",\n           \"How bitter a thing it is to look into happiness through another man's eyes!\",\n           \"Blow, blow, thou winter wind! Thou art not so unkind as man's ingratitude.\",\n           \"True is it that we have seen better days.\",\n           \"For ever and a day.\",\n           \"The fool doth think he is wise, but the wise man knows himself to be a fool.\"]\n      end\n\n\n      def king_richard_iii\n          [\"Now is the winter of our discontent.\",\n           \"A horse! a horse! my kingdom for a horse!.\",\n           \"Conscience is but a word that cowards use, devised at first to keep the strong in awe.\",\n           \"So wise so young, they say, do never live long.\",\n           \"Off with his head!\",\n           \"An honest tale speeds best, being plainly told.\",\n           \"The king's name is a tower of strength.\",\n           \"The world is grown so bad, that wrens make prey where eagles dare not perch.\"]\n      end\n\n\n\n      def romeo_and_juliet\n          [\"O Romeo, Romeo! wherefore art thou Romeo?.\",\n           \"It is the east, and Juliet is the sun.\",\n           \"Good Night, Good night! Parting is such sweet sorrow, that I shall say good night till it be morrow.\",\n           \"What's in a name? That which we call a rose by any other name would smell as sweet.\",\n           \"Wisely and slow; they stumble that run fast.\",\n           \"Tempt not a desperate man.\",\n           \"For you and I are past our dancing days.\",\n           \"O! she doth teach the torches to burn bright.\",\n           \"It seems she hangs upon the cheek of night like a rich jewel in an Ethiope's ear.\",\n           \"See, how she leans her cheek upon her hand! O that I were a glove upon that hand, that I might touch that cheek!.\",\n           \"Not stepping o'er the bounds of modesty.\"]\n      end\n\n      end\n    end\n  end\n</code></pre>\n\n<p>Here is my test file:</p>\n\n<pre><code>require File.expand_path(File.dirname(__FILE__) + '/test_helper.rb')\n\nclass TestFakerShakespeare &lt; Test::Unit::TestCase      \n  def setup\n    @romeo_and_juliet = Faker::Shakespeare.romeo_and_juliet\n      @king_richard_iii = Faker::Shakespeare.king_richard_iii\n      @as_you_like_it = Faker::Shakespeare.as_you_like_it\n      @hamlet = Faker::Shakespeare.hamlet\n  end\n\n  def test_quotes\n    assert @romeo_and_juliet.size == 11    \n    @romeo_and_juliet.each do |quotes|\n       assert !quotes.nil?\n       assert quotes != \"\"\n    end    \n\n    assert @king_richard_iii.size == 8    \n    @king_richard_iii.each do |quotes|\n       assert !quotes.nil?\n       assert quotes != \"\"\n    end   \n\n    assert @as_you_like_it.size == 8   \n    @as_you_like_it.each do |quotes|\n       assert !quotes.nil?\n       assert quotes != \"\"\n    end   \n\n    assert @hamlet.size == 18    \n    @hamlet.each do |quotes|\n       assert !quotes.nil?\n       assert quotes != \"\"\n    end       \n  end  \n\n  def test_as_you_like_it_quote\n    assert Faker::Shakespeare.as_you_like_it_quote.match(/\\w+/)\n  end\n\n  def test_king_richard_iii_quote\n    assert Faker::Shakespeare.king_richard_iii_quote.match(/\\w+/)\n  end\n\n  def test_romeo_and_juliet_quote\n    assert Faker::Shakespeare.romeo_and_juliet_quote.match(/\\w+/)\n  end\n\n  def test_hamlet_quote\n    assert Faker::Shakespeare.hamlet_quote.match(/\\w+/)\n  end\n\nend\n</code></pre>\n\n<p>Here is my error:</p>\n\n<pre><code>NameError: uninitialized constant Faker::Shakespeare\nC:/workspace/faker/test/test_faker_shakespeare.rb:5:in `setup'\n    (eval):12:in `run'\n    C:/Program Files (x86)/JetBrains/RubyMine 7.1.3/rb/testing/patch/testunit/test/unit/ui/teamcity/testrunner.rb:93:in `start_mediator'\n    C:/Program Files (x86)/JetBrains/RubyMine 7.1.3/rb/testing/patch/testunit/test/unit/ui/teamcity/testrunner.rb:81:in `start'\n</code></pre>\n\n<p>And if you want to check out any more files in the repo that I was not the creator of, you can look at the repo <a href=\"https://github.com/stympy/faker\" rel=\"nofollow\">here</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "parsing", "rss", "feedzirra"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 3011985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3112ffefc6a65969336f882fa958?s=128&d=identicon&r=PG&f=1", "display_name": "Redology", "link": "https://stackoverflow.com/users/3011985/redology"}, "is_accepted": false, "score": 3, "last_activity_date": 1440023568, "creation_date": 1440023568, "answer_id": 32106727, "question_id": 32106588, "link": "https://stackoverflow.com/questions/32106588/how-to-get-custom-element-attributes-not-values-in-feedzirra/32106727#32106727", "title": "How to get custom element attributes not values in Feedzirra", "body": "<p>After really looking into the rss_entry.rb</p>\n\n<p><a href=\"https://github.com/feedjira/feedjira/blob/master/lib/feedjira/parser/rss_entry.rb\" rel=\"nofollow\">https://github.com/feedjira/feedjira/blob/master/lib/feedjira/parser/rss_entry.rb</a></p>\n\n<p>I figured out how I had it backwards by trying to follow the \"media:content\" example</p>\n\n<p>So here is the correct code.</p>\n\n<pre><code>Feedzirra::Feed.add_common_feed_entry_element('enc:enclosure', :as =&gt; :img, :value=&gt;:resource)\nfeed.entries.first.img\n</code></pre>\n\n<p>returns \"<a href=\"http://hello.jpg\" rel=\"nofollow\">http://hello.jpg</a>\"</p>\n\n<p>If I understand it right, the :as tells the parser what I want to call it.  And then sets the value of that to the attribute of interest, in this case resource.</p>\n\n<p>Hope this helps someone.</p>\n"}], "owner": {"reputation": 31, "user_id": 3011985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3112ffefc6a65969336f882fa958?s=128&d=identicon&r=PG&f=1", "display_name": "Redology", "link": "https://stackoverflow.com/users/3011985/redology"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440023568, "creation_date": 1440022784, "question_id": 32106588, "link": "https://stackoverflow.com/questions/32106588/how-to-get-custom-element-attributes-not-values-in-feedzirra", "title": "How to get custom element attributes not values in Feedzirra", "body": "<p>I have an RSS feed that looks like</p>\n\n<pre><code>&lt;item&gt;\n&lt;title&gt;Blah&lt;/title&gt;\n&lt;enc:enclosure resource=\"http://hello.jpg\" type=\"image/jpeg\"/&gt;\n&lt;/item&gt;\n</code></pre>\n\n<p>Using Feedzirra I am trying to retrieve the URL of the resource.</p>\n\n<p>I have tried </p>\n\n<pre><code>Feedzirra::Feed.add_common_feed_entry_element('enc:enclosure', :as =&gt; :img)\nfeed.entries.first.img\n</code></pre>\n\n<p>And that always returns Nil, which I think is because the element has no value.<br>\nI also tried</p>\n\n<pre><code> Feedzirra::Feed.add_common_feed_entry_element('enc:enclosure', :resource =&gt; :res, :as =&gt; :img)\n feed.entries.first.res\n</code></pre>\n\n<p>And img is nil and res returns undefined method.</p>\n\n<p>So how to I get the elements attribute value \"resource\"?</p>\n"}, {"tags": ["ruby", "sorting", "date"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1440024499, "post_id": 32106478, "comment_id": 52108214, "body": "Why don&#39;t you sort the results when you query the database so they&#39;re in the proper order after using <code>to_json</code>?"}, {"owner": {"reputation": 243, "user_id": 4639689, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IeGRx.jpg?s=128&g=1", "display_name": "premunk", "link": "https://stackoverflow.com/users/4639689/premunk"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1440024642, "post_id": 32106478, "comment_id": 52108253, "body": "Yes, I&#39;ve tried using the .where().order() but that returns it in ascending. Have a look at my edits."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1440025176, "post_id": 32106478, "comment_id": 52108374, "body": "It really sounds like you need to learn more about doing database queries. Retrieving data then sorting it is a waste of CPU. DBMs are MUCH more efficient. You don&#39;t say what ORM you&#39;re using but Active Record and Sequel are the big two for Ruby, and their documentation cover all this nicely. Also, it&#39;s not necessary to add &quot;Edit&quot; markers. We can see what you&#39;ve edited if we want to look at the edit history. Instead, add your changes into your question in a logical, readable, manner and we&#39;ll figure it out."}, {"owner": {"reputation": 243, "user_id": 4639689, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IeGRx.jpg?s=128&g=1", "display_name": "premunk", "link": "https://stackoverflow.com/users/4639689/premunk"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1440025910, "post_id": 32106478, "comment_id": 52108557, "body": "Ah, where do I start?"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1440062468, "post_id": 32107941, "comment_id": 52121522, "body": "Or <code>array.sort_by { |item| item[&#39;date&#39;]  }.reverse</code> or <code>array.min_by(array.size) { |item| item[&#39;date&#39;] }</code>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1440117862, "post_id": 32107941, "comment_id": 52152208, "body": "@CarySwoveland: I thought about using <code>reverse</code>; it uses more memory, but is more readable. <code>min_by</code> would only return the lowest value, rather than the descending list."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1440118592, "post_id": 32107941, "comment_id": 52152367, "body": "I included <a href=\"http://ruby-doc.org/core-2.2.0/Enumerable.html#method-i-min_by\" rel=\"nofollow noreferrer\">Enumerable#min_by</a> for fun. As you see, it takes an argument in v2.2. Same for <code>max_by</code>, <code>max</code> and <code>min</code>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1440118795, "post_id": 32107941, "comment_id": 52152425, "body": "@CarySwoveland: Huh, TIL."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 2, "last_activity_date": 1440036716, "last_edit_date": 1440036716, "creation_date": 1440032347, "answer_id": 32107941, "question_id": 32106478, "link": "https://stackoverflow.com/questions/32106478/sorting-a-json-array-of-hashes-in-descending-based-on-date/32107941#32107941", "title": "Sorting a JSON array of hashes in descending based on Date", "body": "<p>To answer the literal question, </p>\n\n<pre><code>array.sort_by { |item| -item['date'].to_time.to_i }\n</code></pre>\n\n<p>However, the points raised in comments are very valid - if you can sort it already in SQL, you should do so. (If you want to know about SQL, tag with DBMS. If you want to know about a specific ORM, tag with those instead.)</p>\n\n<p>EDIT: Thanks, Cary - Indeed, OP wanted the reverse sort.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5245595, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2BeMi.jpg?s=128&g=1", "display_name": "vivian93", "link": "https://stackoverflow.com/users/5245595/vivian93"}, "is_accepted": false, "score": 0, "last_activity_date": 1440037809, "creation_date": 1440037809, "answer_id": 32108632, "question_id": 32106478, "link": "https://stackoverflow.com/questions/32106478/sorting-a-json-array-of-hashes-in-descending-based-on-date/32108632#32108632", "title": "Sorting a JSON array of hashes in descending based on Date", "body": "<p>It seems that you need this: \n            .order(\"date DESC\").\nuse order after \"where\".\n the first param is your column name,and the second param \"DESC\" means descend,if you don't write the second param,ruby will do default ascend.\n(I hope you can understand me...I'm not good at English..)</p>\n"}], "owner": {"reputation": 243, "user_id": 4639689, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IeGRx.jpg?s=128&g=1", "display_name": "premunk", "link": "https://stackoverflow.com/users/4639689/premunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1440037809, "creation_date": 1440022257, "last_edit_date": 1440025511, "question_id": 32106478, "link": "https://stackoverflow.com/questions/32106478/sorting-a-json-array-of-hashes-in-descending-based-on-date", "title": "Sorting a JSON array of hashes in descending based on Date", "body": "<p>My model has a date attribute:</p>\n\n<pre><code>'date'              =&gt; { 'type' =&gt; 'date'    }\n</code></pre>\n\n<p>I am querying based on a <code>user_id</code> attribute and displaying the list of results, then I convert it into a JSON array to be returned in the route. </p>\n\n<pre><code>modelObj = Models::Persistence::ModelName.where(:user_id =&gt; user_id)\nreturn modelObj.to_json\n</code></pre>\n\n<p>This gives me an array of hashes, each hash having a date attribute. How can I sort the hashes based on the date? I tried doing a date sort by converting it to <code>to_i</code> but that doesn't work. How can I do a descending sort based on the Date object?</p>\n\n<p>I tried adding <code>.order(:date)</code> after <code>.where</code> so that I don't sort the JSON array. This gives me </p>\n\n<pre><code>NoMethodError: undefined method `__sort_option__' for :date:Symbol\n</code></pre>\n\n<p>What am I missing? <code>.order(date: :desc)</code> doesn't break but still returns the data in ascending order.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1440018009, "post_id": 32105563, "comment_id": 52105665, "body": "Do you mean <code>492-as</code> passes?"}, {"owner": {"reputation": 115, "user_id": 3859077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d3da0e660a50ab1281eaca9e9b4369d4?s=128&d=identicon&r=PG&f=1", "display_name": "Khin L", "link": "https://stackoverflow.com/users/3859077/khin-l"}, "reply_to_user": {"reputation": 658033, "user_id": 548225, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab08478b226280d4a30894c9a7ed719?s=128&d=identicon&r=PG", "display_name": "anubhava", "link": "https://stackoverflow.com/users/548225/anubhava"}, "edited": false, "score": 1, "creation_date": 1440018386, "post_id": 32105563, "comment_id": 52105840, "body": "@anubhava that was it. Can you answer it so I can accept? Thanks a lot!"}], "answers": [{"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 6, "last_activity_date": 1440018252, "creation_date": 1440018252, "answer_id": 32105637, "question_id": 32105563, "link": "https://stackoverflow.com/questions/32105563/how-to-write-a-ruby-regexp-for-a-z0-9-repeat-3-or-4-times-no-more/32105637#32105637", "title": "How to write a Ruby regexp for [A-Z0-9] repeat 3, or 4 times, no more?", "body": "<p>You need to use start and end of string anchors:</p>\n\n<pre><code>/\\A[A-Z0-9]{3,4}\\z/\n</code></pre>\n\n<p>See <a href=\"http://rubular.com/r/SSaMoWbPTz\">demo at Rubular</a></p>\n\n<p>The <code>\\A</code> forces the match at the beginning of a string, and <code>\\z</code> matches the end of string.</p>\n"}], "owner": {"reputation": 115, "user_id": 3859077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d3da0e660a50ab1281eaca9e9b4369d4?s=128&d=identicon&r=PG&f=1", "display_name": "Khin L", "link": "https://stackoverflow.com/users/3859077/khin-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 32105637, "answer_count": 1, "score": -1, "last_activity_date": 1440021138, "creation_date": 1440017908, "last_edit_date": 1440021138, "question_id": 32105563, "link": "https://stackoverflow.com/questions/32105563/how-to-write-a-ruby-regexp-for-a-z0-9-repeat-3-or-4-times-no-more", "title": "How to write a Ruby regexp for [A-Z0-9] repeat 3, or 4 times, no more?", "body": "<p>I want to detect <code>3P4</code>, <code>4SC3</code>, etc., but not <code>492-as</code>. I tried  <code>/[A-Z0-9]{3,4}/</code> but <code>492-as</code> is still passing.</p>\n\n<p>If anyone could help me with this regexp rule, I'd greatly appreciate it.</p>\n"}, {"tags": ["ruby", "form-data", "faye"], "answers": [{"tags": [], "owner": {"reputation": 556, "user_id": 1343810, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/634ab278467e8f28f1ac9f981b45e7d0?s=128&d=identicon&r=PG&f=1", "display_name": "droptheplot", "link": "https://stackoverflow.com/users/1343810/droptheplot"}, "is_accepted": true, "score": 0, "last_activity_date": 1440341102, "creation_date": 1440341102, "answer_id": 32167884, "question_id": 32105502, "link": "https://stackoverflow.com/questions/32105502/sending-files-with-faye/32167884#32167884", "title": "Sending files with Faye", "body": "<p>Made using FileReader.</p>\n\n<pre><code>var sendMessage = function(file) {\n  client.publish(channel, { file: file });\n}\n\nvar fr = new FileReader();\n\nfr.onload = function(event) {\n  sendMessage(event.target.result);\n};\n\nfr.readAsDataURL($('.file')[0].files[0]);\n</code></pre>\n"}], "owner": {"reputation": 556, "user_id": 1343810, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/634ab278467e8f28f1ac9f981b45e7d0?s=128&d=identicon&r=PG&f=1", "display_name": "droptheplot", "link": "https://stackoverflow.com/users/1343810/droptheplot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 32167884, "answer_count": 1, "score": 0, "last_activity_date": 1440341102, "creation_date": 1440017677, "question_id": 32105502, "link": "https://stackoverflow.com/questions/32105502/sending-files-with-faye", "title": "Sending files with Faye", "body": "<p>Is it possible to send files with Faye Ruby server? </p>\n\n<p>Looks like FormData works only by XHR because e.g.:</p>\n\n<pre><code>var fd = new FormData();\nfd.append('file', $('.file')[0].files[0]);\n\nclient.publish(channel, { file: fd });\n</code></pre>\n\n<p>returns an empty hash in my Ruby application.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 7767, "user_id": 1580424, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0fcc56e6bb5cdee4a4b1f8d1d72e7cec?s=128&d=identicon&r=PG", "display_name": "JTG", "link": "https://stackoverflow.com/users/1580424/jtg"}, "edited": false, "score": 3, "creation_date": 1440017982, "post_id": 32105415, "comment_id": 52105647, "body": "When you reach the end of the array, and your <code>index</code> variable is the last iterator in the array, what is <code>array[index+1]</code> going to be?"}, {"owner": {"reputation": 27, "user_id": 5237022, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153420822707152/picture?type=large", "display_name": "Nikos Papayiannakis", "link": "https://stackoverflow.com/users/5237022/nikos-papayiannakis"}, "reply_to_user": {"reputation": 7767, "user_id": 1580424, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0fcc56e6bb5cdee4a4b1f8d1d72e7cec?s=128&d=identicon&r=PG", "display_name": "JTG", "link": "https://stackoverflow.com/users/1580424/jtg"}, "edited": false, "score": 1, "creation_date": 1440030391, "post_id": 32105415, "comment_id": 52109675, "body": "I will be nil. Gotcha.  So the error message is saying at the end of the array it is trying to extract a length from nil, which is not going to happen. Putting a limit on the array iteration of array.length - 1 has it working.  Thanks!"}], "owner": {"reputation": 27, "user_id": 5237022, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153420822707152/picture?type=large", "display_name": "Nikos Papayiannakis", "link": "https://stackoverflow.com/users/5237022/nikos-papayiannakis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1440021263, "creation_date": 1440017318, "last_edit_date": 1440021263, "question_id": 32105415, "link": "https://stackoverflow.com/questions/32105415/debug-ruby-script-error-undefined-length-method-for-bubble-sort", "title": "Debug Ruby script error }undefined .length method&quot; for bubble sort", "body": "<p>I get the following error</p>\n\n<pre><code>bubble_sort.rb:38:in `block in &lt;main&gt;': undefined method `length' for nil:NilClass (NoMethodError)\n    from bubble_sort.rb:27:in `block (2 levels) in bubble_sort_by'\n    from bubble_sort.rb:25:in `each'\n    from bubble_sort.rb:25:in `each_with_index'\n    from bubble_sort.rb:25:in `block in bubble_sort_by'\n    from bubble_sort.rb:22:in `loop'\n    from bubble_sort.rb:22:in `bubble_sort_by'\n    from bubble_sort.rb:37:in `&lt;main&gt;'\n</code></pre>\n\n<p>when I run the following script</p>\n\n<pre><code>def bubble_sort_by(array)\n\n    loop do\n        swap_count = 0\n\n        array.each_index do |index| \n\n            if yield(array[index], array[index + 1]) &gt; 0\n                array[index], array[index + 1] = array[index + 1], array[index]\n                swap_count += 1 \n            end\n        end\n        break if swap_count == 0\n    end\n    array\nend\n\nbubble_sort_by([\"hi\",\"hello\",\"hey\"]) do |left,right|\n   left.length - right.length\n end\n</code></pre>\n\n<p>I compared this to another's code which is similar but using a <code>while</code> loop to iterate over the array indexes.  I spent two hours working on it and I don't understand why the interpreter won't recognize <code>array[index].length</code> in this script, while it recognizes the expression in IRB.</p>\n"}, {"tags": ["ruby", "methods", "dry"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 4, "creation_date": 1440019234, "post_id": 32105234, "comment_id": 52106219, "body": "Since you have working code, this question is not appropriate for SO, but is for <a href=\"http://codereview.stackexchange.com/\">Code Review</a>. There you will get both an analysis of your existing code and suggestions for improving it."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1440021057, "post_id": 32105234, "comment_id": 52107029, "body": "...but I couldn&#39;t resist."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1440021357, "post_id": 32105234, "comment_id": 52107148, "body": "I&#39;m voting to close this question as off-topic because it belongs on <a href=\"https://codereview.stackexchange.com\">Code Review</a>."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1440021391, "post_id": 32105501, "comment_id": 52107166, "body": "A slight simplification: <code>result = case roll; when pick; &quot;tie&quot;; when &quot;scissors&quot;...</code> (My first comment had erroneous code. Man, do I hate writing code in comments.)"}], "tags": [], "owner": {"reputation": 5130, "user_id": 1443478, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4J9cr.jpg?s=128&g=1", "display_name": "Brennan", "link": "https://stackoverflow.com/users/1443478/brennan"}, "is_accepted": false, "score": 1, "last_activity_date": 1440018069, "last_edit_date": 1440018069, "creation_date": 1440017676, "answer_id": 32105501, "question_id": 32105234, "link": "https://stackoverflow.com/questions/32105234/drying-up-rock-paper-scissors/32105501#32105501", "title": "DRYing up Rock Paper Scissors", "body": "<p>I think a proc or other similar setup is probably overkill. Just use inline-ifs:</p>\n\n<pre><code>def rps(roll)\n  raise \"Choose rock, paper, or scissors\" if roll.nil?\n  roll_ops = [\"rock\", \"paper\", \"scissors\"]\n  pick = roll_ops.sample\n  result = if roll == pick\n    \"tie\"\n  else\n    case roll\n    when \"scissors\"\n      pick == \"paper\" ? 'win' : 'lose'\n    when \"rock\"\n      pick == \"scissors\" ? 'win' : 'lose'\n    when \"paper\" then\n      pick == \"rock\" ? 'win' : 'lose'\n    end\n  end\n  puts \"#{pick}, #{result}\"\nend\n\nrps(\"scissors\")\n</code></pre>\n\n<p>I removed your extra else that was supposed to handle non-input. Better to use errors in such a case.</p>\n\n<p>There are a couple tricks here:</p>\n\n<p>1- The inline-ifs. Those should be pretty clear.</p>\n\n<p>2- The result variable is set equal to the return value of the if expression. This is a handy trick that you can use because in Ruby, everything is an expression!</p>\n\n<p>If you are interested in using a lambda for this, it should work pretty well too:</p>\n\n<pre><code>def rps(roll)\n  raise \"Choose rock, paper, or scissors\" if roll.nil?\n  roll_ops = [\"rock\", \"paper\", \"scissors\"]\n  pick = roll_ops.sample\n  did_win = lambda do |choice|\n    return choice == pick ? 'win' : 'lose'\n  end\n  result = if roll == pick\n    \"tie\"\n  else\n    case roll\n    when \"scissors\"\n      did_win.call('paper')\n    when \"rock\"\n      did_win.call('scissors')\n    when \"paper\" then\n      did_win.call('rock')\n    end\n  end\n  puts \"#{pick}, #{result}\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14364, "user_id": 1023609, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14cd00b085c207261db49ac46be4773c?s=128&d=identicon&r=PG", "display_name": "MurifoX", "link": "https://stackoverflow.com/users/1023609/murifox"}, "is_accepted": false, "score": 4, "last_activity_date": 1440017746, "creation_date": 1440017746, "answer_id": 32105519, "question_id": 32105234, "link": "https://stackoverflow.com/questions/32105234/drying-up-rock-paper-scissors/32105519#32105519", "title": "DRYing up Rock Paper Scissors", "body": "<p>You can build a hash that contains the pick and which option lose against that pick:  </p>\n\n<pre><code>hash = {'scissors' =&gt; 'paper', 'rock' =&gt; 'scissors', 'paper' =&gt; 'rock'}\n</code></pre>\n\n<p>Then you check if the machine pick is the same like you did:  </p>\n\n<pre><code>roll_ops = [\"rock\", \"paper\", \"scissors\"]\npick = roll_ops.sample\nif roll == pick\n</code></pre>\n\n<p>And the win/lose condition becomes something like this:  </p>\n\n<pre><code>if hash[roll] == pick\n  \"win\"\nelse\n  \"lose\"\nend\n</code></pre>\n\n<p>Nice and clean with just 2 conditions.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1440100165, "post_id": 32105547, "comment_id": 52145533, "body": "Readers unfamilar with <a href=\"http://ruby-doc.org/core-2.2.0/Object.html#method-i-freeze\" rel=\"nofollow noreferrer\">Object#freeze</a>: <a href=\"http://tmm1.net/ruby21-fstrings/\" rel=\"nofollow noreferrer\">this</a> explains why sawa used it here."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1440018189, "last_edit_date": 1440018189, "creation_date": 1440017847, "answer_id": 32105547, "question_id": 32105234, "link": "https://stackoverflow.com/questions/32105234/drying-up-rock-paper-scissors/32105547#32105547", "title": "DRYing up Rock Paper Scissors", "body": "<pre><code>ROLL_OPS = %w[rock paper scissors]\nRESULTS = %w[tie lose win]\ndef rps(roll)\n  unless i = ROLL_OPS.index(roll)\n    return puts \"Please input rock paper or scissors\".freeze\n  end\n  pick = ROLL_OPS.sample\n  puts \"#{pick}, #{RESULTS[(i - ROLL_OPS.index(pick)) % 3]}\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1440024653, "last_edit_date": 1440024653, "creation_date": 1440020889, "answer_id": 32106207, "question_id": 32105234, "link": "https://stackoverflow.com/questions/32105234/drying-up-rock-paper-scissors/32106207#32106207", "title": "DRYing up Rock Paper Scissors", "body": "<p>Here are a couple of ways:</p>\n\n<p><strong>#1 Use <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-cycle\" rel=\"nofollow\">Array#cycle</a></strong></p>\n\n<pre><code>OPS = %w[rock paper scissors]\n\ndef rps(roll)\n  pick = OPS.sample\n  enum = OPS.cycle\n  (prev = enum.next) until enum.peek == roll\n  return [pick, \"lose\"] if prev == pick\n  enum.next\n  return [pick, \"win\"] if enum.peek == pick\n  [pick, \"tie\"]\nend\n\nrps \"scissors\" #=&gt; [\"scissors\", \"tie\"] \nrps \"scissors\" #=&gt; [\"scissors\", \"tie\"] \nrps \"scissors\" #=&gt; [\"rock\", \"win\"] \nrps \"scissors\" #=&gt; [\"paper\", \"lose\"] \n</code></pre>\n\n<p><strong>#2 Take @MurifoX's answer one step farther</strong></p>\n\n<pre><code>def rps(roll)\n  roll_ops = %w|rock paper scissors|\n  h = (roll_ops + [roll_ops.first]).each_cons(2).\n    with_object(Hash.new(\"tie\")) { |(a,b),h| h[[a,b]]=\"lose\"; h[[b,a]]=\"win\" }\n  pick = roll_ops.sample\n  [pick, h[[roll,pick]]]\nend\n\nrps \"scissors\" #=&gt; [\"rock\", \"lose\"] \nrps \"scissors\" #=&gt; [\"scissors\", \"tie\"] \nrps \"scissors\" #=&gt; [\"paper\", \"win\"] \n</code></pre>\n\n<p>Here:</p>\n\n<pre><code>h #=&gt; {[\"rock\", \"paper\"]=&gt;\"lose\", [\"paper\", \"rock\"]=&gt;\"win\",\n  #    [\"paper\", \"scissors\"]=&gt;\"lose\", [\"scissors\", \"paper\"]=&gt;\"win\",\n  #    [\"scissors\", \"rock\"]=&gt;\"lose\", [\"rock\", \"scissors\"]=&gt;\"win\"} \n</code></pre>\n\n<p>and because of the default value \"tie\":</p>\n\n<pre><code>h[[\"rock\", \"rock\"]]         #=&gt; \"tie\"\nh[[\"paper\", \"paper\"]]       #=&gt; \"tie\"\nh[[\"scissors\", \"scissors\"]] #=&gt; \"tie\"\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 4911390, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a17f7b28c6f454be83d2e503c54512c9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4911390/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1440024653, "creation_date": 1440016681, "last_edit_date": 1440019411, "question_id": 32105234, "link": "https://stackoverflow.com/questions/32105234/drying-up-rock-paper-scissors", "title": "DRYing up Rock Paper Scissors", "body": "<p>I'm a novice ruby programmer and although this code works, I'm wondering how I can improve it. I have very limited knowledge on lambdas and procs and the like, but any advice would be great. Is there any way to simplify the <code>if else</code> statements in each case? Also, is there any alternative way to the <code>case</code> statement skipped instead of making almost the entirety of the code one big if else statement? </p>\n\n<pre><code>def rps(roll)\n    roll_ops = [\"rock\", \"paper\", \"scissors\"]\n    pick = roll_ops.sample\n    result = nil\n    if roll == pick\n        result = \"tie\"\n    else\n    case roll\n    when \"scissors\" then\n        if pick == \"paper\"\n            result = \"win\"\n        else\n            result = \"lose\"\n        end\n    when \"rock\" then\n        if pick == \"scissors\"\n            result = \"win\"\n        else\n            result = \"lose\"\n        end\n    when \"paper\" then\n        if pick == \"rock\"\n            result = \"win\"\n        else\n            result = \"lose\"\n        end\n    else\n        puts \"Please input rock paper or scissors\"\n    end\n    end\n\n    puts \"#{pick}, #{result}\"\nend\n\nrps(\"scissors\")\n</code></pre>\n"}, {"tags": ["java", "ruby", "rabbitmq", "protocol-buffers"], "answers": [{"comments": [{"owner": {"reputation": 1203, "user_id": 535339, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ff97dd288f72e9671524a9837e9564bb?s=128&d=identicon&r=PG", "display_name": "crobicha", "link": "https://stackoverflow.com/users/535339/crobicha"}, "edited": false, "score": 0, "creation_date": 1440091975, "post_id": 32111555, "comment_id": 52141066, "body": "Thanks! This worked with a small change, I ended up using &quot;protoRequest = ProtoRequest.parseFrom( Base64.decode( new String( message.getBody() ) ) );&quot; on the java side, since message.getBody() was returning a byte array."}], "tags": [], "owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "is_accepted": true, "score": 1, "last_activity_date": 1440058318, "last_edit_date": 1440058318, "creation_date": 1440054090, "answer_id": 32111555, "question_id": 32105151, "link": "https://stackoverflow.com/questions/32105151/how-to-serialize-parse-protobuf-object-between-ruby-and-java/32111555#32111555", "title": "How to serialize / parse protobuf object between Ruby and Java?", "body": "<p>It is not clear how you are packaging the <code>protoNew.serialize_to_string</code> output such that it becomes content of JMS message for Java Code.  I guess something is getting messed due to char encoding.</p>\n\n<p>As a work around, you can do Base 64 encoding of the binary output of <code>protoNew.serialize_to_string</code>, and do Base 64 decoding at Java end.</p>\n\n<pre><code>require \"base64\"\n...\nreturn Base64.encode64 protoNew.serialize_to_string\n</code></pre>\n\n<p>On Java Side,</p>\n\n<pre><code>import org.apache.commons.codec.binary.Base64;\n...\nprotoRequest = ProtoRequest.parseFrom(Base64.decodeBase64(message.getBody()))\n</code></pre>\n\n<p>One thing bad about the above solution is that it will result in bigger payload size compared to pure binary form.</p>\n\n<p>PS: Please note that if I write output of <code>person.serialize_to_string</code> to a file in Ruby side, and read that file on Java, it seems to work fine</p>\n\n<pre><code>f = File.open(\"data.dat\", \"wb\")\nf &lt;&lt; person.serialize_to_string\nf.close\n</code></pre>\n"}], "owner": {"reputation": 1203, "user_id": 535339, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ff97dd288f72e9671524a9837e9564bb?s=128&d=identicon&r=PG", "display_name": "crobicha", "link": "https://stackoverflow.com/users/535339/crobicha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4714, "favorite_count": 2, "accepted_answer_id": 32111555, "answer_count": 1, "score": 5, "last_activity_date": 1440058318, "creation_date": 1440016389, "question_id": 32105151, "link": "https://stackoverflow.com/questions/32105151/how-to-serialize-parse-protobuf-object-between-ruby-and-java", "title": "How to serialize / parse protobuf object between Ruby and Java?", "body": "<p>What is the correct way to serialize a protobuf object in ruby and parse in Java? This is for automated testing, we are listening for this message on a Rabbit queue.</p>\n\n<p>Publisher (Ruby):</p>\n\n<pre><code>protoNew = Protobuf::Request.new\nprotoNew.request = request\nprotoNew.id = id.to_i\nprotoNew.authentication = authentication\n\nreturn protoNew.serialize_to_string\n</code></pre>\n\n<p>Consumer (Java):</p>\n\n<pre><code>    @Override\n    public void onMessage(Message message, Channel channel) \n    {\n        ProtoRequest protoRequest;\n        try {\n            protoRequest = ProtoRequest.parseFrom(message.getBody());\n        } catch (InvalidProtocolBufferException e1) {\n            logger.error(\"Error parsing protobuf\", e1);\n        } \n</code></pre>\n\n<p>Here is the error I am seeing:</p>\n\n<blockquote>\n  <p>Error parsing protobuf: com.google.protobuf.InvalidProtocolBufferException: Protocol message end-group tag did not match expected tag.\n          at com.google.protobuf.InvalidProtocolBufferException.invalidEndTag(InvalidProtocolBufferException.java:94) [protobuf-java-2.6.1.jar:]\n          at com.google.protobuf.CodedInputStream.checkLastTagWas(CodedInputStream.java:174) [protobuf-java-2.6.1.jar:]\n          at com.google.protobuf.AbstractParser.parsePartialFrom(AbstractParser.java:139) [protobuf-java-2.6.1.jar:]\n          at com.google.protobuf.AbstractParser.parseFrom(AbstractParser.java:168) [protobuf-java-2.6.1.jar:]\n          at com.google.protobuf.AbstractParser.parseFrom(AbstractParser.java:180) [protobuf-java-2.6.1.jar:]\n          at com.google.protobuf.AbstractParser.parseFrom(AbstractParser.java:185) [protobuf-java-2.6.1.jar:]\n          at com.google.protobuf.AbstractParser.parseFrom(AbstractParser.java:49) [protobuf-java-2.6.1.jar:]</p>\n</blockquote>\n"}, {"tags": ["ruby", "serialization", "yaml"], "comments": [{"owner": {"reputation": 50175, "user_id": 1307905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a38a4f5f180194ac457cdc057f1be6e3?s=128&d=identicon&r=PG", "display_name": "Anthon", "link": "https://stackoverflow.com/users/1307905/anthon"}, "edited": false, "score": 1, "creation_date": 1440016403, "post_id": 32104842, "comment_id": 52104813, "body": "How would you distinguish between maps that should be loaded normally, and ones that have to be read as Foo? Or all all maps from this file going to be loaded as Foo?"}, {"owner": {"reputation": 1052, "user_id": 5153223, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2eb1e2066f49fd770286205385ad6d1?s=128&d=identicon&r=PG&f=1", "display_name": "Borsunho", "link": "https://stackoverflow.com/users/5153223/borsunho"}, "reply_to_user": {"reputation": 50175, "user_id": 1307905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a38a4f5f180194ac457cdc057f1be6e3?s=128&d=identicon&r=PG", "display_name": "Anthon", "link": "https://stackoverflow.com/users/1307905/anthon"}, "edited": false, "score": 0, "creation_date": 1440016625, "post_id": 32104842, "comment_id": 52104923, "body": "@Anthon Top-level map (i.e. whole file) is supposed to be load as <code>Foo</code>. Any sub-maps as normal <code>Hash</code>es"}, {"owner": {"reputation": 50175, "user_id": 1307905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a38a4f5f180194ac457cdc057f1be6e3?s=128&d=identicon&r=PG", "display_name": "Anthon", "link": "https://stackoverflow.com/users/1307905/anthon"}, "edited": false, "score": 1, "creation_date": 1440087144, "post_id": 32104842, "comment_id": 52138604, "body": "Then you should just convert the top level hash to your <code>Foo</code> class after loading, by creating the keys of as attributes and the values as the attribute value."}, {"owner": {"reputation": 1052, "user_id": 5153223, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2eb1e2066f49fd770286205385ad6d1?s=128&d=identicon&r=PG&f=1", "display_name": "Borsunho", "link": "https://stackoverflow.com/users/5153223/borsunho"}, "reply_to_user": {"reputation": 50175, "user_id": 1307905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a38a4f5f180194ac457cdc057f1be6e3?s=128&d=identicon&r=PG", "display_name": "Anthon", "link": "https://stackoverflow.com/users/1307905/anthon"}, "edited": false, "score": 1, "creation_date": 1440087759, "post_id": 32104842, "comment_id": 52138945, "body": "@Anthon This level of implementation details exposure is exactly what I&#39;m trying to avoid."}, {"owner": {"reputation": 50175, "user_id": 1307905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a38a4f5f180194ac457cdc057f1be6e3?s=128&d=identicon&r=PG", "display_name": "Anthon", "link": "https://stackoverflow.com/users/1307905/anthon"}, "edited": false, "score": 1, "creation_date": 1440091931, "post_id": 32104842, "comment_id": 52141045, "body": "Psych is not going to guess itself what needs to be done, so some level of implementation detail has to be in your program. From my experience with YAML parsers (but not with Psych so it might be different), you don&#39;t have that level of control what a mapping is rendered as depending on its nesting depth, while it is parsing. So you have to do something afterward (as suggested), or before. The latter you could e.g do by inserting the <code>!ruby&#47;object:Foo</code> programmatically before you hand the whole thing to Psych."}, {"owner": {"reputation": 1052, "user_id": 5153223, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2eb1e2066f49fd770286205385ad6d1?s=128&d=identicon&r=PG&f=1", "display_name": "Borsunho", "link": "https://stackoverflow.com/users/5153223/borsunho"}, "reply_to_user": {"reputation": 50175, "user_id": 1307905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a38a4f5f180194ac457cdc057f1be6e3?s=128&d=identicon&r=PG", "display_name": "Anthon", "link": "https://stackoverflow.com/users/1307905/anthon"}, "edited": false, "score": 0, "creation_date": 1440092949, "post_id": 32104842, "comment_id": 52141629, "body": "@Anthon Psych has nice build-in way to allow custom yaml encoding for a class, that includes easy way to remove <code>!ruby&#47;object:Foo</code> tag, so I <i>suspect</i> that it has a way to properly read object when yaml lacks it, it just isn&#39;t easy to find it because of its poor doc. Right now I deal with it using <code>gsub</code>, but I&#39;m still digging."}, {"owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "edited": false, "score": 0, "creation_date": 1440404282, "post_id": 32104842, "comment_id": 52240590, "body": "Can you make your object&#39;s constructor so that it accepts a <code>hash</code>/<code>array</code> that is generated by <code>Psych</code>? So to say <code>MyObject.new(JSON.parse(my_file_name))</code> ? Undocumented things tend to change with gem updates, I&#39;d try to find an approach that gives me more control over what happens"}, {"owner": {"reputation": 1052, "user_id": 5153223, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2eb1e2066f49fd770286205385ad6d1?s=128&d=identicon&r=PG&f=1", "display_name": "Borsunho", "link": "https://stackoverflow.com/users/5153223/borsunho"}, "edited": false, "score": 0, "creation_date": 1440406470, "post_id": 32104842, "comment_id": 52241849, "body": "Currently I do just that."}], "answers": [{"tags": [], "owner": {"reputation": 6190, "user_id": 5029266, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7d4922cf09a8b3d3195cd4d848091ba3?s=128&d=identicon&r=PG", "display_name": "EugZol", "link": "https://stackoverflow.com/users/5029266/eugzol"}, "is_accepted": true, "score": 5, "last_activity_date": 1440484177, "last_edit_date": 1440484177, "creation_date": 1440451259, "answer_id": 32191928, "question_id": 32104842, "link": "https://stackoverflow.com/questions/32104842/force-psych-to-read-yaml-map-as-object-of-given-class/32191928#32191928", "title": "Force Psych to read YAML map as object of given class", "body": "<p>You can provide your own <code>Handler</code> to Psych:</p>\n\n<pre><code>class MyHandler &lt; Psych::Handlers::DocumentStream\n  def start_mapping(anchor, tag, implicit, style)\n    unless @__root\n      tag = \"!ruby/hash:MyHash\"\n      @__root = true\n    end\n    super anchor, tag, implicit, style\n  end\nend\n\nclass MyHash &lt; Hash\nend\n\ndef my_parse(yaml)\n  parser = Psych::Parser.new(MyHandler.new{|node| return node})\n  parser.parse yaml\n  false\nend\n\n# {a: 1, b: {c: 2, d: 3}, c: [1,2,3]}.to_yaml\nstr = \"---\\n:a: 1\\n:b:\\n  :c: 2\\n  :d: 3\\n:c:\\n- 1\\n- 2\\n- 3\\n\"\n\nresult = my_parse(str).to_ruby\nputs result.class # =&gt; MyHash\n</code></pre>\n\n<p>A bit of documentation. <code>my_parse</code> is just a re-implementation of Psych <a href=\"https://github.com/tenderlove/psych/blob/master/lib/psych.rb#L323\" rel=\"nofollow\">default parse method</a>. Instead of <a href=\"https://github.com/tenderlove/psych/blob/master/lib/psych.rb#L373\" rel=\"nofollow\">default handler</a> I use <code>MyHandler</code> here.</p>\n\n<p><code>MyHandler</code>'s <code>start_mapping</code> method overrides <code>TreeBuilder</code>'s <a href=\"https://github.com/tenderlove/psych/blob/master/lib/psych/tree_builder.rb#L27\" rel=\"nofollow\">default implementation</a>. This is a callback which is called when parser bumps into Map in YAML, and document root <em>is</em> a Map. So you just need to swap the tag for the root element (and don't bother with everything else \u2013 that's why I use <code>@__root</code> variable to skip further modifications).</p>\n"}], "owner": {"reputation": 1052, "user_id": 5153223, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2eb1e2066f49fd770286205385ad6d1?s=128&d=identicon&r=PG&f=1", "display_name": "Borsunho", "link": "https://stackoverflow.com/users/5153223/borsunho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 0, "accepted_answer_id": 32191928, "answer_count": 1, "score": 3, "last_activity_date": 1440484177, "creation_date": 1440015311, "question_id": 32104842, "link": "https://stackoverflow.com/questions/32104842/force-psych-to-read-yaml-map-as-object-of-given-class", "title": "Force Psych to read YAML map as object of given class", "body": "<p>I have a class <code>Foo</code> that is supposed to be serialized to a text file in most human-friendly way possible, I use Ruby's default YAML(Psych) with custom <code>encode_with</code>. My question is: if I remove <code>!ruby/object:Foo</code> like so:</p>\n\n<pre><code>def encode_with coder\n  coder.tag = nil\n  ...\nend\n</code></pre>\n\n<p>can I somehow still force Psych to load a map as object of class <code>Foo</code>(using its <code>init_with</code>). Ideally, I'd like to remove <code>---</code> document mark as well.</p>\n\n<p>Of course, this is easy to solve with <code>gsub</code>, but I wonder if there is some Psych solution for this. Unfortunately, Psych isn't the best documented of gems.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3.2", "haml"], "answers": [{"comments": [{"owner": {"reputation": 1305, "user_id": 623919, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c7d2113d86e7a9b16e8cac6956096bf0?s=128&d=identicon&r=PG", "display_name": "Axel Tetzlaff", "link": "https://stackoverflow.com/users/623919/axel-tetzlaff"}, "edited": false, "score": 1, "creation_date": 1440018871, "post_id": 32105299, "comment_id": 52106060, "body": "I think it&#39;s perfectly fine to do this heavily view related assignment in the view itself. The class key can also use an array as value. So one could also write <code>- adwords_class = [: links1] + params[:action] == &#39;adwords&#39; ? [:active] : []</code>"}], "tags": [], "owner": {"reputation": 18593, "user_id": 4304188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5695b0e5c30d4464163e3f3412fe5f1?s=128&d=identicon&r=PG", "display_name": "Mihai Dinculescu", "link": "https://stackoverflow.com/users/4304188/mihai-dinculescu"}, "is_accepted": false, "score": 0, "last_activity_date": 1440017293, "last_edit_date": 1440017293, "creation_date": 1440016953, "answer_id": 32105299, "question_id": 32104585, "link": "https://stackoverflow.com/questions/32104585/how-to-add-one-more-class-attributes-to-already-exiting-link-to-in-haml/32105299#32105299", "title": "How to add one more class attributes to already exiting link_to in HAML", "body": "<p>Why don't you just concatenate the two classes into a single one</p>\n\n<pre><code>= link_to 'AdWords Info', admin_settings_adwords_path, :class =&gt; (params[:action] == 'adwords' ? 'links1 active' : 'link1')\n</code></pre>\n\n<p>or, to have it a bit cleaner, do it in two steps</p>\n\n<pre><code>- adwords_class = (params[:action] == 'adwords' ? 'links1 active' : 'link1')\n= link_to 'AdWords Info', admin_settings_adwords_path, :class =&gt; adwords_class\n</code></pre>\n\n<p>Of course, purist will insist that you shouldn't do this in a view, and they are right.<br>\nYou should set <code>adwords_class</code> in the controller, as an instance variable.</p>\n"}], "owner": {"reputation": 9, "user_id": 5186736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307f2335659235f530887a3393486ec5?s=128&d=identicon&r=PG&f=1", "display_name": "VenkataYaparla", "link": "https://stackoverflow.com/users/5186736/venkatayaparla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440017293, "creation_date": 1440014409, "last_edit_date": 1440014622, "question_id": 32104585, "link": "https://stackoverflow.com/questions/32104585/how-to-add-one-more-class-attributes-to-already-exiting-link-to-in-haml", "title": "How to add one more class attributes to already exiting link_to in HAML", "body": "<pre><code>  = link_to 'AdWords Info', admin_settings_adwords_path, :class =&gt; ('active' if params[:action] == 'adwords')\n</code></pre>\n\n<p>class to add- :class => \u201clinks1\"</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "file", "temporary-files", "pry"], "comments": [{"owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "edited": false, "score": 1, "creation_date": 1440014549, "post_id": 32104526, "comment_id": 52103776, "body": "Have you changed the content of <code>epub</code> without saving the file?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1440023402, "post_id": 32104526, "comment_id": 52107881, "body": "What versions of Ruby and Pry are you using?"}, {"owner": {"reputation": 7688, "user_id": 929701, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/HZnD7.jpg?s=128&g=1", "display_name": "hrishikeshp19", "link": "https://stackoverflow.com/users/929701/hrishikeshp19"}, "reply_to_user": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "edited": false, "score": 0, "creation_date": 1440024078, "post_id": 32104526, "comment_id": 52108075, "body": "@SimoneCarletti: Seems to me thats the case. But I cannot figure out where exactly. So, I just did epub.close and epub.open and now I have files in sync. Thanks everyone for answers!"}], "answers": [{"comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1440015076, "post_id": 32104747, "comment_id": 52104059, "body": "Is it ? I thought the wording are different... but they are same."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 4, "last_activity_date": 1440015942, "last_edit_date": 1440015942, "creation_date": 1440014987, "answer_id": 32104747, "question_id": 32104526, "link": "https://stackoverflow.com/questions/32104526/ruby-tempfile-anomalous-behavior/32104747#32104747", "title": "Ruby tempfile anomalous behavior", "body": "<p>The devil is in the details. From the docs for <a href=\"http://ruby-doc.org/stdlib-2.2.1/libdoc/tempfile/rdoc/Tempfile.html#method-i-size\" rel=\"nofollow\"><code>Tempfile#size</code></a> (emphasis mine):</p>\n\n<blockquote>\n  <p><strong>size()</strong></p>\n  \n  <p>Returns the size of the temporary file. <em>As a side effect, the IO buffer is flushed before determining the size</em>.</p>\n</blockquote>\n\n<p>What's happening is that you're using <code>File.size</code> to read the size of the file before the buffer has been flushed\u2014i.e. before all of the bytes have been written to the file\u2014and then you're using <code>Tempfile#size</code>, which flushes that buffer before it calculates the size:</p>\n\n<pre><code>tmp = Tempfile.new('foo')\ntmp.write('a' * 1000)\nFile.size(tmp)\n# =&gt; 0\ntmp.size\n# =&gt; 1000\n</code></pre>\n\n<p>But see what happens when you call <code>tmp.size</code> <em>before</em> <code>File.size(tmp)</code>:</p>\n\n<pre><code>tmp = Tempfile.new('bar')\ntmp.write('a' * 1000)\ntmp.size\n# =&gt; 1000\nFile.size(tmp)\n# =&gt; 1000\n</code></pre>\n\n<p>You can get the behavior you want out of <code>File.size</code> by manually flushing the buffer:</p>\n\n<pre><code>tmp = Tempfile.new('baz')\ntmp.write('a' * 1000)\ntmp.flush\nFile.size(tmp)\n# =&gt; 1000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1440023213, "creation_date": 1440023213, "answer_id": 32106670, "question_id": 32104526, "link": "https://stackoverflow.com/questions/32104526/ruby-tempfile-anomalous-behavior/32106670#32106670", "title": "Ruby tempfile anomalous behavior", "body": "<p>I'm using Pry version 0.10.1 on Ruby 2.2.2 and can't duplicate that situation:</p>\n\n<pre><code>[1] (pry) main: 0&gt; foo = Tempfile.new('foo')\n#&lt;File:/var/folders/yb/whn8dwns6rl92jswry5cz87dsgk2n1/T/foo20150819-83612-1tpkqm4&gt;\n[2] (pry) main: 0&gt; File.size(foo.path)\n=&gt; 0\n[3] (pry) main: 0&gt; foo.size\n=&gt; 0\n</code></pre>\n\n<p>After initialization, the file size is 0 bytes.</p>\n\n<pre><code>[4] (pry) main: 0&gt; foo.write('a')\n=&gt; 1\n[5] (pry) main: 0&gt; File.size(foo.path)\n=&gt; 0\n</code></pre>\n\n<p>After writing one character to <code>foo</code>, the data has been buffered and not flushed to disk as I'd expect.</p>\n\n<pre><code>[6] (pry) main: 0&gt; foo.size\n=&gt; 1\n[7] (pry) main: 0&gt; File.size(foo.path)\n=&gt; 1\n</code></pre>\n\n<p><code>foo.size</code> flushes the buffer then returns the size of the file, which matches what <code>File.size</code> says it is.</p>\n\n<p>When dealing with temporary files created by Tempfile, we don't care or want to know what their size is. They're temporary and will disappear (eventually) and are treated like buffers. If you need a file that is more permanent, then create and write to a normal file.</p>\n"}], "owner": {"reputation": 7688, "user_id": 929701, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/HZnD7.jpg?s=128&g=1", "display_name": "hrishikeshp19", "link": "https://stackoverflow.com/users/929701/hrishikeshp19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1440023213, "creation_date": 1440014185, "last_edit_date": 1440021529, "question_id": 32104526, "link": "https://stackoverflow.com/questions/32104526/ruby-tempfile-anomalous-behavior", "title": "Ruby tempfile anomalous behavior", "body": "<p>This is my pry session output:</p>\n\n<pre><code>[1] pry(SomeTask)&gt; epub\n=&gt; #&lt;File:/somepath/tmp/x.epub&gt;\n[2] pry(SomeTask)&gt; epub.size\n=&gt; 134\n[3] pry(SomeTask)&gt; File.size(\"/somepath/tmp/x.epub\")\n=&gt; 44299\n[4] pry(SomeTask)&gt; epub.class\n=&gt; Tempfile\n</code></pre>\n\n<p>I see that <code>File.size</code> yields a different result than the <code>size</code> method of the Tempfile instance.</p>\n\n<p>How is this possible?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "edited": false, "score": 0, "creation_date": 1440014429, "post_id": 32104288, "comment_id": 52103719, "body": "What is the definition for <code>get_priority</code>?"}, {"owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "reply_to_user": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "edited": false, "score": 0, "creation_date": 1440036535, "post_id": 32104288, "comment_id": 52111047, "body": "Say that model &quot;n&quot; belongs_to model &quot;m&quot; and &quot;m&quot; has_many &quot;n.&quot;  Then, get_priority is the number of n that belong to an instance of m."}], "answers": [{"comments": [{"owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "edited": false, "score": 0, "creation_date": 1440014366, "post_id": 32104438, "comment_id": 52103668, "body": "Thanks Simone. What you stated was pretty much what I suspected, but I wanted someone who knew more to confirm it. Now I basically have to decide if I want speed, or to add code to measure this priority state (as you guessed, it involves calculations with other entities in the database)."}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": true, "score": 3, "last_activity_date": 1440013877, "creation_date": 1440013877, "answer_id": 32104438, "question_id": 32104288, "link": "https://stackoverflow.com/questions/32104288/rails-ordering-of-collections-by-proc/32104438#32104438", "title": "Rails ordering of collections by proc", "body": "<p><code>sort_by</code> is implemented at Ruby level and it's part of Ruby, not ActiveRecord. Therefore, the sorting will not be executed by the database, rather by the Ruby interpreter.</p>\n\n<p>This is not an optimal solution as DBMS are generally more efficient at sorting data as they may use existing indexes.</p>\n\n<p>If <code>get_priority</code> performs some sort of computation outside the database, then you don't have a lot of alternatives to the code you posted here unless you want to cache the result of the <code>get_priority</code> as a column in the <code>Model</code> table and sort against it using the ActiveRecord <code>order</code> statement that will result in an <code>ORDER BY</code> SQL statement.</p>\n"}], "owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 1, "accepted_answer_id": 32104438, "answer_count": 1, "score": 2, "last_activity_date": 1440013898, "creation_date": 1440013339, "last_edit_date": 1440013898, "question_id": 32104288, "link": "https://stackoverflow.com/questions/32104288/rails-ordering-of-collections-by-proc", "title": "Rails ordering of collections by proc", "body": "<p>I want to sort a collection using a custom proc. I know Rails has the order method, but I don't believe this works with procs, so I'm just using sort_by instead. Can someone go into detail about the speed I'm sacrificing, or suggest alternatives? My understanding is that the exact implementation of order will depend on the adapter (which, in my case, is mysql), but I'm wondering if there are ways to take advantage of this to speed the sort up.</p>\n\n<p>As an example, I want to do this:</p>\n\n<pre><code>Model.order(|m| m.get_priority )\n</code></pre>\n\n<p>but am forced to do this</p>\n\n<pre><code>Model.all.sort_by{|m| m.get_priority}\n</code></pre>\n"}, {"tags": ["ruby", "git", "openshift", "windows-10", "cloning"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5244537, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NsssdLDU-nM/AAAAAAAAAAI/AAAAAAAAAIg/cchXyxh6DMo/photo.jpg?sz=128", "display_name": "DemSec", "link": "https://stackoverflow.com/users/5244537/demsec"}, "edited": false, "score": 0, "creation_date": 1440017898, "post_id": 32105359, "comment_id": 52105598, "body": "I changed the directory of git install path from &quot;C:\\Program Files\\Git&quot; to &quot;Z:\\Nauro\\Programs\\Git&quot;. Does this make a difference? (Here&#39;s temp link: <a href=\"https://www.dropbox.com/s/kry25xqgi643m6h/Screenshot%202015-08-19%2010.36.13.png?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/kry25xqgi643m6h/&hellip;</a>)"}, {"owner": {"reputation": 25, "user_id": 5244537, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NsssdLDU-nM/AAAAAAAAAAI/AAAAAAAAAIg/cchXyxh6DMo/photo.jpg?sz=128", "display_name": "DemSec", "link": "https://stackoverflow.com/users/5244537/demsec"}, "edited": false, "score": 1, "creation_date": 1440019490, "post_id": 32105359, "comment_id": 52106361, "body": "Aha! Yes, keeping the default path lets phc to find git. It has been cloned automatically now. Thank You!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2879327"}, "is_accepted": true, "score": 0, "last_activity_date": 1440017168, "creation_date": 1440017168, "answer_id": 32105359, "question_id": 32104144, "link": "https://stackoverflow.com/questions/32104144/openshift-git-v2-5-0-not-found-cant-clone-app-git-repo/32105359#32105359", "title": "OpenShift - Git v2.5.0 not found - can&#39;t clone app git repo", "body": "<p>The rhc command looks for git to be installed in these locations (along with being in your path first)</p>\n\n<pre><code>if RHC::Helpers.windows?\n          guessing_locations &lt;&lt; \n            discover_windows_executables do |base|\n              [ \n                \"git.exe\",\n                \"#{base}\\\\Git\\\\bin\\\\git.exe\", \n                \"#{base}\\\\git.exe\", \n              ]\n            end\n        end\n</code></pre>\n\n<p><a href=\"https://github.com/openshift/rhc/blob/master/lib/rhc/git_helpers.rb#L24-L33\" rel=\"nofollow\">https://github.com/openshift/rhc/blob/master/lib/rhc/git_helpers.rb#L24-L33</a></p>\n\n<p>You should check what directory &amp; name your git is installed with (I see you used Git in your question...) And make sure that it is either on your path (maybe close &amp; reopen your terminal window) or that it is in one of those standard locations in the code</p>\n"}], "owner": {"reputation": 25, "user_id": 5244537, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NsssdLDU-nM/AAAAAAAAAAI/AAAAAAAAAIg/cchXyxh6DMo/photo.jpg?sz=128", "display_name": "DemSec", "link": "https://stackoverflow.com/users/5244537/demsec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 32105359, "answer_count": 1, "score": 1, "last_activity_date": 1440020156, "creation_date": 1440012804, "last_edit_date": 1440020156, "question_id": 32104144, "link": "https://stackoverflow.com/questions/32104144/openshift-git-v2-5-0-not-found-cant-clone-app-git-repo", "title": "OpenShift - Git v2.5.0 not found - can&#39;t clone app git repo", "body": "<p>So, the first official version of Git (v2.5.0) came out, and as my first OpenShift project, where I followed the <a href=\"https://developers.openshift.com/en/getting-started-windows.html\" rel=\"nofollow\">official tutorial</a>, and used Ruby v2.1.6p336, I came across the problem of ruby phc not finding any Git installed to clone the app repo.</p>\n\n<p>Here's the cmd log:</p>\n\n<pre><code>Microsoft Windows [Version 10.0.10240]\n(c) 2015 Microsoft Corporation. All rights reserved.\n\nC:\\Users\\Nauro&gt;Ruby --version\nruby 2.1.6p336 (2015-04-13 revision 50298) [x64-mingw32]\n\nC:\\Users\\Nauro&gt;Git --version\ngit version 2.5.0.windows.1\n\nC:\\Users\\Nauro&gt;rhc --version\nDL is deprecated, please use Fiddle\nrhc 1.36.4\n\n\nC:\\Users\\Nauro&gt;rhc app create python-2.7 -a test\nDL is deprecated, please use Fiddle\nApplication Options\n-------------------\nDomain:     lab001\nCartridges: python-2.7\nGear Size:  default\nScaling:    no\n\nCreating application 'test' ... done\n\n\nWaiting for your DNS name to be available ... done\n\nYou do not have git installed, so your application's git repo will not be cloned\n\nYour application 'test' is now available.\n\n  URL:        http://test-lab001.rhcloud.com/\n  SSH to:     55d4d6952d5271bce7000051@test-lab001.rhcloud.com\n  Git remote: ssh://55d4d6952d5271bce7000051@test-lab001.rhcloud.com/~/git/test.git/\n\nRun 'rhc show-app test' for more details about your app.\n\nC:\\Users\\Nauro&gt;\n</code></pre>\n\n<p>I don't think I want to use the Pre-Releases and want to make it work with this new version (although, it might work), because Git doesn't give me to choose an older version anyway (unlike Ruby).</p>\n\n<p>Also, I should mention that there are 2 extra steps in the official version of Git installation process, not mentioned in the tutorial, because the didn't exist in the Pre-Releases. One allows you to choose between \"Using MinTTY\" and \"Use Windows' default console window\" in which I tried both options, and the other is \"Enable file system caching\", which I never checked.</p>\n\n<p>The setup:</p>\n\n<ul>\n<li>Windows 10.0.10240</li>\n<li>Ruby v2.1.6p336</li>\n<li>Git v2.5.0 (first official release)</li>\n<li>phc v1.36.4</li>\n</ul>\n\n<p>P.S.: I just started learning Ruby, Git, and OpenShift hosting with a simple <a href=\"https://www.youtube.com/watch?v=kLxBsN1CeW8\" rel=\"nofollow\">Hello World tutorial</a>, and got stuck, so I know nothing much beyond that.</p>\n\n<p>Answered:\nBy keeping the install path on default and choosing \"Use Windows' default console window\", the app repo automaticaly cloned successfully. </p>\n"}, {"tags": ["ruby", "user-interface", "checkbox", "menu", "sketchup"], "answers": [{"tags": [], "owner": {"reputation": 276, "user_id": 3484707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mG7Wn.jpg?s=128&g=1", "display_name": "Ruts", "link": "https://stackoverflow.com/users/3484707/ruts"}, "is_accepted": false, "score": 0, "last_activity_date": 1440079257, "creation_date": 1440079257, "answer_id": 32120351, "question_id": 32104106, "link": "https://stackoverflow.com/questions/32104106/sketchup-api-how-to-add-a-check-box-to-a-menu-item/32120351#32120351", "title": "SketchUp API: How to add a check box to a menu item", "body": "<p>I have not seen a checkbox menu item created from an extensions before, but I'm a beginning user so that's maybe why.</p>\n\n<p>An other approach would be to do it like this:</p>\n\n<pre><code>unless file_loaded?(__FILE__)\n    plugin_menu = UI.menu(\"Plugin\")\n    option_menu = plugin_menu.add_submenu(\"NameOfOption\")\n    option_menu.add_item(\"OptionA\"){ }\n    option_menu.add_item(\"OptionB\"){ }\n    file_loaded(__FILE__)\nend\n</code></pre>\n\n<p>The file_loaded?(_ <em>FILE</em> _) makes sure the menu only is created once, instead of every time you load your script. I hope this is helpfull. Maybe some experts now a way to create a checkbox menu.</p>\n"}, {"comments": [{"owner": {"reputation": 1254, "user_id": 5179394, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lg1MR.png?s=128&g=1", "display_name": "ClydeTheGhost", "link": "https://stackoverflow.com/users/5179394/clydetheghost"}, "edited": false, "score": 0, "creation_date": 1440387809, "post_id": 32154971, "comment_id": 52234505, "body": "Thanks, this is exactly what I was looking for!"}], "tags": [], "owner": {"reputation": 166, "user_id": 816093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cbb2ac552f386093675dc47733e205c?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/816093/jim"}, "is_accepted": true, "score": 1, "last_activity_date": 1440238834, "creation_date": 1440238834, "answer_id": 32154971, "question_id": 32104106, "link": "https://stackoverflow.com/questions/32104106/sketchup-api-how-to-add-a-check-box-to-a-menu-item/32154971#32154971", "title": "SketchUp API: How to add a check box to a menu item", "body": "<p>SketchUp can have check marks in menu items. Both menu items and commands can have a validation proc. The documentation for <code>set_validation_proc</code> gives this example:</p>\n\n<pre><code>plugins_menu = UI.menu(\"Plugins\")\nitem = plugins_menu.add_item(\"Test\") { UI.messagebox \"My Test Item\"}\nstatus = plugins_menu.set_validation_proc(item)  {\n  if Sketchup.is_pro?\n   MF_ENABLED\n  else\n   MF_GRAYED\n  end\n}\n</code></pre>\n\n<p>Although for checkmarks you would use the constants <code>MF_CHECKED</code> and <code>MF_UNCHECKED</code> </p>\n\n<p><a href=\"http://www.sketchup.com/intl/en/developer/docs/ourdoc/menu#set_validation_proc\" rel=\"nofollow\">http://www.sketchup.com/intl/en/developer/docs/ourdoc/menu#set_validation_proc</a></p>\n\n<p><a href=\"http://www.sketchup.com/intl/en/developer/docs/ourdoc/command#set_validation_proc\" rel=\"nofollow\">http://www.sketchup.com/intl/en/developer/docs/ourdoc/command#set_validation_proc</a></p>\n"}], "owner": {"reputation": 1254, "user_id": 5179394, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lg1MR.png?s=128&g=1", "display_name": "ClydeTheGhost", "link": "https://stackoverflow.com/users/5179394/clydetheghost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 32154971, "answer_count": 2, "score": 0, "last_activity_date": 1490538673, "creation_date": 1440012686, "question_id": 32104106, "link": "https://stackoverflow.com/questions/32104106/sketchup-api-how-to-add-a-check-box-to-a-menu-item", "title": "SketchUp API: How to add a check box to a menu item", "body": "<p>I don't see it anywhere in the Ruby API documentation but just in case I'm missing something...</p>\n\n<p>I'm writing a plugin for SketchUp and I'm trying to add some options to the menu bar. One of my options would work best as a checkbox, but right now I have to have two separate buttons. Is there a way to create a checkbox menu item with the Ruby API?</p>\n\n<p>Here's what I had to do instead:</p>\n\n<pre><code>foo = true\nUI.menu(\"Plugins\").add_item(\"Turn foo_option on\") { @foo = true }\nUI.menu(\"Plugins\").add_item(\"Turn foo_option off\") { @foo = false }\n</code></pre>\n\n<p>...and then I just use foo to change the options. Is there a cleaner way to do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "heroku-postgres"], "comments": [{"owner": {"reputation": 357, "user_id": 3446742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9aa067bf1a218645e6bd515c44339e9a?s=128&d=identicon&r=PG", "display_name": "tangrufus", "link": "https://stackoverflow.com/users/3446742/tangrufus"}, "edited": false, "score": 0, "creation_date": 1440027842, "post_id": 32103661, "comment_id": 52109068, "body": "Is the last tmapp1 build success?"}, {"owner": {"reputation": 416, "user_id": 1031478, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8ebfd80989779e7e09777bc01ab21062?s=128&d=identicon&r=PG", "display_name": "ronan_mac", "link": "https://stackoverflow.com/users/1031478/ronan-mac"}, "edited": false, "score": 0, "creation_date": 1440054135, "post_id": 32103661, "comment_id": 52116441, "body": "I had the same error message on a build at about the same time as you reported this, although it was precipated by a <code>rake db:migrate</code> and not through the CLI. I just ran it today and it&#39;s working again, so I presume the issue was on the Heroku side."}], "answers": [{"comments": [{"owner": {"reputation": 4159, "user_id": 1959050, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/421de4eb68c9e4a007b0c90f05c15999?s=128&d=identicon&r=PG", "display_name": "Philip7899", "link": "https://stackoverflow.com/users/1959050/philip7899"}, "edited": false, "score": 0, "creation_date": 1440017127, "post_id": 32105258, "comment_id": 52105198, "body": "Thanks, but that did not work.  I still get the same error."}, {"owner": {"reputation": 4666, "user_id": 24708, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/544e2e76286098a2c64c3638401d2191?s=128&d=identicon&r=PG", "display_name": "jmccartie", "link": "https://stackoverflow.com/users/24708/jmccartie"}, "reply_to_user": {"reputation": 4159, "user_id": 1959050, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/421de4eb68c9e4a007b0c90f05c15999?s=128&d=identicon&r=PG", "display_name": "Philip7899", "link": "https://stackoverflow.com/users/1959050/philip7899"}, "edited": false, "score": 0, "creation_date": 1440036565, "post_id": 32105258, "comment_id": 52111057, "body": "Sorry to hear that.  Can you open a support ticket?  help.heroku.com/tickets/new  I can get that fixed for you ASAP"}, {"owner": {"reputation": 4159, "user_id": 1959050, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/421de4eb68c9e4a007b0c90f05c15999?s=128&d=identicon&r=PG", "display_name": "Philip7899", "link": "https://stackoverflow.com/users/1959050/philip7899"}, "edited": false, "score": 0, "creation_date": 1440041063, "post_id": 32105258, "comment_id": 52112084, "body": "thanks jmccartie, I just made a support ticket: <a href=\"https://help.heroku.com/tickets/265991\" rel=\"nofollow noreferrer\">help.heroku.com/tickets/265991</a>"}], "tags": [], "owner": {"reputation": 4666, "user_id": 24708, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/544e2e76286098a2c64c3638401d2191?s=128&d=identicon&r=PG", "display_name": "jmccartie", "link": "https://stackoverflow.com/users/24708/jmccartie"}, "is_accepted": false, "score": 0, "last_activity_date": 1440016759, "creation_date": 1440016759, "answer_id": 32105258, "question_id": 32103661, "link": "https://stackoverflow.com/questions/32103661/forking-heroku-rails-app-does-not-work-it-says-invalid-data/32105258#32105258", "title": "forking heroku rails app does not work. It says invalid data", "body": "<p>This was a bug introduced in the CLI.  Run <code>heroku update</code> to get the latest version and this should be resolved.</p>\n"}], "owner": {"reputation": 4159, "user_id": 1959050, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/421de4eb68c9e4a007b0c90f05c15999?s=128&d=identicon&r=PG", "display_name": "Philip7899", "link": "https://stackoverflow.com/users/1959050/philip7899"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1440016759, "creation_date": 1440011179, "question_id": 32103661, "link": "https://stackoverflow.com/questions/32103661/forking-heroku-rails-app-does-not-work-it-says-invalid-data", "title": "forking heroku rails app does not work. It says invalid data", "body": "<p>I am trying to fork an existing heroku app and create a staging app. I use the following command:</p>\n\n<pre><code>heroku fork --from tmapp1 --to tmstage1\n</code></pre>\n\n<p>The following is returned:</p>\n\n<pre><code>Forking tmapp1... done. Forked to tmstage\n \u25b8    invalid data\n\nThere was an error forking to tmstage.\n\nIn order to avoid being charged for any resources on tmstage, it is being destroyed...\n</code></pre>\n\n<p>It is not giving any more information.  How do I get the forking to work?  I  am using ruby on rails 4.1.4 and Ruby 2.2.0</p>\n"}, {"tags": ["ruby", "oauth", "gem", "rest-client"], "comments": [{"owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "edited": false, "score": 0, "creation_date": 1440013327, "post_id": 32103288, "comment_id": 52103013, "body": "Where is @consumer coming from in 3? What does it contain?"}, {"owner": {"reputation": 139, "user_id": 3078381, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/PNcYS.jpg?s=128&g=1", "display_name": "brbrr", "link": "https://stackoverflow.com/users/3078381/brbrr"}, "reply_to_user": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "edited": false, "score": 0, "creation_date": 1440014712, "post_id": 32103288, "comment_id": 52103856, "body": "@ReggieB I&#39;ve update description. all methods uses generic <code>get_con</code> method to get consumer object"}, {"owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "edited": false, "score": 1, "creation_date": 1440058851, "post_id": 32103288, "comment_id": 52119201, "body": "I assumed get_con was get connection, and didn&#39;t realise it had anything to do with consumer. I&#39;ve edited your code to make it a little clearer IMO."}], "answers": [{"tags": [], "owner": {"reputation": 139, "user_id": 3078381, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/PNcYS.jpg?s=128&g=1", "display_name": "brbrr", "link": "https://stackoverflow.com/users/3078381/brbrr"}, "is_accepted": true, "score": 0, "last_activity_date": 1440082508, "creation_date": 1440082508, "answer_id": 32121613, "question_id": 32103288, "link": "https://stackoverflow.com/questions/32103288/how-to-sign-requests-with-custom-access-token-for-2-legged-oauth/32121613#32121613", "title": "How to sign requests with custom access token for 2 legged oAuth", "body": "<p>Issue was related to server (Spring) encoding stuff. <a href=\"https://github.com/oauth-xx/oauth-ruby\" rel=\"nofollow\">oauth-ruby</a> gem is escaping token secret (Combined secret or Encryption key) which is used for signature creation. Spring by default doing the same on server side.</p>\n\n<p>Unescaping access_token.secret fixed this issue:</p>\n\n<p><code>access_token.secret = OAuth::Helper.unescape(access_token.secret)</code></p>\n"}], "owner": {"reputation": 139, "user_id": 3078381, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/PNcYS.jpg?s=128&g=1", "display_name": "brbrr", "link": "https://stackoverflow.com/users/3078381/brbrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 32121613, "answer_count": 1, "score": 1, "last_activity_date": 1440082508, "creation_date": 1440009865, "last_edit_date": 1440058734, "question_id": 32103288, "link": "https://stackoverflow.com/questions/32103288/how-to-sign-requests-with-custom-access-token-for-2-legged-oauth", "title": "How to sign requests with custom access token for 2 legged oAuth", "body": "<p>I using <a href=\"https://github.com/oauth-xx/oauth-ruby\" rel=\"nofollow\">oauth-ruby</a> gem for a while, and I already implemented 2 types of auth:</p>\n\n<ol>\n<li>default one</li>\n<li>and custom, which uses <code>OTP</code> sent via sms</li>\n</ol>\n\n<p>Both of them works perfectly now</p>\n\n<p>But now i'm trying to implement new(3) 2-legged oauth. And I ran in to issues which I actually can't understand.\nAll my signed requests using access token from (3) are failing because of invalid token. For (1-2) it works without any issues. </p>\n\n<p>Signing requests is implemented via <code>RestClient.before_execution_proc</code>:</p>\n\n<pre><code>RestClient.add_before_execution_proc do |req, params|\n  access_token.sign!(req)\nend\n</code></pre>\n\n<p>I suppose the problem comes from <code>access_token = OAuth::AccessToken</code> as there actual difference between other 2.\nAny suggestions or advices will be very helpful</p>\n\n<p>1.</p>\n\n<pre><code>def default_oauth(login, pass, device: Device.new)\n  @cookies = login_req(login, pass).cookies\n  headers = common_headers.merge(\"Cookie\" =&gt; @cookies)\n  #Get request token\n  request_token = consumer.get_request_token\n  # Authorize request key\n  authorize = RestClient.post(base_url + '/oauth/authorize',\n                              { requestToken: request_token.token, authorize: 'Authorize'},\n                              headers) {|response, request, result| response }\n  auth_url_resp = RestClient.get(authorize.headers[:location], headers: headers) {|response, request, result| response }\n  # Get Access key\n  access_token = request_token.get_access_token\nend\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>def custom_oauth(phone, pin, otp: nil, device: Device.new)\n  otp = phone.to_s[-5..-1] if otp.nil?\n  resp = RestClient.post(\"#{base_url}/rest/smartphone/otp/sms-sender/#{phone}\", '', common_headers) {|response, request, result| response }\n\n  request_token = consumer.get_request_token\n  payload = {\n      device: device.to_h,\n      otp: otp,\n      password: pin.to_s,\n      requestToken: request_token.token\n  }\n  headers = json_headers.merge('Cookie' =&gt; otp)\n  authorize = RestClient.post(base_url + '/oauth/otp-authorization',\n                              payload.to_json, headers) {|response, request, result| response }\n  @access_token = request_token.get_access_token\nend\n</code></pre>\n\n<p>3.</p>\n\n<pre><code>def new_oauth(login, pass, entry, device: Device.new)\n  tkn = consumer.get_request_token.token\n  payload = {\n      username: login,\n      password: pass.to_s,\n      requestToken: tkn,\n      entryPoint: entry,\n      device: device.to_h\n  }\n\n  headers =json_headers(device.id)\n  resp = RestClient.post(\"#{base_url}/oauth/login-authorization\", payload.to_json, headers) {|response, request, result| response}\n  hsh ={oauth_token: resp.headers[:accesstoken], oauth_token_secret: resp.headers[:tokensecret] }\n  access_token = OAuth::AccessToken.from_hash(consumer, hsh)\nend\n</code></pre>\n\n<p>Consumer:</p>\n\n<pre><code>def consumer\n  @consumer ||= build_consumer\nend\n\ndef build_consumer\n  key = 'key_string'\n  secret ='secret_string'\n  OAuth::Consumer.new(key, secret, :site =&gt; base_url)\nend\n</code></pre>\n"}, {"tags": ["ruby", "amazon-s3", "ceph", "radosgw"], "answers": [{"comments": [{"owner": {"reputation": 1555, "user_id": 8358881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhm8s.jpg?s=128&g=1", "display_name": "lwileczek", "link": "https://stackoverflow.com/users/8358881/lwileczek"}, "edited": false, "score": 0, "creation_date": 1603314704, "post_id": 32277951, "comment_id": 114001938, "body": "out of date, link is dead."}], "tags": [], "owner": {"reputation": 759, "user_id": 1972954, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9402cedfdd957e56a7b324944e7a1c4c?s=128&d=identicon&r=PG", "display_name": "Erik Nguyen", "link": "https://stackoverflow.com/users/1972954/erik-nguyen"}, "is_accepted": true, "score": 1, "last_activity_date": 1440787968, "creation_date": 1440787968, "answer_id": 32277951, "question_id": 32103129, "link": "https://stackoverflow.com/questions/32103129/aws-s3-and-ceph-rados-bucket-permission-inheritance/32277951#32277951", "title": "AWS S3 and CEPH / Rados Bucket permission inheritance", "body": "<p>Unfortunately policies are inherited, so while it is possible to read the list of objects in a bucket, as it stands the anonymous read permission doesn't continue for the items uploaded.</p>\n\n<p><a href=\"http://ceph.com/docs/master/radosgw/s3/\" rel=\"nofollow\">http://ceph.com/docs/master/radosgw/s3/</a></p>\n"}], "owner": {"reputation": 759, "user_id": 1972954, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9402cedfdd957e56a7b324944e7a1c4c?s=128&d=identicon&r=PG", "display_name": "Erik Nguyen", "link": "https://stackoverflow.com/users/1972954/erik-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1033, "favorite_count": 0, "accepted_answer_id": 32277951, "answer_count": 1, "score": 0, "last_activity_date": 1440787968, "creation_date": 1440009347, "question_id": 32103129, "link": "https://stackoverflow.com/questions/32103129/aws-s3-and-ceph-rados-bucket-permission-inheritance", "title": "AWS S3 and CEPH / Rados Bucket permission inheritance", "body": "<p>I'm having issues with creating a publicly readable bucket. I'm working in a CEPH / Rados store using the Amazon aws-sdk v 1.60.2</p>\n\n<p>I created a bucket similar to many different tutorials with</p>\n\n<pre><code>s3.buckets.create('bucketName', :acl =&gt; :public_read)\n</code></pre>\n\n<p>I then uploaded a number of files up to <code>s3.buckets['bucketName']</code> But when I go in and look at specific permissions for the bucket and it's internal objects the bucket I see has READ permissions granted to AllUsers group as well as FULL_CONTROL set to the user I created the bucket with. The objects however do not inherit the anonymous read permissions. I need the objects in the bucket to be readable anonymously.</p>\n\n<p>As a note I see these permissions when I run <code>s3.buckets['bucketName'].acl</code>. When I try to run <code>s3.buckets['bucketName'].policy</code> I get the following error that makes no sense:</p>\n\n<pre><code>/var/lib/gems/1.9.1/gems/json-1.8.3/lib/json/common.rb:155:in `parse': 757: unexpected token at '&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;ListBucketResult xmlns=\"http://s3.amazonaws.com/doc/2006-03-01/\"&gt;&lt;Name&gt;erik.test&lt;/Name&gt;&lt;Prefix&gt;&lt;/Prefix&gt;&lt;Marker&gt;&lt;/Marker&gt;&lt;MaxKeys&gt;1000&lt;/MaxKeys&gt;&lt;IsTruncated&gt;false&lt;/IsTruncated&gt;&lt;/ListBucketResult&gt;' (JSON::ParserError)\n    from /var/lib/gems/1.9.1/gems/json-1.8.3/lib/json/common.rb:155:in `parse'\n    from /var/lib/gems/1.9.1/gems/aws-sdk-v1-1.60.2/lib/aws/core/policy.rb:146:in `from_json'\n    from /var/lib/gems/1.9.1/gems/aws-sdk-v1-1.60.2/lib/aws/s3/bucket.rb:621:in `policy'\n    from test.rb:20:in `&lt;main&gt;'\n</code></pre>\n\n<p>The above error looks like aws-sdk is calling a json parser on an XML string which shouldn't be happening.</p>\n\n<p>I cannot simply upload the objects with explicit permissions because my project would have BOSH uploading to the store automatically. </p>\n"}, {"tags": ["ruby", "database", "sorting", "ruby-on-rails-4", "activerecord"], "comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1440010208, "post_id": 32103065, "comment_id": 52101152, "body": "Is <i>general</i> returned after <code>pluck</code> or is it just something you want to add to each category afterwards?"}, {"owner": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1440011617, "post_id": 32103065, "comment_id": 52101969, "body": "@ndn &#39;general&#39; is currently one of the subcategories. It&#39;s not present in all of the subcategories though."}], "answers": [{"tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": false, "score": 0, "last_activity_date": 1440011849, "creation_date": 1440011849, "answer_id": 32103867, "question_id": 32103065, "link": "https://stackoverflow.com/questions/32103065/two-level-array-sort-with-one-of-the-second-level-array-members-always-on-top/32103867#32103867", "title": "Two level array sort with one of the second level array members always on top", "body": "<p>If I were you, I would format the DB query result, so that it looks like</p>\n\n<pre><code>{\n  \"category1\" =&gt; [\"general\", \"subcategory1\", \"subcategory2\", ...],\n  \"category2\" =&gt; [\"general\", \"subcategory1\", \"subcategory2\", ...],\n  ...\n}\n</code></pre>\n\n<p>If <code>\"general\"</code> is <strong>not</strong> stored in DB, then</p>\n\n<pre><code>ModelName.pluck(:category, :subcategory).sort.reduce(Hash.new{['general']}) do |hash, model|\n  hash[model[0]] &lt;&lt;= model[1]\nend\n</code></pre>\n\n<p>If <code>\"general\"</code> is in DB, then just remove <code>\"general\"</code> from each array then unshift it:</p>\n\n<pre><code>result = ModelName.pluck(:category, :subcategory).sort.reduce(Hash.new{[]}) do |hash, model|\n  hash[model[0]] &lt;&lt;= model[1]\nend\nresult.values.each do |subcategories|\n  subcategories.unshift('general') if subcategories.delete('general')\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "edited": false, "score": 0, "creation_date": 1440012793, "post_id": 32103990, "comment_id": 52102704, "body": "I tried using your method and it seems that it will unshift all of the &#39;general&#39; subcategories to the top of the list rather than keeping them within their own categories."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "edited": false, "score": 0, "creation_date": 1440013006, "post_id": 32103990, "comment_id": 52102831, "body": "@JCC, this doesn&#39;t make sense. I tried it in pry and it works. Comparison for array compares elements from left to right. Aka it will first compare by <code>category</code> and only if the categories are equal will it compare by <code>subcategory</code>."}, {"owner": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "edited": false, "score": 0, "creation_date": 1440013417, "post_id": 32103990, "comment_id": 52103067, "body": "I&#39;m not sure what&#39;s going on. I double checked and it does look like it extracts all of the categories with a &#39;general&#39; subcategory and puts them on top of the list. Not even in order. The rest of the list is ordered however."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "edited": false, "score": 0, "creation_date": 1440013572, "post_id": 32103990, "comment_id": 52103174, "body": "@JCC, could you provide exact output of <code>p categorization</code>?"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "edited": false, "score": 0, "creation_date": 1440014203, "post_id": 32103990, "comment_id": 52103568, "body": "@JCC, btw <code>sort_by</code> does not sort inplace. If you are going to use the <code>categorization</code> value afterwards and expect it to be sorted according to the above rule, you should use <code>sort_by!</code> instead."}, {"owner": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "edited": false, "score": 0, "creation_date": 1440014353, "post_id": 32103990, "comment_id": 52103663, "body": "I posted the output in my question post above. Thanks."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "edited": false, "score": 0, "creation_date": 1440014634, "post_id": 32103990, "comment_id": 52103814, "body": "@JCC, glad to hear that. I added it in my answer. Could you please update the question too, so it wont be confusing for future readers?"}, {"owner": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "edited": false, "score": 0, "creation_date": 1440014883, "post_id": 32103990, "comment_id": 52103944, "body": "I&#39;m not sure what you need me to change in my question? Let me know and I&#39;ll edit. Thanks."}, {"owner": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1440015173, "post_id": 32103990, "comment_id": 52104130, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/87413/discussion-between-jcc-and-ndn\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": true, "score": 3, "last_activity_date": 1440014588, "last_edit_date": 1440014588, "creation_date": 1440012278, "answer_id": 32103990, "question_id": 32103065, "link": "https://stackoverflow.com/questions/32103065/two-level-array-sort-with-one-of-the-second-level-array-members-always-on-top/32103990#32103990", "title": "Two level array sort with one of the second level array members always on top", "body": "<pre><code>categorization = ModelName.pluck(:category, :subcategory)\n    # =&gt; [[\"category1\", \"subcategory1\"],\n    #     [\"category1\", \"subcategory2\"],\n    #     [\"category1\", \"general\"],\n    #     [\"category2\", \"general\"],\n    #     [\"category2\", \"subcategory2\"],\n    #     [\"category3\", \"subcategory3\"],\n    #     [\"category3\", \"general\"]]\n\n\ncategorization.sort_by! do |category, subcategory|\n  subcategory == 'general' ? [category, ''] : [category, subcategory]\nend\n    # =&gt; [[\"category1\", \"general\"],\n    #     [\"category1\", \"subcategory1\"],\n    #     [\"category1\", \"subcategory2\"],\n    #     [\"category2\", \"general\"],\n    #     [\"category2\", \"subcategory2\"],\n    #     [\"category3\", \"general\"],\n    #     [\"category3\", \"subcategory3\"]]\n</code></pre>\n"}], "owner": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 32103990, "answer_count": 2, "score": 1, "last_activity_date": 1440015018, "creation_date": 1440009146, "last_edit_date": 1440015018, "question_id": 32103065, "link": "https://stackoverflow.com/questions/32103065/two-level-array-sort-with-one-of-the-second-level-array-members-always-on-top", "title": "Two level array sort with one of the second level array members always on top", "body": "<p>I have a two level array that has a category and a sub-category in each element like this:</p>\n\n<p><code>[[category1, subcategory1], [category1, subcategory2], [category2, subcategory2], [category3, subcategory3]]...</code></p>\n\n<p>I'm using this in a dropdown that will show the list like this:</p>\n\n<pre><code>category1\n  general\n  subcategory1\n  subcategory2\ncategory2\n  general\n  subcategory1\n  subcategory2\n  subcategory3\n</code></pre>\n\n<p>Basically, I need to have the 'general' subcategory to always show up on top of the list of subcategories, if it's present, which are alphabetical. How would I code this?</p>\n\n<p>Using ActiveRecord, it's relatively easy to do an alphabetical sort for the array itself:\n<code>ModelName.pluck(:category, :subcategory).sort</code></p>\n\n<p>But that won't put the subcategory 'general' on top. It will be alphabetical. I would prefer a rails solution but any help in pointing me in the right direction would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "linux"], "comments": [{"owner": {"reputation": 6584, "user_id": 1831520, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFRGt.jpg?s=128&g=1", "display_name": "sadaf2605", "link": "https://stackoverflow.com/users/1831520/sadaf2605"}, "edited": false, "score": 0, "creation_date": 1440008895, "post_id": 32102916, "comment_id": 52100289, "body": "do you have pgsql installed in your system?"}, {"owner": {"reputation": 1538, "user_id": 2150483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5kARJ.jpg?s=128&g=1", "display_name": "Alan Kis", "link": "https://stackoverflow.com/users/2150483/alan-kis"}, "reply_to_user": {"reputation": 6584, "user_id": 1831520, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFRGt.jpg?s=128&g=1", "display_name": "sadaf2605", "link": "https://stackoverflow.com/users/1831520/sadaf2605"}, "edited": false, "score": 0, "creation_date": 1440010838, "post_id": 32102916, "comment_id": 52101517, "body": "Yes, postgresql is installed and running."}, {"owner": {"reputation": 186, "user_id": 806902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65dccca1788bb6e6bce10f7d7eac9d24?s=128&d=identicon&r=PG", "display_name": "grenierm5", "link": "https://stackoverflow.com/users/806902/grenierm5"}, "edited": false, "score": 1, "creation_date": 1440016221, "post_id": 32102916, "comment_id": 52104724, "body": "$ sudo apt-get install ruby-dev libpq-dev build-essential (Different problem, but probably the same solution <a href=\"http://stackoverflow.com/questions/11172264/postgres-the-last-version-0-14-0-of-the-pg-gem-gives-error\" title=\"postgres the last version 0 14 0 of the pg gem gives error\">stackoverflow.com/questions/11172264/&hellip;</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 1538, "user_id": 2150483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5kARJ.jpg?s=128&g=1", "display_name": "Alan Kis", "link": "https://stackoverflow.com/users/2150483/alan-kis"}, "is_accepted": true, "score": 0, "last_activity_date": 1440086655, "last_edit_date": 1495542594, "creation_date": 1440086655, "answer_id": 32123106, "question_id": 32102916, "link": "https://stackoverflow.com/questions/32102916/gem-install-encoding-error-after-enironment-changed-from-win-to-linux/32123106#32123106", "title": "Gem install encoding error after enironment changed from Win to Linux", "body": "<p>According to similar <a href=\"https://stackoverflow.com/questions/11172264/postgres-the-last-version-0-14-0-of-the-pg-gem-gives-error\">question</a> on SO, to which SO user grenierm5 pointed me,i t seems that installing ruby-dev headers for compiling extension modules did the trick. </p>\n\n<pre><code>sudo apt-get install ruby-dev &amp;&amp; sudo gem install pg\n</code></pre>\n"}], "owner": {"reputation": 1538, "user_id": 2150483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5kARJ.jpg?s=128&g=1", "display_name": "Alan Kis", "link": "https://stackoverflow.com/users/2150483/alan-kis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 32123106, "answer_count": 1, "score": 0, "last_activity_date": 1440086655, "creation_date": 1440008646, "last_edit_date": 1440010816, "question_id": 32102916, "link": "https://stackoverflow.com/questions/32102916/gem-install-encoding-error-after-enironment-changed-from-win-to-linux", "title": "Gem install encoding error after enironment changed from Win to Linux", "body": "<p>I am trying to install pgsql gem, but I have some strange encoding issue when trying to install. Whole app have just been migrated from windows environment to Linux environment, but only default gemfile was used. I have found that way to solve is to change locale in registry.rb, but as I mentioned, my environment is Linux. Gist of gem_make.out can be viewed here: <a href=\"https://gist.github.com/alankis/66fe0b3d80d0373dc01e\" rel=\"nofollow\">gist</a></p>\n\n<p>postgresql is installed and runing:</p>\n\n<pre><code>$ service postgresql status \n9.3/main (port 5432): online\n</code></pre>\n\n<p>EDIT: Seems that this issue is only happening with pgsql gem, other gems are installing sucessfuly, for example, running <code>$ gem install A_123</code> installs specified gem successfully.</p>\n"}, {"tags": ["ruby", "rake", "rakefile"], "answers": [{"comments": [{"owner": {"reputation": 32630, "user_id": 1011527, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/950d56c466691980bba71859798bfe65?s=128&d=identicon&r=PG", "display_name": "Jay Blanchard", "link": "https://stackoverflow.com/users/1011527/jay-blanchard"}, "edited": false, "score": 1, "creation_date": 1440008231, "post_id": 32102533, "comment_id": 52099857, "body": "<i>smacks forehead</i> I totally missed that @Jordan. I was thinking I would limit the extensions of the files that could be included, so I&#39;ll rewrite and do that only one time. I&#39;ll also rename the variable to reflect that it is file extensions."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 4, "last_activity_date": 1440007326, "creation_date": 1440007326, "answer_id": 32102533, "question_id": 32102266, "link": "https://stackoverflow.com/questions/32102266/rake-runs-function-twice/32102533#32102533", "title": "Rake runs function twice", "body": "<p>The problem is that you're adding <code>foo.db</code> to the <code>files</code> FileList twice:</p>\n\n<pre><code>files.include Dir.glob(\"#{src}/*.*\")\nFILES.each {|ext| files.include \"#{src}/*.#{ext}\"}\n</code></pre>\n\n<p>Because <code>FILES</code> (which is a misleading variable name) includes <code>\"db\"</code>, on the first line you're adding <code>*.*</code> to <code>files</code> and on the second line you're adding <code>*.db</code> to <code>files</code>.</p>\n\n<p>It's not clear why you have both lines, since the first line will add every file in the directory, so the second line is only going to add files that you've already added.</p>\n"}], "owner": {"reputation": 32630, "user_id": 1011527, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/950d56c466691980bba71859798bfe65?s=128&d=identicon&r=PG", "display_name": "Jay Blanchard", "link": "https://stackoverflow.com/users/1011527/jay-blanchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 32102533, "answer_count": 1, "score": 1, "last_activity_date": 1440007326, "creation_date": 1440006481, "last_edit_date": 1440007206, "question_id": 32102266, "link": "https://stackoverflow.com/questions/32102266/rake-runs-function-twice", "title": "Rake runs function twice", "body": "<p>I started creating a set of Rake tasks (my first time, with limited Ruby experience) and when I run the first task, using either <code>rake test</code> or <code>rake db</code>, from the command line I get two outputs even though there is only one file in the directory in question.</p>\n\n<p>rakefile.rb</p>\n\n<pre><code>require 'fileutils'\n\nFILES    = [\"html\", \"css\", \"js\", \"svg\", \"otf\", \"eot\", \"ttf\", \"woff\", \"jpeg\", \"map\", \"ico\", \"map\", \"png\", \"db\"]\n\ndesc 'test script'\ntask :test =&gt; [:db]\n\ntask :db do\n    copy_to 'data/', 'c:/xampp/htdocs/home/shared/data'\nend\n\ndef copy_to(dest, src)\n\n    files = FileList.new()\n    files.include Dir.glob(\"#{src}/*.*\")\n    FILES.each {|ext| files.include \"#{src}/*.#{ext}\"}\n    files.each do |src|\n        puts \"copying: #{src} to #{dest}\"\n        FileUtils.cp src, dest\n    end\n\nend\n</code></pre>\n\n<p>Output </p>\n\n<pre><code>(in C:/xampp/htdocs/home/gateway)                        \ncopying: c:/xampp/htdocs/home/shared/data/foo.db to data/   \ncopying: c:/xampp/htdocs/home/shared/data/foo.db to data/   \n</code></pre>\n\n<p>When I do <code>rake -T</code> I get the following (which is what I would expect):</p>\n\n<pre><code>(in C:/xampp/htdocs/home/gateway)\nrake test  # test script\n</code></pre>\n\n<p>Of course <code>foo.db</code> only gets copied once, or the second copy overwrites the \nfirst one.</p>\n\n<p><strong>EDIT</strong> ran <code>rake test --trace</code> from the command line</p>\n\n<pre><code>** Invoke test (first_time)                                                   \n** Invoke db (first_time)                                                     \n** Execute db                                                                 \ncopying: c:/xampp/htdocs/home/shared/data/foo.db to data/ \ncopying: c:/xampp/htdocs/home/shared/data/foo.db to data/ \n** Execute test                                                               \n</code></pre>\n\n<p>Is it executing <code>:db</code> and <em>then</em> <code>:test</code>? Or is <code>:db</code> running twice as it appears to be doing here? What am I missing? Have I done something wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2805, "user_id": 918365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oTr91.jpg?s=128&g=1", "display_name": "Yosep Kim", "link": "https://stackoverflow.com/users/918365/yosep-kim"}, "edited": false, "score": 0, "creation_date": 1440007282, "post_id": 32102114, "comment_id": 52099319, "body": "what is the console output for the request? It would be easier for us to help you out if what&#39;s being passed over to the server."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1440007561, "post_id": 32102114, "comment_id": 52099475, "body": "You really should not have the permitted_params method in your model. Dealing with user input is the controllers job, not the model. If you really need to dry out the params whitelist use a module or helper method."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1440010309, "post_id": 32102114, "comment_id": 52101211, "body": "Can you please add the controller?"}, {"owner": {"reputation": 569, "user_id": 3978366, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adfd542c717f83dc36ff74636c60fe15?s=128&d=identicon&r=PG", "display_name": "Terry Raimondo", "link": "https://stackoverflow.com/users/3978366/terry-raimondo"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1440067186, "post_id": 32102114, "comment_id": 52124657, "body": "@max I added the controller, why permitted_params should not be in the model ?"}, {"owner": {"reputation": 569, "user_id": 3978366, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adfd542c717f83dc36ff74636c60fe15?s=128&d=identicon&r=PG", "display_name": "Terry Raimondo", "link": "https://stackoverflow.com/users/3978366/terry-raimondo"}, "reply_to_user": {"reputation": 2805, "user_id": 918365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oTr91.jpg?s=128&g=1", "display_name": "Yosep Kim", "link": "https://stackoverflow.com/users/918365/yosep-kim"}, "edited": false, "score": 0, "creation_date": 1440067362, "post_id": 32102114, "comment_id": 52124777, "body": "@YosepKim I&#39;m sorry but the output is really heavy, it is a deeply nested form"}], "answers": [{"comments": [{"owner": {"reputation": 569, "user_id": 3978366, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adfd542c717f83dc36ff74636c60fe15?s=128&d=identicon&r=PG", "display_name": "Terry Raimondo", "link": "https://stackoverflow.com/users/3978366/terry-raimondo"}, "edited": false, "score": 0, "creation_date": 1440067860, "post_id": 32104226, "comment_id": 52125079, "body": "Still run into this issue with inverse_of. has_many :projects, inverse_of: :user and belongs_to :user, inverse_of: :projects"}, {"owner": {"reputation": 569, "user_id": 3978366, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adfd542c717f83dc36ff74636c60fe15?s=128&d=identicon&r=PG", "display_name": "Terry Raimondo", "link": "https://stackoverflow.com/users/3978366/terry-raimondo"}, "edited": false, "score": 0, "creation_date": 1440145951, "post_id": 32104226, "comment_id": 52161844, "body": "I think :inverse_of would be useful in the case my form is a user form with a project and not a project form with a user. For my user is already existing and not my project, I can&#39;t update it in this form with this solution."}], "tags": [], "owner": {"reputation": 2799, "user_id": 3772982, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/91362482c60ebfba88fbdbde79c5fac6?s=128&d=identicon&r=PG&f=1", "display_name": "margo", "link": "https://stackoverflow.com/users/3772982/margo"}, "is_accepted": false, "score": 0, "last_activity_date": 1440020301, "last_edit_date": 1440020301, "creation_date": 1440013100, "answer_id": 32104226, "question_id": 32102114, "link": "https://stackoverflow.com/questions/32102114/update-an-existing-model-user-in-a-nested-form-for-a-new-model-project/32104226#32104226", "title": "Update an existing model (User) in a nested form for a new model (Project)", "body": "<p>It sounds like you need to use inverse of in your class. Look it up in the rails docs, also <a href=\"https://viget.com/extend/exploring-the-inverse-of-option-on-rails-model-associations\" rel=\"nofollow\">this article</a> gives a pretty good explanation. </p>\n\n<p>Btw I agree with @max's comments re permitted parameters belonging in the controller. Below is how you whitelist params in your controller and include attributes for an association.</p>\n\n<pre><code>def user_params\n  params.require(:user).permit(\n    :id, :last_name, bank_account_attributes: [:id, :account_number, :sort_code]\n  )\nend\n</code></pre>\n"}], "owner": {"reputation": 569, "user_id": 3978366, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adfd542c717f83dc36ff74636c60fe15?s=128&d=identicon&r=PG", "display_name": "Terry Raimondo", "link": "https://stackoverflow.com/users/3978366/terry-raimondo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1441026043, "creation_date": 1440005899, "last_edit_date": 1495540687, "question_id": 32102114, "link": "https://stackoverflow.com/questions/32102114/update-an-existing-model-user-in-a-nested-form-for-a-new-model-project", "title": "Update an existing model (User) in a nested form for a new model (Project)", "body": "<p>Using Rails 4.2.3</p>\n\n<p>I want to create a form to update a model (User) and create new ones (Project, Rewards, BankAccount)</p>\n\n<p>My models:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class User &lt; ActiveRecord::Base\n  has_many :projects\n  def self.permitted_params\n    [:id, :last_name, ... , bank_account_attributes: BankAccount.permitted_params]\n  end\n    ...\nend\n\nclass Project &lt; ActiveRecord::Base\n  belongs_to :user\n  accepts_nested_attributes_for :user\n\n  def self.permitted_params\n    [:name, :description, ...]\n  end\n    ...\nend\n</code></pre>\n\n<p>Form:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;%= simple_form_for @project, html: { class: 'saveable-form' } do |f| %&gt;\n  &lt;%= f.input :name %&gt;\n  ...\n\n  &lt;%= f.simple_fields_for :user do |user| %&gt;\n      &lt;%= render 'user_fields', f: user %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Controller</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ProjectsController &lt; ApplicationController\n  def new\n    @project = Project.new\n    @project.user = current_user\n    @project.user.build_bank_account\n  end\n\n...\n\n  def project_params\n    params.require(:project).permit(\n      Project.permitted_params,\n      rewards_attributes: Reward.permitted_params,\n      user_attributes: User.permitted_params\n    )\n  end\nend\n</code></pre>\n\n<p>It is a really simple form.</p>\n\n<p>But when I try to submit I got this:</p>\n\n<pre><code>Couldn't find User with ID=1 for Project with ID=\n</code></pre>\n\n<p>I got a temporary fix for this, found <a href=\"https://stackoverflow.com/questions/6346134/use-rails-nested-model-to-create-outer-object-and-simultaneously-edit-existi/12064875#12064875\">here</a> </p>\n\n<p>This is a fix for Rails 2.3.8.\nI hope there is a DRYer solution for this.</p>\n\n<p>Suggestions ? Do anyone have already encountered this problem and how do you have fixed this ?</p>\n\n<p>Here is the full code:</p>\n\n<p>Form:\n<a href=\"http://pastebin.com/NwfxCJQH\" rel=\"nofollow noreferrer\">http://pastebin.com/NwfxCJQH</a></p>\n\n<p>Controller:\n<a href=\"http://pastebin.com/U2g2Sv04\" rel=\"nofollow noreferrer\">http://pastebin.com/U2g2Sv04</a></p>\n\n<p>Models:\n<a href=\"http://pastebin.com/5QsCsXN6\" rel=\"nofollow noreferrer\">http://pastebin.com/5QsCsXN6</a></p>\n"}, {"tags": ["ruby", "api"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 4, "creation_date": 1440006693, "post_id": 32102096, "comment_id": 52099017, "body": "That&#39;s a terrible api. They probably didn&#39;t care about the users."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1440008509, "post_id": 32102096, "comment_id": 52100058, "body": "I would say it is an API design failure. The second case should be <code>[{a:1, b:2}]</code>, and the third case <code>[]</code>."}, {"owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "edited": false, "score": 0, "creation_date": 1440061559, "post_id": 32102096, "comment_id": 52120870, "body": "Unfortunately, it&#39;s not my api..."}], "answers": [{"tags": [], "owner": {"reputation": 237, "user_id": 5243467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb7ca64eda9911e73adba6964b025b7?s=128&d=identicon&r=PG&f=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/5243467/leroy"}, "is_accepted": false, "score": 0, "last_activity_date": 1440006411, "creation_date": 1440006411, "answer_id": 32102247, "question_id": 32102096, "link": "https://stackoverflow.com/questions/32102096/deal-with-array-of-hashes-or-single-hash-from-an-api-response/32102247#32102247", "title": "Deal with Array of Hashes or single Hash ( from an API Response)", "body": "<p>In Ruby, you can use <code>case</code> to test types.</p>\n\n<pre><code>def type? item    \n    case result\n       when Array\n           \"array\"\n       when Hash\n           \"hash\"\n       else\n           \"couldn't figure it out\"\n    end\nend\n</code></pre>\n\n<p>That would clean up your code and not make it a bunch of nested ifs.</p>\n"}, {"comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1440007442, "post_id": 32102448, "comment_id": 52099423, "body": "Now replace <code>([] &lt;&lt; call_api)</code> with <code>[call_api]</code> and it will even look pretty."}], "tags": [], "owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "is_accepted": true, "score": 1, "last_activity_date": 1440009822, "last_edit_date": 1440009822, "creation_date": 1440006990, "answer_id": 32102448, "question_id": 32102096, "link": "https://stackoverflow.com/questions/32102096/deal-with-array-of-hashes-or-single-hash-from-an-api-response/32102448#32102448", "title": "Deal with Array of Hashes or single Hash ( from an API Response)", "body": "<p>Hopefully this should work for you.</p>\n\n<pre><code> # API Simulator\n def call_api\n    # Lets return randomly - one of the three results\n    [ [{a: 1, b: 2}, {a:2, b:3}], {a: 1, b:2}, nil ].sample\n end\n\n 5.times do \n    r = []\n    r &lt;&lt; call_api\n    p r.flatten.compact.map { |h| h.update(c:3) }\n end\n</code></pre>\n\n<p>Above code can also be written like below:</p>\n\n<pre><code>5.times do\n  p  [call_api].flatten.compact.map { |h| h.update(c:3)}\nend\n</code></pre>\n\n<p>The output will be array always, it may be empty or if it contains hashes, it will have <code>{ :c =&gt; 3 }</code> in each of the hashes.  One of the sample run produces below output:</p>\n\n<pre><code>[]\n[{:a=&gt;1, :b=&gt;2, :c=&gt;3}]\n[]\n[{:a=&gt;1, :b=&gt;2, :c=&gt;3}, {:a=&gt;2, :b=&gt;3, :c=&gt;3}]\n[{:a=&gt;1, :b=&gt;2, :c=&gt;3}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6584, "user_id": 1831520, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFRGt.jpg?s=128&g=1", "display_name": "sadaf2605", "link": "https://stackoverflow.com/users/1831520/sadaf2605"}, "is_accepted": false, "score": 0, "last_activity_date": 1440007701, "creation_date": 1440007701, "answer_id": 32102633, "question_id": 32102096, "link": "https://stackoverflow.com/questions/32102096/deal-with-array-of-hashes-or-single-hash-from-an-api-response/32102633#32102633", "title": "Deal with Array of Hashes or single Hash ( from an API Response)", "body": "<p>You want to </p>\n\n<blockquote>\n  <p>\"add an extra parameter where it's present.\"</p>\n</blockquote>\n\n<p>So, when we will successfully add an extra parameter, it will not be single any more so as the documentation says:</p>\n\n<blockquote>\n  <p>A single hash, if only one result</p>\n  \n  <p>results = {a:1, b:2}</p>\n</blockquote>\n\n<p>Without much thinking we can do that when result is not <code>nil</code>:</p>\n\n<pre><code>array.new(results).flatten.append(c:3)\n</code></pre>\n\n<p>So one possible solution could be:</p>\n\n<pre><code>newhash={c:3}\nif result.nil? ? array.new(results).flatten.append(c:3) else newhash end\n</code></pre>\n\n<p>But I have a feeling that this is not the best solution :P</p>\n"}, {"tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": false, "score": 0, "last_activity_date": 1440012825, "creation_date": 1440012825, "answer_id": 32104148, "question_id": 32102096, "link": "https://stackoverflow.com/questions/32102096/deal-with-array-of-hashes-or-single-hash-from-an-api-response/32104148#32104148", "title": "Deal with Array of Hashes or single Hash ( from an API Response)", "body": "<p>Normalizing the API response to array (even it has 0 or 1 hash) will help you:</p>\n\n<pre><code>results = [results].flatten.compact\n</code></pre>\n"}], "owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 32102448, "answer_count": 4, "score": 1, "last_activity_date": 1440012825, "creation_date": 1440005832, "last_edit_date": 1440006715, "question_id": 32102096, "link": "https://stackoverflow.com/questions/32102096/deal-with-array-of-hashes-or-single-hash-from-an-api-response", "title": "Deal with Array of Hashes or single Hash ( from an API Response)", "body": "<p>I have an API that is responding with either:</p>\n\n<ol>\n<li><p>An Array of Hashes </p>\n\n<pre><code>results = [{a: 1, b: 2}, {a:2, b:3}]\n</code></pre></li>\n<li><p>A single hash, if only one result</p>\n\n<pre><code>results = {a:1, b:2}\n</code></pre></li>\n<li><p>Or <code>nil</code></p></li>\n</ol>\n\n<p>I'm trying to work out an elegant way to deal with the situation so I can add an extra parameter where it's present. </p>\n\n<p>e.g. \nSituation 1: </p>\n\n<pre><code>results.map!{|h| h.update(c:3) }\n</code></pre>\n\n<p>Situation 2:</p>\n\n<pre><code>results[:c] = 3\n</code></pre>\n\n<p>Situation 3:</p>\n\n<pre><code>(Don't do anything)\n</code></pre>\n\n<p>I've tried </p>\n\n<pre><code>if results.is_a?(Array)\n  results.map!{|h| h.update(c:3) }\nelsif results.is_a?(Hash)\n  results.update(c:3)\nend\n</code></pre>\n\n<p>But it looks ugly, messes up the code around it (and I've got a bug that I can't pin down)...</p>\n\n<p>Is there a more elegant way to do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "model"], "comments": [{"owner": {"reputation": 357, "user_id": 3446742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9aa067bf1a218645e6bd515c44339e9a?s=128&d=identicon&r=PG", "display_name": "tangrufus", "link": "https://stackoverflow.com/users/3446742/tangrufus"}, "edited": false, "score": 0, "creation_date": 1440007282, "post_id": 32102032, "comment_id": 52099320, "body": "So, the problem is that you don&#39;t want to save Questions into DB?"}, {"owner": {"reputation": 2287, "user_id": 2842709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/30f658c76a63bcb3f40cc305020e6109?s=128&d=identicon&r=PG", "display_name": "MicFin", "link": "https://stackoverflow.com/users/2842709/micfin"}, "reply_to_user": {"reputation": 357, "user_id": 3446742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9aa067bf1a218645e6bd515c44339e9a?s=128&d=identicon&r=PG", "display_name": "tangrufus", "link": "https://stackoverflow.com/users/3446742/tangrufus"}, "edited": false, "score": 0, "creation_date": 1440007801, "post_id": 32102032, "comment_id": 52099619, "body": "I want hte questions to save to the database, I want the survey to map to many questions and a question to map to many surveys....but I want the question attribute/column value called :content to be a string that is different depending on who the survey is mapped to."}, {"owner": {"reputation": 6584, "user_id": 1831520, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFRGt.jpg?s=128&g=1", "display_name": "sadaf2605", "link": "https://stackoverflow.com/users/1831520/sadaf2605"}, "edited": false, "score": 0, "creation_date": 1440007903, "post_id": 32102032, "comment_id": 52099672, "body": "did you try meta programming?"}, {"owner": {"reputation": 2287, "user_id": 2842709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/30f658c76a63bcb3f40cc305020e6109?s=128&d=identicon&r=PG", "display_name": "MicFin", "link": "https://stackoverflow.com/users/2842709/micfin"}, "reply_to_user": {"reputation": 6584, "user_id": 1831520, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFRGt.jpg?s=128&g=1", "display_name": "sadaf2605", "link": "https://stackoverflow.com/users/1831520/sadaf2605"}, "edited": false, "score": 0, "creation_date": 1440008062, "post_id": 32102032, "comment_id": 52099764, "body": "@sadaf2605 I did not and am not sure how to go about doing that in this scenario (and am not very familiar with it in general)"}, {"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1440008265, "post_id": 32102032, "comment_id": 52099884, "body": "My thought was to store the question in the database with some strange token where you want the user&#39;s info to go and then just regex that out when it comes time to show the question. You&#39;d only have one row in your DB for each general question, so you don&#39;t need to store each user&#39;s custom question."}, {"owner": {"reputation": 2287, "user_id": 2842709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/30f658c76a63bcb3f40cc305020e6109?s=128&d=identicon&r=PG", "display_name": "MicFin", "link": "https://stackoverflow.com/users/2842709/micfin"}, "reply_to_user": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1440008340, "post_id": 32102032, "comment_id": 52099943, "body": "@nicholas79171 that sounds like how I wouuld like to do it.  How would you go about setting that up (minus the details of the regex which I can work through)"}, {"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1440008848, "post_id": 32102032, "comment_id": 52100259, "body": "@MicFin it&#39;s a really rough idea and not sure if it&#39;ll work, but check out the answer I&#39;m about to post."}], "answers": [{"comments": [{"owner": {"reputation": 2287, "user_id": 2842709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/30f658c76a63bcb3f40cc305020e6109?s=128&d=identicon&r=PG", "display_name": "MicFin", "link": "https://stackoverflow.com/users/2842709/micfin"}, "edited": false, "score": 0, "creation_date": 1440008119, "post_id": 32102732, "comment_id": 52099794, "body": "So if I was to create a new instance of a Question that has new content, would I need to create a new method for each one?"}, {"owner": {"reputation": 2287, "user_id": 2842709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/30f658c76a63bcb3f40cc305020e6109?s=128&d=identicon&r=PG", "display_name": "MicFin", "link": "https://stackoverflow.com/users/2842709/micfin"}, "edited": false, "score": 0, "creation_date": 1440009393, "post_id": 32102732, "comment_id": 52100615, "body": "not quite.  I updated my question.  Having trouble expressing the result i need"}, {"owner": {"reputation": 357, "user_id": 3446742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9aa067bf1a218645e6bd515c44339e9a?s=128&d=identicon&r=PG", "display_name": "tangrufus", "link": "https://stackoverflow.com/users/3446742/tangrufus"}, "reply_to_user": {"reputation": 2287, "user_id": 2842709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/30f658c76a63bcb3f40cc305020e6109?s=128&d=identicon&r=PG", "display_name": "MicFin", "link": "https://stackoverflow.com/users/2842709/micfin"}, "edited": false, "score": 0, "creation_date": 1440009832, "post_id": 32102732, "comment_id": 52100913, "body": "I guess you want to allow users to input their questions, then replace part of the question with user&#39;s info, right? If so, check my updated ans"}, {"owner": {"reputation": 2287, "user_id": 2842709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/30f658c76a63bcb3f40cc305020e6109?s=128&d=identicon&r=PG", "display_name": "MicFin", "link": "https://stackoverflow.com/users/2842709/micfin"}, "edited": false, "score": 0, "creation_date": 1440013839, "post_id": 32102732, "comment_id": 52103372, "body": "exactly!  I will add that to my question.  An AdminUser creates a survey and the questions and some of those questions will need a placeholder in them (or something) for the name of the User that takes the survey."}, {"owner": {"reputation": 357, "user_id": 3446742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9aa067bf1a218645e6bd515c44339e9a?s=128&d=identicon&r=PG", "display_name": "tangrufus", "link": "https://stackoverflow.com/users/3446742/tangrufus"}, "reply_to_user": {"reputation": 2287, "user_id": 2842709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/30f658c76a63bcb3f40cc305020e6109?s=128&d=identicon&r=PG", "display_name": "MicFin", "link": "https://stackoverflow.com/users/2842709/micfin"}, "edited": false, "score": 0, "creation_date": 1440014807, "post_id": 32102732, "comment_id": 52103902, "body": "Then, use my approach. Let AdminUser create questions. gsub content_raw with current_user.name"}], "tags": [], "owner": {"reputation": 357, "user_id": 3446742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9aa067bf1a218645e6bd515c44339e9a?s=128&d=identicon&r=PG", "display_name": "tangrufus", "link": "https://stackoverflow.com/users/3446742/tangrufus"}, "is_accepted": true, "score": 0, "last_activity_date": 1440010142, "last_edit_date": 1440010142, "creation_date": 1440008060, "answer_id": 32102732, "question_id": 32102032, "link": "https://stackoverflow.com/questions/32102032/rails-model-instance-with-dynamic-attribute-value-based-on-relationship/32102732#32102732", "title": "Rails model instance with dynamic attribute value based on relationship", "body": "<p>First, rename the <code>content</code> column to <code>content_raw</code></p>\n\n<p>Then define a method in <code>question</code> model, like </p>\n\n<pre><code>def content(maybe_some_params)\n  content_raw.gsub(.....)\nend\n</code></pre>\n\n<p>In this case, you can reuse the same question record if <code>content_raw</code> is the same</p>\n"}, {"tags": [], "owner": {"reputation": 6584, "user_id": 1831520, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFRGt.jpg?s=128&g=1", "display_name": "sadaf2605", "link": "https://stackoverflow.com/users/1831520/sadaf2605"}, "is_accepted": false, "score": 0, "last_activity_date": 1440008208, "creation_date": 1440008208, "answer_id": 32102780, "question_id": 32102032, "link": "https://stackoverflow.com/questions/32102032/rails-model-instance-with-dynamic-attribute-value-based-on-relationship/32102780#32102780", "title": "Rails model instance with dynamic attribute value based on relationship", "body": "<p>I think you can use ':after_create' hook. It is going to create following Questions, every time a survey will be created and when there is survey, you will have the owner of the survey.</p>\n\n<pre><code>class Survey &lt; ActiveRecord::Base\n after_create :create_random_question\n   def create_random_question:\nQuestion.new(position: 1, tier: 1, content: \"When did you first become aware of #{user.first_name}'s needs?\", question_type: \"Response\", survey_group: \"User\", survey_group_question_id: 1, choices: \"\", survey_id: new_survey.id).save\n   end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "is_accepted": false, "score": 0, "last_activity_date": 1440009111, "creation_date": 1440009111, "answer_id": 32103059, "question_id": 32102032, "link": "https://stackoverflow.com/questions/32102032/rails-model-instance-with-dynamic-attribute-value-based-on-relationship/32103059#32103059", "title": "Rails model instance with dynamic attribute value based on relationship", "body": "<p>Here's some <em>really</em> rough code that might help you have one question \"template\" and just sub in that user's data when it comes to render the form.</p>\n\n<pre><code>class Question &lt; ActiveRecord::Base\n  belongs_to :survey\n\n  def self.generate_questions(survey_id)\n    Question.new(content: \"When did you first become aware of USER_FIRST_NAME's needs?\", survey_id: survey_id)\n    Question.new(content: \"What food does USER_FIRST_NAME regularly need to avoid?\")\n  end\n\nend\n\nclass SurveysController &lt; ApplicationController\n\n  def new\n    @questions = Questions.where(survey_id: 4)\n    survey_user = User.find(user_id)\n    @questions.each do |q|\n      # Use a switch to determine which string to look for and what to sub it with\n      case q.id\n      when 1 \n        q.content = q.content.gsub(.....)\n      when 2\n        q.content = q.content.gsub(.....)\n      when 3\n        q.content = q.content.gsub(.....)\n      when 4\n        q.content = q.content.gsub(.....)\n      end\n    end\n  end\n\nend\n</code></pre>\n\n<p>I'm not positive how your models are set up or what attributes you have, but it's definitely something to go on.</p>\n"}], "owner": {"reputation": 2287, "user_id": 2842709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/30f658c76a63bcb3f40cc305020e6109?s=128&d=identicon&r=PG", "display_name": "MicFin", "link": "https://stackoverflow.com/users/2842709/micfin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 32102732, "answer_count": 3, "score": 2, "last_activity_date": 1440014183, "creation_date": 1440005517, "last_edit_date": 1440014183, "question_id": 32102032, "link": "https://stackoverflow.com/questions/32102032/rails-model-instance-with-dynamic-attribute-value-based-on-relationship", "title": "Rails model instance with dynamic attribute value based on relationship", "body": "<p>My AdminUser creates a survey and the questions that go along with it.  A different User then takes the survey.  A survey will be taken by multiple Users.  Some of the questions in the survey, will need to include an attribute of that User (example: name).  So the AdminUser would create a question like \"What did USER eat?\" but the User who takes the survey will see \"What did Jane eat?\". </p>\n\n<p>Currently, I have a Survey model and a Question model.  I would like the questions in the survey to include the user's name that is taking the survey.  As an example, if the question is \"What do you eat?\" I would like it to say \"What does Jan eat?\"</p>\n\n<p>To temporarily accomplish this I created a method on my Survey model that creates new Questions each time a new survey is created.  This is clogging up my database with ultimately the same questions with just 1 word difference.  It also makes it more difficult to link different users' answers to the same question since each question instance is unique.</p>\n\n<p>Here is my current Survey model</p>\n\n<p><strong>survey.rb</strong></p>\n\n<pre><code>class Survey &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :surveyable, :polymorphic =&gt; true\n  has_many :questions, :dependent =&gt; :destroy\n\n\n  def self.generate_for_user(survey_user)\n      new_survey = Survey.new\n      new_survey.surveyable_id = survey_user.id\n      new_survey.surveyable_type = \"User\"\n      new_survey.user = client\n      new_survey.save\n      Question.new(position: 1, tier: 1, content: \"When did you first become aware of #{survey_user.first_name}'s needs?\", question_type: \"Response\", survey_group: \"User\", survey_group_question_id: 1, choices: \"\", survey_id: new_survey.id).save\n\n      Question.new(position: 2, tier: 1, content: \"What foods does #{survey_user.first_name} regularly need to avoid?\", question_type: \"Response\", survey_group: \"User\", survey_group_question_id: 2, choices: \"\", survey_id: new_survey.id).save\n\n     ... and so on ...\n\nend\n</code></pre>\n\n<p>Here is my current Question model</p>\n\n<pre><code>class Question &lt; ActiveRecord::Base\n  belongs_to :survey\nend\n</code></pre>\n\n<p>As you can see, I really dont think I went about this the right way.  </p>\n\n<p>How can I create Questions that can have a dynamic attribute that is based on one of its relationships?  Is that possible?  </p>\n\n<p>Do I need the attribute to be static with a placeholder and then call a method on the question that inserts the dynamic name into the placeholder when its called?</p>\n\n<p>I would like to be able to call</p>\n\n<pre><code>Question.new(content: \"What does #{survey_user_name} eat?\")\nQuestion.new(content: \"What does #{survey_user_name} wear?\")\n</code></pre>\n\n<p>And I want the #{name} to be replaced with the survey owner.  So the same question can be applied to many different surveys and still use the specific survey owners name.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1440004877, "post_id": 32101722, "comment_id": 52097973, "body": "Seems like there is already a server running. Did you try to reboot your computer?"}, {"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1440005781, "post_id": 32101722, "comment_id": 52098544, "body": "Did you get the same error when you run <code>rails s --binding=127.0.0.1</code>? Also, do try rebooting your machine."}, {"owner": {"reputation": 250, "user_id": 4909361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c537320a14a84539a5e85fab6c7fab1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Kunzig", "link": "https://stackoverflow.com/users/4909361/brian-kunzig"}, "edited": false, "score": 0, "creation_date": 1440005922, "post_id": 32101722, "comment_id": 52098617, "body": "try     rails s -b 0.0.0.0"}, {"owner": {"reputation": 1422, "user_id": 956867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/949376c3e1300e12a5e1fbfb3056ce29?s=128&d=identicon&r=PG", "display_name": "Loqman", "link": "https://stackoverflow.com/users/956867/loqman"}, "edited": false, "score": 0, "creation_date": 1440010090, "post_id": 32101722, "comment_id": 52101073, "body": "Try running <code>cmd</code> As Administrator and then doing <code>rails s</code>"}, {"owner": {"reputation": 25, "user_id": 5243511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d2d50fe925ac2f69d31bd6c7f61a14?s=128&d=identicon&r=PG", "display_name": "Philip Jones", "link": "https://stackoverflow.com/users/5243511/philip-jones"}, "edited": false, "score": 0, "creation_date": 1440343748, "post_id": 32101722, "comment_id": 52223321, "body": "Thank you guys for jumping on my question. I had to re-install Windows 10 and then install Ruby 1.9.3 with the SSL workaround - <a href=\"https://gist.github.com/luislavena/f064211759ee0f806c88\" rel=\"nofollow noreferrer\">gist.github.com/luislavena/f064211759ee0f806c88</a>. Thank you for your help. I am going to install a Linux partition on my desktop soon!!"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 5811421, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9abca66f5f455572968c4c76570ba047?s=128&d=identicon&r=PG", "display_name": "bsquad", "link": "https://stackoverflow.com/users/5811421/bsquad"}, "is_accepted": true, "score": 1, "last_activity_date": 1453219618, "creation_date": 1453219618, "answer_id": 34881499, "question_id": 32101722, "link": "https://stackoverflow.com/questions/32101722/rails-server-does-not-start-windows-10-rails-4-1-8-ruby-2-1/34881499#34881499", "title": "Rails server does not start - Windows 10, Rails 4.1.8, Ruby 2.1", "body": "<p>This is the solution:</p>\n\n<ul>\n<li><p>gem source -r <a href=\"https://rubygems.org/\" rel=\"nofollow\">https://rubygems.org/</a>  </p></li>\n<li><p>gem source -a <a href=\"http://rubygems.org/\" rel=\"nofollow\">http://rubygems.org/</a></p></li>\n<li><p>gem update --system</p></li>\n<li>gem install rails -v 4.2.3 (4.2.5)(if this is done already then ignore this step)</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 5811421, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9abca66f5f455572968c4c76570ba047?s=128&d=identicon&r=PG", "display_name": "bsquad", "link": "https://stackoverflow.com/users/5811421/bsquad"}, "is_accepted": false, "score": 0, "last_activity_date": 1459824534, "creation_date": 1459824534, "answer_id": 36416272, "question_id": 32101722, "link": "https://stackoverflow.com/questions/32101722/rails-server-does-not-start-windows-10-rails-4-1-8-ruby-2-1/36416272#36416272", "title": "Rails server does not start - Windows 10, Rails 4.1.8, Ruby 2.1", "body": "<p>This is the solution:</p>\n\n<p>gem source -r <a href=\"https://rubygems.org/\" rel=\"nofollow\">https://rubygems.org/</a></p>\n\n<p>gem source -a <a href=\"http://rubygems.org/\" rel=\"nofollow\">http://rubygems.org/</a></p>\n"}], "owner": {"reputation": 25, "user_id": 5243511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d2d50fe925ac2f69d31bd6c7f61a14?s=128&d=identicon&r=PG", "display_name": "Philip Jones", "link": "https://stackoverflow.com/users/5243511/philip-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 972, "favorite_count": 1, "accepted_answer_id": 34881499, "answer_count": 2, "score": 1, "last_activity_date": 1459824534, "creation_date": 1440004412, "last_edit_date": 1440004643, "question_id": 32101722, "link": "https://stackoverflow.com/questions/32101722/rails-server-does-not-start-windows-10-rails-4-1-8-ruby-2-1", "title": "Rails server does not start - Windows 10, Rails 4.1.8, Ruby 2.1", "body": "<p>I am running Ruby 2.1.5p273 (2014-11-13 revision 48405) [i386-mingw32]\nRails 4.1.8\nRubyGems 2.2.3</p>\n\n<p>I have done the bundle install and ran the server. Errors.\nI did a rails server --binding=127.0.0.1 and that did not work.\nI have changed the port from 3000 to 9001 and that did not work.\nI have changed and even deleted the PID and that did not work.</p>\n\n<p>All I want to do is run the server.</p>\n\n<p>Any help is greatly appreciated.</p>\n\n<p>Here is the error message:</p>\n\n<pre><code>C:\\Sites\\NOOB&gt;rails s\n=&gt; Booting WEBrick\n=&gt; Rails 4.1.8 application starting in development on http://0.0.0.0:3000\n=&gt; Run `rails server -h` for more startup options\n=&gt; Notice: server is listening on all interfaces (0.0.0.0). Consider using     127.0.0.1 (--binding option)\n=&gt; Ctrl-C to shutdown server\n[2015-08-19 12:06:56] INFO  WEBrick 1.3.1\n[2015-08-19 12:06:56] INFO  ruby 2.1.5 (2014-11-13) [i386-mingw32]\nExiting\nC:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/socket.rb:206:in `bind': Permission denied - bind(2) for 0.0.0.0:3000 (Errno::EACCES)\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/socket.rb:206:in `listen'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/socket.rb:461:in `block in tcp_server_sockets'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/socket.rb:232:in `each'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/socket.rb:232:in `foreach'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/socket.rb:459:in `tcp_server_sockets'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/webrick/utils.rb:75:in `create_listeners'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/webrick/server.rb:132:in `listen'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/webrick/server.rb:113:in `initialize'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/webrick/httpserver.rb:45:in `initialize'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/rack-1.5.5/lib/rack/handler/webrick.rb:11:in `new'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/rack-1.5.5/lib/rack/handler/webrick.rb:11:in `run'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/rack-1.5.5/lib/rack/server.rb:264:in `start'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/railties-4.1.8/lib/rails/commands/server.rb:69:in `start'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/railties-4.1.8/lib/rails/commands/commands_tasks.rb:81:in `block in server'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/railties-4.1.8/lib/rails/commands/commands_tasks.rb:76:in `tap'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/railties-4.1.8/lib/rails/commands/commands_tasks.rb:76:in `server'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/railties-4.1.8/lib/rails/commands/commands_tasks.rb:40:in `run_command!'\nfrom C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/railties-4.1.8/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\nfrom bin/rails:4:in `require'\nfrom bin/rails:4:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "jira", "dashing", "rufus-scheduler"], "comments": [{"owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "edited": false, "score": 0, "creation_date": 1440023139, "post_id": 32101613, "comment_id": 52107800, "body": "You could have a &quot;every 2 hours&quot; schedule and a &quot;every 10 minutes&quot; schedule. Or have a single &quot;every 10 minutes&quot; schedule, that, when some timer is over 2h, resets the timer and performs the &quot;every 2h&quot; job."}, {"owner": {"reputation": 11, "user_id": 2968674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8126cb7fef44af3bbf4e3e6c3ae49c5c?s=128&d=identicon&r=PG&f=1", "display_name": "user2968674", "link": "https://stackoverflow.com/users/2968674/user2968674"}, "reply_to_user": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "edited": false, "score": 0, "creation_date": 1440058343, "post_id": 32101613, "comment_id": 52118882, "body": "I tried two times but couldn&#39;t get it working properly"}, {"owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "edited": false, "score": 0, "creation_date": 1440061219, "post_id": 32101613, "comment_id": 52120618, "body": "If you&#39;d like an answer you&#39;d better rework your question."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2968674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8126cb7fef44af3bbf4e3e6c3ae49c5c?s=128&d=identicon&r=PG&f=1", "display_name": "user2968674", "link": "https://stackoverflow.com/users/2968674/user2968674"}, "edited": false, "score": 0, "creation_date": 1440147672, "post_id": 32128058, "comment_id": 52162860, "body": "I did try this, but couldn&#39;t get it to work. Because I&#39;m parsing through all of the filters each time, I ended up with all of the last updated values being the same for each filter."}], "tags": [], "owner": {"reputation": 41, "user_id": 1524652, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/884d53e611b832b6a28048bf68feaa1a?s=128&d=identicon&r=PG", "display_name": "user1524652", "link": "https://stackoverflow.com/users/1524652/user1524652"}, "is_accepted": false, "score": 1, "last_activity_date": 1440103552, "creation_date": 1440103552, "answer_id": 32128058, "question_id": 32101613, "link": "https://stackoverflow.com/questions/32101613/dashing-rufus-scheduler-updating-two-different-values/32128058#32128058", "title": "dashing rufus scheduler updating two different values", "body": "<p>You could set up two schedulers in your job like this</p>\n\n<pre><code>SCHEDULER.every '10m', :first_in =&gt; 0 do |job|\n  # Your code here\nend\n\nSCHEDULER.every '2h', :first_in =&gt; 0 do |job|\n  # Your code here\nend\n</code></pre>\n\n<p>This way you can seperate your logic for \"last_number_issues\" into its own schedule.</p>\n"}], "owner": {"reputation": 11, "user_id": 2968674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8126cb7fef44af3bbf4e3e6c3ae49c5c?s=128&d=identicon&r=PG&f=1", "display_name": "user2968674", "link": "https://stackoverflow.com/users/2968674/user2968674"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440103552, "creation_date": 1440004006, "question_id": 32101613, "link": "https://stackoverflow.com/questions/32101613/dashing-rufus-scheduler-updating-two-different-values", "title": "dashing rufus scheduler updating two different values", "body": "<p>I'm using dashing to display some information taken from Jira bug tracking system.</p>\n\n<p>Using the plugin: <a href=\"https://gist.github.com/christiangalsterer/1b24f2b42aa39ba63a92\" rel=\"nofollow\">https://gist.github.com/christiangalsterer/1b24f2b42aa39ba63a92</a></p>\n\n<p>I have a ruby script that gets the number of Jira issues based on a filter, for each filter in a list. This then gets pushed to 3 number widgets each displaying a different filter.</p>\n\n<pre><code>require 'jira'\n\nlast_issues = Hash.new(6)\n\nJIRA_FILTERS.each do |filter_data_id, filter|\n    SCHEDULER.every '5s', :first_in =&gt; 0 do |job|\n    last_number_issues = last_issues['filter_data_id']\n    client = JIRA::Client.new(JIRA_OPTIONS)\n    current_number_issues = client.Issue.jql(\"filter in (\\\"#     {filter[:filter]}\\\")\").size\n    last_issues['filter_data_id'] = current_number_issues\n    send_event(filter_data_id, { current: current_number_issues, last: last_issues['filter_data_id']})\n    end\nend\n</code></pre>\n\n<p>The problem I have is that I wish to schedule the part that gets the \"last_number_issues\" every 2 hours, but the rest of it every 10 minutes so I can work out whether the number has gone up or down in that 2 hour time frame.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 564, "user_id": 51386, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1806298f8e8d16ffba4d465689606094?s=128&d=identicon&r=PG", "display_name": "yves", "link": "https://stackoverflow.com/users/51386/yves"}, "edited": false, "score": 0, "creation_date": 1475158588, "post_id": 32101571, "comment_id": 66839893, "body": "using this create doublons:  cp_r will copy all files &quot;flat&quot; in the target directory, and then do a recursive copy for directory listed in files list. So if a file as a path dir/ex.txt it will appear twice in destination: 1) ./ex.txt, 2) ./dir/ex.txt"}], "tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": false, "score": 3, "last_activity_date": 1440018565, "last_edit_date": 1440018565, "creation_date": 1440003892, "answer_id": 32101571, "question_id": 32101358, "link": "https://stackoverflow.com/questions/32101358/copy-all-files-and-folders-except-few-in-ruby/32101571#32101571", "title": "Copy all files and folders except few in Ruby", "body": "<p>Sure but you'd have to implement some kind of filter first like this:</p>\n\n<pre><code>[8] pry(main)&gt; Dir.glob(\"**/*\")\n=&gt; [\"bin\", \"CODE_OF_CONDUCT.md\", \"Gemfile\", \"Gemfile.lock\", \"hello.tar\", \"lib\", \"LICENSE.txt\", \"mygem.gemspec\", \"Rakefile\", \"README.md\", \"spec\"]\n</code></pre>\n\n<p>That gave us all the files in that directory and subsequent directories(thanks ndn for that tip), now let's filter out that <code>hello.tar</code>:</p>\n\n<pre><code>files = Dir.glob(\"**/*\").reject { |file| file.end_with?(\".tar\") }\n</code></pre>\n\n<p>Now we can pass an array into <a href=\"http://ruby-doc.org/stdlib-2.2.2/libdoc/fileutils/rdoc/FileUtils.html#method-c-cp_r\" rel=\"nofollow\"><code>FilteUtils::cp_r</code></a></p>\n\n<pre><code>FileUtils.cp_r(files, destination)\n</code></pre>\n"}], "owner": {"reputation": 935, "user_id": 2095793, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/98ec2ef665b7e86cd22ed73e5c149fbd?s=128&d=identicon&r=PG", "display_name": "itsh", "link": "https://stackoverflow.com/users/2095793/itsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1105, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1440018565, "creation_date": 1440003177, "question_id": 32101358, "link": "https://stackoverflow.com/questions/32101358/copy-all-files-and-folders-except-few-in-ruby", "title": "Copy all files and folders except few in Ruby", "body": "<p>I was wondering if I can use <code>FileUtils.cp_r</code> method to copy all the files and directories from source to target except <code>.tar</code> files.\nCan someone give me an example for better understanding?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "barcode", "require"], "comments": [{"owner": {"reputation": 1063, "user_id": 823878, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/39b534691270c7ba0f05cb7481e13d38?s=128&d=identicon&r=PG&f=1", "display_name": "Oakland510", "link": "https://stackoverflow.com/users/823878/oakland510"}, "edited": false, "score": 0, "creation_date": 1440006742, "post_id": 32101310, "comment_id": 52099041, "body": "Omar Lahlou is right. You can remove the require lines. Have you run &quot;bundle install&quot; after adding the gem to your gem file. If you run &quot;bundle&quot; you should see &quot;barby&quot; listed."}], "answers": [{"tags": [], "owner": {"reputation": 970, "user_id": 4084065, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/290a14bddde956ae20395f460e3f691f?s=128&d=identicon&r=PG", "display_name": "Omar Lahlou", "link": "https://stackoverflow.com/users/4084065/omar-lahlou"}, "is_accepted": true, "score": 5, "last_activity_date": 1440007974, "last_edit_date": 1440007974, "creation_date": 1440003591, "answer_id": 32101481, "question_id": 32101310, "link": "https://stackoverflow.com/questions/32101310/require-barby-not-working-cannot-load-such-file-barby/32101481#32101481", "title": "Require &#39;barby&#39; not working. - cannot load such file -- barby", "body": "<p>You only add <code>require</code> when you are dealing with a <code>ruby</code> project. In your case(<code>ruby-on-rails</code>), you can remove those lines.</p>\n\n<p>Also, keep in mind that you should add your <code>gem</code>s into your <code>Gemfile</code></p>\n"}, {"tags": [], "owner": {"reputation": 3514, "user_id": 1794802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9404788dd9ecd74e3070ec684adbf439?s=128&d=identicon&r=PG", "display_name": "strongjz", "link": "https://stackoverflow.com/users/1794802/strongjz"}, "is_accepted": false, "score": 0, "last_activity_date": 1440007373, "creation_date": 1440007373, "answer_id": 32102544, "question_id": 32101310, "link": "https://stackoverflow.com/questions/32101310/require-barby-not-working-cannot-load-such-file-barby/32102544#32102544", "title": "Require &#39;barby&#39; not working. - cannot load such file -- barby", "body": "<p>bundle install? It sounds like you do not have the gem installed when ruby tries to load it, it can not find it. Gem list will list out the installed gems on the system, or bundle exec gem list. </p>\n\n<pre><code>gem list\n</code></pre>\n"}], "owner": {"reputation": 834, "user_id": 3613495, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f800e450ad24344c5a7e4cd848acba2c?s=128&d=identicon&r=PG&f=1", "display_name": "Padagomez", "link": "https://stackoverflow.com/users/3613495/padagomez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 0, "accepted_answer_id": 32101481, "answer_count": 2, "score": 1, "last_activity_date": 1440007974, "creation_date": 1440002989, "last_edit_date": 1440003382, "question_id": 32101310, "link": "https://stackoverflow.com/questions/32101310/require-barby-not-working-cannot-load-such-file-barby", "title": "Require &#39;barby&#39; not working. - cannot load such file -- barby", "body": "<p>I'm trying to use the <code>barby</code> <code>gem</code> that I installed, but when I do it gives me this error.</p>\n\n<pre><code>LoadError cannot load such file -- barby\n</code></pre>\n\n<p>Here's the require methods in my controller.</p>\n\n<pre><code>    require 'barby'\n    require 'barby/barcode/ean_13'\n    require 'barby/outputter/ascii_outputter'\n    require 'barby/outputter/html_outputter'\n\n    class PalletsController &lt; ApplicationController\n    -snip-\n    end\n</code></pre>\n\n<p>Here's the gem in my gemfile. </p>\n\n<pre><code>gem 'barby'\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["ruby", "json"], "comments": [{"owner": {"reputation": 983, "user_id": 2407413, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a0127be1eaeb8927c1bcba11cd9641f9?s=128&d=identicon&r=PG", "display_name": "akalikin", "link": "https://stackoverflow.com/users/2407413/akalikin"}, "edited": false, "score": 4, "creation_date": 1440000979, "post_id": 32100703, "comment_id": 52095818, "body": "Have you at least tried the last bit of your question?"}, {"owner": {"reputation": 2359, "user_id": 405454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/IDzwW.png?s=128&g=1", "display_name": "mhutter", "link": "https://stackoverflow.com/users/405454/mhutter"}, "edited": false, "score": 1, "creation_date": 1440003042, "post_id": 32100703, "comment_id": 52096992, "body": "Author, did you even bother googling &quot;ruby json&quot;? Or testing the code you provided? Go read <a href=\"http://devdocs.io/ruby/json\" rel=\"nofollow noreferrer\">devdocs.io/ruby/json</a> - If this doesn&#39;t answer all your questions I&#39;ll gladly help or provide examples."}], "owner": {"reputation": 7877, "user_id": 1401560, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/347d89519bdf28150424b22543d0fbdb?s=128&d=identicon&r=PG", "display_name": "Chris F", "link": "https://stackoverflow.com/users/1401560/chris-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 782, "favorite_count": 0, "closed_date": 1440171850, "answer_count": 0, "score": 0, "last_activity_date": 1440000767, "creation_date": 1440000767, "question_id": 32100703, "link": "https://stackoverflow.com/questions/32100703/how-can-i-update-a-json-file-in-ruby", "closed_reason": "Duplicate", "title": "How can I update a json file in ruby?", "body": "<p>I want to do this in ruby.</p>\n\n<p>Say I have an example.json file that looks like</p>\n\n<pre><code>{\n   \"name\" : \"My name is - \"\n}\n</code></pre>\n\n<p>and I want to update that to</p>\n\n<pre><code>{\n   \"name\" : \"My name is - Chris\"\n}\n</code></pre>\n\n<p>I know to do this</p>\n\n<pre><code>require 'json'\njson = JSON.parse('example.json')\nname = json['name'] + ' Chris'\n</code></pre>\n\n<p>Now how I write name back into example.json file and save the file, simply like this?</p>\n\n<pre><code>json['name'] = name\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1440000940, "post_id": 32100273, "comment_id": 52095797, "body": "Can&#39;t you use <code>@foo.errors.add(:foo_name, &#39;error message&#39;)</code>? And then extract the errors not matching your attributes&#39; names <code>foo_nm</code>, etc?"}, {"owner": {"reputation": 2475, "user_id": 523585, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NtF1o.jpg?s=128&g=1", "display_name": "Raghu", "link": "https://stackoverflow.com/users/523585/raghu"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1440001117, "post_id": 32100273, "comment_id": 52095889, "body": "@MrYoshiji I am using validates :foo_nm , presence: true and according to you will have to rewrite the validates just to add the foo_name in the error hash . That is something that i dont want to do bcoz i have 10 other models like foo where I need _nm to be _name. so i will have to change it everywhere"}], "answers": [{"comments": [{"owner": {"reputation": 2475, "user_id": 523585, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NtF1o.jpg?s=128&g=1", "display_name": "Raghu", "link": "https://stackoverflow.com/users/523585/raghu"}, "edited": false, "score": 0, "creation_date": 1440006470, "post_id": 32101639, "comment_id": 52098906, "body": "This is one of the first thing i tried and it seems like locale translations are taken into account only when you do foo.errors.full_messages and not on foo.errors ."}], "tags": [], "owner": {"reputation": 14364, "user_id": 1023609, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14cd00b085c207261db49ac46be4773c?s=128&d=identicon&r=PG", "display_name": "MurifoX", "link": "https://stackoverflow.com/users/1023609/murifox"}, "is_accepted": false, "score": 0, "last_activity_date": 1440004102, "creation_date": 1440004102, "answer_id": 32101639, "question_id": 32100273, "link": "https://stackoverflow.com/questions/32100273/updating-the-attributes-in-the-rails-errors/32101639#32101639", "title": "Updating the attributes in the rails errors", "body": "<p>Can't you do it inside your locale files?  </p>\n\n<pre><code># config/locales/en.yml\nen:\n  hello: \"Hello world\"\n  activerecord:\n    models:\n      foo: \"Foo\"\n    attributes:\n      foo_nm: \"foo_name\"\n</code></pre>\n"}], "owner": {"reputation": 2475, "user_id": 523585, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NtF1o.jpg?s=128&g=1", "display_name": "Raghu", "link": "https://stackoverflow.com/users/523585/raghu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1440004102, "creation_date": 1439999481, "last_edit_date": 1439999745, "question_id": 32100273, "link": "https://stackoverflow.com/questions/32100273/updating-the-attributes-in-the-rails-errors", "title": "Updating the attributes in the rails errors", "body": "<p>I am looking to update the model errors hash that the rails sent with humanized attributes name. For example for a model called <code>Foo</code> . I have an attribute called <code>foo_nm</code> . I want the translated to foo_name when I do <code>@foo.errors</code> assuming that <code>@foo</code> is an object of class Foo.</p>\n\n<pre><code>{\"foo_nm\"=&gt;[\"can't be blank\"]}\n</code></pre>\n\n<p>So far I tried to extend the human_attribute_name the following way </p>\n\n<pre><code>   HUMANIZED_ATTRIBUTES = {\n    :foo_nm =&gt; \"foo_name\"\n  }\n\n  def self.human_attribute_name(attr, options={})\n    HUMANIZED_ATTRIBUTES[attr.to_sym] || super\n  end\n</code></pre>\n\n<p>But this doesnt seem to modify the errors hash. Any ideas around on how I can update the errors hash would be appreciated</p>\n"}, {"tags": ["arrays", "ruby", "haml"], "comments": [{"owner": {"reputation": 21, "user_id": 5241878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd56af16be00074628055e61362cd30?s=128&d=identicon&r=PG&f=1", "display_name": "vanga", "link": "https://stackoverflow.com/users/5241878/vanga"}, "reply_to_user": {"reputation": 7671, "user_id": 2686013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kqJWO.jpg?s=128&g=1", "display_name": "HaveNoDisplayName", "link": "https://stackoverflow.com/users/2686013/havenodisplayname"}, "edited": false, "score": 0, "creation_date": 1439999986, "post_id": 32100223, "comment_id": 52095301, "body": "Tried and doesn&#39;t work for the array. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "is_accepted": false, "score": 0, "last_activity_date": 1440000264, "last_edit_date": 1440000264, "creation_date": 1439999811, "answer_id": 32100407, "question_id": 32100223, "link": "https://stackoverflow.com/questions/32100223/removing-letters-from-a-string-and-only-retaining-numbers/32100407#32100407", "title": "Removing letters from a string and only retaining numbers", "body": "<p>Use:</p>\n\n<pre><code>array = [\"23 mm\", \"34 mm\", \"56 mm\"] \narray.select {|a| a[/\\d+/]}.map(&amp;:to_i)\n# &gt; [23, 34, 56]\n\narray = [\"25 km/s m\", \"32 km/s m\", \"12 km/s m\"]\narray.select {|a| a[/\\d+/]}.map(&amp;:to_i)\n# &gt; [25, 32, 12]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2009, "user_id": 20769, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/922e7e3c612566756735b2def78827d8?s=128&d=identicon&r=PG", "display_name": "Joshua", "link": "https://stackoverflow.com/users/20769/joshua"}, "is_accepted": false, "score": 1, "last_activity_date": 1440011450, "creation_date": 1440011450, "answer_id": 32103744, "question_id": 32100223, "link": "https://stackoverflow.com/questions/32100223/removing-letters-from-a-string-and-only-retaining-numbers/32103744#32103744", "title": "Removing letters from a string and only retaining numbers", "body": "<p>to_i ignores everything after numbers so you can do the following.</p>\n\n<pre><code>array = ['23 mm', '34 mm', '56 mm'] \narray.map(&amp;:to_i)\n# [23, 34, 56] \n\narray = ['25 km/s m', '32 km/s m', '12 km/s m']\narray.map(&amp;:to_i)\n# [25, 32, 12] \n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5241878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd56af16be00074628055e61362cd30?s=128&d=identicon&r=PG&f=1", "display_name": "vanga", "link": "https://stackoverflow.com/users/5241878/vanga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1440011450, "creation_date": 1439999317, "last_edit_date": 1440001216, "question_id": 32100223, "link": "https://stackoverflow.com/questions/32100223/removing-letters-from-a-string-and-only-retaining-numbers", "title": "Removing letters from a string and only retaining numbers", "body": "<p>I have an array <code>arr</code> in HAML, which is inside a loop.</p>\n\n<pre><code>- item.each do |grp, arr = []|\n  - grp.section.each {|abc| arr.push(abc.values_with_units) }\n</code></pre>\n\n<p>For each iteration, the values and the units of them change. It might be <code>[\"23 mm\", \"34 mm\", \"56 mm\"]</code> and in the next iteration it might be <code>[\"25 km/s m\", \"32 km/s m\", \"12 km/s m\"]</code>. I want to get rid of the units and retain only the values: in case 1 <code>[23,34,56]</code>, and in case 2 <code>[25, 32, 12]</code>.</p>\n\n<p>How can I achieve this in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "avatar"], "comments": [{"owner": {"reputation": 5434, "user_id": 974389, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f0ebd5b49987227c5a7a8830011e744?s=128&d=identicon&r=PG", "display_name": "Liyali", "link": "https://stackoverflow.com/users/974389/liyali"}, "edited": false, "score": 0, "creation_date": 1440002161, "post_id": 32100211, "comment_id": 52096510, "body": "Maybe you should copy some code from your controller too?"}, {"owner": {"reputation": 163, "user_id": 4203814, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-NmsXU-R8K-I/AAAAAAAAAAI/AAAAAAAAADM/GQgTUr9mChg/photo.jpg?sz=128", "display_name": "Steven Ossorio", "link": "https://stackoverflow.com/users/4203814/steven-ossorio"}, "reply_to_user": {"reputation": 5434, "user_id": 974389, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f0ebd5b49987227c5a7a8830011e744?s=128&d=identicon&r=PG", "display_name": "Liyali", "link": "https://stackoverflow.com/users/974389/liyali"}, "edited": false, "score": 0, "creation_date": 1440003673, "post_id": 32100211, "comment_id": 52097335, "body": "@Liyali I&#39;ve added my user controller as well."}], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 4203814, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-NmsXU-R8K-I/AAAAAAAAAAI/AAAAAAAAADM/GQgTUr9mChg/photo.jpg?sz=128", "display_name": "Steven Ossorio", "link": "https://stackoverflow.com/users/4203814/steven-ossorio"}, "edited": false, "score": 0, "creation_date": 1440092809, "post_id": 32101561, "comment_id": 52141558, "body": "Thank you for your explanation. I&#39;ll be reformatting the way my tables look in order to hopefully avoid a bigger problem for the future. First time hearing about &quot;Code Smell&quot;. Thanks for that and I have a final question. Should I also make a model such as user_profiles in order to put a user profile information there or keep it together with the user model? Thanks again for your explanation."}, {"owner": {"reputation": 3768, "user_id": 449342, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dcfde00ac1fae8b575b2f9b39c7e244b?s=128&d=identicon&r=PG", "display_name": "Michael De Silva", "link": "https://stackoverflow.com/users/449342/michael-de-silva"}, "reply_to_user": {"reputation": 163, "user_id": 4203814, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-NmsXU-R8K-I/AAAAAAAAAAI/AAAAAAAAADM/GQgTUr9mChg/photo.jpg?sz=128", "display_name": "Steven Ossorio", "link": "https://stackoverflow.com/users/4203814/steven-ossorio"}, "edited": false, "score": 0, "creation_date": 1443122399, "post_id": 32101561, "comment_id": 53377593, "body": "Chances are, a user will have a single profile (but potentially multiple avatar images? Depends on your use case) and a single avatar, which could be part of their profile.  Good case for User <code>has_one</code> :profile.  It doesn&#39;t hurt to keep these separate from the User itself."}], "tags": [], "owner": {"reputation": 3768, "user_id": 449342, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dcfde00ac1fae8b575b2f9b39c7e244b?s=128&d=identicon&r=PG", "display_name": "Michael De Silva", "link": "https://stackoverflow.com/users/449342/michael-de-silva"}, "is_accepted": true, "score": 1, "last_activity_date": 1440004611, "last_edit_date": 1440004611, "creation_date": 1440003850, "answer_id": 32101561, "question_id": 32100211, "link": "https://stackoverflow.com/questions/32100211/when-i-update-my-avatar-picture-it-changes-all-users-picture/32101561#32101561", "title": "When I update my Avatar picture, it changes all users picture", "body": "<p>Your approach has a <a href=\"https://en.wikipedia.org/wiki/Code_smell\" rel=\"nofollow\">pungent code smell</a>; I do not see any reason for your <code>User</code> model to have a <code>t.integer  \"user_id\"</code> column, especially when you've set the asset directly on the user model.  This is also a poor, and brittle, approach as you've lumped images with the <code>User</code>.</p>\n\n<p>When building a feature like this, it's good to attempt normalising your domain model, and one approach would be to have two tables - <code>users</code> and <code>user_avatars</code>. This way, the <code>user_avatars</code> table can have a <code>user_id</code> column to be used as a foreign key.  a <code>User</code> instance with <code>has_one :avatar_image, class_name: \"::UserAvatar\"</code> and <code>UserAvatar</code> will <code>belong_to :user</code>.</p>\n\n<p>This will allow your <code>user</code> instance (i.e. where <code>user = User.new</code>; I'm simply showing that it's an instance of the <code>User</code> klass) to be able to call <code>user.avatar_image</code>; and if you had a <code>has_attached_file :avatar</code> declaration on the <code>UserAvatar</code>, you'll be able to fetch that via <code>user.avatar_image.avatar.url(:thumb)</code></p>\n"}], "owner": {"reputation": 163, "user_id": 4203814, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-NmsXU-R8K-I/AAAAAAAAAAI/AAAAAAAAADM/GQgTUr9mChg/photo.jpg?sz=128", "display_name": "Steven Ossorio", "link": "https://stackoverflow.com/users/4203814/steven-ossorio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 32101561, "answer_count": 1, "score": 0, "last_activity_date": 1440004611, "creation_date": 1439999277, "last_edit_date": 1440003632, "question_id": 32100211, "link": "https://stackoverflow.com/questions/32100211/when-i-update-my-avatar-picture-it-changes-all-users-picture", "title": "When I update my Avatar picture, it changes all users picture", "body": "<p>I seem to be making an error in my code. I've been looking at two of my past projects and in one I have a pictures table to associate a picture_id with a user but on a different project it wasn't even required and I forgot how I did it. Any advice in my code for improvement and reason of error will be appreciated, Thank you in advance. </p>\n\n<p><strong>Schema</strong> </p>\n\n<pre><code>create_table \"users\", force: true do |t|\n    t.string   \"first_name\"\n    t.string   \"last_name\"\n    t.string   \"email\"\n    t.string   \"password_digest\"\n    t.string   \"user_name\"\n    t.date     \"birthdate\"\n    t.integer  \"zip_code\"\n    t.string   \"gender\"\n    t.datetime \"created_at\"\n    t.datetime \"updated_at\"\n    t.string   \"avatar_file_name\"\n    t.string   \"avatar_content_type\"\n    t.integer  \"avatar_file_size\"\n    t.datetime \"avatar_updated_at\"\n    t.integer  \"user_id\"\n    t.integer  \"profile_id\"\n    t.string   \"background_file_name\"\n    t.string   \"background_content_type\"\n    t.integer  \"background_file_size\"\n    t.datetime \"background_updated_at\"\n    t.string   \"slug\"\n  end\n</code></pre>\n\n<p><strong>User/show</strong></p>\n\n<pre><code>&lt;div id=\"profile_to\"&gt;\n &lt;div class=\"profile_background_picture\"&gt;\n  &lt;%= image_tag current_user.background.url(:medium) %&gt;\n &lt;/div&gt;\n &lt;div class=\"profile_picture\"&gt;\n  &lt;%= image_tag current_user.avatar.url(:medium) %&gt;\n &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>User/index</strong></p>\n\n<pre><code>&lt;% if current_user %&gt;\n &lt;div id=\"login_top\"&gt;\n  &lt;a href=\"/\"&gt;&lt;p class=\"logo\"&gt;Trend&lt;/p&gt;&lt;/a&gt;\n  &lt;nav&gt;\n   &lt;div class=\"loginout\"&gt;\n    &lt;%= link_to (\"LOGOUT\"), \"/sessions/new\",method: :delete %&gt;\n   &lt;/div&gt;\n   &lt;div class=\"user-links\"&gt;\n    &lt;a href=\"/users/&lt;%= current_user.id %&gt;\"&gt;\n     &lt;% if current_user.user_name.present? %&gt;\n      &lt;%= link_to current_user.user_name, user_path(current_user) %&gt;\n     &lt;% else %&gt;\n      &lt;%= current_user.first_name %&gt;\n     &lt;% end %&gt;\n    &lt;/a&gt;\n    &amp;nbsp;&lt;b class=\"size\"&gt;|&lt;/b&gt;&amp;nbsp;\n    &lt;a href=\"\"&gt;Settings&lt;/a&gt;\n    &amp;nbsp;&lt;b class=\"size\"&gt;|&lt;/b&gt;&amp;nbsp;\n   &lt;/div&gt;\n   &lt;% if current_user.avatar.present? %&gt;\n    &lt;div class=\"circular\"&gt;\n     &lt;%= image_tag current_user.avatar.url(:medium) %&gt;\n    &lt;/div&gt;\n   &lt;% else %&gt;     \n   &lt;% end %&gt;\n  &lt;/nav&gt;\n &lt;/div&gt; \n&lt;% end %&gt;\n\n&lt;%= form_for current_user, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n  &lt;p class=\"editpage\"&gt;Profile Picture: &lt;%= f.file_field :avatar %&gt;&lt;/p&gt;\n  &lt;%= f.submit \"Upload\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>User Model</strong></p>\n\n<pre><code>has_attached_file :avatar, :styles =&gt; {\n :medium =&gt; \"200x200&gt;\",\n :small =&gt; \"120x120#\",\n :thumb =&gt; \"75x75#\",\n :default_url =&gt; \"http://www.adtechnology.co.uk/images/UGM-default-user.png\"\n}\n\nvalidates_attachment_content_type :avatar, :content_type =&gt; /\\Aimage\\/.*\\Z/\n\nhas_attached_file :background, :styles =&gt; {\n :medium =&gt; \"200x200&gt;\",\n :small =&gt; \"120x120#\",\n :thumb =&gt; \"75x75#\",\n :default_url =&gt; \"http://www.adtechnology.co.uk/images/UGM-default-user.png\"\n}\n\nvalidates_attachment_content_type :background, :content_type =&gt; /\\Aimage\\/.*\\Z/\n</code></pre>\n\n<p>For further information, please feel free to ask. Again, thank you for all your help and explanation to my error. </p>\n\n<p><strong>User Controller</strong></p>\n\n<pre><code>def index\n @user = User.new\n @users = User.all\nend\n\ndef create\n@user = User.new(user_params)\n if @user.save\n  session[:user_id] = @user.id\n  cookies[:user_id] = @user.id\n  flash[:notice] = \"Successfully Registerd\"\n  redirect_to \"/\"\n else\n  flash[:alert] = @user.errors.full_messages\n  redirect_to \"/\"\n end\nend\n\ndef new\n @user = User.new\nend\n\ndef edit\n @user = User.friendly.find(params[:id])\n current_user\nend\n\ndef show\n @user = User.friendly.find(params[:id])\n current_user\nend\n\ndef update\n @user = User.friendly.find(params[:id])\n  if @user.update(user_params)\n   flash[:notice] = \"You have successfully update your information\"\n   redirect_to \"/\"\n end\nend\n\ndef destroy\n @user = User.friendly.find(params[:id])\n @user.destroy\nend\n\nprivate\n\ndef user_params\n params.require(:user).permit(:background, :username_or_email, :first_name,  :last_name, :email, :password, :password_confirmation, :user_name, :female, :male, :avatar, :gender, :zip_code, :birthdate)\nend\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1439999417, "post_id": 32100151, "comment_id": 52094868, "body": "why you can&#39;t? You can"}, {"owner": {"reputation": 1895, "user_id": 2576839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ShO0a.jpg?s=128&g=1", "display_name": "GhostRider", "link": "https://stackoverflow.com/users/2576839/ghostrider"}, "reply_to_user": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1439999469, "post_id": 32100151, "comment_id": 52094904, "body": "I get: undefined method `downcase&#39; for nil:NilClass"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1439999525, "post_id": 32100151, "comment_id": 52094944, "body": "so one of your &#39;iso&#39; is empty. try this <code>User.all.group_by(&amp;:iso).map{|k,v| [k, v.count, k.try(:downcase)]}</code>"}, {"owner": {"reputation": 1895, "user_id": 2576839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ShO0a.jpg?s=128&g=1", "display_name": "GhostRider", "link": "https://stackoverflow.com/users/2576839/ghostrider"}, "reply_to_user": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1439999566, "post_id": 32100151, "comment_id": 52094974, "body": "With your code I get:                                                                     undefined local variable or method `downcase&#39; for #&lt;UsersController:0x007fdab38110b0&gt;"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1439999720, "post_id": 32100151, "comment_id": 52095093, "body": "what will return <code>k.to_s.downcase</code>?"}, {"owner": {"reputation": 1895, "user_id": 2576839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ShO0a.jpg?s=128&g=1", "display_name": "GhostRider", "link": "https://stackoverflow.com/users/2576839/ghostrider"}, "reply_to_user": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1439999812, "post_id": 32100151, "comment_id": 52095169, "body": "Yep, that works.....make it an answer!"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1439999922, "post_id": 32100151, "comment_id": 52095255, "body": "Actually it is wrong behavior. You should check your code for a fat bug."}, {"owner": {"reputation": 1895, "user_id": 2576839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ShO0a.jpg?s=128&g=1", "display_name": "GhostRider", "link": "https://stackoverflow.com/users/2576839/ghostrider"}, "reply_to_user": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1439999981, "post_id": 32100151, "comment_id": 52095296, "body": "Please explain (many thanks)"}], "answers": [{"tags": [], "owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "is_accepted": false, "score": 1, "last_activity_date": 1440000390, "creation_date": 1440000390, "answer_id": 32100606, "question_id": 32100151, "link": "https://stackoverflow.com/questions/32100151/ruby-adding-a-new-element-to-each-array-in-an-array-such-that-the-new-element/32100606#32100606", "title": "Ruby: adding a new element to each array in an array, such that the new element is the downcased version of an existing element", "body": "<p>Your code</p>\n\n<pre><code>@users = User.all.group_by(&amp;:iso).map{ |k,v| [k, v.count] }\n</code></pre>\n\n<p>is absolutely valid and its output shows us that you have got only three iso groups. Then</p>\n\n<pre><code>@users = User.all.group_by(&amp;:iso).map{ |k,v| [k, v.count, k.downcase] }\n</code></pre>\n\n<p>is absolutely valid code as well. But you get an error <code>undefined method 'downcase' for nil:NilClass</code> which tells us that one of iso values is <code>nil</code>. Which is not true from your first example output.</p>\n\n<p>After that, your third snippet</p>\n\n<pre><code>User.all.group_by(&amp;:iso).map{ |k,v| [k, v.count, k.inspect.downcase] }\n</code></pre>\n\n<p>which is again correct, returns the same output as first one (I mean same sample of iso).</p>\n\n<p>So somewhere in your code is bug. I believe it is close to provided piece of code. You could show whole controller's code to see maybe the problem is on the surface.</p>\n"}], "owner": {"reputation": 1895, "user_id": 2576839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ShO0a.jpg?s=128&g=1", "display_name": "GhostRider", "link": "https://stackoverflow.com/users/2576839/ghostrider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440001058, "creation_date": 1439999108, "last_edit_date": 1440001058, "question_id": 32100151, "link": "https://stackoverflow.com/questions/32100151/ruby-adding-a-new-element-to-each-array-in-an-array-such-that-the-new-element", "title": "Ruby: adding a new element to each array in an array, such that the new element is the downcased version of an existing element", "body": "<p>if </p>\n\n<pre><code>@users = User.all.group_by(&amp;:iso).map{|k,v| [k, v.count]}\n</code></pre>\n\n<p>returns</p>\n\n<pre><code> [[\"GB\", 1], [\"GI\", 3], [\"BD\", 1]]\n</code></pre>\n\n<p>Why can't I do this</p>\n\n<pre><code> @users = User.all.group_by(&amp;:iso).map{|k,v| [k, v.count, k.downcase]}\n</code></pre>\n\n<p>to get </p>\n\n<pre><code>[[\"GB\", 1, \"gb\"], [\"GI\", 3, \"gi\"], [\"BD\", 1, \"bd\"]]\n</code></pre>\n\n<p>I am getting the error</p>\n\n<pre><code>      undefined method `downcase' for nil:NilClass\n</code></pre>\n\n<p>How do I get this. </p>\n\n<p>If I do </p>\n\n<pre><code>   @user_json = User.all.group_by(&amp;:iso).map{|k,v| [k, v.count, k.inspect]}\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>   [[\"GB\", 1, \"\\\"GB\\\"\"], [\"GI\", 3, \"\\\"GI\\\"\"], [\"BD\", 1, \"\\\"BD\\\"\"]\n</code></pre>\n\n<p>and then </p>\n\n<pre><code>  @user_json = User.all.group_by(&amp;:iso).map{|k,v| [k, v.count, k.inspect.downcase]}\n\n [[\"GB\", 1, \"\\\"gb\\\"\"], [\"GI\", 3, \"\\\"gi\\\"\"], [\"BD\", 1, \"\\\"bd\\\"\"]\n</code></pre>\n\n<p>V. confused</p>\n\n<p>FOR MORE DETAILS - THIS WORKS (but if it is wrong and can't explain why)</p>\n\n<p>I am trying to build a JSON array with the structure:</p>\n\n<pre><code>   [{\"code\":\"GB\",\"value\":1,\"flag\":\"gb\"},{\"code\":\"GI\",\"value\":3,\"flag\":\"gi\"},{\"code\":\"BD\",\"value\":1,\"flag\":\"bd\"}]\n</code></pre>\n\n<p>My controller code</p>\n\n<pre><code>     def global_chart\n          @user_json = User.all.group_by(&amp;:iso).map{|k,v| [k, v.count, k.to_s.downcase]}.map {|c, v | [\"code\" =&gt; c, \"value\" =&gt; v, \"flag\" =&gt; c.to_s.downcase]}.flatten.to_json\n          render 'users/charts/global'\n    end\n</code></pre>\n\n<p>This works ( the @user_json variable has the right structure) however I can't explain the behaviour above....</p>\n"}, {"tags": ["ruby", "geojson", "geohashing"], "comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1440011486, "post_id": 32099850, "comment_id": 52101894, "body": "<a href=\"https://github.com/davetroy/geohash\" rel=\"nofollow noreferrer\">github.com/davetroy/geohash</a> may help.  I just did a google for <code>ruby geohash</code>"}, {"owner": {"reputation": 3051, "user_id": 1872168, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/19cb4aef41aff57068dc4510f1c0bfb6?s=128&d=identicon&r=PG", "display_name": "Crystark", "link": "https://stackoverflow.com/users/1872168/crystark"}, "reply_to_user": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1440056672, "post_id": 32099850, "comment_id": 52117910, "body": "Yeah I got that one but it doesn&#39;t allow to transform anything other than a single point."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3292534"}, "edited": false, "score": 3, "creation_date": 1480596508, "post_id": 32099850, "comment_id": 69034299, "body": "Hi, same question here. Ever found anything?"}, {"owner": {"reputation": 3051, "user_id": 1872168, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/19cb4aef41aff57068dc4510f1c0bfb6?s=128&d=identicon&r=PG", "display_name": "Crystark", "link": "https://stackoverflow.com/users/1872168/crystark"}, "edited": false, "score": 1, "creation_date": 1480927928, "post_id": 32099850, "comment_id": 69149650, "body": "@kaboom For now I&#39;m calling the geohash-poly as a microservice from my rails app."}], "owner": {"reputation": 3051, "user_id": 1872168, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/19cb4aef41aff57068dc4510f1c0bfb6?s=128&d=identicon&r=PG", "display_name": "Crystark", "link": "https://stackoverflow.com/users/1872168/crystark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1769, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1439998688, "creation_date": 1439998272, "last_edit_date": 1439998688, "question_id": 32099850, "link": "https://stackoverflow.com/questions/32099850/how-to-convert-a-geojson-polygon-to-a-list-of-geohashes-of-a-given-precision-in", "title": "How to convert a GeoJSON polygon to a list of Geohashes of a given precision in ruby?", "body": "<p>I'm currently working with combinations of geopoint + radius that I've successfully transformed to a GeoJSON polygon (loosing a bit of precision).\nWhat I need now is a conversion to a list of all Geohashes that intersects with that area with a predetermined precision.</p>\n\n<p>I've found <a href=\"https://github.com/derrickpelletier/geohash-poly\" rel=\"nofollow\">geohash-poly</a> which does exactly what I want but it's in javascript/node-js rather than ruby.</p>\n\n<p>Is there any equivalent in ruby out there ?\nThanks</p>\n"}, {"tags": ["ruby", "class", "module", "extend"], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1440007094, "post_id": 32100042, "comment_id": 52099213, "body": "This won&#39;t work either, since now it is still an instance method of <code>EanControl::Fixnum</code>, not <code>::Fixnum</code>."}], "tags": [], "owner": {"reputation": 1829, "user_id": 1442966, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2347a5fea07665538a73887817f30b85?s=128&d=identicon&r=PG", "display_name": "Edward", "link": "https://stackoverflow.com/users/1442966/edward"}, "is_accepted": false, "score": 1, "last_activity_date": 1439998818, "creation_date": 1439998818, "answer_id": 32100042, "question_id": 32099839, "link": "https://stackoverflow.com/questions/32099839/why-cant-i-extend-the-fixnum-class-in-a-module-and-use-it/32100042#32100042", "title": "Why can&#39;t I extend the Fixnum class in a module and use it?", "body": "<p>In your extension, you have defined <code>roundup</code> as a <strong>class</strong> method while <code>12</code> is an <strong>instance</strong>.</p>\n\n<p>Try:</p>\n\n<pre><code>module EanControl\n  # Extend Fixnum with #roundup\n  class Fixnum\n    def roundup\n      return self if self % 10 == 0   # already a factor of 10\n      return self + 10 - (self % 10)  # go to nearest factor 10\n    end\n  end\n\n  # More code...\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2049, "user_id": 2246700, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/63ae5300336319b5b03e0008130b27b6?s=128&d=identicon&r=PG&f=1", "display_name": "narzero", "link": "https://stackoverflow.com/users/2246700/narzero"}, "edited": false, "score": 1, "creation_date": 1440006910, "post_id": 32102185, "comment_id": 52099130, "body": "Thank you for the fantastic anwser."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 12, "last_activity_date": 1440007156, "last_edit_date": 1440007156, "creation_date": 1440006203, "answer_id": 32102185, "question_id": 32099839, "link": "https://stackoverflow.com/questions/32099839/why-cant-i-extend-the-fixnum-class-in-a-module-and-use-it/32102185#32102185", "title": "Why can&#39;t I extend the Fixnum class in a module and use it?", "body": "<p>There are three problems with your code:</p>\n\n<ol>\n<li><p>You are creating a <em>new</em> class <code>EanControl::Fixnum</code>, but you actually want to change the <em>existing</em> builtin <code>::Fixnum</code>. Solution: explicitly start the constant lookup from the top-level, or, more idiomatically, just drop the module.</p>\n\n<pre><code>module EanControl\n  class ::Fixnum\n    # \u2026\n  end\nend\n\n# although it would be much simpler to just do this:\n\nclass Fixnum\n  # \u2026\nend\n</code></pre></li>\n<li><p>You define <code>roundup</code> as a singleton method of the object <code>Fixnum</code>, but you call it as an instance method of instances of <code>Fixnum</code>. Solution: make <code>roundup</code> an instance method:</p>\n\n<pre><code>class Fixnum\n  def roundup\n    return self if (self % 10).zero? # already a factor of 10\n    self + 10 - (self % 10)          # go to nearest factor 10\n  end\nend\n</code></pre></li>\n<li><p>The Ruby Language Specification does not actually guarantee that there even <em>is</em> a <code>Fixnum</code> class. It only guarantees that there is an <code>Integer</code> class, and it allows that different implementations may provide implementation-specific subclasses. (E.g. YARV has <code>Fixnum</code> and <code>Bignum</code> subclasses of <code>Integer</code>.) Since you only add the method to <code>Fixnum</code>, it won't work for other <code>Integer</code>s, which aren't <code>Fixnum</code>s. And since the range of <code>Fixnum</code>s is different for different implementations of architectures (e.g. on YARV on 32 bit systems, <code>Fixnum</code>s are 31 bit, on 64 bit systems, they are 63 bit, on JRuby, they are always 64 bit), you don't even know for sure what numbers your method will work on and when it will fail. (E.g.: <code>9223372036854775808.roundup # NoMethodError: undefined method 'roundup' for 9223372036854775808:Bignum</code>.) Solution: make the method an instance method of <code>Integer</code>:</p>\n\n<pre><code>class Integer\n  def roundup\n    return self if (self % 10).zero? # already a factor of 10\n    self + 10 - (self % 10)          # go to nearest factor 10\n  end\nend\n</code></pre></li>\n</ol>\n\n<p>Lastly, I want to suggest at least using a mixin here:</p>\n\n<pre><code>module IntegerWithRoundup\n  def roundup\n    return self if (self % 10).zero? # already a factor of 10\n    self + 10 - (self % 10)          # go to nearest factor 10\n  end\nend\n\nclass Integer\n  include IntegerWithRoundup\nend\n</code></pre>\n\n<p>Now, if someone else debugs your code, and wonders where this <code>roundup</code> method comes from, there is a clear trace in the ancestry chain:</p>\n\n<pre><code>12.method(:roundup).owner\n# =&gt; IntegerWithRoundup\n</code></pre>\n\n<p>Even better would be to use a Refinement, that way your monkeypatch doesn't pollute the global namespace:</p>\n\n<pre><code>module IntegerWithRoundup\n  module Roundup\n    def roundup\n      return self if (self % 10).zero? # already a factor of 10\n      self + 10 - (self % 10)          # go to nearest factor 10\n    end\n  end\n\n  refine Integer do\n    include Roundup\n  end\nend\n\n12.roundup\n# NoMethodError: undefined method `roundup' for 12:Fixnum\n\nusing IntegerWithRoundup\n\n12.roundup\n# =&gt; 20\n</code></pre>\n"}], "owner": {"reputation": 2049, "user_id": 2246700, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/63ae5300336319b5b03e0008130b27b6?s=128&d=identicon&r=PG&f=1", "display_name": "narzero", "link": "https://stackoverflow.com/users/2246700/narzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1683, "favorite_count": 1, "accepted_answer_id": 32102185, "answer_count": 2, "score": 2, "last_activity_date": 1440007156, "creation_date": 1439998249, "question_id": 32099839, "link": "https://stackoverflow.com/questions/32099839/why-cant-i-extend-the-fixnum-class-in-a-module-and-use-it", "title": "Why can&#39;t I extend the Fixnum class in a module and use it?", "body": "<p>I've created a module in which I extend the Fixnum class with a new method. But when I <code>require</code> the module and try to use the extended method, it returns:</p>\n\n<pre><code>NoMethodError: undefined method `roundup' for 13:Fixnum\n</code></pre>\n\n<p>Here's what my module looks like:</p>\n\n<pre><code>module EanControl\n  # Extend Fixnum with #roundup\n  class Fixnum\n    def self.roundup\n      return self if self % 10 == 0   # already a factor of 10\n      return self + 10 - (self % 10)  # go to nearest factor 10\n    end\n  end\n\n  # More code...\nend\n</code></pre>\n\n<p>This is what I'm doing:</p>\n\n<pre><code>require 'path_to_module'\n12.roundup\n\n# =&gt; NoMethodError: undefined method `roundup' for 13:Fixnum\n</code></pre>\n\n<p>How could I solve this?</p>\n"}, {"tags": ["ruby", "setter", "string-interpolation", "attr-accessor"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 5228881, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1429f2e32fc3ee4d52b33bde30dc65d8?s=128&d=identicon&r=PG&f=1", "display_name": "npresco", "link": "https://stackoverflow.com/users/5228881/npresco"}, "edited": false, "score": 0, "creation_date": 1440002443, "post_id": 32099977, "comment_id": 52096671, "body": "Thanks for the alternate solution but there is reason for the other gamespace attribute. Recreating is key but it seems this is not possible without writing the setter method as I did."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1439998653, "creation_date": 1439998653, "answer_id": 32099977, "question_id": 32099796, "link": "https://stackoverflow.com/questions/32099796/string-interpolation-update-after-change/32099977#32099977", "title": "String interpolation update after change", "body": "<p>When you change your <code>@s</code> array, then you will need to re-create the <code>gamespace</code> string. Or you have to write a setter method instead of the <code>attr_accessor</code>. But from your example it looks like there is no need for the <code>@gamespace</code> variable at all:</p>\n\n<pre><code>attr_accessor :s\n\ndef initialize(s = [1,2,3])\n  @s = s\nend\n\ndef gamespace\n  @s.join(' | ')\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 5228881, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1429f2e32fc3ee4d52b33bde30dc65d8?s=128&d=identicon&r=PG&f=1", "display_name": "npresco", "link": "https://stackoverflow.com/users/5228881/npresco"}, "edited": false, "score": 1, "creation_date": 1440002350, "post_id": 32101110, "comment_id": 52096609, "body": "That&#39;s what I figured, thanks for the clarification."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 0, "last_activity_date": 1440002351, "last_edit_date": 1440002351, "creation_date": 1440002250, "answer_id": 32101110, "question_id": 32099796, "link": "https://stackoverflow.com/questions/32099796/string-interpolation-update-after-change/32101110#32101110", "title": "String interpolation update after change", "body": "<p>A reader method only refers to an instance variable, it doesn't re-evaluate it. If you want to use a reader method to get an updated value, the only thing you can do is to not use the default setter method, but write your own.</p>\n\n<pre><code>def s= a\n  @s = a\n  @gamespace = \"#{a[0]} | #{a[1]} | #{a[2]} \"\nend\n</code></pre>\n\n<p>Setting <code>@a</code> should not be done directly, but should always be done through <code>s=</code>. This applies to <code>initialize</code> as well:</p>\n\n<pre><code>def initialize; s=([1, 2, 3]) end\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5228881, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1429f2e32fc3ee4d52b33bde30dc65d8?s=128&d=identicon&r=PG&f=1", "display_name": "npresco", "link": "https://stackoverflow.com/users/5228881/npresco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 32101110, "answer_count": 2, "score": 0, "last_activity_date": 1440002351, "creation_date": 1439998151, "last_edit_date": 1440001870, "question_id": 32099796, "link": "https://stackoverflow.com/questions/32099796/string-interpolation-update-after-change", "title": "String interpolation update after change", "body": "<p>I have values in an interpolated string that refer to an array like this:</p>\n\n<pre><code>attr_accessor :s, :gamespace\n\ndef initialize\n  @s = [1,2,3]\n  @gamespace = \"#{@s[0]} | #{@s[1]} | #{@s[2]} \"\nend\n</code></pre>\n\n<p>When I change the value of <code>@s</code>, it doesn't update the value of <code>@gamespace</code>.</p>\n\n<p>I resorted to making an additional method like this:</p>\n\n<pre><code>def gamespace\n  @gamespace = \"#{@s[0]} | #{@s[1]} | #{@s[2]}\"\nend\n</code></pre>\n\n<p>and then I call it after any change to <code>@s</code>.</p>\n\n<p>Is there a way to let <code>attr_accessor</code> update the string interpolation after a change without writing this method?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "json", "steam"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1439998281, "post_id": 32099715, "comment_id": 52094033, "body": "Please post the output of <code>Net::HTTP::get(url)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2060, "user_id": 3625058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PEy9i.jpg?s=128&g=1", "display_name": "matanco", "link": "https://stackoverflow.com/users/3625058/matanco"}, "is_accepted": false, "score": 0, "last_activity_date": 1440010681, "creation_date": 1440010681, "answer_id": 32103528, "question_id": 32099715, "link": "https://stackoverflow.com/questions/32099715/jsonparsererror-757-unexpected-token/32103528#32103528", "title": "JSON::ParserError 757 Unexpected token", "body": "<p>The problem for sure is the response, this is an invalid JSON, what you can do first of all move this code to model then check what response code you get from the url you try to send the request if it different then 200 don't try JSON.parse the response because you will get the error you get now.</p>\n\n<p>do something like:</p>\n\n<pre><code>url =      URI.parse(\"http://api.steampowered.com/IPlayerService/GetOwnedGames/v0001/?key=#{ENV['STEAM_WEB_API_KEY']}&amp;account_id=#{session[:current_user][:uid]}\")\n\nif Net::HTTP.get_response(url).kind_of? Net::HTTPSuccess\n  @gameslibrary = JSON.parse(Net::HTTP::get(url))['game_count']['app_id']['name']['playtime_forever'] || []\nelse\n  ... raise or log or something ...\nend\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4023605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ncs1s.jpg?s=128&g=1", "display_name": "DarthAbingdon", "link": "https://stackoverflow.com/users/4023605/darthabingdon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3752, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440010681, "creation_date": 1439997955, "question_id": 32099715, "link": "https://stackoverflow.com/questions/32099715/jsonparsererror-757-unexpected-token", "title": "JSON::ParserError 757 Unexpected token", "body": "<p>A little background on what I'm working on. I'm trying to create an app to spice up my coding portfolio but I can't get this app to work with me. I followed a guide for part of it, specifically integrating Steam OpenID/Omniuath with Ruby on Rails since it uses POST with no CSRF token....yadda yadda yadda. Anyhoo, what I'm trying to get this to do so far is upon logging in through steam, just for this moment, a list of the players owned games will display. However it's not working with me. My code is below for my controller.</p>\n\n<pre><code>    class WelcomeController &lt; ApplicationController\n  skip_before_filter :verify_authenticity_token, :only =&gt; :auth_callback\n  def index\n    @gameslibrary = []\n    if session.key? :current_user\n    url = URI.parse(\"http://api.steampowered.com/IPlayerService/GetOwnedGames/v0001/?key=#{ENV['STEAM_WEB_API_KEY']}&amp;account_id=#{session[:current_user][:uid]}\")\n    res = Net::HTTP::get(url)\n    @gameslibrary = JSON.parse(res)['game_count']['app_id']['name']['playtime_forever'] || []\n  end\nend\n  def auth_callback\n      auth = request.env['omniauth.auth']\n      session[:current_user] = { :nickname =&gt; auth.info['nickname'],\n                                            :image =&gt; auth.info['image'],\n                                            :uid =&gt; auth.uid }\n      redirect_to root_url\n    end\nend\n</code></pre>\n\n<p>And here is my view code</p>\n\n<pre><code>&lt;h1&gt;Welcome#index&lt;/h1&gt;\n&lt;%= link_to image_tag(\"http://cdn.steamcommunity.com/public/images/signinthroughsteam/sits_large_noborder.png\"), '/auth/steam' %&gt;\n&lt;% if session.key? :current_user %&gt;\n&lt;h3&gt;Current User:&lt;/h3&gt;\n&lt;%= image_tag session[:current_user][:image] %&gt;\n&lt;p&gt;&lt;%= session[:current_user][:nickname] %&gt;&lt;/p&gt;\n&lt;p&gt;&lt;%= session[:current_user][:uid] %&gt; &lt;/p&gt;\n&lt;% end %&gt;\n&lt;ul&gt;\n  &lt;% @gameslibrary.each do |game| %&gt;\n  &lt;li&gt;&lt;%= puts game %&gt;&lt;/li&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>my JSON parse comes back with the following</p>\n\n<pre><code>757: unexpected token at '&lt;html&gt; &lt;head&gt; &lt;title&gt;500 Internal Server Error&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Internal Server Error&lt;/h1&gt; &lt;/body&gt; &lt;/html&gt;'\n</code></pre>\n\n<p>Now the Steam Web API does support JSON output. And those items after the JSON parse are actual names of arrays/items in arrays. What am I doing wrong here? And for even more help how would I convert the the JSON parse data from an array into a hash? (or is that automatic?) I'm new to most of this and this is my first app I've done mostly on my own. I'm using GetOwnedGamesv0001 from the Steam Web API if anyone wants to look at it.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 461, "user_id": 4356506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8368ff96dbdb44928059bc3ce89b0c55?s=128&d=identicon&r=PG", "display_name": "0e1val", "link": "https://stackoverflow.com/users/4356506/0e1val"}, "is_accepted": false, "score": 1, "last_activity_date": 1440006771, "last_edit_date": 1440006771, "creation_date": 1440000005, "answer_id": 32100469, "question_id": 32099642, "link": "https://stackoverflow.com/questions/32099642/why-is-my-code-entering-a-string-when-i-explicitly-convert-into-an-int-only-for/32100469#32100469", "title": "Why is my code entering a string when I explicitly convert into an int, ONLY for one specific output?", "body": "<p>reduce/inject would return a single element from the enumerable object if it only contains one element</p>\n\n<p>What you can do is to first map your array elements as numbers then you don't have to rely on you reduce/inject</p>\n\n<pre><code>weight.split(\"\").map(&amp;:to_i).inject{|sum,n| sum+n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "is_accepted": false, "score": 1, "last_activity_date": 1440001107, "creation_date": 1440001107, "answer_id": 32100810, "question_id": 32099642, "link": "https://stackoverflow.com/questions/32099642/why-is-my-code-entering-a-string-when-i-explicitly-convert-into-an-int-only-for/32100810#32100810", "title": "Why is my code entering a string when I explicitly convert into an int, ONLY for one specific output?", "body": "<p>No, it's your bug.</p>\n\n<p>From the <a href=\"http://ruby-doc.org/core/Enumerable.html#method-i-reduce\" rel=\"nofollow\"><code>Enumerable#reduce</code></a> documentation:</p>\n\n<blockquote>\n  <p>If you do not explicitly specify an <em>initial</em> value for <em>memo</em>, then the first element of collection is used as the initial value of <em>memo</em>.</p>\n</blockquote>\n\n<p>That's likely the reason you've written <code>sum.to_i</code> because <code>sum</code> is then originally a string in your case. Also if the collection has only one element (such as <code>[\"3\"]</code>) then there is no need to invoke the block because as the documentation says the return value is the first element (which is <code>\"3\"</code>). Your code can be fixed by explicitly setting the initial value (to <code>0</code>):</p>\n\n<pre><code>a = [\"3\"]\ni = a.reduce { |sum, n| puts 'called'; sum + n.to_i } # no output\np i # =&gt; \"3\"\ni = a.reduce(0) { |sum, n| puts 'called'; sum + n.to_i } # =&gt; called\np i # =&gt; 3\n</code></pre>\n\n<p>If you want your code reviewed, try <a href=\"https://codereview.stackexchange.com/\">Code Review Stack Exchange</a>. The biggest code smell is the definition of a method inside another method. Use a lambda or get rid of it instead.</p>\n"}], "owner": {"reputation": 59, "user_id": 3802564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e974e3d30637aa1e91e5fbf0551c2504?s=128&d=identicon&r=PG&f=1", "display_name": "user3802564", "link": "https://stackoverflow.com/users/3802564/user3802564"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1440006771, "creation_date": 1439997778, "question_id": 32099642, "link": "https://stackoverflow.com/questions/32099642/why-is-my-code-entering-a-string-when-i-explicitly-convert-into-an-int-only-for", "title": "Why is my code entering a string when I explicitly convert into an int, ONLY for one specific output?", "body": "<p><a href=\"http://www.codewars.com/kata/55c6126177c9441a570000cc/train/ruby\" rel=\"nofollow\">This</a> is what I'm working on right now.</p>\n\n<p>Here is my code (feel free to critique it, and please do).</p>\n\n<pre><code>def order_weight(weights)\n    weightslist = weights.split(\" \")\n    def convert(weight)\n      weight.split(\"\").reduce{|sum,n| sum.to_i + n.to_i}\n    end\n\n   weightsconv = weightslist.map {|weight| convert(weight)}\n\n   weightslist.sort_by{|a| [weightsconv[weightslist.index(a)],a]}.join(\" \")\nend\n</code></pre>\n\n<p>This works on <em>everything</em> except the following input string: <code>order_weight(\"3 16 9 38 95 1131268 49455 347464 59544965313 496636983114762 85246814996697\")</code></p>\n\n<p>In that case (by printing), I see that the first 3 entries in weightsconv are corrupted to \"3\", \"7\", \"9\". Everything else stays the same. This solved by adding a <code>.map{|n| n.to_i}</code> at the end of line 7. I don't understand why this is necessary, since I'm already converting inside the previous block. What goes wrong inside this <em>one</em> input? Is this a Ruby bug?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 14407, "user_id": 3035830, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14809f2ad7f14e2867798697ab8f8006?s=128&d=identicon&r=PG", "display_name": "shivam", "link": "https://stackoverflow.com/users/3035830/shivam"}, "edited": false, "score": 0, "creation_date": 1439996914, "post_id": 32099286, "comment_id": 52093066, "body": "can you share the <code>undefined error</code>? Also did you mean  <code>def grab</code> instead of <code>def Lead</code> ?"}, {"owner": {"reputation": 257, "user_id": 4421640, "user_type": "registered", "accept_rate": 4, "profile_image": "https://www.gravatar.com/avatar/69eaf0d8792f78913b0adb7644bc2194?s=128&d=identicon&r=PG&f=1", "display_name": "John Long", "link": "https://stackoverflow.com/users/4421640/john-long"}, "reply_to_user": {"reputation": 14407, "user_id": 3035830, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14809f2ad7f14e2867798697ab8f8006?s=128&d=identicon&r=PG", "display_name": "shivam", "link": "https://stackoverflow.com/users/3035830/shivam"}, "edited": false, "score": 0, "creation_date": 1439997354, "post_id": 32099286, "comment_id": 52093405, "body": "undefined local variable or method `leads&#39; for #&lt;FunctionsController:0x588c660&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 257, "user_id": 4421640, "user_type": "registered", "accept_rate": 4, "profile_image": "https://www.gravatar.com/avatar/69eaf0d8792f78913b0adb7644bc2194?s=128&d=identicon&r=PG&f=1", "display_name": "John Long", "link": "https://stackoverflow.com/users/4421640/john-long"}, "edited": false, "score": 0, "creation_date": 1439997414, "post_id": 32099453, "comment_id": 52093448, "body": "Fixed the example. The problem is when the model method is called I don&#39;t know how to return a variable back to the controller that initially called it."}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "reply_to_user": {"reputation": 257, "user_id": 4421640, "user_type": "registered", "accept_rate": 4, "profile_image": "https://www.gravatar.com/avatar/69eaf0d8792f78913b0adb7644bc2194?s=128&d=identicon&r=PG&f=1", "display_name": "John Long", "link": "https://stackoverflow.com/users/4421640/john-long"}, "edited": false, "score": 1, "creation_date": 1439997566, "post_id": 32099453, "comment_id": 52093547, "body": "The grab method is returning the newdata value, but you&#39;re then not using it. So if you do <code>newdata = Lead.grab(data)</code> then <code>newdata</code> is the returned value. It&#39;s a local variable, so when you set it within the grab method it is not available outside that method as a variable, unless you set it as one."}], "tags": [], "owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "is_accepted": false, "score": 0, "last_activity_date": 1440052696, "last_edit_date": 1440052696, "creation_date": 1439997173, "answer_id": 32099453, "question_id": 32099286, "link": "https://stackoverflow.com/questions/32099286/grabbing-returned-variables/32099453#32099453", "title": "Grabbing returned variables?", "body": "<p>You are trying to define a method called <code>Lead</code>. Do you mean <code>Lead.grab</code>? </p>\n\n<p>I would expect it to be more like</p>\n\n<pre><code>class Lead\n\n  def Lead.grab(data)\n    ...\n  end\n\nend\n</code></pre>\n\n<p>When you call <code>functions</code>, there is nothing named <code>data</code>, so you probably get this error</p>\n\n<pre><code>undefined method or local variable, 'data'\n</code></pre>\n\n<p>That data variable has to come from somewhere. Perhaps</p>\n\n<pre><code>init_data = 30\ndata = Lead.grab(init_data)\nputs data\n# 50\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "is_accepted": false, "score": 1, "last_activity_date": 1439997932, "creation_date": 1439997932, "answer_id": 32099705, "question_id": 32099286, "link": "https://stackoverflow.com/questions/32099286/grabbing-returned-variables/32099705#32099705", "title": "Grabbing returned variables?", "body": "<p>You should have <code>newdata = Lead.grab(data)</code>.  The variable <code>newdata</code> in the grab function is out of scope of the controller, so you can't just use it. You have to set the variable in the controller to the returned value of <code>Lead.grab(data)</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 345, "user_id": 5064765, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8a5a38cc6a3dccee850f33e07bb9fa05?s=128&d=identicon&r=PG&f=1", "display_name": "Anna88", "link": "https://stackoverflow.com/users/5064765/anna88"}, "is_accepted": false, "score": 0, "last_activity_date": 1440050481, "last_edit_date": 1440050481, "creation_date": 1440050066, "answer_id": 32110507, "question_id": 32099286, "link": "https://stackoverflow.com/questions/32099286/grabbing-returned-variables/32110507#32110507", "title": "Grabbing returned variables?", "body": "<p>Try to Use self.grab(data)...end in Lead model</p>\n\n<p>Here grab is an instance method not class and you are calling through model so make the grab a class method using self.</p>\n"}], "owner": {"reputation": 257, "user_id": 4421640, "user_type": "registered", "accept_rate": 4, "profile_image": "https://www.gravatar.com/avatar/69eaf0d8792f78913b0adb7644bc2194?s=128&d=identicon&r=PG&f=1", "display_name": "John Long", "link": "https://stackoverflow.com/users/4421640/john-long"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1440052696, "creation_date": 1439996810, "last_edit_date": 1439997319, "question_id": 32099286, "link": "https://stackoverflow.com/questions/32099286/grabbing-returned-variables", "title": "Grabbing returned variables?", "body": "<p>Lets say I have a model called Lead and a controller method called functions. Lead model has a method called grab.</p>\n\n<pre><code>def functions\n    Lead.grab(data)\n    puts newdata\nend\n\ndef grab(data)\n    newdata = data + 20\n    return newdata\nend\n</code></pre>\n\n<p>Why would this not work? The newdata variable is passed back but the functions method cannot seem to use it without an undefined error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "activeadmin"], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 953042, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aabcbddb30001f6ef03e813b78d6da5?s=128&d=identicon&r=PG", "display_name": "Chris Kinniburgh", "link": "https://stackoverflow.com/users/953042/chris-kinniburgh"}, "is_accepted": true, "score": 0, "last_activity_date": 1439998736, "creation_date": 1439998736, "answer_id": 32100009, "question_id": 32099025, "link": "https://stackoverflow.com/questions/32099025/activeadmin-page-not-displaying-form-tag-form-alongside-other-content/32100009#32100009", "title": "ActiveAdmin page not displaying form_tag form alongside other content", "body": "<p>I ended up using a partial which seemed to fix the issue.  This ended up with the panel looking like this:</p>\n\n<pre><code>panel \"Update/Import Matters\" do\n    para \"Some info about the form.\"\n    render 'matters_form'\nend\n</code></pre>\n\n<p>And /app/views/admin/import/_matters_form.html.erb:</p>\n\n<pre><code>&lt;%= form_tag import_matters_path, multipart: true do %&gt;\n    &lt;%= file_field_tag :file %&gt;\n    &lt;%= submit_tag \"Import\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This might not be the only way, but partials definitely worked in this situation.</p>\n"}], "owner": {"reputation": 381, "user_id": 953042, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aabcbddb30001f6ef03e813b78d6da5?s=128&d=identicon&r=PG", "display_name": "Chris Kinniburgh", "link": "https://stackoverflow.com/users/953042/chris-kinniburgh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 886, "favorite_count": 0, "accepted_answer_id": 32100009, "answer_count": 1, "score": 1, "last_activity_date": 1439998736, "creation_date": 1439996231, "question_id": 32099025, "link": "https://stackoverflow.com/questions/32099025/activeadmin-page-not-displaying-form-tag-form-alongside-other-content", "title": "ActiveAdmin page not displaying form_tag form alongside other content", "body": "<p>I have an ActiveAdmin page I want to use to upload a variety of files to various controllers:</p>\n\n<pre><code>ActiveAdmin.register_page \"Import\" do\n    content do\n        columns do \n            column do\n                panel \"Overview\" do\n                    para \"This is the admin Import page.\"\n                end\n            end\n            column do\n                panel \"Update/Import Matters\" do\n                    para \"This is some info about what this form should take.\"\n                    form_tag import_matters_path, multipart: true do\n                        file_field_tag :file\n                        submit_tag \"Import\"\n                    end\n                end\n            end\n        end\n    end\nend\n</code></pre>\n\n<p>The page displays, but the right hand column only displays the panel with the text \"this is some info...\" When I comment out that line, I get an import button but no way to upload a file.  When I comment out the submit_tag and the para line, I get the 'choose file' button to select a file to import, but nothing else.</p>\n\n<p>The panel seems to be unable to concatenate the html from the form properly, but I'm not clear how to do that myself.</p>\n"}, {"tags": ["ruby", "centos", "rvm", "yum"], "answers": [{"tags": [], "owner": {"reputation": 497, "user_id": 2884190, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a4eb38bf50b16a23ef1e07eb351ad23d?s=128&d=identicon&r=PG&f=1", "display_name": "Kostia Skrypnyk", "link": "https://stackoverflow.com/users/2884190/kostia-skrypnyk"}, "is_accepted": true, "score": 2, "last_activity_date": 1439996294, "creation_date": 1439996294, "answer_id": 32099056, "question_id": 32098808, "link": "https://stackoverflow.com/questions/32098808/issue-with-install-newest-version-of-ruby-on-cetos/32099056#32099056", "title": "issue with install newest version of ruby on cetos", "body": "<p>Try to remove lib : </p>\n\n<pre><code>rpm -e --nodeps libffi\n</code></pre>\n\n<p>and again try to install ruby.</p>\n"}], "owner": {"reputation": 133, "user_id": 5148520, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c3069d1f5d02b9955ae3aad40b7506b8?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/5148520/just-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 32099056, "answer_count": 1, "score": 0, "last_activity_date": 1439996294, "creation_date": 1439995697, "last_edit_date": 1439995855, "question_id": 32098808, "link": "https://stackoverflow.com/questions/32098808/issue-with-install-newest-version-of-ruby-on-cetos", "title": "issue with install newest version of ruby on cetos", "body": "<p>Please help!!! \nI have issue with installing new version of ruby in my Centos6. \nI'l try install it using rvm :</p>\n\n<pre><code>/usr/local/rvm/bin/rvm install 1.9.2\n</code></pre>\n\n<p>And got the next message :</p>\n\n<blockquote>\n  <p>Error running 'requirements_centos_libs_install libyaml-devel\n  readline-devel libffi-devel sqlite-devel', showing last 15 lines of\n  /usr/local/rvm/log/1439995406_ruby-1.9.2-p330/package_install_libyaml-devel_readline-devel_libffi-devel_sqlite-devel.log\n  If you don't want/need both architectures anymore then you\n         can remove the one with the missing update and everything\n             will work.</p>\n  \n  <p>You have duplicate versions of libffi installed already.\n    You can use \"yum check\" to get yum show these errors.</p>\n  \n  <p>...you can also use --setopt=protected_multilib=false to remove\n    this checking, however this is almost never the correct thing to\n    do as something else is very likely to go wrong (often causing\n    much more problems).</p>\n  \n  <p>Protected multilib versions: libffi-3.0.5-3.2.el6.i686 != libffi-3.0.9-1.el5.rf.x86_64\n  ++ return 1\n  ++ return 1 Requirements installation failed with status: 1.</p>\n</blockquote>\n\n<p>I try to remove this lib but again fail :</p>\n\n<blockquote>\n  <p>Error: Trying to remove \"yum\", which is protected</p>\n</blockquote>\n\n<p>Can somebody explain where I fail? Please! Thx all!</p>\n\n<p>p.s. I'm update the system (in case if answer will be \"yum update\") :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4891639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YNsCxAFcqNU/AAAAAAAAAAI/AAAAAAAAADs/EC_d_ItmWHQ/photo.jpg?sz=128", "display_name": "Nathan Huber", "link": "https://stackoverflow.com/users/4891639/nathan-huber"}, "edited": false, "score": 0, "creation_date": 1439992858, "post_id": 32097552, "comment_id": 52089843, "body": "Forgive me if I&#39;m sounding like an idiot, but I think it would be useful to have that data saved for each load, that way if we want to run a report/invoice or something for the last week, or the last month or even year.  Or would I just have that method calculate it every time?"}, {"owner": {"reputation": 53, "user_id": 4891639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YNsCxAFcqNU/AAAAAAAAAAI/AAAAAAAAADs/EC_d_ItmWHQ/photo.jpg?sz=128", "display_name": "Nathan Huber", "link": "https://stackoverflow.com/users/4891639/nathan-huber"}, "edited": false, "score": 0, "creation_date": 1439993126, "post_id": 32097552, "comment_id": 52090027, "body": "And I&#39;m not sure why I&#39;m getting the negative marks for my question.  I&#39;ve been trying to research this for a while, and have not been able to find anything.  Maybe I&#39;m so new at this that I&#39;m not sure how to search what I&#39;m looking for or how to ask the right question, but a little direction would help, I thought this was a community that helps each other out... Seeing all the negative marks with no feedback is a little discouraging."}, {"owner": {"reputation": 779, "user_id": 5135282, "user_type": "registered", "profile_image": "https://graph.facebook.com/511721875/picture?type=large", "display_name": "Alexandre Voyer", "link": "https://stackoverflow.com/users/5135282/alexandre-voyer"}, "reply_to_user": {"reputation": 53, "user_id": 4891639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YNsCxAFcqNU/AAAAAAAAAAI/AAAAAAAAADs/EC_d_ItmWHQ/photo.jpg?sz=128", "display_name": "Nathan Huber", "link": "https://stackoverflow.com/users/4891639/nathan-huber"}, "edited": false, "score": 0, "creation_date": 1439994941, "post_id": 32097552, "comment_id": 52091485, "body": "Let&#39;s say for some reason in the future your logic changes or you add a layer of complexity, this function allows you way more flexibility than just stored data :)"}, {"owner": {"reputation": 779, "user_id": 5135282, "user_type": "registered", "profile_image": "https://graph.facebook.com/511721875/picture?type=large", "display_name": "Alexandre Voyer", "link": "https://stackoverflow.com/users/5135282/alexandre-voyer"}, "reply_to_user": {"reputation": 53, "user_id": 4891639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YNsCxAFcqNU/AAAAAAAAAAI/AAAAAAAAADs/EC_d_ItmWHQ/photo.jpg?sz=128", "display_name": "Nathan Huber", "link": "https://stackoverflow.com/users/4891639/nathan-huber"}, "edited": false, "score": 0, "creation_date": 1439994989, "post_id": 32097552, "comment_id": 52091532, "body": "as for the downvotes, it&#39;s mostly because you didn&#39;t provide much code/database insight. next time copy your model and your db/schema.rb :)"}], "tags": [], "owner": {"reputation": 779, "user_id": 5135282, "user_type": "registered", "profile_image": "https://graph.facebook.com/511721875/picture?type=large", "display_name": "Alexandre Voyer", "link": "https://stackoverflow.com/users/5135282/alexandre-voyer"}, "is_accepted": false, "score": 2, "last_activity_date": 1439992405, "creation_date": 1439992405, "answer_id": 32097552, "question_id": 32097423, "link": "https://stackoverflow.com/questions/32097423/ruby-on-rails-calculations/32097552#32097552", "title": "Ruby on Rails Calculations", "body": "<p>why keep that logic in the database? You could simply have it in the model.</p>\n\n<p>Let's say you have a Load model</p>\n\n<p>simply add the following method</p>\n\n<pre><code>def net_weight\n  gross_weight - tare_weight\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 4891639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YNsCxAFcqNU/AAAAAAAAAAI/AAAAAAAAADs/EC_d_ItmWHQ/photo.jpg?sz=128", "display_name": "Nathan Huber", "link": "https://stackoverflow.com/users/4891639/nathan-huber"}, "edited": false, "score": 0, "creation_date": 1439993828, "post_id": 32097703, "comment_id": 52090624, "body": "Thanks for the reply Axel.  Why I have to store it in the database?  Lol, cause I probably don&#39;t know any better.  I just thought if I need to access that data later on, it would be best to have it stored..."}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1439996467, "post_id": 32097703, "comment_id": 52092726, "body": "to the why. IMO you&#39;d store it in the database because its one computation stored (in the database) when the record is updated vs having to compute it every time on a render for every record. ruby/rails is slow enough already without unneeded computations in the view."}, {"owner": {"reputation": 1305, "user_id": 623919, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c7d2113d86e7a9b16e8cac6956096bf0?s=128&d=identicon&r=PG", "display_name": "Axel Tetzlaff", "link": "https://stackoverflow.com/users/623919/axel-tetzlaff"}, "edited": false, "score": 0, "creation_date": 1439997535, "post_id": 32097703, "comment_id": 52093532, "body": "Storing this because &#39;ruby/rails is slow enough already&#39; is a classic case of premature optimization - storing this value in the db does indeed yield less computations, but you also have to &#39;remember&#39; to update this if you update the other weights - of course you can do this with a before_save, but this is more code. And the best code is the one you don&#39;t have to write ;-). So unless you have actual performance issues I would stick with the transient solution proposed by Alexandre as well"}], "tags": [], "owner": {"reputation": 1305, "user_id": 623919, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c7d2113d86e7a9b16e8cac6956096bf0?s=128&d=identicon&r=PG", "display_name": "Axel Tetzlaff", "link": "https://stackoverflow.com/users/623919/axel-tetzlaff"}, "is_accepted": false, "score": 1, "last_activity_date": 1439992839, "creation_date": 1439992839, "answer_id": 32097703, "question_id": 32097423, "link": "https://stackoverflow.com/questions/32097423/ruby-on-rails-calculations/32097703#32097703", "title": "Ruby on Rails Calculations", "body": "<p>I would also ask why you have to store it in the database. If you do want to store it none the less:</p>\n\n<p>You can create the before_create <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html\" rel=\"nofollow\">lifecyle hook</a> of a model to calculate and set values before saving it to the database.</p>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 3, "last_activity_date": 1439994202, "creation_date": 1439994202, "answer_id": 32098235, "question_id": 32097423, "link": "https://stackoverflow.com/questions/32097423/ruby-on-rails-calculations/32098235#32098235", "title": "Ruby on Rails Calculations", "body": "<p>I would add a <code>before_validation</code> callback to the model and let is calculate the missing value. Something like this:</p>\n\n<pre><code># in your model\nbefore_validation :calculate_net_weight\n\nprivate\ndef calculate_net_weight\n  self.net_weight = gross_weight - tare_weight\nend\n</code></pre>\n\n<p>Btw. I would argue that is makes sense to store all three values in the database even if you could calculate one from the other two. But having all three values in the databse might help to fix problems or might make calculation or statistics easier.</p>\n"}], "owner": {"reputation": 53, "user_id": 4891639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YNsCxAFcqNU/AAAAAAAAAAI/AAAAAAAAADs/EC_d_ItmWHQ/photo.jpg?sz=128", "display_name": "Nathan Huber", "link": "https://stackoverflow.com/users/4891639/nathan-huber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 32098235, "answer_count": 3, "score": 0, "last_activity_date": 1439994202, "creation_date": 1439992139, "question_id": 32097423, "link": "https://stackoverflow.com/questions/32097423/ruby-on-rails-calculations", "title": "Ruby on Rails Calculations", "body": "<p>I'm new to Rails and coding in general, and I'm trying to teach myself by working on an app for a delivery driver.  I have a table called loads, and included are the columns for Gross Weight, tare weight and net weight.  The way it is currently, the driver would have to type in all 3 weights manually.  I'm trying to figure out the best way to have the app calculate the net weight (by subtracting the tare weight from the gross weight)and add it to the net column. This would cut down on the driver making a simple math mistake.  I'm using MySQL, can someone point me in the right direction?</p>\n"}, {"tags": ["ruby", "puppet", "puppet-enterprise"], "answers": [{"comments": [{"owner": {"reputation": 545, "user_id": 2369696, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/xKKds.jpg?s=128&g=1", "display_name": "rjinski", "link": "https://stackoverflow.com/users/2369696/rjinski"}, "edited": false, "score": 0, "creation_date": 1440055887, "post_id": 32101597, "comment_id": 52117453, "body": "Novice question, can variables still be passed with <code>contain</code>?"}, {"owner": {"reputation": 545, "user_id": 2369696, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/xKKds.jpg?s=128&g=1", "display_name": "rjinski", "link": "https://stackoverflow.com/users/2369696/rjinski"}, "edited": false, "score": 0, "creation_date": 1440056790, "post_id": 32101597, "comment_id": 52117974, "body": "Yes, you can. <code>class ntp {   # ...   class { &#39;ntp::service&#39;:     enable =&gt; true,   }   contain &#39;ntp::service&#39;   # ... }</code> <a href=\"https://docs.puppetlabs.com/puppet/latest/reference/lang_containment.html#containing-classes\" rel=\"nofollow noreferrer\">docs.puppetlabs.com/puppet/latest/reference/&hellip;</a>"}, {"owner": {"reputation": 7902, "user_id": 3356612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085070b2074edcce07bc4381c7b5d635?s=128&d=identicon&r=PG", "display_name": "Felix Frank", "link": "https://stackoverflow.com/users/3356612/felix-frank"}, "reply_to_user": {"reputation": 545, "user_id": 2369696, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/xKKds.jpg?s=128&g=1", "display_name": "rjinski", "link": "https://stackoverflow.com/users/2369696/rjinski"}, "edited": false, "score": 0, "creation_date": 1440058837, "post_id": 32101597, "comment_id": 52119194, "body": "@rjinski yes, but it&#180;s preferable to rely on Hiera and automatic parameter lookup instead, anyway."}], "tags": [], "owner": {"reputation": 7902, "user_id": 3356612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085070b2074edcce07bc4381c7b5d635?s=128&d=identicon&r=PG", "display_name": "Felix Frank", "link": "https://stackoverflow.com/users/3356612/felix-frank"}, "is_accepted": true, "score": 2, "last_activity_date": 1440003968, "creation_date": 1440003968, "answer_id": 32101597, "question_id": 32097190, "link": "https://stackoverflow.com/questions/32097190/puppet-class-orders-break-using-defines/32101597#32101597", "title": "Puppet class orders break using defines", "body": "<p>Ordering relationships do not transcend common class declaration using <code>include</code> or <code>class { 'title': }</code>.</p>\n\n<p>The easiest way to go about this in your scenario is to <a href=\"https://docs.puppetlabs.com/puppet/latest/reference/lang_classes.html#using-contain\" rel=\"nofollow\">contain</a> classes.</p>\n\n<pre><code>class base {\n    contain base::prereqs\n    contain base::worker\n    Class['base::prereqs'] -&gt; Class['base::worker']\n}\n</code></pre>\n"}], "owner": {"reputation": 545, "user_id": 2369696, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/xKKds.jpg?s=128&g=1", "display_name": "rjinski", "link": "https://stackoverflow.com/users/2369696/rjinski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 32101597, "answer_count": 1, "score": 1, "last_activity_date": 1440003968, "creation_date": 1439991530, "question_id": 32097190, "link": "https://stackoverflow.com/questions/32097190/puppet-class-orders-break-using-defines", "title": "Puppet class orders break using defines", "body": "<p>I have a level of dependency in the order of modules being applied:</p>\n\n<pre><code>class build() {\n    # define order\n    Class['base'] -&gt; Class['config'] -&gt; Class['app'] -&gt; Class['sso']\n\n    class { 'base' : ... }\n    class { 'config' : ... }\n    # etc\n}\n\nclass base::init.pp () {\n    class { 'base::prereqs' : ... }\n    class { 'base::worker' : \n        require =&gt; Class['base::prereqs']\n        ... \n    }\n}\n\n# etc etc\n</code></pre>\n\n<p>The error occurs when <code>base::prereqs</code> has:</p>\n\n<pre><code>define base::prereqs::file () { ... }\n\nclass base::prereqs () {\n    $files = [ 'file_name', ... ]\n    base::prereqs::file { $files : }\n}\n</code></pre>\n\n<p>The desired order is <strong>base::init --> base::prereqs --> base::worker --> config::init --> config::prepreqs --> config::worker --> app::init ...</strong></p>\n\n<p>However the actual order using a define becomes...</p>\n\n<p><strong>base::init --> base::prereqs (except resources created in the define) --> config::init --> config::prereqs --> ... --> base:prepreqs (resources created by define) --> base::worker</strong></p>\n\n<p>The ordering inside <code>base</code> is consistent but the level above in <code>order</code> does not seem to know that resources have been added inside of <code>prereqs</code> and considers <code>base</code> complete.</p>\n\n<p>Any help?</p>\n\n<p><em>Puppet v3.6.2 (Puppet Enterprise 3.3.2)</em></p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax", "forms"], "comments": [{"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1439992013, "post_id": 32096991, "comment_id": 52089145, "body": "I assume <code>current_user</code> is a helper method on the controller, which I guess is cached.  Switch it to the user object you updated.  <code>$(&#39;.location-name&#39;).html(&#39;&lt;%= @user.location %&gt;&#39;);</code>"}, {"owner": {"reputation": 148, "user_id": 2238060, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8163be9f3509d9f2221bdd81d1f0a7fe?s=128&d=identicon&r=PG", "display_name": "MindRave", "link": "https://stackoverflow.com/users/2238060/mindrave"}, "reply_to_user": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1439995754, "post_id": 32096991, "comment_id": 52092179, "body": "@japed Yes! That was it! Can you provide your comment in an answer so that I can mark it correct? Thank you so much for your help."}], "answers": [{"tags": [], "owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "is_accepted": true, "score": 2, "last_activity_date": 1439996009, "creation_date": 1439996009, "answer_id": 32098946, "question_id": 32096991, "link": "https://stackoverflow.com/questions/32096991/update-js-in-rails-needs-second-submit/32098946#32098946", "title": "update.js in Rails needs second submit", "body": "<p>I assume <code>current_user</code> is a helper method on the controller, which I guess is cached. Switch it to the user object you updated. <code>$('.location-name').html('&lt;%= @user.location %&gt;');</code></p>\n"}], "owner": {"reputation": 148, "user_id": 2238060, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8163be9f3509d9f2221bdd81d1f0a7fe?s=128&d=identicon&r=PG", "display_name": "MindRave", "link": "https://stackoverflow.com/users/2238060/mindrave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 32098946, "answer_count": 1, "score": 0, "last_activity_date": 1439996009, "creation_date": 1439991096, "last_edit_date": 1439991414, "question_id": 32096991, "link": "https://stackoverflow.com/questions/32096991/update-js-in-rails-needs-second-submit", "title": "update.js in Rails needs second submit", "body": "<p>I am having a small (really small) issue with Rails.</p>\n\n<p>A remote:true update form (calling update.js.erb) needs two submissions instead of one to correctly refresh the view.</p>\n\n<pre><code>def update\n@user = User.find(params[:id])\nif @user.update_attributes(update_user_params)\n  respond_to do |format|\n    format.html {\n      flash[:success] = \"Votre profil a \u00e9t\u00e9 mis \u00e0 jour.\"\n      redirect_to @user\n    }\n    format.js\n  end\nelse\n  render 'edit'\nend\n</code></pre>\n\n<p>end</p>\n\n<p>And here is the view code (I am using method: 'put' because I am calling it from the homepage, and not the edit.html, but even without it, the problem persists):</p>\n\n<pre><code>&lt;%= form_for @user, html: { multipart: true }, remote: true, method: 'put' do |f| %&gt;\n  &lt;%= f.label :location, 'Ville', class: 'popover-title' %&gt;\n  &lt;%= f.select :location, cities_options %&gt;\n  &lt;%= f.submit \"Valider\", class: 'btn-addon' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here's what I see on submit:</p>\n\n<pre><code>Started PUT \"/users/101\" for 127.0.0.1 at 2015-08-19 15:25:05 +0200\nProcessing by UsersController#update as JS\nParameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"hZMd5usgyZVgY4DxqNp0PxF8JPvRk/V+WAGTjFLhj8rqS0y1UCbzbQ9e7HYH20oNdn3TK6FXrLgeDXYnrZeVIg==\", \"user\"=&gt;{\"location\"=&gt;\"Paris\"}, \"commit\"=&gt;\"Valider\", \"id\"=&gt;\"101\"}\nUser Load (0.1ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT 1  [[\"id\", 101]]\nUser Load (0.1ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT 1  [[\"id\", 101]]\nCACHE (0.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT 1  [[\"id\", \"101\"]]\n(0.0ms)  begin transaction\nUser Exists (0.1ms)  SELECT  1 AS one FROM \"users\" WHERE (LOWER(\"users\".\"email\") = LOWER('andrey.soloviev.s@gmail.com') AND \"users\".\"id\" != 101) LIMIT 1\nSQL (0.3ms)  UPDATE \"users\" SET \"location\" = ?, \"lat\" = ?, \"lng\" = ?, \"updated_at\" = ? WHERE \"users\".\"id\" = ?  [[\"location\", \"Paris\"], [\"lat\", 48.856614], [\"lng\", 2.3522219], [\"updated_at\", \"2015-08-19 13:25:05.511789\"], [\"id\", 101]]\n(2.2ms)  commit transaction\nRendered users/update.js.erb (0.1ms)\nCompleted 200 OK in 208ms (Views: 4.6ms | ActiveRecord: 2.9ms)\n</code></pre>\n\n<p>And finally, here is the update.js.erb:</p>\n\n<pre><code>$('.location-name').html('&lt;%= current_user.location %&gt;');\n</code></pre>\n\n<p>Basic Rails js, nothing out of the ordinary. The above code tells me that everything appears to be working properly. However, on submit, update.js refreshes the location with the old value from the database (that was there before the new one). Only on second submit I get to see the correct value appearing.</p>\n\n<p>If anyone has any ideas or solutions, I am forever grateful.</p>\n\n<p>Thank you all in advance!</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1439990570, "post_id": 32096728, "comment_id": 52087959, "body": "This looks like a duplicate of this quesiton... <a href=\"http://stackoverflow.com/questions/5174913/combine-two-arrays-into-hash\" title=\"combine two arrays into hash\">stackoverflow.com/questions/5174913/&hellip;</a>"}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1439993822, "post_id": 32096728, "comment_id": 52090617, "body": "Why have you only got 3 entries for :sales but 4 for :net_income - is that just a mistake?"}, {"owner": {"reputation": 7, "user_id": 3974554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/782883359/picture?type=large", "display_name": "Takaaki Furuse", "link": "https://stackoverflow.com/users/3974554/takaaki-furuse"}, "edited": false, "score": 0, "creation_date": 1440023794, "post_id": 32096728, "comment_id": 52107987, "body": "Max, it&#39;s just my mistake. I will correct it."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1439994592, "post_id": 32098214, "comment_id": 52091229, "body": "Ummm, <i>technically</i> the code above will return you <code>@nums</code> :) Better to use <code>each_with_object</code> in the outer loop, I think."}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1439997038, "post_id": 32098214, "comment_id": 52093177, "body": "It doesn&#39;t matter what the loop returns: the required data is held in the variable <code>arr</code>.  Apologies if this is not clear."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1440005969, "post_id": 32098214, "comment_id": 52098649, "body": "My point was, you don&#39;t <i>need</i> extra complexity in form of local variable <code>arr</code>. Your updated code will return the array. It is also what <code>each_with_object</code> does internally, so might as well just use it (code will be cleaner)"}, {"owner": {"reputation": 7, "user_id": 3974554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/782883359/picture?type=large", "display_name": "Takaaki Furuse", "link": "https://stackoverflow.com/users/3974554/takaaki-furuse"}, "edited": false, "score": 0, "creation_date": 1440023995, "post_id": 32098214, "comment_id": 52108051, "body": "Sergio, if I remove arr from Max&#39;s code, it&#39;s just returns only the first element of what I want to get."}], "tags": [], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1439997121, "last_edit_date": 1439997121, "creation_date": 1439994160, "answer_id": 32098214, "question_id": 32096728, "link": "https://stackoverflow.com/questions/32096728/how-could-i-turn-2-arrays-and-1-hash-into-single-hash-by-ruby/32098214#32098214", "title": "How could I Turn 2 arrays and 1 hash into single hash by Ruby?", "body": "<pre><code>arr = []\n@nums.each do |num_key, num_arr|\n  @years.each_with_index do |year,i|\n    arr &lt;&lt; {\"year\" =&gt; year, \"entry\" =&gt; num_key.to_sym, \"amount\" =&gt; num_arr[i]}\n  end\nend;arr\n</code></pre>\n\n<p>Gives me</p>\n\n<pre><code>[{\"amount\"=&gt;20, \"entry\"=&gt;:net_income, \"year\"=&gt;2011},\n{\"amount\"=&gt;30, \"entry\"=&gt;:net_income, \"year\"=&gt;2012},\n{\"amount\"=&gt;50, \"entry\"=&gt;:net_income, \"year\"=&gt;2013},\n{\"amount\"=&gt;60, \"entry\"=&gt;:net_income, \"year\"=&gt;2014},\n{\"amount\"=&gt;1000, \"entry\"=&gt;:sales, \"year\"=&gt;2011},\n{\"amount\"=&gt;2000, \"entry\"=&gt;:sales, \"year\"=&gt;2012},\n{\"amount\"=&gt;3000, \"entry\"=&gt;:sales, \"year\"=&gt;2013},\n{\"amount\"=&gt;4000, \"entry\"=&gt;:sales, \"year\"=&gt;2014}]\n</code></pre>\n\n<p>EDIT: put \";arr\" after the loop so you're left with the <code>arr</code> variable which holds the hashes.</p>\n"}, {"tags": [], "owner": {"reputation": 1940, "user_id": 1058763, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/48a913a2e3bb5e68aae6f73079648e84?s=128&d=identicon&r=PG", "display_name": "Junichi Ito", "link": "https://stackoverflow.com/users/1058763/junichi-ito"}, "is_accepted": false, "score": 0, "last_activity_date": 1440029457, "creation_date": 1440029457, "answer_id": 32107614, "question_id": 32096728, "link": "https://stackoverflow.com/questions/32096728/how-could-i-turn-2-arrays-and-1-hash-into-single-hash-by-ruby/32107614#32107614", "title": "How could I Turn 2 arrays and 1 hash into single hash by Ruby?", "body": "<p>I refactored Max's answer.</p>\n\n<pre><code>  def build_hash\n    @nums.flat_map do |num_key, num_arr|\n      @years.map.with_index do |year, i|\n        {\"year\" =&gt; year, \"entry\" =&gt; num_key.to_sym, \"amount\" =&gt; num_arr[i]}\n      end\n    end\n  end\n</code></pre>\n\n<p>FYI, here is code and spec.</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe 'Array to Hash' do\n  before do\n    @key_array = %w(year entry amount)\n\n    @nums = {\n        \"sales\": [1000, 2000, 3000, 4000],\n        \"net_income\": [20, 30, 50, 60],\n    }\n\n    @years = [2011, 2012, 2013, 2014]\n  end\n\n  let(:expected) do\n    [{\"year\"=&gt;2011, \"entry\"=&gt;:sales, \"amount\"=&gt;1000},\n     {\"year\"=&gt;2012, \"entry\"=&gt;:sales, \"amount\"=&gt;2000},\n     {\"year\"=&gt;2013, \"entry\"=&gt;:sales, \"amount\"=&gt;3000},\n     {\"year\"=&gt;2014, \"entry\"=&gt;:sales, \"amount\"=&gt;4000},\n     {\"year\"=&gt;2011, \"entry\"=&gt;:net_income, \"amount\"=&gt;20},\n     {\"year\"=&gt;2012, \"entry\"=&gt;:net_income, \"amount\"=&gt;30},\n     {\"year\"=&gt;2013, \"entry\"=&gt;:net_income, \"amount\"=&gt;50},\n     {\"year\"=&gt;2014, \"entry\"=&gt;:net_income, \"amount\"=&gt;60}]\n  end\n\n  def build_hash\n    @nums.flat_map do |num_key, num_arr|\n      @years.map.with_index do |year, i|\n        {\"year\" =&gt; year, \"entry\" =&gt; num_key.to_sym, \"amount\" =&gt; num_arr[i]}\n      end\n    end\n  end\n\n  specify do\n    expect(build_hash).to eq expected\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 3974554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/782883359/picture?type=large", "display_name": "Takaaki Furuse", "link": "https://stackoverflow.com/users/3974554/takaaki-furuse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 32098214, "answer_count": 2, "score": 0, "last_activity_date": 1440029457, "creation_date": 1439990450, "last_edit_date": 1440023848, "question_id": 32096728, "link": "https://stackoverflow.com/questions/32096728/how-could-i-turn-2-arrays-and-1-hash-into-single-hash-by-ruby", "title": "How could I Turn 2 arrays and 1 hash into single hash by Ruby?", "body": "<p><strong>My question</strong></p>\n\n<p>Here, I have 2 arrays and 1 hash,</p>\n\n<pre><code>@key_array = %w(year entry amount)\n\n@nums = {\n  \"sales\": [1000, 2000, 3000, 4000],\n  \"net_income\": [20, 30, 50, 60],\n}\n\n@years = [2011, 2012, 2013, 2014]\n</code></pre>\n\n<p>What I would like to do is to turn those 3 into like this</p>\n\n<pre><code>[{\"year\"=&gt;2011, \"entry\"=&gt;:sales, \"amount\"=&gt;1000},\n {\"year\"=&gt;2012, \"entry\"=&gt;:sales, \"amount\"=&gt;2000},\n {\"year\"=&gt;2013, \"entry\"=&gt;:sales, \"amount\"=&gt;3000},\n {\"year\"=&gt;2014, \"entry\"=&gt;:sales, \"amount\"=&gt;4000},\n {\"year\"=&gt;2011, \"entry\"=&gt;:net_income, \"amount\"=&gt;20},\n {\"year\"=&gt;2012, \"entry\"=&gt;:net_income, \"amount\"=&gt;30},\n {\"year\"=&gt;2013, \"entry\"=&gt;:net_income, \"amount\"=&gt;50},\n {\"year\"=&gt;2014, \"entry\"=&gt;:net_income, \"amount\"=&gt;60}]\n</code></pre>\n\n<p>So far, I have tried this Ruby code...</p>\n\n<pre><code>def build_entry_nums_hash\n  num_arr = []\n  @years.each do |year|\n    @nums.each do |key, value|\n      value.each do |fin|\n        value_array = [year, key, fin]\n        hash = {}\n        @key_array.zip(value_array).each { |k, v| hash[k] = v }\n        num_arr &lt;&lt; hash\n      end\n    end\n  end\n  num_arr\nend\n</code></pre>\n\n<p>It returns almost what I expected, but a bit wrong. It returns some unnecessary hashes.   </p>\n\n<pre><code> [{\"year\"=&gt;2011, \"entry\"=&gt;:sales, \"amount\"=&gt;1000},\n {\"year\"=&gt;2011, \"entry\"=&gt;:sales, \"amount\"=&gt;2000},\n {\"year\"=&gt;2011, \"entry\"=&gt;:sales, \"amount\"=&gt;3000},\n {\"year\"=&gt;2011, \"entry\"=&gt;:sales, \"amount\"=&gt;4000},\n ......\n {\"year\"=&gt;2014, \"entry\"=&gt;:net_income, \"amount\"=&gt;20},\n {\"year\"=&gt;2014, \"entry\"=&gt;:net_income, \"amount\"=&gt;30},\n {\"year\"=&gt;2014, \"entry\"=&gt;:net_income, \"amount\"=&gt;50},\n {\"year\"=&gt;2014, \"entry\"=&gt;:net_income, \"amount\"=&gt;60}]\n</code></pre>\n\n<p>Would you give me some advice?</p>\n\n<p><strong>Current situation</strong></p>\n\n<p>I am not sure this is necessary, so please read through if you concerned why I have to convert those arrays and hash into one hash.</p>\n\n<p>I am trying to parse some financial data from an website by using Nokogiri. The data is written in HTML Table tag and it looks like an Excel spreadsheet. My goal is to display those data by using my rails. Currently, I was able to get the numbers and struggling how could I put them into rails DB. It's good if I could do like..</p>\n\n<pre><code>Findata.create{\"year\"=&gt;2011, \"entry\"=&gt;:sales, \"amount\"=&gt;1000} \n</code></pre>\n\n<p>Sine it was very easy to get the financial numbers in row, I made a hahs like @num. What I need is to mix up other 2 arrays and get a hash what I need. </p>\n\n<p>Edit: I have corrected mistakes in array with hash</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 13270, "user_id": 6678, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/777894ea5153122bfa6b83f5bbf23622?s=128&d=identicon&r=PG", "display_name": "Leonid Shevtsov", "link": "https://stackoverflow.com/users/6678/leonid-shevtsov"}, "edited": false, "score": 0, "creation_date": 1439987616, "post_id": 32095614, "comment_id": 52085658, "body": "Please post your event model."}, {"owner": {"reputation": 4600, "user_id": 4315866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8511f579eed33ee3f3be0581ac6233e9?s=128&d=identicon&r=PG", "display_name": "Petros Kyriakou", "link": "https://stackoverflow.com/users/4315866/petros-kyriakou"}, "reply_to_user": {"reputation": 13270, "user_id": 6678, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/777894ea5153122bfa6b83f5bbf23622?s=128&d=identicon&r=PG", "display_name": "Leonid Shevtsov", "link": "https://stackoverflow.com/users/6678/leonid-shevtsov"}, "edited": false, "score": 0, "creation_date": 1439987665, "post_id": 32095614, "comment_id": 52085699, "body": "it has nothing in it. just the class declaration,updating my post anyhow"}, {"owner": {"reputation": 14364, "user_id": 1023609, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14cd00b085c207261db49ac46be4773c?s=128&d=identicon&r=PG", "display_name": "MurifoX", "link": "https://stackoverflow.com/users/1023609/murifox"}, "edited": false, "score": 2, "creation_date": 1439987867, "post_id": 32095614, "comment_id": 52085861, "body": "Change <code>find_by</code> to <code>find</code>."}], "answers": [{"tags": [], "owner": {"reputation": 13270, "user_id": 6678, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/777894ea5153122bfa6b83f5bbf23622?s=128&d=identicon&r=PG", "display_name": "Leonid Shevtsov", "link": "https://stackoverflow.com/users/6678/leonid-shevtsov"}, "is_accepted": true, "score": 6, "last_activity_date": 1439987897, "creation_date": 1439987897, "answer_id": 32095750, "question_id": 32095614, "link": "https://stackoverflow.com/questions/32095614/rails-4-destroy-action-deletes-wrong-record/32095750#32095750", "title": "Rails 4 - destroy action deletes wrong record", "body": "<p>You should use <code>Event.find(params[:id])</code> or <code>Event.find_by(id: params[:id])</code>.</p>\n\n<p>What happens with your code is that the SQL query finds every event - <code>WHERE (66)</code> is true for any record - and <code>find_by</code> takes the first record from the set, and it gets destroyed. The ID from the request doesn't matter.</p>\n"}, {"tags": [], "owner": {"reputation": 9480, "user_id": 625348, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eEgMg.jpg?s=128&g=1", "display_name": "mohamed-ibrahim", "link": "https://stackoverflow.com/users/625348/mohamed-ibrahim"}, "is_accepted": false, "score": 1, "last_activity_date": 1439988260, "last_edit_date": 1439988260, "creation_date": 1439987935, "answer_id": 32095764, "question_id": 32095614, "link": "https://stackoverflow.com/questions/32095614/rails-4-destroy-action-deletes-wrong-record/32095764#32095764", "title": "Rails 4 - destroy action deletes wrong record", "body": "<p>Why you use <code>find_by</code> its used when you want to use with different attribute to search use:</p>\n\n<pre><code>Event.find(params[:id])\n</code></pre>\n\n<p>OR use find_by_id if you want to not throw an Exception if record not find</p>\n\n<pre><code>Event.find_by_id(params[:id])\n</code></pre>\n\n<p>OR if you still want to use <code>find_by</code> you can use  which if no record is found it returns nil:</p>\n\n<pre><code>Event.find_by(id: params[:id])\n</code></pre>\n\n<p>and use <code>find_by!</code> to throuw an exception if no record found with this id:</p>\n\n<pre><code> Event.find_by!(id: params[:id])\n</code></pre>\n"}], "owner": {"reputation": 4600, "user_id": 4315866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8511f579eed33ee3f3be0581ac6233e9?s=128&d=identicon&r=PG", "display_name": "Petros Kyriakou", "link": "https://stackoverflow.com/users/4315866/petros-kyriakou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 32095750, "answer_count": 2, "score": 0, "last_activity_date": 1439988260, "creation_date": 1439987503, "last_edit_date": 1439987694, "question_id": 32095614, "link": "https://stackoverflow.com/questions/32095614/rails-4-destroy-action-deletes-wrong-record", "title": "Rails 4 - destroy action deletes wrong record", "body": "<p>I am doing an ajax request to rails passing in the data an id.</p>\n\n<p>here is the ajax</p>\n\n<pre><code>function delete_availability(id) {\n    var id = id;\n\n    $.ajax({\n      type: \"DELETE\",\n      url: \"/events/\" + id,\n      statusCode: {\n\n        200: function() {\n          //alert(\"200\");\n        },\n        202: function() {\n          //alert(\"202\");\n        }\n      },\n      success: function(data) {\n\n        console.log('availability deleted');\n\n      },\n      error: function(xhr) {\n        alert(\"The error code is: \" + xhr.statusText);\n      }\n    });\n  }\n</code></pre>\n\n<p><strong>my destroy action</strong> </p>\n\n<pre><code>def destroy\n\n    @event = Event.find_by(params[:id]);\n\n    respond_to do |format|\n      if @event.destroy\n        format.json {\n          render json: {}\n        }\n      end\n    end\n  end\n</code></pre>\n\n<p><strong>my event model has nothing in it</strong></p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\n\nend\n</code></pre>\n\n<p>the problem is even though rails receives correct id, when it goes for destroying, it changes id and destroys the next one.</p>\n\n<p>here is the <strong>rails log:</strong></p>\n\n<pre><code>Processing by EventsController#destroy as */*\n  Parameters: {\"id\"=&gt;\"66\"}\n  Event Load (0.1ms)  SELECT  \"events\".* FROM \"events\" WHERE (66) LIMIT 1\n   (0.0ms)  begin transaction\n  SQL (0.2ms)  DELETE FROM \"events\" WHERE \"events\".\"id\" = ?  [[\"id\", 65]]\n   (2.4ms)  commit transaction\nCompleted 200 OK in 6ms (Views: 0.1ms | ActiveRecord: 2.8ms)\n</code></pre>\n\n<p>anyone knows why?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 1, "creation_date": 1439987402, "post_id": 32095325, "comment_id": 52085502, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/31848723/unique-random-string-with-alphanumberic-required-in-ruby\">Unique random string with alphanumberic required in Ruby</a>"}, {"owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1439988105, "post_id": 32095325, "comment_id": 52086040, "body": "That&#39;s probably fair. My only difference is that my characters don&#39;t need to be unique and I&#39;d like to allow some extra special characters. The answers there are pretty good."}, {"owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1439990923, "post_id": 32095325, "comment_id": 52088249, "body": "Actually, I&#39;m going to leave it for a couple of days. I think that the answers on that other thread are brilliant, but the thread&#39;s hard to find (I didn&#39;t find it)."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1439987370, "creation_date": 1439987370, "answer_id": 32095566, "question_id": 32095325, "link": "https://stackoverflow.com/questions/32095325/generate-a-password-string-of-fixed-length-with-certain-required-criteria-capit/32095566#32095566", "title": "Generate a password string of fixed length with certain required criteria (Capitals, numbers, special characters)", "body": "<p>I have never heard about built-in out of the box feature, but you might do:</p>\n\n<pre><code>samples = [('a'..'z'), ('A'..'Z'), (0..9), ['_']].map &amp;:to_a\n(samples.map(&amp;:sample) + \\ # ensure at least one of each group\n  (10-4).times.map do      # 4 are already chosen\n    samples.flatten[rand(samples.flatten.size)] # pick random\n  end).shuffle.join\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39408, "user_id": 55857, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9cc59902c5433de334920d378626b9d8?s=128&d=identicon&r=PG", "display_name": "FMc", "link": "https://stackoverflow.com/users/55857/fmc"}, "is_accepted": true, "score": 5, "last_activity_date": 1439992629, "last_edit_date": 1439992629, "creation_date": 1439988072, "answer_id": 32095816, "question_id": 32095325, "link": "https://stackoverflow.com/questions/32095325/generate-a-password-string-of-fixed-length-with-certain-required-criteria-capit/32095816#32095816", "title": "Generate a password string of fixed length with certain required criteria (Capitals, numbers, special characters)", "body": "<pre><code>low = ('a'..'d').to_a\nup  = ('A'..'Z').to_a\nnum = ('0'..'9').to_a\nu   = ['_']\nany = low + up + num + u\npw  = (low.sample(1) + \n       up.sample(1) + \n       num.sample(1) + \n       u.sample(1) +\n       any.sample(6)).shuffle.join\n</code></pre>\n"}], "owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 32095816, "answer_count": 2, "score": 2, "last_activity_date": 1439992629, "creation_date": 1439986718, "last_edit_date": 1439991218, "question_id": 32095325, "link": "https://stackoverflow.com/questions/32095325/generate-a-password-string-of-fixed-length-with-certain-required-criteria-capit", "title": "Generate a password string of fixed length with certain required criteria (Capitals, numbers, special characters)", "body": "<p>I'm trying to generate secure passwords of a certain length that will meet certain criteria. </p>\n\n<p>e.g. I want (say) a 10 letter password that:</p>\n\n<p>Has at least 1 Capital letter</p>\n\n<p>Has at least 1 lower case letter</p>\n\n<p>Has at least 1 number</p>\n\n<p>Has at least 1 underscore (or other character, but underscore is good due to certain restrictions where only underscores are accepted)</p>\n\n<p>I've tried </p>\n\n<pre><code>SecureRandom.url_safeBase64(10)\n</code></pre>\n\n<p>but this generates strings that are too long and doesn't guarantee the presence of each restriction. </p>\n\n<p>Wondering if there's an easy way...</p>\n"}, {"tags": ["ruby", "variables", "module", "opalrb"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1439986212, "post_id": 32095041, "comment_id": 52084640, "body": "You are mixing class and instance up. <code>base</code> here is a <code>Class</code> object. Setting instance variable on it makes no sense. You might try <a href=\"http://ruby-doc.org/core-2.1.0/Module.html#method-i-attr_accessor\" rel=\"nofollow noreferrer\"><code>attr_accessor</code></a>:  <code>base.send :attr_accessor, :variable_name</code>. The latter will make accessors for this var for each instance. Other way is to patch <code>initialize</code>, but it seems to be an overkill here. Setting value here is impossible, since at this moment there is no <i>instance</i>. Other way would be to define getter and setter for those vars explicitly, using <code>define_method</code>."}, {"owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1439988828, "post_id": 32095041, "comment_id": 52086625, "body": "I&#39;ve actually tried <code>base.attr_accessor :some_variable</code> but I&#39;ll try it using the send method instead, if not then I guess I&#39;l just do it using  a setter and getter."}], "answers": [{"tags": [], "owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "is_accepted": true, "score": 0, "last_activity_date": 1439991364, "creation_date": 1439991364, "answer_id": 32097112, "question_id": 32095041, "link": "https://stackoverflow.com/questions/32095041/cant-create-variable-on-base-object-in-self-included-hook-in-opal/32097112#32097112", "title": "Can&#39;t create variable on base object in &#39;self.included&#39; hook in Opal", "body": "<p>In the end, I had to use <code>@variable_name ||= []</code> inside of the function definitions themselves to get it to work, I don't like it but it works.</p>\n\n<p>If you want to know why I don't like it's because defining object attributes in once places means I can easily find where they're defined and change the initial value, whereas here I have to track it down to change it (not hard but it's the principle).</p>\n\n<p>Personal preference I guess.</p>\n"}], "owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 32097112, "answer_count": 1, "score": -1, "last_activity_date": 1447278312, "creation_date": 1439985930, "last_edit_date": 1447278312, "question_id": 32095041, "link": "https://stackoverflow.com/questions/32095041/cant-create-variable-on-base-object-in-self-included-hook-in-opal", "title": "Can&#39;t create variable on base object in &#39;self.included&#39; hook in Opal", "body": "<p>It's as the question title says, I have an included hook in a module:</p>\n\n<pre><code>def self.included(base)\n    puts 'included'\n    base.extend API\nend\n</code></pre>\n\n<p>My API requires certain variables on the object to exists but none of them are being created.</p>\n\n<p>I've tried:</p>\n\n<ol>\n<li><code>base.variable_name = []</code></li>\n<li><code>%x|#{base}.variable_name = []|</code></li>\n<li><code>base.instance_variable_set(:@variable_name,[])</code></li>\n<li><code>base.instance_exec{@variable_name = []}</code></li>\n<li>1-2 inside of <code>base.instance_exec</code> but using <code>self</code> instead of <code>base</code></li>\n</ol>\n\n<p>Yet none of them work, the console just complains that <code>variable_name=</code> doesn't exist.</p>\n\n<p>What.the.hell?</p>\n\n<p>How do I get the variable to exist on the base object inside of the <code>included</code> hook?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1439986665, "post_id": 32095030, "comment_id": 52084988, "body": "If you are using Rails 4 you need to use <a href=\"http://guides.rubyonrails.org/action_controller_overview.html#strong-parameters\" rel=\"nofollow noreferrer\">strong parameters</a>."}, {"owner": {"reputation": 29, "user_id": 5159845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ceda7d0b2ec9028e76dba60aa90392c?s=128&d=identicon&r=PG&f=1", "display_name": "akash", "link": "https://stackoverflow.com/users/5159845/akash"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1439986754, "post_id": 32095030, "comment_id": 52085046, "body": "and how to get that? @max"}, {"owner": {"reputation": 1305, "user_id": 623919, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c7d2113d86e7a9b16e8cac6956096bf0?s=128&d=identicon&r=PG", "display_name": "Axel Tetzlaff", "link": "https://stackoverflow.com/users/623919/axel-tetzlaff"}, "edited": false, "score": 0, "creation_date": 1439986951, "post_id": 32095030, "comment_id": 52085174, "body": "Google for &#39;rails guide strong parameters&#39;"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1439987346, "post_id": 32095030, "comment_id": 52085453, "body": "The link is already right there in my comment :)"}], "answers": [{"comments": [{"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 1, "creation_date": 1440000838, "post_id": 32095306, "comment_id": 52095733, "body": "To be clear, it looks like you are calling <code>params[:User]</code> with an upper case letter U."}], "tags": [], "owner": {"reputation": 1099, "user_id": 2024073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mETW6.jpg?s=128&g=1", "display_name": "Sarwan Kumar", "link": "https://stackoverflow.com/users/2024073/sarwan-kumar"}, "is_accepted": false, "score": 2, "last_activity_date": 1439987804, "last_edit_date": 1439987804, "creation_date": 1439986680, "answer_id": 32095306, "question_id": 32095030, "link": "https://stackoverflow.com/questions/32095030/ruby-on-rails-form-data-not-not-getting-saved/32095306#32095306", "title": "Ruby on rails form data not not getting saved", "body": "<p>In users_controller, create method, you are using     </p>\n\n<pre><code>@user = User.new(params[:User])   \n</code></pre>\n\n<p>replace it with following code, hope it will work fine.</p>\n\n<pre><code>@user = User.new(params[:user])\n</code></pre>\n\n<p>And,also use strong params if you are using rails 4. Like follwoing.  </p>\n\n<pre><code>def create\n  @user = User.new(user_params)\n  if @user.save\n    flash[:notice]= \"you signed up successfully\"\n    flash[:color]= \"valid\"\n  else\n    flash[:notice]= \"failed\"\n    flash[:color]=\"invalid\"\n  end\n  render \"new\"\nend\n\nprivate  \n  def user_params  \n    params.require(:user).permit(:username, :account, :email, :password, :password_confirmation)    \n  end\n</code></pre>\n\n<p>If, it still not works, then, please display your log.</p>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1440000424, "last_edit_date": 1440000424, "creation_date": 1439987125, "answer_id": 32095477, "question_id": 32095030, "link": "https://stackoverflow.com/questions/32095030/ruby-on-rails-form-data-not-not-getting-saved/32095477#32095477", "title": "Ruby on rails form data not not getting saved", "body": "<p>If you are using Rails 4 you need to use <a href=\"http://guides.rubyonrails.org/action_controller_overview.html#strong-parameters\" rel=\"nofollow\">strong parameters</a> to whitelist the parameters you want to assign to your models.</p>\n\n<p>This became non-optional in Rails 4 to prevent mass-assignment vulnerabilities where a malicious user can assign any property to a model after Egor Homakovs much publicised Github attack.</p>\n\n<p>Also note that Ruby is case sensitive. This applies to hash keys as well:</p>\n\n<pre><code>irb(main):003:0&gt; hash = { a: 1 }\n=&gt; {:a=&gt;1}\nirb(main):004:0&gt; hash[:A]\n=&gt; nil\n</code></pre>\n\n<p>Which is why why you do <code>User.new(params[:User])</code> you are actually doing <code>User.new(nil)</code></p>\n\n<p>This is a corrected version of your controller</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def new\n    @user= User.new\n  end\n\n  def create\n    @user = User.new(params[:User])\n    if @user.save\n      flash[:notice]= \"you signed up successfully\"\n      flash[:color]= \"valid\"\n      # You should redirect instead of rendering the form again\n      redirect_to @user # or redirect_to root_path\n    else\n      flash[:notice]= \"failed\"\n      flash[:color]=\"invalid\"\n      render \"new\" # Needs to be inside the \"else\" statement\n      # Otherwise you will get a double render error\n    end\n  end\n\n  def user_params\n    params.require(:user)\n          .allow(:username, :email, :password, :password_confirmation)\n  end\nend\n</code></pre>\n\n<h1>Added:</h1>\n\n<p>You can also simplify your form_for to</p>\n\n<pre><code>&lt;%= form_for(:user) do |f| %&gt;\n</code></pre>\n\n<p>Rails will by convention route the form to <code>UserController#create</code>.\nAlso you should use <code>&lt;label&gt;</code> tags for accessibility, as they help people who use assistive technology such as screen readers to find the correct inputs.</p>\n\n<p>By using the built in <code>label</code> helper rails will set up the <code>for</code> attribute and you can translate the label texts with Rails built in I18n functionality.</p>\n\n<pre><code>&lt;% page_title=\"Signup\" %&gt;\n&lt;div class=\"Sign_Form\"&gt;\n  &lt;h1&gt;Sign up&lt;/h1&gt;\n  &lt;%= form_for(:user) do |f| %&gt;\n    &lt;div class=\"row\"&gt;\n      &lt;%= f.label :username %&gt;:&lt;/br&gt; \n      &lt;%= f.text_field :username %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"row\"&gt;\n      &lt;%= f.label :email %&gt;:&lt;/br&gt;\n      &lt;%= f.text_field :email %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"row\"&gt;\n      &lt;%= f.label :password %&gt;:&lt;/br&gt;\n      &lt;%= f.password_field :password %&gt;\n    &lt;/div&gt;\n    &lt;%= f.submit :Signup %&gt;\n  &lt;% end %&gt;\n  &lt;% if @user.errors.any? %&gt;\n    &lt;ul class=\"Signup_Errors\"&gt;\n    &lt;%# for loops are almost never used in ruby. %&gt;\n    &lt;%# .each is the idiomatically correct way %&gt;\n    &lt;% @user.errors.full_messages.each do |message_error| %&gt;\n      &lt;li&gt;* &lt;%= message_error %&gt;&lt;/li&gt;\n    &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5159845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ceda7d0b2ec9028e76dba60aa90392c?s=128&d=identicon&r=PG&f=1", "display_name": "akash", "link": "https://stackoverflow.com/users/5159845/akash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1440000424, "creation_date": 1439985900, "last_edit_date": 1439986707, "question_id": 32095030, "link": "https://stackoverflow.com/questions/32095030/ruby-on-rails-form-data-not-not-getting-saved", "title": "Ruby on rails form data not not getting saved", "body": "<p>So i am getting trouble in saving form data,.Any help will b appreciable\nform is submitted without getting any error, but in database, nothing is stored\ni am new on rails</p>\n\n<blockquote>\n  <p>users_controller</p>\n</blockquote>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def new\n    @user= User.new\n  end\n\n  def create\n    @user = User.new(params[:User])\n    if @user.save\n        flash[:notice]= \"you signed up successfully\"\n        flash[:color]= \"valid\"\n    else\n        flash[:notice]= \"failed\"\n        flash[:color]=\"invalid\"\n    end\n    render \"new\"\n  end\nend\n</code></pre>\n\n<blockquote>\n  <p>new.html.erb</p>\n</blockquote>\n\n<pre><code>&lt;% page_title=\"Signup\" %&gt;\n&lt;div class=\"Sign_Form\"&gt;\n    &lt;h1&gt;Sign up&lt;/h1&gt;\n    &lt;%= form_for(:user, :url =&gt; {:controller =&gt; 'users', :action =&gt; 'create'}) do |f| %&gt;\n    &lt;p&gt; Username:&lt;/br&gt; &lt;%= f.text_field :username %&gt; &lt;/p&gt;\n    &lt;p&gt; Email:&lt;/br&gt; &lt;%= f.text_field :email %&gt; &lt;/p&gt;\n    &lt;p&gt; Password:&lt;/br&gt; &lt;%= f.password_field :password %&gt;&lt;/p&gt;\n    &lt;p&gt; Password Confirmation:&lt;/br&gt; &lt;%= f.password_field :password_confirmation %&gt; &lt;/p&gt;\n    &lt;%= f.submit :Signup %&gt;\n  &lt;% end %&gt;\n  &lt;% if @user.errors.any? %&gt;\n    &lt;ul class=\"Signup_Errors\"&gt;\n    &lt;% for message_error in @user.errors.full_messages %&gt;\n      &lt;li&gt;* &lt;%= message_error %&gt;&lt;/li&gt;\n    &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<blockquote>\n  <p>in app/models/user.rb  </p>\n</blockquote>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  attr_accessor :password\n  EMAIL_REGEX = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i\n  validates :username, :presence =&gt; true, :uniqueness =&gt; true, :length =&gt; { :in =&gt; 3..20 }\n  validates :email, :presence =&gt; true, :uniqueness =&gt; true #:format =&gt; EMAIL_REGEX\n  validates :password, :presence =&gt;true #:confirmation =&gt; true #password_confirmation attr\n  validates_length_of :password, :in =&gt; 6..20, :on =&gt; :create\nend\n</code></pre>\n"}, {"tags": ["ruby", "string", "bytearray"], "comments": [{"owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "edited": false, "score": 0, "creation_date": 1439983147, "post_id": 32093928, "comment_id": 52082525, "body": "which ruby version are you using?"}, {"owner": {"reputation": 173, "user_id": 4795741, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bfe59a0e5bd79d89c57c946048c7b2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thanathan", "link": "https://stackoverflow.com/users/4795741/thanathan"}, "reply_to_user": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "edited": false, "score": 0, "creation_date": 1439983378, "post_id": 32093928, "comment_id": 52082689, "body": "@tompave I&#39;m using 1.9.3"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1439983382, "post_id": 32093928, "comment_id": 52082690, "body": "Where did you get this string from? utf-8 strings never have zero byte in the middle."}, {"owner": {"reputation": 173, "user_id": 4795741, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bfe59a0e5bd79d89c57c946048c7b2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thanathan", "link": "https://stackoverflow.com/users/4795741/thanathan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1439983456, "post_id": 32093928, "comment_id": 52082727, "body": "@SergioTulentsev I&#39;m porting a python script into Ruby. I get the string trough file.read(@length).unpack(&quot;a#{length}&quot;)."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1439983537, "post_id": 32093928, "comment_id": 52082779, "body": "What kind of file is that? Binary? Byte array is rarely also a valid string."}, {"owner": {"reputation": 173, "user_id": 4795741, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bfe59a0e5bd79d89c57c946048c7b2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thanathan", "link": "https://stackoverflow.com/users/4795741/thanathan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1439983642, "post_id": 32093928, "comment_id": 52082849, "body": "@SergioTulentsev Yes it&#39;s a binary file. I got the byte values through debugging the program which shows me the terminated string and the byte values of the string array. In the python script it works, so the file is correct."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1439984438, "post_id": 32093928, "comment_id": 52083390, "body": "I know you don&#39;t want to share the data file but is it possible to share more or the whole code instead of single lines? Is using <code>@length</code> but also <code>length</code> intended? Why are you using <code>String#unpack</code> here?"}, {"owner": {"reputation": 173, "user_id": 4795741, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bfe59a0e5bd79d89c57c946048c7b2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thanathan", "link": "https://stackoverflow.com/users/4795741/thanathan"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1439984773, "post_id": 32093928, "comment_id": 52083604, "body": "@cremno I&#39;ve edited the question to give the class I&#39;m using and the context."}, {"owner": {"reputation": 4688, "user_id": 2116518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwt8F.jpg?s=128&g=1", "display_name": "Nic Nilov", "link": "https://stackoverflow.com/users/2116518/nic-nilov"}, "edited": false, "score": 0, "creation_date": 1439985278, "post_id": 32093928, "comment_id": 52083988, "body": "<code>f.read(@length)</code> already gives you a binary string. No need to use <code>unpack(&#39;a*&#39;)</code> on top of that."}, {"owner": {"reputation": 173, "user_id": 4795741, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bfe59a0e5bd79d89c57c946048c7b2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thanathan", "link": "https://stackoverflow.com/users/4795741/thanathan"}, "reply_to_user": {"reputation": 4688, "user_id": 2116518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwt8F.jpg?s=128&g=1", "display_name": "Nic Nilov", "link": "https://stackoverflow.com/users/2116518/nic-nilov"}, "edited": false, "score": 0, "creation_date": 1439985356, "post_id": 32093928, "comment_id": 52084045, "body": "@NicNilov I know. But I want data to be a string. Not a binary String. In the Python script the output from read gets packes into a string as well, for writing it back to a file later."}, {"owner": {"reputation": 4688, "user_id": 2116518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwt8F.jpg?s=128&g=1", "display_name": "Nic Nilov", "link": "https://stackoverflow.com/users/2116518/nic-nilov"}, "edited": false, "score": 0, "creation_date": 1439985693, "post_id": 32093928, "comment_id": 52084245, "body": "Yes, but you do have non-ascii/unicode characters in it. Is it cleanup what you&#39;re trying to achieve?"}, {"owner": {"reputation": 173, "user_id": 4795741, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bfe59a0e5bd79d89c57c946048c7b2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thanathan", "link": "https://stackoverflow.com/users/4795741/thanathan"}, "reply_to_user": {"reputation": 4688, "user_id": 2116518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwt8F.jpg?s=128&g=1", "display_name": "Nic Nilov", "link": "https://stackoverflow.com/users/2116518/nic-nilov"}, "edited": false, "score": 0, "creation_date": 1439985812, "post_id": 32093928, "comment_id": 52084332, "body": "@NicNilov I know that. But Python seems to be able to handle that. So my question is, why Ruby seems to have problems with the same string.  The purpose of the script is to extract data from the ccache file (where Kerberos tickets are stored) and save them in a .kirbi file, which has a certain structure."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1439986028, "post_id": 32093928, "comment_id": 52084494, "body": "<code>if I access data it gets cut off</code> - We need to see that part of the code and not one that works as expected."}, {"owner": {"reputation": 4688, "user_id": 2116518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwt8F.jpg?s=128&g=1", "display_name": "Nic Nilov", "link": "https://stackoverflow.com/users/2116518/nic-nilov"}, "edited": false, "score": 0, "creation_date": 1439986093, "post_id": 32093928, "comment_id": 52084555, "body": "Ruby is not Python just like Python is not Ruby. You have binary file, so a binary string is what you get. It&#39;s not clear what handling you are trying to do before saving that to another (binary?) file. You probably should handle the data as binary as well instead of trying to convert it to a character string."}, {"owner": {"reputation": 173, "user_id": 4795741, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bfe59a0e5bd79d89c57c946048c7b2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thanathan", "link": "https://stackoverflow.com/users/4795741/thanathan"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1439986105, "post_id": 32093928, "comment_id": 52084566, "body": "@cremno I&#39;m debugging with Aptana Studio 3. I have a breakpoint after I&#39;ve parsed the file. When I access data, it shows me the wrong string."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1439986513, "post_id": 32093928, "comment_id": 52084879, "body": "That sounds like Aptana Studio 3 has a bug. Or can you reproduce it with the good old <code>p</code> debugging?"}], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 4795741, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bfe59a0e5bd79d89c57c946048c7b2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thanathan", "link": "https://stackoverflow.com/users/4795741/thanathan"}, "is_accepted": true, "score": 0, "last_activity_date": 1440058014, "creation_date": 1440058014, "answer_id": 32112830, "question_id": 32093928, "link": "https://stackoverflow.com/questions/32093928/ruby-string-with-a-null-byte/32112830#32112830", "title": "Ruby string with a null byte", "body": "<p>The Problem was, that I used <code>''</code> for my string. With <code>\"\"</code> the zero Byte was interpreted correctly.</p>\n"}], "owner": {"reputation": 173, "user_id": 4795741, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bfe59a0e5bd79d89c57c946048c7b2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thanathan", "link": "https://stackoverflow.com/users/4795741/thanathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1477, "favorite_count": 0, "accepted_answer_id": 32112830, "answer_count": 1, "score": 2, "last_activity_date": 1440058014, "creation_date": 1439982873, "last_edit_date": 1439984750, "question_id": 32093928, "link": "https://stackoverflow.com/questions/32093928/ruby-string-with-a-null-byte", "title": "Ruby string with a null byte", "body": "<p>I have this class:</p>\n\n<pre><code>class CountedOctet\n  attr_reader :length, :data\n  def initialize\n    @length = nil\n    @data = \"\"\n  end\n  def parsefile(f)\n    @length, = f.read(4).unpack(\"N\")\n    @data, = f.read(@length).unpack(\"a#{@length}\")\n  end\nend\n</code></pre>\n\n<p>It's ported from <a href=\"https://github.com/rvazarkar/KrbCredExport\" rel=\"nofollow\">https://github.com/rvazarkar/KrbCredExport</a> (which is in Python) to Ruby.</p>\n\n<p>Everything works fine, the files gets read, but if I access data it gets cut off. The length of it is 1163 (which is correct), but at position 152 the byte of the string is 0. This seems to terminate the string. Position 153 is correct, so the reading and unpacking seems to have worked correct. Is there any way to stop Ruby from terminating the string at the null byte? </p>\n\n<p>The python script works with the same file, so it shouldn't be a corrupt/wrong file.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1958, "user_id": 515991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/319b6176a2b56541cbf44182fd3987a1?s=128&d=identicon&r=PG&f=1", "display_name": "usmanali", "link": "https://stackoverflow.com/users/515991/usmanali"}, "edited": false, "score": 0, "creation_date": 1439982861, "post_id": 32093873, "comment_id": 52082328, "body": "You should send it as multipart form data"}, {"owner": {"reputation": 321, "user_id": 1660935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e223bc5df2a4f9024a30c557023f134?s=128&d=identicon&r=PG", "display_name": "xenover", "link": "https://stackoverflow.com/users/1660935/xenover"}, "edited": false, "score": 0, "creation_date": 1439983063, "post_id": 32093873, "comment_id": 52082458, "body": "See if this thread is of any assistance <a href=\"http://stackoverflow.com/questions/2521053/how-to-read-a-user-uploaded-file-without-saving-it-to-the-database\" title=\"how to read a user uploaded file without saving it to the database\">stackoverflow.com/questions/2521053/&hellip;</a>"}, {"owner": {"reputation": 5835, "user_id": 558777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YK58K.jpg?s=128&g=1", "display_name": "Ahmad Ajmi", "link": "https://stackoverflow.com/users/558777/ahmad-ajmi"}, "reply_to_user": {"reputation": 1958, "user_id": 515991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/319b6176a2b56541cbf44182fd3987a1?s=128&d=identicon&r=PG&f=1", "display_name": "usmanali", "link": "https://stackoverflow.com/users/515991/usmanali"}, "edited": false, "score": 0, "creation_date": 1439984440, "post_id": 32093873, "comment_id": 52083392, "body": "Thanks @usmanali this did the trick plus a new work in the method"}, {"owner": {"reputation": 5835, "user_id": 558777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YK58K.jpg?s=128&g=1", "display_name": "Ahmad Ajmi", "link": "https://stackoverflow.com/users/558777/ahmad-ajmi"}, "reply_to_user": {"reputation": 321, "user_id": 1660935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e223bc5df2a4f9024a30c557023f134?s=128&d=identicon&r=PG", "display_name": "xenover", "link": "https://stackoverflow.com/users/1660935/xenover"}, "edited": false, "score": 0, "creation_date": 1439984498, "post_id": 32093873, "comment_id": 52083429, "body": "Thanks @xenover this helps too"}], "answers": [{"tags": [], "owner": {"reputation": 5835, "user_id": 558777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YK58K.jpg?s=128&g=1", "display_name": "Ahmad Ajmi", "link": "https://stackoverflow.com/users/558777/ahmad-ajmi"}, "is_accepted": true, "score": 1, "last_activity_date": 1439983837, "last_edit_date": 1495542347, "creation_date": 1439983837, "answer_id": 32094267, "question_id": 32093873, "link": "https://stackoverflow.com/questions/32093873/read-uploaded-json-file-in-rails/32094267#32094267", "title": "Read uploaded JSON file in Rails", "body": "<p>The solution:</p>\n\n<p>Update the form to send the file as multipart form data as @usmanali advised</p>\n\n<pre><code>= form_tag import_posts_path, multipart: true do\n  = file_field_tag :file\n  = submit_tag \"import\"\n</code></pre>\n\n<p>and then in the controller just <code>read</code> directly into <code>params[:file]</code> as described in this <a href=\"https://stackoverflow.com/a/19893804/558777\">answer</a></p>\n\n<pre><code>def import\n  file = params[:file].read\n  data = JSON.parse(file)\nend\n</code></pre>\n"}], "owner": {"reputation": 5835, "user_id": 558777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YK58K.jpg?s=128&g=1", "display_name": "Ahmad Ajmi", "link": "https://stackoverflow.com/users/558777/ahmad-ajmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1634, "favorite_count": 1, "accepted_answer_id": 32094267, "answer_count": 1, "score": 1, "last_activity_date": 1439983837, "creation_date": 1439982732, "question_id": 32093873, "link": "https://stackoverflow.com/questions/32093873/read-uploaded-json-file-in-rails", "title": "Read uploaded JSON file in Rails", "body": "<p>I'm uploading a JSON file in Rails in order to parse it and then insert into the database without storing the file itself</p>\n\n<p>Form</p>\n\n<pre><code>= form_tag import_posts_path do\n  = file_field_tag :file\n  = submit_tag \"import\"\n</code></pre>\n\n<p>Controller method</p>\n\n<pre><code>def import\n  file = params[:file]\n\n  puts \"file =&gt; \" + file # file =&gt; posts.json\n\n  data = File.read(params[:file]) # Errno::ENOENT at /posts/import No such file or directory @ rb_sysopen - posts.json\n\n  json = JSON.parse(data)\nend\n</code></pre>\n\n<p>routes</p>\n\n<pre><code>resources :posts do\n  collection { post :import }\nend\n</code></pre>\n\n<p>request info in Terminal, and the <code>posts.json</code> is there but I get <code>Errno::ENOENT at /posts/import No such file or directory @ rb_sysopen - posts.json</code></p>\n\n<pre><code>  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"9lzpwyCWclgiI4WA/zho5y1WLCBQtRL7z3FcAn+wc80=\", \"file\"=&gt;\"posts.json\", \"commit\"=&gt;\"import\"}\nfile =&gt; posts.json\nCompleted 500 Internal Server Error in 23ms\n</code></pre>\n"}, {"tags": ["ruby", "filter", "logstash"], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 4490478, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6b815950a738f8b13c21ca3c74d8af36?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/4490478/mike"}, "edited": false, "score": 0, "creation_date": 1440056330, "post_id": 32101546, "comment_id": 52117711, "body": "thank you for answering,b  basically what i need is to memorize columns as field, but i don&#39;t know how my columns will look like, so i cant use regular expressions.. that&#39;s why i used the ruby code... but next line, i should remember those columns"}], "tags": [], "owner": {"reputation": 15576, "user_id": 677561, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/95077e3dc8c640d554cfa97da3dc6131?s=128&d=identicon&r=PG&f=1", "display_name": "Alain Collins", "link": "https://stackoverflow.com/users/677561/alain-collins"}, "is_accepted": false, "score": 1, "last_activity_date": 1440056641, "last_edit_date": 1440056641, "creation_date": 1440003788, "answer_id": 32101546, "question_id": 32093690, "link": "https://stackoverflow.com/questions/32093690/logstash-use-ruby-code-inside-of-a-filter/32101546#32101546", "title": "logstash - use ruby code inside of a filter", "body": "<p>No, csv{} is a filter and ruby{} is a filter, so they don't nest inside each other as you've shown.</p>\n\n<p>You haven't described the problem, but perhaps just using ruby{} is what you're looking for.</p>\n\n<p>EDIT: with more information on the problem, here are some more notes:</p>\n\n<p>Logstash runs one event at a time, so for csv{}, it's processing one line from the file at a time.  Even with the ruby{} filter, you don't get a look at the entire input.</p>\n\n<p>Since the header row is first, however, you should be able to drop into ruby{}, tuck away the columns of this row into a persistent variable, and, for subsequent rows, loop through the fields in ruby and rename them.</p>\n\n<p>You could also extend the csv{} filter to be \"header aware\", which would benefit a good population of logstash users.</p>\n"}], "owner": {"reputation": 597, "user_id": 4490478, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6b815950a738f8b13c21ca3c74d8af36?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/4490478/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7167, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440056641, "creation_date": 1439982210, "question_id": 32093690, "link": "https://stackoverflow.com/questions/32093690/logstash-use-ruby-code-inside-of-a-filter", "title": "logstash - use ruby code inside of a filter", "body": "<p>is it possible to use ruby code inside of a filter? something like this:</p>\n\n<pre><code>filter {\n csv{\n   ruby {\n      code =&gt; \"\n            fieldArray = event['message'].split(',')\n            for field in fieldArray\n                event[field] = field\n            end\n        \"\n        }\n   }\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "polymorphism", "metaprogramming"], "comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1439981891, "post_id": 32093505, "comment_id": 52081622, "body": "Can you give some more details of how you would use this module?"}, {"owner": {"reputation": 193, "user_id": 2483560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MMiZK.png?s=128&g=1", "display_name": "KcC0", "link": "https://stackoverflow.com/users/2483560/kcc0"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1439982292, "post_id": 32093505, "comment_id": 52081941, "body": "I&#39;m basically trying to include this module in all the polymorphic models in my application which can belong_to an STI model."}, {"owner": {"reputation": 193, "user_id": 2483560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MMiZK.png?s=128&g=1", "display_name": "KcC0", "link": "https://stackoverflow.com/users/2483560/kcc0"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1439982795, "post_id": 32093505, "comment_id": 52082270, "body": "@MaxWilliams I&#39;m trying to make the polymorphic instance access the base class of the belonging STI model. If that makes any sense at all. I&#39;ll edit the question to give a better example."}, {"owner": {"reputation": 1958, "user_id": 515991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/319b6176a2b56541cbf44182fd3987a1?s=128&d=identicon&r=PG&f=1", "display_name": "usmanali", "link": "https://stackoverflow.com/users/515991/usmanali"}, "edited": false, "score": 0, "creation_date": 1439983523, "post_id": 32093505, "comment_id": 52082768, "body": "Can you create an example of what would be the outcome you want. Maybe adding the STI model example to OP."}, {"owner": {"reputation": 193, "user_id": 2483560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MMiZK.png?s=128&g=1", "display_name": "KcC0", "link": "https://stackoverflow.com/users/2483560/kcc0"}, "reply_to_user": {"reputation": 1958, "user_id": 515991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/319b6176a2b56541cbf44182fd3987a1?s=128&d=identicon&r=PG&f=1", "display_name": "usmanali", "link": "https://stackoverflow.com/users/515991/usmanali"}, "edited": false, "score": 0, "creation_date": 1439984029, "post_id": 32093505, "comment_id": 52083128, "body": "@usmanali, I&#39;ve added an example for clarity"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 2483560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MMiZK.png?s=128&g=1", "display_name": "KcC0", "link": "https://stackoverflow.com/users/2483560/kcc0"}, "edited": false, "score": 0, "creation_date": 1439984054, "post_id": 32094089, "comment_id": 52083139, "body": "This really doesn&#39;t help me much right now. Thanks though."}], "tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": false, "score": 0, "last_activity_date": 1439983342, "creation_date": 1439983342, "answer_id": 32094089, "question_id": 32093505, "link": "https://stackoverflow.com/questions/32093505/rails-how-to-retrieve-the-polymorphic-type-column-name-for-a-polymorphic-mod/32094089#32094089", "title": "Rails: How to retrieve the polymorphic &#39;_type&#39; column name for a polymorphic model dynamically?", "body": "<p>You might be interested on looking at <a href=\"https://github.com/makandra/modularity\" rel=\"nofollow\">Modularity</a> gem so you could pass variables when you're including the Module. Haven't really tried it though. Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 219, "user_id": 200006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91ada9f9f71352c92ad734eceb800d7d?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/200006/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1508179708, "creation_date": 1508179708, "answer_id": 46777147, "question_id": 32093505, "link": "https://stackoverflow.com/questions/32093505/rails-how-to-retrieve-the-polymorphic-type-column-name-for-a-polymorphic-mod/46777147#46777147", "title": "Rails: How to retrieve the polymorphic &#39;_type&#39; column name for a polymorphic model dynamically?", "body": "<p>We do something like this:</p>\n\n<pre><code>module Shared::PolymorphicAnnotator\n  extend ActiveSupport::Concern\n\n  class_methods do\n    # @return [String]\n    #    the polymorphic _id column\n    def annotator_id\n      reflections[annotator_reflection].foreign_key.to_s\n    end\n\n    # @return [String]\n    #    the polymorphic _type column\n    def annotator_type\n      reflections[annotator_reflection].foreign_type\n    end \n  end\n\n  included do\n    # Concern implementation macro\n    def self.polymorphic_annotates(polymorphic_belongs, foreign_key = nil)\n      belongs_to polymorphic_belongs.to_sym, polymorphic: true, foreign_key: (foreign_key.nil? ? (polymorphic_belongs.to_s + '_id').to_s : polymorphic_belongs.to_s)\n      alias_attribute :annotated_object, polymorphic_belongs.to_sym \n\n      define_singleton_method(:annotator_reflection){polymorphic_belongs.to_s} \n    end\n\n    attr_accessor :annotated_global_entity \n\n    # @return [String]\n    #   the global_id of the annotated object\n    def annotated_global_entity\n      annotated_object.to_global_id if annotated_object.present?\n    end\n\n    # @return [True]\n    #    set the object when passed a global_id String\n    def annotated_global_entity=(entity)\n      o = GlobalID::Locator.locate entity\n\n      write_attribute(self.class.annotator_id, o.id)\n      write_attribute(self.class.annotator_type, o.class.base_class)\n      true\n    end\n  end\nend\n</code></pre>\n\n<p>In your model:</p>\n\n<pre><code>class Foo\n   include Shared::PolymorphicAnnotator\n   polymorphic_annotates('belongs_to_name', 'foreign_key')\n end\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 2483560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MMiZK.png?s=128&g=1", "display_name": "KcC0", "link": "https://stackoverflow.com/users/2483560/kcc0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 942, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1508179708, "creation_date": 1439981665, "last_edit_date": 1439983992, "question_id": 32093505, "link": "https://stackoverflow.com/questions/32093505/rails-how-to-retrieve-the-polymorphic-type-column-name-for-a-polymorphic-mod", "title": "Rails: How to retrieve the polymorphic &#39;_type&#39; column name for a polymorphic model dynamically?", "body": "<p>I basically want to create a concern which will be included in all the polymorphic models. This concern needs to have a dynamic setter method which which sets the value for the '_type' column.</p>\n\n<pre><code>module StiPolymorphable\n  extend ActiveSupport::Concern\n\n  included do\n    define_method \"#{magic_method_to_get_type_column}=\" do |type_field|\n      super(type_field.to_s.classify.constantize.base_class.to_s)\n    end\n  end\nend\n</code></pre>\n\n<p>I basically want to access all the addresses of a Parent instance instead of a Person instance.</p>\n\n<p>Example -\nSuppose I have the following classes</p>\n\n<pre><code>class Person &lt; ActiveRecord::Base\nend\n\nclass Parent &lt; Person end\nclass Teacher &lt; Person end\n\nclass Address &lt; ActiveRecord::Base\n  include StiPolymorphable\n\n  belongs_to :addressable, polymorphic: true\nend\n</code></pre>\n\n<p>Right now if I try to access the addresses of a Parent it gives me zero records since the addressable_type field contains the value 'Person'.</p>\n\n<pre><code> Parent.first.addresses =&gt; #&lt;ActiveRecord::Associations::CollectionProxy []&gt; \n Person.first.addresses =&gt; #&lt;ActiveRecord::Associations::CollectionProxy [#&lt;Address id: .....&gt;]&gt; \n</code></pre>\n"}, {"tags": ["javascript", "css", "ruby", "sass", "gulp"], "comments": [{"owner": {"reputation": 8789, "user_id": 530653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54862ae62a03a7b55655240b91370281?s=128&d=identicon&r=PG", "display_name": "RobW", "link": "https://stackoverflow.com/users/530653/robw"}, "edited": false, "score": 0, "creation_date": 1439999811, "post_id": 32092898, "comment_id": 52095168, "body": "What&#39;s the error you&#39;re trying to log? If it&#39;s a quick fix I can help here, otherwise let&#39;s move it to the issue tracker."}, {"owner": {"reputation": 563, "user_id": 5151345, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d509efccecaf805b047f2d14f029b44?s=128&d=identicon&r=PG&f=1", "display_name": "Larry Lawless", "link": "https://stackoverflow.com/users/5151345/larry-lawless"}, "reply_to_user": {"reputation": 8789, "user_id": 530653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54862ae62a03a7b55655240b91370281?s=128&d=identicon&r=PG", "display_name": "RobW", "link": "https://stackoverflow.com/users/530653/robw"}, "edited": false, "score": 0, "creation_date": 1440006092, "post_id": 32092898, "comment_id": 52098714, "body": "Just general sass to css compilation errors. The plugin page states that it will throw errors and that they can be handled with the error event. But when I force a syntax error, the error gets logged to the console by the implementation code of the sass plugin and no error is ever thrown and thus my logError handler in the code never gets invoked. It&#39;s a shame because I call the useful gutil.beep method in my generic error handler to notify. The sass plugin does not notify when there&#39;s an error, but logs to the console silently."}, {"owner": {"reputation": 563, "user_id": 5151345, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d509efccecaf805b047f2d14f029b44?s=128&d=identicon&r=PG&f=1", "display_name": "Larry Lawless", "link": "https://stackoverflow.com/users/5151345/larry-lawless"}, "reply_to_user": {"reputation": 8789, "user_id": 530653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54862ae62a03a7b55655240b91370281?s=128&d=identicon&r=PG", "display_name": "RobW", "link": "https://stackoverflow.com/users/530653/robw"}, "edited": false, "score": 0, "creation_date": 1440006342, "post_id": 32092898, "comment_id": 52098851, "body": "Thank you, could you do that? I don&#39;t use github, also I&#39;m running this on windows 7 if it makes any difference"}], "answers": [{"comments": [{"owner": {"reputation": 563, "user_id": 5151345, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d509efccecaf805b047f2d14f029b44?s=128&d=identicon&r=PG&f=1", "display_name": "Larry Lawless", "link": "https://stackoverflow.com/users/5151345/larry-lawless"}, "edited": false, "score": 0, "creation_date": 1440664034, "post_id": 32188203, "comment_id": 52369479, "body": "Thank you! It works with that option yes.  I digged around in gulp-ruby-sass/logger.js  On line 40: gutil.log(data);  The compilation errors are logged through there as you know.  Is it not reliable to add another &quot;else if&quot; clause before the &quot;else&quot; and check the &quot;data&quot; variable output message for the string &quot;Invalid CSS&quot; and emit the error event on the stream if so? That string seems to be output in all compilation error.      else if (/Invalid CSS/.test(data))     {stream.emit(&quot;error&quot;, new Error(data)); }"}, {"owner": {"reputation": 8789, "user_id": 530653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54862ae62a03a7b55655240b91370281?s=128&d=identicon&r=PG", "display_name": "RobW", "link": "https://stackoverflow.com/users/530653/robw"}, "reply_to_user": {"reputation": 563, "user_id": 5151345, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d509efccecaf805b047f2d14f029b44?s=128&d=identicon&r=PG&f=1", "display_name": "Larry Lawless", "link": "https://stackoverflow.com/users/5151345/larry-lawless"}, "edited": false, "score": 0, "creation_date": 1440691040, "post_id": 32188203, "comment_id": 52388471, "body": "We could. I got a little worried about parsing stdout/err after I found this behavior: <a href=\"https://github.com/sass/sass/issues/1715#issuecomment-98213569\" rel=\"nofollow noreferrer\">github.com/sass/sass/issues/1715#issuecomment-98213569</a>"}, {"owner": {"reputation": 8789, "user_id": 530653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54862ae62a03a7b55655240b91370281?s=128&d=identicon&r=PG", "display_name": "RobW", "link": "https://stackoverflow.com/users/530653/robw"}, "reply_to_user": {"reputation": 563, "user_id": 5151345, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d509efccecaf805b047f2d14f029b44?s=128&d=identicon&r=PG&f=1", "display_name": "Larry Lawless", "link": "https://stackoverflow.com/users/5151345/larry-lawless"}, "edited": false, "score": 0, "creation_date": 1440691221, "post_id": 32188203, "comment_id": 52388612, "body": "But I don&#39;t think we&#39;re going to get away from using the command line executable, which displays the broken output issue. We can throw errors during the task, but not with reliably good error messages. I&#39;m going to look at this again after the next group of issues I take care of."}], "tags": [], "owner": {"reputation": 8789, "user_id": 530653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54862ae62a03a7b55655240b91370281?s=128&d=identicon&r=PG", "display_name": "RobW", "link": "https://stackoverflow.com/users/530653/robw"}, "is_accepted": false, "score": 1, "last_activity_date": 1440691254, "last_edit_date": 1440691254, "creation_date": 1440437452, "answer_id": 32188203, "question_id": 32092898, "link": "https://stackoverflow.com/questions/32092898/gulp-ruby-sass-plugin-not-throwing-error-only-logging-the-error-itself/32188203#32188203", "title": "gulp-ruby-sass plugin not throwing error, only logging the error itself", "body": "<p>Just fixed this today actually. Use the <code>emitCompileError</code> option in version 1.3.0. </p>\n\n<p>Note we can't log specific errors because:</p>\n\n<ul>\n<li>Sass doesn't output them as errors, just as stderr and stdout depending on whether you're compiling a single file or a directory</li>\n<li>node.js stderr and stdout message lines are not guaranteed to be made available in the group they were originally emitted in, so we can't parse the output reliably. <a href=\"https://github.com/sass/sass/issues/1715#issuecomment-98213569\" rel=\"nofollow\">https://github.com/sass/sass/issues/1715#issuecomment-98213569</a></li>\n</ul>\n\n<p>I may do some behind the scenes line-by-line parsing to fix this in the future.</p>\n\n<p>For more info see the gulp-ruby-sass readme and the issue <a href=\"https://github.com/sindresorhus/gulp-ruby-sass/issues/209\" rel=\"nofollow\">https://github.com/sindresorhus/gulp-ruby-sass/issues/209</a>.</p>\n"}], "owner": {"reputation": 563, "user_id": 5151345, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d509efccecaf805b047f2d14f029b44?s=128&d=identicon&r=PG&f=1", "display_name": "Larry Lawless", "link": "https://stackoverflow.com/users/5151345/larry-lawless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440691254, "creation_date": 1439980061, "question_id": 32092898, "link": "https://stackoverflow.com/questions/32092898/gulp-ruby-sass-plugin-not-throwing-error-only-logging-the-error-itself", "title": "gulp-ruby-sass plugin not throwing error, only logging the error itself", "body": "<p>On the page for gulp ruby sass <a href=\"https://www.npmjs.com/package/gulp-ruby-sass/\" rel=\"nofollow\">https://www.npmjs.com/package/gulp-ruby-sass/</a></p>\n\n<p>It says \"Handle Sass errors with an on('error', cb) listener. gulp-ruby-sass throws errors like a gulp plugin, but streams the erroring files so you can see Sass errors in your browser too.\"</p>\n\n<p>Then I should be able to log the error that it says it throws but when an error happens it is logged to the console and my error callback is never invoked, this is my code:</p>\n\n<pre><code>gulp.task(\"css\", function() {\n\n   return sass(paths.css.in)\n          .on('error', logError)\n          .pipe(gulp.dest(paths.css.out));\n\n});\n</code></pre>\n\n<p>Am I doing something wrong?</p>\n"}, {"tags": ["ruby", "bitwise-operators", "fixnum"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1439980078, "post_id": 32092811, "comment_id": 52080365, "body": "What does the definition of <code>flag</code> look like in <code>my_user</code>&#39;s class?"}, {"owner": {"reputation": 853, "user_id": 3083321, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b89a0aec6a8d868f2d37ae7e2d911e24?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/3083321/mat"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1439980172, "post_id": 32092811, "comment_id": 52080421, "body": "It is a column in the table User (generated with Rails)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1439981203, "post_id": 32092811, "comment_id": 52081142, "body": "There&#39;s no <code>&amp;~</code> operator, <code>&amp;</code> and <code>~</code> are separate operators."}], "answers": [{"comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 2, "creation_date": 1439980277, "post_id": 32092948, "comment_id": 52080499, "body": "Why not simply <code>my_user.flag &amp; ~flag</code>?"}, {"owner": {"reputation": 853, "user_id": 3083321, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b89a0aec6a8d868f2d37ae7e2d911e24?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/3083321/mat"}, "edited": false, "score": 0, "creation_date": 1439980433, "post_id": 32092948, "comment_id": 52080613, "body": "Indeed it works. I do not really understand however. I thought the columns were meant to be used as attributes and not methods. Thanks anyway."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "reply_to_user": {"reputation": 853, "user_id": 3083321, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b89a0aec6a8d868f2d37ae7e2d911e24?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/3083321/mat"}, "edited": false, "score": 0, "creation_date": 1439980481, "post_id": 32092948, "comment_id": 52080651, "body": "@Mat see my previous comment and Jesse&#39;s answer. Without the parentheses, Ruby thinks you are passing an argument to the <i>setter</i> for the <code>flag</code> attribute in the <code>User</code> class."}, {"owner": {"reputation": 853, "user_id": 3083321, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b89a0aec6a8d868f2d37ae7e2d911e24?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/3083321/mat"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1439980557, "post_id": 32092948, "comment_id": 52080704, "body": "@lurker Oh ok. That&#39;s because there&#39;s a setter ! Indeed, that&#39;s clear now. Thank you !"}, {"owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1439980911, "post_id": 32092948, "comment_id": 52080941, "body": "@cremno offers a more commonly seen syntax by moving the <code>~</code> adjacent to <code>flag</code>; unary operators are usually flush with their operands. I&#39;ve also updated my answer to include @lurker&#39;s suggestion for alternate <code>()</code> placement."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1439981072, "post_id": 32092948, "comment_id": 52081047, "body": "@lurker: Of course, there are other ways one could write it but I think the one in my comment is the most preferable one (<a href=\"https://github.com/bbatsov/ruby-style-guide#no-args-no-parens\" rel=\"nofollow noreferrer\">no unnecessary parentheses</a>, it doesn&#39;t \u201cpretend\u201d a <code>&amp;~</code> operator exists)."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1439981547, "post_id": 32092948, "comment_id": 52081370, "body": "@cremno ah yes. If the OP wrote the expression as the operators are intended to mean, then the problem would not occur."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "reply_to_user": {"reputation": 853, "user_id": 3083321, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b89a0aec6a8d868f2d37ae7e2d911e24?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/3083321/mat"}, "edited": false, "score": 0, "creation_date": 1439981612, "post_id": 32092948, "comment_id": 52081419, "body": "@Mat see cremno&#39;s comment regarding how the operators are written, which also resolves the error (it disambiguates the expression, and more properly represents the semantics of the operators). You have a bitwise and (<code>&amp;</code>) and a bitwise complement (<code>~</code>), not a single <code>&amp;~</code> operator, so it&#39;s more proper to write, <code>a &amp; ~b</code>."}], "tags": [], "owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "is_accepted": true, "score": 4, "last_activity_date": 1440052145, "last_edit_date": 1440052145, "creation_date": 1439980175, "answer_id": 32092948, "question_id": 32092811, "link": "https://stackoverflow.com/questions/32092811/typeerror-wrong-argument-type-with-ruby-operator/32092948#32092948", "title": "TypeError: wrong argument type with Ruby &amp;~ operator", "body": "<p>The difference between <code>1 &amp;~ 128</code> and <code>my_user.flag &amp;~ flag</code> is that the second expression involves a dot-method call. That changes the way the subsequent tokens are interpreted.</p>\n\n<p>Try this:</p>\n\n<pre><code># works\nmy_user.flag() &amp;~ flag\n\n# also works\n(my_user.flag) &amp;~ flag\n\n# best\nmy_user.flag &amp; ~flag\n</code></pre>\n\n<p>You'll find that it works. This is because adding <code>()</code> or moving <code>~</code> changes the order of operations to be more in line with what you expected.</p>\n\n<p>The original method call you're using is actually interpreted by Ruby as:</p>\n\n<pre><code># bad\nmy_user.flag(&amp;(~flag))\n</code></pre>\n\n<p>This order of operations first flips the bits in <code>flag</code> by applying the <code>~</code> operator, then attempts to call <code>to_proc</code> on the resulting <code>Fixnum</code> because of the application of the <code>&amp;</code> (cast-as-block) operator, and then finally attempts (had that not thrown a <code>TypeError</code>) to pass it as a block argument to the <code>User#flag</code> method.</p>\n"}], "owner": {"reputation": 853, "user_id": 3083321, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b89a0aec6a8d868f2d37ae7e2d911e24?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/3083321/mat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 0, "accepted_answer_id": 32092948, "answer_count": 1, "score": 5, "last_activity_date": 1440052145, "creation_date": 1439979814, "question_id": 32092811, "link": "https://stackoverflow.com/questions/32092811/typeerror-wrong-argument-type-with-ruby-operator", "title": "TypeError: wrong argument type with Ruby &amp;~ operator", "body": "<p>I try to compare flags in my Ruby application.</p>\n\n<p>I have this code :</p>\n\n<pre><code>if self.flag &amp;~ flag == self.flag\n        return false\n</code></pre>\n\n<p>But it won't run. I've narrowed the problem to this :</p>\n\n<pre><code>irb(main):020:0&gt; my_user.flag\n=&gt; 1\nirb(main):021:0&gt; flag\n=&gt; 128\nirb(main):022:0&gt; my_user.flag.class\n=&gt; Fixnum\nirb(main):023:0&gt; flag.class\n=&gt; Fixnum\nirb(main):024:0&gt; my_user.flag &amp;~ flag\nTypeError: wrong argument type Fixnum (expected Proc)\n</code></pre>\n\n<p>That is really disturbing since it works like this :</p>\n\n<pre><code>irb(main):025:0&gt; 1 &amp;~ 128\n=&gt; 1\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "encoding"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439979271, "post_id": 32092482, "comment_id": 52079870, "body": "What is the proper char, i.e. what&#39;s your expected output?"}, {"owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439979322, "post_id": 32092482, "comment_id": 52079895, "body": "it is something like &quot;&#232;&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "edited": false, "score": 0, "creation_date": 1439979520, "post_id": 32092675, "comment_id": 52080018, "body": "I have red about this. But my concern is, why it indicates me that is Ascii-8bit? And, I need to deal with lot of different encoded text ( I work on emails ), so this code will cause problems with all charset different from Iso-8859"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "edited": false, "score": 0, "creation_date": 1439979959, "post_id": 32092675, "comment_id": 52080299, "body": "@ciaoben emails usually contain a header specifying the encoding, something like <code>Content-Type: text&#47;plain; charset=&quot;iso-8859-1&quot;</code>. But any decent email library should be able to handle this for you. Don&#39;t reinvent the wheel ;-)"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1439979523, "last_edit_date": 1439979523, "creation_date": 1439979391, "answer_id": 32092675, "question_id": 32092482, "link": "https://stackoverflow.com/questions/32092482/how-to-properly-handle-invalid-bytes-in-utf-8-strings/32092675#32092675", "title": "How to properly handle invalid bytes in UTF-8 strings?", "body": "<p>Your string seems to be <a href=\"https://en.wikipedia.org/wiki/ISO/IEC_8859-1\" rel=\"nofollow\">ISO-8859-1</a> encoded. This should work:</p>\n\n<pre><code>str = \"quindi \\xE8 al \\r\\ngoverno\"\n\nstr.force_encoding('ISO-8859-1').encode('UTF-8')\n#=&gt; \"quindi \u00e8 al \\r\\ngoverno\"\n</code></pre>\n\n<p>Note that you have to use double quotes.</p>\n"}], "owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1453483720, "creation_date": 1439978833, "last_edit_date": 1453483720, "question_id": 32092482, "link": "https://stackoverflow.com/questions/32092482/how-to-properly-handle-invalid-bytes-in-utf-8-strings", "title": "How to properly handle invalid bytes in UTF-8 strings?", "body": "<p>I have a string with encoding ASCII-8BIT:</p>\n\n<pre><code>str = 'quindi \\xE8 al \\r\\ngoverno'\n</code></pre>\n\n<p>I want to transcode it to UTF-8, for not having problems with char visualization.\nNaturally, <code>\\xE8</code> is not a valid sequence in UTF-8, so I get the error when I try to:</p>\n\n<pre><code>str.encode 'utf-8'\n</code></pre>\n\n<p>Which returns:</p>\n\n<pre><code>UndefinedConversionError \"\\xE8\" from ASCII-8BIT to UTF-8\n</code></pre>\n\n<p>Reading the docs about encode method, and I came up with this solution:</p>\n\n<pre><code>encode('UTF-8', invalid: :replace, undef: :replace)\n</code></pre>\n\n<p>This way all the invalid sequences are replaced with the <code>?</code>. But if I want to display the proper char instead of the <code>?</code>. I have different escape sequences in this text, <code>\\xE8</code>, <code>\\xE0</code> ...</p>\n\n<p>Is there a way to automatically replace them with the right escaped char?</p>\n"}, {"tags": ["ruby", "rabbitmq", "rack", "bunny"], "comments": [{"owner": {"reputation": 2053, "user_id": 342013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3eb24dc767e178a2c7d67f1ee1af11f?s=128&d=identicon&r=PG", "display_name": "old_sound", "link": "https://stackoverflow.com/users/342013/old-sound"}, "edited": false, "score": 0, "creation_date": 1442486902, "post_id": 32092066, "comment_id": 53106222, "body": "There have been some fixes on that area on the latest bunny releases. Perhaps upgrade to 2.0+ See <a href=\"https://github.com/ruby-amqp/bunny/blob/master/ChangeLog.md#non-blocking-writes\" rel=\"nofollow noreferrer\">github.com/ruby-amqp/bunny/blob/master/&hellip;</a>"}], "owner": {"reputation": 1976, "user_id": 767166, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/6a07e1b5f02cf61303cd2c3e97618a84?s=128&d=identicon&r=PG", "display_name": "cmthakur", "link": "https://stackoverflow.com/users/767166/cmthakur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1439977771, "creation_date": 1439977771, "question_id": 32092066, "link": "https://stackoverflow.com/questions/32092066/connection-level-error-unexpected-frame-hutch", "title": "Connection-level error: UNEXPECTED_FRAME hutch", "body": "<p>I have producers that produce message in fanout manner via hutch where consumers to consume those message. \nHere I have a single RabbitMq server where multiple instances for hutch runs.</p>\n\n<p>Everything works fine in local/testing environment, but the hutch instance get crash in production(every hour) raising error</p>\n\n<pre><code>/home/deploy/.gem/ruby/2.2.2/gems/bunny-1.7.0/lib/bunny/concurrent/continuation_queue.rb:25:in `pop': Connection-level error: UNEXPECTED_FRAME - expected content body, got non content body frame instead (Bunny::UnexpectedFrame)\nfrom /home/deploy/.gem/ruby/2.2.2/gems/bunny-1.7.0/lib/bunny/concurrent/continuation_queue.rb:25:in `block in poll'\n</code></pre>\n\n<p>After searching through numerous posts here on stackoverflow and elsewhere, I've come to understand that this error has to do with a race condition.</p>\n\n<p>BUT I didn't found any solution implemented for <a href=\"https://github.com/gocardless/hutch\" rel=\"nofollow\">hutch</a>.</p>\n\n<p>I will be glad enough if someone help me here.</p>\n\n<p><strong>Prerequisite:</strong></p>\n\n<ul>\n<li>RabbitMQ 3.3.4 </li>\n<li>hutch (0.15.0)\n\n<ul>\n<li>bunny (>= 1.7.0)</li>\n<li>carrot-top (~> 0.0.7)</li>\n<li>multi_json (~> 1.5)</li>\n</ul></li>\n</ul>\n"}, {"tags": ["ruby", "regex"], "answers": [{"comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1439979076, "post_id": 32092467, "comment_id": 52079741, "body": "Just added <code>[zZ]</code> as per the <a href=\"http://ruby-doc.org/core-2.2.0/Regexp.html\" rel=\"nofollow noreferrer\">RegExp docs</a>, there is also <code>\\Z</code> anchor: <i>Matches end of string. If string ends with a newline, it matches just before newline</i>. I shortened the number of lines, my initial code was just a bit more illustrative."}, {"owner": {"reputation": 18778, "user_id": 963396, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ee19b0668e0a34136ee53f7838733028?s=128&d=identicon&r=PG", "display_name": "X&#229;pplI&#39;-I0llwlg&#39;I  -", "link": "https://stackoverflow.com/users/963396/x%c3%a5ppli-i0llwlgi"}, "edited": false, "score": 1, "creation_date": 1439979577, "post_id": 32092467, "comment_id": 52080056, "body": "Thank you! Rails emits the error <code>Regexp anchor characters are not allowed in routing requirements</code> when you use anchors in route constraints. This solves that problem. :)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 18778, "user_id": 963396, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ee19b0668e0a34136ee53f7838733028?s=128&d=identicon&r=PG", "display_name": "X&#229;pplI&#39;-I0llwlg&#39;I  -", "link": "https://stackoverflow.com/users/963396/x%c3%a5ppli-i0llwlgi"}, "edited": false, "score": 0, "creation_date": 1439980555, "post_id": 32092467, "comment_id": 52080702, "body": "@X&#229;pplI&#39;-I0llwlg&#39;I- wouldn&#39;t it be easier to solve it the other way round, i.e. start with an anchor-less regex that can be used in your routes and <i>add</i> the anchors later on?"}, {"owner": {"reputation": 18778, "user_id": 963396, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ee19b0668e0a34136ee53f7838733028?s=128&d=identicon&r=PG", "display_name": "X&#229;pplI&#39;-I0llwlg&#39;I  -", "link": "https://stackoverflow.com/users/963396/x%c3%a5ppli-i0llwlgi"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439981141, "post_id": 32092467, "comment_id": 52081097, "body": "@Stefan The regex is defined in <a href=\"https://github.com/jlindsey/semantic/blob/master/lib/semantic/version.rb\" rel=\"nofollow noreferrer\">a third-party gem</a>, so I don&#39;t have any control over it. Sure, I could simply not use the gem&#39;s regex and define my own anchor-less version, but I don&#39;t want to miss out on future updates to the gem&#39;s regex."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1439981333, "post_id": 32092467, "comment_id": 52081240, "body": "<code>remove_anchors(&#47;(\\A)&#47;) # =&gt; &#47;(\\A)&#47;</code>"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1439982929, "post_id": 32092467, "comment_id": 52082377, "body": "@J&#246;rgWMittag: I agree there may be issues when an expressions is more complex. <b>X&#229;pplI&#39;-I0llwlg&#39;I-</b>: Once you come across it, please drop a comment here. I will check something meanwhile, and update the answer eventually."}], "tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 4, "last_activity_date": 1439979241, "last_edit_date": 1439979241, "creation_date": 1439978793, "answer_id": 32092467, "question_id": 32092048, "link": "https://stackoverflow.com/questions/32092048/how-to-programmatically-remove-anchors-from-a-regular-expression-in-ruby/32092467#32092467", "title": "How to programmatically remove anchors from a regular expression in Ruby?", "body": "<p>You can use the following function:</p>\n\n<pre><code>def remove_anchors(regex)\n   pattern = regex.source.gsub(/\\A(?:\\\\A|\\^)|(?:\\\\[zZ]|\\$)\\z/, '')\n   return Regexp.new(pattern);\nend\n</code></pre>\n\n<p>And here is an <a href=\"http://ideone.com/6nrH41\" rel=\"nofollow\">IDEONE demo</a></p>\n\n<p>The regex literal notation <code>/.../</code> compiles the regex and its string pattern can be obtained via the <em>source</em> property. With <code>gsub</code>, the anchors like <code>^</code>, <code>$</code>, <code>\\A</code> and <code>\\z</code> can be removed from the string pattern. </p>\n"}, {"comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1439981607, "post_id": 32093452, "comment_id": 52081415, "body": "No one is talking about modifying <i>existing</i> regexp object, but about <i>rebuilding</i> it."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1439981699, "post_id": 32093452, "comment_id": 52081489, "body": "The OP is talking about it, he even explicitly uses both the word &quot;exisitng&quot; and the word &quot;modify&quot;: &quot;It is even possible to modify an existing regular expression like this in Ruby?&quot;"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1439981528, "creation_date": 1439981528, "answer_id": 32093452, "question_id": 32092048, "link": "https://stackoverflow.com/questions/32092048/how-to-programmatically-remove-anchors-from-a-regular-expression-in-ruby/32093452#32093452", "title": "How to programmatically remove anchors from a regular expression in Ruby?", "body": "<blockquote>\n  <p>It is even possible to modify an existing regular expression like this in Ruby?</p>\n</blockquote>\n\n<p>No, it is not possible to modify an existing <code>Regexp</code> <em>at all</em> in Ruby.</p>\n\n<p>You can just look at <a href=\"http://ruby-doc.org/core/Regexp.html\" rel=\"nofollow\">the available methods</a> and you will immediately see that there are no mutating methods.</p>\n\n<p>There is exactly <em>one</em> method, which allows you to build a <em>new</em> <code>Regexp</code> from one or more existing <code>Regexp</code>s, namely <a href=\"http://ruby-doc.org/core-2.2.2/Regexp.html#method-c-union\" rel=\"nofollow\"><code>Regexp::union</code></a>, but that won't help you here.</p>\n\n<p>Pretty much the only thing you <em>can</em> do, is get a <code>String</code> representation of the <code>Regexp</code> using <a href=\"http://ruby-doc.org/core-2.2.2/Regexp.html#method-i-to_s\" rel=\"nofollow\"><code>Regexp#to_s</code></a>, then parse that <code>String</code>, remove the anchors textually, and create a new <code>Regexp</code> from the <code>String</code> via <a href=\"http://ruby-doc.org/core-2.2.2/Regexp.html#method-c-new\" rel=\"nofollow\"><code>Regexp::new</code></a>. Note, however, that the syntax of Ruby <code>Regexp</code>s is anything but trivial to parse, this is not a simple endeavor.</p>\n\n<p>It appears there is no documentation for the syntax of Ruby's <code>Regexp</code>s, so you will have to look at the parser: <a href=\"https://github.com/ruby/ruby/blob/trunk/regparse.c\" rel=\"nofollow\"><code>regparse.c</code></a></p>\n"}, {"comments": [{"owner": {"reputation": 18778, "user_id": 963396, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ee19b0668e0a34136ee53f7838733028?s=128&d=identicon&r=PG", "display_name": "X&#229;pplI&#39;-I0llwlg&#39;I  -", "link": "https://stackoverflow.com/users/963396/x%c3%a5ppli-i0llwlgi"}, "edited": false, "score": 0, "creation_date": 1440001971, "post_id": 32095563, "comment_id": 52096383, "body": "Pretty cool! But I need it to replace the <code>id</code> segment of a resource&#39;s routes. Do you know how to do that? For reference, this is currently my routing setup: <code>resources :packages, constraints: { id: remove_anchors(Semantic::Version::SemVerRegexp) }</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 18778, "user_id": 963396, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ee19b0668e0a34136ee53f7838733028?s=128&d=identicon&r=PG", "display_name": "X&#229;pplI&#39;-I0llwlg&#39;I  -", "link": "https://stackoverflow.com/users/963396/x%c3%a5ppli-i0llwlgi"}, "edited": false, "score": 0, "creation_date": 1440076322, "post_id": 32095563, "comment_id": 52130763, "body": "@X&#229;pplI&#39;-I0llwlg&#39;I- maybe you have to define the routes manually as shown above. After all, <code>resources</code> is just a helper to set up the default CRUD routes."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1439987351, "last_edit_date": 1495542125, "creation_date": 1439987351, "answer_id": 32095563, "question_id": 32092048, "link": "https://stackoverflow.com/questions/32092048/how-to-programmatically-remove-anchors-from-a-regular-expression-in-ruby/32095563#32095563", "title": "How to programmatically remove anchors from a regular expression in Ruby?", "body": "<p>According to <a href=\"https://stackoverflow.com/questions/32092048/how-to-programmatically-remove-anchors-from-a-regular-expression-in-ruby#comment52080056_32092467\">your</a> <a href=\"https://stackoverflow.com/questions/32092048/how-to-programmatically-remove-anchors-from-a-regular-expression-in-ruby#comment52081097_32092467\">comments</a>, you're actually trying to use the <a href=\"https://github.com/jlindsey/semantic/blob/master/lib/semantic/version.rb#L4\" rel=\"nofollow noreferrer\">regular expression</a> from the Semantic gem in your routes:</p>\n\n<pre><code>module Semantic\n  class Version\n    SemVerRegexp = /\\A(\\d+\\.\\d+\\.\\d+)(-([0-9A-Za-z-]+(\\.[0-9A-Za-z-]+)*))?(\\+([0-9A-Za-z-]+(\\.[0-9A-Za-z-]+)*))?\\Z/\n    # ...\n  end\nend\n</code></pre>\n\n<p>According to the <a href=\"http://guides.rubyonrails.org/routing.html#segment-constraints\" rel=\"nofollow noreferrer\">routing docs</a>: (you have already tried this)</p>\n\n<blockquote>\n  <p><code>:constraints</code> takes regular expressions with the restriction that regexp anchors can't be used.</p>\n</blockquote>\n\n<p>But there's another way: can specify <a href=\"http://guides.rubyonrails.org/routing.html#advanced-constraints\" rel=\"nofollow noreferrer\">advanced constraints</a> as a lambda. Here's an example:</p>\n\n<pre><code>Rails.application.routes.draw do\n  get '/some/path/*version_str' =&gt; 'versions#show',\n    format: false,\n    constraints: lambda { |request| \n      Semantic::Version::SemVerRegexp =~ request.params[:version_str]\n    }\nend\n</code></pre>\n\n<p><code>format: false</code> prevents Rails from extracting trailing dots.</p>\n\n<p>Testing the route in <code>rails console</code>:</p>\n\n<pre><code>r = Rails.application.routes\n\nr.recognize_path '/some/path/1.6.5'\n#=&gt; {:controller=&gt;\"versions\", :action=&gt;\"show\", :version_str=&gt;\"1.6.5\"}\n\nr.recognize_path '/some/path/3.7.9-pre.1+revision.15723'\n#=&gt; {:controller=&gt;\"versions\", :action=&gt;\"show\", :version_str=&gt;\"3.7.9-pre.1+revision.15723\"}\n\nr.recognize_path '/some/path/123'\n#=&gt; ActionController::RoutingError: No route matches \"/some/path/123\"\n</code></pre>\n"}], "owner": {"reputation": 18778, "user_id": 963396, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ee19b0668e0a34136ee53f7838733028?s=128&d=identicon&r=PG", "display_name": "X&#229;pplI&#39;-I0llwlg&#39;I  -", "link": "https://stackoverflow.com/users/963396/x%c3%a5ppli-i0llwlgi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 32092467, "answer_count": 3, "score": 3, "last_activity_date": 1439987351, "creation_date": 1439977720, "last_edit_date": 1439984331, "question_id": 32092048, "link": "https://stackoverflow.com/questions/32092048/how-to-programmatically-remove-anchors-from-a-regular-expression-in-ruby", "title": "How to programmatically remove anchors from a regular expression in Ruby?", "body": "<p>Consider:</p>\n\n<pre><code>regex1 = /\\A[a-z0-9\\-\\_]+\\z/\n\nregex2 = remove_anchors(regex1) # =&gt; /[a-z0-9\\-\\_]+/\n</code></pre>\n\n<p>How to implement a <code>remove_anchors</code> function that <em>programmatically</em> removes any <a href=\"http://regular-expressions.info/anchors.html\" rel=\"nofollow\">anchors</a> (<code>\\A</code>, <code>\\z</code>, <code>^</code>, <code>$</code>) from <code>regex1</code>, producing <code>regex2</code>? Is it even possible to modify an existing regular expression like this in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rails-i18n"], "comments": [{"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1439978754, "post_id": 32091962, "comment_id": 52079533, "body": "I am gona go with &quot;because they don&#39;t know about <code>delegate</code> method. &quot;"}, {"owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "reply_to_user": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1439979018, "post_id": 32091962, "comment_id": 52079706, "body": "are there any disadvantages of using delegate?"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 1, "creation_date": 1439980058, "post_id": 32091962, "comment_id": 52080355, "body": "Have a look at <code>delegate</code> source code (yep, this is a method, not a keyword or anything). Under the hood it literally defines a method like yours. The only difference is that it takes some extra options to modify the method, but it is only executed once when module is laoded and the overhead is practically non-existent so in short - there is no measurable difference."}, {"owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "reply_to_user": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1439982440, "post_id": 32091962, "comment_id": 52082031, "body": "Also: it generates custom exception message, so it&#39;s easier to debug <a href=\"https://github.com/rails/rails/blob/master/activesupport/lib/active_support/core_ext/module/delegation.rb#L198\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/master/activesupport/lib/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 4, "last_activity_date": 1440055128, "last_edit_date": 1440055128, "creation_date": 1439980361, "answer_id": 32093014, "question_id": 32091962, "link": "https://stackoverflow.com/questions/32091962/why-people-mostly-wrap-i18n-t-method-instead-of-delegating/32093014#32093014", "title": "Why people mostly wrap I18n.t method instead of delegating?", "body": "<blockquote>\n  <p>Why people tend to not use it?</p>\n</blockquote>\n\n<p>Well, one reason (as mentioned by @BroiSatse) is that people simply don't know about this technique.</p>\n\n<p>From bytecode point of view, there is little difference. <code>delegate</code> generates roughly the same method, with a few additional checks for safety (<code>respond_to?</code>, etc.)</p>\n\n<p>We, in our team, have this rule: <code>delegate</code> should be used to give a hint to <em>external</em> callers that methods are being forwarded to some other object. As a consequence, it should <em>not</em> be used just for \"shortening\" internal invocations of delegated methods. That is, if a method is not called from outside, don't use <code>delegate</code> on it, write the forwarding yourself.</p>\n\n<p>So the choice is based on the message that we want to convey. And yes, we have both forms of delegation to <code>I18n.t</code> in our app :)</p>\n\n<p>For example: </p>\n\n<pre><code># use `delegate`, method is called from outside\nclass User\n  has_one :address\n\n  delegate :country, to: :address\nend\n\n&lt;%= user.country %&gt;\n\n\n# only internal callers, do not use `delegate`\nclass Exporter\n  # delegate :export, to: :handler \n  def call\n    handler.export\n  end\n\n  private\n\n  def handler\n    return something_with_export_method\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 1, "accepted_answer_id": 32093014, "answer_count": 1, "score": 1, "last_activity_date": 1440055128, "creation_date": 1439977530, "last_edit_date": 1439981694, "question_id": 32091962, "link": "https://stackoverflow.com/questions/32091962/why-people-mostly-wrap-i18n-t-method-instead-of-delegating", "title": "Why people mostly wrap I18n.t method instead of delegating?", "body": "<p>I see many examples of</p>\n\n<pre><code>def t(*args)\n  I18n.t(*args)\nend\n</code></pre>\n\n<p>and very few </p>\n\n<pre><code>delegate :t, to: I18n\n</code></pre>\n\n<p>In my honest opinion second solution is semantically better. Why people tend to not use it?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 4100, "user_id": 217756, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/547377f831a0ee3de6df245b7d40cbff?s=128&d=identicon&r=PG", "display_name": "tomsoft", "link": "https://stackoverflow.com/users/217756/tomsoft"}, "edited": false, "score": 0, "creation_date": 1439975257, "post_id": 32090997, "comment_id": 52076989, "body": "is it the only variable which is destroyed? Might be linked to the size of the session , which seems to be already big! I suggest to put many of these attiributes in users data (last sign ip, etc...) and only keep what is really session dependant in session"}, {"owner": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "reply_to_user": {"reputation": 4100, "user_id": 217756, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/547377f831a0ee3de6df245b7d40cbff?s=128&d=identicon&r=PG", "display_name": "tomsoft", "link": "https://stackoverflow.com/users/217756/tomsoft"}, "edited": false, "score": 0, "creation_date": 1439975364, "post_id": 32090997, "comment_id": 52077053, "body": "i thought so but even after removing user object from session it sometimes retains in session and sometimes gets deleted."}, {"owner": {"reputation": 4100, "user_id": 217756, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/547377f831a0ee3de6df245b7d40cbff?s=128&d=identicon&r=PG", "display_name": "tomsoft", "link": "https://stackoverflow.com/users/217756/tomsoft"}, "edited": false, "score": 1, "creation_date": 1439975548, "post_id": 32090997, "comment_id": 52077175, "body": "I suggest to use ActiveRecord session store (session is stored in database and not in browser <a href=\"https://github.com/rails/activerecord-session_store\" rel=\"nofollow noreferrer\">github.com/rails/activerecord-session_store</a> ) just to see if it makes any difference. If you still have any problems, might spend some time on debugging"}], "owner": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439974958, "creation_date": 1439974958, "question_id": 32090997, "link": "https://stackoverflow.com/questions/32090997/how-to-retain-value-in-session-from-one-request-to-another-in-rails", "title": "How to retain value in session from one request to another in rails", "body": "<p>I have a \"theme_layout_id\" variable that i store in session to get that from one request to another. (The last variable in hash)</p>\n\n<pre><code>{\"_csrf_token\"=&gt;\"JGLph2PFnv3iQqPO84bYaNZvbW4EqI2xneFv3fda4c4=\", \"theme_id\"=&gt;4, \"theme_style_id\"=&gt;7,\n  \"sample_feed_user\"=&gt;#&lt;User id: 202, email: \"food@food.com\", username: \"food\", client_id: 184, slug: \"food\",\n   encrypted_password: \"$2a$10$cipeV/AB6K0n1d6Oqp.oWuwChe.A.tJZvRIjvuJ71IuO...\", reset_password_token: nil, reset_password_sent_at: nil,\n    remember_created_at: nil, sign_in_count: 1, current_sign_in_at: \"2015-08-06 19:03:40\", last_sign_in_at: \"2015-08-06 19:03:40\", current_sign_in_ip: \"127.0.0.1\", last_sign_in_ip: \"127.0.0.1\", created_at: \"2015-08-06 19:03:37\", updated_at: \"2015-08-06 19:04:44\", superadmin: false, profile_pic_url: nil, can_publish: true,\n   can_curate: true, signup_notify: true, remember_me: nil, intro_curate_completed: nil, intro_design_completed: nil&gt;, \"theme_layout_id\"=&gt;4}\n</code></pre>\n\n<p>but it keep on destroying when going for another controller request. Only this particular variable keep on lapsing, not others.\nWhat could be possible reason for this.</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "erb"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1439974806, "post_id": 32090850, "comment_id": 52076703, "body": "Looks like <code>@books</code> is empty"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1439974872, "post_id": 32090850, "comment_id": 52076757, "body": "This is because you don&#39;t have any records in <code>books</code> table, so <code>@books</code> is empty. So it has no records to loop here <code>&lt;% @books.each do |b| %&gt;</code>. Create a record and check."}, {"owner": {"reputation": 57, "user_id": 3239012, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/0EC9T.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/3239012/satchel"}, "edited": false, "score": 0, "creation_date": 1439974956, "post_id": 32090850, "comment_id": 52076806, "body": "I should, add I also seeded books, and raked db."}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1439975137, "post_id": 32090850, "comment_id": 52076921, "body": "@user3239012 : can you post your seed file&#39;s code? How you make store data? Please verify that Books table has records. run <code>rails c</code> then do <code>Book.all.count</code> which will return you the total number of records"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1439976330, "post_id": 32090850, "comment_id": 52077724, "body": "Please show us your controller where you create @books relation."}, {"owner": {"reputation": 57, "user_id": 3239012, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/0EC9T.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/3239012/satchel"}, "edited": false, "score": 0, "creation_date": 1439976598, "post_id": 32090850, "comment_id": 52077930, "body": "Added the seeds file"}, {"owner": {"reputation": 57, "user_id": 3239012, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/0EC9T.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/3239012/satchel"}, "edited": false, "score": 0, "creation_date": 1439976655, "post_id": 32090850, "comment_id": 52077975, "body": "And I rain book.all.count and it returned with &quot;0&quot; as books entries. But I&#39;ve ran the rake several times."}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1439976952, "post_id": 32090850, "comment_id": 52078215, "body": "@user3239012 - Please change all <code>create</code> to <code>create!</code> - it will raise an exception if there are any unsatisfied validations. Then rerun seed and fix validation errors."}, {"owner": {"reputation": 57, "user_id": 3239012, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/0EC9T.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/3239012/satchel"}, "edited": false, "score": 0, "creation_date": 1439977688, "post_id": 32090850, "comment_id": 52078727, "body": "&quot;ActiveRecord::UnknownAttributeError: unknown attribute: rank_this_week&quot;  But rank_this_week is clearly in the books active record as &quot;t.integer :rank_this_week&quot;"}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1439978167, "post_id": 32090850, "comment_id": 52079103, "body": "@user3239012 : You might be miss spell somewhere <code>rank_this_week</code> instead of <code>rank_this_week:</code>"}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 3239012, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/0EC9T.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/3239012/satchel"}, "is_accepted": false, "score": 0, "last_activity_date": 1441253022, "creation_date": 1441253022, "answer_id": 32366756, "question_id": 32090850, "link": "https://stackoverflow.com/questions/32090850/ruby-script-in-erb-not-being-read/32366756#32366756", "title": "Ruby script in ERB not being read", "body": "<p>I solved it thanks to a ton of the comments! I realized when I was running rake db:seed nothing was going through but it was most likely a typo causing a seeding error.</p>\n"}], "owner": {"reputation": 57, "user_id": 3239012, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/0EC9T.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/3239012/satchel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441253022, "creation_date": 1439974579, "last_edit_date": 1439976564, "question_id": 32090850, "link": "https://stackoverflow.com/questions/32090850/ruby-script-in-erb-not-being-read", "title": "Ruby script in ERB not being read", "body": "<p><strong>This is the index.html.erb:</strong></p>\n\n<pre><code>&lt;h1&gt;Bookmarks&lt;/h1&gt;\nt\n&lt;% @books.each do |b| %&gt;\n  &lt;div class=\"book\"&gt;\n    e\n    &lt;div class=\"row\"&gt;\n      s\n      &lt;div class=\"col-md-1\"&gt;\n        t\n        &lt;p class=\"rank-this-week\"&gt;\n          &lt;%= b.rank_this_week %&gt; &lt;/p&gt;\n      &lt;/div&gt;\n      &lt;div class=\"col-md-9\"&gt;\n        &lt;p class=\"title\"&gt; &lt;%= b.title %&gt; &lt;/p&gt;\n        &lt;p class=\"author\"&gt;by  &lt;%= b.author %&gt;&lt;/p&gt;\n        &lt;p class=\"publisher\"&gt;(&lt;%= b.publisher %&gt;)&lt;/p&gt;\n        &lt;p class=\"description\"&gt; &lt;%= b.description %&gt; &lt;/p&gt;\n        &lt;%= link_to 'See all Editorial Reviews', b %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"col-md-2\"&gt;\n        &lt;p class=\"weeks-on-list\"&gt;&lt;%= b.weeks_on_list %&gt;&lt;/p&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>This is the books controller</strong></p>\n\n<pre><code> class BooksController &lt; ApplicationController\n  def index\n    @books = Book.all\n  end\n\n  def show\n    @book = Book.find(params[:id])\n    @reviews = @book.reviews\n  end\nend\n</code></pre>\n\n<p>I've routed the resources in <strong>routes.rb</strong> via <code>resources :books</code> and all of the object's elements exist in the <code>db/migrate</code>. And books has been seeded with tons of entries. Also ran <code>rake db:seed</code>.The problem is that when viewing the page, only The <code>&lt;h1&gt;</code> tag bookmarks, and the <code>t</code> are displayed. Nothing else.</p>\n\n<p>Please help, really trying to crack down on RoR. Any help appreciated. </p>\n\n<p>EDIT: The seeds file is pretty big but here is a sample of what it follows consistently. </p>\n\n<pre><code>b1 = Book.create(title: \"American Sniper\", author: \"Chris Kyle, Scott        McEwen, Jim DeFelice\", description: \"A memoir about battlefield experiences in Iraq by the Navy SEALs sniper.\", publisher: \"Morrow/HarperCollins\", weeks_on_list: 63, rank_this_week: 1)\nb2 = Book.create(title: \"Unbroken\", author: \"Laura Hillenbrand\", description: \"An Olympic runner\u00e2\u20ac\u2122s story of survival as a prisoner of the Japanese in World War II after his plane went down over the Pacific.\", publisher: \"Random House\", weeks_on_list: 25, rank_this_week: 2)\nb3 = Book.create(title: \"Wild\", author: \"Cheryl Strayed\", description: \"A woman\u00e2\u20ac\u2122s account of the life-changing 1,100-mile solo hike she took along the Pacific Crest Trail in 1995.\", publisher: \"Vintage\", weeks_on_list: 95, rank_this_week: 3)\n</code></pre>\n"}, {"tags": ["ruby", "json", "sinatra", "opalrb", "react.rb"], "comments": [{"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1440152959, "post_id": 32090775, "comment_id": 52166051, "body": "I&#39;d do a couple of things. Firstly, I&#39;d watch <code>details</code> in the javascript console and see if it&#39;s what you think it is. Secondly, I&#39;d use cURL to send a request with the values as you expect them to be and see how your backend handles that (or set up a spec to do it, hint hint;) One or the other will give you an idea of what&#39;s happening."}, {"owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1440153325, "post_id": 32090775, "comment_id": 52166245, "body": "&quot;I definitely know that details is correctly formatted so that&#39;s not an issue.&quot; &lt;- did you not read this? I wouldn&#39;t have said that if I hadn&#39;t already stuck it in the console to check, the value and the class both before and after being turned into json. I get that your trying to be helpful so thank you but please read the OP, otherwise you end up posting something that&#39;s already been done."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1440200309, "post_id": 32090775, "comment_id": 52190616, "body": "And yet you offered no evidence of that other than your personal assertion. Considering you&#39;re the one with the problem, and the one looking for help, you may consider being a bit less critical of others and tighten up the question. Good luck with getting further help with this ;)"}, {"owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1440405812, "post_id": 32090775, "comment_id": 52241477, "body": "I&#39;m not being critical, If you WANT me to treat people like they&#39;re stupid and can&#39;t think for themselves then ok, I&#39;ll speak slowly. But I don&#39;t because I expect people on this site to have a minimal level of intelligence, so when I say &quot;I definitely know that details is correctly formatted so that&#39;s not an issue&quot; I expect people to read this and go&quot; Op must have already done some basic debugging through the console and seen that it was both  a Json string and that the correct Key values were being sent&quot;;  or are you saying that people are in fact incapable and need be spoken to like idiots?"}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1440412436, "post_id": 32090775, "comment_id": 52245534, "body": "I try not to make assumptions when approaching a problem, it&#39;s not helpful, and I expect the person I&#39;m helping to make allowances for my lack of knowledge of their situation - especially when it is incumbent upon them to provide as much information as they can, which you haven&#39;t done. More importantly, it seems you have an attitude problem more than a technical problem, I hope you get both of them resolved soon."}, {"owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1440415982, "post_id": 32090775, "comment_id": 52247818, "body": "I specifically wrote &quot;<b>correctly formatted</b>&quot;, that means I&#39;ve checked the formatting; to have checked the formatting means I&#39;ve already put it to the console and seen that it&#39;s what I expect, if it wasn&#39;t I would have added it to the OP. The problem , whatever it is, comes after the formatting of the data; adding the correctly formatted data any way would have added nothing to the OP. What I have isn&#39;t an attitude problem, it&#39;s an irritation for people who don&#39;t read the whole question and then go on to ask for redundant information and then complain when it&#39;s pointed out."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1440427620, "post_id": 32090775, "comment_id": 52255838, "body": "I read that, you didn&#39;t <i>verify</i> it. It&#39;s up to you to produce that information, <i>no one else</i>, and if it&#39;s your word vs the Opal project&#39;s code, or the Sinatra project&#39;s code, my bet is the problem is with <b>you</b> - which would fit the general attitude of &quot;it&#39;s not me&quot; that you&#39;re giving off. Write those specs, you should get the basics right before whining to others."}, {"owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1440430549, "post_id": 32090775, "comment_id": 52257857, "body": "Whatever, I&#39;m not going to let this question degenerate any further. If you want to be all pretentious about minor thing, do so. But for the record, what you&#39;re asking for isn&#39;t verification, it&#39;s asking me to treat anyone, you included, like a child that can&#39;t understand basic english. On a website like this I try to hold people to a better standard. That they&#39;re capable of reasoning through the OP and therefore of realising what is &amp; isn&#39;t necessary to come to a conclusion about the problem; adding something just for the sake of adding it is just bloviating and therefore redundant."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1440433054, "post_id": 32090775, "comment_id": 52259409, "body": "You got me, I was wrong, you really are such a good coder that I was wrong to question your word, because your reputation is so high and your abilities so widely acknowledged as brilliant that I should toss aside those from 2 projects that actually have specs, because we&#39;re all humbled by your brilliance. Thank you for not treating us like children and like we all know basic English. If only we could write code and questions as good as you, you&#39;re raising the standard of this place no end! ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "is_accepted": true, "score": 0, "last_activity_date": 1440420318, "last_edit_date": 1495541298, "creation_date": 1440420318, "answer_id": 32182681, "question_id": 32090775, "link": "https://stackoverflow.com/questions/32090775/opal-jquery-ajax-request-sending-malformed-json-string/32182681#32182681", "title": "opal-jquery ajax request sending malformed json string", "body": "<p>After following the advice from <a href=\"https://stackoverflow.com/a/17049683/3536548\">this</a>, specifically I'm doing:</p>\n\n<pre><code>before do\n  request.body.rewind\n  req = request.body.read\n  puts req\n  puts JSON.parse(req)\nend\n</code></pre>\n\n<p>I was able to see that the request arrived at the server correctly and as expected. I don't know why but sinatra was mangling the response in such a away that <code>@params</code> came out as </p>\n\n<pre><code>{\"{\\\"username\\\":\\\"some_user\\\", \\\"password\\\":\\\"some_password\\\"}\"=&gt;nil}\n</code></pre>\n\n<p>so, in the end I'm doing</p>\n\n<pre><code>before do\n    request.body.rewind\n    @request_payload = JSON.parse(request.body.read)\n    request.body.rewind\nend\n</code></pre>\n\n<p>To read out the request body before sinatra gets anything and just reading out the params I need from <code>@request_payload</code>.</p>\n"}], "owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 32182681, "answer_count": 1, "score": 0, "last_activity_date": 1449342927, "creation_date": 1439974395, "last_edit_date": 1449342927, "question_id": 32090775, "link": "https://stackoverflow.com/questions/32090775/opal-jquery-ajax-request-sending-malformed-json-string", "title": "opal-jquery ajax request sending malformed json string", "body": "<p>I'm using opal-jquery to send an ajax request to my backend, but the json payload is malformed when I try to access it on the backend.</p>\n\n<p>When I do <code>puts @params.to_s</code> on my back end, it gets displays as:</p>\n\n<pre><code>{\"{\\\"username\\\":\\\"some_user\\\", \\\"password\\\":\\\"some_password\\\"}\"=&gt;nil}\n</code></pre>\n\n<p>So to get the login details I have to do:</p>\n\n<pre><code>@params.each do |k,v|\n    login_details = JSON.parse(k)\nend\n</code></pre>\n\n<p>My front end (opal) submit request looks like this:</p>\n\n<pre><code>    def handle_login_submit details\n    url = \"/client/api/auth\"\n    HTTP.post url, payload: details.to_json, dataType: 'json' do |response|\n        case response.status_code / 100\n        when 2\n            puts response.status_code\n            self.login_state = :return_success \n            puts response.json\n        when 4\n            self.login_state = :return_failed\n            puts response.status_code\n            puts response.json\n        when 5\n            self.f_message = {type: :error, message: \"There was a server error\" }\n            self.login_state = :return_failed\n        end\n\n    end\n\nend\n</code></pre>\n\n<p>I definitely know that details is correctly formatted so that's not an issue.</p>\n\n<p>I guess in the end, it boils down to is whether it's </p>\n\n<ol>\n<li><p>opal-jquery sending the post request incorrectly</p></li>\n<li><p>sinatra improperly parsing the request.</p></li>\n</ol>\n\n<p>I'm not sure which one it is, but I'm inclined to believe it's the former because it was working fine before I switched to using react.rb for the front end.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rails-activerecord"], "answers": [{"tags": [], "owner": {"reputation": 1118, "user_id": 3243794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QxQsp.jpg?s=128&g=1", "display_name": "nesiseka", "link": "https://stackoverflow.com/users/3243794/nesiseka"}, "is_accepted": false, "score": 0, "last_activity_date": 1439974715, "creation_date": 1439974715, "answer_id": 32090888, "question_id": 32090683, "link": "https://stackoverflow.com/questions/32090683/rails-active-record-different-association-results-into-one-object/32090888#32090888", "title": "Rails Active Record different association results into one object", "body": "<p>I think something like this should work:</p>\n\n<pre><code>def colleagues\n  projects.map(&amp;:all_users)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 744, "user_id": 1885107, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f3cb4e9a996ab41c7980d6954dfb68d?s=128&d=identicon&r=PG", "display_name": "Prakash Laxkar", "link": "https://stackoverflow.com/users/1885107/prakash-laxkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1439974962, "creation_date": 1439974962, "answer_id": 32090999, "question_id": 32090683, "link": "https://stackoverflow.com/questions/32090683/rails-active-record-different-association-results-into-one-object/32090999#32090999", "title": "Rails Active Record different association results into one object", "body": "<p>You can try this with eager loading also.</p>\n\n<pre><code>Project.includes(users).map(&amp;:all_users)\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": false, "score": 1, "last_activity_date": 1439977367, "last_edit_date": 1439977367, "creation_date": 1439976043, "answer_id": 32091416, "question_id": 32090683, "link": "https://stackoverflow.com/questions/32090683/rails-active-record-different-association-results-into-one-object/32091416#32091416", "title": "Rails Active Record different association results into one object", "body": "<p>Since you want colleagues_of_user to be ActiveRecord::Relation rather than an Array, I think you could do it like this:</p>\n\n<pre><code>def colleagues\n  colleague_ids = projects_colleague_ids + teams_projects_colleague_ids\n  colleagues_of_user = User.where(id: colleague_ids.flatten.uniq )\nend\n\nprivate\n\ndef projects_colleague_ids(projects = nil)\n  projects ||= self.projects\n  projects.includes(:users).collect{ |project| project.all_users.pluck(:id) }.flatten.uniq\nend\n\ndef teams_projects_colleague_ids\n  teams.includes(projects: :users).collect do |team|\n    projects_colleague_ids( team.projects )\n  end.flatten.uniq\nend\n</code></pre>\n"}], "owner": {"reputation": 3895, "user_id": 894705, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/70LbO.png?s=128&g=1", "display_name": "1.44mb", "link": "https://stackoverflow.com/users/894705/1-44mb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1439977367, "creation_date": 1439974117, "last_edit_date": 1439976713, "question_id": 32090683, "link": "https://stackoverflow.com/questions/32090683/rails-active-record-different-association-results-into-one-object", "title": "Rails Active Record different association results into one object", "body": "<p>I have a Project model.\nProject model has \"all_users\" instance method which returns all users of the project.</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n    has_many :memberships\n    has_many :users, through: :memberships, source: :member, source_type: 'User'\n    has_many :teams, through: :memberships, source: :member, source_type: 'Team'\n\n    scope :all_users, -&gt; (project) {\n        User.where(%{\n            (users.id in (select member_id from memberships where project_id = #{project.id} and member_type = 'User')) OR\n            (users.id in (select user_id from teams_users where team_id IN (select member_id from memberships where project_id = #{project.id} and member_type = 'Team')))\n            })\n    }\n\n    def all_users\n        Project.all_users(self).order(:name)\n    end\nend\n</code></pre>\n\n<p>A user has many projects.</p>\n\n<p>I want to make an instance method in User model to return all users of instance's all projects. Such as:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    has_many :memberships, as: :member, dependent: :destroy\n    has_many :projects, through: :memberships\n\n    def colleagues\n        colleagues_of_user = []\n        projects.each do |project|\n            project.all_users.each do |user|\n                colleagues_of_user &lt;&lt; user\n            end\n        end\n        teams.each do |team|\n            team.projects.each do |project|\n                project.all_users.each do |user|\n                    colleagues_of_user &lt;&lt; user\n                end\n            end\n        end\n        colleagues_of_user.uniq\n    end\nend\n</code></pre>\n\n<p>The problem is; i want to concatenate all \"project.all_users\" into one object but i can't. I have to turn them into an array (to_a). But i want the results (colleagues_of_user) in one object (\"ActiveRecord::Relation\").</p>\n\n<hr>\n\n<p><strong>UPDATE</strong>: Another point that should be noted is;\ncolleagues_of_user could be:<br>\n 1. Any user that is member of any projects of the current user.<br>\n 2. Any user that is member of current user's teams' projects.  </p>\n\n<p>I have updated \"colleagues\" method regarding these notes. How to get all results into one ActiveRecord::Relation object? (Not an array)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "gem", "bundler", "gemfile"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1439972487, "post_id": 32089666, "comment_id": 52075211, "body": "Doesn&#39;t NewRelic perform a no-op when in test environment anyway?"}, {"owner": {"reputation": 3164, "user_id": 193785, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b9110bc3c6f788945c789bf190932dc1?s=128&d=identicon&r=PG", "display_name": "BookOfGreg", "link": "https://stackoverflow.com/users/193785/bookofgreg"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1439973264, "post_id": 32089666, "comment_id": 52075687, "body": "I just doodled an minimal example gemfile to illustrate the problem. Newrelic might have been a bad choice so imagine it was pagination."}], "answers": [{"comments": [{"owner": {"reputation": 3164, "user_id": 193785, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b9110bc3c6f788945c789bf190932dc1?s=128&d=identicon&r=PG", "display_name": "BookOfGreg", "link": "https://stackoverflow.com/users/193785/bookofgreg"}, "edited": false, "score": 0, "creation_date": 1439973535, "post_id": 32090302, "comment_id": 52075861, "body": "Lets imagine it&#39;s some gem with an external dependency such as nokogiri, I do not want these gems installed at all, which is why I&#39;m specifying without."}, {"owner": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "reply_to_user": {"reputation": 3164, "user_id": 193785, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b9110bc3c6f788945c789bf190932dc1?s=128&d=identicon&r=PG", "display_name": "BookOfGreg", "link": "https://stackoverflow.com/users/193785/bookofgreg"}, "edited": false, "score": 0, "creation_date": 1439984894, "post_id": 32090302, "comment_id": 52083686, "body": "I don&#39;t see how you could have Nokogiri in production, but not testing that it&#39;s parsing HTML correctly in some form of test. And the same goes for all other gems.   I&#39;m not saying you should test the gem, but you should test that the output of methods are right, which means that you will need the gem available in test."}, {"owner": {"reputation": 3164, "user_id": 193785, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b9110bc3c6f788945c789bf190932dc1?s=128&d=identicon&r=PG", "display_name": "BookOfGreg", "link": "https://stackoverflow.com/users/193785/bookofgreg"}, "edited": false, "score": 0, "creation_date": 1439996036, "post_id": 32090302, "comment_id": 52092392, "body": "I don&#39;t care about testing nokogiri or any gem. This question is about preventing certain gem <i>groups</i> from being <i>installed</i> on the system at all."}], "tags": [], "owner": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "is_accepted": false, "score": 1, "last_activity_date": 1439972931, "creation_date": 1439972931, "answer_id": 32090302, "question_id": 32089666, "link": "https://stackoverflow.com/questions/32089666/how-to-run-bundle-without-in-a-way-that-installs-gems-in-multiple-groups/32090302#32090302", "title": "How to run bundle --without in a way that installs gems in multiple groups?", "body": "<p>I would add it flat out to the Gemfile, like this:</p>\n\n<pre><code># Gemfile\ngem 'newrelic_rpm'\n</code></pre>\n\n<p>And then in <code>test.rb</code>  simply disable it. See here for details: <a href=\"https://docs.newrelic.com/docs/agents/ruby-agent/troubleshooting/controlling-when-ruby-agent-starts\" rel=\"nofollow\">https://docs.newrelic.com/docs/agents/ruby-agent/troubleshooting/controlling-when-ruby-agent-starts</a></p>\n"}], "owner": {"reputation": 3164, "user_id": 193785, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b9110bc3c6f788945c789bf190932dc1?s=128&d=identicon&r=PG", "display_name": "BookOfGreg", "link": "https://stackoverflow.com/users/193785/bookofgreg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439973377, "creation_date": 1439970992, "last_edit_date": 1439973377, "question_id": 32089666, "link": "https://stackoverflow.com/questions/32089666/how-to-run-bundle-without-in-a-way-that-installs-gems-in-multiple-groups", "title": "How to run bundle --without in a way that installs gems in multiple groups?", "body": "<p>If you run <code>bundle --without development test</code> on this gemfile, it will not install bcrypt because it appears in a group that has development as a member. How could you specify bundle to install bcrypt and not the other groups?</p>\n\n<pre><code>gem \"rails\"\n\ngroup :production, :development do\n  gem \"bcrypt\"\nend\n\ngroup :development do\n  gem \"better_errors\"\nend\n\ngroup :development, :test do\n  gem \"selenium-webdriver\"\nend\n</code></pre>\n\n<p>Edit: Alternatively, which is a better way of structuring the file in such a way as I can avoid bcrypt being included in test?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "performance", "redis", "sidekiq"], "comments": [{"owner": {"reputation": 11227, "user_id": 1087866, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/52hpI.jpg?s=128&g=1", "display_name": "Jon Cairns", "link": "https://stackoverflow.com/users/1087866/jon-cairns"}, "edited": false, "score": 0, "creation_date": 1439972917, "post_id": 32089549, "comment_id": 52075468, "body": "I&#39;m assuming that your Sidekiq use the database? If so, what&#39;s the pool size in your <code>config&#47;database.yml</code>? It needs to be high enough to handle all the connections from your rails app <i>and</i> your 50 sidekiq threads."}, {"owner": {"reputation": 650, "user_id": 904430, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2337ccc2c954f6fef01334ad81d58225?s=128&d=identicon&r=PG", "display_name": "Vitali", "link": "https://stackoverflow.com/users/904430/vitali"}, "reply_to_user": {"reputation": 11227, "user_id": 1087866, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/52hpI.jpg?s=128&g=1", "display_name": "Jon Cairns", "link": "https://stackoverflow.com/users/1087866/jon-cairns"}, "edited": false, "score": 0, "creation_date": 1439973021, "post_id": 32089549, "comment_id": 52075540, "body": "Pool size is 150. More than enough to handle Sidekiq threads. Again, same configuration was on old server."}, {"owner": {"reputation": 6267, "user_id": 1144104, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c135bc644610fabc6e059b73fdd7f8ad?s=128&d=identicon&r=PG", "display_name": "jazzytomato", "link": "https://stackoverflow.com/users/1144104/jazzytomato"}, "edited": false, "score": 0, "creation_date": 1439974093, "post_id": 32089549, "comment_id": 52076209, "body": "I tried to move from <code>resque</code> to <code>sidekiq</code> recently with the exact same config as you but I faced incredibly poor performance too. Sorry I can&#39;t really help because all I did is rollback to <code>resque</code>, I&#39;m just saying you&#39;re not the only one"}, {"owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "edited": false, "score": 0, "creation_date": 1440001279, "post_id": 32089549, "comment_id": 52095981, "body": "Are you CPU bound or I/O bound?  How many Sidekiq processes are you running?  If you are only running one with 50 threads, you should try 2 processes with 25 threads."}, {"owner": {"reputation": 650, "user_id": 904430, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2337ccc2c954f6fef01334ad81d58225?s=128&d=identicon&r=PG", "display_name": "Vitali", "link": "https://stackoverflow.com/users/904430/vitali"}, "edited": false, "score": 0, "creation_date": 1440015157, "post_id": 32089549, "comment_id": 52104114, "body": "Pretty sure I am CPU bound. I am running 1 Sidekiq process. Unfortunately I will be able to try running multiple Sidekiq processes only on Monday and will let you know on my results then. Thanks for your advise."}, {"owner": {"reputation": 650, "user_id": 904430, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2337ccc2c954f6fef01334ad81d58225?s=128&d=identicon&r=PG", "display_name": "Vitali", "link": "https://stackoverflow.com/users/904430/vitali"}, "edited": false, "score": 0, "creation_date": 1440501931, "post_id": 32089549, "comment_id": 52289533, "body": "So, I did what you suggested. 2 processes with 25 threads each BUT it didn&#39;t seem to improve situation much. See screenshot: <a href=\"http://i.imgur.com/gHJnyZv.jpg\" rel=\"nofollow noreferrer\">i.imgur.com/gHJnyZv.jpg</a> tasks that take in reality 10 seconds take up to 30 minutes. They eventually disappear one by one but take really long to complete."}, {"owner": {"reputation": 530, "user_id": 4714655, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/wbq5r.png?s=128&g=1", "display_name": "eugene", "link": "https://stackoverflow.com/users/4714655/eugene"}, "reply_to_user": {"reputation": 6267, "user_id": 1144104, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c135bc644610fabc6e059b73fdd7f8ad?s=128&d=identicon&r=PG", "display_name": "jazzytomato", "link": "https://stackoverflow.com/users/1144104/jazzytomato"}, "edited": false, "score": 0, "creation_date": 1543913412, "post_id": 32089549, "comment_id": 94079061, "body": "@jazzytomato I got the same problem, did migrate back to resque resolve the issue?"}, {"owner": {"reputation": 6267, "user_id": 1144104, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c135bc644610fabc6e059b73fdd7f8ad?s=128&d=identicon&r=PG", "display_name": "jazzytomato", "link": "https://stackoverflow.com/users/1144104/jazzytomato"}, "reply_to_user": {"reputation": 530, "user_id": 4714655, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/wbq5r.png?s=128&g=1", "display_name": "eugene", "link": "https://stackoverflow.com/users/4714655/eugene"}, "edited": false, "score": 0, "creation_date": 1543919340, "post_id": 32089549, "comment_id": 94082768, "body": "@eugene this thread is a bit old and I don&#39;t recall I am sorry. I know that in the end I managed to use sidekiq which is more performant with the appropriate configuration. There are many factors that could cause a problem and I suggest you ask a question with your specific configuration, what problem you observe etc... I suppose that &quot;Migrating back to resque&quot; would not solve the problem that originally makes you want to migrate away from it."}, {"owner": {"reputation": 530, "user_id": 4714655, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/wbq5r.png?s=128&g=1", "display_name": "eugene", "link": "https://stackoverflow.com/users/4714655/eugene"}, "reply_to_user": {"reputation": 6267, "user_id": 1144104, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c135bc644610fabc6e059b73fdd7f8ad?s=128&d=identicon&r=PG", "display_name": "jazzytomato", "link": "https://stackoverflow.com/users/1144104/jazzytomato"}, "edited": false, "score": 0, "creation_date": 1545705370, "post_id": 32089549, "comment_id": 94680524, "body": "@jazzytomato thank you for responding me, I faced a very specific case that I have 10 instances (each instance run 3 sidekiq concurrency) and all of them connect to 1 postgresql database. And in this case the query is too slow (from 2ms to 200ms) and I don&#39;t have any idea why,  not sure it&#39;s accepted as a question in SO."}], "owner": {"reputation": 650, "user_id": 904430, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2337ccc2c954f6fef01334ad81d58225?s=128&d=identicon&r=PG", "display_name": "Vitali", "link": "https://stackoverflow.com/users/904430/vitali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1558, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1459519343, "creation_date": 1439970618, "last_edit_date": 1439975178, "question_id": 32089549, "link": "https://stackoverflow.com/questions/32089549/sidekiq-is-very-slow-at-processing", "title": "Sidekiq is very slow at processing", "body": "<p>I recently migrated to another, more powerful server.</p>\n\n<p>Upgraded Ruby version, Rails, Sidekiq and Redis but for some unknown to me reason, Sidekiq is incredibly slow at processing tasks.</p>\n\n<p>Sometimes tasks can be staying in \"Busy\" queue for up to 20 minutes, when in reality, performing same tasks synchronously (via WorkerName.new.perform) take no longer than 10 seconds.</p>\n\n<p>We don't have any long polling tasks longer than 1 minute.</p>\n\n<p>Sidekiq utilizes only one CPU at 100% but I suppose that's normal with MRI. But again, we used to have a much better performance with similar configuration.</p>\n\n<p>config/sidekiq.yml</p>\n\n<pre><code>:verbose: false\n:pidfile: ./tmp/pids/sidekiq.pid\n:concurrency:  50\n:queues:\n  - [webmaster_balance, 5]\n  - [advertiser_balance, 4]\n  - [balance_history, 3]\n  - [mailer, 2]\n  - [default, 1]\n</code></pre>\n\n<p>We use Capistrano to deploy and capistrano-sidekiq gem.\nThis is the command that is used to start Sidekiq\n<code>\n/usr/local/rvm/bin/rvm default do bundle exec sidekiq --index 0 --pidfile /home/deployer/fruby/shared/tmp/pids/sidekiq.pid --environment production --logfile /home/deployer/fruby/shared/log/sidekiq.log --config /home/deployer/fruby/current/config/sidekiq.yml --daemon\n</code></p>\n\n<p>Nothing interesting in Sidekiq logs.</p>\n\n<ul>\n<li>Sidekiq v 3.4.2</li>\n<li>Ruby 2.1.6</li>\n<li>Rails 3.2.22</li>\n<li>Redis Server 3.0.3</li>\n</ul>\n\n<p>Any hints on where should I start looking would be highly appreciated.</p>\n"}, {"tags": ["html", "css", "ruby-on-rails", "ruby", "pdf"], "answers": [{"tags": [], "owner": {"reputation": 744, "user_id": 1885107, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f3cb4e9a996ab41c7980d6954dfb68d?s=128&d=identicon&r=PG", "display_name": "Prakash Laxkar", "link": "https://stackoverflow.com/users/1885107/prakash-laxkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1439970317, "last_edit_date": 1439970317, "creation_date": 1439969637, "answer_id": 32089218, "question_id": 32088947, "link": "https://stackoverflow.com/questions/32088947/style-sheet-link-tag-to-wicked-pdf/32089218#32089218", "title": "Style sheet link tag to wicked pdf", "body": "<p>Try with stylesheet link tag like </p>\n\n<pre><code>&lt;%= wicked_pdf_stylesheet_link_tag 'frontend/your_file_name' %&gt;\n</code></pre>\n\n<p>It will help you. Thanks</p>\n"}, {"tags": [], "owner": {"reputation": 1256, "user_id": 4060732, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a62feb573aed36e5657c6495954ba514?s=128&d=identicon&r=PG", "display_name": "Sajjad Murtaza", "link": "https://stackoverflow.com/users/4060732/sajjad-murtaza"}, "is_accepted": false, "score": 1, "last_activity_date": 1439969897, "creation_date": 1439969897, "answer_id": 32089293, "question_id": 32088947, "link": "https://stackoverflow.com/questions/32088947/style-sheet-link-tag-to-wicked-pdf/32089293#32089293", "title": "Style sheet link tag to wicked pdf", "body": "<p>Try to create a separate layout for PDFs e.g pdf.html.erb in view/layout. Here i'm assuming there will be pdf.css.scss in assets/stylesheets.</p>\n\n<pre><code>&lt;%= wicked_pdf_stylesheet_link_tag 'pdf'  %&gt;\n</code></pre>\n\n<p>The in your controller you have you specified layout.</p>\n\n<pre><code>layout: 'pdf.html.erb'\n</code></pre>\n\n<p>See Example <a href=\"https://github.com/mileszs/wicked_pdf#wicked_pdf-helpers\" rel=\"nofollow\">wicked_pdf</a> </p>\n"}], "owner": {"reputation": 11, "user_id": 5242160, "user_type": "registered", "profile_image": "https://graph.facebook.com/1484449631849409/picture?type=large", "display_name": "Rahuldev Shetty", "link": "https://stackoverflow.com/users/5242160/rahuldev-shetty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 994, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1439970317, "creation_date": 1439968890, "last_edit_date": 1439969510, "question_id": 32088947, "link": "https://stackoverflow.com/questions/32088947/style-sheet-link-tag-to-wicked-pdf", "title": "Style sheet link tag to wicked pdf", "body": "<p>I written html code for the pdf page .. i want to add some styles to that page so i added below link tag to include style.css.scss in that page.</p>\n\n<pre><code>&lt;%= wicked_pdf_stylesheet_link_tag \"application\"%&gt;\n&lt;%= wicked_pdf_stylesheet_link_tag \"pdf\"%&gt;\n</code></pre>\n\n<p>But it is not working because i created one more folder like  frontend under assets/stylesheets and copied total css files in that folder .. May be  this is the reason it is working. If it is the reason can you please clarify me how to include stylesheet link_tag to wicked_pdf??</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "devise", "devise-confirmable"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1439974008, "post_id": 32088692, "comment_id": 52076140, "body": "You are using <code>user</code> and <code>@user</code>, shouldn&#39;t it just be <code>user</code>?"}, {"owner": {"reputation": 275, "user_id": 3205784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213012f39ccb8156f7058d4b2ef8880a?s=128&d=identicon&r=PG", "display_name": "mammothbane", "link": "https://stackoverflow.com/users/3205784/mammothbane"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1439974210, "post_id": 32088692, "comment_id": 52076288, "body": "whoops, yeah, thanks. i had messed around with that a bit. fixed now, but still the same issue. wasn&#39;t failing on that line."}], "answers": [{"comments": [{"owner": {"reputation": 275, "user_id": 3205784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213012f39ccb8156f7058d4b2ef8880a?s=128&d=identicon&r=PG", "display_name": "mammothbane", "link": "https://stackoverflow.com/users/3205784/mammothbane"}, "edited": false, "score": 0, "creation_date": 1439973609, "post_id": 32090258, "comment_id": 52075902, "body": "I got there eventually (see my edit) but it seems like that&#39;s not the root of my problem"}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 0, "last_activity_date": 1439972796, "creation_date": 1439972796, "answer_id": 32090258, "question_id": 32088692, "link": "https://stackoverflow.com/questions/32088692/defining-stubs-in-an-rspec-helper-method/32090258#32090258", "title": "Defining stubs in an RSpec helper method", "body": "<p>What about stubing <code>env</code> on <code>Rails</code>, not <code>test?</code> etc. on <code>env</code>.</p>\n\n<pre><code>before do \n  rails_env = \"test\".inquirer\n  allow(Rails).to receive(:env).and_return(rails_env)\nend\n</code></pre>\n"}], "owner": {"reputation": 275, "user_id": 3205784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213012f39ccb8156f7058d4b2ef8880a?s=128&d=identicon&r=PG", "display_name": "mammothbane", "link": "https://stackoverflow.com/users/3205784/mammothbane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439974376, "creation_date": 1439968080, "last_edit_date": 1439974376, "question_id": 32088692, "link": "https://stackoverflow.com/questions/32088692/defining-stubs-in-an-rspec-helper-method", "title": "Defining stubs in an RSpec helper method", "body": "<p>I've got a confirmable <code>devise</code> model that I'm trying to write a spec for, and it's got some code that skips the confirmation if we're in a staging or development environment. To test it, I'm trying to stub the <code>Rails.env.*?</code> environment methods, so I defined a method as a helper to handle all the cases:</p>\n\n<pre><code>def enable_environment(env)\n  if env == :staging\n    stub_env('STAGING', 'true')\n  end\n\n  # clear all environments\n  allow(Rails.env).to receive(:test?) { false }\n  allow(Rails.env).to receive(:development?) { false }\n  allow(Rails.env).to receive(:production?) { false }\n\n  # turn on environment of choice\n  if env == :production || env == :staging\n    allow(Rails.env).to receive(:production?) { true }\n  elsif env == :development\n    allow(Rails.env).to receive(:development?) { true }\n  elsif env == :test\n    allow(Rails.env).to receive(:test?) { true }\n  else\n    raise 'no such environment'\n  end\nend\n</code></pre>\n\n<p>However, it's looking like these stubs are only scoped to the method--if I call <code>enable_environment(:staging)</code> in an example and debug with <code>byebug</code> right after, <code>Rails.env.test?</code> returns <code>true</code> and <code>Rails.env.production?</code> returns <code>false</code>. <code>ENV['STAGING']</code> also returns <code>nil</code>. Is there any way to do this, or will I just have to copy-paste the code in each example?</p>\n\n<p><strong>Edit</strong>: So, the second layer of the problem seems to be another scoping issue. I was testing by calling <code>User.create</code>, which calls my <code>skip_conf!</code> method off the <code>after_create</code> hook. This fails because the <code>Rails.env</code> that I've stubbed doesn't affect that hook (it seems). </p>\n\n<p>Next, I tried just building a <code>User</code> model with <code>User.new</code> then directly calling <code>skip_conf!</code> on it. This fails because <code>skip_conf!</code> has side-effects (I get a <code>NoMethodError: undefined method '+' for nil:NilClass</code>). I've tried other methods (<code>skip_conf</code>, for instance, without side-effects), and they work. My <code>User</code> model looks like this:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  after_create :skip_conf!\n\n  # ...\n\n  def skip_conf!\n    self.confirm unless (Rails.env.production? &amp;&amp; !ENV['STAGING'] == 'true') || Rails.env.test?\n  end\nend\n</code></pre>\n\n<p>New testing code:</p>\n\n<pre><code>context 'in testing' do\n  before :each do\n    @user = User.new(\n      # params\n    )\n  end\n\n  it 'shouldn\\'t skip confirmation' do\n    allow(Rails).to receive(:env).and_return(ActiveSupport::StringInquirer.new('development'))\n    @user.skip_conf!\n    expect(@user.confirmed?).to be_falsey\n  end\nend\n</code></pre>\n\n<p>If I change <code>user.skip_conf!</code> to <code>user.skip_conf</code> (and write an empty <code>skip_conf</code> method in my <code>User</code> model), the test runs. Any ideas? I'm fine with just running this as an integration test if necessary, but I feel like it shouldn't be difficult to test a simple method with side-effects in RSpec.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 777, "user_id": 4043127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TQN72.jpg?s=128&g=1", "display_name": "Luis Menjivar", "link": "https://stackoverflow.com/users/4043127/luis-menjivar"}, "edited": false, "score": 0, "creation_date": 1439964534, "post_id": 32087546, "comment_id": 52070923, "body": "What errors are you getting?"}, {"owner": {"reputation": 29, "user_id": 5159845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ceda7d0b2ec9028e76dba60aa90392c?s=128&d=identicon&r=PG&f=1", "display_name": "akash", "link": "https://stackoverflow.com/users/5159845/akash"}, "reply_to_user": {"reputation": 777, "user_id": 4043127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TQN72.jpg?s=128&g=1", "display_name": "Luis Menjivar", "link": "https://stackoverflow.com/users/4043127/luis-menjivar"}, "edited": false, "score": 0, "creation_date": 1439965191, "post_id": 32087546, "comment_id": 52071187, "body": "@LuisMenjivar updated the question"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1439965391, "post_id": 32087546, "comment_id": 52071290, "body": "@akash see the answer below <code>@user</code> is nil because you are trying to create a new object on <code>@user</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3895, "user_id": 1110171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ln0nD.jpg?s=128&g=1", "display_name": "fruqi", "link": "https://stackoverflow.com/users/1110171/fruqi"}, "is_accepted": false, "score": 1, "last_activity_date": 1439964343, "creation_date": 1439964343, "answer_id": 32087667, "question_id": 32087546, "link": "https://stackoverflow.com/questions/32087546/ruby-on-rails-basic-form-submission/32087667#32087667", "title": "Ruby on Rails - basic form submission", "body": "<p>In your <strong>users_controller</strong> > <strong>create</strong>, you put capital letter on <code>User</code> param.</p>\n\n<p>For your case, it should be all lower case <code>params[:user]</code>. \nSide note, it actually depends on your attribute name you set on the form in the first place.</p>\n\n<p>Edit:\nIn addition of that you should put <code>@user = User.new(params[:user])</code> </p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 5159845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ceda7d0b2ec9028e76dba60aa90392c?s=128&d=identicon&r=PG&f=1", "display_name": "akash", "link": "https://stackoverflow.com/users/5159845/akash"}, "edited": false, "score": 0, "creation_date": 1439965598, "post_id": 32087881, "comment_id": 52071395, "body": "it gives  ActiveModel::ForbiddenAttributesError"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 29, "user_id": 5159845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ceda7d0b2ec9028e76dba60aa90392c?s=128&d=identicon&r=PG&f=1", "display_name": "akash", "link": "https://stackoverflow.com/users/5159845/akash"}, "edited": false, "score": 0, "creation_date": 1440165022, "post_id": 32087881, "comment_id": 52173395, "body": "Use strong parameters refer this <a href=\"http://edgeapi.rubyonrails.org/classes/ActionController/StrongParameters.html\" rel=\"nofollow noreferrer\">edgeapi.rubyonrails.org/classes/ActionController/&hellip;</a>"}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 1, "last_activity_date": 1440165063, "last_edit_date": 1440165063, "creation_date": 1439965278, "answer_id": 32087881, "question_id": 32087546, "link": "https://stackoverflow.com/questions/32087546/ruby-on-rails-basic-form-submission/32087881#32087881", "title": "Ruby on Rails - basic form submission", "body": "<p>First thing you should create new object of User class\nSecond pass correct params key</p>\n\n<p>change first line in create method to </p>\n\n<pre><code>@user = User.new(params[:user])\n</code></pre>\n\n<p>So the changed code will look like this:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def new   \n    @user= User.new\n  end\n\n  def create\n    @user = User.new(params[:user])\n    if @user.save\n        flash[:notice]= \"you signed up successfully\"\n        flash[:color]= \"valid\"\n    else\n        flash[:notice]= \"failed\"\n        flash[:color]=\"invalid\"\n    end\n    render \"new\"\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 777, "user_id": 4043127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TQN72.jpg?s=128&g=1", "display_name": "Luis Menjivar", "link": "https://stackoverflow.com/users/4043127/luis-menjivar"}, "is_accepted": true, "score": 0, "last_activity_date": 1439965416, "creation_date": 1439965416, "answer_id": 32087923, "question_id": 32087546, "link": "https://stackoverflow.com/questions/32087546/ruby-on-rails-basic-form-submission/32087923#32087923", "title": "Ruby on Rails - basic form submission", "body": "<p>change <code>@user.new(params[:user])</code> to <code>@user = User.new(params[:user])</code> I creates @user but it is not saved to database yet. On the line below <code>@user.save</code> that is when it gets saved. And remove <code>render new</code> because it will render the template with out setting the variables that the template needs. instead use <code>redirect_to :new</code> that will send the user to new and also set the variables needed</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4287390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v4cXsIax1Kk/AAAAAAAAAAI/AAAAAAAAAB8/aRGyp4z2c38/photo.jpg?sz=128", "display_name": "Preetesh Patil", "link": "https://stackoverflow.com/users/4287390/preetesh-patil"}, "is_accepted": false, "score": 0, "last_activity_date": 1439977896, "creation_date": 1439977896, "answer_id": 32092123, "question_id": 32087546, "link": "https://stackoverflow.com/questions/32087546/ruby-on-rails-basic-form-submission/32092123#32092123", "title": "Ruby on Rails - basic form submission", "body": "<p>I guess you need to allow the <code>params</code> of <code>User</code> model in the <code>User</code> controller so as to avoid the <code>forbidden error message</code> as mentioned <a href=\"http://guides.rubyonrails.org/getting_started.html#saving-data-in-the-controller\" rel=\"nofollow\">here</a>. Please note that this is Rails feature as mentioned </p>\n\n<blockquote>\n  <p>Rails has several security features that help you write secure applications, and you're running into one of them now. This one is called <strong>strong parameters</strong>, which requires us to tell Rails exactly which parameters are allowed into our controller actions.</p>\n</blockquote>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 29, "user_id": 5159845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ceda7d0b2ec9028e76dba60aa90392c?s=128&d=identicon&r=PG&f=1", "display_name": "akash", "link": "https://stackoverflow.com/users/5159845/akash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 32087923, "answer_count": 4, "score": 1, "last_activity_date": 1440165063, "creation_date": 1439963868, "last_edit_date": 1439966383, "question_id": 32087546, "link": "https://stackoverflow.com/questions/32087546/ruby-on-rails-basic-form-submission", "title": "Ruby on Rails - basic form submission", "body": "<p>I have been working on PHP. Presently trying to learn Ruby on Rails. I am learning Rails online, for now I am badly stuck on Sign-up or can say a form submission page. Sorry if it's too silly.</p>\n\n<p>Error is:</p>\n\n<p><code>undefined method new for nil:NilClass</code></p>\n\n<p>Here is the code:</p>\n\n<p><strong>users_controller.rb</strong></p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def new   \n    @user= User.new\n  end\n\n  def create\n    @user.new(params[:user])\n    if @user.save\n        flash[:notice]= \"you signed up successfully\"\n        flash[:color]= \"valid\"\n    else\n        flash[:notice]= \"failed\"\n        flash[:color]=\"invalid\"\n    end\n    render \"new\"\n  end\nend\n</code></pre>\n\n<p><strong>new.html.erb</strong></p>\n\n<pre><code>&lt;% page_title=\"Signup\" %&gt;\n&lt;div class=\"Sign_Form\"&gt;\n    &lt;h1&gt;Sign up&lt;/h1&gt;\n    &lt;%= form_for(:user, :url =&gt; {:controller =&gt; 'users', :action =&gt; 'create'}) do |f| %&gt;\n    &lt;p&gt; Username:&lt;/br&gt; &lt;%= f.text_field :username%&gt; &lt;/p&gt;\n    &lt;p&gt; Email:&lt;/br&gt; &lt;%= f.text_field :email%&gt; &lt;/p&gt;\n    &lt;p&gt; Password:&lt;/br&gt; &lt;%= f.password_field :password%&gt;&lt;/p&gt;\n    &lt;p&gt; Password Confirmation:&lt;/br&gt; &lt;%= f.password_field :password_confirmation%&gt; &lt;/p&gt;\n    &lt;%= f.submit :Signup %&gt;\n  &lt;% end %&gt;\n  &lt;% if @user.errors.any? %&gt;\n    &lt;ul class=\"Signup_Errors\"&gt;\n    &lt;% for message_error in @user.errors.full_messages %&gt;\n      &lt;li&gt;* &lt;%= message_error %&gt;&lt;/li&gt;\n    &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>user.rb</strong>    </p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  attr_accessor :password\n  EMAIL_REGEX = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i\n  validates :username, :presence =&gt; true, :uniqueness =&gt; true, :length =&gt; { :in =&gt; 3..20 }\n  validates :email, :presence =&gt; true, :uniqueness =&gt; true #:format =&gt; EMAIL_REGEX\n  validates :password, `enter code here`:presence =&gt;true #:confirmation =&gt; true #password_confirmation attr\n  validates_length_of :password, :in =&gt; 6..20, :on =&gt; :create\nend\n</code></pre>\n"}, {"tags": ["javascript", "html", "ruby", "haml"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1439963328, "post_id": 32087357, "comment_id": 52070483, "body": "Hello. You have achieved the above code; it is already written. Can you give example values for all of your variables, and what final HTML (not Haml) you wish to achieve using Haml?"}], "answers": [{"comments": [{"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "reply_to_user": {"reputation": 21, "user_id": 5241878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd56af16be00074628055e61362cd30?s=128&d=identicon&r=PG&f=1", "display_name": "vanga", "link": "https://stackoverflow.com/users/5241878/vanga"}, "edited": false, "score": 0, "creation_date": 1439964163, "post_id": 32087567, "comment_id": 52070803, "body": "@vanga : it will be more helpful if you provide us content of your object for array and another array. as well as simple HTML sytax the way you wish."}, {"owner": {"reputation": 21, "user_id": 5241878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd56af16be00074628055e61362cd30?s=128&d=identicon&r=PG&f=1", "display_name": "vanga", "link": "https://stackoverflow.com/users/5241878/vanga"}, "edited": false, "score": 0, "creation_date": 1440013648, "post_id": 32087567, "comment_id": 52103230, "body": "I&#39;m sorry about the confusion. I have updated stating what I&#39;m trying to do. Thanks"}], "tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 0, "last_activity_date": 1439964410, "last_edit_date": 1439964410, "creation_date": 1439963927, "answer_id": 32087567, "question_id": 32087357, "link": "https://stackoverflow.com/questions/32087357/displaying-array-in-td-tag-in-haml/32087567#32087567", "title": "Displaying array in td tag in Haml", "body": "<p>It's not clear how do you want but as I understood from your code, you want to make a loop for <code>td</code> :</p>\n\n<pre><code>%table{data: {chart: 'line'}, class: 'table-hover'}\n  %tbody\n    %tr{data: { y_values: arr, x_values: another_array}}\n      - arr.each do |ar|\n        %td\n          = ar # this will print value of ar from loop of arr \n</code></pre>\n\n<p>Let me know if this is what you are looking for or provide me further information so I can modify my answer accordingly</p>\n"}, {"tags": [], "owner": {"reputation": 1052, "user_id": 5153223, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2eb1e2066f49fd770286205385ad6d1?s=128&d=identicon&r=PG&f=1", "display_name": "Borsunho", "link": "https://stackoverflow.com/users/5153223/borsunho"}, "is_accepted": false, "score": 0, "last_activity_date": 1439968289, "creation_date": 1439968289, "answer_id": 32088753, "question_id": 32087357, "link": "https://stackoverflow.com/questions/32087357/displaying-array-in-td-tag-in-haml/32088753#32088753", "title": "Displaying array in td tag in Haml", "body": "<p>Haml allows you to easly use ruby iterators and loops:</p>\n\n<pre><code>- arr.each do |element|\n   %td= element\n</code></pre>\n\n<p>Just remember to start line with <code>each</code> with <code>-</code> instead of <code>=</code>, and that you don't need to write <code>end</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 5241878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd56af16be00074628055e61362cd30?s=128&d=identicon&r=PG&f=1", "display_name": "vanga", "link": "https://stackoverflow.com/users/5241878/vanga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 570, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1440013607, "creation_date": 1439962947, "last_edit_date": 1440013607, "question_id": 32087357, "link": "https://stackoverflow.com/questions/32087357/displaying-array-in-td-tag-in-haml", "title": "Displaying array in td tag in Haml", "body": "<p>I have the following div,</p>\n\n<pre><code> - abc.each do |gg, arr = []|\n  - gg.items.each {|def| arr.push(def.values) }\n\n  = modal(attributes: {id: 'some-modal', class: 'modal-wide'}, legacy: true) do\n    = header('Item Details', attributes: {id: 'some-modal-header'})\n\n    #graph\n      - y_axis = array_values(arr)\n      %table{data: {chart: 'line'}, class: 'table-hover'}\n        %tbody\n          %tr{data: { y_values: y_axis, x_values: [3, 10, 12, 20, 32, 35, 50, 52, 90]}}\n            - y_axis.each do |y|\n              %td= y\n\n    = actions do\n      %span= 'hello'\n      %button.btn(data-dismiss='modal' aria-hidden='true')= 'close'\n</code></pre>\n\n<p>I don't know what I'm doing wrong here. when I hard code y_axis with the values, it works fine. When I use the above code is skips the loop and goes to \"actions\". Can someone show some direction.</p>\n"}, {"tags": ["ruby", "neo4j", "neo4j.rb"], "comments": [{"owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "edited": false, "score": 0, "creation_date": 1439989066, "post_id": 32086538, "comment_id": 52086797, "body": "What version of the <code>neo4j</code> and <code>neo4j-core</code> gems are you using?"}, {"owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "edited": false, "score": 0, "creation_date": 1439989086, "post_id": 32086538, "comment_id": 52086818, "body": "Also if you&#39;d like to chat with us our Gitter channel is <a href=\"https://gitter.im/neo4jrb/neo4j\" rel=\"nofollow noreferrer\">gitter.im/neo4jrb/neo4j</a>"}, {"owner": {"reputation": 2125, "user_id": 66731, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/85WeZ.jpg?s=128&g=1", "display_name": "Louis Sayers", "link": "https://stackoverflow.com/users/66731/louis-sayers"}, "reply_to_user": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "edited": false, "score": 0, "creation_date": 1440042448, "post_id": 32086538, "comment_id": 52112397, "body": "I&#39;m currently on neo4j 5.1.0, neo4j-core 5.1.0. Thanks for the gitter channel link! I&#39;m travelling atm, but will hop on there for sure :)"}, {"owner": {"reputation": 4762, "user_id": 2105069, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2c107e06ab979c6ef456d76b98e8d114?s=128&d=identicon&r=PG", "display_name": "subvertallchris", "link": "https://stackoverflow.com/users/2105069/subvertallchris"}, "edited": false, "score": 0, "creation_date": 1440128713, "post_id": 32086538, "comment_id": 52154786, "body": "Definitely pop into the Gitter room when you have a chance. Are you using Rails? I can&#39;t think of why this would happen but I have some ideas about where the offending code may be."}], "answers": [{"comments": [{"owner": {"reputation": 2125, "user_id": 66731, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/85WeZ.jpg?s=128&g=1", "display_name": "Louis Sayers", "link": "https://stackoverflow.com/users/66731/louis-sayers"}, "edited": false, "score": 0, "creation_date": 1440042729, "post_id": 32096187, "comment_id": 52112447, "body": "Thanks for your input. I&#39;m not using self.mapped_label_name, and none of the nodes have multiple labels. I&#39;ll have to see if I can work out how to recreate the error as it&#39;s pretty sporadic atm."}, {"owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "reply_to_user": {"reputation": 2125, "user_id": 66731, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/85WeZ.jpg?s=128&g=1", "display_name": "Louis Sayers", "link": "https://stackoverflow.com/users/66731/louis-sayers"}, "edited": false, "score": 0, "creation_date": 1440071809, "post_id": 32096187, "comment_id": 52127616, "body": "Gotcha.  Definitely let us know if you can reproduce!"}], "tags": [], "owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "is_accepted": false, "score": 0, "last_activity_date": 1439989051, "creation_date": 1439989051, "answer_id": 32096187, "question_id": 32086538, "link": "https://stackoverflow.com/questions/32086538/neo4j-gem-undefined-method-name-for-cyphernode/32096187#32096187", "title": "Neo4j gem undefined method `name&#39; for CypherNode", "body": "<p>That is certainly strange!  Some thoughts:</p>\n\n<ul>\n<li>I think you already covered this, but the labels should be <code>Member</code> and <code>Game</code> (case-sensitive).  I see your matching on <code>Member</code> in the query but not on <code>Game</code> (that doesn't matter as long as the label on the node is right, but just to check)</li>\n<li>If you're using <code>self.mapped_label_name</code> in your model that could affect things</li>\n<li>Do any of these nodes have multiple labels?  Again, I don't think that will make a difference, but it's good to know</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 4762, "user_id": 2105069, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2c107e06ab979c6ef456d76b98e8d114?s=128&d=identicon&r=PG", "display_name": "subvertallchris", "link": "https://stackoverflow.com/users/2105069/subvertallchris"}, "is_accepted": true, "score": 2, "last_activity_date": 1441831674, "creation_date": 1441831674, "answer_id": 32488904, "question_id": 32086538, "link": "https://stackoverflow.com/questions/32086538/neo4j-gem-undefined-method-name-for-cyphernode/32488904#32488904", "title": "Neo4j gem undefined method `name&#39; for CypherNode", "body": "<p>This is related to a bug that was patched in 5.1.5, regressed in 5.2.0-5.2.2, fixed again in release 5.2.3. <a href=\"https://github.com/neo4jrb/neo4j/issues/955\" rel=\"nofollow\">https://github.com/neo4jrb/neo4j/issues/955</a> addresses it.</p>\n"}], "owner": {"reputation": 2125, "user_id": 66731, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/85WeZ.jpg?s=128&g=1", "display_name": "Louis Sayers", "link": "https://stackoverflow.com/users/66731/louis-sayers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 32488904, "answer_count": 2, "score": 1, "last_activity_date": 1441831674, "creation_date": 1439958165, "last_edit_date": 1439983025, "question_id": 32086538, "link": "https://stackoverflow.com/questions/32086538/neo4j-gem-undefined-method-name-for-cyphernode", "title": "Neo4j gem undefined method `name&#39; for CypherNode", "body": "<p>I'm currently experiencing an issue where it looks like CypherNodes aren't being converted into their corresponding model objects properly.</p>\n\n<p>Interestingly enough, if I clear my DB locally, the error stops occurring, but will sure enough occur sometime later. Once it has occurred it consistently produces the error.</p>\n\n<p>The main bit of code where the issue occurs resembles the following: </p>\n\n<pre><code>results = Club.query_as(:club)\n             .match(\"(region:Region)-[:has_club]-&gt;(club)\")\n             .match(\"(club)-[:last_event]-&gt;()&lt;-[:next*0..]-(event)-[:action]-&gt;(game)\")\n             .match(\"(game)&lt;-[:action]-(:Event)&lt;-[:next*0..]-()&lt;-[:first_event]-(member:Member)\")\n             .where(region: { name: region_name }, club: { name: club_name })\n             .order(event: { created_at: :desc })\n             .limit(limit)\n             .pluck(:member, :event, :game)\n\n\n  results.map do |member, event, game|\n    # Error occurs on 'game.name' as game is a CypherNode, not a Game object\n    view_model = GameViewModel.new(game: game.name,\n                                   member_name: member.nickname,\n                                   created_at: event.created_at.to_i)\n  end\n</code></pre>\n\n<p>When the problem occurs, this results in an array with items that look like:</p>\n\n<pre><code>[ \n  CypherNode 1139 (70254694683340), \n  #&lt;Event uuid: \"c3b81116-1be3-4722-8908-8c36d5c76fe3\", created_at: Wed, 19 Aug 2015 03:53:43 +0000&gt;, \n  CypherNode 993 (70254694681800)\n ]\n</code></pre>\n\n<p>If I look into each CypherNode (node.labels, node.props), I can see that it has the correct label in an array, and the correct properties on it. </p>\n\n<p>The member model is quite complex, but the game model is very simple and looks like:</p>\n\n<pre><code>class Game\n  include Neo4j::ActiveNode\n  property :name, type: String\nend\n</code></pre>\n\n<p>I'm kind of stuck with this, not knowing exactly what to look at. Any thoughts or suggestions would be much appreciated!</p>\n"}, {"tags": ["ruby", "mechanize"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1439959849, "post_id": 32086294, "comment_id": 52069261, "body": "You can&#39;t. Mechanize does not evaluate JavaScript. Find out what kind of requests result from the button clicks by observing the Network panel in your browser&#39;s Developer Tools."}, {"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1440041439, "post_id": 32086294, "comment_id": 52112173, "body": "What does SPA stand for?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1440133723, "post_id": 32086294, "comment_id": 52156069, "body": "@pguardiario: <a href=\"https://en.wikipedia.org/wiki/Single-page_application\" rel=\"nofollow noreferrer\">Single-Page Application</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1439965000, "post_id": 32086958, "comment_id": 52071110, "body": "Thank you for saving my time."}], "tags": [], "owner": {"reputation": 122, "user_id": 3903587, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d566c0db7b1dc8c13d921fb36d18545f?s=128&d=identicon&r=PG&f=1", "display_name": "j.sanghoon", "link": "https://stackoverflow.com/users/3903587/j-sanghoon"}, "is_accepted": true, "score": 2, "last_activity_date": 1439960974, "creation_date": 1439960974, "answer_id": 32086958, "question_id": 32086294, "link": "https://stackoverflow.com/questions/32086294/how-to-use-mechanize-on-a-page-with-no-form/32086958#32086958", "title": "How to use Mechanize on a page with no form?", "body": "<p>I had the exact same problem you did. I ended up using 'capybara', 'launchy' and 'selenium-webdriver' to  do what 'mechanize' would have in non-JavaScript env</p>\n"}, {"tags": [], "owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "is_accepted": false, "score": 0, "last_activity_date": 1440041404, "creation_date": 1440041404, "answer_id": 32109103, "question_id": 32086294, "link": "https://stackoverflow.com/questions/32086294/how-to-use-mechanize-on-a-page-with-no-form/32109103#32109103", "title": "How to use Mechanize on a page with no form?", "body": "<p>Let's say <code>agent</code> is a <code>Mechanize</code> object and <code>page</code> is a <code>Mechanize::Page</code>.</p>\n\n<p>You can do:</p>\n\n<pre><code>form = Mechanize::Form.new page.at('body'), agent\n</code></pre>\n\n<p>Now the form is initialized with all the fields and buttons on the page.</p>\n\n<p>You will need to set the action and method yourself:</p>\n\n<pre><code>form.action = 'http://foo.com'\nform.method = 'POST'\nnext_page = form.submit\n</code></pre>\n"}], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "accepted_answer_id": 32086958, "answer_count": 2, "score": 1, "last_activity_date": 1440041404, "creation_date": 1439956607, "last_edit_date": 1439958321, "question_id": 32086294, "link": "https://stackoverflow.com/questions/32086294/how-to-use-mechanize-on-a-page-with-no-form", "title": "How to use Mechanize on a page with no form?", "body": "<p>I am trying to write a website crawler with <code>Mechanize</code>, and I found that my target website is written in a SPA fashion, and although there are a bunch of text fields and buttons, there is no form!</p>\n\n<p>How can I use <code>mechanize</code> to fill text fields and click buttons outside forms?</p>\n"}, {"tags": ["ruby", "gem", "command-line-interface"], "answers": [{"tags": [], "owner": {"reputation": 1515, "user_id": 633567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45355cfdc64d509b8cbfe2d5789ee94?s=128&d=identicon&r=PG", "display_name": "adzdavies", "link": "https://stackoverflow.com/users/633567/adzdavies"}, "is_accepted": false, "score": 0, "last_activity_date": 1439959173, "creation_date": 1439959173, "answer_id": 32086683, "question_id": 32085764, "link": "https://stackoverflow.com/questions/32085764/how-to-share-ruby-cli-executable-and-make-it-available-globally-in-command-line/32086683#32086683", "title": "How to share Ruby Cli executable and make it available globally in command line?", "body": "<p>To make it available as a gem, you should create a gem. Bundler can help setup all the parts:</p>\n\n<pre><code>bundle gem my_gem\n</code></pre>\n\n<p>See more here: <a href=\"http://bundler.io/v1.10/rubygems.html\" rel=\"nofollow\">http://bundler.io/v1.10/rubygems.html</a></p>\n\n<p>To make an executable, add a ruby script in \"./bin/\" then edit you \"my_gem.gemspec\" file, and add a line about 'executables'.</p>\n\n<pre><code>s.executables &lt;&lt; 'myscript'  # should exist in bin/myscript\n</code></pre>\n\n<p><a href=\"http://guides.rubygems.org/make-your-own-gem/#adding-an-executable\" rel=\"nofollow\">http://guides.rubygems.org/make-your-own-gem/#adding-an-executable</a></p>\n\n<p>Once you have that working, you can publish your gem using the rake task bundler setup for you:</p>\n\n<pre><code>bundle exec rake release\n</code></pre>\n\n<p>That will tag and push to rubygems, and you should then be able to run \"gem install my_gem\" from any other machine.</p>\n"}], "owner": {"reputation": 14557, "user_id": 1319799, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/638c6066d351794d90fb3abfa1704c01?s=128&d=identicon&r=PG", "display_name": "Muhammad Umer", "link": "https://stackoverflow.com/users/1319799/muhammad-umer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439959173, "creation_date": 1439952598, "question_id": 32085764, "link": "https://stackoverflow.com/questions/32085764/how-to-share-ruby-cli-executable-and-make-it-available-globally-in-command-line", "title": "How to share Ruby Cli executable and make it available globally in command line?", "body": "<p>At my school we need to perform certain tasks and i've made ruby program that solves the problems and assists. It executes fine but i've to type path to the folder or be in the folder of ruby program.</p>\n\n<p>I'd like to do two things with cli app...</p>\n\n<p>1) make it available to rest of my friends (preferably if they do something like gem install nameOfMyThing)</p>\n\n<p>2) and i and everyone else who downloads it should be able to run it from terminal anywhere whether be on desktop or at c: </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-associations"], "comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1444042281, "post_id": 32085741, "comment_id": 53718457, "body": "You should really start accepting answers to your questions (click the checkmark next to the voting buttons for the best answer to each question)."}], "answers": [{"tags": [], "owner": {"reputation": 2174, "user_id": 3448554, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j7RcG.jpg?s=128&g=1", "display_name": "Kelsey Hannan", "link": "https://stackoverflow.com/users/3448554/kelsey-hannan"}, "is_accepted": false, "score": 1, "last_activity_date": 1440019112, "last_edit_date": 1440019112, "creation_date": 1439953633, "answer_id": 32085890, "question_id": 32085741, "link": "https://stackoverflow.com/questions/32085741/ruby-on-rails-for-reverse-auction-type-app/32085890#32085890", "title": "Ruby on Rails for reverse-auction type app", "body": "<p>To get a list of all carriers from an individual user making a shipment:</p>\n\n<pre><code>@associated_carriers = user.posted_shipments.map{ |shipment| shipment.carriers}.uniq\n</code></pre>\n\n<p>To get a list of all shippers from an individual user wanting to see new shipments:</p>\n\n<pre><code>@associated_shippers = user.carrier_shipments.map{|shipment| shipment.shippers}.uniq\n</code></pre>\n\n<p>From those two lists of users, you can then iterate through the individual users to get info about each. </p>\n\n<p>For a user's <code>@associated_shippers</code>, you can list those shippers posted_shipments by doing:</p>\n\n<pre><code>@associated_shippers.each do |shipper_user|\n  # in the auction view:\n  # shipper_user.posted_shipments, etc.\nend\n</code></pre>\n\n<p>and for a user's <code>@associated_carriers</code>, you can list those carriers carrier_shipments by doing:</p>\n\n<pre><code>@associated_carriers.each do |carrier_user|\n  # in the auction view:\n  # carrier_user.carrier_shipments, etc.\nend\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5100911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86da0ad07e9f41050f00298644f5afbc?s=128&d=identicon&r=PG&f=1", "display_name": "jmanikan", "link": "https://stackoverflow.com/users/5100911/jmanikan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1440019112, "creation_date": 1439952446, "question_id": 32085741, "link": "https://stackoverflow.com/questions/32085741/ruby-on-rails-for-reverse-auction-type-app", "title": "Ruby on Rails for reverse-auction type app", "body": "<p>Need help, please!</p>\n\n<p>If I have:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :user_shipments\n  has_many :shipments, through: :user_shipments\n\n  def posted_shipments\n    user_shipments.where(role: 'shipper').map(&amp;:shipment)\n  end\n\n  def carrier_shipments\n    user_shipments.where(role: 'carrier').map(&amp;:shipment)\n  end\nend\n</code></pre>\n\n<p>and </p>\n\n<pre><code>class Shipment &lt; ActiveRecord::Base\n  has_many :user_shipments\n  has_many :users, through: :user_shipments\n\n  def shippers\n    user_shipments.where(role: 'shipper').map(&amp;:user)\n  end\n\n  def carriers\n    user_shipments.where(role: 'carrier').map(&amp;:user)\n  end\nend\n</code></pre>\n\n<p>and </p>\n\n<pre><code>class UserShipment &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :shipment\nend\n</code></pre>\n\n<p>how do we associate <code>carrier</code> with <code>shipper</code> such that for every <code>shipment</code> created by <code>shipper</code>, the latter can view his <code>carriers</code> for a reverse-auction type of app we're trying to build for a project?</p>\n\n<p>In other words, a <code>User</code> <code>shipper</code> creates a <code>shipment</code> and a <code>User</code> <code>carrier</code> can bid on the same, but only on those that belong to his <code>shipper</code>, or when a <code>shipment</code> is created, a <code>shipper</code> can instantly see his list of <code>carriers</code> and view their bids?</p>\n\n<p>Thanks so much! We're new to this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "shoulda"], "comments": [{"owner": {"reputation": 2174, "user_id": 3448554, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j7RcG.jpg?s=128&g=1", "display_name": "Kelsey Hannan", "link": "https://stackoverflow.com/users/3448554/kelsey-hannan"}, "edited": false, "score": 1, "creation_date": 1439950755, "post_id": 32085421, "comment_id": 52066833, "body": "You need to post your <code>Region</code> and <code>City</code> models and the relevant part of your <code>schema.rb</code> so that we can assess your data is set up correctly."}, {"owner": {"reputation": 2174, "user_id": 3448554, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j7RcG.jpg?s=128&g=1", "display_name": "Kelsey Hannan", "link": "https://stackoverflow.com/users/3448554/kelsey-hannan"}, "edited": false, "score": 0, "creation_date": 1439952518, "post_id": 32085421, "comment_id": 52067296, "body": "Again please post your schema.rb for Region and City, not your migration of City.  Finally please provide what version of Rails and Shoulda you are using."}], "answers": [{"comments": [{"owner": {"reputation": 6388, "user_id": 382920, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7052789b5f3895e4e4aaa640a4d3b904?s=128&d=identicon&r=PG", "display_name": "Necronet", "link": "https://stackoverflow.com/users/382920/necronet"}, "edited": false, "score": 0, "creation_date": 1440000239, "post_id": 32086135, "comment_id": 52095475, "body": "yes it does seem pretty clear but I still need to figure out why since I am able to link a Region to a city, checked schema.rb and database and I can see a <code>city_id integer</code> field,"}, {"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "reply_to_user": {"reputation": 6388, "user_id": 382920, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7052789b5f3895e4e4aaa640a4d3b904?s=128&d=identicon&r=PG", "display_name": "Necronet", "link": "https://stackoverflow.com/users/382920/necronet"}, "edited": false, "score": 0, "creation_date": 1440027608, "post_id": 32086135, "comment_id": 52109000, "body": "do you really need <code>add_reference :regions, :city, index: true, foreign_key: true</code> to add your foreign key? It could be an issue. There could be gem version compatibility issue. I could not find anything on that though. still trying. In the mean time, try removing that line, just keep <code>city_id</code> column in <code>regions</code> table and the proper association which you already have. Then try. Let me know!"}, {"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "reply_to_user": {"reputation": 6388, "user_id": 382920, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7052789b5f3895e4e4aaa640a4d3b904?s=128&d=identicon&r=PG", "display_name": "Necronet", "link": "https://stackoverflow.com/users/382920/necronet"}, "edited": false, "score": 0, "creation_date": 1440032467, "post_id": 32086135, "comment_id": 52110075, "body": "One thing just came into my mind. did you run: <code>RAILS_ENV=test rake db:migrate</code>? It could be your test database that does not have the <code>city_id</code> in <code>regions</code> table. Please test this and let me know! Try: <code>RAILS_ENV=test bundle exec rails c</code> then try to create a <code>Region</code> with a <code>city</code> tied to it on rails console (pointing to test database). Let me know about it."}], "tags": [], "owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "is_accepted": true, "score": 1, "last_activity_date": 1439955557, "creation_date": 1439955557, "answer_id": 32086135, "question_id": 32085421, "link": "https://stackoverflow.com/questions/32085421/unable-to-test-should-belong-to-missing-id-foreign-key-on-rails/32086135#32086135", "title": "Unable to test should belong_to, missing id foreign key on Rails", "body": "<pre><code>Region does not have a city_id foreign key.\n</code></pre>\n\n<p>Your error message clearly points out the problem. \nAs, <code>Region</code> <strong>belongs_to</strong> a <code>City</code>, it's expecting a <code>city_id</code> foreign_key in <code>Region</code> Model.</p>\n\n<p>Add a <code>city_id</code> column in your <code>Region</code> model by a migration and then this test will work! \nI think, nothing is wrong here with the <code>shoulda</code> gem. It's just your current model setup.</p>\n"}], "owner": {"reputation": 6388, "user_id": 382920, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7052789b5f3895e4e4aaa640a4d3b904?s=128&d=identicon&r=PG", "display_name": "Necronet", "link": "https://stackoverflow.com/users/382920/necronet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 2, "accepted_answer_id": 32086135, "answer_count": 1, "score": 2, "last_activity_date": 1439960244, "creation_date": 1439950025, "last_edit_date": 1439960244, "question_id": 32085421, "link": "https://stackoverflow.com/questions/32085421/unable-to-test-should-belong-to-missing-id-foreign-key-on-rails", "title": "Unable to test should belong_to, missing id foreign key on Rails", "body": "<p>Hello I have been looking for a way to test model relationship and stumble upon \n<a href=\"https://github.com/thoughtbot/shoulda\" rel=\"nofollow\">should gem</a> </p>\n\n<ul>\n<li>shoulda (3.5.0)</li>\n<li>shoulda-context (1.2.1)</li>\n<li>shoulda-matchers (2.8.0)</li>\n</ul>\n\n<p>Unfortunatly I tried to test a simple example with rspec </p>\n\n<pre><code>describe Region do\n  it  \"should have a city\" do \n    should belong_to(:city)\n  end\nend\n</code></pre>\n\n<p>and I always get a message of </p>\n\n<pre><code>Region should have a city\n     Failure/Error: should belong_to(:city)\n       Expected Region to have a belongs_to association called city (Region does not have a city_id foreign key.)\n     # ./spec/models/region_spec.rb:5:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>I though that there was something wrong with my relationships but I have test to create a Region with a city tied to it on <code>rails console</code> successfully. I must be missing something!!</p>\n\n<p><strong>Edit Models and migration</strong></p>\n\n<pre><code>class Region &lt; ActiveRecord::Base\n    belongs_to :city\nend\n\n\nclass City &lt; ActiveRecord::Base\n    validates :name, :presence =&gt; true\n    has_many :regions\nend\n</code></pre>\n\n<p>And I created the city after the region so had to modify the migration file a bit:</p>\n\n<pre><code>class CreateCities &lt; ActiveRecord::Migration\n  def change\n    create_table :cities do |t|\n      t.string :name\n      t.float :longitude\n      t.float :latitude\n      t.timestamps\n    end\n\n    add_reference :regions, :city, index: true, foreign_key: true\n\n  end\nend\n</code></pre>\n\n<p>schema.rb</p>\n\n<pre><code>  create_table \"cities\", force: true do |t|\n    t.string   \"name\"\n    t.float    \"longitude\"\n    t.float    \"latitude\"\n    t.datetime \"created_at\"\n    t.datetime \"updated_at\"\n  end\n\n  create_table \"regions\", force: true do |t|\n    t.string   \"name\"\n    t.datetime \"created_at\"\n    t.datetime \"updated_at\"\n    t.integer  \"city_id\"\n  end\n\n  add_index \"regions\", [\"city_id\"], name: \"index_regions_on_city_id\"\n</code></pre>\n"}, {"tags": ["ruby", "chef-infra", "rbenv"], "comments": [{"owner": {"reputation": 2626, "user_id": 70665, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9ad2a5355d8cfa842e24b7a4322b2535?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/70665/martin"}, "edited": false, "score": 0, "creation_date": 1440023835, "post_id": 32085015, "comment_id": 52107996, "body": "What chef cookbook did you use to install rbenv? If you used one of the community ones, they have methods for marking the ruby as &#39;global&#39; which will make it the default. Perhaps you&#39;ve omitted that? Knowing how you installed rbenv (what cookbook, what recipe, what attributes) would be hugely helpful to troubleshooting why that install didn&#39;t work the way you expected."}, {"owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "reply_to_user": {"reputation": 2626, "user_id": 70665, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9ad2a5355d8cfa842e24b7a4322b2535?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/70665/martin"}, "edited": false, "score": 0, "creation_date": 1440030979, "post_id": 32085015, "comment_id": 52109794, "body": "i&#39;ve manually set a global ruby version in the machine (as you can see from the result of rbenv global above)."}], "owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 325, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439968602, "creation_date": 1439946917, "question_id": 32085015, "link": "https://stackoverflow.com/questions/32085015/ruby-installed-with-rbenv-not-found-when-running-script-called-from-init-d", "title": "ruby installed with rbenv not found when running script called from init.d", "body": "<p>I'm using chef to deploy to a test machine.  The first part of the recipe is to install rbenv.</p>\n\n<p>The next part is to clone the <a href=\"https://github.com/secondimpression/newrelic_sidekiq_agent\" rel=\"nofollow\">newrelic_sidekiq_agent git repo</a> under <code>/web/newrelic_sidekiq_agent</code>.</p>\n\n<p>The next part is to create an init.d script from the following template.</p>\n\n<pre><code>APP_PATH=/web/newrelic_sidekiq_agent\n\n. /etc/rc.d/init.d/functions\n\nstart() {\n  cd $APP_PATH &amp;&amp; ./newrelic_sidekiq_agent.daemon start\n}\n\nstop() {\n  cd $APP_PATH &amp;&amp; ./newrelic_sidekiq_agent.daemon stop\n}\n\nstatus() {\n  cd $APP_PATH &amp;&amp; ./newrelic_sidekiq_agent.daemon status\n}\n\ncase \"$1\" in\n  start)\n    start\n    ;;\n  stop)\n    stop\n    ;;\n  restart)\n    $0 stop\n    $0 start\n    ;;\n  status)\n    status\n    ;;\n  *)\n    echo \"Usage: $0 {start|stop|status|restart}\"\n    exit 1\n    ;;\nesac\n</code></pre>\n\n<p>The content of <code>newrelic_sidekiq_agent.daemon</code> is </p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'rubygems'\nrequire 'daemons'\nrequire 'bundler/setup'\n\nDaemons.run(File.dirname(Pathname.new(__FILE__).realpath) + '/newrelic_sidekiq_agent')\n</code></pre>\n\n<p>The chef recipe fails because it can't find the ruby bin.  The error I get is</p>\n\n<pre><code>Mixlib::ShellOut::ShellCommandFailed\n------------------------------------\nExpected process to exit with [0], but received '127'\n---- Begin output of /sbin/service newrelic_sidekiq_agent start ----\nSTDOUT:\nSTDERR: /usr/bin/env: ruby: No such file or directory\n---- End output of /sbin/service newrelic_sidekiq_agent start ----\n</code></pre>\n\n<p>Logging in to the server, I set the global ruby version and then ran the following.</p>\n\n<pre><code>&gt;&gt; rbenv global\n2.1.6\n\n&gt;&gt; which ruby\n/opt/rbenv/shims/ruby\n\n&gt;&gt; /sbin/service newrelic_sidekiq_agent status\n/usr/bin/env: ruby: No such file or directory\n\n&gt;&gt; ./newrelic_sidekiq_agent.daemon status\nnewrelic_sidekiq_agent: running [pid 25208]\n</code></pre>\n\n<p>Changing the call to ruby to use absolute path works with the init.d script.</p>\n\n<pre><code>#!/usr/bin/env /opt/rbenv/shims/ruby\n</code></pre>\n\n<p>Is there a way to make it work so I don't have to use absolute path?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1439951346, "post_id": 32084883, "comment_id": 52067009, "body": "In case you didn&#39;t know, you can upvote answers, including the one you select. In future, consider waiting longer (a couple of hours, perhaps) before making a selection, so as to not discourage other answers or spoil the fun for those still working on their answers. The point is, there&#39;s no rush."}], "answers": [{"comments": [{"owner": {"reputation": 596, "user_id": 3271960, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/2NPAZ.png?s=128&g=1", "display_name": "TJH", "link": "https://stackoverflow.com/users/3271960/tjh"}, "edited": false, "score": 0, "creation_date": 1439946666, "post_id": 32084919, "comment_id": 52065865, "body": "<a href=\"http://ideone.com/ybFknt\" rel=\"nofollow noreferrer\">ideone.com/ybFknt</a> - This doesn&#39;t appear to be working for me. What did I do wrong?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 596, "user_id": 3271960, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/2NPAZ.png?s=128&g=1", "display_name": "TJH", "link": "https://stackoverflow.com/users/3271960/tjh"}, "edited": false, "score": 0, "creation_date": 1439946831, "post_id": 32084919, "comment_id": 52065909, "body": "Oh, one more thing. <code>gets</code> inputs a line. A &quot;line&quot; is defined as sequence of characters terminated by newline. Thus, <code>choice</code> is actually never <code>&quot;h&quot;</code>, but <code>&quot;h\\n&quot;</code>. Use <code>choice = gets.strip</code> to get rid of the newline character. (BTW, you don&#39;t need <code>to_s</code> unless you are worried someone will end-of-file your input and <code>nil</code> might break your code, since otherwise <code>gets</code> will always give you a string.)"}, {"owner": {"reputation": 596, "user_id": 3271960, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/2NPAZ.png?s=128&g=1", "display_name": "TJH", "link": "https://stackoverflow.com/users/3271960/tjh"}, "edited": false, "score": 0, "creation_date": 1439947352, "post_id": 32084919, "comment_id": 52066049, "body": "Can you please check out my code I linked in my first comment.  I can&#39;t seem to get it working with the &#39;choice == &#39;t&#39;&#39; method."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 1, "last_activity_date": 1439946273, "creation_date": 1439946273, "answer_id": 32084919, "question_id": 32084883, "link": "https://stackoverflow.com/questions/32084883/ruby-exact-string-match/32084919#32084919", "title": "Ruby exact string match", "body": "<p><code>choice.match('t')</code> will be truthy for any string where there is <code>t</code> anywhere in it. Use <code>choice == 't'</code>. Or, if you really want to be using regular expressions, <code>choice.match(/\\At\\Z/)</code> (match beginning, <code>t</code> and end of the string).</p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 4894585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eccc0f3f16d095977d35aeee0c6818a?s=128&d=identicon&r=PG&f=1", "display_name": "QASource", "link": "https://stackoverflow.com/users/4894585/qasource"}, "is_accepted": false, "score": 0, "last_activity_date": 1440072607, "creation_date": 1440072607, "answer_id": 32117916, "question_id": 32084883, "link": "https://stackoverflow.com/questions/32084883/ruby-exact-string-match/32117916#32117916", "title": "Ruby exact string match", "body": "<pre><code>To fix your issue, you can update your code with below changes:\n\n 1. Replace match with eql? in the above code. This will perform\n    case-sensitive string comparisons in the program. In order to\n    ensure, for case-insensitive comparisons, you can use 'casecmp'\n    method defined in ruby. \n 2.  Also, you can enhance your code by replacing\n    to_s with chomp() method it will strip off \\r,\\n.\n</code></pre>\n\n<p><strong><em>Updated code is as follows:</em></strong></p>\n\n<pre><code>puts \"~~~~~ HEADS OR TAILS ~~~~~\"\nprint \"Choose: Heads or Tails? (h,t): \"\nchoice = gets.chomp\nflip = rand(0..1)\n\nif !choice.eql?('h') &amp;&amp; !choice.eql?('t')\n  puts \"oops\"\nelsif flip === 0\n  puts \"The coin flipped as heads!\"\n  puts \"You chose: \" + choice\n  if choice.match('h')\n    puts \"YOU WIN!\"\n  elsif !choice.match('h')\n    puts \"YOU LOSE.\"\n  end\nelsif flip === 1\n  puts \"The coin flipped as tails\"\n  puts \"You chose: \" + choice\n  if choice.match('t')\n    puts \"YOU WIN!\"\n  elsif !choice.match('t')\n    puts \"YOU LOSE.\"\n  end\n</code></pre>\n\n<p>Also, you can refer to the document \"<a href=\"http://ruby-doc.org/core-2.2.2/Object.html#method-i-eql-3F\" rel=\"nofollow\">http://ruby-doc.org/core-2.2.2/Object.html#method-i-eql-3F</a>\". </p>\n"}], "owner": {"reputation": 596, "user_id": 3271960, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/2NPAZ.png?s=128&g=1", "display_name": "TJH", "link": "https://stackoverflow.com/users/3271960/tjh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1995, "favorite_count": 1, "accepted_answer_id": 32084919, "answer_count": 2, "score": 0, "last_activity_date": 1440072607, "creation_date": 1439945996, "question_id": 32084883, "link": "https://stackoverflow.com/questions/32084883/ruby-exact-string-match", "title": "Ruby exact string match", "body": "<p>so I'm teaching myself Ruby, and I made a simple heads or tails game.  The user types in 'h' to choose heads and 't' to select tails.  Under normal use, everything works fine, but unfortunately if the user types in 'th' they can win every time.  How do I only reward exact string matches?</p>\n\n<pre><code>puts \"~~~~~ HEADS OR TAILS ~~~~~\"\nprint \"Choose: Heads or Tails? (h,t): \"\nchoice = gets.to_s\nflip = rand(0..1)\n\nif !choice.match('h') &amp;&amp; !choice.match('t')\n  puts \"oops\"\nelsif flip === 0\n  puts \"The coin flipped as heads!\"\n  puts \"You chose: \" + choice.to_s\n  if choice.match('h')\n    puts \"YOU WIN!\"\n  elsif !choice.match('h')\n    puts \"YOU LOSE.\"\n  end\nelsif flip === 1\n  puts \"The coin flipped as tails\"\n  puts \"You chose: \" + choice.to_s\n  if choice.match('t')\n    puts \"YOU WIN!\"\n  elsif !choice.match('t')\n    puts \"YOU LOSE.\"\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 4, "creation_date": 1439948233, "post_id": 32084808, "comment_id": 52066240, "body": "Math operations <i>are</i> methods. Unary negation is just a fancy way of calling the <a href=\"http://ruby-doc.org/core-2.2.2/Fixnum.html#method-i-2D-40\" rel=\"nofollow noreferrer\"><code>-@</code></a> method so <code>-int</code> is just a short form of <code>int.-@</code> or <code>int.send(:-@)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1161, "user_id": 1520956, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1de66cb040b2256a6de3625fb4735ba?s=128&d=identicon&r=PG&f=1", "display_name": "rukia_kuchiki_21", "link": "https://stackoverflow.com/users/1520956/rukia-kuchiki-21"}, "edited": false, "score": 0, "creation_date": 1439945762, "post_id": 32084830, "comment_id": 52065640, "body": "Ah so there&#39;s no function for that. I see. I&#39;ll just do Math operations then. Thanks for confirming :D"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 1161, "user_id": 1520956, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1de66cb040b2256a6de3625fb4735ba?s=128&d=identicon&r=PG&f=1", "display_name": "rukia_kuchiki_21", "link": "https://stackoverflow.com/users/1520956/rukia-kuchiki-21"}, "edited": false, "score": 0, "creation_date": 1439972342, "post_id": 32084830, "comment_id": 52075125, "body": "@XirukiTepe the method is <a href=\"http://ruby-doc.org/core-2.2.2/Fixnum.html#method-i-2A%5D\" rel=\"nofollow noreferrer\"><code>Fiuxnum#*</code></a>, <code>num * -1</code> is syntactic sugar for <code>num.send(:*, -1)</code>"}], "tags": [], "owner": {"reputation": 91, "user_id": 666029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5006f7a7b62e23cb95e7aa446c1abfda?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Maia", "link": "https://stackoverflow.com/users/666029/jo%c3%a3o-maia"}, "is_accepted": false, "score": 3, "last_activity_date": 1439945613, "creation_date": 1439945613, "answer_id": 32084830, "question_id": 32084808, "link": "https://stackoverflow.com/questions/32084808/convert-positive-integer-to-negative-integer/32084830#32084830", "title": "Convert positive integer to negative integer", "body": "<p>You can just multiply per -1 the amount.</p>\n"}, {"tags": [], "owner": {"reputation": 1886, "user_id": 5107060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd82997a60e997c9fd480c8de0f2a7f1?s=128&d=identicon&r=PG&f=1", "display_name": "mooiamaduck", "link": "https://stackoverflow.com/users/5107060/mooiamaduck"}, "is_accepted": false, "score": 13, "last_activity_date": 1439945840, "creation_date": 1439945840, "answer_id": 32084861, "question_id": 32084808, "link": "https://stackoverflow.com/questions/32084808/convert-positive-integer-to-negative-integer/32084861#32084861", "title": "Convert positive integer to negative integer", "body": "<p>You can just use the unary <code>-</code> operator:</p>\n\n<pre><code>def negate_amount\n    -model.amount\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1161, "user_id": 1520956, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1de66cb040b2256a6de3625fb4735ba?s=128&d=identicon&r=PG&f=1", "display_name": "rukia_kuchiki_21", "link": "https://stackoverflow.com/users/1520956/rukia-kuchiki-21"}, "edited": false, "score": 0, "creation_date": 1439946069, "post_id": 32084874, "comment_id": 52065716, "body": "<code>abs</code> function is not found?"}, {"owner": {"reputation": 431, "user_id": 3680881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0aa92849647ac34c11b174768902690?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3680881/josh"}, "reply_to_user": {"reputation": 1161, "user_id": 1520956, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1de66cb040b2256a6de3625fb4735ba?s=128&d=identicon&r=PG&f=1", "display_name": "rukia_kuchiki_21", "link": "https://stackoverflow.com/users/1520956/rukia-kuchiki-21"}, "edited": false, "score": 0, "creation_date": 1439946235, "post_id": 32084874, "comment_id": 52065755, "body": "Sorry, need to brush up on my ruby, try <code>-(model.abs)</code>. And the abs isn&#39;t necessary, it just ensures that the return is going to be a negative number. Depending on functionality, this may or may not be what you want. Do you want a negative number to come back negative or positive? If that works I will update my answer."}], "tags": [], "owner": {"reputation": 431, "user_id": 3680881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0aa92849647ac34c11b174768902690?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3680881/josh"}, "is_accepted": false, "score": 11, "last_activity_date": 1440020892, "last_edit_date": 1495539967, "creation_date": 1439945952, "answer_id": 32084874, "question_id": 32084808, "link": "https://stackoverflow.com/questions/32084808/convert-positive-integer-to-negative-integer/32084874#32084874", "title": "Convert positive integer to negative integer", "body": "<p>Similar question to <a href=\"https://stackoverflow.com/questions/9968707/how-do-i-convert-a-positive-number-to-negative\">How do I convert a positive number to negative?</a>.\nBut in summary, if you are always expecting a negative answer you could simply say </p>\n\n<pre><code>def negate_amount\n    amount = -(model.abs)\nend\n</code></pre>\n\n<p>Otherwise, if you simply want the function to return a negative of the integer : assuming negating a negative number returns a positive number, then you would use</p>\n\n<pre><code>def negate_amount\n    amount = -(model)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439972602, "post_id": 32089540, "comment_id": 52075288, "body": "You can&#39;t multiply a string by <code>-1</code>"}, {"owner": {"reputation": 824, "user_id": 4477550, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/pzSVV.jpg?s=128&g=1", "display_name": "Vince Banzon", "link": "https://stackoverflow.com/users/4477550/vince-banzon"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439973369, "post_id": 32089540, "comment_id": 52075758, "body": "i didn&#39;t notice that.  then use .to_i instead"}, {"owner": {"reputation": 824, "user_id": 4477550, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/pzSVV.jpg?s=128&g=1", "display_name": "Vince Banzon", "link": "https://stackoverflow.com/users/4477550/vince-banzon"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439973446, "post_id": 32089540, "comment_id": 52075803, "body": "amount=amount.to_i *-1"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439973496, "post_id": 32089540, "comment_id": 52075833, "body": "According to the question, <code>amount</code> is already an integer :-)"}, {"owner": {"reputation": 824, "user_id": 4477550, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/pzSVV.jpg?s=128&g=1", "display_name": "Vince Banzon", "link": "https://stackoverflow.com/users/4477550/vince-banzon"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439973909, "post_id": 32089540, "comment_id": 52076066, "body": "Hmm, right. I also didn&#39;t notice that. So she&#39;s trying to simply ask a yes or no question.  which I don&#39;t know if there exist such method and I won&#39;t do such thing negating a number using string."}], "tags": [], "owner": {"reputation": 824, "user_id": 4477550, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/pzSVV.jpg?s=128&g=1", "display_name": "Vince Banzon", "link": "https://stackoverflow.com/users/4477550/vince-banzon"}, "is_accepted": false, "score": 2, "last_activity_date": 1439970601, "creation_date": 1439970601, "answer_id": 32089540, "question_id": 32084808, "link": "https://stackoverflow.com/questions/32084808/convert-positive-integer-to-negative-integer/32089540#32089540", "title": "Convert positive integer to negative integer", "body": "<p>How about if you multiply it by negative one?</p>\n\n<pre><code>  def negate_amount\n    amount = model.amount.to_s\n    amount = amount*-1\n  end\n</code></pre>\n"}], "owner": {"reputation": 1161, "user_id": 1520956, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1de66cb040b2256a6de3625fb4735ba?s=128&d=identicon&r=PG&f=1", "display_name": "rukia_kuchiki_21", "link": "https://stackoverflow.com/users/1520956/rukia-kuchiki-21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21399, "favorite_count": 2, "answer_count": 4, "score": 6, "last_activity_date": 1440020892, "creation_date": 1439945391, "last_edit_date": 1439945839, "question_id": 32084808, "link": "https://stackoverflow.com/questions/32084808/convert-positive-integer-to-negative-integer", "title": "Convert positive integer to negative integer", "body": "<pre><code>  def negate_amount\n    amount = model.amount.to_s\n    (\"-\" + amount).to_i\n  end\n</code></pre>\n\n<p>is there a better way to turn positive integer to negative?</p>\n\n<p>The code above works, but is there a ruby or rails function for that? Without doing math operations?</p>\n"}, {"tags": ["ruby", "loops", "while-loop"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439996030, "post_id": 32084681, "comment_id": 52092386, "body": "<i>&quot;Will produce both the same output&quot;</i> - nope"}], "answers": [{"tags": [], "owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "is_accepted": true, "score": 7, "last_activity_date": 1439950984, "last_edit_date": 1439950984, "creation_date": 1439945360, "answer_id": 32084801, "question_id": 32084681, "link": "https://stackoverflow.com/questions/32084681/what-is-the-difference-between-the-while-and-until-loops-in-ruby/32084801#32084801", "title": "What is the difference between the while and until loops in ruby?", "body": "<p>ruby allows multiple ways of doing exactly the same thing, so that the code can read naturally depending on which sounds better for you and the code you are writing. Sometimes a conditional works better in the positive eg <code>something_is_happening?</code> vs the negative <code>something_is_done</code></p>\n\n<p>and <code>while</code> works while something positive is continuing to be positive, whereas <code>until</code> continues the loop until something negative occurs.</p>\n\n<p>eg</p>\n\n<pre><code>while 'yes' == keep_going do\n   keep_going = get_answer\nend\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>until 'stop' == answer do\n   answer = get_answer\nend\n</code></pre>\n\n<p>Also i note that you haven't actually tried running your two loops in irb...I know this because the output of the second one is definitely not the same as the first.</p>\n\n<pre><code>2.1.2 :008 &gt; $i = 0\n =&gt; 0 \n2.1.2 :009 &gt; $num = 5\n =&gt; 5 \n2.1.2 :010 &gt; \n2.1.2 :011 &gt;   until $i &lt; $num  do\n2.1.2 :012 &gt;        puts(\"Inside the loop i = #$i\" )\n2.1.2 :013?&gt;      $i +=1;\n2.1.2 :014 &gt;     end\n =&gt; nil \n</code></pre>\n\n<p>This is because when ruby interprets \"is <code>$i &lt; $num</code> yet\" it evaluates to true and then stops immediately.</p>\n"}, {"tags": [], "owner": {"reputation": 236, "user_id": 3982034, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/054y0.jpg?s=128&g=1", "display_name": "Surge", "link": "https://stackoverflow.com/users/3982034/surge"}, "is_accepted": false, "score": 0, "last_activity_date": 1551963681, "creation_date": 1551963681, "answer_id": 55044426, "question_id": 32084681, "link": "https://stackoverflow.com/questions/32084681/what-is-the-difference-between-the-while-and-until-loops-in-ruby/55044426#55044426", "title": "What is the difference between the while and until loops in ruby?", "body": "<p><code>until</code> can also be used to get the same result as <code>while</code>.</p>\n\n<p>In this case <code>until $i &gt;= $num do</code> works similarly to <code>while $i &lt; $num</code>  </p>\n\n<pre><code>2.4.0 :002 &gt; $i = 0\n =&gt; 0 \n2.4.0 :003 &gt; $num = 5\n =&gt; 5 \n2.4.0 :004 &gt; until $i &gt;= $num do\n2.4.0 :005 &gt;     puts(\"Inside the loop i = #$i\")\n2.4.0 :006?&gt;   $i += 1 \n2.4.0 :007?&gt;   end\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 5229030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QFD7.png?s=128&g=1", "display_name": "kCC", "link": "https://stackoverflow.com/users/5229030/kcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3647, "favorite_count": 0, "accepted_answer_id": 32084801, "answer_count": 2, "score": 5, "last_activity_date": 1551963681, "creation_date": 1439944285, "question_id": 32084681, "link": "https://stackoverflow.com/questions/32084681/what-is-the-difference-between-the-while-and-until-loops-in-ruby", "title": "What is the difference between the while and until loops in ruby?", "body": "<p>In Ruby there are to loops that appear to do the exact same thing as each other, the <strong>while</strong> and <strong>until</strong> loops.</p>\n\n<p>What would be a situation to use one over the other and why does Ruby have two loops that seem to do the same thing?</p>\n\n<p>The while loops syntax is as follows:</p>\n\n<pre><code>while conditional [do]\n   code\nend\n</code></pre>\n\n<p>And the <strong>until</strong> syntax:</p>\n\n<pre><code>until conditional [do]\n   code\nend\n</code></pre>\n\n<p>So to make this as clear as possible:</p>\n\n<pre><code>$i = 0\n$num = 5\n\nwhile $i &lt; $num  do\n   puts(\"Inside the loop i = #$i\" )\n   $i +=1\nend\n</code></pre>\n\n<p>And</p>\n\n<pre><code>$i = 0\n$num = 5\n\nuntil $i &lt; $num  do\n   puts(\"Inside the loop i = #$i\" )\n   $i +=1;\nend\n</code></pre>\n\n<p>Will produce both the same out put of:</p>\n\n<pre><code>Inside the loop i = 0\nInside the loop i = 1\nInside the loop i = 2\nInside the loop i = 3\nInside the loop i = 4\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "rake", "faker"], "comments": [{"owner": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 0, "creation_date": 1440096417, "post_id": 32084542, "comment_id": 52143544, "body": "it just hangs there, nothing after that output?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "reply_to_user": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 0, "creation_date": 1440096882, "post_id": 32084542, "comment_id": 52143782, "body": "Yes. I let it hang for roughly 10 hours overnight even, no change."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "edited": false, "score": 0, "creation_date": 1439948585, "post_id": 32084987, "comment_id": 52066326, "body": "<code>bundle install</code> works fine, but when I run <code>bunlde exec ruby test</code> from the root, I get <code>C:\\workspace\\faker&gt;bundle exec ruby test DL is deprecated, please use Fiddle ruby: Is a directory -- test (LoadError)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "edited": false, "score": 0, "creation_date": 1439948911, "post_id": 32084987, "comment_id": 52066393, "body": "I&#39;ve tried <code>C:\\workspace\\faker\\tasks&gt;bundle exec rake test</code>, but that has really strange behavior and results in the name of each test file being printed and then the system just hanging..."}], "tags": [], "owner": {"reputation": 91, "user_id": 666029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5006f7a7b62e23cb95e7aa446c1abfda?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Maia", "link": "https://stackoverflow.com/users/666029/jo%c3%a3o-maia"}, "is_accepted": false, "score": 0, "last_activity_date": 1439946682, "creation_date": 1439946682, "answer_id": 32084987, "question_id": 32084542, "link": "https://stackoverflow.com/questions/32084542/how-can-i-run-test-files-on-windows-using-rake/32084987#32084987", "title": "how can I run test files on Windows using rake?", "body": "<p>I tried this and works fine:</p>\n\n<pre><code>bundle install\nbundle exec ruby test\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440096392, "creation_date": 1439943231, "last_edit_date": 1440096392, "question_id": 32084542, "link": "https://stackoverflow.com/questions/32084542/how-can-i-run-test-files-on-windows-using-rake", "title": "how can I run test files on Windows using rake?", "body": "<p>UPDATE: when I run <code>rake test</code> from root, I get:</p>\n\n<pre><code>C:\\workspace\\faker&gt;rake test\nDL is deprecated, please use Fiddle\nC:/RailsInstaller/Ruby2.1.0/bin/ruby.exe -w -I\"lib;test;.\" -I\"C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/rake-10.4.2/lib\" \"C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/rake-10.4.2/lib/rake/rake_test_loader.r\nb\" \"test/test_array_sample_method_compat.rb\" \"test/test_avatar.rb\" \"test/test_en_au_ocker_locale.rb\" \"test/test_en_ca_locale.rb\" \"test/test_en_locale.rb\" \"test/test_en_ug_locale.rb\" \"test/test_en_us_locale.rb\" \"test/test_es_l\nocale.rb\" \"test/test_faker.rb\" \"test/test_faker_app.rb\" \"test/test_faker_bitcoin.rb\" \"test/test_faker_book.rb\" \"test/test_faker_business.rb\" \"test/test_faker_city.rb\" \"test/test_faker_code.rb\" \"test/test_faker_color.rb\" \"test\n/test_faker_commerce.rb\" \"test/test_faker_company.rb\" \"test/test_faker_date.rb\" \"test/test_faker_hacker_talk.rb\" \"test/test_faker_internet.rb\" \"test/test_faker_lorem.rb\" \"test/test_faker_name.rb\" \"test/test_faker_number.rb\" \"\ntest/test_faker_shakespear.rb\" \"test/test_faker_shakespeare.rb\" \"test/test_faker_slack_emoji.rb\" \"test/test_faker_street.rb\" \"test/test_faker_team.rb\" \"test/test_faker_time.rb\" \"test/test_faker_university.rb\" \"test/test_flexi\nble.rb\" \"test/test_helper.rb\" \"test/test_locale.rb\" \"test/test_pl_locale.rb\" \"test/test_uk_locale.rb\"`\n</code></pre>\n\n<p>I don't fully understand what rake is doing at this point, but the system hangs infinitely. What am I missing?</p>\n\n<p>So I have built some added functionality for the faker gem, and want to run the tests I wrote before submitting a pull request. However, all my attempts to run the existing tests, and my new tests, have failed. I am worried that it is a Windows machine related issue.</p>\n\n<p>I have tried running <code>rake test:units</code> but it gives me an error and then hangs, while also ringing the Bell on my system 5 times. Strange right?</p>\n\n<p>I have also tried running <code>bundle exec rspec spec</code>, but no tests are found becasue they are not RSpec unit tests, or at least not in the right location.</p>\n\n<p>To see how the gem is formatted, check it out at <a href=\"https://github.com/stympy/faker\" rel=\"nofollow\">the repo</a></p>\n\n<p>All the test files, including my new one, live in the <code>test</code> directory. But for the life of me, I can't run them. </p>\n"}, {"tags": ["ruby", "activerecord", "sqlite", "self-join"], "owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1439950576, "creation_date": 1439943167, "last_edit_date": 1495542762, "question_id": 32084531, "link": "https://stackoverflow.com/questions/32084531/activerecord-equivalent-of-messy-self-join", "title": "ActiveRecord equivalent of messy self-join", "body": "<p>Given the following models:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class File &lt; ActiveRecord::Base\n  has_many :transfers\nend\n\nclass Transfer &lt; ActiveRecord::Base\n  belongs_to :file\n  enum status: [:pending, :in_progress, :succeeded, :failed]\nend\n</code></pre>\n\n<p>Now, I want to find those <code>Files</code> that have <code>:failed</code> <code>Transfers</code>, and <em>only</em> <code>:failed</code> <code>Transfers</code>. (One <code>File</code> can have many <code>Transfers</code> -- in particular, if a transfer operation fails, another transfer for that file may be scheduled later, and might succeed.)</p>\n\n<p>Based on <a href=\"https://stackoverflow.com/a/32083685/27358\">this answer</a> and some experimentation, the following SQL query seems to be the fastest way to do this:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT DISTINCT files.*\nFROM\n  files INNER JOIN transfers t1\n  ON files.id = t1.file_id AND t1.status = 3   -- 3 = :failed\n  LEFT JOIN transfers t2\n  ON files.id = t2.file_id AND t2.status &lt;&gt; 3  -- 3 = :failed\nWHERE\n  t2.id IS NULL\n</code></pre>\n\n<p>Now, obviously I can use this directly with <code>find_by_sql</code>, but it seems like there ought to be a way to code it with the <a href=\"http://guides.rubyonrails.org/active_record_querying.html\" rel=\"nofollow noreferrer\">ActiveRecord query interface</a> and get the same result, <em>without</em> any raw SQL or SQL fragments. I'm thinking something like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>File.joins(:transfers).where(transfers: { status: 3 })\n  .not.includes(transfer).where('status &lt;&gt; 3')\n</code></pre>\n\n<p>-- but you can't use <code>.not</code> there, plus it still includes a SQL fragment, and I'm not really sure of the <code>includes()</code> semantics in any case.</p>\n\n<p>Maybe the AR query interface just isn't powerful enough to do what I want?</p>\n"}, {"tags": ["ruby", "voltrb"], "answers": [{"tags": [], "owner": {"reputation": 6433, "user_id": 1064917, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/219d10e3fc486c3173291954195d537c?s=128&d=identicon&r=PG", "display_name": "Rick", "link": "https://stackoverflow.com/users/1064917/rick"}, "is_accepted": false, "score": 0, "last_activity_date": 1439942707, "creation_date": 1439942707, "answer_id": 32084484, "question_id": 32084439, "link": "https://stackoverflow.com/questions/32084439/using-a-voltmodel-as-a-dictionary-of-key-value-pairs/32084484#32084484", "title": "Using a Volt::Model as a dictionary of Key/Value pairs", "body": "<p>Figured it out. This works:</p>\n\n<pre><code>&lt;dl&gt;\n  {{ dictionary.keys.each do |key| }}\n  &lt;dt&gt;Term: {{ key }}&lt;/dt&gt;\n  &lt;dd&gt;Definition: {{ dictionary.get(key) }}&lt;/dd&gt;\n  {{ end }}\n&lt;/dl&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 359, "user_id": 3518266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NHTHc.jpg?s=128&g=1", "display_name": "Torsten", "link": "https://stackoverflow.com/users/3518266/torsten"}, "is_accepted": false, "score": 0, "last_activity_date": 1439943033, "creation_date": 1439943033, "answer_id": 32084516, "question_id": 32084439, "link": "https://stackoverflow.com/questions/32084439/using-a-voltmodel-as-a-dictionary-of-key-value-pairs/32084516#32084516", "title": "Using a Volt::Model as a dictionary of Key/Value pairs", "body": "<p>The version in the question should almost work. You just have to use each_pair instead of each.</p>\n"}, {"tags": [], "owner": {"reputation": 876, "user_id": 368602, "user_type": "registered", "profile_image": "https://graph.facebook.com/144900684/picture?type=large", "display_name": "Ryan", "link": "https://stackoverflow.com/users/368602/ryan"}, "is_accepted": true, "score": 1, "last_activity_date": 1439953561, "creation_date": 1439953561, "answer_id": 32085885, "question_id": 32084439, "link": "https://stackoverflow.com/questions/32084439/using-a-voltmodel-as-a-dictionary-of-key-value-pairs/32085885#32085885", "title": "Using a Volt::Model as a dictionary of Key/Value pairs", "body": "<p>Sorry, I don't have .each_pair working in bindings in Volt yet, its on the todo list.  Yea, you can use .keys.each do |key| in the mean time.</p>\n"}], "owner": {"reputation": 6433, "user_id": 1064917, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/219d10e3fc486c3173291954195d537c?s=128&d=identicon&r=PG", "display_name": "Rick", "link": "https://stackoverflow.com/users/1064917/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 32085885, "answer_count": 3, "score": 0, "last_activity_date": 1439953561, "creation_date": 1439942321, "question_id": 32084439, "link": "https://stackoverflow.com/questions/32084439/using-a-voltmodel-as-a-dictionary-of-key-value-pairs", "title": "Using a Volt::Model as a dictionary of Key/Value pairs", "body": "<p>I would like to use a Volt::Model as a reactive dictionary in a view.</p>\n\n<p>Ideally, I would like something like this:</p>\n\n<pre><code>&lt;dl&gt;\n  {{ dictionary.each do |key, val| }}\n  &lt;dt&gt;Term: {{ key }}&lt;/dt&gt;\n  &lt;dd&gt;Definition: {{ val }}&lt;/dd&gt;\n  {{ end }}\n&lt;/dl&gt;\n</code></pre>\n\n<p>Is this possible in Volt without using an ArrayModel?</p>\n"}, {"tags": ["ruby", "terminal", "cucumber"], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 3236557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/p6V9b.jpg?s=128&g=1", "display_name": "Kirill Zhukov", "link": "https://stackoverflow.com/users/3236557/kirill-zhukov"}, "is_accepted": true, "score": 0, "last_activity_date": 1439960458, "creation_date": 1439960458, "answer_id": 32086875, "question_id": 32084260, "link": "https://stackoverflow.com/questions/32084260/i-get-the-same-error-on-terminal-for-different-file/32086875#32086875", "title": "I get the same error on terminal for different file", "body": "<p>Error message speaks for itself: you have scenario outline without examples table. Either include examples table, either replace <code>Scenario Outline:</code> with just <code>Scenario:</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 4847217, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/593ab746ad994bc7803414cc8f4ff28c?s=128&d=identicon&r=PG&f=1", "display_name": "ownJava", "link": "https://stackoverflow.com/users/4847217/ownjava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 32086875, "answer_count": 1, "score": -1, "last_activity_date": 1439961511, "creation_date": 1439940842, "last_edit_date": 1439961511, "question_id": 32084260, "link": "https://stackoverflow.com/questions/32084260/i-get-the-same-error-on-terminal-for-different-file", "title": "I get the same error on terminal for different file", "body": "<p>I am running a feature file on Cucumber and every-time I get the same error message. No matter what feature file tags I run.</p>\n\n<blockquote>\n  <p>Missing Examples section for Scenario Outline at\n  features/support/internetonly.feature:10\n  (Cucumber::Core::Gherkin::ParseError)</p>\n</blockquote>\n\n<p>Please help.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby", "gem", "rubygems", "rvm"], "answers": [{"comments": [{"owner": {"reputation": 2120, "user_id": 474701, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/80b006d40de5e39fe50bd6868dd53969?s=128&d=identicon&r=PG", "display_name": "Richard Burton", "link": "https://stackoverflow.com/users/474701/richard-burton"}, "edited": false, "score": 0, "creation_date": 1440009600, "post_id": 32085589, "comment_id": 52100748, "body": "Thanks. That\u2019s where I got confused :)"}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 1, "last_activity_date": 1439951426, "creation_date": 1439951426, "answer_id": 32085589, "question_id": 32084222, "link": "https://stackoverflow.com/questions/32084222/rvm-works-ruby-gems-installed-but-not-accessible-with-require/32085589#32085589", "title": "RVM works, Ruby gems installed, but not accessible with require", "body": "<p>You need to require <code>plaid</code>, not <code>plaid-ruby</code>. The file you require doesn\u2019t necessarily have the same name as the gem, although it\u2019s often the case that it does.</p>\n\n<p>In fact from the <a href=\"https://rubygems.org/gems/plaid-ruby\" rel=\"nofollow\">Rubygems page for <code>plaid-ruby</code></a> and the <a href=\"https://github.com/plaid/plaid-ruby\" rel=\"nofollow\">Github page it links to</a> it looks like it is an old version of the Plaid client, <a href=\"https://github.com/plaid/plaid-ruby/blob/master/plaid.gemspec#L6\" rel=\"nofollow\">and you should be using the <code>plaid</code> gem</a>.</p>\n"}], "owner": {"reputation": 2120, "user_id": 474701, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/80b006d40de5e39fe50bd6868dd53969?s=128&d=identicon&r=PG", "display_name": "Richard Burton", "link": "https://stackoverflow.com/users/474701/richard-burton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 32085589, "answer_count": 1, "score": 0, "last_activity_date": 1439951426, "creation_date": 1439940480, "last_edit_date": 1439945067, "question_id": 32084222, "link": "https://stackoverflow.com/questions/32084222/rvm-works-ruby-gems-installed-but-not-accessible-with-require", "title": "RVM works, Ruby gems installed, but not accessible with require", "body": "<p>Here\u2019s my problem:</p>\n\n<pre><code>\u279c  ~ rvm current\nruby-2.2.1\n\u279c  ~ rvm list\n\nrvm rubies\n\n   ruby-2.0.0-p643 [ x86_64 ]\n   ruby-2.1.1 [ x86_64 ]\n=* ruby-2.2.1 [ x86_64 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n\n\u279c  ~ ruby -v\nruby 2.2.1p85 (2015-02-26 revision 49769) [x86_64-darwin14]\n\u279c  ~ gem list\n\n*** LOCAL GEMS ***\n\nbigdecimal (1.2.6)\nbundler (1.10.6)\ncoderay (1.1.0)\ndomain_name (0.5.24)\nhttp-cookie (1.0.2)\nio-console (0.4.3)\njson (1.8.1)\nmethod_source (0.8.2)\nmime-types (2.6.1)\nnetrc (0.10.3)\nplaid-ruby (0.1.2)\nplist (3.1.0)\npry (0.10.1)\npsych (2.0.8)\nrake (10.4.2)\nrdoc (4.2.0)\nrest-client (1.8.0)\nslop (3.6.0)\nunf (0.1.4)\nunf_ext (0.0.7.1)\n\u279c  ~ irb\nirb(main):001:0&gt; require 'plaid-ruby'\nLoadError: cannot load such file -- plaid-ruby\n    from /Users/richardburton/.rvm/rubies/ruby-2.2.1/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    from /Users/richardburton/.rvm/rubies/ruby-2.2.1/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    from (irb):1\n    from /Users/richardburton/.rvm/rubies/ruby-2.2.1/bin/irb:11:in `&lt;main&gt;'\nirb(main):002:0&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 3299, "user_id": 1749638, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cERvr.jpg?s=128&g=1", "display_name": "coderhs", "link": "https://stackoverflow.com/users/1749638/coderhs"}, "edited": false, "score": 1, "creation_date": 1439940848, "post_id": 32084166, "comment_id": 52064531, "body": "Does the books table have an amazon id field? Did you run the migration on heroku."}, {"owner": {"reputation": 115, "user_id": 5191975, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/805ad6b209bc95fe971a65e95f1221f4?s=128&d=identicon&r=PG&f=1", "display_name": "Hola", "link": "https://stackoverflow.com/users/5191975/hola"}, "reply_to_user": {"reputation": 3299, "user_id": 1749638, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cERvr.jpg?s=128&g=1", "display_name": "coderhs", "link": "https://stackoverflow.com/users/1749638/coderhs"}, "edited": false, "score": 0, "creation_date": 1439944888, "post_id": 32084166, "comment_id": 52065438, "body": "Yes I did &quot;heroku run rake db:migrate&quot; but it doesn&#39;t help. &quot;heroku run rake db:setup&quot; - help me. So why? Should I create a new database every time after deploy?"}], "answers": [{"tags": [], "owner": {"reputation": 25150, "user_id": 383888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Kd57u.jpg?s=128&g=1", "display_name": "Mori", "link": "https://stackoverflow.com/users/383888/mori"}, "is_accepted": false, "score": 2, "last_activity_date": 1439940194, "creation_date": 1439940194, "answer_id": 32084185, "question_id": 32084166, "link": "https://stackoverflow.com/questions/32084166/how-to-define-this-method-in-ruby/32084185#32084185", "title": "How to define this method in Ruby?", "body": "<p>This line is the key:</p>\n\n<pre><code>&gt; ActionView::Template::Error (undefined method `amazon_id' for #&lt;Book:0x007f06994ea498&gt;):\n</code></pre>\n\n<p>Your <code>book</code> instance doesn't respond to <code>amazon_id</code>. Try checking the value, e.g.</p>\n\n<pre><code>puts \"amazon_id: #{book.try(:amazon_id)}\"\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5191975, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/805ad6b209bc95fe971a65e95f1221f4?s=128&d=identicon&r=PG&f=1", "display_name": "Hola", "link": "https://stackoverflow.com/users/5191975/hola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439940194, "creation_date": 1439940042, "question_id": 32084166, "link": "https://stackoverflow.com/questions/32084166/how-to-define-this-method-in-ruby", "title": "How to define this method in Ruby?", "body": "<p>I really stuck with this error and hope someone help me to solve it. \nSo, I use this helper: </p>\n\n<pre><code>module BooksHelper\n  def image_from_amazon(amazon_id)\n        image_tag \"http://images.amazon.com/images/P/#{amazon_id}.01.ZTZZZZZZ.jpg\"\n  end\nend\n</code></pre>\n\n<p>View file</p>\n\n<pre><code>&gt; &lt;%= image_from_amazon(book.amazon_id) %&gt;\n</code></pre>\n\n<p>On my local machine everything working fine except Heroku. Logs:</p>\n\n<pre><code>&gt; ActionView::Template::Error (undefined method `amazon_id' for #&lt;Book:0x007f06994ea498&gt;):\n2015-08-18T16:28:19.320038+00:00 app[web.1]:      7: &lt;% @books.each do |book| %&gt;\n2015-08-18T16:28:19.320040+00:00 app[web.1]:      8: &lt;div class=\"book\"&gt;\n2015-08-18T16:28:19.320041+00:00 app[web.1]:      9:   &lt;div class=\"cover\"&gt;\n2015-08-18T16:28:19.320042+00:00 app[web.1]:     10:     &lt;%= image_from_amazon(book.amazon_id) %&gt;\n2015-08-18T16:28:19.320044+00:00 app[web.1]:     11:   &lt;/div&gt;\n2015-08-18T16:28:19.320045+00:00 app[web.1]:     12:   &lt;div class=\"content\"&gt;\n2015-08-18T16:28:19.320047+00:00 app[web.1]:     13:     &lt;h4 class=\"title\"&gt;&lt;%= link_to book.title, book %&gt;&lt;/h4&gt;\n2015-08-18T16:28:19.320048+00:00 app[web.1]:   app/views/books/index.html.erb:10:in `block in _app_views_books_index_html_erb__843408363563836431_69833158224880'\n2015-08-18T16:28:19.320050+00:00 app[web.1]:   app/views/books/index.html.erb:7:in `_app_views_books_index_html_erb__843408363563836431_69833158224880'\n</code></pre>\n"}, {"tags": ["ruby", "forms", "ruby-on-rails-4", "collections", "simple-form"], "comments": [{"owner": {"reputation": 2174, "user_id": 3448554, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j7RcG.jpg?s=128&g=1", "display_name": "Kelsey Hannan", "link": "https://stackoverflow.com/users/3448554/kelsey-hannan"}, "edited": false, "score": 0, "creation_date": 1439952168, "post_id": 32083841, "comment_id": 52067204, "body": "The best thing I could find to an answer to your question on how to do this was here:  <a href=\"http://w3facility.org/question/how-to-change-class-of-a-label-for-checkboxes-in-simple_form/#answer-15036409\" rel=\"nofollow noreferrer\">w3facility.org/question/&hellip;</a>"}], "owner": {"reputation": 2287, "user_id": 2842709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/30f658c76a63bcb3f40cc305020e6109?s=128&d=identicon&r=PG", "display_name": "MicFin", "link": "https://stackoverflow.com/users/2842709/micfin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1570547759, "creation_date": 1439938137, "question_id": 32083841, "link": "https://stackoverflow.com/questions/32083841/rails-simple-form-add-class-to-collection-input-based-on-collection-item-attribu", "title": "Rails simple_form add class to collection input based on collection item attribute", "body": "<p>I would like to add a css class to the input element of only some of the collection boxes based on the collection items attribute.</p>\n\n<p>Here is my collection.</p>\n\n<pre><code>&lt;%= f.collection_check_boxes :group_ids, @groups, :id, :name, :checked =&gt; @user.group_ids %&gt;\n</code></pre>\n\n<p>To add a class to all of the inputs, I could do</p>\n\n<pre><code>&lt;%= f.collection_check_boxes :group_ids, @groups, :id, :name, :checked =&gt; @user.group_ids, input_html: { class: 'getsClass' } %&gt;\n</code></pre>\n\n<p>But I only need it on some of the inputs, I need something along the lines of</p>\n\n<pre><code>&lt;%= f.collection_check_boxes :group_ids, @groups, :id, :name, :checked =&gt; @user.group_ids, input_html: { class: {group.new == true ? \"getsClass\"} } %&gt;\n</code></pre>\n\n<p>but I can not access the group.  Thanks for your guidance!</p>\n"}, {"tags": ["ruby", "module", "self", "enumerable"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1439937507, "post_id": 32083632, "comment_id": 52063545, "body": "This is a very big question. It seems doubtful to me that a reader could provide a better explanation than is given in any Ruby book or essay on <code>self</code>. Neither is it a good use of readers&#39; time when excellent explanations are available within easy reach."}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 5268592, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/706623049443244/picture?type=large", "display_name": "Rajesh Choudhary", "link": "https://stackoverflow.com/users/5268592/rajesh-choudhary"}, "edited": false, "score": 0, "creation_date": 1441955145, "post_id": 32083693, "comment_id": 52893049, "body": "i want ur help regarding nokogiri"}], "tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": false, "score": 1, "last_activity_date": 1439937316, "creation_date": 1439937316, "answer_id": 32083693, "question_id": 32083632, "link": "https://stackoverflow.com/questions/32083632/how-does-self-work-in-ruby/32083693#32083693", "title": "How does .self work in Ruby?", "body": "<p>In Ruby, you have objects that you can send messages to. The object you send a message to is called the \"receiver\" of that message. Calling a method on an object basically just sends a message with the method's name to that object.</p>\n\n<p><code>self</code> is a Ruby language construct which refers to whatever the current receiver is. So, when you mix the Enumerable module into a class, then instantiate the class and call <code>#my_each</code> on it, the receiver will be an instance of that class, which you can get a handle to with the keyword <code>self</code>.</p>\n"}], "owner": {"reputation": 551, "user_id": 4613575, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/94ee57c5cea9f3b94b68b7e5cf76369e?s=128&d=identicon&r=PG&f=1", "display_name": "hackrnaut", "link": "https://stackoverflow.com/users/4613575/hackrnaut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "closed_date": 1439938557, "answer_count": 1, "score": 0, "last_activity_date": 1439939254, "creation_date": 1439936967, "last_edit_date": 1439939254, "question_id": 32083632, "link": "https://stackoverflow.com/questions/32083632/how-does-self-work-in-ruby", "closed_reason": "Duplicate", "title": "How does .self work in Ruby?", "body": "<p>I'm trying to re-write enumerable methods just for practice. I do not understand how <code>self</code> works in my methods. I know how to use it and what it returns, but what does <code>self</code> refer to?</p>\n\n<p>Here's a sample of the <code>each</code> method I re-wrote to extend the <code>Enumerable</code> method [sic].</p>\n\n<pre><code>module Enumerable\n  def my_each\n    return self unless block_given?\n    i = 0\n    while i &lt; self.length\n      yield(self[i])\n      i+=1\n    end\n  end\nend\n</code></pre>\n\n<p>If someone can clarify how <code>self</code> works, I'd appreciate it. More specifically, I would like to know what <code>self.length</code> refers to and what role it plays in my code.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-drive-api", "google-apps", "google-api-client"], "comments": [{"owner": {"reputation": 977, "user_id": 4204155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b97cac237052e03909c015c998f96e1?s=128&d=identicon&r=PG&f=1", "display_name": "SGC", "link": "https://stackoverflow.com/users/4204155/sgc"}, "edited": false, "score": 0, "creation_date": 1440006118, "post_id": 32083555, "comment_id": 52098727, "body": "Once you register in developers console for service account, you get email address like XXXX@developer.gserviceaccount.com. To add files into your drive using service account, you need to impersonate the email address of the user by instantiating drive service. check this link <a href=\"https://developers.google.com/drive/web/delegation\" rel=\"nofollow noreferrer\">developers.google.com/drive/web/delegation</a>"}, {"owner": {"reputation": 637, "user_id": 2059561, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/0187e3cab96975381f84302185091bb5?s=128&d=identicon&r=PG", "display_name": "prussiap", "link": "https://stackoverflow.com/users/2059561/prussiap"}, "reply_to_user": {"reputation": 977, "user_id": 4204155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b97cac237052e03909c015c998f96e1?s=128&d=identicon&r=PG&f=1", "display_name": "SGC", "link": "https://stackoverflow.com/users/4204155/sgc"}, "edited": false, "score": 0, "creation_date": 1440030414, "post_id": 32083555, "comment_id": 52109682, "body": "But I need a Google Apps account or can I just use the blah@gmail.com account and service account. Also from what I&#39;ve seen the drive site is for pre 0.90 drive ?"}, {"owner": {"reputation": 977, "user_id": 4204155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b97cac237052e03909c015c998f96e1?s=128&d=identicon&r=PG&f=1", "display_name": "SGC", "link": "https://stackoverflow.com/users/4204155/sgc"}, "edited": false, "score": 0, "creation_date": 1440194735, "post_id": 32083555, "comment_id": 52189074, "body": "You should have Google Apps account"}, {"owner": {"reputation": 637, "user_id": 2059561, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/0187e3cab96975381f84302185091bb5?s=128&d=identicon&r=PG", "display_name": "prussiap", "link": "https://stackoverflow.com/users/2059561/prussiap"}, "reply_to_user": {"reputation": 977, "user_id": 4204155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b97cac237052e03909c015c998f96e1?s=128&d=identicon&r=PG&f=1", "display_name": "SGC", "link": "https://stackoverflow.com/users/4204155/sgc"}, "edited": false, "score": 0, "creation_date": 1440512878, "post_id": 32083555, "comment_id": 52297447, "body": "Still having issues with client. I edited and added code example. any sample &quot;impersonation&quot; using above code would be very helpful. Thanks again for the tips."}], "owner": {"reputation": 637, "user_id": 2059561, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/0187e3cab96975381f84302185091bb5?s=128&d=identicon&r=PG", "display_name": "prussiap", "link": "https://stackoverflow.com/users/2059561/prussiap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1440512823, "creation_date": 1439936542, "last_edit_date": 1440512823, "question_id": 32083555, "link": "https://stackoverflow.com/questions/32083555/ruby-google-api-client-service-account-and-google-app-to-use-google-drive", "title": "ruby google api client, service account and Google app to use google drive", "body": "<p>You can skip to the problem below but in short I can auth, upload and get a file list but it doesn't correspond to the gmail account I setup with the service account and google dev console</p>\n\n<p><strong>longer version:</strong>\nI created a new email account say blah@gmail.com and used the google development console to enable drive, contacts and a few other APIs for my project.</p>\n\n<p>Then I created the service account API keys/secrets and downloaded the client_secrets.json as well.</p>\n\n<p>It took a while but got authentication working with the ruby google-api-client and I can login via rails console. </p>\n\n<p><strong>Problem:</strong>\nI'm getting file.list but it only has the Getting Started.pdf even though I've created a few docs and spreadsheets on the blah@gmail.com service account.</p>\n\n<p>I can also upload a file but don't see it.</p>\n\n<p>I \"think\" that it's uploading to Google Apps related account? but I have neither set one up nor do I own domain for the organization I'm setting this up with.</p>\n\n<p>I have no idea where the files are going or uploading or how I can access the drive account I actually did setup with blah@gmail.com</p>\n\n<p>what's going on .</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Can i get some code example on how to modify this to impersonate user? </p>\n\n<pre><code>require 'google/apis/drive_v2'\n\nDrive = Google::Apis::DriveV2\n\n@drive = Drive::DriveService.new\n\n\nscope = 'https://www.googleapis.com/auth/drive'\n@drive.authorization = Google::Auth.get_application_default([scope])\n\n#give me list of files\n@files = @drive.list_files\nputs \"Search results:\"\n@files.items.each do |file|\n  puts \"- File: #{file.title} (#{file.id})\"\nend\n</code></pre>\n\n<p>If I have to setup google apps this might be tough since they only have subdomains and I don't have direct access. The type of thing I wish I had been told up front.</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4564260, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wY2e7C1lShU/AAAAAAAAAAI/AAAAAAAAACA/J5AQ-Brzgoo/photo.jpg?sz=128", "display_name": "drsbhattac", "link": "https://stackoverflow.com/users/4564260/drsbhattac"}, "edited": false, "score": 0, "creation_date": 1439986442, "post_id": 32084369, "comment_id": 52084819, "body": "Yes! but my question is what necessary changes I need to perform on my code. I already have an AWS account. From their tutorial its not clear!"}, {"owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "reply_to_user": {"reputation": 1, "user_id": 4564260, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wY2e7C1lShU/AAAAAAAAAAI/AAAAAAAAACA/J5AQ-Brzgoo/photo.jpg?sz=128", "display_name": "drsbhattac", "link": "https://stackoverflow.com/users/4564260/drsbhattac"}, "edited": false, "score": 0, "creation_date": 1440000950, "post_id": 32084369, "comment_id": 52095805, "body": "@drsbhattac I&#39;m not sure if I understand. If you have an AWS account you will need to launch a new EC2 instance."}], "tags": [], "owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1439941807, "creation_date": 1439941807, "answer_id": 32084369, "question_id": 32083526, "link": "https://stackoverflow.com/questions/32083526/running-a-ruby-program-on-aws/32084369#32084369", "title": "Running a ruby program on AWS", "body": "<p>You can run Ruby scripts on anything that <a href=\"https://www.ruby-lang.org/en/downloads/\" rel=\"nofollow\">has Ruby installed</a>.</p>\n\n<p>AWS (Amazon Web Services) provides you with a suite of tools to host servers (among other things). So your question <strong>\"is it possible to run a simple ruby code on amazon AWS?\"</strong> makes almost no sense at all. However, if you host an AWS server with some operating system, such as Ubuntu, then all you need to do is install Ruby, but it typically comes pre-installed on Linux.</p>\n"}], "owner": {"reputation": 1, "user_id": 4564260, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wY2e7C1lShU/AAAAAAAAAAI/AAAAAAAAACA/J5AQ-Brzgoo/photo.jpg?sz=128", "display_name": "drsbhattac", "link": "https://stackoverflow.com/users/4564260/drsbhattac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1439941962, "creation_date": 1439936395, "last_edit_date": 1439941962, "question_id": 32083526, "link": "https://stackoverflow.com/questions/32083526/running-a-ruby-program-on-aws", "title": "Running a ruby program on AWS", "body": "<p>I have a Ruby code that I would like to run on AWS. Is is possible to run Ruby code on AWS?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439933731, "post_id": 32082741, "comment_id": 52062099, "body": "<code>Object.new</code> does not take an argument, maybe you should pick a class that does, like <code>String</code> or <code>Array</code>."}, {"owner": {"reputation": 71, "user_id": 4785364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/262ea62c3affa3d730dd6c22d859ca04?s=128&d=identicon&r=PG&f=1", "display_name": "Shibl", "link": "https://stackoverflow.com/users/4785364/shibl"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439934649, "post_id": 32082741, "comment_id": 52062495, "body": "@stefan .. Thanks, I edited my question"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4785364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/262ea62c3affa3d730dd6c22d859ca04?s=128&d=identicon&r=PG&f=1", "display_name": "Shibl", "link": "https://stackoverflow.com/users/4785364/shibl"}, "edited": false, "score": 0, "creation_date": 1439934777, "post_id": 32082846, "comment_id": 52062547, "body": "Just edited my question. what happens in case we use an Array or String instead of Object?"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1439933154, "creation_date": 1439933154, "answer_id": 32082846, "question_id": 32082741, "link": "https://stackoverflow.com/questions/32082741/new-array-declaration-in-ruby/32082846#32082846", "title": "New array declaration in Ruby", "body": "<p>The first one is assignment, and will not create a new object. The second one is invalid (under default definition of <code>Object</code>), and will raise an argument error.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1439937077, "creation_date": 1439937077, "answer_id": 32083654, "question_id": 32082741, "link": "https://stackoverflow.com/questions/32082741/new-array-declaration-in-ruby/32083654#32083654", "title": "New array declaration in Ruby", "body": "<p>Consider the following:</p>\n\n<pre><code>old_arr = [1,2,3]              #=&gt; [1, 2, 3] \nold_arr.object_id              #=&gt; 70142672048160 \n\nnew_arr = old_arr              #=&gt; [1, 2, 3] \nnew_arr.object_id              #=&gt; 70142672048160 \n\nnewer_arr = Array.new(old_arr) #=&gt; [1, 2, 3] \nnewer_arr.object_id            #=&gt; 70142675883800 \n</code></pre>\n\n<p>So you see the local variables <code>old_arr</code> and <code>new_arr</code> hold the same array object. By contrast, the variable <code>newer_arr</code> holds a different array object.</p>\n\n<p>Now try this:</p>\n\n<pre><code>old_arr[0] = 'X'               #=&gt; \"X\" \nold_arr                        #=&gt; [\"X\", 2, 3] \n</code></pre>\n\n<p>then</p>\n\n<pre><code>new_arr                        #=&gt; [\"X\", 2, 3] \nnewer_arr                      #=&gt; [1, 2, 3] \n</code></pre>\n\n<p><code>newer_arr</code> points to what is called a \"shallow copy\" of <code>old_arr</code>. To see what this means, consider another example:</p>\n\n<pre><code>old_arr = [1,2,[3,4]]          #=&gt; [1, 2, [3, 4]] \nnew_arr = old_arr              #=&gt; [1, 2, [3, 4]] \nnewer_arr = Array.new(old_arr) #=&gt; [1, 2, [3, 4]] \n\nold_arr[0] = 'X'               #=&gt; \"X\"\nold_arr[2][0] = 'Y'            #=&gt; \"Y\"\nold_arr                        #=&gt; [\"X\", 2, [\"Y\", 4]] \nnew_arr                        #=&gt; [\"X\", 2, [\"Y\", 4]] \nnewer_arr                      #=&gt; [1, 2, [\"Y\", 4]] \n</code></pre>\n\n<p>As before, <code>newer_arr[0]</code> has not been modified, and <code>newer_arr[2]</code> contains the same object as it did previously, but that object has been modified.</p>\n"}, {"tags": [], "owner": {"reputation": 796, "user_id": 3915216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/792d736baa8e05b9f379690d40c3b6a7?s=128&d=identicon&r=PG&f=1", "display_name": "piezol", "link": "https://stackoverflow.com/users/3915216/piezol"}, "is_accepted": false, "score": 0, "last_activity_date": 1439937195, "creation_date": 1439937195, "answer_id": 32083673, "question_id": 32082741, "link": "https://stackoverflow.com/questions/32082741/new-array-declaration-in-ruby/32083673#32083673", "title": "New array declaration in Ruby", "body": "<p>\"what happens in case we use an Array or String instead of Object?\"</p>\n\n<p>That depends on the class definition itself, so you should look at the documentation.\nBasically, #new method creates a new object and then calls \"initialize\" method with parameters passed to it.</p>\n\n<p>To answer your question:\nArray.new method copies the array passed to it (actually, as i said before: it passes that array to initialize method, which copies it).\nSame happens with String.</p>\n\n<p>The easiest way to know such things is actually repl.\nIn irb execute following lines, one by one:</p>\n\n<pre><code>a = \":)\"\nb = a\na[1] = '('\nputs a\nputs b\n\n\na = \":)\"\nb = String.new(a)\na[1] = '('\nputs a\nputs b\n\n\na = [1,2,3]\nb = a\na[1] = 10\nputs a\nputs b\n\n\na = [1,2,3]\nb = Array.new(a)\na[1] = 10\nputs a\nputs b\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 4785364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/262ea62c3affa3d730dd6c22d859ca04?s=128&d=identicon&r=PG&f=1", "display_name": "Shibl", "link": "https://stackoverflow.com/users/4785364/shibl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1440036305, "creation_date": 1439932768, "last_edit_date": 1440036305, "question_id": 32082741, "link": "https://stackoverflow.com/questions/32082741/new-array-declaration-in-ruby", "title": "New array declaration in Ruby", "body": "<p>In Ruby, what is the difference between:</p>\n\n<pre><code>new_array = old_array\n</code></pre>\n\n<p>and</p>\n\n<pre><code>new_array = Array.new(old_array)\n</code></pre>\n"}, {"tags": ["ruby", "irb"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439934483, "post_id": 32082606, "comment_id": 52062424, "body": "<code>-r</code> loads the library using <code>require</code> and according to <a href=\"http://ruby-doc.org/core-2.2.2/Kernel.html#method-i-require\" rel=\"nofollow noreferrer\">its documentation</a>: <i>&quot;local variables will not be propagated to the loading environment.&quot;</i>."}, {"owner": {"reputation": 1576, "user_id": 1163940, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pvAaY.jpg?s=128&g=1", "display_name": "xst", "link": "https://stackoverflow.com/users/1163940/xst"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1439936235, "post_id": 32082606, "comment_id": 52063139, "body": "@Stefan thanks, I&#39;m looking through the docs now for some kind of &quot;with binding&quot; functionality, otherwise I&quot;ll try to write something to expose the binding to the irb session"}], "answers": [{"comments": [{"owner": {"reputation": 1576, "user_id": 1163940, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pvAaY.jpg?s=128&g=1", "display_name": "xst", "link": "https://stackoverflow.com/users/1163940/xst"}, "edited": false, "score": 0, "creation_date": 1439935414, "post_id": 32083143, "comment_id": 52062835, "body": "I agree that the purpose of local variables is to separate that context from the calling context and avoid pollution, etc..  Im looking for some kind of meta-programming solution more for understanding than for actual production usage"}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1439935787, "post_id": 32083143, "comment_id": 52062983, "body": "no offense but I must offend. if you are unclear on local vs global scope (which your question proves) your quest for understanding starts there, meta programming magic is for after you build your lightsaber."}, {"owner": {"reputation": 1576, "user_id": 1163940, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pvAaY.jpg?s=128&g=1", "display_name": "xst", "link": "https://stackoverflow.com/users/1163940/xst"}, "reply_to_user": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1439936743, "post_id": 32083143, "comment_id": 52063320, "body": "@engineerDave yeah well i&#39;m kinda new to Ruby. in javascript the global context is the same in a script and in an interactive node session."}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1439936842, "post_id": 32083143, "comment_id": 52063347, "body": "yeah everything is pretty much global in JS LOL but scope is important in ruby because of things like Proc and lamdas, good luck!"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1439934380, "creation_date": 1439934380, "answer_id": 32083143, "question_id": 32082606, "link": "https://stackoverflow.com/questions/32082606/irb-access-pre-load-script-local-variables/32083143#32083143", "title": "irb access pre-load script local variables", "body": "<p>No. You can't access local variables from a different scope. That's the <em>whole point</em> of local variables: they are local to the scope they are defined in.</p>\n\n<p>In this case, <code>a</code> is local to the script body of <code>script.rb</code>.</p>\n"}], "owner": {"reputation": 1576, "user_id": 1163940, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pvAaY.jpg?s=128&g=1", "display_name": "xst", "link": "https://stackoverflow.com/users/1163940/xst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1439935084, "creation_date": 1439932266, "last_edit_date": 1439935084, "question_id": 32082606, "link": "https://stackoverflow.com/questions/32082606/irb-access-pre-load-script-local-variables", "title": "irb access pre-load script local variables", "body": "<p>i'm using <code>irb -I . -r script.rb</code> to <code>require</code> a script before starting an interactive session.  functions defined in the global scope are available but variables aren't unless they are declared with <code>@</code></p>\n\n<p>is there a way to access local variables defined in the global context of a script or a better way to do this</p>\n\n<hr>\n\n<p><em>script.rb</em>:\n</p>\n\n<pre><code>def func() \"...\" end\na = \"str\"\n@b = 1\n</code></pre>\n\n<p>then after <code>irb</code> starts:</p>\n\n<pre><code>irb(main):001:0&gt; a\n\nNameError: undefined local variable or method `a' for main:Object\n    from (irb):1\n    from /usr/bin/irb:11:in `&lt;main&gt;'\n\nirb(main):002:0&gt; @b\n\n=&gt; 1\n\nirb(main):003:0&gt; func\n\n=&gt; \"...\"\n</code></pre>\n\n<p>i'm assuming that the script's contents are executed as if defined in a function (eg: <code>main</code> in C-type languages) and so the variables at the global context are local variables that are not accessible outside that scope</p>\n\n<p>so do most people use <code>@</code> variables when writing their scripts?</p>\n\n<p>the use-case is narrow in scope (script development) and the solution is trivial (search-replace any <code>variable</code> with <code>@variable</code>), but I'm learning the semantics of the language and I'm curious about this.  Can't the <a href=\"http://ruby-doc.org/core-2.2.0/Binding.html\" rel=\"nofollow\">execution context</a> be exposed and merged into the current context somehow?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 575, "user_id": 2855747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ef29652da2fde5184c329af0e72ccea?s=128&d=identicon&r=PG", "display_name": "Colto", "link": "https://stackoverflow.com/users/2855747/colto"}, "edited": false, "score": 0, "creation_date": 1439935859, "post_id": 32082481, "comment_id": 52063005, "body": "There is something wrong in <code>spec&#47;controllers&#47;reports_controller_spec.rb:11</code>, start there."}, {"owner": {"reputation": 575, "user_id": 2855747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ef29652da2fde5184c329af0e72ccea?s=128&d=identicon&r=PG", "display_name": "Colto", "link": "https://stackoverflow.com/users/2855747/colto"}, "edited": false, "score": 0, "creation_date": 1439936398, "post_id": 32082481, "comment_id": 52063208, "body": "Also, you shouldn&#39;t have to be setting the rails env. You should be able to just run <code>bundle exec rspec spec</code>."}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 3193634, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/KrJxo.jpg?s=128&g=1", "display_name": "Grunthor", "link": "https://stackoverflow.com/users/3193634/grunthor"}, "is_accepted": false, "score": 1, "last_activity_date": 1439994312, "creation_date": 1439994312, "answer_id": 32098278, "question_id": 32082481, "link": "https://stackoverflow.com/questions/32082481/rspec-errors-after-starting-tests/32098278#32098278", "title": "Rspec errors after starting tests", "body": "<p>without ENV it's the same story.\nMy reports_controller_spec.rb :</p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe ReportsController do\n  let(:user) { create :user }\n\n  before { sign_in user }\n\n  describe 'GET #subjects' do\n    subject { get :subjects }\n\n    it_behaves_like 'template rendering action', :subjects\n  end\nend\n</code></pre>\n\n<p>I'm new in spec tests and I don't see errors. That's reports_controller.rb. Mayby will be helpful.</p>\n\n<pre><code>class ReportsController &lt; ApplicationController\n  expose(:subject_items) { SubjectItem.includes(:teacher, :students) }\nend\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 3193634, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/KrJxo.jpg?s=128&g=1", "display_name": "Grunthor", "link": "https://stackoverflow.com/users/3193634/grunthor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439994312, "creation_date": 1439931711, "last_edit_date": 1439932315, "question_id": 32082481, "link": "https://stackoverflow.com/questions/32082481/rspec-errors-after-starting-tests", "title": "Rspec errors after starting tests", "body": "<p>I tried to start my rspec test, and after</p>\n\n<pre><code>RAILS_ENV=test bundle exec rspec\n</code></pre>\n\n<p>I got:</p>\n\n<pre><code>    /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:348:in `find_and_eval_shared': Could not find shared examples \"template rend\nering action\" (ArgumentError)\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:309:in `block (2 levels) in define_nested_shared_group_method'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:363:in `module_exec'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:363:in `subclass'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:254:in `block in define_example_group_method'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:308:in `block in define_nested_shared_group_method'\n        from /home/nitrous/poznan-workshops-2015/spec/controllers/reports_controller_spec.rb:11:in `block (2 levels) in &lt;top (required)&gt;'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:363:in `module_exec'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:363:in `subclass'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:254:in `block in define_example_group_method'\n        from /home/nitrous/poznan-workshops-2015/spec/controllers/reports_controller_spec.rb:8:in `block in &lt;top (required)&gt;'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:363:in `module_exec'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:363:in `subclass'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/example_group.rb:254:in `block in define_example_group_method'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/dsl.rb:43:in `block in expose_example_group_alias'\n        from /home/nitrous/poznan-workshops-2015/spec/controllers/reports_controller_spec.rb:3:in `&lt;top (required)&gt;'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/configuration.rb:1327:in `load'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/configuration.rb:1327:in `block in load_spec_files'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/configuration.rb:1325:in `each'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/configuration.rb:1325:in `load_spec_files'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/runner.rb:102:in `setup'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/runner.rb:88:in `run'\n        from /home/nitrous/poznan-workshops-2015/.bundle/gems/rspec-core-3.3.0/lib/rspec/core/runner.rb:73:in `run'\n</code></pre>\n\n<p>I googled it but didn't find the solution. I noticed that rspec only on models works fine, but when I want to start it on controllers I get the same error.\nAll gems which are needed I've installed properly.</p>\n"}, {"tags": ["arrays", "ruby", "hash", "filter"], "answers": [{"tags": [], "owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "is_accepted": false, "score": 0, "last_activity_date": 1439936347, "last_edit_date": 1495541173, "creation_date": 1439936347, "answer_id": 32083519, "question_id": 32082469, "link": "https://stackoverflow.com/questions/32082469/ruby-method-to-select-property-in-possibly-nested-array-of-objects/32083519#32083519", "title": "Ruby method to select property in possibly nested array of objects", "body": "<p>there is a <a href=\"http://ruby-doc.org/core-2.2.0/Hash.html#method-i-fetch\" rel=\"nofollow noreferrer\">fetch</a> method on hash but it doesn't recurse through object</p>\n\n<p>you could use this <a href=\"https://stackoverflow.com/a/19116143/793330\">answer</a> or there are many deep fetch examples out there. good luck!</p>\n"}], "owner": {"reputation": 595, "user_id": 621460, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/196ee442bda8b74a1982ba5fa5389670?s=128&d=identicon&r=PG", "display_name": "Carlos Vergara", "link": "https://stackoverflow.com/users/621460/carlos-vergara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1038, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439937793, "creation_date": 1439931676, "last_edit_date": 1439937793, "question_id": 32082469, "link": "https://stackoverflow.com/questions/32082469/ruby-method-to-select-property-in-possibly-nested-array-of-objects", "title": "Ruby method to select property in possibly nested array of objects", "body": "<p>I'm having a problem trying to get objects from an array where a given hash might either have a specific property and a specific value, or a nested hash which potentially can too. </p>\n\n<p>Is there a method for returning the specific hash that has the key I need OR RECURSE when it doesn't? </p>\n\n<p>Example: I have this completely made-up structure: </p>\n\n<pre><code>  the_array = [\n  {\n    :is_father =&gt; true, \n    :seek_this =&gt; \"01\"  \n  },\n  {\n    :is_uncle =&gt; false,\n    :children =&gt; [\n       {\n         :seek_this =&gt; \"09\"\n       },\n       {\n         :seek_this =&gt; \"2a\"\n       }\n    ]\n  },\n  {\n    :random_property=&gt; 3,\n    :children =&gt; {\n      :random_er =&gt; true,\n      :children =&gt; [\n        {\n          :is_father =&gt; false,\n          :children =&gt; [\n             {\n               :seek_this =&gt; \"3b\"\n             },\n             {\n               :seek_this =&gt; \"h1\"\n             }\n          ]\n        }\n      ]\n    }\n  }\n]\n</code></pre>\n\n<p>And after calling</p>\n\n<pre><code>the_array\n  .methodThatIDoNotKnow { |x| !x.seek_this.nil? } \n  .each do |hash_i_need|\n  //operate on hash somehow\n  hash_i_need.seek_this = 0xDEADBEEF\nend\n</code></pre>\n\n<p>This is what I would expect to have happened:</p>\n\n<pre><code>  the_array = [\n  {\n    :some_key =&gt; true, \n    :seek_this =&gt; 0xDEADBEEF\n  },\n  {\n    :some_other_key =&gt; false,\n    :children =&gt; [\n       {\n         :seek_this =&gt; 0xDEADBEEF\n       },\n       {\n         :seek_this =&gt; 0xDEADBEEF\n       }\n    ]\n  },\n  {\n    :random_key: 3,\n    :children =&gt; {\n      :random_er =&gt; true,\n      :children  =&gt; [\n        {\n          :is_father =&gt; false,\n          :children  =&gt; [\n             {\n               :seek_this =&gt; 0xDEADBEEF\n             },\n             {\n               :seek_this =&gt; 0xDEADBEEF\n             }\n          ]\n        }\n      ]\n    }\n  }\n]\n</code></pre>\n\n<p>I understand this is something that I can code myself, I'm just wondering <strong>if I need to</strong> or there is functionality for this kind of search out of the box. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "appium"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5318708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6efdc0251169a8c4954ab6fe96fc2393?s=128&d=identicon&r=PG&f=1", "display_name": "Eric F", "link": "https://stackoverflow.com/users/5318708/eric-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1441831893, "last_edit_date": 1441831893, "creation_date": 1441831086, "answer_id": 32488744, "question_id": 32082460, "link": "https://stackoverflow.com/questions/32082460/send-multiple-processarguments-in-appium/32488744#32488744", "title": "Send multiple ProcessArguments in appium", "body": "<p>I'm assuming that you're trying to pass two arguments above, separated by a comma. Here's how you would do that (I've only tested this on iOS) --</p>\n\n<pre><code>:processArguments =&gt; \"\\\"-web_url_environment #{$env}\\\" \\\"-mock_setup true\\\"\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4053103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3a594f4bb62c8d96bc52c2aa801efb9?s=128&d=identicon&r=PG&f=1", "display_name": "Radhika Pothukuchi", "link": "https://stackoverflow.com/users/4053103/radhika-pothukuchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441831893, "creation_date": 1439931653, "question_id": 32082460, "link": "https://stackoverflow.com/questions/32082460/send-multiple-processarguments-in-appium", "title": "Send multiple ProcessArguments in appium", "body": "<p>Is there any format that we can follow to send multiple processArguments with appium?</p>\n\n<p>Here is the format we tried and didn't work. I didn't find an example for this in appium documentation. Appreciate if anybody has tried this and has the format that works.</p>\n\n<pre><code>    :processArguments =&gt; \"-web_url_environment #{$env}, -mock_setup true\"\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 6, "creation_date": 1439931433, "post_id": 32082391, "comment_id": 52060983, "body": "Single quotes do not interpolate. Use <code>&quot;</code>."}, {"owner": {"reputation": 1785, "user_id": 3373470, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8f968c218643a09267014e4beaeb4770?s=128&d=identicon&r=PG&f=1", "display_name": "onebree", "link": "https://stackoverflow.com/users/3373470/onebree"}, "edited": false, "score": 2, "creation_date": 1439931493, "post_id": 32082391, "comment_id": 52061004, "body": "How does double quotes not work? Can you show us some output from IRB or something? That way we can see how it parses the strings"}, {"owner": {"reputation": 4022, "user_id": 1741325, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/amaxC.png?s=128&g=1", "display_name": "DaniG2k", "link": "https://stackoverflow.com/users/1741325/danig2k"}, "edited": false, "score": 2, "creation_date": 1439931511, "post_id": 32082391, "comment_id": 52061014, "body": "First of all, if you need to interpolate you should use <code>&quot;-variable #{ENV[&#39;TEXT&#39;]}&quot;</code>. Second, why is there a comma at the end of your example?"}, {"owner": {"reputation": 5139, "user_id": 1735262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Reinstate Monica -- notmaynard", "link": "https://stackoverflow.com/users/1735262/reinstate-monica-notmaynard"}, "edited": false, "score": 1, "creation_date": 1439932273, "post_id": 32082391, "comment_id": 52061389, "body": "From <a href=\"http://ruby-doc.org/core-2.2.2/doc/syntax/literals_rdoc.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.2.2/doc/syntax/literals_rdoc.html</a>: <code>Double-quote strings allow interpolation of other values using #{...} ... . ... Interpolation may be disabled by escaping the \u201c#\u201d character or using single-quote strings</code>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1439933545, "post_id": 32082391, "comment_id": 52062008, "body": "What is your question?"}], "answers": [{"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 2, "last_activity_date": 1439932525, "creation_date": 1439932525, "answer_id": 32082671, "question_id": 32082391, "link": "https://stackoverflow.com/questions/32082391/inject-variable-into-single-quote-string/32082671#32082671", "title": "Inject variable into single quote string", "body": "<p>You have to use double-quotes or <code>%Q(...)</code> to interpolate variables into a string:</p>\n\n<pre><code>foo = 'word'\n'a #{foo}' # =&gt; \"a \\#{foo}\"\n\"a #{foo}\" # =&gt; \"a word\"\n%Q(a #{foo}) # =&gt; \"a word\"\n</code></pre>\n\n<p>There are other ways but that's a different question.</p>\n"}], "owner": {"reputation": 1412, "user_id": 2752065, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/0ce2fdf5a902f6b23843d59e02c06c4a?s=128&d=identicon&r=PG&f=1", "display_name": "elcharrua", "link": "https://stackoverflow.com/users/2752065/elcharrua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "closed_date": 1439934435, "accepted_answer_id": 32082671, "answer_count": 1, "score": -2, "last_activity_date": 1439932632, "creation_date": 1439931358, "last_edit_date": 1439932632, "question_id": 32082391, "link": "https://stackoverflow.com/questions/32082391/inject-variable-into-single-quote-string", "closed_reason": "Not suitable for this site", "title": "Inject variable into single quote string", "body": "<p>I have the following string:</p>\n\n<pre><code>'-variable #{ENV['TEXT']}', \n</code></pre>\n\n<p>When I'm trying to inject <code>#{ENV['TEXT']}</code>, <code>ENV['TEXT']</code> isn't seen as a variable. </p>\n\n<p>I tried using the double quote but with the double-quote it doesn't work.</p>\n"}, {"tags": ["ruby", "grape", "grape-api", "wisper"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 1, "creation_date": 1440001405, "post_id": 32082288, "comment_id": 52096054, "body": "Maybe pub/sub is not approprite for this since publishing is fire and forget, there is no return value. I&#39;d suggest the service to return a value which is then transformed to JSON, e.g. <code>MyJSONSerializer.new(MyService.call(params))</code>"}, {"owner": {"reputation": 1366, "user_id": 1843422, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/l4DDN.jpg?s=128&g=1", "display_name": "There Are Four Lights", "link": "https://stackoverflow.com/users/1843422/there-are-four-lights"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1442407682, "post_id": 32082288, "comment_id": 53068979, "body": "In fact this <i>is</i> fire and forget, and I&#39;m just triggering an even to invoke calculations"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1442476501, "post_id": 32082288, "comment_id": 53100228, "body": "In the question you say you need to respond to the post with the result of the subscriber, am I misreading?"}], "answers": [{"tags": [], "owner": {"reputation": 6689, "user_id": 273444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26988136c0514172417b7c7c863733f2?s=128&d=identicon&r=PG", "display_name": "Alexey Shein", "link": "https://stackoverflow.com/users/273444/alexey-shein"}, "is_accepted": true, "score": 3, "last_activity_date": 1442434738, "creation_date": 1442434738, "answer_id": 32617927, "question_id": 32082288, "link": "https://stackoverflow.com/questions/32082288/wisper-and-grape-return-results-from-a-post-request/32617927#32617927", "title": "Wisper and Grape return results from a POST request", "body": "<p>The point of PubSub pattern is that Publisher is <em>completely</em> unaware of its subscribers. What you are trying to achieve is to pass Subscriber's result back to Publisher, which is against all of the idea.</p>\n\n<p>What you can do, however, is to make your subscriber also a publisher and collect responses in a separate subscriber. </p>\n\n<p>Please, note, that this is sample code as I don't have Grape installed at hand (but, hopefully, it works):</p>\n\n<pre><code>class ResponseListener\n  attr_reader :response\n\n  def initialize\n    @response = {}\n  end\n\n  def collect_response(item)\n    @response.merge!(item) # customize as you wish\n  end\nend\n\nclass SomeSub\n  include Wisper::Publisher\n\n  def do_calculations(payload)\n     broadcast(:collect_response, result: \"42\")\n  end\nend\n\nmodule Something\n  class Doit &lt; Grape::API\n    post :now do\n      response_listener = ResponseListener.new\n      # globally subscribe response_listener to all events it can respond to\n      Wisper.subscribe(response_listener) \n\n      service = SomePub.new\n      service.subscribe(SomeSub.new)\n      service.call(params)\n\n      response_listener.response.to_json # render collected response\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1366, "user_id": 1843422, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/l4DDN.jpg?s=128&g=1", "display_name": "There Are Four Lights", "link": "https://stackoverflow.com/users/1843422/there-are-four-lights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 32617927, "answer_count": 1, "score": 3, "last_activity_date": 1442434738, "creation_date": 1439930850, "last_edit_date": 1439931158, "question_id": 32082288, "link": "https://stackoverflow.com/questions/32082288/wisper-and-grape-return-results-from-a-post-request", "title": "Wisper and Grape return results from a POST request", "body": "<p>I have a simple POST Grape endpoint with Wisper pub/sub in a background:</p>\n\n<pre><code>module Something\n  class Doit &lt; Grape::API\n    post :now do\n      service = SomePub.new\n      service.subscribe(SomeSub.new)\n      service.call(params)\n    end\n  end\nend\n</code></pre>\n\n<p>Here is the <code>SomeSub</code> where actually calculations happens:</p>\n\n<pre><code>class SomeSub\n  def do_calculations(payload)\n     {result: \"42\"}.to_json\n  end\nend\n</code></pre>\n\n<p><code>SomePub</code> is simple too:</p>\n\n<pre><code>class SomePub\n  include Wisper::Publisher\n\n  def call(payload)\n    broadcast(:do_calculations, payload)\n  end\nend\n</code></pre>\n\n<p><strong>So what I need is</strong> to respond with the JSON <code>{result: \"42\"}</code>, when calling the Grape's <code>post :now</code> endpoint.</p>\n\n<p>Unfortunately it doesn't work this way, and what I have is:</p>\n\n<pre><code>{\"local_registrations\":[{\"listener\":{},\"on\":{},\"with\":null,\"prefix\":\"\",\"allowed_classes\":[],\"broadcaster\":{}}]}\n</code></pre>\n\n<p>That example from Wisper's wiki doesn't help too much (<a href=\"https://github.com/krisleech/wisper/wiki/Grape\" rel=\"nofollow\">https://github.com/krisleech/wisper/wiki/Grape</a>)</p>\n\n<p>Any ideas how to actually pass <code>SomePub#do_calculations</code> results, as a result of Grape's endpoint call?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 55166, "user_id": 88851, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f42db155847d3648bc14b86bf838af06?s=128&d=identicon&r=PG", "display_name": "Bastien L&#233;onard", "link": "https://stackoverflow.com/users/88851/bastien-l%c3%a9onard"}, "edited": false, "score": 0, "creation_date": 1439930269, "post_id": 32082134, "comment_id": 52060402, "body": "What happens when you run the command? (bin/rake db:migrate RAILS_ENV=development)"}, {"owner": {"reputation": 69, "user_id": 3605702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa8c1edb2bec51a8a955887240f0be58?s=128&d=identicon&r=PG&f=1", "display_name": "miro", "link": "https://stackoverflow.com/users/3605702/miro"}, "reply_to_user": {"reputation": 55166, "user_id": 88851, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f42db155847d3648bc14b86bf838af06?s=128&d=identicon&r=PG", "display_name": "Bastien L&#233;onard", "link": "https://stackoverflow.com/users/88851/bastien-l%c3%a9onard"}, "edited": false, "score": 0, "creation_date": 1439930683, "post_id": 32082134, "comment_id": 52060614, "body": "rake aborted! ActiveRecord::DuplicatedMigrationNameError: Multiple migrations have the name create comments"}, {"owner": {"reputation": 6190, "user_id": 5029266, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7d4922cf09a8b3d3195cd4d848091ba3?s=128&d=identicon&r=PG", "display_name": "EugZol", "link": "https://stackoverflow.com/users/5029266/eugzol"}, "edited": false, "score": 0, "creation_date": 1439931615, "post_id": 32082134, "comment_id": 52061071, "body": "@miro, well, rename your duplicate migration! :)"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 1889806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa4cfb353f2d9b38eeb0e8ab64816ea?s=128&d=identicon&r=PG", "display_name": "Konstantin Plyusnin", "link": "https://stackoverflow.com/users/1889806/konstantin-plyusnin"}, "edited": false, "score": 0, "creation_date": 1439932505, "post_id": 32082441, "comment_id": 52061502, "body": "haven&#39;t seen comments while was writing answer. so that was just duplicated names"}], "tags": [], "owner": {"reputation": 41, "user_id": 1889806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa4cfb353f2d9b38eeb0e8ab64816ea?s=128&d=identicon&r=PG", "display_name": "Konstantin Plyusnin", "link": "https://stackoverflow.com/users/1889806/konstantin-plyusnin"}, "is_accepted": false, "score": 0, "last_activity_date": 1439931563, "creation_date": 1439931563, "answer_id": 32082441, "question_id": 32082134, "link": "https://stackoverflow.com/questions/32082134/migrations-are-pending-to-resolve-this-issue-run-bin-rake-dbmigrate-rails-en/32082441#32082441", "title": "Migrations are pending. To resolve this issue, run: bin/rake db:migrate RAILS_ENV=development error when running as server", "body": "<p>If you did and if you don't have any important data in the database, you should destroy your database and recreate it using existing migrations. These commands in this order:<br>\n<code>$ rake db:drop</code><br>\nif you're using postgres<br>\n<code>$ rake db:create</code><br>\nand finally remigrate<br>\n<code>$ rake db:migrate</code></p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 3605702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa8c1edb2bec51a8a955887240f0be58?s=128&d=identicon&r=PG&f=1", "display_name": "miro", "link": "https://stackoverflow.com/users/3605702/miro"}, "edited": false, "score": 0, "creation_date": 1439932055, "post_id": 32082485, "comment_id": 52061290, "body": "thanks a lot i have found two files with the same name"}], "tags": [], "owner": {"reputation": 55166, "user_id": 88851, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f42db155847d3648bc14b86bf838af06?s=128&d=identicon&r=PG", "display_name": "Bastien L&#233;onard", "link": "https://stackoverflow.com/users/88851/bastien-l%c3%a9onard"}, "is_accepted": true, "score": 1, "last_activity_date": 1439931723, "creation_date": 1439931723, "answer_id": 32082485, "question_id": 32082134, "link": "https://stackoverflow.com/questions/32082134/migrations-are-pending-to-resolve-this-issue-run-bin-rake-dbmigrate-rails-en/32082485#32082485", "title": "Migrations are pending. To resolve this issue, run: bin/rake db:migrate RAILS_ENV=development error when running as server", "body": "<p>Migration files live in the <code>db/migrate</code> directory, and their names look like this:</p>\n\n<pre><code>20150121164407_create_comments.rb\n</code></pre>\n\n<p>From your comment, it looks like inside your <code>db/migrate</code> directory, you have several migrations with the same \u201cbasic\u201d name <code>create_comments</code> (and probably different timestamps).\nYou need to remove one of those duplicated files.</p>\n"}], "owner": {"reputation": 69, "user_id": 3605702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa8c1edb2bec51a8a955887240f0be58?s=128&d=identicon&r=PG&f=1", "display_name": "miro", "link": "https://stackoverflow.com/users/3605702/miro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8811, "favorite_count": 2, "accepted_answer_id": 32082485, "answer_count": 2, "score": 0, "last_activity_date": 1439931723, "creation_date": 1439930148, "last_edit_date": 1495541379, "question_id": 32082134, "link": "https://stackoverflow.com/questions/32082134/migrations-are-pending-to-resolve-this-issue-run-bin-rake-dbmigrate-rails-en", "title": "Migrations are pending. To resolve this issue, run: bin/rake db:migrate RAILS_ENV=development error when running as server", "body": "<p>I have tried to run as a server before and it worked well, I don't change anything in the database but when I tried to run again a have this message <code>Migrations are pending. To resolve this issue, run: bin/rake db:migrate RAILS_ENV=development</code></p>\n\n<p>i tried as this site <a href=\"https://stackoverflow.com/questions/20082002/migrations-are-pending-run-bin-rake-dbmigrate-rails-env-development-to-resol?rq=1#_=_\">link</a>\nbut it failed \nany help please \ni am a beginner in ruby on rails</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "typhoeus"], "answers": [{"tags": [], "owner": {"reputation": 2070, "user_id": 1010826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d926cfe6638d33207f97dbd5a5103ba1?s=128&d=identicon&r=PG", "display_name": "Magnuss", "link": "https://stackoverflow.com/users/1010826/magnuss"}, "is_accepted": true, "score": 1, "last_activity_date": 1439929808, "creation_date": 1439929808, "answer_id": 32082058, "question_id": 32081805, "link": "https://stackoverflow.com/questions/32081805/what-is-my-error-log-telling-me/32082058#32082058", "title": "What is my error log telling me?", "body": "<p>Yes, it seems that the error is on their part.</p>\n\n<p><code>Typhoeus -https://github.com/typhoeus/typhoeus</code> is the default user agent.\n<a href=\"https://github.com/typhoeus/typhoeus/blob/master/lib/typhoeus.rb#L50\" rel=\"nofollow\">https://github.com/typhoeus/typhoeus/blob/master/lib/typhoeus.rb#L50</a></p>\n"}], "owner": {"reputation": 5183, "user_id": 799618, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/449b61e3b1906e8198b18b338259808c?s=128&d=identicon&r=PG", "display_name": "Ryan-Neal Mes", "link": "https://stackoverflow.com/users/799618/ryan-neal-mes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 32082058, "answer_count": 1, "score": 0, "last_activity_date": 1439929808, "creation_date": 1439928876, "question_id": 32081805, "link": "https://stackoverflow.com/questions/32081805/what-is-my-error-log-telling-me", "title": "What is my error log telling me?", "body": "<p>I am trying to resolve a problem with an 3rd party application I am integrating with. Our API access was IP blocked due to a series of errors being raised because of calls we were making to the 3rd party application. After chatting to them they sent me the error that they were receiving in their logs.</p>\n\n<pre><code>A sample request sent is: [REMOVED_IP] - [REMOVED_API_TOKEN] [18/Aug/2015:12:57:42 +0000] \"PUT /contacts/5016104701.json HTTP/1.1\" 500 38052 \"-\" \"Typhoeus -https://github.com/typhoeus/typhoeus\" \"[REMOVED_IP]\".\n</code></pre>\n\n<p>According to them</p>\n\n<p><em>It looks like the particular IP was hitting the url <a href=\"https://github.com/typhoeus/typhoeus\" rel=\"nofollow\">https://github.com/typhoeus/typhoeus</a> several times. Also, we got multiple Nginx 500 Errors for that domain too.</em></p>\n\n<p>From my understanding the log they sent me is saying that there was an internal server error (500) on their side. I have am guessing that <code>\"Typhoeus -https://github.com/typhoeus/typhoeus\"</code> is a response header. From my research that could be the effective URL being returned in the response. Something to do with redirection, but I could not find much on it.</p>\n\n<p>My questions are:</p>\n\n<p>Is this an error on their side? I am guessing it's an error in their application.\nWhat is the <code>\"Typhoeus -https://github.com/typhoeus/typhoeus\"</code> in the response header?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "json", "haml"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1439928766, "post_id": 32081640, "comment_id": 52059585, "body": "You could do this: <code>json.scan(&#47;\\&quot;display\\&quot;: \\&quot;(\\d+\\.\\d+) centimeter&#47;).flatten.map(&amp;:to_f) #=&gt; [151.13, 170.39] </code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1439929119, "post_id": 32081640, "comment_id": 52059781, "body": "Do you know the structure (i.e., nested keys, etc.) or do you just want to dig through nested hashes and arrays until you find a string that looks like what you want?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1439930614, "post_id": 32081640, "comment_id": 52060586, "body": "I suggest you enclose your JSON string with single quotes so that it is one."}, {"owner": {"reputation": 2437, "user_id": 4058838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/56c7770d8f5d6b9ec7a13e82fbf0a59c?s=128&d=identicon&r=PG", "display_name": "Amit Badheka", "link": "https://stackoverflow.com/users/4058838/amit-badheka"}, "edited": false, "score": 0, "creation_date": 1439961940, "post_id": 32081640, "comment_id": 52069946, "body": "Why are you doing this in haml? Cant you shift this logic in controller and then pass a variable in haml?"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 4946929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/427aaae36bfc5f16343b09d607580eb8?s=128&d=identicon&r=PG&f=1", "display_name": "sp1117", "link": "https://stackoverflow.com/users/4946929/sp1117"}, "edited": false, "score": 0, "creation_date": 1439931424, "post_id": 32082187, "comment_id": 52060981, "body": "Yes, I already have the &quot;item_group&quot; in an object. So I wanna iterate through it and add all the &quot;values&quot; in an array."}, {"owner": {"reputation": 69, "user_id": 4946929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/427aaae36bfc5f16343b09d607580eb8?s=128&d=identicon&r=PG&f=1", "display_name": "sp1117", "link": "https://stackoverflow.com/users/4946929/sp1117"}, "edited": false, "score": 0, "creation_date": 1439957590, "post_id": 32082187, "comment_id": 52068591, "body": "Instead of the three loops, can we say g[&#39;item_group&#39;][&#39;section&#39;][&#39;values&#39;] ?"}, {"owner": {"reputation": 69, "user_id": 4946929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/427aaae36bfc5f16343b09d607580eb8?s=128&d=identicon&r=PG&f=1", "display_name": "sp1117", "link": "https://stackoverflow.com/users/4946929/sp1117"}, "edited": false, "score": 0, "creation_date": 1439959556, "post_id": 32082187, "comment_id": 52069164, "body": "And the problem is I&#39;m using this in Haml"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 69, "user_id": 4946929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/427aaae36bfc5f16343b09d607580eb8?s=128&d=identicon&r=PG&f=1", "display_name": "sp1117", "link": "https://stackoverflow.com/users/4946929/sp1117"}, "edited": false, "score": 0, "creation_date": 1439961614, "post_id": 32082187, "comment_id": 52069820, "body": "You may need only one loop, Please see my edit. As I mentioned, that&#39;s not likely to make the method significantly more efficient, but the reduced looping may be helpful to you."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1440017014, "last_edit_date": 1440017014, "creation_date": 1439930411, "answer_id": 32082187, "question_id": 32081640, "link": "https://stackoverflow.com/questions/32081640/ruby-array-construction/32082187#32082187", "title": "Ruby array construction", "body": "<p>Assuming you know the structure of the underlying hash, you can do this:</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>require 'json'\n\nJSON.parse(json_str)['items'].each_with_object([]) do |g,arr|\n  g['item_group'].each do |gg|\n    gg['section'].each do |ggg|\n      ggg['values'].each { |gggg|arr &lt;&lt; gggg['display'][/\\d+\\.\\d+/].to_f }\n    end\n  end\nend    \n  #=&gt; [151.13, 170.39] \n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The steps are as follows:</p>\n\n<pre><code>a = JSON.parse(json_str)\nb = a['items']\nenum = b.each_with_object([])\n  #=&gt; #&lt;Enumerator: [{\"name\"=&gt;\"table\",...\"total\"=&gt;1}]:each_with_object([])&gt; \n</code></pre>\n\n<p>We can see the elements of the enumerator by converting it to an array:</p>\n\n<pre><code>enum.to_a\n  #=&gt; [[{\"name\"=&gt;\"table\", \"item_group\"=&gt;[{\"code\"=&gt;\"code1\",\n  #        \"section\"=&gt;[{\"unit\"=&gt;\"centimeter\",\n  #        \"values\"=&gt;[{\"display\"=&gt;\"151.13 centimeter\"}]},\n  #        { \"unit\"=&gt;\"centimeter (qualifier value)\",\n  #        \"values\"=&gt;[{\"display\"=&gt;\"170.39 centimeter\"}]}], \"total\"=&gt;2}],\n  #     \"more_results\"=&gt;false,\n  #     \"total\"=&gt;1},\n  #   []]] \n</code></pre>\n\n<p>Notice that this array has a single element, a two-element array containing a hash and an empty array.</p>\n\n<p>The first element of <code>enum</code> is passed to the block and assigned to the block variables using parallel assignment:</p>\n\n<pre><code>g, arr = enum.next\n  #=&gt; {\"name\"=&gt;\"table\",\n  #    \"item_group\"=&gt;[\n  #      {\"code\"=&gt;\"code1\",\n  #      \"section\"=&gt;[\n  #        {\"unit\"=&gt;\"centimeter\",\n  #         \"values\"=&gt;[\n  #           {\"display\"=&gt;\"151.13 centimeter\"}\n  #         ]\n  #        },\n  #      {\"unit\"=&gt;\"centimeter (qualifier value)\",\n  #      \"values\"=&gt;[\n  #        {\"display\"=&gt;\"170.39 centimeter\"}\n  #       ]\n  #      }\n  #     ],\n  #    \"total\"=&gt;2}],\n  #    \"more_results\"=&gt;false,\n  #    \"total\"=&gt;1} \narr #=&gt; [] \n\nc = g['item_group']\n  #=&gt; [{\"code\"=&gt;\"code1\",\n  #     \"section\"=&gt;[\n  #       {\"unit\"=&gt;\"centimeter\",\n  #        \"values\"=&gt;[\n  #          {\"display\"=&gt;\"151.13 centimeter\"}\n  #         ]\n  #       },\n  #       {\"unit\"=&gt;\"centimeter (qualifier value)\",\n  #        \"values\"=&gt;[\n  #          {\"display\"=&gt;\"170.39 centimeter\"}\n  #        ]\n  #       }\n  #   ],\n  #   \"total\"=&gt;2}] \n</code></pre>\n\n<p>Note <code>c</code> has the form <code>[hash]</code>.</p>\n\n<p>The first (and only) element of <code>c</code> is passed to its block and assigned to its block variable:</p>\n\n<pre><code>gg = c.first\nd = gg['section']\n  #=&gt; [{\"unit\"=&gt;\"centimeter\",\n        \"values\"=&gt;[\n         {\"display\"=&gt;\"151.13 centimeter\"}\n        ]\n       },\n       {\"unit\"=&gt;\"centimeter (qualifier value)\",\n        \"values\"=&gt;[\n          {\"display\"=&gt;\"170.39 centimeter\"}\n        ]\n       }\n      ] \n\nggg = d.first\n  #=&gt; {\"unit\"=&gt;\"centimeter\",\n  #    \"values\"=&gt;[\n  #      {\"display\"=&gt;\"151.13 centimeter\"}\n  #    ]\n  #   } \n\ne = ggg['values']\n  #=&gt; [{\"display\"=&gt;\"151.13 centimeter\"}]\n\ngggg = e.first\n  #=&gt; {\"display\"=&gt;\"151.13 centimeter\"} \n\nf = gggg['display']\n  #=&gt; \"151.13 centimeter\" \ng = f[/\\d+\\.\\d+/]\n  #=&gt; \"151.13\" \ni = g.to_f\n  #=&gt; 151.13 \narr &lt;&lt; i\n  #=&gt; [151.13] \narr\n  #=&gt; [151.13] \n</code></pre>\n\n<p>The remaining calculations are similar.</p>\n\n<p><strong>Alternative expression</strong></p>\n\n<p>If, as in the example, the arrays <code>JSON.parse(json_str)['items']</code>, <code>g['item_group']</code> and <code>ggg['values']</code> each contain a single element (a hash), you could instead write:</p>\n\n<pre><code>JSON.parse(json_str)['items'].first['item_group'].first['section'].\n  each_with_object([]) do |g, arr|\n    arr &lt;&lt; g['values'].first['display'][/\\d+\\.\\d+/].to_f\n  end\n  #=&gt; [151.13, 170.39] \n</code></pre>\n\n<p>though I doubt that would be significantly more efficient.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1439962097, "post_id": 32086916, "comment_id": 52070012, "body": "That&#39;s interesting, @Amit. Note that you can write <code>json_content.jq(jq_filter).map(&amp;:to_f) #=&gt; [151.13, 170.39]</code>, since <code>&quot;151.13  my dog has fleas&quot;.to_f #=&gt; 151.13</code>."}], "tags": [], "owner": {"reputation": 2437, "user_id": 4058838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/56c7770d8f5d6b9ec7a13e82fbf0a59c?s=128&d=identicon&r=PG", "display_name": "Amit Badheka", "link": "https://stackoverflow.com/users/4058838/amit-badheka"}, "is_accepted": false, "score": 1, "last_activity_date": 1439960722, "creation_date": 1439960722, "answer_id": 32086916, "question_id": 32081640, "link": "https://stackoverflow.com/questions/32081640/ruby-array-construction/32086916#32086916", "title": "Ruby array construction", "body": "<p>I know there are multiple ways of doing this. But if you really have many  complex JSON queries, you can try <a href=\"https://github.com/winebarrel/ruby-jq\" rel=\"nofollow\">ruby-jq gem</a>. It is very fast, as it uses linux pipes</p>\n\n<pre><code>require 'jq'\nrequire 'jq/extend'\njson_content =         {\n        \"items\": [\n            {\n                \"name\": \"table\",\n                \"item_group\": [\n                {\n                        \"code\": \"code1\",\n                        \"section\": [\n                            {                         \n                                \"unit\": \"centimeter\",\n                                \"values\": [\n                                    {\n                                        \"display\": \"151.13 centimeter\"\n                                    }\n                                ]\n                            },\n                            {                         \n                                \"unit\": \"centimeter (qualifier value)\",\n                                \"values\": [\n                                    {\n                                        \"display\": \"170.39 centimeter\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"total\": 2\n                    }\n                ],\n                \"more_results\": false,\n                \"total\": 1\n            }\n        ]\n    }\n\n\njq_filter = ' .items | .[].item_group |.[].section| . [ ] .values | . [ ] .display'\n\nfinal_array = json_content.jq(jq_filter)\n\n  # =&gt; final_array =  [\"151.13 centimeter\", \"170.39 centimeter\"]\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 4946929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/427aaae36bfc5f16343b09d607580eb8?s=128&d=identicon&r=PG&f=1", "display_name": "sp1117", "link": "https://stackoverflow.com/users/4946929/sp1117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1440017014, "creation_date": 1439928218, "last_edit_date": 1439959631, "question_id": 32081640, "link": "https://stackoverflow.com/questions/32081640/ruby-array-construction", "title": "Ruby array construction", "body": "<p>I have the following json,</p>\n\n<pre><code>{\n    \"items\": [\n        {\n            \"name\": \"table\",\n            \"item_group\": [\n                {\n                    \"code\": \"code1\",\n                    \"section\": [\n                        {                         \n                            \"unit\": \"centimeter\",\n                            \"values\": [\n                                {\n                                    \"display\": \"151.13 centimeter\"\n                                }\n                            ]\n                        },\n                        {                         \n                            \"unit\": \"centimeter (qualifier value)\",\n                            \"values\": [\n                                {\n                                    \"display\": \"170.39 centimeter\"\n                                }\n                            ]\n                        }\n                    ],\n                    \"total\": 2\n                }\n            ],\n            \"more_results\": false,\n            \"total\": 1\n        }\n    ]\n}\n</code></pre>\n\n<p>How do I iterate through this and create an array of \"values\". I want something like  [151.13 centimeter, 170.39 centimeter,....]. Please show some direction in this. thanks.</p>\n\n<p>Note: I have to do this in Haml.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "embedly"], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 564191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8c7c9368a3ca878913d62e5620631c9?s=128&d=identicon&r=PG", "display_name": "screeley", "link": "https://stackoverflow.com/users/564191/screeley"}, "is_accepted": true, "score": 1, "last_activity_date": 1439932069, "creation_date": 1439932069, "answer_id": 32082556, "question_id": 32081617, "link": "https://stackoverflow.com/questions/32081617/embedly-oembed-not-adhering-to-the-maxwidth-parameter/32082556#32082556", "title": "Embedly.oembed not adhering to the maxwidth parameter", "body": "<p><code>maxwidth</code> only applies to the html, images can be of any width. </p>\n\n<p>Embedly does allow you to set an <code>image_width</code> though. Try:</p>\n\n<pre><code>embedly_api.oembed(url: url, maxwidth: 50, type: 'photo', image_width: 50)\n</code></pre>\n\n<p><a href=\"http://embed.ly/docs/api/display/integration\" rel=\"nofollow\">http://embed.ly/docs/api/display/integration</a></p>\n"}], "owner": {"reputation": 7276, "user_id": 1419236, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7b397e63cc2782396ceb5934ed6e0efc?s=128&d=identicon&r=PG&f=1", "display_name": "RobertJoseph", "link": "https://stackoverflow.com/users/1419236/robertjoseph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 32082556, "answer_count": 1, "score": 0, "last_activity_date": 1439932069, "creation_date": 1439928105, "question_id": 32081617, "link": "https://stackoverflow.com/questions/32081617/embedly-oembed-not-adhering-to-the-maxwidth-parameter", "title": "Embedly.oembed not adhering to the maxwidth parameter", "body": "<p>I am trying to use <a href=\"http://embed.ly/docs/api/embed\" rel=\"nofollow\">Embedly</a> to generate a thumbnail for a given url. I need the thumbnail to be smaller than a maximum size, so I call the api like so:</p>\n\n<pre><code>url = \"http://embed.ly\"\nembedly_api = Embedly::API.new(key: ENV['EMBEDLY_KEY'])\nobj = embedly_api.oembed(url: url, maxwidth: 50, type: 'photo').first\n\njson_obj = JSON.pretty_generate(obj.marshal_dump)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>http://api.embed.ly/1/oembed?key=[KEY_VALUE]&amp;url=http://embed.ly&amp;maxwidth=50&amp;type=photo\n</code></pre>\n\n<p>In either case the result is:</p>\n\n<pre><code>{\n  provider_url: \"http://embed.ly\",\n  description: \"Embedly delivers the ultra-fast,...\",\n  title: \"Embedly makes your content more engaging and easier...\",\n  mean_alpha: 32.7480314961,\n  thumbnail_width: 399,\n  url: \"http://embed.ly\",\n  thumbnail_url: \"http://embed.ly/static/images/logos/logo_color.png?v=4b245\",\n  version: \"1.0\",\n  provider_name: \"Embedly\",\n  type: \"link\",\n  thumbnail_height: 127\n}\n</code></pre>\n\n<p>Notice that <code>thumbnail_width</code> is 399 (which is larger than what I passed in for the <code>maxwidth</code> parameter). Am I missing something obvious here?</p>\n"}]