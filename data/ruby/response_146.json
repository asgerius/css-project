[{"tags": ["ruby-on-rails", "ruby", "activerecord", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 1296, "user_id": 8377250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3705bb7e15384ec8a6b41f60d59b3e10?s=128&d=identicon&r=PG&f=1", "display_name": "mindlis", "link": "https://stackoverflow.com/users/8377250/mindlis"}, "is_accepted": true, "score": 3, "last_activity_date": 1508978679, "creation_date": 1508978679, "answer_id": 46944110, "question_id": 46943604, "link": "https://stackoverflow.com/questions/46943604/searching-for-the-active-record-without-the-last/46944110#46944110", "title": "Searching for the active record without the last", "body": "<p>Try setting up the associations as:</p>\n\n<pre><code>GoalSalesman.rb\n  belongs_to :goal\n  belongs_to :salesman\n\nGoal.rb\n  has_many :goal_salesmen\n  has_many :salesmen, through: :goal_salesmen\n\nSalesman.rb\n  has_many :goal_salesmen\n  has_many :goals, through: :goal_salesmen\n</code></pre>\n\n<p>You should then be able to get all the names by calling</p>\n\n<pre><code>Goal.find(1).salesmen.pluck(:name)\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 7838720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/792720319533922301b7f2ec109a7b36?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Policarpo", "link": "https://stackoverflow.com/users/7838720/denis-policarpo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 46944110, "answer_count": 1, "score": 1, "last_activity_date": 1508978679, "creation_date": 1508974519, "last_edit_date": 1508975413, "question_id": 46943604, "link": "https://stackoverflow.com/questions/46943604/searching-for-the-active-record-without-the-last", "title": "Searching for the active record without the last", "body": "<p>How can I get the names of sellers that have a certain goal? Follow the model below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/AILsG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AILsG.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I get the names of sellers that have a certain goal? I have the right database model.</p>\n\n<p>I'm trying like this:</p>\n\n<pre><code>GoalSalesman.where (goal_id: 1).last.salesman.name\n</code></pre>\n\n<p>But so I get only the last name because of <code>last</code>, I wanted all the names.</p>\n\n<p>How can I get all of the names?</p>\n"}, {"tags": ["ruby", "post", "httparty"], "answers": [{"tags": [], "owner": {"reputation": 9584, "user_id": 1420684, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/78242bebaa42db9b1f771e6c19a074fe?s=128&d=identicon&r=PG&f=1", "display_name": "Mirror318", "link": "https://stackoverflow.com/users/1420684/mirror318"}, "is_accepted": false, "score": 0, "last_activity_date": 1508978195, "creation_date": 1508978195, "answer_id": 46944052, "question_id": 46943388, "link": "https://stackoverflow.com/questions/46943388/ruby-httparty-how-to-send-a-post-request-with-data-binary/46944052#46944052", "title": "Ruby + HTTParty\u2014how to send a POST request with data-binary?", "body": "<p>I eventually got it to work with <code>curb</code>. The main problem was that <code>curl</code>'s <code>$'my_string\\n'</code> type of string turns <code>\\r\\n</code> characters into new lines, whereas in ruby I was trying <code>'my_string\\n'</code> which was automatically parsed to <code>my_string\\\\n</code>. By changing to use double quotes I fixed that problem.</p>\n\n<p>Final working code is:</p>\n\n<pre><code>curl = Curl::Easy.new('https://externalsite.com/ForgotPasswordSubmit.action')\ncurl.headers[\"Content-Type\"] = \"multipart/form-data; boundary=----qwertyuiop\"\ndata = \"------qwertyuiop\\r\\nContent-Disposition: form-data; name=\\\"xsrf_token\\\"\\r\\n\\r\\nnull\\r\\n------qwertyuiop\\r\\nContent-Disposition: form-data; name=\\\"emailAddr\\\"\\r\\n\\r\\n#{email}\\r\\n------qwertyuiop--\\r\\n\"\ncurl.post_body=data\ncurl.http_post\n</code></pre>\n"}], "owner": {"reputation": 9584, "user_id": 1420684, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/78242bebaa42db9b1f771e6c19a074fe?s=128&d=identicon&r=PG&f=1", "display_name": "Mirror318", "link": "https://stackoverflow.com/users/1420684/mirror318"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508978195, "creation_date": 1508972989, "question_id": 46943388, "link": "https://stackoverflow.com/questions/46943388/ruby-httparty-how-to-send-a-post-request-with-data-binary", "title": "Ruby + HTTParty\u2014how to send a POST request with data-binary?", "body": "<p>I have the following <code>curl</code> that works:</p>\n\n<pre><code>curl 'https://externalsite.com/ForgotPasswordSubmit.action' \\\n-X POST \\\n-H 'Content-Type: multipart/form-data; boundary=----qwertyuiop' \\\n--data-binary $'------qwertyuiop\\r\\nContent-Disposition: form-data; name=\"xsrf_token\"\\r\\n\\r\\nnull\\r\\n------qwertyuiop\\r\\nContent-Disposition: form-data; name=\"emailAddr\"\\r\\n\\r\\nmy_email_address@gmail.com\\r\\n------qwertyuiop--\\r\\n'\n</code></pre>\n\n<p>I'm trying to get a Ruby + Sinatra app to do the same thing, but it's not working. Here's my latest attempt:</p>\n\n<pre><code>HTTParty.post \"https://externalsite.com/ForgotPasswordSubmit.action\", :headers =&gt; {\"Content-Type\"=&gt;\"multipart/form-data; boundary=----qwertyuiop\"}, :body =&gt; '------qwertyuiop\\r\\nContent-Disposition: form-data; name=\"xsrf_token\"\\r\\n\\r\\nnull\\r\\n------qwertyuiop\\r\\nContent-Disposition: form-data; name=\"emailAddr\"\\r\\n\\r\\nmy_email@gmail.com\\r\\n------qwertyuiop--\\r\\n'\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "sorting", "hash", "radix-sort"], "answers": [{"tags": [], "owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "is_accepted": false, "score": 2, "last_activity_date": 1508978084, "creation_date": 1508978084, "answer_id": 46944039, "question_id": 46943071, "link": "https://stackoverflow.com/questions/46943071/pushing-a-value-into-an-array-within-a-hash/46944039#46944039", "title": "pushing a value into an array within a hash", "body": "<blockquote>\n  <p>buckets[sdigit].push(num) is the line that tells me one of my values\n  is nil.</p>\n</blockquote>\n\n<p>If you look at the error message :</p>\n\n<pre><code>top.rb:30:in `block (2 levels) in &lt;main&gt;': undefined method `push' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p>and your code :</p>\n\n<p><a href=\"https://i.stack.imgur.com/rfJrW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rfJrW.png\" alt=\"enter image description here\"></a></p>\n\n<p>you see that line 30 is the <code>puts</code>, not <code>buckets[sdigit].push(num)</code>.</p>\n\n<p>Cause : there is a discrepancy between the values displayed by the <code>puts</code> and those used by the expression : <code>[digit]</code> instead of <code>[sdigit]</code>, and that's the trace which causes the error.</p>\n\n<p>Personally I write the <code>puts</code> traces before the statement to trace, because it shows the values that will be used by the expression before the statement which could cause the error is executed. It usually helps ... except when the trace itself is in error. </p>\n\n<p>I have slightly rearranged your code :</p>\n\n<pre><code>arr = []\n\n100.times { arr &lt;&lt; rand(1000) }\nputs arr.join(', ')\n\narr.each do | outer_index |\n  puts \"===== for outer_index=#{outer_index} in arr\"\n  buckets = Hash.new()\n  puts \"buckets = Hash.new()\"\n\n  puts \"for j in 0..9\"\n  (0..9).each do | j |\n    buckets[j.to_s] = Array.new()\n    #buckets[j.to_s] = [j]\n    puts \"buckets[#{j.to_s}]=#{buckets[j.to_s]}\"\n  end\n\n  arr.each do | inner_index |\n    puts \"----- for inner_index=#{inner_index} in arr\"\n    num = inner_index\n    puts \"num(#{num}) = inner_index(#{inner_index})\"\n\n    sdigit = num.to_s[-1]\n    puts \"sdigit(#{sdigit}) = num.to_s[-1](#{num.to_s[-1]})\"\n    digit = sdigit.to_i\n    puts \"digit(#{digit}) = sdigit.to_i(#{sdigit.to_i})\"\n    puts \"buckets[digit] = #{buckets[sdigit]}\"\n    puts \"#{buckets[\"1\"]}\"\n    puts \"o#{num}\"\n    puts buckets\n\n    puts \"buckets[sdigit].push(num)=buckets[#{sdigit}].push(#{num})\"\n    buckets[sdigit].push(num)\n#    puts \"buckets[digit].push(num)(#{buckets[digit].push(num)})\"\n  end\n\n  arr = buckets.values.flatten\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8242910, "user_type": "registered", "profile_image": "https://graph.facebook.com/1601882509822359/picture?type=large", "display_name": "Marty Carr", "link": "https://stackoverflow.com/users/8242910/marty-carr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508978084, "creation_date": 1508970998, "question_id": 46943071, "link": "https://stackoverflow.com/questions/46943071/pushing-a-value-into-an-array-within-a-hash", "title": "pushing a value into an array within a hash", "body": "<p>Ive been working at this code for a radix sort for awhile now. Everything has seemed to be coming together fine until i try to push a value into an array within a hash.\nIm getting an error message that the value is nil, however ive checked all the values in question just prior to trying to store them in the array and its still not allowing me to do so. Any ideas? buckets[sdigit].push(num) is the line that tells me one of my values is nil.</p>\n\n<pre><code>    arr = []\nwhile arr.size &lt; 100\n  arr.push(rand(1000))\nend\nfor outer_index in arr\n  puts \"for outer index(#{outer_index} in arr\"\n  buckets = Hash.new()\n  puts \"buckets = Hash.new()\"\n  puts \"for j in 0..9\"\n  for j in 0..9\n    buckets[j.to_s] = Array.new()\n    #buckets[j.to_s] = [j]\n    puts \"buckets[j.to_s(#{buckets[j.to_s]})\"\n  end\n\nfor inner_index in arr\n  puts \"for inner_index(#{inner_index}) in arr\"\n  num = inner_index\n  puts \"num(#{num}) = inner_index(#{inner_index})\"\n\n  sdigit = num.to_s[-1]\n  puts \"sdigit(#{sdigit}) = num.to_s[-1](#{num.to_s[-1]})\"\n  digit = sdigit.to_i\n  puts \"digit(#{digit}) = sdigit.to_i(#{sdigit.to_i})\"\n  puts \"buckets[digit] = #{buckets[sdigit]}\"\n  puts \"#{buckets[\"1\"]}\"\n  puts \"o#{num}\"\n  puts buckets\n buckets[sdigit].push(num)\n  puts \"buckets[digit].push(num)(#{buckets[digit].push(num)})\"\n\nend\n  arr = buckets.values.flatten\n\nend `\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 4568, "user_id": 8712097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hevmE.jpg?s=128&g=1", "display_name": "Tom Aranda", "link": "https://stackoverflow.com/users/8712097/tom-aranda"}, "edited": false, "score": 0, "creation_date": 1508975785, "post_id": 46942608, "comment_id": 80834979, "body": "Don&#39;t be afraid to up vote answers you find useful.  It helps the community find good answers."}], "answers": [{"tags": [], "owner": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "is_accepted": false, "score": 0, "last_activity_date": 1508969306, "creation_date": 1508969306, "answer_id": 46942813, "question_id": 46942608, "link": "https://stackoverflow.com/questions/46942608/comparing-instances-to-get-differences-and-attribute-names/46942813#46942813", "title": "Comparing instances to get differences and attribute names", "body": "<p>How about something like this:</p>\n\n<pre><code>class Animal\n  def initialize(a, b, c)\n    @aa=a\n    @bb=b\n    @cc=c\n  end\n\n  def inst_vars obj\n     obj.instance_variables.map do |att|\n       [ att, instance_variable_get(att), obj.instance_variable_get(att) ]\n     end.select do |att, one, two|\n       one != two\n     end\n  end\nend\n</code></pre>\n\n<p>I've attempted to re-use as much of the given logic as I could.</p>\n\n<p>note: This does return an array of arrays. eg:</p>\n\n<pre><code>2.4.1 :046 &gt; animal_original = Animal.new(1,2,3)\n =&gt; #&lt;Animal:0x007ffdf718da10 @aa=1, @bb=2, @cc=3&gt;\n2.4.1 :047 &gt; animal_to_compare = Animal.new(11,2,3)\n =&gt; #&lt;Animal:0x007ffdf7119980 @aa=11, @bb=2, @cc=3&gt;\n2.4.1 :048 &gt; animal_original.inst_vars animal_to_compare\n =&gt; [[:@aa, 1, 11]]\n</code></pre>\n\n<p>Or with multiple differences:</p>\n\n<pre><code>2.4.1 :049 &gt; animal1 = Animal.new(1,2,3)\n =&gt; #&lt;Animal:0x007ffdf717ed80 @aa=1, @bb=2, @cc=3&gt;\n2.4.1 :050 &gt; animal2 = Animal.new(1,3,4)\n =&gt; #&lt;Animal:0x007ffdf715c7d0 @aa=1, @bb=3, @cc=4&gt;\n2.4.1 :051 &gt; animal1.inst_vars animal2\n =&gt; [[:@bb, 2, 3], [:@cc, 3, 4]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4568, "user_id": 8712097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hevmE.jpg?s=128&g=1", "display_name": "Tom Aranda", "link": "https://stackoverflow.com/users/8712097/tom-aranda"}, "is_accepted": true, "score": 0, "last_activity_date": 1508969605, "creation_date": 1508969605, "answer_id": 46942870, "question_id": 46942608, "link": "https://stackoverflow.com/questions/46942608/comparing-instances-to-get-differences-and-attribute-names/46942870#46942870", "title": "Comparing instances to get differences and attribute names", "body": "<p>Try using this method:</p>\n\n<pre><code>def compare_animals(obj1, obj2)\n  out = []\n  obj1.instance_variables.map do |var|                                                                                            \n    if obj1.instance_variable_get(var) != obj2.instance_variable_get(var)  \n      out &lt;&lt; var.to_s.slice(/[^@]./)\n      out &lt;&lt; obj1.instance_variable_get(var)\n      out &lt;&lt; obj2.instance_variable_get(var)\n    end\n  end\n  out\nend\n</code></pre>\n\n<p>You can call it with this:</p>\n\n<pre><code>compare_animals animal_original, animal_to_compare\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6521061"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 46942870, "answer_count": 2, "score": 0, "last_activity_date": 1508987657, "creation_date": 1508968216, "last_edit_date": 1508987657, "question_id": 46942608, "link": "https://stackoverflow.com/questions/46942608/comparing-instances-to-get-differences-and-attribute-names", "title": "Comparing instances to get differences and attribute names", "body": "<p>I have a class animal</p>\n\n<pre><code>class Animal\n    def initialize( a, b, c)\n        @aa=a\n        @bb=b\n        @cc=c\n    end\nend\n</code></pre>\n\n<p>I'm trying to compare these instances:</p>\n\n<pre><code>animal_original = Animal.new(1,2,3)\nanimal_to_compare = Animal.new(11,2,3)\n</code></pre>\n\n<p>I need a method to compare these two instances and get the differences in terms of the name of the variable and the values.</p>\n\n<p>In this case, I will need an array containing <code>aa</code> (it's the name of the variable), the value of the first object, and the value of the second to be like this:</p>\n\n<pre><code>[\"aa\", \"1\", \"11\"] #returned value\n</code></pre>\n\n<p>I tried to do it getting all the instance variables of the object, and converting them to a map to make the compare more easily with this function:</p>\n\n<pre><code>  def inst_vars obj\n     obj.instance_variables.map do |att|\n       { att =&gt; obj.instance_variable_get(att) }\n     end\n  end\n</code></pre>\n\n<p>But I cannot accomplish this. How can I do it to make the comparison and get all the values that I need?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "bamboo"], "answers": [{"tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 0, "last_activity_date": 1509120659, "creation_date": 1509120659, "answer_id": 46979347, "question_id": 46942535, "link": "https://stackoverflow.com/questions/46942535/why-my-datetime-format-changed-on-bamboo-build/46979347#46979347", "title": "Why my DateTime format changed on Bamboo build", "body": "<p>The problem isn't your format. The problem is that the array elements are not in the same order. The dates in your <code>expect</code> array begin with the 2017-12-31 dates, while those in your <code>match</code> array begin with the 2017-03-26 dates.</p>\n\n<p>RSpec's <code>eq</code> method returns true only if each element of the first array is identical to the element at the same index of the second array. But the <code>match_array</code> method returns true so long as the two arrays have the same elements, regardless of order. </p>\n\n<p>Change your expectation line to:</p>\n\n<pre><code>expect(ranges).to match_array(my_array)\n</code></pre>\n\n<p>And you should be good to go.</p>\n"}], "owner": {"reputation": 3133, "user_id": 1883793, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/33ed6dd2dcb89dab186d5b9dfe8ae9b2?s=128&d=identicon&r=PG", "display_name": "user1883793", "link": "https://stackoverflow.com/users/1883793/user1883793"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509120659, "creation_date": 1508967893, "last_edit_date": 1509013143, "question_id": 46942535, "link": "https://stackoverflow.com/questions/46942535/why-my-datetime-format-changed-on-bamboo-build", "title": "Why my DateTime format changed on Bamboo build", "body": "<p>I have a <code>User</code> class that <code>has_many</code> <code>Jobs</code>. I map jobs with the following code, the start_at and end_at are datetime:</p>\n\n<pre><code>def ranges\n  user.jobs.map { |u| [u.start_at, u.end_at] }\nend\n</code></pre>\n\n<p>I have a spec that compares two arrays:</p>\n\n<pre><code>my_array = [[start1, end1], [start2, end2]]\nexpect(ranges).to eq my_array\n</code></pre>\n\n<p>The test data are also datetime created from factory girl e.g. </p>\n\n<pre><code>create(:jobs, start_at:DateTime.parse('2017-03-26 00:00:00'), end_at: DateTime.parse('2017-03-27 00:00:00'))\n</code></pre>\n\n<p>Everything works fine, expect when Bamboo runs my spec, I get following error:</p>\n\n<pre><code>expect \n[[2017-12-31 00:00:00.000000000 +0000, 2017-12-31 10:10:00.000000000 +0000], [2017-12-30 00:00:00.000000000 +0000, 2017-12-31 00:10:00.000000000 +0000], [2017-11-26 00:00:00.000000000 +0000, 2017-11-26 10:10:00.000000000 +0000], [2017-03-24 00:00:00.000000000 +0000, 2017-03-24 10:10:00.000000000 +0000], [2017-03-25 00:00:00.000000000 +0000, 2017-03-25 10:10:00.000000000 +0000], [2017-03-26 00:00:00.000000000 +0000, 2017-03-26 10:10:00.000000000 +0000]] \n</code></pre>\n\n<p>to match</p>\n\n<pre><code>[[Sun, 26 Mar 2017 00:00:00 UTC +00:00, Sun, 26 Mar 2017 10:10:00 UTC +00:00], [Sat, 25 Mar 2017 00:00:00 UTC +00:00, Sat, 25 Mar 2017 10:10:00 UTC +00:00], [Fri, 24 Mar 2017 00:00:00 UTC +00:00, Fri, 24 Mar 2017 10:10:00 UTC +00:00], [Sun, 26 Nov 2017 00:00:00 UTC +00:00, Sun, 26 Nov 2017 10:10:00 UTC +00:00], [Sat, 30 Dec 2017 00:00:00 UTC +00:00, Sun, 31 Dec 2017 00:10:00 UTC +00:00], [Sun, 31 Dec 2017 00:00:00 UTC +00:00, Sun, 31 Dec 2017 10:10:00 UTC +00:00]]\n</code></pre>\n\n<p>dose this mean I need to format all my datetime object by<code>iso8601</code> all the time? what could cause this on <code>Bamboo</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "model"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1508967294, "post_id": 46942395, "comment_id": 80832249, "body": "You need to add to your question (by editing your question, not by posting to comments) the output in your console. I believe you will find that you do not have <code>group_event</code> in your parameters. Also, if you&#39;re going to be doing Rails for a while, it wouldn&#39;t hurt to follow naming conventions (especially since that was your challenge on your last question)."}, {"owner": {"reputation": 2914, "user_id": 777880, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/gDijM.jpg?s=128&g=1", "display_name": "Ziyan Junaideen", "link": "https://stackoverflow.com/users/777880/ziyan-junaideen"}, "edited": false, "score": 0, "creation_date": 1508989715, "post_id": 46942395, "comment_id": 80838244, "body": "How are you making it post to the <code>publishnew</code> action? JS?"}], "answers": [{"tags": [], "owner": {"reputation": 2914, "user_id": 777880, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/gDijM.jpg?s=128&g=1", "display_name": "Ziyan Junaideen", "link": "https://stackoverflow.com/users/777880/ziyan-junaideen"}, "is_accepted": true, "score": 1, "last_activity_date": 1508989732, "creation_date": 1508989732, "answer_id": 46945564, "question_id": 46942395, "link": "https://stackoverflow.com/questions/46942395/ruby-on-rails-save-data-into-model-in-two-ways/46945564#46945564", "title": "Ruby on Rails Save Data into model in two ways", "body": "<p>I suggest a different approach to get the same behavior.</p>\n\n<p>If I understand correct, you want to have form submission that will behave differently.</p>\n\n<p>How about add two buttons...</p>\n\n<pre><code>f.submit :publish\nf.submit :draft\n</code></pre>\n\n<p>This will have some thing like</p>\n\n<pre><code>&lt;input type=\"submit\" value=\"publish\" id=\"..\" name=\"commit\" /&gt;\n&lt;input type=\"submit\" value=\"draft\" id=\"..\" name=\"commit\" /&gt;\n</code></pre>\n\n<p>Then in the controller action you can do some thing like</p>\n\n<pre><code>class GroupsEventsController &lt; ApplicationController\n  def create\n    if params[:commit] == 'publish'\n      publish_event\n    else\n      draft_event\n    end\n  end\n\n  private\n\n  def publish_event\n    // Appropriate code here\n  end\n\n  def draft_event\n    // Appropriate code here\n  end\nend\n</code></pre>\n\n<p>That way you don't need to do JS foo doo in the client side to get it to post to different routes.</p>\n"}], "owner": {"reputation": 844, "user_id": 6085236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0062b2fe329a0a1d4164b47b950394e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6085236/jin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 1, "accepted_answer_id": 46945564, "answer_count": 1, "score": -1, "last_activity_date": 1508989732, "creation_date": 1508967146, "last_edit_date": 1508985856, "question_id": 46942395, "link": "https://stackoverflow.com/questions/46942395/ruby-on-rails-save-data-into-model-in-two-ways", "title": "Ruby on Rails Save Data into model in two ways", "body": "<p>I want to duplicate wordpress post functionality. </p>\n\n<p>For example you can create new post and save in two ways - \"Publish Post\" and \"Make Draft\"</p>\n\n<p>Using Rails resources routes I created <code>create</code> method and <code>new</code> method.</p>\n\n<p>Also I created custom methods to save in publish mode and draft mode.</p>\n\n<pre><code>class GroupEventsController &lt; ApplicationController\ndef new\n  @ge = GroupEvent.new\nend\n\ndef publishnew\n  @ge = GroupEvent.new(groupevent_params)\n  @ge.save\n  redirect_to @ge\nend\ndef create\n  @ge = GroupEvent.new(groupevent_params)\n  @ge.save\n  redirect_to @ge\nend\n\nprivate\ndef groupevent_params   \n  abort params.inspect          \n  params.require(:group_event).permit(:name, :description, :startdate, :duration, :status)\nend\n</code></pre>\n\n<p>It works perfect when submit form but when you go to publishnew method it is not working. \nIt shows such error. <em>param is missing or the value is empty: group_event</em></p>\n\n<p>How can I fix it?</p>\n"}, {"tags": ["ruby", "rubygems", "rvm"], "answers": [{"tags": [], "owner": {"reputation": 666, "user_id": 3518947, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e113ffc49039a4e71fe98fe536789341?s=128&d=identicon&r=PG", "display_name": "Michael Heuberger", "link": "https://stackoverflow.com/users/3518947/michael-heuberger"}, "is_accepted": false, "score": 1, "last_activity_date": 1508967182, "creation_date": 1508967182, "answer_id": 46942399, "question_id": 46942064, "link": "https://stackoverflow.com/questions/46942064/could-not-find-a-valid-gem-in-usr-local-bin/46942399#46942399", "title": "Could not find a valid gem in `/usr/local/bin`", "body": "<p>Meh, silly me, <code>gem: \"/usr/local/bin\"</code> was a bad entry. removing that helped :)</p>\n"}], "owner": {"reputation": 666, "user_id": 3518947, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e113ffc49039a4e71fe98fe536789341?s=128&d=identicon&r=PG", "display_name": "Michael Heuberger", "link": "https://stackoverflow.com/users/3518947/michael-heuberger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508967182, "creation_date": 1508965582, "last_edit_date": 1508965932, "question_id": 46942064, "link": "https://stackoverflow.com/questions/46942064/could-not-find-a-valid-gem-in-usr-local-bin", "title": "Could not find a valid gem in `/usr/local/bin`", "body": "<p>When running this command for example</p>\n\n<pre><code>$ gem install af --no-rdoc --no-ri\n</code></pre>\n\n<p>This error is printed:</p>\n\n<pre><code>ERROR:  Could not find a valid gem '/usr/local/bin' (&gt;= 0) in any repository\n</code></pre>\n\n<p>Already researched and no link/post/comment was really helpful here. Here some facts:</p>\n\n<pre><code>$ gem --version\n2.6.14\n\n$ rvm list\n=* ruby-2.4.2 [ x86_64 ]\n\n$ gem list\n*** LOCAL GEMS ***\n(empty)\n</code></pre>\n\n<p>Also when I try to get gem environment vars like that I get this error</p>\n\n<pre><code>$ gem env\nERROR:  While executing gem ... (Gem::CommandLineError)\n    Unknown environment option [/usr/local/bin]\n</code></pre>\n\n<p>Contents of .gemrc is</p>\n\n<pre><code>$ cat .gemrc\n---\n:backtrace: false\n:bulk_threshold: 1000\n:sources:\n- https://rubygems.org/\n:update_sources: true\n:verbose: true\ngem: \"/usr/local/bin\"\n</code></pre>\n\n<p>Any ideas what this can be? Really weird ...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": false, "score": 0, "last_activity_date": 1508964123, "creation_date": 1508964123, "answer_id": 46941704, "question_id": 46941354, "link": "https://stackoverflow.com/questions/46941354/rspec-multiple-controllers-with-one-common-authentication/46941704#46941704", "title": "Rspec multiple controllers with one common authentication", "body": "<p>You can use <code>before(:suite)</code> or <code>before(:all)</code> to prevent multiple calls to this method, e.g.</p>\n\n<pre><code>before(:suite) do\n  authenticate_user(user, role)\nend \n</code></pre>\n\n<p>Also you can locate it at <code>spec/support/sign_in_helper.rb</code>, like:</p>\n\n<pre><code>module SignInHelper\n  def sign_in\n    before(:suite) do\n      authenticate_user(user, role)\n    end \n  end\nend\n</code></pre>\n\n<p>and use it at <code>spec_helper</code>, like:</p>\n\n<pre><code>require 'spec/support/sign_in_helper'\nextend SignInHelper\n</code></pre>\n\n<p>After that you'll be able to use it like macros in your controller specs at top-level.</p>\n"}], "owner": {"reputation": 1, "user_id": 2904720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/033e06b13cd744c2eccd2ffc3ff451d6?s=128&d=identicon&r=PG&f=1", "display_name": "user2904720", "link": "https://stackoverflow.com/users/2904720/user2904720"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508964123, "creation_date": 1508962702, "question_id": 46941354, "link": "https://stackoverflow.com/questions/46941354/rspec-multiple-controllers-with-one-common-authentication", "title": "Rspec multiple controllers with one common authentication", "body": "<p>Hello guys i have a lot of controller test for an API in different files inside spec/controller folder. For each of those specs i have a  </p>\n\n<pre><code>before do\n  authenticate_user(user, role)\nend \n</code></pre>\n\n<p>This is spec\u00b4s time consuming because i have to create a User and a Role for every test. I would like to have this same helper at an upper level in order to execute all my controllers test under the same authentication.  </p>\n\n<p>does anyone has an idea of who to achieve this?</p>\n\n<p>Stubing this is also a choice but there is a lot of logic under the user that may be difficult and time consuming.  </p>\n\n<p>thanks</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1508965956, "post_id": 46941097, "comment_id": 80831643, "body": "<code>day.count { |k,v| v }.fdiv day.size</code>"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1508973156, "post_id": 46941097, "comment_id": 80834278, "body": "<code>day.reduce(0) { |m, (k,v)|  v ? m.next : m }.fdiv day.size</code>"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508961800, "post_id": 46941135, "comment_id": 80829526, "body": "This is half the answer as the question does ask for the percentage."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508961872, "post_id": 46941135, "comment_id": 80829563, "body": "Sure? I don&#39;t know, the title is different, he talks just about the counting part"}, {"owner": {"reputation": 1846, "user_id": 2816949, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LPiwD.jpg?s=128&g=1", "display_name": "theartofbeing", "link": "https://stackoverflow.com/users/2816949/theartofbeing"}, "edited": false, "score": 0, "creation_date": 1508962035, "post_id": 46941135, "comment_id": 80829647, "body": "Thanks, I never thought of use <code>itself</code> in that way. Such ruby."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1508961979, "last_edit_date": 1508961979, "creation_date": 1508961718, "answer_id": 46941135, "question_id": 46941097, "link": "https://stackoverflow.com/questions/46941097/count-keys-inside-of-hash-that-have-specific-value/46941135#46941135", "title": "Count keys inside of hash that have specific value", "body": "<p>If you know there are only true/false values in there</p>\n\n<pre><code>day.values.count(&amp;:itself)\n</code></pre>\n\n<p>otherwise</p>\n\n<pre><code>day.values.count { |item| item == true }\n</code></pre>\n\n<p>usage:</p>\n\n<pre><code>sum = day.count.to_f\nadherence_percent = day.values.count(&amp;:itself) / sum * 100\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1846, "user_id": 2816949, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LPiwD.jpg?s=128&g=1", "display_name": "theartofbeing", "link": "https://stackoverflow.com/users/2816949/theartofbeing"}, "edited": false, "score": 0, "creation_date": 1508964900, "post_id": 46941321, "comment_id": 80831076, "body": "that&#39;s really clean. I didn&#39;t realize you could pass <code>count</code> a block. Trying to figure out what <code>.last</code> is being called on. How is this working"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508970994, "post_id": 46941321, "comment_id": 80833595, "body": "When calling Enumerable methods on hashes you get <code>[key,value]</code> as an argument if your block has an arity of 1, that is it accepts only one argument. If you specify two you get <code>key,value</code>. <code>last</code> here calls the second element in the key/value pair array, or <code>value</code>."}, {"owner": {"reputation": 1846, "user_id": 2816949, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LPiwD.jpg?s=128&g=1", "display_name": "theartofbeing", "link": "https://stackoverflow.com/users/2816949/theartofbeing"}, "edited": false, "score": 0, "creation_date": 1508984416, "post_id": 46941321, "comment_id": 80837005, "body": "and by default is it only counting values that are <code>true</code>?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1509004757, "post_id": 46941321, "comment_id": 80844678, "body": "All the truthy values. Values that are not nil nor false."}], "tags": [], "owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "is_accepted": true, "score": 2, "last_activity_date": 1509028476, "last_edit_date": 1509028476, "creation_date": 1508962524, "answer_id": 46941321, "question_id": 46941097, "link": "https://stackoverflow.com/questions/46941097/count-keys-inside-of-hash-that-have-specific-value/46941321#46941321", "title": "Count keys inside of hash that have specific value", "body": "<p>You can do this using <code>count</code> and <code>last</code></p>\n\n<pre><code>day.count(&amp;:last).fdiv(day.size)\n</code></pre>\n\n<h3><a href=\"https://repl.it/NOXS/1\" rel=\"nofollow noreferrer\">Demonstration</a></h3>\n"}], "owner": {"reputation": 1846, "user_id": 2816949, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LPiwD.jpg?s=128&g=1", "display_name": "theartofbeing", "link": "https://stackoverflow.com/users/2816949/theartofbeing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1060, "favorite_count": 0, "accepted_answer_id": 46941321, "answer_count": 2, "score": 0, "last_activity_date": 1509028476, "creation_date": 1508961566, "question_id": 46941097, "link": "https://stackoverflow.com/questions/46941097/count-keys-inside-of-hash-that-have-specific-value", "title": "Count keys inside of hash that have specific value", "body": "<p>I have a Hash that looks like:</p>\n\n<pre><code>day = {\n  :morning =&gt; true,\n  :afternoon =&gt; false,\n  :evening =&gt; true,\n  :night =&gt; true\n}\n</code></pre>\n\n<p>I'd like to get the percent of values that == <code>true</code></p>\n\n<p>I'm current doing</p>\n\n<pre><code>sum = day.count.to_f\nadherence_percent = (day.select{|k, v| v == true }.count / sum) * 100\n:&gt; 66.6666666\n</code></pre>\n\n<p>Is there a more elegant/efficient way I can do this?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "comments": [{"owner": {"reputation": 2256, "user_id": 2241124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc5006fe57f3543b66290035bb9ef0c7?s=128&d=identicon&r=PG", "display_name": "seancdavis", "link": "https://stackoverflow.com/users/2241124/seancdavis"}, "edited": false, "score": 0, "creation_date": 1508960792, "post_id": 46940747, "comment_id": 80828990, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13005393/ruby-find-the-keys-of-the-largest-values-of-a-hash\">Ruby - find the key(s) of the largest value(s) of a hash</a>"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1508966617, "post_id": 46940747, "comment_id": 80831945, "body": "Use <code>inject</code> to build an array of max values."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 2256, "user_id": 2241124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc5006fe57f3543b66290035bb9ef0c7?s=128&d=identicon&r=PG", "display_name": "seancdavis", "link": "https://stackoverflow.com/users/2241124/seancdavis"}, "edited": false, "score": 0, "creation_date": 1508967358, "post_id": 46940747, "comment_id": 80832274, "body": "@seancdavis if you think a question is duplicate, flag it."}], "answers": [{"tags": [], "owner": {"reputation": 5819, "user_id": 4385889, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/V0hjo.png?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4385889/andrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1508960565, "creation_date": 1508960565, "answer_id": 46940849, "question_id": 46940747, "link": "https://stackoverflow.com/questions/46940747/how-to-find-the-max-value-in-an-array-of-hashes/46940849#46940849", "title": "How to find the max value in an array of hashes?", "body": "<p>You can always just take that max value and <code>select</code>.</p>\n\n<pre><code>arr = [{:question_type=&gt;\"Fire\", :total=&gt;0.0}, {:question_type=&gt;\"Water\", :total=&gt;0.0}, {:question_type=&gt;\"Metal\", :total=&gt;0.0}, {:question_type=&gt;\"Earth\", :total=&gt;50.0}, {:question_type=&gt;\"Wood\", :total=&gt;50.0}]\n\nmax = arr.max_by{|x| x[:total]}\nmax_values = arr.select{|hash| hash[:total] == max[:total]}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4568, "user_id": 8712097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hevmE.jpg?s=128&g=1", "display_name": "Tom Aranda", "link": "https://stackoverflow.com/users/8712097/tom-aranda"}, "is_accepted": false, "score": 1, "last_activity_date": 1508960592, "creation_date": 1508960592, "answer_id": 46940859, "question_id": 46940747, "link": "https://stackoverflow.com/questions/46940747/how-to-find-the-max-value-in-an-array-of-hashes/46940859#46940859", "title": "How to find the max value in an array of hashes?", "body": "<p>You could do this in tow steps this way:</p>\n\n<pre><code>max = arr.max_by{|x| x[:total]}\nmax = arr.select{ |x| x[:total] == max[:total }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "is_accepted": true, "score": 5, "last_activity_date": 1508961152, "last_edit_date": 1508961152, "creation_date": 1508960827, "answer_id": 46940923, "question_id": 46940747, "link": "https://stackoverflow.com/questions/46940747/how-to-find-the-max-value-in-an-array-of-hashes/46940923#46940923", "title": "How to find the max value in an array of hashes?", "body": "<p>You can do this with <code>group_by</code> and <code>max</code>:</p>\n\n<pre><code>arr.group_by { |x| x[:total] }.max.last\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1508966929, "post_id": 46940995, "comment_id": 80832075, "body": "You could refactor this code with <code>each_with_object</code> or maybe use <code>reduce</code> instead."}], "tags": [], "owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "is_accepted": false, "score": 0, "last_activity_date": 1508962288, "last_edit_date": 1508962288, "creation_date": 1508961145, "answer_id": 46940995, "question_id": 46940747, "link": "https://stackoverflow.com/questions/46940747/how-to-find-the-max-value-in-an-array-of-hashes/46940995#46940995", "title": "How to find the max value in an array of hashes?", "body": "<p>An alternative approach to some solid answers already posted here is to roll your own method to retrieve the max values, including multiples if there are ties:</p>\n\n<pre><code>def get_max(arr)\n  result = []\n  current_max = 0.0\n  arr.each do |hash|\n    if hash[:total] &gt; current_max\n      result = [hash[:question_type]]\n      current_max = hash[:total]\n    elsif hash[:total] == current_max\n      result.push(hash[:question_type])\n    end\n  end\n  result\nend\n\n\narr = [{:question_type=&gt;\"Fire\", :total=&gt;0.0}, {:question_type=&gt;\"Water\", :total=&gt;0.0}, {:question_type=&gt;\"Metal\", :total=&gt;0.0}, {:question_type=&gt;\"Earth\", :total=&gt;50.0}, {:question_type=&gt;\"Wood\", :total=&gt;50.0}]\nputs get_max(arr)\n# =&gt; [\"Earth\", \"Wood\"]\n</code></pre>\n\n<p>It may not be as succinct as using something like <code>#max_by</code> and <code>#select</code>, but the benefit of the above approach is you only iterate through the array once.</p>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 309, "user_id": 950781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/iDxO7.jpg?s=128&g=1", "display_name": "Marrento", "link": "https://stackoverflow.com/users/950781/marrento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1089, "favorite_count": 1, "accepted_answer_id": 46940923, "answer_count": 4, "score": 1, "last_activity_date": 1509006000, "creation_date": 1508960124, "last_edit_date": 1509006000, "question_id": 46940747, "link": "https://stackoverflow.com/questions/46940747/how-to-find-the-max-value-in-an-array-of-hashes", "title": "How to find the max value in an array of hashes?", "body": "<p>Given this array of hashes here:</p>\n\n<pre><code>arr = [{:question_type=&gt;\"Fire\", :total=&gt;0.0}, {:question_type=&gt;\"Water\", :total=&gt;0.0}, {:question_type=&gt;\"Metal\", :total=&gt;0.0}, {:question_type=&gt;\"Earth\", :total=&gt;0.0}, {:question_type=&gt;\"Wood\", :total=&gt;100.0}]\n</code></pre>\n\n<p>I would like to pick the hash with the highest value for the total key.\nSo the code bellow seems to do the work</p>\n\n<pre><code>max = arr.max_by{|x| x[:total]}\nputs max[:question_type]\n#=&gt; Wood\n</code></pre>\n\n<p>However if I have 2 hashes with the same value it will return the first one only</p>\n\n<pre><code>arr2 = [{:question_type=&gt;\"Fire\", :total=&gt;0.0}, {:question_type=&gt;\"Water\", :total=&gt;0.0}, {:question_type=&gt;\"Metal\", :total=&gt;0.0}, {:question_type=&gt;\"Earth\", :total=&gt;50.0}, {:question_type=&gt;\"Wood\", :total=&gt;50.0}]\n\nmax = arr2.max_by{|x| x[:total]} #it should be arr2\nputs max[:question_type]\n#=&gt; Earth\n</code></pre>\n\n<p>What would be the best way to get it to return <code>Earth</code> and <code>Wood</code> in case both are the highest values?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 7568, "user_id": 492969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b936bf1ffa62366b2c107de33361cc41?s=128&d=identicon&r=PG", "display_name": "three", "link": "https://stackoverflow.com/users/492969/three"}, "edited": false, "score": 0, "creation_date": 1508962126, "post_id": 46940602, "comment_id": 80829685, "body": "use sudo? Or use a local install of ruby via rvm, chruby et al?"}, {"owner": {"reputation": 6178, "user_id": 3307520, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jWlYC.jpg?s=128&g=1", "display_name": "Cyzanfar", "link": "https://stackoverflow.com/users/3307520/cyzanfar"}, "edited": false, "score": 0, "creation_date": 1508962860, "post_id": 46940602, "comment_id": 80830060, "body": "try running the command as an Administrator. on windows use the <code>runas</code> command"}, {"owner": {"reputation": 2914, "user_id": 777880, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/gDijM.jpg?s=128&g=1", "display_name": "Ziyan Junaideen", "link": "https://stackoverflow.com/users/777880/ziyan-junaideen"}, "edited": false, "score": 0, "creation_date": 1508992603, "post_id": 46940602, "comment_id": 80838988, "body": "If you want to develop in Windows, you can use Vagrant with VirtualBx... life  will be much easier for you!"}], "answers": [{"comments": [{"owner": {"reputation": 2914, "user_id": 777880, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/gDijM.jpg?s=128&g=1", "display_name": "Ziyan Junaideen", "link": "https://stackoverflow.com/users/777880/ziyan-junaideen"}, "edited": false, "score": 0, "creation_date": 1508992667, "post_id": 46941770, "comment_id": 80839009, "body": "If in Windows a Vagrant + VBox would also do. Even WSL (Windows sub system for Linux) is alright in some of the cases"}], "tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": false, "score": 0, "last_activity_date": 1508964393, "creation_date": 1508964393, "answer_id": 46941770, "question_id": 46940602, "link": "https://stackoverflow.com/questions/46940602/permission-denied-installing-rabl-gem/46941770#46941770", "title": "Permission Denied installing rabl gem", "body": "<p>First of all, I would recommend you to use <code>bundler</code> for automatic dependencies resolving.</p>\n\n<p>Regarding your problem, I believe the root cause is here: <code>Permission denied @ rb_file_s_symlink - (fixtures/ashared/views_rails_3/users/phone_number.json.rabl</code></p>\n\n<p>You should check permissions for this file and probably fix them. Because your current user does not have enough rights to access it.</p>\n\n<p>And the last, but not the least, try switching to linux/mac. Windows is really not suitable for productive Ruby developemnt.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 9276501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQJGM.png?s=128&g=1", "display_name": "chindruby", "link": "https://stackoverflow.com/users/9276501/chindruby"}, "is_accepted": false, "score": 7, "last_activity_date": 1517064026, "creation_date": 1517064026, "answer_id": 48476871, "question_id": 46940602, "link": "https://stackoverflow.com/questions/46940602/permission-denied-installing-rabl-gem/48476871#48476871", "title": "Permission Denied installing rabl gem", "body": "<p>You can fix it by running your terminal on windows ( \"Start Command Prompt with Ruby\", \"Git Bash\" or similar ) as administrator.</p>\n"}, {"tags": [], "owner": {"reputation": 547, "user_id": 3396971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c75295766cfc6c5950bb398fa6c7e2?s=128&d=identicon&r=PG", "display_name": "NemyaNation", "link": "https://stackoverflow.com/users/3396971/nemyanation"}, "is_accepted": false, "score": 0, "last_activity_date": 1518435647, "creation_date": 1518435647, "answer_id": 48745657, "question_id": 46940602, "link": "https://stackoverflow.com/questions/46940602/permission-denied-installing-rabl-gem/48745657#48745657", "title": "Permission Denied installing rabl gem", "body": "<p>Just had this problem when trying to install the Spree gem on ruby on rails.</p>\n\n<p>This was done on Rails 5.1.4, running Ruby ruby 2.3.3p222</p>\n\n<p>This error occurs when you don't have admin rights.</p>\n\n<p>Firstly, locate cmd and then right click on it and click on 'Run as administrator'.</p>\n\n<p>Log in with the appropiate credentials and then when the cmd pops up, run the command again </p>\n\n<blockquote>\n  <p>gem install rabl -v '0.13.1'</p>\n</blockquote>\n\n<p>And it should be successful!</p>\n"}, {"tags": [], "owner": {"reputation": 5949, "user_id": 557396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QbABH.jpg?s=128&g=1", "display_name": "Tasnim Reza", "link": "https://stackoverflow.com/users/557396/tasnim-reza"}, "is_accepted": false, "score": 1, "last_activity_date": 1588169209, "creation_date": 1588169209, "answer_id": 61503757, "question_id": 46940602, "link": "https://stackoverflow.com/questions/46940602/permission-denied-installing-rabl-gem/61503757#61503757", "title": "Permission Denied installing rabl gem", "body": "<p>If anyone runs into this problem in a Windows environment (windows 10), \nuse <code>start command prompt with ruby</code> as administrator \nand run <code>bundle update</code></p>\n"}], "owner": {"reputation": 443, "user_id": 7161061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58ec49d163553d91e7f717623216f926?s=128&d=identicon&r=PG&f=1", "display_name": "jmike", "link": "https://stackoverflow.com/users/7161061/jmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1793, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1588169209, "creation_date": 1508959618, "question_id": 46940602, "link": "https://stackoverflow.com/questions/46940602/permission-denied-installing-rabl-gem", "title": "Permission Denied installing rabl gem", "body": "<p>I am trying to install the spree gem but i am having a little trouble installing the gem. currently i am getting an error when trying to install the rabl(0.13.1) gem. I am getting a permission is denied . Wondering how i can fix this error so i can get back to finish installing spree.</p>\n\n<pre><code>ERROR:  While executing gem ... (Errno::EACCES)\n    Permission denied @ rb_file_s_symlink \n</code></pre>\n\n<hr>\n\n<pre><code>Installing rabl 0.13.1\nErrno::EACCES: Permission denied @ rb_file_s_symlink -\n(fixtures/ashared/views_rails_3/users/phone_number.json.rabl,\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rabl-0.13.1/fixtures/ashared/views_rails_3/users/phone_number.xml.rabl)\nAn error occurred while installing rabl (0.13.1), and Bundler cannot continue.\nMake sure that `gem install rabl -v '0.13.1'` succeeds before bundling.\n\nIn Gemfile:\n  spree was resolved to 3.4.1, which depends on\n    spree_backend was resolved to 3.4.1, which depends on\n      spree_api was resolved to 3.4.1, which depends on\n        rabl\n\nC:\\Users\\Michael\\Desktop\\ruby\\pen&gt;gem install rabl -v '0.13.1\nERROR:  While executing gem ... (Errno::EACCES)\n    Permission denied @ rb_file_s_symlink - (fixtures/ashared/views_rails_3/users/phone_number.json.rabl, C:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rabl-0.13.1/fixtures/ashared/views_rails_3/users/phone_number.xml.rabl)\n\nC:\\Users\\Michael\\Desktop\\ruby\\pen&gt;gem install\nERROR:  While executing gem ... (Gem::CommandLineError)\n    Please specify at least one gem name (e.g. gem build GEMNAME)\n\nC:\\Users\\Michael\\Desktop\\ruby\\pen&gt;uby/gems/2.4\n'uby' is not recognized as an internal or external command,\noperable program or batch file.\n</code></pre>\n"}, {"tags": ["ruby", "gcc", "rubygems", "autotools"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508962155, "post_id": 46940487, "comment_id": 80829699, "body": "If you did the same thing today that you did yesterday, but got different results, then it follows that something changed on your system.  That could have been something in your project directory, but it could also be elsewhere in your system.  I don&#39;t see how we can answer the question, other than by guessing."}, {"owner": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508967908, "post_id": 46940487, "comment_id": 80832513, "body": "@JohnBollinger i figured the issue, posted below :)"}], "answers": [{"tags": [], "owner": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1508967877, "creation_date": 1508967877, "answer_id": 46942527, "question_id": 46940487, "link": "https://stackoverflow.com/questions/46940487/problems-compiling-ruby-2-4-2/46942527#46942527", "title": "Problems compiling Ruby 2.4.2", "body": "<p>The answer to this was that I had also run:</p>\n\n<p><code>CFLAGS=\"$X\" CXXFLAGS=\"$X\" LDFLAGS=\"$X\" ./configure --prefix=/tmp/ruby-deploy --with-openssl-dir=$(brew --prefix openssl) --with-static-linked-ext --disable-install-doc --without-gmp</code></p>\n\n<p>at one point -- note the <code>--with-static-linked-ext</code>. This resulted in the other dynamically linked libs.</p>\n\n<p>However because i had subsequently run <code>./configure</code> again WITHOUT that option i assumed it would have reset the configuration, but it didn't.</p>\n\n<p>I discovered the problem by wiping out the Ruby source folder and re-fetching from github. Running the initial <code>./configure</code> (excluding the <code>--with-static-linked-ext</code> resolved the issue!</p>\n"}], "owner": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508967877, "creation_date": 1508959172, "last_edit_date": 1508960464, "question_id": 46940487, "link": "https://stackoverflow.com/questions/46940487/problems-compiling-ruby-2-4-2", "title": "Problems compiling Ruby 2.4.2", "body": "<p>I am trying to build a minimal easily transportable Ruby without relying on external projects, just for my own learning process.</p>\n\n<p>I am using <code>otool -L ruby</code> to determine what libraries the Ruby binary is dynamically linking against as I am trying to minimize it.</p>\n\n<p>Yesterday when i built Ruby it only dynamically linked against 3 libraries, however today when i build Ruby it is linking against 13. I have no idea what has changed between yesterday and today but I am thoroughly confused -- especially as many of the libraries it is linking against existed prior to yesterday's compilation.</p>\n\n<p>On Yesterday's Ruby executable the result of <code>otool -L</code> was:</p>\n\n<pre><code>otool -L ruby\nruby:\n    /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 1349.8.0)\n    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1238.60.2)\n    /usr/lib/libobjc.A.dylib (compatibility version 1.0.0, current version 228.0.0)\n    /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 489.0.0)\n</code></pre>\n\n<p>But today it is:</p>\n\n<pre><code>otool -L ./ruby\n./ruby:\n    /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 1349.8.0)\n    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1238.60.2)\n    /usr/lib/libobjc.A.dylib (compatibility version 1.0.0, current version 228.0.0)\n    /usr/local/opt/openssl/lib/libcrypto.1.0.0.dylib (compatibility version 1.0.0, current version 1.0.0)\n    /usr/local/opt/openssl/lib/libssl.1.0.0.dylib (compatibility version 1.0.0, current version 1.0.0)\n    /usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.8)\n    /usr/lib/libffi.dylib (compatibility version 1.0.0, current version 1.0.0)\n    /usr/local/opt/gdbm/lib/libgdbm.4.dylib (compatibility version 5.0.0, current version 5.0.0)\n    /usr/lib/libutil.dylib (compatibility version 1.0.0, current version 1.0.0)\n    /usr/lib/libedit.3.dylib (compatibility version 2.0.0, current version 3.0.0)\n    /usr/lib/libncurses.5.4.dylib (compatibility version 5.4.0, current version 5.4.0)\n    /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 489.0.0)\n</code></pre>\n\n<p>Does anyone know what is going on?</p>\n\n<p>I am compiling Ruby 2.4.2 like so:</p>\n\n<pre><code>X=\"-arch i386 -mmacosx-version-min=10.5\"\nCFLAGS=\"$X\" CXXFLAGS=\"$X\" LDFLAGS=\"$X\" ./configure --prefix=/tmp/ruby-deploy --with-openssl-dir=$(brew --prefix openssl)  --disable-install-doc --without-gmp\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508954956, "post_id": 46939256, "comment_id": 80825703, "body": "The redirect is correct. You have your routes set up incorrectly. Please add the relevant section of <code>routes.rb</code> to your question so we can identify the error."}, {"owner": {"reputation": 844, "user_id": 6085236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0062b2fe329a0a1d4164b47b950394e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6085236/jin"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508954995, "post_id": 46939256, "comment_id": 80825715, "body": "resources :groupevents"}, {"owner": {"reputation": 1215, "user_id": 2824935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/dkDTX.jpg?s=128&g=1", "display_name": "garythegoat", "link": "https://stackoverflow.com/users/2824935/garythegoat"}, "edited": false, "score": 0, "creation_date": 1508955008, "post_id": 46939256, "comment_id": 80825723, "body": "What is the output of <code>$ rake routes</code>?  The correct path given your current route setup should be in the output"}, {"owner": {"reputation": 844, "user_id": 6085236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0062b2fe329a0a1d4164b47b950394e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6085236/jin"}, "edited": false, "score": 0, "creation_date": 1508955033, "post_id": 46939256, "comment_id": 80825739, "body": "this is what I added in routes.rb"}, {"owner": {"reputation": 149, "user_id": 1787057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37c2783c540cc3bb9c07305a56ad81d8?s=128&d=identicon&r=PG", "display_name": "ishe_ua", "link": "https://stackoverflow.com/users/1787057/ishe-ua"}, "edited": false, "score": 0, "creation_date": 1508955138, "post_id": 46939256, "comment_id": 80825796, "body": "Try:     &quot;rails routes | grep group&quot;.  You should see <b>group_event_path</b> in output."}], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 1998931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bc6bbd9b85f9ed97574bc4b834ab2f?s=128&d=identicon&r=PG", "display_name": "Carlos Roque", "link": "https://stackoverflow.com/users/1998931/carlos-roque"}, "edited": false, "score": 1, "creation_date": 1508955650, "post_id": 46939350, "comment_id": 80826089, "body": "OP should use scaffolding command in rails to avoid these type of naming issues"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 399, "user_id": 1998931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bc6bbd9b85f9ed97574bc4b834ab2f?s=128&d=identicon&r=PG", "display_name": "Carlos Roque", "link": "https://stackoverflow.com/users/1998931/carlos-roque"}, "edited": false, "score": 1, "creation_date": 1508956474, "post_id": 46939350, "comment_id": 80826536, "body": "Using scaffolding is not always a good idea. It generates a lot of code at once and its easy to outrun your test coverage. @CarlosRoque"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1508957033, "post_id": 46939350, "comment_id": 80826866, "body": "Personally (and this is just one dude&#39;s probably-terrible point of view), I ended up building my own scaffold because I feel the out-of-the-box scaffolding has bad practices built in. But, I&#39;m probably insane."}, {"owner": {"reputation": 399, "user_id": 1998931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bc6bbd9b85f9ed97574bc4b834ab2f?s=128&d=identicon&r=PG", "display_name": "Carlos Roque", "link": "https://stackoverflow.com/users/1998931/carlos-roque"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508957462, "post_id": 46939350, "comment_id": 80827107, "body": "@max respectfully, I think if you can&#39;t get your names correct from the get-go then scaffolding is a good a idea. specially for beginners. Obviously someone experienced will have no problem with doing things by hand. I find it easier to delete the files i don&#39;t need than having to figure out why a route is not working."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508967420, "post_id": 46939350, "comment_id": 80832302, "body": "Please feel free to accept this answer if it worked for you. Cheers!"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 4, "last_activity_date": 1508955406, "last_edit_date": 1508955406, "creation_date": 1508955069, "answer_id": 46939350, "question_id": 46939256, "link": "https://stackoverflow.com/questions/46939256/ruby-on-rails-multi-word-name-model-redirect-error/46939350#46939350", "title": "Ruby on Rails multi word name model redirect error", "body": "<p>You'll need to change:</p>\n\n<pre><code>resources :groupevents\n</code></pre>\n\n<p>to: </p>\n\n<pre><code>resources :group_events\n</code></pre>\n\n<p><code>:groupevents</code> would imply a model named <code>Groupevents</code>. <code>:group_events</code>, implies a model named <code>GroupEvents</code>.</p>\n\n<p>Also, it would be conventional to do something like:</p>\n\n<pre><code>def create\n  @ge = GroupEvent.new(groupevent_params)\n\n  if @ge.valid?\n    @ge.save\n    redirect_to @ge\n  else\n    redirect_to some_other_path\n  end\n\nend\n</code></pre>\n\n<p>In case there's something wrong with <code>@ge</code>.</p>\n"}], "owner": {"reputation": 844, "user_id": 6085236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0062b2fe329a0a1d4164b47b950394e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6085236/jin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508955406, "creation_date": 1508954744, "question_id": 46939256, "link": "https://stackoverflow.com/questions/46939256/ruby-on-rails-multi-word-name-model-redirect-error", "title": "Ruby on Rails multi word name model redirect error", "body": "<p>I created model named GroupEvent</p>\n\n<p>When I tried to redirect it returns error. \nHere is code.</p>\n\n<pre><code>def create\n  @ge = GroupEvent.new(groupevent_params)\n\n  @ge.save\n  redirect_to @ge\nend\n</code></pre>\n\n<p>It shows such error. \n*undefined method `group_event_path' *</p>\n\n<p>I think it should redirect_to groupevent_path but due to model name it throws error.</p>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["ruby", "nokogiri"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1508954759, "post_id": 46938939, "comment_id": 80825576, "body": "You&#39;re using a single hash. That doesn&#39;t explain why you get a single result back; you should get back an array of references to the single hash."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1508955344, "post_id": 46938939, "comment_id": 80825929, "body": "@DaveNewton: That&#39;s because the loop is just one cycle rather than iteration over the rules."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1508956809, "post_id": 46938939, "comment_id": 80826742, "body": "@kiddorails Ok; didn&#39;t look at the DOM."}], "answers": [{"tags": [], "owner": {"reputation": 1103, "user_id": 2624489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad9f7a424213d6f44f4dc7c40362d5f?s=128&d=identicon&r=PG", "display_name": "james00794", "link": "https://stackoverflow.com/users/2624489/james00794"}, "is_accepted": false, "score": 0, "last_activity_date": 1508954918, "creation_date": 1508954918, "answer_id": 46939305, "question_id": 46938939, "link": "https://stackoverflow.com/questions/46938939/i-am-trying-to-return-an-array-of-hashes-but-only-the-last-hash-is-being-added/46939305#46939305", "title": "I am trying to return an array of hashes, but only the last hash is being added to the array?", "body": "<p>The <code>doc.css('div#rules-of-poker-accordion')</code> call is returning a single div, as that is how the page is structured. Because of that, you are only actually entering the <code>each</code> loop once.</p>\n\n<p>The layout of that site is a bit funny, so you'll have to get the names and the values separately. Here is a brute force solution...</p>\n\n<pre><code>def get_all_hands\n  doc = Nokogiri::HTML(open('http://www.cardplayer.com/rules-of-poker/hand-rankings'))\n  hands_array = []\n\n  doc.css('div#rules-of-poker-accordion').css(\"strong\").each do |name|\n    hands_array.push({name: name.text, value: []})\n  end\n\n  doc.css('div#rules-of-poker-accordion').css(\".rules-cards\").each_with_index do |hand, i|\n    hand.css('img').each do |card|\n      hands_array[i][:value].push card.attr('src')\n    end\n  end\n  hands_array\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1103, "user_id": 2624489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad9f7a424213d6f44f4dc7c40362d5f?s=128&d=identicon&r=PG", "display_name": "james00794", "link": "https://stackoverflow.com/users/2624489/james00794"}, "edited": false, "score": 1, "creation_date": 1508955409, "post_id": 46939406, "comment_id": 80825969, "body": "I like the use of <code>zip</code> :)"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1508964054, "post_id": 46939406, "comment_id": 80830597, "body": "Good answer. You can replace lines 7 through 11 (and be more idiomatic) by using <code>map</code> instead of <code>each</code> like so: <code>hand_hash[:value] = value.css(&#39;img&#39;).map { |card| card.attr(&#39;src&#39;) }</code>. This does result in the second array element having <code>:value =&gt; []</code>, but I think that is preferable to no <code>:value</code> key at all."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1508964234, "post_id": 46939406, "comment_id": 80830688, "body": "@moveson - yes, I totally get it. The entire thing can actually be rewritten in a more idiomatic way. But my intent is to help OP with his own code for the problem at hand."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1508964348, "post_id": 46939406, "comment_id": 80830760, "body": "@kiddorails Agreed. But because the code there is somewhat tortured and exhibits the same problem the OP was having to begin with (i.e., line 10 assigns the growing array repeatedly to the same Hash key) I thought it might make sense to help him understand how to properly work with arrays in Ruby."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1508964516, "post_id": 46939406, "comment_id": 80830845, "body": "@moveson - I agree with you. Would be really glad, if you could add an edit to this answer (or add another) with additional information/code of how OP should have structured his code?"}], "tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": false, "score": 3, "last_activity_date": 1508955743, "last_edit_date": 1508955743, "creation_date": 1508955283, "answer_id": 46939406, "question_id": 46938939, "link": "https://stackoverflow.com/questions/46938939/i-am-trying-to-return-an-array-of-hashes-but-only-the-last-hash-is-being-added/46939406#46939406", "title": "I am trying to return an array of hashes, but only the last hash is being added to the array?", "body": "<p>This particular piece of code is reason why it doesn't work. You are iterating on each <code>strong</code> assigning the value to the same key (<code>:name</code>) of <code>hand_hash</code>. Same is the case with next iteration. Basically, you are overriding the same hash without saving it anywhere, until last iteration.</p>\n\n<pre><code>hands.css('strong').each_with_index do |hand, index|\n  hand_hash[index] = hand.text\nend\n</code></pre>\n\n<p>I made some changes in your own code to fix this:</p>\n\n<pre><code>doc = Nokogiri::HTML(open('http://www.cardplayer.com/rules-of-poker/hand-rankings'))\nhands_array = []\ndoc.css('div#rules-of-poker-accordion').each do |hands|\n  hands.css('strong').zip(hands.css('div.rules-cards')).each do |hand, value|\n    hand_hash = {}\n    hand_hash[:name] = hand.text\n    hand_value = []\n    value.css('img').each do |card|\n      hand_value &lt;&lt; card.attr('src')\n      hand_hash[:value] = hand_value\n    end\n    hands_array &lt;&lt; hand_hash #here, now you are saving after each hand\n  end\nend\nhands_array\n</code></pre>\n\n<p><code>hands.css('strong').zip(hands.css('div.rules-cards'))</code> will pair up each <em>name</em> and <em>rule</em> and then you are just adding that in your <code>hands_array</code>. </p>\n\n<p>Result:</p>\n\n<blockquote>\n  <p>[{:name=>\"1. Royal flush\",   :value=><br>\n  [\"/packages/cards/Large/Diamond/A-49a04aae5e96d2f948dc2062c2c4fcd5.png\",\n      \"/packages/cards/Large/Diamond/K-0bfc14d8f58cc13891b108e4178f92f9.png\",\n      \"/packages/cards/Large/Diamond/Q-b981aa1f57642480de1dceaf1c2e810f.png\",\n      \"/packages/cards/Large/Diamond/J-d915fc38dbca1ca74cdd75dd913de1f3.png\",\n      \"/packages/cards/Large/Diamond/T-ef2fe11bbd701e4c5b6681e506271700.png\"]},\n  {:name=>\"2. Straight flush\"},  {:name=>\"3. Four of a kind\",   :value=>\n  [\"/packages/cards/Large/Heart/J-2bf19067cda29391286416d0d00646d6.png\",\n      \"/packages/cards/Large/Diamond/J-d915fc38dbca1ca74cdd75dd913de1f3.png\",\n      \"/packages/cards/Large/Spade/J-fff29c49da8ca1f7a272c5ac83f51d06.png\",\n      \"/packages/cards/Large/Club/J-58b4c0f26e3e0cf8c0772ab3e9e34784.png\",\n      \"/packages/cards/Large/Diamond/7-7e507c2122efe10ed7abacab95edff97.png\"]},\n  {:name=>\"4. Full house\",   :value=><br>\n  [\"/packages/cards/Large/Heart/T-c3f8fd4ffc3e09ec705a817aa212dc86.png\",\n      \"/packages/cards/Large/Diamond/T-ef2fe11bbd701e4c5b6681e506271700.png\",\n      \"/packages/cards/Large/Spade/T-9a16f63a333b3edeb50c4372f8dd9883.png\",\n      \"/packages/cards/Large/Club/9-e6f0020a48aef9907b626477c5a60ac2.png\",\n      \"/packages/cards/Large/Diamond/9-3e500833bafc81a708d195f16d005125.png\"]},\n  {:name=>\"5. Flush\",   :value=><br>\n  [\"/packages/cards/Large/Spade/4-4200c8b5f3f5ba04d9fd5a69d71dab2f.png\",\n      \"/packages/cards/Large/Spade/J-fff29c49da8ca1f7a272c5ac83f51d06.png\",\n      \"/packages/cards/Large/Spade/8-60d335b08119f600c3ca02aa58fa902d.png\",\n      \"/packages/cards/Large/Spade/2-e2d1cee5fc0db0b70990036153d57906.png\",\n      \"/packages/cards/Large/Spade/9-b0d71e77734375ceb3954156232f1f2d.png\"]},\n  {:name=>\"6. Straight\",   :value=><br>\n  [\"/packages/cards/Large/Club/9-e6f0020a48aef9907b626477c5a60ac2.png\",\n      \"/packages/cards/Large/Diamond/8-6cd5b3025be0dd56cd52dfd2a49d922d.png\",\n      \"/packages/cards/Large/Spade/7-6c1d119e9c923f8e4773cf00d05e26d6.png\",\n      \"/packages/cards/Large/Diamond/6-a0c0218210a1a6c4ec17e5cec17ee3d8.png\",\n      \"/packages/cards/Large/Heart/5-f498916a3011c2b7199e1c1008dbe330.png\"]},\n  {:name=>\"7. Three of a kind\",   :value=><br>\n  [\"/packages/cards/Large/Club/7-5610625720208cc02c1107c91365eb37.png\",\n      \"/packages/cards/Large/Diamond/7-7e507c2122efe10ed7abacab95edff97.png\",\n      \"/packages/cards/Large/Spade/7-6c1d119e9c923f8e4773cf00d05e26d6.png\",\n      \"/packages/cards/Large/Club/K-3e8312c33de4718943cd0276de8a16a1.png\",\n      \"/packages/cards/Large/Diamond/3-909f8b1571f834c774576c93eae26594.png\"]},\n  {:name=>\"8. Two pair\",   :value=><br>\n  [\"/packages/cards/Large/Club/4-33a9251d25da1ea2ba49e69e94549aee.png\",\n      \"/packages/cards/Large/Spade/4-4200c8b5f3f5ba04d9fd5a69d71dab2f.png\",\n      \"/packages/cards/Large/Club/3-0c3eda54cfb6808b0a94950c045e497a.png\",\n      \"/packages/cards/Large/Diamond/3-909f8b1571f834c774576c93eae26594.png\",\n      \"/packages/cards/Large/Club/Q-9fcc4fd7692aa96ba9fcb04fa9fd727d.png\"]},\n  {:name=>\"9. Pair\",   :value=><br>\n  [\"/packages/cards/Large/Heart/A-748f3f87f79ac475e6a432750725b64c.png\",\n      \"/packages/cards/Large/Diamond/A-49a04aae5e96d2f948dc2062c2c4fcd5.png\",\n      \"/packages/cards/Large/Club/8-c3708e4821723f1100d514e5280b3f32.png\",\n      \"/packages/cards/Large/Spade/4-4200c8b5f3f5ba04d9fd5a69d71dab2f.png\",\n      \"/packages/cards/Large/Heart/7-1610ff3e74c68f6dd8a855bd16887457.png\"]},\n  {:name=>\"10. High Card\",   :value=><br>\n  [\"/packages/cards/Large/Diamond/3-909f8b1571f834c774576c93eae26594.png\",\n      \"/packages/cards/Large/Club/J-58b4c0f26e3e0cf8c0772ab3e9e34784.png\",\n      \"/packages/cards/Large/Spade/8-60d335b08119f600c3ca02aa58fa902d.png\",\n      \"/packages/cards/Large/Heart/4-712ce04b7f2c7e588c48a1e2b46a4244.png\",\n      \"/packages/cards/Large/Spade/2-e2d1cee5fc0db0b70990036153d57906.png\"]}]</p>\n</blockquote>\n\n<p>Hope it helps :)</p>\n"}, {"tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 0, "last_activity_date": 1508972757, "creation_date": 1508972757, "answer_id": 46943353, "question_id": 46938939, "link": "https://stackoverflow.com/questions/46938939/i-am-trying-to-return-an-array-of-hashes-but-only-the-last-hash-is-being-added/46943353#46943353", "title": "I am trying to return an array of hashes, but only the last hash is being added to the array?", "body": "<p>The answer by @kiddorails is correct, but you can be much more concise and Ruby-idiomatic in this problem. Consider the following, which gives the same result:</p>\n\n<pre><code>  def get_all_hands\n    doc = Nokogiri::HTML(open('http://www.cardplayer.com/rules-of-poker/hand-rankings'))\n    hands = doc.css('div#rules-of-poker-accordion').first\n    hands.css('strong').zip(hands.css('div.rules-cards')).map do |hand, value|\n      {name: hand.text, value: value.css('img').map { |card| card.attr('src') }}\n    end\n  end\n</code></pre>\n\n<p>Ruby has strong methods for handling and transforming Arrays. Once you have an Array, you can transform it using one of Ruby's many expressive <a href=\"http://ruby-doc.org/core-2.4.2/Enumerable.html\" rel=\"nofollow noreferrer\">Enumerable methods</a>. @kiddorails started down this path by using <code>#zip</code> to join two arrays together, and the above refactoring finishes the job by taking the resulting array of arrays and transforming it into an array of hashes using <code>#map</code>. </p>\n\n<p>In Ruby, anytime you find yourself writing this pattern:</p>\n\n<pre><code>result = []\narray.each { |element| result &lt;&lt; method(element) }\nresult\n</code></pre>\n\n<p>You can generally replace those three lines with:</p>\n\n<pre><code>array.map { |element| method(element) }\n</code></pre>\n"}], "owner": {"reputation": 510, "user_id": 8833196, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/0134ed1fe03621d083acf928a94fec19?s=128&d=identicon&r=PG&f=1", "display_name": "adam tropp", "link": "https://stackoverflow.com/users/8833196/adam-tropp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1508972757, "creation_date": 1508953668, "last_edit_date": 1508954679, "question_id": 46938939, "link": "https://stackoverflow.com/questions/46938939/i-am-trying-to-return-an-array-of-hashes-but-only-the-last-hash-is-being-added", "title": "I am trying to return an array of hashes, but only the last hash is being added to the array?", "body": "<p>Here is how I get all the hands</p>\n\n<pre><code>def get_all_hands\n  doc = Nokogiri::HTML(open('http://www.cardplayer.com/rules-of-poker/hand-rankings'))\n  hand_hash = {}\n  hands_array = []\n  doc.css('div#rules-of-poker-accordion').each do |hands|\n    hands.css('strong').each do |hand|\n      hand_hash[:name] = hand.text\n    end\n    hands.css('div.rules-cards').each do |hand|\n      hand_value = []\n      hand.css('img').each do |card|\n        hand_value &lt;&lt; card.attr('src')\n        hand_hash[:value] = hand_value\n      end\n    end\n    hands_array &lt;&lt; hand_hash\n  end\n  hands_array\nend\nHandScraper.new.get_all_hands\n</code></pre>\n\n<p>This returns: </p>\n\n<pre><code>[{:name=&gt;\"10. High Card\",\n:value=&gt;\n[\"/packages/cards/Large/Diamond/3-909f8b1571f834c774576c93eae26594.png\",\n \"/packages/cards/Large/Club/J-58b4c0f26e3e0cf8c0772ab3e9e34784.png\",\n \"/packages/cards/Large/Spade/8-60d335b08119f600c3ca02aa58fa902d.png\",\n \"/packages/cards/Large/Heart/4-712ce04b7f2c7e588c48a1e2b46a4244.png\",\n \"/packages/cards/Large/Spade/2-e2d1cee5fc0db0b70990036153d57906.png\"]}]\n</code></pre>\n\n<p>which is the tenth and final hand, when I want it to return all 10. </p>\n"}, {"tags": ["ruby", "object", "virtus"], "answers": [{"comments": [{"owner": {"reputation": 5648, "user_id": 1492005, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jLmY9.jpg?s=128&g=1", "display_name": "Jaison Brooks", "link": "https://stackoverflow.com/users/1492005/jaison-brooks"}, "edited": false, "score": 0, "creation_date": 1508961423, "post_id": 46939909, "comment_id": 80829329, "body": "This is awesome, and is sooo close to what im looking for. I updated my sample code with what the data is gonna look like consistently. mind taking one last look?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 5648, "user_id": 1492005, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jLmY9.jpg?s=128&g=1", "display_name": "Jaison Brooks", "link": "https://stackoverflow.com/users/1492005/jaison-brooks"}, "edited": false, "score": 0, "creation_date": 1508964695, "post_id": 46939909, "comment_id": 80830945, "body": "@JaisonBrooks did you actually try this because it works as expected. I have updated with an example"}, {"owner": {"reputation": 5648, "user_id": 1492005, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jLmY9.jpg?s=128&g=1", "display_name": "Jaison Brooks", "link": "https://stackoverflow.com/users/1492005/jaison-brooks"}, "edited": false, "score": 0, "creation_date": 1508964944, "post_id": 46939909, "comment_id": 80831099, "body": "I did try it, i keep receiving the following error. <code>undefined method `key?&#39; for &quot;1234&quot;:String</code>. Your first example output is perfect. I pry wont be using the array type entry. since the data will be a hash, unless its that single string. thanks again for this help/saving me."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 5648, "user_id": 1492005, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jLmY9.jpg?s=128&g=1", "display_name": "Jaison Brooks", "link": "https://stackoverflow.com/users/1492005/jaison-brooks"}, "edited": false, "score": 0, "creation_date": 1508965639, "post_id": 46939909, "comment_id": 80831486, "body": "@JaisonBrooks glad it helped"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1508965285, "last_edit_date": 1508965285, "creation_date": 1508957068, "answer_id": 46939909, "question_id": 46938598, "link": "https://stackoverflow.com/questions/46938598/initialize-with-string-or-hash-in-virtus-ruby-object/46939909#46939909", "title": "Initialize with String or Hash in Virtus Ruby object", "body": "<p><strong>Note:</strong> This is for edification purposes only and may have unintended consequences that might be difficult to debug.</p>\n\n<p>You can override the <code>Virtus::InstanceMethods::Constructor</code> like so if you really want to:</p>\n\n<pre><code>module VirtusOverride\n  def self.included(base)\n    raise \"#{base.name} must include Virtus.model prior to including VirtusOverride\" unless base.included_modules.include?(Virtus::InstanceMethods)\n  end\n\n  def initialize(*attributes)\n    super(construct(attributes))\n  end\n\n  private\n    def construct(attributes)\n      return attributes.first if valid_constructor?(attributes)\n      build_attributes_from_array(attributes) \n    end \n    def valid_constructor?(attributes)\n      return false unless attributes.count == 1 \n      constructor = attributes.first\n      constructor.is_a?(Hash) &amp;&amp;  \n      !(attribute_set.flat_map {|a| [a.name,a.name.to_s]} &amp; constructor.keys).empty?\n    end\n    def build_attributes_from_array(attributes)\n      attribute_set.map(&amp;:name).zip(attributes).to_h\n    end\nend \n</code></pre>\n\n<p>Then include it as needed</p>\n\n<pre><code>class Account\n  include Virtus.model\n  include VirtusOverride\n\n  attribute :id, String\n  attribute :contact, Hash\nend \n</code></pre>\n\n<p>Now you can either pass the options positional to the definition of attributes (e.g. <code>Account.new(id,contact)</code>) or as a <code>Hash</code>.</p>\n\n<p>Example: </p>\n\n<pre><code>Account.new(\"1234\",{name: 'mnky'})\n#=&gt; #&lt;Account:0x2a071b8 @id=\"1234\", @contact={:name=&gt;\"mnky\"}&gt;\n\nAccount.new(id: \"1234\", contact: {name: 'mnky'})\n#=&gt; #&lt;Account:0x2b42b78 @id=\"1234\", @contact={:name=&gt;\"mnky\"}&gt;\n</code></pre>\n\n<p>You could monkey patch <code>Virtus::InstanceMethods::Constructor</code> to perform the same but I am not a big supporter of this philosophy as it could add confusion to other developers where as the module inclusion offers granularity and clarity.</p>\n\n<p><strong>Update</strong></p>\n\n<pre><code>class Account\n  include Virtus.model\n  include VirtusOverride\n\n  attribute :id, String\n  attribute :contact, Contact\nend \n\nclass Contact\n  include Virtus.model\n  include VirtusOverride\n\n  attribute :id, String\nend  \n\n Account.new(id: '1234', contact: '123456', name: 'Bob Jones')\n #=&gt;  #&lt;Account:0x2bcb060 @id=\"1234\", @contact=#&lt;Contact:0x2bc9c50 @id=\"123456\"&gt;, @name=\"Bob Jones\"&gt;\n Account.new('1234', '123456', 'Bob Jones')\n #=&gt; #&lt;Account:0x2faea00 @id=\"1234\", @contact=#&lt;Contact:0x2fae880 @id=\"123456\"&gt;, @name=\"Bob Jones\"&gt;\n Account.new('id' =&gt; '1234', 'contact' =&gt; '123456', 'name' =&gt; 'Bob Jones')\n #=&gt; #&lt;Account:0x2faffc0 @id=\"1234\", @contact=#&lt;Contact:0x2fafb70 @id=\"123456\"&gt;, @name=\"Bob Jones\"&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1508959160, "post_id": 46940146, "comment_id": 80828114, "body": "I can more than agree with this sentiment but I have never used <code>virtus</code> so it fun to explore a new code base. :)"}], "tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 3, "last_activity_date": 1508958005, "creation_date": 1508958005, "answer_id": 46940146, "question_id": 46938598, "link": "https://stackoverflow.com/questions/46938598/initialize-with-string-or-hash-in-virtus-ruby-object/46940146#46940146", "title": "Initialize with String or Hash in Virtus Ruby object", "body": "<p><a href=\"https://github.com/solnic/virtus/issues/262#issuecomment-40470064\" rel=\"nofollow noreferrer\">Virtus\u2019 author\u2019s opinion</a> is that you should not be using Virtus for sanitization. As you can see from @engineersmnky\u2019s answer, it takes more work than it ought to to override the <code>initialize</code> method. </p>\n\n<p>It would instead be easier to wrap the object you're passing in:</p>\n\n<pre><code>class Hashable\n  def initialize(hashable_object)\n    @obj = hashable_object\n  end\n\n  def to_hash\n    case @obj\n    when Hash then @obj\n    when String\n      { \"id\" =&gt; @obj }\n    else\n      raise \"No conversion from #{@obj.class} to hash\"\n    end\n  end\nend\n\nAccount.new(Hashable.new(relationship))\n</code></pre>\n"}], "owner": {"reputation": 5648, "user_id": 1492005, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jLmY9.jpg?s=128&g=1", "display_name": "Jaison Brooks", "link": "https://stackoverflow.com/users/1492005/jaison-brooks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508965285, "creation_date": 1508952584, "last_edit_date": 1508961892, "question_id": 46938598, "link": "https://stackoverflow.com/questions/46938598/initialize-with-string-or-hash-in-virtus-ruby-object", "title": "Initialize with String or Hash in Virtus Ruby object", "body": "<p>I need to be able to create a Virtus based object that takes in a Hash or a String. If its a Hash, then normal behavior is perfect. If it's a plain String, then i need to convert it to <code>{'id' =&gt; \"STRING\"}</code>. At this time, i'm not sure how / where to override the <code>initialize</code> method to perform this function. Or maybe there's a different way. Your expertise is greatly appreciated. </p>\n\n<pre><code>class Contact\n  include Virtus.model\n\n  attribute :id, String\nend\n\nclass Account\n  include Virtus.model\n\n  attribute :id, String\n  attribute :contact, Contact\n  attribute :name, String\nend \n\naccount = Account.new(\"1234\")\naccount.id #&gt;1234\n\n# and still work like this\n\naccount = Account.new(id: '1234', contact: '123456', name: 'Bob Jones')\naccount.id #&gt;1234\naccount.contact.id #&gt;123456\naccount.name #&gt;Bob Jones\n</code></pre>\n\n<p>Sample Data</p>\n\n<pre><code>{'id' =&gt; '1234', 'contact' =&gt; '123456', 'name' =&gt; 'Bob Jones'}\n</code></pre>\n\n<p>So between both Contact and Account. I need them to be able to initialized with a String, which populates the @id param.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 1, "last_activity_date": 1508952162, "last_edit_date": 1508952162, "creation_date": 1508951565, "answer_id": 46938340, "question_id": 46938217, "link": "https://stackoverflow.com/questions/46938217/cannot-rake-migration-for-my-ruby-project/46938340#46938340", "title": "Cannot rake migration for my ruby project", "body": "<p>The error appears when you define the <code>post</code> and <code>delete</code> routes within the <code>format</code> scope, to tell Rails which controller and action/method use for the URI being defined.</p>\n\n<p>To refer then the controller name and action use the lowercase name followed by a slash, instead the uppercase controller name and colons <code>::</code>, like:</p>\n\n<pre><code>post   '/api/login'  =&gt; 'api/sessions#create'\ndelete '/api/logout' =&gt; 'api/sessions#destroy'\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8645487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92529533799cca9caca0d020f819dda5?s=128&d=identicon&r=PG&f=1", "display_name": "Jianhan Wang", "link": "https://stackoverflow.com/users/8645487/jianhan-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1508952162, "creation_date": 1508951160, "question_id": 46938217, "link": "https://stackoverflow.com/questions/46938217/cannot-rake-migration-for-my-ruby-project", "title": "Cannot rake migration for my ruby project", "body": "<p>When I try to rake a migration for my ruby project, it gives me an error \"'API::sessions' is not a supported controller name\". Does anyone know how to solve this problem? The following code is from my routes.rb file and sessions_controller.rb file.</p>\n\n<pre><code>Rails.application.routes.draw do\n\nget 'projects/:id', to: 'projects#show'\nget 'projects', to: 'projects#index'\n\nget 'welcome/index'\nroot 'welcome#index'\nmatch '/login', to: 'sessions#new', via: :get\nmatch '/login_create', to: 'sessions#create', via: :post\nresources :users\n\nscope :format =&gt; true, :constraints =&gt; { :format =&gt; 'json' } do\n  post   \"/api/login\"       =&gt; \"API::sessions#create\"\n  delete \"/api/logout\"      =&gt; \"API::sessions#destroy\"\nend\nend\n</code></pre>\n\n<hr>\n\n<pre><code>class API::SessionsController &lt; API::ApiController\nskip_before_action :require_login, only: [:create], raise: false\n\ndef create\n    if user = User.valid_login?(params[:email], params[:password])\n        allow_token_to_be_used_only_once_for(user)\n        send_auth_token_for_valid_login_of(user)\n    else\n        render_unauthorized(\"Error with your login or password\")\n    end\nend\n\ndef destroy\n    logout\n    head :ok\nend\n\nprivate\n\ndef send_auth_token_for_valid_login_of(user)\n    render json: { token: user.token }\nend\n\ndef allow_token_to_be_used_only_once_for(user)\n    user.regenerate_token\nend\n\ndef logout\n    current_user.invalidate_token\nend\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara"], "comments": [{"owner": {"reputation": 2914, "user_id": 777880, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/gDijM.jpg?s=128&g=1", "display_name": "Ziyan Junaideen", "link": "https://stackoverflow.com/users/777880/ziyan-junaideen"}, "edited": false, "score": 0, "creation_date": 1508952467, "post_id": 46938187, "comment_id": 80824291, "body": "Can you update the question with the modal as well pls."}, {"owner": {"reputation": 1, "user_id": 8832958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9df062f977dd1ac494176f0e784de67?s=128&d=identicon&r=PG&f=1", "display_name": "vini91", "link": "https://stackoverflow.com/users/8832958/vini91"}, "reply_to_user": {"reputation": 2914, "user_id": 777880, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/gDijM.jpg?s=128&g=1", "display_name": "Ziyan Junaideen", "link": "https://stackoverflow.com/users/777880/ziyan-junaideen"}, "edited": false, "score": 0, "creation_date": 1508959619, "post_id": 46938187, "comment_id": 80828372, "body": "@Ziyan Junaideen what is modal?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8832958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9df062f977dd1ac494176f0e784de67?s=128&d=identicon&r=PG&f=1", "display_name": "vini91", "link": "https://stackoverflow.com/users/8832958/vini91"}, "edited": false, "score": 0, "creation_date": 1508959749, "post_id": 46938349, "comment_id": 80828445, "body": "The challenge&#39;s owner wouldn&#39;t like if changed the tests file."}], "tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1508951598, "creation_date": 1508951598, "answer_id": 46938349, "question_id": 46938187, "link": "https://stackoverflow.com/questions/46938187/rails-capybaraelementnotfound/46938349#46938349", "title": "Rails: Capybara::ElementNotFound", "body": "<p>You could do this, assuming your input has an id of <code>name</code>:</p>\n\n<pre><code>find(\"input[id$='name']\").set \"Vostro 2017\"\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>find(\"#name\").set \"Vostro 2017\"\n</code></pre>\n\n<p>You might also try lower-casing <code>Name</code>:</p>\n\n<pre><code>fill_in 'name', with: \"Vostro 2017\"\n</code></pre>\n\n<p>Capybara will target the name or the id attribute, so the second example should work.</p>\n"}, {"tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": false, "score": 0, "last_activity_date": 1508953221, "creation_date": 1508953221, "answer_id": 46938801, "question_id": 46938187, "link": "https://stackoverflow.com/questions/46938187/rails-capybaraelementnotfound/46938801#46938801", "title": "Rails: Capybara::ElementNotFound", "body": "<p>Rails generates form input names with using form object.</p>\n\n<pre><code>fill_in 'item[name]', with: \"Vostro 2017\"\nfill_in 'item[description]', with: 'Dell Notebook'\nfill_in 'item[features]', with: '16gb, 1Tb, 15.6\"'\nfill_in 'item[assetNumber]', with: '392 DLL'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8832958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9df062f977dd1ac494176f0e784de67?s=128&d=identicon&r=PG&f=1", "display_name": "vini91", "link": "https://stackoverflow.com/users/8832958/vini91"}, "edited": false, "score": 0, "creation_date": 1508959927, "post_id": 46940601, "comment_id": 80828525, "body": "Great tip. Thanks a lot."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1508959617, "creation_date": 1508959617, "answer_id": 46940601, "question_id": 46938187, "link": "https://stackoverflow.com/questions/46938187/rails-capybaraelementnotfound/46940601#46940601", "title": "Rails: Capybara::ElementNotFound", "body": "<p>If you look at the actual HTML of the page instead of the erb template (always better to include the HTML unless your question is specifically about the erb) you'll notice your labels aren't actually associated with the input elements (no matching <code>for</code> attribute to the id of the input).  Obviously for Capybara to find the element by label text ('Name' in your case) the label would have to be correctly associated with the element.  To fix that you need to use <code>f.label</code> - <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-label\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-label</a> - correctly. If you want to specify the text of the element (vs using text extracted from i18n translation) that would be </p>\n\n<pre><code>f.label :name, 'Name'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8832958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9df062f977dd1ac494176f0e784de67?s=128&d=identicon&r=PG&f=1", "display_name": "vini91", "link": "https://stackoverflow.com/users/8832958/vini91"}, "is_accepted": false, "score": 0, "last_activity_date": 1508959758, "creation_date": 1508959758, "answer_id": 46940641, "question_id": 46938187, "link": "https://stackoverflow.com/questions/46938187/rails-capybaraelementnotfound/46940641#46940641", "title": "Rails: Capybara::ElementNotFound", "body": "<p>I realized what I was doing wrong, so let's go:\nI changed the instance variable items inside def show action to item (not pluralized) and I changed an atribute from assetNumber to asset_number, so this way the Cabybara test could understand correctly.</p>\n\n<p>Thanks guys.</p>\n"}], "owner": {"reputation": 1, "user_id": 8832958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9df062f977dd1ac494176f0e784de67?s=128&d=identicon&r=PG&f=1", "display_name": "vini91", "link": "https://stackoverflow.com/users/8832958/vini91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1508959758, "creation_date": 1508951034, "last_edit_date": 1508953153, "question_id": 46938187, "link": "https://stackoverflow.com/questions/46938187/rails-capybaraelementnotfound", "title": "Rails: Capybara::ElementNotFound", "body": "<p>I'm trying to solve a challenge, but I received an error message from Cabybara saying: </p>\n\n<pre><code>`Failure/Error: fill_in 'Name', with: 'Vostro 2017'   \n     Capybara::ElementNotFound: Unable to find visible field \"Name\" that is not disabled`\n</code></pre>\n\n<p>My <code>new.html.erb</code> is:</p>\n\n<pre><code>&lt;%= form_for @item, url: {action: \"create\"} do |f|%&gt;\n  &lt;%= f.label 'Name' %&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;%= f.label 'Description' %&gt;\n  &lt;%= f.text_field :description %&gt;\n  &lt;%= f.label 'Features' %&gt;\n  &lt;%= f.text_field :features %&gt;\n  &lt;%= f.label 'Asset number' %&gt;\n  &lt;%= f.text_field :assetNumber %&gt;\n  &lt;%= f.submit%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And my <code>item_controller.rb</code> is: </p>\n\n<pre><code>class ItemController &lt; ApplicationController\n  def show\n    @items = Item.find(params[:id])\n  end\n  def new\n    @item = Item.new\n  end\n\n  def create\n    @item = Item.new(item_params)\n\n    @item.save\n    redirect_to @item\n  end\n\n  private\n  def item_params\n    params.require(:item).permit(:name, :description, :features, :assetNumber)\n  end\nend\n</code></pre>\n\n<p>The rspec file that is being used to do the test is:</p>\n\n<pre><code>require 'rails_helper'\n\nfeature 'User creates a new inventory item' do\n  scenario 'successfully' do\n    visit new_item_path\n    fill_in 'Name', with: 'Vostro 2017'\n    fill_in 'Description', with: 'Dell Notebook'\n    fill_in 'Features', with: '16gb, 1Tb, 15.6\"'\n    fill_in 'Asset number', with: '392 DLL'\n    click_button 'Create Item'\n\n    expect(page).to have_content 'Vostro 2017'\n    expect(page).to have_content 'Dell Notebook'\n    expect(page).to have_content '16gb, 1Tb, 15.6\"'\n    expect(page).to have_content '392 DLL'\n  end\nend\n</code></pre>\n\n<p>I'm using ruby-2.3.5 and rails 4.1.0.\nI'm beginner in ruby/rails and I can't figure out what's wrong with my code.\nCould somebody help me to solve that?\nI appreciate in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "callback"], "comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1508950836, "post_id": 46938063, "comment_id": 80823352, "body": "Please post the code in your <code>set_initial_counts</code> method"}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 1, "creation_date": 1508950910, "post_id": 46938063, "comment_id": 80823394, "body": "Why not just use <code>after_create</code>?"}, {"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1508951082, "post_id": 46938063, "comment_id": 80823490, "body": "Guide clearly says that <code>after_save</code> will be triggered both after create and update. Read the texts with Red background after the section <code>3.3</code> in your mentioned link."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508953554, "post_id": 46938063, "comment_id": 80824898, "body": "What is the method supposed to do? It soundslike something that should be done with column defaults or counter caches."}, {"owner": {"reputation": 29, "user_id": 8359939, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1f7a517f53570700ffe971582107a411?s=128&d=identicon&r=PG&f=1", "display_name": "RFlaum", "link": "https://stackoverflow.com/users/8359939/rflaum"}, "edited": false, "score": 0, "creation_date": 1508954286, "post_id": 46938063, "comment_id": 80825325, "body": "I&#39;ve updated the original post to answer the first three comments. I didn&#39;t see max&#39;s comment, so I&#39;ll answer it here: you&#39;re correct that it should be done with a counter cache. However, at the time I started doing this, I wasn&#39;t aware that Rails had an automatic counter cache feature, so I wrote my own, and changing it now would require changing a lot of code, and isn&#39;t worth it."}], "answers": [{"tags": [], "owner": {"reputation": 1285, "user_id": 3491275, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/571855393/picture?type=large", "display_name": "oowowaee", "link": "https://stackoverflow.com/users/3491275/oowowaee"}, "is_accepted": false, "score": 0, "last_activity_date": 1508958239, "creation_date": 1508958239, "answer_id": 46940210, "question_id": 46938063, "link": "https://stackoverflow.com/questions/46938063/rails-model-callbacks-triggered-on-wrong-events/46940210#46940210", "title": "Rails model callbacks triggered on wrong events", "body": "<p>See <a href=\"https://github.com/rails/rails/issues/12502\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<p>The answer is basically that on is not an option to after_save, if you wanted to use the on create option, you'd just use after_create.</p>\n"}], "owner": {"reputation": 29, "user_id": 8359939, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1f7a517f53570700ffe971582107a411?s=128&d=identicon&r=PG&f=1", "display_name": "RFlaum", "link": "https://stackoverflow.com/users/8359939/rflaum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508958239, "creation_date": 1508950598, "last_edit_date": 1508954091, "question_id": 46938063, "link": "https://stackoverflow.com/questions/46938063/rails-model-callbacks-triggered-on-wrong-events", "title": "Rails model callbacks triggered on wrong events", "body": "<p>I have a model with the following callback registration:</p>\n\n<pre><code>after_save :set_initial_counts, on: :create\n</code></pre>\n\n<p>The <a href=\"http://guides.rubyonrails.org/active_record_callbacks.html\" rel=\"nofollow noreferrer\">guide</a> seems to say that the set_initial_counts method will be called after saving during the create chain, but not when saving during update. I have found, however, that it gets called after <em>every</em> save. How do I get it to only be called during create? (I considered the possibility that it was creating a new model that I hadn't intended for some reason, so I tried registering a test method to after_create. As you would expect, that doesn't get called.)</p>\n\n<p>Updates to answer a few questions:\nFirst, here is the text of set_initial_counts:</p>\n\n<pre><code>def set_initial_counts\n  [tags, sources, characters].each do |coll|\n    coll.each do |obj|\n      obj.increment!(:stories_count)\n    end\n  end\nend\n</code></pre>\n\n<p>The purpose of this is to manage a counter cache. The story object has_and_belongs_to_many tags, sources, and characters. Each of these has a stories_count column to store how many stories it's associated with.</p>\n\n<p>Second: someone wanted to know why I'm not using after_create instead of after_save. In practice, I probably could use after_create, but I'd like to know why this isn't working, because the fact that it isn't working means that my understanding of callbacks is flawed, which could cause me to make more bugs in the future.</p>\n\n<p>Thirdly: I'm aware that after_save is triggered during update. However, the third code block in <a href=\"http://guides.rubyonrails.org/active_record_callbacks.html#callback-registration\" rel=\"nofollow noreferrer\">Section 2.1</a> indicates that I can use on: :create to ensure that set_initial_counts only gets called during create.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "edited": false, "score": 0, "creation_date": 1508960840, "post_id": 46937402, "comment_id": 80829013, "body": "You&#39;ll probably end up doing this with a SQL sub-query. I suggest you start looking there for an answer."}, {"owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "edited": false, "score": 0, "creation_date": 1508964646, "post_id": 46937402, "comment_id": 80830914, "body": "When you say <code>intersection</code>, do you mean exact equality of time and day? Or do you want to get even partial overlapping of time?"}, {"owner": {"reputation": 31, "user_id": 8093919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a42253f04805456baffc1339cb82fecf?s=128&d=identicon&r=PG&f=1", "display_name": "user8093919", "link": "https://stackoverflow.com/users/8093919/user8093919"}, "reply_to_user": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "edited": false, "score": 0, "creation_date": 1508965722, "post_id": 46937402, "comment_id": 80831527, "body": "@StanislavMekhonoshin I simply mean, exact equality. i.e.   (ta1.day == ta2.day) &amp;&amp; (ta1.start_time == ta2.start_time) &amp;&amp; (ta1.end_time == ta3.end_time)"}], "answers": [{"tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": false, "score": 0, "last_activity_date": 1508966285, "creation_date": 1508966285, "answer_id": 46942213, "question_id": 46937402, "link": "https://stackoverflow.com/questions/46937402/ruby-intersection-of-two-collections-which-are-attributes-of-two-different-ob/46942213#46942213", "title": "Ruby - Intersection of two collections, which are attributes of two different objects", "body": "<p>I believe you can do:</p>\n\n<pre><code>intersections = client_instance1.meeting_times.reduce([]) do |result, client_meeting|\n  intersects = provider_instance1.meeting_times.any? { |provider_meeting| provider_meeting.day == client_meeting.day &amp;&amp; provider_meeting.start_time == client_meeting.start_time &amp;&amp; provider_meeting.end_time == client_meeting.end_time }\n  result &lt;&lt; obj if intersects\n  result\nend\n</code></pre>\n\n<p>But following this approach, keep in mind, it'll return only <code>client_instance1</code> meetings, which have equivalent date/time in <code>provider_instance1</code> meetings.</p>\n\n<p>The smarter approach - is to build a hash, where the keys will be a checksum of string like: <code>\"#{day}#{start_time}#{end_time}\"</code>.\nAnd values - are arrays of equal meetings, both from client and providers meetings.</p>\n"}], "owner": {"reputation": 31, "user_id": 8093919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a42253f04805456baffc1339cb82fecf?s=128&d=identicon&r=PG&f=1", "display_name": "user8093919", "link": "https://stackoverflow.com/users/8093919/user8093919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1508966285, "creation_date": 1508948233, "question_id": 46937402, "link": "https://stackoverflow.com/questions/46937402/ruby-intersection-of-two-collections-which-are-attributes-of-two-different-ob", "title": "Ruby - Intersection of two collections, which are attributes of two different objects", "body": "<p>I have 3 classes defined as:</p>\n\n<p>Client</p>\n\n<pre><code>class Client &lt; ActiveRecord::Base\n  belongs_to :provider\n  has_many :meeting_times\nend\n</code></pre>\n\n<p>Provider </p>\n\n<pre><code>class Provider &lt; ActiveRecord::Base\n  has_many :clients\n  has_many :meeting_times\nend\n</code></pre>\n\n<p>MeetingTime</p>\n\n<pre><code>class MeetingTime &lt; ActiveRecord::Base\n  belongs_to :meetingable, polymorphic: true\nend\n</code></pre>\n\n<p>Each instance of MeetingTime has a day, start_time and end_time.\nIs there a way for me to efficiently compute the intersection of</p>\n\n<pre><code>client_instance1.meeting_times and provider_instance1.meeting_times\n</code></pre>\n\n<p>In my seed file, I create meeting_times for clients and providers as follows</p>\n\n<pre><code>client_instance1.meeting_times.build(:day =&gt; \"Friday\", :start_time =&gt; time1, :end_time =&gt; time2)\nclient_instance1.meeting_times.build(:day =&gt; \"Saturday\", :start_time =&gt; time3, :end_time =&gt; time4)\nclient_instance1.save!\n</code></pre>\n\n<p>Currently when I try </p>\n\n<pre><code>client_instance1.meeting_times &amp; provider_instance1.meeting_times\n</code></pre>\n\n<p>after developing the client and provider instances in a seed file, I get an empty set because the ids of different meeting times don't match (even if the day, start_time and end_time are the same). \nHow could I resolve this issue? Am I misunderstanding something?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "foreman", "webpacker", "theforeman"], "comments": [{"owner": {"reputation": 2607, "user_id": 4470392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvLjT.jpg?s=128&g=1", "display_name": "Maxim Pontyushenko", "link": "https://stackoverflow.com/users/4470392/maxim-pontyushenko"}, "edited": false, "score": 0, "creation_date": 1508952155, "post_id": 46936735, "comment_id": 80824091, "body": "Can you attach your Profile?"}, {"owner": {"reputation": 367, "user_id": 1743452, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b24be693471aabcc9ca974b5912c9624?s=128&d=identicon&r=PG", "display_name": "Hirohito Yamada", "link": "https://stackoverflow.com/users/1743452/hirohito-yamada"}, "reply_to_user": {"reputation": 2607, "user_id": 4470392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvLjT.jpg?s=128&g=1", "display_name": "Maxim Pontyushenko", "link": "https://stackoverflow.com/users/4470392/maxim-pontyushenko"}, "edited": false, "score": 0, "creation_date": 1508953001, "post_id": 46936735, "comment_id": 80824593, "body": "@MaximPontyushenko bash_profile???"}, {"owner": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "edited": false, "score": 1, "creation_date": 1508957360, "post_id": 46936735, "comment_id": 80827063, "body": "Procfile and Gemfile please"}, {"owner": {"reputation": 367, "user_id": 1743452, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b24be693471aabcc9ca974b5912c9624?s=128&d=identicon&r=PG", "display_name": "Hirohito Yamada", "link": "https://stackoverflow.com/users/1743452/hirohito-yamada"}, "reply_to_user": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "edited": false, "score": 0, "creation_date": 1509007199, "post_id": 46936735, "comment_id": 80846256, "body": "@phoet info added! Please take a look!"}, {"owner": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "edited": false, "score": 0, "creation_date": 1509023156, "post_id": 46936735, "comment_id": 80857376, "body": "could you try to run passenger directly without foreman and check if there is an error in any file in the logs directory?"}, {"owner": {"reputation": 367, "user_id": 1743452, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b24be693471aabcc9ca974b5912c9624?s=128&d=identicon&r=PG", "display_name": "Hirohito Yamada", "link": "https://stackoverflow.com/users/1743452/hirohito-yamada"}, "edited": false, "score": 0, "creation_date": 1509076594, "post_id": 46936735, "comment_id": 80881845, "body": "passenger itself runs fine...."}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 1787057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37c2783c540cc3bb9c07305a56ad81d8?s=128&d=identicon&r=PG", "display_name": "ishe_ua", "link": "https://stackoverflow.com/users/1787057/ishe-ua"}, "is_accepted": false, "score": 0, "last_activity_date": 1508957093, "creation_date": 1508957093, "answer_id": 46939913, "question_id": 46936735, "link": "https://stackoverflow.com/questions/46936735/foreman-start-not-working-right-on-rails-app/46939913#46939913", "title": "Foreman start not working right on rails app", "body": "<p>You have problem with Passenger. Try to run only it in development mode and after that in production. You should see error on log output.</p>\n\n<p>It is a most common approach for debugging foreman.</p>\n"}, {"comments": [{"owner": {"reputation": 367, "user_id": 1743452, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b24be693471aabcc9ca974b5912c9624?s=128&d=identicon&r=PG", "display_name": "Hirohito Yamada", "link": "https://stackoverflow.com/users/1743452/hirohito-yamada"}, "edited": false, "score": 0, "creation_date": 1509006214, "post_id": 46940398, "comment_id": 80845641, "body": "Thanks! I tried your advise but still not working.. added my assumption above, please let me know what you think! Thanks!"}], "tags": [], "owner": {"reputation": 3171, "user_id": 2610043, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jIN0G.jpg?s=128&g=1", "display_name": "hedgesky", "link": "https://stackoverflow.com/users/2610043/hedgesky"}, "is_accepted": false, "score": 0, "last_activity_date": 1508958867, "creation_date": 1508958867, "answer_id": 46940398, "question_id": 46936735, "link": "https://stackoverflow.com/questions/46936735/foreman-start-not-working-right-on-rails-app/46940398#46940398", "title": "Foreman start not working right on rails app", "body": "<p>Try to add <code>gem 'passenger'</code> to your Gemfile and run <code>bundle</code>. The issue might be that you installed passenger via <code>gem install passenger</code> and bundler doesn't load it. </p>\n"}], "owner": {"reputation": 367, "user_id": 1743452, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b24be693471aabcc9ca974b5912c9624?s=128&d=identicon&r=PG", "display_name": "Hirohito Yamada", "link": "https://stackoverflow.com/users/1743452/hirohito-yamada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1389, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1509076921, "creation_date": 1508946261, "last_edit_date": 1509076921, "question_id": 46936735, "link": "https://stackoverflow.com/questions/46936735/foreman-start-not-working-right-on-rails-app", "title": "Foreman start not working right on rails app", "body": "<p>I'm trying to run foreman start on my app.</p>\n\n<p>but it gives me an error saying</p>\n\n<pre><code>12:53:39 web.1     | started with pid 7647\n12:53:39 rails.1   | started with pid 7648\n12:53:39 webpack.1 | started with pid 7649\n12:53:39 web.1     |  [passenger_native_support.bundle] trying to compile for the current user (hiro_yamada) and Ruby interpreter...\n12:53:39 web.1     |      (set PASSENGER_COMPILE_NATIVE_SUPPORT_BINARY=0 to disable)\n12:53:40 webpack.1 | /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/bundler/gems/webpacker-78b2dd910603/lib/webpacker/dev_server_runner.rb:47:in `exec': No such file or directory - /Users/hiro_yamada/Dropbox/foriio/node_modules/.bin/webpack-dev-server (Errno::ENOENT)\n12:53:40 webpack.1 |    from /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/bundler/gems/webpacker-78b2dd910603/lib/webpacker/dev_server_runner.rb:47:in `block in execute_cmd'\n12:53:40 webpack.1 |    from /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/bundler/gems/webpacker-78b2dd910603/lib/webpacker/dev_server_runner.rb:46:in `chdir'\n12:53:40 webpack.1 |    from /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/bundler/gems/webpacker-78b2dd910603/lib/webpacker/dev_server_runner.rb:46:in `execute_cmd'\n12:53:40 webpack.1 |    from /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/bundler/gems/webpacker-78b2dd910603/lib/webpacker/dev_server_runner.rb:11:in `run'\n12:53:40 webpack.1 |    from /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/bundler/gems/webpacker-78b2dd910603/lib/webpacker/runner.rb:6:in `run'\n12:53:40 webpack.1 |    from /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/bundler/gems/webpacker-78b2dd910603/exe/webpack-dev-server:8:in `&lt;top (required)&gt;'\n12:53:40 webpack.1 |    from bin/webpack-dev-server:17:in `load'\n12:53:40 webpack.1 |    from bin/webpack-dev-server:17:in `&lt;main&gt;'\n12:53:40 webpack.1 | exited with code 1\n12:53:40 system    | sending SIGTERM to all processes\n12:53:40 web.1     | bundler: failed to load command: passenger (/Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/bin/passenger)\n12:53:40 web.1     | SignalException: SIGTERM\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:310:in `system'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:310:in `sh_nonfatal'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:337:in `block (3 levels) in compile'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:335:in `chdir'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:335:in `block (2 levels) in compile'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/utils/tmpio.rb:70:in `mktmpdir'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:334:in `block in compile'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:378:in `block (2 levels) in try_directories'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:377:in `chdir'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:377:in `block in try_directories'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:371:in `each'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:371:in `each_with_index'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:371:in `try_directories'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:329:in `compile'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:219:in `compile_and_load'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:52:in `start'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/native_support.rb:439:in `&lt;top (required)&gt;'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger.rb:240:in `require'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger.rb:240:in `require_passenger_lib'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/utils/file_system_watcher.rb:25:in `&lt;top (required)&gt;'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger.rb:240:in `require'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger.rb:240:in `require_passenger_lib'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/standalone/app_finder.rb:27:in `&lt;top (required)&gt;'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger.rb:240:in `require'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger.rb:240:in `require_passenger_lib'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/standalone/start_command.rb:288:in `find_apps'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/standalone/start_command.rb:59:in `run'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/src/ruby_supportlib/phusion_passenger/standalone/main.rb:51:in `run!'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/gems/passenger-5.1.8/bin/passenger:45:in `&lt;top (required)&gt;'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/bin/passenger:23:in `load'\n12:53:40 web.1     |   /Users/hiro_yamada/Dropbox/foriio/vendor/bundle/ruby/2.2.0/bin/passenger:23:in `&lt;top (required)&gt;'\n12:53:40 rails.1   | terminated by SIGTERM\n12:53:40 web.1     | exited with code 1\n</code></pre>\n\n<p>How could I fix this issue...?\nThank you for you time.</p>\n\n<hr>\n\n<p>So I tried adding passenger on gemfile and bundling... Still not working.\nand I noticed one thing, when I changed my ruby version to 2.2.0 sinc passenger was under a directory ruby/2.2.0/. Then error was returned saying foreman only can run on 2.2.3. Maybe passenger gem I installed is not compatible with ruby 2.2.3??</p>\n\n<p>My procfile and gemfile is</p>\n\n<pre><code>web: bundle exec passenger start -p $PORT --max-pool-size 6\nrails: PORT=3000 rails s\nwebpack: bin/webpack-dev-server\n\nsource 'https://rubygems.org'\nruby \"2.2.3\"\n\ngem 'rails', '~&gt; 5.1.1'\ngem 'uglifier', '&gt;= 1.3.0'\ngem 'jbuilder', '~&gt; 2.0'\ngem 'sdoc', '~&gt; 0.4.0',          group: :doc\ngem 'spring',        group: :development\ngem 'passenger'\ngem 'paperclip', '4.3.6'\ngem 'rmagick'\ngem 'aws-sdk', '&lt; 2.0'\ngem 'newrelic_rpm'\ngem 'friendly_id', '~&gt; 5.1.0'\ngem 'ruby-oembed'\ngem 'impressionist'\ngem 'meta-tags'\ngem 'capybara'\ngem 'poltergeist'\ngem 'webpacker', github: 'rails/webpacker'\n\n# Client\ngem 'slim-rails'\ngem 'sass-rails'\ngem 'coffee-rails'\ngem 'jquery-rails'\ngem 'jquery-ui-rails'\ngem 'turbolinks'\ngem 'aasm'\ngem 'siteinfo_parser'\ngem 'open_uri_redirections'\n\n# Exception Notification to Slack\ngem 'exception_notification', :github =&gt; 'smartinez87/exception_notification'\ngem 'slack-notifier'\n\n# login\ngem 'devise'\n\n# Oauth\ngem 'omniauth'\ngem 'omniauth-facebook'\ngem 'omniauth-twitter'\ngem 'omniauth-instagram'\n\n# Auth\ngem 'cancancan', '~&gt; 1.10'\n\n# SNS API\ngem 'koala'\ngem 'twitter'\ngem 'instagram'\n\n# manage constant file\ngem 'config'\n\n# Use ActiveModel has_secure_password\ngem 'bcrypt', '~&gt; 3.1.7'\n\n# Pagination\ngem 'kaminari'\n\n# Auto-link\ngem 'rails_autolink'\n\n#font-awesome\ngem 'font-awesome-sass'\n\n# follow, like, mention\ngem 'socialization'\n\n# Copy to clipboard\ngem 'zeroclipboard-rails'\n\ngroup :development, :test do\n  gem 'better_errors'\n  gem 'binding_of_caller'\n  gem 'foreman'\n  gem 'pry-rails'\n  gem 'pry-byebug'\n  gem 'pry-doc'\n  gem 'pry-stack_explorer'\nend\n\ngroup :development do\n  gem 'pg'\nend\n\ngroup :test do\n  gem 'sqlite3'\nend\n\ngroup :production do\n  gem 'pg'\n  gem 'rails_12factor'\nend\n</code></pre>\n"}, {"tags": ["ruby", "algorithm", "sorting", "variables"], "comments": [{"owner": {"reputation": 399, "user_id": 1998931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bc6bbd9b85f9ed97574bc4b834ab2f?s=128&d=identicon&r=PG", "display_name": "Carlos Roque", "link": "https://stackoverflow.com/users/1998931/carlos-roque"}, "edited": false, "score": 0, "creation_date": 1508946373, "post_id": 46936471, "comment_id": 80820729, "body": "can you please explain your expected result better? I fail to understand your problem"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 7175012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Nf17.png?s=128&g=1", "display_name": "spuyet", "link": "https://stackoverflow.com/users/7175012/spuyet"}, "is_accepted": true, "score": 0, "last_activity_date": 1508945864, "creation_date": 1508945864, "answer_id": 46936602, "question_id": 46936471, "link": "https://stackoverflow.com/questions/46936471/ruby-algorithm-insertion-sort/46936602#46936602", "title": "Ruby. Algorithm insertion sort", "body": "<p>Just clone your array to keep you first array as before:</p>\n\n<pre><code>def  insertionsort(num)\n  res = num.dup\n  for j in 1..(res.length - 1)\n    key = res[j]\n    i = j - 1\n    while i &gt;= 0 and res[i] &gt; key\n      res[i+1] = res[i]\n      i = i - 1\n    end\n    res[i+1] = key\n end\n res\nend\n\nar = Array.new(10) { rand(1...11) }\nres = insertionsort(ar)\np ar\np res\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7621673, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-n0Wwjk7rACA/AAAAAAAAAAI/AAAAAAAAAC8/PzEnsx2ZHgw/photo.jpg?sz=128", "display_name": "Den", "link": "https://stackoverflow.com/users/7621673/den"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "closed_date": 1508970449, "accepted_answer_id": 46936602, "answer_count": 1, "score": -1, "last_activity_date": 1508945864, "creation_date": 1508945470, "question_id": 46936471, "link": "https://stackoverflow.com/questions/46936471/ruby-algorithm-insertion-sort", "closed_reason": "Needs details or clarity", "title": "Ruby. Algorithm insertion sort", "body": "<p>Sorry maybe a simple question but I can not figure it out. I have a program that sorts an array:</p>\n\n<pre><code>def  insertionsort(num)\n  for j in 1..(num.length - 1)\n      key = num[j]\n      i = j - 1\n      while i &gt;= 0 and num[i] &gt; key\n          num[i+1] = num[i]\n          i = i - 1\n      end\n      num[i+1] = key\n  end\nend\n\nar = Array.new(10) { rand(1...11) }\n\ninsertionsort(ar)\ninsertionsort(ar)\ninsertionsort(ar)\ninsertionsort(ar)\ninsertionsort(ar)\n\np ar\n</code></pre>\n\n<p>But after the first sort insertionsort(ar) i must to use the same array, but after the first sort variable ar take sorted array</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 2, "creation_date": 1508946042, "post_id": 46936528, "comment_id": 80820500, "body": "If you pass a Hash containing non-Symbol keys, your method will blow up with an <code>ArgumentError</code> instead of passing the Hash to <code>b</code>. This is because keyword arguments always have to be given with Symbol keys."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1508946290, "post_id": 46936528, "comment_id": 80820670, "body": "@HolgerJust true, so what?"}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1508953573, "post_id": 46936528, "comment_id": 80824910, "body": "With that, I just wanted to say that your solution doesn&#39;t completely fulfil the desired interface for all arguments. With respect to the tradeoffs involved, it is a good solution though. In any case, if OP only passes Hashes containing non-Symbol keys to <code>b</code>, his method definition will work directly."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1508945610, "creation_date": 1508945610, "answer_id": 46936528, "question_id": 46936313, "link": "https://stackoverflow.com/questions/46936313/methods-with-optional-and-keyword-arguments/46936528#46936528", "title": "Methods with optional and keyword arguments", "body": "<p>If you want this exact signature, you should probably use double-splat for <code>b</code> parameter:</p>\n\n<pre><code>def test(a, c: 1, **b)\n  [a, b, c]\nend\ntest 1, {hello: :world}\n#\u21d2\u00a0[1, {hello: :word}, 1]\n</code></pre>\n\n<p>There are issues distinguishing named keyword parameters and the hash itself when the latter is passed immediately before named keywords.</p>\n"}], "owner": {"reputation": 6268, "user_id": 503831, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/992c174c48fa4dadacb03854dbf7ade8?s=128&d=identicon&r=PG", "display_name": "Arnold Roa", "link": "https://stackoverflow.com/users/503831/arnold-roa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 46936528, "answer_count": 1, "score": 0, "last_activity_date": 1508945610, "creation_date": 1508945041, "question_id": 46936313, "link": "https://stackoverflow.com/questions/46936313/methods-with-optional-and-keyword-arguments", "title": "Methods with optional and keyword arguments", "body": "<pre><code>def test(a, b = {}, c: 1)\n  [a, b, c]\nend\n\ntest 1, {hello: :world}\n</code></pre>\n\n<p>I would expect the output of this to be:</p>\n\n<pre><code>[1, {hello: :word}, 1]\n</code></pre>\n\n<p>But instead I got:</p>\n\n<pre><code>ArgumentError: unknown keyword: hello\n</code></pre>\n\n<p>I've read some pages like <a href=\"https://makandracards.com/makandra/36011-ruby-do-not-mix-optional-and-keyword-arguments\" rel=\"nofollow noreferrer\">https://makandracards.com/makandra/36011-ruby-do-not-mix-optional-and-keyword-arguments</a></p>\n\n<p>that suggest to dont mix with optional arguments a keywords argument.</p>\n\n<p>Is possible to make this work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1508944071, "post_id": 46935846, "comment_id": 80819019, "body": "Have you defined any validation in the model being used?"}, {"owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1508944290, "post_id": 46935846, "comment_id": 80819189, "body": "Inline with that @Sebasti&#225;nPalma is asking, can you post any relative model files."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508944369, "post_id": 46935846, "comment_id": 80819245, "body": "Where do you save the new <code>@order_item</code>?"}, {"owner": {"reputation": 443, "user_id": 7161061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58ec49d163553d91e7f717623216f926?s=128&d=identicon&r=PG&f=1", "display_name": "jmike", "link": "https://stackoverflow.com/users/7161061/jmike"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1508944618, "post_id": 46935846, "comment_id": 80819427, "body": "@Sebasti&#225;nPalma there my model for devise i assigned user model to order, and order model to user"}, {"owner": {"reputation": 443, "user_id": 7161061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58ec49d163553d91e7f717623216f926?s=128&d=identicon&r=PG&f=1", "display_name": "jmike", "link": "https://stackoverflow.com/users/7161061/jmike"}, "reply_to_user": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "edited": false, "score": 0, "creation_date": 1508945985, "post_id": 46935846, "comment_id": 80820454, "body": "@ddubs can you look at models"}, {"owner": {"reputation": 443, "user_id": 7161061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58ec49d163553d91e7f717623216f926?s=128&d=identicon&r=PG&f=1", "display_name": "jmike", "link": "https://stackoverflow.com/users/7161061/jmike"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508946049, "post_id": 46935846, "comment_id": 80820502, "body": "@jvillian i think it has something to do with my models user"}, {"owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "edited": false, "score": 0, "creation_date": 1508948211, "post_id": 46935846, "comment_id": 80821936, "body": "In your schema there is no index on orders for user_id, make sure your migration on orders uses <code>t.references :user, foreign_key: true</code>"}], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 1998931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bc6bbd9b85f9ed97574bc4b834ab2f?s=128&d=identicon&r=PG", "display_name": "Carlos Roque", "link": "https://stackoverflow.com/users/1998931/carlos-roque"}, "edited": false, "score": 0, "creation_date": 1508944749, "post_id": 46936144, "comment_id": 80819525, "body": "Also, you are doing a lot of things differently from &quot;The Rails Way&quot; maybe next time you want to generate your models, views, controllers using the scaffold command"}, {"owner": {"reputation": 443, "user_id": 7161061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58ec49d163553d91e7f717623216f926?s=128&d=identicon&r=PG&f=1", "display_name": "jmike", "link": "https://stackoverflow.com/users/7161061/jmike"}, "edited": false, "score": 0, "creation_date": 1508945047, "post_id": 46936144, "comment_id": 80819770, "body": "thanks also my model user.rb model should be associated with orders right cause i click add to cart when i am signed in but nothing happens the order doesn&#39;t add to cart wondering are my association with my user model correct. @CarlosRoque"}, {"owner": {"reputation": 399, "user_id": 1998931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bc6bbd9b85f9ed97574bc4b834ab2f?s=128&d=identicon&r=PG", "display_name": "Carlos Roque", "link": "https://stackoverflow.com/users/1998931/carlos-roque"}, "reply_to_user": {"reputation": 443, "user_id": 7161061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58ec49d163553d91e7f717623216f926?s=128&d=identicon&r=PG&f=1", "display_name": "jmike", "link": "https://stackoverflow.com/users/7161061/jmike"}, "edited": false, "score": 0, "creation_date": 1508945940, "post_id": 46936144, "comment_id": 80820418, "body": "your associations look fine, is that after making the change I suggested?"}, {"owner": {"reputation": 443, "user_id": 7161061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58ec49d163553d91e7f717623216f926?s=128&d=identicon&r=PG&f=1", "display_name": "jmike", "link": "https://stackoverflow.com/users/7161061/jmike"}, "edited": false, "score": 0, "creation_date": 1508946226, "post_id": 46936144, "comment_id": 80820629, "body": "i just posted after the change what my rails server is saying @CarlosRoque"}, {"owner": {"reputation": 399, "user_id": 1998931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bc6bbd9b85f9ed97574bc4b834ab2f?s=128&d=identicon&r=PG", "display_name": "Carlos Roque", "link": "https://stackoverflow.com/users/1998931/carlos-roque"}, "reply_to_user": {"reputation": 443, "user_id": 7161061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58ec49d163553d91e7f717623216f926?s=128&d=identicon&r=PG&f=1", "display_name": "jmike", "link": "https://stackoverflow.com/users/7161061/jmike"}, "edited": false, "score": 0, "creation_date": 1508946683, "post_id": 46936144, "comment_id": 80820937, "body": "lets recap. You changed new to create in the :create action. there is now more activity in your logs. you are still unable to see the order items?"}, {"owner": {"reputation": 443, "user_id": 7161061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58ec49d163553d91e7f717623216f926?s=128&d=identicon&r=PG&f=1", "display_name": "jmike", "link": "https://stackoverflow.com/users/7161061/jmike"}, "edited": false, "score": 0, "creation_date": 1508947065, "post_id": 46936144, "comment_id": 80821204, "body": "yah i am unable to see my order items when i click add to cart. When i click add to cart nothing happens and there nothing added to the cart i was thinking  it had something do do with the user not registering a orderitem @CarlosRoque"}, {"owner": {"reputation": 399, "user_id": 1998931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bc6bbd9b85f9ed97574bc4b834ab2f?s=128&d=identicon&r=PG", "display_name": "Carlos Roque", "link": "https://stackoverflow.com/users/1998931/carlos-roque"}, "reply_to_user": {"reputation": 443, "user_id": 7161061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58ec49d163553d91e7f717623216f926?s=128&d=identicon&r=PG&f=1", "display_name": "jmike", "link": "https://stackoverflow.com/users/7161061/jmike"}, "edited": false, "score": 0, "creation_date": 1508947240, "post_id": 46936144, "comment_id": 80821317, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/157500/discussion-between-carlos-roque-and-jmike\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 399, "user_id": 1998931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bc6bbd9b85f9ed97574bc4b834ab2f?s=128&d=identicon&r=PG", "display_name": "Carlos Roque", "link": "https://stackoverflow.com/users/1998931/carlos-roque"}, "is_accepted": false, "score": 0, "last_activity_date": 1508944588, "creation_date": 1508944588, "answer_id": 46936144, "question_id": 46935846, "link": "https://stackoverflow.com/questions/46935846/rails-server-saying-rollback-transcation-when-clicking-add-to-cart/46936144#46936144", "title": "Rails server saying rollback transcation when clicking add to cart", "body": "<pre><code>@order_item = @order.order_items.new(order_item_params)\n</code></pre>\n\n<p>is creating an item only in memory. there is nothing wrong with that.but i think you need to change the new to create as so</p>\n\n<pre><code>@order_item = @order.order_items.create(order_item_params)\n</code></pre>\n"}], "owner": {"reputation": 443, "user_id": 7161061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58ec49d163553d91e7f717623216f926?s=128&d=identicon&r=PG&f=1", "display_name": "jmike", "link": "https://stackoverflow.com/users/7161061/jmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508946163, "creation_date": 1508943767, "last_edit_date": 1508946163, "question_id": 46935846, "link": "https://stackoverflow.com/questions/46935846/rails-server-saying-rollback-transcation-when-clicking-add-to-cart", "title": "Rails server saying rollback transcation when clicking add to cart", "body": "<p>Just started learning ruby on rails, and i created a simple shopping cart application but when i click \"add to cart\", i get a rollback transaction from my server. I believe the error has something to do with my  orderitem controller but not sure how to fix this issue here my code.</p>\n\n<hr>\n\n<p>rails server</p>\n\n<pre><code>Started POST \"/order_items\" for 127.0.0.1 at 2017-10-25 10:47:44 -0400\nProcessing by OrderItemsController#create as JS\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"order_item\"=&gt;{\"product_id\"=&gt;\"13\", \"quantity\"=&gt;\"1\"}, \"commit\"=&gt;\"Add to cart\"}\n   (0.0ms)  begin transaction\n  Product Load (0.5ms)  SELECT  \"products\".* FROM \"products\" WHERE \"products\".\"id\" = ? LIMIT ?  [[\"id\", 13], [\"LIMIT\", 1]]\n   (0.0ms)  rollback transaction\n  Rendering order_items/create.js.erb\n  Rendered order_items/create.js.erb (0.5ms)\nCompleted 200 OK in 1028ms (Views: 605.5ms | ActiveRecord: 0.5ms)\n</code></pre>\n\n<hr>\n\n<p>order_items_controller.rb</p>\n\n<pre><code>class OrderItemsController &lt; ApplicationController\n\n    def create\n        @order = current_order\n        @order_item = @order.order_items.new(order_item_params)\n        @order.save\n        session[:order_id] = @order.id\n    end\n\n    def update\n        @order = current_order\n        @order_item = @order.order_items.new(order_item_params)\n        @order_item.update_attributes(order_item_params)\n        @order_items = @order.order_items\n    end\n\n    def destroy\n        @order = current_order\n        @order_item = @order.order_items.find(params[:id])\n        @order_item.destroy\n        @order_items = @order.order_items\n    end\n\n\n    private\n\n    def order_item_params\n        params.require(:order_item).permit(:product_id, :quantity)\n    end\n\nend\n</code></pre>\n\n<hr>\n\n<p>create.js.erb</p>\n\n<pre><code>&lt;% if @order.errors.any? || @order_item.errors.any? %&gt;\n    alert(\"Invalid\")\n&lt;% else %&gt;\n    $(\".cart\").html(\"&lt;%= escape_javascript(render 'layouts/cart') %&gt;\")\n&lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<p>schema.rb</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 20171019015705) do\n\n  create_table \"order_items\", force: :cascade do |t|\n    t.integer  \"product_id\"\n    t.integer  \"order_id\"\n    t.integer  \"quantity\"\n    t.float    \"total_price\"\n    t.float    \"unit_price\"\n    t.datetime \"created_at\",  null: false\n    t.datetime \"updated_at\",  null: false\n  end\n\n  create_table \"orders\", force: :cascade do |t|\n    t.float    \"subtotal\"\n    t.float    \"total\"\n    t.float    \"shipping\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.integer  \"user_id\"\n  end\n\n  create_table \"products\", force: :cascade do |t|\n    t.string   \"name\"\n    t.datetime \"created_at\",  null: false\n    t.datetime \"updated_at\",  null: false\n    t.float    \"price\"\n    t.text     \"description\"\n    t.string   \"picture\"\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.string   \"email\",                  default: \"\", null: false\n    t.string   \"encrypted_password\",     default: \"\", null: false\n    t.string   \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.integer  \"sign_in_count\",          default: 0,  null: false\n    t.datetime \"current_sign_in_at\"\n    t.datetime \"last_sign_in_at\"\n    t.string   \"current_sign_in_ip\"\n    t.string   \"last_sign_in_ip\"\n    t.string   \"username\"\n    t.datetime \"created_at\",                          null: false\n    t.datetime \"updated_at\",                          null: false\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n    t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n  end\n\nend\n</code></pre>\n\n<hr>\n\n<p>orderItem.rb</p>\n\n<pre><code>class OrderItem &lt; ApplicationRecord\n    belongs_to :order\n    belongs_to :product\n\n    before_save :set_unit_price\n    before_save :set_total_price\n\n    def unit_price\n        if persisted?\n            self[:unit_price]\n        else\n            product.price\n        end\n    end\n\n    def total_price\n        unit_price * quantity\n    end\n\n    private\n\n    def set_unit_price\n        self[:unit_price] = unit_price\n    end\n\n    def set_total_price\n        self[:total_price] = quantity * set_unit_price\n    end\n\n\nend\n</code></pre>\n\n<hr>\n\n<p>order.rb</p>\n\n<pre><code>class Order &lt; ApplicationRecord\n    has_many :order_items\n    belongs_to :user\n    before_save :set_subtotal\n\n\n    def subtotal\n        order_items.collect {|order_item| order_item.valid? ? (order_item.unit_price*order_item.quantity) : 0}.sum\n    end\n\n    private\n\n    def set_subtotal\n        self[:subtotal] = subtotal\n    end\nend\n</code></pre>\n\n<hr>\n\n<p>user.rb</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n    has_many :orders\n def to_param\n        username\n    end\nend\n</code></pre>\n\n<hr>\n\n<p>carts_controller.rb</p>\n\n<pre><code>class CartsController &lt; ApplicationController\n  before_action :authenticate_user!\n\n    def show\n        @order_items = current_order.order_items\n    end\n\nend\n</code></pre>\n\n<hr>\n\n<p>Rails Server now</p>\n\n<pre><code>Started GET \"/products\" for 127.0.0.1 at 2017-10-25 11:21:11 -0400\nProcessing by ProductsController#index as HTML\n  Rendering products/index.html.erb within layouts/application\n  Product Load (0.0ms)  SELECT \"products\".* FROM \"products\"\n  Rendered products/index.html.erb within layouts/application (16.0ms)\n  User Load (0.5ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? ORDER BY \"users\".\"id\" ASC LIMIT ?  [[\"id\", 1], [\"LIMIT\", 1]]\n  Rendered layouts/_cart.html.erb (1.0ms)\n  Rendered layouts/_nav.html.erb (34.3ms)\nCompleted 200 OK in 604ms (Views: 571.1ms | ActiveRecord: 0.5ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "websphere", "ibm-mq"], "answers": [{"tags": [], "owner": {"reputation": 6263, "user_id": 1431734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ex16s.gif?s=128&g=1", "display_name": "Roger", "link": "https://stackoverflow.com/users/1431734/roger"}, "is_accepted": false, "score": 0, "last_activity_date": 1508962683, "creation_date": 1508962683, "answer_id": 46941349, "question_id": 46935838, "link": "https://stackoverflow.com/questions/46935838/connecting-to-websphere-mq-using-ruby/46941349#46941349", "title": "Connecting to websphere MQ using ruby", "body": "<p>It would be far easier to use Java on Mac OS X rather than Ruby.  But if you want to stick with Ruby then your only option is to use <a href=\"https://developer.ibm.com/messaging/ibm-mq-light-downloads/\" rel=\"nofollow noreferrer\">MQ Light</a> to communicate with an MQ Server via AMQP protocol.  </p>\n\n<p>Note: AMQP protocol was introduced in MQ v8.0.0.4. </p>\n"}], "owner": {"reputation": 591, "user_id": 3755036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4feUb.jpg?s=128&g=1", "display_name": "qaispak", "link": "https://stackoverflow.com/users/3755036/qaispak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508962683, "creation_date": 1508943754, "question_id": 46935838, "link": "https://stackoverflow.com/questions/46935838/connecting-to-websphere-mq-using-ruby", "title": "Connecting to websphere MQ using ruby", "body": "<p>I need to push a message to MQ from ruby code. The only gem I see is WMQ and I don't think that works on OSX systems (mine is a remote MQ)</p>\n\n<p>What are options I have? I can't find any details on this online</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ubuntu-16.04"], "comments": [{"owner": {"reputation": 459, "user_id": 5810899, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fjGwDZDO7Zg/AAAAAAAAAAI/AAAAAAAAAPo/Ldy2L5fEqpY/photo.jpg?sz=128", "display_name": "Vaibhav Dhoke", "link": "https://stackoverflow.com/users/5810899/vaibhav-dhoke"}, "edited": false, "score": 0, "creation_date": 1508942280, "post_id": 46935209, "comment_id": 80817744, "body": "Your project error stack tells you are using ruby <code>2.2.0</code> whereas in the question you said it&#39;s <code>2.2.2</code>, please correct if I am wrong."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508942365, "post_id": 46935209, "comment_id": 80817794, "body": "Looks like adding the line <code>127.0.0.1 postgres</code> to <code>&#47;etc&#47;hosts</code> file (or appending <code>postgres</code> to the line starting with <code>127.0.0.1</code>) would help."}, {"owner": {"reputation": 81, "user_id": 7175012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Nf17.png?s=128&g=1", "display_name": "spuyet", "link": "https://stackoverflow.com/users/7175012/spuyet"}, "edited": false, "score": 0, "creation_date": 1508942400, "post_id": 46935209, "comment_id": 80817822, "body": "The hostname of your DB in the config file seems to be <code>postgres</code> instead of <code>127.0.0.1</code> or <code>localhost</code>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 81, "user_id": 7175012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Nf17.png?s=128&g=1", "display_name": "spuyet", "link": "https://stackoverflow.com/users/7175012/spuyet"}, "edited": false, "score": 1, "creation_date": 1508942463, "post_id": 46935209, "comment_id": 80817871, "body": "Have you tried <a href=\"https://github.com/instructure/lti_tool_provider_example/issues/4\" rel=\"nofollow noreferrer\">this</a>? (Similar, I think, to @spuyet - although they recommend <code>localhost</code> instead of the ip.)"}, {"owner": {"reputation": 81, "user_id": 7175012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Nf17.png?s=128&g=1", "display_name": "spuyet", "link": "https://stackoverflow.com/users/7175012/spuyet"}, "edited": false, "score": 1, "creation_date": 1508942553, "post_id": 46935209, "comment_id": 80817941, "body": "yes @jvilian the both work :)"}, {"owner": {"reputation": 4568, "user_id": 8712097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hevmE.jpg?s=128&g=1", "display_name": "Tom Aranda", "link": "https://stackoverflow.com/users/8712097/tom-aranda"}, "edited": false, "score": 0, "creation_date": 1508947093, "post_id": 46935209, "comment_id": 80821221, "body": "Can you post <code>config&#47;database.yml</code>  Please redact any username and password info before posting, and we only need the environment that is causing the error.  Also, what gem and version are you using to connect to postgres?"}, {"owner": {"reputation": 143, "user_id": 8036301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a4590d5ba350acf9907bc34a9c04890?s=128&d=identicon&r=PG", "display_name": "bigzoo", "link": "https://stackoverflow.com/users/8036301/bigzoo"}, "reply_to_user": {"reputation": 459, "user_id": 5810899, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fjGwDZDO7Zg/AAAAAAAAAAI/AAAAAAAAAPo/Ldy2L5fEqpY/photo.jpg?sz=128", "display_name": "Vaibhav Dhoke", "link": "https://stackoverflow.com/users/5810899/vaibhav-dhoke"}, "edited": false, "score": 0, "creation_date": 1508952927, "post_id": 46935209, "comment_id": 80824545, "body": "@VaibhavDhoke I hadn&#39;t actually noticed the difference in the error. Thing is output of ruby -v is 2.2.2, set by both the gemfile and rbenv. I&#39;m not sure why some parts say 2.2.0 and I haven&#39;t even installed it with rbenv."}, {"owner": {"reputation": 143, "user_id": 8036301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a4590d5ba350acf9907bc34a9c04890?s=128&d=identicon&r=PG", "display_name": "bigzoo", "link": "https://stackoverflow.com/users/8036301/bigzoo"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508953937, "post_id": 46935209, "comment_id": 80825117, "body": "@mudasobwa. Adding the line 127.0.0.1 worked well. I had tried that before but was adding the port 5432 which I guess isn&#39;t required."}, {"owner": {"reputation": 143, "user_id": 8036301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a4590d5ba350acf9907bc34a9c04890?s=128&d=identicon&r=PG", "display_name": "bigzoo", "link": "https://stackoverflow.com/users/8036301/bigzoo"}, "reply_to_user": {"reputation": 81, "user_id": 7175012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Nf17.png?s=128&g=1", "display_name": "spuyet", "link": "https://stackoverflow.com/users/7175012/spuyet"}, "edited": false, "score": 0, "creation_date": 1508953987, "post_id": 46935209, "comment_id": 80825150, "body": "@spuyet I hadn&#39;t tried that but I think it can work too though I think it would be better leaving the app aside and fixing it from the system."}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 8036301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a4590d5ba350acf9907bc34a9c04890?s=128&d=identicon&r=PG", "display_name": "bigzoo", "link": "https://stackoverflow.com/users/8036301/bigzoo"}, "is_accepted": true, "score": 8, "last_activity_date": 1550609331, "last_edit_date": 1550609331, "creation_date": 1508954438, "answer_id": 46939160, "question_id": 46935209, "link": "https://stackoverflow.com/questions/46935209/rails-could-not-translate-host-name-postgres-to-address-name-or-service-not-k/46939160#46939160", "title": "Rails could not translate host name &quot;postgres&quot; to address: Name or service not known (PG::ConnectionBad)", "body": "<p>Adding the line below to /etc/hosts did the trick.</p>\n\n<pre><code>127.0.0.1 postgres\n</code></pre>\n\n<p>did the trick.</p>\n\n<p>Rails uses the host name postgres and leaves it up to the system to direct postgres to the host and port as required. The line above allows the mapping to take place if it doesn't work for some reason.</p>\n\n<p>Credits @mudasobwa.</p>\n\n<p>PS.\nTo edit /etc/hosts just type (in your console)</p>\n\n<pre><code>sudo nano /etc/hosts\n</code></pre>\n\n<p>To open it and add the line.</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 2034449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eefb76366f2edba6754d6d52b71badc?s=128&d=identicon&r=PG", "display_name": "Chase Gibbons", "link": "https://stackoverflow.com/users/2034449/chase-gibbons"}, "edited": false, "score": 0, "creation_date": 1569649791, "post_id": 56705872, "comment_id": 102673083, "body": "You saved my life man!! Why does this work exactly? Are there random one off volumes that get created that I don&#39;t know about or something, which were holding onto some other variation of the &quot;postgres&quot; host address? I tried deleting my named volumes one-by-one numerous times to no avail previously, but this did the trick for me!!! Thank you very much good sir."}, {"owner": {"reputation": 3180, "user_id": 7147228, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecaf2771089d20f8e66cccd5096fbe95?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Hunter", "link": "https://stackoverflow.com/users/7147228/joshua-hunter"}, "reply_to_user": {"reputation": 103, "user_id": 2034449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eefb76366f2edba6754d6d52b71badc?s=128&d=identicon&r=PG", "display_name": "Chase Gibbons", "link": "https://stackoverflow.com/users/2034449/chase-gibbons"}, "edited": false, "score": 0, "creation_date": 1571167432, "post_id": 56705872, "comment_id": 103147903, "body": "I&#39;m not sure, what causes it, honestly.  I was glad to finally find something that worked, though."}], "tags": [], "owner": {"reputation": 3180, "user_id": 7147228, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecaf2771089d20f8e66cccd5096fbe95?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Hunter", "link": "https://stackoverflow.com/users/7147228/joshua-hunter"}, "is_accepted": false, "score": 6, "last_activity_date": 1571167291, "last_edit_date": 1571167291, "creation_date": 1561129127, "answer_id": 56705872, "question_id": 46935209, "link": "https://stackoverflow.com/questions/46935209/rails-could-not-translate-host-name-postgres-to-address-name-or-service-not-k/56705872#56705872", "title": "Rails could not translate host name &quot;postgres&quot; to address: Name or service not known (PG::ConnectionBad)", "body": "<p>This happened to me on a container that I had been using regularly.  It just randomly started throwing this error and not resolving.</p>\n\n<p>I eventually solved it with</p>\n\n<pre><code>docker system prune --volumes\n</code></pre>\n\n<p>running it without the volumes flag didn't resolve it.</p>\n"}, {"tags": [], "owner": {"reputation": 152, "user_id": 10385358, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XAdcI_5w9Ug/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pj7mTjT1kRQHtwS6LN8hgF1QCNmg/mo/photo.jpg?sz=128", "display_name": "M_Badrah", "link": "https://stackoverflow.com/users/10385358/m-badrah"}, "is_accepted": false, "score": 0, "last_activity_date": 1584549442, "last_edit_date": 1584549442, "creation_date": 1584549066, "answer_id": 60743729, "question_id": 46935209, "link": "https://stackoverflow.com/questions/46935209/rails-could-not-translate-host-name-postgres-to-address-name-or-service-not-k/60743729#60743729", "title": "Rails could not translate host name &quot;postgres&quot; to address: Name or service not known (PG::ConnectionBad)", "body": "<p>if you run with docker add :</p>\n\n<pre><code>        services:\n        postgres:\n          image: postgres\n        environment:\n          POSTGRES_HOST_AUTH_METHOD: trust\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 8036301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a4590d5ba350acf9907bc34a9c04890?s=128&d=identicon&r=PG", "display_name": "bigzoo", "link": "https://stackoverflow.com/users/8036301/bigzoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10180, "favorite_count": 0, "accepted_answer_id": 46939160, "answer_count": 3, "score": 5, "last_activity_date": 1589461988, "creation_date": 1508942059, "last_edit_date": 1546367477, "question_id": 46935209, "link": "https://stackoverflow.com/questions/46935209/rails-could-not-translate-host-name-postgres-to-address-name-or-service-not-k", "title": "Rails could not translate host name &quot;postgres&quot; to address: Name or service not known (PG::ConnectionBad)", "body": "<p>I'm working on a Rails 4.2.3 project with ruby 2.2.2 (Running ubuntu 16.04). It was working ok but after revisiting it after a while I can't serve. I've tried searching but all situations don't seem to be of help.\nHere's the error log:</p>\n\n<pre><code>bigzoo@bigzoo:~/Documents/projects/proj$ rs\n=&gt; Booting Puma\n=&gt; Rails 4.2.3 application starting in development on http://localhost:3000\n=&gt; Run `rails server -h` for more startup options\n=&gt; Ctrl-C to shutdown server\nExiting\n/home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:655:in `initialize': could not translate host name \"postgres\" to address: Name or service not known (PG::ConnectionBad)\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:655:in `new'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:655:in `connect'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:242:in `initialize'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:44:in `new'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:44:in `postgresql_connection'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:438:in `new_connection'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:448:in `checkout_new_connection'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:422:in `acquire_connection'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:349:in `block in checkout'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/monitor.rb:211:in `mon_synchronize'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:348:in `checkout'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:263:in `block in connection'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/monitor.rb:211:in `mon_synchronize'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:262:in `connection'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:571:in `retrieve_connection'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_handling.rb:113:in `retrieve_connection'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/connection_handling.rb:87:in `connection'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/querying.rb:39:in `find_by_sql'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/relation.rb:638:in `exec_queries'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/relation.rb:514:in `load'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/relation.rb:243:in `to_a'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activerecord-4.2.3/lib/active_record/relation/delegation.rb:46:in `map'\n    from /home/bigzoo/Documents/projects/proj/app/admin/product.rb:62:in `block in &lt;top (required)&gt;'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/dsl.rb:15:in `instance_exec'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/dsl.rb:15:in `run_registration_block'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/namespace.rb:223:in `parse_registration_block'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/namespace.rb:48:in `register'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/application.rb:154:in `register'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin.rb:75:in `register'\n    from /home/bigzoo/Documents/projects/proj/app/admin/product.rb:1:in `&lt;top (required)&gt;'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:268:in `load'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:268:in `block in load'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:240:in `load_dependency'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:268:in `load'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/application.rb:212:in `block in load'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/error.rb:41:in `capture'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/application.rb:212:in `load'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/application.rb:204:in `block in load!'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/application.rb:204:in `each'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/application.rb:204:in `load!'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin/application.rb:226:in `routes'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/bundler/gems/activeadmin-21f76b1faf65/lib/active_admin.rb:79:in `routes'\n    from /home/bigzoo/Documents/projects/proj/config/routes.rb:20:in `block in &lt;top (required)&gt;'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/actionpack-4.2.3/lib/action_dispatch/routing/route_set.rb:434:in `instance_exec'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/actionpack-4.2.3/lib/action_dispatch/routing/route_set.rb:434:in `eval_block'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/actionpack-4.2.3/lib/action_dispatch/routing/route_set.rb:412:in `draw'\n    from /home/bigzoo/Documents/projects/proj/config/routes.rb:1:in `&lt;top (required)&gt;'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:268:in `load'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:268:in `block in load'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:240:in `load_dependency'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:268:in `load'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/application/routes_reloader.rb:40:in `block in load_paths'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/application/routes_reloader.rb:40:in `each'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/application/routes_reloader.rb:40:in `load_paths'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/application/routes_reloader.rb:16:in `reload!'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/application/routes_reloader.rb:26:in `block in updater'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/file_update_checker.rb:75:in `call'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/file_update_checker.rb:75:in `execute'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/application/routes_reloader.rb:27:in `updater'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/application/routes_reloader.rb:7:in `execute_if_updated'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/application/finisher.rb:69:in `block in &lt;module:Finisher&gt;'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/initializable.rb:30:in `instance_exec'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/initializable.rb:30:in `run'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/tsort.rb:226:in `block in tsort_each'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/tsort.rb:348:in `block (2 levels) in each_strongly_connected_component'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/tsort.rb:429:in `each_strongly_connected_component_from'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/tsort.rb:347:in `block in each_strongly_connected_component'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/tsort.rb:345:in `each'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/tsort.rb:345:in `call'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/tsort.rb:345:in `each_strongly_connected_component'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/tsort.rb:224:in `tsort_each'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/tsort.rb:203:in `tsort_each'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/initializable.rb:54:in `run_initializers'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/application.rb:352:in `initialize!'\n    from /home/bigzoo/Documents/projects/proj/config/environment.rb:5:in `&lt;top (required)&gt;'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:274:in `require'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:274:in `block in require'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:240:in `load_dependency'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/activesupport-4.2.3/lib/active_support/dependencies.rb:274:in `require'\n    from /home/bigzoo/Documents/projects/proj/config.ru:3:in `block in &lt;main&gt;'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/rack-1.6.5/lib/rack/builder.rb:55:in `instance_eval'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/rack-1.6.5/lib/rack/builder.rb:55:in `initialize'\n    from /home/bigzoo/Documents/projects/proj/config.ru:in `new'\n    from /home/bigzoo/Documents/projects/proj/config.ru:in `&lt;main&gt;'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/rack-1.6.5/lib/rack/builder.rb:49:in `eval'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/rack-1.6.5/lib/rack/builder.rb:49:in `new_from_string'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/rack-1.6.5/lib/rack/builder.rb:40:in `parse_file'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/rack-1.6.5/lib/rack/server.rb:299:in `build_app_and_options_from_config'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/rack-1.6.5/lib/rack/server.rb:208:in `app'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/commands/server.rb:61:in `app'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/rack-1.6.5/lib/rack/server.rb:336:in `wrapped_app'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/commands/server.rb:139:in `log_to_stdout'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/commands/server.rb:78:in `start'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/commands/commands_tasks.rb:80:in `block in server'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/commands/commands_tasks.rb:75:in `tap'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/commands/commands_tasks.rb:75:in `server'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/commands/commands_tasks.rb:39:in `run_command!'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/railties-4.2.3/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\n    from /home/bigzoo/Documents/projects/proj/bin/rails:8:in `require'\n    from /home/bigzoo/Documents/projects/proj/bin/rails:8:in `&lt;top (required)&gt;'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/spring-1.3.6/lib/spring/client/rails.rb:28:in `load'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/spring-1.3.6/lib/spring/client/rails.rb:28:in `call'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/spring-1.3.6/lib/spring/client/command.rb:7:in `call'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/spring-1.3.6/lib/spring/client.rb:26:in `run'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/spring-1.3.6/bin/spring:48:in `&lt;top (required)&gt;'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/spring-1.3.6/lib/spring/binstub.rb:11:in `load'\n    from /home/bigzoo/Documents/projects/proj/.bundle/ruby/2.2.0/gems/spring-1.3.6/lib/spring/binstub.rb:11:in `&lt;top (required)&gt;'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    from /home/bigzoo/.rbenv/versions/2.2.2/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    from /home/bigzoo/Documents/projects/proj/bin/spring:13:in `&lt;top (required)&gt;'\n    from bin/rails:3:in `load'\n    from bin/rails:3:in `&lt;main&gt;'\n</code></pre>\n\n<p>The only issue seems to be connecting to postgres.</p>\n\n<p>PS. I've already tried running <code>unset DATABASE_URL</code> if anyone is feeling compelled to suggest that.</p>\n\n<p>Extra info:</p>\n\n<pre><code>bigzoo@bigzoo:~/Documents/projects/proj$ sudo netstat -atpn | grep 5432\n[sudo] password for bigzoo: \ntcp        0      0 127.0.0.1:5432          0.0.0.0:*               LISTEN      1744/postgres \n</code></pre>\n"}, {"tags": ["ruby", "web-scraping", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8564271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EtcNB.jpg?s=128&g=1", "display_name": "Monique", "link": "https://stackoverflow.com/users/8564271/monique"}, "edited": false, "score": 0, "creation_date": 1509021077, "post_id": 46934332, "comment_id": 80855786, "body": "I&#39; ve tried this before, even with 1 minute sleep didnt work."}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "reply_to_user": {"reputation": 1, "user_id": 8564271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EtcNB.jpg?s=128&g=1", "display_name": "Monique", "link": "https://stackoverflow.com/users/8564271/monique"}, "edited": false, "score": 0, "creation_date": 1509027663, "post_id": 46934332, "comment_id": 80860962, "body": "It&#39;s possible, then, that the rate-limiting mechanism locks you out for a while after a burst of requests. You could try using a VPN to hit it from different IP addresses, but this is a little &quot;shady&quot;. The operator of the site doesn&#39;t want you to crawl it like this. Question: When the the requests fail, what status code are you getting in the response?"}], "tags": [], "owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "is_accepted": false, "score": 0, "last_activity_date": 1508939672, "creation_date": 1508939672, "answer_id": 46934332, "question_id": 46933753, "link": "https://stackoverflow.com/questions/46933753/cant-reload-the-page-after-many-requests/46934332#46934332", "title": "Can&#39;t reload the page after many requests", "body": "<p>You are likely being blocked because the website you're scraping does not want bots consuming its pages at the high rate you're attempting. Slowing down your scraping is a reasonable approach, and you should be able to accomplish this with a <code>sleep</code> between each page. You'll have to use trial and error to figure how slowly you need to go so that you don't get blocked.</p>\n\n<p>Something like this should work:</p>\n\n<pre><code>def final_results(range, link)\n  (range[:start]..range[:finish]).each do |page_number|\n    begin\n      if page_number == 1\n        parse_response(parser('utf-8', 'iso-8859-1'))\n      elsif page_number == 2\n        get_next_link(link)\n      else\n        get_next_link(@next_link)\n      end\n    rescue Exception =&gt; e\n      range = {:start =&gt; page_number, :finish =&gt; range[:finish]}\n      final_results(range, link)\n    end\n    # sleep here!\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8564271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EtcNB.jpg?s=128&g=1", "display_name": "Monique", "link": "https://stackoverflow.com/users/8564271/monique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508939672, "creation_date": 1508938085, "last_edit_date": 1508939554, "question_id": 46933753, "link": "https://stackoverflow.com/questions/46933753/cant-reload-the-page-after-many-requests", "title": "Can&#39;t reload the page after many requests", "body": "<p>I'm parsing a website with ruby nokogiri, but after many requests the sites blocks me, so I have to retry at the last page I was parsing (the link is get by the @next_link).</p>\n\n<p>I've tried using the <code>sleep</code> method, exceptions e many things. Nothing works.</p>\n\n<p>I have, for example, 150 pages to parse, but at page 25 I get blocked. </p>\n\n<p>This function makes a loop through my pages:</p>\n\n<pre><code>def final_results(range, link)\n  (range[:start]..range[:finish]).each do |page_number|\n    begin\n      if page_number == 1\n        parse_response(parser('utf-8', 'iso-8859-1'))\n      elsif page_number == 2\n        get_next_link(link)\n      else\n        get_next_link(@next_link)\n      end\n    rescue Exception =&gt; e\n      range = {:start =&gt; page_number, :finish =&gt; range[:finish]}\n      final_results(range, link)\n    end\n  end\nend\n</code></pre>\n\n<p>This function gets the next page link and parses the current page: </p>\n\n<pre><code>def get_next_link(link)\n  begin\n    post((BASE_URL + link), request_with_captcha_solution)\n    aux = parser('utf-8', 'iso-8859-1')\n    parse_response(aux)\n    paginator_table = aux.css('table.fonte11')[1].children[1]\n    @next_link = paginator_table.children[3].children[-2]['href']\n  rescue Exception =&gt; e\n    @error_message =\"#{$!}\"\n  end\n  @next_link\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "cors"], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 5032873, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MSWnq.jpg?s=128&g=1", "display_name": "mike927", "link": "https://stackoverflow.com/users/5032873/mike927"}, "edited": false, "score": 0, "creation_date": 1508936667, "post_id": 46933226, "comment_id": 80813385, "body": "no it is not my question. I would like to know why I can use GET, POST even if there are excluded."}, {"owner": {"reputation": 833, "user_id": 5609246, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d2b90d639a8b94fcb4f099c2ace9ba9a?s=128&d=identicon&r=PG", "display_name": "McMutton", "link": "https://stackoverflow.com/users/5609246/mcmutton"}, "reply_to_user": {"reputation": 613, "user_id": 5032873, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MSWnq.jpg?s=128&g=1", "display_name": "mike927", "link": "https://stackoverflow.com/users/5032873/mike927"}, "edited": false, "score": 0, "creation_date": 1508937687, "post_id": 46933226, "comment_id": 80814110, "body": "I see your point, may I ask, how do you make your calls to the server?"}], "tags": [], "owner": {"reputation": 833, "user_id": 5609246, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d2b90d639a8b94fcb4f099c2ace9ba9a?s=128&d=identicon&r=PG", "display_name": "McMutton", "link": "https://stackoverflow.com/users/5609246/mcmutton"}, "is_accepted": false, "score": 1, "last_activity_date": 1508936571, "creation_date": 1508936571, "answer_id": 46933226, "question_id": 46932909, "link": "https://stackoverflow.com/questions/46932909/rails-cors-simple-request-allowed-methods-option-is-ignored/46933226#46933226", "title": "Rails CORS - simple request: allowed methods option is ignored", "body": "<p>If you want to allow only specific methods, say GET and OPTIONS, try this: </p>\n\n<pre><code>config.middleware.insert_before 0, Rack::Cors do\n  allow do\n    origins '*'\n    resource '*', :headers =&gt; :any, :methods =&gt; [:get, :options]\n  end\nend\n</code></pre>\n\n<p>More info <a href=\"https://github.com/cyu/rack-cors\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 2467, "user_id": 3703048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/953952e7b8c1e4929c87cd7eec72bc51?s=128&d=identicon&r=PG", "display_name": "Shahzad Tariq", "link": "https://stackoverflow.com/users/3703048/shahzad-tariq"}, "edited": false, "score": 0, "creation_date": 1508938057, "post_id": 46933705, "comment_id": 80814401, "body": "Check code at line # 348 <a href=\"https://github.com/cyu/rack-cors/blob/master/lib/rack/cors.rb\" rel=\"nofollow noreferrer\">github.com/cyu/rack-cors/blob/master/lib/rack/cors.rb</a>"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 1, "creation_date": 1508940443, "post_id": 46933705, "comment_id": 80816366, "body": "I don&#39;t see <code>opts[:methods]</code> being set to <code>:any</code> anywhere in that code for blank array. If <code>opts[:methods]</code> is not passed, it is picking up <code>[:get]</code>"}, {"owner": {"reputation": 2467, "user_id": 3703048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/953952e7b8c1e4929c87cd7eec72bc51?s=128&d=identicon&r=PG", "display_name": "Shahzad Tariq", "link": "https://stackoverflow.com/users/3703048/shahzad-tariq"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1508942935, "post_id": 46933705, "comment_id": 80818231, "body": "Check line # 351   ensure_enum(opts[:methods]) || [:get]"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1508946236, "post_id": 46933705, "comment_id": 80820640, "body": "Precisely, check the implementation of <a href=\"https://github.com/cyu/rack-cors/blob/master/lib/rack/cors.rb#L425\" rel=\"nofollow noreferrer\"><code>enure_enum</code></a>. It will return nil if opts[:methods] is nil (which isn&#39;t the case), else it will send the flatten array of http verbs passed in <code>opts[:methods]</code> (which is empty)."}], "tags": [], "owner": {"reputation": 2467, "user_id": 3703048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/953952e7b8c1e4929c87cd7eec72bc51?s=128&d=identicon&r=PG", "display_name": "Shahzad Tariq", "link": "https://stackoverflow.com/users/3703048/shahzad-tariq"}, "is_accepted": false, "score": 0, "last_activity_date": 1508942917, "last_edit_date": 1508942917, "creation_date": 1508937961, "answer_id": 46933705, "question_id": 46932909, "link": "https://stackoverflow.com/questions/46932909/rails-cors-simple-request-allowed-methods-option-is-ignored/46933705#46933705", "title": "Rails CORS - simple request: allowed methods option is ignored", "body": "<p>Rack-cors gem set default value of methods and headers to :get</p>\n\n<p>So if you pass empty string or empty array or nil, it would take it as :any so it is allowing get, post etc requests.</p>\n"}, {"comments": [{"owner": {"reputation": 613, "user_id": 5032873, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MSWnq.jpg?s=128&g=1", "display_name": "mike927", "link": "https://stackoverflow.com/users/5032873/mike927"}, "edited": false, "score": 0, "creation_date": 1508945819, "post_id": 46933759, "comment_id": 80820320, "body": "so [:get, :head, :post, :put, :patch, :delete, :options] gets the same effect as [:put, :patch, :delete] ?"}, {"owner": {"reputation": 61150, "user_id": 441757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/921df025d1d7c99fad4553ac83bd8bdf?s=128&d=identicon&r=PG", "display_name": "sideshowbarker", "link": "https://stackoverflow.com/users/441757/sideshowbarker"}, "reply_to_user": {"reputation": 613, "user_id": 5032873, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MSWnq.jpg?s=128&g=1", "display_name": "mike927", "link": "https://stackoverflow.com/users/5032873/mike927"}, "edited": false, "score": 1, "creation_date": 1508947596, "post_id": 46933759, "comment_id": 80821550, "body": "@mike927 for simple requests, yeah, those have the same effect \u30fc which is to say, they both have no effect at all. But for preflighted requests, they instead have different effects \u30fc which is to say, exactly the effects you would expect them to have. Specifically, a preflighted POST request will disallowed by browsers if that method value doesn&#39;t have :post"}, {"owner": {"reputation": 613, "user_id": 5032873, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MSWnq.jpg?s=128&g=1", "display_name": "mike927", "link": "https://stackoverflow.com/users/5032873/mike927"}, "edited": false, "score": 0, "creation_date": 1508959170, "post_id": 46933759, "comment_id": 80828124, "body": "hey, finally I got it! I felt confused how it is possible to perform preflight request along with GET. I forgot about other restrictions than HTTP method, like custom header though. Definitely best answer !"}], "tags": [], "owner": {"reputation": 61150, "user_id": 441757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/921df025d1d7c99fad4553ac83bd8bdf?s=128&d=identicon&r=PG", "display_name": "sideshowbarker", "link": "https://stackoverflow.com/users/441757/sideshowbarker"}, "is_accepted": true, "score": 3, "last_activity_date": 1508938805, "last_edit_date": 1508938805, "creation_date": 1508938105, "answer_id": 46933759, "question_id": 46932909, "link": "https://stackoverflow.com/questions/46932909/rails-cors-simple-request-allowed-methods-option-is-ignored/46933759#46933759", "title": "Rails CORS - simple request: allowed methods option is ignored", "body": "<p>That <code>methods</code> value only controls what method names the server sends back in the value of the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Methods\" rel=\"nofollow noreferrer\"><code>Access-Control-Allow-Methods</code></a> header in response to a <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#Preflighted_requests\" rel=\"nofollow noreferrer\">CORS preflight <code>OPTIONS</code> request</a> \u2014 that is, only for non-\u201csimple\u201d requests.</p>\n\n<p>So if your request has characteristics that trigger a preflight, only then will browsers check the value of the <code>Access-Control-Allow-Methods</code> response header to see if the request method is allowed, and so only then will the <code>methods</code> value you\u2019ve configured have any effect.</p>\n\n<p>Otherwise, your browser will allow any cross-origin <code>GET</code> and <code>POST</code> that doesn\u2019t trigger a preflight \u2014 any \u201csimple\u201d request \u2014 without regard to whatever <code>methods</code> value you\u2019ve configured.</p>\n\n<blockquote>\n  <p>how to forbid e.g. POST using CORS?</p>\n</blockquote>\n\n<p>You can\u2019t forbid \u201csimple\u201d <code>POST</code> requests using CORS. You can only forbid non-simple <code>POST</code> requests \u2014 those that have for whatever reason triggered a preflight.</p>\n\n<p>Or, by using the <code>headers</code> option, you can set the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Headers\" rel=\"nofollow noreferrer\"><code>Access-Control-Allow-Headers</code></a> header value \u2014 which will cause the browser to disallow any non-simple preflighted requests that have request headers with names other than the header names you\u2019ve specified with that <code>headers</code> option.</p>\n"}], "owner": {"reputation": 613, "user_id": 5032873, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MSWnq.jpg?s=128&g=1", "display_name": "mike927", "link": "https://stackoverflow.com/users/5032873/mike927"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "accepted_answer_id": 46933759, "answer_count": 3, "score": 1, "last_activity_date": 1508942917, "creation_date": 1508935730, "last_edit_date": 1508941765, "question_id": 46932909, "link": "https://stackoverflow.com/questions/46932909/rails-cors-simple-request-allowed-methods-option-is-ignored", "title": "Rails CORS - simple request: allowed methods option is ignored", "body": "<p>I build API based on Rails 5. I use 'rack-cors' gem to control CORS. Below code snipped I wonder about:</p>\n\n<pre><code>    config.middleware.insert_before 0, Rack::Cors do\n      allow do\n        origins '*'\n        resource '*', headers: :any, methods: %i()\n      end\n    end\n</code></pre>\n\n<p>I removed all HTTP methods from allowed methods array however still I can call GET, POST successfully (DELETE is forbidden and I get it). As I can see OPTIONS, GET, POST are ignored because even it's empty I can call server with these methods. Is it normal? If it is so how to forbid e.g. POST using CORS?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "callback", "associated-object"], "comments": [{"owner": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "edited": false, "score": 0, "creation_date": 1508936181, "post_id": 46932837, "comment_id": 80813004, "body": "U mean before updating you want old_value but you are seeing new_Value right?"}, {"owner": {"reputation": 13, "user_id": 4959273, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b12d66858ddfd8812fe18cf33d45bb7a?s=128&d=identicon&r=PG&f=1", "display_name": "GTeley", "link": "https://stackoverflow.com/users/4959273/gteley"}, "reply_to_user": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "edited": false, "score": 0, "creation_date": 1508937078, "post_id": 46932837, "comment_id": 80813666, "body": "@krishnar: Yes, As the associating is recorded in its own table, the old values are records that appear to be deleted from the associated table  before I can get my hands on it."}, {"owner": {"reputation": 13, "user_id": 4959273, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b12d66858ddfd8812fe18cf33d45bb7a?s=128&d=identicon&r=PG&f=1", "display_name": "GTeley", "link": "https://stackoverflow.com/users/4959273/gteley"}, "reply_to_user": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "edited": false, "score": 0, "creation_date": 1508937424, "post_id": 46932837, "comment_id": 80813917, "body": "Well, I&#39;ve found one way to get the old values: In the controller save method just before assigning the new values to the existing record. But this is IMHO not the intended Rails way to do it!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4959273, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b12d66858ddfd8812fe18cf33d45bb7a?s=128&d=identicon&r=PG&f=1", "display_name": "GTeley", "link": "https://stackoverflow.com/users/4959273/gteley"}, "edited": false, "score": 0, "creation_date": 1508938657, "post_id": 46933617, "comment_id": 80814833, "body": "As I said: getting old values for the main model is no problem. Getting the associated (has_many) record is the problem. If I assign new values to the associated fields in the model controller, just before calling save, Rails updates the associated table(s) before letting me get them in the before_save callback."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1508941906, "post_id": 46933617, "comment_id": 80817465, "body": "An <i>has_many</i> relation still has a <i>belongs_to</i> on the other side. What happens if you set up a <i>before_save</i> there?"}], "tags": [], "owner": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "is_accepted": false, "score": 0, "last_activity_date": 1508937738, "creation_date": 1508937738, "answer_id": 46933617, "question_id": 46932837, "link": "https://stackoverflow.com/questions/46932837/how-to-fetch-previous-values-of-associated-records/46933617#46933617", "title": "How to fetch previous values of associated records?", "body": "<p>Use before_update and you can access old values using <strong><code>_was</code></strong> </p>\n\n<pre><code>before_update :record_values\n\n\ndef record_values\n  p \"oldvalue:  #{self.field_was} Newvalue: #{self.field}\"\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 4959273, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b12d66858ddfd8812fe18cf33d45bb7a?s=128&d=identicon&r=PG&f=1", "display_name": "GTeley", "link": "https://stackoverflow.com/users/4959273/gteley"}, "edited": false, "score": 0, "creation_date": 1508954414, "post_id": 46936114, "comment_id": 80825392, "body": "Thanks for the reply. Maybe I wasn&#39;t clear enough. My problem is with many-to-many relationships who are recorded in an relation table. The detection of changes works fine in the has_many model, but not for the belongs_to model (has_many, :through) I solved it, sort of, in the main model controller by logging the changes before the new values are assigned to the related_to ids."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1508945321, "last_edit_date": 1508945321, "creation_date": 1508944501, "answer_id": 46936114, "question_id": 46932837, "link": "https://stackoverflow.com/questions/46932837/how-to-fetch-previous-values-of-associated-records/46936114#46936114", "title": "How to fetch previous values of associated records?", "body": "<p>Your question is a bit unclear, but let me provide you with an example of what I think you try to do.</p>\n\n<p>The code below works fine for me:</p>\n\n<pre><code>class Person &lt; ApplicationRecord\n  has_many :addresses\n\n  validates_presence_of :name\n\n  before_save { puts \"before_save of person - changes: #{changes}\" }\n  before_destroy { puts \"before_destroy of person with id: #{id}\" }\nend\n\nclass Address &lt; ApplicationRecord\n  belongs_to :person, required: true\n\n  validates_presence_of :name\n\n  before_save { puts \"before_save of address - changes: #{changes}\" }\n  before_destroy { puts \"before_destroy of address with id: #{id}\" }\nend\n</code></pre>\n\n<p>This results in the following output when interacting:</p>\n\n<pre><code>person = Person.create(name: 'Johan Wentholt')\n# before_save of person - changes: {\"name\" =&gt;[nil, \"Johan Wentholt\"]}\n#=&gt; #&lt;Person id: 2, name: \"Johan Wentholt\", created_at: \"2017-10-25 15:04:27\", updated_at: \"2017-10-25 15:04:27\"&gt;\n\nperson.addresses.create(name: 'Address #1')\n# before_save of address - changes: {\"person_id\"=&gt;[nil, 2], \"name\"  =&gt;[nil, \"Address #1\"]}\n#=&gt; #&lt;Address id: 7, person_id: 2, name: \"Address #1\", created_at: \"2017-10-25 15:06:38\", updated_at: \"2017-10-25 15:06:38\"&gt;\n\nperson.addresses.last.update(name: 'Address without typo')\n# before_save of address - changes: {\"name\"=&gt;[\"Address #1\", \"Address without typo\"]}\n#=&gt; true\n\nperson.update(name: 'Kaasboer')\n# before_save of person - changes: {\"name\"=&gt;[\"Johan Wentholt\", \"Kaasboer\"]}\n#=&gt; true\n\nperson.addresses.last.destroy\n# before_destroy of address with id: 7\n#=&gt; #&lt;Address id: 7, person_id: 2, name: \"Address without typo\", created_at: \"2017-10-25 15:06:38\", updated_at: \"2017-10-25 15:08:51\"&gt;\n\nperson.destroy\n# before_destroy of person with id: 2\n#=&gt; #&lt;Person id: 2, name: \"Kaasboer\", created_at: \"2017-10-25 15:04:27\", updated_at: \"2017-10-25 15:10:46\"&gt;\n</code></pre>\n\n<p>As you can see this logs all changes. Like I said, the question is a bit unclear, but I hope this helps you further.</p>\n\n<p><strong>Keep in mind that some Rails methods don't trigger callbacks. For example: <em>delete</em>, <em>update_all</em>, <em>update_column</em> and some others.</strong></p>\n\n<p>For more about changes take a look at: <a href=\"http://api.rubyonrails.org/classes/ActiveModel/Dirty.html\" rel=\"nofollow noreferrer\"><em>ActiveModel::Dirty</em></a></p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 4959273, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b12d66858ddfd8812fe18cf33d45bb7a?s=128&d=identicon&r=PG&f=1", "display_name": "GTeley", "link": "https://stackoverflow.com/users/4959273/gteley"}, "is_accepted": true, "score": 0, "last_activity_date": 1508956461, "creation_date": 1508956461, "answer_id": 46939744, "question_id": 46932837, "link": "https://stackoverflow.com/questions/46932837/how-to-fetch-previous-values-of-associated-records/46939744#46939744", "title": "How to fetch previous values of associated records?", "body": "<p>For clarity sake, lets give some extended information:</p>\n\n<pre><code>class Book &lt; ActiveRecord::Base\n  unloadable\n  has_many :titles, dependent: :destroy\n  has_many :authors, :through =&gt; :titles\n  accepts_nested_attributes_for :authors\n\n  before_save :pre_save\n  after_save  :post_save\n  before_destroy :pre_delete\n\n  def pre_save\n    @nr = self.new_record?\n  end\n\n  def pre_save\n    changed_values = []\n    if @nr\n      changed_values.push \"New record created\"\n    else \n      self.changes.each do |field, cvs|\n        changes.push(\"#{field} : #{cvs[0]} =&gt; #{cvs[1]}\")\n      end\n    end\n    if changes.length &gt; 0\n      BookLog.create(:book_id =&gt; self.id, :changed_values =&gt; changes.join(', '))\n    end\n  end\n\n  def pre_delete\n    BookLog.create(:book_id =&gt; self.id, :changed_values =&gt; \"Deleted: #{self.name}\")\n  end\nend\n\nclass Title &lt; ActiveRecord::Base\n  unloadable\n  belongs_to :book\n  belongs_to :author\nend\n\nclass Author &lt; ActiveRecord::Base\n  unloadable\n  has_many :titles, dependent: :destroy\n  has_many :books, :through =&gt; :titles\n  accepts_nested_attributes_for :books\nend\n\nclass BooksController &lt; ApplicationController\n\n  def edit\n    book = Book.find(params[:book][:id])\n    book.name = .....\n    ===&gt; Here the old values are still available &lt;==== \n    book.author_ids = params[:book][:author_ids] \n    ===&gt; Now the new values are written to the database! &lt;==== \n    book.save!\n  end\nend\n</code></pre>\n\n<p>Changes to the Book record are perfectly logged.\nBut there is no way to fetch the changed associated values for author_ids.\nA before_destroy callback in Title was not called, the after_save was.</p>\n\n<p>I checked this with enabling the SQL logging just before the assignment of the new author_ids to the edited record. I could see that Rails determines the differences between the existing and new associated values, deletes the surplus form the Titles table and insert the extra ones (if any)</p>\n\n<p>I solved it by moving the logging for the changes in Titles to the Books controller by comparing the old with the new values:</p>\n\n<pre><code>     o_authors = book.author_ids\n     n_authors = params[:book][:author_ids].collect {|c| c.to_i}\n     diff = o_authors - n_authors | n_authors - o_authors\n     if !diff.empty?\n       changed_values = []\n       (o_authors - n_authors).each do |d|\n         changed_values.push(\"Removed Author: #{Author.find(d).name}\")\n       end\n       (n_authors - o_authors).each do |d|\n         changed_values.push(\"Added Author: #{Author.find(d).name}\")\n       end\n       BookLog.create(:book_id =&gt; book.id, :changed_values =&gt; changed_values)\n     end\n     book.author_ids = params[:book][:author_ids]\n     book.save!\n</code></pre>\n\n<p>Like I said, it works but IMHO it does not reflect the Rails way of doing things. I would have expected to get the previous author_ids in the same way as any other Book attribute.</p>\n"}], "owner": {"reputation": 13, "user_id": 4959273, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b12d66858ddfd8812fe18cf33d45bb7a?s=128&d=identicon&r=PG&f=1", "display_name": "GTeley", "link": "https://stackoverflow.com/users/4959273/gteley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1297, "favorite_count": 0, "accepted_answer_id": 46939744, "answer_count": 3, "score": 0, "last_activity_date": 1508956461, "creation_date": 1508935530, "question_id": 46932837, "link": "https://stackoverflow.com/questions/46932837/how-to-fetch-previous-values-of-associated-records", "title": "How to fetch previous values of associated records?", "body": "<p>When working with many-to-many relationships, I need to maintain a log file recording the changed values.\nUsing the before_save and after_save callbacks works fine for the main (has_many) model itself but in the before_save callback the associated (belongs_to) records appear to be updated already!\nIt seems rather odd to see that some parts of the data already have been updated before the 'before_save' callback is called.</p>\n\n<p>Also, using callbacks in the associated model reveals that there is no before_destroy executed. Only the before_save gets called and shows the new values.\nI also tried the :prepend => :true option but that didn't gave other results.</p>\n\n<p>When turning on SQL logging before the actual save in the main (has_many) model, I can see Rails is fetching the associated records, determines the differences and deletes the surplus record(s). The before_destroy of the associated model is not called.\nIt then calls the before_save of the associated model and inserts the new ones (if any) and commits the transaction. This is all done JUST BEFORE the before_save of the main model.</p>\n\n<p>Does anyone know how to fetch the associated records before they are changed?\nI would expect the before_destroy of the associated model would get called and let me handle it.</p>\n"}, {"tags": ["ruby", "sequel", "padrino"], "comments": [{"owner": {"reputation": 1215, "user_id": 2824935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/dkDTX.jpg?s=128&g=1", "display_name": "garythegoat", "link": "https://stackoverflow.com/users/2824935/garythegoat"}, "edited": false, "score": 0, "creation_date": 1508942716, "post_id": 46930661, "comment_id": 80818061, "body": "Are you using Bundler? If so, have you tried another <code>$ bundle install</code>, and seeing if the issue persists?"}, {"owner": {"reputation": 161, "user_id": 846437, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/240b60897b668ee3ae95dd134b8b11e4?s=128&d=identicon&r=PG", "display_name": "lasoweq", "link": "https://stackoverflow.com/users/846437/lasoweq"}, "reply_to_user": {"reputation": 1215, "user_id": 2824935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/dkDTX.jpg?s=128&g=1", "display_name": "garythegoat", "link": "https://stackoverflow.com/users/2824935/garythegoat"}, "edited": false, "score": 0, "creation_date": 1508943650, "post_id": 46930661, "comment_id": 80818714, "body": "@garythegoat yes, I use Bundler. As I understand from the docs, flag <code>-b</code> is executing <code>bundle install</code>. I also did it manually, doesn&#39;t change the situation"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 846437, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/240b60897b668ee3ae95dd134b8b11e4?s=128&d=identicon&r=PG", "display_name": "lasoweq", "link": "https://stackoverflow.com/users/846437/lasoweq"}, "edited": false, "score": 0, "creation_date": 1508948620, "post_id": 46935909, "comment_id": 80822160, "body": "so I won&#39;t be able to use generator with padrino?"}], "tags": [], "owner": {"reputation": 11331, "user_id": 132053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f183bcc4176b308c9edabe79299e448f?s=128&d=identicon&r=PG", "display_name": "Jeremy Evans", "link": "https://stackoverflow.com/users/132053/jeremy-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1508943955, "creation_date": 1508943955, "answer_id": 46935909, "question_id": 46930661, "link": "https://stackoverflow.com/questions/46930661/padrino-g-cannot-load-such-file-sequel-plugins-schema/46935909#46935909", "title": "padrino g: cannot load such file -- sequel/plugins/schema", "body": "<p>The schema plugin was deprecated in Sequel 4.45.0 and removed in Sequel 5.0.0.  Switch to using migrations or calling the Sequel::Database schema modification methods directly before creating your model classes.</p>\n"}, {"tags": [], "owner": {"reputation": 237, "user_id": 872540, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/783e4dd5aecec1a30d2e43f119066011?s=128&d=identicon&r=PG", "display_name": "DrPepper", "link": "https://stackoverflow.com/users/872540/drpepper"}, "is_accepted": false, "score": 0, "last_activity_date": 1512418282, "creation_date": 1512418282, "answer_id": 47641213, "question_id": 46930661, "link": "https://stackoverflow.com/questions/46930661/padrino-g-cannot-load-such-file-sequel-plugins-schema/47641213#47641213", "title": "padrino g: cannot load such file -- sequel/plugins/schema", "body": "<p>The Sequel gem can't find the schema plugin, but the blog tutorial project doesn't seem to need it. Open up the blog-tutorial/config/database.rb file, and comment out the first line:</p>\n\n<pre><code>#Sequel::Model.plugin(:schema)\nSequel::Model.raise_on_save_failure = false # Do not throw exceptions on failure\nSequel::Model.db = case Padrino.env\n  when :development then Sequel.connect(\"sqlite://db/blog_tutorial_development.db\", :loggers =&gt; [logger])\n  when :production  then Sequel.connect(\"sqlite://db/blog_tutorial_production.db\",  :loggers =&gt; [logger])\n  when :test        then Sequel.connect(\"sqlite://db/blog_tutorial_test.db\",        :loggers =&gt; [logger])\nend\n</code></pre>\n\n<p>I tested the whole project like this, except the RSS feed part at the end, and everything worked for me.</p>\n"}], "owner": {"reputation": 161, "user_id": 846437, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/240b60897b668ee3ae95dd134b8b11e4?s=128&d=identicon&r=PG", "display_name": "lasoweq", "link": "https://stackoverflow.com/users/846437/lasoweq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 485, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1512418282, "creation_date": 1508929202, "question_id": 46930661, "link": "https://stackoverflow.com/questions/46930661/padrino-g-cannot-load-such-file-sequel-plugins-schema", "title": "padrino g: cannot load such file -- sequel/plugins/schema", "body": "<p>new to Ruby, decided to start with Padrino framework</p>\n\n<p>was following <a href=\"http://padrinorb.com/guides/getting-started/blog-tutorial/\" rel=\"nofollow noreferrer\">http://padrinorb.com/guides/getting-started/blog-tutorial/</a></p>\n\n<p>I created my project using <code>padrino g project blog-tutorial -e erb -c scss -s jquery -d sequel -a mysql2 -b</code>, then I tried to make a model <code>padrino g model post title:string body:text created_at:datetime</code></p>\n\n<p>but instead I get an error:</p>\n\n<pre><code>/home/user/.rvm/gems/ruby-2.4.1/gems/sequel-5.1.0/lib/sequel/model/base.rb:914:in `require': cannot load such file -- sequel/plugins/schema (LoadError)\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/sequel-5.1.0/lib/sequel/model/base.rb:914:in `plugin_module'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/sequel-5.1.0/lib/sequel/model/base.rb:533:in `plugin'\n        from /home/user/Sites/blog-tutorial/config/database.rb:1:in `&lt;top (required)&gt;'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/padrino-core-0.14.1.1/lib/padrino-core/reloader.rb:91:in `require'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/padrino-core-0.14.1.1/lib/padrino-core/reloader.rb:91:in `safe_load'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/padrino-core-0.14.1.1/lib/padrino-core/loader.rb:154:in `block in require_dependencies'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/padrino-core-0.14.1.1/lib/padrino-core/loader.rb:152:in `each'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/padrino-core-0.14.1.1/lib/padrino-core/loader.rb:152:in `require_dependencies'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/padrino-core-0.14.1.1/lib/padrino-core/loader.rb:57:in `load!'\n        from /home/user/Sites/blog-tutorial/config/boot.rb:60:in `&lt;top (required)&gt;'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/padrino-gen-0.14.1.1/lib/padrino-gen/generators/cli.rb:26:in `require'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/padrino-gen-0.14.1.1/lib/padrino-gen/generators/cli.rb:26:in `load_boot'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `block in invoke_all'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `each'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `map'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `invoke_all'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/thor-0.20.0/lib/thor/group.rb:232:in `dispatch'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/thor-0.20.0/lib/thor/base.rb:466:in `start'\n        from /home/user/.rvm/gems/ruby-2.4.1/gems/padrino-gen-0.14.1.1/bin/padrino-gen:16:in `&lt;main&gt;'\n</code></pre>\n\n<p>can't find a solution for this (<code>mysql-devel</code> is installed, <code>mysql2</code> gem too)</p>\n\n<p><code>config/database.rb</code> has valid credentials for db connection, e.g. <code>mysql2://root:1@localhost/my_db</code>. Also tried to pass user/password in parameters</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "service-worker"], "answers": [{"comments": [{"owner": {"reputation": 2605, "user_id": 5387729, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/5ydk0.jpg?s=128&g=1", "display_name": "Rijo", "link": "https://stackoverflow.com/users/5387729/rijo"}, "edited": false, "score": 0, "creation_date": 1508932475, "post_id": 46931649, "comment_id": 80810213, "body": "If you r not getting solution from firebase document, I&#39;ll explained detail."}, {"owner": {"reputation": 500, "user_id": 4511009, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/6268aff8a32d4666a7c0ed9b418f6bb4?s=128&d=identicon&r=PG&f=1", "display_name": "calvin sugianto", "link": "https://stackoverflow.com/users/4511009/calvin-sugianto"}, "edited": false, "score": 0, "creation_date": 1509089343, "post_id": 46931649, "comment_id": 80886560, "body": "when i use this firebase, i do not need serviceworker-rails gem right?"}, {"owner": {"reputation": 2605, "user_id": 5387729, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/5ydk0.jpg?s=128&g=1", "display_name": "Rijo", "link": "https://stackoverflow.com/users/5387729/rijo"}, "reply_to_user": {"reputation": 500, "user_id": 4511009, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/6268aff8a32d4666a7c0ed9b418f6bb4?s=128&d=identicon&r=PG&f=1", "display_name": "calvin sugianto", "link": "https://stackoverflow.com/users/4511009/calvin-sugianto"}, "edited": false, "score": 0, "creation_date": 1509095619, "post_id": 46931649, "comment_id": 80890255, "body": "Yes bro , Its not needed , If you satisfy with my answer please like it"}, {"owner": {"reputation": 500, "user_id": 4511009, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/6268aff8a32d4666a7c0ed9b418f6bb4?s=128&d=identicon&r=PG&f=1", "display_name": "calvin sugianto", "link": "https://stackoverflow.com/users/4511009/calvin-sugianto"}, "edited": false, "score": 0, "creation_date": 1509098169, "post_id": 46931649, "comment_id": 80891988, "body": "i think i got the solution suddenly with serviceworker-rails, i just need to save subscription keys to AdminUser fields every he/she subscribe push notifications, and then when i would like to push notification, just send it from every AdminUser subscription field, and it works! Thank you for your assistance, i will upvote it, but still, i&#39;m using serviceworker-rails because i have already set up all of it :)"}], "tags": [], "owner": {"reputation": 2605, "user_id": 5387729, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/5ydk0.jpg?s=128&g=1", "display_name": "Rijo", "link": "https://stackoverflow.com/users/5387729/rijo"}, "is_accepted": false, "score": 1, "last_activity_date": 1509081889, "last_edit_date": 1509081889, "creation_date": 1508932108, "answer_id": 46931649, "question_id": 46930467, "link": "https://stackoverflow.com/questions/46930467/push-notification-with-service-worker-without-subscribe/46931649#46931649", "title": "push notification with Service Worker without subscribe", "body": "<p>You can send push notification from admin side using <code>curl</code> function. I did push notification recently using java script and PHP. You can send same as ruby on rails. Please refer <a href=\"https://www.firebase.google.com\" rel=\"nofollow noreferrer\">firebase.google.com.</a> You will get better idea. </p>\n\n<p>Using firebase three files is needed to send push notification. FIrst html/php/ruby file for allow user to accept permission. Second Service worker file upload in the root folder. Third server file need to send push notification for the individual token or group token. When user allows the notification you will get a token. You can save the token in the database and send the push notification.</p>\n\n<p>Html,</p>\n\n<pre><code>   &lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"https://www.gstatic.com/firebasejs/4.3.0/firebase.js\"&gt;&lt;/script&gt;\n    &lt;script&gt;\n      // Initialize Firebase\n      var config = {\n        apiKey: \"yours\",\n        authDomain: \"yours\",\n        databaseURL: \"yours\",\n        projectId: \"yours\",\n        storageBucket: \"yours\",\n        messagingSenderId: \"yours\"\n      };\n      firebase.initializeApp(config);\n      const messaging = firebase.messaging();\n      messaging.requestPermission().then(function(){\n        console.log('Have permoission');\n        console.log(messaging.getToken());\n        return messaging.getToken();\n      }).then(function(token){\n//you can insert token value to your database \n        $.post( \"\", { token: token, action: 'push-notification' }, function( data ) {\n        console.log(token);\n\n        })\n      })\n      .catch(function(err){\n        console.log('Error occured');\n      })\n      messaging.onMessage(function(payload){\n        console.log(payload);\n      });\n    &lt;/script&gt;\n</code></pre>\n\n<p>firebase-messaging-sw.js</p>\n\n<pre><code>importScripts('https://www.gstatic.com/firebasejs/4.3.0/firebase-app.js');\nimportScripts('https://www.gstatic.com/firebasejs/4.3.0/firebase-messaging.js');\n  var config = {\n     apiKey: \"yours\",\n        authDomain: \"yours\",\n        databaseURL: \"yours\",\n        projectId: \"yours\",\n        storageBucket: \"yours\",\n        messagingSenderId: \"yours\"\n  };\n  firebase.initializeApp(config);\n  const messaging = firebase.messaging();\n</code></pre>\n\n<p>Server code here i'm using php. you can use any server language </p>\n\n<pre><code>function send_notification($tokens)\n{\n    $url = 'https://fcm.googleapis.com/fcm/send';\n    $fields = array(\n        'to' =&gt; $tokens, \n        'notification' =&gt; array('title' =&gt; 'Bumper Prize', 'body' =&gt; 'Shop for more than 10,000 get a chance to Bumper Prize', 'click_action' =&gt; 'https://www.gardensgalleria.com/', 'icon'=&gt; 'https://www.gardensgalleria.com/notification_image/1507791852notification_logo.png'), \n        'priority' =&gt; 10\n    );\n    $headers = array(\n    'Authorization:key = yours',\n    'Content-Type: application/json'\n    );\n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, $url);\n    curl_setopt($ch, CURLOPT_POST, true);\n    curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);\n    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);\n    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($fields));\n    $server_output = curl_exec($ch);\n    if ($server_output === FALSE) { die('Curl failed:' .curl_error($ch)); }\n    curl_close ($ch);\n    return $server_output;\n} \n    $sql_select = mysql_query(\"SELECT token FROM notification_info\");\n    $tokens = array();\n    while($row_retailer=mysql_fetch_assoc($sql_select))\n    {\n        echo send_notification($row_retailer['token']).'&lt;br&gt;----';\n    } \n</code></pre>\n\n<p>Try this one.. May this will help you little bit  </p>\n"}, {"comments": [{"owner": {"reputation": 6976, "user_id": 236062, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/63c7436d6b05ba912a5cb0b0bf254c93?s=128&d=identicon&r=PG", "display_name": "Zibri", "link": "https://stackoverflow.com/users/236062/zibri"}, "edited": false, "score": 0, "creation_date": 1516982978, "post_id": 46972423, "comment_id": 83923616, "body": "How to do this with CURL? (notification using vapid)"}, {"owner": {"reputation": 500, "user_id": 4511009, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/6268aff8a32d4666a7c0ed9b418f6bb4?s=128&d=identicon&r=PG&f=1", "display_name": "calvin sugianto", "link": "https://stackoverflow.com/users/4511009/calvin-sugianto"}, "reply_to_user": {"reputation": 6976, "user_id": 236062, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/63c7436d6b05ba912a5cb0b0bf254c93?s=128&d=identicon&r=PG", "display_name": "Zibri", "link": "https://stackoverflow.com/users/236062/zibri"}, "edited": false, "score": 0, "creation_date": 1517218471, "post_id": 46972423, "comment_id": 83989305, "body": "i haven&#39;t use CURL for push notifications, so i&#39;m not capable for answering this"}], "tags": [], "owner": {"reputation": 500, "user_id": 4511009, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/6268aff8a32d4666a7c0ed9b418f6bb4?s=128&d=identicon&r=PG&f=1", "display_name": "calvin sugianto", "link": "https://stackoverflow.com/users/4511009/calvin-sugianto"}, "is_accepted": true, "score": 0, "last_activity_date": 1509098416, "creation_date": 1509098416, "answer_id": 46972423, "question_id": 46930467, "link": "https://stackoverflow.com/questions/46930467/push-notification-with-service-worker-without-subscribe/46972423#46972423", "title": "push notification with Service Worker without subscribe", "body": "<p>i got the solution! </p>\n\n<p>Just save all of subscription hash after subscribe push notification with this code</p>\n\n<pre><code>reg.pushManager\n.subscribe({\n    userVisibleOnly: true,\n    applicationServerKey: window.vapidPublicKey\n}).then(function(subscription) {\n  $.post( \"/api/v1/subscribe\", { 'subscription': subscription.toJSON() })\n});\n</code></pre>\n\n<p>after that, save it in Admin's subscription field. Whenever a visitor sign up on website, just push it using all of admin's subscription field</p>\n\n<pre><code>Webpush.payload_send(\n      message: params[:message],\n      endpoint: admin.subscription[:endpoint],\n      p256dh: admin.subscription[:keys][:p256dh],\n      auth: admin.subscription[:keys][:auth],\n      ttl: 24 * 60 * 60,\n      vapid: {\n          subject: 'mailto:yourname@yourdomain.com',\n          public_key: ENV['VAPID_PUBLIC_KEY'],\n          private_key: ENV['VAPID_PRIVATE_KEY']\n      }\n  )\n</code></pre>\n"}], "owner": {"reputation": 500, "user_id": 4511009, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/6268aff8a32d4666a7c0ed9b418f6bb4?s=128&d=identicon&r=PG&f=1", "display_name": "calvin sugianto", "link": "https://stackoverflow.com/users/4511009/calvin-sugianto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1537, "favorite_count": 0, "accepted_answer_id": 46972423, "answer_count": 2, "score": 0, "last_activity_date": 1509098416, "creation_date": 1508928663, "last_edit_date": 1509003912, "question_id": 46930467, "link": "https://stackoverflow.com/questions/46930467/push-notification-with-service-worker-without-subscribe", "title": "push notification with Service Worker without subscribe", "body": "<p>right now i'm using push notification from this library <a href=\"https://github.com/rossta/serviceworker-rails\" rel=\"nofollow noreferrer\">https://github.com/rossta/serviceworker-rails</a></p>\n\n<p>I have followed the instructions and i have success implemented it, (i got the push notification).\nBut now, i'm wondering whether is it possible for user to push notification without subscribe ? Because i wanted my push notification is sent after people register on my sign up form, and only admin who can subscribe &amp; get push notification from new user registration.</p>\n\n<p>This is my script when a new user visit and sign up for the first time</p>\n\n<pre><code>   if(navigator.serviceWorker) {\n        console.log('Begin to push notif');\n\n        navigator.serviceWorker.register('/serviceworker.js')\n            .then(function(reg) {\n                console.log('Register service worker');\n                navigator.serviceWorker.ready\n                    .then(function(serviceWorkerRegistration) {\n                        serviceWorkerRegistration.pushManager.getSubscription()\n                            .then(function(subscription) {\n                                $.post('/push', {\n                                    subscription: subscription.toJSON(),\n                                    message: 'There is a new registered User!'\n                                });\n                            });\n                    });\n            });\n    }\n</code></pre>\n\n<p>From these code, it would have work if only we already has subscribe push notification, but what i want to do is, visitor trigger push notifications to all of subscriber (only super admin who has subscribe push notification from my dashboard). Any solution to get all of subscriptions for push to all of admin who has subscribe from my website ? </p>\n\n<p>This is my backend code when push notification is triggered</p>\n\n<pre><code>result = Webpush.payload_send(\n    message: params[:message],\n    endpoint: params[:subscription][:endpoint],\n    p256dh: params[:subscription][:keys][:p256dh],\n    auth: params[:subscription][:keys][:auth],\n    ttl: 24 * 60 * 60,\n    vapid: {\n      subject: 'mailto:calvin@thechordgenius.com',\n      public_key: ENV['VAPID_PUBLIC_KEY'],\n      private_key: ENV['VAPID_PRIVATE_KEY']\n    }\n)\n</code></pre>\n"}, {"tags": ["ruby", "fizzbuzz"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 6, "creation_date": 1508928708, "post_id": 46930366, "comment_id": 80807612, "body": "The exact purpose of the foobar problem was to detect/exclude people who write code like this. So indeed, the problem is functioning as intended."}, {"owner": {"reputation": 171, "user_id": 5207118, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7dcccd4f819418a82891bbda6a0c9d40?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel A.Rahman", "link": "https://stackoverflow.com/users/5207118/nabeel-a-rahman"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1508928919, "post_id": 46930366, "comment_id": 80807746, "body": "currently my code will display 1 through 100 but will not actually print out the case statements when it is divisible by 3 or 5 or both ....What am I doing wrong here ?"}, {"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 3, "creation_date": 1508929176, "post_id": 46930366, "comment_id": 80807953, "body": "Read about the <a href=\"https://ruby-doc.org/core-2.4.1/doc/syntax/control_expressions_rdoc.html#label-case+Expression\" rel=\"nofollow noreferrer\"><code>case</code> expressions</a> in Ruby until you find it obvious why the posted code always takes the <code>else</code> branch."}, {"owner": {"reputation": 171, "user_id": 5207118, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7dcccd4f819418a82891bbda6a0c9d40?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel A.Rahman", "link": "https://stackoverflow.com/users/5207118/nabeel-a-rahman"}, "reply_to_user": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1508931002, "post_id": 46930366, "comment_id": 80809191, "body": "@axiac ...ok I see what I did wrong ..Here is the new implementation:         def display(item_count)    n = 1     while n &lt;= item_count       case         when (n % 3 ==0 &amp;&amp; n % 5 == 0)            puts &quot;Foobar&quot;         when n % 5 == 0           puts &quot;Bar&quot;         when n % 3 ==0            puts &quot;Foo&quot;         else           puts &quot;#{n}&quot;       end #--  case end stmt     n = n + 1     end #while end statement end #end satement for metod   puts &quot; How many items do you want to see&quot; item_count = gets.chomp.to_i puts &quot;#{display(item_count)}&quot;"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508931110, "post_id": 46930366, "comment_id": 80809270, "body": "@NabeelA.Rahman: JFYI, multiline code snippets in comments are unreadable. Better post them as links to gist.github.com (or something) or add to the question (when appropriate)."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 2, "creation_date": 1508933642, "post_id": 46930366, "comment_id": 80811076, "body": "This is better known as fizzbuzz."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1508930547, "post_id": 46930856, "comment_id": 80808870, "body": "Very functional, not very readable. :) Let&#39;s see if I can come up with a better snippet."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508931041, "post_id": 46930856, "comment_id": 80809231, "body": "<a href=\"https://pastebin.com/iyYAkAbL\" rel=\"nofollow noreferrer\">Extensible</a> solution. Although even less readable. :/"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508931376, "post_id": 46930856, "comment_id": 80809469, "body": "@SergioTulentsev I had exactly this in the first version, but later I decided that looping 2 elements does not make any sense :) Of course, <code>case</code> is a way to go here."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508932115, "post_id": 46930856, "comment_id": 80809966, "body": "I thought I had a <a href=\"https://pastebin.com/DhUAgek7\" rel=\"nofollow noreferrer\">beginning of a smart-ass solution</a>, but can&#39;t figure out how to use that with <code>.grep</code> (in a nice clean way). Oh well..."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508932438, "post_id": 46930856, "comment_id": 80810188, "body": "@SergioTulentsev like that: <code>(1..gets.to_i).map { |i| filters.map { |f, v| v if f === i }.join.tap { |e| e &lt;&lt; i.to_s if e.empty? }  }</code>? It could be shorter with a temporary local variable for <code>filters.map.compact</code>, but I hate local variables."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508932651, "post_id": 46930856, "comment_id": 80810346, "body": "The idea was to use something that will hide the <code>===</code> and therefore look like magic. <code>grep</code> is a good example, <code>case</code> is another."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508933288, "post_id": 46930856, "comment_id": 80810816, "body": "Check this out! <a href=\"https://gist.github.com/stulentsev/b7fc3830c9d21a115308f275111cf549\" rel=\"nofollow noreferrer\">gist.github.com/stulentsev/b7fc3830c9d21a115308f275111cf549</a>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508933652, "post_id": 46930856, "comment_id": 80811084, "body": "@SergioTulentsev Monadic composition! I like it."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1508934798, "post_id": 46930856, "comment_id": 80811937, "body": "This complete re-engineering of the solution does nothing to answer OP&#39;s question."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1508935319, "post_id": 46930856, "comment_id": 80812315, "body": "@Max <i>\u201cAny answer that gets the asker going in the right direction is helpful\u201d</i> \u2014<a href=\"https://stackoverflow.com/help/how-to-answer\">here</a>."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1508929821, "creation_date": 1508929821, "answer_id": 46930856, "question_id": 46930366, "link": "https://stackoverflow.com/questions/46930366/foo-bar-not-printing-the-correct-output/46930856#46930856", "title": "foo bar not printing the correct output", "body": "<pre><code>print \"Enter amount of times&gt; \"\n(1..gets.to_i).each do |i|\n  puts(\n    \"\".tap do |res|\n      res &lt;&lt; \"foo\" if (i % 3).zero?\n      res &lt;&lt; \"bar\" if (i % 5).zero?\n      res &lt;&lt; i.to_s if res.empty?\n    end)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1508931411, "post_id": 46931149, "comment_id": 80809493, "body": "This is <b>not</b> a ruby way by any means. Three subsequent loops instead of the only one required immediately strikes this code out from being acceptable."}, {"owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508931921, "post_id": 46931149, "comment_id": 80809837, "body": "The real world doesn&#39;t work like that; your objection is pedantic outside the scope of scalability.  Silicon is cheap compared to programmer time.  If scalability were a primary concern, you could in fact do the same thing with a single map.with_index, but it would be ugly.  Ruby code is most often used to transport results over a network, or to transform stored data and store it again. For that you must put your results in a data structure."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1508931998, "post_id": 46931149, "comment_id": 80809893, "body": "This code is completely unreadable as well (read: it\u2019s a perfect example of how one <i>should never ever write ruby</i>.) Mutating lists inplace, three unnecessary ternaries, redundant checks: all that smells."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508932168, "post_id": 46931149, "comment_id": 80809993, "body": "<i>Sidenote:</i> you do not need <code>to_a</code> in the initial line, ranges are iterable as well."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508932283, "post_id": 46931149, "comment_id": 80810084, "body": "Although I would have worded it diffferently, I will have to agree with mudasobwa. This is not what idiomatic ruby looks like. Out of all snippets in this topic, the one in the question is closest to ruby way (needs some fixes, obviously. Like separating printing from calculation)"}, {"owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "edited": false, "score": 0, "creation_date": 1508932564, "post_id": 46931149, "comment_id": 80810283, "body": "What I mean by &#39;the ruby way&#39; is that everything is an object, so why would you write code that does not operate on an object, let alone one you can&#39;t use for anything?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508932754, "post_id": 46931149, "comment_id": 80810421, "body": "@Tom: with that I agree, printing should be extracted."}, {"owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "edited": false, "score": 0, "creation_date": 1508932934, "post_id": 46931149, "comment_id": 80810544, "body": "Thanks. That&#39;s the main thing I was going for.  Beyond that, I did learn something; I had not seen tap before.  Good stuff."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1509018748, "post_id": 46931149, "comment_id": 80854129, "body": "Much better, this. Only now your <code>map</code> returns mixed data types. Do you think this is a problem or is it intended?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1509019710, "post_id": 46931149, "comment_id": 80854785, "body": "And you&#39;re right, of course. My monadic solution is the slowest of the bunch, but, arguably, most beatiful :)"}, {"owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "edited": false, "score": 0, "creation_date": 1509128206, "post_id": 46931149, "comment_id": 80909803, "body": "The mixed data types were actually intentional, and the original answer had that as well.  Ruby is a dynamically typed language, there is no reason to do otherwise.  Enumerating the array later can duck-type individual values if necessary.  Come to think of it, it would also be more efficient to use symbols :foo, :bar, and :foobar rather than strings, not just for the ruby virtual machine and the algorithm but for storage as well."}], "tags": [], "owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "is_accepted": false, "score": -1, "last_activity_date": 1509128719, "last_edit_date": 1509128719, "creation_date": 1508930658, "answer_id": 46931149, "question_id": 46930366, "link": "https://stackoverflow.com/questions/46930366/foo-bar-not-printing-the-correct-output/46931149#46931149", "title": "foo bar not printing the correct output", "body": "<p>Displaying something is one thing; having the result of a function available in memory for further use, such as transport over a network connection or storage, is something else. In ruby everything is an object, so you should operate on and with objects.  This is what ruby was made for.</p>\n\n<p>Edited to address looping multiple times and readability.</p>\n\n<p>My original was decried as unreadable, and then someone came up with a monadic solution using a lambda literal and monkey patching.  Even a seasoned programmer will be challenged to follow its logic, and the stack manipulation involved in the interpreter throws scalability out the window anyway.  A procedural block in a single loop addresses all of that without being pedantic.  \"Readable\" also implies \"understandable.\"</p>\n\n<p>Freezing the string literals should not be necessary in ruby >= 2.4; they should be automatically frozen, but since the single-loop solution is to address scalability (imagine calling it a million times), one should not overlook this optimization.  Also, I have reduced it to a single conditional statement within the block, which means greater scalability.</p>\n\n<pre><code>print 'How many items do you want to see: '.freeze\n\nlist = (1..gets.to_i).collect do |i|\n  div_by_3 = (i % 3).zero?\n  div_by_5 = (i % 5).zero?\n  case \n    when div_by_3 &amp;&amp; div_by_5\n      :foobar\n    when div_by_3\n      :foo\n    when div_by_5\n      :bar\n    else\n     i\n  end\nend\n\nputs list.to_s\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>How many items do you want to see: 50\n[1, 2, :foo, 4, :bar, :foo, 7, 8, :foo, :bar, 11, :foo, 13, 14, :foobar, 16, 17, :foo, 19, :bar, :foo, 22, 23, :foo, :bar, 26, :foo, 28, 29, :foobar, 31, 32, :foo, 34, :bar, :foo, 37, 38, :foo, :bar, 41, :foo, 43, 44, :foobar, 46, 47, :foo, 49, :bar]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508934704, "post_id": 46932464, "comment_id": 80811879, "body": "@SergioTulentsev I&#39;m not trying to post a complete working solution, if you actually read my answer. I&#39;m showing the OP what logic his code is actually performing. :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508934770, "post_id": 46932464, "comment_id": 80811921, "body": "Ah, sorry, my bad :)"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1508934546, "last_edit_date": 1508934546, "creation_date": 1508934506, "answer_id": 46932464, "question_id": 46930366, "link": "https://stackoverflow.com/questions/46930366/foo-bar-not-printing-the-correct-output/46932464#46932464", "title": "foo bar not printing the correct output", "body": "<p>The <a href=\"https://ruby-doc.org/core/doc/syntax/control_expressions_rdoc.html#label-case+Expression\" rel=\"nofollow noreferrer\">case expression</a> compares the argument you give it with each of the <code>when</code> expressions using <code>===</code> (which is the same as <code>==</code> in most cases). So your code is roughly equivalent to</p>\n\n<pre><code>if (n % 3 == 0) === n\n  puts \"foo\"\nelsif (n % 5 == 0) === n\n  puts \"bar\"\nelsif (n % 3 == 0 &amp;&amp; n % 5 == 0) === n\n  puts \"foobar\"\nelse\n  puts \"#{n}\"\nend\n</code></pre>\n\n<p>All of the <code>when</code> expressions return <code>true</code> or <code>false</code>, so every case fails and you end up in the <code>else</code>. Just use this <code>if</code> format instead of <code>case</code> and you can do what you want (though you'll need to rearrange your conditions to get the right output).</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1509018525, "post_id": 46944818, "comment_id": 80853961, "body": "&quot;must still return true or false&quot; - not quite. Just truthy/falsy, as it is in most of ruby."}, {"owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1509128009, "post_id": 46944818, "comment_id": 80909722, "body": "You are correct, and that is an important distinction to make."}], "tags": [], "owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1508984133, "creation_date": 1508984133, "answer_id": 46944818, "question_id": 46930366, "link": "https://stackoverflow.com/questions/46930366/foo-bar-not-printing-the-correct-output/46944818#46944818", "title": "foo bar not printing the correct output", "body": "<p>You can use a case statement in ruby without an argument.  The when clause must still return true or false.</p>\n\n<pre><code>case\nwhen true\n  puts 'this happens'\nwhen false\n  puts 'this does not happen'\nend\n</code></pre>\n\n<p>Therefore, the code in the original post will work (at least, the case statement) if you simply change the</p>\n\n<pre><code>case n\n</code></pre>\n\n<p>into</p>\n\n<pre><code>case\n</code></pre>\n\n<p>and move the 'foobar' test to the top of the \"when\" list.  My other answer also uses this construct, but eliminates the stack manipulation and yields a storable/transmittable object instead of merely displaying results.</p>\n\n<p>Note: calling the zero? method on an object is faster than comparing it to a literal 0.  (x.zero? is faster than x == 0).</p>\n"}], "owner": {"reputation": 171, "user_id": 5207118, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7dcccd4f819418a82891bbda6a0c9d40?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel A.Rahman", "link": "https://stackoverflow.com/users/5207118/nabeel-a-rahman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 46944818, "answer_count": 4, "score": -1, "last_activity_date": 1509128719, "creation_date": 1508928392, "last_edit_date": 1508934043, "question_id": 46930366, "link": "https://stackoverflow.com/questions/46930366/foo-bar-not-printing-the-correct-output", "title": "foo bar not printing the correct output", "body": "<p>Currently my code will display 1 through 100 but will not actually print out the case statements when it is divisible by 3 or 5 or both ....What am I doing wrong here?</p>\n\n<pre><code>def display(item_count)\n  n = 1  \n  while n &lt;= item_count\n    case n\n    when n % 3 == 0 \n      puts \"foo\"\n    when n % 5 == 0\n      puts \"bar\"\n    when (n % 3 ==0 &amp;&amp; n % 5 == 0) \n      puts \"foobar\"\n    else\n      puts \"#{n}\"\n    end #--  case end stmt\n    n = n + 1\n  end #while end statement\nend #end satement for metod\n\nputs \" How many items do you want to see\"\nitem_count = gets.chomp.to_i\nputs \"#{display(item_count)}\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "arguments", "block"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1508927430, "creation_date": 1508927430, "answer_id": 46930048, "question_id": 46929956, "link": "https://stackoverflow.com/questions/46929956/writing-a-better-method-with-default-options-and-a-block-in-ruby/46930048#46930048", "title": "Writing a better method with default options and a block in ruby", "body": "<p>Use keyword parameters with defaults:</p>\n\n<pre><code>def m(o1: 42, o2: :foo, o3: :bar, &amp;block)\n  puts [o1, o2, o3].inspect\nend\n\nm(o3: 3.14)\n#\u21d2\u00a0[42, :foo, 3.14]      \n</code></pre>\n\n<p>or. alternatively, use double-splat:</p>\n\n<pre><code>def m(**options, &amp;block)\n  options = {o1: 42, o2: :foo, o3: :bar}.merge options\n  puts options.values.inspect\nend\n\nm(o3: 3.14)\n#\u21d2\u00a0[42, :foo, 3.14]      \n</code></pre>\n"}], "owner": {"reputation": 5735, "user_id": 269404, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jHC9T.jpg?s=128&g=1", "display_name": "MintDeparture", "link": "https://stackoverflow.com/users/269404/mintdeparture"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528695431, "creation_date": 1508927210, "last_edit_date": 1528695431, "question_id": 46929956, "link": "https://stackoverflow.com/questions/46929956/writing-a-better-method-with-default-options-and-a-block-in-ruby", "title": "Writing a better method with default options and a block in ruby", "body": "<p>I have a method in Ruby (a rails helper) that I would like to write better, it's a method that takes a lot of options as a hash, and if those options are not there it has some defaults too.</p>\n\n<p>It currently looks like this:</p>\n\n<pre><code>def some_html_helper(options = {}, &amp;block)\n    option1 = options.fetch(:option1, \"default option1 value\")\n    option2 = options.fetch(:option2, \"default option2 value\")\n    option3 = options.fetch(:option3, \"default option3 value\")\n    option4 = options.fetch(:option4, \"default option4 value\")\n    option5 = options.fetch(:option5, \"default option5 value\")\n    option6 = options.fetch(:option6, \"default option6 value\")\n    \"return html with options used here and content... #{capture(&amp;block)}\"\n  end\n</code></pre>\n\n<p>So it's possible to pass in one or no options and the rest have defaults, like this:</p>\n\n<pre><code>&lt;%= some_html_helper option3: \"not default value\", do %&gt;\n  Some content...\n&lt;% end %&gt;\n</code></pre>\n\n<p>Is there a better way to write a method like this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 7329, "user_id": 1232447, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001bb9923606697c5edf6b88955c73e8?s=128&d=identicon&r=PG&f=1", "display_name": "maximus \u30c4", "link": "https://stackoverflow.com/users/1232447/maximus-%e3%83%84"}, "edited": false, "score": 3, "creation_date": 1508925094, "post_id": 46929149, "comment_id": 80805214, "body": "What do you mean by &quot;then show it on the second iteration&quot;?"}, {"owner": {"reputation": 103, "user_id": 3403166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1403d15f674970d29504de34a00a2c9c?s=128&d=identicon&r=PG&f=1", "display_name": "tonic", "link": "https://stackoverflow.com/users/3403166/tonic"}, "reply_to_user": {"reputation": 7329, "user_id": 1232447, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001bb9923606697c5edf6b88955c73e8?s=128&d=identicon&r=PG&f=1", "display_name": "maximus \u30c4", "link": "https://stackoverflow.com/users/1232447/maximus-%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1508925220, "post_id": 46929149, "comment_id": 80805304, "body": "When the loop goes back to the beginning - I want it to show the first record that it skipped initially.  E.g. [1, 2, 3] - I want it to skip 1 on the first go so we get [2, 3]. But then on the second iteration I would like it to show [1,2,3]. As I&#39;m using a next button to show hidden divs but I need to skip the first div initially."}, {"owner": {"reputation": 7329, "user_id": 1232447, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001bb9923606697c5edf6b88955c73e8?s=128&d=identicon&r=PG&f=1", "display_name": "maximus \u30c4", "link": "https://stackoverflow.com/users/1232447/maximus-%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1508925554, "post_id": 46929149, "comment_id": 80805573, "body": "Why do you think loop will go back to beginning? Not unless you are using nested loops."}, {"owner": {"reputation": 103, "user_id": 3403166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1403d15f674970d29504de34a00a2c9c?s=128&d=identicon&r=PG&f=1", "display_name": "tonic", "link": "https://stackoverflow.com/users/3403166/tonic"}, "reply_to_user": {"reputation": 7329, "user_id": 1232447, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001bb9923606697c5edf6b88955c73e8?s=128&d=identicon&r=PG&f=1", "display_name": "maximus \u30c4", "link": "https://stackoverflow.com/users/1232447/maximus-%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1508925694, "post_id": 46929149, "comment_id": 80805673, "body": "Sorry I&#39;m probably out of my depth explaining things as I&#39;m a bit of an amateur. I&#39;m not really sure what a nested loop is. I&#39;ll add a link to my code in the main image in the next few minutes to try and show what I&#39;ve got."}, {"owner": {"reputation": 7329, "user_id": 1232447, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001bb9923606697c5edf6b88955c73e8?s=128&d=identicon&r=PG&f=1", "display_name": "maximus \u30c4", "link": "https://stackoverflow.com/users/1232447/maximus-%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1508925830, "post_id": 46929149, "comment_id": 80805778, "body": "Nested loop is loop inside loop. Check <a href=\"https://www.tutorialspoint.com/cprogramming/c_nested_loops.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cprogramming/c_nested_loops.htm</a> if you are curious."}, {"owner": {"reputation": 103, "user_id": 3403166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1403d15f674970d29504de34a00a2c9c?s=128&d=identicon&r=PG&f=1", "display_name": "tonic", "link": "https://stackoverflow.com/users/3403166/tonic"}, "reply_to_user": {"reputation": 7329, "user_id": 1232447, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001bb9923606697c5edf6b88955c73e8?s=128&d=identicon&r=PG&f=1", "display_name": "maximus \u30c4", "link": "https://stackoverflow.com/users/1232447/maximus-%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1508926964, "post_id": 46929149, "comment_id": 80806522, "body": "Thank you. I&#39;ll have a read of this later. :)"}], "answers": [{"tags": [], "owner": {"reputation": 5582, "user_id": 27060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50576d785edd6db7d1999810863bcb01?s=128&d=identicon&r=PG", "display_name": "Reuben Mallaby", "link": "https://stackoverflow.com/users/27060/reuben-mallaby"}, "is_accepted": false, "score": 7, "last_activity_date": 1508925816, "creation_date": 1508925816, "answer_id": 46929494, "question_id": 46929149, "link": "https://stackoverflow.com/questions/46929149/skip-first-record-in-loop-in-first-iteration-only/46929494#46929494", "title": "Skip first record in loop in first iteration only", "body": "<p>Use the <code>drop</code> method.</p>\n\n<pre><code>@example.drop(1).each do |item|\n...\nend\n</code></pre>\n\n<p>Afterwards use the normal <code>each</code></p>\n\n<pre><code>@example.each do |item|\n...\nend\n</code></pre>\n\n<p><a href=\"https://docs.ruby-lang.org/en/2.0.0/Array.html\" rel=\"noreferrer\">Documentation</a></p>\n"}], "owner": {"reputation": 103, "user_id": 3403166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1403d15f674970d29504de34a00a2c9c?s=128&d=identicon&r=PG&f=1", "display_name": "tonic", "link": "https://stackoverflow.com/users/3403166/tonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2635, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508926889, "creation_date": 1508924801, "last_edit_date": 1508926889, "question_id": 46929149, "link": "https://stackoverflow.com/questions/46929149/skip-first-record-in-loop-in-first-iteration-only", "title": "Skip first record in loop in first iteration only", "body": "<p>I want to create an each loop that will skip the first record on the first loop but then show it on the second iteration. Is this possible?</p>\n\n<p>I know that the following would start at the second item in the array but obviously it would still skip the first record on it's second loop around.</p>\n\n<pre><code>    &lt;% @example[1..n].each do |example| %&gt;\n      ...\n    &lt;% end %&gt;\n</code></pre>\n\n<p><strong>EDIT:</strong> To give a bit of context - this is my code currently. I don't really know javascript too well and I'm probably doing this in a more complicated way than it needs to be.</p>\n\n<p>Also could people please explain why this is a bad question when giving negative votes. I'm trying to learn from scratch. I don't know anyone who codes so I can't bounce ideas from someone so it would be nice for people to tell me if I've misunderstood the concept as I don't learn anything from a negative vote without any kind of reasoning.</p>\n\n<pre><code>&lt;div class=\"row no-gutters\"&gt;\n&lt;div class=\"col-md-8 col-sm-8  no-gutters\"&gt;\n&lt;div class=\"divs\"&gt;\n    &lt;% @example.each do |example| %&gt;\n        &lt;!--example information goes here --&gt;\n    &lt;% end %&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"col-md-4 col-sm-4  no-gutters\"&gt;\n    &lt;div class=\"row no-gutters\"&gt;\n        &lt;div class=\"col-md-12 no-gutters\" style=\"position: relative; text-align: center; color: white;\"&gt;\n            &lt;div class=\"divs2\"&gt;\n                &lt;% @example.each do |example| %&gt;\n                    &lt;!--this is the one I want to skip the first item on--&gt;\n                &lt;% end %&gt;   \n            &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-md-12 no-gutters\"&gt;\n            &lt;div class=\"container text-center\"&gt;     \n                &lt;span&gt;\n                    &lt;a id=\"prev\" class=\"hidden\"&gt;&lt;i class=\"fa fa-arrow-left\" aria-hidden=\"true\"&gt;&lt;/i&gt;&lt;/a&gt;\n                    &lt;a id=\"next\"&gt;&lt;i class=\"fa fa-arrow-right\" aria-hidden=\"true\"&gt;&lt;/i&gt;&lt;/a&gt;\n                &lt;/span&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;  \n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>$('a#next').click(function(){\n$('a#prev').removeClass('hidden');\n    });\n\n $(document).ready(function(){\n$(\".divs div\").each(function(e) {\n    if (e != 0)\n        $(this).hide();\n});\n\n$(\"#next\").click(function(){\n    if ($(\".divs div:visible\").next().length != 0)\n        $(\".divs div:visible\").next().show().prev().hide();\n    else {\n        $(\".divs div:visible\").hide();\n        $(\".divs div:first\").show();\n    }\n    return false;\n});\n\n$(\"#prev\").click(function(){\n    if ($(\".divs div:visible\").prev().length != 0)\n        $(\".divs div:visible\").prev().show().next().hide();\n    else {\n        $(\".divs div:visible\").hide();\n        $(\".divs div:last\").show();\n    }\n    return false;\n});\n\n$(document).ready(function(){\n$(\".divs2 div\").each(function(e) {\n    if (e != 0)\n        $(this).hide();\n});\n\n$(\"#next\").click(function(){\n    if ($(\".divs2 div:visible\").next().length != 0)\n        $(\".divs2 div:visible\").next().show().prev().hide();\n    else {\n        $(\".divs2 div:visible\").hide();\n        $(\".divs2 div:first\").show();\n    }\n    return false;\n});\n\n$(\"#prev\").click(function(){\n    if ($(\".divs2 div:visible\").prev().length != 0)\n        $(\".divs2 div:visible\").prev().show().next().hide();\n    else {\n        $(\".divs2 div:visible\").hide();\n        $(\".divs2 div:last\").show();\n    }\n    return false;\n}); });\n</code></pre>\n"}, {"tags": ["ruby", "vagrant", "chef-infra"], "comments": [{"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1508924932, "post_id": 46929117, "comment_id": 80805107, "body": "<code>make: gcc: Command not found</code> that means you don&#39;t have gcc installed. You need to install it, what is your operating system?"}, {"owner": {"reputation": 1384, "user_id": 7175708, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/QJYJM.png?s=128&g=1", "display_name": "Lechucico", "link": "https://stackoverflow.com/users/7175708/lechucico"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1508924972, "post_id": 46929117, "comment_id": 80805135, "body": "I know that gcc is missing, the problem is how I solve that dependency. Vagrant is provisioning a CentOS 7"}, {"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1508925121, "post_id": 46929117, "comment_id": 80805235, "body": "Try running <code>sudo yum groupinstall &#39;Development Tools&#39;</code>, this will install the usual build tools necessary on your box, including <code>gcc</code>. Not sure how <code>gcc</code> depends on installing Ruby gems, but pretty sure it&#39;s not the case."}, {"owner": {"reputation": 1384, "user_id": 7175708, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/QJYJM.png?s=128&g=1", "display_name": "Lechucico", "link": "https://stackoverflow.com/users/7175708/lechucico"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1508925195, "post_id": 46929117, "comment_id": 80805280, "body": "I know how to solve it manually. The problem is that vagrant uses chef to provision the machine. And when chef tryes to compile the recipes, it crashes because gcc is not installed."}, {"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1508925332, "post_id": 46929117, "comment_id": 80805399, "body": "Can you edit the <code>Vagrantfile</code>? if so, why don&#39;t you add that command before the chef installation?"}, {"owner": {"reputation": 1384, "user_id": 7175708, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/QJYJM.png?s=128&g=1", "display_name": "Lechucico", "link": "https://stackoverflow.com/users/7175708/lechucico"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1508925375, "post_id": 46929117, "comment_id": 80805433, "body": "How can I install gcc on VagrantFile?"}], "answers": [{"comments": [{"owner": {"reputation": 1384, "user_id": 7175708, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/QJYJM.png?s=128&g=1", "display_name": "Lechucico", "link": "https://stackoverflow.com/users/7175708/lechucico"}, "edited": false, "score": 0, "creation_date": 1508929117, "post_id": 46930203, "comment_id": 80807897, "body": "That works, but what about if I change my CentOS for an ubuntu? That wouldn&#39;t work."}, {"owner": {"reputation": 1296, "user_id": 2081387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9492856d9ec97b0caaaa6bb38665f12c?s=128&d=identicon&r=PG", "display_name": "d1ll1nger", "link": "https://stackoverflow.com/users/2081387/d1ll1nger"}, "reply_to_user": {"reputation": 1384, "user_id": 7175708, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/QJYJM.png?s=128&g=1", "display_name": "Lechucico", "link": "https://stackoverflow.com/users/7175708/lechucico"}, "edited": false, "score": 0, "creation_date": 1508929291, "post_id": 46930203, "comment_id": 80808046, "body": "Then you would write some logic to detect what os you&#39;re running and execute the appropriate command. That kind of thing is quite common."}], "tags": [], "owner": {"reputation": 1296, "user_id": 2081387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9492856d9ec97b0caaaa6bb38665f12c?s=128&d=identicon&r=PG", "display_name": "d1ll1nger", "link": "https://stackoverflow.com/users/2081387/d1ll1nger"}, "is_accepted": false, "score": 0, "last_activity_date": 1508927944, "creation_date": 1508927944, "answer_id": 46930203, "question_id": 46929117, "link": "https://stackoverflow.com/questions/46929117/chef-crashes-when-installing-gem/46930203#46930203", "title": "Chef crashes when installing gem", "body": "<p>Add a shell provisioner before the chef provisioning?</p>\n\n<p>In your Vagrantfile for example:</p>\n\n<pre><code>Vagrant.configure(\"2\") do |config|\n    config.vm.provision :shell, inline: 'yum install -y gcc'\n    config.vm.provision :chef, inline: '...'\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 501, "user_id": 4978971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12568bf3b1251cdccebcbcabdc3f241c?s=128&d=identicon&r=PG&f=1", "display_name": "JackChance", "link": "https://stackoverflow.com/users/4978971/jackchance"}, "is_accepted": false, "score": 0, "last_activity_date": 1508953752, "creation_date": 1508953752, "answer_id": 46938961, "question_id": 46929117, "link": "https://stackoverflow.com/questions/46929117/chef-crashes-when-installing-gem/46938961#46938961", "title": "Chef crashes when installing gem", "body": "<p>Recipes are perfectly capable of running arbitrary commands, so if you know how to do it manually you can do it with Chef in a pinch. That being said you should guard any arbitrary commands so they aren't run every single time the recipe runs, only when they're needed.</p>\n\n<pre><code>execute 'sudo yum groupinstall \\'Development Tools\\'' unless &lt;your logic for \ndetecting gcc goes here&gt;\n</code></pre>\n\n<p>Chef also has Ohai which gathers metadata about the run before it even starts, including what OS you're operating on, so you can make your recipe multiplatform by leveraging that.</p>\n\n<p><a href=\"https://docs.chef.io/dsl_recipe.html\" rel=\"nofollow noreferrer\">https://docs.chef.io/dsl_recipe.html</a></p>\n\n<pre><code>include_recipe 'mycookbook::debian' if node['platform_family'] == 'debian'\ninclude_recipe 'mycookbook::rhel' if node['platform_family'] == 'rhel'\n</code></pre>\n\n<p>Or, to give you more flexibility if you plan on having many platform types</p>\n\n<pre><code>possible_platforms = ['debian', 'rhel']\nif possible_platforms.contains? node['platform_family']\n   include_recipe \"mycookbook::node['platform_family']\"\nelse\n    puts 'This platform isn't valid'\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 2, "last_activity_date": 1508955735, "creation_date": 1508955735, "answer_id": 46939543, "question_id": 46929117, "link": "https://stackoverflow.com/questions/46929117/chef-crashes-when-installing-gem/46939543#46939543", "title": "Chef crashes when installing gem", "body": "<p>The Chef-y way to install <code>gcc</code> is to use the <code>build-essential</code> cookbook.</p>\n"}], "owner": {"reputation": 1384, "user_id": 7175708, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/QJYJM.png?s=128&g=1", "display_name": "Lechucico", "link": "https://stackoverflow.com/users/7175708/lechucico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 46939543, "answer_count": 3, "score": 0, "last_activity_date": 1509005288, "creation_date": 1508924678, "last_edit_date": 1509005288, "question_id": 46929117, "link": "https://stackoverflow.com/questions/46929117/chef-crashes-when-installing-gem", "title": "Chef crashes when installing gem", "body": "<p>Im using chef and vagrant as provisioner.</p>\n\n<p>When I try to install gems as follows, the app crashes:</p>\n\n<p>metadata.rb</p>\n\n<pre><code>gem 'faraday'\ngem 'json'\n</code></pre>\n\n<p>default.rb</p>\n\n<pre><code>require 'faraday'\nrequire 'json'\n\nconn = Faraday.new(:url =&gt; 'http://127.0.0.1:8200')\n</code></pre>\n\n<p>This error raises:</p>\n\n<pre><code>==&gt; default: Running handlers:\n==&gt; default: [2017-10-25T09:42:43+00:00] ERROR: Running exception handlers\n==&gt; default: Running handlers complete\n==&gt; default: [2017-10-25T09:42:43+00:00] ERROR: Exception handlers complete\n==&gt; default: Chef Client failed. 0 resources updated in 19 seconds\n==&gt; default: [2017-10-25T09:42:43+00:00] INFO: Sending resource update report (run-id: 7f4593f5-1c86-409c-95fe-988f09501740)\n==&gt; default: [2017-10-25T09:42:43+00:00] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out\n==&gt; default: [2017-10-25T09:42:43+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report\n==&gt; default: [2017-10-25T09:42:43+00:00] ERROR: Expected process to exit with [0], but received '5'\n==&gt; default: ---- Begin output of bundle install ----\n==&gt; default: STDOUT: Don't run Bundler as root. Bundler can ask for sudo if it is needed, and\n==&gt; default: installing your bundle as root will break this application for all non-root\n==&gt; default: users on this machine.\n==&gt; default: Fetching gem metadata from https://rubygems.org/\n==&gt; default: Fetching version metadata from https://rubygems.org/\n==&gt; default: Resolving dependencies...\n==&gt; default: Installing multipart-post 2.0.0\n==&gt; default: Installing json 2.1.0 with native extensions\n==&gt; default:\n==&gt; default: Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n==&gt; default:\n==&gt; default:     current directory: /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/json-2.1.0/ext/json/ext/generator\n==&gt; default: /opt/chef/embedded/bin/ruby -r ./siteconf20171025-3434-1qh8whd.rb extconf.rb\n==&gt; default: creating Makefile\n==&gt; default:\n==&gt; default: current directory: /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/json-2.1.0/ext/json/ext/generator\n==&gt; default: make \"DESTDIR=\" clean\n==&gt; default:\n==&gt; default: current directory: /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/json-2.1.0/ext/json/ext/generator\n==&gt; default: make \"DESTDIR=\"\n==&gt; default: compiling generator.c\n==&gt; default: make: gcc: Command not found\n==&gt; default: make: *** [generator.o] Error 127\n==&gt; default:\n==&gt; default: make failed, exit code 2\n==&gt; default:\n==&gt; default: Gem files will remain installed in /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/json-2.1.0 for inspection.\n==&gt; default: Results logged to /opt/chef/embedded/lib/ruby/gems/2.3.0/extensions/x86_64-linux/2.3.0/json-2.1.0/gem_make.out\n==&gt; default: Using bundler 1.12.5\n==&gt; default: Installing faraday 0.13.1\n==&gt; default: An error occurred while installing json (2.1.0), and Bundler cannot continue.\n==&gt; default: Make sure that `gem install json -v '2.1.0'` succeeds before bundling.\n==&gt; default: STDERR:\n==&gt; default: ---- End output of bundle install ----\n==&gt; default: Ran bundle install returned 5\n==&gt; default: [2017-10-25T09:42:43+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)\nChef never successfully completed! Any errors should be visible in the\noutput above. Please fix your recipes so that they properly complete.\n</code></pre>\n\n<p>It seems that gcc is missing, but I can't install it because it tries first to install gems and then executes the recipe, so it crashes before I can do anything.</p>\n\n<p>-- EDIT -- </p>\n\n<p>I've added these lines and is working:</p>\n\n<p>metadata.rb: (Remove gem dependency from here)</p>\n\n<pre><code>depends 'hashicorp-vault', '~&gt; 2.5.0'\ndepends 'build-essential', '~&gt; 8.0.3'\n</code></pre>\n\n<p>default.rb:</p>\n\n<pre><code>include_recipe 'hashicorp-vault::default'\nchef_gem 'faraday'\nchef_gem 'json'\nrequire 'faraday'\nrequire 'json'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "puma", "pry"], "comments": [{"owner": {"reputation": 1215, "user_id": 2824935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/dkDTX.jpg?s=128&g=1", "display_name": "garythegoat", "link": "https://stackoverflow.com/users/2824935/garythegoat"}, "edited": false, "score": 0, "creation_date": 1508943154, "post_id": 46928771, "comment_id": 80818405, "body": "What command are you using to start your Puma server?"}, {"owner": {"reputation": 842, "user_id": 5908592, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/k2qVE.jpg?s=128&g=1", "display_name": "James Stonehill", "link": "https://stackoverflow.com/users/5908592/james-stonehill"}, "reply_to_user": {"reputation": 1215, "user_id": 2824935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/dkDTX.jpg?s=128&g=1", "display_name": "garythegoat", "link": "https://stackoverflow.com/users/2824935/garythegoat"}, "edited": false, "score": 0, "creation_date": 1508952078, "post_id": 46928771, "comment_id": 80824042, "body": "@garythegoat just using <code>rails s</code> but I&#39;ve also tried <code>puma -C config&#47;puma.rb</code> and I doesn&#39;t seem to make any difference."}, {"owner": {"reputation": 4835, "user_id": 1478217, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/01c6aaf3f334a8b79cd11966423018a0?s=128&d=identicon&r=PG", "display_name": "Slicedpan", "link": "https://stackoverflow.com/users/1478217/slicedpan"}, "edited": false, "score": 0, "creation_date": 1508953135, "post_id": 46928771, "comment_id": 80824688, "body": "I think your condition is wrong. Try removing it or changing it to <code>ENV[&quot;RAILS_ENV&quot;] == &quot;development&quot;</code>"}, {"owner": {"reputation": 1215, "user_id": 2824935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/dkDTX.jpg?s=128&g=1", "display_name": "garythegoat", "link": "https://stackoverflow.com/users/2824935/garythegoat"}, "edited": false, "score": 0, "creation_date": 1508954854, "post_id": 46928771, "comment_id": 80825646, "body": "In rails you can also do <code>Rails.env.development?</code>"}, {"owner": {"reputation": 842, "user_id": 5908592, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/k2qVE.jpg?s=128&g=1", "display_name": "James Stonehill", "link": "https://stackoverflow.com/users/5908592/james-stonehill"}, "reply_to_user": {"reputation": 4835, "user_id": 1478217, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/01c6aaf3f334a8b79cd11966423018a0?s=128&d=identicon&r=PG", "display_name": "Slicedpan", "link": "https://stackoverflow.com/users/1478217/slicedpan"}, "edited": false, "score": 0, "creation_date": 1509036557, "post_id": 46928771, "comment_id": 80866835, "body": "@Slicedpan it seems you were right. For some reason a this point RACK_ENV is not yet set but RAILS_ENV is set (by my .env file)."}], "owner": {"reputation": 842, "user_id": 5908592, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/k2qVE.jpg?s=128&g=1", "display_name": "James Stonehill", "link": "https://stackoverflow.com/users/5908592/james-stonehill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1097, "favorite_count": 0, "answer_count": 0, "score": 6, "last_activity_date": 1508923748, "creation_date": 1508923748, "question_id": 46928771, "link": "https://stackoverflow.com/questions/46928771/pry-session-timing-out-because-of-puma-worker-timeout", "title": "Pry session timing out because of Puma worker timeout", "body": "<p>Whenever I hit a <code>binding.pry</code> while running an app locally, I enter the pry session as normal, but after about a minute, I see something like this in my server output.\n<code>\n[54438] ! Terminating timed out worker: 54455\n</code></p>\n\n<p>Then the server seems to run in a loop for a second or two (re-running queries that lead to the pry session) and I return to a new pry session from the same <code>binding.pry</code>, except in this new pry session whenever I type I can't see anything I'm typing. The only way to fix this problem is to quit the server and restart.</p>\n\n<p>I've tried inserting the following line in my <code>config/puma.rb</code> file but it doesn't seem to make any difference. \n<code>\nworker_timeout 900 if ENV[\"RACK_ENV\"] == \"development\"\n</code></p>\n\n<p>The only thing that works is setting the number of puma workers I have to 0 in my .env file. E.g\n<code>\nPUMA_WORKERS=0\n</code></p>\n\n<p>Is there any way around this issue that doesn't involve just eliminating all puma workers?</p>\n"}, {"tags": ["ruby", "getter", "string-interpolation", "instance-methods", "string-to-symbol"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 1, "creation_date": 1508922544, "post_id": 46928281, "comment_id": 80803371, "body": "<code>puts o.instance_variable_get(&quot;@#{key}&quot;)</code> or <code>puts o.send(key)</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1508922576, "post_id": 46928281, "comment_id": 80803391, "body": "<code>puts o.public_send(key)</code>"}, {"owner": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "edited": false, "score": 0, "creation_date": 1508923073, "post_id": 46928281, "comment_id": 80803755, "body": "Thank you to both of you for your solutions."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1508923241, "post_id": 46928412, "comment_id": 80803876, "body": "<i>Sidenote:</i> call to <code>to_s</code> inside a string interpolation is redundant: it\u2019s called by ruby automatically. Also, prefer <code>public_send</code> over <code>send</code> wherever possible."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508929318, "post_id": 46928412, "comment_id": 80808060, "body": "yes. I agree. I updated the answer to add a note for this. Thanks @mudasobwa!"}], "tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": true, "score": 1, "last_activity_date": 1508929288, "last_edit_date": 1508929288, "creation_date": 1508922771, "answer_id": 46928412, "question_id": 46928281, "link": "https://stackoverflow.com/questions/46928281/taking-a-key-from-a-hash-and-interpolate-that-as-a-getter-on-an-object/46928412#46928412", "title": "Taking a key from a hash, and interpolate that as a getter on an object", "body": "<p><code>puts o.\"#{key}\"</code> is syntactically wrong. You need to fetch the property on runtime. For this you can:</p>\n\n<pre><code>puts o.instance_variable_get(\"@#{key}\") # dynamically inspect instance variable\n# above will only work if key is instance variable and not a method of o.\n</code></pre>\n\n<p>or </p>\n\n<pre><code>puts o.send(key) #dyanmic dispatch\n# will work as long o responds to the key like o.method1.\n</code></pre>\n\n<p><strong>Update:</strong> Prefer <code>o.public_send(key)</code> over <code>send</code> to dynamically dispatch only the publicly accessible method/attribute, as it is safer inspection of object without leaking it's private content.</p>\n\n<p>If you are sure that is an instance variable, go with the safer first option.</p>\n"}], "owner": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "accepted_answer_id": 46928412, "answer_count": 1, "score": 1, "last_activity_date": 1508929288, "creation_date": 1508922358, "question_id": 46928281, "link": "https://stackoverflow.com/questions/46928281/taking-a-key-from-a-hash-and-interpolate-that-as-a-getter-on-an-object", "title": "Taking a key from a hash, and interpolate that as a getter on an object", "body": "<p>I have a class that creates objects. I've created getter/setter methods for that class.</p>\n\n<pre><code>Class Test\n\n  attr_accessor :method1, :method2, :method3, :method4\n</code></pre>\n\n<p>I have created several instances from that class, and appended them to a list</p>\n\n<pre><code>@object_array = [obj1, obj2, obj3]\n</code></pre>\n\n<p>I have a dictionary that contains the keys and values. The keys have the same string value that the instance variables in the test class use. (For example 'method1' exists as :method1) I would like to access those keys as the getter methods.</p>\n\n<pre><code>@method_hash = {'method1' =&gt; ['data1','data2'], 'method2' =&gt; ['data3','data4']}\n</code></pre>\n\n<p>I expect this to work, but it isn't. What am I doing wrong?</p>\n\n<p>I should mention that the method below is taking place inside a class and that @object_list and @method_list are themselves instance variables of this second class. (This might not be relevant to solve the issue, but wanted to mention just in case..)</p>\n\n<pre><code>block (2 levels) in func1': undefined method `key' for #&lt;Obj:0x007ffbe1061870&gt; (NoMethodError)\n\n  def func1\n    @object_array.each do |o|\n      @method_hash.each do |key, value|\n        puts o.\"#{key}\"\n      end\n    end\n  end\n</code></pre>\n\n<p>I tried using .to_s, .to_sym to get it to work with no luck.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "state-machine", "aasm"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508920417, "post_id": 46927443, "comment_id": 80801996, "body": "Call that returns a <code>state</code> uses <code>booking_state</code> variable, while the latter one uses a symbol <code>:booking_state</code>. Is it a typo?"}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508920615, "post_id": 46927443, "comment_id": 80802115, "body": "@mudasobwa yes it is a typo. Sorry for that."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1508920998, "post_id": 46927443, "comment_id": 80802348, "body": "Master branch of <code>aasm</code> declares methods like <a href=\"https://github.com/aasm/aasm/blob/master/lib/aasm/base.rb#L101-L104\" rel=\"nofollow noreferrer\"><code>&quot;#{namespace}_#{state}?&quot;</code></a> when the namespace is specified. That said, <code>booking.booking_state_pending?</code> should work."}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508922774, "post_id": 46927443, "comment_id": 80803543, "body": "@mudasobwa yes worked..Missing in docs I think..Please provide as an answer and I will accept. Thank you."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1508922989, "post_id": 46927443, "comment_id": 80803688, "body": "For ruby gems I personally never rely on docs, I always go read a code base :)"}], "answers": [{"comments": [{"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1508927711, "post_id": 46928476, "comment_id": 80807001, "body": "any idea on how to fetch all records with <code>pending state</code>?  like <code>booking.pending</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1508928059, "post_id": 46928476, "comment_id": 80807213, "body": "<a href=\"https://github.com/aasm/aasm#automatic-scopes\" rel=\"nofollow noreferrer\">github.com/aasm/aasm#automatic-scopes</a> :: <code>Booking.booking_state_pending</code>?"}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1508928380, "post_id": 46928476, "comment_id": 80807405, "body": "<code>boolean</code> response do work <code>booking.booking_state_pending?</code>. But if  just call  <code>Booking.booking_state_pending</code> will throw no method error.<code>NoMethodError: undefined method </code>payment_state_pending for #&lt;Booking:0x007fad60175998&gt;`"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1508929921, "post_id": 46928476, "comment_id": 80808450, "body": "Just go with <code>where(state: :pending)</code>?"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1508922934, "creation_date": 1508922934, "answer_id": 46928476, "question_id": 46927443, "link": "https://stackoverflow.com/questions/46927443/checking-for-a-specific-state-not-working-when-using-multiple-states-per-model/46928476#46928476", "title": "checking for a specific state not working when using multiple states per model (aasm)", "body": "<p>Master branch of aasm declares methods like <a href=\"https://github.com/aasm/aasm/blob/master/lib/aasm/base.rb#L101-L104\" rel=\"nofollow noreferrer\"><code>\"#{namespace}_#{state}?\"</code></a> when the namespace is specified.</p>\n\n<p>That said, <code>booking.booking_state_pending?</code> would work.</p>\n"}], "owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 46928476, "answer_count": 1, "score": 0, "last_activity_date": 1508922934, "creation_date": 1508919782, "last_edit_date": 1508920549, "question_id": 46927443, "link": "https://stackoverflow.com/questions/46927443/checking-for-a-specific-state-not-working-when-using-multiple-states-per-model", "title": "checking for a specific state not working when using multiple states per model (aasm)", "body": "<p>Below are the states defined in my <code>booking</code> model.</p>\n\n<p><strong>1st state</strong></p>\n\n<pre><code>aasm :booking_state,namespace: :booking_state, skip_validation_on_save: true, :whiny_transitions =&gt; false do\n    state :pending, initial: true\n    state :some_other_states\nend\n</code></pre>\n\n<p><strong>2nd state</strong></p>\n\n<pre><code>  aasm :payment_state,namespace: :payment_state, skip_validation_on_save: true, :whiny_transitions =&gt; false do\n    state :pending, initial: true\n    state :some_other_states\nend\n</code></pre>\n\n<p>Now if I do <code>booking.aasm(:booking_state).current_state</code> it returns the proper <code>state</code> name. </p>\n\n<p>But if I do <code>booking.aasm(:booking_state).pending?</code> it returns below <code>error</code> instead of boolean value.</p>\n\n<pre><code>`NoMethodError: undefined method `pending?' for #&lt;AASM::InstanceBase:0x005611e58e4cf0&gt;`  \n</code></pre>\n\n<p>What could be the issue here? I know if I only use <code>one</code> <code>state</code> per model this works. But not working when using <code>multiple states</code> per model. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "asynchronous", "web-worker"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508920698, "post_id": 46927244, "comment_id": 80802172, "body": "Sounds like <code>perform_now</code> <a href=\"http://api.rubyonrails.org/?q=activejob\" rel=\"nofollow noreferrer\">is synchronous</a>. You probably need to call <code>perform_later</code> instead."}, {"owner": {"reputation": 506, "user_id": 2926181, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5af8f4a18aa46609d95cbbfa0a828f43?s=128&d=identicon&r=PG&f=1", "display_name": "HFR1994", "link": "https://stackoverflow.com/users/2926181/hfr1994"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508939070, "post_id": 46927244, "comment_id": 80815144, "body": "Did, it enqueued de job but didn&#39;t actually start ( wait 1 hour)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508939224, "post_id": 46927244, "comment_id": 80815269, "body": "That means your queue is reporting back as \u201cbusy.\u201d"}, {"owner": {"reputation": 506, "user_id": 2926181, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5af8f4a18aa46609d95cbbfa0a828f43?s=128&d=identicon&r=PG&f=1", "display_name": "HFR1994", "link": "https://stackoverflow.com/users/2926181/hfr1994"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508939320, "post_id": 46927244, "comment_id": 80815358, "body": "The problem is that it&#39;s always busy because health checks are every 30 seconds"}], "owner": {"reputation": 506, "user_id": 2926181, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5af8f4a18aa46609d95cbbfa0a828f43?s=128&d=identicon&r=PG&f=1", "display_name": "HFR1994", "link": "https://stackoverflow.com/users/2926181/hfr1994"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508919122, "creation_date": 1508919122, "question_id": 46927244, "link": "https://stackoverflow.com/questions/46927244/asynchronous-jobs-with-large-waiting-time-in-rails", "title": "Asynchronous Jobs with large waiting time in Rails?", "body": "<p>So basically I have two instances, my Webserver and my Worker instance both deployed on Ruby on Rails using AWS ElasticBeanstalk. </p>\n\n<p>I just added a new job on my worker instance so it can create a xlsx file containing all db records from a certain model. This task usually takes up to 40 minutes to complete, the problem is when this job is ejecuting request usually stop working until the process is finished (including the healthcheck link). </p>\n\n<p>How can I make this job be independent from other request so it dosen't affect the ability of my worker instance to handle requests?</p>\n\n<p>Request arrive via SQS and handle by a controller (default Worker ElasticBeanstak profile) which determine what to do.</p>\n\n<p>XLSX files are currently handle by the following Job:</p>\n\n<pre><code>class NotifyJob &lt; ApplicationJob\n    require 'json'\n    require 'date'\n    require 'aws-sdk'\n    require 'rubyXL'\n\n    queue_as :notify\n\n    def perform(type)\n      case type\n        when 'doctor'\n          start = Time.now\n          doc = doctores\n          S3.put_object({:bucket =&gt; 'cadigen-images', :key =&gt; 'doctor.xlsx', :body =&gt; doc.stream, :content_length =&gt; doc.stream.string.length, :content_type =&gt; doc.content_type.to_s, acl: \"public-read\"})\n          after = Time.now\n          link = Aws::S3::Object.new(\"cadigen-images\",\"doctor.xlsx\",:client =&gt; S3).public_url\n          NotificationMailer.finished('Relacion Doctores',time(start,after),Doctor.count,\"&lt;a href='#{link}'&gt;doctor.xlsx&lt;/a&gt;\",\"frhectorin@gmail.com\").deliver_now\n        when 'cadi'\n          start = Time.now\n          cadi = cadis\n          S3.put_object({:bucket =&gt; 'cadigen-images', :key =&gt; 'cadi.xlsx', :body =&gt; cadi.stream, :content_length =&gt; cadi.stream.string.length, :content_type =&gt; cadi.content_type.to_s, acl: \"public-read\"})\n          after = Time.now\n          link = Aws::S3::Object.new(\"cadigen-images\",\"cadi.xlsx\",:client =&gt; S3).public_url\n          NotificationMailer.finished('Relacion CADIs',time(start,after),Cadi.count,\"&lt;a href='#{link}'&gt; cadi.xlsx&lt;/a&gt;\",\"frhectorin@gmail.com\").deliver_now\n        when 'conferencia'\n          start = Time.now\n          conf = conferencia\n          S3.put_object({:bucket =&gt; 'cadigen-images', :key =&gt; 'conferencia.xlsx', :body =&gt; conf.stream, :content_length =&gt; conf.stream.string.length, :content_type =&gt; conf.content_type.to_s, acl: \"public-read\"})\n          after = Time.now\n          link = Aws::S3::Object.new(\"cadigen-images\",\"conferencia.xlsx\",:client =&gt; S3).public_url\n          NotificationMailer.finished('Relacion Conferencia',time(start,after) ,Conferencia.count,\"&lt;a href='#{link}'&gt;conferencia.xlsx&lt;/a&gt;\",\"frhectorin@gmail.com\").deliver_now\n        else\n          render status: 500\n      end\n    end\n\n    def time(start,ending)\n      if start != ending\n        medidas=[\"a\u00f1o\",\"mes\",\"dia\",\"hora\",\"minuto\",\"segundo\"]\n        array=[1970,1,1,0,0,0]\n        text = \"\"\n        Time.at(ending-start).utc.to_a.take(6).reverse.each_with_index do |k,i|\n          text = \"#{text} #{I18n.translate medidas[i].to_sym, count: k-array[i]}\"\n        end\n        text = text.strip.squish\n        puts text\n        pos = text.rindex(\" \",(text.rindex(\" \")-1))\n        unless pos.nil?\n          text = text.insert(pos,\" y\")\n        end\n        text = text.strip.squish\n      else\n        \"0 segundos\"\n      end\n    end\n\n    def doctores\n      workbook = RubyXL::Workbook.new\n      worksheet = workbook[0]\n\n      worksheet.add_cell(0, 0,'ID')\n      worksheet.add_cell(0, 1,'Cuenta')\n      worksheet.add_cell(0, 2,'Titulo')\n      worksheet.add_cell(0, 3,'Nombre')\n      worksheet.add_cell(0, 4,'Email')\n      worksheet.add_cell(0, 5,'Pais')\n      worksheet.add_cell(0, 6,'Verificado')\n      worksheet.add_cell(0, 7,'Autoriza Envio de Emails')\n      worksheet.add_cell(0, 8,'Activo')\n      worksheet.add_cell(0, 9,'Bounce')\n      worksheet.add_cell(0, 10,'Complains')\n      worksheet.add_cell(0, 11,'CADIS')\n\n      doctores = Doctor.order(:id)\n\n      doctores.each_with_index do |doctor,i|\n        i=i+1\n        worksheet.add_cell(i, 0, doctor.id)\n        worksheet.add_cell(i, 1, doctor.cuenta)\n        worksheet.add_cell(i, 2, doctor.titulo)\n        worksheet.add_cell(i, 3, doctor.nombre)\n        worksheet.add_cell(i, 4, doctor.email)\n        worksheet.add_cell(i, 5, doctor.pais)\n        worksheet.add_cell(i, 6, doctor.verified ? 'Si':'No')\n        worksheet.add_cell(i, 7, doctor.email_authorized ? 'Si':'No')\n        worksheet.add_cell(i, 8, doctor.active ? 'Si':'No')\n        worksheet.add_cell(i, 9, doctor.bounce ? 'Si':'No')\n        worksheet.add_cell(i, 10, doctor.complains ? 'Si':'No')\n        worksheet.add_cell(i, 11, doctor.count)\n      end\n\n      return workbook\n\n      #send_data workbook.stream.string, filename: \"doctor.xlsx\", disposition: 'attachment'\n\n    end\n\n    def conferencia\n      workbook = RubyXL::Workbook.new\n      worksheet = workbook[0]\n\n      worksheet.add_cell(0, 0,'ID')\n      worksheet.add_cell(0, 1,'Conferencia')\n      worksheet.add_cell(0, 2,'Conferencista')\n      worksheet.add_cell(0, 3,'Numero de Conferencia')\n      worksheet.add_cell(0, 4,'Fecha')\n      worksheet.add_cell(0, 5,'Tema')\n      worksheet.add_cell(0, 6,'Patrocinador')\n      worksheet.add_cell(0, 7,'Estatus')\n      worksheet.add_cell(0, 8,'Acreditaciones')\n\n      conferencias = Conferencia.order(:id)\n\n      conferencias.each_with_index do |conferencia,i|\n        i=i+1\n        worksheet.add_cell(i, 0, conferencia.id)\n        worksheet.add_cell(i, 1, conferencia.conferencia)\n        worksheet.add_cell(i, 2, conferencia.conferencista)\n        worksheet.add_cell(i, 3, conferencia.numero_conferencia)\n        worksheet.add_cell(i, 4, conferencia.fecha.strftime('%d-%m-%Y %H:%M:%S'))\n        worksheet.add_cell(i, 5, conferencia.tema)\n        worksheet.add_cell(i, 6, conferencia.patrocinador)\n        worksheet.add_cell(i, 7, conferencia.status ? 'Acreditada':'Sin Acreditar')\n        worksheet.add_cell(i, 8, conferencia.count)\n      end\n\n      return workbook\n\n      #send_data workbook.stream.string, filename: \"doctor.xlsx\", disposition: 'attachment'\n\n    end\n\n    def cadis\n      workbook = RubyXL::Workbook.new\n      worksheet = workbook[0]\n\n      worksheet.add_cell(0, 0,'ID')\n      worksheet.add_cell(0, 1,'Numero de CADI')\n      worksheet.add_cell(0, 2,'Email')\n      worksheet.add_cell(0, 3,'Cuenta')\n      worksheet.add_cell(0, 4,'Conferencia')\n\n      cadis = Cadi.order(:id)\n\n      cadis.each_with_index do |cadi,i|\n        i=i+1\n        worksheet.add_cell(i, 0, cadi.id)\n        worksheet.add_cell(i, 1, cadi.numero_cadi)\n        worksheet.add_cell(i, 2, cadi.doctor.email)\n        worksheet.add_cell(i, 3, cadi.doctor.cuenta)\n        worksheet.add_cell(i, 4, cadi.conferencia.conferencia)\n      end\n\n      return workbook\n\n      #send_data workbook.stream.string, filename: \"doctor.xlsx\", disposition: 'attachment'\n\n    end\nend\n</code></pre>\n\n<p>And call using</p>\n\n<pre><code>NotifyJob.perform_now(type)\n</code></pre>\n\n<p>My queue handler is <a href=\"https://github.com/tawan/active-elastic-job\" rel=\"nofollow noreferrer\">active-elastic-job</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 2568, "user_id": 685060, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b3dae619e0ce0dcd8e1fa0632711662?s=128&d=identicon&r=PG", "display_name": "lighter", "link": "https://stackoverflow.com/users/685060/lighter"}, "edited": false, "score": 0, "creation_date": 1508915930, "post_id": 46924956, "comment_id": 80799229, "body": "<code>&lt;%= f.fields_for :attraction_photos</code> is equal my attraction_controller&#39;s <code>@attraction_photos</code>?"}, {"owner": {"reputation": 745, "user_id": 2681735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1083cc275a80a1add8d4269500345165?s=128&d=identicon&r=PG&f=1", "display_name": "kolas", "link": "https://stackoverflow.com/users/2681735/kolas"}, "reply_to_user": {"reputation": 2568, "user_id": 685060, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b3dae619e0ce0dcd8e1fa0632711662?s=128&d=identicon&r=PG", "display_name": "lighter", "link": "https://stackoverflow.com/users/685060/lighter"}, "edited": false, "score": 0, "creation_date": 1508919323, "post_id": 46924956, "comment_id": 80801353, "body": "@lighter no, its get objects from association <code>attraction_photos</code> of parent form&#39;s object <code>@attraction</code>"}, {"owner": {"reputation": 2568, "user_id": 685060, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b3dae619e0ce0dcd8e1fa0632711662?s=128&d=identicon&r=PG", "display_name": "lighter", "link": "https://stackoverflow.com/users/685060/lighter"}, "edited": false, "score": 0, "creation_date": 1508923591, "post_id": 46924956, "comment_id": 80804109, "body": "I tried to modify upload multiple files, 1. I add this to my view  multiple: true` . 2. modify permitted <code>attraction_photos_attributes: [[:id, :photo] =&gt; []]</code> Can I auto-generate multiple photo row data?"}, {"owner": {"reputation": 745, "user_id": 2681735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1083cc275a80a1add8d4269500345165?s=128&d=identicon&r=PG&f=1", "display_name": "kolas", "link": "https://stackoverflow.com/users/2681735/kolas"}, "reply_to_user": {"reputation": 2568, "user_id": 685060, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b3dae619e0ce0dcd8e1fa0632711662?s=128&d=identicon&r=PG", "display_name": "lighter", "link": "https://stackoverflow.com/users/685060/lighter"}, "edited": false, "score": 0, "creation_date": 1508928900, "post_id": 46924956, "comment_id": 80807735, "body": "@lighter you should build attraction_photos two or more times in the controller"}], "tags": [], "owner": {"reputation": 745, "user_id": 2681735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1083cc275a80a1add8d4269500345165?s=128&d=identicon&r=PG&f=1", "display_name": "kolas", "link": "https://stackoverflow.com/users/2681735/kolas"}, "is_accepted": true, "score": 0, "last_activity_date": 1508911095, "creation_date": 1508911095, "answer_id": 46924956, "question_id": 46924133, "link": "https://stackoverflow.com/questions/46924133/rails-carrierwave-one-user-has-many-image/46924956#46924956", "title": "rails carrierwave, one user has many image", "body": "<p>I recomend you to use <a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">https://github.com/nathanvda/cocoon</a></p>\n\n<p>But if you don't want to use gems:</p>\n\n<ul>\n<li>You should use a nested form helper <a href=\"http://guides.rubyonrails.org/form_helpers.html#nested-forms\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/form_helpers.html#nested-forms</a></li>\n</ul>\n\n<p>Like this:</p>\n\n<pre><code>&lt;%= f.fields_for :attraction_photos do |att_photo| %&gt;\n    &lt;%= att_photo.label :photo %&gt;\n    &lt;%= att_photo.file_field :photo %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<ul>\n<li><p>Remember to build attraction photos in the new controller's action.\n<code>@attraction.attraction_photos.build</code></p></li>\n<li><p>You should fix permitted parameters from \n<code>attraction_photos: [:photo]</code> to \n<code>attraction_photos_attributes: [:id, :photo]</code></p></li>\n</ul>\n"}], "owner": {"reputation": 2568, "user_id": 685060, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b3dae619e0ce0dcd8e1fa0632711662?s=128&d=identicon&r=PG", "display_name": "lighter", "link": "https://stackoverflow.com/users/685060/lighter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 46924956, "answer_count": 1, "score": 0, "last_activity_date": 1508915868, "creation_date": 1508906581, "last_edit_date": 1508915868, "question_id": 46924133, "link": "https://stackoverflow.com/questions/46924133/rails-carrierwave-one-user-has-many-image", "title": "rails carrierwave, one user has many image", "body": "<p>I used</p>\n\n<pre><code>rails: 4.2.9\nruby: 2.3.1p112\n</code></pre>\n\n<p>I created uses, attractions, and attraction_photos model. I want every user has much attraction and each attraction has many attractions photo. Attraction create is work, but attraction_photos is empty, and the file doesn't upload success. </p>\n\n<p><strong>Gemfile</strong> </p>\n\n<pre><code>gem 'carrierwave'\ngem 'mini_magick'\n</code></pre>\n\n<p><strong>attraction photos migrate</strong></p>\n\n<pre><code>class CreateAttractionPhotos &lt; ActiveRecord::Migration\n  def change\n    create_table :attraction_photos do |t|\n      t.integer :attraction_id\n      t.string :photo\n\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<p><strong>User</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n    has_many :attractions\n    ...\nend\n</code></pre>\n\n<p><strong>Attraction</strong></p>\n\n<pre><code>class Attraction &lt; ActiveRecord::Base\n  belongs_to :user\n  has_many :attraction_photos, dependent: :destroy\n\n  accepts_nested_attributes_for :attraction_photos\n  ...\nend\n</code></pre>\n\n<p><strong>Attraction_photo</strong></p>\n\n<pre><code>class AttractionPhoto &lt; ActiveRecord::Base\n  belongs_to :attraction\n\n  mount_uploader :photo, AttractionImageUploader\nend\n</code></pre>\n\n<p><strong>AttractionImageUploader</strong></p>\n\n<pre><code>class AttractionImageUploader &lt; CarrierWave::Uploader::Base\n\n  include CarrierWave::MiniMagick\n  storage :file\n\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  process resize_to_fit: [800, 800] \n\n  version :thumb do\n    process resize_to_fit: [200, 200]\n  end\n\n  version :medium do \n    process resize_to_fill: [400, 400]\n  end\n\n  def extension_whitelist\n    %w(jpg jpeg gif png)\n  end\nend\n</code></pre>\n\n<p><strong>attractions_controller</strong></p>\n\n<pre><code>  def new\n    @attractions = Attraction.new\n    @attraction_photos = @attractions.attraction_photos.new\n  end\n\n  def create\n    @attractions = current_user.attractions.build(attraction_params)\n\n    if @attractions.save\n      flash[:success] = \"success\"\n      redirect_to attractions_path\n    else\n      flash[:danger] = @attractions.errors.full_messages\n      render action: :new\n    end\n  end\n\n  private\n\n  def attraction_params\n    params.require(:attraction).permit(:name, :longitude, :latitude, :address, :phone, :category_id, attraction_photos: [:photo])\n  end\n</code></pre>\n\n<p><strong>attraction new.html.erb</strong></p>\n\n<pre><code>&lt;%= form_for(@attractions) do |f| %&gt;\n    &lt;div class=\"form-group\"&gt;\n      &lt;%= f.label :name, t(\"attraction.name\"), class: \"col-md-2 control-label\" %&gt;\n      &lt;div class=\"col-md-10\"&gt;\n        &lt;%= f.text_field :name, class: \"form-control\" %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"form-group\"&gt;\n      &lt;%= f.label :attraction_photos, t(\"attraction.attraction_photo\"), class: \"col-md-2 control-label\" %&gt;\n      &lt;div class=\"col-md-10\"&gt;\n        &lt;%= f.file_field :photo, class: \"form-control\" %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1508904883, "post_id": 46923629, "comment_id": 80794678, "body": "Look at it this way. <code>e = (3..9).each #=&gt; #&lt;Enumerator: 3..9:each&gt;</code>. Ruby then uses the method <a href=\"http://ruby-doc.org/core-2.4.0/Enumerator.html#method-i-next\" rel=\"nofollow noreferrer\">Enumerator#next</a> to generate elements of <code>e</code>, which she passes to the block, assigning their values to the block variable <code>start</code>: <code>start = e.next #=&gt; 3; start = e.next #=&gt; 4</code> and so on."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8593776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1860482657312419/picture?type=large", "display_name": "Mason Towne", "link": "https://stackoverflow.com/users/8593776/mason-towne"}, "edited": false, "score": 0, "creation_date": 1508904039, "post_id": 46923676, "comment_id": 80794475, "body": "Thanks! Just the explanation that I needed!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 11, "user_id": 8593776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1860482657312419/picture?type=large", "display_name": "Mason Towne", "link": "https://stackoverflow.com/users/8593776/mason-towne"}, "edited": false, "score": 1, "creation_date": 1508924216, "post_id": 46923676, "comment_id": 80804579, "body": "@MasonTowne another way to express <code>(0...length).each</code> is <code>length.times</code>"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 1, "last_activity_date": 1508903446, "creation_date": 1508903446, "answer_id": 46923676, "question_id": 46923629, "link": "https://stackoverflow.com/questions/46923629/what-does-calling-each-on-a-range-inside-a-block-do/46923676#46923676", "title": "What does calling &#39;each&#39; on a range inside a block do?", "body": "<p><code>length</code> is defined as:</p>\n\n<pre><code>length = characters.length\n</code></pre>\n\n<p>and <code>characters</code> is defined as:</p>\n\n<pre><code>characters = word.split(\"\")\n</code></pre>\n\n<p><code>word</code> is a block variable for an iteration over <code>words</code>, which is defined as:</p>\n\n<pre><code>words = sentence.split(\" \")\n</code></pre>\n\n<p>In other words, <code>(0...length).each</code> iterates over each index of the characters in <code>word</code>, which is yielded by splitting <code>sentence</code> by a space.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1508907788, "creation_date": 1508907788, "answer_id": 46924332, "question_id": 46923629, "link": "https://stackoverflow.com/questions/46923629/what-does-calling-each-on-a-range-inside-a-block-do/46924332#46924332", "title": "What does calling &#39;each&#39; on a range inside a block do?", "body": "<blockquote>\n  <p>I'm interested in this block of code</p>\n\n<pre><code>(0...length).each { |start|\n</code></pre>\n  \n  <p>I'm wondering what <code>each</code> method is called on.</p>\n</blockquote>\n\n<p>It is called on the <a href=\"http://ruby-doc.org/core/Range.html\" rel=\"nofollow noreferrer\"><code>Range</code> literal <code>0...length</code></a>.</p>\n\n<blockquote>\n  <p>I don't see an array explicitly listed for the <code>each</code> method to be called on.</p>\n</blockquote>\n\n<p>Why would there need to be an <code>Array</code> for <code>each</code>? There are lots of classes which implement <code>each</code>: <a href=\"http://ruby-doc.org/core/ENV.html#method-c-each\" rel=\"nofollow noreferrer\"><code>ENV</code></a>, <a href=\"http://ruby-doc.org/core/ENV.html#method-c-each\" rel=\"nofollow noreferrer\"><code>ARGF</code></a>, <a href=\"http://ruby-doc.org/core/Dir.html#method-c-each\" rel=\"nofollow noreferrer\"><code>Dir</code></a>, <a href=\"http://ruby-doc.org/core/Enumerator.html#method-c-each\" rel=\"nofollow noreferrer\"><code>Enumerator</code></a>, <a href=\"http://ruby-doc.org/core/Hash.html#method-c-each\" rel=\"nofollow noreferrer\"><code>Hash</code></a>, <a href=\"http://ruby-doc.org/core/IO.html#method-c-each\" rel=\"nofollow noreferrer\"><code>IO</code></a>, <a href=\"http://ruby-doc.org/core/Range.html#method-c-each\" rel=\"nofollow noreferrer\"><code>Range</code></a>, <a href=\"http://ruby-doc.org/core/Struct.html#method-c-each\" rel=\"nofollow noreferrer\"><code>Struct</code></a>, <a href=\"http://ruby-doc.org/core/Array.html#method-c-each\" rel=\"nofollow noreferrer\"><code>Array</code></a>, and that's just the ones in the core library. There's even more in the standard library, for example <a href=\"http://ruby-doc.org/stdlib/libdoc/csv/rdoc/CSV.html#method-i-each\" rel=\"nofollow noreferrer\"><code>CSV#each</code></a> in the <a href=\"http://ruby-doc.org/stdlib/libdoc/csv/rdoc/\" rel=\"nofollow noreferrer\"><code>csv</code> library</a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/matrix/rdoc/Matrix.html#method-i-each\" rel=\"nofollow noreferrer\"><code>Matrix#each</code></a> and <a href=\"http://ruby-doc.org/stdlib/libdoc/matrix/rdoc/Vector.html#method-i-each\" rel=\"nofollow noreferrer\"><code>Vector#each</code></a> in the <a href=\"http://ruby-doc.org/stdlib/libdoc/matrix/rdoc/\" rel=\"nofollow noreferrer\"><code>matrix</code> library</a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/REXML/QuickPath.html#method-i-each\" rel=\"nofollow noreferrer\"><code>REXML::QuickPath#each</code></a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/REXML/XPath.html#method-i-each\" rel=\"nofollow noreferrer\"><code>REXML::XPath#each</code></a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/REXML/AttlistDecl.html#method-i-each\" rel=\"nofollow noreferrer\"><code>REXML::AttlistDecl#each</code></a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/REXML/Attributes.html#method-i-each\" rel=\"nofollow noreferrer\"><code>REXML::Attributes#each</code></a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/REXML/Elements.html#method-i-each\" rel=\"nofollow noreferrer\"><code>REXML::Elements#each</code></a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/REXML/Light/Node.html#method-i-each\" rel=\"nofollow noreferrer\"><code>REXML::Light::Node#each</code></a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/REXML/Parent.html#method-i-each\" rel=\"nofollow noreferrer\"><code>REXML::Parent#each</code></a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/REXML/Parsers/PullParser.html#method-i-each\" rel=\"nofollow noreferrer\"><code>REXML::Parsers::PullParser#each</code></a>, and <a href=\"http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/REXML/SyncEnumerator.html#method-i-each\" rel=\"nofollow noreferrer\"><code>REXML::SyncEnumerator#each</code></a> in the <a href=\"http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/\" rel=\"nofollow noreferrer\"><code>rexml</code> library</a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/set/rdoc/Set.html#method-i-each\" rel=\"nofollow noreferrer\"><code>Set#each</code></a> in the <a href=\"http://ruby-doc.org/stdlib/libdoc/set/rdoc/\" rel=\"nofollow noreferrer\"><code>set</code> library</a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/stringio/rdoc/StringIO.html#method-i-each\" rel=\"nofollow noreferrer\"><code>StringIO#each</code></a> in the <a href=\"http://ruby-doc.org/stdlib/libdoc/stringio/rdoc/\" rel=\"nofollow noreferrer\"><code>stringio</code> library</a>, <a href=\"http://ruby-doc.org/stdlib/libdoc/yaml/rdoc/YAML/DBM.html#method-i-each\" rel=\"nofollow noreferrer\"><code>YAML::DBM#each</code></a> in the <a href=\"http://ruby-doc.org/stdlib/libdoc/yaml/rdoc/\" rel=\"nofollow noreferrer\"><code>yaml</code> library</a>, and probably many more. And of course, there are probably hundreds of others in the wider Ruby ecosystem, e.g. there are 14 implementations of <code>each</code> in Ruby on Rails.</p>\n\n<blockquote>\n  <p>There is a range listed, but how does it know what array the range is referring to?</p>\n</blockquote>\n\n<p>It doesn't. The <code>Range</code> isn't referring to an array. It is referring to a range.</p>\n\n<blockquote>\n  <p>Does it just call it on the block it is currently in?</p>\n</blockquote>\n\n<p>You can't call methods on a block. You can only call methods on objects, and blocks aren't objects in Ruby. (You can reify a block, but then it becomes just a normal <code>Proc</code> object. And <code>Proc</code> doesn't respond to <code>each</code>, so you can't call <code>each</code> on that, either.)</p>\n"}], "owner": {"reputation": 11, "user_id": 8593776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1860482657312419/picture?type=large", "display_name": "Mason Towne", "link": "https://stackoverflow.com/users/8593776/mason-towne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 46923676, "answer_count": 2, "score": 0, "last_activity_date": 1508907788, "creation_date": 1508903164, "last_edit_date": 1508904017, "question_id": 46923629, "link": "https://stackoverflow.com/questions/46923629/what-does-calling-each-on-a-range-inside-a-block-do", "title": "What does calling &#39;each&#39; on a range inside a block do?", "body": "<p>I'm supposed to define a method <code>substrings</code> that will return a hash listing the number of occurrences of substrings that match against a defined array of strings. Here is the code</p>\n\n<pre><code>dictionary = [\"below\", \"down\", \"go\", \"going\", \"horn\", \"how\", \"howdy\", \"it\", \"i\", \"low\", \"own\", \"part\", \"partner\", \"sit\"]\n\ndef substrings(sentence, dictionary)\n  substrings = Hash.new(0)\n  words = sentence.split(\" \")\n  words.each { |word|\n    word = word.downcase\n    characters = word.split(\"\")\n    length = characters.length\n    (0...length).each { |start|\n      substring = []\n      (start...length).each { |stop|\n        substring.push(characters[stop])\n        if (dictionary.include?(substring.join))\n          substrings[substring.join] += 1\n        end\n      }\n    }\n  }\n  puts substrings\nend\n\nsubstrings(\"Howdy partner, sit down! How's it going?\", dictionary)\n</code></pre>\n\n<p>I'm interested in this block of code</p>\n\n<pre><code>(0...length).each { |start|\n</code></pre>\n\n<p>I'm wondering what <code>each</code> method is called on. I don't see an array explicitly listed for the <code>each</code> method to be called on. There is a range listed, but how does it know what array the range is referring to? Does it just call it on the block it is currently in?</p>\n"}, {"tags": ["ruby", "stack-level"], "comments": [{"owner": {"reputation": 3160, "user_id": 1266795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7855792dbc5f3b4c365344314e2b1ad6?s=128&d=identicon&r=PG", "display_name": "AndyV", "link": "https://stackoverflow.com/users/1266795/andyv"}, "edited": false, "score": 2, "creation_date": 1508901604, "post_id": 46922125, "comment_id": 80793929, "body": "At a quick glance, I&#39;m going to guess that Computer#check_move is producing the same suggested move for any given configuration of the board.  If that&#39;s true and if that move fails to satisfy the !board.valid_move test, then you&#39;ll end up in an infinite loop with wargame_turn calling itself recursively until death."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3114072"}, "is_accepted": true, "score": 1, "last_activity_date": 1508902137, "creation_date": 1508902137, "answer_id": 46923481, "question_id": 46922125, "link": "https://stackoverflow.com/questions/46922125/debugging-a-stack-level-too-deep-error-ruby/46923481#46923481", "title": "Debugging a stack level too deep error - Ruby", "body": "<p>You can use the ruby <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/tracer/rdoc/Tracer.html\" rel=\"nofollow noreferrer\">Tracer class</a>:</p>\n\n<pre><code>ruby -r tracer your_main_script.rb\n</code></pre>\n\n<p>Also, you can take a look at your code and see where the loop may happen:</p>\n\n<pre><code>def wargame_turn\n\n  input = current_player.move(board)\n\n  if !board.valid_move?(input)\n\n    wargame_turn #### HERE'S A POTENTIAL INFINITE LOOP\n</code></pre>\n\n<p>So the heart of the problem seems at:</p>\n\n<pre><code>if !board.valid_move?(input)\n</code></pre>\n\n<p>It could be a good start.</p>\n"}], "owner": {"reputation": 789, "user_id": 8758793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ZupKk.jpg?s=128&g=1", "display_name": "Matt Hough", "link": "https://stackoverflow.com/users/8758793/matt-hough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "accepted_answer_id": 46923481, "answer_count": 1, "score": 1, "last_activity_date": 1508902137, "creation_date": 1508892111, "last_edit_date": 1508892753, "question_id": 46922125, "link": "https://stackoverflow.com/questions/46922125/debugging-a-stack-level-too-deep-error-ruby", "title": "Debugging a stack level too deep error - Ruby", "body": "<p>I am building a Tic Tac Toe game in which the user can play a computer, or computers can play each other. While building the AI I am running into the below error. How can I debug this? I understand it is to do with a loop somewhere but I can't find it.</p>\n\n<pre><code>ttt-with-ai-project-cb-000/lib/players/computer.rb:13:in `each': stack level too deep (SystemStackError)\n        from ttt-with-ai-project-cb-000/lib/players/computer.rb:13:in `detect'\n        from ttt-with-ai-project-cb-000/lib/players/computer.rb:13:in `check_move'\n        from ttt-with-ai-project-cb-000/lib/players/computer.rb:8:in `move'\n        from ttt-with-ai-project-cb-000/lib/game.rb:61:in `wargame_turn'\n        from ttt-with-ai-project-cb-000/lib/game.rb:64:in `wargame_turn'\n        from ttt-with-ai-project-cb-000/lib/game.rb:64:in `wargame_turn'\n        from ttt-with-ai-project-cb-000/lib/game.rb:64:in `wargame_turn'\n        from ttt-with-ai-project-cb-000/lib/game.rb:64:in `wargame_turn'\n         ... 11900 levels...\n        from bin/tictactoe:37:in `block in run_game'\n        from bin/tictactoe:35:in `times'\n        from bin/tictactoe:35:in `run_game'\n        from bin/tictactoe:79:in `&lt;main&gt;'\n</code></pre>\n\n<p><br />\n<strong>The Offending Methods</strong></p>\n\n<p>lib/players/computer.rb</p>\n\n<pre><code>def move(board)\n    check_move(board)\nend\n\ndef check_move(board)\n    win_combo = Game::WIN_COMBINATIONS.detect do |indices|\n    board.cells[indices[0]] == token &amp;&amp; board.cells[indices[1]] == token || board.cells[indices[1]] == token &amp;&amp; board.cells[indices[2]] == token || board.cells[indices[0]] == token &amp;&amp; board.cells[indices[2]] == token\n    end\n\n    win_combo.detect {|index| board.cells[index] == \" \"}.join if win_combo\nend\n</code></pre>\n\n<p><br />\nlib/game.rb</p>\n\n<pre><code>def wargame_turn\n    input = current_player.move(board)\n\n    if !board.valid_move?(input)\n        wargame_turn\n    else\n        board.update(input, current_player)\n    end\nend\n</code></pre>\n\n<p><br />\nbin/tictactoe calls the method in the following block within #run_game:</p>\n\n<pre><code>100.times do \n    game = Game.new(Players::Computer.new(\"X\"), player_2 = Players::Computer.new(\"O\"))\n    game.wargames\n    if game.winner == \"X\"\n        x_wins += 1\n    elsif game.winner == \"O\"\n        x_wins += 1\n    elsif game.draw?\n        draws += 1\n    end\nend\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "coffeescript"], "comments": [{"owner": {"reputation": 6178, "user_id": 3307520, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jWlYC.jpg?s=128&g=1", "display_name": "Cyzanfar", "link": "https://stackoverflow.com/users/3307520/cyzanfar"}, "edited": false, "score": 0, "creation_date": 1508890818, "post_id": 46921843, "comment_id": 80791222, "body": "What are you setting the variable &#39;Phase&#39; to? Can it be explicitly set at render time?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1508891199, "post_id": 46921843, "comment_id": 80791320, "body": "you just need to understand the difference between javascript and ruby events. The Javascript event handler will happen first and only take place on the browser. It&#39;s only after a HTTP request to the server is made that the ruby event happens - actually rails does not care whether or not it was a click or hover or what as long as it receives a http request."}, {"owner": {"reputation": 6178, "user_id": 3307520, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jWlYC.jpg?s=128&g=1", "display_name": "Cyzanfar", "link": "https://stackoverflow.com/users/3307520/cyzanfar"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1508891431, "post_id": 46921843, "comment_id": 80791370, "body": "Precisely @maxpleaner. If you want the event listener to capture that information, you need to make sure you can set the data in your controller backend, to render in the view (you can&#39;t just pass data to your browser it has to go through the view). To do this, you basically need to output the data to make sure your html view can output the required information."}, {"owner": {"reputation": 185, "user_id": 7733552, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0585b2af4349bcf8312cad05f837ab9?s=128&d=identicon&r=PG&f=1", "display_name": "megahra", "link": "https://stackoverflow.com/users/7733552/megahra"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1508891819, "post_id": 46921843, "comment_id": 80791473, "body": "@max : Yes, that makes sense. But the method that my CoffeeScript calls is actually on the server side (ActionCable corresponding <code>channel.rb</code>). Since that Button press is the only thing that triggers a new &quot;phase&quot; (@Cyzanfar : I&#39;m building a quiz app, so phase 1 - display question, phase 2 - display results etc.) I&#39;m specifically looking for a way to avoid race conditions between the 2 methods."}], "answers": [{"tags": [], "owner": {"reputation": 185, "user_id": 7733552, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0585b2af4349bcf8312cad05f837ab9?s=128&d=identicon&r=PG&f=1", "display_name": "megahra", "link": "https://stackoverflow.com/users/7733552/megahra"}, "is_accepted": true, "score": 0, "last_activity_date": 1509054208, "creation_date": 1509054208, "answer_id": 46964304, "question_id": 46921843, "link": "https://stackoverflow.com/questions/46921843/rails-on-click-event-how-to-deal-with-race-condition-between-2-ruby-methods/46964304#46964304", "title": "Rails - on click event - how to deal with race condition between 2 Ruby methods?", "body": "<p>Ok, I solved it by finding a way to call the 2 methods sequentially. I ended up eliminating the on click listener completely and <strong>calling the ActionCable backend method directly</strong>, which was possible by turning it into a class method:</p>\n\n<pre><code>class QuizDataChannel &lt; ApplicationCable::Channel\n  #method B:\n  def self.send_answers #self. makes it a class method\n    #...\n    #do something with phase\n  end\nend\n</code></pre>\n\n<p>And in my controller:</p>\n\n<pre><code>#method A:\ndef switch_to_next_question\n   #...\n   self.phase += 1\n   if self.save\n      QuizDataChannel.send_answers\n   else\n      #...\n   end\nend\n</code></pre>\n\n<p>As you can see in the end I got rid of all of these: <code>sleep</code>, new threads and the <code>index_changed</code> flag.</p>\n"}], "owner": {"reputation": 185, "user_id": 7733552, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0585b2af4349bcf8312cad05f837ab9?s=128&d=identicon&r=PG&f=1", "display_name": "megahra", "link": "https://stackoverflow.com/users/7733552/megahra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 46964304, "answer_count": 1, "score": 1, "last_activity_date": 1509054208, "creation_date": 1508889853, "last_edit_date": 1508974672, "question_id": 46921843, "link": "https://stackoverflow.com/questions/46921843/rails-on-click-event-how-to-deal-with-race-condition-between-2-ruby-methods", "title": "Rails - on click event - how to deal with race condition between 2 Ruby methods?", "body": "<p>On my view I have a <code>link_to</code> element \"Start Quiz!\" that calls a controller method (method A) that sets a variable \"Phase\" and redirects the user to a new static page. In my CoffeeScript I have an event listener listening for clicks on this <code>link_to</code> element. The listener calls a different method (method B) on the backend that uses the \"Phase\" variable to do sth.</p>\n\n<p>The problem: sometimes method B tries to use the \"Phase\" variable before it has been updated by the controller method A! Does anyone have a suggestion what the best way would be to ensure that the \"Phase\" variable was updated before using it for anything else?</p>\n\n<p>I'm a Rails beginner and would appreciate any pointers. :)</p>\n\n<hr>\n\n<p>EDIT:\n\"Phase\" is a variable I use to track the current question of my quiz. It's not dependent on any input, but it needs increment whenever a new page is rendered (which is triggered by the button click).</p>\n\n<hr>\n\n<p>EDIT2:\nI've now tried to solve this by introducing an instance variable flag \"is_changed\" to my controller and letting the method B sleep until the flag is set to true:</p>\n\n<pre><code>#method B:\ndef send_answers\n   until controller.index_changed?\n     sleep(0.5)\n   end\n   ...\n   do sth.\nend\n\n#method A (in controller):\ndef initialize\n   @index_changed = false\nend\n\ndef index_changed?\n   @index_changed\nend\n\ndef set_index_changed!\n   @index_changed = false\nend\n\ndef switch_to_next_question\n   ...\n   self.phase += 1\n   if self.save\n      Thread.new do\n         @index_changed = true\n         ActiveRecord::Base.connection.close\n      end\n   else\n      ...\n   end\nend\n</code></pre>\n\n<p>It's not working. Method A gets stuck sleeping. How do I fix this? And is this even the right approach?</p>\n\n<p>Is it a problem with the scope of my @index_changed variable? I'm trying to create an instance variable that is accessible from multiple methods within the class, but individual to each instance of this class.</p>\n"}, {"tags": ["ruby", "grep", "multiline"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1508896201, "post_id": 46921789, "comment_id": 80792531, "body": "You have not escaped the period <code>.</code>. You have to write <code>\\.</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3114072"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1508903834, "post_id": 46921789, "comment_id": 80794420, "body": "@sawa, are you sure? Sancam says \u201cwhere ... represents a series of control characters\u201d. He doesn&#39;t look for periods, I think."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1508904203, "post_id": 46921789, "comment_id": 80794514, "body": "@Philicare I see. You&#39;re right."}], "answers": [{"comments": [{"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1508892934, "post_id": 46921864, "comment_id": 80791758, "body": "but \\s does match new lines by default. I don&#39;t think this is relevant. <code>m</code> as far as I know means each line is treated as it&#39;s own haystack such that <code>^</code> is the beginning of the line and <code>$</code> is the end of the line."}], "tags": [], "owner": {"reputation": 377, "user_id": 158886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d2450fcc6205543865a09f85102089?s=128&d=identicon&r=PG", "display_name": "valbaca", "link": "https://stackoverflow.com/users/158886/valbaca"}, "is_accepted": false, "score": 0, "last_activity_date": 1508889986, "creation_date": 1508889986, "answer_id": 46921864, "question_id": 46921789, "link": "https://stackoverflow.com/questions/46921789/multiline-file-grep/46921864#46921864", "title": "Multiline file grep", "body": "<p>You need to enable multiline mode. <code>.</code> doesn't match newlines by default.</p>\n\n<p>From the documentation <a href=\"https://ruby-doc.org/core-2.1.1/Regexp.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.1.1/Regexp.html</a></p>\n\n<pre><code>/./ - Any character except a newline.\n/./m - Any character (the m modifier enables multiline mode)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1508914509, "post_id": 46924374, "comment_id": 80798362, "body": "I mean the file does contain more than just the data structure. The file itself is 8000kb, but it&#39;s cool. I will try with a line-by-line method. Also What I&#39;m scanning for, with the <code>[\\x00-\\x08]</code> is the control characters at the end of the section of text. It&#39;s not just a CSV file. It&#39;s an entire database file in a (undocumented) propriety database format."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3114072"}, "is_accepted": false, "score": 0, "last_activity_date": 1508908013, "creation_date": 1508908013, "answer_id": 46924374, "question_id": 46921789, "link": "https://stackoverflow.com/questions/46921789/multiline-file-grep/46924374#46924374", "title": "Multiline file grep", "body": "<blockquote>\n  <p>Am I correct that grep uses line-by-line parsing?</p>\n</blockquote>\n\n<p>Yes. Try on your file:</p>\n\n<pre><code>r = File.open(somePath) do |f|\n  f.grep(/[A-Z]{2},/)\nend\n\nputs r\n# =&gt; AB, \"Abandoned\", 0, 13168840\n#    DM, \"Demolished\", 0, 15780518\n#    OP, \"Operational\", 0, 15780518\n\nputs r.inspect\n# =&gt; [\"AB, \\\"Abandoned\\\", 0, 13168840\\n\", \"DM, \\\"Demolished\\\", 0, 15780518\\n\", \"OP, \\\"Operational\\\", 0, 15780518\\n\"]\n</code></pre>\n\n<blockquote>\n  <p>Is this why my regex isn't working as intended?</p>\n</blockquote>\n\n<p>Not only. What are you searching for, with [\\x00-\\x08]? An ascii or an hexadecimal character?</p>\n\n<blockquote>\n  <p>Would it be better to use file.each_line to capture the data?</p>\n</blockquote>\n\n<p><code>File#grep</code> sounds good.</p>\n"}, {"comments": [{"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1508920148, "post_id": 46925048, "comment_id": 80801834, "body": "It appears that the problem is actually that I&#39;m reading a binary file, it seems. I can use <code>File.binread(&quot;C:\\\\Users\\\\jwa\\\\Desktop\\\\TBD\\\\master.db&quot;)</code> to ensure I get the whole file, but still the regex doesn&#39;t seem to work... Oddly though, even scanning for <code>&#47;.&#47;</code> returns no results... So that&#39;s confusing... xD Edit: Oops, my mistake <code>&#47;.&#47;</code> does return matches."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1508920190, "post_id": 46925048, "comment_id": 80801853, "body": "Mind to share the file content? I believe explicit <code>File.binread().force_encoding(Encoding::BINARY)</code> could help."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1508920892, "post_id": 46925048, "comment_id": 80802277, "body": "Sure <a href=\"https://ufile.io/rsakp\" rel=\"nofollow noreferrer\">ufile.io/rsakp</a>. I also attempted using <code>enforce_encoding</code>, however it seems like it isn&#39;t a method on my old version of ruby (1.9.1)."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1508921052, "post_id": 46925048, "comment_id": 80802385, "body": "Ruby 1.9.1? I wash my hands, sorry. BTW, the method name is <code>force_encoding</code>, not <code>enforce_encoding</code>."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1508922465, "post_id": 46925048, "comment_id": 80803316, "body": "Not entirely sure where I got the method name <code>enforce_encoding</code> from... xD And no problem! Thanks for trying to solve the issue though :)"}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 1, "creation_date": 1508937913, "post_id": 46925048, "comment_id": 80814290, "body": "FYI, your solution worked like a charm. My regex also had some issues."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1508911495, "creation_date": 1508911495, "answer_id": 46925048, "question_id": 46921789, "link": "https://stackoverflow.com/questions/46921789/multiline-file-grep/46925048#46925048", "title": "Multiline file grep", "body": "<p><a href=\"https://ruby-doc.org/core/String.html#method-i-scan\" rel=\"nofollow noreferrer\"><code>String#scan</code></a> comes to the rescue:</p>\n\n<pre><code>File.read('/path/to/file').scan(\n  /flags.+id, description, used, color(?&lt;data&gt;(?:.|\\s)*?)[\\x00-\\x08]/m\n)\n</code></pre>\n"}], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 46925048, "answer_count": 3, "score": 1, "last_activity_date": 1508911495, "creation_date": 1508889507, "last_edit_date": 1508895842, "question_id": 46921789, "link": "https://stackoverflow.com/questions/46921789/multiline-file-grep", "title": "Multiline file grep", "body": "<p>I have a file that has sections like this,</p>\n\n<pre><code>flags...id, description, used, color\nAB, \"Abandoned\", 0, 13168840\nDM, \"Demolished\", 0, 15780518\nOP, \"Operational\", 0, 15780518...\n</code></pre>\n\n<p>where <code>...</code> represents a series of control characters e.g. ETX and STX. I am trying to grab multiple lines from the file.</p>\n\n<p>I am using the following code:</p>\n\n<pre><code>f = File.open(somePath)\nr = f.grep(/flags.+id, description, used, color(?&lt;data&gt;(?:.|\\s)*?)[\\x00-\\x08]/)\n</code></pre>\n\n<p>This code does not work. I do not understand why. The documentation of grep appears to insinuate that the file is parsed line by line. I have a feeling that this may be the reason why the regular expression isn't returning any results.</p>\n\n<ol>\n<li>Am I correct that grep uses line-by-line parsing? Is this why my regex isn't working as intended?</li>\n<li>Would it be better to use <code>file.each_line</code> to capture the data?</li>\n<li>Are there better/cleaner alternatives to all of the above?</li>\n</ol>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "edited": false, "score": 0, "creation_date": 1508887183, "post_id": 46921414, "comment_id": 80790340, "body": "<code>Enumerable</code> does not define <code>#[]</code> and <code>#[]=</code>"}, {"owner": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "reply_to_user": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "edited": false, "score": 0, "creation_date": 1508887267, "post_id": 46921414, "comment_id": 80790355, "body": "Which module defines?"}, {"owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "edited": false, "score": 0, "creation_date": 1508887320, "post_id": 46921414, "comment_id": 80790371, "body": "I think must be provided by the class. Alongside with an <code>each</code> method."}, {"owner": {"reputation": 3280, "user_id": 2990656, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QuT1B.png?s=128&g=1", "display_name": "Steven Jeffries", "link": "https://stackoverflow.com/users/2990656/steven-jeffries"}, "edited": false, "score": 0, "creation_date": 1508887375, "post_id": 46921414, "comment_id": 80790383, "body": "This answer may help: <a href=\"https://stackoverflow.com/a/10018947/2990656\">stackoverflow.com/a/10018947/2990656</a>"}, {"owner": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "reply_to_user": {"reputation": 3280, "user_id": 2990656, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QuT1B.png?s=128&g=1", "display_name": "Steven Jeffries", "link": "https://stackoverflow.com/users/2990656/steven-jeffries"}, "edited": false, "score": 0, "creation_date": 1508887730, "post_id": 46921414, "comment_id": 80790475, "body": "@StevenJeffries I don\u2019t want inheriting from Hash or Array. Do you know the <code>ActiveRecord</code>, for example? Its <a href=\"https://github.com/rails/rails/blob/3-2-stable/activerecord/lib/active_record/relation.rb\" rel=\"nofollow noreferrer\"><code>Relation</code></a> class doesn\u2019t inherit from any class."}, {"owner": {"reputation": 3280, "user_id": 2990656, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QuT1B.png?s=128&g=1", "display_name": "Steven Jeffries", "link": "https://stackoverflow.com/users/2990656/steven-jeffries"}, "edited": false, "score": 0, "creation_date": 1508963240, "post_id": 46921414, "comment_id": 80830244, "body": "@rplaurindo Looks like you got it all sorted out; that link was just a reference for overriding the <code>[]</code> and <code>[]=</code> methods."}, {"owner": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "edited": false, "score": 0, "creation_date": 1508963394, "post_id": 46921414, "comment_id": 80830302, "body": "Yes, I got it. Understood. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "edited": false, "score": 0, "creation_date": 1508888303, "post_id": 46921538, "comment_id": 80790622, "body": "It\u2019s true, but I don\u2019t want to inherit from Array. My class has no relationship &quot;is a&quot; with Array."}, {"owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "reply_to_user": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "edited": false, "score": 1, "creation_date": 1508888343, "post_id": 46921538, "comment_id": 80790632, "body": "then follow the first example. That one has no relation with <code>Array</code>"}, {"owner": {"reputation": 2231, "user_id": 1238868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9884f1eabc8587f2c9dfd2b1ccf9a6?s=128&d=identicon&r=PG", "display_name": "Michael Chaney", "link": "https://stackoverflow.com/users/1238868/michael-chaney"}, "edited": false, "score": 1, "creation_date": 1508888402, "post_id": 46921538, "comment_id": 80790641, "body": "So take care of <code>[]</code> and <code>each</code> yourself, per Mr. Ragni&#39;s first example.  Of course, the easiest way to do so internally is with an array, but you don&#39;t have to expose it outside your class except through interfaces that you design and control."}, {"owner": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "edited": false, "score": 0, "creation_date": 1508889657, "post_id": 46921538, "comment_id": 80790956, "body": "Ok, I updated the post. Now I would like to show as an array when executing the variable that holds the instance reference in line command."}, {"owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "edited": false, "score": 0, "creation_date": 1508890315, "post_id": 46921538, "comment_id": 80791101, "body": "Ok, now <code>Node</code> prints as an <code>Array</code>. Check out the <code>to_s</code> method. I&#39;m using  a method from enumerable"}, {"owner": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "edited": false, "score": 0, "creation_date": 1508895549, "post_id": 46921538, "comment_id": 80792369, "body": "@MatteoRagni In this way I have to explicitly call the <code>to_s</code> method."}], "tags": [], "owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "is_accepted": false, "score": 2, "last_activity_date": 1508890665, "last_edit_date": 1508890665, "creation_date": 1508887830, "answer_id": 46921538, "question_id": 46921414, "link": "https://stackoverflow.com/questions/46921414/ruby-define-a-numeric-index-in-an-enumerable-class-without-inheriting-from-array/46921538#46921538", "title": "Ruby define a numeric index in an enumerable class without inheriting from Array or Hash and print it out", "body": "<p>As you can see on the left column (with all the defined methods in the module) <a href=\"https://ruby-doc.org/core-2.2.0/Enumerable.html\" rel=\"nofollow noreferrer\">of the documentation</a>, the <code>Enumerate</code> module does not define the methods <code>#[]</code> and <code>#[]=</code>, which must be provided by the class.</p>\n\n<p>Also, the class that includes <code>Enumerate</code> <strong>must</strong> provide an <code>#each</code> method.</p>\n\n<pre><code>class Test\n  include Enumerate\n\n  def [](i)\n    # do your stuff\n  end\n\n  def []=(i, v)\n    # do your stuff\n  end\n\n  def each\n    # required!\n  end\nend\n</code></pre>\n\n<p><strong>Implementing the required methods does not create any</strong> (let's say) <strong>\"relation\"</strong>  <strong>with the <code>Array</code> class</strong>. The only way to create such a \"relation\" is through <strong>inheritance</strong>. </p>\n\n<p>Let's make a silly example with some sort of linked list just to see how it works the idea...It is not robust nor well implemented... It is only an idea:</p>\n\n<pre><code>class Node\n  include Enumerable\n\n  attr_reader :data\n\n  def initialize(payload, n = nil)\n    @node = n if n.is_a? Node\n    @data = payload\n  end\n\n  def [](n)\n    if n == 0\n      self\n    else\n      @node[n - 1]\n    end\n  end\n\n  def []=(n, v)\n    if n == 0\n      @data = v\n    else\n      @node[n - 1] = v \n    end\n  end\n\n  def each(&amp;block)\n    block.call(self)\n    @node.each(&amp;block) if @node\n  end\n\n  def &lt;=&gt;(o)\n    @data &lt;=&gt; o.data\n  end\n\n  def to_s\n    \"[\" + self.map { |e| \"#{e.data}\" }.join(\", \") + \"]\"\n  end\nend\n\na = Node.new(\"Node 0\")\nb = Node.new(\"Node 1\", a)\nc = Node.new(\"Node 2\", b)\nd = Node.new(\"Node 3\", c)\n\nd[2] = \"Edited\"\n\nd.each do |n|\n  puts n.data\nend\n\n# Let's use an enumerable method\ns = d.select { |n| n.data == \"Node 0\" }[0]\nputs \"#{a.inspect} = #{s.inspect}\"\n\nputs a, b, c, d\n\n# =&gt; Output:\n# \n# Node 3\n# Node 2\n# Edited\n# Node 0\n# #&lt;Node:0x0000562e121e2440 @data=\"Node 0\"&gt; = #&lt;Node:0x0000562e121e2440 @data=\"Node 0\"&gt;\n# [Node 0]\n# [Edited, Node 0]\n# [Node 2, Edited, Node 0]\n# [Node 3, Node 2, Edited, Node 0]\n</code></pre>\n\n<p>As alternatives, you may consider:</p>\n\n<pre><code># 1. Inheritance\ndef Test &lt; Array\n  # do your stuff\nend\n\n# 2. Reopen the Array class\ndef Array\n  # do your stuff\nend\n</code></pre>\n\n<p>The methods <code>#[]</code> and <code>#[]=</code> for the <code>Array</code> class are defined in the C source of the interpreter.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1508905824, "post_id": 46922700, "comment_id": 80794950, "body": "When @sawa refers to the &quot;default definition of <code>inspect</code> he is referring to <a href=\"http://ruby-doc.org/core-2.4.0/Object.html#method-i-inspect\" rel=\"nofollow noreferrer\">Kernel#inspect</a>. We know that because <code>class A; end; A.instance_method(:inspect).owner #=&gt; Kernel</code>. Note from the second sentence of the doc for the module <a href=\"http://ruby-doc.org/core-2.4.0/Kernel.html\" rel=\"nofollow noreferrer\">Kernel</a> that <code>Kernel</code>&#39;s instance methods are documented in the class <a href=\"http://ruby-doc.org/core-2.4.0/Object.html\" rel=\"nofollow noreferrer\">Object</a>."}, {"owner": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "edited": false, "score": 0, "creation_date": 1508934369, "post_id": 46922700, "comment_id": 80811621, "body": "Thanks for <code>A.instance_method(:inspect).owner</code>. Very useful."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 2, "last_activity_date": 1508896363, "creation_date": 1508896363, "answer_id": 46922700, "question_id": 46921414, "link": "https://stackoverflow.com/questions/46921414/ruby-define-a-numeric-index-in-an-enumerable-class-without-inheriting-from-array/46922700#46922700", "title": "Ruby define a numeric index in an enumerable class without inheriting from Array or Hash and print it out", "body": "<p>Your problem is that you have not implemented the <code>inspect</code> method. At the moment, the default <code>inspect</code> definition is used in your class. You may want to define it like:</p>\n\n<pre><code>class AEnumerableObject\n  def inspect\n    @original_list.inspect\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 46922700, "answer_count": 2, "score": 0, "last_activity_date": 1508934441, "creation_date": 1508886915, "last_edit_date": 1508934441, "question_id": 46921414, "link": "https://stackoverflow.com/questions/46921414/ruby-define-a-numeric-index-in-an-enumerable-class-without-inheriting-from-array", "title": "Ruby define a numeric index in an enumerable class without inheriting from Array or Hash and print it out", "body": "<p>I have the following class:</p>\n\n<pre><code>class AEnumerableObject\n  include Enumerable\n\n  def initialize\n    @original_list = []\n  end\n\n  def [] index\n    @original_list[index]\n  end\n\n  def []= index, value\n    @original_list[index] = value\n  end\n\n  def each &amp;block\n    @original_list.each_with_index do |item, i|\n      yield item, i\n    end if block_given?\n  end\nend\n</code></pre>\n\n<p>If I run inline commands</p>\n\n<pre><code>$ object = AEnumerableObject.new\n$ object[0] = 1\n$ object[1] = 2\n$ object[2] = 3\n$ p object\n</code></pre>\n\n<p>should show</p>\n\n<pre><code>[1, 2, 3]\n</code></pre>\n\n<p>but it actually shows</p>\n\n<pre><code>#&lt;AEnumerableObject:... @original_list=[1, 2, 3]&gt;\n</code></pre>\n\n<p>while if I run</p>\n\n<pre><code>$ p object.class\n</code></pre>\n\n<p>it shows</p>\n\n<pre><code>=&gt; AEnumerableObject\n</code></pre>\n\n<p>How do I implement an Array like print method?</p>\n\n<p><strong>UPDATED</strong></p>\n\n<p>I implemented the methods <code>#[]</code>, <code>#[]=</code> and <code>#each</code> (so now it\u2019s iterable). But how to show it like an <code>Array</code> in line command?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "savon"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2340017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e724eaa8554fd155a94eb94c69f4d39?s=128&d=identicon&r=PG", "display_name": "paulorodriguez", "link": "https://stackoverflow.com/users/2340017/paulorodriguez"}, "edited": false, "score": 0, "creation_date": 1508886681, "post_id": 46921155, "comment_id": 80790235, "body": "The autoload goes in the file loosely or inside the Application class ?TY"}, {"owner": {"reputation": 3171, "user_id": 2610043, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jIN0G.jpg?s=128&g=1", "display_name": "hedgesky", "link": "https://stackoverflow.com/users/2610043/hedgesky"}, "reply_to_user": {"reputation": 31, "user_id": 2340017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e724eaa8554fd155a94eb94c69f4d39?s=128&d=identicon&r=PG", "display_name": "paulorodriguez", "link": "https://stackoverflow.com/users/2340017/paulorodriguez"}, "edited": false, "score": 0, "creation_date": 1508955378, "post_id": 46921155, "comment_id": 80825948, "body": "Inside <code>Application</code> class."}], "tags": [], "owner": {"reputation": 3171, "user_id": 2610043, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jIN0G.jpg?s=128&g=1", "display_name": "hedgesky", "link": "https://stackoverflow.com/users/2610043/hedgesky"}, "is_accepted": false, "score": 0, "last_activity_date": 1508885145, "creation_date": 1508885145, "answer_id": 46921155, "question_id": 46921064, "link": "https://stackoverflow.com/questions/46921064/what-the-right-place-to-create-a-web-service-client-for-a-rails-application/46921155#46921155", "title": "What the right place to create a web service client for a rails application?", "body": "<p>You could start with <code>lib/services</code> directory. In general, non-Rails Ruby projects contain all the code inside <code>lib</code>, so it's good choice.</p>\n\n<p>However, code inside <code>lib</code> directory isn't automatically reloaded in Rails by default. But you could setup it with</p>\n\n<pre><code># config/application.rb\nconfig.autoload_paths &lt;&lt; \"#{Rails.root}/lib/services\"\n</code></pre>\n\n<p>Also, you should follow standard naming conventions (<code>lib/services/example.rb</code> should contain class <code>Example</code>) in order autoloading to work properly.</p>\n"}, {"tags": [], "owner": {"reputation": 295, "user_id": 4296084, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/1057962333/picture?type=large", "display_name": "Thounder", "link": "https://stackoverflow.com/users/4296084/thounder"}, "is_accepted": false, "score": 0, "last_activity_date": 1508886476, "creation_date": 1508886476, "answer_id": 46921358, "question_id": 46921064, "link": "https://stackoverflow.com/questions/46921064/what-the-right-place-to-create-a-web-service-client-for-a-rails-application/46921358#46921358", "title": "What the right place to create a web service client for a rails application?", "body": "<p>My suggestion would be like hedgesky, create a sub folder inside <code>lib</code> call <code>lib/third_party/third_party_name</code>.</p>\n\n<p>This folder would contain any logic which would be needed to connect to your partner.</p>\n\n<p>Then you create a service <code>services/...</code> which contain your business logic and will call the connector.</p>\n\n<p>Finally call your service in the controller.</p>\n\n<p>Like so, everything has his own layer. More then that, if later on you create a second app using the same partner. You could extract <code>lib/third_party/third_party_name</code> inside your own gem and reuse it.</p>\n"}], "owner": {"reputation": 31, "user_id": 2340017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e724eaa8554fd155a94eb94c69f4d39?s=128&d=identicon&r=PG", "display_name": "paulorodriguez", "link": "https://stackoverflow.com/users/2340017/paulorodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508886476, "creation_date": 1508884558, "last_edit_date": 1508885306, "question_id": 46921064, "link": "https://stackoverflow.com/questions/46921064/what-the-right-place-to-create-a-web-service-client-for-a-rails-application", "title": "What the right place to create a web service client for a rails application?", "body": "<p>I want to connect to a web service using savon in a rails application, but I don't know where to start. I would like to have it encapsulated, not just code in a controller. Where is the right place to create it ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 4, "creation_date": 1508884708, "post_id": 46921057, "comment_id": 80789704, "body": "Where do you set <code>end_date</code>? Have you tried doing <code>&lt;%= end_date %&gt;</code>? Just to see that it is, in fact, not nil as you suggest?"}, {"owner": {"reputation": 6178, "user_id": 3307520, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jWlYC.jpg?s=128&g=1", "display_name": "Cyzanfar", "link": "https://stackoverflow.com/users/3307520/cyzanfar"}, "edited": false, "score": 1, "creation_date": 1508884756, "post_id": 46921057, "comment_id": 80789726, "body": "How are you calling <code>end_date</code>? where is it assigned? Shouldn&#39;t you be calling the attribute <code>end_date</code> on the instance?"}, {"owner": {"reputation": 31, "user_id": 6221033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ae5d5284daf4845c8f7ca2160c55d7?s=128&d=identicon&r=PG&f=1", "display_name": "tecz", "link": "https://stackoverflow.com/users/6221033/tecz"}, "edited": false, "score": 0, "creation_date": 1508885036, "post_id": 46921057, "comment_id": 80789798, "body": "<code>end_date</code> is input by users using a datepicker.. I tried calling just <code>&lt;%= end_date %&gt;</code> and it rendered in the view as <code>2018-12-21</code>"}, {"owner": {"reputation": 31, "user_id": 6221033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ae5d5284daf4845c8f7ca2160c55d7?s=128&d=identicon&r=PG&f=1", "display_name": "tecz", "link": "https://stackoverflow.com/users/6221033/tecz"}, "edited": false, "score": 0, "creation_date": 1508885252, "post_id": 46921057, "comment_id": 80789855, "body": "I tried wrapping it in a <code>try</code> and changing it to <code>end_date.try(:strftime, &#39;%b %d, %Y&#39;)</code> and that actually works and renders the date exactly as expected. I&#39;m still not sure why this would only be necessary for one record that isn&#39;t even nil..."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1508886353, "post_id": 46921057, "comment_id": 80790146, "body": "Assuming you are using Ruby 2.3+, you should use <code>end_date&amp;.strftime(&#39;%b %d, %Y&#39;)</code> instead of <code>end_date.try(:strftime, &#39;%b %d, %Y&#39;)</code>. But either way it doesn&#39;t make sense."}, {"owner": {"reputation": 295, "user_id": 4296084, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/1057962333/picture?type=large", "display_name": "Thounder", "link": "https://stackoverflow.com/users/4296084/thounder"}, "edited": false, "score": 1, "creation_date": 1508886589, "post_id": 46921057, "comment_id": 80790213, "body": "Avoid try if you require the info. Otherwise you&#39;ll have false positive"}], "owner": {"reputation": 31, "user_id": 6221033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ae5d5284daf4845c8f7ca2160c55d7?s=128&d=identicon&r=PG&f=1", "display_name": "tecz", "link": "https://stackoverflow.com/users/6221033/tecz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508884486, "creation_date": 1508884486, "question_id": 46921057, "link": "https://stackoverflow.com/questions/46921057/undefined-method-strftime-for-nilnilclass-field-is-not-nil-in-database", "title": "undefined method `strftime&#39; for nil:NilClass -- field is NOT nil in database", "body": "<p>I have a Rails app with a field called <code>end_date</code> which is required for a record to be saved to the database.</p>\n\n<p>In another part of the app, I am converting the end_date field's output using</p>\n\n<pre><code>&lt;%= end_date.strftime('%b %d, %Y') %&gt;\n</code></pre>\n\n<p>However, I am receiving the error </p>\n\n<pre><code>undefined method `strftime' for nil:NilClass\n</code></pre>\n\n<p>In reference to the line of code above. This error is (as far as I've found so far) only occurring on one record in the database, which has a value of <code>2018-12-21</code> for the end_date in the database.</p>\n\n<hr>\n\n<p>When I login to the Rails console and load the same record from the database, then call <code>end_date.strftime('%b %d, %Y')</code> on the record, it returns</p>\n\n<pre><code>=&gt; \"Dec 21, 2018\"\n</code></pre>\n\n<p>As expected.</p>\n\n<p>This error is only occurring for one record, and it is not because the method is being called on a null record, which is what the error message says is the cause.</p>\n\n<p>I have looked into some other solutions, but I do not have a <code>default_timezone</code> set in <code>application.rb</code>, so I don't think it's an error being caused by that.</p>\n\n<p>For reference I am using devise to handle authentication, if that matters.</p>\n\n<p>I'm nearing my wit's end, does anyone have any ideas as to what might be causing this error?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter-bootstrap", "wkhtmltopdf"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508884464, "post_id": 46921015, "comment_id": 80789633, "body": "Did you include <code>stylesheet_link_tag</code> and <code>wicked_pdf_stylesheet_link_tag</code> in <code>form.html.erb</code> as described in the <code>wicked_pdf</code> docs?"}, {"owner": {"reputation": 395, "user_id": 6451457, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc567abba69c8b2f11c7e5cf446b1c73?s=128&d=identicon&r=PG", "display_name": "Jeffrey Wen", "link": "https://stackoverflow.com/users/6451457/jeffrey-wen"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508885291, "post_id": 46921015, "comment_id": 80789867, "body": "@jvillian - If I am using the bootstrap-sass gem, where are my bootstrap stylesheets located?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508885700, "post_id": 46921015, "comment_id": 80789982, "body": "I do this to include bootstrap: <code>wicked_pdf_stylesheet_link_tag &quot;bootstrap.css&quot;</code>. I don&#39;t recall if there was further configuration."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1508885792, "post_id": 46921015, "comment_id": 80790006, "body": "BTW, if you&#39;re deploying on Heroku, you&#39;ll want to use <code>gem &#39;wkhtmltopdf-heroku&#39;</code> unless you want <code>wkhtmltopdf-binary</code> to instantaneously suck up all available memory in the known universe."}, {"owner": {"reputation": 395, "user_id": 6451457, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc567abba69c8b2f11c7e5cf446b1c73?s=128&d=identicon&r=PG", "display_name": "Jeffrey Wen", "link": "https://stackoverflow.com/users/6451457/jeffrey-wen"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508886110, "post_id": 46921015, "comment_id": 80790084, "body": "@jvillian - Thank you for letting me know about that gem. I would&#39;ve totally pushed <code>wkhtmltopdf-binary</code> to heroku. On the other hand, I took your advice and put the <code>&lt;%= wicked_pdf_stylesheet_link_tag &quot;bootstrap.css&quot; %&gt;</code> in the header of <code>app&#47;views&#47;layouts&#47;application.html.erb</code>. Unfortunately, nothing is changing."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508886809, "post_id": 46921015, "comment_id": 80790265, "body": "I&#39;ll start an answer and see if we can&#39;t sort it out."}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 6451457, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc567abba69c8b2f11c7e5cf446b1c73?s=128&d=identicon&r=PG", "display_name": "Jeffrey Wen", "link": "https://stackoverflow.com/users/6451457/jeffrey-wen"}, "edited": false, "score": 0, "creation_date": 1508948683, "post_id": 46921483, "comment_id": 80822197, "body": "Thank you for posting that solution. However, prior to reading this, I&#39;ve found a Git Repository that I looked around and figured it out! <a href=\"https://github.com/eltonsantos/wicked_pdf_example\" rel=\"nofollow noreferrer\">github.com/eltonsantos/wicked_pdf_example</a>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 395, "user_id": 6451457, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc567abba69c8b2f11c7e5cf446b1c73?s=128&d=identicon&r=PG", "display_name": "Jeffrey Wen", "link": "https://stackoverflow.com/users/6451457/jeffrey-wen"}, "edited": false, "score": 0, "creation_date": 1508949593, "post_id": 46921483, "comment_id": 80822664, "body": "Great news! Was the answer in anything I posted? If not, perhaps you could add your own answer so that future readers can see how you solved it without having to scrounge through the git repository."}, {"owner": {"reputation": 395, "user_id": 6451457, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc567abba69c8b2f11c7e5cf446b1c73?s=128&d=identicon&r=PG", "display_name": "Jeffrey Wen", "link": "https://stackoverflow.com/users/6451457/jeffrey-wen"}, "edited": false, "score": 1, "creation_date": 1508949933, "post_id": 46921483, "comment_id": 80822864, "body": "You indirectly pointed me in the right direction so I knew how to search &#39;smarter&#39; in Google! I&#39;ll post the solution a little later today :)"}, {"owner": {"reputation": 824, "user_id": 5610600, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Szyb3uK2uU8/AAAAAAAAAAI/AAAAAAAAAJE/XuBsiUUU61c/photo.jpg?sz=128", "display_name": "Jem Built", "link": "https://stackoverflow.com/users/5610600/jem-built"}, "reply_to_user": {"reputation": 395, "user_id": 6451457, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc567abba69c8b2f11c7e5cf446b1c73?s=128&d=identicon&r=PG", "display_name": "Jeffrey Wen", "link": "https://stackoverflow.com/users/6451457/jeffrey-wen"}, "edited": false, "score": 0, "creation_date": 1539654757, "post_id": 46921483, "comment_id": 92570475, "body": "would totally love to see what you added @JeffreyWen"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 0, "last_activity_date": 1508887408, "creation_date": 1508887408, "answer_id": 46921483, "question_id": 46921015, "link": "https://stackoverflow.com/questions/46921015/rails-5-wkhtmltopdf-does-not-include-bootstrap/46921483#46921483", "title": "Rails 5 - wkhtmltopdf does not include bootstrap", "body": "<p><code>form.html.erb</code> should have something like:</p>\n\n<pre><code>&lt;%= stylesheet_link_tag wicked_pdf_asset_base64(\"form_stylesheet\") %&gt; \n&lt;%= wicked_pdf_stylesheet_link_tag \"bootstrap.css\" %&gt;\n&lt;%= stylesheet_link_tag \"http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css\", media: \"all\" %&gt;\n</code></pre>\n\n<p>I included a line there for including Fontawesome fonts - just so you could see that bit.</p>\n\n<p>Then, in your <code>form_stylesheet.sass</code> (which should be located in <code>app/assets/stylesheets</code>), you should have something like:</p>\n\n<pre><code>@import 'bootstrap-sprockets'\n@import 'bootstrap'\n@import 'some_other_styling'\n</code></pre>\n\n<p>NOTES: </p>\n\n<ul>\n<li>I'm using <code>sass</code> as my css preprocessor. If you're using straight css or scss, then you'll need to modify as appropriate.</li>\n<li>'some_other_styling' is where you can put additional css rules. If you don't have any, then don't include that line.</li>\n</ul>\n\n<p>All that seems to work for me...</p>\n\n<p>Oh, and in <code>config/initializers/wicked_pdf.rb</code>, I have:</p>\n\n<pre><code>WickedPdf.config ||= {}\nWickedPdf.config.merge!({\n  # your extra configurations here\n})\n\ndef wicked_pdf_asset(*sources)\n  sources.collect { |source|\n    asset = Rails.application.assets.find_asset(\"#{source}.sass\")\n\n    if asset.nil?\n      #raise \"could not find asset for #{source}.css\"\n    else\n      \"&lt;style type='text/css'&gt;#{asset.body}&lt;/style&gt;\"\n    end\n  }.join(\"\\n\").gsub(/url\\(['\"](.+)['\"]\\)(.+)/,%[url(\"#{wicked_pdf_image_location(\"\\\\1\")}\")\\\\2]).html_safe\nend\n</code></pre>\n\n<p>I don't recall if that helped me sort things out.</p>\n"}], "owner": {"reputation": 395, "user_id": 6451457, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc567abba69c8b2f11c7e5cf446b1c73?s=128&d=identicon&r=PG", "display_name": "Jeffrey Wen", "link": "https://stackoverflow.com/users/6451457/jeffrey-wen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 646, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1508887408, "creation_date": 1508884146, "question_id": 46921015, "link": "https://stackoverflow.com/questions/46921015/rails-5-wkhtmltopdf-does-not-include-bootstrap", "title": "Rails 5 - wkhtmltopdf does not include bootstrap", "body": "<p><strong>Problem</strong> - wkhtmltopdf does not include my Bootstrap styles when generating displaying the PDF. I have tried numerous methods from all over the interwebs with no luck.</p>\n\n<p><strong>System Specs</strong></p>\n\n<ul>\n<li>Rails 5.1.4</li>\n<li>ruby 2.4.2p198 (2017-09-14 revision 59899) [x86_64-darwin17]</li>\n</ul>\n\n<p>Here are the snippets of code:</p>\n\n<pre><code># Gemfile\ngem 'wicked_pdf'\ngem 'wkhtmltopdf-binary'\ngem 'bootstrap-sass', '~&gt; 3.3.6'\n\n# app/controllers/forms_controller\ndef show\n  @form = Form.find(params[:id])\n  respond_to do |format|\n    format.html\n    format.pdf do\n      render pdf: \"#{@form.id}\",\n        template: 'forms/show.html.erb',\n        locals: { f: @f }\n    end\n  end\nend\n\n# app/views/forms/show.html.erb\n&lt;%= render 'forms/form.html.erb' %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "vagrant", "chef-infra", "hazelcast", "ohai-gem"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1508904543, "creation_date": 1508904543, "answer_id": 46923850, "question_id": 46920795, "link": "https://stackoverflow.com/questions/46920795/chef-client-failed-0-resources-updated-in-01-seconds-error-wrong-number-of-a/46923850#46923850", "title": "Chef Client failed. 0 resources updated in 01 seconds - ERROR: wrong number of arguments (given 1, expected 3)", "body": "<p>The important bit is probably this:</p>\n\n<pre><code>[DEPRECATION] Plugin at /tmp/vagrant-chef/ohai/cookbook_plugins/ohai/hint.rb is a version 6 plugin.     \nVersion 6 plugins will not be supported in Chef/Ohai 14. Please upgrade your plugin to version 7 plugin format. \nFor more information visit here: docs.chef.io/ohai_custom.html\n</code></pre>\n\n<p>Figure out what is installing that plugin and check if anything is in the same folder and is an invalid plugin.</p>\n"}], "owner": {"reputation": 11, "user_id": 7678751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210676266696050/picture?type=large", "display_name": "Alvaro Ruiz", "link": "https://stackoverflow.com/users/7678751/alvaro-ruiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2027, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508904543, "creation_date": 1508882766, "question_id": 46920795, "link": "https://stackoverflow.com/questions/46920795/chef-client-failed-0-resources-updated-in-01-seconds-error-wrong-number-of-a", "title": "Chef Client failed. 0 resources updated in 01 seconds - ERROR: wrong number of arguments (given 1, expected 3)", "body": "<p>I am trying to run a simple Hazelcast cluster on Amazon EC2 following the  <a href=\"https://github.com/hazelcast/hazelcast-code-samples/tree/master/hazelcast-integration/amazon-ec2-vagrant-chef\" rel=\"nofollow noreferrer\">official code sample</a>, every step seems to be OK but when running <code>vagrant up --provider=aws</code> ( under the header \"Let's do this thing\" ) it fails as shown:</p>\n\n<pre><code>==&gt; hazelcast2: - ohai (5.2.0)\n==&gt; hazelcast2: Installing Cookbook Gems:\n==&gt; hazelcast2: Compiling Cookbooks...\n==&gt; hazelcast2: [2017-10-24T20:03:06+00:00] INFO: The plugin path /etc/chef/ohai/plugins does not exist. Skipping...\n==&gt; hazelcast2: [2017-10-24T20:03:06+00:00] WARN: \n[DEPRECATION] Plugin at /tmp/vagrant-chef/ohai/cookbook_plugins/ohai/hint.rb is a version 6 plugin.     \nVersion 6 plugins will not be supported in Chef/Ohai 14. Please upgrade your plugin to version 7 plugin format. \nFor more information visit here: docs.chef.io/ohai_custom.html\n==&gt; hazelcast2: \n==&gt; hazelcast2: Running handlers:\n==&gt; hazelcast2: [2017-10-24T20:03:06+00:00] ERROR: Running exception handlers\n==&gt; hazelcast2: Running handlers complete\n==&gt; hazelcast2: \n==&gt; hazelcast2: [2017-10-24T20:03:06+00:00] ERROR: Exception handlers complete\n==&gt; hazelcast2: Chef Client failed. 0 resources updated in 01 seconds\n==&gt; hazelcast2: [2017-10-24T20:03:06+00:00] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out\n==&gt; hazelcast2: [2017-10-24T20:03:06+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report\n==&gt; hazelcast2: [2017-10-24T20:03:06+00:00] ERROR: wrong number of arguments (given 1, expected 3)\n==&gt; hazelcast2: [2017-10-24T20:03:06+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully \n(exit code 1)\n==&gt; hazelcast2: An error occurred. The error will be shown after all tasks complete.\nAn error occurred while executing multiple actions in parallel.\nAny errors that occurred are shown below.\n\nAn error occurred while executing the action on the 'hazelcast1' machine. \nPlease handle this error then try again:\n\nChef never successfully completed! Any errors should be visible in the output above. \nPlease fix your recipes so that they properly complete.\n\nAn error occurred while executing the action on the 'hazelcast2' machine. \nPlease handle this error then try again:\n\nChef never successfully completed! Any errors should be visible in the output above. \nPlease fix your recipes so that they properly complete.\n</code></pre>\n\n<p>/var/chef/cache/chef-stacktrace.out:</p>\n\n<pre><code>Generated at 2017-10-24 21:36:55 +0000\nArgumentError: wrong number of arguments (given 1, expected 3)\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/ohai-13.5.0/lib/ohai/dsl/plugin/versionvi.rb:27:in `initialize'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/ohai-13.5.0/lib/ohai/loader.rb:223:in `new'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/ohai-13.5.0/lib/ohai/loader.rb:223:in `load_v7_plugin'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/ohai-13.5.0/lib/ohai/loader.rb:93:in `block in load_additional'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/ohai-13.5.0/lib/ohai/loader.rb:90:in `collect'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/ohai-13.5.0/lib/ohai/loader.rb:90:in `load_additional'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/ohai-13.5.0/lib/ohai/system.rb:116:in `run_additional_plugins'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/run_context/cookbook_compiler.rb:119:in `compile_ohai_plugins'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/run_context/cookbook_compiler.rb:73:in `compile'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/run_context.rb:192:in `load'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/policy_builder/expand_node_object.rb:97:in `setup_run_context'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/client.rb:513:in `setup_run_context'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/client.rb:281:in `run'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application.rb:291:in `block in fork_chef_client'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application.rb:279:in `fork'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application.rb:279:in `fork_chef_client'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application.rb:244:in `block in run_chef_client'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/local_mode.rb:44:in `with_server_connectivity'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application.rb:232:in `run_chef_client'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application/client.rb:469:in `sleep_then_run_chef_client'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application/client.rb:458:in `block in interval_run_chef_client'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application/client.rb:457:in `loop'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application/client.rb:457:in `interval_run_chef_client'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application/client.rb:441:in `run_application'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application.rb:59:in `run'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/lib/chef/application/solo.rb:225:in `run'\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/chef-13.5.3/bin/chef-solo:25:in `&lt;top (required)&gt;'\n/usr/bin/chef-solo:58:in `load'\n/usr/bin/chef-solo:58:in `&lt;main&gt;'\n</code></pre>\n\n<p>Ohai version:\n    ohai -version\n    Ohai: 13.5.0</p>\n\n<p>Java jdk not installed (when it should be according to the receipt):</p>\n\n<pre><code>java -version\nThe program 'java' can be found in the following packages:\n * default-jre\n * gcj-5-jre-headless\n * openjdk-8-jre-headless\n * gcj-4.8-jre-headless\n * gcj-4.9-jre-headless\n * openjdk-9-jre-headless\nTry: sudo apt install &lt;selected package&gt;\n</code></pre>\n\n<p><strong>Following the Stacktrace</strong> I got to the point where I believe it has something to do with the fact that the function:\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/ohai-13.5.0/lib/ohai/dsl/plugin/versionvi.rb:27:in `initialize':</p>\n\n<pre><code>def initialize(controller, plugin_path, plugin_dir_path)\n          super(controller.data)\n          @controller = controller\n          @version = :version6\n          @source = plugin_path\n          @plugin_dir_path = plugin_dir_path\nend\n</code></pre>\n\n<p>... <strong>requires 3 parameters and is called with only one in</strong>: \n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/ohai-13.5.0/lib/ohai/loader.rb:223:in 'new'  in the function:\n/opt/chef/embedded/lib/ruby/gems/2.4.0/gems/ohai-13.5.0/lib/ohai/loader.rb:223:in `load_v7_plugin'</p>\n\n<pre><code> def load_v7_plugin(plugin_class)\n      plugin = plugin_class.new(@controller.data)\n      collect_provides(plugin)\n      plugin\n end\n</code></pre>\n\n<p>I repeated the steps on an Ubuntu 14.04 and on an Ubuntu 16.04 VM and I am still stuck with the same Error, any idea what I am doing wrong?</p>\n\n<p>P.S. I am just following the steps in the sample.</p>\n\n<p>Thank you  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unicorn", "puma", "grpc"], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 5511606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74f6ded64f3be372a26d22a97dfb97f4?s=128&d=identicon&r=PG&f=1", "display_name": "apolcyn", "link": "https://stackoverflow.com/users/5511606/apolcyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1521051226, "creation_date": 1521051226, "answer_id": 49284988, "question_id": 46920598, "link": "https://stackoverflow.com/questions/46920598/ruby-rails-grpc-server-restart-without-disconnecting-clients/49284988#49284988", "title": "ruby/rails grpc server restart without disconnecting clients", "body": "<p>There is no such support for rolling out new deployments that's built in to the ruby-gRPC.</p>\n\n<p>However, it should be possible for applications with multiple server instances to do rolling restarts. E.g., note that if gRPC connects to a server and starts to make RPC's to it and that server gets shut down, then gRPC will internally notice that the connection went bad and it will try to make its next RPC on a newly connection (the default gRPC behavior will be to perform its next RPC on the next resolved address that can be successfully connected to, and this might mean reconnecting to the same address for which the connection just broke). Note too that gRPC servers use <code>SO_REUSEPORT</code> by default, so one could potentially run multiple servers on the same port.</p>\n"}], "owner": {"reputation": 341, "user_id": 2088529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dffcc243d2a246f8e09cc884b909be47?s=128&d=identicon&r=PG", "display_name": "Dechao Qiu", "link": "https://stackoverflow.com/users/2088529/dechao-qiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521051226, "creation_date": 1508881709, "question_id": 46920598, "link": "https://stackoverflow.com/questions/46920598/ruby-rails-grpc-server-restart-without-disconnecting-clients", "title": "ruby/rails grpc server restart without disconnecting clients", "body": "<p>I am using the following code snippet to start a grpc server which works fine. But whenever I need to deploy new code to the server, what is the right way for me to restart the server? Should I just kill the server process, and let client to handle the error message? Or is there a way for enabling master/worker mode like unicorn does?</p>\n\n<pre><code>s = GRPC::RpcServer.new\ns.run_till_terminated\n</code></pre>\n"}, {"tags": ["ruby", "logging"], "answers": [{"comments": [{"owner": {"reputation": 2276, "user_id": 1365699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f97699899cb6a81167e3da917435510a?s=128&d=identicon&r=PG&f=1", "display_name": "R891", "link": "https://stackoverflow.com/users/1365699/r891"}, "edited": false, "score": 0, "creation_date": 1508880185, "post_id": 46920184, "comment_id": 80788043, "body": "Thanks, that worked. I&#39;ll accept your answer as soon as the timer lets me."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 2276, "user_id": 1365699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f97699899cb6a81167e3da917435510a?s=128&d=identicon&r=PG&f=1", "display_name": "R891", "link": "https://stackoverflow.com/users/1365699/r891"}, "edited": false, "score": 0, "creation_date": 1508880741, "post_id": 46920184, "comment_id": 80788310, "body": "My pleasure Sir :)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1508879948, "creation_date": 1508879948, "answer_id": 46920184, "question_id": 46920155, "link": "https://stackoverflow.com/questions/46920155/ruby-logger-is-nil/46920184#46920184", "title": "Ruby logger is nil", "body": "<p>Try this one</p>\n\n<pre><code>def initialize\n  # Log to STDOUT and `tee` it to a file\n  @logger = Logger.new(\"| tee output.log\")\n  @logger.level = :debug\nend\n</code></pre>\n\n<p>Obviously into the <code>LogStuff</code> class. Basically, otherwise your <code>@logger</code> variable is defined in another scope.</p>\n"}], "owner": {"reputation": 2276, "user_id": 1365699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f97699899cb6a81167e3da917435510a?s=128&d=identicon&r=PG&f=1", "display_name": "R891", "link": "https://stackoverflow.com/users/1365699/r891"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 46920184, "answer_count": 1, "score": 1, "last_activity_date": 1508879948, "creation_date": 1508879848, "question_id": 46920155, "link": "https://stackoverflow.com/questions/46920155/ruby-logger-is-nil", "title": "Ruby logger is nil", "body": "<p>When I try to use Ruby's <code>logger</code>, it comes up as <code>nil</code>. Is an instance variable the correct way to do this?</p>\n\n<pre><code>require 'logger'\n\nclass LogStuff\n\n  # Log to STDOUT and `tee` it to a file\n  @logger = Logger.new(\"| tee output.log\")\n  @logger.level = :debug\n\n  def run\n    (1..10).each do |n|\n      @logger.debug('l1') { @logger.debug \"proceessing #{n}\" }\n    end\n\n    ['a', 'b', 'c', 'd', 'e'].each do |letter|\n      @logger.debug('letters') { @logger.debug \"proceessing #{letter}\" }\n    end\n  end\n\nend\n\nif __FILE__ == $0\n  lggr = LogStuff.new\n  lggr.run\nend\n</code></pre>\n\n<p>Error message:</p>\n\n<pre><code>$ ruby script.rb \nscript.rb:11:in `block in run': undefined method `debug' for nil:NilClass (NoMethodError)\n        from script.rb:10:in `each'\n        from script.rb:10:in `run'\n        from script.rb:23:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508878831, "post_id": 46919744, "comment_id": 80787376, "body": "In Rails you can get the request url, the controller and action. But since this is a SPA and not a classical web application then its pretty meaningless since Rails just serves JSON in response to ajax requests. In a (good) SPA you keep track of the &quot;current page&quot; or state by updating the URL - this also makes the application linkable. <code>history.pushState</code> lets you update the current url without reloading the page.<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/History_API\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/API/History_API</a>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508878959, "post_id": 46919744, "comment_id": 80787462, "body": "<a href=\"https://tomdale.net/2012/05/ember-routing/\" rel=\"nofollow noreferrer\">tomdale.net/2012/05/ember-routing</a>"}, {"owner": {"reputation": 11, "user_id": 6282618, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/fcXib.png?s=128&g=1", "display_name": "MrJesus", "link": "https://stackoverflow.com/users/6282618/mrjesus"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508880287, "post_id": 46919744, "comment_id": 80788099, "body": "@max Yeah.. I know, I should&#39;ve used a framework other than rails.. But I&#39;ve gone too far at this point lol. Should&#39;ve planned out the design better before jumping into a Rails build :/ Thank you for the useful links. Will have to put those practices to use. I&#39;m developing my portfolio, so it&#39;s important I follow good practices! This is the last thing on my list. Might just redevelop the whole thing using Angular once I&#39;m done. Thanks again"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6282618, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/fcXib.png?s=128&g=1", "display_name": "MrJesus", "link": "https://stackoverflow.com/users/6282618/mrjesus"}, "edited": false, "score": 0, "creation_date": 1508879811, "post_id": 46919928, "comment_id": 80787866, "body": "Ah, okay. Thanks for clarifying that JS will definitely have to be used. I just felt the need to verify if that was the case or not. Welp, am already using bootstrap utility classes.. Look like I&#39;ll be using scrollspy! Thanks"}], "tags": [], "owner": {"reputation": 1325, "user_id": 3295284, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdP8.jpg?s=128&g=1", "display_name": "patkoperwas", "link": "https://stackoverflow.com/users/3295284/patkoperwas"}, "is_accepted": false, "score": 0, "last_activity_date": 1508878825, "creation_date": 1508878825, "answer_id": 46919928, "question_id": 46919744, "link": "https://stackoverflow.com/questions/46919744/is-there-a-current-page-type-method-for-page-sections-using-rails5/46919928#46919928", "title": "Is there a &quot;current_page?&quot; type method for page sections using Rails5?", "body": "<p>If you want elements to on the page to update as the user interacts with the page you will have to use Javascript.</p>\n\n<p>If you're using Bootstrap take a look at their Scrollspy component\n<a href=\"https://getbootstrap.com/docs/4.0/components/scrollspy/\" rel=\"nofollow noreferrer\">https://getbootstrap.com/docs/4.0/components/scrollspy/</a></p>\n\n<p>If you want something more lightweight and minimal, take a look at this related question <a href=\"https://stackoverflow.com/questions/9979827/change-active-menu-item-on-page-scroll\">Change Active Menu Item on Page Scroll?</a></p>\n"}], "owner": {"reputation": 11, "user_id": 6282618, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/fcXib.png?s=128&g=1", "display_name": "MrJesus", "link": "https://stackoverflow.com/users/6282618/mrjesus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508878825, "creation_date": 1508878069, "question_id": 46919744, "link": "https://stackoverflow.com/questions/46919744/is-there-a-current-page-type-method-for-page-sections-using-rails5", "title": "Is there a &quot;current_page?&quot; type method for page sections using Rails5?", "body": "<p>QUICK QUESTIONS.</p>\n\n<p>I'm using Rails to develop a single page webapp with a sidebar for scrolling. I'd like for my sidebar to change active states depending on the page section. </p>\n\n<p>I'm used to using the \"current_page?\" method to set navigation links active, but am unaware if there is a method like this for page sections. I know jQuery can get this working, but I'd like to use as little lines of code as possible. </p>\n\n<p><strong><em>Is there another method out there like \"current_page\", but for sections on a page?</em></strong></p>\n\n<p><strong><em>Is there maybe a way to still use \"current_page?\", and apply that to page sections?</em></strong></p>\n\n<p><strong><em>Am I forced to use jQuery?</em></strong> </p>\n\n<p>Have never used Rails for a single page webapp, so am feeling lost on how I could use the controller here. I know I probably should've used a framework like Angular, but I did not originally plan on developing this to be a single page webapp.</p>\n\n<p>Any help or advice would be GREATLY appreciated!</p>\n"}, {"tags": ["ruby", "amazon-web-services", "ruby-on-rails-5", "amazon-elastic-beanstalk"], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 491376, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/315c7e0a22144bd075a506ca351ea604?s=128&d=identicon&r=PG", "display_name": "hudarsono", "link": "https://stackoverflow.com/users/491376/hudarsono"}, "edited": false, "score": 0, "creation_date": 1523613674, "post_id": 46935141, "comment_id": 86642812, "body": "Hi Jay, may you elaborate a bit more on how to execute option 3?  I have the same issue, and tried option 2 but didnt work. still the same error."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 349, "user_id": 491376, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/315c7e0a22144bd075a506ca351ea604?s=128&d=identicon&r=PG", "display_name": "hudarsono", "link": "https://stackoverflow.com/users/491376/hudarsono"}, "edited": false, "score": 0, "creation_date": 1523645294, "post_id": 46935141, "comment_id": 86662476, "body": "@hudarsono It&#39;s been so long since I&#39;ve run into this I don&#39;t remember the exact details and I don&#39;t have the code from when I ran into this. I&#39;ll add an update to my answer with the details I do remember"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 349, "user_id": 491376, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/315c7e0a22144bd075a506ca351ea604?s=128&d=identicon&r=PG", "display_name": "hudarsono", "link": "https://stackoverflow.com/users/491376/hudarsono"}, "edited": false, "score": 0, "creation_date": 1523647211, "post_id": 46935141, "comment_id": 86663437, "body": "@hudarsono I updated with some new info. Also, the dotenv gem has new maintainers and they&#39;ve re-opened the issue I filed so they may merge that fix in hopefully. If they do, that would be the solution you&#39;d want. If they don&#39;t, I&#39;d suggest a fork. The change is minor and easy to maintain, and should be forwards compatible with EB changes. Good luck, let me know if you need anything else"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 349, "user_id": 491376, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/315c7e0a22144bd075a506ca351ea604?s=128&d=identicon&r=PG", "display_name": "hudarsono", "link": "https://stackoverflow.com/users/491376/hudarsono"}, "edited": false, "score": 0, "creation_date": 1523817974, "post_id": 46935141, "comment_id": 86705990, "body": "@hudarsono the new maintainers merged my pull request in. You might try using the latest master of dotenv (hasn&#39;t been packaged and published to rubygems yet)"}, {"owner": {"reputation": 349, "user_id": 491376, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/315c7e0a22144bd075a506ca351ea604?s=128&d=identicon&r=PG", "display_name": "hudarsono", "link": "https://stackoverflow.com/users/491376/hudarsono"}, "edited": false, "score": 1, "creation_date": 1523858636, "post_id": 46935141, "comment_id": 86715503, "body": "thank you for following up. As I am using figaro rather that dotenv, so I resorted to deleting the rb-readline gem which is the first option. And it works fine now. Thanks!"}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": true, "score": 2, "last_activity_date": 1523647116, "last_edit_date": 1523647116, "creation_date": 1508941890, "answer_id": 46935141, "question_id": 46919232, "link": "https://stackoverflow.com/questions/46919232/issue-deploying-rails-5-application-to-aws-using-elastic-beanstalk-due-to-rb-rea/46935141#46935141", "title": "issue deploying rails 5 application to AWS using Elastic Beanstalk due to rb-readline", "body": "<p>I had a similar error, but with dot-env rails gem. It looks like it <em>might</em> be same root cause.</p>\n\n<p>It appeared to be because <code>$HOME</code> was not set by AWS during the deploy, and a call to <code>File.expand_path</code> dies when it's not set.</p>\n\n<p>Possible fixes:</p>\n\n<ol>\n<li>Remove rbreadline</li>\n<li>Add a <code>HOME</code> environment variable into your EB configuration or <code>eb setenv</code> (and redeploy)</li>\n<li>Add a config file that overwrites the existing deploy script &amp; adds a $HOME variable before the bundle install command is run</li>\n</ol>\n\n<p>I successfully tried the first and last option, and settled with using a forked version of the Gem that handled a missing <code>$HOME</code> correctly. </p>\n\n<p>I suspect the 2nd version is the more correct way to do it, but to be honest it's unclear why Amazon didn't set a <code>$HOME</code> to begin with, and what it should actually be.</p>\n\n<p>The app will exist in either <code>/var/app/ondeck</code> or <code>/var/app/current</code> so either one of those two folders, or <code>/home/webapp</code> (per the error) all might be a good value to start with.</p>\n\n<p>This may not be 100% the root cause because I've had varying degrees of luck with replicating this locally with different versions of Ruby. However, the <code>expand_path</code> docs do say <code>HOME</code> must be set correctly so this may be the cause.</p>\n\n<p><a href=\"https://ruby-doc.org/core-2.4.2/File.html#method-c-expand_path\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.4.2/File.html#method-c-expand_path</a></p>\n\n<p>More detail on working solutions:</p>\n\n<p>I found two solutions that worked (try one or the other)</p>\n\n<p>At one point I did submit a PR with dotenv to fix this issue. <a href=\"https://github.com/bkeepers/dotenv/pull/314\" rel=\"nofollow noreferrer\">https://github.com/bkeepers/dotenv/pull/314</a>. As far as I recall, this fixes it, and doesn't break anything else. The issue was marked as <code>wontfix</code> by the automated bot, but has recently been re-opened by the new maintainers</p>\n\n<p>I ultimately switched back to the ebextensions approach after it was clear my PR wouldn't be merged, but last I recall it was functioning as expected (and I think the better approach)</p>\n\n<p>The other solution I used was to create a new config file that replaced the <code>/opt/elasticbeanstalk/hooks/appdeploy/pre/10_bundle_install.sh</code> file. </p>\n\n<ul>\n<li>Get the current version of that file from an existing application server</li>\n<li>Create an ebextension config that creates that file (it will overwrite the original) but include a line to set the <code>$HOME</code> variable before the <code>bundle install</code> command is run. </li>\n<li>Set the <code>$HOME</code> value to whatever it would be for the default user</li>\n</ul>\n\n<p>The documentation for creating such a file using ebextensions are here:</p>\n\n<p><a href=\"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers-ec2.html#linux-files\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers-ec2.html#linux-files</a></p>\n"}], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1611, "favorite_count": 2, "accepted_answer_id": 46935141, "answer_count": 1, "score": 4, "last_activity_date": 1523647116, "creation_date": 1508875893, "question_id": 46919232, "link": "https://stackoverflow.com/questions/46919232/issue-deploying-rails-5-application-to-aws-using-elastic-beanstalk-due-to-rb-rea", "title": "issue deploying rails 5 application to AWS using Elastic Beanstalk due to rb-readline", "body": "<p>I am trying to deploy my code to AWS using elastic beanstalk but keep running into errors when deploying.</p>\n\n<p>I added a gem 'rb-readline' and when I check the logs I see that there is an error with this gem in deployment. I can't remember what error adding the gem 'rb-readline' fixed but I don't know if removing the gem would fix this problem. Here is the link to the gem: <a href=\"https://github.com/ConnorAtherton/rb-readline\" rel=\"nofollow noreferrer\">https://github.com/ConnorAtherton/rb-readline</a></p>\n\n<p>here is the error log from the deployment.</p>\n\n<pre><code>Application update failed at 2017-10-24T19:27:36Z with exit status 1 and error: Hook /opt/elasticbeanstalk/hooks/appdeploy/pre/11_asset_compilation.sh failed.\n\n++ /opt/elasticbeanstalk/bin/get-config container -k script_dir\n+ EB_SCRIPT_DIR=/opt/elasticbeanstalk/support/scripts\n++ /opt/elasticbeanstalk/bin/get-config container -k app_staging_dir\n+ EB_APP_STAGING_DIR=/var/app/ondeck\n++ /opt/elasticbeanstalk/bin/get-config container -k app_user\n+ EB_APP_USER=webapp\n++ /opt/elasticbeanstalk/bin/get-config container -k support_dir\n+ EB_SUPPORT_DIR=/opt/elasticbeanstalk/support\n+ . /opt/elasticbeanstalk/support/envvars\n++ export RACK_ENV=production\n++ RACK_ENV=production\n++ export RAILS_SKIP_ASSET_COMPILATION=false\n++ RAILS_SKIP_ASSET_COMPILATION=false\n++ export RAILS_SKIP_MIGRATIONS=false\n++ RAILS_SKIP_MIGRATIONS=false\n++ export BUNDLE_WITHOUT=test:development\n++ BUNDLE_WITHOUT=test:development\n++ export RDS_PORT=5432\n++ RDS_PORT=5432\n++ export RDS_HOSTNAME=aa16lalntiz6vr0.cghvpjf0tzo5.us-east-1.rds.amazonaws.com\n++ RDS_HOSTNAME=aa16lalntiz6vr0.cghvpjf0tzo5.us-east-1.rds.amazonaws.com\n++ export RDS_USERNAME=theasteve\n++ RDS_USERNAME=theasteve\n++ export RDS_DB_NAME=ebdb\n++ RDS_DB_NAME=ebdb\n++ export RDS_PASSWORD=Colombia1\n++ RDS_PASSWORD=Colombia1\n+ RAKE_TASK=assets:precompile\n+ . /opt/elasticbeanstalk/support/scripts/use-app-ruby.sh\n++ . /usr/local/share/chruby/chruby.sh\n+++ CHRUBY_VERSION=0.3.9\n+++ RUBIES=()\n+++ for dir in '\"$PREFIX/opt/rubies\"' '\"$HOME/.rubies\"'\n+++ [[ -d /opt/rubies ]]\n++++ ls -A /opt/rubies\n+++ [[ -n ruby-1.9.3-p551\nruby-2.0.0-p648\nruby-2.1.10\nruby-2.2.8\nruby-2.3.5\nruby-2.4.2\nruby-current ]]\n+++ RUBIES+=(\"$dir\"/*)\n+++ for dir in '\"$PREFIX/opt/rubies\"' '\"$HOME/.rubies\"'\n+++ [[ -d /.rubies ]]\n+++ unset dir\n+++ cat /etc/elasticbeanstalk/.ruby_version\n++ chruby 2.3.5\n++ case \"$1\" in\n++ local dir match\n++ for dir in '\"${RUBIES[@]}\"'\n++ dir=/opt/rubies/ruby-1.9.3-p551\n++ case \"${dir##*/}\" in\n++ for dir in '\"${RUBIES[@]}\"'\n++ dir=/opt/rubies/ruby-2.0.0-p648\n++ case \"${dir##*/}\" in\n++ for dir in '\"${RUBIES[@]}\"'\n++ dir=/opt/rubies/ruby-2.1.10\n++ case \"${dir##*/}\" in\n++ for dir in '\"${RUBIES[@]}\"'\n++ dir=/opt/rubies/ruby-2.2.8\n++ case \"${dir##*/}\" in\n++ for dir in '\"${RUBIES[@]}\"'\n++ dir=/opt/rubies/ruby-2.3.5\n++ case \"${dir##*/}\" in\n++ match=/opt/rubies/ruby-2.3.5\n++ for dir in '\"${RUBIES[@]}\"'\n++ dir=/opt/rubies/ruby-2.4.2\n++ case \"${dir##*/}\" in\n++ for dir in '\"${RUBIES[@]}\"'\n++ dir=/opt/rubies/ruby-current\n++ case \"${dir##*/}\" in\n++ [[ -z /opt/rubies/ruby-2.3.5 ]]\n++ shift\n++ chruby_use /opt/rubies/ruby-2.3.5 ''\n++ [[ ! -x /opt/rubies/ruby-2.3.5/bin/ruby ]]\n++ [[ -n '' ]]\n++ export RUBY_ROOT=/opt/rubies/ruby-2.3.5\n++ RUBY_ROOT=/opt/rubies/ruby-2.3.5\n++ export RUBYOPT=\n++ RUBYOPT=\n++ export PATH=/opt/rubies/ruby-2.3.5/bin:/opt/elasticbeanstalk/lib/ruby/bin:/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin\n++ PATH=/opt/rubies/ruby-2.3.5/bin:/opt/elasticbeanstalk/lib/ruby/bin:/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin\n+++ /opt/rubies/ruby-2.3.5/bin/ruby -\n++ eval 'export RUBY_ENGINE=ruby;\nexport RUBY_VERSION=2.3.5;\nexport GEM_ROOT=\"/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0\";'\n+++ export RUBY_ENGINE=ruby\n+++ RUBY_ENGINE=ruby\n+++ export RUBY_VERSION=2.3.5\n+++ RUBY_VERSION=2.3.5\n+++ export GEM_ROOT=/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0\n+++ GEM_ROOT=/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0\n++ (( 0 != 0 ))\n+ cd /var/app/ondeck\n+ su -s /bin/bash -c 'bundle exec /opt/elasticbeanstalk/support/scripts/check-for-rake-task.rb assets:precompile' webapp\n`/home/webapp` is not a directory.\nBundler will use `/tmp/bundler/home/webapp' as your home directory temporarily.\n+ '[' false == true ']'\n+ su -s /bin/bash -c 'bundle exec rake assets:precompile' webapp\n`/home/webapp` is not a directory.\nBundler will use `/tmp/bundler/home/webapp' as your home directory temporarily.\nrake aborted!\nBundler::GemRequireError: There was an error while trying to load the gem 'rb-readline'.\nGem Load Error is: HOME environment variable (or HOMEDRIVE and HOMEPATH) must be set and point to a directory\nBacktrace for gem load error is:\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rb-readline-0.5.4/lib/rbreadline.rb:1097:in `&lt;module:RbReadline&gt;'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rb-readline-0.5.4/lib/rbreadline.rb:17:in `&lt;top (required)&gt;'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rb-readline-0.5.4/lib/readline.rb:10:in `require'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rb-readline-0.5.4/lib/readline.rb:10:in `&lt;module:Readline&gt;'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rb-readline-0.5.4/lib/readline.rb:8:in `&lt;top (required)&gt;'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rb-readline-0.5.4/lib/rb-readline.rb:16:in `require'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rb-readline-0.5.4/lib/rb-readline.rb:16:in `&lt;top (required)&gt;'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/runtime.rb:82:in `require'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/runtime.rb:82:in `block (2 levels) in require'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/runtime.rb:77:in `each'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/runtime.rb:77:in `block in require'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/runtime.rb:66:in `each'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/runtime.rb:66:in `require'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler.rb:108:in `require'\n/var/app/ondeck/config/application.rb:17:in `&lt;top (required)&gt;'\n/var/app/ondeck/Rakefile:4:in `require_relative'\n/var/app/ondeck/Rakefile:4:in `&lt;top (required)&gt;'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rake-12.0.0/lib/rake/rake_module.rb:28:in `load'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rake-12.0.0/lib/rake/rake_module.rb:28:in `load_rakefile'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rake-12.0.0/lib/rake/application.rb:687:in `raw_load_rakefile'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rake-12.0.0/lib/rake/application.rb:96:in `block in load_rakefile'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rake-12.0.0/lib/rake/application.rb:178:in `standard_exception_handling'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rake-12.0.0/lib/rake/application.rb:95:in `load_rakefile'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rake-12.0.0/lib/rake/application.rb:79:in `block in run'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rake-12.0.0/lib/rake/application.rb:178:in `standard_exception_handling'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rake-12.0.0/lib/rake/application.rb:77:in `run'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/rake-12.0.0/exe/rake:27:in `&lt;top (required)&gt;'\n/opt/rubies/ruby-2.3.5/bin/rake:23:in `load'\n/opt/rubies/ruby-2.3.5/bin/rake:23:in `&lt;top (required)&gt;'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/cli/exec.rb:74:in `load'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/cli/exec.rb:74:in `kernel_load'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/cli/exec.rb:27:in `run'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/cli.rb:360:in `exec'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/vendor/thor/lib/thor.rb:369:in `dispatch'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/cli.rb:20:in `dispatch'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/vendor/thor/lib/thor/base.rb:444:in `start'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/cli.rb:10:in `start'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/exe/bundle:35:in `block in &lt;top (required)&gt;'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/friendly_errors.rb:121:in `with_friendly_errors'\n/opt/rubies/ruby-2.3.5/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/exe/bundle:27:in `&lt;top (required)&gt;'\n/opt/rubies/ruby-2.3.5/bin/bundle:23:in `load'\n/opt/rubies/ruby-2.3.5/bin/bundle:23:in `&lt;main&gt;'\nBundler Error Backtrace:\n/var/app/ondeck/config/application.rb:17:in `&lt;top (required)&gt;'\n/var/app/ondeck/Rakefile:4:in `require_relative'\n/var/app/ondeck/Rakefile:4:in `&lt;top (required)&gt;'\n/opt/rubies/ruby-2.3.5/bin/bundle:23:in `load'\n/opt/rubies/ruby-2.3.5/bin/bundle:23:in `&lt;main&gt;'\nHOME environment variable (or HOMEDRIVE and HOMEPATH) must be set and point to a directory\n/var/app/ondeck/config/application.rb:17:in `&lt;top (required)&gt;'\n/var/app/ondeck/Rakefile:4:in `require_relative'\n/var/app/ondeck/Rakefile:4:in `&lt;top (required)&gt;'\n/opt/rubies/ruby-2.3.5/bin/bundle:23:in `load'\n/opt/rubies/ruby-2.3.5/bin/bundle:23:in `&lt;main&gt;'\n(See full trace by running task with --trace).\nIncorrect application version \"app-cd09-171024_152653\" (deployment 3). Expected version \"app-cd09-171024_150253\" (deployment 2).\n100 % of CPU is in use.\n</code></pre>\n"}, {"tags": ["ruby", "graphql"], "comments": [{"owner": {"reputation": 4625, "user_id": 3076424, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/aeq6d.jpg?s=128&g=1", "display_name": "yachaka", "link": "https://stackoverflow.com/users/3076424/yachaka"}, "edited": false, "score": 0, "creation_date": 1508979667, "post_id": 46918847, "comment_id": 80835871, "body": "I don&#39;t use graphql-ruby ; it seems to me that you must name your mutation"}, {"owner": {"reputation": 45, "user_id": 8302861, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d24b0259ed085997cd8d0c7a11552a36?s=128&d=identicon&r=PG&f=1", "display_name": "testing_josh", "link": "https://stackoverflow.com/users/8302861/testing-josh"}, "reply_to_user": {"reputation": 4625, "user_id": 3076424, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/aeq6d.jpg?s=128&g=1", "display_name": "yachaka", "link": "https://stackoverflow.com/users/3076424/yachaka"}, "edited": false, "score": 0, "creation_date": 1509039160, "post_id": 46918847, "comment_id": 80868286, "body": "I added a name to my mutation, still no luck."}], "owner": {"reputation": 45, "user_id": 8302861, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d24b0259ed085997cd8d0c7a11552a36?s=128&d=identicon&r=PG&f=1", "display_name": "testing_josh", "link": "https://stackoverflow.com/users/8302861/testing-josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509039174, "creation_date": 1508874353, "last_edit_date": 1509039174, "question_id": 46918847, "link": "https://stackoverflow.com/questions/46918847/graphql-unknown-keywords-when-trying-to-query", "title": "GraphQL: unknown keywords when trying to query", "body": "<p>I currently using the github/graphql-client ruby gem to try and query my GraphQL API. Here is what I have.</p>\n\n<pre><code>module MyAPI\n  HTTP = GraphQL::Client::HTTP.new(\"http://myapi.com/graphql\")\n  Schema = GraphQL::Client.load_schema(HTTP)\n  Client = GraphQL::Client.new(schema: Schema, execute: HTTP)\nend\n\n# Create the query.\nCreateMeeting = MyAPI::Client.parse &lt;&lt;-'GRAPHQL'\n  mutation CreateMeeting($name: String!, $meeting_id: String!){\n    createMeeting(name: $name, meeting_id: $meeting_id){\n      name\n    }\n  }\nGRAPHQL\n\nmeeting = {name: 'test', meeting_id: 'm_id'}\nMyAPI::Client.query(CreateMeeting, meeting)\n</code></pre>\n\n<p>This give me back the following error:</p>\n\n<p><code>unknown keywords: name, meeting_id</code></p>\n\n<p>I'm not sure what's causing this, because within createMeeting on the API name and meeting_id are defined as String arguments.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1508873777, "post_id": 46918476, "comment_id": 80784721, "body": "Adding spaces like this leads to ambiguity which leads to bugs which leads to Stack Overflow questions which could have been avoided by keeping things orderly and well-formatted. To stomp out habits like this, tools like <a href=\"https://github.com/bbatsov/rubocop\" rel=\"nofollow noreferrer\">Rubocop</a> are very good at laying down the law."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 2, "last_activity_date": 1508873022, "creation_date": 1508873022, "answer_id": 46918476, "question_id": 46918442, "link": "https://stackoverflow.com/questions/46918442/my-application-doesnt-start-because-of-the-product-id/46918476#46918476", "title": "my application doesnt start because of the product id", "body": "<p>Remove space between <code>line_items_path</code> and its arguments (and remove this <code>do</code> keyword):</p>\n\n<pre><code>&lt;%= button_to 'Add to Cart', line_items_path(product_id: product.id) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8745775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe423a08bd07afb19b2f4138d111fdb?s=128&d=identicon&r=PG&f=1", "display_name": "george", "link": "https://stackoverflow.com/users/8745775/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1508875271, "creation_date": 1508872888, "last_edit_date": 1508875271, "question_id": 46918442, "link": "https://stackoverflow.com/questions/46918442/my-application-doesnt-start-because-of-the-product-id", "title": "my application doesnt start because of the product id", "body": "<p>I am currently stuck on a piece of code.  Please help guys. I am developing an online store. Everything works perfect until i add this line of code <code>(product_id: do product.id)</code>  to my homepage.  Here is the problem when i try to load the application.</p>\n\n<pre><code>ruby 2.4.1p111 (2017-03-22 revision 58053) [i386-mingw32]\n\nC:\\Users\\COMPUTER&gt;cd desktop\n\nC:\\Users\\COMPUTER\\Desktop&gt;cd trial\n\nC:\\Users\\COMPUTER\\Desktop\\trial&gt;cd depot\n\nC:\\Users\\COMPUTER\\Desktop\\trial\\depot&gt;rails s\n=&gt; Booting Puma\n=&gt; Rails 5.0.5 application starting in development on http://localhost:3000\n=&gt; Run `rails server -h` for more startup options\n*** SIGUSR2 not implemented, signal based restart unavailable!\n*** SIGUSR1 not implemented, signal based restart unavailable!\n*** SIGHUP not implemented, signal based logs reopening unavailable!\nPuma starting in single mode...\n* Version 3.10.0 (ruby 2.4.1-p111), codename: Russell's Teapot\n* Min threads: 5, max threads: 5\n* Environment: development\n* Listening on tcp://0.0.0.0:3000\nUse Ctrl-C to stop\nStarted GET \"/\" for 127.0.0.1 at 2017-10-23 17:21:30 +0100\n  ActiveRecord::SchemaMigration Load (0.0ms)  SELECT \"schema_migrations\".* FROM \"schema_migrations\"\nProcessing by StoreController#index as HTML\n  Rendering store/index.html.erb within layouts/application\n  Rendered store/index.html.erb within layouts/application (4.0ms)\nCompleted 500 Internal Server Error in 1256ms (ActiveRecord: 0.0ms)\n\n\n\nSyntaxError (C:/Users/COMPUTER/Desktop/trial/depot/app/views/store/index.html.erb:18: syntax error, unexpected ( arg, expecting keyword_do or '{' or '('\nd to Cart' , line_items_path (product_id: product.id)  );@ou\n                              ^\nC:/Users/COMPUTER/Desktop/trial/depot/app/views/store/index.html.erb:18: syntax error, unexpected ')', expecting keyword_end\nth (product_id: product.id)  );@output_buffer.safe_append='\n                              ^\nC:/Users/COMPUTER/Desktop/trial/depot/app/views/store/index.html.erb:24: syntax error, unexpected keyword_ensure, expecting end-of-input\n          ensure\n                ^):\n\napp/views/store/index.html.erb:18: syntax error, unexpected ( arg, expecting keyword_do or '{' or '('\napp/views/store/index.html.erb:18: syntax error, unexpected ')', expecting keyword_end\napp/views/store/index.html.erb:24: syntax error, unexpected keyword_ensure, expecting end-of-input\n  Rendering C:/Ruby24/lib/ruby/gems/2.4.0/gems/actionpack-5.0.5/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout\n  Rendering C:/Ruby24/lib/ruby/gems/2.4.0/gems/actionpack-5.0.5/lib/action_dispatch/middleware/templates/rescues/_source.html.erb\n  Rendered C:/Ruby24/lib/ruby/gems/2.4.0/gems/actionpack-5.0.5/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (88.0ms)\n  Rendering C:/Ruby24/lib/ruby/gems/2.4.0/gems/actionpack-5.0.5/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb\n  Rendered C:/Ruby24/lib/ruby/gems/2.4.0/gems/actionpack-5.0.5/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (32.0ms)\n  Rendering C:/Ruby24/lib/ruby/gems/2.4.0/gems/actionpack-5.0.5/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb\n  Rendered C:/Ruby24/lib/ruby/gems/2.4.0/gems/actionpack-5.0.5/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (8.0ms)\n  Rendered C:/Ruby24/lib/ruby/gems/2.4.0/gems/actionpack-5.0.5/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (9608.1ms)    \n</code></pre>\n\n<p>this is the homepage.....</p>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt; \n\n&lt;h1&gt;Your Pragmatic Catalog&lt;/h1&gt; \n&lt;% cache @products do %&gt;\n&lt;% @products.each do |product| %&gt; \n&lt;% cache @product do %&gt;\n&lt;div class=\"entry\"&gt; \n\n\n&lt;h3&gt;&lt;%= product.title %&gt;&lt;/h3&gt; \n\n&lt;%= image_tag(product.image_url) %&gt;\n&lt;%= sanitize(product.description) %&gt;\n&lt;div class=\"price_line\"&gt; \n\n&lt;span class=\"price\"&gt;&lt;%= number_to_currency (product.price) %&gt;&lt;/span&gt; \n\n&lt;%= button_to 'Add to Cart' , line_items_path (product_id: do product.id)  %&gt;\n&lt;/div&gt; \n&lt;/div&gt; \n&lt;% end %&gt;\n&lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>this is the controller.....</p>\n\n<pre><code>class StoreController &lt; ApplicationController\n  def index\n    @products = Product.order(:title)\n\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508873866, "post_id": 46918425, "comment_id": 80784761, "body": "You have some good data there. The next step before asking a Stack Overflow question is to try something, anything, to solve your problem. You need to have some Ruby code in here. You can&#39;t &quot;refactor&quot; nothing."}, {"owner": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508874211, "post_id": 46918425, "comment_id": 80784932, "body": "Np, but my attempt is embarassing."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508874244, "post_id": 46918425, "comment_id": 80784951, "body": "Embarrassing or not, it shows you&#39;re committed to solving the problem and we&#39;ll respect you more for that than expecting us to come up with the answer for you."}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1508944380, "post_id": 46918425, "comment_id": 80819257, "body": "Curiosity question: Did the hash exist as a JSON prior to being converted to a hash?"}], "answers": [{"comments": [{"owner": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "edited": false, "score": 0, "creation_date": 1508888732, "post_id": 46920813, "comment_id": 80790732, "body": "Your suggestion is very close to but not quite what I am trying to achieve and has certainly given me a direction to investigate.  Many thanks!"}, {"owner": {"reputation": 10076, "user_id": 4010391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/NgRol.jpg?s=128&g=1", "display_name": "Travis", "link": "https://stackoverflow.com/users/4010391/travis"}, "reply_to_user": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "edited": false, "score": 0, "creation_date": 1508943725, "post_id": 46920813, "comment_id": 80818767, "body": "@ARL I updated the answer without <code>Array#flatten</code> which I think matches what you&#39;re looking for. If not let me know."}], "tags": [], "owner": {"reputation": 10076, "user_id": 4010391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/NgRol.jpg?s=128&g=1", "display_name": "Travis", "link": "https://stackoverflow.com/users/4010391/travis"}, "is_accepted": false, "score": 1, "last_activity_date": 1508943590, "last_edit_date": 1508943590, "creation_date": 1508882927, "answer_id": 46920813, "question_id": 46918425, "link": "https://stackoverflow.com/questions/46918425/generic-restructure-of-ruby-hash-with-depth-of-4/46920813#46920813", "title": "Generic restructure of ruby hash (with depth of 4)", "body": "<p>I think I follow what you're looking for and you should get what you're after with:</p>\n\n<pre><code>myhash.values.each_with_object([]) do |by_country, out_arr|\n  by_country.values.each do |by_type|\n    out_arr &lt;&lt; by_type.values\n  end\nend\n</code></pre>\n\n<p>which would return:</p>\n\n<pre><code>[\n  [\n    [\n      \"nginx-240\"\n    ],\n    [\n      \"nginx-210\",\n      \"nginx-241\",\n      \"nginx-211\",\n      \"nginx-209\"\n    ],\n    [\n      \"tomcat-269\",\n      \"tomcat-255\",\n      \"tomcat-119\",\n      \"tomcat-124\"\n    ]\n  ],\n  [\n    [\n      \"nginx-249\",\n      \"nginx-250\",\n      \"nginx-246\",\n      \"nginx-247\",\n      \"nginx-248\"\n    ],\n    [\n      \"tomcat-302\"\n    ],\n    [\n      \"tomcat-396\",\n      \"tomcat-156\",\n      \"tomcat-157\"\n    ]\n  ],\n  [\n    [\n      \"nginx-144\",\n      \"nginx-146\",\n      \"nginx-145\",\n      \"nginx-175\",\n      \"nginx-173\"\n    ],\n    [\n      \"tomcat-204\",\n      \"tomcat-206\"\n    ]\n  ]\n]\n</code></pre>\n\n<p>Piece by piece</p>\n\n<ul>\n<li>Take your hash, disgard the keys and just create an array of values.</li>\n<li>iterate over the values (array of hashes by country) and initialize an array to return.</li>\n<li>for each hash that by_country points to, again take the values, to drop into the by type(?) hashes</li>\n<li>iterate over your by_type hashes and again take the values of each</li>\n<li>push each return array into the array you want to return</li>\n</ul>\n"}], "owner": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1508943590, "creation_date": 1508872827, "last_edit_date": 1508874399, "question_id": 46918425, "link": "https://stackoverflow.com/questions/46918425/generic-restructure-of-ruby-hash-with-depth-of-4", "title": "Generic restructure of ruby hash (with depth of 4)", "body": "<p>Is it possible to convert this HASH into an array of arrays based solely on the position of the key (rather than it's value). ie: I know ahead of time that the first Key will always be PROD/ALPHA, and the second Key will always be a country (that I would like to be able to change in the future at will)</p>\n\n<p>The idea would be to group all servers of the same type (webservers) that are also in the same environment (production) but are located in different farms (UK, USA)</p>\n\n<p>While any suggestions on how to do this are welcome, <strong>I'll be happy to just know that I'm not walking into a dead-end I won't be able to solve.</strong></p>\n\n<p>Here are some visuals to aid in my explanation:</p>\n\n<pre><code>{\n  \"PROD\": {\n    \"USA\": {\n      \"generic\": [\n        \"nginx-240\"\n      ],\n      \"WEB\": [\n        \"nginx-210\",\n        \"nginx-241\",\n        \"nginx-211\",\n        \"nginx-209\"\n      ],\n      \"APP\": [\n        \"tomcat-269\",\n        \"tomcat-255\",\n        \"tomcat-119\",\n        \"tomcat-124\"\n      ]\n    },\n    \"UK\": {\n      \"WEB\": [\n        \"nginx-249\",\n        \"nginx-250\",\n        \"nginx-246\",\n        \"nginx-247\",\n        \"nginx-248\"\n      ],\n      \"generic\": [\n        \"tomcat-302\"\n      ],\n      \"APP\": [\n        \"tomcat-396\",\n        \"tomcat-156\",\n        \"tomcat-157\"\n      ]\n    }\n  },\n  \"ALPHA\": {\n    \"USA\": {\n      \"WEB\": [\n        \"nginx-144\",\n        \"nginx-146\",\n        \"nginx-145\",\n        \"nginx-175\",\n        \"nginx-173\"\n      ],\n      \"APP\": [\n        \"tomcat-204\",\n        \"tomcat-206\"\n      ]\n    }\n  }\n}\n</code></pre>\n\n<p>The expectation is that data from the <strong>lowest level</strong> in the hash would be grouped together.</p>\n\n<p>Again the idea is that all Production app servers (both from UK and USA) are grouped together in the following kind of pattern:</p>\n\n<p><strong>PROD_UK_APP</strong> would be represented by \n<strong>[\"tomcat-396\",\"tomcat-156\",\"tomcat-157\"]</strong> as these are the lowest branches of the tree PROD->UK->applicationserver</p>\n\n<pre><code>[\n [\n  [PROD_UK_APP],[PROD_USA_APP]\n ],\n [\n  [PROD_UK_WEB],[PROD_USA_WEB]\n ]\n]\n</code></pre>\n\n<p>New list..</p>\n\n<pre><code>[\n [\n  [ALPHA_USA_WEB]\n ],\n [\n  [ALPHA_USA_APP],\n [\n[ \n</code></pre>\n\n<p>Again the idea is to keep this generic. Is this something that is practically achievable or am I likely to require some degree of hardcoding to ensure it always works? The idea is that if tomorrow UK becomes JAPAN, it will still work in exactly the same way, comparing between the APP and WEB tier of UK, and JAPAN (separating ALPHA from PROD).</p>\n\n<p>EDIT: my attempt to try and sort it:</p>\n\n<pre><code>  def walk\n    a = []\n    myhash.each do |env, data|\n      data.each do |dc, tier|\n        tier.each do |x, y|\n          a &lt;&lt; y\n        end\n      end\n    end\n    p a\n  end\n\n[[\"nginx240\"], [\"nginx210\", \"nginx241\", \"nginx211\", \"nginx209\"], [\"tomcat269\", \"tomcat255\", \"tomcat119\", \"tomcat124\"], [\"nginx249\", \"nginx250\", \"nginx246\", \"nginx247\", \"nginx248\"], [\"tomcat302\"], [\"tomcat396\", \"tomcat156\", \"tomcat157\"], [\"nginx144\", \"nginx146\", \"nginx145\", \"nginx175\", \"nginx173\"], [\"tomcat204\", \"tomcat206\"]]\n</code></pre>\n\n<p>Thanks,</p>\n"}, {"tags": ["ruby", "yaml", "puppet", "erb"], "answers": [{"comments": [{"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1508931276, "post_id": 46918338, "comment_id": 80809396, "body": "This does work, except that it misses the <code>{}</code> on your first keys in each element. Does that matter?"}, {"owner": {"reputation": 147, "user_id": 8480012, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad35ceccd5aa5ad71759fd83a09a8ccb?s=128&d=identicon&r=PG&f=1", "display_name": "Merakel", "link": "https://stackoverflow.com/users/8480012/merakel"}, "reply_to_user": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1508946750, "post_id": 46918338, "comment_id": 80820992, "body": "Conceptually it works, it just needed a little cleanup to get the actual end result.  Still trying to figure out the absolute path thing though!"}], "tags": [], "owner": {"reputation": 147, "user_id": 8480012, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad35ceccd5aa5ad71759fd83a09a8ccb?s=128&d=identicon&r=PG&f=1", "display_name": "Merakel", "link": "https://stackoverflow.com/users/8480012/merakel"}, "is_accepted": true, "score": 1, "last_activity_date": 1508872447, "creation_date": 1508872447, "answer_id": 46918338, "question_id": 46918101, "link": "https://stackoverflow.com/questions/46918101/puppet-templates-iterations-and-yaml-files/46918338#46918338", "title": "Puppet Templates Iterations and yaml files", "body": "<p>Amazing how typing something out will answer your own question. I realized there was a pretty easy solution. If we take my template:</p>\n\n<pre><code>conf {\n&lt;% settings = YAML.load_file('/etc/puppetlabs/code/environments/example/data/conf.yaml') -%&gt;\n&lt;% settings['type'].each do |val| -%&gt;\n  &lt;%= val %&gt;\n&lt;% end -%&gt;\n}\n</code></pre>\n\n<p>and on line three replace <code>&lt;% settings['type'].each do |val| -%&gt;</code> with <code>&lt;% settings.keys.each do |val| -%&gt;</code> I'm able to get what I'm looking for. I'd still be interested if there is a better way to do this though, either how I'm loading via yaml or otherwise.</p>\n"}], "owner": {"reputation": 147, "user_id": 8480012, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad35ceccd5aa5ad71759fd83a09a8ccb?s=128&d=identicon&r=PG&f=1", "display_name": "Merakel", "link": "https://stackoverflow.com/users/8480012/merakel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 46918338, "answer_count": 1, "score": 2, "last_activity_date": 1508872447, "creation_date": 1508871537, "question_id": 46918101, "link": "https://stackoverflow.com/questions/46918101/puppet-templates-iterations-and-yaml-files", "title": "Puppet Templates Iterations and yaml files", "body": "<p>I have the following yaml file in my data dir:</p>\n\n<pre><code>---\ntype:\n  - config_setting1:\n    foo: bar\n  - config_setting2:\n    foo: bar\n</code></pre>\n\n<p>My <code>.erb</code> template looks like this:</p>\n\n<pre><code>conf {\n&lt;% settings = YAML.load_file('/etc/puppetlabs/code/environments/example/data/conf.yaml') -%&gt;\n&lt;% settings['type'].each do |val| -%&gt;\n  &lt;%= val %&gt;\n&lt;% end -%&gt;\n}\n</code></pre>\n\n<p>When I run puppet on my agent machine I end up with this:</p>\n\n<pre><code>conf {\n  {\"config_setting1\"=&gt;nil, \"foo\"=&gt;\"bar\"}\n  {\"config_setting2\"=&gt;nil, \"foo\"=&gt;\"bar\"}\n}\n</code></pre>\n\n<p>My end goal is to get the output to look like this:</p>\n\n<pre><code>conf {\n  config_setting1 {\n    foo: bar\n  }\n  config_setting2 {\n    foo: bar\n  }\n}\n</code></pre>\n\n<p>I know I have some clean up to do on my template to actually get things to output that way, but I'm more focused on the how than the end result at the moment. As you can see I'm familiar with using the <code>['type']</code> on the end of the settings to navigate through the nested hash, and I realize I could create this structure pretty easily if I hard coded it but I want to understand how to use it iteratively. I've been attempting to follow the <a href=\"https://puppet.com/docs/puppet/5.3/lang_iteration.html\" rel=\"nofollow noreferrer\">Puppet Documentation</a> on iterations but their examples don't work even when you copy them verbatim... which makes things a little difficult. How can I call pull out a single piece of data in a nested yaml file like I have? Either just the key or just a specific value? I tried something like:</p>\n\n<pre><code>&lt;% settings['type'].each do |val| -%&gt;\n  &lt;%= settings['val'] %&gt;\n&lt;% end -%&gt;\n</code></pre>\n\n<p>and multiple variations of this but I couldn't find the right syntax to get what I wanted. I've also tried having something along the lines of <code>&lt;% settings['type'].each do |index, value| -%&gt;</code> but I was unable to get any results I could use out of that either. If anyone could point me in the right direction I'd appreciate it. I'm open to being told that I'm going about this entirely the wrong way as well; if there is a better way to get at this data I'm all ears.</p>\n\n<p>Another question that's less important, but still irks me - in my load_file I have the absolute path... is there a way to use relative?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "aasm"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1508871780, "post_id": 46918073, "comment_id": 80783642, "body": "wouldn&#39;t <code>booking.payment_authorised</code> change the state of booking to &#39;payment_authorized&#39; rather than checking it? Do you mean, <code>booking.payment_authorized?</code>"}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1508872000, "post_id": 46918073, "comment_id": 80783773, "body": "Yes, typo is fixed.. It will change. But there is a scenario where I need to fetch all records satisfying those two states..."}], "answers": [{"comments": [{"owner": {"reputation": 906, "user_id": 7933325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4181aecdacd635102e337da145eafe9?s=128&d=identicon&r=PG", "display_name": "Tom Copeland", "link": "https://stackoverflow.com/users/7933325/tom-copeland"}, "reply_to_user": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1508872737, "post_id": 46918217, "comment_id": 80784171, "body": "Sure, no problem!"}], "tags": [], "owner": {"reputation": 906, "user_id": 7933325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4181aecdacd635102e337da145eafe9?s=128&d=identicon&r=PG", "display_name": "Tom Copeland", "link": "https://stackoverflow.com/users/7933325/tom-copeland"}, "is_accepted": true, "score": 2, "last_activity_date": 1508871990, "creation_date": 1508871990, "answer_id": 46918217, "question_id": 46918073, "link": "https://stackoverflow.com/questions/46918073/efficiently-fetching-records-on-multiple-condition/46918217#46918217", "title": "Efficiently fetching records on multiple condition", "body": "<p>You can use <code>Booking.payment_authorized.or(Booking.payment_captured)</code> to get all records in a single query.</p>\n"}, {"comments": [{"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1508873949, "post_id": 46918445, "comment_id": 80784805, "body": "Thank you for the explanation. This method works and easy to chain using scopes."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 1, "creation_date": 1508874112, "post_id": 46918445, "comment_id": 80784891, "body": "@Abhilash: Rails scoping will work with <code>OR</code> as well, since resultant of ActiveRelation is a Relation which can be chained. The slight advantage is how SQL queries <code>IN</code>(sorts and binary search) over <code>OR</code>(goes for all row by row)."}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1508874823, "post_id": 46918445, "comment_id": 80785247, "body": "Never used scopes with OR before. Thank you for the info."}], "tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": false, "score": 2, "last_activity_date": 1508872893, "creation_date": 1508872893, "answer_id": 46918445, "question_id": 46918073, "link": "https://stackoverflow.com/questions/46918073/efficiently-fetching-records-on-multiple-condition/46918445#46918445", "title": "Efficiently fetching records on multiple condition", "body": "<p>@Tom gave a pretty good solution for the problem. It utilizes <code>ActiveRelation</code>'s <code>OR</code> for logical union of two relations. Note that the solution is specific to Rails 5.</p>\n\n<p>You can also do it via:</p>\n\n<pre><code>Booking.where(aasm_state: [:payment_authorized, :payment_captured])\n</code></pre>\n\n<p><code>aasm</code> uses <code>aasm_state</code> column to contain the state, by default. It will make the <code>IN</code> query.</p>\n"}], "owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 46918217, "answer_count": 2, "score": 1, "last_activity_date": 1509262290, "creation_date": 1508871438, "last_edit_date": 1509262290, "question_id": 46918073, "link": "https://stackoverflow.com/questions/46918073/efficiently-fetching-records-on-multiple-condition", "title": "Efficiently fetching records on multiple condition", "body": "<p>Using <code>aasm</code> <code>statemachine</code> for model <code>Booking</code>.</p>\n\n<p>The state machine have below states</p>\n\n<pre><code> state :payment_authorized\n state :payment_captured\n state :payment_failed\n state :some_more_states\n</code></pre>\n\n<p>So to fetch bookings based on state I can call <code>booking.payment_authorized</code>. But what am looking for is I want all records with state <code>payment_authorized</code> and <code>payment_captured</code>. </p>\n\n<p>This works  <code>booking.payment_authorized + booking.payment_captured</code> but this is doing 2 database calls. one for finding <code>authorized_state</code> and other for <code>captured_state</code>. How can I do this more efficiently(in one call)?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "migration"], "comments": [{"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 1, "creation_date": 1508870643, "post_id": 46917812, "comment_id": 80783008, "body": "Can you show the relevant part of your <code>db&#47;schema.rb</code> and how you&#39;ve set up the association in your <code>Equipment</code> model? I&#39;d expect the name of that model&#39;s table to be <code>equipments</code> (plural). If so, your migration statement should be <code>add_reference :equipments, :category, foreign_key: true</code>."}, {"owner": {"reputation": 629, "user_id": 7116039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-W1XRU2i8SxQ/AAAAAAAAAAI/AAAAAAAAAHs/ceXJf5aD9w4/photo.jpg?sz=128", "display_name": "olegario", "link": "https://stackoverflow.com/users/7116039/olegario"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 1, "creation_date": 1508870850, "post_id": 46917812, "comment_id": 80783132, "body": "The name of the table, actually, is just <code>equipment</code>. I will edit the question so I can show the schema."}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 1, "creation_date": 1508871346, "post_id": 46917812, "comment_id": 80783400, "body": "Thanks for including the schema. (But please do share code as text, not images.) Can you also show the <code>has_one</code>/<code>belongs_to</code> associations in the models?"}, {"owner": {"reputation": 629, "user_id": 7116039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-W1XRU2i8SxQ/AAAAAAAAAAI/AAAAAAAAAHs/ceXJf5aD9w4/photo.jpg?sz=128", "display_name": "olegario", "link": "https://stackoverflow.com/users/7116039/olegario"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 1, "creation_date": 1508871737, "post_id": 46917812, "comment_id": 80783619, "body": "I added the associations and also edited the image. Thanks for the tips ;)"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1508871953, "post_id": 46917812, "comment_id": 80783742, "body": "model <code>Equipment</code> will never map to table <code>equipment</code> by default, according to rails convention(model name is singular, table as plural), unless you have explicitly specified with <code>self.table_name = &quot;equipment&quot;</code> in <code>Equipment</code> model."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 1, "creation_date": 1508872018, "post_id": 46917812, "comment_id": 80783785, "body": "also, it needs to be <code>belong_to :category</code> in <code>Equipment</code>"}], "answers": [{"comments": [{"owner": {"reputation": 629, "user_id": 7116039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-W1XRU2i8SxQ/AAAAAAAAAAI/AAAAAAAAAHs/ceXJf5aD9w4/photo.jpg?sz=128", "display_name": "olegario", "link": "https://stackoverflow.com/users/7116039/olegario"}, "edited": false, "score": 0, "creation_date": 1508878235, "post_id": 46918209, "comment_id": 80787042, "body": "I renamed with a migration the table <code>equipment</code> for <code>equipments</code>, but now Ruby is saying: <code>ActiveRecord::StatementInvalid: Could not find table &#39;equipment&#39; </code>"}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "reply_to_user": {"reputation": 629, "user_id": 7116039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-W1XRU2i8SxQ/AAAAAAAAAAI/AAAAAAAAAHs/ceXJf5aD9w4/photo.jpg?sz=128", "display_name": "olegario", "link": "https://stackoverflow.com/users/7116039/olegario"}, "edited": false, "score": 1, "creation_date": 1508878715, "post_id": 46918209, "comment_id": 80787315, "body": "Yeah you may need to tell the <code>Equipment</code> model to look for the table name <code>&quot;equipments&quot;</code>. By default it will look for a table called <code>&quot;equipment&quot;.pluralize</code>, which just evaluates to <code>&quot;equipment&quot;</code>. Do this in the model: <code>self.table_name = &quot;equipments&quot;</code>. (Docs: <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/ModelSchema/ClassMethods.html#method-i-table_name\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveRecord/ModelSchema/&hellip;</a>) The simplest route (all else equal) is to choose a different name altogether."}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1508882901, "post_id": 46918209, "comment_id": 80789104, "body": "Using a table called &quot;equipments&quot; defeats both the purpose of the inflector and exhibits the poor English the inflector is designed to prevent. The fact that you have to add extra configuration to support broken English makes it a very bad idea, IMHO."}], "tags": [], "owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "is_accepted": true, "score": 2, "last_activity_date": 1508871964, "creation_date": 1508871964, "answer_id": 46918209, "question_id": 46917812, "link": "https://stackoverflow.com/questions/46917812/fk-column-name-messed-in-rails/46918209#46918209", "title": "FK column name messed in Rails", "body": "<p>You want to use <code>belongs_to</code> for the class that has the foreign key, sp:</p>\n\n<pre><code>class Category &lt; ApplicationRecord\n    # Associations\n    has_many :equipment\n    ...\n\nclass Equipment &lt; ApplicationRecord\n    # Associations\n    belongs_to :category\n    ...\n</code></pre>\n\n<p>You might also run into some trouble because <code>equipment</code> is <a href=\"https://github.com/rails/rails/blob/20c91119903f70eb19aed33fe78417789dbf070f/activesupport/lib/active_support/inflections.rb#L70\" rel=\"nofollow noreferrer\">an irregularly inflected noun</a>\u2014it's its own plural in Rails. Using that kind of word for tables/models often involves to trial and error for me, and may ultimately be more trouble than it's worth.</p>\n"}], "owner": {"reputation": 629, "user_id": 7116039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-W1XRU2i8SxQ/AAAAAAAAAAI/AAAAAAAAAHs/ceXJf5aD9w4/photo.jpg?sz=128", "display_name": "olegario", "link": "https://stackoverflow.com/users/7116039/olegario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 46918209, "answer_count": 1, "score": 1, "last_activity_date": 1508871964, "creation_date": 1508870473, "last_edit_date": 1508871714, "question_id": 46917812, "link": "https://stackoverflow.com/questions/46917812/fk-column-name-messed-in-rails", "title": "FK column name messed in Rails", "body": "<p>So, I'm having my first in experience with Ruby on Rails. This is the second month, but somethings are still kind weird to me. In some cases I can do:</p>\n\n<pre><code>link.url = url\n</code></pre>\n\n<p>Where the Class Link has a FK to the Url Class. But in some cases, if I do:</p>\n\n<pre><code>equipment.category = category\n</code></pre>\n\n<p>The Rails start to complaining, saying:</p>\n\n<pre><code>ActiveModel::MissingAttributeError: can't write unknown attribute `equipment_id`\n</code></pre>\n\n<p>Why this happen? Every time I had to do it some changes in the tables about references I did:</p>\n\n<pre><code>add_reference :equipment, :category, foreign_key: true\n</code></pre>\n\n<p>So how can I do all Classes/Table behaviour like the first example?</p>\n\n<p><strong>EDIT 1:</strong></p>\n\n<p>My schema for Category and Equipment is this:</p>\n\n<pre><code>create_table \"categories\", force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\nend\n\ncreate_table \"equipment\", force: :cascade do |t|\n    t.string \"title\"\n    t.text \"description\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.integer \"category_id\"\n    t.index [\"category_id\"], name: \"index_equipment_on_category_id\"\nend\n</code></pre>\n\n<p><strong>EDIT 2</strong>\nThe associations in the classes are this:</p>\n\n<pre><code>class Category &lt; ApplicationRecord\n    # Associations\n    has_many :equipment\n    ...\n\nclass Equipment &lt; ApplicationRecord\n    # Associations\n    has_one :category\n    ...\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "performance", "processing-efficiency"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508867888, "post_id": 46917046, "comment_id": 80781489, "body": "No, you can not."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 3, "creation_date": 1508868203, "post_id": 46917046, "comment_id": 80781670, "body": "You don&#39;t need to loop over the entire array of 10_000 elements. You just need to loop over <code>[10,20, 45, 15, 99, 682, 100]</code>."}, {"owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1508868325, "post_id": 46917046, "comment_id": 80781747, "body": "@sawa in real time I have an array of 1 million records, and thousands of random numbers and at those indexes I have to assign a value say <code>0</code>., and by looping i mean to iterate of these given random numbers."}, {"owner": {"reputation": 404, "user_id": 1888553, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WznXZ.jpg?s=128&g=1", "display_name": "Derrell Durrett", "link": "https://stackoverflow.com/users/1888553/derrell-durrett"}, "edited": false, "score": 0, "creation_date": 1508869417, "post_id": 46917046, "comment_id": 80782340, "body": "What you&#39;re looking for is something like: <code>foo=[]; foo[3,5,7,8,12,40]=[0,0,0,0,0,0]</code>. <a href=\"https://ruby-doc.org/core-2.3.1/Array.html#method-i-5B-5D-3D\" rel=\"nofollow noreferrer\">The documentation of <code>Array#[]=</code></a> clearly shows that this isn&#39;t possible (as would be, say, in Perl)."}, {"owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "edited": false, "score": 0, "creation_date": 1508869565, "post_id": 46917046, "comment_id": 80782422, "body": "Yes was expecting something like this foo[10,15]=0."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1508869935, "post_id": 46917046, "comment_id": 80782639, "body": "<i>Sidenote:</i> do not use backticks for emphasis."}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508870061, "post_id": 46917046, "comment_id": 80782692, "body": "This feels like a data structured problem. At least for the case of access you could represent the data as a hash and use <code>#values_at</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 2, "creation_date": 1508870111, "post_id": 46917046, "comment_id": 80782717, "body": "@hoffm: arrays have <code>values_at</code> too. Still, be it read or write, one can&#39;t escape that loop/enumeration. It&#39;s fundamentally impossible. :)"}, {"owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "edited": false, "score": 0, "creation_date": 1508870170, "post_id": 46917046, "comment_id": 80782746, "body": "I have to assign values, dont want to get it."}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508870172, "post_id": 46917046, "comment_id": 80782749, "body": "@SergioTulentsev Good point. I retract that specific suggestion. But it still feels like representing the data differently could make this possible, if one cares only about CPU efficiency."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 1, "creation_date": 1508870575, "post_id": 46917046, "comment_id": 80782965, "body": "@hoffm if one cares about CPU efficiency that much, they should not use <a href=\"https://stackoverflow.com/questions/tagged/ruby\">ruby</a> for that in the first place. Native extension in <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> with array created with an explicit <code>malloc</code> and direct memory access would do, for instance."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1508881478, "post_id": 46917046, "comment_id": 80788591, "body": "@mudasobwa: I disagree. There are plenty of examples of well-performing Ruby code. Rubinius has thrown away their JIT and are working on a new one, but back when they <i>did</i> still have one, their <code>Hash</code> class (written in pure Ruby) was as performant as YARV&#39;s (written in C). And Chris Seaton has demonstrated pure-Ruby image manipulation code on TruffleRuby outperforming the same code using a native C extension on YARV. So, clearly, Ruby <i>can</i> be as fast as, and even faster than C, given a good enough compiler. (TruffleRuby has also demonstrated that its C interpreter can run C extensions \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1508881504, "post_id": 46917046, "comment_id": 80788603, "body": "\u2026 as fast as YARV can run them natively compiled, but that is a different interesting question.)"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1508883466, "post_id": 46917046, "comment_id": 80789300, "body": "You can always use <a href=\"https://crystal-lang.org/\" rel=\"nofollow noreferrer\">Crystal</a>..."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1508906925, "post_id": 46917046, "comment_id": 80795228, "body": "@J&#246;rgWMittag I am not sure I follow what exactly do you disagree with. Ruby due to it\u2019s nature has no ability to directly address memory and there is no way to outperform direct memory access while retrieving values. Single <code>get</code> using the implementation I proposed in the previous comment requires exactly 3 assembly instructions (including multiplication by value\u2019s length.) There is no way to outperform this <i>with an implementation</i>, no matter how great is it."}], "owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1508870614, "creation_date": 1508867715, "last_edit_date": 1508870614, "question_id": 46917046, "link": "https://stackoverflow.com/questions/46917046/assign-value-at-multiple-index-in-ruby-array-at-once", "title": "Assign value at multiple index in ruby array at once", "body": "<p>I have an array of <em>10_000 elements or more</em>, and I have got a bunch of random numbers, for example, say <code>[10,20, 45, 15, 99, 682, 100]</code>. I know that I can loop over array and access or set some value at these indexes. My questions is that can I assign values to these indexes at once without looping to make it <em>CPU efficient</em>.</p>\n"}, {"tags": ["ruby", "chef-infra", "recipe"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 0, "last_activity_date": 1508904064, "creation_date": 1508904064, "answer_id": 46923773, "question_id": 46916953, "link": "https://stackoverflow.com/questions/46916953/how-prevent-chef-failure-on-ruby-code/46923773#46923773", "title": "How prevent chef failure on ruby code?", "body": "<p>You didn't show where <code>title</code> comes from so they best I can say is to put your code in a <code>ruby_block</code> resource and use the <code>ignore_failure</code> property. You can also use normal Ruby <code>rescue</code> blocks for imperative code but be aware of how that interacts (or rather, doesn't) with resources, see <a href=\"https://coderanger.net/two-pass/\" rel=\"nofollow noreferrer\">https://coderanger.net/two-pass/</a> for some details on the loading process Chef uses.</p>\n"}], "owner": {"reputation": 69, "user_id": 5812504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f2a7f7d4a5fe4d9ec67067e0b891539?s=128&d=identicon&r=PG&f=1", "display_name": "goldver", "link": "https://stackoverflow.com/users/5812504/goldver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 46923773, "answer_count": 1, "score": -1, "last_activity_date": 1508904064, "creation_date": 1508867294, "last_edit_date": 1508869709, "question_id": 46916953, "link": "https://stackoverflow.com/questions/46916953/how-prevent-chef-failure-on-ruby-code", "title": "How prevent chef failure on ruby code?", "body": "<p>Sometimes Chef fails on the next code (this code not in block or any resource):</p>\n\n<pre><code>tmp = title.force_encoding(\"ISO-8859-1\").encode(\"UTF-8\")\ntitle = tmp.encode('ISO8859-1').force_encoding('UTF-8')\n</code></pre>\n\n<p>error that I get:</p>\n\n<h2>NoMethodError</h2>\n\n<p>undefined method `force_encoding' for nil:NilClass</p>\n\n<p>My question is how best practice to ignore any code error and to continue to run rest recipes, thanks </p>\n"}, {"tags": ["ruby", "require"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1508865492, "post_id": 46916248, "comment_id": 80780154, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3672586/what-is-the-difference-between-require-relative-and-require-in-ruby\">What is the difference between require_relative and require in Ruby?</a>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1508865550, "post_id": 46916248, "comment_id": 80780181, "body": "@BradWerth: not really a <i>duplicate</i>, though. Because this question doesn&#39;t mention <code>require_relative</code>."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 1, "creation_date": 1508865645, "post_id": 46916248, "comment_id": 80780239, "body": "There were better &quot;duplicates&quot; that made worse targets. I was looking at it sorta like how <a href=\"https://stackoverflow.com/questions/4660142/what-is-a-nullreferenceexception-and-how-do-i-fix-it\" title=\"what is a nullreferenceexception and how do i fix it\">stackoverflow.com/questions/4660142/&hellip;</a> gets used..."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 1, "creation_date": 1508865738, "post_id": 46916248, "comment_id": 80780286, "body": "I think the duplicate is justified, as it is clearly the information the OP is seeking. If not this one, I bet I could find at least one more require_relative question in the last 10 years of ruby questions...."}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 0, "last_activity_date": 1508865176, "creation_date": 1508865176, "answer_id": 46916343, "question_id": 46916248, "link": "https://stackoverflow.com/questions/46916248/requiring-files-from-a-required-file/46916343#46916343", "title": "Requiring files from a required file", "body": "<blockquote>\n  <p>Is there a way to denote a path relative to the actual required.rb</p>\n</blockquote>\n\n<p>Yes, kinda. There's another method for this.</p>\n\n<p><a href=\"http://ruby-doc.org/core-2.4.2/Kernel.html#method-i-require_relative\" rel=\"nofollow noreferrer\">http://ruby-doc.org/core-2.4.2/Kernel.html#method-i-require_relative</a></p>\n\n<blockquote>\n  <p><strong>require_relative(string) \u2192 true or false</strong></p>\n  \n  <p>Ruby tries to load the library named string relative to the requiring file\u2019s path. If the file\u2019s path cannot be determined a LoadError is raised. If a file is loaded true is returned and false otherwise.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 582, "user_id": 6080955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9794b0c5e0e9da2340181a57132e19d?s=128&d=identicon&r=PG&f=1", "display_name": "Bennett Talpers", "link": "https://stackoverflow.com/users/6080955/bennett-talpers"}, "is_accepted": false, "score": 0, "last_activity_date": 1508867009, "creation_date": 1508867009, "answer_id": 46916857, "question_id": 46916248, "link": "https://stackoverflow.com/questions/46916248/requiring-files-from-a-required-file/46916857#46916857", "title": "Requiring files from a required file", "body": "<p>I was incorrect regarding <code>__FILE__</code>; Using <code>File.dirname(__FILE__)</code> instead of <code>Dir.pwd</code> works for giving the directory of the actual file versus the directory of the invoking file.</p>\n"}], "owner": {"reputation": 582, "user_id": 6080955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9794b0c5e0e9da2340181a57132e19d?s=128&d=identicon&r=PG&f=1", "display_name": "Bennett Talpers", "link": "https://stackoverflow.com/users/6080955/bennett-talpers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508875117, "creation_date": 1508864850, "last_edit_date": 1508866377, "question_id": 46916248, "link": "https://stackoverflow.com/questions/46916248/requiring-files-from-a-required-file", "title": "Requiring files from a required file", "body": "<p>I have a file <code>required.rb</code> required by other files <code>main.rb</code> and <code>tester.rb</code>, each of which is invoked separately and run separately.</p>\n\n<p>Within <code>required.rb</code>, I want to require all files in a subdirectory of the required file. The whole thing looks something like this:</p>\n\n<pre><code>main.rb\nlib/\n   required.rb\n   req_files/\n      req1.rb\n      req2.rb\n      req3.rb\ntester/\n   tester.rb\n</code></pre>\n\n<p>The code to import the required files looks like:</p>\n\n<pre><code>Dir[Dir.pwd + \"/req_files/*.rb\"].each do  |file|\n  require file\nend\n</code></pre>\n\n<p>In suggested strategies I have seen, be it utilizing <code>Dir.pwd</code> or <code>__FILE__</code>, the context applied to <code>required.rb</code>'s location is the context of whichever original file required it in the first place, which means that I can't support requiring from both of those files separately with the current setup.</p>\n\n<p>Is there a way to denote a path relative to the actual <code>required.rb</code>?</p>\n\n<p>EDIT :</p>\n\n<p>It's not though, because changing require to require_relative doesn't change the fact that <code>Dir[Dir.pwd + \"/req_files/*.rb\"]</code> and more specifically <code>Dir.pwd</code> resolves with respect to the original file (main or tester), so it cannot be expressed as is in required and work for both entry points</p>\n\n<p>Also note that <code>required.rb</code> is required via <code>require_relative</code> already from both <code>main.rb</code> and <code>tester.rb</code>.</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 1, "creation_date": 1508866380, "post_id": 46915949, "comment_id": 80780647, "body": "You should do <code>@idz = params[:idz]</code>"}, {"owner": {"reputation": 554, "user_id": 8066456, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fcdc1b0ee11fa7ab705b178bd0a888da?s=128&d=identicon&r=PG&f=1", "display_name": "stig Garet", "link": "https://stackoverflow.com/users/8066456/stig-garet"}, "reply_to_user": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1508867959, "post_id": 46915949, "comment_id": 80781532, "body": "Thanks for your answer @7urkm3n, I&#39;ve finally succeed it, but is not an elegant solution at the end. So i&#39;m trying to remake entirely"}], "answers": [{"tags": [], "owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1508869126, "creation_date": 1508869126, "answer_id": 46917430, "question_id": 46915949, "link": "https://stackoverflow.com/questions/46915949/run-js-file-in-function-of-my-current-page/46917430#46917430", "title": "run js file in function of my current_page", "body": "<p>I see, you are using <code>remote: true</code></p>\n\n<p><strong>show.html.erb</strong></p>\n\n<pre><code>&lt;%= link_to \"undone\", undone_task_path(task.id, :idz=&gt; \"1\"), class: \"task_done_btn\", remote: true %&gt;\n</code></pre>\n\n<p><strong>Controller</strong></p>\n\n<pre><code>def undone\n  respond_to do |format|\n    @idz = params[:idz]\n    #no need format.html, because using remote: true\n    format.js \n  end\nend\n</code></pre>\n\n<p><strong>routes</strong></p>\n\n<pre><code>resources :tasks do\n  member do\n    put 'undone'\n  end\nend\n</code></pre>\n\n<p><strong>undone.js.erb</strong></p>\n\n<pre><code>&lt;%- if @idz == 1 %&gt;\n  // jquery 1\n&lt;% else %&gt; #no need elsif\n  // jquery 2\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 554, "user_id": 8066456, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fcdc1b0ee11fa7ab705b178bd0a888da?s=128&d=identicon&r=PG&f=1", "display_name": "stig Garet", "link": "https://stackoverflow.com/users/8066456/stig-garet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 46917430, "answer_count": 1, "score": 0, "last_activity_date": 1508869126, "creation_date": 1508863714, "question_id": 46915949, "link": "https://stackoverflow.com/questions/46915949/run-js-file-in-function-of-my-current-page", "title": "run js file in function of my current_page", "body": "<p>I would like to run my script from js file in function of my current_page</p>\n\n<p>To do that i'm trying something like that </p>\n\n<p><strong>Step 1</strong>\n ( insert a params (idz = 1 || 2) into my href to use it latter)</p>\n\n<p><em>groups/show.html.erb</em></p>\n\n<pre><code> &lt;%- if current_page?(\"/groups/#{task.group.id}/\")%&gt;\n  &lt;a href=\"/tasks/&lt;%=task.id%&gt;/undone?idz='1'\" data-method=\"patch\" data-remote=\"true\" class=\"task_done_btn\"&gt;undone&lt;/a&gt;\n&lt;% elsif current_page?(\"/groups/#{task.group.id}/task_board\") %&gt;\n  &lt;a href=\"/tasks/&lt;%=task.id%&gt;/undone?idz='2'\" data-method=\"patch\" data-remote=\"true\" class=\"task_done_btn\"&gt;undone&lt;/a&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Step 2</strong> (transfert the idz defined in the first step into a local variable)</p>\n\n<p><em>controllers/tasks_controller.rb</em> </p>\n\n<pre><code>def undone\n  respond_to do |format|\n    @idz = idz\n    format.html { redirect_back}\n    format.js \n  end\nend \n</code></pre>\n\n<p><strong>Step 3</strong> (use the idz as a condition to run my jquery)</p>\n\n<p><em>tasks/undone.js.erb</em></p>\n\n<pre><code>&lt;%- if @idz == 1 %&gt;\n  // jquery 1\n&lt;% elsif @idz == 2 %&gt;\n  // jquery 2\n&lt;% end %&gt;\n</code></pre>\n\n<p>But this method is'nt working (--). Do you know how I can solve that ? I think the problem append into the step2, when I want to attribute the number of my params(idz) into a local variable </p>\n"}, {"tags": ["ruby", "math", "imagemagick", "rmagick"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 8496955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130af836e960f2242a04e7fa5cbef5a8?s=128&d=identicon&r=PG&f=1", "display_name": "lumos", "link": "https://stackoverflow.com/users/8496955/lumos"}, "edited": false, "score": 0, "creation_date": 1508869823, "post_id": 46916138, "comment_id": 80782569, "body": "wow thank you so much! This is absolutely perfect. A dumb math question though: what is the logic behind taking the square root of that first ratio? Just trying to make sure I get the concept there."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 131, "user_id": 8496955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130af836e960f2242a04e7fa5cbef5a8?s=128&d=identicon&r=PG&f=1", "display_name": "lumos", "link": "https://stackoverflow.com/users/8496955/lumos"}, "edited": false, "score": 0, "creation_date": 1508870022, "post_id": 46916138, "comment_id": 80782673, "body": "Both <code>col</code> and <code>row</code> should be normalized by <code>ratio</code>, what gives <code>ratio</code> in the denominator <i>squared</i>. Hence the retrieve it the square root is required. It\u2019s a basic arithmetic proportion."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1508864431, "creation_date": 1508864431, "answer_id": 46916138, "question_id": 46915587, "link": "https://stackoverflow.com/questions/46915587/resizing-image-with-rmagick-imagemagick-to-be-less-than-a-specified-product-of-i/46916138#46916138", "title": "resizing image with rmagick/imagemagick to be less than a specified product of its width and height", "body": "<p>You need to properly calculate the <code>ratio</code>, which is a square root from your desired dimension divided by (<code>row</code> multiplied by <code>col</code>):</p>\n\n<pre><code>row, col = [2793, 1970]\nratio = Math.sqrt(4_000_000.0 / (row *\u00a0col))\n[row, col].map &amp;ratio.method(:*)\n#\u21d2 [\n#  [0] 2381.400006266842,\n#  [1] 1679.6842149465374\n#]\n[row, col].map(&amp;ratio.method(:*)).reduce(:*)\n#\u221e 3999999.9999999995\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 8496955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130af836e960f2242a04e7fa5cbef5a8?s=128&d=identicon&r=PG&f=1", "display_name": "lumos", "link": "https://stackoverflow.com/users/8496955/lumos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 46916138, "answer_count": 1, "score": 0, "last_activity_date": 1508864431, "creation_date": 1508862475, "last_edit_date": 1508862872, "question_id": 46915587, "link": "https://stackoverflow.com/questions/46915587/resizing-image-with-rmagick-imagemagick-to-be-less-than-a-specified-product-of-i", "title": "resizing image with rmagick/imagemagick to be less than a specified product of its width and height", "body": "<p>I'm running a script that resizes images that are too large. I've used \"resize_to_fit\" to reduce images to a specific pixel size depending on the longer side, but I'm wondering if it's possible to do it with this logic instead: for any image whose <em>width x height</em> product is greater than a set value, resize the image so that the new width and height values are as large as possible while still being under that value. In other words, I don't want to arbitrarily resize the dimensions more than necessary, and I'd want to retain aspect ratio in this conversion. This may be more of a math question than a ruby one, but in any case, this is what I've tried: </p>\n\n<pre><code>image = Magick::Image.read(image_file)[0];\ndimensions = image.columns, image.rows\nresolution = dimensions[0] * dimensions[1]\nif resolution &gt; 4000000\n   resolution_ratio = 4000000 / resolution.to_f\n   dimension_ratio = dimensions[0].to_f * resolution_ratio\n   img = img.resize_to_fit(dimension_ratio,dimension_ratio)\n   img.write(\"#{image}\")\nend\n</code></pre>\n\n<p>So let's say an image has a width of 2793px and a height of 1970px. The resolution would be 5,502,210. It thus goes through the conditional statement, and as of right now, outputs a new width of 2030 and height of 1432. The product of these two is 2,906,960\u2014which is obviously well under 4,000,000. But there are other possible <em>width x height</em> combinations whose product could be much closer to 4,000,000 pixels than 2,906,960 is. Is there a way of determining that information, and then resizing it accordingly? </p>\n"}, {"tags": ["sql-server", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "edited": false, "score": 0, "creation_date": 1508864219, "post_id": 46915551, "comment_id": 80779401, "body": "have you tried to write this image to a file?"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 1, "creation_date": 1508870603, "post_id": 46915551, "comment_id": 80782987, "body": "Slight detour...the image datatype has been deprecated in favor of varbinary(max) for over a decade now. Probably time to stop using it."}], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1508864076, "last_edit_date": 1508864076, "creation_date": 1508863753, "answer_id": 46915960, "question_id": 46915551, "link": "https://stackoverflow.com/questions/46915551/how-do-i-convert-binary-field-to-text-in-ruby/46915960#46915960", "title": "How do I convert binary field to text in Ruby?", "body": "<pre><code>s = \"54004800490053002000490053002000410020004c00490047004800540041005200540020004f0052004400450052002e00200020004c004900470048005400410052005400200049005300200044004f0049004e004700200054004800450020004600410042002e000d000a004c00490047004800540041005200540020005300480049005000500049004e004700200054004f00200043005500530054004f004d004500520020003c0038002d00320033002d00310037003e000d000a000d000a0043006f006e006e00690065002c00200070006c00650061007300650020007000720069006e007400200073007400690063006b00650072007300200066006f0072002000650061006300680020006f007500740065007200200062006f00780020007400680061007400200069006e0063006c0075006400650073002000740068006500200069006e0066006f003a000d000a0028003100290020006f00660020002800310029000d000a004c004100320020005400680072006500650020004c00610072006700650020000d000a00380036005c0022004c0020007800200036005c002200570020007800200038005c00220048000d000a004e00610074007500720061006c000d000a005000320030003900380031003000350020004d004f0044002000500069007a007a00610020005300750067006100720068006f007500730065002c00200055005400\"\n</code></pre>\n\n<p><strong>Code</strong>:</p>\n\n<pre><code>puts s.scan(/.{2}(?=0{2})/).map{|s| s.to_i(16)}.pack(\"c*\")\n</code></pre>\n\n<p><strong>Output</strong>:</p>\n\n<pre><code>THISISALIGHTARTORDER.LIGHTARTISDOINGTHEFAB.\nLIGHTARTSHIINGTOCUSTOMER&lt;8-23-17&gt;\n\nConnie,leaserintstickersforeachouterboxthatincludestheinfo:\n(1)of(1)\nLA2ThreeLarge\n86\\\"Lx6\\\"Wx8\\\"H\nNatural\n29815MODizzaSugarhouse,UT\n</code></pre>\n\n<p>Note: Some characters are unprintable, so they do not appear in this page. See the edit page of this answer for detail.</p>\n\n<p>Or, if you replace <code>\"\\x02\"</code> with a space,</p>\n\n<pre><code>puts s.scan(/.{2}(?=0{2})/).map{|s| s.to_i(16)}.pack(\"c*\").tr(\"\\x02\", \" \")\n</code></pre>\n\n<p>you get:</p>\n\n<pre><code>THIS IS A LIGHTART ORDER.  LIGHTART IS DOING THE FAB.\nLIGHTART SHIING TO CUSTOMER &lt;8-23-17&gt;\n\nConnie, lease rint stickers for each outer box that includes the info:\n(1) of (1)\nLA2 Three Large \n86\\\"L x 6\\\"W x 8\\\"H\nNatural\n29815 MOD izza Sugarhouse, UT\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 903, "user_id": 196230, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/P2KGd.png?s=128&g=1", "display_name": "Jason Shultz", "link": "https://stackoverflow.com/users/196230/jason-shultz"}, "edited": false, "score": 0, "creation_date": 1508869524, "post_id": 46915964, "comment_id": 80782401, "body": "I noticed that if i just type the variable in irb then it shows the hidden characters, but if i &quot;put&quot; the variable on the screen then it doesn&#39;t."}, {"owner": {"reputation": 903, "user_id": 196230, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/P2KGd.png?s=128&g=1", "display_name": "Jason Shultz", "link": "https://stackoverflow.com/users/196230/jason-shultz"}, "edited": false, "score": 0, "creation_date": 1508869577, "post_id": 46915964, "comment_id": 80782431, "body": "However, if I return the variable from my rails backend to the angular2 frontend those characters remain. :/ How can I remove them from being sent via the backend?"}], "tags": [], "owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "is_accepted": false, "score": 0, "last_activity_date": 1508864067, "last_edit_date": 1508864067, "creation_date": 1508863766, "answer_id": 46915964, "question_id": 46915551, "link": "https://stackoverflow.com/questions/46915551/how-do-i-convert-binary-field-to-text-in-ruby/46915964#46915964", "title": "How do I convert binary field to text in Ruby?", "body": "<p>That happens when you're inspecting the data, but when you write it will be fine: </p>\n\n<p>Example: </p>\n\n<pre><code>$ ruby -e 'bin = File.read(\"/bin/ls\");p bin; File.open(\"/tmp/file\",\"w+\"){|f| f.write bin}'\n\"\\u007FELF\\u0002\\u0001\\u0001\\u0000\\u0000\\u0000 ...\n....\n$ md5sum /bin/ls\n84b7b042405dfc79f2afe9b12d6b931d  /bin/ls\n$ md5sum /tmp/file\n84b7b042405dfc79f2afe9b12d6b931d  /tmp/file\n</code></pre>\n\n<p>So here we read a binary file <code>/bin/ls</code> and wrote it to another file <code>/tmp/file</code> as you can the the checksums are the identical.  </p>\n"}, {"tags": [], "owner": {"reputation": 903, "user_id": 196230, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/P2KGd.png?s=128&g=1", "display_name": "Jason Shultz", "link": "https://stackoverflow.com/users/196230/jason-shultz"}, "is_accepted": true, "score": 0, "last_activity_date": 1508871417, "creation_date": 1508871417, "answer_id": 46918066, "question_id": 46915551, "link": "https://stackoverflow.com/questions/46915551/how-do-i-convert-binary-field-to-text-in-ruby/46918066#46918066", "title": "How do I convert binary field to text in Ruby?", "body": "<p>I finally figured this out. I needed to do <code>string.gsub(\"\\u0000\", '')</code></p>\n\n<p>So, I was getting the data from the MSSQL database correctly it seemed, but I that null byte was really throwing things off and was being sent to the front end where it was appearing on the page. i swear i tried gsubing before but for whatever reason it wasn't working. I tried it again now before when the response is being formed and it is now being sent correctly. </p>\n"}], "owner": {"reputation": 903, "user_id": 196230, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/P2KGd.png?s=128&g=1", "display_name": "Jason Shultz", "link": "https://stackoverflow.com/users/196230/jason-shultz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 46918066, "answer_count": 3, "score": 0, "last_activity_date": 1508871417, "creation_date": 1508862352, "last_edit_date": 1508865694, "question_id": 46915551, "link": "https://stackoverflow.com/questions/46915551/how-do-i-convert-binary-field-to-text-in-ruby", "title": "How do I convert binary field to text in Ruby?", "body": "<p>I have a MSSQL table with a field of type <code>image</code> that has some text stored in it.</p>\n\n<p>The field has data that looks like this: </p>\n\n<p><code>54004800490053002000490053002000410020004c00490047004800540041005200540020004f0052004400450052002e00200020004c004900470048005400410052005400200049005300200044004f0049004e004700200054004800450020004600410042002e000d000a004c00490047004800540041005200540020005300480049005000500049004e004700200054004f00200043005500530054004f004d004500520020003c0038002d00320033002d00310037003e000d000a000d000a0043006f006e006e00690065002c00200070006c00650061007300650020007000720069006e007400200073007400690063006b00650072007300200066006f0072002000650061006300680020006f007500740065007200200062006f00780020007400680061007400200069006e0063006c0075006400650073002000740068006500200069006e0066006f003a000d000a0028003100290020006f00660020002800310029000d000a004c004100320020005400680072006500650020004c00610072006700650020000d000a00380036005c0022004c0020007800200036005c002200570020007800200038005c00220048000d000a004e00610074007500720061006c000d000a005000320030003900380031003000350020004d004f0044002000500069007a007a00610020005300750067006100720068006f007500730065002c00200055005400</code></p>\n\n<p>In PHP I can write a SQL query to convert that data like this: <code>SELECT CAST(CAST(CUST_ORDER_BINARY.BITS as VARBINARY(8000)) as VARCHAR(8000)) as result FROM CUST_ORDER_BINARY WHERE CUST_ORDER_ID = 'CO-299403S';</code></p>\n\n<p>When I try the same thing in Ruby I get a result like this:</p>\n\n<p><code>specs = VisualCustomer.connection.exec_query(sql).first</code></p>\n\n<p><code>{\"result\"=&gt;\"T\\u0000H\\u0000I\\u0000S\\u0000 \\u0000I\\u0000S\\u0000 \\u0000A\\u0000 \\u0000L\\u0000I\\u0000G\\u0000H\\u0000T\\u0000A\\u0000R\\u0000T\\u0000 \\u0000O\\u0000R\\u0000D\\u0000E\\u0000R\\u0000.\\u0000 \\u0000 \\u0000L\\u0000I\\u0000G\\u0000H\\u0000T\\u0000A\\u0000R\\u0000T\\u0000 \\u0000I\\u0000S\\u0000 \\u0000D\\u0000O\\u0000I\\u0000N\\u0000G\\u0000 \\u0000T\\u0000H\\u0000E\\u0000 \\u0000F\\u0000A\\u0000B\\u0000.\\u0000\\r\\u0000\\n\\u0000L\\u0000I\\u0000G\\u0000H\\u0000T\\u0000A\\u0000R\\u0000T\\u0000 \\u0000S\\u0000H\\u0000I\\u0000P\\u0000P\\u0000I\\u0000N\\u0000G\\u0000 \\u0000T\\u0000O\\u0000 \\u0000C\\u0000U\\u0000S\\u0000T\\u0000O\\u0000M\\u0000E\\u0000R\\u0000 \\u0000&lt;\\u00008\\u0000-\\u00002\\u00003\\u0000-\\u00001\\u00007\\u0000&gt;\\u0000\\r\\u0000\\n\\u0000\\r\\u0000\\n\\u0000C\\u0000o\\u0000n\\u0000n\\u0000i\\u0000e\\u0000,\\u0000 \\u0000p\\u0000l\\u0000e\\u0000a\\u0000s\\u0000e\\u0000 \\u0000p\\u0000r\\u0000i\\u0000n\\u0000t\\u0000 \\u0000s\\u0000t\\u0000i\\u0000c\\u0000k\\u0000e\\u0000r\\u0000s\\u0000 \\u0000f\\u0000o\\u0000r\\u0000 \\u0000e\\u0000a\\u0000c\\u0000h\\u0000 \\u0000o\\u0000u\\u0000t\\u0000e\\u0000r\\u0000 \\u0000b\\u0000o\\u0000x\\u0000 \\u0000t\\u0000h\\u0000a\\u0000t\\u0000 \\u0000i\\u0000n\\u0000c\\u0000l\\u0000u\\u0000d\\u0000e\\u0000s\\u0000 \\u0000t\\u0000h\\u0000e\\u0000 \\u0000i\\u0000n\\u0000f\\u0000o\\u0000:\\u0000\\r\\u0000\\n\\u0000(\\u00001\\u0000)\\u0000 \\u0000o\\u0000f\\u0000 \\u0000(\\u00001\\u0000)\\u0000\\r\\u0000\\n\\u0000L\\u0000A\\u00002\\u0000 \\u0000T\\u0000h\\u0000r\\u0000e\\u0000e\\u0000 \\u0000L\\u0000a\\u0000r\\u0000g\\u0000e\\u0000 \\u0000\\r\\u0000\\n\\u00008\\u00006\\u0000\\\\\\u0000\\\"\\u0000L\\u0000 \\u0000x\\u0000 \\u00006\\u0000\\\\\\u0000\\\"\\u0000W\\u0000 \\u0000x\\u0000 \\u00008\\u0000\\\\\\u0000\\\"\\u0000H\\u0000\\r\\u0000\\n\\u0000N\\u0000a\\u0000t\\u0000u\\u0000r\\u0000a\\u0000l\\u0000\\r\\u0000\\n\\u0000P\\u00002\\u00000\\u00009\\u00008\\u00001\\u00000\\u00005\\u0000 \\u0000M\\u0000O\\u0000D\\u0000 \\u0000P\\u0000i\\u0000z\\u0000z\\u0000a\\u0000 \\u0000S\\u0000u\\u0000g\\u0000a\\u0000r\\u0000h\\u0000o\\u0000u\\u0000s\\u0000e\\u0000,\\u0000 \\u0000U\\u0000T\\u0000\"}</code></p>\n\n<p>So the data is \"almost\" there. :)</p>\n\n<p>I've tried gsubing to remove the <code>\\u0000</code> from the result but that's not working, obviously. </p>\n\n<p>** EDIT 1 **</p>\n\n<p>So, for some reason, getting the data from MSSQL into ruby is causing some kind of partial translation. I never get the raw data from the field, instead I get the \"semi-translated\" data. Even if I just query it, it still comes out like </p>\n\n<p><code>\"T\\x00H\\x00I\\x00S\\x00 \\x00I\\x00S\\x00 \\x00A\\x00...</code> </p>\n\n<p>I tried to put it back doing:</p>\n\n<p><code>s = order_specs.each_byte.map { |b| b.to_s(16) }.join</code></p>\n\n<p>Then, when I do: </p>\n\n<p><code>order_specs = s.scan(/.{2}(?=0{2})/).map{|s| s.to_i(16)}.pack(\"c*\").tr(\"\\x02\", \" \")</code></p>\n\n<p>I just get an empty string. :/</p>\n"}, {"tags": ["ruby", "chef-infra", "dsl", "chef-recipe"], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 863389, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/68b9fa9f319c2e42bcc7fd568f8bed5f?s=128&d=identicon&r=PG&f=1", "display_name": "eramm", "link": "https://stackoverflow.com/users/863389/eramm"}, "edited": false, "score": 0, "creation_date": 1508863804, "post_id": 46915439, "comment_id": 80779147, "body": "and a variable set in a ruby block will be preserved/available in the next install block ?"}, {"owner": {"reputation": 161, "user_id": 863389, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/68b9fa9f319c2e42bcc7fd568f8bed5f?s=128&d=identicon&r=PG&f=1", "display_name": "eramm", "link": "https://stackoverflow.com/users/863389/eramm"}, "edited": false, "score": 0, "creation_date": 1508924227, "post_id": 46915439, "comment_id": 80804586, "body": "I wasn&#39;t able to find any documentation on nested blocks but you were correct in identifying the root cause."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1146504, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e85fb6a6f6200c7c148a236a241df02f?s=128&d=identicon&r=PG", "display_name": "Jakir00", "link": "https://stackoverflow.com/users/1146504/jakir00"}, "is_accepted": false, "score": 3, "last_activity_date": 1508861985, "creation_date": 1508861985, "answer_id": 46915439, "question_id": 46914926, "link": "https://stackoverflow.com/questions/46914926/chef-run-install-block-based-on-variable-condition/46915439#46915439", "title": "Chef - run install block based on variable condition", "body": "<p>Chef has an order of precidance that controls the flow of execution.</p>\n\n<p>Code inside resource blocks (e.g. 'yum_package') will execute AFTER any loose code in your recipe.</p>\n\n<p>The following lines are being executed FIRST, before your 'yum_package' blocks:</p>\n\n<pre><code>mycond = ::File.directory?('/opt/MyPkg/conf')\nChef::Log.fatal(\"MyPkg package not installed ? conf dir is missing\") unless mycond\n</code></pre>\n\n<p>I believe you can nest resource blocks. You cold be able to combind all this code in a 'ruby_block' and it should execute in order as you'd expect.</p>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 863389, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/68b9fa9f319c2e42bcc7fd568f8bed5f?s=128&d=identicon&r=PG&f=1", "display_name": "eramm", "link": "https://stackoverflow.com/users/863389/eramm"}, "edited": false, "score": 0, "creation_date": 1508871778, "post_id": 46916273, "comment_id": 80783640, "body": "How can i get it to write to the local log as well?"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 161, "user_id": 863389, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/68b9fa9f319c2e42bcc7fd568f8bed5f?s=128&d=identicon&r=PG&f=1", "display_name": "eramm", "link": "https://stackoverflow.com/users/863389/eramm"}, "edited": false, "score": 0, "creation_date": 1508874043, "post_id": 46916273, "comment_id": 80784847, "body": "I would probably use a log resource for that."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 4, "last_activity_date": 1508864949, "creation_date": 1508864949, "answer_id": 46916273, "question_id": 46914926, "link": "https://stackoverflow.com/questions/46914926/chef-run-install-block-based-on-variable-condition/46916273#46916273", "title": "Chef - run install block based on variable condition", "body": "<p>The problem is Chef's two-pass model. See <a href=\"https://coderanger.net/two-pass/\" rel=\"nofollow noreferrer\">https://coderanger.net/two-pass/</a> for the full explanation for for this you just need to move the condition check in to the <code>only_if</code> block itself since that is delayed until converge time: <code>only_if { ::File.directory?('/opt/MyPkg/conf') }</code>.</p>\n\n<p>Using the <code>fatal</code> log level is also probably not a good idea as this isn't actually a fatal error as written.</p>\n"}], "owner": {"reputation": 161, "user_id": 863389, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/68b9fa9f319c2e42bcc7fd568f8bed5f?s=128&d=identicon&r=PG&f=1", "display_name": "eramm", "link": "https://stackoverflow.com/users/863389/eramm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 46916273, "answer_count": 2, "score": 1, "last_activity_date": 1508864949, "creation_date": 1508860281, "question_id": 46914926, "link": "https://stackoverflow.com/questions/46914926/chef-run-install-block-based-on-variable-condition", "title": "Chef - run install block based on variable condition", "body": "<p>Background: our systems are setup in a way that I will only be able to see the local chef log and will have no access to the Chef server console or any other sysadmin privileges. Hence I have a need to log locally if I want to see if or why something failed.</p>\n\n<p>I can hear you asking \" If you don't trust the pkg or Chef to install it correctly, then...\" My answer is that while you are correct, I still want to be covered by the occasional anomaly.</p>\n\n<p>My goal is to install a pkg, check to see that it installed correctly than go on to the next pkg.</p>\n\n<p>On to the question:</p>\n\n<p>I would like to set a variable that checks for the existence of a directory that was created by the first package using the following code:</p>\n\n<pre><code>   mycond = ::File.directory?('/opt/MyPkg/conf')\n    Chef::Log.fatal(\"MyPkg package not installed ? conf dir is missing\") unless mycond\n</code></pre>\n\n<p>the next stage in the recipee is to run the next install block checking to see if the variable has been set.</p>\n\n<pre><code>yum_package 'OtherPkg' do\n  action :install\n  only_if { mycond }\nend\n</code></pre>\n\n<p>My question is since the <code>only_if</code> is failing, I was wondering if there was something wrong with the way I am setting the <code>mycond</code> variable ? perhapes {} braces are needed somewhere in the code ?</p>\n\n<p>Total Chef newbie so please be specific with your answer.</p>\n\n<p>Thanks !</p>\n\n<p>Full code below:</p>\n\n<pre><code>yum_package 'MyPkg' do\n      flush_cache [ :before ]\n      action :install\n    end\n\n    mycond = ::File.directory?('/opt/MyPkg/conf')\n    Chef::Log.fatal(\"MyPkg package not installed ? conf dir is missing\") unless mycond\n\n    yum_package 'OtherPkg' do\n      action :install\n      only_if { mycond }\n    end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "railstutorial.org"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 7631261, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/34c3f5c01682697bbf4c010f477c47f1?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7631261/owen"}, "edited": false, "score": 0, "creation_date": 1508860269, "post_id": 46914629, "comment_id": 80776930, "body": "sorry, yes now edited to include sessions controller, but i still dont understand what is wrong with that line"}, {"owner": {"reputation": 83, "user_id": 7026739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dsWxI.jpg?s=128&g=1", "display_name": "LazyNick7", "link": "https://stackoverflow.com/users/7026739/lazynick7"}, "reply_to_user": {"reputation": 321, "user_id": 7631261, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/34c3f5c01682697bbf4c010f477c47f1?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7631261/owen"}, "edited": false, "score": 0, "creation_date": 1508860959, "post_id": 46914629, "comment_id": 80777487, "body": "@Owen check each file that is specified in the trace, until you find an error. Next line is: test/test_helper.rb:32:in `log_in_as&#39;"}, {"owner": {"reputation": 321, "user_id": 7631261, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/34c3f5c01682697bbf4c010f477c47f1?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7631261/owen"}, "edited": false, "score": 0, "creation_date": 1508882694, "post_id": 46914629, "comment_id": 80789034, "body": "that&#39;s my problem i dont see any errors. all the code is copied from the book."}], "tags": [], "owner": {"reputation": 83, "user_id": 7026739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dsWxI.jpg?s=128&g=1", "display_name": "LazyNick7", "link": "https://stackoverflow.com/users/7026739/lazynick7"}, "is_accepted": false, "score": 0, "last_activity_date": 1508859396, "creation_date": 1508859396, "answer_id": 46914629, "question_id": 46914228, "link": "https://stackoverflow.com/questions/46914228/michael-hartls-tutorial-chapter-10-2-2-listing-10-26-tests-failing/46914629#46914629", "title": "Michael Hartl&#39;s tutorial Chapter 10.2.2, listing 10.26 tests failing", "body": "<p>look more attentively at line: </p>\n\n<pre><code>BCrypt::Errors::InvalidHash: invalid hash\n            app/controllers/sessions_controller.rb:9:in `create'\n</code></pre>\n\n<p>You did not specify the code for this controller, and I can not tell you what might be wrong.</p>\n"}, {"tags": [], "owner": {"reputation": 40, "user_id": 5776807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/236f2becadf41c3aa8d4c5f4f9cc2493?s=128&d=identicon&r=PG", "display_name": "mose", "link": "https://stackoverflow.com/users/5776807/mose"}, "is_accepted": true, "score": 1, "last_activity_date": 1509035702, "creation_date": 1509035702, "answer_id": 46959501, "question_id": 46914228, "link": "https://stackoverflow.com/questions/46914228/michael-hartls-tutorial-chapter-10-2-2-listing-10-26-tests-failing/46959501#46959501", "title": "Michael Hartl&#39;s tutorial Chapter 10.2.2, listing 10.26 tests failing", "body": "<p>You're missing a closing angle bracket in the <code>password_digest</code> for the \"Sterling Archer\" test fixture.</p>\n\n<pre><code>password_digest: &lt;%= User.digest('password') %\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>password_digest: &lt;%= User.digest('password') %&gt;\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 7631261, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/34c3f5c01682697bbf4c010f477c47f1?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7631261/owen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 46959501, "answer_count": 2, "score": 0, "last_activity_date": 1509035702, "creation_date": 1508858309, "last_edit_date": 1508860221, "question_id": 46914228, "link": "https://stackoverflow.com/questions/46914228/michael-hartls-tutorial-chapter-10-2-2-listing-10-26-tests-failing", "title": "Michael Hartl&#39;s tutorial Chapter 10.2.2, listing 10.26 tests failing", "body": "<p>Going through Hartl's tutorial and have searched for an answer, but found none. (There may be answers existing but becuase the chapters have been updated and switched around in the newer editions I can't find them if they exist.)</p>\n\n<p>I am at section 10.2.2. listing 10.26 doing the rails test.</p>\n\n<p>here is the error for my tests:</p>\n\n<pre><code>ERROR[\"test_should_redirect_edit_when_logged_in_as_wrong_user\", UsersControllerTest, 1.5802158990409225]\n test_should_redirect_edit_when_logged_in_as_wrong_user#UsersControllerTest (1.58s)\nBCrypt::Errors::InvalidHash:         BCrypt::Errors::InvalidHash: invalid hash\n            app/controllers/sessions_controller.rb:9:in `create'\n            test/test_helper.rb:32:in `log_in_as'\n            test/controllers/users_controller_test.rb:29:in `block in &lt;class:UsersControllerTest&gt;'\n\nERROR[\"test_should_redirect_update_when_logged_in_as_wrong_user\", UsersControllerTest, 1.606778411893174]\n test_should_redirect_update_when_logged_in_as_wrong_user#UsersControllerTest (1.61s)\nBCrypt::Errors::InvalidHash:         BCrypt::Errors::InvalidHash: invalid hash\n            app/controllers/sessions_controller.rb:9:in `create'\n            test/test_helper.rb:32:in `log_in_as'\n            test/controllers/users_controller_test.rb:36:in `block in &lt;class:UsersControllerTest&gt;'\n\n  35/35: [=====================================================] 100% Time: 00:00:01, Time: 00:00:01\n\nFinished in 1.71823s\n35 tests, 87 assertions, 0 failures, 2 errors, 0 skips\n</code></pre>\n\n<p>test/fixtures/users.yml</p>\n\n<pre><code>michael:\n  name: Michael Example\n  email: michael@example.com\n  password_digest: &lt;%= User.digest('password') %&gt;\n\narcher:\n  name: Sterling Archer\n  email: duchess@example.gov\n  password_digest: &lt;%= User.digest('password') %\n</code></pre>\n\n<p>test/controllers/users_controller_test.rb</p>\n\n<pre><code>require 'test_helper'\n\nclass UsersControllerTest &lt; ActionDispatch::IntegrationTest\n\n  def setup\n    @user = users(:michael)\n    @other_user = users(:archer)\n  end\n\n  test \"should get new\" do\n    get signup_path\n    assert_response :success\n  end\n\n test \"should redirect edit when not logged in\" do\n    get edit_user_path(@user)\n    assert_not flash.empty?\n    assert_redirected_to login_url\n  end\n\n  test \"should redirect update when not logged in\" do\n    patch user_path(@user), params: { user: { name: @user.name,\n                                              email: @user.email } }\n    assert_not flash.empty?\n    assert_redirected_to login_url\n  end\n\n   test \"should redirect edit when logged in as wrong user\" do\n    log_in_as(@other_user)\n    get edit_user_path(@user)\n    assert flash.empty?\n    assert_redirected_to root_url\n  end\n\n  test \"should redirect update when logged in as wrong user\" do\n    log_in_as(@other_user)\n    patch user_path(@user), params: { user: { name: @user.name,\n                                              email: @user.email } }\n    assert flash.empty?\n    assert_redirected_to root_url\n  end\n\nend\n</code></pre>\n\n<p>app/controllers/users_controller.rb</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n    before_action :logged_in_user, only: [:edit, :update]\n    before_action :correct_user,   only: [:edit, :update]\n\n  def show\n    @user = User.find(params[:id])\n\n  end\n\n  def new\n    @user = User.new\n  end\n\n  def create\n    @user = User.new(user_params)\n  #  @user = User.new(params[:user])    # Not the final implementation!\n    if @user.save\n      log_in @user\n      flash[:success] = \"Welcome to the Sample App!\"\n      redirect_to @user\n      # Handle a successful save.\n    else\n      render 'new'\n    end\n  end\n\n  def edit\n    # can take out because already in correct_user     @user = User.find(params[:id])\n  end\n\n  def update\n    # can take out because already in correct_user @user = User.find(params[:id])\n    if @user.update_attributes(user_params)\n      # Handle a successful update.\n      flash[:success] = \"Profile updated\"\n      redirect_to @user\n\n    else\n      render 'edit'\n    end\n  end\n\n  private\n\n    def user_params\n      params.require(:user).permit(:name, :email, :password,\n                                   :password_confirmation)\n    end\n\n    # Before filters\n\n    # Confirms a logged-in user.\n    def logged_in_user\n      unless logged_in?\n        flash[:danger] = \"Please log in.\"\n        redirect_to login_url\n      end\n    end\n\n        # Confirms the correct user.\n    def correct_user\n      @user = User.find(params[:id])\n      redirect_to(root_url) unless @user == current_user\n    end\n\nend\n</code></pre>\n\n<p>Why am I getting 2 failed tests when the book says that all tests should pass? I have looked at the lines the error message mentions ,but I am not sure what is wrong.\nThanks for the help.</p>\n\n<p>EDIT: Sessions controller</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n  def new\n  end\n\n  def create\n\n    @user = User.find_by(email: params[:session][:email].downcase)\n\n    if @user &amp;&amp; @user.authenticate(params[:session][:password])\n    log_in @user\n    params[:session][:remember_me] == '1' ? remember(@user) : forget(@user) \n    redirect_to @user\n\n    else\n    flash.now[:danger] = 'Invalid email/password combination' # Not quite right!\n    render 'new'\n    end\n  end\n\n  def destroy\n    log_out if logged_in?\n    redirect_to root_url\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "regex", "rubular"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508858616, "post_id": 46914029, "comment_id": 80775780, "body": "I don&#39;t understand the question. What do you mean by &quot;match a number with a regex&quot;? -- You can&#39;t. You could either just <i>check if it&#39;s a number</i>, or convert it to a string first. What does <code>&#47;^#{column}$&#47;i</code> mean? (What is <code>column</code>?)"}, {"owner": {"reputation": 123, "user_id": 7351450, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/55599da0718129c5a87e69d9937a203d?s=128&d=identicon&r=PG&f=1", "display_name": "brandoncodes", "link": "https://stackoverflow.com/users/7351450/brandoncodes"}, "edited": false, "score": 0, "creation_date": 1508858942, "post_id": 46914029, "comment_id": 80776012, "body": "Sorry, I forgot to include that it is a Mongo query. So in my database I could have a value of 20000 which is a number, or I could have <code>&quot;20000&quot;</code> and my regex would need to capture both of these values."}], "owner": {"reputation": 123, "user_id": 7351450, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/55599da0718129c5a87e69d9937a203d?s=128&d=identicon&r=PG&f=1", "display_name": "brandoncodes", "link": "https://stackoverflow.com/users/7351450/brandoncodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "closed_date": 1508859066, "answer_count": 0, "score": 0, "last_activity_date": 1508858741, "creation_date": 1508857677, "last_edit_date": 1508858741, "question_id": 46914029, "link": "https://stackoverflow.com/questions/46914029/how-to-use-regex-to-match-for-number-and-string", "closed_reason": "Duplicate", "title": "How to use regex to match for number and string?", "body": "<p>My variable column could either be a string or a number/float. I need to use my regex to catch both <code>20000</code> and <code>\"20000\"</code>. Right now my regex is <code>/^#{column}$/i</code> which only catches the string <code>\"20000\"</code>. In addition to this, I need it to stay case insensitive which it currently is. </p>\n\n<p>I am using Mongoid to query a mongo database. The whole query is </p>\n\n<pre><code>Mongoid.client(\"default\")[\"table_name\"].find({ field: /^#{row[column]}$/i })\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 356, "user_id": 7781865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a015f597dcb8d01d4deae23070c6991f?s=128&d=identicon&r=PG", "display_name": "colincr", "link": "https://stackoverflow.com/users/7781865/colincr"}, "edited": false, "score": 0, "creation_date": 1508858186, "post_id": 46913995, "comment_id": 80775504, "body": "does your browser js console return any errors?"}], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 8818948, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5992e6d07f86d46cb4530bb96935f095?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8818948/john"}, "edited": false, "score": 0, "creation_date": 1508889865, "post_id": 46920005, "comment_id": 80791005, "body": "I added turbolinks and throws me an error of Uncaught TypeError: calendar.fullCalender is not a function"}, {"owner": {"reputation": 1325, "user_id": 3295284, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdP8.jpg?s=128&g=1", "display_name": "patkoperwas", "link": "https://stackoverflow.com/users/3295284/patkoperwas"}, "reply_to_user": {"reputation": 205, "user_id": 8818948, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5992e6d07f86d46cb4530bb96935f095?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8818948/john"}, "edited": false, "score": 0, "creation_date": 1508950578, "post_id": 46920005, "comment_id": 80823221, "body": "You have a typo. Calendar has an <code>a</code> instead of an <code>e</code>. Should be <code>calendar.fullCalendar({})</code>"}], "tags": [], "owner": {"reputation": 1325, "user_id": 3295284, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdP8.jpg?s=128&g=1", "display_name": "patkoperwas", "link": "https://stackoverflow.com/users/3295284/patkoperwas"}, "is_accepted": true, "score": 0, "last_activity_date": 1508950763, "last_edit_date": 1508950763, "creation_date": 1508879157, "answer_id": 46920005, "question_id": 46913995, "link": "https://stackoverflow.com/questions/46913995/fullcalendar-gem-rails-wont-display/46920005#46920005", "title": "Fullcalendar Gem Rails Wont Display", "body": "<p>Looks like you are missing</p>\n\n<pre><code>//= require turbolinks\n</code></pre>\n\n<p>In your <code>application.js</code>. Without it the <code>'turbolinks:load'</code> won't fire.</p>\n\n<p>If you plan on using Turbolinks you will also need to destroy your fullCalendar objects before navigation, as <a href=\"https://github.com/bokmann/fullcalendar-rails#usage-together-with-turbolinks-version-5\" rel=\"nofollow noreferrer\">mentioned here</a>.</p>\n\n<pre><code>function eventCalendar() {\n  return $('#event_calendar').fullCalendar({ ***your FullCalendar config***});\n};\n\nfunction clearCalendar() {\n  $('#event_calendar').fullCalendar('delete'); // In case delete doesn't work.\n  $('#event_calendar').html('');\n};\n\n$(document).on('turbolinks:load', eventCalendar);\n$(document).on('turbolinks:before-cache', clearCalendar)\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 8818948, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5992e6d07f86d46cb4530bb96935f095?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8818948/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 46920005, "answer_count": 1, "score": 1, "last_activity_date": 1508950763, "creation_date": 1508857604, "question_id": 46913995, "link": "https://stackoverflow.com/questions/46913995/fullcalendar-gem-rails-wont-display", "title": "Fullcalendar Gem Rails Wont Display", "body": "<p>FullCalendar appears blank how can i display the calendar. It seems that there are few guides or documentation for the fullcalendar on rails. I can't seem to pinpoint what's wrong. There are no errors just displays a blank page. </p>\n\n<p>View</p>\n\n<pre><code>&lt;div class=\"calendar\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>Channel/full_calendar.js</p>\n\n<pre><code>var initialize_calendar;\ninitialize_calendar = function() {\n    $('.calendar').each(function(){\n        var calendar = $(this);\n        calendar.fullCalender({});\n    })\n};\n$(document).on('turbolinks:load', initialize_calendar);\n</code></pre>\n\n<p>Application.js </p>\n\n<pre><code>//= require jquery\n//= require rails-ujs\n//= require bootstrap\n//= require moment\n//= require fullcalendar\n//= require jquery-dcjqaccordion\n//= require_tree .\n</code></pre>\n\n<p>Application.css.scss</p>\n\n<pre><code> *= require fullcalendar\n *= require daterangepicker\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "raty"], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 5231216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4953a314078d82b90514afb2ab86d5c0?s=128&d=identicon&r=PG&f=1", "display_name": "Diiru", "link": "https://stackoverflow.com/users/5231216/diiru"}, "is_accepted": false, "score": 1, "last_activity_date": 1508856228, "creation_date": 1508856228, "answer_id": 46913538, "question_id": 46913537, "link": "https://stackoverflow.com/questions/46913537/rails-gem-ratyrate-showings-stars-only-after-refresh-and-not-saving/46913538#46913538", "title": "Rails gem Ratyrate showings stars only after refresh and not saving", "body": "<p>Fixed this issue with:</p>\n\n<blockquote>\n  <ol>\n  <li><p>Specifying version in each Rating Migration (currently using ActiveRecord::Migration[5.1])</p></li>\n  <li><p>Changing Rate Controller \"create\" method, replacing \"if user_signed_in?\" with \"if current_user\"</p></li>\n  <li><p>Adding \"post '/rate' => 'rater#create', :as => 'rate'\" to routes.rb (gem should do this for you)</p></li>\n  <li><p>Adding \n  &lt;%= javascript_include_tag 'ratyrate.js', \"data-turbolinks-track\": false %> at the bottom of show.html.erb (the view of the model you want to rate)</p></li>\n  </ol>\n</blockquote>\n\n<p>Hope this helps !</p>\n"}], "owner": {"reputation": 97, "user_id": 5231216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4953a314078d82b90514afb2ab86d5c0?s=128&d=identicon&r=PG&f=1", "display_name": "Diiru", "link": "https://stackoverflow.com/users/5231216/diiru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1508856228, "creation_date": 1508856228, "question_id": 46913537, "link": "https://stackoverflow.com/questions/46913537/rails-gem-ratyrate-showings-stars-only-after-refresh-and-not-saving", "title": "Rails gem Ratyrate showings stars only after refresh and not saving", "body": "<p>(Saw many posts with these problems and got it working, so I will upload solution)</p>\n\n<p>I'm using <a href=\"https://github.com/wazery/ratyrate\" rel=\"nofollow noreferrer\">Ratyrate</a> without Devise and the stars only appear after a web refresh and they do not save the previously assigned rate.</p>\n"}, {"tags": ["ruby", "ubuntu", "bundle", "shopify"], "answers": [{"comments": [{"owner": {"reputation": 635, "user_id": 3897206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RimSC.jpg?s=128&g=1", "display_name": "rvargas", "link": "https://stackoverflow.com/users/3897206/rvargas"}, "edited": false, "score": 0, "creation_date": 1531266917, "post_id": 46914751, "comment_id": 89528760, "body": "&quot;but it is required for them to install pg gem properly&quot; why?"}], "tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": true, "score": 5, "last_activity_date": 1508859765, "creation_date": 1508859765, "answer_id": 46914751, "question_id": 46913424, "link": "https://stackoverflow.com/questions/46913424/an-error-occurred-while-installing-pg-0-21-0-and-bundler-cannot-continue/46914751#46914751", "title": "An error occurred while installing pg (0.21.0), and Bundler cannot continue", "body": "<p>I believe the reason of your problem is here</p>\n\n<pre><code>libpq-dev : Depends: libssl-dev but it is not going to be installed\n</code></pre>\n\n<p>You should solve it to install <code>libssl-dev</code>, it is not related to ruby/pg, but it is required for them to install pg gem properly.</p>\n"}, {"comments": [{"owner": {"reputation": 821, "user_id": 5965865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TNJ20.png?s=128&g=1", "display_name": "YCode", "link": "https://stackoverflow.com/users/5965865/ycode"}, "edited": false, "score": 0, "creation_date": 1533563258, "post_id": 48052062, "comment_id": 90379354, "body": "Of all the questions and tips I&#39;ve found, yours seems most pertinent to my situation. I get the error &quot;can&#39;t find the &#39;libpq-fe.h header&quot; with one particular rails app, but not another rails app. Question is: Do I have to use Postgrsql if I have mysql already installed?"}], "tags": [], "owner": {"reputation": 186, "user_id": 1545052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8165b41cae99fc056a74011ebe4badf?s=128&d=identicon&r=PG", "display_name": "snorris", "link": "https://stackoverflow.com/users/1545052/snorris"}, "is_accepted": false, "score": 0, "last_activity_date": 1514830300, "creation_date": 1514830300, "answer_id": 48052062, "question_id": 46913424, "link": "https://stackoverflow.com/questions/46913424/an-error-occurred-while-installing-pg-0-21-0-and-bundler-cannot-continue/48052062#48052062", "title": "An error occurred while installing pg (0.21.0), and Bundler cannot continue", "body": "<p>I just ran into this running the \"rails new\" command on my Mac (Rails 5, High-Sierra) with the <code>--database=postgresql</code> option turned on. This is kind of a restating of things mentioned in earlier answers, but I think it might be helpful.  The issue is because I've installed Postgres as an app in my Applications folder and when the \"rails new\" command runs it can't find the includes it needs to install the pg gem.  All I had to do is let the system know where they are.  So I executed this in the Terminal:</p>\n\n<pre><code>export CONFIGURE_ARGS=\u201cwith-pg-include=Applications/Postgres.app/Contents/Versions/latest/include/\u201c\n</code></pre>\n\n<p>Then I could run with out issue:</p>\n\n<pre><code>rails new MyAppName --database=postgresql \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2606, "user_id": 6320917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28342c08ee057cf8e481197a22372158?s=128&d=identicon&r=PG", "display_name": "Unkas", "link": "https://stackoverflow.com/users/6320917/unkas"}, "is_accepted": false, "score": 0, "last_activity_date": 1527453672, "creation_date": 1527453672, "answer_id": 50556325, "question_id": 46913424, "link": "https://stackoverflow.com/questions/46913424/an-error-occurred-while-installing-pg-0-21-0-and-bundler-cannot-continue/50556325#50556325", "title": "An error occurred while installing pg (0.21.0), and Bundler cannot continue", "body": "<p>Probably, you forgot to install ruby-dev packages.\nIt solved probled for me.</p>\n\n<pre><code>sudo apt-get install ruby-dev\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1036, "user_id": 11655094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FDZH9.jpg?s=128&g=1", "display_name": "Saeid Amini", "link": "https://stackoverflow.com/users/11655094/saeid-amini"}, "edited": false, "score": 0, "creation_date": 1568273540, "post_id": 57901412, "comment_id": 102223871, "body": "When your answer is too short, it&#39;s better to send as a comment."}], "tags": [], "owner": {"reputation": 67, "user_id": 3999793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd735eaea5f82043c3c4c124839566a?s=128&d=identicon&r=PG&f=1", "display_name": "Faizan Khan", "link": "https://stackoverflow.com/users/3999793/faizan-khan"}, "is_accepted": false, "score": 4, "last_activity_date": 1568272026, "creation_date": 1568272026, "answer_id": 57901412, "question_id": 46913424, "link": "https://stackoverflow.com/questions/46913424/an-error-occurred-while-installing-pg-0-21-0-and-bundler-cannot-continue/57901412#57901412", "title": "An error occurred while installing pg (0.21.0), and Bundler cannot continue", "body": "<p>I think you dont have postgres insatlled.</p>\n\n<pre><code>  Try: brew install postgres\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "is_accepted": false, "score": 8, "last_activity_date": 1589876402, "creation_date": 1589876402, "answer_id": 61886385, "question_id": 46913424, "link": "https://stackoverflow.com/questions/46913424/an-error-occurred-while-installing-pg-0-21-0-and-bundler-cannot-continue/61886385#61886385", "title": "An error occurred while installing pg (0.21.0), and Bundler cannot continue", "body": "<p>Actually this worked for me </p>\n\n<pre><code>sudo apt-get install libpq-dev ruby-dev\n</code></pre>\n\n<p>It required me to install two packages <code>libpq-dev</code> and <code>ruby-dev</code></p>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 5634603, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153705028107521/picture?type=large", "display_name": "Vasanth Saminathan", "link": "https://stackoverflow.com/users/5634603/vasanth-saminathan"}, "is_accepted": false, "score": 2, "last_activity_date": 1594028788, "creation_date": 1594028788, "answer_id": 62753399, "question_id": 46913424, "link": "https://stackoverflow.com/questions/46913424/an-error-occurred-while-installing-pg-0-21-0-and-bundler-cannot-continue/62753399#62753399", "title": "An error occurred while installing pg (0.21.0), and Bundler cannot continue", "body": "<p>Try installing postgres:</p>\n<blockquote>\n<p>brew install postgresql</p>\n</blockquote>\n"}], "owner": {"reputation": 186, "user_id": 8747498, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d9142e4eba926547c833a5264ba00c54?s=128&d=identicon&r=PG&f=1", "display_name": "Gyntonic", "link": "https://stackoverflow.com/users/8747498/gyntonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10810, "favorite_count": 1, "accepted_answer_id": 46914751, "answer_count": 6, "score": 7, "last_activity_date": 1594028788, "creation_date": 1508855898, "question_id": 46913424, "link": "https://stackoverflow.com/questions/46913424/an-error-occurred-while-installing-pg-0-21-0-and-bundler-cannot-continue", "title": "An error occurred while installing pg (0.21.0), and Bundler cannot continue", "body": "<p>I am trying to follow <a href=\"https://github.com/Shopify/shopify_app/blob/master/docs/Quickstart.md\" rel=\"noreferrer\">this tutorial about Shopify Apps</a>.\nFirst I try:</p>\n\n<blockquote>\n  <p>bundle install</p>\n</blockquote>\n\n<p><strong>But it gives me this error</strong></p>\n\n<pre><code>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    current directory: /tmp/bundler20171024-12759-18v2l7apg-0.21.0/gems/pg-0.21.0/ext\n/usr/bin/ruby2.3 -r ./siteconf20171024-12759-2yizk4.rb extconf.rb\nchecking for pg_config... yes\nUsing config values from /usr/bin/pg_config\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for\nbuilding a client-side application.\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for\nbuilding a client-side application.\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/bin/$(RUBY_BASE_NAME)2.3\n    --with-pg\n    --without-pg\n    --enable-windows-cross\n    --disable-windows-cross\n    --with-pg-config\n    --without-pg-config\n    --with-pg_config\n    --without-pg_config\n    --with-pg-dir\n    --without-pg-dir\n    --with-pg-include\n    --without-pg-include=${pg-dir}/include\n    --with-pg-lib\n    --without-pg-lib=${pg-dir}/lib\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /tmp/bundler20171024-12759-18v2l7apg-0.21.0/extensions/x86_64-linux/2.3.0/pg-0.21.0/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /tmp/bundler20171024-12759-18v2l7apg-0.21.0/gems/pg-0.21.0 for\ninspection.\nResults logged to\n/tmp/bundler20171024-12759-18v2l7apg-0.21.0/extensions/x86_64-linux/2.3.0/pg-0.21.0/gem_make.out\n\nAn error occurred while installing pg (0.21.0), and Bundler cannot continue.\nMake sure that `gem install pg -v '0.21.0'` succeeds before bundling.\n\nIn Gemfile:\n  pg\n</code></pre>\n\n<p>But if I try: </p>\n\n<blockquote>\n  <p>gem install pg -v '0.21.0'</p>\n</blockquote>\n\n<p><strong>It also gives me error:</strong></p>\n\n<pre><code>Building native extensions.  This could take a while...\nERROR:  Error installing pg:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /var/lib/gems/2.3.0/gems/pg-0.21.0/ext\n/usr/bin/ruby2.3 -r ./siteconf20171024-12993-1t8i3d6.rb extconf.rb\nchecking for pg_config... yes\nUsing config values from /usr/bin/pg_config\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/bin/$(RUBY_BASE_NAME)2.3\n    --with-pg\n    --without-pg\n    --enable-windows-cross\n    --disable-windows-cross\n    --with-pg-config\n    --without-pg-config\n    --with-pg_config\n    --without-pg_config\n    --with-pg-dir\n    --without-pg-dir\n    --with-pg-include\n    --without-pg-include=${pg-dir}/include\n    --with-pg-lib\n    --without-pg-lib=${pg-dir}/lib\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /var/lib/gems/2.3.0/extensions/x86_64-linux/2.3.0/pg-0.21.0/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /var/lib/gems/2.3.0/gems/pg-0.21.0 for inspection.\nResults logged to /var/lib/gems/2.3.0/extensions/x86_64-linux/2.3.0/pg-0.21.0/gem_make.out\n</code></pre>\n\n<p>I have read that </p>\n\n<blockquote>\n  <p>sudo apt-get install libpq-dev</p>\n</blockquote>\n\n<p><strong>Should work, but, yes... error:</strong></p>\n\n<pre><code>Building dependency tree       \nReading state information... Done\nSome packages could not be installed. This may mean that you have\nrequested an impossible situation or if you are using the unstable\ndistribution that some required packages have not yet been created\nor been moved out of Incoming.\nThe following information may help to resolve the situation:\n\nThe following packages have unmet dependencies:\n libpq-dev : Depends: libssl-dev but it is not going to be installed\nE: Unable to correct problems, you have held broken packages.\n</code></pre>\n\n<p><strong>I am working on Ubuntu 16.04 LTS. (This is the gemfile:)</strong></p>\n\n<pre><code>source 'https://rubygems.org'\n\ngit_source(:github) do |repo_name|\n  repo_name = \"#{repo_name}/#{repo_name}\" unless repo_name.include?(\"/\")\n  \"https://github.com/#{repo_name}.git\"\nend\n\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.1.4'\n# Use postgresql as the database for Active Record\ngem 'pg', '~&gt; 0.18'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.7'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.2'\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 3.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '~&gt; 2.13'\n  gem 'selenium-webdriver'\nend\n\ngroup :development do\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\ngem 'shopify_app', '~&gt; 7.0.0'\n</code></pre>\n\n<p>What should I do? Thank you.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 399, "user_id": 1998931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bc6bbd9b85f9ed97574bc4b834ab2f?s=128&d=identicon&r=PG", "display_name": "Carlos Roque", "link": "https://stackoverflow.com/users/1998931/carlos-roque"}, "edited": false, "score": 0, "creation_date": 1508959881, "post_id": 46913397, "comment_id": 80828506, "body": "I think p and puts call to_s automatically. if you want your output to look like an array override the to_s method in your class. additionally still need to implement enumerable on your data at some point so why not just inherit from array?"}, {"owner": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "reply_to_user": {"reputation": 399, "user_id": 1998931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bc6bbd9b85f9ed97574bc4b834ab2f?s=128&d=identicon&r=PG", "display_name": "Carlos Roque", "link": "https://stackoverflow.com/users/1998931/carlos-roque"}, "edited": false, "score": 0, "creation_date": 1508960385, "post_id": 46913397, "comment_id": 80828761, "body": "Thanks, but I should overwrite <a href=\"https://ruby-doc.org/core-2.4.2/Object.html#method-i-inspect\" rel=\"nofollow noreferrer\"><code>inspect</code></a> as can be seen <a href=\"https://ruby-doc.org/core-2.4.2/Kernel.html#method-i-p\" rel=\"nofollow noreferrer\">here</a>, in really."}], "answers": [{"comments": [{"owner": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "edited": false, "score": 0, "creation_date": 1508861471, "post_id": 46914763, "comment_id": 80777840, "body": "Thanks. I like how the <code>ActiveRecord</code> gem works. More specifically the <code>Relation</code> class, it returns an object with the format <code>[..., ..., ...]</code>, but it doesn&#39;t inherits from <code>Array</code>."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1509094577, "post_id": 46914763, "comment_id": 80889566, "body": "See: <a href=\"https://stackoverflow.com/questions/7220634/how-do-i-use-the-enumerable-mixin-in-my-class\" title=\"how do i use the enumerable mixin in my class\">stackoverflow.com/questions/7220634/&hellip;</a>"}], "tags": [], "owner": {"reputation": 447, "user_id": 3816367, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4ncI.jpg?s=128&g=1", "display_name": "cmramseyer", "link": "https://stackoverflow.com/users/3816367/cmramseyer"}, "is_accepted": false, "score": 1, "last_activity_date": 1508859811, "creation_date": 1508859811, "answer_id": 46914763, "question_id": 46913397, "link": "https://stackoverflow.com/questions/46913397/how-to-make-a-class-behave-like-an-array-without-inherits-from-array/46914763#46914763", "title": "How to make a class behave like an array without inherits from Array", "body": "<p>With <code>class LikeArray &lt; Array; end</code> you can achieve the behaviour you are looking for. What are you trying to do?</p>\n"}], "owner": {"reputation": 965, "user_id": 2730593, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/da029ed3c584066f45baed0e6793200b?s=128&d=identicon&r=PG", "display_name": "rplaurindo", "link": "https://stackoverflow.com/users/2730593/rplaurindo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1508861124, "answer_count": 1, "score": -3, "last_activity_date": 1508869395, "creation_date": 1508855844, "last_edit_date": 1508869395, "question_id": 46913397, "link": "https://stackoverflow.com/questions/46913397/how-to-make-a-class-behave-like-an-array-without-inherits-from-array", "closed_reason": "Needs details or clarity", "title": "How to make a class behave like an array without inherits from Array", "body": "<p>Below there is a code that works:</p>\n\n<pre><code>class LikeAnArray &lt; Array\n\nend\n</code></pre>\n\n<p>If I run:</p>\n\n<pre><code>$ p object = LikeAnArray.new\n</code></pre>\n\n<p>It returns:</p>\n\n<pre><code>$ #=&gt; []\n</code></pre>\n\n<p>If I run:</p>\n\n<pre><code>$ p object.class\n</code></pre>\n\n<p>It returns:</p>\n\n<pre><code>$ #=&gt; LikeAnArray\n</code></pre>\n\n<p>How can I achieve this functionality without making my class be a sub class of <code>Array</code>?</p>\n"}, {"tags": ["ruby", "selenium", "testing", "automated-tests", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8319484, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212669840198795/picture?type=large", "display_name": "Ezgi Nacar", "link": "https://stackoverflow.com/users/8319484/ezgi-nacar"}, "edited": false, "score": 0, "creation_date": 1509085819, "post_id": 46914355, "comment_id": 80884883, "body": "Thank you for the clue. When I tried to use this element with send_keys, the system shows me focus error. Or when i use another ways to fill that field, my entries are missing. I&#39;m going crazy!"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 23, "user_id": 8319484, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212669840198795/picture?type=large", "display_name": "Ezgi Nacar", "link": "https://stackoverflow.com/users/8319484/ezgi-nacar"}, "edited": false, "score": 0, "creation_date": 1509086317, "post_id": 46914355, "comment_id": 80885092, "body": "@EzgiNacar I would recommend opening a new question where you provide the HTML you&#39;re trying to interact with, what library you&#39;re using for the tags widget (if you&#39;re using a library), exactly what a user has to do on the page, the code you&#39;ve tried to replicate the user, and the exact complete errors that code returns."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1508858616, "creation_date": 1508858616, "answer_id": 46914355, "question_id": 46912668, "link": "https://stackoverflow.com/questions/46912668/no-method-error-for-capybara/46914355#46914355", "title": "No method error for Capybara", "body": "<p>There is no method <code>native_send_keys</code> in Capybara. The code you copied from was probably calling <code>element.native.send_keys(...)</code> but you shouldn't be calling that either.  Just call <code>send_keys</code>on the desired element - <a href=\"http://www.rubydoc.info/gems/capybara/Capybara/Node/Element#send_keys-instance_method\" rel=\"nofollow noreferrer\">http://www.rubydoc.info/gems/capybara/Capybara/Node/Element#send_keys-instance_method</a> .  In your case that would be</p>\n\n<pre><code>find('.x-tagfield-body').send_keys(:enter)\n</code></pre>\n\n<p>Whether or not that will actually work for the control you're trying to interact with is impossible to say given the info provided, but it will fix the \"no method error\" this question is about.</p>\n"}], "owner": {"reputation": 23, "user_id": 8319484, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212669840198795/picture?type=large", "display_name": "Ezgi Nacar", "link": "https://stackoverflow.com/users/8319484/ezgi-nacar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 46914355, "answer_count": 1, "score": 0, "last_activity_date": 1508858616, "creation_date": 1508853994, "last_edit_date": 1508854667, "question_id": 46912668, "link": "https://stackoverflow.com/questions/46912668/no-method-error-for-capybara", "title": "No method error for Capybara", "body": "<p>I want to add a tag to a tag field. To fill the tag field, I have to add <code>','</code>, or hit enter with a tag name, for example, <code>\"Ezgi,\"</code>. I wrote these steps for it.</p>\n\n<pre><code>When(/^I enter \"([^\"]*)\" on Label field$/) do |arg1|\n    within('.x-anchor-form-item', :text=&gt;'Label') do\n        find('.x-tagfield-body').click\n        fill_in('', :with=&gt;arg1)\n    end\n    if page.has_css?('ul', :text=&gt;arg1) then\n        within('ul',:text=&gt;arg1) do \n            find('li', :text=&gt;arg1).click\n        end \n    else\n        within('.x-anchor-form-item', :text=&gt;'Label') do\n            find('.x-tagfield-body').native_send_keys(:enter)\n        end\n        within('.x-window-resizable', match: :first) do \n            find_all('a', :text=&gt;'Save')[1].click\n        end\n        within('.x-anchor-form-item', :text=&gt;'Label') do\n            find('.x-form-text-wrap.x-form-text-wrap-default').click\n            fill_in('', :with=&gt;arg1)\n        end\n        within('ul',:text=&gt;arg1) do \n            find('li', :text=&gt;arg1).click\n        end \n    end\nend\n</code></pre>\n\n<p>I tried to write so many classes to fill the field, but that didn't work. For the 11th step, I viewed a message like this:</p>\n\n<pre><code>undefined method `native_send_keys' for #&lt;Capybara::Node::Element:0x00000005119270&gt; (NoMethodError)\n</code></pre>\n\n<p>Does anyone have any idea for this case? Can someone help me?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 0, "last_activity_date": 1508855484, "creation_date": 1508855484, "answer_id": 46913267, "question_id": 46912223, "link": "https://stackoverflow.com/questions/46912223/rails-ajax-forms-flash-messages/46913267#46913267", "title": "Rails ajax forms + flash messages", "body": "<p><a href=\"https://stackoverflow.com/questions/366311/how-do-you-handle-rails-flash-with-ajax-requests/10167659#10167659\">How do you handle Rail&#39;s flash with Ajax requests?</a></p>\n\n<p>and the gist:</p>\n\n<p><a href=\"https://gist.github.com/linjunpop/3410235\" rel=\"nofollow noreferrer\">https://gist.github.com/linjunpop/3410235</a></p>\n"}], "owner": {"reputation": 85, "user_id": 2000944, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/1800477/picture?type=large", "display_name": "Arash Hadipanah", "link": "https://stackoverflow.com/users/2000944/arash-hadipanah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 46913267, "answer_count": 1, "score": -1, "last_activity_date": 1508855484, "creation_date": 1508852790, "question_id": 46912223, "link": "https://stackoverflow.com/questions/46912223/rails-ajax-forms-flash-messages", "title": "Rails ajax forms + flash messages", "body": "<p>Are there any good tutorials or gems that handle Rails Flash messages via Ajax? </p>\n\n<p>In my .js.erb files, I've used something like the following: </p>\n\n<pre><code>&lt;% if @event.errors.any? %&gt;\n  &lt;% @event.errors.keys.each do |key| %&gt;\n  $( \"#event_&lt;%= j key.to_s %&gt;\" ).addClass(\"errorField\");\n  &lt;% end %&gt;\n  $(\"#flashMSG\").css(\"display\", \"block\");\n  if(!$(\".flashError\").length){\n    $(\"&lt;div class='flashError'&gt;\").html(\"Sorry, please fill in required fields.\").appendTo(\".noticeContainer\");\n  }\n&lt;% else %&gt;\n  $(document).bind(\"ajax:success\", function(e, data, status, xhr) {\n    $(\"#flashMSG\").slideUp(400).delay(400).slideDown();\n    if(!$(\".flashSuccess\").length){\n      $(\"&lt;div class='flashSuccess'&gt;\").html(\"Event Updated.\").appendTo(\".noticeContainer\");\n    }\n  });\n&lt;% end %&gt;\n</code></pre>\n\n<p>Just wondering if there's a better way to do this or automate it similar to how Rails just handles it with a standard form submission.</p>\n"}, {"tags": ["ruby", "rspec", "minitest"], "answers": [{"tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": false, "score": 0, "last_activity_date": 1508860017, "creation_date": 1508860017, "answer_id": 46914843, "question_id": 46912171, "link": "https://stackoverflow.com/questions/46912171/minitests-equivalent-to-rspecs-receive/46914843#46914843", "title": "Minitest&#39;s equivalent to RSpec&#39;s receive", "body": "<p>It looks like this question was already answered here: <a href=\"https://stackoverflow.com/questions/10869417/how-to-assert-certain-method-is-called-with-ruby-minitest-framework\">How to assert certain method is called with Ruby minitest framework?</a></p>\n\n<p>In short - you should use mocks for checking is the method was called.</p>\n"}], "owner": {"reputation": 15926, "user_id": 474597, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cf5fcf12effe4798f02aa84def25c684?s=128&d=identicon&r=PG", "display_name": "lulalala", "link": "https://stackoverflow.com/users/474597/lulalala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508860017, "creation_date": 1508852669, "question_id": 46912171, "link": "https://stackoverflow.com/questions/46912171/minitests-equivalent-to-rspecs-receive", "title": "Minitest&#39;s equivalent to RSpec&#39;s receive", "body": "<p>In Rspec one can do</p>\n\n<pre><code>expect(foo).to receive(:bark)\n</code></pre>\n\n<p>What's the equivalent in MiniTest?</p>\n\n<p>(<code>assert_send</code> seems to not have a different behavior)</p>\n"}, {"tags": ["arrays", "ruby", "enumerator"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1508852013, "post_id": 46911838, "comment_id": 80770823, "body": "Just call <code>.to_a</code> on <code>buyer_ids</code>"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1508852014, "creation_date": 1508852014, "answer_id": 46911937, "question_id": 46911838, "link": "https://stackoverflow.com/questions/46911838/how-to-split-array-of-hashes/46911937#46911937", "title": "How to split array of hashes", "body": "<p>It's correct. Just add a <code>to_a</code> or call a method on the resulting collection to verify that</p>\n\n<pre><code>buyer_ids.slice_after { |obj| obj[\"tid\"] != nil }.to_a\nbuyer_ids.slice_after { |obj| obj[\"tid\"] != nil }.each { |item| puts item }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8791735, "user_type": "registered", "profile_image": "https://graph.facebook.com/1635606293158107/picture?type=large", "display_name": "LennyFrost", "link": "https://stackoverflow.com/users/8791735/lennyfrost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1508852776, "creation_date": 1508851742, "last_edit_date": 1508852776, "question_id": 46911838, "link": "https://stackoverflow.com/questions/46911838/how-to-split-array-of-hashes", "title": "How to split array of hashes", "body": "<p>I am trying to split an array of hashes. All hashes have the same keys. The expected result would be something that looks like this: </p>\n\n<pre><code>1 = [{\"tid\" =&gt; nil}, {\"tid\" =&gt; nil}, {\"tid\" =&gt; true}]\n2 = [{\"tid\" =&gt; nil}, {\"tid\" =&gt; true}]\n3 = [{\"tid\" =&gt; nil}, {\"tid\" =&gt; nil}, {\"tid\" =&gt; nil}, {\"tid\" =&gt; true}]\n</code></pre>\n\n<p>I'm trying to get this code working:</p>\n\n<pre><code>buyer_ids = specific_buyer.slice_after{ |obj| obj[\"tid\"] != nil}\n# =&gt; #&lt;Enumerator: #&lt;Enumerator::Generator:0x007ffe9ea2f5b8&gt;:each&gt;\n</code></pre>\n\n<p>I have no clue what the result means.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-engines"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1508851850, "post_id": 46911810, "comment_id": 80770698, "body": "Maybe it all depends on what &quot;Rails 4 code&quot; means. If you are using depreciated methods then warnings abound if you are using methods that were completely removed then yes it would need to be refactored. If you are using primarily pure ruby with basic rails syntax then it may survive for versions to come. All very dependent on your existing code base. In all cases you should try to make a homogeneous version if possible so as to avoid any current or future issues."}, {"owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1508851951, "post_id": 46911810, "comment_id": 80770771, "body": "@engineersmnky got it. So just to double check, all the code in the engine would most definitely need to be compatible with all code within the app the engine is mounted on if I want them to be able to work together?"}, {"owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1508851992, "post_id": 46911810, "comment_id": 80770801, "body": "Also, sorry in this sense, Rails 4 code, meaning a Rails 4 app."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1508852136, "post_id": 46911810, "comment_id": 80770926, "body": "Yes otherwise you will run into dependency issues as things like <code>rails</code> would become ambiguous. That is why it is always best to (and you see pretty much every rails library) release version based engines for compatibility with each rails version. Refactor now means smaller refactoring when rails 5 becomes 6 or 7. IF you have ever tried to migrate an old app up more than 1 version you will understand the pain. Usually this is a uncomfortable stepping process e.g Rails 3 to rails 5 usually involves migrating to rails 4 patch and update and then migrate to rails 5 patch and update."}, {"owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1508852347, "post_id": 46911810, "comment_id": 80771091, "body": "Thanks @engineersmnky, if you want to add an answer, I\u2019ll accept it!"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508856023, "post_id": 46911810, "comment_id": 80773883, "body": "The differences between 4 &amp; 5 are a lot smaller than between 3 &amp; 4 though."}], "owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508851975, "creation_date": 1508851645, "last_edit_date": 1508851975, "question_id": 46911810, "link": "https://stackoverflow.com/questions/46911810/rails-engine-integration-questions", "title": "Rails Engine Integration Questions", "body": "<p>If I'm wanting to mount a particular Rails Engine within an application, does all code within that engine have to be compatible with the app on which the engine is being mounted?</p>\n\n<p>For instance, if I have a Rails 5 app, and have an engine which uses Rails 4 code/Is a Rails 4 app, that engine would have to also be using Rails 5 or have compatible classes right?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "debugging", "byebug"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508848785, "post_id": 46910753, "comment_id": 80768257, "body": "What would that code do? Where should it stop? When loading <code>User</code> class? When doing <code>User.find</code>? When doing <code>problematic_method</code>? if the latter, how byebug would know to not stop at earlier steps? :)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1508849045, "post_id": 46910753, "comment_id": 80768439, "body": "If you want to debug <code>problematic_method</code>, you could call <code>byebug</code> from within that method."}, {"owner": {"reputation": 508, "user_id": 552391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b9cfd9892a765221fe557768987b42d?s=128&d=identicon&r=PG", "display_name": "Matias", "link": "https://stackoverflow.com/users/552391/matias"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1508851326, "post_id": 46910753, "comment_id": 80770268, "body": "@SergioTulentsev yes, I also thought that, but maybe starting the session before any call and let me step into. But this could be a nightmare too."}], "answers": [{"tags": [], "owner": {"reputation": 1618, "user_id": 299781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d380305288301a38f4bac69132e19d?s=128&d=identicon&r=PG", "display_name": "Holger Frohloff", "link": "https://stackoverflow.com/users/299781/holger-frohloff"}, "is_accepted": false, "score": 0, "last_activity_date": 1508849994, "creation_date": 1508849994, "answer_id": 46911280, "question_id": 46910753, "link": "https://stackoverflow.com/questions/46910753/starting-byebug-with-a-block/46911280#46911280", "title": "Starting Byebug with a block", "body": "<p>That is not possible. What you can do, is write your code inside a <code>.rb</code> file and debug that file/script using byebug.</p>\n"}, {"tags": [], "owner": {"reputation": 508, "user_id": 552391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b9cfd9892a765221fe557768987b42d?s=128&d=identicon&r=PG", "display_name": "Matias", "link": "https://stackoverflow.com/users/552391/matias"}, "is_accepted": false, "score": 1, "last_activity_date": 1508853570, "last_edit_date": 1508853570, "creation_date": 1508852341, "answer_id": 46912046, "question_id": 46910753, "link": "https://stackoverflow.com/questions/46910753/starting-byebug-with-a-block/46912046#46912046", "title": "Starting Byebug with a block", "body": "<p>I opened the class and override the <code>problematic_method</code> inside the Rails console and added the <code>byebug</code> statement where I wanted it. This way I don't have to change the running production code (I forgot to mention above I want to debug in production).</p>\n\n<p>This workaround will be enough for my purposes. The only problem is that you don't have the debug code listing available for that method, but its fine.</p>\n"}], "owner": {"reputation": 508, "user_id": 552391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b9cfd9892a765221fe557768987b42d?s=128&d=identicon&r=PG", "display_name": "Matias", "link": "https://stackoverflow.com/users/552391/matias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508853570, "creation_date": 1508848470, "last_edit_date": 1508853547, "question_id": 46910753, "link": "https://stackoverflow.com/questions/46910753/starting-byebug-with-a-block", "title": "Starting Byebug with a block", "body": "<p>I'm wondering if it's possible to start a Byebug session giving a starting point from a Rails console. I know I can insert a <code>byebug</code> statement wherever I want and start debugging, but I'd like to do something like this:</p>\n\n<pre><code>Byebug.start do\n  # entry point\n  User.find(12).problematic_method\nend\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby", "if-statement"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 5, "creation_date": 1508847195, "post_id": 46909903, "comment_id": 80767029, "body": "You can run the program via <code>ruby --dump=parsetree weird.rb</code> to see how the parser interprets your code."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1508847280, "post_id": 46909903, "comment_id": 80767090, "body": "@Stefan today I learned :)"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 19, "last_activity_date": 1508854272, "last_edit_date": 1508854272, "creation_date": 1508846170, "answer_id": 46909937, "question_id": 46909903, "link": "https://stackoverflow.com/questions/46909903/if-elsif-without-conditions-not-branching-correctly-in-ruby/46909937#46909937", "title": "if-elsif without conditions not branching correctly in Ruby", "body": "<blockquote>\n  <p>an if-elsif without conditions</p>\n</blockquote>\n\n<p>Here's where you're wrong. The <code>puts</code> <strong>are</strong> the conditions. There are no bodies in that snippet, only the conditions.</p>\n\n<p>Here's your code, properly formatted.</p>\n\n<pre><code>if puts \"A\"  \nelsif puts \"B\"  \nend  \n</code></pre>\n\n<blockquote>\n  <p>And why it executes both branches?</p>\n</blockquote>\n\n<p><code>puts</code> returns nil, a falsey value. That's why it tries both branches. If this code had an <code>else</code>, it'd be executed too.</p>\n"}, {"tags": [], "owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "is_accepted": false, "score": 2, "last_activity_date": 1508847148, "creation_date": 1508847148, "answer_id": 46910282, "question_id": 46909903, "link": "https://stackoverflow.com/questions/46909903/if-elsif-without-conditions-not-branching-correctly-in-ruby/46910282#46910282", "title": "if-elsif without conditions not branching correctly in Ruby", "body": "<p>In other words :</p>\n\n<pre><code>if # this is the condition :\n    puts \"A\" # an expression which prints A and returns nil\n# hence it's like \"if false\", try elsif ...\nthen\n    puts 'passes in then'\nelsif # this is another condition :\n    puts \"B\" # puts prints B and returns nil\nelse # no condition satisfied, passes in else :\n    puts 'in else'\nend\n</code></pre>\n\n<p>Execution :</p>\n\n<pre><code>$ ruby -w t.rb \nA\nB\nin else\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 6184124, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KpCRw.jpg?s=128&g=1", "display_name": "angarciaba", "link": "https://stackoverflow.com/users/6184124/angarciaba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 46909937, "answer_count": 2, "score": 4, "last_activity_date": 1508854275, "creation_date": 1508846043, "last_edit_date": 1508854275, "question_id": 46909903, "link": "https://stackoverflow.com/questions/46909903/if-elsif-without-conditions-not-branching-correctly-in-ruby", "title": "if-elsif without conditions not branching correctly in Ruby", "body": "<p>When I run the following code:</p>\n\n<pre><code>if  \n  puts \"A\"  \nelsif  \n  puts \"B\"  \nend  \n</code></pre>\n\n<p>I get the output:</p>\n\n<pre><code>A\nB\n</code></pre>\n\n<p>Why does it not warn or raise any errors? And why does it execute both branches?</p>\n"}, {"tags": ["ruby", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1508846132, "post_id": 46909896, "comment_id": 80766326, "body": "Ruby comes with <a href=\"http://ruby-doc.org/stdlib-2.4.2/libdoc/ripper/rdoc/Ripper.html\" rel=\"nofollow noreferrer\"><code>Ripper</code></a>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508850009, "post_id": 46909896, "comment_id": 80769250, "body": "@Stefan To my understanding, <code>Ripper</code> is not developed by the Ruby developers, so there is a slight chance that it would stop synchronizing with Ruby in the future when some change is made to the latter. I am concerned with that."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1508850134, "post_id": 46909896, "comment_id": 80769358, "body": "Ruby is obviously not a natural language."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1508852032, "post_id": 46909896, "comment_id": 80770843, "body": "@sawa since Ripper is bundled with Ruby, I would expect it to be updated accordingly."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508852608, "post_id": 46909896, "comment_id": 80771310, "body": "@Stefan You seem to be right."}, {"owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "edited": false, "score": 0, "creation_date": 1508928950, "post_id": 46909896, "comment_id": 80807771, "body": "Unfortunately that Corundum is listed as a Ruby grammar but has nothing to  do with Ruby. I was also looking for a Ruby grammar and have tested it : it is absolutely unable to parse the simplest line of Ruby code."}], "owner": {"reputation": 3, "user_id": 3970539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a614ccc1a01d26eaaafcfb43b68f31ac?s=128&d=identicon&r=PG&f=1", "display_name": "Jes&#250;s Gal&#225;n", "link": "https://stackoverflow.com/users/3970539/jes%c3%bas-gal%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508850442, "creation_date": 1508846030, "last_edit_date": 1508850442, "question_id": 46909896, "link": "https://stackoverflow.com/questions/46909896/analysis-of-ruby-code", "title": "Analysis of Ruby code", "body": "<p>I'm trying to perform Natural Language Processing (NLP) analysis on source code, and especially on Ruby files. In particular, I want to extract identifiers and comments, considering the structure of the code.</p>\n\n<p>My first attempt was using off-the-shelf NLP libraries, such as Lucene or spacy. However, I was not able to remove all the noise coming from keywords, literals, and the typical stuff in source code.</p>\n\n<p>My second attempt is about to obtain the AST of a particular piece of code, and then extract some parts. There are multiple tools and libraries for a number of languages, but I'm not able to find anything specific to parse Ruby code. So far, my main option is using ANTLR 4, and tailor a Ruby-like grammar (<a href=\"https://github.com/antlr/grammars-v4/tree/master/ruby\" rel=\"nofollow noreferrer\">Corundum</a>) to work also with OOP.</p>\n\n<p>Is there a more straightforward path to what I'm looking for?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508845787, "post_id": 46909505, "comment_id": 80766089, "body": "Using <code>&lt;&lt;-</code> instead of <code>&lt;&lt;</code> allows you to indent the ending identifier. Maybe you are looking for <code>&lt;&lt;~</code> which removes indentation from the heredoc&#39;s content."}, {"owner": {"reputation": 435, "user_id": 5998656, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/2Kj8J.jpg?s=128&g=1", "display_name": "Snowman08", "link": "https://stackoverflow.com/users/5998656/snowman08"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508846185, "post_id": 46909505, "comment_id": 80766368, "body": "Using &lt;&lt;~ I get  syntax errors.  @Stefan"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508846255, "post_id": 46909505, "comment_id": 80766417, "body": "Are you using an older version of Ruby?"}, {"owner": {"reputation": 435, "user_id": 5998656, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/2Kj8J.jpg?s=128&g=1", "display_name": "Snowman08", "link": "https://stackoverflow.com/users/5998656/snowman08"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508846328, "post_id": 46909505, "comment_id": 80766464, "body": "Yes 2.2.3 @Stefan"}, {"owner": {"reputation": 435, "user_id": 5998656, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/2Kj8J.jpg?s=128&g=1", "display_name": "Snowman08", "link": "https://stackoverflow.com/users/5998656/snowman08"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508846428, "post_id": 46909505, "comment_id": 80766528, "body": "Let me update my version, and ill try again."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1508846429, "post_id": 46909505, "comment_id": 80766530, "body": "That explains the syntax error, <code>&lt;&lt;~</code> was introduced in Ruby 2.3. You could strip the trailing whitespace yourself, e.g. <code>&lt;&lt;-MESSAGE_END.gsub(&#47;^\\s+&#47;, &#39;&#39;)</code> (that will remove all trailing whitespace, not just the first level of indentation)"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508847863, "post_id": 46910165, "comment_id": 80767512, "body": "<i>&quot;I tested&quot;</i> \u2013 really?"}, {"owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508848136, "post_id": 46910165, "comment_id": 80767728, "body": "@Stefan, yes for that example is working fine, but <code>&#47;^\\s+&#47;</code> could be replaced by <code>&#47;^ {n}&#47;</code> where n is the number of spaces, but not necessary for this example. didn&#39;t it work for you?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508848308, "post_id": 46910165, "comment_id": 80767888, "body": "Doesn&#39;t it remove the empty line after <code>Content-Disposition: inline</code>?"}, {"owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508848448, "post_id": 46910165, "comment_id": 80767996, "body": "It does,  but still display nicely on my email client."}, {"owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508848630, "post_id": 46910165, "comment_id": 80768144, "body": "<code>&#47;^ {6}&#47;</code> keeps the empty line, but it&#39;s weak since OP would have to remember to update the number every time indentation changes, @Stefan"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508848816, "post_id": 46910165, "comment_id": 80768272, "body": "You could replace <code>{6}</code> with something more general."}, {"owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508849930, "post_id": 46910165, "comment_id": 80769185, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/157375/discussion-between-tiago-and-stefan\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "is_accepted": true, "score": 2, "last_activity_date": 1508851244, "last_edit_date": 1508851244, "creation_date": 1508846783, "answer_id": 46910165, "question_id": 46909505, "link": "https://stackoverflow.com/questions/46909505/cant-get-ruby-net-smtp-to-send-html-code-via-email/46910165#46910165", "title": "Cant get ruby net/smtp to send html code via email", "body": "<p>This will solve your problem, I tested: </p>\n\n<pre><code>  message = &lt;&lt;-MESSAGE_END.gsub(/^\\s+/,'')\n  From: #{from}\n  To: #{to}\n  Subject: #{subject}\n  Mime-Version: 1.0\n  Content-Type: text/html\n  Content-Disposition: inline\n\n  &lt;b&gt;This is my simple HTML message&lt;/b&gt;&lt;br /&gt;&lt;br /&gt;\n  It goes on to tell of wonderful things you can do in ruby.\n  MESSAGE_END\n</code></pre>\n\n<p>The issue is with leading empty spaces, we get rid of them with: <code>MESSAGE_END.gsub(/^\\s+/,'')</code></p>\n\n<hr>\n\n<p><strong>EDIT:</strong> That worked well on my email client but as @stefan pointed out it strips empty lines. If you need those empty lines I have three options: </p>\n\n<ol>\n<li><code>MESSAGE_END.gsub(/^ {6}/,'')</code> # That works but you would have to update in case indentation changes.  </li>\n<li><code>MESSAGE_END.lines.map{|l| l.gsub(/^\\s+([^$])/,'\\1')}.join</code> # That works despite of indentation changes, but we kinda sacrifice readability. </li>\n<li><code>MESSAGE_END.gsub(/^[ ]+/,'')</code> # That was suggested by @stefan and probably reads better. </li>\n</ol>\n"}], "owner": {"reputation": 435, "user_id": 5998656, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/2Kj8J.jpg?s=128&g=1", "display_name": "Snowman08", "link": "https://stackoverflow.com/users/5998656/snowman08"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 46910165, "answer_count": 1, "score": 1, "last_activity_date": 1508851244, "creation_date": 1508844929, "last_edit_date": 1508845526, "question_id": 46909505, "link": "https://stackoverflow.com/questions/46909505/cant-get-ruby-net-smtp-to-send-html-code-via-email", "title": "Cant get ruby net/smtp to send html code via email", "body": "<p>I can't seem to figure out why my html isn't encoded when sending a email using net/smtp ruby. Any help would be greatly appreciated. </p>\n\n<p>Here is my class:</p>\n\n<pre><code>class CheckAccounts\n\n  def self.emailPwdExpire(email, name, days,  subject)\n    begin\n      server = 'x.x.x.x'\n      from    = \"NetworkAccountMgr\"\n      to      = \"someuser@mydomain.com\"\n      subject = \"Network Account Expiration Notice\"\n      message = &lt;&lt;-MESSAGE_END\n      From: #{from}\n      To: #{to}\n      Subject: #{subject}\n      Mime-Version: 1.0\n      Content-Type: text/html\n      Content-Disposition: inline\n\n      &lt;b&gt;This is my simple HTML message&lt;/b&gt;&lt;br /&gt;&lt;br /&gt;\n      It goes on to tell of wonderful things you can do in ruby.\n      MESSAGE_END\n\n      Net::SMTP.start(server, 25) do |s|\n        s.send_message message, from, 'someuser@mydomain.com'\n        s.finish\n      end\n    rescue [Net::SMTPFatalError, Net::SMTPSyntaxError]\n      puts \"BAD\"\n    end\n  end\n</code></pre>\n\n<p>Which gives me this email with no subject and the html is not encoded. </p>\n\n<pre><code> &lt;b&gt;This is my simple HTML message&lt;/b&gt;&lt;br /&gt;&lt;br /&gt;\n It goes on to tell of wonderful things you can do in ruby.\n</code></pre>\n\n<p>However when I try to not ignore white spaces using <code>&lt;&lt;MESSAGE_END</code> instead of <code>&lt;&lt;-MESSAGE_END</code> I get this :</p>\n\n<pre><code>ldap_callback.rb:148: can't find string \"MESSAGE_END\" anywhere before EOF\nldap_callback.rb:64: syntax error, unexpected end-of-input, expecting tSTRING_CONTENT or tSTRING_DBEG or tSTRING_DVAR or tSTRING_END\n      message = &lt;&lt;MESSAGE_END \n</code></pre>\n"}, {"tags": ["ruby", "utf-8"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1508843159, "post_id": 46908606, "comment_id": 80764304, "body": "Obligatory: is there a good reason why you&#39;re using ruby <code>1.9.3</code>? This version is <b>old</b>, and no longer supported."}, {"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508843580, "post_id": 46908606, "comment_id": 80764589, "body": "I am adding a fix to an Sinatra app and it&#39;s on 1.9.3"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508843927, "post_id": 46908606, "comment_id": 80764855, "body": "You might be able to convert the byte sequence 0xC3 0xA1 to <code>&#225;</code>, but converting <code>&#225;</code> to <code>&#224;</code> is a spell checking issue, not an encoding issue."}], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1508842901, "post_id": 46908706, "comment_id": 80764140, "body": "thanks but here is the error <code>Encoding::UndefinedConversionError: U+2019 from UTF-8 to ISO-8859-1 \tfrom (irb):162:in </code>encode&#39; \tfrom (irb):162`"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1508842976, "post_id": 46908706, "comment_id": 80764189, "body": "Note: (1) The encoding may actually be <code>Windows-1252</code>, not <code>iso-8859-1</code>? And (2) it <a href=\"http://www.i18nqa.com/debug/utf8-debug.html\" rel=\"nofollow noreferrer\">looks to me</a> like the correct character <b>is</b> actually &#225;, not &#224; (??)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1508843097, "post_id": 46908706, "comment_id": 80764271, "body": "@SumeetMasih is that error from a <i>longer</i> input string? If so, can you track down a simple reproduction? if not, does my alternate encoding suggestion work? A clue as to the correct encoding may come from the <i>original data source</i> -- what is it? MS Word?"}, {"owner": {"reputation": 136, "user_id": 2256635, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b467213a7be1d66412030828afb7f006?s=128&d=identicon&r=PG", "display_name": "tgezginis", "link": "https://stackoverflow.com/users/2256635/tgezginis"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1508843229, "post_id": 46908706, "comment_id": 80764348, "body": "@TomLord yes, you&#39;re right. <code>Windows-1252</code> is true format. I updated the post."}, {"owner": {"reputation": 136, "user_id": 2256635, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b467213a7be1d66412030828afb7f006?s=128&d=identicon&r=PG", "display_name": "tgezginis", "link": "https://stackoverflow.com/users/2256635/tgezginis"}, "reply_to_user": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1508843398, "post_id": 46908706, "comment_id": 80764466, "body": "@SumeetMasih I think the problem is that Ruby version is 1.9.3."}, {"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1508843420, "post_id": 46908706, "comment_id": 80764482, "body": "great, that works but the rest of the text is distorted <code>&quot;Nous travaillons \\u00c3\\u00a0 rendre possible l\u2019envoi de textos&quot;</code> becomes <code>&quot;Nous travaillons &#224; rendre possible l\\x92envoi de textos&quot;</code> any workaround for that as well"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "edited": false, "score": 0, "creation_date": 1508844838, "post_id": 46908706, "comment_id": 80765496, "body": "@SumeetMasih I&#39;m no expert, but it looks to me like you&#39;ve somehow got <i>multiple encodings mixed up into a single string</i>??!! I don&#39;t know how to best deal with this... Maybe the issue was introduced earlier in your own codebase?? <code>\\u00c3\\u00a0</code> is Windows-1252; <code>\u2019</code> is already UTF-8. So coercing the whole string encoding one way or the other seems to break something."}], "tags": [], "owner": {"reputation": 136, "user_id": 2256635, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b467213a7be1d66412030828afb7f006?s=128&d=identicon&r=PG", "display_name": "tgezginis", "link": "https://stackoverflow.com/users/2256635/tgezginis"}, "is_accepted": true, "score": 0, "last_activity_date": 1508843292, "last_edit_date": 1508843292, "creation_date": 1508842603, "answer_id": 46908706, "question_id": 46908606, "link": "https://stackoverflow.com/questions/46908606/encoding-in-ruby-utf-8-error/46908706#46908706", "title": "Encoding in ruby utf-8 error", "body": "<p>You have to encode string and force encoding after this.</p>\n\n<pre><code>\"Nous travaillons \u00c3\u00a1 rendre\".encode(\"Windows-1252\").force_encoding(\"utf-8\")\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>\"Nous travaillons \u00e1 rendre\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34123, "user_id": 16012, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a96d7d4f942af97c61081d92fa074ca3?s=128&d=identicon&r=PG", "display_name": "JoelFan", "link": "https://stackoverflow.com/users/16012/joelfan"}, "is_accepted": false, "score": 1, "last_activity_date": 1508870240, "last_edit_date": 1508870240, "creation_date": 1508869739, "answer_id": 46917607, "question_id": 46908606, "link": "https://stackoverflow.com/questions/46908606/encoding-in-ruby-utf-8-error/46917607#46917607", "title": "Encoding in ruby utf-8 error", "body": "<p>Have you tried: \"Nous travaillons \\u00E0 rendre\"?</p>\n\n<p>The character you want (Latin Small Letter A with grave) is a <strong>single</strong> unicode character.  That means if you are using \\u, you want just <strong>one</strong> escape sequence, not two the way your question is.  You are mixing up the concept of Unicode code point (character) and UTF-8 encoding.</p>\n\n<p>If you want to represent UTF-8 encoding in your string you should use <strong>two</strong> \\x sequences... if you want to represent the encoded character itself, you should use <strong>one</strong> \\u sequence.</p>\n\n<p>It is only your incorrect use of \\u that is making you have to resort to <em>force_encoding</em></p>\n"}], "owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 46908706, "answer_count": 2, "score": 0, "last_activity_date": 1508870240, "creation_date": 1508842308, "question_id": 46908606, "link": "https://stackoverflow.com/questions/46908606/encoding-in-ruby-utf-8-error", "title": "Encoding in ruby utf-8 error", "body": "<p>I want to convert this string</p>\n\n<pre><code>\"Nous travaillons \\u00c3\\u00a1 rendre\"\n</code></pre>\n\n<p>to</p>\n\n<p><code>Nous travaillons \u00e0 rendre</code></p>\n\n<p>but not able to do it. I tried <code>force_encoding(\"UTF-8\")</code> method on string but that didn't work too. My output is always</p>\n\n<pre><code>\"Nous travaillons \u00c3\u00a1 rendre\"\n</code></pre>\n\n<hr>\n\n<p>Only thing that seems to be working is if I manually replace <code>\\u00</code> with <code>\\x</code></p>\n\n<pre><code>\"Nous travaillons \\xc3\\xa1 rendre\"\n</code></pre>\n\n<p>but <code>gsub</code> doesn't seems to be working on this <code>\"Nous travaillons \\u00c3\\u00a1 rendre\"</code> </p>\n\n<p>i am using ruby 1.9.3</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bitcoin", "bitcoind", "bitcoin-testnet"], "comments": [{"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1508850017, "post_id": 46907132, "comment_id": 80769256, "body": "are you getting an error? You think you are not getting an error, but you are. You don&#39;t know how to check it. What are you doing to check this balance? Maybe if you tell us more about what you are doing and the understanding of Peatio you have, we can help you solve this issue"}, {"owner": {"reputation": 99, "user_id": 1776169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XJB9n.jpg?s=128&g=1", "display_name": "yatindra rao", "link": "https://stackoverflow.com/users/1776169/yatindra-rao"}, "reply_to_user": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1508932427, "post_id": 46907132, "comment_id": 80810185, "body": "@FabrizioBertoglio I am adding bitcoin in the address shown in the image from <a href=\"https://testnet.manu.backend.hamburg/faucet\" rel=\"nofollow noreferrer\">testnet.manu.backend.hamburg/faucet</a> . But It is not updating here."}, {"owner": {"reputation": 1243, "user_id": 344993, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e79fe344ca4fd2327d1d64bcf473c669?s=128&d=identicon&r=PG", "display_name": "Parth", "link": "https://stackoverflow.com/users/344993/parth"}, "edited": false, "score": 0, "creation_date": 1519623635, "post_id": 46907132, "comment_id": 84969135, "body": "Same issue for me as well, did you find any solution to this?"}], "answers": [{"tags": [], "owner": {"reputation": 1243, "user_id": 344993, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e79fe344ca4fd2327d1d64bcf473c669?s=128&d=identicon&r=PG", "display_name": "Parth", "link": "https://stackoverflow.com/users/344993/parth"}, "is_accepted": false, "score": 0, "last_activity_date": 1519625984, "last_edit_date": 1519625984, "creation_date": 1519625493, "answer_id": 48982451, "question_id": 46907132, "link": "https://stackoverflow.com/questions/46907132/how-to-add-bitcoin-in-peatio/48982451#48982451", "title": "how to add bitcoin in Peatio?", "body": "<p>I am not sure why, but it seems that the bitcoind was not configured properly. </p>\n\n<p>So, first I did this manually. Find the transaction IDs you did and call it manually.</p>\n\n<ol>\n<li>Either you can try using the same way you are doing, just make the curl as POST request. (For me, it's <code>webhooks/tx</code>) (<a href=\"https://github.com/peatio/peatio/issues/79#issuecomment-44631111\" rel=\"nofollow noreferrer\">https://github.com/peatio/peatio/issues/79#issuecomment-44631111</a>)</li>\n<li>Another option is, you can call <code>/usr/local/sbin/rabbitmqadmin publish routing_key=peatio.deposit.coin payload='{\"txid\":\"YOUR_TRANS_ID_HERE\", \"channel_key\":\"satoshi\"}'</code></li>\n</ol>\n\n<p>And it shows the balance now in peatio!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8930803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6bde53a239bdcd89f5ef671dc0d4355?s=128&d=identicon&r=PG&f=1", "display_name": "Nandini Raut", "link": "https://stackoverflow.com/users/8930803/nandini-raut"}, "is_accepted": false, "score": 0, "last_activity_date": 1533215450, "creation_date": 1533215450, "answer_id": 51654538, "question_id": 46907132, "link": "https://stackoverflow.com/questions/46907132/how-to-add-bitcoin-in-peatio/51654538#51654538", "title": "how to add bitcoin in Peatio?", "body": "<p>You are running peatio in testnet mode, If btc is deposited in the testnet address it won't reflect until and  unless your blockchain server not sych with your peatio server.</p>\n\n<p>Or check your blockchain server status is upto date \nbitcoin-cli getblockcount</p>\n"}], "owner": {"reputation": 99, "user_id": 1776169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XJB9n.jpg?s=128&g=1", "display_name": "yatindra rao", "link": "https://stackoverflow.com/users/1776169/yatindra-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1442, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1533215450, "creation_date": 1508838094, "last_edit_date": 1508938119, "question_id": 46907132, "link": "https://stackoverflow.com/questions/46907132/how-to-add-bitcoin-in-peatio", "title": "how to add bitcoin in Peatio?", "body": "<p><a href=\"https://i.stack.imgur.com/E3WDR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E3WDR.png\" alt=\"enter image description here\"></a>I have created test bitcoins but how to deposit it in Peatio.</p>\n\n<p>currencies.yml</p>\n\n<pre><code>    - id: 2\n      key: satoshi\n      code: btc\n      symbol: \"\u0e3f\"\n      coin: true\n      quick_withdraw_max: 1000\n      rpc: http://test_user_123:ddd545a1142f7fd3e167cd60e60d0a67@127.0.0.1:18332\n      blockchain: https://testnet.smartbit.com.au/tx/e9d09a0401080e299c3871ba8e3bf537ab20734567cb86ea7a63d9a025b1a8f3\n      address_url: https://testnet.smartbit.com.au/address/msCgLuJQNiRnXEg9AJzgpzC1qxehFNWkfH\n      assets:\n        balance: 3333\n        accounts:\n          -\n            address: msCgLuJQNiRnXEg9AJzgpzC1qxehFNWkfH \n</code></pre>\n\n<p>bitcoin.conf</p>\n\n<pre><code>            server=1\n            daemon=1\n\n            # If run on the test network instead of the real bitcoin network\n            testnet=1\n\n            # You must set rpcuser and rpcpassword to secure the JSON-RPC api\n            # Please make rpcpassword to something secure, `5gKAgrJv8CQr2CGUhjVbBFLSj29HnE6YGXvfykHJzS3k` for example.\n            # Listen for JSON-RPC connections on &lt;port&gt; (default: 8332 or testnet: 18332)\n            rpcuser=test_user_123\n            rpcpassword=ddd545a1142f7fd3e167cd60e60d0a67\n            rpcport=18332\n\n            # Notify when receiving coins\n            walletnotify=curl http://192.168.1.41:3000/payment_transaction/btc/%s\n</code></pre>\n\n<p>I am not able to see the balance in my bitcoin funds. What could be the reason for this?</p>\n\n<p>Server trace:</p>\n\n<pre><code>        Started GET \"/payment_transaction/btc/dc06e9864d3114ea814118f6c9b578d52f67874477ff0b546e79b360775e1117\" for 192.168.1.41 at 2017-10-25 18:57:00 +0530\n\n    ActionController::RoutingError (No route matches [GET] \"/payment_transaction/btc/dc06e9864d3114ea814118f6c9b578d52f67874477ff0b546e79b360775e1117\"):\n      lib/middleware/security.rb:11:in `call'\n      lib/middleware/i18n_js.rb:9:in `call'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1508836432, "post_id": 46906170, "comment_id": 80759723, "body": "It&#39;s the same error as here: <a href=\"https://github.com/rails/rails/issues/25007\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/25007</a> So the suspicion is the error is somehow caused by one of gems you&#39;re using. Do you have any possibly non-compatible gems in your gemset?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508837320, "post_id": 46906170, "comment_id": 80760365, "body": "This doesn&#39;t answer your question, but why are you creating the HTML in such a &quot;manual&quot; way? You can generate that HTML from <b>one line</b> of ruby code, with no need to hand-craft <i>any</i> HTML."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508837716, "post_id": 46906170, "comment_id": 80760639, "body": "Just use <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to\" rel=\"nofollow noreferrer\"><code>link_to</code></a>, with a block."}], "answers": [{"tags": [], "owner": {"reputation": 5714, "user_id": 2389501, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/23f6a708c04c660111117c4613592689?s=128&d=identicon&r=PG", "display_name": "Mateusz Urba\u0144ski", "link": "https://stackoverflow.com/users/2389501/mateusz-urba%c5%84ski"}, "is_accepted": false, "score": 0, "last_activity_date": 1508837886, "creation_date": 1508837886, "answer_id": 46907056, "question_id": 46906170, "link": "https://stackoverflow.com/questions/46906170/error-when-rendering-simple-partial-from-console/46907056#46907056", "title": "Error when rendering simple partial from console", "body": "<p>I was able to make it work with following code:</p>\n\n<pre><code>ApplicationController.new.render_to_string(\n  :partial =&gt; 'patients/patient_link',\n  :locals =&gt; { :patient_link =&gt; User.last , current_user: User.first}\n)\n</code></pre>\n"}], "owner": {"reputation": 5714, "user_id": 2389501, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/23f6a708c04c660111117c4613592689?s=128&d=identicon&r=PG", "display_name": "Mateusz Urba\u0144ski", "link": "https://stackoverflow.com/users/2389501/mateusz-urba%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508837886, "creation_date": 1508835434, "question_id": 46906170, "link": "https://stackoverflow.com/questions/46906170/error-when-rendering-simple-partial-from-console", "title": "Error when rendering simple partial from console", "body": "<p>In my Ruby on Rails app I have the following partial <code>patients/_patient_link.html.erb</code></p>\n\n<pre><code>&lt;a class=\"patient\" href=\"&lt;%= patient_path(patient_link.id) %&gt;\"&gt;\n  &lt;span class=\"name\"&gt;&lt;%= patient_link.name %&gt;&lt;/span&gt;\n&lt;/a&gt;\n</code></pre>\n\n<p>I'm trying to render this partial from the console using the following code:</p>\n\n<pre><code>include Rails.application.routes.url_helpers\nview = ActionView::Base.new('app/views/patients', {},  ActionController::Base.new)\noutput = view.render(file: '_patient_link.html', locals: {patient_link: User.last, current_user: User.last})\n</code></pre>\n\n<p>It returns me following error:</p>\n\n<pre><code>ActionView::Template::Error: wrong number of arguments (given 3, expected 0..1)\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionpack-4.2.8/lib/action_dispatch/routing/url_for.rb:150:in `url_for'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionpack-4.2.8/lib/action_dispatch/routing/route_set.rb:280:in `call'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionpack-4.2.8/lib/action_dispatch/routing/route_set.rb:223:in `call'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionpack-4.2.8/lib/action_dispatch/routing/route_set.rb:345:in `block (2 levels) in define_url_helper'\n    from /home/mateusz/projects/dashboard/app/views/patients/_patient_link.html.erb:1:in `_app_views_patients__patient_link_html_erb__1558238916296672676_82012840'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/template.rb:145:in `block in render'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/activesupport-4.2.8/lib/active_support/notifications.rb:166:in `instrument'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/template.rb:333:in `instrument'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/template.rb:143:in `render'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/renderer/template_renderer.rb:54:in `block (2 levels) in render_template'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/renderer/abstract_renderer.rb:39:in `block in instrument'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/activesupport-4.2.8/lib/active_support/notifications.rb:164:in `block in instrument'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/activesupport-4.2.8/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/activesupport-4.2.8/lib/active_support/notifications.rb:164:in `instrument'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/renderer/abstract_renderer.rb:39:in `instrument'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/renderer/template_renderer.rb:53:in `block in render_template'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/renderer/template_renderer.rb:61:in `render_with_layout'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/renderer/template_renderer.rb:52:in `render_template'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/renderer/template_renderer.rb:14:in `render'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/renderer/renderer.rb:46:in `render_template'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/renderer/renderer.rb:27:in `render'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/actionview-4.2.8/lib/action_view/helpers/rendering_helper.rb:32:in `render'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/haml-4.0.7/lib/haml/helpers/action_view_mods.rb:12:in `render_with_haml'\n    from (irb):5\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/railties-4.2.8/lib/rails/commands/console.rb:110:in `start'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/railties-4.2.8/lib/rails/commands/console.rb:9:in `start'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/railties-4.2.8/lib/rails/commands/commands_tasks.rb:68:in `console'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/railties-4.2.8/lib/rails/commands/commands_tasks.rb:39:in `run_command!'\n    from /home/mateusz/.rvm/gems/ruby-2.4.1/gems/railties-4.2.8/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\n    from bin/rails:4:in `require'\n    from bin/rails:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>This href attribute inside partial is causing this error: <code>href=\"&lt;%= patient_path(patient_link.id) %&gt;\"</code>. How can I fix that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundle", "rest-client"], "comments": [{"owner": {"reputation": 846, "user_id": 5805239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/53b5c6384585bfc78c2b95b354d99a32?s=128&d=identicon&r=PG", "display_name": "Aakanksha", "link": "https://stackoverflow.com/users/5805239/aakanksha"}, "edited": false, "score": 0, "creation_date": 1508835408, "post_id": 46906075, "comment_id": 80759021, "body": "try <code>bundle update</code> or remove the Gemfile.lock and do <code>bundle install</code>."}, {"owner": {"reputation": 43, "user_id": 5955055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zn1_atAUoSA/AAAAAAAAAAI/AAAAAAAAAR8/dkhPHuv89Xo/photo.jpg?sz=128", "display_name": "Shahriar Khan", "link": "https://stackoverflow.com/users/5955055/shahriar-khan"}, "edited": false, "score": 0, "creation_date": 1508837284, "post_id": 46906075, "comment_id": 80760346, "body": "I tried everything. nothing happens.   when i try to update it shows: Could not find gem &#39;rest_client&#39; in any of the gem sources listed in your Gemfile or in gems cached in vendor/cache.  When i try to install this gem this error shown:  ERROR:  Could not find a valid gem &#39;rest_client&#39; (= 1.8.3) in any repository ERROR:  Possible alternatives: rest-client  I remove gemfile.lock and use bundle install same error appear:  Could not find gem &#39;rest_client&#39; in any of the gem sources listed in your Gemfile or in gems cached in vendor/cache."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1508838777, "post_id": 46906075, "comment_id": 80761386, "body": "<a href=\"https://rubygems.org/gems/rest-client\" rel=\"nofollow noreferrer\"><code>gem install rest-client</code></a>."}, {"owner": {"reputation": 43, "user_id": 5955055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zn1_atAUoSA/AAAAAAAAAAI/AAAAAAAAAR8/dkhPHuv89Xo/photo.jpg?sz=128", "display_name": "Shahriar Khan", "link": "https://stackoverflow.com/users/5955055/shahriar-khan"}, "edited": false, "score": 0, "creation_date": 1508842948, "post_id": 46906075, "comment_id": 80764174, "body": "not working. I just remove all of ruby version. re install ruby. remove project directory again clone this. but result is same."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1508843561, "post_id": 46906075, "comment_id": 80764579, "body": "How does your <code>Gemfile</code> look like? Is there a line like <code>gem &#39;rest_client&#39;</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 365, "user_id": 5339089, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xynzpKdp1Mw/AAAAAAAAAAI/AAAAAAAAABA/sFBDQdwNN6Q/photo.jpg?sz=128", "display_name": "Rifatul Islam Chayon", "link": "https://stackoverflow.com/users/5339089/rifatul-islam-chayon"}, "is_accepted": true, "score": 2, "last_activity_date": 1508845670, "creation_date": 1508845670, "answer_id": 46909782, "question_id": 46906075, "link": "https://stackoverflow.com/questions/46906075/bundle-is-locked-to-rest-client-1-8-3/46909782#46909782", "title": "bundle is locked to rest_client (1.8.3)", "body": "<p><code>rest_client</code> is deprecated. That's why your bundler couldn't find it in any source. Either you have to install it from git or you have to use <code>rest-client</code> which is in the source (RubyGems.org).\nBut your Gemfile.lock file has <code>rest_client</code> locked. Follow these steps:</p>\n\n<ol>\n<li>Remove your <code>Gemfile.lock</code> file.</li>\n<li>Remove <code>rest_client</code> from your <code>Gemfile</code>.</li>\n<li>Add <code>gem 'rest-client'</code> to your <code>Gemfile</code>.</li>\n<li><code>bundle install</code>.</li>\n</ol>\n\n<p>Your problem is solved hopefully.</p>\n"}], "owner": {"reputation": 43, "user_id": 5955055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zn1_atAUoSA/AAAAAAAAAAI/AAAAAAAAAR8/dkhPHuv89Xo/photo.jpg?sz=128", "display_name": "Shahriar Khan", "link": "https://stackoverflow.com/users/5955055/shahriar-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 46909782, "answer_count": 1, "score": -2, "last_activity_date": 1508845670, "creation_date": 1508835121, "last_edit_date": 1508837276, "question_id": 46906075, "link": "https://stackoverflow.com/questions/46906075/bundle-is-locked-to-rest-client-1-8-3", "title": "bundle is locked to rest_client (1.8.3)", "body": "<blockquote>\n  <p>Your bundle is locked to rest_client (1.8.3), but that version could\n  not be found in any of the sources listed in your Gemfile. If you\n  haven't changed sources, that means the author of rest_client (1.8.3)\n  has removed it. You'll need to update your bundle to a different\n  version of rest_client (1.8.3) that hasn't been removed in order to\n  install.</p>\n</blockquote>\n"}, {"tags": ["ruby", "selenium", "webdriver"], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 6254815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2gAjS.png?s=128&g=1", "display_name": "CaptureSunshine", "link": "https://stackoverflow.com/users/6254815/capturesunshine"}, "is_accepted": true, "score": 0, "last_activity_date": 1508836292, "creation_date": 1508836292, "answer_id": 46906496, "question_id": 46905605, "link": "https://stackoverflow.com/questions/46905605/targeting-a-new-tab-in-selenium/46906496#46906496", "title": "Targeting a new tab in Selenium", "body": "<p>The following code in c#, please feel free to change it to ruby.</p>\n\n<pre><code>// This gets the window handles of open available windows(also, tabs)\nvar availableWindows= driver.WindowHandles;\n</code></pre>\n\n<p>To switch to the new tab with respect to the title of the page:</p>\n\n<pre><code> string Title= \"whateveryourpagetitleis\";\n    foreach (string windowId in availableWindows)\n                {\n                    string windowTitle = driver.SwitchTo().Window(windowId).Title;\n                    if (windowTitle.ContainsIgnoreCase(title))\n                    {\n                        driver.SwitchTo().Window(windowId);\n                    }\n                }\n</code></pre>\n\n<p>You can play around with the functions and then use your asserts accordingly. But, what you're looking for is <code>WindowHandles</code></p>\n"}], "owner": {"reputation": 485, "user_id": 8798283, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0522bfc3b8fd78d05a7d4e1bbee5188e?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/8798283/jas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 46906496, "answer_count": 1, "score": 0, "last_activity_date": 1508836292, "creation_date": 1508833643, "question_id": 46905605, "link": "https://stackoverflow.com/questions/46905605/targeting-a-new-tab-in-selenium", "title": "Targeting a new tab in Selenium", "body": "<p>I have a test which essentially will click a link on the footer of the page. We have three of them and they all lead to different places:</p>\n\n<ul>\n<li>A Google Docs form</li>\n<li>A training page</li>\n<li>A licensing page</li>\n</ul>\n\n<p>The code below makes the right assertions and clicks the link:</p>\n\n<pre><code>if @link_selection.eql?('leave feedback')\n    @wait.until {@driver.find_element(css: =&gt; 'cell.feedback').click}\n    @wait.until {@driver.find_element(css: =&gt; 'a[href=\"https://docs.google.com/a/showmyhomework.co.uk/forms/d/1LP8BZ950TSXXDR1HuVz7yhv9Cp3h6scmQtNFqIRW_XI/viewform\"').click}\n    puts \"Leave feedback link clicked\"\n</code></pre>\n\n<p>I've modularised it for each different link location. \nWhen the link is clicked, it naturally opens in a new browser tab. I then wanted to extend the test to then view the tab which was opened and then make an assertion on that page. I wanted to ask how I can handle a new tab in Selenium and the way in that:</p>\n\n<p>a. It asserts that the new tab is open (and switches to it)<br>\nb. It can then assert a heading or title of the page (so that the test is sure that the page has been opened. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508828990, "post_id": 46904224, "comment_id": 80755144, "body": "They should be auto-loaded without any additional steps, provided that FQN matches the path. Show some code (the module, at which path it resides and how you include it)"}, {"owner": {"reputation": 160, "user_id": 7499006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/26e5d39e3ed98d6107a08bdbd71e93ef?s=128&d=identicon&r=PG&f=1", "display_name": "zOs0", "link": "https://stackoverflow.com/users/7499006/zos0"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508830196, "post_id": 46904224, "comment_id": 80755862, "body": "added some code"}], "answers": [{"comments": [{"owner": {"reputation": 160, "user_id": 7499006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/26e5d39e3ed98d6107a08bdbd71e93ef?s=128&d=identicon&r=PG&f=1", "display_name": "zOs0", "link": "https://stackoverflow.com/users/7499006/zos0"}, "edited": false, "score": 0, "creation_date": 1508831131, "post_id": 46904732, "comment_id": 80756417, "body": "the second one is helpful, thanks a lot. The first is not."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 160, "user_id": 7499006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/26e5d39e3ed98d6107a08bdbd71e93ef?s=128&d=identicon&r=PG&f=1", "display_name": "zOs0", "link": "https://stackoverflow.com/users/7499006/zos0"}, "edited": false, "score": 1, "creation_date": 1508831236, "post_id": 46904732, "comment_id": 80756502, "body": "@zOs0: yet the first one IS the way you should be taking. The rails guide has a big red warning that &quot;<code>require_dependency</code> should be rarely needed. Class names and file paths should match&quot;."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1508830532, "creation_date": 1508830532, "answer_id": 46904732, "question_id": 46904224, "link": "https://stackoverflow.com/questions/46904224/how-to-require-modules-in-app-lib-folder-to-rspec-in-rails-5/46904732#46904732", "title": "How to require modules in app/lib folder to rspec in Rails 5", "body": "<blockquote>\n  <p>What is the best way to require that modules</p>\n</blockquote>\n\n<p>Use rails' auto-loading mechanism. Put your <code>Parsers::Parser1</code> to <code>app/lib/parsers/parser1.rb</code> and <code>Parsers::Parser2</code> to <code>app/lib/parsers/parser2.rb</code>. See how module's full name mirrors where it's stored? That's how rails is able to find it.</p>\n\n<p>Or you can require the file explicitly</p>\n\n<pre><code># my_spec.rb\nrequire_dependency Rails.root.join('app', 'lib', 'parsers')\n\nRSpec.describe ... \n</code></pre>\n"}], "owner": {"reputation": 160, "user_id": 7499006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/26e5d39e3ed98d6107a08bdbd71e93ef?s=128&d=identicon&r=PG&f=1", "display_name": "zOs0", "link": "https://stackoverflow.com/users/7499006/zos0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 46904732, "answer_count": 1, "score": 1, "last_activity_date": 1508830532, "creation_date": 1508828876, "last_edit_date": 1508830180, "question_id": 46904224, "link": "https://stackoverflow.com/questions/46904224/how-to-require-modules-in-app-lib-folder-to-rspec-in-rails-5", "title": "How to require modules in app/lib folder to rspec in Rails 5", "body": "<p>I moved my modules to</p>\n\n<pre><code>app/lib/parsers\n</code></pre>\n\n<p>folder.</p>\n\n<p>Model classes responds to module methods, but when i try</p>\n\n<pre><code>rspec\nI have issue\n\nFailure/Error: include MainModule::Submodule\n\nNameError:\nuninitialized constant ModelName::MainModule\n\nmodule in lib/parsers looks like this\n\nModule Parsers\n  Module Parser1\n    def foo\n    end\nend\n  Module Parser2\n\n   def bar\n   end\n end\nend\n</code></pre>\n\n<p>first model includes first parser by that way</p>\n\n<pre><code>Class Model1 &lt; ApplicationRecord\n  include Parsers::Parser1\nend\n</code></pre>\n\n<p>and the second one by the same way\nWhat is the best way to require that modules in Rspec?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "chef-infra"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 6482719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fd504f893ebb2c5320ee288daad9a533?s=128&d=identicon&r=PG&f=1", "display_name": "hlesnt395", "link": "https://stackoverflow.com/users/6482719/hlesnt395"}, "edited": false, "score": 0, "creation_date": 1508835880, "post_id": 46905098, "comment_id": 80759355, "body": "Thanks for the support. can u just explain this further. suppose  my file name is config.xml which has the above block and I need to comment that line."}, {"owner": {"reputation": 197, "user_id": 6482719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fd504f893ebb2c5320ee288daad9a533?s=128&d=identicon&r=PG&f=1", "display_name": "hlesnt395", "link": "https://stackoverflow.com/users/6482719/hlesnt395"}, "edited": false, "score": 0, "creation_date": 1508843676, "post_id": 46905098, "comment_id": 80764665, "body": "Thanks David for the support. I will check this and confirm!"}], "tags": [], "owner": {"reputation": 366, "user_id": 2372963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ed0138024f09030d02fdae6e2980fc8?s=128&d=identicon&r=PG", "display_name": "David Wright", "link": "https://stackoverflow.com/users/2372963/david-wright"}, "is_accepted": false, "score": 2, "last_activity_date": 1508839877, "last_edit_date": 1508839877, "creation_date": 1508831762, "answer_id": 46905098, "question_id": 46903966, "link": "https://stackoverflow.com/questions/46903966/comment-xml-file-content-using-ruby-code/46905098#46905098", "title": "Comment .XML file content using ruby code", "body": "<p>You can search your document with the <code>search</code> method, add a comment with <code>Comment.new</code> and then remove the original line with the <code>remove</code> method.</p>\n\n<pre><code>Nokogiri::XML::Comment.new(doc, node.to_s)\n</code></pre>\n\n<p><a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Comment\" rel=\"nofollow noreferrer\">Class: Nokogiri::XML::Comment</a></p>\n\n<p><strong>Edit:</strong>\nI implemented an example, but used <code>replace</code> instead of <code>remove</code>:</p>\n\n<pre><code>require 'nokogiri'\n\nf = File.open('./config.xml')\nx = Nokogiri::XML(f);\nx.search('message').each do |el|\n    puts(el.to_s)\n    c = Nokogiri::XML::Comment.new(x, el.to_s);\n    el.replace(c);\nend\n\nFile.write('./config.xml', x.to_xml);\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 6482719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fd504f893ebb2c5320ee288daad9a533?s=128&d=identicon&r=PG&f=1", "display_name": "hlesnt395", "link": "https://stackoverflow.com/users/6482719/hlesnt395"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508839877, "creation_date": 1508827986, "last_edit_date": 1508833069, "question_id": 46903966, "link": "https://stackoverflow.com/questions/46903966/comment-xml-file-content-using-ruby-code", "title": "Comment .XML file content using ruby code", "body": "<p>Can anyone tell me how I can comment the following line in my .XML file using Ruby?</p>\n\n<p>I hope this can be done by using \"nokogiri\".</p>\n\n<pre><code>&lt;message group=\"1\" sub_group=\"1\" type=\"none\" destination=\"mydata\" remark=\"mylist\" userOnly=\"true \"/&gt;\n</code></pre>\n\n<p>output should be:</p>\n\n<pre><code>&lt;!-- &lt;message group=\"1\" sub_group=\"1\" type=\"none\" destination=\"mydata\" remark=\"mylist\" userOnly=\"true \"/&gt; --&gt;\n</code></pre>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "database", "model-view-controller"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1508831652, "post_id": 46903267, "comment_id": 80756729, "body": "Surely it&#39;s incorrect to use constants in this case."}], "answers": [{"tags": [], "owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "is_accepted": false, "score": 0, "last_activity_date": 1508835298, "creation_date": 1508835298, "answer_id": 46906131, "question_id": 46903267, "link": "https://stackoverflow.com/questions/46903267/ruby-on-rails-create-an-activity-feed-by-sum-two-model/46906131#46906131", "title": "Ruby on Rails: Create an Activity Feed by Sum two Model", "body": "<p>I would try get the most from Rails models.</p>\n\n<p>For example, <code>following_ids</code> could be returned by a scope or a class method of Relationship:</p>\n\n<pre><code>class Relationship &lt; ActiveRecord::Base\n\n  scope :followed_ids, -&gt;(user_id) { where(follower_id: user_id).pluck(:followed_id) }\n  # or\n\n  def self.followed_ids(user_id)\n    where(follower_id: user_id).pluck(:followed_id)\n  end\nend\n</code></pre>\n\n<p>You can basically do the same thing for Post:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  scope :feed_for, -&gt;(user_id, following_ids) { where(user_id: [user_id, *following_ids]) }\nend\n</code></pre>\n\n<p>and Like:</p>\n\n<pre><code>class Like &lt; ActiveRecord::Base\n  scope :feed_for, -&gt;(user_id, following_ids) { where(user_id: [user_id, *following_ids]) }\nend\n</code></pre>\n\n<p>And finally integrate it into your User model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  def feed\n    following_ids = Relationship.followed_ids(self.id)\n    Post.feed_for(self.id, following_ids) + Like.feed_for(self.id, following_ids)\n  end\n\nend\n</code></pre>\n\n<p>Try to not use raw sql inside your Rails code and to delegate the responsibility of every action to the most relevant model for it.</p>\n"}], "owner": {"reputation": 387, "user_id": 8152465, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17b78615d8f648d8b9745b530b880422?s=128&d=identicon&r=PG&f=1", "display_name": "rod", "link": "https://stackoverflow.com/users/8152465/rod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508835298, "creation_date": 1508825161, "last_edit_date": 1508834287, "question_id": 46903267, "link": "https://stackoverflow.com/questions/46903267/ruby-on-rails-create-an-activity-feed-by-sum-two-model", "title": "Ruby on Rails: Create an Activity Feed by Sum two Model", "body": "<p>I'm trying to create an activity feed mixing two models (Post + Like). Activity feed show both current user and following users Post + Like.</p>\n\n<p>I create feed method in the User model (following the MHartl Tutorial).</p>\n\n<pre><code>  def feed\n\n    following_ids = \"SELECT followed_id FROM relationships WHERE follower_id = :user_id\"\n    Posts = Post.where(\"user_id IN (#{following_ids}) OR user_id = :user_id\", user_id: id)\n    Likes = Like.where(\"user_id IN (#{following_ids}) OR user_id = :user_id\", user_id: id)\n\n    Posts + Likes\n\n  end\n</code></pre>\n\n<p>Than in controller I simply call <code>@feed = current_user.feed.paginate</code> etc... And all works properly.</p>\n\n<p>Is it correct to sum Posts and Likes in this way? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 2982, "user_id": 3176055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c976138fc7bd60baa57b22e334816a44?s=128&d=identicon&r=PG&f=1", "display_name": "jon snow", "link": "https://stackoverflow.com/users/3176055/jon-snow"}, "is_accepted": true, "score": 2, "last_activity_date": 1508822481, "creation_date": 1508822481, "answer_id": 46902749, "question_id": 46902612, "link": "https://stackoverflow.com/questions/46902612/mysql2error-unknown-column-in-where-clause-rails/46902749#46902749", "title": "Mysql2::Error: Unknown column in where clause Rails", "body": "<p>As you requested, you can add where clause without <code>requests</code> as,</p>\n\n<pre><code>@req = Request.left_outer_joins(:user).where('access_level_id = ?', 1).order('id DESC')\n</code></pre>\n\n<p>But its good to keep relative aliasing for access_level_id. If its <code>users</code> then please use it like,</p>\n\n<pre><code>@req = Request.left_outer_joins(:user).where(users: { access_level_id: 1 }).order('id DESC')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 599, "user_id": 5963504, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/ae80b53abdd383a7339ead329343cb66?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5963504/vishal"}, "is_accepted": false, "score": 0, "last_activity_date": 1508822807, "creation_date": 1508822807, "answer_id": 46902803, "question_id": 46902612, "link": "https://stackoverflow.com/questions/46902612/mysql2error-unknown-column-in-where-clause-rails/46902803#46902803", "title": "Mysql2::Error: Unknown column in where clause Rails", "body": "<p>Assuming that <code>access_level_id</code> is field for user, you can replace your query with following:</p>\n\n<pre><code>@req = Request.left_outer_joins(:user).where('users.access_level_id = ?', 1).order('id  DESC')\n</code></pre>\n\n<p>By default the fields in where conditions are considered to be belonging to Request method in your query.</p>\n\n<p>Hope this helps you.\nPlease let me know if you face any issue.</p>\n"}], "owner": {"reputation": 205, "user_id": 8818948, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5992e6d07f86d46cb4530bb96935f095?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8818948/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1939, "favorite_count": 0, "accepted_answer_id": 46902749, "answer_count": 2, "score": 0, "last_activity_date": 1508828238, "creation_date": 1508821661, "last_edit_date": 1508828238, "question_id": 46902612, "link": "https://stackoverflow.com/questions/46902612/mysql2error-unknown-column-in-where-clause-rails", "title": "Mysql2::Error: Unknown column in where clause Rails", "body": "<p>I receive an error of </p>\n\n<pre><code>Mysql2::Error: Unknown column 'requests.access_level_id' in 'where clause': \nSELECT `requests`.* \n  FROM `requests` LEFT OUTER JOIN `users` ON `users`.`id` = `requests`.`from_id` \n  WHERE `requests`.`access_level_id` = 1 \n  ORDER BY id DESC\n</code></pre>\n\n<p>Model</p>\n\n<pre><code>class Request &lt; ApplicationRecord\n  belongs_to :user, foreign_key: :from_id\nend\n</code></pre>\n\n<p>Controller </p>\n\n<pre><code>@req = Request.left_outer_joins(:user).where(access_level_id: 1).order('id DESC')\n</code></pre>\n\n<p>How can I remove requests from the <code>WHERE clause requests.access_level_id = 1</code>? I just want <code>access_level_id = 1</code> to be in the where statement.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cloudinary"], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 2681049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/UBM7Z.jpg?s=128&g=1", "display_name": "Qmr", "link": "https://stackoverflow.com/users/2681049/qmr"}, "is_accepted": false, "score": 0, "last_activity_date": 1508822185, "creation_date": 1508822185, "answer_id": 46902698, "question_id": 46902457, "link": "https://stackoverflow.com/questions/46902457/unable-to-upload-seed-data-with-attachinary-gem-undefined-method-photos-urls/46902698#46902698", "title": "Unable to upload seed data with Attachinary gem &quot;Undefined method `photos_urls=&#39; for object&quot;", "body": "<p>Add attachment path</p>\n\n<pre><code>has_attached_file :photo,\n:styles =&gt; {\n:thumb=&gt; \"\",\n:small  =&gt; \"\"},\n:path =&gt; \"uploads/:class/:attachment/:id_partition/:style/:basename.:extension\",\n:url =&gt; \"uploads/:class/:attachment/:id/:style/:basename.:extension\"\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5144279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207498488238941/picture?type=large", "display_name": "Hugo Hyz", "link": "https://stackoverflow.com/users/5144279/hugo-hyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508822185, "creation_date": 1508820729, "question_id": 46902457, "link": "https://stackoverflow.com/questions/46902457/unable-to-upload-seed-data-with-attachinary-gem-undefined-method-photos-urls", "title": "Unable to upload seed data with Attachinary gem &quot;Undefined method `photos_urls=&#39; for object&quot;", "body": "<p>I'm trying to upload seed data for my Photoshoot model which consists of multiple for urls like so:</p>\n\n<pre><code>10.times {\n  urls = [\n    'http://lorempixel.com/400/400/',\n    'http://lorempixel.com/400/400/',\n    'http://lorempixel.com/400/400/',\n    'http://lorempixel.com/400/400/',\n    'http://lorempixel.com/400/400/',\n    'http://lorempixel.com/400/400/',\n    'http://lorempixel.com/400/400/',\n    'http://lorempixel.com/400/400/'\n  ]\n  time = Faker::Time.between(DateTime.now - 1, DateTime.now + 3)\n  photoshoot = Photoshoot.new( user_id: Faker::Number.between(1, 19), photograph_id: Faker::Number.between(1, 19), start_time: time, end_time: time + Faker::Number.between(1, 2).hours, message: Faker::TheFreshPrinceOfBelAir.quote )\n  photoshoot.save!\n  photoshoot.photo_urls = urls\n}\n</code></pre>\n\n<p>But I'm getting the following error message in my seed:</p>\n\n<p><em>NoMethodError: undefined method `photos_urls=' for </em></p>\n\n<p>My model is the following :</p>\n\n<pre><code>class Photoshoot &lt; ApplicationRecord\n  has_attachment :photos, maximum: 20\n  belongs_to :photograph\n  belongs_to :user\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508829552, "post_id": 46902273, "comment_id": 80755467, "body": "I would solve the problem within <code>thing</code> by memoizing the result of <code>expensive_transform</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508851299, "post_id": 46902273, "comment_id": 80770239, "body": "assuming <code>expensive_transform</code> is reliable and consistent isn&#39;t there a pattern that could be applied to <code>thing</code> to determine the the potential result of <code>expensive_transform</code> without actually applying it? Obviously we have no idea what <code>expensive_transform</code> does. Additionally you could create a mutable object that memoizes <code>expensive_transform</code> as @Stefan mentioned and then <code>thing</code> would already know this value without the need to process twice but this requires performing the operation on 1 to n elements where n is the found element or the end of the collection."}], "answers": [{"tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 0, "last_activity_date": 1508826258, "creation_date": 1508826258, "answer_id": 46903516, "question_id": 46902273, "link": "https://stackoverflow.com/questions/46902273/ruby-enumerablefind-returning-mapped-value/46903516#46903516", "title": "Ruby Enumerable#find returning mapped value", "body": "<p>I don't think there is a \"obvious best general solution\" for your problem, which is also simple to use. You have two procedures involved (<code>expensive_transform</code> and <code>meets_condition?</code>), and you also would need - if this were a library method to use - as a third parameter the value to return, if no transformed element meets the condition. You return nil in this case, but in a general solution, <code>expensive_transform</code> might also yield nil, and only the caller knows what unique value would indicate that the condition as not been met.</p>\n\n<p>Hence, a possible solution within Enumerable would have the signature</p>\n\n<pre><code>class Enumerable\n\n  def find_transformed(default_return_value, transform_proc, condition_proc)\n     ...\n  end\n\nend\n</code></pre>\n\n<p>or something similar, so this is not particularily elegant either. </p>\n\n<p>You could do it with a single block, if you agree to merge the semantics of the two procedures into one: You have only one procedure, which calculates the transformed value and tests it. If the test succeeds, it returns the transformed value, and if it fails, it returns the default value:</p>\n\n<pre><code>class Enumerable\n\n  def find_by(default_value, &amp;block)\n    result = default_value\n    each do |element|\n      result = block.call(element)\n      break if result != default_value\n    end\n  end\n\n  result\n\nend\n</code></pre>\n\n<p>You would use it in your case like this:</p>\n\n<pre><code>my_collection.find_by(nil) do |el|\n  transformed_value = expensive_transform(el)\n  meets_condition?(transformed_value) ? transformed_value : nil\nend\n</code></pre>\n\n<p>I'm not sure whether this is really intuitive to use...</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1508918640, "post_id": 46923044, "comment_id": 80800941, "body": "Custom enumerators are highly underrated."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1508958763, "last_edit_date": 1508958763, "creation_date": 1508899040, "answer_id": 46923044, "question_id": 46902273, "link": "https://stackoverflow.com/questions/46902273/ruby-enumerablefind-returning-mapped-value/46923044#46923044", "title": "Ruby Enumerable#find returning mapped value", "body": "<p>I would be inclined to create an enumerator that generates values <code>thing.expensive_transform</code> and then make that the receiver for <code>find</code> with <code>meets_condition?</code> in <code>find</code>'s block. For one, I like the way that reads.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def costly_find(things)\n  Enumerator.new { |y| things.each { |thing| y &lt;&lt; thing.expensive_transform } }.\n             find(&amp;:meets_condition?)\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>class Thing\n  attr_reader :value\n  def initialize(value)\n    @value = value\n  end\n  def expensive_transform\n    self.class.new(value*2)\n  end\n  def meets_condition?\n    value == 12\n  end\nend\n\nthings = [1,3,6,4].map { |n| Thing.new(n) }\n  #=&gt; [#&lt;Thing:0x00000001e90b78 @value=1&gt;, #&lt;Thing:0x00000001e90b28 @value=3&gt;,\n  #    #&lt;Thing:0x00000001e90ad8 @value=6&gt;, #&lt;Thing:0x00000001e90ab0 @value=4&gt;]\ncostly_find(things)\n  #=&gt; #&lt;Thing:0x00000001e8a3b8 @value=12&gt;\n</code></pre>\n\n<p>In the example I have assumed that <code>expensive_things</code> and <code>things</code> are instances of the same class, but if that is not the case the code would need to be modified in the obvious way.</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 2, "last_activity_date": 1508923801, "last_edit_date": 1508923801, "creation_date": 1508921798, "answer_id": 46928083, "question_id": 46902273, "link": "https://stackoverflow.com/questions/46902273/ruby-enumerablefind-returning-mapped-value/46928083#46928083", "title": "Ruby Enumerable#find returning mapped value", "body": "<blockquote>\n  <p>Of course there are ugly ways of accomplishing this...</p>\n</blockquote>\n\n<p>If you had a cheap operation, you'd just use:</p>\n\n<pre><code>collection.map(&amp;:operation).find(&amp;:condition?)\n</code></pre>\n\n<p>To make Ruby call <code>operation</code> only \"on a as-needed basis\" (as the documentation says), you can simply prepend <a href=\"http://ruby-doc.org/core-2.4.2/Enumerable.html#method-i-lazy\" rel=\"nofollow noreferrer\"><code>lazy</code></a>:</p>\n\n<pre><code>collection.lazy.map(&amp;:operation).find(&amp;:condition?)\n</code></pre>\n\n<p>I don't think this is ugly at all\u2014quite the contrary\u2014 it looks elegant to me.</p>\n\n<hr>\n\n<p>Applied to your code:</p>\n\n<pre><code>def costly_find(things)\n  things.lazy.map(&amp;:expensive_transform).find(&amp;:meets_condition?)\nend\n</code></pre>\n"}], "owner": {"reputation": 633, "user_id": 2569591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8d27d0f26642f207e98f9ecbd36ca59?s=128&d=identicon&r=PG", "display_name": "bosticko", "link": "https://stackoverflow.com/users/2569591/bosticko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 1, "accepted_answer_id": 46928083, "answer_count": 3, "score": 2, "last_activity_date": 1508958763, "creation_date": 1508819698, "question_id": 46902273, "link": "https://stackoverflow.com/questions/46902273/ruby-enumerablefind-returning-mapped-value", "title": "Ruby Enumerable#find returning mapped value", "body": "<p><strong>Does Ruby's <code>Enumerable</code> offer a better way to do the following?</strong></p>\n\n<pre><code>output = things\n  .find { |thing| thing.expensive_transform.meets_condition? }\n  .expensive_transform\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.4.2/Enumerable.html#method-i-find\" rel=\"nofollow noreferrer\"><code>Enumerable#find</code></a> is great for finding an element in an enumerable, but returns the original element, not the return value of the block, so any work done is lost.</p>\n\n<p>Of course there are ugly ways of accomplishing this...</p>\n\n<h3>Side effects</h3>\n\n<pre><code>def constly_find(things)\n  output = nil\n\n  things.each do |thing|\n    expensive_thing = thing.expensive_transform\n    if expensive_thing.meets_condition?\n      output = expensive_thing\n      break\n    end\n  end\n\n  output\nend\n</code></pre>\n\n<h3>Returning from a block</h3>\n\n<p><em>This is the alternative I'm trying to refactor</em></p>\n\n<pre><code>def costly_find(things)\n  things.each do |thing|\n    expensive_thing = thing.expensive_transform\n\n    return expensive_thing if expensive_thing.meets_condition?\n  end\n\n  nil\nend\n</code></pre>\n\n<h3><code>each.lazy.map.find</code></h3>\n\n<pre><code>def costly_find(things)\n  things\n    .each\n    .lazy\n    .map(&amp;:expensive_transform)\n    .find(&amp;:meets_condition?)\nend\n</code></pre>\n\n<p>Is there something better?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "heroku"], "comments": [{"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 0, "creation_date": 1508848689, "post_id": 46902067, "comment_id": 80768184, "body": "restart your Heroku server using this command - heroku restart --a app_name"}, {"owner": {"reputation": 4201, "user_id": 4177142, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/o7RE7.png?s=128&g=1", "display_name": "Dinuka Jay", "link": "https://stackoverflow.com/users/4177142/dinuka-jay"}, "reply_to_user": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 0, "creation_date": 1508849048, "post_id": 46902067, "comment_id": 80768443, "body": "@AniketShivamTiwari Thanks but it didn&#39;t fix it either. Could it be an issue in the database config?"}], "answers": [{"tags": [], "owner": {"reputation": 4201, "user_id": 4177142, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/o7RE7.png?s=128&g=1", "display_name": "Dinuka Jay", "link": "https://stackoverflow.com/users/4177142/dinuka-jay"}, "is_accepted": true, "score": 1, "last_activity_date": 1508866659, "last_edit_date": 1508866659, "creation_date": 1508858989, "answer_id": 46914469, "question_id": 46902067, "link": "https://stackoverflow.com/questions/46902067/rails-and-sinatra-not-getting-any-response-from-database/46914469#46914469", "title": "Rails and Sinatra - Not getting any response from Database", "body": "<p>Apparently the code is correct and the database connection was being established. I just wasn't converting the response to json. Silly but I am just learning ruby on rails. Going to post this here to help out any other person:</p>\n\n<pre><code>post '/login' do\n  @result = AdminUser.take(10)\n  @result.to_json\nend\n</code></pre>\n"}], "owner": {"reputation": 4201, "user_id": 4177142, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/o7RE7.png?s=128&g=1", "display_name": "Dinuka Jay", "link": "https://stackoverflow.com/users/4177142/dinuka-jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 46914469, "answer_count": 1, "score": 1, "last_activity_date": 1508866659, "creation_date": 1508818372, "question_id": 46902067, "link": "https://stackoverflow.com/questions/46902067/rails-and-sinatra-not-getting-any-response-from-database", "title": "Rails and Sinatra - Not getting any response from Database", "body": "<p>I am attempting to read from a postgresql database hosted on Heroku using a web interface developed using Sinatra and Rails. The site is functioning properly and upon sending a post request, the site returns no values from the table I'm reading from. No errors occurred.</p>\n\n<p><strong>My site.rb</strong></p>\n\n<pre><code>require 'sinatra'\nrequire 'sinatra/activerecord'\nrequire_relative 'app/models/admin_user'\n\nset :database_file, 'config/database.yml'\n\nget '/' do\n  erb :index\nend\n\npost '/login' do\n  @result = AdminUser.take(10)\n  @result.to_s\nend\n</code></pre>\n\n<p>The response I get when I post to <code>/login</code> is just this:</p>\n\n<pre><code>[#]\n</code></pre>\n\n<p>The same database.yml file was used for another mobile backend project and the endpoints were able to establish the connection. In this case, no errors are produced so I'm assuming the database was connected successfully? How can I resolve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker"], "answers": [{"comments": [{"owner": {"reputation": 971, "user_id": 1372767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6d968e5de074e1aeef2ed6b9cc336f9?s=128&d=identicon&r=PG", "display_name": "Jeff Dickey", "link": "https://stackoverflow.com/users/1372767/jeff-dickey"}, "edited": false, "score": 0, "creation_date": 1583085499, "post_id": 46911915, "comment_id": 106989375, "body": "This page was removed at some point before 14 February 2019, when the site was crawled by the Wayback Machine (also known as web.archive.org).  More recent, existing pointers would be greatly appreciated."}], "tags": [], "owner": {"reputation": 136, "user_id": 2256635, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b467213a7be1d66412030828afb7f006?s=128&d=identicon&r=PG", "display_name": "tgezginis", "link": "https://stackoverflow.com/users/2256635/tgezginis"}, "is_accepted": false, "score": -1, "last_activity_date": 1508851972, "creation_date": 1508851972, "answer_id": 46911915, "question_id": 46902009, "link": "https://stackoverflow.com/questions/46902009/how-to-copy-installed-gems-to-another-docker-image/46911915#46911915", "title": "How to copy installed gems to another docker image?", "body": "<p>You can share the data by creating a persistent Ruby gems container. Review the details below;</p>\n\n<p><a href=\"https://www.healthcareblocks.com/blog/persistent-ruby-gems-docker-container\" rel=\"nofollow noreferrer\">https://www.healthcareblocks.com/blog/persistent-ruby-gems-docker-container</a></p>\n"}], "owner": {"reputation": 101, "user_id": 4790081, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kvxsAfXSXHI/AAAAAAAAAAI/AAAAAAAAABs/JhF3ACMkIAI/photo.jpg?sz=128", "display_name": "kuntao", "link": "https://stackoverflow.com/users/4790081/kuntao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 920, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1508851972, "creation_date": 1508817969, "last_edit_date": 1508824874, "question_id": 46902009, "link": "https://stackoverflow.com/questions/46902009/how-to-copy-installed-gems-to-another-docker-image", "title": "How to copy installed gems to another docker image?", "body": "<p>I tried Docker multi-stage build to create a clean image for rails production runtime.\nI made Dockerfile like below</p>\n\n<pre><code># Build image\nFROM scardon/ruby-node-alpine:2.4.2 AS build-env\n\nCOPY Gemfile* ./\nRUN apk update &amp;&amp; \\\n    apk add --no-cache --virtual build-dependencies PACKAGES &amp;&amp; \\\n    gem install bundler &amp;&amp; \\\n    bundle install &amp;&amp; \\\n    bundle exec assets:precompile &amp;&amp; \\\n    bundle exec assets:sync\n\n# Runtime image\nFROM ruby:2.4.2-alpine3.6\n\nCOPY . .\n# $BUNLE_PATH is set to /usr/local/bundle in both images.\nCOPY --from=build-env /usr/local/bundle /usr/local/bundle\nCOPY --from=build-env /root/public/assets/.sprockets-manifest-abcdef123456.json /root/public/assets/.sprockets-manifest-abcdef123456.json\n</code></pre>\n\n<p>But in below image, <code>bundle check</code> says that gems, which needs native extension build, is not installed. <code>bundle doctor</code> outputs is like below</p>\n\n<pre><code>Ignoring bindex-0.5.0 because its extensions are not built.  Try: gem pristine bindex --version 0.5.0\nIgnoring binding_of_caller-0.7.2 because its extensions are not built.  Try: gem pristine binding_of_caller --version 0.7.2\nIgnoring byebug-9.0.6 because its extensions are not built.  Try: gem pristine byebug --version 9.0.6\nIgnoring debug_inspector-0.0.3 because its extensions are not built.  Try: gem pristine debug_inspector --version 0.0.3\nIgnoring ffi-1.9.18 because its extensions are not built.  Try: gem pristine ffi --version 1.9.18\nIgnoring json-2.1.0 because its extensions are not built.  Try: gem pristine json --version 2.1.0\nIgnoring mysql2-0.4.8 because its extensions are not built.  Try: gem pristine mysql2 --version 0.4.8\nIgnoring nio4r-2.1.0 because its extensions are not built.  Try: gem pristine nio4r --version 2.1.0\nIgnoring nokogiri-1.8.0 because its extensions are not built.  Try: gem pristine nokogiri --version 1.8.0\nIgnoring oj-3.3.4 because its extensions are not built.  Try: gem pristine oj --version 3.3.4\nIgnoring puma-3.9.1 because its extensions are not built.  Try: gem pristine puma --version 3.9.1\nIgnoring rainbow-2.2.2 because its extensions are not built.  Try: gem pristine rainbow --version 2.2.2\nIgnoring websocket-driver-0.6.5 because its extensions are not built.  Try: gem pristine websocket-driver --version 0.6.5\nThe latest bundler is 1.16.0.pre.3, but you are currently running 1.15.4.\nTo update, run `gem install bundler --pre`\nThe following gems are missing\n * nokogiri (1.8.0)\n * nio4r (2.1.0)\n * websocket-driver (0.6.5)\n * bindex (0.5.0)\n * debug_inspector (0.0.3)\n * binding_of_caller (0.7.2)\n * byebug (9.0.6)\n * ffi (1.9.18)\n * rainbow (2.2.2)\n * json (2.1.0)\n * mysql2 (0.4.8)\n * oj (3.3.4)\n * puma (3.9.1)\nInstall missing gems with `bundle install`\n</code></pre>\n\n<p>But in <code>$BUNDLE_PATH</code>, these gems are there.\nWhat is needed to tell <code>bundler</code> that dependencies are satisfied?</p>\n\n<p>Thank you</p>\n\n<p>(Sorry for my poor English.)</p>\n"}, {"tags": ["ruby", "rubymine"], "answers": [{"comments": [{"owner": {"reputation": 3549, "user_id": 658270, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/56a007a4b2c47b141bd39790278f88a7?s=128&d=identicon&r=PG", "display_name": "Sonia Hamilton", "link": "https://stackoverflow.com/users/658270/sonia-hamilton"}, "edited": false, "score": 0, "creation_date": 1508828767, "post_id": 46901578, "comment_id": 80755005, "body": "That&#39;s great, thank you!! I mustn&#39;t had the code highlighted, therefore the command didn&#39;t appear in the menubar. I&#39;m new to visual editors, I&#39;ve been using vim since before the Wright brothers."}, {"owner": {"reputation": 191, "user_id": 2878233, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Ok3Qo.jpg?s=128&g=1", "display_name": "laechoppe", "link": "https://stackoverflow.com/users/2878233/laechoppe"}, "edited": false, "score": 0, "creation_date": 1555432991, "post_id": 46901578, "comment_id": 98106553, "body": "Actually I have &quot;Surround with&quot; option inactive for feature files. However, everything is ok with .rb Any ideas what should I change?"}], "tags": [], "owner": {"reputation": 8454, "user_id": 958529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3ec25db39c63bab1a11037649e326b8?s=128&d=identicon&r=PG", "display_name": "halfelf", "link": "https://stackoverflow.com/users/958529/halfelf"}, "is_accepted": true, "score": 2, "last_activity_date": 1508814580, "creation_date": 1508814580, "answer_id": 46901578, "question_id": 46901353, "link": "https://stackoverflow.com/questions/46901353/manual-markers-for-code-folding-in-rubymine/46901578#46901578", "title": "Manual markers for code folding in RubyMine", "body": "<p>Yes. Rubymine has the same function like IntelliJ. </p>\n\n<p>Select any code region you like, press <kbd>option</kbd>+<kbd>command</kbd>+<kbd>T</kbd> on a mac or some other similar keys binding on windows (I haven't a win install right now).  Also you can do this from menu: <code>Code</code> -> <code>Surround With...</code>.</p>\n\n<p>To go to any custom folding, press <kbd>option</kbd>+<kbd>command</kbd>+<kbd>.</kbd> on mac, or from menu: <code>Navigate</code> -> <code>Custom Folding...</code>.</p>\n"}], "owner": {"reputation": 3549, "user_id": 658270, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/56a007a4b2c47b141bd39790278f88a7?s=128&d=identicon&r=PG", "display_name": "Sonia Hamilton", "link": "https://stackoverflow.com/users/658270/sonia-hamilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 46901578, "answer_count": 1, "score": 1, "last_activity_date": 1508815430, "creation_date": 1508812836, "last_edit_date": 1508815430, "question_id": 46901353, "link": "https://stackoverflow.com/questions/46901353/manual-markers-for-code-folding-in-rubymine", "title": "Manual markers for code folding in RubyMine", "body": "<p>In RubyMine, is it possible to insert manual fold markers (like vim or emacs)?</p>\n\n<p>I want to automatically fold a very large hash whenever I open a file. It's available in <a href=\"https://blog.jetbrains.com/idea/2012/03/custom-code-folding-regions-in-intellij-idea-111/\" rel=\"nofollow noreferrer\">IntelliJ</a>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 3133, "user_id": 1883793, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/33ed6dd2dcb89dab186d5b9dfe8ae9b2?s=128&d=identicon&r=PG", "display_name": "user1883793", "link": "https://stackoverflow.com/users/1883793/user1883793"}, "edited": false, "score": 0, "creation_date": 1508811388, "post_id": 46901127, "comment_id": 80749257, "body": "Thanks, so its the AR/SQL query result is in a different order, if I understand correctly"}, {"owner": {"reputation": 4397, "user_id": 1945948, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ecf1cdd8eed500e1e1df86d036b69a7?s=128&d=identicon&r=PG&f=1", "display_name": "atw", "link": "https://stackoverflow.com/users/1945948/atw"}, "edited": false, "score": 0, "creation_date": 1582917837, "post_id": 46901127, "comment_id": 106954715, "body": "Hi, what does &quot;should preserve the order mean&quot;? Do you mean that it 100% will preserve the order or are there scenarios where it won&#39;t? Thanks."}], "tags": [], "owner": {"reputation": 6251, "user_id": 145525, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dd5d3f6afa97634b647fc6c3c5703cb?s=128&d=identicon&r=PG", "display_name": "Dhruva Sagar", "link": "https://stackoverflow.com/users/145525/dhruva-sagar"}, "is_accepted": true, "score": 6, "last_activity_date": 1508811270, "last_edit_date": 1508811270, "creation_date": 1508811057, "answer_id": 46901127, "question_id": 46901054, "link": "https://stackoverflow.com/questions/46901054/does-array-map-preserve-the-original-order/46901127#46901127", "title": "Does &#39;array.map&#39; preserve the original order?", "body": "<p>The underlying issue isn't because of <code>map</code>, which should preserve the order. Rather, <code>user.jobs</code> itself may be in a different order (in each test) since there isn't any explicit <code>order by</code> clause used. Without an explicit <code>order by</code>, you can't guarantee the order of the jobs even if you create them in a specific order.</p>\n\n<p>You should use <a href=\"http://www.rubydoc.info/github/rspec/rspec-expectations/RSpec/Matchers:match_array\" rel=\"noreferrer\">http://www.rubydoc.info/github/rspec/rspec-expectations/RSpec/Matchers:match_array</a> instead of <code>eq</code> for comparison to avoid such issues.</p>\n"}], "owner": {"reputation": 3133, "user_id": 1883793, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/33ed6dd2dcb89dab186d5b9dfe8ae9b2?s=128&d=identicon&r=PG", "display_name": "user1883793", "link": "https://stackoverflow.com/users/1883793/user1883793"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1510, "favorite_count": 0, "accepted_answer_id": 46901127, "answer_count": 1, "score": 2, "last_activity_date": 1508811270, "creation_date": 1508810443, "last_edit_date": 1508811004, "question_id": 46901054, "link": "https://stackoverflow.com/questions/46901054/does-array-map-preserve-the-original-order", "title": "Does &#39;array.map&#39; preserve the original order?", "body": "<p>I have a <code>User</code> class that <code>has_many</code> <code>Job</code>s. I map jobs with the following code:</p>\n\n<pre><code>def ranges\n  user.jobs.map { |u| [u.start_at, u.end_at] }\nend\n</code></pre>\n\n<p>I have a spec that compares two arrays:</p>\n\n<pre><code>my_array = [[start1, end1], [start2, end2]]\nexpect(ranges).to eq my_array\n</code></pre>\n\n<p>It passes on local, but not on Bamboo build. I had to change it to pass the build. I still don't understand why it behaves like this. I expect some random pattern even if map doesn't preserve the order.</p>\n\n<p>Why does this pass on my local, but fails in Bamboo build?</p>\n"}, {"tags": ["ruby", "spree", "ruby-on-rails-5.1", "spree-auth-devise"], "comments": [{"owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 0, "creation_date": 1508848258, "post_id": 46899557, "comment_id": 80767842, "body": "hi @uncleasol, could you add to your question also an extract of your <code>routes.rb</code>? Did you check if there is anything useful in the issue history of this gem? <a href=\"https://github.com/spree/spree_auth_devise/issues?utf8=%E2%9C%93&amp;q=is%3Aissue%20\" rel=\"nofollow noreferrer\">github.com/spree/spree_auth_devise/&hellip;</a>"}, {"owner": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "reply_to_user": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 0, "creation_date": 1508856106, "post_id": 46899557, "comment_id": 80773959, "body": "thanks, @mabe02 - I will post an extract of the routes.rb file this evening, but I did do a search on the issues and don&#39;t see anything about removing or uninstalling the gem."}, {"owner": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "reply_to_user": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 0, "creation_date": 1508877666, "post_id": 46899557, "comment_id": 80786724, "body": "@mabe02 - Relevant portions of routes.rb (which is what I think you meant by &quot;an extract&quot;) have been included above. Thanks again for the help."}, {"owner": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "reply_to_user": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 0, "creation_date": 1509056877, "post_id": 46899557, "comment_id": 80877320, "body": "Since there was no issue posted at spree_auth_devise about this, I have posted one to see if anyone has anything over there: <a href=\"https://github.com/spree/spree_auth_devise/issues/398\" rel=\"nofollow noreferrer\">github.com/spree/spree_auth_devise/issues/398</a>"}, {"owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "edited": false, "score": 1, "creation_date": 1509368388, "post_id": 46899557, "comment_id": 80978042, "body": "<code>git revert</code> :)"}], "answers": [{"comments": [{"owner": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "edited": false, "score": 0, "creation_date": 1509489868, "post_id": 47018530, "comment_id": 81038535, "body": "I&#39;m trying these things now. I have all of my spree changes in a feature branch, but I&#39;d rather not have to do the install all over again. Mainly because I don&#39;t want to have to re-setup my database."}, {"owner": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "edited": false, "score": 0, "creation_date": 1509491236, "post_id": 47018530, "comment_id": 81038943, "body": "I&#39;m trying to rollback the database changes for devise only, but when I try to run rake db:migrate, I&#39;m still getting that same error on AuthenticationHelpers"}, {"owner": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "edited": false, "score": 0, "creation_date": 1509491307, "post_id": 47018530, "comment_id": 81038968, "body": "Sorry, I posted that error on GitHub - I will update the post above with the error"}, {"owner": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "edited": false, "score": 0, "creation_date": 1509491910, "post_id": 47018530, "comment_id": 81039122, "body": "Update 2 above has the error - hoping that will help"}, {"owner": {"reputation": 1504, "user_id": 3536450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7d9026d96e8a5733927cb70c20010a1?s=128&d=identicon&r=PG", "display_name": "dfherr", "link": "https://stackoverflow.com/users/3536450/dfherr"}, "reply_to_user": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "edited": false, "score": 0, "creation_date": 1509643336, "post_id": 47018530, "comment_id": 81111483, "body": "i edited my answer. you probably have a reference to <code>Spree::AuthenticationHelpers</code> still in your <code>ApplicationController</code>"}, {"owner": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "edited": false, "score": 0, "creation_date": 1510071978, "post_id": 47018530, "comment_id": 81275252, "body": "Yes, this was the problem. Though, unfortunately I was unexpectedly away for the past week and the bounty expired. I will see if I can find a way to add it back."}, {"owner": {"reputation": 1504, "user_id": 3536450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7d9026d96e8a5733927cb70c20010a1?s=128&d=identicon&r=PG", "display_name": "dfherr", "link": "https://stackoverflow.com/users/3536450/dfherr"}, "reply_to_user": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "edited": false, "score": 0, "creation_date": 1510073453, "post_id": 47018530, "comment_id": 81276184, "body": "@unclesol i automatically got half of it, because of 2 upvotes. I guess not much you can do about it now ;)"}], "tags": [], "owner": {"reputation": 1504, "user_id": 3536450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7d9026d96e8a5733927cb70c20010a1?s=128&d=identicon&r=PG", "display_name": "dfherr", "link": "https://stackoverflow.com/users/3536450/dfherr"}, "is_accepted": true, "score": 2, "last_activity_date": 1509763961, "last_edit_date": 1509763961, "creation_date": 1509376052, "answer_id": 47018530, "question_id": 46899557, "link": "https://stackoverflow.com/questions/46899557/howto-uninstall-spree-auth-devise-gem/47018530#47018530", "title": "Howto Uninstall spree_auth_devise gem", "body": "<p>Based on your information, try this:</p>\n\n<p><strong>Remove</strong> <code>config/initializers/devise.rb</code> if you haven't done it</p>\n\n<p><strong>remove any</strong> <code>devise</code> <strong>related code from your</strong> <code>routes.rb</code></p>\n\n<p>Might look similar to this:</p>\n\n<pre><code>devise_for :users, controllers: {\n    confirmations: 'users/confirmations',\n    passwords: 'users/passwords',\n    registrations: 'users/registrations',\n    sessions: 'users/sessions',\n    unlocks: 'users/unlocks'\n}\n</code></pre>\n\n<p><strong>Check if there are is any code related to</strong> <code>devise</code>/<code>spree_auth_devise</code></p>\n\n<p>Might look like this in your <code>User</code> model:</p>\n\n<pre><code>devise :database_authenticatable, :registerable\n</code></pre>\n\n<p>Or in your <code>ApplicationController</code> or any other controller (git grep it):</p>\n\n<pre><code>before_action :authenticate_user!\n</code></pre>\n\n<p><strong>Rollback your database changes</strong> (set STEP and RAILS_ENV appropirately):</p>\n\n<pre><code>rake db:rollback STEP=1 RAILS_ENV=development\n</code></pre>\n\n<p>If nothing helps, try a <a href=\"https://git-scm.com/docs/git-revert\" rel=\"nofollow noreferrer\">git revert</a> or <a href=\"https://git-scm.com/docs/git-reset\" rel=\"nofollow noreferrer\">git reset</a></p>\n\n<p>Regarding your error <code>uninitialized constant Spree::AuthenticationHelpers</code></p>\n\n<p>This module is defined in the <code>spree_auth_gem</code> <a href=\"https://github.com/spree/spree_auth_devise/blob/56f3fe203c141c1edb75667eba0455cf931cfffa/lib/spree/authentication_helpers.rb\" rel=\"nofollow noreferrer\">here</a> and also gets included to your <code>ApplicationController</code> in <a href=\"https://github.com/spree/spree_auth_devise/blob/56f3fe203c141c1edb75667eba0455cf931cfffa/lib/spree/auth/engine.rb#L49\" rel=\"nofollow noreferrer\">the engine</a>.</p>\n\n<p>If you did setup spree by <a href=\"https://guides.spreecommerce.org/developer/authentication.html\" rel=\"nofollow noreferrer\">this guide</a> <strong>remove</strong> <code>include Spree::AuthenticationHelpers</code> <strong>from your</strong> <code>ApplicationController</code>.</p>\n\n<p>Thes includes below <strong>might</strong> also be unnecessary. I would remove them 1 by 1 and see if your app still works:</p>\n\n<pre><code>include Spree::Core::ControllerHelpers::Auth\ninclude Spree::Core::ControllerHelpers::Common\ninclude Spree::Core::ControllerHelpers::Order\ninclude Spree::Core::ControllerHelpers::Store\nhelper 'spree/base'\n</code></pre>\n"}], "owner": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 47018530, "answer_count": 1, "score": 2, "last_activity_date": 1509763961, "creation_date": 1508798345, "last_edit_date": 1509491395, "question_id": 46899557, "link": "https://stackoverflow.com/questions/46899557/howto-uninstall-spree-auth-devise-gem", "title": "Howto Uninstall spree_auth_devise gem", "body": "<p>I have an existing Rails 5.1 application which already contains a custom user controller.</p>\n\n<p>As I was following the instructions to install <code>Spree</code>, I installed the <a href=\"https://github.com/spree/spree_auth_devise\" rel=\"nofollow noreferrer\"><code>spree_auth_devise</code> gem</a> and ran the migrations and other install commands as advised on the readme page. As I began working with the gem I found that there was an issue with my User class, and this - of course - was because I had installed the <code>devise gem</code> when I am not using devise.</p>\n\n<p>I have attempted to follow the instructions on how to set up a custom user model when not using devise, but after following these instructions and removing the <code>spree_auth_devise</code> I am unable to launch the site.</p>\n\n<p>When I run the site with the gem installed, my custom routes for \"login\" etc, do not work. They point to the path where spree is installed and not that defined in my routes.rb. </p>\n\n<p>I'm not sure what to do to remove the gem and get my user model working with spree. Any help is appreciated. I'm not sure what details or code to provide other than this as there are many files affected by this. I will post anything you feel may help.</p>\n\n<p><strong>UPDATE:</strong> Per the comment below, here are the spree-relevant portions of my routes.rb. Let me know if you need anything else:</p>\n\n<pre><code>mount Spree::Core::Engine, at: '/store'\n\nget 'login'                                 =&gt;  'sessions#new'\nget 'signup'                                =&gt;  'users#new'\ndelete  'logout'                            =&gt;  'sessions#destroy'\npost 'login'                                =&gt;  'sessions#create'\n</code></pre>\n\n<p><strong>UPDATE 2</strong> I get this error when I try to launch the server or run rake db:migrate...</p>\n\n<pre><code>Exiting\n/Users/user/sites/site/app/controllers/application_controller.rb:8:in `&lt;class:ApplicationController&gt;': uninitialized constant Spree::AuthenticationHelpers (NameError)\n    from /Users/user/sites/site/app/controllers/application_controller.rb:1:in `&lt;top (required)&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "recursion", "hash", "tree", "refactoring"], "comments": [{"owner": {"reputation": 60090, "user_id": 188031, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/p2YIF.jpg?s=128&g=1", "display_name": "tokland", "link": "https://stackoverflow.com/users/188031/tokland"}, "edited": false, "score": 0, "creation_date": 1508794690, "post_id": 46898415, "comment_id": 80745055, "body": "Sorry, I don&#39;t understand part of the expected output. For example: <code>:alpha -&gt; :nyc -&gt; :app</code>. There is no member with this triplet, where does it come from? What about <code>null</code>? What about <code>generic</code>?"}, {"owner": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "reply_to_user": {"reputation": 60090, "user_id": 188031, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/p2YIF.jpg?s=128&g=1", "display_name": "tokland", "link": "https://stackoverflow.com/users/188031/tokland"}, "edited": false, "score": 0, "creation_date": 1508795384, "post_id": 46898415, "comment_id": 80745341, "body": "@tokland my apologies, copy and paste issue from mobile phone and mixed things up. Good catch! Is it clearer now?"}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508799462, "post_id": 46898415, "comment_id": 80746584, "body": "What is <code>dict</code>? Does it start as an empty hash?"}], "answers": [{"comments": [{"owner": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "edited": false, "score": 0, "creation_date": 1508822866, "post_id": 46899802, "comment_id": 80752241, "body": "I&#39;m using 1.8 (not my choice) so I&#39;ll checkout the group_by definitely."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "edited": false, "score": 1, "creation_date": 1508824422, "post_id": 46899802, "comment_id": 80752810, "body": "Egad! We had steam-powered locomotives when v1.8.7 was around. I&#39;ve edited to show how to roll-your-own <code>transform_values</code> that should work with v.1.8.7."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1508855588, "last_edit_date": 1508855588, "creation_date": 1508800115, "answer_id": 46899802, "question_id": 46898415, "link": "https://stackoverflow.com/questions/46898415/trying-to-create-a-hash-with-depth-of-3-from-several-hashes/46899802#46899802", "title": "Trying to create a hash with depth of 3 from several hashes", "body": "<pre><code>members.group_by { |g| g['segment'] }.\n        transform_values { |a| a.group_by { |f| f['dc'] }.\n          transform_values { |aa| aa.group_by { |h| h['designation'] }.\n            transform_values { |aaa| aaa.map { |e| e['name'] } } } }\n  #=&gt; { \"alpha\"=&gt;{\n          \"nyc\"=&gt;{\n             \"web\"=&gt;[200],\n             \"app\"=&gt;[202]\n          },\n          \"sfc\"=&gt;{\n             \"web\"=&gt;[400],\n             \"app\"=&gt;[403]\n          }\n        },\n        \"shared\"=&gt;{\n          \"nyc\"=&gt;{\n            \"generic\"=&gt;[201]\n          },\n          \"sfc\"=&gt;{\n            \"web\"=&gt;[401],\n            \"app\"=&gt;[402]\n          }\n        }\n      }\n</code></pre>\n\n<p>See the docs for <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerble#group_by</a> and <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-transform_values\" rel=\"nofollow noreferrer\">Hash#transform_values</a>. The latter made its debut in Ruby v2.4.</p>\n\n<p>For Ruby versions prior to 2.4 one could create the method <code>Hash#tranform_values</code> quite easily.</p>\n\n<pre><code>class Hash\n  def transform_values\n    Hash[map { |k,v| [k, yield(v)] }]\n  end\nend\n</code></pre>\n\n<p>Then, for example,</p>\n\n<pre><code>{ a: 1, b: 3 }.transform_values { |v| 2*v }\n  #=&gt; { :a=&gt;2, :b=&gt;6 }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "is_accepted": false, "score": 1, "last_activity_date": 1508846010, "last_edit_date": 1508846010, "creation_date": 1508840891, "answer_id": 46908141, "question_id": 46898415, "link": "https://stackoverflow.com/questions/46898415/trying-to-create-a-hash-with-depth-of-3-from-several-hashes/46908141#46908141", "title": "Trying to create a hash with depth of 3 from several hashes", "body": "<p>In Ruby 2.3 and 2.0 (without <code>transform_values</code>, with <code>group_by</code>) :</p>\n\n<pre><code>a = {'name' =&gt; 200, 'segment' =&gt; 'alpha',  'dc' =&gt; 'nyc', 'designation' =&gt; 'web'}\nb = {'name' =&gt; 201, 'segment' =&gt; 'shared', 'dc' =&gt; 'nyc', 'designation' =&gt; 'generic'}\nc = {'name' =&gt; 202, 'segment' =&gt; 'alpha', 'dc' =&gt; 'nyc', 'designation' =&gt; 'app'}\nd = {'name' =&gt; 400, 'segment' =&gt; 'alpha',  'dc' =&gt; 'sfc', 'designation' =&gt; 'web'}\ne = {'name' =&gt; 401, 'segment' =&gt; 'shared', 'dc' =&gt; 'sfc', 'designation' =&gt; 'web'}\nf = {'name' =&gt; 402, 'segment' =&gt; 'shared', 'dc' =&gt; 'sfc', 'designation' =&gt; 'app'}\ng = {'name' =&gt; 403, 'segment' =&gt; 'alpha', 'dc' =&gt; 'sfc', 'designation' =&gt; 'app'}\n\nmembers = [a,b,c,d,e,f,g]\n\nh1 = members.group_by { | gr | gr['segment'] }\np h1\n#           in h1 at key k1 put this new value\nh1.each { | k1, v1 | h1[k1] = v1.group_by { | gr | gr['dc'] } }\nputs\np h1\nh1.each { | k1, v1 | v1.each { | k2, v2 | v1[k2] = v2.group_by { | gr | gr['designation'] } } }\nputs\np h1\nh1.each { | k1, v1 | v1.each { | k2, v2 | v2.each { | k3, v3 | v2[k3] = v3.collect { | el | el['name'] } } } }\nputs '--- final result ---'\np h1\n</code></pre>\n\n<p>Maybe in Ruby 1.8 (without <code>group_by</code>) :</p>\n\n<pre><code>a = {'name' =&gt; 200, 'segment' =&gt; 'alpha',  'dc' =&gt; 'nyc', 'designation' =&gt; 'web'}\nb = {'name' =&gt; 201, 'segment' =&gt; 'shared', 'dc' =&gt; 'nyc', 'designation' =&gt; 'generic'}\nc = {'name' =&gt; 202, 'segment' =&gt; 'alpha', 'dc' =&gt; 'nyc', 'designation' =&gt; 'app'}\nd = {'name' =&gt; 400, 'segment' =&gt; 'alpha',  'dc' =&gt; 'sfc', 'designation' =&gt; 'web'}\ne = {'name' =&gt; 401, 'segment' =&gt; 'shared', 'dc' =&gt; 'sfc', 'designation' =&gt; 'web'}\nf = {'name' =&gt; 402, 'segment' =&gt; 'shared', 'dc' =&gt; 'sfc', 'designation' =&gt; 'app'}\ng = {'name' =&gt; 403, 'segment' =&gt; 'alpha', 'dc' =&gt; 'sfc', 'designation' =&gt; 'app'}\n\nmembers = [a,b,c,d,e,f,g]\n\nputs '=== without group_by ==='\n\nclass Array # reopen class Array\n    def groupedByKey(p_key)\n        new_h = {}\n\n        self.each do | el | # el must be a hash\n            key = el[p_key]\n            unless new_h[key]\n            then # the key does not exist, create a key - value pair\n                new_h[key] = [el] # the value is an array with the whole element\n            else # a key and value already exist ...\n                new_h[key] &lt;&lt; el # ... push the new value onto the array\n            end\n        end\n\n        new_h\n    end\nend # class Array\n\nh1 = members.groupedByKey('segment')\np h1\nh1.each { | k1, v1 | h1[k1] = v1.groupedByKey('dc') }\nputs\np h1\nh1.each { | k1, v1 | v1.each { | k2, v2 | v1[k2] = v2.groupedByKey('designation') } }\nputs\np h1\nh1.each { | k1, v1 | v1.each { | k2, v2 | v2.each { | k3, v3 | v2[k3] = v3.collect { | el | el['name'] } } } }\nputs '--- final result ---'\np h1\n</code></pre>\n\n<p>Execution (in 2.0) :</p>\n\n<pre><code>$ ruby -w t2.rb \n=== without group_by ===\n{\"alpha\"=&gt;[{\"name\"=&gt;200, \"segment\"=&gt;\"alpha\", \"dc\"=&gt;\"nye\",\n...\n--- final result ---\n{\"alpha\"=&gt;{\"nyc\"=&gt;{\"web\"=&gt;[200], \"app\"=&gt;[202]}, \"sfc\"=&gt;{\"web\"=&gt;[400], \"app\"=&gt;[403]}},\n\"shared\"=&gt;{\"nyc\"=&gt;{\"generic\"=&gt;[201]}, \"sfc\"=&gt;{\"web\"=&gt;[401], \"app\"=&gt;`[402]}}}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Combined with Cary's <code>Hash#transform_values</code> :</p>\n\n<pre><code>a = {'name' =&gt; 200, 'segment' =&gt; 'alpha',  'dc' =&gt; 'nyc', 'designation' =&gt; 'web'}\nb = {'name' =&gt; 201, 'segment' =&gt; 'shared', 'dc' =&gt; 'nyc', 'designation' =&gt; 'generic'}\nc = {'name' =&gt; 202, 'segment' =&gt; 'alpha', 'dc' =&gt; 'nyc', 'designation' =&gt; 'app'}\nd = {'name' =&gt; 400, 'segment' =&gt; 'alpha',  'dc' =&gt; 'sfc', 'designation' =&gt; 'web'}\ne = {'name' =&gt; 401, 'segment' =&gt; 'shared', 'dc' =&gt; 'sfc', 'designation' =&gt; 'web'}\nf = {'name' =&gt; 402, 'segment' =&gt; 'shared', 'dc' =&gt; 'sfc', 'designation' =&gt; 'app'}\ng = {'name' =&gt; 403, 'segment' =&gt; 'alpha', 'dc' =&gt; 'sfc', 'designation' =&gt; 'app'}\n\nmembers = [a,b,c,d,e,f,g]\n\nputs '=== should work in Ruby 1.8 ==='\n\nclass Array # reopen class Array\n    def groupedByKey(p_key)\n        new_h = {}\n\n        self.each do | el | # el must be a hash\n            key = el[p_key]\n            unless new_h[key]\n            then # the key does not exist, create a key - value pair\n                new_h[key] = [el] # the value is an array with the whole element\n            else # a key and value already exist ...\n                new_h[key] &lt;&lt; el # ... push the new value onto the array\n            end\n        end\n\n        new_h\n    end\nend # class Array\n\nclass Hash\n    def transformValues\n        Hash[self.collect { | k, v | [ k, yield(v) ] } ]\n    end\nend\n\n# Step by step\nh1 = members.groupedByKey('segment')\nputs '--- grouped by segment'\np h1\nh2 = h1.transformValues { | v1 | v1.groupedByKey('dc') }\nputs '--- grouped by dc'\np h2\nh2 = members.groupedByKey('segment').\n     transformValues { | v1 | v1.groupedByKey('dc').\n        transformValues { | val | val.groupedByKey('designation') } }\nputs '--- grouped by designation'\np h2\n\n# One step.\n# Note that the hash returned by each groupedByKey is immediately transformed\n# (watch the dot after groupedByKey('xxx')).\nh2 = members.groupedByKey('segment').\n     transformValues { | v1 | v1.groupedByKey('dc').\n        transformValues { | v2 | v2.groupedByKey('designation').\n            transformValues { | v3 | v3.collect { | el | el['name'] } } } }\nputs '--- final result ---'\np h2\n</code></pre>\n"}], "owner": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1508855588, "creation_date": 1508792294, "last_edit_date": 1508795315, "question_id": 46898415, "link": "https://stackoverflow.com/questions/46898415/trying-to-create-a-hash-with-depth-of-3-from-several-hashes", "title": "Trying to create a hash with depth of 3 from several hashes", "body": "<p>I am trying to take an array of hashes where each has has depth of one with multiple key, values and trying to create a new hash that incorporates all of this data.</p>\n\n<p>My Data:</p>\n\n<pre><code>a = {'name' =&gt; 200, 'segment' =&gt; 'alpha',  'dc' =&gt; 'nyc', 'designation' =&gt; 'web'}\nb = {'name' =&gt; 201, 'segment' =&gt; 'shared', 'dc' =&gt; 'nyc', 'designation' =&gt; 'generic'}\nc = {'name' =&gt; 202, 'segment' =&gt; 'alpha', 'dc' =&gt; 'nyc', 'designation' =&gt; 'app'}\nd = {'name' =&gt; 400, 'segment' =&gt; 'alpha',  'dc' =&gt; 'sfc', 'designation' =&gt; 'web'}\ne = {'name' =&gt; 401, 'segment' =&gt; 'shared', 'dc' =&gt; 'sfc', 'designation' =&gt; 'web'}\nf = {'name' =&gt; 402, 'segment' =&gt; 'shared', 'dc' =&gt; 'sfc', 'designation' =&gt; 'app'}\ng = {'name' =&gt; 403, 'segment' =&gt; 'alpha', 'dc' =&gt; 'sfc', 'designation' =&gt; 'app'}\n\nmembers = [a,b,c,d,e,f,g]\n</code></pre>\n\n<p><strong>This is what I am expecting to get:</strong></p>\n\n<pre><code>{\n  :alpha =&gt; {\n    :nyc =&gt; {\n      :web =&gt; [200],\n      :app =&gt; [202]\n    },\n    :sfc =&gt; {\n      :web =&gt; [400],\n      :app =&gt; [403],\n    }\n  },\n  :shared =&gt; {\n    :nyc =&gt; {\n       generic =&gt; [201]\n    },\n    :sfc =&gt; {\n      :app =&gt; [402],\n      :web =&gt; [401]\n    }\n  }\n}\n</code></pre>\n\n<p>This is my code (at least.. the start of it...)</p>\n\n<pre><code>members.each do |m|\n  if m.key? 'segment'\n    dict[m['segment']] = {} unless dict.key? m['segment']\n  end\n  puts m['dc']\n  if m.key? 'dc'\n    dict[m['segment']] = m['dc']\n    #dict[m['segment']['dc']] = m['segment']['dc']# unless dict[m['segment']].key? m['dc']\n  end\n</code></pre>\n\n<p>I've tried various variations of my code and <strong>I'm getting results like</strong>:</p>\n\n<pre><code>{\"alpha\"=&gt;\"sfc\", \"shared\"=&gt;\"sfc\"}\n{\"alpha\"=&gt;{\"sfc\"=&gt;{}}, \"shared\"=&gt;{\"sfc\"=&gt;{}}}\n{\"alpha\"=&gt;{\"sfc\"=&gt;{}}, nil=&gt;{\"web\"=&gt;[]}, \"shared\"=&gt;{\"sfc\"=&gt;{}}}\n</code></pre>\n\n<p>What are the buzzwords I need to be searching for to figure this out?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["ruby", "heroku", "sinatra"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1619046973, "post_id": 46898723, "comment_id": 118789891, "body": "Mlozniak What timeout mechanism on long-running actions should we use for those cases?"}], "tags": [], "owner": {"reputation": 5178, "user_id": 2577840, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1520578334/picture?type=large", "display_name": "Micha\u0142 M\u0142o\u017aniak", "link": "https://stackoverflow.com/users/2577840/micha%c5%82-m%c5%82o%c5%baniak"}, "is_accepted": true, "score": 2, "last_activity_date": 1508793546, "creation_date": 1508793546, "answer_id": 46898723, "question_id": 46898246, "link": "https://stackoverflow.com/questions/46898246/h12-request-timeout-503-on-heroku-then-200-success/46898723#46898723", "title": "H12 Request timeout 503 on heroku then 200 success", "body": "<p>Here is how it works. Heroku has 30 seconds timeout for any web request. When the new request is routed to your application dyno and there is no response within this 30 seconds time limit, Heroku is dropping the connection and reporting H12 error. But your dyno is still processing the web request, even nobody will ever use its response. The client is already gone. Because of such behavior it is recommended to put some kind of timeout mechanism on long-running actions. If you send many requests to such endpoint you can easily bring your whole application to a halt.</p>\n\n<p>The work-around to this problem is to process your images in background job. So the first request will register a new job and return its id or some kind of identifier. Then your ios app can periodically ping server using this id to check if the job has finished.</p>\n"}], "owner": {"reputation": 221, "user_id": 8238879, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b4819b2f474196fe19bd24fa5e388a8d?s=128&d=identicon&r=PG&f=1", "display_name": "Wrumble", "link": "https://stackoverflow.com/users/8238879/wrumble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 0, "accepted_answer_id": 46898723, "answer_count": 1, "score": 0, "last_activity_date": 1508793546, "creation_date": 1508791663, "question_id": 46898246, "link": "https://stackoverflow.com/questions/46898246/h12-request-timeout-503-on-heroku-then-200-success", "title": "H12 Request timeout 503 on heroku then 200 success", "body": "<p>I am running a small docker image that starts a ruby Sinatra API. Th point of the API is to receive an image, preprocess it using a script then use Tesseract OCR to return the text from the image.</p>\n\n<p>The issue I'm having is that I'm getting a 503 error then a 300 success with the text, but it's of no use as my ios app has already received the 503 error and continued on its way.</p>\n\n<pre><code>require 'sinatra'\nrequire \"json\"\nrequire 'sinatra/base'\nrequire 'sinatra'\nrequire 'json'\nrequire 'fileutils'\nrequire 'tempfile'\nrequire \"base64\"\nrequire 'puma_worker_killer'\n\nPumaWorkerKiller.enable_rolling_restart\n\nset :protection, except: [ :json_csrf ]\nport = ENV['PORT'] || 8080\nset :port, port\nset :bind, '0.0.0.0'\n\npost '/extractText' do\n  begin\n    bas64Image = Base64.decode64(params[:image])\n    imageFile = Tempfile.new(['image', '.png'])\n    imageFile.write(bas64Image)\n    imageFile.close\n    `textcleaner #{imageFile.path} #{imageFile.path}`\n    # `textdeskew #{imageFile.path} #{imageFile.path}`\n    output = `tesseract #{imageFile.path} --psm 6 --oem 2 stdout`\n    p output\n  rescue\n    status 402\n    return \"Error reading image\"\n  end\n  status 200\n  return output\nend\n</code></pre>\n\n<p>Heres the heroku read out i get:</p>\n\n<pre><code>2017-10-23T20:22:00.548029+00:00 heroku[router]: at=error code=H12 desc=\"Request timeout\" method=POST path=\"/extractText\" host=tesseractimageserver.herokuapp.com request_id=7b179829-ef1f-4e18-844b-42b90a5c5c69 fwd=\"82.32.79.208\" dyno=web.1 connect=1ms service=30945ms status=503 bytes=0 protocol=https\n2017-10-23T20:22:42.864098+00:00 app[web.1]: \"Returned text from reading image using tesseract\"\n2017-10-23T20:22:42.872633+00:00 app[web.1]: 82.32.79.208 - - [23/Oct/2017:20:22:42 +0000] \"POST /extractText HTTP/1.1\" 200 467 72.2921\n</code></pre>\n\n<p>Id there a way around this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1508791282, "post_id": 46898070, "comment_id": 80743474, "body": "Rails need to find each object you want to delete in order to run the callbacks (<code>before_</code> and <code>after_</code> destroy) on each. If you want to skip that process, which is a slippery slope, you might want to create a service object which holds all the logic about this &quot;delete all related objects&quot; and reset the association"}, {"owner": {"reputation": 1131, "user_id": 1600823, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/37f9d28d46537ac8bae09f47a4ab8488?s=128&d=identicon&r=PG", "display_name": "mp94", "link": "https://stackoverflow.com/users/1600823/mp94"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1508793716, "post_id": 46898070, "comment_id": 80744674, "body": "I think resetting the association is also not optimal, because if the association gets accessed later on, the objects will have to get refetched, even though we know what should be in the relation."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1508799694, "post_id": 46898070, "comment_id": 80746645, "body": "IMO, you should not try to reduce the SQL queries and redefine Rails&#39; behaviour. It can lead to various issues, not visible at first sight but much later when you whole app has been using it for months..."}, {"owner": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "edited": false, "score": 0, "creation_date": 1508804036, "post_id": 46898070, "comment_id": 80747641, "body": "When you say &quot;keep the association up to date&quot;, do you mean in memory? In other words: you want to execute a single <code>DELETE</code>, but at the same time also update your in-memory object without having to query the DB again?"}, {"owner": {"reputation": 1131, "user_id": 1600823, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/37f9d28d46537ac8bae09f47a4ab8488?s=128&d=identicon&r=PG", "display_name": "mp94", "link": "https://stackoverflow.com/users/1600823/mp94"}, "reply_to_user": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "edited": false, "score": 0, "creation_date": 1508810595, "post_id": 46898070, "comment_id": 80749079, "body": "@henrebotha yes, that is my intention. I want the in memory has many association to stay up to date with what&#39;s in the database."}, {"owner": {"reputation": 6251, "user_id": 145525, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dd5d3f6afa97634b647fc6c3c5703cb?s=128&d=identicon&r=PG", "display_name": "Dhruva Sagar", "link": "https://stackoverflow.com/users/145525/dhruva-sagar"}, "edited": false, "score": 0, "creation_date": 1508811231, "post_id": 46898070, "comment_id": 80749221, "body": "@mp94 A <code>reload</code> at the end of delete_all should successfully correct the in-memory association data."}, {"owner": {"reputation": 1131, "user_id": 1600823, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/37f9d28d46537ac8bae09f47a4ab8488?s=128&d=identicon&r=PG", "display_name": "mp94", "link": "https://stackoverflow.com/users/1600823/mp94"}, "edited": false, "score": 0, "creation_date": 1508813884, "post_id": 46898070, "comment_id": 80749828, "body": "It would yes, but I feel like this shouldn&#39;t be necessary because based on the queries I have ran, I have all the data already in memory, but I can&#39;t assign to the <code>has_many</code> association without doing more queries. The reload will generate a SELECT query I believe."}, {"owner": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "edited": false, "score": 1, "creation_date": 1508834278, "post_id": 46898070, "comment_id": 80758300, "body": "This is a frustratingly tricky problem! You can do <code>parent.children.replace(filtered_subset_of_children)</code>, which will execute the <code>DELETE</code> &amp; update the in-memory object at the same time (I think); but then you have to either filter the children ahead of time (in which case you&#39;re just displacing the extra queries, not removing them), or filter them in memory. Seems almost impossible to generate a true <code>DELETE WHERE foo = bar</code> that will update the cache..."}], "answers": [{"comments": [{"owner": {"reputation": 1131, "user_id": 1600823, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/37f9d28d46537ac8bae09f47a4ab8488?s=128&d=identicon&r=PG", "display_name": "mp94", "link": "https://stackoverflow.com/users/1600823/mp94"}, "edited": false, "score": 0, "creation_date": 1508810693, "post_id": 46900941, "comment_id": 80749098, "body": "The problem I am having is that, if we do something like <code>foo.statements.where(some_param: 42).delete_all</code>, <code>foo.statements</code> is no longer what is actually in the DB."}, {"owner": {"reputation": 163, "user_id": 451056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fTNA3.jpg?s=128&g=1", "display_name": "rbb", "link": "https://stackoverflow.com/users/451056/rbb"}, "reply_to_user": {"reputation": 1131, "user_id": 1600823, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/37f9d28d46537ac8bae09f47a4ab8488?s=128&d=identicon&r=PG", "display_name": "mp94", "link": "https://stackoverflow.com/users/1600823/mp94"}, "edited": false, "score": 0, "creation_date": 1508855835, "post_id": 46900941, "comment_id": 80773720, "body": "In which case, reload statements: <code>foo.statements.reload</code>"}], "tags": [], "owner": {"reputation": 163, "user_id": 451056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fTNA3.jpg?s=128&g=1", "display_name": "rbb", "link": "https://stackoverflow.com/users/451056/rbb"}, "is_accepted": false, "score": 1, "last_activity_date": 1508809423, "creation_date": 1508809423, "answer_id": 46900941, "question_id": 46898070, "link": "https://stackoverflow.com/questions/46898070/remove-records-from-has-many-rails-association-with-a-single-query/46900941#46900941", "title": "Remove records from has_many Rails association with a single query", "body": "<p>There are two methods to delete records from a relation. <code>destroy</code> deletes all the related records one at a time, running the callbacks on each deleted record. <code>delete_all</code> deletes all the records in one query and does not run the callbacks.</p>\n\n<p>So, in a model you could have:</p>\n\n<pre><code>class Customer &lt; ApplicationRecord\n  has_many :statements, dependent: :delete_all\n</code></pre>\n\n<p>and when you delete the customer</p>\n\n<pre><code>pry(main) foo = Customer.first\npry(main)&gt; foo.destroy\n  (0.3ms)  BEGIN\n  SQL (290.4ms)  DELETE FROM `statements` WHERE `statements`.`customer_id` = 3\n  SQL (2.6ms)  DELETE FROM `customers` WHERE `customers`.`id` = 3\n</code></pre>\n\n<p>All done in one swell foop, no callbacks on the deleted.</p>\n\n<p>or -</p>\n\n<pre><code>class Customer &lt; ApplicationRecord\n  has_many :statements, dependent: :destroy\n</code></pre>\n\n<p>and when you delete the customer</p>\n\n<pre><code>pry(main) foo = Customer.first\npry(main)&gt; foo.destroy\n  (0.4ms)  BEGIN\n  Statement Load (25.0ms)  SELECT `statements`.* FROM `statements` WHERE `statements`.`customer_id` = 4\n  SQL (0.5ms)  DELETE FROM `statements` WHERE `statements`.`id` = 9023\n  SQL (0.3ms)  DELETE FROM `statements` WHERE `statements`.`id` = 9024\n  SQL (0.3ms)  DELETE FROM `statements` WHERE `statements`.`id` = 9025\n  . . . etc etc etc . . .\n</code></pre>\n\n<p>Each dependent record deleted one at a time, callbacks run on each deleted.</p>\n\n<p>And <code>delete_all</code> and <code>destroy</code> can be run on any result set with similar effects. So if you wanted to have some filter on the related records:</p>\n\n<pre><code>pry(main) foo = Customer.first\npry(main)&gt; bar = foo.statements.where(some_param: 42)\npry(main)&gt; bar.delete_all\n  SQL (4.2ms)  DELETE FROM `statements` WHERE `statements`.`customer_id` = 7 AND `notices`.`some_param` = 42\n=&gt; 2\n</code></pre>\n\n<p>or -</p>\n\n<pre><code>pry(main) foo = Customer.first\npry(main)&gt; bar = foo.statements.where(some_param: 42)\npry(main)&gt; bar.destroy_all\n   (0.2ms)  BEGIN\n  SQL (0.6ms)  DELETE FROM `notices` WHERE `notices`.`id` = 4639\n   (0.5ms)  COMMIT\n   (0.2ms)  BEGIN\n  SQL (0.5ms)  DELETE FROM `notices` WHERE `notices`.`id` = 4640\n   (0.4ms)  COMMIT\n   (0.1ms)  BEGIN\n  SQL (0.5ms)  DELETE FROM `notices` WHERE `notices`.`id` = 4641\n   (0.5ms)  COMMIT\n  . . . etc etc etc . . .\n</code></pre>\n"}], "owner": {"reputation": 1131, "user_id": 1600823, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/37f9d28d46537ac8bae09f47a4ab8488?s=128&d=identicon&r=PG", "display_name": "mp94", "link": "https://stackoverflow.com/users/1600823/mp94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2203, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1508809423, "creation_date": 1508790971, "question_id": 46898070, "link": "https://stackoverflow.com/questions/46898070/remove-records-from-has-many-rails-association-with-a-single-query", "title": "Remove records from has_many Rails association with a single query", "body": "<p>I'm having trouble removing records from a has_many association in Rails without triggering unnecessary queries. Essentially, I have a model which has a has_many relation on it, and I want to remove multiple records from it based on some criteria. I want to be able to simultaneously keep the association up to date, but also remove the records from the database, and only require one DELETE query to do this. I've tried assigning to the relation with the new objects (which generates unnecessary UPDATE queries) and calling delete_all (which makes one query but doesn't update the association).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "url", "devise", "routes"], "answers": [{"tags": [], "owner": {"reputation": 1296, "user_id": 8377250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3705bb7e15384ec8a6b41f60d59b3e10?s=128&d=identicon&r=PG&f=1", "display_name": "mindlis", "link": "https://stackoverflow.com/users/8377250/mindlis"}, "is_accepted": true, "score": 2, "last_activity_date": 1508805042, "creation_date": 1508805042, "answer_id": 46900434, "question_id": 46898046, "link": "https://stackoverflow.com/questions/46898046/customize-devise-pathnames/46900434#46900434", "title": "Customize Devise pathnames", "body": "<p>From the <a href=\"https://github.com/plataformatec/devise/wiki/How-To:-Change-the-default-sign_in-and-sign_out-routes\" rel=\"nofollow noreferrer\">documentation</a>, it looks like you can use a block to more define the routes as you would normally.</p>\n\n<pre><code>devise_for :users, skip: [:sessions, ...]\nas :user do\n  get 'login', to: 'sessions#new', as: :new_user_session\n  get 'logout', to: 'sessions#destroy', as: :destroy_user_session\n  ...\nend\n</code></pre>\n"}], "owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "accepted_answer_id": 46900434, "answer_count": 1, "score": 2, "last_activity_date": 1508805042, "creation_date": 1508790886, "question_id": 46898046, "link": "https://stackoverflow.com/questions/46898046/customize-devise-pathnames", "title": "Customize Devise pathnames", "body": "<p>I am trying to customize the urls created by the devise gem:</p>\n\n<pre><code>devise_for :users, path: '', path_names: {\n    sign_in: 'login',\n    sign_out: 'logout',\n    sign_up: 'signup',\n    password: 'forgot',\n    confirmation: 'activate',\n    invitation: 'invite'\n}\n</code></pre>\n\n<p>This works well. It creates the following routes:</p>\n\n<pre><code>/login -&gt; sessions#new\n/logout -&gt; sessions#destroy\n/signup -&gt; registrations#new\n/forgot/new -&gt; passwords#new\n/forgot/edit -&gt; passwords#edit\n/activate/new -&gt; confirmations#new\n/activate/show -&gt; confirmations#show\n/invite/new -&gt; invitations#new\n/invite/accept -&gt; invitations#edit\n/invite/remove -&gt; invitations#destroy\n</code></pre>\n\n<p>But instead I want to achieve something like this:</p>\n\n<pre><code>/login -&gt; sessions#new\n/logout -&gt; sessions#destroy\n/signup -&gt; registrations#new\n/forgot -&gt; passwords#new\n/recover -&gt; passwords#edit\n/activate -&gt; confirmations#new\n/confirm -&gt; confirmations#show\n/invite -&gt; invitations#new\n/invite/accept -&gt; invitations#edit\n/invite/remove -&gt; invitations#destroy\n</code></pre>\n\n<p>How can change the path names of the unique controller methods with devise (without manually rewriting them all together with a custom controller)?</p>\n"}]