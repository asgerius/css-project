[{"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2306, "user_id": 1741654, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0401af2dd09da09b304326e4396d1d78?s=128&d=identicon&r=PG", "display_name": "rmosolgo", "link": "https://stackoverflow.com/users/1741654/rmosolgo"}, "edited": false, "score": 1, "creation_date": 1466033069, "post_id": 37847428, "comment_id": 63154728, "body": "I don&#39;t understand what you mean by &quot;A -&gt; B&quot; or &quot;B -&gt; A&quot;, can you explain it another way?"}, {"owner": {"reputation": 1, "user_id": 6471971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Da2-Ekc6djk/AAAAAAAAAAI/AAAAAAAAABE/DTGLqoP6qZQ/photo.jpg?sz=128", "display_name": "Vanhensy", "link": "https://stackoverflow.com/users/6471971/vanhensy"}, "reply_to_user": {"reputation": 2306, "user_id": 1741654, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0401af2dd09da09b304326e4396d1d78?s=128&d=identicon&r=PG", "display_name": "rmosolgo", "link": "https://stackoverflow.com/users/1741654/rmosolgo"}, "edited": false, "score": 0, "creation_date": 1466033641, "post_id": 37847428, "comment_id": 63154865, "body": "Thank you for your reply. I mean person A can create order to person B and vice versa."}, {"owner": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "edited": false, "score": 1, "creation_date": 1466035420, "post_id": 37847428, "comment_id": 63155301, "body": "Can you clarify what you mean by &quot;filter Order to unique record?&quot; Are you looking for a query that returns, say, all orders made by user A where the target is user B?"}, {"owner": {"reputation": 1, "user_id": 6471971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Da2-Ekc6djk/AAAAAAAAAAI/AAAAAAAAABE/DTGLqoP6qZQ/photo.jpg?sz=128", "display_name": "Vanhensy", "link": "https://stackoverflow.com/users/6471971/vanhensy"}, "reply_to_user": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "edited": false, "score": 0, "creation_date": 1466035702, "post_id": 37847428, "comment_id": 63155361, "body": "@jmschles I mean it&#39;ll return only one order that made between user A and user B ( even if user A send many order to user B and user B aslo make order for user A)"}, {"owner": {"reputation": 7922, "user_id": 2747593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cdcEd.jpg?s=128&g=1", "display_name": "Scott Weldon", "link": "https://stackoverflow.com/users/2747593/scott-weldon"}, "edited": false, "score": 0, "creation_date": 1466036269, "post_id": 37847428, "comment_id": 63155463, "body": "Welcome to Stack Overflow! To make it easier for other users to help you, please include some code, preferably in the form of a <a href=\"//stackoverflow.com/help/mcve\">Minimum, Complete, Verifiable Example</a>. See also <a href=\"//stackoverflow.com/help/how-to-ask\">How to Ask</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6471971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Da2-Ekc6djk/AAAAAAAAAAI/AAAAAAAAABE/DTGLqoP6qZQ/photo.jpg?sz=128", "display_name": "Vanhensy", "link": "https://stackoverflow.com/users/6471971/vanhensy"}, "edited": false, "score": 0, "creation_date": 1466036237, "post_id": 37847806, "comment_id": 63155456, "body": "This query will not return unique record. I used:  <code>Order.uniq.pluck(:user_id, :target_id)</code>  which return:  <code>[[1,2],[1,14],[3,5],[1,23],[2,1],...]</code>  So Is there any way that I can query the unique order using this array ?!"}, {"owner": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "reply_to_user": {"reputation": 1, "user_id": 6471971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Da2-Ekc6djk/AAAAAAAAAAI/AAAAAAAAABE/DTGLqoP6qZQ/photo.jpg?sz=128", "display_name": "Vanhensy", "link": "https://stackoverflow.com/users/6471971/vanhensy"}, "edited": false, "score": 0, "creation_date": 1466036583, "post_id": 37847806, "comment_id": 63155524, "body": "I&#39;m still having trouble understanding what you mean by &quot;unique record&quot;. It sounds like you&#39;re saying there could be multiple orders with the same user and target. So let&#39;s say your query above returned <code>[[1,2],[1,2]]</code>. If you want to query for one or the other, you need a field that differentiates them somehow. Otherwise you just have to do something arbitrary like grab the first or last one."}, {"owner": {"reputation": 1, "user_id": 6471971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Da2-Ekc6djk/AAAAAAAAAAI/AAAAAAAAABE/DTGLqoP6qZQ/photo.jpg?sz=128", "display_name": "Vanhensy", "link": "https://stackoverflow.com/users/6471971/vanhensy"}, "edited": false, "score": 0, "creation_date": 1466036640, "post_id": 37847806, "comment_id": 63155542, "body": "Hmmm... As your new update. So what if the Order that have (user_id: B, target_id: A) ?! It&#39;will return another record right ?!"}, {"owner": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "reply_to_user": {"reputation": 1, "user_id": 6471971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Da2-Ekc6djk/AAAAAAAAAAI/AAAAAAAAABE/DTGLqoP6qZQ/photo.jpg?sz=128", "display_name": "Vanhensy", "link": "https://stackoverflow.com/users/6471971/vanhensy"}, "edited": false, "score": 0, "creation_date": 1466036685, "post_id": 37847806, "comment_id": 63155549, "body": "Yup, that&#39;s a different query and will only return orders where the user is B and the target is A."}, {"owner": {"reputation": 1, "user_id": 6471971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Da2-Ekc6djk/AAAAAAAAAAI/AAAAAAAAABE/DTGLqoP6qZQ/photo.jpg?sz=128", "display_name": "Vanhensy", "link": "https://stackoverflow.com/users/6471971/vanhensy"}, "edited": false, "score": 0, "creation_date": 1466036873, "post_id": 37847806, "comment_id": 63155598, "body": "Ok. To be clearer. My project helps user A get phone number of user B and user B also can get phone number of user A (some kind of matching people). I build a dashboard to check that they are matching or not. As you see, whether the order from A or B or how many time they made order, it&#39;s just a connection between 2 people. That&#39;s why I want to get a unique record"}], "tags": [], "owner": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "is_accepted": false, "score": 0, "last_activity_date": 1466099134, "last_edit_date": 1466099134, "creation_date": 1466035852, "answer_id": 37847806, "question_id": 37847428, "link": "https://stackoverflow.com/questions/37847428/how-to-get-unique-record-by-multi-attributes/37847806#37847806", "title": "How to get unique record by multi-attributes", "body": "<p>Okay, assuming you have users A and B, you should just be able to do this:</p>\n\n<pre><code>Order.where(user: A, target: B)\n</code></pre>\n\n<p>...assuming you've defined your associations, otherwise:</p>\n\n<pre><code>Order.where(user_id: A.id, target_id: B.id)\n</code></pre>\n\n<p>EDIT: just saw your comment. You could add <code>.first</code> to either of the above queries just to get the first order if you wanted to.</p>\n\n<p>ANOTHER EDIT: As I understand it, if there's ever been one or more orders between A and B (or B and A), you want to grab one of them, and you don't care which. You could do this:</p>\n\n<pre><code>(Order.where(user: A, target: B) + Order.where(user: B, target: A)).first\n</code></pre>\n\n<p>That will give you a record if one exists and <code>nil</code> if it doesn't.  Raw SQL would be more efficient:</p>\n\n<pre><code>Order.where(\"user_id = ? AND target_id = ? OR user_id = ? AND target_id = ?\", A.id, B.id, B.id, A.id).first\n</code></pre>\n\n<p>... but less readable, and be sure to test it. Good luck!</p>\n"}], "owner": {"reputation": 1, "user_id": 6471971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Da2-Ekc6djk/AAAAAAAAAAI/AAAAAAAAABE/DTGLqoP6qZQ/photo.jpg?sz=128", "display_name": "Vanhensy", "link": "https://stackoverflow.com/users/6471971/vanhensy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466099134, "creation_date": 1466032934, "last_edit_date": 1466033680, "question_id": 37847428, "link": "https://stackoverflow.com/questions/37847428/how-to-get-unique-record-by-multi-attributes", "title": "How to get unique record by multi-attributes", "body": "<p>I have a model like this:\n    Order(id: integer, user_id: integer, target_id: integer, content: string, created_at: datetime, updated_at: datetime) </p>\n\n<p>It belongs to User. User can make order for each other like:</p>\n\n<ul>\n<li>person A -> person B</li>\n<li>person B -> person A </li>\n<li>person A -> person B</li>\n</ul>\n\n<p>=> The unique record should be A -> B, so how can I filter Order to unique record ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "omniauth"], "comments": [{"owner": {"reputation": 31711, "user_id": 634576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/48891dab622b535f3c2b4ec1c8765bed?s=128&d=identicon&r=PG", "display_name": "Dave Schweisguth", "link": "https://stackoverflow.com/users/634576/dave-schweisguth"}, "edited": false, "score": 0, "creation_date": 1466083588, "post_id": 37847397, "comment_id": 63178358, "body": "This is a little too big and broad for me to read and understand. Can you point out a specific line or lines that you want to cover?"}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 31711, "user_id": 634576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/48891dab622b535f3c2b4ec1c8765bed?s=128&d=identicon&r=PG", "display_name": "Dave Schweisguth", "link": "https://stackoverflow.com/users/634576/dave-schweisguth"}, "edited": false, "score": 0, "creation_date": 1466089855, "post_id": 37847397, "comment_id": 63183221, "body": "@DaveSchweisguth I have updated the question with coverage issues."}, {"owner": {"reputation": 6620, "user_id": 3238292, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74e9b06481e2c4b20d7369e62b39a369?s=128&d=identicon&r=PG", "display_name": "sealocal", "link": "https://stackoverflow.com/users/3238292/sealocal"}, "edited": false, "score": 0, "creation_date": 1466184589, "post_id": 37847397, "comment_id": 63229168, "body": "So, your image there is your test coverage? Is the <code>token_expired?</code> method covered? In other words, is <code>Time.now &gt; token_expires_at</code> green? It&#39;s not visible in your image."}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 6620, "user_id": 3238292, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74e9b06481e2c4b20d7369e62b39a369?s=128&d=identicon&r=PG", "display_name": "sealocal", "link": "https://stackoverflow.com/users/3238292/sealocal"}, "edited": false, "score": 0, "creation_date": 1466184691, "post_id": 37847397, "comment_id": 63229213, "body": "I have test coverage on that method, but the others are not @sealocal"}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 6620, "user_id": 3238292, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74e9b06481e2c4b20d7369e62b39a369?s=128&d=identicon&r=PG", "display_name": "sealocal", "link": "https://stackoverflow.com/users/3238292/sealocal"}, "edited": false, "score": 0, "creation_date": 1466184911, "post_id": 37847397, "comment_id": 63229308, "body": "@sealocal from my research I have to stub | mock and I am pulling my hair out"}, {"owner": {"reputation": 6620, "user_id": 3238292, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74e9b06481e2c4b20d7369e62b39a369?s=128&d=identicon&r=PG", "display_name": "sealocal", "link": "https://stackoverflow.com/users/3238292/sealocal"}, "edited": false, "score": 0, "creation_date": 1466185323, "post_id": 37847397, "comment_id": 63229539, "body": "Well, you&#39;ve explicitly called <code>user.token_expired?</code>, so it makes sense that it&#39;s covered. I&#39;m guessing that you&#39;ve included the <code>OmittedOmniAuthentication</code> module in your User model? So, I would try adding another <code>describe</code> block like <code>describe &#39;#refresh_token?&#39; do</code> and add a spec that calls <code>refresh_token?</code> on your <code>user</code> instance.  Maybe that&#39;s in conflict with the approach you desire?"}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 6620, "user_id": 3238292, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74e9b06481e2c4b20d7369e62b39a369?s=128&d=identicon&r=PG", "display_name": "sealocal", "link": "https://stackoverflow.com/users/3238292/sealocal"}, "edited": false, "score": 0, "creation_date": 1466186246, "post_id": 37847397, "comment_id": 63229979, "body": "@sealocal I get that in theory, but do you have an example that would mock this out? I am not 100% sure as to what you are pointing too, thank you so much for your help"}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 6620, "user_id": 3238292, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74e9b06481e2c4b20d7369e62b39a369?s=128&d=identicon&r=PG", "display_name": "sealocal", "link": "https://stackoverflow.com/users/3238292/sealocal"}, "edited": false, "score": 0, "creation_date": 1466186276, "post_id": 37847397, "comment_id": 63229997, "body": "@sealocal I also, want to make sure to give you credit for helping"}], "answers": [{"comments": [{"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1466211900, "post_id": 37888617, "comment_id": 63238945, "body": "I am in the final stretch + I just made some major edits.  Thoughts on getting to 100%?"}, {"owner": {"reputation": 6620, "user_id": 3238292, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74e9b06481e2c4b20d7369e62b39a369?s=128&d=identicon&r=PG", "display_name": "sealocal", "link": "https://stackoverflow.com/users/3238292/sealocal"}, "reply_to_user": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1466213435, "post_id": 37888617, "comment_id": 63239180, "body": "It looks like for every test that calls <code>refresh_access_token!</code>, you&#39;ve either stubbed that method, or stubbed the <code>user.result</code>, so the <code>refresh_access_token!</code> method never fully executes.  You could write a describe block for the <code>refresh_access_token!</code>. Perhaps for one test in the describe block you could test the successful condition and for the other you could stub the result as the error that you are rescuing."}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1466214303, "post_id": 37888617, "comment_id": 63239294, "body": "ok, maybe I am lost here @sealocal, how would I write what you are saying?"}, {"owner": {"reputation": 6620, "user_id": 3238292, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74e9b06481e2c4b20d7369e62b39a369?s=128&d=identicon&r=PG", "display_name": "sealocal", "link": "https://stackoverflow.com/users/3238292/sealocal"}, "reply_to_user": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1466218012, "post_id": 37888617, "comment_id": 63239816, "body": "I added the code example for unit testing your <code>refresh_access_token!</code> method."}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1466313144, "post_id": 37888617, "comment_id": 63260985, "body": "I tried your examples and still not hitting 100%. I updated my example to the latest as well under &quot;updated&quot; above. When I tried the <code>expect(user.refresh_access_token!).to be_truthy</code> it failed b/c the method returned false? I am still hacking on this.  Thoughts?"}, {"owner": {"reputation": 6620, "user_id": 3238292, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74e9b06481e2c4b20d7369e62b39a369?s=128&d=identicon&r=PG", "display_name": "sealocal", "link": "https://stackoverflow.com/users/3238292/sealocal"}, "reply_to_user": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1466315283, "post_id": 37888617, "comment_id": 63261271, "body": "There&#39;s only three main lines in your refresh_access_token! method. Either the first line is returning false or the save is returning false. You can use save! to raise an error instead of return false, which will more quickly tell you if your user instance is invalid upon save. You should see the error as output from your test run. If your user is valid, then determine why the first line is returning false. Perhaps you insert puts lines to output the state of variables and the method return value."}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1466370667, "post_id": 37888617, "comment_id": 63275646, "body": "thank you for your help. I gave you credit for this answer and please check out my final update. It was the stub chain that I needed to get the method to reach 100%."}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1467144651, "post_id": 37888617, "comment_id": 63607184, "body": "I have a follow up to this <a href=\"http://stackoverflow.com/questions/38085404/rails-4-oauth-model-concern-test-coverage-stubs\" title=\"rails 4 oauth model concern test coverage stubs\">stackoverflow.com/questions/38085404/&hellip;</a> I was wondering if you could offer insight on?"}], "tags": [], "owner": {"reputation": 6620, "user_id": 3238292, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74e9b06481e2c4b20d7369e62b39a369?s=128&d=identicon&r=PG", "display_name": "sealocal", "link": "https://stackoverflow.com/users/3238292/sealocal"}, "is_accepted": true, "score": 0, "last_activity_date": 1466228445, "last_edit_date": 1466228445, "creation_date": 1466189959, "answer_id": 37888617, "question_id": 37847397, "link": "https://stackoverflow.com/questions/37847397/achieving-100-test-coverage-in-rails-oauth-using-rspec-stubs-and-mocks/37888617#37888617", "title": "Achieving 100% test coverage in Rails Oauth using Rspec stubs and mocks", "body": "<p>I'm not sure where you might be calling the external provider, so I'm not sure what you want to stub/mock.</p>\n\n<p>To get you a little closer to your coverage goal, try adding another spec for your simplest module methods:</p>\n\n<pre><code>  describe '#refresh_token!' do\n    it 'is true if there is an access_token' do\n      if !user.access_token?\n        expect(user.refresh_token!).to be_truthy\n      end\n    end\n\n    # Do you have factories or fixtures set up that can force\n    # #access_token? to be falsey?\n    it 'is false if there is no access_token' do\n      if !user.access_token?\n        expect(user.refresh_token!).to be_falsey\n      end\n    end\n\n    # Maybe you want to set the falsey value for the access_token\n    # as you have have for the value of token_expires_at in\n    # your #token_expired? test.\n    it 'is false if there is no access_token' do\n      # You should be able to force the method to return a false\n      # value (stub the method) with this line\n      allow(user).to receive(:access_token) { false }\n      expect(user.refresh_token!).to be_falsey\n    end\n  end\n</code></pre>\n\n<p>This example feels a little unnecessary since your <code>access_token</code> method appears that it will never return false. I would expect that your <code>access_token</code> method will always return an object, or an error, so your <code>refresh_token!</code> method would never encounter a falsey condition in the ternary. Maybe you should instead rescue and return false.</p>\n\n<p>Regardless, I think the point is that you should stub the method with the <code>allow</code> method, and that will get you on your way to figuring out your method stubs. Hope it helps somewhat.</p>\n\n<p>For <code>refresh_access_token!</code> you can unit test the method by stubbing the <code>user.result</code> method with an error, and not stubbing for the \"successful\" result of the <code>refresh_access_token!</code> method.</p>\n\n<pre><code>  describe '#refresh_access_token!' do\n    it 'it returns true when refreshed' do\n      # The successful control flow path for this method\n      # is to save the user and return true.\n      # I suppose this would happen smoothly in your tests and app.\n      expect(user.refresh_access_token!).to be_truthy\n    end\n\n    it 'returns false when an OAuth2 Error is rescued' do\n      # To force the case that you receive an OAuth2 Error,\n      # stub the user's access_token return value with the Error\n      # The refresh_access_token! method should then rescue the error\n      # and cover the false return value of the method\n      allow(user).to receive(:access_token) { OAuth2::Error }\n      expect(user.refresh_access_token!).to be_falsey\n    end\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "is_accepted": false, "score": 0, "last_activity_date": 1520289938, "creation_date": 1520289938, "answer_id": 49120746, "question_id": 37847397, "link": "https://stackoverflow.com/questions/37847397/achieving-100-test-coverage-in-rails-oauth-using-rspec-stubs-and-mocks/49120746#49120746", "title": "Achieving 100% test coverage in Rails Oauth using Rspec stubs and mocks", "body": "<p><em>(Posted solution on behalf of the question author)</em>.</p>\n\n<p>This is now working. With the following spec adjustment stubbing the method chain I was able to get a successful call of <code>true</code> for the method:</p>\n\n<pre><code>  def refresh_access_token!\n    result = access_token.refresh!\n    store_token(result)\n    save\n  rescue OAuth2::Error\n    false\n  end\n</code></pre>\n\n<p>The completed spec that pushed me to 100%</p>\n\n<pre><code>it 'true when refreshed' do\n  auth_token = OpenStruct.new(token: FFaker::Lorem.characters(50),\n                              refresh_token: FFaker::Lorem.characters(50),\n                              expires_at: 5.days.from_now)\n  allow(user).to receive_message_chain('access_token.refresh!') { auth_token }\n  expect(user.refresh_access_token!).to be_truthy\nend\n</code></pre>\n\n<p>Stubs and Mocks can be fun. I learned a ton from this thread.  Here are the <a href=\"https://relishapp.com/rspec/rspec-mocks/docs/working-with-legacy-code/message-chains\" rel=\"nofollow noreferrer\">Rspec 3.4 docs on this</a>.</p>\n"}], "owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 37888617, "answer_count": 2, "score": 0, "last_activity_date": 1520290064, "creation_date": 1466032707, "last_edit_date": 1520290064, "question_id": 37847397, "link": "https://stackoverflow.com/questions/37847397/achieving-100-test-coverage-in-rails-oauth-using-rspec-stubs-and-mocks", "title": "Achieving 100% test coverage in Rails Oauth using Rspec stubs and mocks", "body": "<p>I am trying to figure out a way to stub/mock the access token calls to provide coverage to methods called when a user's token has expired.  The more guides I read on this issue the more I get confused.  I do not want to call the external provider, and I want to confirm the methods report 100% coverage in case a developer modifies them and they work incorrectly.  What should I add to the spec below to make it reach our testing goal of 100%? </p>\n\n<p>The <code>load_json_fixture('omitted_oauth')</code> brings in a JSON fixture based on what the initial Oauth call returns.</p>\n\n<p><strong>Model Concern</strong></p>\n\n<pre><code>module OmittedOmniAuthentication\n  extend ActiveSupport::Concern\n\n  module ClassMethods\n    def from_omniauth(auth)\n      Rails.logger.debug auth.inspect\n      where(provider: auth.provider, uid: auth.uid).first_or_create do |user|\n        setup_user(user, auth)\n      end\n    end\n\n    def setup_user(user, auth)\n      user.provider = auth.provider\n      user.uid = auth.uid\n      user.email = auth.info.email\n      user.customer_ids = auth.extra.raw_info.customer_ids\n      user.store_token(auth.credentials)\n    end\n  end\n\n  def refresh_token!\n    access_token ? refresh_access_token! : false\n  end\n\n  def refresh_access_token!\n    result = access_token.refresh!\n    store_token(result)\n    save\n  rescue OAuth2::Error\n    false\n  end\n\n  def settings\n    @settings ||= Devise.omniauth_configs[:omitted].strategy\n  end\n\n  def strategy\n    @strategy ||= OmniAuth::Strategies::Omitted.new(nil, settings.client_id, settings.client_secret, client_options: settings.client_options)\n  end\n\n  def client\n    @client ||= strategy.client\n  end\n\n  def access_token\n    OAuth2::AccessToken.new(client, token, refresh_token: refresh_token)\n  end\n\n  def store_token(auth_token)\n    self.token = auth_token.token\n    self.refresh_token = auth_token.refresh_token\n    self.token_expires_at = Time.at(auth_token.expires_at).to_datetime\n  end\n\n  def token_expired?\n    Time.now &gt; token_expires_at\n  end\nend\n</code></pre>\n\n<p><strong>Rspec Spec</strong></p>\n\n<pre><code>RSpec.describe 'OmittedOmniAuthentication', type: :concern do\n  let(:klass) { User }\n  let(:user) { create(:user) }\n  let(:user_oauth_json_response) do\n    unfiltered_oauth_packet = load_json_fixture('omitted_oauth')\n    unfiltered_oauth_packet['provider'] = unfiltered_oauth_packet['provider'].to_sym\n    unfiltered_oauth_packet['uid'] = unfiltered_oauth_packet['uid'].to_i\n    unfiltered_oauth_packet\n  end\n\n  before do\n    OmniAuth.config.test_mode = true\n    OmniAuth.config.mock_auth[:omitted] = OmniAuth::AuthHash.new(\n      user_oauth_json_response,\n      credentials: { token: ENV['OMITTED_CLIENT_ID'], secret: ENV['OMITTED_CLIENT_SECRET'] }\n    )\n  end\n\n  describe \"#from_omniauth\" do\n    let(:omitted_oauth){ OmniAuth.config.mock_auth[:omitted] }\n\n    it 'returns varying oauth related data for Bigcartel OAuth response' do\n      data = klass.from_omniauth(omitted_oauth)\n      expect(data[:provider]).to eq(user_oauth_json_response['provider'].to_s)\n      expect(data[:uid]).to eq(user_oauth_json_response['uid'].to_s)\n      expect(data[:email]).to eq(user_oauth_json_response['info']['email'])\n      expect(data[:customer_ids]).to eq(user_oauth_json_response['extra']['raw_info']['customer_ids'])\n    end\n  end\n\n  describe '#token expired?' do\n    it 'true if valid' do\n      expect(user.token_expired?).to be_falsey\n    end\n\n    it 'false if expired' do\n      user.token_expires_at = 10.days.ago\n      expect(user.token_expired?).to be_truthy\n    end\n  end\nend\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/woPWE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/woPWE.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>UPDATE</strong></p>\n\n<pre><code>  describe '#refresh_access_token!' do\n    it 'false if OAuth2 Fails' do\n      allow(user).to receive(:result).and_raise(OAuth2::Error)\n      expect(user.refresh_access_token!).to be_falsey\n    end\n\n    it 'false if refresh fails' do\n      allow(user).to receive(:access_token) { true }\n      allow(user).to receive(:refresh_access_token!) { false }\n      expect(user.refresh_token!).to be_falsey\n    end\n\n    it 'true if new token' do\n      allow(user).to receive(:access_token) { true }\n      allow(user).to receive(:refresh_access_token!) { true }\n      expect(user.refresh_token!).to be_truthy\n    end\n\n    it 'true when refreshed' do\n      allow(user).to receive(:access_token) { true }\n      allow(user).to receive(:refresh_access_token!) { true }\n      allow(user).to receive(:store_token) { true }\n      allow(user).to receive(:save) { true }\n      expect(user.refresh_access_token!).to be_truthy\n    end\n  end\n</code></pre>\n\n<p><code>=&gt;</code> <strong>I was able to get to 94.12% with these updates</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/CiSYu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CiSYu.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-cloudformation"], "answers": [{"tags": [], "owner": {"reputation": 7160, "user_id": 250993, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uep8d.jpg?s=128&g=1", "display_name": "joslinm", "link": "https://stackoverflow.com/users/250993/joslinm"}, "is_accepted": false, "score": 2, "last_activity_date": 1466093583, "last_edit_date": 1466093583, "creation_date": 1466032686, "answer_id": 37847395, "question_id": 37847394, "link": "https://stackoverflow.com/questions/37847394/how-to-wait-for-cloudformation-stack-to-update-with-ruby/37847395#37847395", "title": "How to wait for CloudFormation stack to update with Ruby?", "body": "<p>The waiter passes an updated <a href=\"http://docs.aws.amazon.com/sdkforruby/api/Aws/CloudFormation/Stack.html#stack_status-instance_method\" rel=\"nofollow\">Stack</a> instance into the given block every <code>delay</code> seconds for <code>max_attempts</code>.</p>\n\n<pre><code># @client is your client\nstack = Aws::CloudFormation::Stack.new(name, :client =&gt; @client)\nstack(stage).wait_until({delay: 15, max_attempts: 20}) do |i|\n  i.stack_status == 'STACK_UPDATE_COMPLETE' \nend\n</code></pre>\n"}], "owner": {"reputation": 7160, "user_id": 250993, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uep8d.jpg?s=128&g=1", "display_name": "joslinm", "link": "https://stackoverflow.com/users/250993/joslinm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466093583, "creation_date": 1466032686, "question_id": 37847394, "link": "https://stackoverflow.com/questions/37847394/how-to-wait-for-cloudformation-stack-to-update-with-ruby", "title": "How to wait for CloudFormation stack to update with Ruby?", "body": "<p>Given that you're using the AWS Ruby SDK (2.0), how to wait for a CloudFormation stack to update?</p>\n"}, {"tags": ["ruby", "rspec", "chef-infra", "test-kitchen", "serverspec"], "comments": [{"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1466035119, "post_id": 37847358, "comment_id": 63155249, "body": "Try checking the output: <code>its(:stdout) { should eq &#39;&#39; }</code> and similar to stderr. That will display them from the rspec output."}, {"owner": {"reputation": 6202, "user_id": 1066615, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iv68W.png?s=128&g=1", "display_name": "sixty4bit", "link": "https://stackoverflow.com/users/1066615/sixty4bit"}, "reply_to_user": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1466035256, "post_id": 37847358, "comment_id": 63155275, "body": "@coderanger I just realized (haven&#39;t added to OP yet) that when serverspec runs the command the <code>$PATH</code> variable is different. I changed the command to <code>&#47;home&#47;ec2-user&#47;.rbenv&#47;rbenv versions</code> and the test passed. Any idea what I need to do to make the paths work correctly here?"}, {"owner": {"reputation": 6202, "user_id": 1066615, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iv68W.png?s=128&g=1", "display_name": "sixty4bit", "link": "https://stackoverflow.com/users/1066615/sixty4bit"}, "reply_to_user": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1466035934, "post_id": 37847358, "comment_id": 63155406, "body": "ok so I&#39;ve finally figured out serverspec is running the tests as <code>root</code> user...so the changes I made to <code>ec2-user</code>&#39;s <code>$PATH</code> aren&#39;t accessible..."}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1466039184, "post_id": 37847358, "comment_id": 63156093, "body": "That is correct, kitchen expects to run everything as root to keep things standardized."}, {"owner": {"reputation": 6202, "user_id": 1066615, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iv68W.png?s=128&g=1", "display_name": "sixty4bit", "link": "https://stackoverflow.com/users/1066615/sixty4bit"}, "reply_to_user": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1466039842, "post_id": 37847358, "comment_id": 63156259, "body": "thanks @coderanger. do you know of another solution besides <code>runuser</code> that I&#39;ve added to the end of the OP, or is that the best?"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1466041826, "post_id": 37847358, "comment_id": 63156697, "body": "I usually use some form of <code>sudo</code>, but that&#39;s just laziness."}], "answers": [{"tags": [], "owner": {"reputation": 6202, "user_id": 1066615, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iv68W.png?s=128&g=1", "display_name": "sixty4bit", "link": "https://stackoverflow.com/users/1066615/sixty4bit"}, "is_accepted": true, "score": 1, "last_activity_date": 1466088770, "last_edit_date": 1466088770, "creation_date": 1466081623, "answer_id": 37859846, "question_id": 37847358, "link": "https://stackoverflow.com/questions/37847358/chef-kitchen-kitchen-ec2-serverspec-spec-failing-and-causing-error/37859846#37859846", "title": "Chef Kitchen (kitchen-ec2) serverspec spec failing and causing error", "body": "<p>serverspec runs its commands as root, so changes made to any other user's path during convergence are irrelevant.</p>\n\n<p>Using the Linux <code>runuser</code> command will allow <code>root</code> to run a command as another user, thereby gaining access to that user's <code>$PATH</code>:</p>\n\n<pre><code>runuser -l ec2-user -c 'rbenv versions'\n</code></pre>\n"}], "owner": {"reputation": 6202, "user_id": 1066615, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iv68W.png?s=128&g=1", "display_name": "sixty4bit", "link": "https://stackoverflow.com/users/1066615/sixty4bit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 1, "accepted_answer_id": 37859846, "answer_count": 1, "score": 0, "last_activity_date": 1466088770, "creation_date": 1466032470, "last_edit_date": 1466036242, "question_id": 37847358, "link": "https://stackoverflow.com/questions/37847358/chef-kitchen-kitchen-ec2-serverspec-spec-failing-and-causing-error", "title": "Chef Kitchen (kitchen-ec2) serverspec spec failing and causing error", "body": "<p>I am learning Chef and the testing process using Kitchen with the ec2 driver and have the following serverspec file:</p>\n\n<pre><code>require \"serverspec\"\n\nset :backend, :exec\n\ndescribe \"rbenv\" do\n  describe file(\"/home/ec2-user/.rbenv\") do\n    it { should be_directory }\n  end\n\n  describe command(\"rbenv versions\") do\n    its(:exit_status) { should eq 0 }\n  end\nend\n</code></pre>\n\n<p>When I run <code>kitchen verify amazon-linux</code> the first test passes but the second one fails and causes an error:</p>\n\n<pre><code>rbenv\n         File \"/home/ec2-user/.rbenv\"\n           should be directory\n         Command \"rbenv versions\"\n           exit_status\n             should eq 0 (FAILED - 1)\n\n       Failures:\n\n         1) rbenv Command \"rbenv versions\" exit_status should eq 0\n            Failure/Error: its(:exit_status) { should eq 0 }\n\n              expected: 0\n                   got: 127\n\n              (compared using ==)\n              /bin/sh -c rbenv\\ versions\n\n            # /tmp/verifier/suites/serverspec/rbenv_spec.rb:11:in `block (3 levels) in &lt;top (required)&gt;'\n\n Finished in 0.05481 seconds (files took 0.30304 seconds to load)\n       2 examples, 1 failure\n\n       Failed examples:\n\n       rspec /tmp/verifier/suites/serverspec/rbenv_spec.rb:11 # rbenv Command \"rbenv versions\" exit_status should eq 0\n\n       /opt/chef/embedded/bin/ruby -I/tmp/verifier/suites/serverspec -I/tmp/verifier/gems/gems/rspec-support-3.4.1/lib:/tmp/ver\nifier/gems/gems/rspec-core-3.4.4/lib /opt/chef/embedded/bin/rspec --pattern /tmp/verifier/suites/serverspec/\\*\\*/\\*_spec.rb --c\nolor --format documentation --default-path /tmp/verifier/suites/serverspec failed\n       !!!!!! Ruby Script [/tmp/verifier/gems/gems/busser-serverspec-0.5.9/lib/busser/runner_plugin/../serverspec/runner.rb /tm\np/verifier/suites/serverspec] exit code was 1\n&gt;&gt;&gt;&gt;&gt;&gt; Verify failed on instance &lt;default-amazon-linux&gt;.\n&gt;&gt;&gt;&gt;&gt;&gt; Please see .kitchen/logs/default-amazon-linux.log for more details\n&gt;&gt;&gt;&gt;&gt;&gt; ------Exception-------\n&gt;&gt;&gt;&gt;&gt;&gt; Class: Kitchen::ActionFailed\n&gt;&gt;&gt;&gt;&gt;&gt; Message: SSH exited (1) for command: [sh -c '\nBUSSER_ROOT=\"/tmp/verifier\"; export BUSSER_ROOT\nGEM_HOME=\"/tmp/verifier/gems\"; export GEM_HOME\nGEM_PATH=\"/tmp/verifier/gems\"; export GEM_PATH\nGEM_CACHE=\"/tmp/verifier/gems/cache\"; export GEM_CACHE\n\nsudo -E /tmp/verifier/bin/busser test\n']\n&gt;&gt;&gt;&gt;&gt;&gt; ----------------------\n</code></pre>\n\n<p>I logged into the server manually and ran the same command <code>/bin/sh -c rbenv\\ versions</code> and it worked fine.</p>\n\n<p>Can anyone tell if there's something I'm doing wrong here?</p>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>I just discovered that when serverspec runs the command the <code>$PATH</code> variable is different from what it is when I log in manually. I added <code>puts ENV['PATH']</code> to the test and the output was this:</p>\n\n<p><code>/sbin:/bin:/usr/sbin:/usr/bin</code></p>\n\n<p>However, when I login manually I get this:</p>\n\n<p><code>/home/ec2-user/.rbenv/shims:/home/ec2-user/.rbenv/bin:/home/ec2-user/.rbenv/shims:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/opt/aws/bin:/home/ec2-user/.local/bin:/home/ec2-user/bin</code></p>\n\n<p>I changed the command in the test to <code>/home/ec2-user/.rbenv/rbenv versions</code> and it passed. Any idea what I need to do to make the paths work correctly here?</p>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>So I've discovered that serverspec is running the commands as <code>root</code>, which means that the changes to <code>ec2-user</code>'s path that took place during <code>kitchen converge</code> are unavailable. </p>\n\n<p>I don't know if there's a more idiomatic way to do this with serverspec, but I changed my command to this and the test now passes:</p>\n\n<p><code>runuser -l ec2-user -c 'rbenv versions'</code></p>\n\n<p>This allows <code>root</code> to run a command as another user. Unless someone knows of a better way to do this kind of test I'll add this as the answer to the question.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv"], "comments": [{"owner": {"reputation": 8966, "user_id": 1842294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6d25f036774c988f92c5acc6a629fbf9?s=128&d=identicon&r=PG", "display_name": "Seth", "link": "https://stackoverflow.com/users/1842294/seth"}, "edited": false, "score": 0, "creation_date": 1466037016, "post_id": 37847355, "comment_id": 63155632, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4822422/output-array-to-csv-in-ruby\">Output array to CSV in Ruby</a>"}, {"owner": {"reputation": 151, "user_id": 5886101, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1b0ad8ed95c480c6fd053fb42f76b49?s=128&d=identicon&r=PG&f=1", "display_name": "Sean L", "link": "https://stackoverflow.com/users/5886101/sean-l"}, "reply_to_user": {"reputation": 8966, "user_id": 1842294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6d25f036774c988f92c5acc6a629fbf9?s=128&d=identicon&r=PG", "display_name": "Seth", "link": "https://stackoverflow.com/users/1842294/seth"}, "edited": false, "score": 0, "creation_date": 1466100454, "post_id": 37847355, "comment_id": 63189846, "body": "Thanks Seth, but how I output the CSV downloadable link when showing a webpage of <code>localhost:&#47;&#47;show&#47;my_search</code>"}, {"owner": {"reputation": 151, "user_id": 5886101, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1b0ad8ed95c480c6fd053fb42f76b49?s=128&d=identicon&r=PG&f=1", "display_name": "Sean L", "link": "https://stackoverflow.com/users/5886101/sean-l"}, "reply_to_user": {"reputation": 8966, "user_id": 1842294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6d25f036774c988f92c5acc6a629fbf9?s=128&d=identicon&r=PG", "display_name": "Seth", "link": "https://stackoverflow.com/users/1842294/seth"}, "edited": false, "score": 0, "creation_date": 1466100567, "post_id": 37847355, "comment_id": 63189914, "body": "<a href=\"http://stackoverflow.com/questions/94502/in-rails-how-to-return-records-as-a-csv-file\" title=\"in rails how to return records as a csv file\">stackoverflow.com/questions/94502/&hellip;</a> may help -- but this will only allow going to <code>localhosts:&#47;&#47;some&#47;path&#47;file.csv</code> which means it shows no webpage in <code>localhosts:&#47;&#47;some&#47;path&#47;file.csv</code>"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 5886101, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1b0ad8ed95c480c6fd053fb42f76b49?s=128&d=identicon&r=PG&f=1", "display_name": "Sean L", "link": "https://stackoverflow.com/users/5886101/sean-l"}, "edited": false, "score": 0, "creation_date": 1466100098, "post_id": 37847502, "comment_id": 63189622, "body": "Thanks for helping! I add more description to the question. Is it that if this function has <code>render json: @data</code> then it will not render any html page? Is it a way to access the <code>@data</code> when showing the page <code>localhost:&#47;&#47;show&#47;my_search</code>?"}, {"owner": {"reputation": 151, "user_id": 5886101, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1b0ad8ed95c480c6fd053fb42f76b49?s=128&d=identicon&r=PG&f=1", "display_name": "Sean L", "link": "https://stackoverflow.com/users/5886101/sean-l"}, "edited": false, "score": 0, "creation_date": 1466100372, "post_id": 37847502, "comment_id": 63189798, "body": "Oh, do you mean to write CSV file (and probably add a link to the path of that <code>some&#47;file.csv</code> in the view) to local path (maybe in <code>public</code> folder?) before render the webpage?"}, {"owner": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "reply_to_user": {"reputation": 151, "user_id": 5886101, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1b0ad8ed95c480c6fd053fb42f76b49?s=128&d=identicon&r=PG&f=1", "display_name": "Sean L", "link": "https://stackoverflow.com/users/5886101/sean-l"}, "edited": false, "score": 0, "creation_date": 1466104103, "post_id": 37847502, "comment_id": 63191868, "body": "Oh, if you&#39;re you&#39;re rendering an HTML page, your controller method&#39;s instance variables should simply be available in the view. In other words, just render the page normally and <code>@data</code> should be usable in the template. As for your second comment, you could set the CSV&#39;s file path to an instance variable (i.e. <code>@csv_path = &#39;some&#47;file.csv&#39;</code>) and then it, too would be available in your view for linking purposes."}, {"owner": {"reputation": 151, "user_id": 5886101, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1b0ad8ed95c480c6fd053fb42f76b49?s=128&d=identicon&r=PG&f=1", "display_name": "Sean L", "link": "https://stackoverflow.com/users/5886101/sean-l"}, "edited": false, "score": 0, "creation_date": 1466459387, "post_id": 37847502, "comment_id": 63315330, "body": "Thanks! So I will just write the CSV to a local copy of <code>&#39;some&#47;file.csv&#39;</code> and then link this to the user? That will be a good workaround, but I wonder if it can gives one-time download link and not storing much thing in the website.. @jmschles"}], "tags": [], "owner": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "is_accepted": false, "score": 2, "last_activity_date": 1466033670, "creation_date": 1466033670, "answer_id": 37847502, "question_id": 37847355, "link": "https://stackoverflow.com/questions/37847355/rails-export-array-of-hash-to-csv/37847502#37847502", "title": "Rails export array of hash to csv", "body": "<p>You can open up a CSV and write to it before your <code>render</code> if you want:</p>\n\n<pre><code>@data = { first_stuff: ['a', 'b', 'c'], second_stuff: [1, 2, 3] }\nCSV.open('some/file.csv', 'w') do |csv|\n  @data.each_pair do |key, value|\n    csv &lt;&lt; value\n  end\nend\nrender json: @data\n</code></pre>\n\n<p>... and so forth. It's hard to get more specific without knowing what your <code>@data</code> looks like, but I hope that helps!</p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 5886101, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1b0ad8ed95c480c6fd053fb42f76b49?s=128&d=identicon&r=PG&f=1", "display_name": "Sean L", "link": "https://stackoverflow.com/users/5886101/sean-l"}, "is_accepted": true, "score": 0, "last_activity_date": 1466634353, "creation_date": 1466634353, "answer_id": 37979259, "question_id": 37847355, "link": "https://stackoverflow.com/questions/37847355/rails-export-array-of-hash-to-csv/37979259#37979259", "title": "Rails export array of hash to csv", "body": "<p>Update 6/20/2016: my current workround:</p>\n\n<p>app/controllers/show_controller.rb:</p>\n\n<p>def my_search\n     get_data\n    # and do other stuff here</p>\n\n<pre><code>render \"table_template\"\n</code></pre>\n\n<p>end</p>\n\n<p>def my_search_export\n    get_data \n    format.each do |format|\n    # something that renders the CSV format when visiting localhost://my_search_export.csv\n        .....\n    end\nend</p>\n\n<p>private\ndef get_data # writes to @data\n    @data=[ {\"name\"=>\"John\", \"age\"=>\"21\"}, {\"name\"=>\"Amy\", \"age\"=>\"20\"} ]\nend\nin view: add a url to localhost://my_search_export.csv.</p>\n\n<p>Bad thing is it loads the data again, good thing is the workflow is simple. I am still looking for a better solution.</p>\n\n<p>P.s. this website may have different user running at the same time so keeping a global variable doesn't sound right for me.</p>\n"}], "owner": {"reputation": 151, "user_id": 5886101, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1b0ad8ed95c480c6fd053fb42f76b49?s=128&d=identicon&r=PG&f=1", "display_name": "Sean L", "link": "https://stackoverflow.com/users/5886101/sean-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 1, "accepted_answer_id": 37979259, "answer_count": 2, "score": 1, "last_activity_date": 1466634353, "creation_date": 1466032437, "last_edit_date": 1466480770, "question_id": 37847355, "link": "https://stackoverflow.com/questions/37847355/rails-export-array-of-hash-to-csv", "title": "Rails export array of hash to csv", "body": "<p>in my <code>show</code> route, there is a <code>my_search</code> route (basically <code>show#my_search</code>) that shows an array of hashes of data in HTML. </p>\n\n<p>What I need to do is just dump <code>@data</code> into my <code>render</code> (or partial) and deal with them in views, making it a HTML table with embedded ruby.</p>\n\n<p>However, is there a easy way to send the same <code>@data</code> to a CSV file? Do I have to get the <code>@data</code> again and make another route specially for it?  Is it a way to access the <code>@data</code> (preferably, in a link to download its CSV or json render) when showing the page <code>localhost://show/my_search</code>?</p>\n\n<p>Edit:</p>\n\n<p>The <code>@data</code> looks like:</p>\n\n<p><code>@data = [ {\"name\"=&gt;\"John\", \"age\"=&gt;\"21\"}, {\"name\"=&gt;\"Amy\", \"age\"=&gt;\"20\"} ]</code></p>\n\n<p>The <code>app/controllers/show_controller.rb</code> looks like:</p>\n\n<pre><code>def my_search\n    @data = [ {\"name\"=&gt;\"John\", \"age\"=&gt;\"21\"}, {\"name\"=&gt;\"Amy\", \"age\"=&gt;\"20\"} ] # and other rows\n    # and do other stuff here\n\n    render \"table_template\"\n</code></pre>\n\n<p>in <code>app/views/show/table_template.html</code> looks like:</p>\n\n<pre><code>&lt;table&gt;\n  &lt;thead&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Name&lt;/th&gt;\n    &lt;th&gt;Age&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;/thead&gt;\n\n  &lt;tbody&gt;\n  &lt;% @data.each do |row| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= row['name'] %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= row['age'] %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n  &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<hr>\n\n<p>Update 6/20/2016: my current workround:</p>\n\n<p><code>app/controllers/show_controller.rb</code>:</p>\n\n<pre><code>def my_search\n     get_data\n    # and do other stuff here\n\n    render \"table_template\"\nend\n\ndef my_search_export\n    get_data \n    format.each do |format|\n    # something that renders the CSV format when visiting localhost://my_search_export.csv\n        .....\n    end\nend\n\n\n\n\nprivate\ndef get_data # writes to @data\n    @data=[ {\"name\"=&gt;\"John\", \"age\"=&gt;\"21\"}, {\"name\"=&gt;\"Amy\", \"age\"=&gt;\"20\"} ]\nend\n</code></pre>\n\n<p>in view: add a url to <code>localhost://my_search_export.csv</code>. </p>\n\n<p>Bad thing is it loads the data again, good thing is the workflow is simple. I am still looking for a better solution.</p>\n\n<p>P.s. this website may have different user running at the same time so keeping a global variable doesn't sound right for me.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1466032263, "post_id": 37847269, "comment_id": 63154513, "body": "You&#39;re calling the <code>-</code> method on <code>nil</code>, like the error says. Since the only place you&#39;re calling <code>-</code> is in the <code>total_time</code> method, it follows that <code>@stop_time</code> is <code>nil</code>."}, {"owner": {"reputation": 1299, "user_id": 2923846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e45ca52b59ce69b3844c6e8b09f278c?s=128&d=identicon&r=PG", "display_name": "lwassink", "link": "https://stackoverflow.com/users/2923846/lwassink"}, "edited": false, "score": 0, "creation_date": 1466051026, "post_id": 37847269, "comment_id": 63158793, "body": "I would consider renaming <code>hours_worked</code> to <code>time_worked</code>."}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 1, "last_activity_date": 1466032295, "creation_date": 1466032295, "answer_id": 37847325, "question_id": 37847269, "link": "https://stackoverflow.com/questions/37847269/calculating-time/37847325#37847325", "title": "Calculating time", "body": "<p>The only place where <code>-</code> is called is in your <code>total_time</code> method. Since it says \"NoMethod - for nil class\" that means that the variable before the minus sign is undefined. So here, that is the <code>@stop_time</code> variable.</p>\n\n<p>It looks like <code>@stop_time</code> only gets defined when you call <code>create</code>. If you want your code to work, you'll have to call both <code>create</code> and <code>destroy</code> before calling <code>total_time</code>.</p>\n\n<p>I'd bet that you're running them out of order - calling <code>total_time</code> before the others - and that's why you're getting an error. </p>\n"}, {"tags": [], "owner": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "is_accepted": true, "score": 3, "last_activity_date": 1466032651, "creation_date": 1466032651, "answer_id": 37847385, "question_id": 37847269, "link": "https://stackoverflow.com/questions/37847269/calculating-time/37847385#37847385", "title": "Calculating time", "body": "<p>I think your underlying problem is that you're assuming your instance variables (<code>@start_time</code> and <code>@stop_time</code>) persist across requests. They don't. Each time you hit one of these endpoints, you're dealing with an entirely new instance of the controller, so even if you've called <code>#create</code> and <code>#destroy</code> previously, when you call <code>#show</code>, both <code>@start_time</code> and <code>@stop_time</code> are <code>nil</code>.</p>\n\n<p>If you do want data to persist across requests, you need some kind of persistence mechanism in place, i.e. a database or key-value store. Instance variables are only held in memory for the duration of a single request/response cycle.</p>\n"}], "owner": {"reputation": 11, "user_id": 6471945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07486efeb4ce428d0a72527fd12b6d67?s=128&d=identicon&r=PG&f=1", "display_name": "idk", "link": "https://stackoverflow.com/users/6471945/idk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 37847385, "answer_count": 2, "score": 0, "last_activity_date": 1466083625, "creation_date": 1466031952, "last_edit_date": 1466083625, "question_id": 37847269, "link": "https://stackoverflow.com/questions/37847269/calculating-time", "title": "Calculating time", "body": "<p>I'm trying to create an app on RoR that calculates time.</p>\n\n<p>when you press as start button it will pull Time.now, then, when you press stop and will pull Time.now again and then calculate the amount of time between the two. Then it will convert the seconds given into and integer via to_i and then calculate the seconds integer into hours:minutes:seconds</p>\n\n<p>However something is up with my code it keeps throwing error after error.</p>\n\n<p>the current order is \"undefined method `-' for nil:NilClass\"</p>\n\n<pre><code>def create\n  @start_time = Time.now\nend \n\ndef destroy\n  @stop_time = Time.now\nend \n\ndef show\n  @total_time = hours_worked(total_time)\nend \n\nprivate\n\ndef total_time\n  total_time = @stop_time - @start_time\n  return total_time.to_i\nend \n\ndef time_worked(seconds_worked)\n  hours = seconds_worked / ( 60 * 60 )\n  minutes = ( seconds_worked / 60 ) % 60\n  seconds = seconds_worked % 60\n  return \"#{hours} + \u201c:\u201d + #{minutes} + \u201c:\u201d + #{seconds}\"\nend \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 10654, "user_id": 476048, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/dhByN.jpg?s=128&g=1", "display_name": "Berin Loritsch", "link": "https://stackoverflow.com/users/476048/berin-loritsch"}, "edited": false, "score": 1, "creation_date": 1466032881, "post_id": 37847215, "comment_id": 63154679, "body": "Is this a question of passing the value from the controller to the view?"}, {"owner": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "reply_to_user": {"reputation": 10654, "user_id": 476048, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/dhByN.jpg?s=128&g=1", "display_name": "Berin Loritsch", "link": "https://stackoverflow.com/users/476048/berin-loritsch"}, "edited": false, "score": 0, "creation_date": 1466033089, "post_id": 37847215, "comment_id": 63154738, "body": "how to configure controller in that case and how to pass the average value to the view"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "edited": false, "score": 0, "creation_date": 1466033845, "post_id": 37847434, "comment_id": 63154927, "body": "// def review_avarage @review = Review.average(:rating) end   //    and in show view &lt;%= [at]review.review_avarage %&gt; ???"}, {"owner": {"reputation": 598, "user_id": 1019579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3iQz.jpg?s=128&g=1", "display_name": "bsvin33t", "link": "https://stackoverflow.com/users/1019579/bsvin33t"}, "reply_to_user": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "edited": false, "score": 0, "creation_date": 1466041793, "post_id": 37847434, "comment_id": 63156687, "body": "usually what I would do is, <code>def show @review = Review.find(:id) end</code>  app/views/reviews/show.html.erb  <code>Average: &lt;%= @review.average%&gt;</code>"}, {"owner": {"reputation": 409, "user_id": 3337880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f2f0015aaa6bfe88cffa956d4d15622?s=128&d=identicon&r=PG", "display_name": "Ivan A.", "link": "https://stackoverflow.com/users/3337880/ivan-a"}, "reply_to_user": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "edited": false, "score": 0, "creation_date": 1466081759, "post_id": 37847434, "comment_id": 63176889, "body": "@FilipMaryniak I think what @bsvin33t is suggesting is to add a method on your Review model and then call that method in the view. In your case, in <code>app&#47;views&#47;reviews</code> you define: <code>def average_rating Review.average(:rating) end</code> and in <code>app&#47;views&#47;reviews</code> you you&#39;ll have <code>&lt;%= @review.average_rating %&gt;</code>. Also if every item has a review (and assuming you&#39;ve set your associations properly), you&#39;ll be able to access its rating via <code>@item.review.average_rating</code> in <code>app&#47;views&#47;items&#47;show.html.erb</code>."}, {"owner": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "edited": false, "score": 0, "creation_date": 1466089241, "post_id": 37847434, "comment_id": 63182786, "body": "undefined method `average_rating&#39; for nil:NilClass still"}], "tags": [], "owner": {"reputation": 598, "user_id": 1019579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3iQz.jpg?s=128&g=1", "display_name": "bsvin33t", "link": "https://stackoverflow.com/users/1019579/bsvin33t"}, "is_accepted": false, "score": 1, "last_activity_date": 1466032981, "last_edit_date": 1495540730, "creation_date": 1466032981, "answer_id": 37847434, "question_id": 37847215, "link": "https://stackoverflow.com/questions/37847215/ruby-on-rails-4-2-3-calculate-average/37847434#37847434", "title": "RUBY ON RAILS 4.2.3 Calculate average", "body": "<p>There are multiple ways of doing this. Easiest way is exposing it as a state on the controller, which is the <code>@average</code>, which can then be accessed in the view. As easy as it might be, I don't recommend this approach.</p>\n\n<p>What I do recommend is, adding a method on your model, \n<code>model_instance#review_ average</code> and when you are exposing (using the <code>@model_instance</code>) the instance of the model in the <code>#show</code> action of your controller to the view, you can just call <code>@model_instance.review_average</code></p>\n\n<p>What is the advantage of the second approach? It hides the logic from the view and controller, and pushes it into the model, which in turn makes it easier to write an automated test case.</p>\n\n<p>for implementing average, check: <a href=\"https://stackoverflow.com/questions/1341271/how-do-i-create-an-average-from-a-ruby-array\">How do I create an average from a Ruby array?</a></p>\n\n<p>I'm also guessing that you have a has-many relation. It should not be too difficult to do the above. </p>\n\n<p>One thing that you have to also keep an eye for, is n+1 queries, But this becomes an issue only when you have to show the avg in the index page.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "edited": false, "score": 0, "creation_date": 1466071213, "post_id": 37849908, "comment_id": 63169803, "body": "Everything what i do: &quot;undefined method `average_rating&#39; for nil:NilClass&quot;"}, {"owner": {"reputation": 895, "user_id": 5780189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0edd103c68c4ed3b24902809589ab35?s=128&d=identicon&r=PG&f=1", "display_name": "Tinus Wagner", "link": "https://stackoverflow.com/users/5780189/tinus-wagner"}, "reply_to_user": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "edited": false, "score": 0, "creation_date": 1466319922, "post_id": 37849908, "comment_id": 63262110, "body": "have you defined a &#39;average_rating&#39; method in your model? Also it may have to do with the data type your trying to average (maybe you&#39;re dealing with strings?)  in your model, define a method .e.g.   <code>def average_rating     model.average(:rating).to_f   end</code>"}, {"owner": {"reputation": 895, "user_id": 5780189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0edd103c68c4ed3b24902809589ab35?s=128&d=identicon&r=PG&f=1", "display_name": "Tinus Wagner", "link": "https://stackoverflow.com/users/5780189/tinus-wagner"}, "reply_to_user": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "edited": false, "score": 0, "creation_date": 1466320158, "post_id": 37849908, "comment_id": 63262154, "body": "That error definitely makes me think you&#39;re not defining the method correctly in the model."}, {"owner": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "edited": false, "score": 0, "creation_date": 1466494688, "post_id": 37849908, "comment_id": 63325806, "body": "I defined in controller <code>def @rating = Model.average(:rating) end</code> and into view i defined <code>&lt;%= @rating %&gt;</code>. It works, but it shows me a strange  number. At first, my item hasn&#39;t got any ratings but the controller show i.e. 11.404040 (?). At second, i think, that my method calculate all ratings from all items which belongs to Model, not from one. But it is not solving the first problem, because if I have only one item - it shows me a strange number too. Any ideas? Thanks for all responses."}, {"owner": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "edited": false, "score": 0, "creation_date": 1466497441, "post_id": 37849908, "comment_id": 63327409, "body": "So, I&#39;m creating the catalogue, every item in the catalogue has reviews with users rating, i want to calculate average rating from reviews for one item."}, {"owner": {"reputation": 895, "user_id": 5780189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0edd103c68c4ed3b24902809589ab35?s=128&d=identicon&r=PG&f=1", "display_name": "Tinus Wagner", "link": "https://stackoverflow.com/users/5780189/tinus-wagner"}, "reply_to_user": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "edited": false, "score": 0, "creation_date": 1466559687, "post_id": 37849908, "comment_id": 63362289, "body": "def @rating = Model.average(:rating).to_f Give that a go"}], "tags": [], "owner": {"reputation": 895, "user_id": 5780189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0edd103c68c4ed3b24902809589ab35?s=128&d=identicon&r=PG&f=1", "display_name": "Tinus Wagner", "link": "https://stackoverflow.com/users/5780189/tinus-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1466051232, "creation_date": 1466051232, "answer_id": 37849908, "question_id": 37847215, "link": "https://stackoverflow.com/questions/37847215/ruby-on-rails-4-2-3-calculate-average/37849908#37849908", "title": "RUBY ON RAILS 4.2.3 Calculate average", "body": "<p>Simply add the following to your show.html.erb :</p>\n\n<pre><code>&lt;%= @model.average_rating %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "is_accepted": true, "score": 0, "last_activity_date": 1466724350, "creation_date": 1466724350, "answer_id": 38003435, "question_id": 37847215, "link": "https://stackoverflow.com/questions/37847215/ruby-on-rails-4-2-3-calculate-average/38003435#38003435", "title": "RUBY ON RAILS 4.2.3 Calculate average", "body": "<p><strong>RESOLVE</strong> STEP BY STEP:</p>\n\n<p><strong>first step:</strong> Add to your model controller, to def show:\n<code>@rating = Model.where(:model_id =&gt; params[:id]).average(:attribute).to_i</code></p>\n\n<p><strong>second step:</strong> add to your model view to show.html.erb:\n<code>&lt;%= @rating %&gt;</code></p>\n\n<p><code>model_id</code> = your model, i.e. Post will be <code>:post_id</code>\n<code>:attribute</code> = your attribute, i.e. :rating</p>\n\n<p>It's all.</p>\n"}], "owner": {"reputation": 11, "user_id": 6471929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294daa84fa9e8089fc090c2b7fec4f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Maryniak", "link": "https://stackoverflow.com/users/6471929/filip-maryniak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "accepted_answer_id": 38003435, "answer_count": 3, "score": 1, "last_activity_date": 1466724350, "creation_date": 1466031649, "last_edit_date": 1466032725, "question_id": 37847215, "link": "https://stackoverflow.com/questions/37847215/ruby-on-rails-4-2-3-calculate-average", "title": "RUBY ON RAILS 4.2.3 Calculate average", "body": "<p>I'm junior RoR programmer.\nI know that Ruby language has a calculate method, When I type this in rails console: <code>ModelName.average(:something)</code>,it calculates the average value from field <code>:something</code>. It works, but how to add average value to the view? </p>\n\n<p>I have a Items catalogue. Every item has a Review which include rating (integer). </p>\n\n<p>How to display on the view (i.e. <strong>show.html.erb</strong>) the average value from all rating fields in Review model?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ffmpeg"], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1466033855, "post_id": 37847352, "comment_id": 63154932, "body": "You should be <i>extremely</i> careful when doing this. Filenames can contain spaces or hazardous symbols or commands. Use the <code>system(&quot;ffmpeg&quot;, &quot;-i&quot;, self.file.path, ...)</code> method whenever possible. Test this with a file named <code>Untitled 1.mpg</code>."}, {"owner": {"reputation": 85974, "user_id": 1109017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PX561.png?s=128&g=1", "display_name": "llogan", "link": "https://stackoverflow.com/users/1109017/llogan"}, "edited": false, "score": 0, "creation_date": 1466039593, "post_id": 37847352, "comment_id": 63156190, "body": "There is no need to use the movie source filter, just declare the image like any other input: <code>ffmpeg -i video -i image -filter_complex overlay output</code>. Also, <code>-strict experimental</code> is not required unless your <code>ffmpeg</code> is old."}, {"owner": {"reputation": 4750, "user_id": 4367019, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/CnP5z.jpg?s=128&g=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/4367019/felix"}, "edited": false, "score": 0, "creation_date": 1466059085, "post_id": 37847352, "comment_id": 63161976, "body": "filter complex dosn&#39;t work thats the reason why I do it like above. Got an error when I user filter complex"}], "tags": [], "owner": {"reputation": 4750, "user_id": 4367019, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/CnP5z.jpg?s=128&g=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/4367019/felix"}, "is_accepted": true, "score": 0, "last_activity_date": 1466032420, "creation_date": 1466032420, "answer_id": 37847352, "question_id": 37847158, "link": "https://stackoverflow.com/questions/37847158/adding-a-watermark-with-ffmpeg-via-rails/37847352#37847352", "title": "Adding a watermark with FFMPEG via Rails", "body": "<p>Problem solved</p>\n\n<p>I use the ffmpeg it selve by callen the console</p>\n\n<pre><code>system \"ffmpeg -i #{self.file.path} -vf 'movie=#{watermarkimage} [watermark]; [in][watermark] overlay=main_w-overlay_w-10:10 [out]' -strict experimental #{tmp_path}\"\n</code></pre>\n"}], "owner": {"reputation": 4750, "user_id": 4367019, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/CnP5z.jpg?s=128&g=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/4367019/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 37847352, "answer_count": 1, "score": 0, "last_activity_date": 1466033813, "creation_date": 1466031279, "last_edit_date": 1466033813, "question_id": 37847158, "link": "https://stackoverflow.com/questions/37847158/adding-a-watermark-with-ffmpeg-via-rails", "title": "Adding a watermark with FFMPEG via Rails", "body": "<p>in my Rails app I want to use ffmpeg to add a watermark to a movie while uploading. </p>\n\n<p>For that I've added the stremio-ffmpeg gem. </p>\n\n<p>My code looks like this:</p>\n\n<pre><code>options = {watermark: Rails.root.join('public/images/logo_klein.png'), watermark_filter: {position: \"RT\", padding_x: 10, padding_y: 10}, custom: '-strict experimental'}\n\ntmp_path = File.join File.dirname(current_path), \"tmp_file.mp4\"\nfile = FFMPEG::Movie.new(self.file.path)\nfile.transcode(tmp_path, options)\n\nFile.rename tmp_path, current_path\n</code></pre>\n\n<p>But my Image is not added to the movie. wenn I call <a href=\"http://localhost/images/logo_klein.php\" rel=\"nofollow\">http://localhost/images/logo_klein.php</a> it is shown in browser (image)</p>\n\n<p>What could be the problem for not added into the movie? When I follow the console out transcoding is started properly. But nothing mentioned of watermarking only transcoding is mentiond</p>\n\n<p>console output:</p>\n\n<pre><code> INFO -- : Running transcoding...\nffmpeg -y -i /var/www/ji/public/uploads/tmp/1466030485-10470-0                                                              013-4987/2016-06-08_09.50.55.mp4   -strict experimental /var/www/ji/public/uploads/tmp/1466030485-10470-0013-4987/tmp_file.mp4\n</code></pre>\n\n<p>What could be the problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "data-analysis"], "answers": [{"comments": [{"owner": {"reputation": 517, "user_id": 1656464, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0c052c0c862fa12503177a9d861bc9?s=128&d=identicon&r=PG", "display_name": "AKovtunov", "link": "https://stackoverflow.com/users/1656464/akovtunov"}, "edited": false, "score": 0, "creation_date": 1466194348, "post_id": 37849542, "comment_id": 63233819, "body": "It&#39;s not the same thing.  Your code hashes everything like {t1_id: t3_records} And mine shows similar records for 2 t1 ids."}, {"owner": {"reputation": 713, "user_id": 520910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a6856519364c26462c51fea9b8e29b?s=128&d=identicon&r=PG", "display_name": "Larry Lv", "link": "https://stackoverflow.com/users/520910/larry-lv"}, "reply_to_user": {"reputation": 517, "user_id": 1656464, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0c052c0c862fa12503177a9d861bc9?s=128&d=identicon&r=PG", "display_name": "AKovtunov", "link": "https://stackoverflow.com/users/1656464/akovtunov"}, "edited": false, "score": 0, "creation_date": 1466219491, "post_id": 37849542, "comment_id": 63239991, "body": "@AKovtunov You miss understood me. My code is the first step. With <code>records</code>, which have <code>{t1_id: t2_ids}</code> hash, you could do sth like this:      hash = {}     records.each do |t1_id, t2_ids|       records.each do |tt1_id, tt2_ids|         if t1_id != tt1_id           inter = t2_ids &amp; tt2_ids           hash[&quot;#{t1_id}_#{tt1_id}&quot;] = inter if !inter.empty?         end       end     end"}, {"owner": {"reputation": 517, "user_id": 1656464, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0c052c0c862fa12503177a9d861bc9?s=128&d=identicon&r=PG", "display_name": "AKovtunov", "link": "https://stackoverflow.com/users/1656464/akovtunov"}, "edited": false, "score": 0, "creation_date": 1466505136, "post_id": 37849542, "comment_id": 63332720, "body": "Ah, I got you idea. Yep, with hash it will be alot faster."}], "tags": [], "owner": {"reputation": 713, "user_id": 520910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a6856519364c26462c51fea9b8e29b?s=128&d=identicon&r=PG", "display_name": "Larry Lv", "link": "https://stackoverflow.com/users/520910/larry-lv"}, "is_accepted": true, "score": 1, "last_activity_date": 1466219642, "last_edit_date": 1466219642, "creation_date": 1466048666, "answer_id": 37849542, "question_id": 37847082, "link": "https://stackoverflow.com/questions/37847082/group-records-for-data-analysis-in-rails/37849542#37849542", "title": "Group records for data analysis in Rails", "body": "<pre><code>Table1.find_each do |table_record|\n  Table1.find_each do |another_table_record|\n    ...\n</code></pre>\n\n<p>Above codes have performance issue that you have to query database N*N times, which could be optimized down to one single query.</p>\n\n<pre><code># Query table3, constructing the data useful to us\n# { table1_id: [table2_ids], ... }\nrecords = Table3.all.group_by { |t| t.table1_id }.map { |t1_id, t3_records|\n    [t1_id, t3_records.map(&amp;:table2_id)]\n  }.to_h\n</code></pre>\n\n<p>Then you could do exactly the same thing to <code>records</code> to get the final result hash.</p>\n\n<p>UPDATE:</p>\n\n<p>@AKovtunov You miss understood me. My code is the first step. With <code>records</code>, which have <code>{t1_id: t2_ids}</code> hash, you could do sth like this:</p>\n\n<pre><code>hash = {}\nrecords.each do |t1_id, t2_ids|\n  records.each do |tt1_id, tt2_ids|\n    if t1_id != tt1_id\n      inter = t2_ids &amp; tt2_ids\n      hash[\"#{t1_id}_#{tt1_id}\"] = inter if !inter.empty?\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 517, "user_id": 1656464, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0c052c0c862fa12503177a9d861bc9?s=128&d=identicon&r=PG", "display_name": "AKovtunov", "link": "https://stackoverflow.com/users/1656464/akovtunov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 37849542, "answer_count": 1, "score": 0, "last_activity_date": 1466219642, "creation_date": 1466030836, "last_edit_date": 1466034180, "question_id": 37847082, "link": "https://stackoverflow.com/questions/37847082/group-records-for-data-analysis-in-rails", "title": "Group records for data analysis in Rails", "body": "<p>I have two tables connected with habtm relation (through a table).</p>\n\n<pre><code>Table1\nid  : integer\nname: string\n\nTable2\nid  : integer\nname: string\n\nTable3\nid       : integer\ntable1_id: integer\ntable2_id: integer\n</code></pre>\n\n<p>I need to group Table1 records by simmilar records from Table2. Example:</p>\n\n<pre><code>userx = Table1.create()\nuser1.table2_ids = 3, 14, 15\nuser2.table2_ids = 3, 14, 15, 16\nuser3.table2_ids = 3, 14, 16\nuser4.table2_ids = 2, 5, 7\nuser5.table2_ids = 3, 5\n</code></pre>\n\n<p>Result of grouping that I want is something like</p>\n\n<pre><code>=&gt; [ [ [1,2], [3, 14, 15] ], [ [2,3], [3,14, 16] ], [ [ 1, 2, 3, 5], [3] ]  ]\n</code></pre>\n\n<p>Where first array is an user ids second is table2_ids.\nI there any possible SQL solution or I need to create some kind of algorithm ?</p>\n\n<p>Updated:\nOk, I have a code that is working like I've said. Maybe someone who can help me will find it useful to understand my idea. </p>\n\n<pre><code>def self.compare\n    hash = {}\n    Table1.find_each do |table_record|\n      Table1.find_each do |another_table_record|\n        if table_record != another_table_record\n          results = table_record.table2_ids &amp; another_table_record.table2_ids\n          hash[\"#{table_record.id}_#{another_table_record.id}\"] = results if !results.empty?\n        end\n      end\n    end\n    #hash = hash.delete_if{|k,v| v.empty?}\n    hash.sort_by{|k,v| v.count}.to_h\n  end\n</code></pre>\n\n<p>But I can bet that you can imagine how long does it takes to show me an output. For my 500 Table1 records it's something near 1-2 minutes. If I will have more, time will be increased in progression, so I need some elegant solution or SQL query.</p>\n"}, {"tags": ["arrays", "ruby", "date", "multidimensional-array"], "answers": [{"tags": [], "owner": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "is_accepted": true, "score": 1, "last_activity_date": 1466030273, "creation_date": 1466030273, "answer_id": 37846971, "question_id": 37846832, "link": "https://stackoverflow.com/questions/37846832/create-nested-array-from-existing-array/37846971#37846971", "title": "Create nested array from existing array", "body": "<p>It's hard for me to be sure without knowing what your <code>@input_date</code> looks like, but I think you're really close. You're probably getting that error because your <code>x</code> is an instance of <code>DateTime</code> and you're trying to subtract <code>6</code> (an <code>Integer</code>) from it. Maybe try subtracting <code>6.days</code> instead, like so:</p>\n\n<pre><code>@date_pairs = (@input_date-105..@input_date).step(7).to_a.reverse.map { |x| [x, x-6.days] }\n</code></pre>\n\n<p>Also note that <code>Array.new(5, 6)</code> produces <code>[6, 6, 6, 6, 6]</code> -- probably not what you want here.</p>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 358, "user_id": 5626213, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b560f197477a43289ff6f7bd44a9026?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Lee", "link": "https://stackoverflow.com/users/5626213/michael-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 37846971, "answer_count": 1, "score": 0, "last_activity_date": 1466030273, "creation_date": 1466029525, "question_id": 37846832, "link": "https://stackoverflow.com/questions/37846832/create-nested-array-from-existing-array", "title": "Create nested array from existing array", "body": "<p>I'm tying to create an array of dates, based on a user input of the date.  The goal is to take the date input by the user and generate 16 date pairs (in sequential order).  </p>\n\n<p>I was able to figure how to generate the start dates and put them in an array, but I can't quite figure out how to take that array and further break them up in to sub-arrays (the date pairs).</p>\n\n<p>Here's the code I used to generate the start dates:</p>\n\n<pre><code>@date_pairs = (@input_date-105..@input_date).step(7).to_a.reverse\n</code></pre>\n\n<p>I tried to create a sub-array in the following way:</p>\n\n<pre><code>@date_pairs = (@input_date-105..@input_date).step(7).to_a.reverse.each { |x| Array.new(x, x-6)}\n</code></pre>\n\n<p>However I get the following error:  no implicit conversion of Date into Integer</p>\n\n<p>Here's an example of what i'm hoping to get:</p>\n\n<pre><code>@input_date = 6/15/2016\n@date_pairs = [[6/15/2016, 6/9/2016], [6/8/2016, 6/2/2016], [6/1/2016, 5/24/2016].....]\n</code></pre>\n\n<p>The goal is to be able to iterate over the @date_pairs, accessing each value within the sub-array.  </p>\n\n<p>I plan to use this concept to create other types of date pairs (ie, date pairs separated by months, years, etc) </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 7213, "user_id": 233596, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7cba92ae4cd4794fd91d6e277ec859c6?s=128&d=identicon&r=PG", "display_name": "Jim Flood", "link": "https://stackoverflow.com/users/233596/jim-flood"}, "edited": false, "score": 0, "creation_date": 1466033380, "post_id": 37846764, "comment_id": 63154802, "body": "That&#39;s funny, your comment on Ruby. I&#39;ve been programming for decades and have used at least a dozen languages, and I would recommend any new programmer to start with Ruby! It&#39;s my favorite."}], "answers": [{"tags": [], "owner": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "is_accepted": false, "score": 0, "last_activity_date": 1466031834, "creation_date": 1466031834, "answer_id": 37847253, "question_id": 37846764, "link": "https://stackoverflow.com/questions/37846764/ruby-writing-filenames-from-subfolders-to-a-txt-file/37847253#37847253", "title": "Ruby - Writing filenames from subfolders to a txt file", "body": "<p>There may be a better way, but you could always <code>split</code> on the last slash in the path:</p>\n\n<pre><code>Dir.glob('**/*.pdf').each do |file_with_path|\n  processed_docs.push(file_with_path.split('/').last)\nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6471830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e059d3edaab4bc6ac58968578aa7407?s=128&d=identicon&r=PG&f=1", "display_name": "Awspry", "link": "https://stackoverflow.com/users/6471830/awspry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466031834, "creation_date": 1466029180, "question_id": 37846764, "link": "https://stackoverflow.com/questions/37846764/ruby-writing-filenames-from-subfolders-to-a-txt-file", "title": "Ruby - Writing filenames from subfolders to a txt file", "body": "<p>I have 385 subfolders in a directory, each containing a CSV file along with several pdfs. I'm trying to find a way to go through each subfolder and write a list of the pdfs to a txt file. (I realize there are better languages out there to do this than Ruby, but I'm new to programming and it's the only language I know.)</p>\n\n<p>I have code that gets the job done, but the problem I'm running into is it's listing the subfolder directory as well. Example: Instead of writing \"document.pdf\" to a text file, it's writing \"subfolder/document.pdf.\"</p>\n\n<p>Can someone please show me how to write just the pdf filename?</p>\n\n<p>Thanks in advance! Here's my code:</p>\n\n<pre><code>class Account\n  attr_reader :account_name, :account_acronym, :account_series\n  attr_accessor :account_directory\n\n  def initialize\n    @account_name = account_name\n    @account_series = account_series\n    @account_directory = account_directory\n  end\n\n  #prompts user for account name and record series so it can create the directory\n  def validation_account\n    print \"What account?\"\n    account_name = gets.chomp\n    print \"What Record Series? \"\n    account_series = gets.chomp\n    account_directory = \"c:/Processed Batches Clone/\" + account_name +  \"/\" + account_series + \"/Data\"\n    puts account_directory\n    return account_directory\n  end\nend\n\nprocessed_batches_dir = Account.new\n\n#changes pwd to account directory\nDir.chdir \"#{processed_batches_dir.validation_account}\"\n\n# pdf list\nprocessed_docs = []\n\n# iterates through subfolders and creates list\nDir.glob(\"**/*.pdf\") { |file|\n  processed_docs.push(file)\n  }\n\n# writes list to .txt file\nFile.open(\"processed_batches.txt\",\"w\") { |file|\n  file.puts(processed_docs)\n  }\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1384, "user_id": 1252245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EF8gC.jpg?s=128&g=1", "display_name": "sequielo", "link": "https://stackoverflow.com/users/1252245/sequielo"}, "edited": false, "score": 1, "creation_date": 1466751337, "post_id": 37846606, "comment_id": 63457968, "body": "What class does <code>self</code> belongs to? I infer that <code>self</code> object doesn&#39;t have the methods <code>controller_name</code>, <code>action_name</code> and <code>current_user</code> (is it a Controller?), thus falling for you (you said you are rendering from &quot;within a Model&quot;)"}, {"owner": {"reputation": 821, "user_id": 1166593, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd1b53c45386ed7ac737bdd65b1f9fe2?s=128&d=identicon&r=PG", "display_name": "AlexN", "link": "https://stackoverflow.com/users/1166593/alexn"}, "edited": false, "score": 1, "creation_date": 1466758058, "post_id": 37846606, "comment_id": 63461482, "body": "Have you tried <code>assigns</code> instead of <code>locals</code>?"}, {"owner": {"reputation": 4313, "user_id": 1177198, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4ea56c658e69eef33b6557b20c7a19ab?s=128&d=identicon&r=PG", "display_name": "bigtunacan", "link": "https://stackoverflow.com/users/1177198/bigtunacan"}, "reply_to_user": {"reputation": 821, "user_id": 1166593, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd1b53c45386ed7ac737bdd65b1f9fe2?s=128&d=identicon&r=PG", "display_name": "AlexN", "link": "https://stackoverflow.com/users/1166593/alexn"}, "edited": false, "score": 1, "creation_date": 1467151617, "post_id": 37846606, "comment_id": 63610389, "body": "@AlexN, yes; that has no impact on this particular issue."}], "answers": [{"comments": [{"owner": {"reputation": 4313, "user_id": 1177198, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4ea56c658e69eef33b6557b20c7a19ab?s=128&d=identicon&r=PG", "display_name": "bigtunacan", "link": "https://stackoverflow.com/users/1177198/bigtunacan"}, "edited": false, "score": 2, "creation_date": 1466690531, "post_id": 37990930, "comment_id": 63431374, "body": "I think you misunderstand my question.  In my example you can see I have passed <code>:@routing_form =&gt; self</code> as I expect @routing_form to be assigned self before it is passed since it is the current object I am working with.  The other locals I pass such as <code>:controller_name =&gt; controller_name</code> I would like to be able to call as <code>self.controller_name</code> from within the layout.  In the standard path of rendering a view this would work; with the render_anywhere gem (now obsolete) this continued to work.  Now in Rails 5 it does not."}, {"owner": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 2, "creation_date": 1466958007, "post_id": 37990930, "comment_id": 63520986, "body": "I think that there&#39;s some confusion about what the <code>self</code> keyword is. This isn&#39;t meant as a variable name that you can assign something to. <code>self</code> will refer to the current instance of an initialized object.  In the case of the renderer, I don&#39;t believe there&#39;s an instantiation happening, and thus there is no <code>self</code> available."}, {"owner": {"reputation": 4313, "user_id": 1177198, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4ea56c658e69eef33b6557b20c7a19ab?s=128&d=identicon&r=PG", "display_name": "bigtunacan", "link": "https://stackoverflow.com/users/1177198/bigtunacan"}, "edited": false, "score": 2, "creation_date": 1467159872, "post_id": 37990930, "comment_id": 63612847, "body": "In the case of a typical render request cycle instance variables from the controller are passed back to the view during initialization. Those variables are then available on <code>self</code> which is the would be a view object. Render Anywhere simulates the same behavior when rendering a view outside the typical request cycle (in this case from a model)."}], "tags": [], "owner": {"reputation": 189, "user_id": 4352712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h58Q5.png?s=128&g=1", "display_name": "aonemd", "link": "https://stackoverflow.com/users/4352712/aonemd"}, "is_accepted": false, "score": 3, "last_activity_date": 1466682946, "creation_date": 1466682946, "answer_id": 37990930, "question_id": 37846606, "link": "https://stackoverflow.com/questions/37846606/rails-5-rendering-from-outside-a-controller-with-applicationcontroller-renderer/37990930#37990930", "title": "Rails 5 rendering from outside a controller with ApplicationController.renderer.render doesn&#39;t set variables on self", "body": "<p>Since <code>self</code> is a keyword in Ruby, you cannot use it as a method call in your layout template, so you should use another name to pass with the locals. </p>\n\n<p>You can pass something like <code>my_object: self</code> and it will work fine. </p>\n\n<p>If you want to name the key with a @, you should put it inside a string <code>'@my_object': self</code> and calls it normally in your template: <code>&lt;%= @my_object.action_name%&gt;</code></p>\n"}], "owner": {"reputation": 4313, "user_id": 1177198, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4ea56c658e69eef33b6557b20c7a19ab?s=128&d=identicon&r=PG", "display_name": "bigtunacan", "link": "https://stackoverflow.com/users/1177198/bigtunacan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1943, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1466682946, "creation_date": 1466028378, "question_id": 37846606, "link": "https://stackoverflow.com/questions/37846606/rails-5-rendering-from-outside-a-controller-with-applicationcontroller-renderer", "title": "Rails 5 rendering from outside a controller with ApplicationController.renderer.render doesn&#39;t set variables on self", "body": "<p>I'm using the Rails 5 <code>ApplicationController.renderer.render</code> method to render from within a model.  I need to pass some variables to my layout which I have done using the <code>locals</code> option; this variable is then available in the layout if accessed directly, but not via <code>self</code>.</p>\n\n<p>Here is how I have setup my render</p>\n\n<pre><code>html_string = ApplicationController.renderer.render(\n  file: \"/#{template_path}/base/show\",\n  :formats =&gt; [:pdf,:html],\n  locals: {\n    :@routing_form =&gt; self,\n    :controller_name =&gt; controller_name,\n    :action_name =&gt; action_name,\n    :current_user =&gt; current_user\n  },\n  :layout  =&gt; '/layouts/application'\n)\n</code></pre>\n\n<p>Then within the layout I want to do something like this.</p>\n\n<pre><code>&lt;div id=\"foo\" class=\"&lt;%= self.action_name %&gt;\"&gt;\n</code></pre>\n\n<p>I was able to get this working by dropping <code>self</code> in this particular instance</p>\n\n<pre><code>&lt;div id=\"foo\" class=\"&lt;%= action_name %&gt;\"&gt;\n</code></pre>\n\n<p>but now my concern is how would I set a variable so that it would work correctly with <code>self</code>?  Previously I was using the render_anywhere gem and this was handled  using <code>rendering_controller.var = \"value\"</code></p>\n"}, {"tags": ["ruby", "amazon-s3"], "owner": {"reputation": 95, "user_id": 5847577, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/440cc275fcedab2f6d73ab31b7d9ec83?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5847577/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1466027950, "creation_date": 1466027950, "question_id": 37846520, "link": "https://stackoverflow.com/questions/37846520/aws-s3-ruby-using-aws-sdk-gem-version-2-creating-folders-programatically-and-wri", "title": "AWS S3 Ruby using aws-sdk gem version 2 creating folders programatically and write image url&#39;s into them which are strings in my database", "body": "<p>I am using aws-sdk gem version 2 and I am trying to create folders/files on my bucket. Each folder should be populated with image urls from my database (they are not real files on my system). I need to put these 'images' on this bucket folders on aws s3. Bucket folders must have the same name as id of the 'image' in my DB (this id is of the form '84675683' for example). So I have something like this:</p>\n\n<pre><code>s3 = Aws::S3::Resource.new(region: 'region', access_key_id: ENV['ACCESS_KEY'], secret_access_key: ENV['SECRET_KEY'])\ns3.bucket(ENV['S3_BUCKET_NAME']).object('special id which is in my db related to every image').put(body: 'image url which is string')\n</code></pre>\n\n<p>This is not creating folders but some kind of files on which I can't click (they don't behave like folders on which I can click to open contents) and which are not populated with anything. Please help, I am out of ideas.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4776684"}, "edited": false, "score": 0, "creation_date": 1466028390, "post_id": 37846431, "comment_id": 63153327, "body": "There are many ways to do that, Pita, and you have to be more specific."}], "answers": [{"comments": [{"owner": {"reputation": 1342, "user_id": 1216838, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c29171dbea109a0147226a1962a4d3c8?s=128&d=identicon&r=PG", "display_name": "Pita", "link": "https://stackoverflow.com/users/1216838/pita"}, "edited": false, "score": 0, "creation_date": 1466029563, "post_id": 37846580, "comment_id": 63153724, "body": "Thank you,I actually ended up making it a HABTM relationship and just did Role.users. but the same idea i guess"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 1342, "user_id": 1216838, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c29171dbea109a0147226a1962a4d3c8?s=128&d=identicon&r=PG", "display_name": "Pita", "link": "https://stackoverflow.com/users/1216838/pita"}, "edited": false, "score": 0, "creation_date": 1466030182, "post_id": 37846580, "comment_id": 63153920, "body": "Yeah HABTM makes more sense here"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 0, "last_activity_date": 1466028275, "creation_date": 1466028275, "answer_id": 37846580, "question_id": 37846431, "link": "https://stackoverflow.com/questions/37846431/querying-for-objects-that-contains-some-object-in-a-one-to-many-relationship/37846580#37846580", "title": "Querying for Objects that contains some object in a one to many relationship", "body": "<p>Start off my making a roles query</p>\n\n<p><code>roles = Role.where(some_key: some_val).includes(:user)</code></p>\n\n<p>You tack on the <code>includes</code> here to preload the associated user records. This way, you can get the users like so:</p>\n\n<p><code>roles.map(&amp;:user)</code> which is equivalent to <code>roles.map { |role| role.user }</code>.</p>\n\n<p>It would work without the <code>includes</code> but it would be slower. This is because of the <a href=\"https://www.sitepoint.com/silver-bullet-n1-problem/\" rel=\"nofollow\">N+1 sequel issue</a>. </p>\n"}], "owner": {"reputation": 1342, "user_id": 1216838, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c29171dbea109a0147226a1962a4d3c8?s=128&d=identicon&r=PG", "display_name": "Pita", "link": "https://stackoverflow.com/users/1216838/pita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10, "favorite_count": 0, "accepted_answer_id": 37846580, "answer_count": 1, "score": 0, "last_activity_date": 1466028275, "creation_date": 1466027580, "question_id": 37846431, "link": "https://stackoverflow.com/questions/37846431/querying-for-objects-that-contains-some-object-in-a-one-to-many-relationship", "title": "Querying for Objects that contains some object in a one to many relationship", "body": "<p>So I have two models</p>\n\n<pre><code>class User\n  has_many :roles\nend\n\nclass Role\n   belongs_to :user\nend\n</code></pre>\n\n<p>how would I query for \"who has xxx-role?\"\nthank you,</p>\n"}, {"tags": ["ruby", "macos", "proxy", "rubygems", "cocoapods"], "comments": [{"owner": {"reputation": 5203, "user_id": 3995261, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54754c59e35649b7d22d70b72ce2989a?s=128&d=identicon&r=PG&f=1", "display_name": "YakovL", "link": "https://stackoverflow.com/users/3995261/yakovl"}, "edited": false, "score": 0, "creation_date": 1466027301, "post_id": 37846059, "comment_id": 63152931, "body": "Welcome to StackOverflow. Please provide the code you have tried. Without it, error messages are rather useless."}, {"owner": {"reputation": 394, "user_id": 4637816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66e877519c50b8d05d4b78dc980c3fb?s=128&d=identicon&r=PG&f=1", "display_name": "phamot", "link": "https://stackoverflow.com/users/4637816/phamot"}, "reply_to_user": {"reputation": 5203, "user_id": 3995261, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54754c59e35649b7d22d70b72ce2989a?s=128&d=identicon&r=PG&f=1", "display_name": "YakovL", "link": "https://stackoverflow.com/users/3995261/yakovl"}, "edited": false, "score": 0, "creation_date": 1466086945, "post_id": 37846059, "comment_id": 63181119, "body": "@YakovL sudo gem install cocoapods. Thanks"}], "owner": {"reputation": 394, "user_id": 4637816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66e877519c50b8d05d4b78dc980c3fb?s=128&d=identicon&r=PG&f=1", "display_name": "phamot", "link": "https://stackoverflow.com/users/4637816/phamot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515848617, "creation_date": 1466025967, "last_edit_date": 1515848617, "question_id": 37846059, "link": "https://stackoverflow.com/questions/37846059/needed-proxy-settings-commands-to-install-cocoapods-on-os-x-also-when-i-am-tryi", "title": "Needed proxy settings commands to install cocoapods on OS X. Also when I am trying to ping rubygems.org I get &quot;Request timeout for icmp_seq&quot; as result", "body": "<p>$ sudo gem install cocoapods</p>\n\n<p>ERROR:  Could not find a valid gem 'cocoapods' (>= 0), here is why:\n          Unable to download data from <a href=\"https://rubygems.org/\" rel=\"nofollow\">https://rubygems.org/</a> - Errno::ECONNREFUSED: Connection refused - connect(2) (<a href=\"https://api.rubygems.org/specs.4.8.gz\" rel=\"nofollow\">https://api.rubygems.org/specs.4.8.gz</a>)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "fabrication-gem"], "answers": [{"comments": [{"owner": {"reputation": 450, "user_id": 1087427, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d4b165f2ead0c25644f7497b10f5001?s=128&d=identicon&r=PG", "display_name": "1087427", "link": "https://stackoverflow.com/users/1087427/1087427"}, "edited": false, "score": 0, "creation_date": 1466082340, "post_id": 37846227, "comment_id": 63177367, "body": "Thanks for your help, using transients is a good idea, the problem with your suggestion is that it is not valid to create a <code>Publicacion</code> without an <code>Usuario</code>. This is solved using <code>Fabricate.build</code> instead, as shown in the answer of Paul Elliott."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1466026701, "creation_date": 1466026701, "answer_id": 37846227, "question_id": 37845728, "link": "https://stackoverflow.com/questions/37845728/rails-fabrication-gem-association-creating-many-objects/37846227#37846227", "title": "Rails Fabrication gem association creating many objects", "body": "<p>The problem is that when you create the <code>usario</code> it creates 10 <code>publicaciones</code> <em>but</em> every <code>publicaciones</code> fabrication creates one <code>usario</code></p>\n\n<p>You can use transients to suppress  the default creation of the new <code>usario</code> records.</p>\n\n<pre><code>Fabricator(:usuario_con_10_publicaciones) do\n  nombre { FFaker::NameMX.name }\n  publicaciones(count: 10) { Fabricate(:publicacion, no_usario: true) }\nend\n\nFabricator(:publicacion) do\n  transient :no_usario\n  texto { FFaker::Lorem.paragraphs }\n  usuario { |attrs| Fabricate(:usario) unless attrs[:no_usario] }\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1109, "user_id": 560325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb877126a0a28f868c2bb2a124c23cb?s=128&d=identicon&r=PG", "display_name": "Paul Elliott", "link": "https://stackoverflow.com/users/560325/paul-elliott"}, "is_accepted": true, "score": 1, "last_activity_date": 1466078550, "creation_date": 1466078550, "answer_id": 37858629, "question_id": 37845728, "link": "https://stackoverflow.com/questions/37845728/rails-fabrication-gem-association-creating-many-objects/37858629#37858629", "title": "Rails Fabrication gem association creating many objects", "body": "<p>Steve is right about what's going on. Another solution is to suppress the creation of the <code>usario</code> in the <code>publicaciones</code>.</p>\n\n<pre><code>Fabricator(:usuario_con_10_publicaciones) do\n  nombre { FFaker::NameMX.name }\n  publicaciones(count: 10) { Fabricate.build(:publicacion, usuario: nil) }\nend\n</code></pre>\n\n<p>ActiveRecord will properly associate them for you when the tree is persisted.</p>\n"}], "owner": {"reputation": 450, "user_id": 1087427, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d4b165f2ead0c25644f7497b10f5001?s=128&d=identicon&r=PG", "display_name": "1087427", "link": "https://stackoverflow.com/users/1087427/1087427"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "accepted_answer_id": 37858629, "answer_count": 2, "score": 0, "last_activity_date": 1466078550, "creation_date": 1466024581, "question_id": 37845728, "link": "https://stackoverflow.com/questions/37845728/rails-fabrication-gem-association-creating-many-objects", "title": "Rails Fabrication gem association creating many objects", "body": "<p>I have two models with a simple <code>has_many</code> association</p>\n\n<pre><code>class Usuario &lt; ActiveRecord::Base\n  has_many :publicaciones, dependent: :destroy\nend\n\nclass Publicacion &lt; ActiveRecord::Base\n  belongs_to :usuario, dependent: :destroy\n  validates_presence_of :usuario\nend\n</code></pre>\n\n<p>And these are the fabricators</p>\n\n<pre><code>Fabricator(:usuario_con_10_publicaciones) do\n  nombre { FFaker::NameMX.name }\n  publicaciones(count: 10)\nend\n\nFabricator(:publicacion) do\n  texto { FFaker::Lorem.paragraphs }\n  usuario\nend\n</code></pre>\n\n<p>When I use the second one it works fine, it creates <strong>one</strong> <code>Publicacion</code> and <strong>one</strong> <code>Usuario</code></p>\n\n<pre><code>&gt; a = Fabricate :publicacion\n&gt; Usuario.count\n=&gt; 1\n&gt; Publicacion.count\n=&gt; 1\n</code></pre>\n\n<p>But when I use the first one, it creates <strong>ten</strong> <code>Publicaciones</code> but <strong>eleven</strong> <code>Usuarios</code>, with all the <code>Publicaciones</code> associated just with the last one.</p>\n\n<pre><code>&gt; u = Fabricate :usuario_con_10_publicaciones\n&gt; Usuario.count\n=&gt; 11\n&gt; Publicacion.count\n=&gt; 10\n</code></pre>\n\n<p>Shouldn't it create just <strong>one</strong> <code>Usuario</code> and <strong>ten</strong> <code>Publicaciones</code>?</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-4.2"], "comments": [{"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1466024726, "post_id": 37845630, "comment_id": 63151789, "body": "Of course, temporarily uninstalling all but version 4.2.2 of the rails gem might help as a work around. But why this error occurs I cannot say. Looks like a bug to me."}, {"owner": {"reputation": 1189, "user_id": 6030977, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/6UMfc.jpg?s=128&g=1", "display_name": "Shyam Bhimani", "link": "https://stackoverflow.com/users/6030977/shyam-bhimani"}, "edited": false, "score": 0, "creation_date": 1466025903, "post_id": 37845630, "comment_id": 63152336, "body": "If you have installed rails through rvm try this: <code>rvm use 4.2.2 --default</code> this will make 4.2.2 as default and let me know if it works?"}, {"owner": {"reputation": 677, "user_id": 3798973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a75b013b0de4acfee1ea863abaddc5e6?s=128&d=identicon&r=PG&f=1", "display_name": "sebpardo", "link": "https://stackoverflow.com/users/3798973/sebpardo"}, "reply_to_user": {"reputation": 1189, "user_id": 6030977, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/6UMfc.jpg?s=128&g=1", "display_name": "Shyam Bhimani", "link": "https://stackoverflow.com/users/6030977/shyam-bhimani"}, "edited": false, "score": 0, "creation_date": 1466026535, "post_id": 37845630, "comment_id": 63152620, "body": "@ShyamBhimani rvm manages Ruby versions, not Rails. As I mentioned above, this error happens when using ruby-2.2.1 but not when using a different version, such as 2.3.0."}, {"owner": {"reputation": 1189, "user_id": 6030977, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/6UMfc.jpg?s=128&g=1", "display_name": "Shyam Bhimani", "link": "https://stackoverflow.com/users/6030977/shyam-bhimani"}, "edited": false, "score": 0, "creation_date": 1466028710, "post_id": 37845630, "comment_id": 63153430, "body": "<a href=\"https://strandcode.com/2013/07/11/ruby-version-manager-rvm-overview-for-rails-newbs/\" rel=\"nofollow noreferrer\">strandcode.com/2013/07/11/&hellip;</a> this would be helpful to solve your issue go through with this."}], "owner": {"reputation": 677, "user_id": 3798973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a75b013b0de4acfee1ea863abaddc5e6?s=128&d=identicon&r=PG&f=1", "display_name": "sebpardo", "link": "https://stackoverflow.com/users/3798973/sebpardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466024232, "creation_date": 1466024232, "question_id": 37845630, "link": "https://stackoverflow.com/questions/37845630/rails-version-using-incorrect-version-under-ruby-2-2-1", "title": "`rails _version_` using incorrect version under ruby-2.2.1", "body": "<p>I'm trying to use a specific version of Rails (4.2.2) to create an application, but Rails is using the wrong version. This error only occurs when using ruby-2.2.1; when I switched to ruby-2.3.0 <code>rails _version_</code> behaved as expected.</p>\n\n<p>When I run <code>rails _4.2.2_ new test_app</code>, the generated <code>Gemfile</code> version of rails is:</p>\n\n<pre><code># Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '4.2.5'\n</code></pre>\n\n<p>I have the desired version installed, but the <code>rails _version_</code> command isn't working:</p>\n\n<pre><code>$ gem list | grep '^rails '\nrails (4.2.5, 4.2.2)\n\n$ rails -v\nRails 4.2.5\n\n$ rails _4.2.5_ -v\nRails 4.2.5\n\n$ rails _4.2.2_ -v\nRails 4.2.5\n</code></pre>\n\n<p>Running <code>rails _4.2.1_ -v</code> or any other version that isn't installed throws an error, as expected.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oop"], "comments": [{"owner": {"reputation": 1708, "user_id": 3569921, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/077N5.jpg?s=128&g=1", "display_name": "marcusshep", "link": "https://stackoverflow.com/users/3569921/marcusshep"}, "edited": false, "score": 0, "creation_date": 1466024739, "post_id": 37845467, "comment_id": 63151797, "body": "There might not might a way around it, try using a class rather than a module."}], "answers": [{"tags": [], "owner": {"reputation": 1368, "user_id": 1599940, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7KpaW.png?s=128&g=1", "display_name": "rootatdarkstar", "link": "https://stackoverflow.com/users/1599940/rootatdarkstar"}, "is_accepted": false, "score": 1, "last_activity_date": 1466025238, "creation_date": 1466025238, "answer_id": 37845871, "question_id": 37845467, "link": "https://stackoverflow.com/questions/37845467/can-a-module-class-method-be-called-from-a-class-nested-in-that-module/37845871#37845871", "title": "Can a module class method be called from a class nested in that module?", "body": "<p>With <code>ActiveSupport</code> (you already have it if you use Rails) you can do something like this:</p>\n\n<pre><code>def self.bar\n  self.to_s.deconstantize.constantize.foo\nend\n</code></pre>\n\n<p>More about inflectors:</p>\n\n<p><a href=\"http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html\" rel=\"nofollow\">http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 31711, "user_id": 634576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/48891dab622b535f3c2b4ec1c8765bed?s=128&d=identicon&r=PG", "display_name": "Dave Schweisguth", "link": "https://stackoverflow.com/users/634576/dave-schweisguth"}, "is_accepted": false, "score": 3, "last_activity_date": 1466045504, "last_edit_date": 1466045504, "creation_date": 1466025431, "answer_id": 37845922, "question_id": 37845467, "link": "https://stackoverflow.com/questions/37845467/can-a-module-class-method-be-called-from-a-class-nested-in-that-module/37845922#37845922", "title": "Can a module class method be called from a class nested in that module?", "body": "<p>I'm not aware of a straightforward way to do exactly what you're asking. But you can move <code>A</code>'s self methods to instance methods in another module and have <code>B</code> extend that module:</p>\n\n<pre><code>module A\n  module ClassMethods\n    def foo\n      'hello'\n    end\n  end\n  extend ClassMethods\nend\n\nmodule A\n  class B\n    extend A::ClassMethods\n\n    def self.bar\n      foo\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 793, "user_id": 631816, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4e538c0933c530582481f447049845b2?s=128&d=identicon&r=PG", "display_name": "Craig Kochis", "link": "https://stackoverflow.com/users/631816/craig-kochis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1466045504, "creation_date": 1466023620, "last_edit_date": 1466039066, "question_id": 37845467, "link": "https://stackoverflow.com/questions/37845467/can-a-module-class-method-be-called-from-a-class-nested-in-that-module", "title": "Can a module class method be called from a class nested in that module?", "body": "<p>Is it possible to call a module's class method from a nested class method? For instance, if I had:</p>\n\n<pre><code>module A\n  def self.foo\n    'hello'\n  end\nend\n\nmodule A\n  class B\n    def self.bar\n      foo # Fails since A is not in B's ancestor chain\n    end\n  end\nend\n</code></pre>\n\n<p>I know that I can call <code>foo</code> directly on <code>A</code> by using</p>\n\n<pre><code>def self.bar\n  A.foo\nend\n</code></pre>\n\n<p>But ideally I would like a way to have <code>A</code> be part of <code>B</code>'s ancestor chain if possible. Any tips would be appreciated.</p>\n"}, {"tags": ["ruby", "open-uri", "fragment-identifier"], "comments": [{"owner": {"reputation": 3943, "user_id": 2647317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f163870821b443d585648035a69464?s=128&d=identicon&r=PG", "display_name": "Pooyan Khosravi", "link": "https://stackoverflow.com/users/2647317/pooyan-khosravi"}, "edited": false, "score": 1, "creation_date": 1466023273, "post_id": 37845118, "comment_id": 63151025, "body": "You shouldn&#39;t send a request with a fragment in them. Browsers strip those before sending the request."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1466023973, "post_id": 37845118, "comment_id": 63151362, "body": "Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. When asking about a problem with your code, especially one where it&#39;s with input data, we need the minimal example of the data that duplicates the problem in the question itself. While we can often cobble up something that reproduces the problem, doing so wastes our time and can possibly result in confusion or bad answers if the imagineered data isn&#39;t correct. So, we need you to provide it for us. It saves us time and helps us help you and helps anyone else searching for similar solutions decide if your question is a good match to their needs."}, {"owner": {"reputation": 11, "user_id": 5486983, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153385159223962/picture?type=large", "display_name": "David Dancey", "link": "https://stackoverflow.com/users/5486983/david-dancey"}, "edited": false, "score": 0, "creation_date": 1466115214, "post_id": 37845118, "comment_id": 63197149, "body": "@ the Tin Man Noted with thanks. First question, so the next one will be phrased better. Cheers!"}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1466024466, "post_id": 37845474, "comment_id": 63151666, "body": "It&#39;s a good idea to use URI or Addressable::URI to manipulate URIs. While we can often make changes to URIs without the class, too often they need special encoding that gets missed, but the class automatically provides. Removing <a href=\"http://ruby-doc.org/stdlib-2.3.1/libdoc/uri/rdoc/URI/Generic.html#method-i-fragment-3D\" rel=\"nofollow noreferrer\">a fragment</a> is easy, just assign <code>nil</code> to it: <code>uri.fragment = nil</code>."}], "tags": [], "owner": {"reputation": 3943, "user_id": 2647317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f163870821b443d585648035a69464?s=128&d=identicon&r=PG", "display_name": "Pooyan Khosravi", "link": "https://stackoverflow.com/users/2647317/pooyan-khosravi"}, "is_accepted": true, "score": 0, "last_activity_date": 1466024736, "last_edit_date": 1466024736, "creation_date": 1466023649, "answer_id": 37845474, "question_id": 37845118, "link": "https://stackoverflow.com/questions/37845118/openuri-having-issues-when-passed-urls-with-fragment-identifiers/37845474#37845474", "title": "OpenURI having issues when passed URLs with fragment identifiers", "body": "<h2>Problem</h2>\n\n<p>Fragment part of a URI should not be sent to server.</p>\n\n<p>From <a href=\"https://en.wikipedia.org/wiki/Fragment_identifier\" rel=\"nofollow\">Wikipedia: Fragment Identifier</a></p>\n\n<blockquote>\n  <p>The fragment identifier functions differently than the rest of the URI: namely, its processing is exclusively client-side with no participation from the web server \u2014 of course the server typically helps to determine the MIME type, and the MIME type determines the processing of fragments. When an agent (such as a Web browser) requests a web resource from a Web server, the agent sends the URI to the server, but does not send the fragment. Instead, the agent waits for the server to send the resource, and then the agent processes the resource according to the document type and fragment value.</p>\n</blockquote>\n\n<h2>Solution</h2>\n\n<p>Strip fragment part of a URI before passing it to <code>open</code>.</p>\n\n<pre><code>require \"uri\"\n\nu = URI.parse \"http://example.com#fragment\"\nu.fragment = nil\nu.to_s #=&gt; \"http://example.com\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5486983, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153385159223962/picture?type=large", "display_name": "David Dancey", "link": "https://stackoverflow.com/users/5486983/david-dancey"}, "edited": false, "score": 0, "creation_date": 1466115398, "post_id": 37845795, "comment_id": 63197214, "body": "Thank you! Much appreciated!"}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1466024886, "creation_date": 1466024886, "answer_id": 37845795, "question_id": 37845118, "link": "https://stackoverflow.com/questions/37845118/openuri-having-issues-when-passed-urls-with-fragment-identifiers/37845795#37845795", "title": "OpenURI having issues when passed URLs with fragment identifiers", "body": "<p>You're 90% of the way there. The client is responsible for processing the fragment. </p>\n\n<p>Your code is already using URI to parse the string, so let the parsed object remove the fragment:</p>\n\n<pre><code>require 'open-uri'\nuri = URI.parse('http://foo.com/index.html#bar')\nuri # =&gt; #&lt;URI::HTTP http://foo.com/index.html#bar&gt;\nuri.fragment = nil\nuri # =&gt; #&lt;URI::HTTP http://foo.com/index.html&gt;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5486983, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153385159223962/picture?type=large", "display_name": "David Dancey", "link": "https://stackoverflow.com/users/5486983/david-dancey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 37845474, "answer_count": 2, "score": 1, "last_activity_date": 1466024886, "creation_date": 1466022287, "last_edit_date": 1466024706, "question_id": 37845118, "link": "https://stackoverflow.com/questions/37845118/openuri-having-issues-when-passed-urls-with-fragment-identifiers", "title": "OpenURI having issues when passed URLs with fragment identifiers", "body": "<p>I have a requirement to read a series of URLs from a text file and then retrieve the pages and output a list of links.</p>\n\n<p>The code has issues whenever the input URLs contain fragment identifiers (<code>#</code>). I tried escaping these with <code>%23</code> but this didn't seem to help. </p>\n\n<p>The error given is from OpenURI and is 404.</p>\n\n<pre><code>#requirements\nrequire 'nokogiri'\nrequire 'open-uri'\n#opening each line in input text file\nline_num=0\ntext=File.open('input.txt').read\ntext.gsub!(/\\r\\n?/, \"\\n\")\ntext.each_line do |line|\n    print \"#{line_num += 1} #{line}\"\n    open('output.txt', 'a') { |f|\n        f.puts \"#{line_num} #{line}\"\n    }\n    uri = URI.parse(URI.encode(line.strip))\n    page = Nokogiri::HTML(open(uri))   \n    links = page.css(\"div.product-carousel-container a\")\n    #loop through links if present\n    e = 0\n    while e &lt; links.length\n        open('output.txt', 'a') { |f|\n        f.puts links[e][\"href\"]\n        }\n        e += 1\n    end  \nend\n</code></pre>\n"}, {"tags": ["ruby", "cron", "phantomjs", "ubuntu-14.04", "poltergeist"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1466023985, "post_id": 37845111, "comment_id": 63151369, "body": "It could be that you have a different PATH when you execute the script in the cron job. You could try <code>puts ENV[&quot;PATH&quot;]</code> in the script and see if it&#39;s different. Or you could pass a custom path when invoking the script in the crob job. <code>PATH=$PATH:&#47;something&#47;custom ruby thescript.rb</code>"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1466041429, "post_id": 37845111, "comment_id": 63156617, "body": "since you&#39;re using ubuntu - you can set the environment variables you want available to cron jobs in /etc/environment -- heres a discussion about it - <a href=\"http://askubuntu.com/questions/700107/why-do-variables-set-in-my-etc-environment-show-up-in-my-cron-environment\" title=\"why do variables set in my etc environment show up in my cron environment\">askubuntu.com/questions/700107/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3017, "user_id": 340648, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Tq5Ji.png?s=128&g=1", "display_name": "roy", "link": "https://stackoverflow.com/users/340648/roy"}, "edited": false, "score": 0, "creation_date": 1466023704, "post_id": 37845347, "comment_id": 63151225, "body": "You&#39;re right, I suppose I could do that, but am wondering if there is a way not to have to put it in the script since that is how it has been prior (thought not sure why it just worked then and not now)."}, {"owner": {"reputation": 3943, "user_id": 2647317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f163870821b443d585648035a69464?s=128&d=identicon&r=PG", "display_name": "Pooyan Khosravi", "link": "https://stackoverflow.com/users/2647317/pooyan-khosravi"}, "reply_to_user": {"reputation": 3017, "user_id": 340648, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Tq5Ji.png?s=128&g=1", "display_name": "roy", "link": "https://stackoverflow.com/users/340648/roy"}, "edited": false, "score": 0, "creation_date": 1466023779, "post_id": 37845347, "comment_id": 63151266, "body": "@roy There is. You can call your script like this <code>bash -l -c &#39;&#47;path&#47;to&#47;script&#39;</code>."}, {"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1466320585, "post_id": 37845347, "comment_id": 63262230, "body": "Or you can set the path in the crontab like someone else suggested"}], "tags": [], "owner": {"reputation": 3943, "user_id": 2647317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f163870821b443d585648035a69464?s=128&d=identicon&r=PG", "display_name": "Pooyan Khosravi", "link": "https://stackoverflow.com/users/2647317/pooyan-khosravi"}, "is_accepted": false, "score": 1, "last_activity_date": 1466023158, "creation_date": 1466023158, "answer_id": 37845347, "question_id": 37845111, "link": "https://stackoverflow.com/questions/37845111/ruby-script-cant-find-phantomjs-only-when-run-from-cronjob-ubuntu-14-04/37845347#37845347", "title": "Ruby script can&#39;t find phantomjs only when run from cronjob (ubuntu 14.04)", "body": "<h2>Problem</h2>\n\n<p>When running executables <code>$PATH</code>, which is an array of directories, is searched for that executable.</p>\n\n<p>For example if your <code>$PATH</code> contains <code>/bin</code> you can run <code>phantomjs</code> and <code>/bin</code> will be searched for <code>/bin/phantomjs</code>.</p>\n\n<p>When running scripts from Cron, <code>$PATH</code> contains different directories than what it does when you run that script from <code>bash</code>.</p>\n\n<h2>Solution</h2>\n\n<p>To run an executable without relying on <code>$PATH</code> simply use its absolute path. An absolute path starts with a <code>/</code>.</p>\n\n<ol>\n<li>Run <code>which phantomjs</code> in <code>bash</code>. This will show <code>phantomjs</code>'s absolute path.</li>\n<li>In your script replace <code>phantomjs</code> with its absolute path.</li>\n</ol>\n"}], "owner": {"reputation": 3017, "user_id": 340648, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Tq5Ji.png?s=128&g=1", "display_name": "roy", "link": "https://stackoverflow.com/users/340648/roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466023158, "creation_date": 1466022273, "last_edit_date": 1495541759, "question_id": 37845111, "link": "https://stackoverflow.com/questions/37845111/ruby-script-cant-find-phantomjs-only-when-run-from-cronjob-ubuntu-14-04", "title": "Ruby script can&#39;t find phantomjs only when run from cronjob (ubuntu 14.04)", "body": "<p>I am not sure why this is, but I have phantomjs installed on my server</p>\n\n<pre><code>$which phantomjs\n/usr/local/bin/phantomjs\n</code></pre>\n\n<p>and am running a script from crontab as: </p>\n\n<pre><code>0 */5 * * * /home/roy/.rbenv/shims/ruby /home/roy/SCRIPT/lib/SCRIPT.rb\n</code></pre>\n\n<p>if I just run the exact command from the command line, it will run. </p>\n\n<p>But if it runs from the cronjob, I get:</p>\n\n<pre><code>/home/roy/.rbenv/versions/2.2.3/lib/ruby/gems/2.2.0/gems/cliver-0.3.2/lib/cliver/dependency.rb:143:in \n`raise_not_found!': Could not find an executable [\"phantomjs\"] on your path. (Cliver::Dependency::NotFound)\n</code></pre>\n\n<p>I've already seen this in possible duplicate <a href=\"https://stackoverflow.com/questions/30703886/could-not-find-phantomjs\">Could not find phantomjs</a>, but even if installed, it still does not appear to be working from cron. </p>\n\n<p>Is there any way to check where this might be going wrong? Just for background this has been working as is for about a month, but broke when I tried to update from phantomjs 2.0.0 to phantomjs 2.1.1.</p>\n"}, {"tags": ["mysql", "ruby", "join", "activerecord"], "comments": [{"owner": {"reputation": 3943, "user_id": 2647317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f163870821b443d585648035a69464?s=128&d=identicon&r=PG", "display_name": "Pooyan Khosravi", "link": "https://stackoverflow.com/users/2647317/pooyan-khosravi"}, "edited": false, "score": 0, "creation_date": 1466024407, "post_id": 37845053, "comment_id": 63151629, "body": "I think for this you need an <i>outer join</i> which as far as I know is not what <code>.includes</code> does."}, {"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1466025699, "post_id": 37845053, "comment_id": 63152237, "body": "Please share some of the code you wrote so far. This will help everyone to understand your setup better."}], "owner": {"reputation": 213, "user_id": 6461829, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/259638c804f105d1ccc4ce1a94dc94ab?s=128&d=identicon&r=PG&f=1", "display_name": "yondaimehokage", "link": "https://stackoverflow.com/users/6461829/yondaimehokage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466022108, "creation_date": 1466022108, "question_id": 37845053, "link": "https://stackoverflow.com/questions/37845053/getting-data-from-joined-tables-ruby", "title": "Getting data from joined tables Ruby", "body": "<p>In summary, I need to grab columns from three tables, which all are associated with each other through inbetween tables.</p>\n\n<p>There are four cases with the data:\n1. Has data in table A, has data in table B, has data in table C\n2. Has data in table A, has data in table B, does not have data in table C\n3. Has data in table A, does not have data in table B, has data in table C\n4. Has data in table A, does not have in table B, does not have in table C</p>\n\n<p>Is there a single active record query I can use to get the data for all these cases?  I cannot use join because the query dies if it come across a row missing any of the pieces.  I have tried .includes and .eager_load, but then it does not include the columns from table B or C.</p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1466022739, "post_id": 37844981, "comment_id": 63150775, "body": "According to the version number it looks like that server wasn&#39;t updated in the last 5 years. Almost all version in the stacktrace are unmaintained and unsupported for years now. Does the application at least have a Gemfile with version numbers?"}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 1, "creation_date": 1466022971, "post_id": 37844981, "comment_id": 63150884, "body": "You can try to run <code>gem update --system 1.8.25 --no-rdoc --no-ri</code> and see if that completes the downgrade."}, {"owner": {"reputation": 323, "user_id": 549572, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3a909f25195da29abc7cac1631cda6d?s=128&d=identicon&r=PG", "display_name": "Kevin Kohler", "link": "https://stackoverflow.com/users/549572/kevin-kohler"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1466024593, "post_id": 37844981, "comment_id": 63151725, "body": "@Casper THANK YOU! post an answer and i will accept it."}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 549572, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3a909f25195da29abc7cac1631cda6d?s=128&d=identicon&r=PG", "display_name": "Kevin Kohler", "link": "https://stackoverflow.com/users/549572/kevin-kohler"}, "edited": false, "score": 0, "creation_date": 1466022654, "post_id": 37845173, "comment_id": 63150731, "body": "Thank you so much for your answer. i believe the gems isnt downgrading. its  bluetube@Megatron ~ $ gem -v 2.6.4"}, {"owner": {"reputation": 323, "user_id": 549572, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3a909f25195da29abc7cac1631cda6d?s=128&d=identicon&r=PG", "display_name": "Kevin Kohler", "link": "https://stackoverflow.com/users/549572/kevin-kohler"}, "edited": false, "score": 0, "creation_date": 1466022689, "post_id": 37845173, "comment_id": 63150751, "body": "after trying to down grade it gem update --system 1.8.25"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1466022495, "creation_date": 1466022495, "answer_id": 37845173, "question_id": 37844981, "link": "https://stackoverflow.com/questions/37844981/updated-ruby-gems-and-broke-the-whole-site/37845173#37845173", "title": "Updated Ruby gems and broke the whole site", "body": "<p>When you update the system gems, the versions bump. Your project is loading some of the new versions, and something's not working.</p>\n\n<p>You should first try to cd into your app and run <code>bundle</code> (or <code>sudo bundle</code>, if you have it set up this way). This will use your <code>Gemfile.lock</code> to find the correct versions to install.</p>\n\n<p>If things still aren't working, try and pinpoint which gem is failing and specify a working version in the Gemfile. Something like <code>gem 'mygem', '~&gt; 1.0.0'</code> where the version is known to be working. Then run <code>bundle</code> or <code>sudo bundle</code> to update. </p>\n\n<p>You should try and keep your production machine in parity with your local environment. The same Ruby version should be used and ideally a similar architecture. That way the same gems will be installed both places and you can debug locally. </p>\n\n<p>I'd also heard the recommendation to isolate your project's gems from your system's. You could use <code>rbenv</code> or <code>RVM</code> to do this. Then you'd no longer use <code>sudo</code> to install gems. Thought I'm not sure if that'd fix anything here. </p>\n"}, {"tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 2, "last_activity_date": 1466024938, "creation_date": 1466024938, "answer_id": 37845809, "question_id": 37844981, "link": "https://stackoverflow.com/questions/37844981/updated-ruby-gems-and-broke-the-whole-site/37845809#37845809", "title": "Updated Ruby gems and broke the whole site", "body": "<p>Your gem downgrade process is failing because it can't generate the documentation (probably an RDoc version problem).</p>\n\n<p>You can try to run the downgrade without generating the docs like this:</p>\n\n<pre><code>gem update --system 1.8.25 --no-rdoc --no-ri \n</code></pre>\n\n<p>See if that helps complete the downgrade...</p>\n"}], "owner": {"reputation": 323, "user_id": 549572, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3a909f25195da29abc7cac1631cda6d?s=128&d=identicon&r=PG", "display_name": "Kevin Kohler", "link": "https://stackoverflow.com/users/549572/kevin-kohler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 37845809, "answer_count": 2, "score": 0, "last_activity_date": 1466086654, "creation_date": 1466021858, "last_edit_date": 1466086654, "question_id": 37844981, "link": "https://stackoverflow.com/questions/37844981/updated-ruby-gems-and-broke-the-whole-site", "title": "Updated Ruby gems and broke the whole site", "body": "<p>I was trying to install a website on a linux box and i was getting gems errors and google told me to update gems.  So I did.. Comes to find out the site was their production and its now down.  I ran the following command and now this happens.</p>\n\n<pre><code>sudo gem update --system\n</code></pre>\n\n<p>I have tried: <code>gem update --system 1.8.25</code>  </p>\n\n<p>And got the following error:</p>\n\n<pre><code> Updating rubygems-update\n    Fetching: rubygems-update-1.8.25.gem (100%)\n    Successfully installed rubygems-update-1.8.25\n    Parsing documentation for rubygems-update-1.8.25\n    file 'hide_lib_for_update' not found\n    file 'History.txt' not found\n    file 'LICENSE.txt' not found\n    file 'MIT.txt' not found\n    file 'Manifest.txt' not found\n    file 'README.rdoc' not found\n    file 'UPGRADING.rdoc' not found\n    file 'hide_lib_for_update/note.txt' not found\n    ERROR:  While executing gem ... (NoMethodError)\n        undefined method `store' for #&lt;RDoc::RDoc:0x7fe8216341e0&gt;\n</code></pre>\n\n<p>Below is the full error message on the screen.  I am really new to rails and ruby. </p>\n\n<pre><code>Error message:\nno such file to load -- rubygems/source_index (MissingSourceFile)\nException class:\nPhusionPassenger::UnknownError\nApplication root:\n\n\n0   /usr/lib64/rubyee/site_ruby/1.8/rubygems.rb 982 in `_deprecated_source_index'\n1   /usr/lib64/rubyee/site_ruby/1.8/rubygems/deprecate.rb   39  in `skip_during'\n2   /usr/lib64/rubyee/site_ruby/1.8/rubygems.rb 981 in `_deprecated_source_index'\n3   /usr/lib64/rubyee/site_ruby/1.8/rubygems/deprecate.rb   63  in `send'\n4   /usr/lib64/rubyee/site_ruby/1.8/rubygems/deprecate.rb   63  in `source_index'\n5   /usr/lib64/ruby/gems/1.8/gems/rails-2.3.14/lib/rails/gem_dependency.rb  21  in `add_frozen_gem_path'\n6   /usr/lib64/ruby/gems/1.8/gems/rails-2.3.14/lib/initializer.rb   298 in `add_gem_load_paths'\n7   /usr/lib64/ruby/gems/1.8/gems/rails-2.3.14/lib/initializer.rb   132 in `process'\n8   /usr/lib64/ruby/gems/1.8/gems/rails-2.3.14/lib/initializer.rb   113 in `send'\n9   /usr/lib64/ruby/gems/1.8/gems/rails-2.3.14/lib/initializer.rb   113 in `run'\n11  /usr/lib64/rubyee/site_ruby/1.8/rubygems/custom_require.rb  36  in `gem_original_require'\n12  /usr/lib64/rubyee/site_ruby/1.8/rubygems/custom_require.rb  36  in `require'\n13  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/classic_rails/application_spawner.rb   222 in `preload_application'\n14  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/classic_rails/application_spawner.rb   181 in `initialize_server'\n15  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/utils.rb   572 in `report_app_init_status'\n16  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/classic_rails/application_spawner.rb   174 in `initialize_server'\n17  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb 204 in `start_synchronously'\n18  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb 180 in `start'\n19  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/classic_rails/application_spawner.rb   149 in `start'\n20  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb   219 in `spawn_rails_application'\n21  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server_collection.rb  132 in `lookup_or_add'\n22  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb   214 in `spawn_rails_application'\n23  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server_collection.rb  82  in `synchronize'\n24  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server_collection.rb  79  in `synchronize'\n25  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb   213 in `spawn_rails_application'\n26  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb   132 in `spawn_application'\n27  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb   275 in `handle_spawn_application'\n28  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb 357 in `__send__'\n29  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb 357 in `server_main_loop'\n30  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb 206 in `start_synchronously'\n31  /usr/lib64/ruby/gems/1.8/gems/passenger-3.0.11/helper-scripts/passenger-spawn-server    99  \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 3943, "user_id": 2647317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f163870821b443d585648035a69464?s=128&d=identicon&r=PG", "display_name": "Pooyan Khosravi", "link": "https://stackoverflow.com/users/2647317/pooyan-khosravi"}, "edited": false, "score": 3, "creation_date": 1466022277, "post_id": 37844811, "comment_id": 63150533, "body": "You are asking multiple questions. One of them is to how to model your data and another one is how to send an email. Please edit down to one specific problem then tell us what you have done to solve it and what went wrong."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1466023486, "post_id": 37844811, "comment_id": 63151117, "body": "If you don&#39;t know where to start with steps 1 and 2, go through a Rails tutorial. To send an email, you don&#39;t really need a gem. <a href=\"https://launchschool.com/blog/handling-emails-in-rails\" rel=\"nofollow noreferrer\">here</a> is a tutorial. Make sure you don&#39;t accidentally put your Gmail password on Github."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1466023539, "post_id": 37844811, "comment_id": 63151142, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1789032/send-email-from-localhost\">send email from localhost</a>"}], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 6472945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2f81b0ddb4f35ba94fee0ca04b71f?s=128&d=identicon&r=PG&f=1", "display_name": "shubhs", "link": "https://stackoverflow.com/users/6472945/shubhs"}, "is_accepted": true, "score": 0, "last_activity_date": 1466059672, "last_edit_date": 1466059672, "creation_date": 1466057562, "answer_id": 37851201, "question_id": 37844811, "link": "https://stackoverflow.com/questions/37844811/model-sends-email-to-another-model/37851201#37851201", "title": "Model sends email to another model", "body": "<p>It's not a big deal. Use the action mailer and specify the other model (recruiter) there and the mail can be sent to the specified recruiter. It must be somehow like this.</p>\n\n<pre><code>class UserMailer &lt; ApplicationMailer\n\ndef subscription_confirmation(recruiter,user)\n\n@recruiter = recruiter\n@user = user\nmail to: recruiter.email, subject: \"A New request has been Added\"\n</code></pre>\n\n<p>end\nend</p>\n"}], "owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 37851201, "answer_count": 1, "score": 0, "last_activity_date": 1466059672, "creation_date": 1466021288, "question_id": 37844811, "link": "https://stackoverflow.com/questions/37844811/model-sends-email-to-another-model", "title": "Model sends email to another model", "body": "<p>Im looking at all these job sites, which allow users to apply for jobs posted by recruiter. When you click the apply button, it usually send the recruiter an email with some details about the user. </p>\n\n<ol>\n<li>2 different models</li>\n<li>User clicks apply on the job posted by a recruiter</li>\n<li>an email is sent to the recruiter</li>\n</ol>\n\n<p>Im not sure where to start? are the any gems that could help with this task, or what would be the best way in achieving this?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4776684"}, "edited": false, "score": 1, "creation_date": 1466021531, "post_id": 37844688, "comment_id": 63150144, "body": "Your question is unclear. Please try to rephrase it."}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1466021626, "creation_date": 1466021626, "answer_id": 37844909, "question_id": 37844688, "link": "https://stackoverflow.com/questions/37844688/ordering-results-by-boolean-attribute-equals-false/37844909#37844909", "title": "Ordering results by boolean attribute equals false", "body": "<p>I would try something like this:</p>\n\n<pre><code>@most_hated_news = News.joins(:likes)\n                       .where('likes.like = ?', false)\n                       .group('news.id')\n                       .order('COUNT(likes.id) DESC').first\n</code></pre>\n"}], "owner": {"reputation": 897, "user_id": 4645227, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/50d116f701889e0977127909fc1ce8d5?s=128&d=identicon&r=PG&f=1", "display_name": "Prezes \u0141ukasz", "link": "https://stackoverflow.com/users/4645227/prezes-%c5%81ukasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 37844909, "answer_count": 1, "score": 1, "last_activity_date": 1502452596, "creation_date": 1466020841, "last_edit_date": 1502452596, "question_id": 37844688, "link": "https://stackoverflow.com/questions/37844688/ordering-results-by-boolean-attribute-equals-false", "title": "Ordering results by boolean attribute equals false", "body": "<p>I want write properly query to get the most hated news.\nCurrent query:</p>\n\n<pre><code>@most_hated_news = News.joins(:likes).where('likes.like = ?', false).order('likes.like DESC').first\n</code></pre>\n\n<p>Schema of likes table:</p>\n\n<pre><code># Table name: likes\n#\n#  id        :integer          not null, primary key\n#  like      :boolean\n#  person_id :integer          not null\n#  news_id   :integer          not null\n</code></pre>\n\n<p>I want to get news, that has most likes equal false.\nThe problem is, that query doesn't care ordering likes with false value and return news with most positive likes. \nIt return news with 3 positive(most) likes and 1 negative. I have in database news with 2 negative(most).\nHow to write correctly?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19, "user_id": 6076203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MSEhvr_UMoE/AAAAAAAAAAI/AAAAAAAAAEc/-fSNSZ6b_n8/photo.jpg?sz=128", "display_name": "Lalit Motagi", "link": "https://stackoverflow.com/users/6076203/lalit-motagi"}, "edited": false, "score": 0, "creation_date": 1466090421, "post_id": 37844634, "comment_id": 63183685, "body": "I was able to get it done by saving the current path in a variable and then changing the directory of execution to dir_open using <code>Dir.chdir()</code>. Once I completed my processing, changed back to current path.  I want to know if there is any other elegant way of handling this?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6076203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MSEhvr_UMoE/AAAAAAAAAAI/AAAAAAAAAEc/-fSNSZ6b_n8/photo.jpg?sz=128", "display_name": "Lalit Motagi", "link": "https://stackoverflow.com/users/6076203/lalit-motagi"}, "edited": false, "score": 0, "creation_date": 1466022196, "post_id": 37844845, "comment_id": 63150490, "body": "still getting the same error. No such file or directory. I believe the path has to be included in some way when I want to open the file. Not able to figure out how."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 19, "user_id": 6076203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MSEhvr_UMoE/AAAAAAAAAAI/AAAAAAAAAEc/-fSNSZ6b_n8/photo.jpg?sz=128", "display_name": "Lalit Motagi", "link": "https://stackoverflow.com/users/6076203/lalit-motagi"}, "edited": false, "score": 0, "creation_date": 1466022578, "post_id": 37844845, "comment_id": 63150704, "body": "What is the value of <code>in_file</code> that is being passed to <code>File.readlines</code>? Is should be a string filepath."}, {"owner": {"reputation": 19, "user_id": 6076203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MSEhvr_UMoE/AAAAAAAAAAI/AAAAAAAAAEc/-fSNSZ6b_n8/photo.jpg?sz=128", "display_name": "Lalit Motagi", "link": "https://stackoverflow.com/users/6076203/lalit-motagi"}, "edited": false, "score": 0, "creation_date": 1466024596, "post_id": 37844845, "comment_id": 63151728, "body": "in_file has only the filename. dir_open has the relative path. Do I have to do Dir.chdir() before trying to read the files?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1466025390, "post_id": 37844845, "comment_id": 63152092, "body": "Using <code>readlines</code> can lead to problems. See <a href=\"http://stackoverflow.com/q/25189262/128421\">stackoverflow.com/q/25189262/128421</a> Stick with <code>foreach</code> as it&#39;s an acceptable way to read a file."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1466021408, "creation_date": 1466021408, "answer_id": 37844845, "question_id": 37844634, "link": "https://stackoverflow.com/questions/37844634/opening-certain-files-from-a-directory-using-ruby/37844845#37844845", "title": "opening certain files from a directory using Ruby", "body": "<p>With this chunk right here:</p>\n\n<pre><code>  input_file = File.open( in_file, \"r\" )\n  File.foreach(input_file).with_index do | line, line_s |\n     puts line\n  end\n</code></pre>\n\n<p>You could instead write <code>File.readlines(in_file).each { |f| puts f }</code></p>\n\n<p><code>File.readlines</code> will return an array where each element is a line of the text. </p>\n"}], "owner": {"reputation": 19, "user_id": 6076203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MSEhvr_UMoE/AAAAAAAAAAI/AAAAAAAAAEc/-fSNSZ6b_n8/photo.jpg?sz=128", "display_name": "Lalit Motagi", "link": "https://stackoverflow.com/users/6076203/lalit-motagi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466021408, "creation_date": 1466020673, "question_id": 37844634, "link": "https://stackoverflow.com/questions/37844634/opening-certain-files-from-a-directory-using-ruby", "title": "opening certain files from a directory using Ruby", "body": "<p>I am facing a certain problem while trying to open files from a directory ( the directory is provided on the command line )</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>require 'optparse'\nOptionParser.new do |opts|\n   opts.banner = \"Usage: rubyfile.rb [options]\"\n\n   options[:c] = \"\"\n   opts.on( '-c', '--dir DILE', \"Specify Directory with input files\" ) do |e|\n      options[:c] = e\n   end\n\n   options[:o] = \"\"\n   opts.on( '-o', '--dir DILE', \"Specify Output file\" ) do |f|\n      options[:c] = f\n   end\nend.parse!\n\nout_file = File.open( options[:o], \"a\" )\ndir_open = Dir.open( options[:c] )\n\nDir.foreach(dir_open) do | in_file |\n   next if File.directory? in_file\n   if( in_file.include? \".txt\" )\n      input_file = File.open( in_file, \"r\" )\n      File.foreach(input_file).with_index do | line, line_s |\n         puts line\n      end\n   end\nend\n</code></pre>\n\n<p>If I try to print out the file names using puts in_file, it works. But when I try to open the file and dump out its contents, it does not.</p>\n\n<p>I know I am missing something here not able to pinpoint what it is though.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "json", "drop-down-menu"], "comments": [{"owner": {"reputation": 2278, "user_id": 2244501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231d8805a81cf94c09ff60cdba6e4029?s=128&d=identicon&r=PG", "display_name": "retgoat", "link": "https://stackoverflow.com/users/2244501/retgoat"}, "edited": false, "score": 0, "creation_date": 1466067255, "post_id": 37844218, "comment_id": 63167044, "body": "Could you please provide an example of needed dropdown box? Which values do you expect to have there? Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 4830289, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e43cb0ab53bb917d651c23a613de070c?s=128&d=identicon&r=PG&f=1", "display_name": "techguy", "link": "https://stackoverflow.com/users/4830289/techguy"}, "is_accepted": false, "score": 1, "last_activity_date": 1466082599, "creation_date": 1466082599, "answer_id": 37860281, "question_id": 37844218, "link": "https://stackoverflow.com/questions/37844218/populate-drop-down-list-from-array-in-ruby/37860281#37860281", "title": "populate drop down list from array in ruby", "body": "<p>The answer ended up being</p>\n\n<pre><code>def country_selection_input options = {}\ncountries = transaction_form.get_countries()[:Countries]\noptions.reverse_merge!(\n  :attribute =&gt; :country_iso,\n  :collection =&gt; countries,\n  :label_method =&gt; :Name,\n  :value_method =&gt; :IsoCode,\n  :input_html =&gt; {},\n  :prompt =&gt; 'please select',\n  :label =&gt; 'To Where'\n)\n\ncall_input_from_args_hash options\n</code></pre>\n\n<p>end</p>\n"}], "owner": {"reputation": 47, "user_id": 4830289, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e43cb0ab53bb917d651c23a613de070c?s=128&d=identicon&r=PG&f=1", "display_name": "techguy", "link": "https://stackoverflow.com/users/4830289/techguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1466082599, "creation_date": 1466019091, "last_edit_date": 1466019786, "question_id": 37844218, "link": "https://stackoverflow.com/questions/37844218/populate-drop-down-list-from-array-in-ruby", "title": "populate drop down list from array in ruby", "body": "<p>I have a country list that I have called in - and have parsed into the following format:</p>\n\n<pre><code>{\"Countries\"=&gt;[{\"Name\"=&gt;\"ABKHAZIA\", \"IsoCode\"=&gt;\"AB\", \"HasTown\"=&gt;\"I\"}, {\"Name\"=&gt;\"ANGUILLA\", \"IsoCode\"=&gt;\"AI\", \"HasTown\"=&gt;\"I\"}, {\"Name\"=&gt;\"ANTIGUA\", \"IsoCode\"=&gt;\"AG\", \"HasTown\"=&gt;\"I\"}, .... {\"Name\"=&gt;\"ZIMBABWE\", \"IsoCode\"=&gt;\"ZW\", \"HasTown\"=&gt;\"I\"}]}\n</code></pre>\n\n<p>I want to populate a drop down list with this data.  Code I am using to create the drop down box is:</p>\n\n<pre><code>def country_selection_input options = {}\noptions.reverse_merge!(\n  :attribute =&gt; :country_iso,\n  :collection =&gt; transaction_form.get_countries,\n  :input_html =&gt; {},\n  :prompt =&gt; 'please select',\n  :label =&gt; 'To Where'\n)\n</code></pre>\n\n<p>This gives me a  drop down box with a please select prompt and a list that consists of only the one word: Countries.</p>\n\n<p>The data is there - but I am not sure how to get it into the drop down list - and am sure I am missing something simple. \nI have tried</p>\n\n<pre><code>:label_method =&gt; :Name,\n</code></pre>\n\n<p>but get an error message of</p>\n\n<pre><code>undefined method `Name' for #&lt;Array:0x007fc385cecbb0&gt;\n</code></pre>\n\n<p>This will probably turn into a menu as I want to take action based on the country selected - but - this is the first step - getting the list to work.</p>\n"}, {"tags": ["ruby", "concurrency", "sidekiq"], "answers": [{"tags": [], "owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "is_accepted": true, "score": 1, "last_activity_date": 1466019315, "creation_date": 1466019315, "answer_id": 37844272, "question_id": 37844126, "link": "https://stackoverflow.com/questions/37844126/how-to-manage-connections-with-sidekiq/37844272#37844272", "title": "How to manage connections with Sidekiq?", "body": "<p>Sidekiq basically does this when executing each job: <code>HardWorker.new.perform</code>.  So, yes.</p>\n"}], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 37844272, "answer_count": 1, "score": 0, "last_activity_date": 1466019315, "creation_date": 1466018728, "question_id": 37844126, "link": "https://stackoverflow.com/questions/37844126/how-to-manage-connections-with-sidekiq", "title": "How to manage connections with Sidekiq?", "body": "<p>Each worker should have it's own resource connection. I read the docs, but it wasn't clear if each thread runs a separate instance of the worker.</p>\n\n<p>If so, does this create a connection that is unique to each worker?</p>\n\n<pre><code>class HardWorker\n  include Sidekiq::Worker\n\n  def perform \n    connection.send 'message'\n  end\n\n  def connection\n    @connection ||= Connection.new\n  end\nend\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "haversine"], "answers": [{"comments": [{"owner": {"reputation": 1217, "user_id": 1180008, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/FdMdK.jpg?s=128&g=1", "display_name": "Nubtacular", "link": "https://stackoverflow.com/users/1180008/nubtacular"}, "edited": false, "score": 0, "creation_date": 1466175405, "post_id": 37845152, "comment_id": 63224046, "body": "Great point on <code>pop</code> and the useless arrays, didn&#39;t think that through. Worked great, thank you."}], "tags": [], "owner": {"reputation": 31711, "user_id": 634576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/48891dab622b535f3c2b4ec1c8765bed?s=128&d=identicon&r=PG", "display_name": "Dave Schweisguth", "link": "https://stackoverflow.com/users/634576/dave-schweisguth"}, "is_accepted": true, "score": 2, "last_activity_date": 1466022395, "creation_date": 1466022395, "answer_id": 37845152, "question_id": 37844121, "link": "https://stackoverflow.com/questions/37844121/ruby-haversine-formula-iterating-through-two-arrays/37845152#37845152", "title": "Ruby Haversine Formula: Iterating Through Two Arrays", "body": "<p>I suspect your problem is that you're popping your coordinates out of the one-element arrays. That permanently modifies each array. When you do it in a loop, the second time through the loop the arrays will be empty.</p>\n\n<p>The quick fix would be to use <code>.last</code> (which just returns the last element of the array rather than removing it) rather than <code>.pop</code>. Since there is only one column in each CSV, <code>.first</code> and <code>.last</code> are equivalent.</p>\n\n<p>However, I suggest rewriting the part of your code that you didn't include in the question. The loops over the arrays read from your CSVs don't do anything useful at all; they just copy the arrays to new arrays.</p>\n\n<p>Instead, strip off the one-element arrays, <code>zip</code> those, and then loop over the result:</p>\n\n<pre><code>fib_coords = fib_lat.map(&amp;:last).zip(fib_long.map(&amp;:last))\ncust_coords = cust_lat.map(&amp;:last).zip(cust_long.map(&amp;:last))\nfib_coords.each do |fib_lat, fib_long|\n  cust_coords.each do |cust_lat, cust_long|\n    # ...\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1217, "user_id": 1180008, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/FdMdK.jpg?s=128&g=1", "display_name": "Nubtacular", "link": "https://stackoverflow.com/users/1180008/nubtacular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 37845152, "answer_count": 1, "score": 0, "last_activity_date": 1473031059, "creation_date": 1466018707, "last_edit_date": 1473031059, "question_id": 37844121, "link": "https://stackoverflow.com/questions/37844121/ruby-haversine-formula-iterating-through-two-arrays", "title": "Ruby Haversine Formula: Iterating Through Two Arrays", "body": "<p>I'm having trouble iterating through two arrays using the haversine Ruby gem. </p>\n\n<p>I'll post the full gist here but give you an idea of what I'm trying to accomplish.</p>\n\n<p><a href=\"https://gist.github.com/ornerymoose/c4a45540304706e78191894dfe6b2539\" rel=\"nofollow\">https://gist.github.com/ornerymoose/c4a45540304706e78191894dfe6b2539</a></p>\n\n<p>We have a fiber network. Just think about it as lines on a map. I have all the lat/long pairs that make up this network, roughly 24,000 rows.</p>\n\n<p>We have potential customers that are in the area of the fiber network. We want to see what customers are within 1,000 feet of our network. For our potential customers, we have roughly 3,000 rows. </p>\n\n<p>The Haversine formula takes four arguments: lat1, long1, lat2, long2. The first two will represent the customer, the second two will represent the fiber network. </p>\n\n<p>For a hardcoded customer location, I can do this and it returns the correct value in feet. Verified via Google Earth. </p>\n\n<pre><code>File.open('distance-output.csv', 'w') do |csv_object|\n    lat.zip(long).each do |lat_locs,long_locs|  \n        csv_object &lt;&lt; Haversine.distance(28.59569, -81.21464, lat_locs.pop.to_f, long_locs.pop.to_f).to_feet\n        csv_object &lt;&lt; \"\\n\"\n    end\nend\n</code></pre>\n\n<p><strong>Now, how would I implement the same type of <code>.zip</code> setup for the customer lat/long data?</strong></p>\n\n<p>If I wrap <code>lat.zip(long).each do |lat_locs,long_locs|</code> in the customer <code>.zip</code>, it returns values but incorrect (like, really incorrect). If I wrap the customer <code>zip</code> block in <code>lat.zip(long).each do |lat_locs,long_locs|</code>, the returned values are also incorrect. </p>\n\n<p>Any input on this is greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "paypal", "paypal-sandbox", "paypal-adaptive-payments"], "comments": [{"owner": {"reputation": 840, "user_id": 5608743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/McaK8.jpg?s=128&g=1", "display_name": "Athrun Zara", "link": "https://stackoverflow.com/users/5608743/athrun-zara"}, "edited": false, "score": 0, "creation_date": 1466056432, "post_id": 37843430, "comment_id": 63160682, "body": "Have you file a ticket with MTS support? You can the issue and give me the MTS ticket number here."}, {"owner": {"reputation": 25535, "user_id": 1188826, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c4071e94510c720ca76cb25e87f1e198?s=128&d=identicon&r=PG", "display_name": "Drew Angell", "link": "https://stackoverflow.com/users/1188826/drew-angell"}, "edited": false, "score": 0, "creation_date": 1466069656, "post_id": 37843430, "comment_id": 63168717, "body": "Sounds like maybe your execute call is getting hit twice in a row, and the response you&#39;re seeing is from the second one..??"}], "owner": {"reputation": 81, "user_id": 6471097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165e7271e9fc73b7ca11447dd73b19d6?s=128&d=identicon&r=PG&f=1", "display_name": "chndt", "link": "https://stackoverflow.com/users/6471097/chndt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1466016340, "creation_date": 1466016340, "question_id": 37843430, "link": "https://stackoverflow.com/questions/37843430/paypal-delayed-chained-payments-releasing-to-secondary-receivers-returns-payke", "title": "PayPal Delayed Chained Payments: Releasing to secondary receivers returns &quot;payKey AP-XXXX has already been used to make a payment&quot;", "body": "<p>I am using the paypal-sdk-adaptivepayments (1.117.1) gem in my Rails application to provide Delayed Chained Payments and Preapprovals. The payment process has three steps, whereas the above mentioned error pops up in the last one (as always). Here's the process:</p>\n\n<ol>\n<li><p>A user pre-approves (using <a href=\"https://developer.paypal.com/docs/classic/adaptive-payments/ht_ap-basicPreapproval-curl-etc/\" rel=\"nofollow\">PayPal's Preapproval</a>) an upcoming delayed chained payment. So far, everything works fine. I get a <code>preapprovalKey</code> back and save that.</p></li>\n<li><p>When the time comes, I trigger a <a href=\"https://developer.paypal.com/docs/classic/adaptive-payments/ht_ap-delayedChainedPayment-curl-etc/\" rel=\"nofollow\">Delayed Chained Payment</a> using the previously saved <code>preapprovalKey</code>. In this action I use the <code>actionType: \"PAY_PRIMARY\"</code>. Again, everything's fine and I get a <code>payKey</code> which I save.</p></li>\n<li><p>Now, a bit later I want to release the money of the DCP from step 2 to the secondary receiver(s). To do that, I use the <code>payKey</code> I got back step 2.</p></li>\n</ol>\n\n<p>And here comes the error:</p>\n\n<blockquote>\n  <p>AP-XXXX has already been used to make a payment\n  The funny thing is that in contrast to this error message, the payment <em>was release successfully</em>, as depicted in the PayPal Dashboard.</p>\n</blockquote>\n\n<p>It is of course no game breaker, since the Payment is still executed, but still there must be something wrong ...</p>\n\n<p>The code for step 3 is the following:</p>\n\n<pre><code>@api = PayPal::SDK::AdaptivePayments::API.new\n\n@execute_payment = @api.build_execute_payment({\n  payKey: @job.payKey\n})\n\n@response = @api.execute_payment(@execute_payment)\n</code></pre>\n\n<p>I am using PayPal in the Sandbox environment. The project is using Rails 4.2.3.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1466016809, "post_id": 37843424, "comment_id": 63147575, "body": "Have you tried <code>bundle exec rails g migration ...</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4776684"}, "edited": false, "score": 0, "creation_date": 1466016958, "post_id": 37843424, "comment_id": 63147651, "body": "Do <code>bundle install | grep database_cleaner</code> and see what is installed for database_cleaner,"}, {"owner": {"reputation": 4694, "user_id": 5670861, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/vxPrL.png?s=128&g=1", "display_name": "EQuimper", "link": "https://stackoverflow.com/users/5670861/equimper"}, "edited": false, "score": 0, "creation_date": 1466017283, "post_id": 37843424, "comment_id": 63147817, "body": "This is what I got <code>Using database_cleaner 1.5.3</code>"}, {"owner": {"reputation": 4694, "user_id": 5670861, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/vxPrL.png?s=128&g=1", "display_name": "EQuimper", "link": "https://stackoverflow.com/users/5670861/equimper"}, "edited": false, "score": 0, "creation_date": 1466017342, "post_id": 37843424, "comment_id": 63147856, "body": "with bundle exec I got the same problem"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4776684"}, "edited": false, "score": 0, "creation_date": 1466017361, "post_id": 37843424, "comment_id": 63147868, "body": "Also, try to run your migration as following <code>bundle exec rails g migration add_user_id_to_posts user:references</code>. It will make sure that you are using the current bundler."}, {"owner": {"reputation": 4694, "user_id": 5670861, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/vxPrL.png?s=128&g=1", "display_name": "EQuimper", "link": "https://stackoverflow.com/users/5670861/equimper"}, "edited": false, "score": 0, "creation_date": 1466017458, "post_id": 37843424, "comment_id": 63147924, "body": "I did it and nothing change"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4776684"}, "edited": false, "score": 1, "creation_date": 1466017491, "post_id": 37843424, "comment_id": 63147941, "body": "Have you tried to open another terminal?"}, {"owner": {"reputation": 4694, "user_id": 5670861, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/vxPrL.png?s=128&g=1", "display_name": "EQuimper", "link": "https://stackoverflow.com/users/5670861/equimper"}, "edited": false, "score": 0, "creation_date": 1466017852, "post_id": 37843424, "comment_id": 63148149, "body": "So I open new terminal and got the same problem but the gem web-console. I install it again do the migration with bundle and now nothing happen in 2 min just waiting."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4776684"}, "edited": false, "score": 0, "creation_date": 1466018449, "post_id": 37843424, "comment_id": 63148494, "body": "@EmanuelQuimper: Does it work now?"}, {"owner": {"reputation": 4694, "user_id": 5670861, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/vxPrL.png?s=128&g=1", "display_name": "EQuimper", "link": "https://stackoverflow.com/users/5670861/equimper"}, "edited": false, "score": 0, "creation_date": 1466018508, "post_id": 37843424, "comment_id": 63148525, "body": "Nop so I closed everything open new terminal rerun my migration and database_cleaner missing again"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4776684"}, "edited": false, "score": 0, "creation_date": 1466018974, "post_id": 37843424, "comment_id": 63148771, "body": "With <code>bundle exec</code>? For some reason your migrations are looking into a wrong place. If there is a way for you to start from scratch, do it."}, {"owner": {"reputation": 4694, "user_id": 5670861, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/vxPrL.png?s=128&g=1", "display_name": "EQuimper", "link": "https://stackoverflow.com/users/5670861/equimper"}, "edited": false, "score": 0, "creation_date": 1466019222, "post_id": 37843424, "comment_id": 63148909, "body": "Yes with <code>bundle exec</code> thank for the help."}], "answers": [{"tags": [], "owner": {"reputation": 4694, "user_id": 5670861, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/vxPrL.png?s=128&g=1", "display_name": "EQuimper", "link": "https://stackoverflow.com/users/5670861/equimper"}, "is_accepted": true, "score": 0, "last_activity_date": 1466022824, "creation_date": 1466022824, "answer_id": 37845262, "question_id": 37843424, "link": "https://stackoverflow.com/questions/37843424/rails-5-gem-database-cleaner-not-find/37845262#37845262", "title": "Rails 5 gem database_cleaner not find", "body": "<p>Find the solution with the help of someone on Slack. I got my spring always running so I have just need to do <code>spring stop</code> and everything work like a charm after.</p>\n\n<p>Thank you all for the help.</p>\n"}], "owner": {"reputation": 4694, "user_id": 5670861, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/vxPrL.png?s=128&g=1", "display_name": "EQuimper", "link": "https://stackoverflow.com/users/5670861/equimper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 37845262, "answer_count": 1, "score": 0, "last_activity_date": 1466022824, "creation_date": 1466016322, "question_id": 37843424, "link": "https://stackoverflow.com/questions/37843424/rails-5-gem-database-cleaner-not-find", "title": "Rails 5 gem database_cleaner not find", "body": "<p>I'm not new to rails but was a long time I didn't used it. Today was trying to build something and get this.</p>\n\n<p>I try to run a standard</p>\n\n<pre><code>rails g migration add_user_id_to_posts user:references\n</code></pre>\n\n<p>And I always get this message in the terminal </p>\n\n<pre><code>Could not find database_cleaner-1.5.3 in any of the sources\nRun `bundle install` to install missing gems.\n</code></pre>\n\n<p>But when I check in the Gemfile I have </p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '&gt;= 5.0.0.rc1', '&lt; 5.1'\ngem 'pg', '~&gt; 0.18'\ngem 'puma', '~&gt; 3.0'\ngem 'sass-rails', '~&gt; 5.0'\ngem 'uglifier', '&gt;= 1.3.0'\ngem 'coffee-rails', '~&gt; 4.1.0'\ngem 'jquery-rails'\ngem 'turbolinks', '~&gt; 5.x'\ngem 'jbuilder', '~&gt; 2.0'\ngem 'responders', '~&gt; 2.2'\ngem 'devise', '~&gt; 4.1', '&gt;= 4.1.1'\n\ngroup :development, :test do\n  gem 'byebug', platform: :mri\n  gem \"rails-controller-testing\", :git =&gt; \"https://github.com/rails/rails-controller-testing\"\n  gem \"rspec-rails\", \"3.5.0.beta3\"\nend\n\ngroup :development do\n  gem 'web-console'\n  gem 'listen', '~&gt; 3.0.5'\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\ngroup :test do\n  gem 'capybara', '~&gt; 2.7', '&gt;= 2.7.1'\n  gem 'database_cleaner', '~&gt; 1.5.3'\nend\n\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>I try everything I find in the net. I deleted my <code>Gemfile.lock</code> and do <code>bundle install</code> again. I install the new version of ruby the 2.3.1.</p>\n\n<p>But I can't figured out what to do. If someone can help me with this, would be appreciate.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 255, "user_id": 1530704, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/7FUDv.jpg?s=128&g=1", "display_name": "A N", "link": "https://stackoverflow.com/users/1530704/a-n"}, "edited": false, "score": 0, "creation_date": 1466015434, "post_id": 37843033, "comment_id": 63146725, "body": "Have you tried any code logic? please post it here."}, {"owner": {"reputation": 1551, "user_id": 4380542, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/nJSw1.jpg?s=128&g=1", "display_name": "Uday kumar das", "link": "https://stackoverflow.com/users/4380542/uday-kumar-das"}, "reply_to_user": {"reputation": 255, "user_id": 1530704, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/7FUDv.jpg?s=128&g=1", "display_name": "A N", "link": "https://stackoverflow.com/users/1530704/a-n"}, "edited": false, "score": 0, "creation_date": 1466016238, "post_id": 37843033, "comment_id": 63147239, "body": "I have updated the code."}], "answers": [{"comments": [{"owner": {"reputation": 1551, "user_id": 4380542, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/nJSw1.jpg?s=128&g=1", "display_name": "Uday kumar das", "link": "https://stackoverflow.com/users/4380542/uday-kumar-das"}, "edited": false, "score": 0, "creation_date": 1466016175, "post_id": 37843173, "comment_id": 63147192, "body": "Can you plz give complete solution.Thanks."}, {"owner": {"reputation": 2752, "user_id": 1238737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f12344b1086944a8189571259e2ede1?s=128&d=identicon&r=PG", "display_name": "snkashis", "link": "https://stackoverflow.com/users/1238737/snkashis"}, "reply_to_user": {"reputation": 1551, "user_id": 4380542, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/nJSw1.jpg?s=128&g=1", "display_name": "Uday kumar das", "link": "https://stackoverflow.com/users/4380542/uday-kumar-das"}, "edited": false, "score": 0, "creation_date": 1466016662, "post_id": 37843173, "comment_id": 63147486, "body": "Updated with quick hack to fix this, would suggest solving this problem in your saved input format instead of doing this on every parse..."}], "tags": [], "owner": {"reputation": 2752, "user_id": 1238737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f12344b1086944a8189571259e2ede1?s=128&d=identicon&r=PG", "display_name": "snkashis", "link": "https://stackoverflow.com/users/1238737/snkashis"}, "is_accepted": false, "score": 3, "last_activity_date": 1466016614, "last_edit_date": 1466016614, "creation_date": 1466015461, "answer_id": 37843173, "question_id": 37843033, "link": "https://stackoverflow.com/questions/37843033/read-all-contents-of-a-txt-file-and-parse-it-to-json-format/37843173#37843173", "title": "read all contents of a txt file and parse it to JSON format", "body": "<p>If you can strip out the leading and trailing <code>'</code> with gsub or something else, it's as simple as </p>\n\n<pre><code>require 'JSON'\nJSON.parse(File.open('demo.txt').read.chop!.reverse.chop!.reverse)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1466025326, "creation_date": 1466025326, "answer_id": 37845895, "question_id": 37843033, "link": "https://stackoverflow.com/questions/37843033/read-all-contents-of-a-txt-file-and-parse-it-to-json-format/37845895#37845895", "title": "read all contents of a txt file and parse it to JSON format", "body": "<p>The file contains this string.</p>\n\n<pre><code>str =\n\"'{\n   \\\"cars\\\": {\n     \\\"Nissan\\\": [\n       {\\\"model\\\":\\\"Sentra\\\", \\\"doors\\\":4},\n       {\\\"model\\\":\\\"Maxima\\\", \\\"doors\\\":4}\n     ]\n   }\n  }'\"\n  #=&gt; \"'{\\n   \\\"cars\\\": {\\n     \\\"Nissan\\\": [\\n       {\\\"model\\\":\\\"Sentra\\\", \\\"doors\\\":4},\\n       {\\\"model\\\":\\\"Maxima\\\", \\\"doors\\\":4}\\n     ]\\n   }\\n  }'\"\n</code></pre>\n\n<p>Let's create the file.</p>\n\n<pre><code>FName = 'temp'\n\nFile.write(FName, str)\n  #=&gt; 152 \n</code></pre>\n\n<p>We can JSON-parse the file after removing the single quotes.</p>\n\n<pre><code>require 'json'\n\nJSON.parse(File.read(FName)[1..-2])\n  #=&gt; {\"cars\"=&gt;{\"Nissan\"=&gt;[{\"model\"=&gt;\"Sentra\", \"doors\"=&gt;4},\n  #                        {\"model\"=&gt;\"Maxima\", \"doors\"=&gt;4}]}} \n</code></pre>\n\n<p>If the last line of the file ends with a newline, the file would be</p>\n\n<pre><code>str1 = str + \"\\n\"\n  #=&gt; \"'{\\n   \\\"cars\\\": {\\n     \\\"Nissan\\\": [\\n       {\\\"model\\\":\\\"Sentra\\\", \\\"doors\\\":4},\\n       {\\\"model\\\":\\\"Maxima\\\", \\\"doors\\\":4}\\n     ]\\n   }\\n  }'\\n\" \nFile.write(FName, str1)\n  #=&gt; 153\n</code></pre>\n\n<p>In this case we need to <code>chomp</code> before <code>[1..-2]</code>.</p>\n\n<pre><code>JSON.parse(File.read(FName).chomp[1..-2])\n  #=&gt; {\"cars\"=&gt;{\"Nissan\"=&gt;[{\"model\"=&gt;\"Sentra\", \"doors\"=&gt;4}, {\"model\"=&gt;\"Maxima\", \"doors\"=&gt;4}]}} \n</code></pre>\n\n<p>We could have instead written</p>\n\n<pre><code>JSON.parse(File.read(FName)[1..-3])\n</code></pre>\n\n<p>but the former has the advantage that it works regardless of whether the file ends with a newline.</p>\n"}], "owner": {"reputation": 1551, "user_id": 4380542, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/nJSw1.jpg?s=128&g=1", "display_name": "Uday kumar das", "link": "https://stackoverflow.com/users/4380542/uday-kumar-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 37845895, "answer_count": 2, "score": 0, "last_activity_date": 1466025326, "creation_date": 1466015045, "last_edit_date": 1466016111, "question_id": 37843033, "link": "https://stackoverflow.com/questions/37843033/read-all-contents-of-a-txt-file-and-parse-it-to-json-format", "title": "read all contents of a txt file and parse it to JSON format", "body": "<p>In <code>demo.txt</code> file:</p>\n\n<pre><code>'{\n  \"cars\": {\n    \"Nissan\": [\n      {\"model\":\"Sentra\", \"doors\":4},\n      {\"model\":\"Maxima\", \"doors\":4}\n    ]\n  }\n}'\n</code></pre>\n\n<p>Expected result:</p>\n\n<pre><code>{\n  \"cars\" =&gt; {\n    \"Nissan\" =&gt; [\n      {\n        \"model\"=&gt;\"Sentra\", \n        \"doors\"=&gt;4\n      },\n      {\n        \"model\" =&gt; \"Maxima\",\n        \"doors\"=&gt;4\n      }\n    ]\n  }\n}\n</code></pre>\n\n<p>I want to read whole content of the file and parse it to JSON format like <code>JSON.parse(file_contents)</code>.Help me out.</p>\n\n<p>I have tried like:</p>\n\n<pre><code>file_contents = File.readlines 'demo.txt'  \narr = []\nfile_contents.each do |d|\n  puts arr &lt;&lt; d.gsub(\"\\n\",\"\")\nend\nputs arr # [\"'{\", \"\\\"cars\\\": {\", \"\\\"Nissan\\\": [\", \"{\\\"model\\\":\\\"Sentra\\\", \\\"doors\\\":4},\", \"{\\\"model\\\":\\\"Maxima\\\", \\\"doors\\\":4}\", \"]\", \"}\", \"}'\"]\n\nputs arr * '' #\"'{\\\"cars\\\": {\\\"Nissan\\\": [{\\\"model\\\":\\\"Sentra\\\", \\\"doors\\\":4},{\\\"model\\\":\\\"Maxima\\\", \\\"doors\\\":4}]}}'\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rails-i18n"], "answers": [{"tags": [], "owner": {"reputation": 2278, "user_id": 2244501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231d8805a81cf94c09ff60cdba6e4029?s=128&d=identicon&r=PG", "display_name": "retgoat", "link": "https://stackoverflow.com/users/2244501/retgoat"}, "is_accepted": false, "score": 2, "last_activity_date": 1466064419, "last_edit_date": 1466064419, "creation_date": 1466064113, "answer_id": 37853271, "question_id": 37842701, "link": "https://stackoverflow.com/questions/37842701/how-to-list-all-available-locale-keys-in-rails/37853271#37853271", "title": "How to list all available locale keys in Rails?", "body": "<p>I do not pretend that this is a uniqe right solution, but this code works for me.</p>\n\n<pre><code># config/initializers/i18n.rb\nmodule I18n\n  class &lt;&lt; self\n    def get_keys(hsh = nil, parent = nil, ary = [])\n      hsh = YAML.load_file(\"config/locales/en.yml\") unless hsh\n      keys = hsh.keys\n      keys.each do |key|\n        if hsh.fetch(key).is_a?(Hash)\n          get_keys(hsh.fetch(key), \"#{parent}.#{key}\", ary)\n        else\n          keys.each do |another|\n            ary &lt;&lt; \"#{parent}.#{another}\"[1..-1]\n          end\n        end\n      end\n      ary.uniq\n    end\n  end\nend\n</code></pre>\n\n<p>Result</p>\n\n<pre><code>[14] pry(main)&gt; I18n.get_keys\n=&gt; [\"en.car.honda.civic.name\", \"en.car.honda.civic.description\", \"en.car.ferrari.la_ferrari.name\", \"en.car.ferrari.la_ferrari.description\", \"en.car.suzuki.escudo.name\", \"en.car.suzuki.escudo.description\"]\n</code></pre>\n\n<p>My <code>en.yml</code></p>\n\n<pre><code>en:\n  car:\n    honda:\n      civic:\n        name: 'Civic'\n        description: 'Entry Level Sedan'\n    ferrari:\n      la_ferrari:\n        name: 'La Ferrari'\n        description: 'Supercar'\n    suzuki:\n      escudo:\n        name: 'Escudo'\n        description: 'SUV'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1466065055, "creation_date": 1466065055, "answer_id": 37853582, "question_id": 37842701, "link": "https://stackoverflow.com/questions/37842701/how-to-list-all-available-locale-keys-in-rails/37853582#37853582", "title": "How to list all available locale keys in Rails?", "body": "<p>This is a script I've written when I had to deal with this. Working great for me. </p>\n\n<pre><code>#! /usr/bin/env ruby\n\nrequire 'yaml'\n\nfilename = if ARGV.length == 1\n  ARGV[0]\nelsif ARGV.length == 0\n  \"/path/to/project/config/locales/new.yml\"\nend\n\nunless filename\n  puts \"Usage: flat_print.rb filename\"\n  exit(1)\nend\n\nhash = YAML.load_file(filename)\nhash = hash[hash.keys.first]\n\ndef recurse(obj, current_path = [], &amp;block)\n  if obj.is_a?(String)\n    path = current_path.join('.')\n    yield [path, obj]\n  elsif obj.is_a?(Hash)\n    obj.each do |k, v|\n      recurse(v, current_path + [k], &amp;block)\n    end\n  end\nend\n\nrecurse(hash) do |path, value|\n  puts path\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 368, "user_id": 2820927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jiKSg.jpg?s=128&g=1", "display_name": "WillHaslett", "link": "https://stackoverflow.com/users/2820927/willhaslett"}, "is_accepted": false, "score": 1, "last_activity_date": 1610117837, "last_edit_date": 1610117837, "creation_date": 1606255057, "answer_id": 64995460, "question_id": 37842701, "link": "https://stackoverflow.com/questions/37842701/how-to-list-all-available-locale-keys-in-rails/64995460#64995460", "title": "How to list all available locale keys in Rails?", "body": "<p>To get an array of available locales:</p>\n<pre><code>I18n.available_locales\n</code></pre>\n<p>I recommend avoiding putting multiple locales in one YAML file. If you need to do so for some processing-related reason, you can always concatenate the files on the fly with, e.g., your *NIX shell:</p>\n<p>...to a file</p>\n<pre><code>cat my_app/config/locales/*.yml &gt;&gt; locales.yml\n</code></pre>\n<p>...or to another processs</p>\n<pre><code>cat my_app/config/locales/*.yml | command_that_takes_stdin -\n</code></pre>\n"}], "owner": {"reputation": 951, "user_id": 717216, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/24825a1dc9410edc67f68c38bfb1ccf5?s=128&d=identicon&r=PG", "display_name": "absessive", "link": "https://stackoverflow.com/users/717216/absessive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2342, "favorite_count": 1, "accepted_answer_id": 37853582, "answer_count": 3, "score": 2, "last_activity_date": 1610117837, "creation_date": 1466013962, "question_id": 37842701, "link": "https://stackoverflow.com/questions/37842701/how-to-list-all-available-locale-keys-in-rails", "title": "How to list all available locale keys in Rails?", "body": "<p>My locale file has become unwieldy with a bunch of nested keys. Is there a way to get a list of all available locale keys, or all locale keys from a single locale file?</p>\n\n<p>For eg.</p>\n\n<pre><code>en:\n  car:\n     honda:\n          civic:\n               name: 'Civic'\n               description: 'Entry Level Sedan'\n     ferrari:\n          la_ferrari:\n               name: 'La Ferrari'\n               description: 'Supercar'\n</code></pre>\n\n<p>This locale should return the list of keys, which in this case is</p>\n\n<pre><code>['en.car.honda.civic.name', 'en.car.honda.civic.description',\n'en.ferrari.la_ferrari.name', 'en.car.ferrari.la_ferrari.name.description']\n</code></pre>\n\n<p>Is there a Rails (I18n) helper to do this?\nThe other way is to iterate over the parsed YAML.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rails-api"], "comments": [{"owner": {"reputation": 602, "user_id": 5065438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306841f540dc52fdc68605d254c522ac?s=128&d=identicon&r=PG&f=1", "display_name": "Jovica \u0160u\u0161a", "link": "https://stackoverflow.com/users/5065438/jovica-%c5%a0u%c5%a1a"}, "edited": false, "score": 0, "creation_date": 1466012381, "post_id": 37842122, "comment_id": 63145084, "body": "Shouldn&#39;t it be - location: episode_url(episode) ?"}, {"owner": {"reputation": 4542, "user_id": 766198, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/bERkx.jpg?s=128&g=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/766198/jean"}, "reply_to_user": {"reputation": 602, "user_id": 5065438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306841f540dc52fdc68605d254c522ac?s=128&d=identicon&r=PG&f=1", "display_name": "Jovica \u0160u\u0161a", "link": "https://stackoverflow.com/users/5065438/jovica-%c5%a0u%c5%a1a"}, "edited": false, "score": 0, "creation_date": 1466012462, "post_id": 37842122, "comment_id": 63145122, "body": "@Jovica\u0160u\u0161a I tried that, but get the same error."}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1466012702, "post_id": 37842122, "comment_id": 63145238, "body": "Do you have corresponding  <code>show</code> route and action?"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1466012724, "post_id": 37842122, "comment_id": 63145254, "body": "@Jean <code>episode_path(episode)</code> ?"}, {"owner": {"reputation": 4542, "user_id": 766198, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/bERkx.jpg?s=128&g=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/766198/jean"}, "reply_to_user": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1466012789, "post_id": 37842122, "comment_id": 63145290, "body": "@Vasfed I justed paste my route on the question."}, {"owner": {"reputation": 4542, "user_id": 766198, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/bERkx.jpg?s=128&g=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/766198/jean"}, "reply_to_user": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1466012857, "post_id": 37842122, "comment_id": 63145325, "body": "@Vasfed same error but this time ..undefined method `episode_path&#39;...."}], "answers": [{"comments": [{"owner": {"reputation": 4542, "user_id": 766198, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/bERkx.jpg?s=128&g=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/766198/jean"}, "edited": false, "score": 0, "creation_date": 1466013374, "post_id": 37842364, "comment_id": 63145595, "body": "Thanks for your help, it solve my question, but now I have the following failure: -&quot;<a href=\"http://api.example.com/episodes.980190963\" rel=\"nofollow noreferrer\">api.example.com/episodes.980190963</a>&quot; +&quot;<a href=\"http://api.example.com/episodes/980190963\" rel=\"nofollow noreferrer\">api.example.com/episodes/980190963</a>&quot; as you can see the action send me this url <a href=\"http://api.example.com/episodes.980190963\" rel=\"nofollow noreferrer\">api.example.com/episodes.980190963</a> with a dot before the id instead / what can be the problem?"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 4542, "user_id": 766198, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/bERkx.jpg?s=128&g=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/766198/jean"}, "edited": false, "score": 0, "creation_date": 1466015752, "post_id": 37842364, "comment_id": 63146941, "body": "@Jean <code>location</code> is passed to <code>url_for</code> as-is, looks like it generates a route to index action with record id in <code>:format</code> place. If polymorphic route does not work for some reason - you can pass hash or even a ready url - <code>api_episode_url(episode)</code>"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 1, "last_activity_date": 1466012908, "creation_date": 1466012908, "answer_id": 37842364, "question_id": 37842122, "link": "https://stackoverflow.com/questions/37842122/how-to-send-location-after-create-action/37842364#37842364", "title": "How to send location after `create` action", "body": "<p>This is because of namespace, use <code>[:api, episode]</code> for <code>location</code></p>\n"}], "owner": {"reputation": 4542, "user_id": 766198, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/bERkx.jpg?s=128&g=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/766198/jean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 37842364, "answer_count": 1, "score": 0, "last_activity_date": 1466012908, "creation_date": 1466012165, "last_edit_date": 1466012763, "question_id": 37842122, "link": "https://stackoverflow.com/questions/37842122/how-to-send-location-after-create-action", "title": "How to send location after `create` action", "body": "<p>I have the following <code>create</code> action:</p>\n\n<pre><code>def create\n  episode = Episode.new(episode_params)\n  if episode.save\n    render json: episode, status: :created, location: episode\n  end\nend\n</code></pre>\n\n<p>but when I test the following:</p>\n\n<pre><code>require 'test_helper'\n\nclass CreatingEpisodesTest &lt; ActionDispatch::IntegrationTest\n  setup { host! 'api.example.com'}\n\n  test 'create episodes' do\n    post '/episodes',\n      { episode:\n          { title: 'Bananas', description: 'Learn about bananas.' }\n      }.to_json,\n      { 'Accept' =&gt; Mime::JSON, 'Content-Type' =&gt; Mime::JSON.to_s }\n\n    assert_equal 200, response.status\n    assert_equal Mime::JSON, response.content_type\n\n    episode = json(response.body)\n    assert_equal \"/episodes/#{episode[:id]}\", response.location\n  end\nend\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>1) Error: CreatingEpisodesTest#test_create_episodes: NoMethodError: undefined method `episode_url' for #&lt;API::EpisodesController:0x007f8e34519450&gt; Did you mean?  episode_params\napp/controllers/api/episodes_controller.rb:11:in `create'\ntest/integration/creating_episodes_test.rb:7:in `block in #&lt;class:CreatingEpisodesTest&gt;'\n\n1 runs, 0 assertions, 0 failures, 1 errors, 0 skips\n</code></pre>\n\n<p>I guest I miss something to send the location after I create the episode.</p>\n\n<h2>UPDATE: Route</h2>\n\n<pre><code>Rails.application.routes.draw do\n  namespace :api, path: '/', constraints: { subdomain: 'api' } do\n    resources :zombies\n    resources :episodes\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1466011016, "post_id": 37841486, "comment_id": 63144365, "body": "<code>next</code> is a reserved keyword. You cannot use it as a method. Are you sure that <code>next</code> is even called correctly?"}, {"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 1, "creation_date": 1466011958, "post_id": 37841486, "comment_id": 63144868, "body": "Not the error you are dealing with at the moment, but you almost certainly don&#39;t want those attr_accessors"}], "answers": [{"tags": [], "owner": {"reputation": 3994, "user_id": 37019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4354cb7ba5e9c6a01f77eb8de753b62?s=128&d=identicon&r=PG", "display_name": "danielrsmith", "link": "https://stackoverflow.com/users/37019/danielrsmith"}, "is_accepted": false, "score": 0, "last_activity_date": 1466010170, "creation_date": 1466010170, "answer_id": 37841557, "question_id": 37841486, "link": "https://stackoverflow.com/questions/37841486/rails-says-that-an-instantiated-variable-is-nil/37841557#37841557", "title": "Rails says that an instantiated variable is nil", "body": "<p>No, instance variables are not shared between calls, they are \"shared\" between methods since they are a property of the object (being the controller, and yes I know the word shared is not a good term).  You can either pass an id of the session into the URL (<code>params[:session_id]</code>) or store it in <code>session</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 0, "last_activity_date": 1466011367, "creation_date": 1466011367, "answer_id": 37841910, "question_id": 37841486, "link": "https://stackoverflow.com/questions/37841486/rails-says-that-an-instantiated-variable-is-nil/37841910#37841910", "title": "Rails says that an instantiated variable is nil", "body": "<p><code>@variables</code> are instance variables, not class ones. Rails creates an instance of your controller for every request, so instance variables will not help. Also keep in mind that consequent requests may not come to the same rails worker process.</p>\n\n<p>You can use rails <code>session</code> to store a few data in cookies and init your <code>Session</code> from these:</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n    def start\n        session[:current_question] = 1\n        session[:correct_answers] = 0\n        @currentQuestion = Question.find(session[:current_question])\n        render 'session'\n    end\n\n    def next\n        session[:current_question] += 1\n        @currentQuestion = Question.find(session[:current_question])\n        render 'session'\n    end\nend\n</code></pre>\n\n<p>See <a href=\"http://guides.rubyonrails.org/action_controller_overview.html#accessing-the-session\" rel=\"nofollow\">rails guide for session</a></p>\n"}], "owner": {"reputation": 318, "user_id": 4992160, "user_type": "registered", "accept_rate": 26, "profile_image": "https://graph.facebook.com/682839341822419/picture?type=large", "display_name": "\u041a\u0440\u0438\u0441\u0438 \u0421\u0442\u043e\u044f\u043d\u043e\u0432", "link": "https://stackoverflow.com/users/4992160/%d0%9a%d1%80%d0%b8%d1%81%d0%b8-%d0%a1%d1%82%d0%be%d1%8f%d0%bd%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1466011367, "creation_date": 1466009916, "last_edit_date": 1466010849, "question_id": 37841486, "link": "https://stackoverflow.com/questions/37841486/rails-says-that-an-instantiated-variable-is-nil", "title": "Rails says that an instantiated variable is nil", "body": "<p>I am creating a quiz site. I have a class <code>Session</code>, which holds the current question and the number of questions that the person has gotten right and a controller with <code>start</code> and <code>next</code> methods. </p>\n\n<p>Here is the session model:</p>\n\n<pre><code>class Session &lt; ActiveRecord::Base\n    attr_accessor :questionNumber, :currentQuestion, :correctQuestions\n\n    def start\n        self.questionNumber = 1\n        self.correctQuestions = 0\n    end\nend\n</code></pre>\n\n<p>And this is the sessions controller:</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n    def start\n        @currentSession = Session.new\n        @currentSession.start\n        @currentSession.currentQuestion = Question.find(@currentSession.questionNumber)\n        render 'session'\n    end\n\n    def next\n        @currentSession.questionNumber += 1\n        @currentSession.currentQuestion = Question.find(@currentSession.questionNumber)\n        render 'session'\n    end\nend\n</code></pre>\n\n<p>I call <code>start</code> from a link in my view, and when they answer a question, I call <code>next</code> (again from the view). I get the error: <code>\"undefined method `questionNumber' for nil:NilClass\"</code></p>\n\n<p>How do I keep <code>@currentSession</code> from being reset to <code>nil</code> between method calls? Aren't <code>@</code> variables shared in the class?</p>\n"}, {"tags": ["ruby", "init.d"], "comments": [{"owner": {"reputation": 2172, "user_id": 4412925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7fa1503a3820659b27943c99d463a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel", "link": "https://stackoverflow.com/users/4412925/nabeel"}, "edited": false, "score": 0, "creation_date": 1466010150, "post_id": 37840667, "comment_id": 63143873, "body": "At the top of your target file (/opt/newrelic_rb_plugin/newrelic_redborder_agent) add <code>puts $LOAD_PATH</code> and run it using <code>service ... start</code>. After that run it again the way it works and check if there are any differences."}], "answers": [{"comments": [{"owner": {"reputation": 780, "user_id": 5239372, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1707c072d0d35dacf2a8ccbdbdd415f0?s=128&d=identicon&r=PG", "display_name": "Fran Rios", "link": "https://stackoverflow.com/users/5239372/fran-rios"}, "edited": false, "score": 0, "creation_date": 1466068166, "post_id": 37842117, "comment_id": 63167669, "body": "It works but I need to run a <code>cd PATH_TO_PROJECT</code>previously in the script cause config dir is not configurable inside NR Ruby SDK. Thank you very much."}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 1, "last_activity_date": 1466012156, "creation_date": 1466012156, "answer_id": 37842117, "question_id": 37840667, "link": "https://stackoverflow.com/questions/37840667/require-in-init-d-script/37842117#37842117", "title": "Require in Init.d script", "body": "<p>Error text suggests that you're using RVM, but it is loaded only at user login and thus is not available in init-scripts by default.</p>\n\n<p>Use <code>rvm do</code> to run a command with rvm enabled:</p>\n\n<pre><code>/usr/local/rvm/bin/rvm ruby-2.1.2 do /opt/newrelic_rb_plugin/newrelic_redborder_agent &gt; /dev/null &amp;\n</code></pre>\n\n<p>(you may need to correct for the exact installed ruby version and gemset name, if any is used)</p>\n"}], "owner": {"reputation": 780, "user_id": 5239372, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1707c072d0d35dacf2a8ccbdbdd415f0?s=128&d=identicon&r=PG", "display_name": "Fran Rios", "link": "https://stackoverflow.com/users/5239372/fran-rios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 37842117, "answer_count": 1, "score": 1, "last_activity_date": 1466012156, "creation_date": 1466007210, "question_id": 37840667, "link": "https://stackoverflow.com/questions/37840667/require-in-init-d-script", "title": "Require in Init.d script", "body": "<p>I've done an init.d script in order to start a newrelic plugin as daemon. The problem is that when I run <code>service rb_nr_agent start</code> it has some errors related with \"require\". Output:</p>\n\n<pre><code>[root@device newrelic_rb_plugin]# /usr/local/rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- snmp (LoadError)\nfrom /usr/local/rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\nfrom /opt/newrelic_rb_plugin/newrelic_redborder_agent:5:in `&lt;main&gt;'  \n</code></pre>\n\n<p><code>[root@device newrelic_rb_plugin]# ./rb_nr_agent start Starting rb_nr_agent:[  OK  ]</code></p>\n\n<p>It doesn't start properly. When I run the same script but in the root path of the project it doesn't have any error and it works fine. The init.d is a copy of that one. Here you have the start option of the script:</p>\n\n<pre><code>start() {\n    RESULT=`ps aux | grep $executable | grep -c -v grep`\n    if [ \"${RESULT:-null}\" -ge \"1\" ]; then\n      echo \"$prog is currently running\"\n    else\n      echo -n \"Starting $prog: \"\n      /opt/newrelic_rb_plugin/newrelic_redborder_agent &gt; /dev/null &amp;\n      RETVAL=$?\n      if [ $RETVAL -eq 0 ]; then\n       echo_success\n      else\n       echo_failure; failure\n       RETVAL=1\n      fi\n      echo\n    fi \n    return $RETVAL }\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex", "gsub"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1466007046, "post_id": 37840461, "comment_id": 63142055, "body": "It seems like in this example you could change the <code>words_to_link</code> array to have only one element. Currently it has the same word twice."}, {"owner": {"reputation": 456, "user_id": 1213306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41f44109c87f57c2fb8932b97e686150?s=128&d=identicon&r=PG", "display_name": "alexanderkustov", "link": "https://stackoverflow.com/users/1213306/alexanderkustov"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1466007092, "post_id": 37840461, "comment_id": 63142085, "body": "Yes, this is a simplified example, but the array can have repetitions"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1466007187, "post_id": 37840461, "comment_id": 63142150, "body": "It seems like this wouldn&#39;t work if the array had repetitions."}, {"owner": {"reputation": 456, "user_id": 1213306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41f44109c87f57c2fb8932b97e686150?s=128&d=identicon&r=PG", "display_name": "alexanderkustov", "link": "https://stackoverflow.com/users/1213306/alexanderkustov"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1466007287, "post_id": 37840461, "comment_id": 63142213, "body": "Is there an alternate way to approach this multiple substituiton @maxpleaner ?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 2, "creation_date": 1466009971, "post_id": 37840461, "comment_id": 63143791, "body": "Try out regular expressions on <a href=\"http://rubular.com\" rel=\"nofollow noreferrer\">rubular.com</a>. I think the posted answer is a good approach. Not sure about the word boundaries problem."}], "answers": [{"comments": [{"owner": {"reputation": 456, "user_id": 1213306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41f44109c87f57c2fb8932b97e686150?s=128&d=identicon&r=PG", "display_name": "alexanderkustov", "link": "https://stackoverflow.com/users/1213306/alexanderkustov"}, "edited": false, "score": 0, "creation_date": 1466008638, "post_id": 37840767, "comment_id": 63143041, "body": "Thank you for the regex bit, I will reflect on the code you posted to flip mine more around it."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 1, "last_activity_date": 1466007553, "creation_date": 1466007553, "answer_id": 37840767, "question_id": 37840461, "link": "https://stackoverflow.com/questions/37840461/multiple-gsub-in-multiple-each-loops-getting-overriden-one-by-another/37840767#37840767", "title": "Multiple `gsub` in multiple `each` loops getting overriden one by another", "body": "<p>I'm a little confused by your question, so may have got the wrong end of the stick here. However, here is an answer by my interpretation:</p>\n\n<pre><code>phrases = [\"hello world\", \"worldwide\"] \nsubstitutions = { /\\bworld\\b/ =&gt; \"world\" } \n\nphrases.each do |ph| \n  substitutions.each do |pattern, replacement| \n    ph.gsub!(pattern, \"&lt;a href='#{replacement}'&gt;#{replacement}&lt;/a&gt;\") \n  end \nend\n\nphrases.join(\"&lt;br /&gt;\").html_safe\n</code></pre>\n\n<p>You can use <code>\\b</code> in a regex to mark a work boundary, to avoid altering the <code>\"worldwide\"</code> string. And (I <em>think</em> this is what you wanted?) you can define some <em>mapping</em> between the search/replace terms rather than looping though twice, to avoid the double-replacement.</p>\n"}], "owner": {"reputation": 456, "user_id": 1213306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41f44109c87f57c2fb8932b97e686150?s=128&d=identicon&r=PG", "display_name": "alexanderkustov", "link": "https://stackoverflow.com/users/1213306/alexanderkustov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 37840767, "answer_count": 1, "score": -1, "last_activity_date": 1466009064, "creation_date": 1466006484, "last_edit_date": 1466009064, "question_id": 37840461, "link": "https://stackoverflow.com/questions/37840461/multiple-gsub-in-multiple-each-loops-getting-overriden-one-by-another", "title": "Multiple `gsub` in multiple `each` loops getting overriden one by another", "body": "<p>Trying to iterate over some phrases, and whenever I find a word, I need to replace it with a link.</p>\n\n<pre><code>phrases = [\"hello world\", \"worldwide\"]\nwords_to_link = [\"world\", \"world\"]\n</code></pre>\n\n<p>I am trying to get:</p>\n\n<pre><code>\"hello &lt;a href='world'&gt;world&lt;/a&gt;&lt;br /&gt;worldwide\"\n</code></pre>\n\n<p>My code is:</p>\n\n<pre><code>phrases.each do |ph|\n  words_to_link.each do |w|\n    ph.gsub!(w, \"&lt;a href='#{w}'&gt;#{w}&lt;/a&gt;\")\n  end\nend.join(\"&lt;br /&gt;\").html_safe\n</code></pre>\n\n<p>The output of this is:</p>\n\n<p><code>\"hello &lt;a href='&lt;a href='world'&gt;world&lt;/a&gt;'&gt;&lt;a href='world'&gt;world&lt;/a&gt;&lt;/a&gt;&lt;br /&gt;&lt;a href='&lt;a href='world'&gt;world&lt;/a&gt;'&gt;&lt;a href='world'&gt;world&lt;/a&gt;&lt;/a&gt;wide\"</code></p>\n\n<p>On the first run it finds all occurrences of <code>world</code>, but on the second, it goes inside the generated <code>&lt;a href=\"#world\"&gt;world&lt;/a&gt;</code> and <code>gsub</code>s again.</p>\n\n<p>Another problem is the proper regex to only find words by boundaries, I thought it would be <code>/\\b(word)\\b</code>, but that didn't work.</p>\n\n<p>Any pointers?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 6443001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t64Bn.png?s=128&g=1", "display_name": "&#201;ric C&#244;t&#233;", "link": "https://stackoverflow.com/users/6443001/%c3%89ric-c%c3%b4t%c3%a9"}, "is_accepted": true, "score": 1, "last_activity_date": 1466008894, "creation_date": 1466008894, "answer_id": 37841181, "question_id": 37840368, "link": "https://stackoverflow.com/questions/37840368/rspec-takes-long-time-to-load-files-when-using-httparty/37841181#37841181", "title": "RSpec takes long time to load files when using HTTParty", "body": "<p>I would advise against calling an outside service from Rspecs. Take a look at webmock gem and try to mock the outside service call. Here's an example to mock all Amazon S3 requests in <code>spec_helper.rb</code>:</p>\n\n<pre><code>config.before(:each) do\n    stub_request(:any, /.*s3.amazonaws.com.*/).to_return(:status =&gt; 200, :body =&gt; \"\", :headers =&gt; {})\nend\n</code></pre>\n\n<p>That way you can mock the response expected in <code>body</code>.</p>\n\n<p>As per your question, I don't see any reason why HTTParty could be so slow under Rspecs, might be related to your specific calls and/or the outside service used.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 775, "user_id": 2001053, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/IdGSk.jpg?s=128&g=1", "display_name": "Leo Le", "link": "https://stackoverflow.com/users/2001053/leo-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "accepted_answer_id": 37841181, "answer_count": 1, "score": 1, "last_activity_date": 1466030458, "creation_date": 1466006232, "last_edit_date": 1466030458, "question_id": 37840368, "link": "https://stackoverflow.com/questions/37840368/rspec-takes-long-time-to-load-files-when-using-httparty", "title": "RSpec takes long time to load files when using HTTParty", "body": "<p>My application use HTTParty to send request (in order to crawl data). I write some rspec test to test the sending request service. My sending request service spec include tags to exclude when I run all spec tests in my application:</p>\n\n<pre><code>RSpec.describe SearchFlight::Jet::SearchFlightRequest do\n  describe 'send search ticket request to Jetstar website', http_request: true do\n    context 'search ticket round trip successfully' do\n      # initialize\n      it 'return status 200' do\n        # my expects here ...\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>When I run</p>\n\n<pre><code>bundle exec rspec --tag ~http_request\n</code></pre>\n\n<p>I took over 4 minutes to load and 1.86s for finished test with run options (exclude {:http_request=>true)</p>\n\n<p>If I delete sending request service spec, the time to load file is about 3.02 seconds.</p>\n\n<p>What is the different ? Why did request service spec took a long time while I excluded them ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cucumber", "watir", "watir-webdriver"], "comments": [{"owner": {"reputation": 37, "user_id": 5646669, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/11fbce77128cf38163a088ccc303348f?s=128&d=identicon&r=PG&f=1", "display_name": "rubytester", "link": "https://stackoverflow.com/users/5646669/rubytester"}, "edited": false, "score": 0, "creation_date": 1466007290, "post_id": 37840361, "comment_id": 63142215, "body": "Thanks no way I could have easily searched for that, answer is good to know will use chrome for now"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1466012397, "post_id": 37840361, "comment_id": 63145094, "body": "<code>gem install rubygems-update</code> doesn&#39;t update all gems. <a href=\"https://rubygems.org/gems/rubygems-update/versions/2.6.4\" rel=\"nofollow noreferrer\">The documentation</a> clearly says: <code>RubyGems is a package management framework for Ruby. This gem is an update for the RubyGems software.</code>."}], "owner": {"reputation": 37, "user_id": 5646669, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/11fbce77128cf38163a088ccc303348f?s=128&d=identicon&r=PG&f=1", "display_name": "rubytester", "link": "https://stackoverflow.com/users/5646669/rubytester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1466006665, "answer_count": 0, "score": 0, "last_activity_date": 1466012295, "creation_date": 1466006205, "last_edit_date": 1466012295, "question_id": 37840361, "link": "https://stackoverflow.com/questions/37840361/unable-to-obtain-stable-ff-connection", "closed_reason": "Duplicate", "title": "Unable to obtain stable ff connection", "body": "<p>I am getting the following error when running any Ruby script using Cucumber:</p>\n\n<pre><code>unable to obtain stable firefox connection in 60 seconds (127.0.0.1:7055) (Selenium::WebDriver::Error::WebDriverError)\n</code></pre>\n\n<p>I tried updating all Ruby gems using <code>gem install rubygems-update</code> but still have the same problem. </p>\n"}, {"tags": ["ios", "ruby", "heroku", "stripe-payments"], "answers": [{"comments": [{"owner": {"reputation": 2342, "user_id": 3063560, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000593194207/picture?type=large", "display_name": "rigdonmr", "link": "https://stackoverflow.com/users/3063560/rigdonmr"}, "edited": false, "score": 0, "creation_date": 1466006054, "post_id": 37840072, "comment_id": 63141364, "body": "and what is the consequence when it &quot;sleeps&quot;?"}, {"owner": {"reputation": 3712, "user_id": 352360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc04109a5e2a6d68e14a121d6c59815e?s=128&d=identicon&r=PG", "display_name": "joshaidan", "link": "https://stackoverflow.com/users/352360/joshaidan"}, "edited": false, "score": 0, "creation_date": 1466006213, "post_id": 37840072, "comment_id": 63141483, "body": "I think the main consequence of your app sleeping is that it will take a few seconds longer to spool up again when it receives another request."}, {"owner": {"reputation": 2342, "user_id": 3063560, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000593194207/picture?type=large", "display_name": "rigdonmr", "link": "https://stackoverflow.com/users/3063560/rigdonmr"}, "edited": false, "score": 0, "creation_date": 1466006310, "post_id": 37840072, "comment_id": 63141545, "body": "okay thanks. just don&#39;t want that shit to sleep forever ya know?"}, {"owner": {"reputation": 456, "user_id": 1213306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41f44109c87f57c2fb8932b97e686150?s=128&d=identicon&r=PG", "display_name": "alexanderkustov", "link": "https://stackoverflow.com/users/1213306/alexanderkustov"}, "edited": false, "score": 0, "creation_date": 1466006527, "post_id": 37840072, "comment_id": 63141705, "body": "You can ping it, with some uptime checker and it might never go to sleep. But heroku is changing its rules and will allow almost free hosting if you just have one app."}, {"owner": {"reputation": 2342, "user_id": 3063560, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000593194207/picture?type=large", "display_name": "rigdonmr", "link": "https://stackoverflow.com/users/3063560/rigdonmr"}, "edited": false, "score": 0, "creation_date": 1466006933, "post_id": 37840072, "comment_id": 63141984, "body": "How bad is it when it goes to sleep @knuxus ?"}, {"owner": {"reputation": 456, "user_id": 1213306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41f44109c87f57c2fb8932b97e686150?s=128&d=identicon&r=PG", "display_name": "alexanderkustov", "link": "https://stackoverflow.com/users/1213306/alexanderkustov"}, "edited": false, "score": 0, "creation_date": 1466007236, "post_id": 37840072, "comment_id": 63142184, "body": "Its not bad at all, from sleeping state your app could be running in less than 30 secs. depending of how heavy it is of course."}, {"owner": {"reputation": 2342, "user_id": 3063560, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000593194207/picture?type=large", "display_name": "rigdonmr", "link": "https://stackoverflow.com/users/3063560/rigdonmr"}, "edited": false, "score": 0, "creation_date": 1466009984, "post_id": 37840072, "comment_id": 63143795, "body": "hmm.. 30 secs is actually kind of a long time to process a payment. It&#39;s extremely lightweight though."}], "tags": [], "owner": {"reputation": 456, "user_id": 1213306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41f44109c87f57c2fb8932b97e686150?s=128&d=identicon&r=PG", "display_name": "alexanderkustov", "link": "https://stackoverflow.com/users/1213306/alexanderkustov"}, "is_accepted": true, "score": 3, "last_activity_date": 1466005511, "creation_date": 1466005511, "answer_id": 37840072, "question_id": 37839948, "link": "https://stackoverflow.com/questions/37839948/what-heroku-plan-do-i-need-to-process-stripe-payments/37840072#37840072", "title": "What Heroku plan do I need to process Stripe Payments?", "body": "<p>You can still run Stripe on the free account without any issues.</p>\n\n<p>If your app is not doing anything, it will sleep, otherwise if there is activity going it won't.</p>\n"}], "owner": {"reputation": 2342, "user_id": 3063560, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000593194207/picture?type=large", "display_name": "rigdonmr", "link": "https://stackoverflow.com/users/3063560/rigdonmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "accepted_answer_id": 37840072, "answer_count": 1, "score": 2, "last_activity_date": 1466005511, "creation_date": 1466005179, "question_id": 37839948, "link": "https://stackoverflow.com/questions/37839948/what-heroku-plan-do-i-need-to-process-stripe-payments", "title": "What Heroku plan do I need to process Stripe Payments?", "body": "<p>I'm working on an iOS app and needed to deploy a very simple web-app for processing Stripe payments, so I deployed a Ruby Sinatra app for free on Heroku.</p>\n\n<p>It's up and running and seems to be working great (the iOS app is not in production yet though), but I'm worried about scalability and know very little about web hosting. Is the free plan good enough for my use case? Again, the web-app does absolutely nothing besides respond to a POST request that processes Stripe payments.</p>\n\n<p>I saw the free plan says \"Sleeps after 30 min of inactivity\". What does that mean? When it sleeps will it not be able to process payments? It also says \"Uses an account based pool of free dyno hours\". What does that mean? What is a dyno? And finally, it says \"1 web/1 worker\". What does that mean? What is a worker? Sorry for the lack of knowledge, just have no background in web hosting. Thanks.</p>\n"}, {"tags": ["ruby", "rubygems", "cucumber", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6470280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/792884a521f39b4415ba190681426b54?s=128&d=identicon&r=PG&f=1", "display_name": "Melie", "link": "https://stackoverflow.com/users/6470280/melie"}, "edited": false, "score": 0, "creation_date": 1466008570, "post_id": 37840384, "comment_id": 63142998, "body": "Thank you Justin for the quick explanation and solution, it works now! I have much to learn for sure."}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 2, "last_activity_date": 1466006286, "creation_date": 1466006286, "answer_id": 37840384, "question_id": 37839887, "link": "https://stackoverflow.com/questions/37839887/cucumber-how-to-write-definition-steps-in-ruby-capybara/37840384#37840384", "title": "Cucumber: How to write definition steps in Ruby Capybara", "body": "<p>When using scenario outlines, the table values are passed to the step definition. It is not the table that is passed. The step:</p>\n\n<pre><code>When I select my \"&lt;Country&gt;\" \n</code></pre>\n\n<p>Is conceptually the same as:</p>\n\n<pre><code>When I select my \"Canada\" \n</code></pre>\n\n<p>and</p>\n\n<pre><code>When I select my \"United States\" \n</code></pre>\n\n<p>In the step definition, <code>table</code> is the captured value between the quotations. You can see that it is just a <code>String</code>.</p>\n\n<pre><code>When(/^I select my \"([^\"]*)\"$/) do |table|\n  p table.class\n  #=&gt; String\n\n  p table\n  #=&gt; \"Canada\" or \"United States\"\nend\n</code></pre>\n\n<p>You can pass this value straight to the <code>select</code> method. You probably want to rename the variable to be reflect its value:</p>\n\n<pre><code>When(/^I select my \"([^\"]*)\"$/) do |country|\n  select(country, :from =&gt; 'id-of-dropdown')\n  click_on('Submit')\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6470280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/792884a521f39b4415ba190681426b54?s=128&d=identicon&r=PG&f=1", "display_name": "Melie", "link": "https://stackoverflow.com/users/6470280/melie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 846, "favorite_count": 0, "accepted_answer_id": 37840384, "answer_count": 1, "score": 1, "last_activity_date": 1466017388, "creation_date": 1466005035, "last_edit_date": 1466017388, "question_id": 37839887, "link": "https://stackoverflow.com/questions/37839887/cucumber-how-to-write-definition-steps-in-ruby-capybara", "title": "Cucumber: How to write definition steps in Ruby Capybara", "body": "<p>I am new to cucumber and have the simplest setup of cucumber/ruby/capybara/selenium driver.</p>\n\n<p>I have a scenario outline such as:</p>\n\n<pre><code>Feature: Country of user is displayed\nScenario Outline: CountryCode of User is displayed based on his Country selected.\nGiven the user is on the test page\nWhen I select my \"&lt;Country&gt;\" \nAnd the testpage is loaded\nThen the \"&lt;CountryCode&gt;\" is displayed\n\nExamples:\n | Country       | CountryCode |\n | Canada        | CA          |\n | United States | US          |\n</code></pre>\n\n<p>step Definition:</p>\n\n<pre><code> Given(/^the user is on the test page$/) do\n visit 'http://....'\nend\n\nWhen(/^I select my \"([^\"]*)\"$/) do |table|\n select([Country], :from =&gt; 'id-of-dropdown')\n click_on('Submit')\nend\n\nWhen(/^the testpage is loaded$/) do\n pending # Write code here that turns the phrase above into concrete actions\nend\n\nThen(/^the \"([^\"]*)\" from UserSetLocation is displayed$/) do |arg1|\n pending # Write code here that turns the phrase above into concrete actions\nend\n</code></pre>\n\n<p>my env.rb file:</p>\n\n<pre><code>require 'rubygems'\nrequire 'capybara'\nrequire 'capybara/dsl'\nrequire 'rspec'\n\nCapybara.run_server = false\n#Set default driver as Selenium\nCapybara.default_driver = :selenium\n#Set default driver as webkit (browserless)\n#Capybara.javascript_driver = :webkit\n#Set default selector as css\nCapybara.default_selector = :css\n\n#Syncronization related settings\nmodule Helpers\n def without_resynchronize\n  page.driver.options[:resynchronize] = false\n  yield\n  page.driver.options[:resynchronize] = true\n end\nend\nWorld(Capybara::DSL, Helpers)\n</code></pre>\n\n<p>The issue I have is what is the correct syntax to pull the value from the datatable, country column for:</p>\n\n<pre><code>When(/^I enter my \"([^\"]*)\"$/) do |table|\n   select([Country], :from =&gt; 'id-of-dropdown')\n</code></pre>\n\n<p>the following works, but I don't want to write this same step for every country, that datatable will potentially include dozens of countries.</p>\n\n<pre><code>select(\"Canada\", :from =&gt; 'id-of-dropdown')\n</code></pre>\n\n<p>I realized perhaps my env.rb is missing info or I am simply not using the right syntax?\nI have literally been searching online and on this site for days, and any help would be greatly appreciated!\nThank you for your time.\nMelie</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466005034, "post_id": 37839801, "comment_id": 63140614, "body": "Yea so I am trying to change the selected value of the form after the fact ... as it is always going to the default after I update. The situation is I need the default to render when the page loads, but I am using ajax to update, and while the form updates the DB, the selected option always returns to it&#39;s default even though that select_tag form is not in sync with ajax"}, {"owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "reply_to_user": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466005160, "post_id": 37839801, "comment_id": 63140721, "body": "So the code in <code>@event.setup_time</code> only executes on the first page load--it won&#39;t change by itself without you using JS to alter the element (it&#39;s not like there&#39;s going to be Ruby in your page source).  I&#39;m a little confused why you&#39;d need to do this, since presumably your user could just...use the form and change the selected value, but I&#39;m guessing you have some other way of processing the form. In that case, you&#39;ll need JS."}, {"owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "reply_to_user": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466005428, "post_id": 37839801, "comment_id": 63140920, "body": "Also, are you talking about reloading the page after the user submits the form? If the default value isn&#39;t as expected even then, then it implies that <code>@event.setup_time</code> isn&#39;t what you think it is, or the change to <code>@event.setup_time</code> hasn&#39;t persisted in the DB like you think."}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466006283, "post_id": 37839801, "comment_id": 63141524, "body": "The db is not the issue, have been monitoring that religiously"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466006327, "post_id": 37839801, "comment_id": 63141559, "body": "All I am trying to do is set the setup time once a new value is selected ... for some reason the form is not displaying the freshly selected option"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466006414, "post_id": 37839801, "comment_id": 63141618, "body": "Have been hashing out stuff in JQuery, but I think the way my code is setup that might not be an option, or it might not sure a bit new to this. Is there a way to set the setup time through ruby? For example, saying something like  setup_form_popup.val(15).change() in ruby"}, {"owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "reply_to_user": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466006434, "post_id": 37839801, "comment_id": 63141632, "body": "Right, but like I said, <code>@event.setup_time</code> won&#39;t change unless you reload the page. Are you reloading the page? If you don&#39;t want to have to, you need JS; if you are reloading the page (after changing the value), the DB value is changing, and you&#39;re still not getting the right default, you might simply not be loading <code>@event</code> properly."}, {"owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "reply_to_user": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466006551, "post_id": 37839801, "comment_id": 63141718, "body": "<code>setup_form_popup.val(15).change()</code> is definitely not something that exists in ruby. Ruby&#39;s not a web framework, it&#39;s not like JQuery where you have code &quot;loaded&quot; in the webpage. All Rails is doing is processing your code and then generating some static web pages for you; you can&#39;t touch those pages with Ruby after they get served."}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466006631, "post_id": 37839801, "comment_id": 63141780, "body": "Exactly, I am not reloading the page .. using ajax to update parts of the page which respond with the setup time. Only thing that is not responding is the selected option for the select_tag"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466006669, "post_id": 37839801, "comment_id": 63141814, "body": "Alright, so yea if that&#39;s not feasible to do in ruby I&#39;ll focus on the jquery of it"}, {"owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "reply_to_user": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466006720, "post_id": 37839801, "comment_id": 63141844, "body": "Then this is a JS error, and you need to write JS to appropriately take whatever values you got back from your DB with Ajax, and then spread them to your select element."}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466006737, "post_id": 37839801, "comment_id": 63141857, "body": "program works perfectly when I run setup_form_popup.val(15).change(), having trouble with the variables"}, {"owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "reply_to_user": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466008472, "post_id": 37839801, "comment_id": 63142947, "body": "Great--if your Ruby issue is resolved, can you mark this question as closed?"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1466020925, "post_id": 37839801, "comment_id": 63149838, "body": "Data was just being cached in the website ... everything good now"}], "tags": [], "owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "is_accepted": false, "score": 0, "last_activity_date": 1466004785, "creation_date": 1466004785, "answer_id": 37839801, "question_id": 37839647, "link": "https://stackoverflow.com/questions/37839647/how-to-set-the-value-of-a-select-tag-widget-in-ruby-using-its-symbol/37839801#37839801", "title": "How to set the value of a select_tag widget in ruby using its symbol", "body": "<p>You need to clarify. What do you mean by symbol--the id of the element? What do you mean by set the value--the default value or changing it after the fact?</p>\n\n<p>Assuming you mean you want to change which item is selected in the select element, then</p>\n\n<ul>\n<li>You're already setting a default value in <code>options_for_select</code>. Change that if you want something else.</li>\n<li>You can use JS to dynamically change the values of your option tags. Assuming you're using a selector, that's where you can pass in the \"symbol\" (the name, id, or class, or whatever you'd like).</li>\n</ul>\n\n<p>But really it could be anything without you clarifying further.</p>\n"}], "owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1466012511, "creation_date": 1466004399, "last_edit_date": 1466012511, "question_id": 37839647, "link": "https://stackoverflow.com/questions/37839647/how-to-set-the-value-of-a-select-tag-widget-in-ruby-using-its-symbol", "title": "How to set the value of a select_tag widget in ruby using its symbol", "body": "<p>I have a <code>select_tag</code> widget, much like the following:</p>\n\n<pre><code>= select_tag :setup_form_popup, options_for_select([ [\"No Setup Time\",\"0\"],[\"15 Minute\", \"15\"], [\"30 Minute\", \"30\"], [\"45 Minute\", \"45\"], [\"60 Minute\", \"60\"], [\"75 Minute\", \"75\"], [\"90 Minute\",\"90\"], [\"105 Minute\", \"105\"],[\"120 Minute\",\"120\"]], @event.setup_time), {:prompt =&gt; 'Setup Time'}\n</code></pre>\n\n<p>How would I set the value of a <code>select_tag</code> widget using its symbol? </p>\n"}, {"tags": ["ruby", "grape-api"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1466001916, "post_id": 37838438, "comment_id": 63138355, "body": "IIRC, <code>helpers</code> includes the module in nested namespaces, too."}, {"owner": {"reputation": 218, "user_id": 1973544, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c35f4105ab1e163ac576dbe1342ecdbc?s=128&d=identicon&r=PG", "display_name": "huntmaster", "link": "https://stackoverflow.com/users/1973544/huntmaster"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1466017848, "post_id": 37838438, "comment_id": 63148144, "body": "That&#39;s fine, but you can do that with modules as well, just by using a standard module pattern of the top level module requiring it&#39;s nested modules.  Less surprising that way too."}], "answers": [{"comments": [{"owner": {"reputation": 218, "user_id": 1973544, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c35f4105ab1e163ac576dbe1342ecdbc?s=128&d=identicon&r=PG", "display_name": "huntmaster", "link": "https://stackoverflow.com/users/1973544/huntmaster"}, "edited": false, "score": 0, "creation_date": 1466017756, "post_id": 37839114, "comment_id": 63148093, "body": "That&#39;s fine, but why would I ever use it for methods?  My example isn&#39;t setting parameters with the helper macro."}], "tags": [], "owner": {"reputation": 2291, "user_id": 1752333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1009edfa56c5a71d0e6de2738342bee7?s=128&d=identicon&r=PG", "display_name": "scorix", "link": "https://stackoverflow.com/users/1752333/scorix"}, "is_accepted": false, "score": 1, "last_activity_date": 1466002982, "creation_date": 1466002982, "answer_id": 37839114, "question_id": 37838438, "link": "https://stackoverflow.com/questions/37838438/why-use-helpers-in-a-grape-api-versus-including-a-module/37839114#37839114", "title": "Why use helpers in a Grape API versus including a module?", "body": "<p>You can define reusable params using helpers which you can't do this in a standard ruby module.</p>\n\n<pre><code>class API &lt; Grape::API\n  helpers do\n    params :pagination do\n      optional :page, type: Integer\n      optional :per_page, type: Integer\n    end\n  end\n\n  desc 'Get collection'\n  params do\n    use :pagination # aliases: includes, use_scope\n  end\n  get do\n    Collection.page(params[:page]).per(params[:per_page])\n  end\nend\n</code></pre>\n\n<p><a href=\"https://github.com/ruby-grape/grape#helpers\" rel=\"nofollow\">https://github.com/ruby-grape/grape#helpers</a></p>\n"}], "owner": {"reputation": 218, "user_id": 1973544, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c35f4105ab1e163ac576dbe1342ecdbc?s=128&d=identicon&r=PG", "display_name": "huntmaster", "link": "https://stackoverflow.com/users/1973544/huntmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2698, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1466002982, "creation_date": 1466001232, "question_id": 37838438, "link": "https://stackoverflow.com/questions/37838438/why-use-helpers-in-a-grape-api-versus-including-a-module", "title": "Why use helpers in a Grape API versus including a module?", "body": "<p>When writing an API with Grape, why bother using the <code>helpers</code> macro, versus just including a module, or adding a method?  </p>\n\n<p>For example, you can define methods in a module and include them as helpers in Grape like so: </p>\n\n<pre><code>module HelperMethods\n  def useful_method(param)\n    \"Does a thing with #{param}\"\n  end\nend\n\nclass HelpersAPI &lt; Grape::API\n  helpers HelperMethods\n\n  get 'do_stuff/:id' do\n    useful_method(params[:id])\n  end\nend\n</code></pre>\n\n<p>But, why not just do this?</p>\n\n<pre><code>class IncludeAPI &lt; Grape::API\n  include HelperMethods\n\n  get 'do_stuff/:id' do\n    useful_method(params[:id])\n  end\nend\n</code></pre>\n\n<p>I guess it's a little more explicit that you're including the <code>HelperMethods</code> module for the purpose of providing helper methods, but that seems like a weak reason to add an alternative syntax.</p>\n\n<p>What are the benefits/reasons that you would want to use <code>helpers</code> versus just a normal <code>include</code>? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1749, "user_id": 2369455, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4491517018191e1cf9cf103bdc2d18e7?s=128&d=identicon&r=PG", "display_name": "sethi", "link": "https://stackoverflow.com/users/2369455/sethi"}, "edited": false, "score": 1, "creation_date": 1466000685, "post_id": 37837879, "comment_id": 63137370, "body": "Yes but the bundler is trying to install from github not rubygem.org. Why dont you try to remove the github option in your Gemfile."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1466000835, "post_id": 37837879, "comment_id": 63137480, "body": "You are using a branch of the gem by <code>optoro</code>, not the main project by <code>Shopify</code>. This is why you are getting different results."}], "owner": {"reputation": 57, "user_id": 6465508, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1271de1fdd2e534c689f9f5b1f1876f?s=128&d=identicon&r=PG&f=1", "display_name": "user6465508", "link": "https://stackoverflow.com/users/6465508/user6465508"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465999769, "creation_date": 1465999769, "question_id": 37837879, "link": "https://stackoverflow.com/questions/37837879/an-error-occurred-while-installing-active-shipping-0-9-13-and-bundler-cannot", "title": "An error occurred while installing active_shipping (0.9.13), and Bundler cannot continue", "body": "<p>When I run <code>bundle install</code> it gives the following error:</p>\n\n<pre><code>An error occurred while installing active_shipping (0.9.13), and Bundler cannot continue.\nMake sure that `gem install active_shipping -v '0.9.13'` succeeds before bundling.\n</code></pre>\n\n<p>But did install <code>gem install active_shipping -v '0.9.13'</code> before running <code>bundle install</code>. How could I fix it? Thanks!</p>\n\n<pre><code>xxxxxx:~/code/inventory$ gem install active_shipping -v '0.9.13'\nSuccessfully installed active_shipping-0.9.13\n1 gem installed\nxxxxxx:~/code/inventory$ bundle install\nIgnoring json-1.8.3 because its extensions are not built.  Try: gem pristine json --version 1.8.3\n/usr/lib/ruby/vendor_ruby/bundler.rb:284: warning: Insecure world writable dir /usr/local/bin in PATH, mode 040777\nFetching source index from https://rubygems.org/\nResolving dependencies...............................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................\nUsing rake (10.5.0) \nUsing Ascii85 (1.0.2) \nUsing ZenTest (4.9.5) \nUsing RubyInline (3.12.2) \nUsing i18n (0.7.0) \nUsing multi_json (1.11.3) \nUsing activesupport (3.2.22.2) \nUsing builder (3.0.4) \nUsing activemodel (3.2.22.2) \nUsing erubis (2.7.0) \nUsing journey (1.0.4) \nUsing rack (1.4.7) \nUsing rack-cache (1.6.1) \nUsing rack-test (0.6.3) \nUsing hike (1.2.3) \nUsing tilt (1.4.1) \nUsing sprockets (2.2.3) \nUsing actionpack (3.2.22.2) \nUsing mime-types (1.25.1) \nUsing polyglot (0.3.5) \nUsing treetop (1.4.15) \nUsing mail (2.5.4) \nUsing actionmailer (3.2.22.2) \nUsing active_utils (2.2.3) \nUsing json (1.8.3) \nUsing money (4.0.2) \nUsing macaddr (1.0.0) \nUsing uuid (2.3.7) \nUsing active_shipping (0.9.13) from git://github.com/optoro/active_shipping.git (at master) \nNoMethodError: undefined method `spec' for nil:NilClass\nAn error occurred while installing active_shipping (0.9.13), and Bundler cannot continue.\nMake sure that `gem install active_shipping -v '0.9.13'` succeeds before bundling.\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 2, "creation_date": 1466001231, "post_id": 37837732, "comment_id": 63137813, "body": "It is not a duplicate of the question that it was claimed to be of. The first form is simply a syntax error."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1466000293, "post_id": 37837946, "comment_id": 63137082, "body": "Note that <code>{&#39;a&#39;: &#39;b&#39;}</code> (without space before <code>:</code>) is valid syntax in recent versions of Ruby."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1466000431, "post_id": 37837946, "comment_id": 63137180, "body": "Valid as of ruby version <code>2.2+</code>, to be precise."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1466000433, "post_id": 37837946, "comment_id": 63137182, "body": "Yes, true. But in that case <code>a</code> key will be a symbol."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 3, "last_activity_date": 1466001350, "last_edit_date": 1466001350, "creation_date": 1465999928, "answer_id": 37837946, "question_id": 37837732, "link": "https://stackoverflow.com/questions/37837732/what-is-the-difference-between-ruby-hash-construction-with-or/37837946#37837946", "title": "What is the difference between Ruby hash construction with &quot;=&gt;&quot; or &quot;:&quot;?", "body": "<p>The first one is wrong, and gives you a syntax error. With the second syntax, you can use a key of any class. Otherwise, this syntax is just a shortcut for a symbol key.</p>\n\n<pre><code>a = {a: 'b'}\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>a = {:a =&gt; 'b'}\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 1503918, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/896267770d8ff23d399000903671aebd?s=128&d=identicon&r=PG", "display_name": "bryantism", "link": "https://stackoverflow.com/users/1503918/bryantism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1466012573, "creation_date": 1465999373, "last_edit_date": 1466012573, "question_id": 37837732, "link": "https://stackoverflow.com/questions/37837732/what-is-the-difference-between-ruby-hash-construction-with-or", "title": "What is the difference between Ruby hash construction with &quot;=&gt;&quot; or &quot;:&quot;?", "body": "<p>What is the difference between these examples?</p>\n\n<pre><code>a = {'a' : 'b'}\na = {'a' =&gt; 'b'}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1465999963, "post_id": 37837471, "comment_id": 63136812, "body": "I think I will use jquery and update when it is changed ... any idea on how to set value?"}, {"owner": {"reputation": 1749, "user_id": 2369455, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4491517018191e1cf9cf103bdc2d18e7?s=128&d=identicon&r=PG", "display_name": "sethi", "link": "https://stackoverflow.com/users/2369455/sethi"}, "edited": false, "score": 0, "creation_date": 1465999973, "post_id": 37837471, "comment_id": 63136825, "body": "you have to do it through a ajax call(may be in the success callback) and change the selected value for this &#39;select&#39;.<a href=\"http://stackoverflow.com/questions/314636/how-do-you-select-a-particular-option-in-a-select-element-in-jquery\" title=\"how do you select a particular option in a select element in jquery\">stackoverflow.com/questions/314636/&hellip;</a>"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "reply_to_user": {"reputation": 1749, "user_id": 2369455, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4491517018191e1cf9cf103bdc2d18e7?s=128&d=identicon&r=PG", "display_name": "sethi", "link": "https://stackoverflow.com/users/2369455/sethi"}, "edited": false, "score": 0, "creation_date": 1466001478, "post_id": 37837471, "comment_id": 63138007, "body": ",update_setup_time: function(e) { \t \t\tvar d = $(&#39;#setup_form_popup&#39;).val(); \t\t$.ajax({ \t\t\tbeforeSend: function(xhr) { xhr.setRequestHeader(&#39;X-CSRF-Token&#39;, $(&#39;meta[name=&quot;csrf-token&quot;]&#39;).attr(&#39;content&#39;))}, \t\t\turl: &#39;/events/&#39;+ e.id + &#39;/update_setup_time_p&#39;, \t\t\ttype: &#39;GET&#39;, \t\t\tdataType: &#39;json&#39;, \t\t\tdata: {needed: d}, \t\t\tsuccess: function() { \t\t\t\tvar intVal = parseInt(d); \t\t\t\t$(&#39;#setup_form_popup&#39;).val(intVal).change(); \t\t\t\talert(intVal); \t\t\t\tTS.calendar.ajax_update(); \t\t\t}, \t\t}); \t}"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "reply_to_user": {"reputation": 1749, "user_id": 2369455, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4491517018191e1cf9cf103bdc2d18e7?s=128&d=identicon&r=PG", "display_name": "sethi", "link": "https://stackoverflow.com/users/2369455/sethi"}, "edited": false, "score": 0, "creation_date": 1466001524, "post_id": 37837471, "comment_id": 63138035, "body": "I put it in my success function, yet it is not updating as it should"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "reply_to_user": {"reputation": 1749, "user_id": 2369455, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4491517018191e1cf9cf103bdc2d18e7?s=128&d=identicon&r=PG", "display_name": "sethi", "link": "https://stackoverflow.com/users/2369455/sethi"}, "edited": false, "score": 0, "creation_date": 1466001557, "post_id": 37837471, "comment_id": 63138065, "body": "hmmm ... the view doesn&#39;t update either so i&#39;m confused at why it is always defaulting to the initial default"}, {"owner": {"reputation": 1749, "user_id": 2369455, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4491517018191e1cf9cf103bdc2d18e7?s=128&d=identicon&r=PG", "display_name": "sethi", "link": "https://stackoverflow.com/users/2369455/sethi"}, "edited": false, "score": 0, "creation_date": 1466002320, "post_id": 37837471, "comment_id": 63138622, "body": "$(&#39;#setup_form_popup&#39;) is form or the select element? put a breakpoint if possible at  var intVal = parseInt(d); and check if your selector is correct i.e. if  $(&#39;#setup_form_popup&#39;) gives you the correct select element"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "reply_to_user": {"reputation": 1749, "user_id": 2369455, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4491517018191e1cf9cf103bdc2d18e7?s=128&d=identicon&r=PG", "display_name": "sethi", "link": "https://stackoverflow.com/users/2369455/sethi"}, "edited": false, "score": 0, "creation_date": 1466002730, "post_id": 37837471, "comment_id": 63138913, "body": "I think because of the way my code is setup I might have to do this part in ruby ... is there a similar method that changes the val in ruby? is it just .val as well"}, {"owner": {"reputation": 1749, "user_id": 2369455, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4491517018191e1cf9cf103bdc2d18e7?s=128&d=identicon&r=PG", "display_name": "sethi", "link": "https://stackoverflow.com/users/2369455/sethi"}, "edited": false, "score": 0, "creation_date": 1466041083, "post_id": 37837471, "comment_id": 63156543, "body": "You can do it in ruby but remember ruby is running on the server not the client so you have to re-render the whole form and send it back as the response to the post ajax request and in the ajax success call $(&quot;#the-form&quot;).innerhtml(response) or a variant of that."}], "owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465998699, "creation_date": 1465998699, "question_id": 37837471, "link": "https://stackoverflow.com/questions/37837471/updating-default-value-in-select-tag-with-ajax-call", "title": "Updating default value in select_tag with Ajax call", "body": "<p>I have a select_tag attribute within a ruby application. However, the default value obtains information from a database - Often that information is changed via an Ajax call and I was just wondering how one would be able to update a default value within a select_tag widget. Here is the following code:</p>\n\n<pre><code>= select_tag 'setup_form_popup', options_for_select([ [\"No Setup Time\",\"0\"],[\"15 Minute\", \"15\"], [\"30 Minute\", \"30\"], [\"45 Minute\", \"45\"], [\"60 Minute\", \"60\"], [\"75 Minute\", \"75\"], [\"90 Minute\",\"90\"], [\"105 Minute\", \"105\"],[\"120 Minute\",\"120\"]], @event.setup_time), {:prompt =&gt; 'Setup Time'}\n</code></pre>\n\n<p>where @event.setup_time is the default when the page is run ... however when there is an Ajax request, it is not updated as the view is not reloaded. Any and all help is appreciated. Cheers~</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rest", "naming", "actionpack"], "answers": [{"tags": [], "owner": {"reputation": 31711, "user_id": 634576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/48891dab622b535f3c2b4ec1c8765bed?s=128&d=identicon&r=PG", "display_name": "Dave Schweisguth", "link": "https://stackoverflow.com/users/634576/dave-schweisguth"}, "is_accepted": true, "score": 0, "last_activity_date": 1466001472, "last_edit_date": 1491982283, "creation_date": 1466001472, "answer_id": 37838529, "question_id": 37837427, "link": "https://stackoverflow.com/questions/37837427/which-restful-action-should-i-use-to-redirect-to-another-site/37838529#37838529", "title": "Which RESTful action should I use to redirect to another site?", "body": "<p>REST (apart from Rails) is about using the correct HTTP method for the correct action. The Rails part is just using the conventional controller action for a given HTTP method.</p>\n\n<p>So, if you're doing a 301 or 302 redirect to another page, which browsers handle by issuing a GET request to the URL in the redirect response's Location header, do it in a <code>show</code> action. This will allow the user's browser to cache the other page when appropriate, and to not notify the user before redirecting.</p>\n\n<p>(<a href=\"https://softwareengineering.stackexchange.com/questions/99894/why-doesnt-http-have-post-redirect\">There is a way to redirect POSTs</a>, but you didn't mention it so I expect you're talking about regular 301/302 redirects.)</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5763425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61707d442d351ad34760658fb069861?s=128&d=identicon&r=PG&f=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/5763425/javier"}, "is_accepted": false, "score": 0, "last_activity_date": 1466003748, "last_edit_date": 1466003748, "creation_date": 1466002920, "answer_id": 37839091, "question_id": 37837427, "link": "https://stackoverflow.com/questions/37837427/which-restful-action-should-i-use-to-redirect-to-another-site/37839091#37839091", "title": "Which RESTful action should I use to redirect to another site?", "body": "<p>Coming from a Java background, the REST actions must be related to CRUD operations. Requests that do not change the resource like in your case where the intent is to redirect to another page must be tied to a GET verb or show in your example.</p>\n\n<p>If you were to create a new resource you would use POST.\nA more detailed explanation can be found in <a href=\"http://martinfowler.com/articles/richardsonMaturityModel.html\" rel=\"nofollow\"> Richardson's rest maturity model level 2</a></p>\n"}], "owner": {"reputation": 25043, "user_id": 1417223, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dbdfe3d2d5f87f172757ada1438f3d16?s=128&d=identicon&r=PG", "display_name": "Fellow Stranger", "link": "https://stackoverflow.com/users/1417223/fellow-stranger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 37838529, "answer_count": 2, "score": 1, "last_activity_date": 1466038938, "creation_date": 1465998609, "last_edit_date": 1466038938, "question_id": 37837427, "link": "https://stackoverflow.com/questions/37837427/which-restful-action-should-i-use-to-redirect-to-another-site", "title": "Which RESTful action should I use to redirect to another site?", "body": "<p>I have an app where I try to <a href=\"http://jeromedalbert.com/how-dhh-organizes-his-rails-controllers/\" rel=\"nofollow\">adhere to REST</a>.</p>\n\n<p>The app receives requests for external links that don't belong to the app, so the sole purpose of the action is to redirect the request to the external URL.</p>\n\n<p>My suggestion is to have the following controller/action: <code>redirects_controller#create</code>. </p>\n\n<p>Is my thinking correct or should it be the <code>show</code> action instead?</p>\n"}, {"tags": ["ruby", "sinatra", "metaprogramming"], "comments": [{"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1465998940, "post_id": 37837282, "comment_id": 63136030, "body": "You can easly use <code>Hash</code> insted of <code>eval</code>. Or you can use something like this: <a href=\"http://stackoverflow.com/a/17842868/2862049\">stackoverflow.com/a/17842868/2862049</a>"}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 1, "creation_date": 1465999065, "post_id": 37837282, "comment_id": 63136131, "body": "Please add punctuations to your question."}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1465999214, "post_id": 37837282, "comment_id": 63136228, "body": "Never trust the scary internet and <code>eval</code> user input. You have too many places for attackers to inject their malicious code."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1466001290, "post_id": 37837282, "comment_id": 63137855, "body": "It&#39;s not clear to me what you&#39;re trying to do."}, {"owner": {"reputation": 89, "user_id": 5352253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1028839820499621/picture?type=large", "display_name": "Joseph McKenzie", "link": "https://stackoverflow.com/users/5352253/joseph-mckenzie"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1466002711, "post_id": 37837282, "comment_id": 63138897, "body": "@DaveNewton I  am trying to generate params based on the amount of questions in a db table (or the length of the array) and have the auto increase their name / number for my sinatra front end"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1466003123, "post_id": 37837282, "comment_id": 63139214, "body": "That doesn&#39;t really help much; sorry. So far you haven&#39;t said anything that makes me think there&#39;s anything that requires any sort of metaprogramming at all, or anything even approaching it."}], "owner": {"reputation": 89, "user_id": 5352253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1028839820499621/picture?type=large", "display_name": "Joseph McKenzie", "link": "https://stackoverflow.com/users/5352253/joseph-mckenzie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1465999314, "creation_date": 1465998289, "last_edit_date": 1465999314, "question_id": 37837282, "link": "https://stackoverflow.com/questions/37837282/how-to-use-eval-with-a-each-to-generate-the-needed-amount-of-params", "title": "How to use eval with a .each to generate the needed amount of params", "body": "<p>I can already generate the amount of params I need using the below code but when I submit the form the data that comes back is the index position not the value submitted I cant seem to find the issue It knows whats being inputted that I know by the error logs when I had something else messed up but that part is fixed. </p>\n\n<p>The Relevant front end :</p>\n\n<pre><code>post '/submitpage' do\n  authentication_required\n  data = database.execute(\"select Id,Questions from Questions\");\n  data.each_with_index do |i|\n    eval(\" '#{i[0]}' + '=' + 'params[:q#{i[0]}]' \")\n  end\n\n\n  name = params[:name]\n  id = params[:id]\n  date = params[:date]\n  time = params[:time]\n\n  c1 = params[:comment4]\n  c2 = params[:comment5]\n  c3 = params[:\"comment6\"]\n  c4 = params[:\"comment7\"]\n  c5 = params[:\"comment8\"]\n  c6 = params[:\"comment9\"]\n  c7 = params[:\"comment10\"]\n  c8 = params[:\"comment11\"]\n  c9 = params[:\"comment12\"]\n  c10 = params[:\"comment13\"]\n\n  database.execute(\"INSERT INTO Answers (Answer) VALUES ('#{name}'),   ('#{id}'),('#{date}'),('#{time}'),('#{1}'),('#{2}'),('#{3}'),('#{4}'), ('#{5}'),('#{6}'),('#{7}'),('#{8}'),('#{9}'), ('#{10}'),('#{11}'),('#{12}'),('#{13}'),('#{14}'),('#{15}'),('#{16}'),('#{17}'),('#{18}'),('#{19}'),('#{20}')\");\n\n  database.execute(\"INSERT INTO Comments (Comments) VALUES ('#{c1}'),('{c2}'),('#{c3}'),('#{c4}'),('#{c5}'),('#{c6}'),('#{c7}'),('#{c8}'),('#{c9}'),('#{c10}')\");\n\n  redirect to('/page1')\nend\n</code></pre>\n\n<p>the relevant partial view :</p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n  &lt;div class=\"column column-12 scrollingTable  \"&gt;\n    &lt;h3&gt;I. Work Evaluation&lt;/h3&gt;\n    &lt;table class=\"sortable\"&gt;\n      &lt;tr&gt;\n        &lt;th&gt;&lt;/th&gt;\n      &lt;/tr&gt;\n\n      &lt;% data.each.with_index do |data, index| %&gt;\n          &lt;% if data[0] &gt;= 5 &amp;&amp; data[0] &lt;= 19 %&gt;\n              &lt;tr&gt;\n\n                &lt;td&gt;&lt;%= data[1] %&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;select name=\"q&lt;%= index %&gt;\"&gt;\n                  &lt;option value=\"\"&gt;&lt;/option&gt;\n                  &lt;option value=\"Yes\"&gt;Yes&lt;/option&gt;\n                  &lt;option value=\"No\"&gt;No&lt;/option&gt;\n                  &lt;option value=\"na\"&gt;N/a&lt;/option&gt;\n                &lt;/select&gt;\n\n                  &lt;div class=\"accordion\"&gt;Comment&lt;/div&gt;\n                  &lt;div class=\"panel\"&gt;\n                    &lt;textarea class=\"comments\" name=\"comment&lt;%= index %&gt;\" rows=\"4\" cols=\"15\"&gt; &lt;/textarea&gt;\n                  &lt;/div&gt;\n                &lt;/td&gt;\n              &lt;/tr&gt;\n          &lt;% end %&gt;\n      &lt;% end %&gt;\n    &lt;/table&gt;\n    &lt;% # some code %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested", "content-management-system"], "comments": [{"owner": {"reputation": 1592, "user_id": 4271743, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Nivk1.jpg?s=128&g=1", "display_name": "ConnorCMcKee", "link": "https://stackoverflow.com/users/4271743/connorcmckee"}, "edited": false, "score": 0, "creation_date": 1465998460, "post_id": 37837145, "comment_id": 63135643, "body": "Could you include the models for Page and Section as well?"}, {"owner": {"reputation": 71, "user_id": 6090379, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/--OHwIEg3ekI/AAAAAAAAAAI/AAAAAAAAAfg/ze_RRyZer-8/photo.jpg?sz=128", "display_name": "FreeLine", "link": "https://stackoverflow.com/users/6090379/freeline"}, "reply_to_user": {"reputation": 1592, "user_id": 4271743, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Nivk1.jpg?s=128&g=1", "display_name": "ConnorCMcKee", "link": "https://stackoverflow.com/users/4271743/connorcmckee"}, "edited": false, "score": 0, "creation_date": 1465998844, "post_id": 37837145, "comment_id": 63135937, "body": "@ConnorCMcKee Models are added now."}, {"owner": {"reputation": 4557, "user_id": 1847280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4124a0c3fbe08db2e0021e3e09b76e7f?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Anfilofyev", "link": "https://stackoverflow.com/users/1847280/yevgeniy-anfilofyev"}, "edited": false, "score": 0, "creation_date": 1465998917, "post_id": 37837145, "comment_id": 63136007, "body": "I think You should read about nested forms: <a href=\"http://guides.rubyonrails.org/form_helpers.html#nested-forms\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/form_helpers.html#nested-forms</a>"}, {"owner": {"reputation": 71, "user_id": 6090379, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/--OHwIEg3ekI/AAAAAAAAAAI/AAAAAAAAAfg/ze_RRyZer-8/photo.jpg?sz=128", "display_name": "FreeLine", "link": "https://stackoverflow.com/users/6090379/freeline"}, "reply_to_user": {"reputation": 4557, "user_id": 1847280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4124a0c3fbe08db2e0021e3e09b76e7f?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Anfilofyev", "link": "https://stackoverflow.com/users/1847280/yevgeniy-anfilofyev"}, "edited": false, "score": 0, "creation_date": 1465999024, "post_id": 37837145, "comment_id": 63136093, "body": "@YevgeniyAnfilofyev Hmmm... The thing is however, that I&#39;m following a tutorial, so changing it will kind of break it.."}, {"owner": {"reputation": 1749, "user_id": 2369455, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4491517018191e1cf9cf103bdc2d18e7?s=128&d=identicon&r=PG", "display_name": "sethi", "link": "https://stackoverflow.com/users/2369455/sethi"}, "edited": false, "score": 0, "creation_date": 1465999673, "post_id": 37837145, "comment_id": 63136582, "body": "The section form is not complete i think you can put the complete code. Looks like it&#39;s a form for a Page model.. and its try to get page_id from a page.. where is the variable f coming from?"}, {"owner": {"reputation": 71, "user_id": 6090379, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/--OHwIEg3ekI/AAAAAAAAAAI/AAAAAAAAAfg/ze_RRyZer-8/photo.jpg?sz=128", "display_name": "FreeLine", "link": "https://stackoverflow.com/users/6090379/freeline"}, "edited": false, "score": 0, "creation_date": 1465999765, "post_id": 37837145, "comment_id": 63136650, "body": "I have new.html.erb that uses the form as a partial: &lt;%= link_to(&quot;&lt;&lt; Back to List&quot;, {:action =&gt; &#39;index&#39;, :page_id =&gt; @page.id}, :class =&gt; &#39;back-link&#39;) %&gt;  &lt;div class=&quot;sections new&quot;&gt; \t&lt;h2&gt;Create Section&lt;/h2&gt; \t&lt;%= form_for(:page, :url =&gt; {:action =&gt; &#39;create&#39;}) do |f| %&gt; \t\t&lt;%= render(:partial =&gt; &quot;sections/form&quot;, :locals =&gt; {:f =&gt; f}) %&gt;  \t\t&lt;div class=&quot;form-buttons&quot;&gt; \t\t\t&lt;%= submit_tag(&quot;Create Section&quot;) %&gt; \t\t&lt;/div&gt;  \t&lt;% end %&gt; &lt;/div&gt;"}, {"owner": {"reputation": 1749, "user_id": 2369455, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4491517018191e1cf9cf103bdc2d18e7?s=128&d=identicon&r=PG", "display_name": "sethi", "link": "https://stackoverflow.com/users/2369455/sethi"}, "edited": false, "score": 0, "creation_date": 1466000914, "post_id": 37837145, "comment_id": 63137543, "body": "may be you wanted form_for(:section. :url.....form for :page will use @page"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1466001093, "post_id": 37837145, "comment_id": 63137696, "body": "@FreeLine can i see yr <code>new.html.erb</code> file how do you call it ?"}, {"owner": {"reputation": 71, "user_id": 6090379, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/--OHwIEg3ekI/AAAAAAAAAAI/AAAAAAAAAfg/ze_RRyZer-8/photo.jpg?sz=128", "display_name": "FreeLine", "link": "https://stackoverflow.com/users/6090379/freeline"}, "reply_to_user": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1466013354, "post_id": 37837145, "comment_id": 63145582, "body": "@7urkm3n I already posted my new.html.erb"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6090379, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/--OHwIEg3ekI/AAAAAAAAAAI/AAAAAAAAAfg/ze_RRyZer-8/photo.jpg?sz=128", "display_name": "FreeLine", "link": "https://stackoverflow.com/users/6090379/freeline"}, "edited": false, "score": 0, "creation_date": 1466013634, "post_id": 37840635, "comment_id": 63145752, "body": "Thanks for the answer, I&#39;ll try fixing it tomorrow (on phone atm). I can&#39;t believe I didn&#39;t notice that... I guess I forgot to change it when I copy pasted the forms. You&#39;re probably right, I&#39;ll mark your answer as correct if it works. Thx"}], "tags": [], "owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "is_accepted": true, "score": 3, "last_activity_date": 1466010441, "last_edit_date": 1466010441, "creation_date": 1466007108, "answer_id": 37840635, "question_id": 37837145, "link": "https://stackoverflow.com/questions/37837145/ruby-on-rails-4-2-6-undefined-method-page-id/37840635#37840635", "title": "Ruby on Rails 4.2.6 Undefined Method page_id", "body": "<p>When you see something like <code>undefined method 'page_id'</code>, where the method is a database column name, it usually means the column is missing from the database table---most often because you haven't yet run the appropriate migration.</p>\n\n<p>In your case, it's not because you haven't run migrations, but because Rails is looking in the wrong table! Note that you are calling <code>page_id</code> on a <code>Page</code>, but it should be a <code>Section</code>:</p>\n\n<pre><code>undefined method `page_id' for #Page:0x0000000b2c1e28.\n</code></pre>\n\n<p>You don't show your <code>form_for</code> in the view, but you should make sure it is <code>form_for @section</code> and not <code>form_for @page</code>.</p>\n\n<p>Also, the reason it gets past line 5 is because <code>f.label</code> doesn't need to call the <code>page_id</code> method, but <code>f.select</code> does (to get the current value).</p>\n"}], "owner": {"reputation": 71, "user_id": 6090379, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/--OHwIEg3ekI/AAAAAAAAAAI/AAAAAAAAAfg/ze_RRyZer-8/photo.jpg?sz=128", "display_name": "FreeLine", "link": "https://stackoverflow.com/users/6090379/freeline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 37840635, "answer_count": 1, "score": 0, "last_activity_date": 1466010441, "creation_date": 1465997945, "last_edit_date": 1495541759, "question_id": 37837145, "link": "https://stackoverflow.com/questions/37837145/ruby-on-rails-4-2-6-undefined-method-page-id", "title": "Ruby on Rails 4.2.6 Undefined Method page_id", "body": "<p>This is the error that I'm getting: undefined method `page_id' for #Page:0x0000000b2c1e28.</p>\n\n<p>Showing C:/Users/eiria/Sites/simple_cms/app/views/sections/_form.html.erb where line #6 raised:</p>\n\n<p>undefined method `page_id' for #\nTrace of template inclusion: app/views/sections/new.html.erb</p>\n\n<p>Rails.root: C:/Users/eiria/Sites/simple_cms</p>\n\n<p>I'm trying to nest Sections inside Pages for my Content Management System.</p>\n\n<p>This is my Sections form:</p>\n\n<pre><code>&lt;%= error_messages_for(@section) %&gt;\n\n&lt;table summary=\"Section form fields\"&gt;\n    &lt;tr&gt;\n        &lt;th&gt;&lt;%= f.label(:page_id, \"Page\") %&gt;&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.select(:page_id, @pages.map {|s| [s.name, s.id]}) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n\n    &lt;tr&gt;\n        &lt;th&gt;&lt;%= f.label(:name) %&gt;&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.text_field(:name) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n\n    &lt;tr&gt;\n        &lt;th&gt;&lt;%= f.label(:position) %&gt;&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.select(:position, 1..@section_count) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n\n    &lt;tr&gt;\n        &lt;th&gt;&lt;%= f.label(:visible) %&gt;&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.select(:visible, {\"Visible\" =&gt; 1, \"Hidden\" =&gt; 2}) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n\n    &lt;tr&gt;\n        &lt;th&gt;&lt;%= f.label(:content_type) %&gt;&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.select(:content_type, ['text', 'HTML']) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n\n    &lt;tr&gt;\n        &lt;th&gt;&lt;%= f.label(:content) %&gt;&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.text_area(:content, :size =&gt; '40x10') %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>This is my Sections controller:</p>\n\n<pre><code>class SectionsController &lt; ApplicationController\n  layout \"admin\"\n\n  before_action :confirm_logged_in\n  before_action :find_page\n\n  def index\n    @sections = @page.sections.sorted\n    @subject = @page.subject\n  end\n\n  def show\n    @section = Section.find(params[:id])\n  end\n\n  def new\n    @section = Section.new({:page_id =&gt; @page.id, :name =&gt; \"Default\"})\n    @pages = Page.order('position ASC')\n    @section_count = Section.count + 1\n  end\n\n  def create\n    @section = Section.new(section_params)\n\n    if @section.save\n      flash[:notice] = \"Section created successfully.\"\n      redirect_to(:action =&gt; 'index', :page_id =&gt; @page.id)\n    else\n      @pages = Page.order('position ASC')\n      @section_count = Section.count + 1\n      render('new')\n    end\n  end\n\n  def \n    @section = Section.find(params[:id])\n    @pages = Page.order('position ASC')\n    @section_count = Section.count\n  end\n\n  def update\n    @section = Section.find(params[:id])\n\n    if @section.update_attributes(section_params)\n      flash[:notice] = \"Section updated successfully.\"\n      redirect_to(:action =&gt; 'show', :id =&gt; @section.id, :page_id =&gt; @page.id)\n    else\n      @section = Section.find(params[:id])\n      @pages = Page.order('position ASC')\n      @section_count = Section.count\n      render('')\n    end\n  end\n\n  def delete\n    @section = Section.find(params[:id])\n  end\n\n  def destroy\n    section = Section.find(params[:id]).destroy\n    flash[:notice] = \"Section '#{section.name}' destroyed succsessfully.\"\n    redirect_to(:action =&gt; 'index')\n  end\n\n  private\n    def section_params\n      params.require(:section).permit(:page_id, :name, :permalink, :position, :visible, :content_type, :content)\n    end\n\n    def find_page\n      if params[:page_id]\n        @page = Page.find(params[:page_id])\n        @subject = @page.subject\n      end\n    end\nend\n</code></pre>\n\n<p>Section model:</p>\n\n<pre><code>class Section &lt; ActiveRecord::Base\n    belongs_to :page\n    has_many :section_edits\n    has_many :editors, :through =&gt; :section_edits, :class_name =&gt; \"AdminUser\"\n\n    CONTENT_TYPES = ['text', 'HTML']\n\n    validates_presence_of :name\n    validates_length_of :name, :maximum =&gt; 255\n\n    validates_inclusion_of :content_type, :in =&gt; CONTENT_TYPES,\n    :message =&gt; \"must be one of: #{CONTENT_TYPES.join(', ')}\"\n    validates_presence_of :content\n\n    scope :visible, lambda { where(:visible =&gt; true) }\n    scope :invisible, lambda { where(:visible =&gt; false) }\n    scope :sorted, lambda { order(\"sections.position ASC\") }\n    scope :newest_first, lambda { order(\"sections.created_at DESC\") }\nend\n</code></pre>\n\n<p>Page model:</p>\n\n<pre><code>class Page &lt; ActiveRecord::Base\n    belongs_to :subject\n    has_many :sections\n    has_and_belongs_to_many :editors, :class_name =&gt; \"AdminUser\"\n\n    validates_presence_of :name\n    validates_length_of :name, :maximum =&gt; 255\n\n    validates_presence_of :permalink\n    validates_length_of :permalink, :within =&gt; 3..255\n    validates_uniqueness_of :permalink\n\n    scope :visible, lambda { where(:visible =&gt; true) }\n    scope :invisible, lambda { where(:visible =&gt; false) }\n    scope :sorted, lambda { order(\"pages.position ASC\") }\n    scope :newest_first, lambda { order(\"pages.created_at DESC\") }\nend\n</code></pre>\n\n<p>I don't see why it says undefined method page_id for line 6, while the same is used for line 5 but theres apparently nothing wrong there...</p>\n\n<p>Any help would be appreciated.</p>\n\n<p>P.S: This is my first question on stackoverflow, so please forgive me for any obvious mistakes. This question is almost completely identical to <a href=\"https://stackoverflow.com/questions/24278758/nomethoderror-in-sectionsedit-similar-issue-to-other\">this</a>, but my problem is creating a new section and not  it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1465997263, "post_id": 37836300, "comment_id": 63134741, "body": "Could you give some more information about the environment you are running, what command you are running, and what the error message says exactly? Possible duplicate of: <a href=\"http://stackoverflow.com/questions/23578440/rails-console-fails-with-switch-to-inspect-mode-in-windows\" title=\"rails console fails with switch to inspect mode in windows\">stackoverflow.com/questions/23578440/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 6469704, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e16de48ac3e23449009028a4e8cabf3?s=128&d=identicon&r=PG&f=1", "display_name": "SIDDHARTH JAIN", "link": "https://stackoverflow.com/users/6469704/siddharth-jain"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1465997315, "post_id": 37836300, "comment_id": 63134778, "body": "&quot;&quot;&quot; $ rails console Loading development environment (Rails 4.2.6) Switch to inspect mode.  &quot;&quot;&quot;&quot;                 This is the line which is coming and nothing is coming after that ,let me know if you have any suggestions."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6469704, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e16de48ac3e23449009028a4e8cabf3?s=128&d=identicon&r=PG&f=1", "display_name": "SIDDHARTH JAIN", "link": "https://stackoverflow.com/users/6469704/siddharth-jain"}, "edited": false, "score": 0, "creation_date": 1466018014, "post_id": 37839001, "comment_id": 63148245, "body": "I am pretty new to this business,so could you let me know how to make out of the terminal . I will get back to you ."}], "tags": [], "owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "is_accepted": false, "score": 0, "last_activity_date": 1466002682, "creation_date": 1466002682, "answer_id": 37839001, "question_id": 37836300, "link": "https://stackoverflow.com/questions/37836300/ruby-on-rails-console-isnt-working-i-am-gettingswitch-to-inspect-mode-on-win/37839001#37839001", "title": "ruby on rails console isn&#39;t working, I am getting&quot;Switch to inspect mode&quot; on windows", "body": "<p>This is likely due to the terminal you're using, not the console itself. (Which terminal are you using...?) Try running <code>$ irb</code> and seeing if you're getting the same issue.</p>\n\n<p>I had the same issue a while back, and momentarily fixed it by changing the irb config output mode, but it still tended to break elsewhere. I recommend using ConEmu to permanently squash the annoyance.</p>\n"}], "owner": {"reputation": 41, "user_id": 6469704, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e16de48ac3e23449009028a4e8cabf3?s=128&d=identicon&r=PG&f=1", "display_name": "SIDDHARTH JAIN", "link": "https://stackoverflow.com/users/6469704/siddharth-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1269, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466002682, "creation_date": 1465995864, "question_id": 37836300, "link": "https://stackoverflow.com/questions/37836300/ruby-on-rails-console-isnt-working-i-am-gettingswitch-to-inspect-mode-on-win", "title": "ruby on rails console isn&#39;t working, I am getting&quot;Switch to inspect mode&quot; on windows", "body": "<p>When I run my rails console it is saying \"Switch to inspect mode\" .I am working on windows . Kindly help !</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "zsh"], "answers": [{"comments": [{"owner": {"reputation": 775, "user_id": 2001053, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/IdGSk.jpg?s=128&g=1", "display_name": "Leo Le", "link": "https://stackoverflow.com/users/2001053/leo-le"}, "edited": false, "score": 0, "creation_date": 1465996044, "post_id": 37835999, "comment_id": 63133828, "body": "no, still error: bundle exec rspec --tag ~http_request zsh: no such user or named directory: http_request"}], "tags": [], "owner": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "is_accepted": false, "score": 0, "last_activity_date": 1465995955, "last_edit_date": 1465995955, "creation_date": 1465995032, "answer_id": 37835999, "question_id": 37835770, "link": "https://stackoverflow.com/questions/37835770/cannot-run-rspec-with-filter-tags/37835999#37835999", "title": "Cannot run rspec with filter tags", "body": "<pre><code>bundle exec rspec --tag ~http_request\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 775, "user_id": 2001053, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/IdGSk.jpg?s=128&g=1", "display_name": "Leo Le", "link": "https://stackoverflow.com/users/2001053/leo-le"}, "edited": false, "score": 0, "creation_date": 1465995685, "post_id": 37836056, "comment_id": 63133571, "body": "it didn&#39;t work. it still run all spec files after I added to .rspec file"}, {"owner": {"reputation": 1431, "user_id": 729535, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5593abb6ec21bc7a9c2070a82a27e4e3?s=128&d=identicon&r=PG", "display_name": "Luiz Carvalho", "link": "https://stackoverflow.com/users/729535/luiz-carvalho"}, "reply_to_user": {"reputation": 775, "user_id": 2001053, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/IdGSk.jpg?s=128&g=1", "display_name": "Leo Le", "link": "https://stackoverflow.com/users/2001053/leo-le"}, "edited": false, "score": 0, "creation_date": 1465995966, "post_id": 37836056, "comment_id": 63133774, "body": "@LeoLe You try --tag instead -t ?"}, {"owner": {"reputation": 775, "user_id": 2001053, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/IdGSk.jpg?s=128&g=1", "display_name": "Leo Le", "link": "https://stackoverflow.com/users/2001053/leo-le"}, "edited": false, "score": 0, "creation_date": 1465996054, "post_id": 37836056, "comment_id": 63133833, "body": "no, still error: bundle exec rspec --tag ~http_request zsh: no such user or named directory: http_request"}, {"owner": {"reputation": 1431, "user_id": 729535, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5593abb6ec21bc7a9c2070a82a27e4e3?s=128&d=identicon&r=PG", "display_name": "Luiz Carvalho", "link": "https://stackoverflow.com/users/729535/luiz-carvalho"}, "reply_to_user": {"reputation": 775, "user_id": 2001053, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/IdGSk.jpg?s=128&g=1", "display_name": "Leo Le", "link": "https://stackoverflow.com/users/2001053/leo-le"}, "edited": false, "score": 0, "creation_date": 1465996140, "post_id": 37836056, "comment_id": 63133896, "body": "You use oh-my-zsh?"}, {"owner": {"reputation": 775, "user_id": 2001053, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/IdGSk.jpg?s=128&g=1", "display_name": "Leo Le", "link": "https://stackoverflow.com/users/2001053/leo-le"}, "edited": false, "score": 0, "creation_date": 1465996385, "post_id": 37836056, "comment_id": 63134071, "body": "same result ! noglob rspec -t ~ http_request zsh: no such user or named directory: http_request"}, {"owner": {"reputation": 1431, "user_id": 729535, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5593abb6ec21bc7a9c2070a82a27e4e3?s=128&d=identicon&r=PG", "display_name": "Luiz Carvalho", "link": "https://stackoverflow.com/users/729535/luiz-carvalho"}, "reply_to_user": {"reputation": 775, "user_id": 2001053, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/IdGSk.jpg?s=128&g=1", "display_name": "Leo Le", "link": "https://stackoverflow.com/users/2001053/leo-le"}, "edited": false, "score": 0, "creation_date": 1465997350, "post_id": 37836056, "comment_id": 63134808, "body": "Temporarily, change to bash and try again. If works your problem is zsh! :)"}], "tags": [], "owner": {"reputation": 1431, "user_id": 729535, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5593abb6ec21bc7a9c2070a82a27e4e3?s=128&d=identicon&r=PG", "display_name": "Luiz Carvalho", "link": "https://stackoverflow.com/users/729535/luiz-carvalho"}, "is_accepted": false, "score": 0, "last_activity_date": 1466013444, "last_edit_date": 1466013444, "creation_date": 1465995192, "answer_id": 37836056, "question_id": 37835770, "link": "https://stackoverflow.com/questions/37835770/cannot-run-rspec-with-filter-tags/37836056#37836056", "title": "Cannot run rspec with filter tags", "body": "<p>In zsh the ~name syntax is expanded to /folder/of/name/user. You can bypass this behavior by adding noglob at the beginning of the command: noglob rspec.... You can also alias the rspec command so that you don't have to put write that every time: alias rspec='noglob rspec '. </p>\n"}, {"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 5, "last_activity_date": 1465996209, "creation_date": 1465996209, "answer_id": 37836438, "question_id": 37835770, "link": "https://stackoverflow.com/questions/37835770/cannot-run-rspec-with-filter-tags/37836438#37836438", "title": "Cannot run rspec with filter tags", "body": "<p>Try something like</p>\n\n<pre><code>rspec --tag \"~http_request\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2291, "user_id": 1752333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1009edfa56c5a71d0e6de2738342bee7?s=128&d=identicon&r=PG", "display_name": "scorix", "link": "https://stackoverflow.com/users/1752333/scorix"}, "is_accepted": false, "score": 0, "last_activity_date": 1466005118, "last_edit_date": 1492086165, "creation_date": 1466005118, "answer_id": 37839924, "question_id": 37835770, "link": "https://stackoverflow.com/questions/37835770/cannot-run-rspec-with-filter-tags/37839924#37839924", "title": "Cannot run rspec with filter tags", "body": "<p>I don't know why, but <code>~http_request</code> has been recognized as the home folder of user \"http_request\".</p>\n\n<p>You can escape <code>~</code> by using <code>\\~</code></p>\n\n<pre><code>bundle exec rspec -t \\~http_request\n</code></pre>\n\n<p>Ref: <a href=\"https://askubuntu.com/questions/442394/why-does-cd-k-tab-expands-to-cd-kernoops-when-i-already-have-a-folder-name#\">https://askubuntu.com/questions/442394/why-does-cd-k-tab-expands-to-cd-kernoops-when-i-already-have-a-folder-name#</a></p>\n"}], "owner": {"reputation": 775, "user_id": 2001053, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/IdGSk.jpg?s=128&g=1", "display_name": "Leo Le", "link": "https://stackoverflow.com/users/2001053/leo-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 37836438, "answer_count": 4, "score": 4, "last_activity_date": 1482334307, "creation_date": 1465994469, "last_edit_date": 1482334307, "question_id": 37835770, "link": "https://stackoverflow.com/questions/37835770/cannot-run-rspec-with-filter-tags", "title": "Cannot run rspec with filter tags", "body": "<p>I have spec </p>\n\n<pre><code>RSpec.describe SearchFlight::Jet::SearchFlightRequest do\n  describe 'send search ticket request to Jetstar website', http_request: true do\n    context 'search ticket round trip successfully' do\n      # initialize\n      it 'return status 200' do\n        # my expects here ...\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>When I run rspec on my iterm, it couldn't run</p>\n\n<pre><code>bundle exec rspec -t ~http_request\nzsh: no such user or named directory: http_request\n</code></pre>\n\n<p>Maybe it related to zsh command line (<a href=\"https://github.com/robbyrussell/oh-my-zsh/issues/3957\" rel=\"nofollow\">issue</a>). I try to remove zsh from my iTerms 2 but it's not success. Any alternative shell for Rails dev ? Thanks</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "syntax-highlighting", "rubymine"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1465994629, "post_id": 37835759, "comment_id": 63132755, "body": "What is the filename?"}, {"owner": {"reputation": 6018, "user_id": 3446655, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AH6Ys.jpg?s=128&g=1", "display_name": "HarlemSquirrel", "link": "https://stackoverflow.com/users/3446655/harlemsquirrel"}, "edited": false, "score": 0, "creation_date": 1465994720, "post_id": 37835759, "comment_id": 63132815, "body": "Are you using the Atom editor?"}, {"owner": {"reputation": 1281, "user_id": 1225966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/103d218de0d98da52cdb9c0ea6a4013e?s=128&d=identicon&r=PG", "display_name": "daniel f.", "link": "https://stackoverflow.com/users/1225966/daniel-f"}, "edited": false, "score": 0, "creation_date": 1465994949, "post_id": 37835759, "comment_id": 63132983, "body": "SergioTulentsev: the filename is something.js.erb HarlemSquirrel: no, i am using RubyMine 2016.1.1"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1465994954, "post_id": 37835759, "comment_id": 63132988, "body": "Hm, yes, you&#39;re right, without .erb extension it wouldn&#39;t work. However, my installation of rubymine doesn&#39;t have any problems in the small snippet I tried. Post the full content of the file."}], "owner": {"reputation": 1281, "user_id": 1225966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/103d218de0d98da52cdb9c0ea6a4013e?s=128&d=identicon&r=PG", "display_name": "daniel f.", "link": "https://stackoverflow.com/users/1225966/daniel-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 434, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1551974639, "creation_date": 1465994441, "last_edit_date": 1551974639, "question_id": 37835759, "link": "https://stackoverflow.com/questions/37835759/rubymine-syntax-highlighting-in-js-erb-files", "title": "Rubymine syntax highlighting in js.erb files", "body": "<p>I have javascript files that have embedded ruby. While functionally everything works fine, the syntax highlighting as well as the error inspection function of RubyMine 2016 has issues with that.</p>\n\n<p>The first time i embed ruby in the javascript file by using the <code>&lt;%= ... %&gt;</code> syntax, something goes horribly wrong. See attached screenshot. I guess that RubyMine interprets the <code>&lt;</code> sign as a comparison operator.</p>\n\n<p>As i assume that embedding ruby in JavaScript is quite common, is there a way to make RubyMine play nice with my functional (and correct) code?</p>\n\n<p>Otherwise it looks like i have a huge number of errors, and editing becomes quite unintuitive:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pbnUw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pbnUw.jpg\" alt=\"over 9000 errors\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "time", "insert"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1465993397, "post_id": 37834974, "comment_id": 63131838, "body": "Rails stores datetime converted to UTC in the database. So I don&#39;t see an issue here."}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1465994026, "post_id": 37834974, "comment_id": 63132297, "body": "share some code and what you would like to see final result."}, {"owner": {"reputation": 517, "user_id": 4595818, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ICCSy.jpg?s=128&g=1", "display_name": "Kinjal Shah", "link": "https://stackoverflow.com/users/4595818/kinjal-shah"}, "edited": false, "score": 0, "creation_date": 1465995042, "post_id": 37834974, "comment_id": 63133048, "body": "please check your timezone in application.rb config.time_zone = &#39;your timezone&#39;. The time value is storage in database as  you specify timezone in that."}, {"owner": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "edited": false, "score": 0, "creation_date": 1466055158, "post_id": 37834974, "comment_id": 63160155, "body": "But I need to convert it into UTC too when displaying on webpage. It is displaying time in webpage in IST format but I need UTC"}], "answers": [{"tags": [], "owner": {"reputation": 594, "user_id": 8934465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tzs1gobeQZ8/AAAAAAAAAAI/AAAAAAAAAOw/irKKhYM8Xj4/photo.jpg?sz=128", "display_name": "Milan Pudasaini", "link": "https://stackoverflow.com/users/8934465/milan-pudasaini"}, "is_accepted": false, "score": 0, "last_activity_date": 1465994048, "last_edit_date": 1495535345, "creation_date": 1465994048, "answer_id": 37835603, "question_id": 37834974, "link": "https://stackoverflow.com/questions/37834974/can-not-store-time-in-database/37835603#37835603", "title": "Can not store time in database", "body": "<p>It is just that the active record is using the utc as a timezone.\nIf you want Active Record to store your time in the preferred timezone, change here</p>\n\n<pre><code># application.rb\nconfig.time_zone = 'Eastern Time (US &amp; Canada)' //insert your time zone here\nconfig.active_record.default_timezone = :local\n</code></pre>\n\n<p>reference: <a href=\"https://stackoverflow.com/questions/6118779/how-to-change-default-timezone-for-active-record-in-rails\">How to change default timezone for Active Record in Rails?</a></p>\n"}], "owner": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465994048, "creation_date": 1465992330, "question_id": 37834974, "link": "https://stackoverflow.com/questions/37834974/can-not-store-time-in-database", "title": "Can not store time in database", "body": "<p>I have used the Time.new method in my rails application to get the current date and I want to store this date into a variable of type datetime . I am using postgresql. Now if I insert the date of this format manually into table using pgAdminIII ,it is working fine but if I try to insert the time into the table via a controller code then it is storing a different date time into table.</p>\n\n<p>For example suppose the current time is:-</p>\n\n<p>2016-06-15 17:29:29 </p>\n\n<p>And if I insert this date and time into the table manually by copying this line from webpage then it is working fine. </p>\n\n<p>But my controller code to store it into table is inserting something else like</p>\n\n<p>2016-06-15 11:41:39</p>\n\n<p>Note: I have used only Time.new (time region is not specified in my code) </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "active-model-serializers"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5710450"}, "edited": false, "score": 0, "creation_date": 1466053847, "post_id": 37834727, "comment_id": 63159715, "body": "<code>@products</code> returning same values for next new request&#39;s too. how can i restrict it any idea?? @pascal betz"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1466063127, "post_id": 37834727, "comment_id": 63164406, "body": "what do you mean by &quot;request&quot;? HTTP Request? Or just &quot;method call&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5710450"}, "edited": false, "score": 0, "creation_date": 1466088661, "post_id": 37834727, "comment_id": 63182359, "body": "<code>HTTP</code> request. sent by <code>curl</code>"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1466088722, "post_id": 37834727, "comment_id": 63182404, "body": "Well, if state of instance variables are kept across requests, then something is rotten. Are you storing the serializer somehow?"}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 1, "last_activity_date": 1465991633, "creation_date": 1465991633, "answer_id": 37834727, "question_id": 37834486, "link": "https://stackoverflow.com/questions/37834486/how-to-avoid-querying-multiple-times-in-serializer/37834727#37834727", "title": "How to avoid querying multiple times in serializer?", "body": "<p>You can use <em>memoization</em>:</p>\n\n<pre><code>def products\n  @products ||= begin\n    some code \n    more code\n   end\nend\n</code></pre>\n\n<p>or if it is just a short piece of code</p>\n\n<pre><code>def products\n  @products ||= some code\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5710450"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470947083, "creation_date": 1465990980, "last_edit_date": 1470947083, "question_id": 37834486, "link": "https://stackoverflow.com/questions/37834486/how-to-avoid-querying-multiple-times-in-serializer", "title": "How to avoid querying multiple times in serializer?", "body": "<p>I have a model <code>story.rb</code> with field <code>product_ids</code>. it is a <code>Array</code>of ids.\nin <code>story_controller</code> <code>show</code> action I have to return a <code>story</code> with it's <code>products</code> and <code>stores</code>. I am returning response through <code>story_serializer</code>. like this</p>\n\n<p>Note: <code>story</code> has no association with <code>store</code></p>\n\n<pre><code>class StorySerializer &lt; ActiveModel::Serializer\n  ----\n  ----\n def products\n    here my query for products using `product_ids`\n end\n\n def stores\n    here is the problem\n    to find stores, I have to find product's first and then find store's of that product. so again I am querying for products here.\n end\n\nend\n</code></pre>\n\n<p>I have <code>product_ids</code> so i can easily returns all the related products of that <code>story</code>, but the problem is to return related <code>stores</code>. How can I return store's without querying for products again. Any suggestions would be helpful.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1465997696, "post_id": 37834366, "comment_id": 63135042, "body": "It is not a wild card. It does not work like that."}], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 4, "last_activity_date": 1465990980, "creation_date": 1465990980, "answer_id": 37834485, "question_id": 37834366, "link": "https://stackoverflow.com/questions/37834366/using-wildcards-in-gsub/37834485#37834485", "title": "Using wildcards in gsub", "body": "<p>You can use regex for this purpose</p>\n\n<pre><code>\"String with text and $abc$ and $def$ and so on... \".gsub(/\\$\\w+\\$/, \"replaceText\")\n#=&gt; \"String with text and replaceText and replaceText and so on... \"\n</code></pre>\n\n<p>Remember you will need to escape $</p>\n"}, {"tags": [], "owner": {"reputation": 10770, "user_id": 381874, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/k7VRE.jpg?s=128&g=1", "display_name": "Sachin R", "link": "https://stackoverflow.com/users/381874/sachin-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1465991137, "creation_date": 1465991137, "answer_id": 37834547, "question_id": 37834366, "link": "https://stackoverflow.com/questions/37834366/using-wildcards-in-gsub/37834547#37834547", "title": "Using wildcards in gsub", "body": "<pre><code>\"String with text and $abc$ and $def$ and so on... \".gsub(/\\$\\w+\\$/, \"replaceText\")\n</code></pre>\n\n<p>Try \\$\\w+\\$ in <a href=\"http://rubular.com/\" rel=\"nofollow\">http://rubular.com/</a> </p>\n\n<p><a href=\"http://rubular.com/r/ZbgdVQvDGb\" rel=\"nofollow\">http://rubular.com/r/ZbgdVQvDGb</a></p>\n"}, {"comments": [{"owner": {"reputation": 431, "user_id": 1676959, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/L1rcL.png?s=128&g=1", "display_name": "kernification", "link": "https://stackoverflow.com/users/1676959/kernification"}, "edited": false, "score": 0, "creation_date": 1466149176, "post_id": 37834702, "comment_id": 63207030, "body": "This also works with special caracters like &quot;&#228;&quot; or &quot;&#252;&quot;"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 431, "user_id": 1676959, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/L1rcL.png?s=128&g=1", "display_name": "kernification", "link": "https://stackoverflow.com/users/1676959/kernification"}, "edited": false, "score": 0, "creation_date": 1466149651, "post_id": 37834702, "comment_id": 63207280, "body": "I am not sure I understood how it is supposed to be used with letters from some European alphabets, having diacritics."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1465991563, "creation_date": 1465991563, "answer_id": 37834702, "question_id": 37834366, "link": "https://stackoverflow.com/questions/37834366/using-wildcards-in-gsub/37834702#37834702", "title": "Using wildcards in gsub", "body": "<p>Just out of curiosity: whether one has more delimiters (not the dollar sign only,) she might use <a href=\"http://ruby-doc.org/core-2.3.0/Regexp.html#class-Regexp-label-Capturing\" rel=\"nofollow\">back-references</a>:</p>\n\n<pre><code>str = \"String with text and $abc$ and *def* and so on... \"\nstr.gsub(/(?&lt;delim&gt;[$*]).*?\\k&lt;delim&gt;/, \"replaceText\")\n#\u21d2 \"String with text and replaceText and replaceText and so on... \"\n</code></pre>\n\n<p>Note that inside <code>[]</code> there is no need to escape <code>$</code> (<code>*</code> neither.)</p>\n"}], "owner": {"reputation": 431, "user_id": 1676959, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/L1rcL.png?s=128&g=1", "display_name": "kernification", "link": "https://stackoverflow.com/users/1676959/kernification"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 37834485, "answer_count": 3, "score": -1, "last_activity_date": 1465997618, "creation_date": 1465990659, "last_edit_date": 1465997618, "question_id": 37834366, "link": "https://stackoverflow.com/questions/37834366/using-wildcards-in-gsub", "title": "Using wildcards in gsub", "body": "<p>I would like to do something like this:</p>\n\n<pre><code>\"String with text and $abc$ and $def$ and so on... \".gsub(\"$*$\", \"replaceText\")\n</code></pre>\n\n<p>which results in</p>\n\n<pre><code>\"String with text and replaceText and replaceText and so on... \"\n</code></pre>\n\n<p>But I have no idea how wildcards like <code>*</code> work here.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "ruby-2.3"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1465999993, "post_id": 37834065, "comment_id": 63136838, "body": "The method argument specifies the number of <i>bytes</i>. Therefore, <code>urlsafe_base64(1)</code> generates 256 values, <code>urlsafe_base64(2)</code> generates 65,536 values and so on (256^n). Besides, assuming that 65,535 tokens of &quot;length&quot; 2 have been created (only one is left), how do you generate that last one?"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1465998440, "post_id": 37834329, "comment_id": 63135633, "body": "Note that <code>64 ^ n</code> is not equivalent to <code>64 ** n</code>"}, {"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1465998577, "post_id": 37834329, "comment_id": 63135738, "body": "Thanks Stefan, I changed it"}], "tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": true, "score": 2, "last_activity_date": 1465998554, "last_edit_date": 1465998554, "creation_date": 1465990557, "answer_id": 37834329, "question_id": 37834065, "link": "https://stackoverflow.com/questions/37834065/check-if-there-are-any-unique-tokens-left-of-a-certain-character-length/37834329#37834329", "title": "Check if there are any unique tokens left of a certain character length", "body": "<p>It would be something like :</p>\n\n<pre><code>64**n - Post.count(:token).where('char_length(token) = ?', n)\n</code></pre>\n\n<p>The first part gives the number of combinations possible and the second the number of records with a token length of n.</p>\n\n<p>But don't forget that your random generator won't necessarily generate the remaining possible combinations. There will be exponentially more and more collisions over the time, therefore I'd strongly discourage this kind of implementation.</p>\n\n<p>Note: The <code>char_length</code> statement is MySQL specific, so depending on your RDBMS, you'll have to adapt this part.</p>\n"}], "owner": {"reputation": 25043, "user_id": 1417223, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dbdfe3d2d5f87f172757ada1438f3d16?s=128&d=identicon&r=PG", "display_name": "Fellow Stranger", "link": "https://stackoverflow.com/users/1417223/fellow-stranger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 37834329, "answer_count": 1, "score": 0, "last_activity_date": 1465998554, "creation_date": 1465989814, "question_id": 37834065, "link": "https://stackoverflow.com/questions/37834065/check-if-there-are-any-unique-tokens-left-of-a-certain-character-length", "title": "Check if there are any unique tokens left of a certain character length", "body": "<p>I have a Post model with the attribute <code>token</code>.</p>\n\n<p>I'm using <code>SecureRandom.urlsafe_base64(length_of_token)</code> to create a token.</p>\n\n<p>The token doesn't need to be unguessable, but must be unique.</p>\n\n<p>I'm starting with tokens 1 character long, and when they are all used up (all 64 combinations), I should move on to have tokens that are 2 characters long.</p>\n\n<p>How should I check if there are any token variations left for tokens that are 3 characters long?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "devise"], "comments": [{"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "edited": false, "score": 0, "creation_date": 1465989074, "post_id": 37833751, "comment_id": 63128646, "body": "that does not sound very secure..."}, {"owner": {"reputation": 7389, "user_id": 2235594, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4MssP.jpg?s=128&g=1", "display_name": "davegson", "link": "https://stackoverflow.com/users/2235594/davegson"}, "edited": false, "score": 0, "creation_date": 1465989130, "post_id": 37833751, "comment_id": 63128681, "body": "that is a horrible idea. And no this is not possible, that&#39;s the point of encrypting the password"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1465989301, "post_id": 37833751, "comment_id": 63128799, "body": "Nope, not possible."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1465990044, "post_id": 37833751, "comment_id": 63129318, "body": "Send the <b>ENCRYPTED</b> passwords to the client application. Never store/send passwords in plain-text (unless it&#39;s a temporary password)."}, {"owner": {"reputation": 371, "user_id": 1709739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/3c9566cb47c09e87a392c97e142a27dc?s=128&d=identicon&r=PG", "display_name": "Chetan Kalore", "link": "https://stackoverflow.com/users/1709739/chetan-kalore"}, "edited": false, "score": 0, "creation_date": 1465990090, "post_id": 37833751, "comment_id": 63129361, "body": "Which algorithm devise uses for encryption ? How does it compare/match the password we enter in login screen with database encrypted password ?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1465990626, "post_id": 37833751, "comment_id": 63129780, "body": "@TomLord: what good is the encrypted password in the client application?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1465990823, "post_id": 37833751, "comment_id": 63129958, "body": "@ChetanKalore: &quot;How does it compare/match the password&quot; - one-way hashing functions. Devise uses bcrypt."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1465991218, "post_id": 37833751, "comment_id": 63130291, "body": "@SergioTulentsev - because you could use the encrypted passwords to seed the client application database, and then perform authentication like normal? It&#39;s not ideal, but better than sending plain-text."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1465992494, "post_id": 37833751, "comment_id": 63131219, "body": "@TomLord: ah, I missed the offline authentication requirement. Yeah, storing hashed/salted password locally could work for this certain use case, but sounds generally suboptimal."}, {"owner": {"reputation": 371, "user_id": 1709739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/3c9566cb47c09e87a392c97e142a27dc?s=128&d=identicon&r=PG", "display_name": "Chetan Kalore", "link": "https://stackoverflow.com/users/1709739/chetan-kalore"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1465994602, "post_id": 37833751, "comment_id": 63132730, "body": "@SergioTulentsev: Suppose I have copied the users with encrypted password in the client application. We have 2 columns in users table - encrypted_password and password_salt. If I am using the same algo. &quot;bcrypt&quot; in client application as well, then how we can do the comparison and with which column out of these &quot;encrypted_password and password_salt&quot; ? Do you have any idea?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1465995294, "post_id": 37833751, "comment_id": 63133241, "body": "@ChetanKalore: huh? Do you know how hash functions work? To authenticate a user, you take his plain text password, salt it, calculate its hash and compare the hash to that stored in the database. If they match, the password is correct."}, {"owner": {"reputation": 371, "user_id": 1709739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/3c9566cb47c09e87a392c97e142a27dc?s=128&d=identicon&r=PG", "display_name": "Chetan Kalore", "link": "https://stackoverflow.com/users/1709739/chetan-kalore"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1466407694, "post_id": 37833751, "comment_id": 63284557, "body": "@SergioTulentsev: I have followed the above process for generating the encrypted password. I have SHA1 algorithm set in my devise, the result of Digest::SHA1.hexdigest(salt+password) should match with encrypted_password value right ? But is not matching in my case. Do you have any idea ?"}], "owner": {"reputation": 371, "user_id": 1709739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/3c9566cb47c09e87a392c97e142a27dc?s=128&d=identicon&r=PG", "display_name": "Chetan Kalore", "link": "https://stackoverflow.com/users/1709739/chetan-kalore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "closed_date": 1465989692, "answer_count": 0, "score": 0, "last_activity_date": 1465989258, "creation_date": 1465989027, "question_id": 37833751, "link": "https://stackoverflow.com/questions/37833751/ruby-on-rails-devise-gem-how-to-retrieve-decrypted-password-plain-text-fro", "closed_reason": "Duplicate", "title": "Ruby on Rails - devise gem - How to retrieve decrypted password (plain text) from users table", "body": "<p>Is there any way we can retrieve the password from users table. I am using ruby gem devise for authentication in my rails application.</p>\n\n<p>The use case is, I need to send the users with passwords to client application (Desktop), so that the authentication can happen locally as well (In case there is no internet, then still user would be authenticated in client application and would be able to use the application).</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 845, "user_id": 5646801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d133162c0a6c4b45ad559f5a86f8f8a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii K", "link": "https://stackoverflow.com/users/5646801/sergii-k"}, "edited": false, "score": 3, "creation_date": 1465988402, "post_id": 37833098, "comment_id": 63128189, "body": "Your code also can be DRY-ed: <code>puts &quot;This is the bigger number #{one &gt; two ? one : two}&quot;</code>."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1465989003, "post_id": 37833098, "comment_id": 63128590, "body": "What is your fault?"}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1465989253, "post_id": 37833098, "comment_id": 63128770, "body": "I dont see any problem, this code works correctly for me."}], "answers": [{"tags": [], "owner": {"reputation": 1656, "user_id": 6138119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YzV7y.jpg?s=128&g=1", "display_name": "Pravesh Khatri", "link": "https://stackoverflow.com/users/6138119/pravesh-khatri"}, "is_accepted": false, "score": 2, "last_activity_date": 1465987341, "creation_date": 1465987341, "answer_id": 37833157, "question_id": 37833098, "link": "https://stackoverflow.com/questions/37833098/code-should-return-highest-of-two-numbers-entered-by-the-user/37833157#37833157", "title": "Code should return highest of two numbers entered by the user", "body": "<p>you didn't change them to integer, <code>gets.chomp</code> gives you string.</p>\n\n<pre><code> puts \"Give me a number\"\n one = gets.chomp.to_i\n puts \"Give me another number\"\n two = gets.chomp.to_i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1099, "user_id": 2799029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea432dc7b47d95cba6b39b0446feb5e?s=128&d=identicon&r=PG&f=1", "display_name": "floum", "link": "https://stackoverflow.com/users/2799029/floum"}, "is_accepted": false, "score": 0, "last_activity_date": 1465991332, "creation_date": 1465991332, "answer_id": 37834612, "question_id": 37833098, "link": "https://stackoverflow.com/questions/37833098/code-should-return-highest-of-two-numbers-entered-by-the-user/37834612#37834612", "title": "Code should return highest of two numbers entered by the user", "body": "<p>First, you are gathering input from an external user of your \"application\", you then have to decide how you want to manage wrong input and conversion.</p>\n\n<ul>\n<li>In any case, gets will return a String</li>\n<li>You are going for numbers, but are they <code>Integer</code>, <code>Float</code> ?</li>\n</ul>\n\n<p>Since <code>String</code> is <code>Comparable</code>, your original code will run but will probably not yield the expected returns.</p>\n\n<p>Let's say you are only interested in Integers.</p>\n\n<p>You will have three conversion functions to consider : </p>\n\n<ul>\n<li><code>Kernel#Integer</code> (which is included in the top-level binding)</li>\n<li><code>String#to_i</code>.</li>\n</ul>\n\n<p><code>String#to_i</code> will never return an error.</p>\n\n<pre><code> 'abcd'.to_i      #=&gt; 0\n '1.2'.to_i       #=&gt; 1\n nil.to_i         #=&gt; 0\n</code></pre>\n\n<p><code>Kernel#Integer</code> will return an error if the String is not a valid Integer. (which I generally find more appropriate for user inputs).</p>\n\n<pre><code>Integer('0')     #=&gt; 0\nInteger('abcd')  #=&gt; ArgumentError\nInteger(nil)     #=&gt; TypeError\n</code></pre>\n\n<p>Finally, you will have to compare your inputs. I personnally would use <code>Array#max</code> since it conveys optimal readability (at the expense of performance still, but you do not seem to be in a performance critical system).</p>\n\n<p>My final code would look like this (without error handling):</p>\n\n<pre><code>inputs = []\n2.times do\n  puts 'Give me a number'\n  inputs &lt;&lt; Integer(gets.chomp) # or use gets.chomp.to_i\nend\n\nputs \"This is the bigger number : #{inputs.max}\"\n</code></pre>\n\n<p>More refactoring can be done but I don't think it would serve for beginners in Ruby.</p>\n"}], "owner": {"reputation": 21, "user_id": 4124314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1649148520/picture?type=large", "display_name": "Timo B.", "link": "https://stackoverflow.com/users/4124314/timo-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "answer_count": 2, "score": -4, "last_activity_date": 1466002987, "creation_date": 1465987180, "last_edit_date": 1466002987, "question_id": 37833098, "link": "https://stackoverflow.com/questions/37833098/code-should-return-highest-of-two-numbers-entered-by-the-user", "title": "Code should return highest of two numbers entered by the user", "body": "<p>This is the code. </p>\n\n<pre><code>puts \"Give me a number\"\none = gets.chomp\nputs \"Give me another number\"\ntwo = gets.chomp\n\nif one &gt; two\n    puts \"This is the bigger number #{one}\"\nelse\n    puts \"This is the bigger number #{two}\"\nend\n</code></pre>\n\n<p>I don't know where my fault is.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "value-objects"], "owner": {"reputation": 1042, "user_id": 1044162, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/RBoXK.jpg?s=128&g=1", "display_name": "Aleksandr K.", "link": "https://stackoverflow.com/users/1044162/aleksandr-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1465987041, "creation_date": 1465987041, "question_id": 37833031, "link": "https://stackoverflow.com/questions/37833031/implementation-value-object-pattern-for-activerecord-attribute", "title": "Implementation Value Object pattern for ActiveRecord attribute", "body": "<p>The task was allow user to view, create, edit records in different units, i.e. altitude in meters and feets, speed in m/s, knots, km/h, mi/h.</p>\n\n<p>I've read a lot about Value Objects, <code>composed_of</code> and why we should not use it and use <code>serialize</code> instead and came with solution below.</p>\n\n<p>It seems like complex solution for me. \nCould you please point me what can I refactor and direction for it?</p>\n\n<p><code>app/models/weather.rb</code></p>\n\n<pre><code>class Weather &lt; ActiveRecord::Base\n  attr_accessor :altitude_unit, :wind_speed_unit\n  attr_reader :altitude_in_units, :wind_speed_in_units\n\n  belongs_to :weatherable, polymorphic: true\n\n  before_save :set_altitude, :set_wind_speed\n\n  validates_presence_of :actual_on, :wind_direction\n  validate :altitude_present?\n  validate :wind_speed_present?\n\n  validates_numericality_of :altitude, greater_than_or_equal_to: 0, allow_nil: true\n  validates_numericality_of :altitude_in_units, greater_than_or_equal_to: 0, allow_nil: true\n  validates_numericality_of :wind_speed, greater_than_or_equal_to: 0, allow_nil: true\n  validates_numericality_of :wind_speed_in_units, greater_than_or_equal_to: 0, allow_nil: true\n  validates_numericality_of :wind_direction, greater_than_or_equal_to: 0, less_than: 360, allow_nil: true\n\n  serialize :altitude, Distance\n  serialize :wind_speed, Velocity\n\n  def wind_speed_in_units=(value)\n    @wind_speed_in_units = value_from_param(value)\n  end\n\n  def altitude_in_units=(value)\n    @altitude_in_units = value_from_param(value)\n  end\n\n  private\n\n  def value_from_param(value)\n    return nil if value.is_a?(String) &amp;&amp; value.empty?\n    value\n  end\n\n  def altitude_present?\n    return if altitude.present? || altitude_in_units.present?\n    errors.add :altitude, :blank\n  end\n\n  def wind_speed_present?\n    return if wind_speed.present? || wind_speed_in_units.present?\n    errors.add :wind_speed, :blank\n  end\n\n  def set_altitude\n    return if altitude_in_units.blank? || altitude_unit.blank?\n    self.altitude = Distance.new(altitude_in_units, altitude_unit)\n  end\n\n  def set_wind_speed\n    return if wind_speed_in_units.blank? || wind_speed_unit.blank?\n    self.wind_speed = Velocity.new(wind_speed_in_units, wind_speed_unit)\n  end\nend\n</code></pre>\n\n<p><code>app/model/distance.rb</code></p>\n\n<pre><code>class Distance &lt; DelegateClass(BigDecimal)\n\n  FT_IN_M = 3.280839895\n\n  def self.load(distance)\n    new(distance) unless distance.nil?\n  end\n\n  def self.dump(obj)\n    obj.dump\n  end\n\n  def initialize(distance, unit = 'm')\n    value = convert_from(BigDecimal.new(distance), unit)\n    super(value)\n  end\n\n  def dump\n    @delegate_dc_obj\n  end\n\n  def convert_to(unit)\n    method = \"to_#{unit}\"\n    raise ArgumentError, \"Unsupported unit #{unit}\" unless respond_to? method\n    send method\n  end\n\n  def convert_from(val, unit)\n    method = \"from_#{unit}\"\n    raise ArgumentError, \"Unsupported unit #{unit}\" unless respond_to? method\n    send method, val\n  end\n\n  def to_m\n    @delegate_dc_obj\n  end\n\n  def to_ft\n    @delegate_dc_obj * FT_IN_M\n  end\n\n  def from_m(val)\n    val\n  end\n\n  def from_ft(val)\n    val / FT_IN_M\n  end\nend\n</code></pre>\n\n<p><code>app/models/velocity.rb</code> is almost the same as distance.</p>\n"}, {"tags": ["ruby", "image", "binary-data"], "answers": [{"comments": [{"owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "edited": false, "score": 0, "creation_date": 1465988588, "post_id": 37833520, "comment_id": 63128328, "body": "Hi Keith, thanks for your reply. so how can i create image of binary data?"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "edited": false, "score": 0, "creation_date": 1465988741, "post_id": 37833520, "comment_id": 63128413, "body": "The rest of your code was correct, you open the file in &#39;wb&#39; mode and write the data to it.  The data will be in the form of a string."}, {"owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "edited": false, "score": 0, "creation_date": 1465988807, "post_id": 37833520, "comment_id": 63128456, "body": "Hello Keith, so i cannot create the file directly from 0 and 1, am i correct? we need to pack it again?"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "edited": false, "score": 1, "creation_date": 1465989196, "post_id": 37833520, "comment_id": 63128735, "body": "That&#39;s correct.  It makes sense. doesn&#39;t it?  You may change the data, but need to restore it to the original format when you save it.  It must be in the format specified by the image specification.  0&#39;s and 1&#39;s as bytes will be very different."}, {"owner": {"reputation": 679, "user_id": 193811, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/661d51c45a74e6884171ca715b9b1cd7?s=128&d=identicon&r=PG", "display_name": "William Daniel", "link": "https://stackoverflow.com/users/193811/william-daniel"}, "reply_to_user": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "edited": false, "score": 0, "creation_date": 1465994156, "post_id": 37833520, "comment_id": 63132394, "body": "Good point, Keith. @opensource-ios, by saying that you are willing to change the data within the string of &quot;bits&quot; you are extracting from a JPEG image, I assume you rather intimately familiar with how the JPEG file format is constructed. Changing the data of a JPEG at the bit level is a very specialized task that requires mapping a nested series of structures to that bit-wise data and tweaking the data perfectly. So, when you say, &quot;i see that the image is corrupt,&quot; (even if you saved the data correctly) are you sure you&#39;ve changed the correct data?"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 679, "user_id": 193811, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/661d51c45a74e6884171ca715b9b1cd7?s=128&d=identicon&r=PG", "display_name": "William Daniel", "link": "https://stackoverflow.com/users/193811/william-daniel"}, "edited": false, "score": 0, "creation_date": 1465995189, "post_id": 37833520, "comment_id": 63133161, "body": "@WilliamDaniel The OP has used unpack to unserialize the data but decode64 to reserialize it.  Even if the data were untouched, the reserialized data would be different from the original data.  Excellent point about the delicacy of modifying this binary data, I was wondering about that too."}], "tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": false, "score": 1, "last_activity_date": 1465988361, "creation_date": 1465988361, "answer_id": 37833520, "question_id": 37833012, "link": "https://stackoverflow.com/questions/37833012/create-a-image-file-from-binary-data-in-ruby/37833520#37833520", "title": "Create a image file from binary data in Ruby", "body": "<p>The reverse of <code>String.unpack</code> is <code>Array.pack</code>:</p>\n\n<pre><code> :007 &gt; bits = 'abc'.unpack(\"B*\")\n =&gt; [\"011000010110001001100011\"]\n :008 &gt; bits.pack(\"B*\")\n =&gt; \"abc\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "is_accepted": false, "score": 3, "last_activity_date": 1465988700, "creation_date": 1465988700, "answer_id": 37833626, "question_id": 37833012, "link": "https://stackoverflow.com/questions/37833012/create-a-image-file-from-binary-data-in-ruby/37833626#37833626", "title": "Create a image file from binary data in Ruby", "body": "<p>Try this code</p>\n\n<pre><code>s = File.binread(\"test_img.jpg\")\nbits = s.unpack(\"B*\")\n\nFile.open('new_test_img.jpg', 'wb') do|f|\n  f.write(bits.pack(\"B*\"))\nend\n</code></pre>\n"}], "owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2156, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1466077594, "creation_date": 1465986979, "last_edit_date": 1466077594, "question_id": 37833012, "link": "https://stackoverflow.com/questions/37833012/create-a-image-file-from-binary-data-in-ruby", "title": "Create a image file from binary data in Ruby", "body": "<p>I am able to access the binary data of a file and store it in a varible like this</p>\n\n<pre><code>s = File.binread(\"sample_22122015_03.jpg\")\nbits = s.unpack(\"B*\")[0]\n</code></pre>\n\n<p>where bits has data like this \"101001001010100100.......\"</p>\n\n<p>However, I want to do some changes and again write the binary data back to a new image, but I am unable to.</p>\n\n<p>I am using</p>\n\n<pre><code>File.open('shipping_label_new.jpg', 'wb') do|f|\nf.write(Base64.decode64(bits))\nend\n</code></pre>\n\n<p>but it's not working and I see that the image is corrupt. </p>\n"}, {"tags": ["ruby", "docker", "rubygems", "dockerfile", "docker-image"], "answers": [{"tags": [], "owner": {"reputation": 562, "user_id": 86798, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/592b7578c7686a6f6ceb526965b83975?s=128&d=identicon&r=PG", "display_name": "Andy Longwill", "link": "https://stackoverflow.com/users/86798/andy-longwill"}, "is_accepted": true, "score": 1, "last_activity_date": 1465993096, "creation_date": 1465993096, "answer_id": 37835264, "question_id": 37832802, "link": "https://stackoverflow.com/questions/37832802/how-to-install-jekyll-to-a-docker-image/37835264#37835264", "title": "How to install jekyll to a Docker image?", "body": "<p>To diagnose the issue you can jump into the container and dig into what's causing the issue.</p>\n\n<pre><code>$ docker run -ti --rm ruby:slim /bin/bash\nroot@bda37983a585:/# gem install jekyll\n# ...\n</code></pre>\n\n<p>Alternatively there is always the jekyll docker image:\n<a href=\"https://hub.docker.com/u/jekyll/\" rel=\"nofollow\">https://hub.docker.com/u/jekyll/</a></p>\n\n<p>Good luck!</p>\n"}, {"comments": [{"owner": {"reputation": 3853, "user_id": 3999893, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6f933b7d397294ba0e722c6d53767c50?s=128&d=identicon&r=PG&f=1", "display_name": "Edward", "link": "https://stackoverflow.com/users/3999893/edward"}, "edited": false, "score": 0, "creation_date": 1465997763, "post_id": 37836982, "comment_id": 63135106, "body": "I realized that the ruby-package is quite large. Now I used <code>jekyll&#47;jekyll</code> as Mr Gravity proposed."}], "tags": [], "owner": {"reputation": 19014, "user_id": 1016588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ac8f1c11b048325e334c7ca27078a4?s=128&d=identicon&r=PG", "display_name": "Hemerson Varela", "link": "https://stackoverflow.com/users/1016588/hemerson-varela"}, "is_accepted": false, "score": 1, "last_activity_date": 1465997555, "creation_date": 1465997555, "answer_id": 37836982, "question_id": 37832802, "link": "https://stackoverflow.com/questions/37832802/how-to-install-jekyll-to-a-docker-image/37836982#37836982", "title": "How to install jekyll to a Docker image?", "body": "<p>There are a few requirements you\u2019ll need to add to your DockerFile before use Jekyll.</p>\n\n<ul>\n<li>Ruby </li>\n<li>RubyGems</li>\n<li>NodeJS</li>\n<li>Python 2.7</li>\n</ul>\n\n<p>So, your <code>DockerFile</code> should look like this:</p>\n\n<pre><code>FROM ruby:2.1\nMAINTAINER nobody@test.com\n\nRUN apt-get update \\\n  &amp;&amp; apt-get install -y \\\n    node \\\n    python-pygments \\\n  &amp;&amp; apt-get clean \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/\n\nRUN gem install \\\n  github-pages \\\n  jekyll \\\n  jekyll-redirect-from \\\n  kramdown \\\n  rdiscount \\\n  rouge\n\nVOLUME /src\nEXPOSE 4000\n\nWORKDIR /src\nENTRYPOINT [\"jekyll\"]\n</code></pre>\n"}], "owner": {"reputation": 3853, "user_id": 3999893, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6f933b7d397294ba0e722c6d53767c50?s=128&d=identicon&r=PG&f=1", "display_name": "Edward", "link": "https://stackoverflow.com/users/3999893/edward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "accepted_answer_id": 37835264, "answer_count": 2, "score": 1, "last_activity_date": 1465997555, "creation_date": 1465986481, "question_id": 37832802, "link": "https://stackoverflow.com/questions/37832802/how-to-install-jekyll-to-a-docker-image", "title": "How to install jekyll to a Docker image?", "body": "<p>I'd like to generate a docker image that has the command <code>jekyll</code> available.</p>\n\n<p>I generated a <code>Dockerfile</code> with the following content:</p>\n\n<pre><code># https://hub.docker.com/_/ruby/\nFROM ruby:slim\n\nRUN gem install jekyll\n</code></pre>\n\n<p>Unfortunately throws an error:</p>\n\n<pre><code>ERROR:  Error installing jekyll:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /usr/local/bundle/gems/ffi-1.9.10/ext/ffi_c\n/usr/local/bin/ruby -r ./siteconf20160615-7-12pthrg.rb extconf.rb\nchecking for ffi.h... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/local/bin/$(RUBY_BASE_NAME)\n    --with-ffi_c-dir\n    --without-ffi_c-dir\n    --with-ffi_c-include\n    --without-ffi_c-include=${ffi_c-dir}/include\n    --with-ffi_c-lib\n    --without-ffi_c-lib=${ffi_c-dir}/lib\n    --with-libffi-config\n    --without-libffi-config\n    --with-pkg-config\n    --without-pkg-config\n/usr/local/lib/ruby/2.3.0/mkmf.rb:456:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /usr/local/lib/ruby/2.3.0/mkmf.rb:587:in `try_cpp'\n    from /usr/local/lib/ruby/2.3.0/mkmf.rb:1091:in `block in have_header'\n    from /usr/local/lib/ruby/2.3.0/mkmf.rb:942:in `block in checking_for'\n    from /usr/local/lib/ruby/2.3.0/mkmf.rb:350:in `block (2 levels) in postpone'\n    from /usr/local/lib/ruby/2.3.0/mkmf.rb:320:in `open'\n    from /usr/local/lib/ruby/2.3.0/mkmf.rb:350:in `block in postpone'\n    from /usr/local/lib/ruby/2.3.0/mkmf.rb:320:in `open'\n    from /usr/local/lib/ruby/2.3.0/mkmf.rb:346:in `postpone'\n    from /usr/local/lib/ruby/2.3.0/mkmf.rb:941:in `checking_for'\n    from /usr/local/lib/ruby/2.3.0/mkmf.rb:1090:in `have_header'\n    from extconf.rb:16:in `&lt;main&gt;'\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /usr/local/bundle/extensions/x86_64-linux/2.3.0-static/ffi-1.9.10/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /usr/local/bundle/gems/ffi-1.9.10 for inspection.\nResults logged to /usr/local/bundle/extensions/x86_64-linux/2.3.0-static/ffi-1.9.10/gem_make.out\n</code></pre>\n\n<p><strong>What am I doing wrong?</strong></p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2755, "user_id": 1543985, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/h2xDy.jpg?s=128&g=1", "display_name": "RichardAE", "link": "https://stackoverflow.com/users/1543985/richardae"}, "edited": false, "score": 0, "creation_date": 1465987279, "post_id": 37832537, "comment_id": 63127368, "body": "Can you post you code? It&#39;s a lot easier for us to understand reading the code itself (models/views/controller/javascript)"}, {"owner": {"reputation": 2755, "user_id": 1543985, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/h2xDy.jpg?s=128&g=1", "display_name": "RichardAE", "link": "https://stackoverflow.com/users/1543985/richardae"}, "edited": false, "score": 0, "creation_date": 1465987572, "post_id": 37832537, "comment_id": 63127604, "body": "Also, the rating model you suggested sounds sensible (to track votes after the fact), but it might be worth having a column like on the question model itself to keep the current rating (so it doesn&#39;t have to go through all the rating objects and calculate the total every time). Alternatively if you don&#39;t care about who rates what you could just have that column to be fair and no model. Do you even have users? Do you need to track individual ratings?"}], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 4910259, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/b8434c312d30683bd4799fe77c40cf8b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Burghess", "link": "https://stackoverflow.com/users/4910259/jeff-burghess"}, "edited": false, "score": 0, "creation_date": 1466040588, "post_id": 37839226, "comment_id": 63156433, "body": "I have the equivalent of @question.rating, but I can&#39;t figure out how to make a form that posts correctly to update the rating. Any ideas? For the url, it would have to be something like question_path(current_question), but that would 1. stay the same even if the current question changes unless I refresh the page and 2. I don&#39;t see a way to store the current question since I pick the current question with javascript, not rails."}, {"owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "reply_to_user": {"reputation": 353, "user_id": 4910259, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/b8434c312d30683bd4799fe77c40cf8b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Burghess", "link": "https://stackoverflow.com/users/4910259/jeff-burghess"}, "edited": false, "score": 0, "creation_date": 1466050356, "post_id": 37839226, "comment_id": 63158571, "body": "It sounds like it would be helpful for you to go through the Rails guides again--specifically, the <a href=\"http://guides.rubyonrails.org/form_helpers.html\" rel=\"nofollow noreferrer\">forms</a>, <a href=\"http://guides.rubyonrails.org/action_controller_overview.html\" rel=\"nofollow noreferrer\">controllers</a>, and <a href=\"http://edgeguides.rubyonrails.org/working_with_javascript_in_rails.html\" rel=\"nofollow noreferrer\">javascript</a> guides. I can&#39;t really give you a tutorial from scratch, but it&#39;s basic Rails to create a controller that can process update events, and then basic JS to write AJAX that sends requests to that controller."}, {"owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "reply_to_user": {"reputation": 353, "user_id": 4910259, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/b8434c312d30683bd4799fe77c40cf8b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Burghess", "link": "https://stackoverflow.com/users/4910259/jeff-burghess"}, "edited": false, "score": 0, "creation_date": 1466050454, "post_id": 37839226, "comment_id": 63158598, "body": "Specifically, it seems like you&#39;re wondering how to dynamically route to a controller--again, plucking your values with JS and then feeding them to AJAX is exactly what AJAX is for (no need to rely on question_path or form helpers--those are just Rails-ese to make life simpler, but you don&#39;t need to be bound by them)."}], "tags": [], "owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "is_accepted": false, "score": 0, "last_activity_date": 1466003207, "creation_date": 1466003207, "answer_id": 37839226, "question_id": 37832537, "link": "https://stackoverflow.com/questions/37832537/rating-system-in-rails-is-it-possible-with-my-set-up/37839226#37839226", "title": "rating system in rails, is it possible with my set up?", "body": "<p>First of all, you should clarify what you mean by using JS to display your questions. It sounds like what you're doing is more or less right, if indeed you need to dynamically update the page through time, but it also potentially sounds like you just want to show a list of questions, which you can do with just HTML.</p>\n\n<p>Second, you should decide whether or not you really need an extra Ratings model. It could be useful so that you can track things like when ratings come in, who made which ratings, and how it changes over time; but if you really just want to know the rating at any given time, you can just have an integer <code>rating</code> column on your questions.</p>\n\n<p>Third, displaying your ratings just involves grabbing more info from the questions when you display them. Assuming you have an <code>@question</code> object in the view, and you were displaying its text like <code>@question.text</code>, you can do the same with the rating by doing <code>@question.rating</code>, or, if you go the model route, something like <code>@question.ratings.count</code>. From there if you still want to use JS to update the value you need to either just make a string or convert the entire object into JSON so that you can handle it in JS.</p>\n\n<p>Finally, you mention needing a Ratings controller. That's fine, but recognize that you're going to need AJAX on your page to send events to that controller so that you can tie clicks (for voting) to actual database changes. </p>\n"}], "owner": {"reputation": 353, "user_id": 4910259, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/b8434c312d30683bd4799fe77c40cf8b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Burghess", "link": "https://stackoverflow.com/users/4910259/jeff-burghess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466003207, "creation_date": 1465985826, "question_id": 37832537, "link": "https://stackoverflow.com/questions/37832537/rating-system-in-rails-is-it-possible-with-my-set-up", "title": "rating system in rails, is it possible with my set up?", "body": "<p>Any help would be appreciated -- I just started rails a few weeks ago and I'm pretty lost right now. So I made an app where people can submit questions, and those questions get randomized and displayed one at a time. I implemented this in a pretty roundabout way. I'm going to lay out what I did explicitly just in case.</p>\n\n<p>I created a Question Model as well as a Question controller with new and create actions -- I put a form to submit the question in the view associated with the new action. To display the questions, I used javascript. I first used embedded ruby within the page to iterate through all the questions in the database. I then put them all in their own <code>&lt;li&gt;</code> and set the class of that to have a display: none. Then I used javascript to grab the class of the <code>&lt;li&gt;</code> tag and pushed all the questions onto an array. </p>\n\n<p>Then, I just used javascript to display the question one at a time by updating a div element's html over and over again. Now, I want to add a simple rating system (like an +1 or -1 thing). I want to take people's ratings of the question and average them out. But I don't really know how to implement this. I THINK that I should have a ratings model that belongs_to the question model (which has_many ratings). There should be a ratings controller with an edit and update action that changes the score every time someone rates a question.</p>\n\n<p>The problem is I don't know how to exactly implement this given what I've already done so far. A big problem for me is having the rating of the question linked to the question itself when I just used javascript to display the questions. Any suggestions? Apologies for the essay.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1465985492, "post_id": 37832258, "comment_id": 63126185, "body": "<code>I don&#39;t have a users_controller</code> -- Step one: create a <code>UsersController</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1465985674, "post_id": 37832258, "comment_id": 63126303, "body": "If you&#39;re getting conflicts with third party tools such as <code>Devise</code> (although I doubt it will be an issue just yet...), you can namespace your controller actions in <code>config&#47;routes.rb</code> by placing your routes in a <code>scope</code> block."}, {"owner": {"reputation": 532, "user_id": 6254638, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ac6489d932c3b5c3cd35cf02aaa8a7fe?s=128&d=identicon&r=PG&f=1", "display_name": "Arif", "link": "https://stackoverflow.com/users/6254638/arif"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1465986345, "post_id": 37832258, "comment_id": 63126709, "body": "Okay I just created a <code>UsersController</code> and edited routes.rb but I still don&#39;t know what the path should be after <code>= link_to @pin.user.email</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1656, "user_id": 6138119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YzV7y.jpg?s=128&g=1", "display_name": "Pravesh Khatri", "link": "https://stackoverflow.com/users/6138119/pravesh-khatri"}, "is_accepted": false, "score": 0, "last_activity_date": 1465985551, "creation_date": 1465985551, "answer_id": 37832442, "question_id": 37832258, "link": "https://stackoverflow.com/questions/37832258/cant-establish-connection-between-controllers/37832442#37832442", "title": "Can&#39;t establish connection between controllers", "body": "<p>You forgot to define your show method</p>\n\n<pre><code> def show\n    @pin        \n end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 4951991, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QMJz_9n5k2w/AAAAAAAAAAI/AAAAAAAAABM/CelKirjXqCo/photo.jpg?sz=128", "display_name": "SANDEEP MEMANE", "link": "https://stackoverflow.com/users/4951991/sandeep-memane"}, "is_accepted": true, "score": 0, "last_activity_date": 1465989520, "creation_date": 1465989520, "answer_id": 37833946, "question_id": 37832258, "link": "https://stackoverflow.com/questions/37832258/cant-establish-connection-between-controllers/37833946#37833946", "title": "Can&#39;t establish connection between controllers", "body": "<p>First Of All Create User Controller.\nRedirect Show page line to user show action\nThen you perform what you want.</p>\n\n<p>For Ex.</p>\n\n<p>link_to \"User Profile\", user_path(@pin.user.id)</p>\n\n<p>users_controller.rb</p>\n\n<p>class UsersController &lt; ApplicationController</p>\n\n<p>def show\n   @user = User.find_by_id(params[:id])\n   @pins = @user.pins\n end\nend</p>\n\n<p>/views/users/show.html.haml\nUser @user and @pins to Display What you want.</p>\n"}], "owner": {"reputation": 532, "user_id": 6254638, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ac6489d932c3b5c3cd35cf02aaa8a7fe?s=128&d=identicon&r=PG&f=1", "display_name": "Arif", "link": "https://stackoverflow.com/users/6254638/arif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 37833946, "answer_count": 2, "score": 0, "last_activity_date": 1465989520, "creation_date": 1465985076, "question_id": 37832258, "link": "https://stackoverflow.com/questions/37832258/cant-establish-connection-between-controllers", "title": "Can&#39;t establish connection between controllers", "body": "<p>I'm new to Rails and I'm stuck at something really silly. I was trying to make an app where users can post pinterest-like pins, so I went with user has_many: pins and pin belongs_to: user. Here's the codes from a few files just to give you an idea of what state I'm in right now:</p>\n\n<p>app/models/user.rb</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  has_many :pins\nend\n</code></pre>\n\n<p>app/models/pin.rb</p>\n\n<pre><code>class Pin &lt; ActiveRecord::Base\n    belongs_to :user\nend\n</code></pre>\n\n<p>pins_controller.rb</p>\n\n<pre><code>class PinsController &lt; ApplicationController\n\n  before_action :find_pin, only: [:show, :edit, :update, :destroy]\n\n  def index\n    @pins = Pin.all.order(\"created_at DESC\")\n  end\n\n  def show\n  end\n\n  def new\n    @pin = current_user.pins.build\n  end\n\n  def create\n    @pin = current_user.pins.build(pin_params)\n\n    if @pin.save\n      redirect_to @pin, notice: \"Successfully created new Pin\"\n    else\n      render 'new'\n    end\n  end\n\n  def edit\n  end\n\n  def update\n    if @pin.update(pin_params)\n      redirect_to @pin, notice: \"Pin was successfully updated!\"\n    else\n      render 'edit'\n    end\n  end\n\n  def destroy\n    @pin.destroy\n    redirect_to root_path\n  end\n\n  def error\n  end\n\n\n  private\n\n  def pin_params\n    params.require(:pin).permit(:title, :description)\n  end\n\n  def find_pin\n    @pin = Pin.find(params[:id])\n  end\nend\n</code></pre>\n\n<p>/views/pins/show.html.haml</p>\n\n<pre><code>%h1= @pin.title\n%p= @pin.description\n%p\n%hr\n%strong Submitted by\n= @pin.user.email\n</code></pre>\n\n<p>Here, in the last line of show.html.haml, I want the @pin.user.email to be a link so that </p>\n\n<ol>\n<li><p>the profile of the user (the one who submitted the article) can be accessed when clicked on it.</p></li>\n<li><p>the profile of the user should list all of the articles submitted by him/her.</p></li>\n</ol>\n\n<p>These are the two things that I'm trying to accomplish but don't know the code I should use for it. I don't have a users_controller. I did have one but I deleted it after it started messing with devise's routes. All answers are welcome, thanks in advance!</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6466233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1df5f699228d6af4763b7ef3fbb55b5?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Giorgi", "link": "https://stackoverflow.com/users/6466233/federico-giorgi"}, "edited": false, "score": 2, "creation_date": 1465985589, "post_id": 37832199, "comment_id": 63126244, "body": "Thank you so much I I thought was necessary for calling a class in another file but now i realized that I probably need to study more and more."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1465984922, "creation_date": 1465984922, "answer_id": 37832199, "question_id": 37832103, "link": "https://stackoverflow.com/questions/37832103/call-a-method-from-another-file-in-ruby/37832199#37832199", "title": "call a method from another file in ruby", "body": "<p>Why as string?</p>\n\n<p>this line</p>\n\n<pre><code>SIX_SIDED_DIE = \"#{Die.new(6)}\"`\n</code></pre>\n\n<p>should be something like</p>\n\n<pre><code>die = Die.new(6)\n</code></pre>\n\n<p>then you can do <code>die.roll</code></p>\n"}], "owner": {"reputation": 1, "user_id": 6466233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1df5f699228d6af4763b7ef3fbb55b5?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Giorgi", "link": "https://stackoverflow.com/users/6466233/federico-giorgi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 932, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465984922, "creation_date": 1465984714, "question_id": 37832103, "link": "https://stackoverflow.com/questions/37832103/call-a-method-from-another-file-in-ruby", "title": "call a method from another file in ruby", "body": "<p>Hello I'm new to programming and I started with ruby. I'm trying to do my first program. I found online this code that generate a dice roll</p>\n\n<pre><code>class Die\n  def initialize(sides)\n    @sides = sides\n  end\n\n  def generate_die_roll\n    rand(@sides) + 1\n  end\n\n  def roll(number=1)\n    roll_array = []\n    number.times do\n      roll_array &lt;&lt; generate_die_roll\n    end\n    total = 0\n    roll_array.each do |roll|\n      new_total = total + roll\n      total = new_total\n    end\n   total\n  end\nend\n</code></pre>\n\n<p>and I would like to use in they way that if the number generated is inferior o equal to another print something otherwise something else.\nIt's probably very easy but i'm trying in every way and now I will need some help please.\nthat's my code:</p>\n\n<pre><code>require \"./newdado.rb\"\nenergia_vitale = 30\nputs \"Lancia un dado scrivendo (D) da sommare alla tua Energia Vitale iniziale di #{energia_vitale} punti\"\nscelta = gets.chomp\n\ncase scelta\nwhen \"D\"\n\nSIX_SIDED_DIE = \"#{Die.new(6)}\"\n  values = Array[]\nvalues.push(SIX_SIDED_DIE.roll)\n  puts values\nif values &lt; 2\n  puts \"c\"\nelse puts \"b\"\nend\nend\n</code></pre>\n\n<p>when I run it i receive this error\n<em>C:/Users/fix/workspace/D&amp;D Ruby/energia vitale.rb:11:in <code>&lt;main&gt;': undefined method</code>roll' for \"#\":String (NoMethodError)</em></p>\n\n<p>Sorry to bother the community with this beginner problem                         </p>\n"}, {"tags": ["ruby", "file-io", "selenium-webdriver", "automation", "rake-task"], "comments": [{"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1465988632, "post_id": 37832074, "comment_id": 63128354, "body": "<code>&quot;#{file_path}&quot;</code> is exactly the same as <code>file_path</code>, assuming it is a String.  So might as well use the simpler form."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 1, "creation_date": 1465989033, "post_id": 37832074, "comment_id": 63128617, "body": "I don&#39;t understand your workflow, but if you&#39;re loading multiple lines from that file, why not read it into an array once, and then use that array in memory?  Also, if you only want to get 1 line per file read, you can easily write a method that reads line by line and stops when you&#39;ve found the desired line -- this will save an average of half a file read."}, {"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "reply_to_user": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1465990846, "post_id": 37832074, "comment_id": 63129977, "body": "@KeithBennett -&gt; I already have the working script with line by line execution. I&#39;m trying to build something which can capture the data at once for a customer and load it into the application. I can do that easily but I would need to do it in the quickest possible time as file size can be huge."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1465991485, "post_id": 37832074, "comment_id": 63130484, "body": "What do you mean by &quot;line by line execution&quot;?  One line per invocation?"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1465991674, "post_id": 37832074, "comment_id": 63130607, "body": "If so, that is where I would start.  I would run your entire set in a single invocation.  There are ways you can deal with failures, e.g. log a message, etc.  Invoking your program once for each input is overkill and IMO a bad idea."}, {"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "reply_to_user": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1466063940, "post_id": 37832074, "comment_id": 63164914, "body": "@KeithBennett -&gt; so you suggest reading the file at once and then go ahead with the execution instead of reading a line and then loading it in the application ? right ? I was trying to avoid this because reading the entire file at once will be time and memory consuming."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1466096423, "post_id": 37832074, "comment_id": 63187451, "body": "When you call File.readlines, you <i>are</i> loading the entire file into memory.  So instead of doing it many times, you could do it just once.  I may not be understanding your workflow though -- how are you getting the other data?"}, {"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "reply_to_user": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1466147652, "post_id": 37832074, "comment_id": 63206155, "body": "How about loading data line by line using File.foreach so as to keep low use of memory ?"}, {"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "reply_to_user": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1466147754, "post_id": 37832074, "comment_id": 63206218, "body": "My flow is to enter certain fields in the ui and submit... now there are records in a text file, each line containing one record. I am loading one line at a time using File.foreach or File.readlines and enter the data in the ui and submit and repeating this process for all the records in the text file."}], "answers": [{"comments": [{"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "edited": false, "score": 0, "creation_date": 1466163015, "post_id": 37876228, "comment_id": 63215795, "body": "Good.  After breaking it down into steps, when you start implementing those steps as code, think about how to code discrete methods, each having a single purpose.  This will simplify the problem."}, {"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "edited": false, "score": 0, "creation_date": 1466168786, "post_id": 37876228, "comment_id": 63219552, "body": "Did that already.. just wanted to check with know how other people will deal with similar problems and if my approach is accurate enough."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "edited": false, "score": 0, "creation_date": 1516792261, "post_id": 37876228, "comment_id": 83831517, "body": "@yudi2312 I see you&#39;re a fairly new user. If you haven&#39;t already, could you read <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a> and, if you feel it&#39;s appropriate, follow the instructions there?"}], "tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": false, "score": 0, "last_activity_date": 1466162944, "last_edit_date": 1466162944, "creation_date": 1466150560, "answer_id": 37876228, "question_id": 37832074, "link": "https://stackoverflow.com/questions/37832074/loading-data-into-the-application-from-gui-using-ruby/37876228#37876228", "title": "Loading Data into the application from GUI using Ruby", "body": "<p>The first thing I'd do is break this down into steps -- as you said in your comment, but more formally here:</p>\n\n<ol>\n<li>Get the data to apply to all records. Put up a page with the\nnecessary information (or support command line specification if not\ntoo much?).</li>\n<li>For each line in the file, do the following (automated):\n        Get the web page for inputting its data;\n        Fill in the fields;\n        Submit the form</li>\n</ol>\n\n<p>Given this, I'd say the 'for each line' instruction should definitely be reading a line at a time from the file using <code>File.foreach</code> or similar.</p>\n\n<p>Is there anything beyond this that needs to be taken into account?</p>\n"}], "owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466162944, "creation_date": 1465984643, "question_id": 37832074, "link": "https://stackoverflow.com/questions/37832074/loading-data-into-the-application-from-gui-using-ruby", "title": "Loading Data into the application from GUI using Ruby", "body": "<p><strong>Problem</strong>: </p>\n\n<p>Hi everyone, I am currently building an automation suite using Ruby-Selenium Webdriver-Cucumber to load data into the application using it's GUI. I've take input from mainframe <em>.txt</em> files. The scenarios are like to create a customer and then load multiple accounts for them as per the data provided in the inputs.</p>\n\n<p><strong>Current Approach</strong></p>\n\n<p>Execute the scenario using the rake task by passing line number as parameter and the script is executed for only one set of data.</p>\n\n<p>To read the data for a particular line, I'm using below code:</p>\n\n<pre><code>  File.readlines(\"#{file_path}\")[line_number.to_i - 1]\n</code></pre>\n\n<p>My purpose of using line by line loading is to keep the execution running even if a line fails to load. </p>\n\n<p><strong>Shortcomings</strong></p>\n\n<p>Supposed I've to load 10 accounts to a single customer. So my current script will run 10 times to load each account. I want something that can load the accounts in a single go.</p>\n\n<p><strong>What I am looking for</strong></p>\n\n<p>To overcome the above shortcoming, I want to capture the entire data for a single customer from the file like accounts etc and load them into the application in a single execution.</p>\n\n<p>Also, I've to keep track on the execution time and memory allocation as well.</p>\n\n<p>Please provide your thoughts on this approach and any suggestions or improvements are welcomed. (Sorry for the long post)</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-4.2", "refinerycms"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1465983810, "post_id": 37831417, "comment_id": 63125067, "body": "Perhaps your system has just got in a funny database state, as you were editing migrations... try running <code>rake db:drop; rake db:create; rake rb:migrate</code>"}, {"owner": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1465984166, "post_id": 37831417, "comment_id": 63125301, "body": "@TomLord I have already done that. but no avail."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 6482516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342191c7e98550b7d64e87995f4e9a9a?s=128&d=identicon&r=PG&f=1", "display_name": "Priya", "link": "https://stackoverflow.com/users/6482516/priya"}, "is_accepted": true, "score": 1, "last_activity_date": 1466243312, "creation_date": 1466243312, "answer_id": 37895591, "question_id": 37831417, "link": "https://stackoverflow.com/questions/37831417/issue-in-migrating-database-after-adding-refinerycms-gem/37895591#37895591", "title": "Issue in migrating database after adding refinerycms gem", "body": "<p>@Shefalee Chaudhary Commenting out these lines in the migration will fix your issue:</p>\n\n<pre><code> #::Refinery::PagePart.create_translation_table!({\n #  :body =&gt; :text\n #})\n\n#::Refinery::Page.create_translation_table!({\n  #  :title =&gt; :string,\n  #  :custom_slug =&gt; :string,\n  #  :menu_title =&gt; :string,\n  #  :slug =&gt; :string\n # })\n</code></pre>\n"}], "owner": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 37895591, "answer_count": 1, "score": 0, "last_activity_date": 1466243312, "creation_date": 1465982890, "last_edit_date": 1465985660, "question_id": 37831417, "link": "https://stackoverflow.com/questions/37831417/issue-in-migrating-database-after-adding-refinerycms-gem", "title": "Issue in migrating database after adding refinerycms gem", "body": "<p>I am integrating refinerycms in existing application and followed steps mentioned in <a href=\"http://www.refinerycms.com/guides/with-an-existing-rails-app\" rel=\"nofollow\">http://www.refinerycms.com/guides/with-an-existing-rails-app</a></p>\n\n<p>My <code>gemfile</code> contains following:</p>\n\n<pre><code>gem 'refinerycms', github: 'refinery/refinerycms', branch: 'master'\ngem 'refinerycms-i18n', github: 'refinery/refinerycms-i18n', branch: 'master'\n</code></pre>\n\n<p>Adding gem 'refinerycms', '~> 3.0.0' to gemfile also generates same error:</p>\n\n<blockquote>\n  <p>Error==> Mysql2::Error: Table 'refinery_base_model_translations' already exists: CREATE TABLE refinery_base_model_translations (id int(11) auto_increment PRIMARY KEY, refinery_base_model_id int(11) NOT NULL, locale varchar(255) NOT NULL, created_at datetime NOT NULL, updated_at datetime NOT NULL) ENGINE=InnoDB**</p>\n</blockquote>\n"}, {"tags": ["mysql", "ruby", "ruby-1.8.7"], "comments": [{"owner": {"reputation": 845, "user_id": 5646801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d133162c0a6c4b45ad559f5a86f8f8a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii K", "link": "https://stackoverflow.com/users/5646801/sergii-k"}, "edited": false, "score": 0, "creation_date": 1465981468, "post_id": 37830735, "comment_id": 63123428, "body": "Standard implementation for RoR is HABTM relation through joint table (<code>users_teams</code> with columns <code>user_id</code> and <code>team_id</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "is_accepted": true, "score": 0, "last_activity_date": 1465985485, "last_edit_date": 1465985485, "creation_date": 1465985071, "answer_id": 37832256, "question_id": 37830735, "link": "https://stackoverflow.com/questions/37830735/need-to-change-relation-between-db-tables/37832256#37832256", "title": "Need to change relation between DB tables", "body": "<p>The answer to my question is:</p>\n\n<p>to create the relationship I need to add the following to the Users table:</p>\n\n<pre><code>has_and_belongs_to_many(:npt_teams,\n                        :join_table =&gt; :users_teams,\n                        :class =&gt; 'NptTeam',\n                        :left_key =&gt; :user_id,\n                        :right_key =&gt; :npt_team_id)\n\nmany_to_many_by_ids :npt_teams, 'UsersTeams'\n</code></pre>\n\n<p>Create a new join table like so:</p>\n\n<pre><code>class UsersTeams &lt; Sequel::Model\n  clear_all\n\n  set_schema {\n    primary_key :id\n    integer :user_id, :null =&gt; false, :default =&gt; 0\n    integer :npt_team_id, :null =&gt; false, :default =&gt; 0\n  }\n  create_table unless table_exists?\n\n  belongs_to :user\n  belongs_to :npt_team\nend\n</code></pre>\n\n<p>and the relationship is created along with the join table.</p>\n\n<p>I don't know if this is the best way to do it but It seems to work.</p>\n\n<p>As for the second question, I don't know, the data currently in the DB seems to be unaffected.</p>\n\n<p>Now I just need to move the current Team to the new table and that should be it.</p>\n\n<p>As for what else I might need to know well I don't, becuase you know, those that do know have seen to know have not respond so I'm just going to have to wing it.</p>\n\n<p>EDIT:</p>\n\n<p>script to move data across:</p>\n\n<pre><code>User.all.each do |user|\n  join = UsersTeams.create(:user_id =&gt; user.id, :npt_team_id =&gt; user.npt_team_id)\n  puts join.inspect\n  join.save\n  puts user.npt_teams.to_a.map {|t|t.inspect}.to_s\nend\n</code></pre>\n"}], "owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 37832256, "answer_count": 1, "score": 0, "last_activity_date": 1465985485, "creation_date": 1465981221, "last_edit_date": 1465981850, "question_id": 37830735, "link": "https://stackoverflow.com/questions/37830735/need-to-change-relation-between-db-tables", "title": "Need to change relation between DB tables", "body": "<p>ok, so lets get the basics out of the way.</p>\n\n<p>I'm running ruby 1.8.7, I'm using the sequel gem version '2.6.0'.</p>\n\n<p>I have a table called Users and a table called Teams</p>\n\n<p>Right now a user can have one team and as such it's relation is:</p>\n\n<pre><code>belongs_to :npt_team\n</code></pre>\n\n<p>However as part of a feature upgrade for teams I have to make it so Users can be apart of multiple teams. </p>\n\n<p>What I want to know:</p>\n\n<p>I can change it to one of the following:</p>\n\n<ul>\n<li><code>:has_and_belongs_to_many</code> </li>\n<li><code>:many_to_many</code> </li>\n<li><code>:many_to_many_by_ids</code></li>\n</ul>\n\n<p>which one is the best to use and why(because I like to know)?</p>\n\n<p>Second of all what will happen to the DB in the tables when I change this?</p>\n\n<p>Any thing else I should be wary of/know about?</p>\n\n<p>I'm using the following mysql version:</p>\n\n<blockquote>\n  <p>mysql  Ver 14.14 Distrib 5.6.29, for osx10.11 (x86_64) using  EditLine\n  wrapper</p>\n</blockquote>\n\n<p>EDIT:</p>\n\n<p>Ooops forgot to mention a rather pertinent point.</p>\n\n<p>I'm not using rails, I'm use an old frame work called Ramaze.</p>\n"}, {"tags": ["ruby", "macos", "sockets", "network-programming"], "answers": [{"tags": [], "owner": {"reputation": 2291, "user_id": 1752333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1009edfa56c5a71d0e6de2738342bee7?s=128&d=identicon&r=PG", "display_name": "scorix", "link": "https://stackoverflow.com/users/1752333/scorix"}, "is_accepted": false, "score": 1, "last_activity_date": 1465981142, "creation_date": 1465981142, "answer_id": 37830703, "question_id": 37830390, "link": "https://stackoverflow.com/questions/37830390/cant-create-simple-socket-with-ruby-errnoeconnrefused/37830703#37830703", "title": "Can&#39;t create simple socket with Ruby - Errno::ECONNREFUSED", "body": "<p>Connection refused since there is no server listening on tcp://127.0.0.1:2000.</p>\n\n<p>If you want to run a server, use <code>TCPServer</code>:</p>\n\n<pre><code>TCPServer.new('localhost', 2000)\n</code></pre>\n\n<p>If you want to connect to a server, run it first.</p>\n"}], "owner": {"reputation": 271, "user_id": 4049841, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001582016865/picture?type=large", "display_name": "Wojciech Jele\u0144", "link": "https://stackoverflow.com/users/4049841/wojciech-jele%c5%84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465981142, "creation_date": 1465980280, "question_id": 37830390, "link": "https://stackoverflow.com/questions/37830390/cant-create-simple-socket-with-ruby-errnoeconnrefused", "title": "Can&#39;t create simple socket with Ruby - Errno::ECONNREFUSED", "body": "<p>I can't create even simplest socket in Ruby, when I try to execute</p>\n\n<pre><code>s = TCPSocket.open('localhost', 2000)\n</code></pre>\n\n<p>in PRY, its always throws an error:</p>\n\n<pre><code>Errno::ECONNREFUSED: Connection refused - connect(2) for \"127.0.0.1\" port 2000\n</code></pre>\n\n<p>Could it be some permission issue? I have no idea even where to start with it...\nI am newbie weekend programmer, so please be forgiving:)\nI am working on OS X El Captain.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 867, "user_id": 4563235, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/M7Zcp.jpg?s=128&g=1", "display_name": "hypern", "link": "https://stackoverflow.com/users/4563235/hypern"}, "edited": false, "score": 0, "creation_date": 1465982447, "post_id": 37830303, "comment_id": 63124090, "body": "Sounds like it could be something in your routes file that&#39;s matching somewhere higher up in the file. Can you post your routes.rb?"}], "answers": [{"comments": [{"owner": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "edited": false, "score": 0, "creation_date": 1465981618, "post_id": 37830447, "comment_id": 63123542, "body": "sorry @kumar its a mistake while posting question the method name and route name is same actually"}, {"owner": {"reputation": 2770, "user_id": 1042201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ada99cff697111a404292dbeff3d4313?s=128&d=identicon&r=PG", "display_name": "Kumar", "link": "https://stackoverflow.com/users/1042201/kumar"}, "reply_to_user": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "edited": false, "score": 0, "creation_date": 1465982184, "post_id": 37830447, "comment_id": 63123908, "body": "And you&#39;re going to <code>&#47;notification_templates&#47;merge_field_keys</code> path and not <code>&#47;notification_templates&#47;merge_fields</code>, right?"}, {"owner": {"reputation": 2770, "user_id": 1042201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ada99cff697111a404292dbeff3d4313?s=128&d=identicon&r=PG", "display_name": "Kumar", "link": "https://stackoverflow.com/users/1042201/kumar"}, "reply_to_user": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "edited": false, "score": 0, "creation_date": 1465984080, "post_id": 37830447, "comment_id": 63125242, "body": "Can you show us your part of your routes file where you&#39;ve written routes for <code>notification_templates</code>?"}], "tags": [], "owner": {"reputation": 2770, "user_id": 1042201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ada99cff697111a404292dbeff3d4313?s=128&d=identicon&r=PG", "display_name": "Kumar", "link": "https://stackoverflow.com/users/1042201/kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1465980441, "creation_date": 1465980441, "answer_id": 37830447, "question_id": 37830303, "link": "https://stackoverflow.com/questions/37830303/collection-route-of-get-type-redirects-to-show-action/37830447#37830447", "title": "collection route of get type redirects to show action", "body": "<p>Your method name is <code>merge_field_keys</code> where as your route says <code>merge_fields</code>. Try changing one of them</p>\n\n<pre><code>resources :notification_templates do \n  collection do\n    get :merge_field_key\n  end\nend\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>class NotificationTemplatesController &lt; ApplicationController\n  def merge_fields\n    ...\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9480, "user_id": 625348, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eEgMg.jpg?s=128&g=1", "display_name": "mohamed-ibrahim", "link": "https://stackoverflow.com/users/625348/mohamed-ibrahim"}, "is_accepted": false, "score": 0, "last_activity_date": 1465984299, "creation_date": 1465984299, "answer_id": 37831940, "question_id": 37830303, "link": "https://stackoverflow.com/questions/37830303/collection-route-of-get-type-redirects-to-show-action/37831940#37831940", "title": "collection route of get type redirects to show action", "body": "<p>What you said can't happen, if you run <code>rake routes</code> you will find \n<code>/notification_templates/merge_field_keys</code> is defined before <code>/notification_templates/:id</code>, and when you request from server Rails start to match to the first Path which is <code>merge_field_keys</code> and when all not match it will call <code>show</code> action and pass whatever after <code>/notification_templates</code> as <code>id</code> param.</p>\n\n<p>Possibly you defined <code>resources :notification_templates</code> twice and you have it above what you mentioned, run <code>rake routes</code> and make sure, and in case you don't even need show action you can do:</p>\n\n<pre><code>resources :notification_templates, only: [:index, :create, :update, :destroy] do \n  collection do\n    get :merge_field_keys\n  end\nend\n</code></pre>\n\n<p>and you can also remove from this array whatever you don't use <code>[:index, :show, :create, :update, :destroy]</code></p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 4951991, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QMJz_9n5k2w/AAAAAAAAAAI/AAAAAAAAABM/CelKirjXqCo/photo.jpg?sz=128", "display_name": "SANDEEP MEMANE", "link": "https://stackoverflow.com/users/4951991/sandeep-memane"}, "is_accepted": false, "score": 0, "last_activity_date": 1465990475, "creation_date": 1465990475, "answer_id": 37834310, "question_id": 37830303, "link": "https://stackoverflow.com/questions/37830303/collection-route-of-get-type-redirects-to-show-action/37834310#37834310", "title": "collection route of get type redirects to show action", "body": "<p>Try These:</p>\n\n<p>redirect_to :controller => 'notification_templates', :action => 'merge_field_keys'</p>\n"}], "owner": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1465990475, "creation_date": 1465980065, "last_edit_date": 1465983352, "question_id": 37830303, "link": "https://stackoverflow.com/questions/37830303/collection-route-of-get-type-redirects-to-show-action", "title": "collection route of get type redirects to show action", "body": "<p>I have defined a routes in collection method of get type but its redirecting to show action of controller rather that merge_fields action</p>\n\n<pre><code>resources :notification_templates do \n    collection do\n      get :merge_field_keys\n    end\n  end\n</code></pre>\n\n<p>so its path is <code>/notification_templates/merge_field_keys</code></p>\n\n<p>now the <code>notification_templates_controller</code> is redirecting it to show method and taking <code>merge_field</code> as id.</p>\n\n<pre><code>class NotificationTemplatesController &lt; ApplicationController\n\n  def merge_field_keys\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "keyword-argument"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1465979137, "post_id": 37829590, "comment_id": 63121883, "body": "<b>Don&#39;t</b> use <code>or</code> (and its friends <code>and</code>/<code>not</code>) for conditionals. Here you may think it lets you specify a default value of empty hash, but it doesn&#39;t."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1466009429, "post_id": 37829590, "comment_id": 63143471, "body": "What is dict? ................"}], "answers": [{"comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1465990256, "post_id": 37829701, "comment_id": 63129486, "body": "In your first example, the <code>{&#39;c&#39; =&gt; &#39;d&#39;}</code> hash is <b>not</b> passed as the keywords arguments. Instead, it is passed as a positional argument and is available in <code>args</code>. The same is true when passing a hash with symbol keys. If you want to pass only keyword arguments here, you have to call the method as <code>m(**{:c =&gt; &#39;d&#39;})</code>."}, {"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1465990532, "post_id": 37829701, "comment_id": 63129709, "body": "About the first part - that is what I say in the answer. I must disagree with you on the second part - trying it in pry (Ruby 2.0.0) passing a hash with symbol keys is passed as the keyword argument hash..."}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1465994815, "post_id": 37829701, "comment_id": 63132873, "body": "Hmmm, looks like my tests were off (and OP&#39;s method is strange in the first place). You are right of course, with symbol keys the hash, it is indeed passed to <code>kwargs</code>. Interestingly, if you pass a hash with mixed symbols and strings as keys, the string keys will get passed to <code>args</code> and the symbol keys get passed to <code>kwargs</code>. I guess the take away from this is: try to avoid these ambiguities as much as possible when designing method interfaces."}, {"owner": {"reputation": 147, "user_id": 1503918, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/896267770d8ff23d399000903671aebd?s=128&d=identicon&r=PG", "display_name": "bryantism", "link": "https://stackoverflow.com/users/1503918/bryantism"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1465998813, "post_id": 37829701, "comment_id": 63135910, "body": "@Holger Just ,  Python does not have this problem, I need it ..... really.   how can solve this..."}, {"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "reply_to_user": {"reputation": 147, "user_id": 1503918, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/896267770d8ff23d399000903671aebd?s=128&d=identicon&r=PG", "display_name": "bryantism", "link": "https://stackoverflow.com/users/1503918/bryantism"}, "edited": false, "score": 0, "creation_date": 1465999548, "post_id": 37829701, "comment_id": 63136493, "body": "@bryantism - what exactly are you trying to solve? As I say in my answer, to force the hash to be the first parameter, you <i>must</i> add the second parameter to differentiate it. Another option would be to remove the default value for the <code>args</code> params, which will make it required, and then it will be chosen over the keyword argument - <code>def m(args, **kwargv)</code>"}, {"owner": {"reputation": 147, "user_id": 1503918, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/896267770d8ff23d399000903671aebd?s=128&d=identicon&r=PG", "display_name": "bryantism", "link": "https://stackoverflow.com/users/1503918/bryantism"}, "edited": false, "score": 0, "creation_date": 1465999826, "post_id": 37829701, "comment_id": 63136697, "body": "I simulate the Python requests.get function, def get(url, params=None, **kwargs)  ..... params can be nil ....."}, {"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "reply_to_user": {"reputation": 147, "user_id": 1503918, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/896267770d8ff23d399000903671aebd?s=128&d=identicon&r=PG", "display_name": "bryantism", "link": "https://stackoverflow.com/users/1503918/bryantism"}, "edited": false, "score": 0, "creation_date": 1466012161, "post_id": 37829701, "comment_id": 63144973, "body": "@bryantism - welcome to the ruby language. Each programming language is a bit different, and has its own behaviors and characteristics. I guess that ruby is different from python in that respect. You still can do most things in both languages, but they will probably not look exactly the same..."}], "tags": [], "owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "is_accepted": false, "score": 3, "last_activity_date": 1465980437, "last_edit_date": 1465980437, "creation_date": 1465978422, "answer_id": 37829701, "question_id": 37829590, "link": "https://stackoverflow.com/questions/37829590/how-does-keyword-argument-work/37829701#37829701", "title": "How does keyword argument work?", "body": "<p>This should work:</p>\n\n<pre><code>&gt; m({'c' =&gt; 'd'})\n# {}\n# {\"c\"=&gt;\"d\"}\n# {\"a\"=&gt;{\"c\"=&gt;\"d\"}}\n# =&gt; nil\n</code></pre>\n\n<p>The logic behind this is that because the first argument is optional (defaulting to <code>nil</code>), and the last argument is a keyword-argument, passing a hash with symbol keys (<code>m({ :c =&gt; 'd'})</code>) will be interpreted as the keyword hash. Any other type of argument will be passed as the first parameter. If you really need to pass a keyword hash as the <em>first</em> parameter, you need to explicitly pass the <em>second</em> parameter as well:</p>\n\n<pre><code>&gt; m({ :c =&gt; 'd' }, {})\n# {}\n# {:c=&gt;\"d\"}\n# {\"a\"=&gt;{:c=&gt;\"d\"}}\n</code></pre>\n\n<p>On a side note, calling the method while naming the <code>args</code> parameter (<code>m(args=something)</code>) is superfluous, and actually does something different than you think (assigns the <code>something</code> to a local variable named <code>args</code>, then passing it to the method). Use <code>m(something)</code> instead.</p>\n"}], "owner": {"reputation": 147, "user_id": 1503918, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/896267770d8ff23d399000903671aebd?s=128&d=identicon&r=PG", "display_name": "bryantism", "link": "https://stackoverflow.com/users/1503918/bryantism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1466009315, "creation_date": 1465978056, "last_edit_date": 1466009315, "question_id": 37829590, "link": "https://stackoverflow.com/questions/37829590/how-does-keyword-argument-work", "title": "How does keyword argument work?", "body": "<p>I have a piece of sample code:</p>\n\n<pre><code>def m(args = nil, **kwargv)\n  puts kwargv\n  a = args or {}\n  puts a\n  kwargv['a'] = a\n  puts kwargv\nend\n</code></pre>\n\n<p>When I invoke:</p>\n\n<pre><code>m(args = {'c':'d'})\nm(args: {'c': 'd'})\nm(args = {xxx}, {})\n</code></pre>\n\n<p>only in the last one will <code>args</code> be interpreted as <code>args</code>; in the first and the second ones, the dict will be used as <code>kwargv</code>.</p>\n\n<p>Is there a more elegant way to specify <code>args</code> as a dict?</p>\n"}, {"tags": ["javascript", "python", "ruby", "keyword-argument"], "comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1465977636, "post_id": 37829344, "comment_id": 63120949, "body": "For Python, see: <a href=\"https://www.python.org/dev/peps/pep-3102/\" rel=\"nofollow noreferrer\">python.org/dev/peps/pep-3102</a>"}, {"owner": {"reputation": 2150, "user_id": 991710, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f660a9ad68d31e30b2d7b153f7eb5bc5?s=128&d=identicon&r=PG", "display_name": "user991710", "link": "https://stackoverflow.com/users/991710/user991710"}, "edited": false, "score": 0, "creation_date": 1465977780, "post_id": 37829344, "comment_id": 63121043, "body": "I&#39;d argue that this is a case of being verbose simply for the sake of being verbose. It is not at all difficult to figure out function parameters, and if a developer needs to change/analyze the function he has to look it up anyway. EDIT: After reading the Python rationale, I can see how keyword-only parameters can be useful. Still, if you <i>need</i> a keyword parameter, you may be better of refactoring, IMO."}, {"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1465978473, "post_id": 37829344, "comment_id": 63121452, "body": "Your title asks <i>&quot;can you&quot;</i>, which is OK, but your question implies you want an answer to <i>&quot;should you&quot;</i>, which is too opinion-based for SO."}, {"owner": {"reputation": 83, "user_id": 3130824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b8c9069b69f81d1fa0519ba63d6e8a?s=128&d=identicon&r=PG&f=1", "display_name": "Thonanth Siddef", "link": "https://stackoverflow.com/users/3130824/thonanth-siddef"}, "reply_to_user": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1466062979, "post_id": 37829344, "comment_id": 63164330, "body": "@jonrsharpe I guess I did get kind of off topic in my reasoning behind wanting to ask the question, but that doesn&#39;t change the fact of the question. Is it a common feature among different programming languages?  More specifically, Python/Javascript? I see now that there is, in fact, an implementation in Python, but I still have no idea what the situation is for Javascript. I could edit the question or question title if you think that that would help the question fit the SO format better."}, {"owner": {"reputation": 83, "user_id": 3130824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b8c9069b69f81d1fa0519ba63d6e8a?s=128&d=identicon&r=PG&f=1", "display_name": "Thonanth Siddef", "link": "https://stackoverflow.com/users/3130824/thonanth-siddef"}, "reply_to_user": {"reputation": 2150, "user_id": 991710, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f660a9ad68d31e30b2d7b153f7eb5bc5?s=128&d=identicon&r=PG", "display_name": "user991710", "link": "https://stackoverflow.com/users/991710/user991710"}, "edited": false, "score": 0, "creation_date": 1466063078, "post_id": 37829344, "comment_id": 63164381, "body": "@user991710 Well, I would think the point of the required keyword parameter is to use it when you don&#39;t need to. Like having to specify an id in a function would be as easy as func(id: 1), and it makes it clear that you are to supply an id of some sort, rather than a string or other object."}, {"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1466063378, "post_id": 37829344, "comment_id": 63164557, "body": "JavaScript prior to ES6 doesn&#39;t have keyword parameters at all, let alone the facility for <i>requiring</i> keywords! Usually people get around this by passing an object literal as a positional argument (<code>obviousTotal({ subtotal: 1, tax: 2, discount: 3 })</code>)."}, {"owner": {"reputation": 83, "user_id": 3130824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b8c9069b69f81d1fa0519ba63d6e8a?s=128&d=identicon&r=PG&f=1", "display_name": "Thonanth Siddef", "link": "https://stackoverflow.com/users/3130824/thonanth-siddef"}, "reply_to_user": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1466091532, "post_id": 37829344, "comment_id": 63184516, "body": "@jonrsharpe Thanks, man! Marked your answer as the answer."}], "answers": [{"tags": [], "owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "is_accepted": true, "score": 18, "last_activity_date": 1466064822, "last_edit_date": 1466064822, "creation_date": 1465978255, "answer_id": 37829651, "question_id": 37829344, "link": "https://stackoverflow.com/questions/37829344/can-you-have-required-keyword-arguments-in-javascript-or-python/37829651#37829651", "title": "Can you have required keyword arguments in Javascript or Python?", "body": "<p><a href=\"http://python.org/dev/peps/pep-3102\" rel=\"noreferrer\">PEP-3102</a> introduced <em>\"keyword-only arguments\"</em>, so in Python 3.x you could do:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def obvious_total(*, subtotal, tax, discount):\n    \"\"\"Calculate the total and force keyword arguments.\"\"\"\n    return subtotal + tax - discount\n</code></pre>\n\n<p>In use:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>&gt;&gt;&gt; obvious_total(1, 2, 3)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nTypeError: obvious_total() takes 0 positional arguments but 3 were given\n&gt;&gt;&gt; obvious_total(subtotal=1, tax=2, discount=3)\n0\n</code></pre>\n\n<hr>\n\n<p>In JavaScript (pre-ES6) there is no way to have keyword arguments at all. The convention for this would be to define a single positional argument into which the user passes an object literal:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>obviousTotal = function (input) {\n    return input.subtotal + input.tax - input.discount\n}\n</code></pre>\n\n<p>and then pass an object literal as <code>input</code>. In use:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>&gt; obviousTotal(1, 2, 3)\nNaN  // because (1).subtotal etc. are undefined \n&gt; obviousTotal({ subtotal: 1, tax: 2, discount: 3 })\n0\n</code></pre>\n\n<p>ES6 lets you simplify this a bit with <em>destructuring</em>, but there is still (as far as I'm aware) no native support for required keyword arguments.</p>\n"}], "owner": {"reputation": 83, "user_id": 3130824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b8c9069b69f81d1fa0519ba63d6e8a?s=128&d=identicon&r=PG&f=1", "display_name": "Thonanth Siddef", "link": "https://stackoverflow.com/users/3130824/thonanth-siddef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4116, "favorite_count": 1, "accepted_answer_id": 37829651, "answer_count": 1, "score": 3, "last_activity_date": 1466064822, "creation_date": 1465977332, "question_id": 37829344, "link": "https://stackoverflow.com/questions/37829344/can-you-have-required-keyword-arguments-in-javascript-or-python", "title": "Can you have required keyword arguments in Javascript or Python?", "body": "<p>Can you have required keyword arguments in javascript or python? Is this a common feature of programming languages, or is it new and rare? They would be analogous to this implementation of keyword arguments in Ruby in Ruby 2.1+</p>\n\n<pre><code>def obvious_total(subtotal:, tax:, discount:)\n  subtotal + tax - discount\nend\n\nobvious_total(subtotal: 100, tax: 10, discount: 5) # =&gt; 105\n</code></pre>\n\n<p>(The above example comes directly from <a href=\"https://robots.thoughtbot.com/ruby-2-keyword-arguments\" rel=\"nofollow\">https://robots.thoughtbot.com/ruby-2-keyword-arguments</a>)</p>\n\n<p>I'd like to know because I was really interested in the perspective of the author of the above page. He basically suggests that required keyword arguments would help coders understand each other's code later on down the line, while only sacrificing succintness. Personally, I think that that is a decent trade off, and I wonder if it is commonly practiced or not. </p>\n\n<p>It is quite a common occurrence, I think, to find poorly documented code, and to wonder which argument does what. That's why I always try to put good and succinct instructions at my methods. I could be crazy and this is a completely unnecessary feature, after all, I'm just a newbie coder who scripts stuff when he gets lazy.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "forms", "postgresql"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "edited": false, "score": 0, "creation_date": 1466056359, "post_id": 37840158, "comment_id": 63160640, "body": "NoMethodError in Sessions#new   undefined method `information_index_path&#39; for #&lt;#&lt;Class:0x8916198&gt;:0x92d5070&gt;"}, {"owner": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "edited": false, "score": 0, "creation_date": 1466056395, "post_id": 37840158, "comment_id": 63160658, "body": "I am new in rails. Can you tell me please what to modify in the routes.rb file"}, {"owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "reply_to_user": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "edited": false, "score": 0, "creation_date": 1466084710, "post_id": 37840158, "comment_id": 63179340, "body": "You should read the <a href=\"http://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">Rails guide on routing</a>. In this case, you&#39;re still missing the POST endpoint for <code>:create</code>."}], "tags": [], "owner": {"reputation": 474, "user_id": 4280391, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c72e42508a9f525a0b8c395d02f97e4?s=128&d=identicon&r=PG&f=1", "display_name": "Raynor Kuang", "link": "https://stackoverflow.com/users/4280391/raynor-kuang"}, "is_accepted": true, "score": 0, "last_activity_date": 1466005712, "creation_date": 1466005712, "answer_id": 37840158, "question_id": 37829239, "link": "https://stackoverflow.com/questions/37829239/issue-regarding-param-is-missing-or-the-value-is-empty-information/37840158#37840158", "title": "Issue regarding param is missing or the value is empty: information", "body": "<p>I think you're confusing <code>create</code> and <code>new</code>. You put your form in your <code>create</code> view, which is only rendered after processing the <code>create</code> endpoint in your controller. But since no params are passed to <code>create</code> (since you haven't even hit a form yet), it's generating an error.</p>\n\n<p>Move your form to <code>new.html.erb</code> and access it by going to your <code>/new</code> route. After that your form should route the submission to your <code>create</code> endpoint. (At which point you can render a <code>create</code> view that just does something like confirm the object was created, or whatever you'd like.)</p>\n"}], "owner": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 37840158, "answer_count": 1, "score": 0, "last_activity_date": 1466056522, "creation_date": 1465977008, "last_edit_date": 1466056522, "question_id": 37829239, "link": "https://stackoverflow.com/questions/37829239/issue-regarding-param-is-missing-or-the-value-is-empty-information", "title": "Issue regarding param is missing or the value is empty: information", "body": "<p>I have an application of sign up and log in. After log in the users can see the contents of a database table. Now I want that after log in the users will also be able to insert data into another table via a form. Since I want to add this capacity after log in so I am writing the necessary code in the session part. But it is showing the following error:</p>\n\n<blockquote>\n  <p>ActionController::ParameterMissing in SessionsController#create</p>\n</blockquote>\n\n<p>param is missing or the value is empty: information</p>\n\n<p>My app/controllers/session_controller.rb file is:</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n    def new\n        super\n        @info = Information.new\n    end\n\n    def index\n        @tm\n        user = User.authenticate(params[:email], params[:password])\n        @data = Information.all\n        @num = Information.count\n        @tym = Time.now.getutc\n    end\n\n    def create\n        user = User.authenticate(params[:email], params[:password])\n        @data = Information.all\n        @num = Information.count\n        @tym = Time.now.getutc\n        if user\n            session[:user_id] = user.id\n            # redirect_to root_url, :notice =&gt; \"Logged in!\"\n\n            # this part is for showing the content of the information table\n            respond_to do |format|\n                format.html\n                format.xml { render xml: @data }\n\n                @info = @num\n                @info = Information.new(information_params)\n                @info.save\n\n                @currentUser = current_user.id\n                @usr = User.find_by(id: @currentUser)\n\n                @other_usr = User.where.not(id: @currentUser)\n\n                @usr.send_password_reset_1\n\n                @other_usr.each(&amp;:notloggedin)\n            end\n        else\n            flash.now.alert = 'Invalid email or password'\n            render 'new'\n        end\n    end\n\n    def information_params\n        params.require(:information).permit(:age, :name)\n    end\n\n    def refresh_page\n        redirect_to :back\n    end\n\n    def destroy\n        @currentUser = current_user.id\n        @usr = User.find_by(id: @currentUser)\n        @usr.send_password_reset_0\n\n        session[:user_id] = nil\n        redirect_to root_url, notice: 'Logged out!'\n    end\nend\n</code></pre>\n\n<p>My app/views/sessions/create.html.erb file is:-</p>\n\n<pre><code>&lt;h4&gt;Database contents here:&lt;/h4&gt;\n&lt;%= @currentUser %&gt;&lt;/br&gt;\n&lt;% @tm=Time.new %&gt;\n&lt;%= @tm.strftime(\"%H:%M:%S\") %&gt;\n&lt;table&gt;                         \n&lt;tr&gt;  \n&lt;th&gt;ID&lt;/th&gt;                        \n&lt;th&gt;AGE&lt;/th&gt;\n&lt;th&gt;NAME&lt;/th&gt;\n&lt;/tr&gt;\n&lt;% @data.each do |data| %&gt;       \n  &lt;tr&gt;\n  &lt;td&gt;&lt;%= data.id %&gt;&lt;/td&gt;  \n  &lt;td&gt;&lt;%= data.age %&gt;&lt;/td&gt;  \n  &lt;td&gt;&lt;%= data.name %&gt;&lt;/td&gt; \n  &lt;/tr&gt;\n&lt;% end %&gt;                        \n&lt;/table&gt; \n\n&lt;div&gt;\n\n&lt;%= form_tag 'refresh_page' do %&gt;\n  &lt;%= button_tag type: 'submit'  do %&gt;\n     &lt;%= content_tag :div do%&gt;\n        &lt;h4&gt;View Data &lt;/h4&gt;&lt;h4&gt;&lt;%= @num %&gt;&lt;/h4&gt;\n     &lt;% end %&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n\n&lt;!-- form for adding data into the information database --&gt;\n&lt;%= form_for @info do |f| %&gt;\n  &lt;% if @info.errors.any? %&gt;\n    &lt;div class=\"error_messages\"&gt;\n      &lt;h2&gt;Form is invalid&lt;/h2&gt;\n      &lt;ul&gt;\n        &lt;% for message in @user.errors.full_messages %&gt;\n          &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n        &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n  &lt;p&gt;\n  &lt;%= f.label :age %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :age %&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n  &lt;%= f.label :name %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;/p&gt;\n  &lt;p class=\"button\"&gt;&lt;%= f.submit %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I am using 2 tables here named User and Information. 'User' table holds all the information regarding the login credentials and I want to add records in the 'Information' table via the forms.</p>\n\n<p>My routes.rb file is:</p>\n\n<pre><code>Rails.application.routes.draw do\n\n\nget 'info_view/new'\n\nget 'sessions/new'\n\n#get 'users/new'\n\n#get 'sign_up' =&gt; 'users#new' , :as =&gt; 'sign_up'\n\n#root :to =&gt; 'users#new'\n#resources :users\n\n\nget \"log_out\" =&gt; \"sessions#destroy\", :as =&gt; \"log_out\"\nget \"log_in\" =&gt; \"sessions#new\", :as =&gt; \"log_in\"\nget \"sign_up\" =&gt; \"users#new\", :as =&gt; \"sign_up\"\nroot :to =&gt; \"users#new\"\n\nresources :users\nresources :sessions\n\nget 'refresh_page' =&gt; 'sessions#refresh_page'\npost 'refresh_page' =&gt; 'sessions#refresh_page'  \nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter"], "answers": [{"tags": [], "owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "is_accepted": true, "score": 1, "last_activity_date": 1465976730, "creation_date": 1465976730, "answer_id": 37829148, "question_id": 37829048, "link": "https://stackoverflow.com/questions/37829048/twitter-search-api-posting-unwanted-string-on-rails-page/37829148#37829148", "title": "Twitter Search API posting unwanted string on Rails page", "body": "<p>remove the <code>=</code> sign from the <code>each</code> line:</p>\n\n<p>instead of:</p>\n\n<pre><code>&lt;%= TwitterApi.search_twitter(query).each do |t| %&gt;\n</code></pre>\n\n<p>it should be:</p>\n\n<pre><code>&lt;% TwitterApi.search_twitter(query).each do |t| %&gt;\n</code></pre>\n\n<p><code>&lt;%=</code> means that the result of the line is rendered on the page. In case of an <code>each</code> clause, the result is the collection being iterated upon, in this case it is the result of <code>TwitterApi.search_twitter(query)</code>, which is of type <code>Twitter::SearchResults</code>...</p>\n"}], "owner": {"reputation": 760, "user_id": 5368448, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c0a99517c180eaf6b58e59246fc27b3d?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Fletcher", "link": "https://stackoverflow.com/users/5368448/marc-fletcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 37829148, "answer_count": 1, "score": 0, "last_activity_date": 1465976730, "creation_date": 1465976427, "question_id": 37829048, "link": "https://stackoverflow.com/questions/37829048/twitter-search-api-posting-unwanted-string-on-rails-page", "title": "Twitter Search API posting unwanted string on Rails page", "body": "<p>I am using the twitter gem and the search api to embed searched tweets on a page, but for some reason, at the bottom of the page, at the end of the embedded tweets, something like this will be posted in plain text:</p>\n\n<pre><code>#&lt;Twitter::SearchResults:0x007f893bb766e8&gt;\n</code></pre>\n\n<p>I cannot figure out why this is being posted. Obviously for presentation reasons I do not want this awkwardly affixed to the end of the page. </p>\n\n<p>from <strong>home.html.erb</strong></p>\n\n<pre><code>&lt;ul&gt;\n    &lt;% query = params[\"q\"] %&gt;\n      &lt;% if query != nil and query.chars.include? \"#\" %&gt;\n        &lt;%= TwitterApi.search_twitter(query).each do |t| %&gt;\n          &lt;% tweet = TwitterApi.embed(t)%&gt;\n          &lt;%= raw(tweet.html) %&gt;\n        &lt;% end %&gt;\n    &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>from <strong>twitter_api.rb</strong></p>\n\n<pre><code>class TwitterApi\n    def self.public_tweets(query)\n      client.user_timeline(query, count: 1, exclude_replies: true, include_rts: false)\n    end\n\n    def self.embed(arg)\n      client.oembed(arg)\n    end\n\n    def self.search_twitter(query)\n      query += \" -rt\"\n      client.search(query, count: 3)\n    end \nend\n</code></pre>\n"}, {"tags": ["ruby", "go", "deferred"], "answers": [{"tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": false, "score": 15, "last_activity_date": 1466021501, "last_edit_date": 1466021501, "creation_date": 1465975990, "answer_id": 37828900, "question_id": 37828645, "link": "https://stackoverflow.com/questions/37828645/what-is-the-ruby-equivalent-of-go-defer/37828900#37828900", "title": "What is the ruby equivalent of Go defer?", "body": "<p>There are no proper equivalents to the <code>defer</code> statement in ruby, however if you want to make sure that a specific code block is executed, you can use the <code>ensure</code> statement. The difference is that you cannot stack code blocks like defer does, but the result is the same.</p>\n\n<p><strong>In a block</strong></p>\n\n<pre><code>begin\n  # ...\nensure\n  # This code will be executed even if an exception is thrown\nend\n</code></pre>\n\n<p><strong>In a method</strong></p>\n\n<pre><code>def foo\n  # ...\nensure\n  # ...\nend\n</code></pre>\n\n<blockquote>\n  <p><a href=\"http://ruby-doc.org/docs/keywords/1.9/Object.html#method-i-ensure\" rel=\"noreferrer\">Object#ensure</a> Marks the final, optional clause of a begin/end block,\n  generally in cases where the block also contains a rescue clause. The\n  code in the ensure clause is guaranteed to be executed, whether\n  control flows to the rescue block or not.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 4921, "user_id": 171916, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/810fb8ed5b7f4d81ade67a2d34c1ffeb?s=128&d=identicon&r=PG", "display_name": "Narfanator", "link": "https://stackoverflow.com/users/171916/narfanator"}, "edited": false, "score": 1, "creation_date": 1492712037, "post_id": 37829583, "comment_id": 74107073, "body": "Someone downvoted this. Why? Does this code not work? Are there ugly consequences? This looks legit and neat."}], "tags": [], "owner": {"reputation": 821, "user_id": 1166593, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd1b53c45386ed7ac737bdd65b1f9fe2?s=128&d=identicon&r=PG", "display_name": "AlexN", "link": "https://stackoverflow.com/users/1166593/alexn"}, "is_accepted": false, "score": 5, "last_activity_date": 1493102456, "last_edit_date": 1493102456, "creation_date": 1465978044, "answer_id": 37829583, "question_id": 37828645, "link": "https://stackoverflow.com/questions/37828645/what-is-the-ruby-equivalent-of-go-defer/37829583#37829583", "title": "What is the ruby equivalent of Go defer?", "body": "<p>It doesn't have such a statement, but you can use metaprogramming to get this behavior.</p>\n\n<pre><code>module Deferable\n  def defer &amp;block\n    @defered_methods &lt;&lt; block\n  end\n\n  def self.included(mod)\n    mod.extend ClassMethods\n  end\n\n  module ClassMethods\n    def deferable method\n      original_method = instance_method(method)\n      define_method(method) do |*args|\n        @@defered_method_stack ||= []\n        @@defered_method_stack &lt;&lt; @defered_methods\n        @defered_methods = []\n        begin\n          original_method.bind(self).(*args)\n        ensure\n          @defered_methods.each {|m| m.call }\n          @defered_methods = @@defered_method_stack.pop\n        end\n      end\n    end\n  end\nend\n\nclass Test\n  include Deferable\n\n  def test\n    defer { puts \"world\" }\n    puts \"hello\"\n  end\n\n  def stacked_methods str\n    defer { puts \"and not broken\" }\n    defer { puts \"at all\" }\n    puts str\n    test\n  end\n\n  def throw_exception\n    defer { puts \"will be executed even if exception is thrown\" }\n    throw Exception.new\n  end\n\n  deferable :test\n  deferable :stacked_methods\n  deferable :throw_exception\nend\n</code></pre>\n\n<p>Example calls:</p>\n\n<pre><code>t = Test.new\nt.test\n\n# -&gt; Output:\n# hello\n# world\n\nt.stacked_methods \"stacked methods\"\n\n# -&gt; Output:\n# stacked methods\n# hello\n# world\n# and not broken\n# at all\n\nt.throw_exception\n# -&gt; Output:\n# will be executed even if exception is thrown\n# deferable.rb:45:in `throw': uncaught throw #&lt;Exception: Exception&gt; (UncaughtThrowError)\n#         from deferable.rb:45:in `throw_exception'\n#         from deferable.rb:18:in `call'\n#         from deferable.rb:18:in `block in deferable'\n#         from deferable.rb:59:in `&lt;main&gt;'\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6468119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e576d3ec6efe55060f0eeabbf81e1c?s=128&d=identicon&r=PG&f=1", "display_name": "reassesad", "link": "https://stackoverflow.com/users/6468119/reassesad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1568, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1493102456, "creation_date": 1465975287, "last_edit_date": 1465979425, "question_id": 37828645, "link": "https://stackoverflow.com/questions/37828645/what-is-the-ruby-equivalent-of-go-defer", "title": "What is the ruby equivalent of Go defer?", "body": "<p>I am a new to Ruby and I am working on a project which involves using this. Go offers the <a href=\"https://tour.golang.org/flowcontrol/12\" rel=\"noreferrer\"><code>defer</code></a> statement, and I wanted to know how I could replicate that function in ruby.</p>\n\n<p>Example:</p>\n\n<pre><code>dst, err := os.Create(dstName)\nif err != nil {\n    return\n}\ndefer dst.Close()\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "edited": false, "score": 0, "creation_date": 1465975066, "post_id": 37828447, "comment_id": 63119442, "body": "<code>ActionDispatch::ShowExeptions</code> should be <code>ActionDispatch::ShowExceptions</code> (you&#39;re missing a <code>c</code>)"}, {"owner": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "reply_to_user": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "edited": false, "score": 0, "creation_date": 1465976352, "post_id": 37828447, "comment_id": 63120210, "body": "Please check my edited question"}, {"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "edited": false, "score": 0, "creation_date": 1465976612, "post_id": 37828447, "comment_id": 63120372, "body": "This API has been deprecated since rails 3.x: <a href=\"http://grokbase.com/t/gg/activescaffold/132j43c9gq/actiondispatch-showexceptions-rails-upgrade-2-3-x-to-3-2-x\" rel=\"nofollow noreferrer\">grokbase.com/t/gg/activescaffold/132j43c9gq/&hellip;</a>"}, {"owner": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "reply_to_user": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "edited": false, "score": 0, "creation_date": 1465977319, "post_id": 37828447, "comment_id": 63120771, "body": "So how can I fix it?"}, {"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "edited": false, "score": 1, "creation_date": 1465977561, "post_id": 37828447, "comment_id": 63120903, "body": "...as it says in the error message - <code>Please configure your exceptions using a railtie or in your application config instead. (called from ApplicationController at &#47;home&#47;app&#47;demo&#47;app&#47;controllers&#47;application_controller.rb:31)</code>"}, {"owner": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "reply_to_user": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "edited": false, "score": 0, "creation_date": 1465984440, "post_id": 37828447, "comment_id": 63125500, "body": "Umm... can you tell me how to do that?"}], "answers": [{"comments": [{"owner": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "edited": false, "score": 0, "creation_date": 1466069847, "post_id": 37833624, "comment_id": 63168850, "body": "Tried.... got error like this which is same: <code>uninitialized constant WillPaginate::Railtie::Forbidden (NameError) </code>"}, {"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "reply_to_user": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "edited": false, "score": 0, "creation_date": 1466072210, "post_id": 37833624, "comment_id": 63170504, "body": "I&#39;m not familiar with the feature, but it seems that you read a very old documentation to implement, I suggest you read up on how to do this in a more recent documentation..."}, {"owner": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "edited": false, "score": 0, "creation_date": 1466078857, "post_id": 37833624, "comment_id": 63174745, "body": "Can you provide me link to most recent documentation?"}, {"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "reply_to_user": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "edited": false, "score": 0, "creation_date": 1466082518, "post_id": 37833624, "comment_id": 63177497, "body": "As I said - I&#39;m not familiar with the feature, so... no, I don&#39;t know where is the most recent documentation"}], "tags": [], "owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "is_accepted": false, "score": 0, "last_activity_date": 1465988688, "creation_date": 1465988688, "answer_id": 37833624, "question_id": 37828447, "link": "https://stackoverflow.com/questions/37828447/undefined-method-rescue-responses-for-actiondispatchshowexceptionsclass-no/37833624#37833624", "title": "undefined method `rescue_responses&#39; for ActionDispatch::ShowExceptions:Class (NoMethodError)", "body": "<p>Try:</p>\n\n<pre><code>initializer \"will_paginate.action_dispatch\" do |app|\n  if defined?(ActionController::Base)\n    config.action_dispatch.rescue_responses.update('ActionController::Forbidden'=&gt;Forbidden)\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "edited": false, "score": 0, "creation_date": 1466493485, "post_id": 37917395, "comment_id": 63325083, "body": "This sounds more sensible, can you give me original <code>railtie.rb</code> file? I didn&#39;t take a backup before modifying <code>railtie.rb</code>. My bad :("}, {"owner": {"reputation": 713, "user_id": 520910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a6856519364c26462c51fea9b8e29b?s=128&d=identicon&r=PG", "display_name": "Larry Lv", "link": "https://stackoverflow.com/users/520910/larry-lv"}, "reply_to_user": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "edited": false, "score": 0, "creation_date": 1466494232, "post_id": 37917395, "comment_id": 63325546, "body": "Just remove codes for module WillPaginate in your railtie.rb. I think after removal that file would be empty if you don&#39;t have any other added codes. If so, just remove the file."}, {"owner": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "edited": false, "score": 0, "creation_date": 1466494766, "post_id": 37917395, "comment_id": 63325843, "body": "so you want me to delete whole code in <code>railtie.rb</code>?"}, {"owner": {"reputation": 713, "user_id": 520910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a6856519364c26462c51fea9b8e29b?s=128&d=identicon&r=PG", "display_name": "Larry Lv", "link": "https://stackoverflow.com/users/520910/larry-lv"}, "reply_to_user": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "edited": false, "score": 0, "creation_date": 1466496424, "post_id": 37917395, "comment_id": 63326767, "body": "If you railtie.rb is just about will_paginate, yes, it&#39;s ok to delete the whole file."}], "tags": [], "owner": {"reputation": 713, "user_id": 520910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a6856519364c26462c51fea9b8e29b?s=128&d=identicon&r=PG", "display_name": "Larry Lv", "link": "https://stackoverflow.com/users/520910/larry-lv"}, "is_accepted": false, "score": 1, "last_activity_date": 1466409964, "creation_date": 1466409964, "answer_id": 37917395, "question_id": 37828447, "link": "https://stackoverflow.com/questions/37828447/undefined-method-rescue-responses-for-actiondispatchshowexceptionsclass-no/37917395#37917395", "title": "undefined method `rescue_responses&#39; for ActionDispatch::ShowExceptions:Class (NoMethodError)", "body": "<p>You don't have to add any initializer codes for hooking <code>will_paginate</code> into Rails project, if you are using recent <code>will_paginate</code> versions.</p>\n\n<p>I see you are using <code>3.0.pre2</code> version, update it to <code>3.0.7</code> in your Gemfile, <code>bundle update will_paginate</code> and remove all the codes you added in <code>railtie.rb</code>, I think everything would be ok.</p>\n"}, {"comments": [{"owner": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "edited": false, "score": 0, "creation_date": 1466493681, "post_id": 37922046, "comment_id": 63325198, "body": "yeah... but version of <code>will_paginate</code> is also important. I&#39;m using rails 4.2.6 and need to add suitable version of <code>will_paginate</code>. So updating from <code>3.0.pre2</code> to <code>3.0.7</code> as suggested by Larry Lv might work"}, {"owner": {"reputation": 279, "user_id": 6011528, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/88988c501057fb63352392af1d882366?s=128&d=identicon&r=PG&f=1", "display_name": "SnehaT", "link": "https://stackoverflow.com/users/6011528/snehat"}, "reply_to_user": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "edited": false, "score": 0, "creation_date": 1466496116, "post_id": 37922046, "comment_id": 63326598, "body": "Yeah I know...I did not say the version of gem does not matter...I just said the rb file is not require..."}], "tags": [], "owner": {"reputation": 279, "user_id": 6011528, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/88988c501057fb63352392af1d882366?s=128&d=identicon&r=PG&f=1", "display_name": "SnehaT", "link": "https://stackoverflow.com/users/6011528/snehat"}, "is_accepted": false, "score": -2, "last_activity_date": 1466424018, "creation_date": 1466424018, "answer_id": 37922046, "question_id": 37828447, "link": "https://stackoverflow.com/questions/37828447/undefined-method-rescue-responses-for-actiondispatchshowexceptionsclass-no/37922046#37922046", "title": "undefined method `rescue_responses&#39; for ActionDispatch::ShowExceptions:Class (NoMethodError)", "body": "<p>I do not find any reason for you to add railtie.rb file. I believe just adding the gem and using it in your view should work.</p>\n"}], "owner": {"reputation": 2460, "user_id": 4185813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/wIebp.jpg?s=128&g=1", "display_name": "Ajay Kulkarni", "link": "https://stackoverflow.com/users/4185813/ajay-kulkarni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1466424018, "creation_date": 1465974704, "last_edit_date": 1466070249, "question_id": 37828447, "link": "https://stackoverflow.com/questions/37828447/undefined-method-rescue-responses-for-actiondispatchshowexceptionsclass-no", "title": "undefined method `rescue_responses&#39; for ActionDispatch::ShowExceptions:Class (NoMethodError)", "body": "<p>In my ruby 2.3.1, I get this error:  </p>\n\n<pre><code> =&gt; Booting WEBrick\n=&gt; Rails 4.2.6 application starting in development on http://localhost:3000\n=&gt; Run `rails server -h` for more startup options\n=&gt; Ctrl-C to shutdown server\nExiting\n/root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/will_paginate-3.0.pre2/lib/will_paginate/railtie.rb:15:in `block in &lt;class:Railtie&gt;': uninitialized constant WillPaginate::Railtie::Forbidden (NameError)\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/initializable.rb:30:in `instance_exec'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/initializable.rb:30:in `run'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/initializable.rb:55:in `block in run_initializers'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:228:in `block in tsort_each'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:431:in `each_strongly_connected_component_from'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:349:in `block in each_strongly_connected_component'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `each'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `call'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `each_strongly_connected_component'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:226:in `tsort_each'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:205:in `tsort_each'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/initializable.rb:54:in `run_initializers'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/application.rb:352:in `initialize!'\n        from /home/bistipweb/config/environment.rb:5:in `&lt;top (required)&gt;'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/polyglot-0.3.1/lib/polyglot.rb:64:in `require'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/polyglot-0.3.1/lib/polyglot.rb:64:in `require'\n        from /home/bistipweb/config.ru:3:in `block in &lt;main&gt;'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-1.6.0/lib/rack/builder.rb:55:in `instance_eval'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-1.6.0/lib/rack/builder.rb:55:in `initialize'\n        from /home/bistipweb/config.ru:in `new'\n        from /home/bistipweb/config.ru:in `&lt;main&gt;'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-1.6.0/lib/rack/builder.rb:49:in `eval'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-1.6.0/lib/rack/builder.rb:49:in `new_from_string'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-1.6.0/lib/rack/builder.rb:40:in `parse_file'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-1.6.0/lib/rack/server.rb:299:in `build_app_and_options_from_config'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-1.6.0/lib/rack/server.rb:208:in `app'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/commands/server.rb:61:in `app'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-1.6.0/lib/rack/server.rb:336:in `wrapped_app'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/commands/server.rb:139:in `log_to_stdout'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/commands/server.rb:78:in `start'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/commands/commands_tasks.rb:80:in `block in server'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/commands/commands_tasks.rb:75:in `tap'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/commands/commands_tasks.rb:75:in `server'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/commands/commands_tasks.rb:39:in `run_command!'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-4.2.6/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\n        from bin/rails:4:in `require'\n        from bin/rails:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>My <code>railtie.rb</code> is:  </p>\n\n<pre><code>require 'will_paginate'\nrequire 'will_paginate/collection'\n\nmodule WillPaginate\n        class Railtie &lt; Rails::Railtie\n                initializer \"will_paginate.active_record\" do |app|\n                        if defined? ::ActiveRecord\n                                require 'will_paginate/finders/active_record'\n                                WillPaginate::Finders::ActiveRecord.enable!\n                        end\n                end\n\n                initializer \"will_paginate.action_dispatch\" do |app|\n                        if defined?(ActionController::Base)\n                                config.action_dispatch.rescue_responses.update('ActionController::Forbidden'=&gt;Forbidden)\n                        end\n                 end\n\n                initializer \"will_paginate.action_view\" do |app|\n                        require 'will_paginate/view_helpers/action_view'\n                        ActionView::Base.send(:include, WillPaginate::ViewHelpers::ActionView)\n                end\n         end\nend\n</code></pre>\n\n<p>How can I fix it? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundler", "rbenv"], "comments": [{"owner": {"reputation": 369, "user_id": 3997439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L7TFV.png?s=128&g=1", "display_name": "plombix", "link": "https://stackoverflow.com/users/3997439/plombix"}, "edited": false, "score": 0, "creation_date": 1466525824, "post_id": 37828200, "comment_id": 63347993, "body": "i had same problem with a student who chmod 777 too much ,i&#39;ve sorted it out with  the dumb lazy way : complete suppression and reinstall of all  components : rvm, ruby , all gems mysql and psql ."}], "answers": [{"comments": [{"owner": {"reputation": 4062, "user_id": 1281694, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83e0f83fbbdd69558f2149f9aa29f3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/1281694/linus"}, "edited": false, "score": 0, "creation_date": 1465975431, "post_id": 37828480, "comment_id": 63119667, "body": "Thanks for the idea. I&#39;ve added the result to my question @Uri Agassi."}, {"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "reply_to_user": {"reputation": 4062, "user_id": 1281694, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83e0f83fbbdd69558f2149f9aa29f3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/1281694/linus"}, "edited": false, "score": 0, "creation_date": 1465975721, "post_id": 37828480, "comment_id": 63119819, "body": "The other calls pass?"}, {"owner": {"reputation": 4062, "user_id": 1281694, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83e0f83fbbdd69558f2149f9aa29f3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/1281694/linus"}, "edited": false, "score": 0, "creation_date": 1465975803, "post_id": 37828480, "comment_id": 63119867, "body": "Sorry for not mentioning, the error is the same for all of them."}, {"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "reply_to_user": {"reputation": 4062, "user_id": 1281694, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83e0f83fbbdd69558f2149f9aa29f3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/1281694/linus"}, "edited": false, "score": 0, "creation_date": 1465975934, "post_id": 37828480, "comment_id": 63119947, "body": "Look at this: <a href=\"http://stackoverflow.com/questions/36387192/my-ruby-gems-path-is-messed-up-after-switching-from-rvm-to-rbenv\" title=\"my ruby gems path is messed up after switching from rvm to rbenv\">stackoverflow.com/questions/36387192/&hellip;</a>"}, {"owner": {"reputation": 4062, "user_id": 1281694, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83e0f83fbbdd69558f2149f9aa29f3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/1281694/linus"}, "edited": false, "score": 0, "creation_date": 1465977219, "post_id": 37828480, "comment_id": 63120711, "body": "Thanks for the link. As the answer mentions deleting the rails project, I think the result is the same if I just delete the vendor folder, which I already did. It would be interesting how exactly he removed the gems. I tried with <code>rm -rf ~&#47;.rbenv&#47;versions&#47;2.3.0</code> and reinstalled the version but it didn&#39;t solve the problem."}], "tags": [], "owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "is_accepted": false, "score": 0, "last_activity_date": 1465974785, "creation_date": 1465974785, "answer_id": 37828480, "question_id": 37828200, "link": "https://stackoverflow.com/questions/37828200/lazy-symbol-binding-failed/37828480#37828480", "title": "lazy symbol binding failed", "body": "<p>Try following the hints in the error messages:</p>\n\n<pre><code>gem pristine binding_of_caller --version 0.7.2\ngem pristine byebug --version 9.0.5\ngem pristine debug_inspector --version 0.0.2\ngem pristine pg --version 0.18.4\ngem pristine puma --version 3.4.0\ngem pristine sqlite3 --version 1.3.11\ngem pristine websocket-driver --version 0.6.4\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4062, "user_id": 1281694, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83e0f83fbbdd69558f2149f9aa29f3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/1281694/linus"}, "edited": false, "score": 0, "creation_date": 1465983259, "post_id": 37829596, "comment_id": 63124665, "body": "Thanks for your suggestion but as I&#39;ve stated in my answer, this command doesn&#39;t solve the problem."}, {"owner": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "reply_to_user": {"reputation": 4062, "user_id": 1281694, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83e0f83fbbdd69558f2149f9aa29f3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/1281694/linus"}, "edited": false, "score": 0, "creation_date": 1465983654, "post_id": 37829596, "comment_id": 63124950, "body": "@Linus one more solution in my answer, could you try it"}, {"owner": {"reputation": 4062, "user_id": 1281694, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83e0f83fbbdd69558f2149f9aa29f3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/1281694/linus"}, "edited": false, "score": 0, "creation_date": 1465984584, "post_id": 37829596, "comment_id": 63125600, "body": "I&#39;m using the <code>Postgres.app</code> for some time now. I&#39;ve additionally installed <code>brew install postgresql</code> but the problem stays. Shall I additionally install something?"}], "tags": [], "owner": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "is_accepted": false, "score": 0, "last_activity_date": 1465983636, "last_edit_date": 1465983636, "creation_date": 1465978072, "answer_id": 37829596, "question_id": 37828200, "link": "https://stackoverflow.com/questions/37828200/lazy-symbol-binding-failed/37829596#37829596", "title": "lazy symbol binding failed", "body": "<p>Try to <a href=\"https://www.postgresql.org/download/\" rel=\"nofollow\">Install Postgresql</a> with <code>libpq-dev</code> lib</p>\n\n<p>It looks like you don't have psql drivers</p>\n"}, {"comments": [{"owner": {"reputation": 4062, "user_id": 1281694, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83e0f83fbbdd69558f2149f9aa29f3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/1281694/linus"}, "edited": false, "score": 0, "creation_date": 1466179865, "post_id": 37881908, "comment_id": 63226663, "body": "Ok, thanks for the hint but this gem is not in the project&#39;s gemfile. I&#39;m not sure why it&#39;s mentioned in the terminal. What can I do to fix this then? Thanks in advance."}], "tags": [], "owner": {"reputation": 732, "user_id": 3165889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iH3bp.jpg?s=128&g=1", "display_name": "Joao Cunha", "link": "https://stackoverflow.com/users/3165889/joao-cunha"}, "is_accepted": false, "score": 0, "last_activity_date": 1466167479, "creation_date": 1466167479, "answer_id": 37881908, "question_id": 37828200, "link": "https://stackoverflow.com/questions/37828200/lazy-symbol-binding-failed/37881908#37881908", "title": "lazy symbol binding failed", "body": "<p>The documentation of binding of caller says that it <strong>only</strong> works until ruby 2.1</p>\n\n<blockquote>\n  <p>Only works in MRI Ruby 1.9.2, 1.9.3, 2.0, 2.1 and RBX (Rubinius)</p>\n</blockquote>\n\n<p>ref:\n<a href=\"https://github.com/banister/binding_of_caller#user-content-binding_of_caller\" rel=\"nofollow\">https://github.com/banister/binding_of_caller#user-content-binding_of_caller</a></p>\n"}, {"tags": [], "owner": {"reputation": 4062, "user_id": 1281694, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83e0f83fbbdd69558f2149f9aa29f3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/1281694/linus"}, "is_accepted": true, "score": 2, "last_activity_date": 1466239912, "last_edit_date": 1466239912, "creation_date": 1466237865, "answer_id": 37894833, "question_id": 37828200, "link": "https://stackoverflow.com/questions/37828200/lazy-symbol-binding-failed/37894833#37894833", "title": "lazy symbol binding failed", "body": "<p>As I've tried a lot to get rid of this error, I cannot exactly tell what eventually solved it - but on the way to the solution I found out that I maybe had installed rbenv via github pull as well as homebrew. Assuming that this could lead to not installed gems (under a specific ruby version) being claimed as installed, this seems like a possible explanation. After running <code>rm -rf ~/.rbenv</code>, while leaving the brew's rbenv version installed, cleared the \"ignoring ...  because its native....\" hints while reinstalling the gems.</p>\n\n<p>The installation problem of the <code>pg</code> app was solved by resetting the correct config path:</p>\n\n<pre><code>bundle config build.pg --with-pg-config=/Applications/Postgres.app/Contents/Versions/9.3/bin/pg_config\n</code></pre>\n\n<p>and then running <code>bundle</code></p>\n"}], "owner": {"reputation": 4062, "user_id": 1281694, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83e0f83fbbdd69558f2149f9aa29f3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/1281694/linus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 37894833, "answer_count": 4, "score": 1, "last_activity_date": 1466239912, "creation_date": 1465974033, "last_edit_date": 1466143249, "question_id": 37828200, "link": "https://stackoverflow.com/questions/37828200/lazy-symbol-binding-failed", "title": "lazy symbol binding failed", "body": "<p>Using OS X Yosemite, for an existing Rails project I've installed ruby version 2.3.0 (using rbenv), installed bundler, bundled and rehashed. Now when I try to start the rails server, using bundle exec rails s, I'm getting the error below. </p>\n\n<p>I'm not entirely sure what happened after installing ruby 2.3.0 because this actually happened some time ago and as I couldn't get it to work in time, I switched back for an older ruby version for now. I've been searching for a solution for quite some time now since then. Solutions to similar issues here and other sites didn't solve this problem. The maybe most obvious solution, as stated below, running <code>gem pristine --all</code> doesn't solve the problem. I really hope you can guide me through, thanks a lot!</p>\n\n<pre><code>-&gt; bundle exec rails s\nIgnoring binding_of_caller-0.7.2 because its extensions are not built.  Try: gem pristine binding_of_caller --version 0.7.2\nIgnoring byebug-9.0.5 because its extensions are not built.  Try: gem pristine byebug --version 9.0.5\nIgnoring debug_inspector-0.0.2 because its extensions are not built.  Try: gem pristine debug_inspector --version 0.0.2\nIgnoring pg-0.18.4 because its extensions are not built.  Try: gem pristine pg --version 0.18.4\nIgnoring puma-3.4.0 because its extensions are not built.  Try: gem pristine puma --version 3.4.0\nIgnoring sqlite3-1.3.11 because its extensions are not built.  Try: gem pristine sqlite3 --version 1.3.11\nIgnoring websocket-driver-0.6.4 because its extensions are not built.  Try: gem pristine websocket-driver --version 0.6.4\ndyld: lazy symbol binding failed: Symbol not found: _rb_data_object_alloc\n  Referenced from: /Users/nandersen/Projects/the-lunch/vendor/bundle/gems/pg-0.18.4/lib/pg_ext.bundle\n  Expected in: flat namespace\n\ndyld: Symbol not found: _rb_data_object_alloc\n  Referenced from: /Users/nandersen/Projects/the-lunch/vendor/bundle/gems/pg-0.18.4/lib/pg_ext.bundle\n  Expected in: flat namespace\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>This is an update for a suggestion from an answer. The following error is the same for all mentioned gems.</p>\n\n<pre><code>gem pristine binding_of_caller --version 0.7.2\nERROR:  While executing gem ... (Gem::Exception)\n    Failed to find gems [\"binding_of_caller\"] = 0.7.2\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "sequel"], "answers": [{"tags": [], "owner": {"reputation": 713, "user_id": 520910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a6856519364c26462c51fea9b8e29b?s=128&d=identicon&r=PG", "display_name": "Larry Lv", "link": "https://stackoverflow.com/users/520910/larry-lv"}, "is_accepted": true, "score": 1, "last_activity_date": 1468548559, "last_edit_date": 1468548559, "creation_date": 1465973031, "answer_id": 37827877, "question_id": 37827627, "link": "https://stackoverflow.com/questions/37827627/equivalent-of-exclusion-in-sequel/37827877#37827877", "title": "Equivalent of `exclusion` in sequel", "body": "<p>Sequel doesn't provide the exclusion helper by default, but you could customize it yourself.</p>\n\n<pre><code>class Host &lt; Sequel::Model\n  def validate\n    super\n    errors.add(:subdomain, \"#{subdomain} is reserved.\") if %w(www us ca jp).include?(subdomain)\n  end\nend\n</code></pre>\n\n<p>See \"<a href=\"https://github.com/jeremyevans/sequel/blob/3ee3373dd81b9ad85ed224d13635c75827647f32/doc/validations.rdoc#custom-validations\" rel=\"nofollow\">Custom Validations</a>\" for more information.</p>\n"}], "owner": {"reputation": 496, "user_id": 5716507, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7b1d3a546a8c1e6e1b52cd5f375474a5?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh Shah", "link": "https://stackoverflow.com/users/5716507/saurabh-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 37827877, "answer_count": 1, "score": 1, "last_activity_date": 1468548559, "creation_date": 1465972065, "last_edit_date": 1468548395, "question_id": 37827627, "link": "https://stackoverflow.com/questions/37827627/equivalent-of-exclusion-in-sequel", "title": "Equivalent of `exclusion` in sequel", "body": "<p>What is the Sequel equivalent of \"exclusion\"?</p>\n\n<p>For a simple example, in Active Record:</p>\n\n<pre><code>validates :subdomain, exclusion: { in: %w(www us ca jp),\n    message: \"%{value} is reserved.\" }\n</code></pre>\n\n<p>How can this be written in Sequel?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "model", "friendly-id"], "answers": [{"comments": [{"owner": {"reputation": 845, "user_id": 5646801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d133162c0a6c4b45ad559f5a86f8f8a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii K", "link": "https://stackoverflow.com/users/5646801/sergii-k"}, "edited": false, "score": 0, "creation_date": 1465970778, "post_id": 37827241, "comment_id": 63117305, "body": "How about: <code>slug.try(:slice!, 0, 19)</code>? It&#39;ll handle <code>nil</code> values for <code>slug</code>."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 845, "user_id": 5646801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d133162c0a6c4b45ad559f5a86f8f8a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii K", "link": "https://stackoverflow.com/users/5646801/sergii-k"}, "edited": false, "score": 0, "creation_date": 1465970892, "post_id": 37827241, "comment_id": 63117366, "body": "If you use <code>try</code> then better go for the bang version <code>try!</code>. Personally I don&#39;t like try that much but it does the same thing as my <code>if</code>"}, {"owner": {"reputation": 845, "user_id": 5646801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d133162c0a6c4b45ad559f5a86f8f8a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii K", "link": "https://stackoverflow.com/users/5646801/sergii-k"}, "edited": false, "score": 0, "creation_date": 1465971404, "post_id": 37827241, "comment_id": 63117585, "body": "Agreed. There is another &quot;syntactic&quot; variation: <code>slug &amp;&amp; slug.slice!(0, 19) &amp;&amp; ...</code>."}, {"owner": {"reputation": 1675, "user_id": 3234020, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/82171ee5bc1b2139a9834c92ce52b4c7?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3234020/rob"}, "edited": false, "score": 0, "creation_date": 1465974502, "post_id": 37827241, "comment_id": 63119111, "body": "Went with the second option but it doesn&#39;t slice the slug. Just gives the validation error"}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": true, "score": 0, "last_activity_date": 1465970817, "last_edit_date": 1465970817, "creation_date": 1465970480, "answer_id": 37827241, "question_id": 37827082, "link": "https://stackoverflow.com/questions/37827082/trying-to-slice-data-in-the-model-before-it-is-saved-to-the-db-but-it-isnt-wor/37827241#37827241", "title": "Trying to .slice data in the model before it is saved to the db but it isn&#39;t working", "body": "<p>You don't assign the sliced value.</p>\n\n<pre><code>validate :text_slug_length\n\ndef text_slug_length\n  if key_type == 4\n    self.slug = slug.slice(0, 19)\n  end\nend\n</code></pre>\n\n<p>You might want to check for non-nil value of <code>slug</code> first.</p>\n\n<p>Now this does not look like a validation (it does not mark attributes as faulty, it corrects them) but modifies the user input. D'd suggest you use <code>before_validation</code> instead (and maybe add a real validation, though this is not necessary because you make sure slug length is not exceeded).</p>\n\n<pre><code>before_validation :slice_slug\nvalidates :slug, length: {maximum: 20}, if: :validate_slug_length?\n\ndef slice_slug\n  self.slug = slug.slice(0, 19) if slug.present? &amp;&amp; validate_slug_length?\nend\n\ndef validate_slug_length?\n  key_type == 4\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "is_accepted": false, "score": 0, "last_activity_date": 1466028601, "creation_date": 1466028601, "answer_id": 37846644, "question_id": 37827082, "link": "https://stackoverflow.com/questions/37827082/trying-to-slice-data-in-the-model-before-it-is-saved-to-the-db-but-it-isnt-wor/37846644#37846644", "title": "Trying to .slice data in the model before it is saved to the db but it isn&#39;t working", "body": "<p>Validations generally add errors to the model if the data is bad. It seems like that's not what you're going for; you just want to truncate the slug if the model's <code>key_type == 4</code>, right?  How about just:</p>\n\n<pre><code>before_validation :truncate_slug\n\ndef truncate_slug\n  self.slug = slug.try!(:slice, 0, 19) if key_type == 4\nend\n</code></pre>\n"}], "owner": {"reputation": 1675, "user_id": 3234020, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/82171ee5bc1b2139a9834c92ce52b4c7?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3234020/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 37827241, "answer_count": 2, "score": 0, "last_activity_date": 1466028601, "creation_date": 1465969762, "question_id": 37827082, "link": "https://stackoverflow.com/questions/37827082/trying-to-slice-data-in-the-model-before-it-is-saved-to-the-db-but-it-isnt-wor", "title": "Trying to .slice data in the model before it is saved to the db but it isn&#39;t working", "body": "<p>I'm trying to have the slug length be less than 20 if the <code>key_type</code> is <code>4</code>. </p>\n\n<p>In the model I have </p>\n\n<pre><code>validate :text_slug_length\n\ndef text_slug_length\n if key_type == 4\n   slug.slice(0, 19)\n end\n\nend\n</code></pre>\n\n<p>But this doesn't throw any errors but also doesnt work. Not sure why...</p>\n\n<p>The slug isnt used for values that have a <code>key_type</code> of <code>4</code>. Data with the <code>key_type</code> of <code>4</code> can be long slabs of text so it causes length errors when its trying to save a really long slug. I could somehow not save a slug of the <code>key_type</code> <code>4</code> but this way will also stop the errors from long slugs being generated and I figured <code>.slice</code> would be easier. </p>\n\n<p>Can someone help on why this doesn't work.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1465969427, "post_id": 37826896, "comment_id": 63116746, "body": "<i>Sidenote</i>: this is by no means a <code>metaprogramming</code>."}, {"owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "edited": false, "score": 0, "creation_date": 1465969863, "post_id": 37826896, "comment_id": 63116916, "body": "It is written above. How to not have this error occur and have the desired output."}, {"owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "edited": false, "score": 0, "creation_date": 1465969885, "post_id": 37826896, "comment_id": 63116930, "body": "The downvote was not justified."}], "answers": [{"comments": [{"owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "edited": false, "score": 0, "creation_date": 1465969815, "post_id": 37826916, "comment_id": 63116899, "body": "Okay so returning<code>self</code> in the <code>message</code> method returning the <code>#&lt;MyClass&gt;</code> object which has an implementation of <code>to</code> method` defined. Correct? Since <code>String#to</code> doesn&#39;t exist."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "edited": false, "score": 0, "creation_date": 1465970175, "post_id": 37826916, "comment_id": 63117060, "body": "I am lost. There is no <code>message</code> method defined. The receiver of <code>to</code> is supposed to be <code>MyClass</code> instance \u21d2 return it from <code>say</code> method that is chained before. I can\u2019t restate it more clear."}, {"owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "edited": false, "score": 0, "creation_date": 1465970251, "post_id": 37826916, "comment_id": 63117093, "body": "Oh my bad, The method <code>say</code> I meant. Not <code>message</code>. Thanks a ton!"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1465970061, "last_edit_date": 1465970061, "creation_date": 1465968913, "answer_id": 37826916, "question_id": 37826896, "link": "https://stackoverflow.com/questions/37826896/using-instance-eval-to-execute-a-block/37826916#37826916", "title": "Using instance_eval to execute a block", "body": "<p>You want to chain methods \u21d2 return a receiver (<code>self</code>):</p>\n\n<pre><code>def say(message)\n  @message = message\n  self\nend\n</code></pre>\n\n<p>In current implementation, <code>say</code> method returns a string and you are calling <code>to</code> method on returned value (a <code>String</code> instance,) resulting in error. </p>\n"}], "owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 37826916, "answer_count": 1, "score": -3, "last_activity_date": 1465970061, "creation_date": 1465968820, "last_edit_date": 1465969555, "question_id": 37826896, "link": "https://stackoverflow.com/questions/37826896/using-instance-eval-to-execute-a-block", "title": "Using instance_eval to execute a block", "body": "<p>I have the following class <code>MyClass</code>.</p>\n\n<pre><code>  class MyClass\n   def initialize(&amp;block)\n     if block_given?\n      self.instance_eval &amp;block\n      p \"Hey #{@name}, I have a message for you: #{@message}\"\n     else\n      #do_something else\n     end\n   end\n\n  def say(message)\n   @message = message\n   #puts \"how are you\"\n  end\n\n  def to(name)\n   puts self.inspect\n   @name = name\n  end\n\nend\n</code></pre>\n\n<p>I call this class with <code>MyClass.new { say('Hello').to('Haseeb') }</code>. But it throws me this error.</p>\n\n<pre><code> undefined method `to' for \"Hello\":String (NoMethodError).\n</code></pre>\n\n<p>The output should be <code>Hey Haseeb I have a message for you: Hello</code></p>\n"}, {"tags": ["ruby", "rake"], "answers": [{"comments": [{"owner": {"reputation": 290, "user_id": 265276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/033485f7e18823d4ccabb24e5cb4935f?s=128&d=identicon&r=PG", "display_name": "vigo", "link": "https://stackoverflow.com/users/265276/vigo"}, "edited": false, "score": 0, "creation_date": 1481393139, "post_id": 37826994, "comment_id": 69363397, "body": "Thanks @mudasobwa for the explanation."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 8, "last_activity_date": 1592683751, "last_edit_date": 1592683751, "creation_date": 1465969286, "answer_id": 37826994, "question_id": 37826890, "link": "https://stackoverflow.com/questions/37826890/what-is-the-magic-behind-desc-description-on-rake/37826994#37826994", "title": "What is the magic behind &quot;desc &#39;description&#39;&quot; on rake?", "body": "<p>Imagine simple DSL <em>that has a state</em> (very nai\u0308ve implementation):</p>\n<pre><code>@tasks = []\n@current = nil\n\ndef desc text\n  @current = Task.new(desc: text)\nend\n\ndef task params, &amp;cb\n  @current.update(params)\n  yield\n   ....\n  @tasks &lt;&lt; @current\n  @current = nil\nend\n</code></pre>\n<p>The code above requires additional checks etc, but the idea is that: stateful DSL collects tasks with their descriptions.</p>\n"}], "owner": {"reputation": 1690, "user_id": 3034747, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac87bcd269dafa9171c0bcb5baa209ac?s=128&d=identicon&r=PG", "display_name": "Yana Agun Siswanto", "link": "https://stackoverflow.com/users/3034747/yana-agun-siswanto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 0, "accepted_answer_id": 37826994, "answer_count": 1, "score": 1, "last_activity_date": 1592683751, "creation_date": 1465968801, "last_edit_date": 1484285147, "question_id": 37826890, "link": "https://stackoverflow.com/questions/37826890/what-is-the-magic-behind-desc-description-on-rake", "title": "What is the magic behind &quot;desc &#39;description&#39;&quot; on rake?", "body": "<p>For example on \n<a href=\"https://github.com/locomotivecms/wagon/blob/master/Rakefile#L23\" rel=\"nofollow noreferrer\">https://github.com/locomotivecms/wagon/blob/master/Rakefile#L23</a></p>\n\n<pre><code>desc 'build the gem and release it to rubygems.org'\ntask release: :gem do\n  sh \"gem push pkg/locomotivecms_wagon-#{gemspec.version}.gem\"\nend\n</code></pre>\n\n<p>When i ran <code>rake --task</code>, it returned as description.</p>\n\n<pre><code>rake clobber_package   # Remove package products\nrake gem               # Build the gem file locomotivecms_wagon-2.2.0.beta1.gem\nrake package           # Build all the packages\nrake release           # build the gem and release it to rubygems.org\nrake repackage         # Force a rebuild of the package files\nrake spec              # Run RSpec code examples\nrake spec:integration  # Run RSpec code examples\nrake spec:unit         # Run RSpec code examples\n</code></pre>\n\n<p>But i dont understand how can they take the description, isn't it replaced every time the description called ? How do they know specific description belongs to specific task ?</p>\n"}, {"tags": ["java", "ruby", "ta-lib"], "answers": [{"comments": [{"owner": {"reputation": 7374, "user_id": 1634753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aa962e4482e6eb20f3985622a039f0fe?s=128&d=identicon&r=PG", "display_name": "Rilcon42", "link": "https://stackoverflow.com/users/1634753/rilcon42"}, "edited": false, "score": 0, "creation_date": 1466360685, "post_id": 37887365, "comment_id": 63272845, "body": "That is an excellent solution, however I am not compiling a program in java. I am attempting to install a Ruby gem"}, {"owner": {"reputation": 177, "user_id": 5924716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b25b80b300aa17a64b8a2c924c3400f?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Umapathy", "link": "https://stackoverflow.com/users/5924716/siva-umapathy"}, "reply_to_user": {"reputation": 7374, "user_id": 1634753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aa962e4482e6eb20f3985622a039f0fe?s=128&d=identicon&r=PG", "display_name": "Rilcon42", "link": "https://stackoverflow.com/users/1634753/rilcon42"}, "edited": false, "score": 0, "creation_date": 1466658231, "post_id": 37887365, "comment_id": 63410466, "body": "@Rilcon42 Could you tell me more about your ruby environment? Are you using JRuby or Ruby? Also, the sequence of steps you did for installing ta-indicator, ta-lib (is there a talib-ruby involved?) could be helpful."}], "tags": [], "owner": {"reputation": 177, "user_id": 5924716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b25b80b300aa17a64b8a2c924c3400f?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Umapathy", "link": "https://stackoverflow.com/users/5924716/siva-umapathy"}, "is_accepted": false, "score": 0, "last_activity_date": 1466315715, "last_edit_date": 1466315715, "creation_date": 1466185357, "answer_id": 37887365, "question_id": 37826651, "link": "https://stackoverflow.com/questions/37826651/no-manifest-attribute-on-install-from-jar-not-self-created/37887365#37887365", "title": "No manifest attribute on install from JAR (not self-created)", "body": "<p>The manifest in this jar does not have an application entry point i.e there is no <code>Main-Class</code> attribute and hence the error. This is a <a href=\"https://docs.oracle.com/javase/tutorial/deployment/jar/appman.html\" rel=\"nofollow\">prerequisite</a> for creating an executable jar file. You could verify this fact by opening the ta-lib jar and reading manifest.mf. Given ta-lib is a library than a launchable program(GUI or interactive console), this is entirely normal to not have this attribute. </p>\n\n<p>As long as you have the ta-lib-0.4.0.jar in your classpath, you could call ta-lib functions like <a href=\"https://github.com/ishanthilina/TA-Lib-Java-Examples/blob/master/src/main/java/SimpleMovingAverageExample.java\" rel=\"nofollow\">this</a>. </p>\n\n<p>To compile the program</p>\n\n<pre><code>javac -cp 'searchpath of directories/jar files separated by OS specific path separator' &lt;sourcefiles&gt;\n</code></pre>\n\n<p>To run the program</p>\n\n<pre><code>java -cp 'searchpath of directories/jar files separated by OS specific path separator' your-main-class\n</code></pre>\n"}], "owner": {"reputation": 7374, "user_id": 1634753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aa962e4482e6eb20f3985622a039f0fe?s=128&d=identicon&r=PG", "display_name": "Rilcon42", "link": "https://stackoverflow.com/users/1634753/rilcon42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466315715, "creation_date": 1465967589, "last_edit_date": 1466050320, "question_id": 37826651, "link": "https://stackoverflow.com/questions/37826651/no-manifest-attribute-on-install-from-jar-not-self-created", "title": "No manifest attribute on install from JAR (not self-created)", "body": "<p>I am trying to install <code>ta-lib</code> for use with a ruby gem (ta-indicator), but the jar file says there is no manifest attribute. This is a fresh Win 10 install with the most recent version of Java SE and the JDK. Can someone tell me what I am doing wrong? </p>\n\n<p>Note: Most of the solutions I have seen for this issue on SO involve jars the user has created. In my case the JAR has been created by someone else <a href=\"http://ta-lib.org/hdr_dw.html\" rel=\"nofollow\">here</a>, and apparently works quite well for most people.   </p>\n\n<p>Note 2: <code>java -cp foo.jar full.package.name.ClassName</code> might work if I knew that information</p>\n\n<pre><code>C:\\Users\\king\\Downloads&gt;java -jar ta-lib-0.4.0.jar\nno main manifest attribute, in ta-lib-0.4.0.jar  \n\nC:\\Users\\king\\Downloads&gt;java -version\njava version \"1.8.0_91\"\nJava(TM) SE Runtime Environment (build 1.8.0_91-b15)\nJava HotSpot(TM) 64-Bit Server VM (build 25.91-b15, mixed mode)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-i18n"], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 5549118, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/1528435484134902/picture?type=large", "display_name": "Pirun Seng", "link": "https://stackoverflow.com/users/5549118/pirun-seng"}, "edited": false, "score": 0, "creation_date": 1465985159, "post_id": 37826827, "comment_id": 63125962, "body": "As I understand, the way you mentioned is to preserve a place, show page in this case, once the update info is invalid. It&#39;s my fault that I forgot to mention about creating a new object. It happens like the updating one. So, I&#39;m afraid we cannot preserve a place for this case since the url after invalid new object creation is &#39;/products&#39; which is exactly &#39;index&#39; page."}], "tags": [], "owner": {"reputation": 2230, "user_id": 6337957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1177d893bf3115edf0119cf56e7220?s=128&d=identicon&r=PG", "display_name": "Greg Navis", "link": "https://stackoverflow.com/users/6337957/greg-navis"}, "is_accepted": false, "score": 0, "last_activity_date": 1465968483, "creation_date": 1465968483, "answer_id": 37826827, "question_id": 37826588, "link": "https://stackoverflow.com/questions/37826588/rails-internationalization-switching-language-no-route-matches-on-fail-validatio/37826827#37826827", "title": "Rails Internationalization Switching Language No Route Matches on Fail Validation Form Update", "body": "<p><code>resources</code> create a mapping like:</p>\n\n<ul>\n<li><code>GET /products</code> - <code>ProductsController#index</code></li>\n<li><code>GET /products/:id</code> - <code>ProductsController#show</code> (not present in your case)</li>\n<li><code>GET /products/:id/edit</code> - <code>ProductsController#edit</code></li>\n<li><code>PUT /products/:id</code> - <code>ProductsController#update</code></li>\n<li><code>POST /products</code> - <code>ProductsController#create</code></li>\n<li><code>DELETE /products/:id</code> - <code>ProductsController#destroy</code></li>\n</ul>\n\n<p>The reason you see <code>/products/:id</code> in the URL is because this is the default route for the <code>update</code> action. What you can do is to change</p>\n\n<pre><code>resources :products, except: [:show]\n</code></pre>\n\n<p>to</p>\n\n<pre><code>resources :products, except: [:edit]\n</code></pre>\n\n<p>and show the edition form in <code>ProductsController#show</code>. If there's no distinction between viewing and editing the product then you don't have to indicate edition in the route with the <code>/edit</code> suffix.</p>\n"}, {"comments": [{"owner": {"reputation": 363, "user_id": 5549118, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/1528435484134902/picture?type=large", "display_name": "Pirun Seng", "link": "https://stackoverflow.com/users/5549118/pirun-seng"}, "edited": false, "score": 0, "creation_date": 1465985334, "post_id": 37827533, "comment_id": 63126073, "body": "Of course, not many, but some. To me, it&#39;s a little bit annoying to bring me to another page I do not expect to be. That&#39;s why I want to hear much idea. I&#39;ll consider your idea. Anyway, just let me hear from some other."}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 0, "last_activity_date": 1465971737, "creation_date": 1465971737, "answer_id": 37827533, "question_id": 37826588, "link": "https://stackoverflow.com/questions/37826588/rails-internationalization-switching-language-no-route-matches-on-fail-validatio/37827533#37827533", "title": "Rails Internationalization Switching Language No Route Matches on Fail Validation Form Update", "body": "<p>How many users will switch languages only after validations failed? Not that many, i think. </p>\n\n<p>So a simple solution would be to:</p>\n\n<ul>\n<li>change locale and show the same page if method was GET</li>\n<li>change locale and redirect to <em>home</em> if method was NOT GET</li>\n</ul>\n"}], "owner": {"reputation": 363, "user_id": 5549118, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/1528435484134902/picture?type=large", "display_name": "Pirun Seng", "link": "https://stackoverflow.com/users/5549118/pirun-seng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465971737, "creation_date": 1465967298, "question_id": 37826588, "link": "https://stackoverflow.com/questions/37826588/rails-internationalization-switching-language-no-route-matches-on-fail-validatio", "title": "Rails Internationalization Switching Language No Route Matches on Fail Validation Form Update", "body": "<p>I have a Rails site with i18 in which a user can switch language on the menu bar, 'en' and 'km' in my case.</p>\n\n<p>What I understand from switching language approach is to merge current param with the locale. 'Get' method is happened, I suppose.</p>\n\n<p>I have a resource, 'products' for example.\nThe products resource HAS NO 'show' page.</p>\n\n<pre><code>resources :products, except: [:show]\n</code></pre>\n\n<p>When update a product with some invalid data. Let say I have a validation the presence of name of the product, but I leave the product name blank in my form. Then the form is rendered back the 'edit' form but the 'update' action, but notice the 'url' is '/products/id' which is exactly like 'show' action.</p>\n\n<p>In this step, I switch the language. As expected, the locale is merged with current param. So, the 'get' method is happened now with the url 'products/id?_method=patch...'</p>\n\n<p>No route matches raises since I have no 'show' action.</p>\n\n<p>Can anybody suggest me a good way to handle this please?\nI can escape this problem by redirecting the 'get' method of 'show' action to somewhere possible like its index page. Anyway, I wonder if there are more better ways.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 2230, "user_id": 6337957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1177d893bf3115edf0119cf56e7220?s=128&d=identicon&r=PG", "display_name": "Greg Navis", "link": "https://stackoverflow.com/users/6337957/greg-navis"}, "is_accepted": true, "score": 2, "last_activity_date": 1465967949, "creation_date": 1465967949, "answer_id": 37826703, "question_id": 37826563, "link": "https://stackoverflow.com/questions/37826563/seed-production-data-in-rails-on-user-creation/37826703#37826703", "title": "Seed production data in Rails on user creation", "body": "<p>You shouldn't invoke <code>seeds.rb</code> upon user creation. Instead, <code>seeds.rb</code> should create the initial <code>User</code>-related models using the same method that the production app uses.</p>\n\n<p>I can see at least two solutions to the problem:</p>\n\n<ol>\n<li><p>Use the <code>after_create</code> callback on <code>User</code> to create the related objects. For example:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  after_create :generate_api_key\n\n  private\n\n  def generate_api_key\n    ApiKey.create!(user: self)\n  end\nend\n</code></pre>\n\n<p>In this case your <code>seeds.rb</code> can just call <code>User.create!(login: 'test1')</code>.  the related objects will be created automatically.</p></li>\n<li><p>Create a service object <code>UserRegistrationService</code> responsible for creating <code>User</code> and it's related objects, e.g.:</p>\n\n<pre><code>class UserRegistrationService\n  def call(user_params)\n    user = User.create!(user_params)\n    ApiKey.create!(user: user)\n    user\n  end\nend\n</code></pre>\n\n<p>In this case, <code>seeds.rb</code> should use the service to create the users. Instead of calling <code>User#create!</code> you should call <code>UserRegistrationService.new.call(login: 'test1')</code>.</p></li>\n</ol>\n"}], "owner": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 37826703, "answer_count": 1, "score": 0, "last_activity_date": 1465967949, "creation_date": 1465967192, "question_id": 37826563, "link": "https://stackoverflow.com/questions/37826563/seed-production-data-in-rails-on-user-creation", "title": "Seed production data in Rails on user creation", "body": "<p>I have a bunch of data created in seeds.rb for development purposes. Now I realized I basically need the same data to be created by default when a new user signs up on my website so he has not an empty account. What would be the best way to do it?</p>\n\n<p>In my seeds.rb I'm creating a testing user and a bunch of objects for it. Can I somehow pass a user id to <code>Rails.application.load_seed</code>? Or is there a better way of doing it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "webhooks", "slack-api", "slack"], "comments": [{"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1465970111, "post_id": 37826470, "comment_id": 63117028, "body": "Are you using the friendly name (e.g. <code>&lt;@smarx&gt;</code>) or the user ID (e.g. <code>&lt;@U12345&gt;</code>)? <a href=\"https://api.slack.com/docs/formatting\" rel=\"nofollow noreferrer\">The documentation</a> makes no mention of the former, but in practice it seems to work."}, {"owner": {"reputation": 255, "user_id": 2573539, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/28100271/picture?type=large", "display_name": "Japes", "link": "https://stackoverflow.com/users/2573539/japes"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1465970211, "post_id": 37826470, "comment_id": 63117079, "body": "I&#39;m using the friendly name, how could i find the ID? Specifically for the user group, because that is the end goal.  I just did a test and omitted the &lt;&gt; tags in the string, it is having some success but I don&#39;t know why. The notifications arent firing but the name is now highlighted yellow..."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1465970571, "post_id": 37826470, "comment_id": 63117224, "body": "I&#39;d suggest <code>notifier.ping &quot;Text @user1&quot;, parse: &quot;full&quot;</code>. With <code>parse=full</code>, you won&#39;t have to bother getting the IDs for things and can just get the parsing behavior you typically expect from manually typing into the Slack client."}, {"owner": {"reputation": 255, "user_id": 2573539, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/28100271/picture?type=large", "display_name": "Japes", "link": "https://stackoverflow.com/users/2573539/japes"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1465970858, "post_id": 37826470, "comment_id": 63117341, "body": "parse: &quot;full&quot; was the solution. Please write it as an answer and I&#39;ll select it as such!"}], "answers": [{"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 2, "last_activity_date": 1465972421, "creation_date": 1465972421, "answer_id": 37827729, "question_id": 37826470, "link": "https://stackoverflow.com/questions/37826470/slack-mentions-not-working/37827729#37827729", "title": "Slack mentions not working", "body": "<p>(Moving my comment to an answer.)</p>\n\n<p>I'd suggest this:</p>\n\n<pre><code>notifier.ping \"Text @user1\", parse: \"full\"\n</code></pre>\n\n<p>The \"full\" parse mode means you'll get automatic linking of @username, #channelname, etc., just like you get when typing into the Slack website/clients.</p>\n"}], "owner": {"reputation": 255, "user_id": 2573539, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/28100271/picture?type=large", "display_name": "Japes", "link": "https://stackoverflow.com/users/2573539/japes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 37827729, "answer_count": 1, "score": 0, "last_activity_date": 1465972421, "creation_date": 1465966658, "last_edit_date": 1465967538, "question_id": 37826470, "link": "https://stackoverflow.com/questions/37826470/slack-mentions-not-working", "title": "Slack mentions not working", "body": "<p>I'm using the slack-notifier gem to send notifications to my slack channel.</p>\n\n<pre><code>  notifier = Slack::Notifier.new \"https://hooks.slack.com/services/ABC1234567890\"\n  notifier.ping \"Text &lt;@user1&gt;\"\n</code></pre>\n\n<p>That is the general setup in rails.</p>\n\n<p>When I send to @user1 (my coworker), everything is OK. </p>\n\n<p>But if I send it to @user2 (myself), text is displayed without mention creating notification or being a clickable link.</p>\n\n<p>Also, if i send it to a usergroup, @my_team text is same above.</p>\n\n<p>I have also tried <code>!my_team</code> and <code>&lt;@user1|user1&gt;</code> . The output to the slack channel looks like <code>&lt;my_team&gt;</code> or <code>@user1</code>. So it appears it is not parsing correctly. </p>\n\n<p>Why could this be happening?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake", "rake-test"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1465966925, "post_id": 37826375, "comment_id": 63115772, "body": "Did you add it to your Gemfile?"}, {"owner": {"reputation": 161, "user_id": 1596148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PnhUs.jpg?s=128&g=1", "display_name": "Karl Bishop", "link": "https://stackoverflow.com/users/1596148/karl-bishop"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1465973091, "post_id": 37826375, "comment_id": 63118381, "body": "Aah I didn&#39;t think of that! That probably should have fixed it. However, I actually then get an error message: rake aborted! LoadError: cannot load such file -- 2.2/Console_ext . . ."}, {"owner": {"reputation": 161, "user_id": 1596148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PnhUs.jpg?s=128&g=1", "display_name": "Karl Bishop", "link": "https://stackoverflow.com/users/1596148/karl-bishop"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1465973194, "post_id": 37826375, "comment_id": 63118424, "body": "I&#39;m going to try rebuilding win32console as suggested by <a href=\"https://paulsperambulations.wordpress.com/2013/07/11/automated-testing-and-fixing-win32console/\" rel=\"nofollow noreferrer\">this blog post</a>"}], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 1596148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PnhUs.jpg?s=128&g=1", "display_name": "Karl Bishop", "link": "https://stackoverflow.com/users/1596148/karl-bishop"}, "is_accepted": true, "score": 0, "last_activity_date": 1465983584, "last_edit_date": 1495542374, "creation_date": 1465983584, "answer_id": 37831681, "question_id": 37826375, "link": "https://stackoverflow.com/questions/37826375/how-to-fix-win32console-message-in-rake-test-output/37831681#37831681", "title": "How to fix win32console message in rake test output?", "body": "<p>Hooray got it working!</p>\n\n<p>In the end your comment <a href=\"https://stackoverflow.com/users/179125/jordan\">Jordan</a> plus the suggestions on <a href=\"https://paulsperambulations.wordpress.com/2013/07/11/automated-testing-and-fixing-win32console/\" rel=\"nofollow noreferrer\">Paul's Perambulations</a> got me there.</p>\n\n<h2>Steps taken, for anyone else stuck on this:</h2>\n\n<ol>\n<li>Download and unzip <a href=\"https://github.com/luislavena/win32console\" rel=\"nofollow noreferrer\">win32console source</a></li>\n<li>Install specific (older) versions of the dependencies:\n\n<ul>\n<li><code>gem install rake -v 10.4.2</code></li>\n<li><code>gem install rake-compiler -v 0.9.9</code> (this is current latest anyway)</li>\n<li><code>gem install hoe -v 3.7.0</code></li>\n</ul></li>\n<li>Run <code>rake _10.4.2_ gem</code> in the win32console source directory (to use correct version)</li>\n<li>Run <code>gem install pkg/win32console-1.3.2.gem</code> (had to change version number and flip the slash around from original instructions)</li>\n<li>Add <code>gem \"win32console\", '1.3.2'</code> to Gemfile</li>\n<li>Go back to project directory and run <code>bundle install</code></li>\n<li>Finally run <code>bundle exec rake test</code> - the info message has disappeared <em>and</em> colours are showing correctly!</li>\n</ol>\n"}], "owner": {"reputation": 161, "user_id": 1596148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PnhUs.jpg?s=128&g=1", "display_name": "Karl Bishop", "link": "https://stackoverflow.com/users/1596148/karl-bishop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 37831681, "answer_count": 1, "score": 0, "last_activity_date": 1465984254, "creation_date": 1465966186, "last_edit_date": 1465984254, "question_id": 37826375, "link": "https://stackoverflow.com/questions/37826375/how-to-fix-win32console-message-in-rake-test-output", "title": "How to fix win32console message in rake test output?", "body": "<p>I'm currently trying to learn Ruby on Rails on <strong>Windows 10</strong>.</p>\n\n<p>I'm following the excellent <a href=\"https://www.railstutorial.org/book/\" rel=\"nofollow\">railstutorial by Michael Hartl</a>.</p>\n\n<p>However, I'm getting bugged by the 'gem install win32console' message (and lack of colour) appearing when I run <code>rake test</code>. How can I fix this?</p>\n\n<h2>Sample output:</h2>\n\n<pre><code>$ bundle exec rake test\nansi: 'gem install win32console' to use color on Windows\nStarted\n\n  3/3: [===================================] 100% Time: 00:00:00, Time: 00:00:00\n\nFinished in 0.35885s\n3 tests, 6 assertions, 0 failures, 0 errors, 0 skips\n</code></pre>\n\n<h2>My setup:</h2>\n\n<p>Base: <a href=\"http://railsinstaller.org/en\" rel=\"nofollow\">Ruby 2.2 Rails Installer for Windows</a>.<br>\nRunning commands using <strong>Git Bash</strong>.<br>\nI also have the <a href=\"https://github.com/kern/minitest-reporters\" rel=\"nofollow\">minitest-reporters</a> gem installed (<a href=\"https://www.railstutorial.org/book/static_pages#sec-minitest_reporters\" rel=\"nofollow\">step 3.7.1 of tutorial</a>).</p>\n\n<h2>What I've tried:</h2>\n\n<ol>\n<li><p>First I ran <code>gem install win32console</code> bu this had no effect, even though the gem is visible when I run <code>gem list</code>.</p></li>\n<li><p>Then I saw <a href=\"https://github.com/luislavena/win32console\" rel=\"nofollow\">win32console is deprecated</a> so I installed <a href=\"http://adoxa.altervista.org/ansicon/\" rel=\"nofollow\">ansicon</a>.<br>\nThis also had no effect. And it seems colours are supported on Windows 10 anyway.<br>\nE.g. I can run the <strong>Hello World</strong> example <code>puts \"\\e[34mHello \\e[31mWorld\\e[0m\"</code> found on <a href=\"http://blog.mmediasys.com/2010/11/24/we-all-love-colors/\" rel=\"nofollow\">this blog</a> and it shows blue and red text, whether ansicon is installed or not.<br>\nHowever, colours won't show up correctly in <code>rake test</code> output and I still get the warning.</p></li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "ssl", "nginx", "captcha"], "comments": [{"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "edited": false, "score": 1, "creation_date": 1465965173, "post_id": 37826048, "comment_id": 63115161, "body": "Change <b>http</b> to <b>https</b> and it should work fine."}, {"owner": {"reputation": 313, "user_id": 2034099, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/p410N.jpg?s=128&g=1", "display_name": "Forrest Wilkins", "link": "https://stackoverflow.com/users/2034099/forrest-wilkins"}, "reply_to_user": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "edited": false, "score": 0, "creation_date": 1465965963, "post_id": 37826048, "comment_id": 63115397, "body": "Where would one change that if they&#39;re using simple_captcha2, like somewhere in the source for the gem itself?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1465966638, "post_id": 37826048, "comment_id": 63115654, "body": "I searched the codebase on Github and didn&#39;t find any matches for that URL. So it seems to not be generated by the gem directly (though it could be one of it&#39;s dependencies). Like has been said, change <code>http:&#47;&#47;anrcho.com</code> to <code>https:&#47;&#47;anrcho.com</code> somehow and it should work."}, {"owner": {"reputation": 313, "user_id": 2034099, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/p410N.jpg?s=128&g=1", "display_name": "Forrest Wilkins", "link": "https://stackoverflow.com/users/2034099/forrest-wilkins"}, "edited": false, "score": 0, "creation_date": 1465968171, "post_id": 37826048, "comment_id": 63116255, "body": "I just found where it&#39;s building the URL <a href=\"https://github.com/pludoni/simple-captcha/blob/master/lib/simple_captcha/view.rb\" rel=\"nofollow noreferrer\">here</a> but I&#39;m not sure if I should actually edit the source for the gem or if there&#39;s a better route available."}, {"owner": {"reputation": 3161, "user_id": 142223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3b8fdf45bb507c0b67d4aa2125748b9?s=128&d=identicon&r=PG", "display_name": "Ian Selby", "link": "https://stackoverflow.com/users/142223/ian-selby"}, "edited": false, "score": 1, "creation_date": 1465971268, "post_id": 37826048, "comment_id": 63117524, "body": "Looks like the code should use https if the request&#39;s protocol matches https (per the code <a href=\"https://github.com/pludoni/simple-captcha/blob/master/lib/simple_captcha/view.rb#L86\" rel=\"nofollow noreferrer\">here</a>). How are you running your rails app (e.g. puma behind nginx proxy)? Often, you need a directive in nginx to forward the protocol over the proxy so that rails is aware the request is https. If you can provide some more detail, I (or someone else) can probably help you get this answered."}, {"owner": {"reputation": 313, "user_id": 2034099, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/p410N.jpg?s=128&g=1", "display_name": "Forrest Wilkins", "link": "https://stackoverflow.com/users/2034099/forrest-wilkins"}, "edited": false, "score": 0, "creation_date": 1465971733, "post_id": 37826048, "comment_id": 63117730, "body": "I&#39;m using nginx with unicorn and I think the problem has something to do with Rails <code>request.protocol</code> that keeps returning <code>http</code> when the URL clearly has https."}, {"owner": {"reputation": 313, "user_id": 2034099, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/p410N.jpg?s=128&g=1", "display_name": "Forrest Wilkins", "link": "https://stackoverflow.com/users/2034099/forrest-wilkins"}, "edited": false, "score": 0, "creation_date": 1465972079, "post_id": 37826048, "comment_id": 63117893, "body": "As far as rails being aware the request is https, I just found this question where the person seems to have the same problem: <a href=\"http://stackoverflow.com/questions/16223470/nginx-can-not-forward-the-request-protocol-correctly-to-upstream\" title=\"nginx can not forward the request protocol correctly to upstream\">stackoverflow.com/questions/16223470/&hellip;</a>"}, {"owner": {"reputation": 313, "user_id": 2034099, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/p410N.jpg?s=128&g=1", "display_name": "Forrest Wilkins", "link": "https://stackoverflow.com/users/2034099/forrest-wilkins"}, "edited": false, "score": 0, "creation_date": 1465972837, "post_id": 37826048, "comment_id": 63118277, "body": "Okay so I changed my nginx config file so that https is being forwarded to rails and the page is loading fine now with no insecure content but the captcha image is still not loading."}, {"owner": {"reputation": 313, "user_id": 2034099, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/p410N.jpg?s=128&g=1", "display_name": "Forrest Wilkins", "link": "https://stackoverflow.com/users/2034099/forrest-wilkins"}, "edited": false, "score": 0, "creation_date": 1465975105, "post_id": 37826048, "comment_id": 63119467, "body": "It&#39;s working now after installing imagemagick. The assistance was much appreciated!"}], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 2034099, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/p410N.jpg?s=128&g=1", "display_name": "Forrest Wilkins", "link": "https://stackoverflow.com/users/2034099/forrest-wilkins"}, "is_accepted": true, "score": 1, "last_activity_date": 1467051032, "last_edit_date": 1495535437, "creation_date": 1467051032, "answer_id": 38060495, "question_id": 37826048, "link": "https://stackoverflow.com/questions/37826048/rails-simple-captcha-not-going-over-https/38060495#38060495", "title": "Rails Simple Captcha not going over HTTPS", "body": "<p>Adding the following lines (as described <a href=\"https://stackoverflow.com/questions/16223470/nginx-can-not-forward-the-request-protocol-correctly-to-upstream\">here</a>) to my <code>nginx.conf</code> solved the issue of <code>request.protocol</code> returning the wrong protocol:</p>\n\n<pre><code>proxy_set_header X-Forwarded-Proto https;\nproxy_set_header X-Forwarded-Ssl on;\n</code></pre>\n\n<p>As far as the captcha image not loading, whether as secure or insecure content, <code>imagemagick</code> has to be installed.</p>\n"}], "owner": {"reputation": 313, "user_id": 2034099, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/p410N.jpg?s=128&g=1", "display_name": "Forrest Wilkins", "link": "https://stackoverflow.com/users/2034099/forrest-wilkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 38060495, "answer_count": 1, "score": 3, "last_activity_date": 1593790278, "creation_date": 1465964184, "last_edit_date": 1593790278, "question_id": 37826048, "link": "https://stackoverflow.com/questions/37826048/rails-simple-captcha-not-going-over-https", "title": "Rails Simple Captcha not going over HTTPS", "body": "<p>I'm using the <code>simple_captcha2</code> gem for authentication with Rails and have it working fine in development but the captcha image/code is not going over the SSL layer in production so the image is not rendering within the captcha form. I set up OpenSSL using this <a href=\"https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-14-04\" rel=\"nofollow noreferrer\">letsencrypt</a> tutorial for multiple domains and it's worked fine for everything but <code>simple_captcha2</code>.</p>\n<p>Here is the error output from Firefox:</p>\n<pre><code>Loading mixed (insecure) display content &quot;http://example.com/simple_captcha?code=f987a2c87ea145419d79a00d6a257df701e2bea8&amp;time=1465962694&quot; on a secure page\n</code></pre>\n"}, {"tags": ["python", "ruby-on-rails", "ruby", "django", "encryption"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1465965601, "post_id": 37825758, "comment_id": 63115283, "body": "i think it&#39;s really not that simple of a question to the everyday ruby user. Maybe it&#39;s easier to delegate the encryption / decryption to the underlying system (i.e. run shell commands). That way both Ruby and Python can use the same API."}, {"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1466017865, "post_id": 37825758, "comment_id": 63148156, "body": "The answer was updated and should fully answer your question."}], "answers": [{"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 1, "last_activity_date": 1466018329, "last_edit_date": 1495541702, "creation_date": 1465971096, "answer_id": 37827388, "question_id": 37825758, "link": "https://stackoverflow.com/questions/37825758/encrypt-string-in-ruby-and-decrypt-in-python/37827388#37827388", "title": "Encrypt String In Ruby and Decrypt in Python", "body": "<p>After feedback by ArtjomB I looked deeper into the proposed library. It is nothing but a thin wrapper around ruby openssl. So you can write a ruby version of your AESCipher on your own. \nIt took some fiddling and research to find the right way:</p>\n\n<pre><code>require 'base64'\nrequire 'securerandom'\nrequire 'openssl'\n\nclass AESCipher\n  attr_reader :key\n\n  def initialize(key)\n    @key = key\n  end\n\n  def encrypt(raw)\n    iv = SecureRandom.random_bytes(16)\n    cipher = build_encription_cipher(iv)\n    encrypted = cipher.update(raw) + cipher.final\n    Base64.encode64(iv + encrypted)\n  end\n\n  def decrypt(data)\n    data = Base64.decode64(data)\n    iv, raw = data[0..15], data[16..-1]\n    cipher = build_decrypt_cipher(iv)\n    cipher.update(raw) + cipher.final\n  end\n\n  private\n\n  def build_encription_cipher(iv)\n    OpenSSL::Cipher::AES.new(128, :CBC).tap do |cipher|\n      cipher.encrypt\n      cipher.key = key\n      cipher.iv = iv\n      cipher.padding = 0\n    end\n  end\n\n  def build_decrypt_cipher(iv)\n    OpenSSL::Cipher::AES.new(128, :CBC).tap do |cipher|\n      cipher.decrypt\n      cipher.key = key\n      cipher.iv = iv\n      cipher.padding = 0\n    end\n  end\nend\n</code></pre>\n\n<p>In my testcases the ruby version decrypted strings encrypted by python and vice versa.</p>\n\n<p>(i did one modification to your python code: remove the call to <code>pad</code> as I don't know HOW it pads. And just used strings that are length multiple of 16).</p>\n\n<p>The answer by <em>colinm</em> in <a href=\"https://stackoverflow.com/questions/19661508/aes-python-encryption-and-ruby-encryption-different-behaviour\">AES Python encryption and Ruby encryption - different behaviour?</a> was very useful.</p>\n"}], "owner": {"reputation": 3240, "user_id": 2694306, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/a36c65851474c1cca6200426379fd82f?s=128&d=identicon&r=PG&f=1", "display_name": "user2694306", "link": "https://stackoverflow.com/users/2694306/user2694306"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 983, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1466018329, "creation_date": 1465962532, "question_id": 37825758, "link": "https://stackoverflow.com/questions/37825758/encrypt-string-in-ruby-and-decrypt-in-python", "title": "Encrypt String In Ruby and Decrypt in Python", "body": "<p>I am brand new to Ruby, so I apologize if this question is simple. I have to update a rails app so that it encrypts a string using a key. This is passed to an api written in django, where the encrypted string will be decrypted using the same key. I have the following code in Python, but I'm not sure how to encrypt the associated message in Ruby. Any help would be appreciated.</p>\n\n<pre><code>import base64\nfrom Crypto.Cipher import AES\nfrom Crypto import Random\n\nclass AESCipher:\n    def __init__( self, key ):\n        self.key = key\n\n    def encrypt( self, raw ):\n        raw = pad(raw)\n        iv = Random.new().read( AES.block_size )\n        cipher = AES.new( self.key, AES.MODE_CBC, iv )\n        return base64.b64encode( iv + cipher.encrypt( raw ) ) \n\n    def decrypt( self, enc ):\n        enc = base64.b64decode(enc)\n        iv = enc[:16]\n        cipher = AES.new(self.key, AES.MODE_CBC, iv )\n        return unpad(cipher.decrypt( enc[16:] ))\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1465964789, "post_id": 37825668, "comment_id": 63115056, "body": "What SQL is ultimately executed? Do you have any default scopes in the User, Role, or Permission model?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1465965873, "post_id": 37825668, "comment_id": 63115368, "body": "The line which outputs the warning is ActiveRecord, which is compiled to SQL. And it references the &quot;User&quot; class. Maybe you should add <code>.references(:user)</code> to the active record query and see if that stops the warning."}, {"owner": {"reputation": 10234, "user_id": 138513, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/42b570f6f4312a872c2fc671e3ddc82b?s=128&d=identicon&r=PG", "display_name": "Trejkaz", "link": "https://stackoverflow.com/users/138513/trejkaz"}, "edited": false, "score": 0, "creation_date": 1465967689, "post_id": 37825668, "comment_id": 63116079, "body": "references(:user) does clear the warning, but it isn&#39;t clear why I need this, because as far as I know, most of the other where() calls throughout the application aren&#39;t generating this warning. (A few others are, though.) As far as default scopes, a lot of the model classes have <code>-&gt;{ order(&#39;name&#39;) }</code> as the default scope. Obviously a lot of this stuff would generate SQL, but the Rails devs&#39; snarky message about not wanting to write an SQL parser seems incorrect as I&#39;m not the one creating the SQL."}, {"owner": {"reputation": 10234, "user_id": 138513, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/42b570f6f4312a872c2fc671e3ddc82b?s=128&d=identicon&r=PG", "display_name": "Trejkaz", "link": "https://stackoverflow.com/users/138513/trejkaz"}, "edited": false, "score": 0, "creation_date": 1465967827, "post_id": 37825668, "comment_id": 63116133, "body": "As far as what SQL it&#39;s actually executing... I can&#39;t tell. It used to come out on the console but it seems like it&#39;s gone now. I wish they would include that in the error message actually, it would really help with figuring out where they have screwed up. :/"}, {"owner": {"reputation": 10234, "user_id": 138513, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/42b570f6f4312a872c2fc671e3ddc82b?s=128&d=identicon&r=PG", "display_name": "Trejkaz", "link": "https://stackoverflow.com/users/138513/trejkaz"}, "edited": false, "score": 0, "creation_date": 1465976579, "post_id": 37825668, "comment_id": 63120354, "body": "Finally dug the SQL out of a log, but it&#39;s not very enlightening. It at least shows that no ordering and other stuff is going on. It&#39;s just a basic query with a single WHERE clause which is clearly constructed by Rails from the parameters I have passed in."}], "owner": {"reputation": 10234, "user_id": 138513, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/42b570f6f4312a872c2fc671e3ddc82b?s=128&d=identicon&r=PG", "display_name": "Trejkaz", "link": "https://stackoverflow.com/users/138513/trejkaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1465977225, "creation_date": 1465961800, "last_edit_date": 1465977225, "question_id": 37825668, "link": "https://stackoverflow.com/questions/37825668/why-is-rails-warning-me-about-an-sql-snippet-which-doesnt-exist", "title": "Why is Rails warning me about an SQL snippet which doesn&#39;t exist?", "body": "<p>I'm trying to get an app from Rails 3.2 to Rails 4.</p>\n\n<p>One particular point in my code is spitting out this warning:</p>\n\n<pre><code>DEPRECATION WARNING: It looks like you are eager loading table(s)\n(one of: users, one.example) that are referenced in a string SQL\nsnippet. For example: \n\n    Post.includes(:comments).where(\"comments.title = 'foo'\")\n\nCurrently, Active Record recognizes the table in the string, and\nknows to JOIN the comments table to the query, rather than loading\ncomments in a separate query. However, doing this without writing\na full-blown SQL parser is inherently flawed. Since we don't want\nto write an SQL parser, we are removing this functionality. From\nnow on, you must explicitly tell Active Record when you are\nreferencing a table from a string:\n\n    Post.includes(:comments).where(\"comments.title = 'foo'\")\n        .references(:comments)\n\nIf you don't rely on implicit join references you can disable the\nfeature entirely by setting\n`config.active_record.disable_implicit_join_references = true`.\n(called from authenticate_common at\n/path/to/project/app/models/user.rb:72)\n</code></pre>\n\n<p>But the line in question doesn't even contain SQL:</p>\n\n<pre><code>def self.authenticate_common(login, password)\n  return nil if login.blank? || password.blank?\n  # this line outputs the warning:\n  user = User.includes(INCLUDES_FOR_AUTH).where(:login =&gt; login).first\n  # and so does this line\n  user ||= User.includes(INCLUDES_FOR_AUTH).where(:email =&gt; login).first\n  return nil unless user &amp;&amp; user.authenticated?(password)\n  user\nend\n</code></pre>\n\n<p>Not only is the condition here not using SQL, but it isn't even referencing any related models, so the suggested fix cannot be performed. Additionally, there are no scopes in the <code>User</code> class which could be adding any default conditions.</p>\n\n<p>The value of <code>INCLUDES_FOR_AUTH</code> is:</p>\n\n<pre><code>INCLUDES_FOR_AUTH = [{ :roles =&gt; [ :permissions ]}]\n</code></pre>\n\n<p>The <code>Role</code> and <code>Permission</code> classes also lack any SQL snippets, though, so it can't be them.</p>\n\n<p>My only remaining thought is that maybe Rails is generating the SQL snippet and then tripping itself up on its own checks... is that what's going on? :/</p>\n\n<p>The investigation so far:</p>\n\n<ul>\n<li>After setting the includes to <code>[]</code>, the warning still appears.</li>\n<li>After removing all <code>order</code> calls from scopes throughout all model classes, the warning still appears.</li>\n<li>If I scatter calls to <code>references(:user)</code> throughout the code, it does clear the warning. I'm guessing that this is just masking the problem, because the problem at hand is that I'm not really sure why I have to call <code>references</code> in the first place, and if I do have to call it, I would like to do so next to the piece of code which causes it to be required, not all over the place.</li>\n<li><p>The queries it's ultimately running for these don't make a lot of sense to me because they don't seem to return the actual record:</p>\n\n<p>SELECT 1 AS one FROM \"users\" WHERE \"users\".\"login\" = 'someone@somewhere.com' LIMIT 1<br>\nSELECT 1 AS one FROM \"users\" WHERE \"users\".\"email\" = 'someone@somewhere.com' LIMIT 1</p>\n\n<p>From the queries, it seems like the where clause is the only one where the data I'm providing is even used, but the SQL there was definitely created by Rails itself.</p></li>\n</ul>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1465951472, "post_id": 37824184, "comment_id": 63111982, "body": "Why the rush to select an answer? Some members may be working on answers and others may decide not to offer an answer because you have already selected one."}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 3, "creation_date": 1465956713, "post_id": 37824300, "comment_id": 63113066, "body": "<code>^</code> and <code>$</code> mean beginning/ending of <i>line</i> in Ruby, not <i>string</i>, so they&#39;re almost always a mistake. You almost always want <code>\\A</code> and <code>\\z</code> instead."}], "tags": [], "owner": {"reputation": 75, "user_id": 4118091, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b99ebf6ddfe8aab91e79844fe4e56064?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Sweeney", "link": "https://stackoverflow.com/users/4118091/sam-sweeney"}, "is_accepted": false, "score": -2, "last_activity_date": 1465950882, "creation_date": 1465950882, "answer_id": 37824300, "question_id": 37824184, "link": "https://stackoverflow.com/questions/37824184/selecting-string-of-variable-length-from-string/37824300#37824300", "title": "Selecting string of variable length from string", "body": "<p>Found what i was looking for</p>\n\n<p>/^[a-zA-Z]{5,10}$/</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1465953697, "post_id": 37824327, "comment_id": 63112436, "body": "The number must have between 5 and 10 digits."}, {"owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "edited": false, "score": 0, "creation_date": 1465969305, "post_id": 37824327, "comment_id": 63116699, "body": "This doesn&#39;t answer the question"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1465975339, "post_id": 37824327, "comment_id": 63119605, "body": "Can you edit your post so I can remove my downvote?  One interpretation of the question makes your answer correct, and because the op accepted your answer, I&#39;m inclined to believe that your interpretation of the question was correct.  Sorry!"}], "tags": [], "owner": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "is_accepted": true, "score": -1, "last_activity_date": 1465976438, "last_edit_date": 1465976438, "creation_date": 1465951055, "answer_id": 37824327, "question_id": 37824184, "link": "https://stackoverflow.com/questions/37824184/selecting-string-of-variable-length-from-string/37824327#37824327", "title": "Selecting string of variable length from string", "body": "<p>looks like this just works:</p>\n\n<pre><code>\"job number:45678 date:01/01/16\"[/\\d+/]\n =&gt; \"45678\" \n\n\"job number:123421312 date:03/03/16\"[/\\d+/]\n =&gt; \"123421312\" \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1465964943, "post_id": 37824582, "comment_id": 63115094, "body": "I thought I&#39;d test out my regex first, and confoundingly <code>String#[]</code> does not honor the x flag.  I can&#39;t remember running in to that before."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 1, "creation_date": 1465965333, "post_id": 37824582, "comment_id": 63115202, "body": "@7stud, idon&#39;t forget that <code>&#47;...job number...&#47;x</code> is converted to <code>&#47;...jobnumber...&#47;</code>. so you need <code>&#47;...job\\snumber...&#47;x</code>."}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1465966068, "post_id": 37824582, "comment_id": 63115434, "body": "Yep, that was it.  Thanks."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1465954105, "last_edit_date": 1465954105, "creation_date": 1465953181, "answer_id": 37824582, "question_id": 37824184, "link": "https://stackoverflow.com/questions/37824184/selecting-string-of-variable-length-from-string/37824582#37824582", "title": "Selecting string of variable length from string", "body": "<pre><code> r = /(?&lt;=\\Ajob number:)\\d{5,10}(?!\\d)/\n\n\"job number:45678 date:01/01/16\"[r]\n  #=&gt; \"45678\" \n\"job number:4567 date:01/01/16\"[r]\n  #=&gt; nil \n\"job number:0123456789 date:01/01/16\"[r]\n  #=&gt; \"0123456789\" \n\"job number:01234567891 date:01/01/16\"[r]\n  #=&gt; nil \n</code></pre>\n\n<ul>\n<li><code>(?&lt;=\\Ajob number:)</code> is a <em>positive lookbehind</em> that requires the string 'job number:' to be at the beginning of the string (<code>\\A</code>), but that string is not part of the match</li>\n<li><code>\\d{5,10}</code> matches 5-10 digits</li>\n<li><code>(?!\\d)</code> is a <em>negative lookahead</em> that ensures the match is not followed by a digit. Without this, my last example above would return <code>0123456789</code>.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1465973281, "post_id": 37826424, "comment_id": 63118473, "body": "If <code>str = &#39;job number:012345678988888888888888 date:01&#47;01&#47;16&#39;</code>, <code>puts str[regex,1] #=&gt; &#39;0123456789&#39;</code>. The string in the capture group cannot be followed by a digit."}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1465974921, "post_id": 37826424, "comment_id": 63119343, "body": "@CarySwoveland, I know you put that restriction in your answer, but I didn&#39;t see where the op stated that restriction.  Although, it would be symmetrical to return nil for a number that is less than 5 digits as well as for a number that is more than 10 digits.  Another interpretation of the question: the numbers are always between 5-10 digits, so just return whatever is there--which would make the accepted answer correct."}], "tags": [], "owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "is_accepted": false, "score": 1, "last_activity_date": 1465975123, "last_edit_date": 1465975123, "creation_date": 1465966412, "answer_id": 37826424, "question_id": 37824184, "link": "https://stackoverflow.com/questions/37824184/selecting-string-of-variable-length-from-string/37826424#37826424", "title": "Selecting string of variable length from string", "body": "<pre><code>str = 'job number:45678 date:01/01/16'\n\nregex = %r{\n  \\A               #Match start of string, followed by...\n  job[ ]number:    #the literal string \"job number:\", followed by...\n  (\\d{5,10})       #a digit, 5 or more times--but not more than 10 times, captured in group 1.\n}xm                #Flags: Ignore whitespace in regex. Dot matches \\n.\n\nputs str[regex, 1]  #Return group 1 of match.\n\n--output:--\n45678\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4118091, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b99ebf6ddfe8aab91e79844fe4e56064?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Sweeney", "link": "https://stackoverflow.com/users/4118091/sam-sweeney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 37824327, "answer_count": 4, "score": 1, "last_activity_date": 1466009707, "creation_date": 1465949943, "last_edit_date": 1466009707, "question_id": 37824184, "link": "https://stackoverflow.com/questions/37824184/selecting-string-of-variable-length-from-string", "title": "Selecting string of variable length from string", "body": "<p>I'm trying to select a number from a string. The number can be between 5 and 10 characters long. For example, I have two job numbers to extract from a string.</p>\n\n<pre><code>\"job number:45678 date:01/01/16\"     # =&gt; jobnumber = \"45678\"\n\"job number:123421312 date:03/03/16\" # =&gt; jobnumber = \"123421312\"\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 13, "user_id": 6452234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rf6j1.jpg?s=128&g=1", "display_name": "Clueless", "link": "https://stackoverflow.com/users/6452234/clueless"}, "edited": false, "score": 1, "creation_date": 1465949762, "post_id": 37824170, "comment_id": 63111536, "body": "If after solving for this for me if you could find a way to make it not look so crude and repetitive, thanks."}, {"owner": {"reputation": 2172, "user_id": 4412925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7fa1503a3820659b27943c99d463a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel", "link": "https://stackoverflow.com/users/4412925/nabeel"}, "edited": false, "score": 0, "creation_date": 1465951322, "post_id": 37824170, "comment_id": 63111932, "body": "I would really advise following a tutorial on how to get started, a similar post  can be found at <a href=\"http://stackoverflow.com/questions/20850598/programming-a-basic-calculator-in-ruby\" title=\"programming a basic calculator in ruby\">stackoverflow.com/questions/20850598/&hellip;</a>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1465955092, "post_id": 37824170, "comment_id": 63112686, "body": "This seems not that far off. Try using <code>gets.chomp</code> instead of just <code>gets</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6452234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rf6j1.jpg?s=128&g=1", "display_name": "Clueless", "link": "https://stackoverflow.com/users/6452234/clueless"}, "edited": false, "score": 0, "creation_date": 1465957943, "post_id": 37825071, "comment_id": 63113334, "body": "Yeah this is what I was looking for. I completely passed over the case option but I&#39;m still wondering why my if statement didn&#39;t go through if you could answer that."}, {"owner": {"reputation": 1703, "user_id": 990996, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/x7qId.png?s=128&g=1", "display_name": "kenshinji", "link": "https://stackoverflow.com/users/990996/kenshinji"}, "reply_to_user": {"reputation": 13, "user_id": 6452234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rf6j1.jpg?s=128&g=1", "display_name": "Clueless", "link": "https://stackoverflow.com/users/6452234/clueless"}, "edited": false, "score": 0, "creation_date": 1465958595, "post_id": 37825071, "comment_id": 63113479, "body": "@Clueless I think that&#39;s why you should use <code>gets.chomp</code> instead of <code>gets</code>, and you can check the answer from <a href=\"http://stackoverflow.com/questions/22166108/difference-between-gets-gets-chomp-and-gets-chomp\">here</a>"}], "tags": [], "owner": {"reputation": 1703, "user_id": 990996, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/x7qId.png?s=128&g=1", "display_name": "kenshinji", "link": "https://stackoverflow.com/users/990996/kenshinji"}, "is_accepted": true, "score": 0, "last_activity_date": 1465957398, "creation_date": 1465957398, "answer_id": 37825071, "question_id": 37824170, "link": "https://stackoverflow.com/questions/37824170/how-do-i-make-this-calculator-work/37825071#37825071", "title": "How do I make this calculator work?", "body": "<p>Is this what you want?</p>\n\n<pre><code>puts \"Welcome to My Calculator! \"  \n\nprint \"Please place in the numbers. \"  \n\nfirst_number = gets.to_i  \n\nprint \"Second number. \"  \n\nsecond_number = gets.to_i  \n\n\nputs \"What operation? \"  \n\noperation_selection = gets.chomp.downcase.to_s  \n\ndef oper(operation_sel, first_number,second_number)\n    case operation_sel\n        when \"add\"\n            puts first_number + second_number\n        when \"sub\"\n            puts first_number - second_number\n        when \"div\"\n            puts first_number / second_number\n        when \"mul\"\n            puts first_number * second_number\n        end\nend\n\noper(operation_selection,first_number,second_number)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6452234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rf6j1.jpg?s=128&g=1", "display_name": "Clueless", "link": "https://stackoverflow.com/users/6452234/clueless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 37825071, "answer_count": 1, "score": -2, "last_activity_date": 1465957398, "creation_date": 1465949739, "last_edit_date": 1465951118, "question_id": 37824170, "link": "https://stackoverflow.com/questions/37824170/how-do-i-make-this-calculator-work", "title": "How do I make this calculator work?", "body": "<p>I just wanted to work on one method then replicate it to the rest. which is why one method is really only done. (kinda)</p>\n\n<pre><code>puts \"Welcome to My Calculator! \"  \n\nprint \"Please place in the numbers. \"  \n\nfirst_number = gets.to_i  \n\nprint \"Second number. \"  \n\nsecond_number = gets.to_i  \n\n\nputs \"What operation? \"  \n\noperation_selection = gets  \n\nif(operation_selection == \"add\")  \n\n  addition_function  \n\n  puts\"#{result}\"\n\nend  \n\n\ndef addition_function\n result = first_number + second_number\n\nend\n\ndef subtraction_function\n  result = first_number - second_number\n\nend\n\ndef divison_function\n   result = first_number / second_number\n\nend\n\ndef multiplication_function\n  result = first_number * second_number\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "answers": [{"comments": [{"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1465956865, "post_id": 37824020, "comment_id": 63113097, "body": "<a href=\"http://rubyofftherails.blogspot.com.br/2016/02/i-want-to-use-heroku-but-my-app-uses.html\" rel=\"nofollow noreferrer\">rubyofftherails.blogspot.com.br/2016/02/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4435, "user_id": 2581266, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/100001828256469/picture?type=large", "display_name": "Papouche Guinslyzinho", "link": "https://stackoverflow.com/users/2581266/papouche-guinslyzinho"}, "is_accepted": false, "score": 1, "last_activity_date": 1465968914, "last_edit_date": 1465968914, "creation_date": 1465948562, "answer_id": 37824020, "question_id": 37823875, "link": "https://stackoverflow.com/questions/37823875/trouble-generating-new-rails-controller/37824020#37824020", "title": "trouble generating new rails controller", "body": "<p>you cold try to <code>rm Gemfile.lock</code> and <code>bundle install</code> to reinstall your gems</p>\n\n<p>Also make sure that the <code>sqlite3</code> gem is in the <code>development</code> group</p>\n\n<pre><code>gem 'sqlite3', :group =&gt; :development\n</code></pre>\n\n<p>So that it will not be install on Heroku</p>\n"}, {"comments": [{"owner": {"reputation": 82, "user_id": 6466923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e1c9fcdaa5b7ace45a9378f81a62ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher L.Nash", "link": "https://stackoverflow.com/users/6466923/christopher-l-nash"}, "edited": false, "score": 1, "creation_date": 1465949926, "post_id": 37824054, "comment_id": 63111572, "body": "I am using that book. Thank you very much for your help!"}], "tags": [], "owner": {"reputation": 12345, "user_id": 429758, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ff984622cd3a9ca31bd0e7e034fc8b17?s=128&d=identicon&r=PG", "display_name": "Prakash Murthy", "link": "https://stackoverflow.com/users/429758/prakash-murthy"}, "is_accepted": true, "score": 1, "last_activity_date": 1465948778, "creation_date": 1465948778, "answer_id": 37824054, "question_id": 37823875, "link": "https://stackoverflow.com/questions/37823875/trouble-generating-new-rails-controller/37824054#37824054", "title": "trouble generating new rails controller", "body": "<p>The error is because the <code>config/database.yml</code> file still has <code>sqlite3</code> as the database adapter for the development database. </p>\n\n<p>If you know which database you want to use for your local development database, set the appropriate database adapter in this file.</p>\n\n<p>Heroku can't use <code>sqlite3</code>; however, you can use <code>sqlite3</code> for your local development database, and specify <code>postgres</code> or <code>mysql</code> for production database. </p>\n\n<p>Since you are a total beginner, I would recommend following the steps from a detailed tutorial as it is till you become familiar with the various concepts. <a href=\"https://www.railstutorial.org/book\" rel=\"nofollow\">Michael Hart's Rails Tutorial book</a> is available for free online, and is a very good resource for beginner rails developers.</p>\n"}], "owner": {"reputation": 82, "user_id": 6466923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e1c9fcdaa5b7ace45a9378f81a62ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher L.Nash", "link": "https://stackoverflow.com/users/6466923/christopher-l-nash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 37824054, "answer_count": 2, "score": 1, "last_activity_date": 1465968914, "creation_date": 1465947524, "last_edit_date": 1465948439, "question_id": 37823875, "link": "https://stackoverflow.com/questions/37823875/trouble-generating-new-rails-controller", "title": "trouble generating new rails controller", "body": "<p>I am new to ruby on rails development. I am currently having difficulties generating a new rails controller. here is what I input into the terminal: </p>\n\n<pre><code>$ rails generate controller static_pages home help\n</code></pre>\n\n<p>here is the response I receive:</p>\n\n<pre><code>/usr/local/rvm/gems/ruby-2.3.0/gems/activerecord-4.2.5/lib/active_record/connection_adapters/connection_specification.rb:177\n:in `rescue in spec': Specified 'sqlite3' for database adapter, but the gem is not loaded. \nAdd `gem 'sqlite3'` to your Gemfile (and ensure its version is at the minimum required by ActiveRecord). (Gem::LoadError)\n</code></pre>\n\n<p>I am also using Heroku for production so I initially removed sqlite3 because Heroku cant use it by doing:</p>\n\n<pre><code>$ gem uninstall sqlite3\n</code></pre>\n\n<p>and I removed it from my gemfile and gemfile.lock. Was this a mistake? Any guidance would be much appreciated.</p>\n"}, {"tags": ["ruby", "cucumber", "automated-tests"], "answers": [{"comments": [{"owner": {"reputation": 1126, "user_id": 4927393, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-7rRm-826oe4/AAAAAAAAAAI/AAAAAAAAIQ8/jBtS640nEeU/photo.jpg?sz=128", "display_name": "Dragan Nikolic", "link": "https://stackoverflow.com/users/4927393/dragan-nikolic"}, "edited": false, "score": 3, "creation_date": 1466011331, "post_id": 37826384, "comment_id": 63144550, "body": "Yes, it works, thanks. I also noticed that if I change &#39;step&#39; to &#39;steps&#39; that works too.  So <b>step %{xxx the calcualtor is run xxx}</b> or <b>step &quot;xxx the calculator is run xxx&quot;</b> or <b>steps %{When xxx the calcualtor is run xxx}</b> all work, but one I used does not."}, {"owner": {"reputation": 3565, "user_id": 2363935, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/273081c71f1516ee881f74fd63b07502?s=128&d=identicon&r=PG", "display_name": "kross", "link": "https://stackoverflow.com/users/2363935/kross"}, "edited": false, "score": 1, "creation_date": 1518288452, "post_id": 37826384, "comment_id": 84447514, "body": "Thanks - I found if you use <code>steps</code> for dynamic table steps, you also <i>happen</i> to need a <code>When&#47;And&#47;Then</code> prefix."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 13, "last_activity_date": 1465966226, "creation_date": 1465966226, "answer_id": 37826384, "question_id": 37823874, "link": "https://stackoverflow.com/questions/37823874/why-do-i-get-undefined-dynamic-step-in-cucumber/37826384#37826384", "title": "Why do I get &#39;Undefined dynamic step&#39; in Cucumber?", "body": "<p>In this line:</p>\n\n<pre><code>  step %{When xxx the calculator is run xxx}\n</code></pre>\n\n<p>Remove the \"When\" and it should work correctly.</p>\n\n<p>You can check this in the <a href=\"https://www.relishapp.com/cucumber/cucumber/docs/defining-steps/nested-steps\" rel=\"noreferrer\">cucumber docs</a>. The <code>step</code> example they give doesn't include the word \"When\".</p>\n"}], "owner": {"reputation": 1126, "user_id": 4927393, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-7rRm-826oe4/AAAAAAAAAAI/AAAAAAAAIQ8/jBtS640nEeU/photo.jpg?sz=128", "display_name": "Dragan Nikolic", "link": "https://stackoverflow.com/users/4927393/dragan-nikolic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2677, "favorite_count": 0, "accepted_answer_id": 37826384, "answer_count": 1, "score": 3, "last_activity_date": 1466001943, "creation_date": 1465947513, "last_edit_date": 1466001943, "question_id": 37823874, "link": "https://stackoverflow.com/questions/37823874/why-do-i-get-undefined-dynamic-step-in-cucumber", "title": "Why do I get &#39;Undefined dynamic step&#39; in Cucumber?", "body": "<p>I have following step definitions (just to illustrate my problem):</p>\n\n<pre><code>When(/^the calculator is run$/) do\n  step %{When xxx the calculator is run xxx}\nend\n\nWhen(/^xxx the calculator is run xxx$/) do\n  @output = `ruby calc.rb #{@input}` \n  raise('Command failed!') unless $?.success?\nend\n</code></pre>\n\n<p>In my feature file, when I call:</p>\n\n<pre><code>When the calculator is run\n</code></pre>\n\n<p>I got the error message:</p>\n\n<pre><code>Undefined dynamic step: \"When xxx the calculator is run xxx\" (Cucumber::UndefinedDynamicStep)\n./features/step_definitions/calculator_steps_when.rb:2:in `/^the calculator is run$/'\nfeatures/adding.feature:11:in `When the calculator is run'\nfeatures/adding.feature:6:in `When the calculator is run'\n</code></pre>\n\n<p>According to the documentation this should work. Initially I had the steps in different files, and thought maybe I had to provide some include directive, but now it happens even when steps are in the same file. What am I missing?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "tcpserver"], "comments": [{"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1465945469, "post_id": 37823161, "comment_id": 63110476, "body": "Are you sure when you make the change it starts working <i>in your browser</i>? You\u2019re not sending back a valid HTTP response, which would explain the \u201cFailed to load response data\u201d error, and adding that extra line doesn\u2019t turn it into a valid response. Are you looking at the response directly with something like Telnet?"}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1465945980, "post_id": 37823161, "comment_id": 63110631, "body": "I&#39;ll try that, @matt. But as far as I know, one may send ANY response with puts and it will be written to the client, in this case the browser. There are examples here at SO where one just wrote <code>puts &quot;#{Date.now}&quot;</code> with no headers and it worked. I tried something like this myself, sending back just the &quot;Test&quot; word and it worked fine."}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1465946734, "post_id": 37823161, "comment_id": 63110847, "body": "I tried it and got just &quot;Test&quot; from the Telnet, since it just don&#39;t send a message header. This is perfectly fine, but does not explain this behavior when the message header is sent."}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 1, "creation_date": 1465948597, "post_id": 37823161, "comment_id": 63111277, "body": "You\u2019re right \u2013 it looks like the browser will just display the response contents if it detects it\u2019s not valid HTTP. I wouldn\u2019t have expected that! I suspect that in your first case the browser initially thinks it\u2019s looking at a valid response (possibly due to the http at the start), but is unable to parse it so errors out. In the second case it knows right away that it isn\u2019t dealing with a normal response so just displays the result."}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 1, "creation_date": 1465948622, "post_id": 37823161, "comment_id": 63111279, "body": "It\u2019s not obvious what the criteria for detecting a valid response are, and it seems to vary across browsers. Firefox and Safari both display your first example OK. In Chrome, adding <code>Test</code> results in everything being shown, but just adding <code>Tes</code> still gives the error."}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 1, "creation_date": 1465948691, "post_id": 37823161, "comment_id": 63111293, "body": "(Sorry \u2013 I reworded one of my comments slightly, and needed to delete and recreate them to do so, which crossed with one of your comments, so things might look a bit out of order)."}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1465948865, "post_id": 37823161, "comment_id": 63111325, "body": "No problem. I&#39;ll try that!"}], "owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465943252, "creation_date": 1465943252, "question_id": 37823161, "link": "https://stackoverflow.com/questions/37823161/ruby-tcpserver-strange-behavior-in-writing-to-client", "title": "Ruby TCPServer strange behavior in writing to client", "body": "<p>I'm creating a Ruby gem named EmeraldCutter which is, essentially, a very simple TCP server. It happens that I detected a very strange behavior and I'd be very glad if someone could give me some clue about this.</p>\n\n<p>As you may see by the code below, it starts a new Thread for each request received, grabs the message sent to the server, separate its parameters and stores them in a hash and then writes to the client a list with the elements of this hash in a list of the form</p>\n\n<pre><code>key =&gt; parameter\n</code></pre>\n\n<p>Then when I run this server and navigate to <code>http://localhost:4321/something</code> my browser should receive something like </p>\n\n<pre><code>http_verb =&gt; GET\nquery_string =&gt; /something\nhttp_version =&gt; HTTP/1.1\nhost =&gt; localhost:4321\nconnection =&gt; keep-alive\ncache_control =&gt; max-age=0\naccept =&gt; text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nupgrade_insecure_requests =&gt; 1\nuser_agent =&gt; Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36\ndnt =&gt; 1\naccept_encoding =&gt; gzip, deflate, sdch\naccept_language =&gt; pt-BR,pt;q=0.8,en-US;q=0.6,en;q=0.4,fr-CA;q=0.2,fr;q=0.2\n</code></pre>\n\n<p>but nothing is displayed and when I visit the Network tab at the developer's console to examine this request, I see a message saying <code>Failed to load response data</code>.</p>\n\n<p>Here is my code:</p>\n\n<p><strong>lib/emerald.rb</strong></p>\n\n<pre><code>require \"emeraldcutter/auxiliary\"\nrequire \"emeraldcutter/version\"\n\nmodule EmeraldCutter\n\n  def self.start\n    require 'socket'\n\n    server = TCPServer.new 4321\n    loop do \n      Thread.start(server.accept) do |client|\n        message = client.recvmsg[0]\n        request = get_request_parameters(message)\n        request.each{ |k,v| client.puts \"#{k} =&gt; #{v}\" }\n        client.close\n      end\n    end\n  end\n\n  private\n\n  def self.http_verb(msg_token)\n    msg_token.split(' ')[0]\n  end\n\n  def self.http_protocol(msg_token)\n    msg_token.split(' ')[2]\n  end\n\n  def self.query_string(msg_token)\n    msg_token.split(' ')[1]\n  end\n\n  def self.get_request_parameters(message)\n    result = Hash.new\n    lines = message.split(\"\\n\");\n    first_line = lines.shift\n    result['http_verb'] = http_verb(first_line)\n    result['query_string'] = query_string(first_line)\n    result['http_version'] = http_protocol(first_line)\n    lines.each{ |line|\n      key_value = line.split(': ')\n      key = EmeraldCutter::Auxiliary.normalize_hash_key(key_value[0].strip)\n      result[key] = key_value[1].strip if not key.empty?\n    }\n    result\n  end\n\nend\n</code></pre>\n\n<p><strong>lib/emeraldcutter/auxiliary.rb</strong></p>\n\n<pre><code>module EmeraldCutter\n  module Auxiliary\n\n    def self.normalize_hash_key(key)\n      key.downcase.tr('-','_')\n    end\n\n  end\nend\n</code></pre>\n\n<p>This wouldn't be so strange. But things get really weird when I add <code>client.puts \"Teste\"</code> to the Thread block like this</p>\n\n<pre><code>    server = TCPServer.new 4321\n    loop do \n      Thread.start(server.accept) do |client|\n        client.puts \"Test\"\n        message = client.recvmsg[0]\n        request = get_request_parameters(message)\n        request.each{ |k,v| client.puts \"#{k} =&gt; #{v}\" }\n        client.close\n      end\n    end\n  end\n</code></pre>\n\n<p>and then it works perfectly well and I get</p>\n\n<pre><code>Test\nhttp_verb =&gt; GET\nquery_string =&gt; /something\nhttp_version =&gt; HTTP/1.1\nhost =&gt; localhost:4321\nconnection =&gt; keep-alive\ncache_control =&gt; max-age=0\naccept =&gt; text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nupgrade_insecure_requests =&gt; 1\nuser_agent =&gt; Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36\ndnt =&gt; 1\naccept_encoding =&gt; gzip, deflate, sdch\naccept_language =&gt; pt-BR,pt;q=0.8,en-US;q=0.6,en;q=0.4,fr-CA;q=0.2,fr;q=0.2\n</code></pre>\n\n<p>Have you ever seen something like this? If so, what is the reason?</p>\n"}, {"tags": ["ruby", "methods"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1465941205, "post_id": 37822711, "comment_id": 63109150, "body": "Can you include some description of what this method is supposed to do, and what you mean by &quot;make better use of&quot;?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1465942939, "post_id": 37822711, "comment_id": 63109766, "body": "Welcome to Stack Overflow. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; with its linked pages. Please don&#39;t use a link to an image (or to another site) for information that is essential to your question; Links rot then break, making your question worthless to those in the future searching for similar solutions."}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 2, "last_activity_date": 1465956830, "creation_date": 1465956830, "answer_id": 37824997, "question_id": 37822711, "link": "https://stackoverflow.com/questions/37822711/how-can-i-shrink-and-make-a-better-use-of-this-method-ruby-raw/37824997#37824997", "title": "How can I shrink and make a better use of this method? - RUBY (raw)", "body": "<p>Take a look at <a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-i-dig\" rel=\"nofollow\"><code>Hash#dig</code></a> which is included in Ruby versions <code>2.3.0</code> or newer.</p>\n\n<p>To summarize:</p>\n\n<pre><code>hash_1 = { a: { a: { a: \"b\" } } }\nhash_2 = { c: { c: { c: \"d\" } } }\nhash_1.dig(:a, :a, :a) # returns \"b\"\nhash_2.dig(:a, :a, :a) # returns nil\n</code></pre>\n\n<p>So you could say <code>if hash_1.dig(:a, :a)</code> instead of</p>\n\n<pre><code>if hash_1[:a]\n  if hash_1[:a][:a]\n    # etc\n</code></pre>\n\n<p>There's also another way to do it, which is to rescue your <code>NoMethod []</code> errors.</p>\n\n<p>Here's an example of that:</p>\n\n<pre><code>if hash_1[:a][:a][:a] rescue false\n   puts \"the key exists\"\nelse\n   puts \"the key doesnt exist\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "is_accepted": false, "score": 0, "last_activity_date": 1465984495, "creation_date": 1465984495, "answer_id": 37832028, "question_id": 37822711, "link": "https://stackoverflow.com/questions/37822711/how-can-i-shrink-and-make-a-better-use-of-this-method-ruby-raw/37832028#37832028", "title": "How can I shrink and make a better use of this method? - RUBY (raw)", "body": "<p>You can use some recursive call</p>\n\n<p><strong>Input data</strong></p>\n\n<pre><code>stored_data = {}\nname = 'COLORADO'\nrace = 3\nyear = 2008\ntitle = :math\npercentage = 0.697\n</code></pre>\n\n<p><strong>Methods</strong></p>\n\n<pre><code>def proficiency_parser(stored_data, name, race, year, title, percentage)\n  parser(stored_data, name, {race =&gt; {year =&gt; {title =&gt; percentage}}})\nend\n\ndef parser(data, key, value)\n  data[key] ? value.each { |k, v| parser(data[key], k, v) } : data[key] = value\nend\n</code></pre>\n\n<p><strong>call</strong></p>\n\n<pre><code>proficiency_parser(stored_data, name, race, year, title, percentage)\n\np stored_data\n# =&gt; {\"COLORADO\"=&gt;{3=&gt;{2008=&gt;{:math=&gt;0.697}}}}\n</code></pre>\n\n<p>I hope this helps</p>\n"}], "owner": {"reputation": 9, "user_id": 6365641, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209584437391821/picture?type=large", "display_name": "Raphael Barbo", "link": "https://stackoverflow.com/users/6365641/raphael-barbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1465989152, "creation_date": 1465941116, "last_edit_date": 1465989152, "question_id": 37822711, "link": "https://stackoverflow.com/questions/37822711/how-can-i-shrink-and-make-a-better-use-of-this-method-ruby-raw", "title": "How can I shrink and make a better use of this method? - RUBY (raw)", "body": "<p><a href=\"http://i.stack.imgur.com/22W5X.png\" rel=\"nofollow\">Working on a project and trying to turn this method (I Have some more similar methods like that in my project) into a more dynamic and concise way </a></p>\n\n<p><strong>Data from image</strong></p>\n\n<pre><code>def proficiency_parser(stored_data, name, race, year, title, percentage)\n  if stored_data.has_key?(name)\n    if stored_data[name].has_key?(race)\n      if stored_data[name][race].has_key?(year)\n        stored_data[name][race][year][title] = percentage\n      else\n        stored_data[name][race][year] = {title =&gt; percentage}\n      end\n    else\n      stored_data[name][race] = {year =&gt; {title =&gt; percentage}}\n    end\n  else\n    stored_data[name] = {race =&gt; {year =&gt; {title =&gt; percentage}}}\n  end\nend\n</code></pre>\n\n<p>so essentially this method through my data to identify whether it meets so of those specification showing in the code, essentially I just don't want to use this amount of \"elses\" and \"Ifs\" if at all possible.</p>\n\n<p><strong>Data</strong></p>\n\n<pre><code>stored_data\n# =&gt; {\"COLORADO\"=&gt;{3=&gt;{2008=&gt;{:math=&gt;0.697}}}}\nname\n# =&gt; \"COLORADO\"\nrace\n# =&gt; 3\nyear\n# =&gt; 2008\ntitle\n# =&gt; :math\npercentage\n# =&gt; 0.697\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1465941301, "post_id": 37822618, "comment_id": 63109187, "body": "are you sure ENV[&#39;USERNAME&#39;] and ENV[&#39;PASSWORD&#39;] is set?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5664181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9hVKDU03TWY/AAAAAAAAAAI/AAAAAAAAAAA/AzQBZmOJfU4/photo.jpg?sz=128", "display_name": "harim kim", "link": "https://stackoverflow.com/users/5664181/harim-kim"}, "is_accepted": false, "score": 1, "last_activity_date": 1472784007, "creation_date": 1472784007, "answer_id": 39283548, "question_id": 37822618, "link": "https://stackoverflow.com/questions/37822618/rake-abortedpgconnectionbad-fe-sendauth-no-password-supplied/39283548#39283548", "title": "rake aborted:PG::ConnectionBad: fe_sendauth: no password supplied", "body": "<p>It seems like Cloud9 issue. I refer <a href=\"https://community.c9.io/t/fe-sendauth-no-password-supplied-error-after-setting-up-postgrsql-on-rails/2206/2\" rel=\"nofollow\">https://community.c9.io/t/fe-sendauth-no-password-supplied-error-after-setting-up-postgrsql-on-rails/2206/2</a></p>\n\n<p>Run below commands on your c9 terminal.</p>\n\n<pre><code>$ source ~/.profile\n$ rake db:create\n$ rake db:migrate\n</code></pre>\n\n<p>It works for me.</p>\n"}], "owner": {"reputation": 454, "user_id": 6117695, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/a7838a79af51040b784f9997eac63256?s=128&d=identicon&r=PG&f=1", "display_name": "Marko I.", "link": "https://stackoverflow.com/users/6117695/marko-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472784007, "creation_date": 1465940596, "question_id": 37822618, "link": "https://stackoverflow.com/questions/37822618/rake-abortedpgconnectionbad-fe-sendauth-no-password-supplied", "title": "rake aborted:PG::ConnectionBad: fe_sendauth: no password supplied", "body": "<p>I'm on Cloud9 Ubuntu Template and I installed postgres. I'm getting an error when I try to do a \"rake db:migrate\".</p>\n\n<pre><code>rake aborted:PG::ConnectionBad: fe_sendauth: no password supplied\n</code></pre>\n\n<p>Related settings in my database.yml file</p>\n\n<pre><code>default: &amp;default\n      adapter: postgresql\n      encoding: unicode\n      pool: 5\n      username: &lt;%= ENV['USERNAME'] %&gt;\n      password: &lt;%= ENV['PASSWORD'] %&gt;\n      host:     &lt;%= ENV['IP'] %&gt;\n\ndevelopment:\n  &lt;&lt;: *default\n  database: app_development\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "mariadb", "mysql2", "ubuntu-16.04"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1465941088, "post_id": 37822546, "comment_id": 63109105, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/5795309/gem-install-mysql-fail\">gem install mysql fail</a>"}, {"owner": {"reputation": 7557, "user_id": 2577852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29383b0cb31502717af693fa45df0e62?s=128&d=identicon&r=PG", "display_name": "Michael Gaskill", "link": "https://stackoverflow.com/users/2577852/michael-gaskill"}, "edited": false, "score": 0, "creation_date": 1465946860, "post_id": 37822546, "comment_id": 63110881, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/29317640/gem-install-rails-fails-on-ubuntu\">gem install rails fails on ubuntu</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6466654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c12303380e3667865948338a133d8704?s=128&d=identicon&r=PG&f=1", "display_name": "Necro_KOT", "link": "https://stackoverflow.com/users/6466654/necro-kot"}, "is_accepted": true, "score": 1, "last_activity_date": 1466255092, "creation_date": 1466255092, "answer_id": 37897283, "question_id": 37822546, "link": "https://stackoverflow.com/questions/37822546/not-able-to-install-gems-mysql2-mariadb-10-1-in-ubuntu-16-04-xenial/37897283#37897283", "title": "Not able to install gems &quot;mysql2, mariadb 10.1&quot; in Ubuntu 16.04 Xenial", "body": "<p>Gem in this situation need 3 packets.</p>\n\n<pre><code>sudo apt-get install libnetcdf-dev libssl-dev libcrypto++-dev\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9567, "user_id": 1900722, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nGsJr.jpg?s=128&g=1", "display_name": "anquegi", "link": "https://stackoverflow.com/users/1900722/anquegi"}, "is_accepted": false, "score": 0, "last_activity_date": 1512318092, "creation_date": 1512318092, "answer_id": 47620446, "question_id": 37822546, "link": "https://stackoverflow.com/questions/37822546/not-able-to-install-gems-mysql2-mariadb-10-1-in-ubuntu-16-04-xenial/47620446#47620446", "title": "Not able to install gems &quot;mysql2, mariadb 10.1&quot; in Ubuntu 16.04 Xenial", "body": "<p>This is for mac but you need to change the path:</p>\n\n<pre><code>gem uninstall mysql2\n</code></pre>\n\n<p>intall mariadb 10.1 andnecesaary ssl packages or maybe this are not needed\nthen check the path to the libraries and the tinal folders have the same name:</p>\n\n<pre><code>bundle config --local build.mysql2 \"--with-mysql-config=/usr/local/Cellar/mariadb@10.1/10.1.29/bin/mysql_config --with-ldflags=-L/usr/local/opt/openssl/lib --with-cppflags=-I/usr/local/opt/openssl/include\"\n</code></pre>\n\n<p>or without the ssl path</p>\n\n<pre><code>bundle config --local build.mysql2 \"--with-mysql-config=/usr/local/Cellar/mariadb@10.1/10.1.29/bin/mysql_config\n</code></pre>\n\n<p>or directly the gem, but if you come ffrom mysql is better to do it with bundle</p>\n\n<pre><code>gem install mysql2 -v 'x.y.z' -- --with-mysql-config=/usr/local/Cellar/mariadb@10.1/10.1.29/bin/mysql_config\n</code></pre>\n\n<p>and finally</p>\n\n<pre><code>bundle install\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6466654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c12303380e3667865948338a133d8704?s=128&d=identicon&r=PG&f=1", "display_name": "Necro_KOT", "link": "https://stackoverflow.com/users/6466654/necro-kot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2178, "favorite_count": 0, "accepted_answer_id": 37897283, "answer_count": 2, "score": 0, "last_activity_date": 1512318092, "creation_date": 1465940240, "last_edit_date": 1465948372, "question_id": 37822546, "link": "https://stackoverflow.com/questions/37822546/not-able-to-install-gems-mysql2-mariadb-10-1-in-ubuntu-16-04-xenial", "title": "Not able to install gems &quot;mysql2, mariadb 10.1&quot; in Ubuntu 16.04 Xenial", "body": "<p>I have working mariadb 10.1 server.\nI install ruby 2.3.0 on ubuntu 16.04.\nI install libmariadbd-dev and libmariadbclient-dev.\nWhen I try \"gem install mysql2\", then a recive message:</p>\n\n<pre><code>Building native extensions with: '--with-mysql-dir=/usr/local/mysql'\nThis could take a while...\nERROR:  Error installing mysql2:\n        ERROR: Failed to build gem native extension.\n\n    current directory: /var/lib/gems/2.3.0/gems/mysql2-0.4.4/ext/mysql2\n/usr/bin/ruby2.3 -r ./siteconf20160615-5183-kj9yds.rb extconf.rb --with-mysql-dir=/usr/local/mysql\nchecking for ruby/thread.h... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=/usr/bin/$(RUBY_BASE_NAME)2.3\n/usr/lib/ruby/2.3.0/mkmf.rb:456:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n        from /usr/lib/ruby/2.3.0/mkmf.rb:587:in `try_cpp'\n        from /usr/lib/ruby/2.3.0/mkmf.rb:1091:in `block in have_header'\n        from /usr/lib/ruby/2.3.0/mkmf.rb:942:in `block in checking_for'\n        from /usr/lib/ruby/2.3.0/mkmf.rb:350:in `block (2 levels) in postpone'\n        from /usr/lib/ruby/2.3.0/mkmf.rb:320:in `open'\n        from /usr/lib/ruby/2.3.0/mkmf.rb:350:in `block in postpone'\n        from /usr/lib/ruby/2.3.0/mkmf.rb:320:in `open'\n        from /usr/lib/ruby/2.3.0/mkmf.rb:346:in `postpone'\n        from /usr/lib/ruby/2.3.0/mkmf.rb:941:in `checking_for'\n        from /usr/lib/ruby/2.3.0/mkmf.rb:1090:in `have_header'\n        from extconf.rb:16:in `&lt;main&gt;'\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /var/lib/gems/2.3.0/extensions/x86_64-linux/2.3.0/mysql2-0.4.4/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /var/lib/gems/2.3.0/gems/mysql2-0.4.4 for inspection.\nResults logged to /var/lib/gems/2.3.0/extensions/x86_64-linux/2.3.0/mysql2-0.4.4/gem_make.out\n</code></pre>\n\n<p>And I can`t find how to build this gem.</p>\n"}, {"tags": ["ruby", "json"], "comments": [{"owner": {"reputation": 5130, "user_id": 1443478, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4J9cr.jpg?s=128&g=1", "display_name": "Brennan", "link": "https://stackoverflow.com/users/1443478/brennan"}, "edited": false, "score": 0, "creation_date": 1465938810, "post_id": 37822006, "comment_id": 63108125, "body": "Is the <code>puts</code> string a typo?"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 2766914, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cef028c07b05ce3b6705e412182086e?s=128&d=identicon&r=PG&f=1", "display_name": "user28374", "link": "https://stackoverflow.com/users/2766914/user28374"}, "edited": false, "score": 0, "creation_date": 1465939896, "post_id": 37822248, "comment_id": 63108603, "body": "Excellent, that works very nicely! Thank you for that, I&#39;ve been poking at it for an hour or so now."}], "tags": [], "owner": {"reputation": 5130, "user_id": 1443478, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4J9cr.jpg?s=128&g=1", "display_name": "Brennan", "link": "https://stackoverflow.com/users/1443478/brennan"}, "is_accepted": true, "score": 2, "last_activity_date": 1465938960, "creation_date": 1465938960, "answer_id": 37822248, "question_id": 37822006, "link": "https://stackoverflow.com/questions/37822006/how-to-find-and-store-all-elements-of-a-json-array-that-have-a-certain-key-value/37822248#37822248", "title": "How to find and store all elements of a JSON array that have a certain key value pair", "body": "<p>Look at the <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-find\" rel=\"nofollow\">documentation</a> for the <code>find</code> method:</p>\n\n<blockquote>\n  <p>Passes each entry in enum to block. Returns the first for which block\n  is not false.</p>\n</blockquote>\n\n<p>Find will only return one entry. </p>\n\n<p>You want to use something like <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-select\" rel=\"nofollow\"><code>select</code></a> instead and then map to get the order number:</p>\n\n<pre><code>processing_orders = all_orders[\"orders\"].select{ |h| h['status'] == 'processing'    }.map{|order| order['order_number']}\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 2766914, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cef028c07b05ce3b6705e412182086e?s=128&d=identicon&r=PG&f=1", "display_name": "user28374", "link": "https://stackoverflow.com/users/2766914/user28374"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1212, "favorite_count": 0, "accepted_answer_id": 37822248, "answer_count": 1, "score": 0, "last_activity_date": 1465940977, "creation_date": 1465938049, "last_edit_date": 1465940977, "question_id": 37822006, "link": "https://stackoverflow.com/questions/37822006/how-to-find-and-store-all-elements-of-a-json-array-that-have-a-certain-key-value", "title": "How to find and store all elements of a JSON array that have a certain key value pair", "body": "<p>I am trying to parse JSON and extract some values to display.</p>\n\n<p>The JSON format is:</p>\n\n<pre><code> {\n \"orders\": [\n {\n ...\n\"order_number\": 12345,\n\"status\" : \"processing\",\n...\n</code></pre>\n\n<p>I have this sample response in JSON parsed in <code>all_orders</code>:</p>\n\n<pre><code>response = http.request(request)\nall_orders = JSON.parse(response.body)\n\n# Checking for 'processing' orders...\nprocessing_orders = all_orders[\"orders\"].find{ |h| h['status'] == 'processing'    }['order_number']\n</code></pre>\n\n<p>I want to display the matching <code>order_numbers</code> that have the status of 'processing', however when I enter:</p>\n\n<pre><code>puts \"processing_orders\"\n</code></pre>\n\n<p>it is only printing one value, when I know for certain that there are more.</p>\n\n<p>Is there something I am doing wrong? I am fairly new to working with this and have tried my best to try solutions on my own.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "carrierwave"], "answers": [{"comments": [{"owner": {"reputation": 3538, "user_id": 693491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f30193798802607aa97082c4529fcc28?s=128&d=identicon&r=PG", "display_name": "Tyler Ferraro", "link": "https://stackoverflow.com/users/693491/tyler-ferraro"}, "edited": false, "score": 0, "creation_date": 1465941054, "post_id": 37822672, "comment_id": 63109088, "body": "Wouldn&#39;t it be <code>model.gender.downcase</code>? I believe that the Uploaded accesses it&#39;s calling record with the <code>model</code> method."}, {"owner": {"reputation": 11638, "user_id": 461294, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EQqHn.jpg?s=128&g=1", "display_name": "vich", "link": "https://stackoverflow.com/users/461294/vich"}, "reply_to_user": {"reputation": 3538, "user_id": 693491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f30193798802607aa97082c4529fcc28?s=128&d=identicon&r=PG", "display_name": "Tyler Ferraro", "link": "https://stackoverflow.com/users/693491/tyler-ferraro"}, "edited": false, "score": 0, "creation_date": 1465941148, "post_id": 37822672, "comment_id": 63109131, "body": "The <code>gender</code> argument passed into the <code>default_url</code> method is a string. I&#39;m not passing the user object, just the value of <code>gender</code>."}, {"owner": {"reputation": 3538, "user_id": 693491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f30193798802607aa97082c4529fcc28?s=128&d=identicon&r=PG", "display_name": "Tyler Ferraro", "link": "https://stackoverflow.com/users/693491/tyler-ferraro"}, "edited": false, "score": 0, "creation_date": 1465941349, "post_id": 37822672, "comment_id": 63109202, "body": "Ah right, now I see it. I like this answer, it&#39;s clean and succinct."}, {"owner": {"reputation": 849, "user_id": 3760584, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/100007767492662/picture?type=large", "display_name": "Alaa Othman", "link": "https://stackoverflow.com/users/3760584/alaa-othman"}, "edited": false, "score": 0, "creation_date": 1465941488, "post_id": 37822672, "comment_id": 63109257, "body": "image_uploader.rb is a class not a module, see the edit please."}, {"owner": {"reputation": 11638, "user_id": 461294, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EQqHn.jpg?s=128&g=1", "display_name": "vich", "link": "https://stackoverflow.com/users/461294/vich"}, "edited": false, "score": 0, "creation_date": 1465941669, "post_id": 37822672, "comment_id": 63109325, "body": "Then you don&#39;t need to include the class."}], "tags": [], "owner": {"reputation": 11638, "user_id": 461294, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EQqHn.jpg?s=128&g=1", "display_name": "vich", "link": "https://stackoverflow.com/users/461294/vich"}, "is_accepted": false, "score": 2, "last_activity_date": 1465941632, "last_edit_date": 1465941632, "creation_date": 1465940941, "answer_id": 37822672, "question_id": 37822000, "link": "https://stackoverflow.com/questions/37822000/set-default-image-according-to-gender-carrierwave-device/37822672#37822672", "title": "Set Default Image According To Gender - Carrierwave &amp; Device", "body": "<p>If <code>image_uploader.rb</code> is a module, call it in your <code>User.rb</code> model using a callback (e.g. <code>after_create</code>) passing the user object and setting the image based on the user's gender.</p>\n\n<p>Something like this:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  after_create :set_default_url!\n\n  def set_default_url!\n    url = ImageUploader.default_url(gender)\n    update!(url: url)\n  end\nend\n</code></pre>\n\n<p>Then, in your module:</p>\n\n<pre><code>class ImageUploader &lt; CarrierWave::Uploader::Base\n  def self.default_url(gender)\n    ActionController::Base.helpers.asset_path(\"fallback/\" + [version_name, \"#{gender.downcase}.PNG\"].compact.join('_'))\n  end\nend\n</code></pre>\n\n<p>Some code was obviously omitted for brevity.</p>\n"}, {"tags": [], "owner": {"reputation": 849, "user_id": 3760584, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/100007767492662/picture?type=large", "display_name": "Alaa Othman", "link": "https://stackoverflow.com/users/3760584/alaa-othman"}, "is_accepted": true, "score": 0, "last_activity_date": 1466692194, "creation_date": 1466692194, "answer_id": 37994577, "question_id": 37822000, "link": "https://stackoverflow.com/questions/37822000/set-default-image-according-to-gender-carrierwave-device/37994577#37994577", "title": "Set Default Image According To Gender - Carrierwave &amp; Device", "body": "<p>The solution is to add the two photos \"male/female.png\" under <code>app/assets/images</code></p>\n\n<p>Then in the helpers/application_helper create this method</p>\n\n<pre><code>def default_img(user)\n  if user.avatar_url.nil?           \n    if (user.gender == \"Male\")\n         \"male.PNG\"\n    else\n        \"female.PNG\"\n    end\n  else\n    user.avatar_url\n  end\nend\n</code></pre>\n\n<p>Then use this method with each <code>img_tag</code></p>\n"}], "owner": {"reputation": 849, "user_id": 3760584, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/100007767492662/picture?type=large", "display_name": "Alaa Othman", "link": "https://stackoverflow.com/users/3760584/alaa-othman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 37994577, "answer_count": 2, "score": 0, "last_activity_date": 1466692194, "creation_date": 1465938023, "last_edit_date": 1465941435, "question_id": 37822000, "link": "https://stackoverflow.com/questions/37822000/set-default-image-according-to-gender-carrierwave-device", "title": "Set Default Image According To Gender - Carrierwave &amp; Device", "body": "<p>I use carrierwave for image uploading but since i have no access in the image_uploader.rb to the var 'current_user' of devise gem i cannot set a default picture based on gender when ever the picture url is nil(after create or update), is there a work out?</p>\n\n<p>uploaders/image_uploader.rb</p>\n\n<pre><code>class ImageUploader &lt; CarrierWave::Uploader::Base\n def default_url\n  if (current_user.gender == \"Male\")\n   ActionController::Base.helpers.asset_path(\"fallback/\" + [version_name, \"male.PNG\"].compact.join('_'))\n  else\n   ActionController::Base.helpers.asset_path(\"fallback/\" + [version_name, \"female.PNG\"].compact.join('_'))\n  end\n end\nend\n</code></pre>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ajax", "csv"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1465941433, "post_id": 37821673, "comment_id": 63109225, "body": "I&#39;d recommend using the built-in <a href=\"http://ruby-doc.org/stdlib-2.3.1/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">CSV class</a> to generate the CSV content. It&#39;s not exactly a trivial <a href=\"https://tools.ietf.org/html/rfc4180#page-2\" rel=\"nofollow noreferrer\">specification</a>, and is likely to bite you when you least expect it, especially when dealing with strings containing double-quotes and/or commas."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1465941730, "post_id": 37821673, "comment_id": 63109350, "body": "It&#39;s hard to say what could case the delays. When you say &quot;large CSV file&quot;, how large is it? How big is your host that generates the data CPU and memory wise? Where is the database hosted? On the same machine or a different one? Are you streaming the CSV to the client&#39;s browser where it&#39;s cached prior to being saved? We need a better idea of the problem. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; including the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;."}, {"owner": {"reputation": 213, "user_id": 6461829, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/259638c804f105d1ccc4ce1a94dc94ab?s=128&d=identicon&r=PG&f=1", "display_name": "yondaimehokage", "link": "https://stackoverflow.com/users/6461829/yondaimehokage"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1465989667, "post_id": 37821673, "comment_id": 63129055, "body": "Regarding some of your questions, I am not sure.  I know the databases are on different servers.  The CSV is not cached, since the items from the database are changed regularly."}, {"owner": {"reputation": 213, "user_id": 6461829, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/259638c804f105d1ccc4ce1a94dc94ab?s=128&d=identicon&r=PG&f=1", "display_name": "yondaimehokage", "link": "https://stackoverflow.com/users/6461829/yondaimehokage"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1465990214, "post_id": 37821673, "comment_id": 63129451, "body": "The CSV is 247.1 KB."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1466013050, "post_id": 37821673, "comment_id": 63145431, "body": "247.1K is not big at all. You&#39;re using <code>to_s</code> in a lot of places where it shouldn&#39;t be necessary, such as <code>((params[:list]).upcase).to_s</code>. If you can use <code>upcase</code> on it it&#39;s a string already. Also it&#39;s not necessary to use <code>to_s</code> on values that are being interpolated into a variable, such as <code>&quot;#{i[&#39;x_1&#39;].to_s}...&quot;</code> because Ruby automatically will convert the values to strings. Individual <code>to_s</code> are useful when necessary, but frivolous use wastes CPU slowing your code. Removing them might not solve the problem but it&#39;ll result in better code."}], "owner": {"reputation": 213, "user_id": 6461829, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/259638c804f105d1ccc4ce1a94dc94ab?s=128&d=identicon&r=PG&f=1", "display_name": "yondaimehokage", "link": "https://stackoverflow.com/users/6461829/yondaimehokage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465941184, "creation_date": 1465936725, "last_edit_date": 1465941184, "question_id": 37821673, "link": "https://stackoverflow.com/questions/37821673/send-data-does-not-correspond-with-end-of-ajax-call", "title": "&#39;send_data&#39; does not correspond with end of AJAX call", "body": "<p>I am generating a large CSV file using backend Ruby code for database queries, and then sending that data via <code>send_data</code> as a named CSV file.  It may take up to 12 minutes before the popup that says to view or save the file shows.</p>\n\n<p>The owner has requested that I place a \"We are compiling your file\" pop-up to display in the meantime.  I tried using an AJAX call along the line of:</p>\n\n<pre><code>$('ul#download-csv li a').on('click', function() {\n  $(\"body\").addClass(\"loading\");\n  $('body').append('&lt;p class=\"waiting\"&gt;Preparing file for download.&lt;/p&gt;');\n  var url = $(this).attr(\"href\");\n  $.ajax({\n    type: 'GET',\n    url: url,\n    beforeSend: function (xhr) {\n      xhr.setRequestHeader('X-CSRF-Token', $('meta[name=\"csrf-token\"]').attr('content'))\n    },\n    async: false\n  })\n  .done(function (data) {\n    $('body').removeClass('loading');\n  })\n  .fail(function () {\n    alert('We encountered an error in processing your request');\n    $('body').removeClass('loading');\n  });\n});\n</code></pre>\n\n<p>As expected, the loading class is removed once the AJAX call is completed after about 6 minutes.  However, for another 6 minutes, the window just sits there before the pop-up appears to save/open the file.  What is causing the additional delay?</p>\n\n<p>This is the Ruby controller:</p>\n\n<pre><code>def download_csv_file\n  x_model = X.new\n  x_file_name = ((params[:list]).upcase).to_s\n  list = List.select('id').where(list_abbreviation: x_file_name)\n  x_array = Array.new(0)\n  fname = x_file_name + \".csv\"\n  csvFile = []\n  query = Y.joins(:z).select('id').where('z.fk_x_id = ?', chemical_list[0])\n  query.each do |i|\n    x_query = x_model.get_list_item_for_download(i)\n    x_array.push(x_query) if !x_query.blank?\n  end\n  csvFile.push \"HEADER1,HEADER2,HEADER3,HEADER4,HEADER5,HEADER6,HEADER7\\n\"\n  x_array.each do |i|\n    csvFile.push \"#{i['x_1'].to_s},#{i['x_2'].to_s},\\\"#{i['x_3'].to_s}\\\",#{i['x_4'].to_s},\\\"#{i['x_5'].to_s}\\\"\\n\"\n  end\n  send_data csvFile.join, filename: fname, content_type: 'text/csv', disposition: 'attachment'\nend\n</code></pre>\n\n<p>This is the Ruby model:</p>\n\n<pre><code>def get_list_item_for_download(id)\n  @result_hash = Hash.new(0)\n\n  query = Y.joins(:a, :b).select('y.id as y_id, y.c1, y.c2, y.c3, a.id as a_id, a.c1, a.c2, a.c3, min(z.c2) as z_level').where('y.id = ?', id)\n\n  (query[0]).attributes.each {|var| @result_hash[var[0].to_sym] = var[1]}\n\n  return @result_hash.as_json\nend\n</code></pre>\n"}, {"tags": ["ruby", "rvg"], "comments": [{"owner": {"reputation": 5130, "user_id": 1443478, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4J9cr.jpg?s=128&g=1", "display_name": "Brennan", "link": "https://stackoverflow.com/users/1443478/brennan"}, "edited": false, "score": 1, "creation_date": 1465936932, "post_id": 37821659, "comment_id": 63107204, "body": "You are adding them in the order in which they will be drawn. Since you want to draw text 1 over text 2, add it second."}, {"owner": {"reputation": 5794, "user_id": 850224, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/65b467905691337e208944fcb34c7f57?s=128&d=identicon&r=PG", "display_name": "Artem Kalinchuk", "link": "https://stackoverflow.com/users/850224/artem-kalinchuk"}, "reply_to_user": {"reputation": 5130, "user_id": 1443478, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4J9cr.jpg?s=128&g=1", "display_name": "Brennan", "link": "https://stackoverflow.com/users/1443478/brennan"}, "edited": false, "score": 1, "creation_date": 1466005843, "post_id": 37821659, "comment_id": 63141215, "body": "@Brennan I had some more findings. See the question with the updates. The text is underneath regardless."}, {"owner": {"reputation": 5794, "user_id": 850224, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/65b467905691337e208944fcb34c7f57?s=128&d=identicon&r=PG", "display_name": "Artem Kalinchuk", "link": "https://stackoverflow.com/users/850224/artem-kalinchuk"}, "reply_to_user": {"reputation": 5130, "user_id": 1443478, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4J9cr.jpg?s=128&g=1", "display_name": "Brennan", "link": "https://stackoverflow.com/users/1443478/brennan"}, "edited": false, "score": 0, "creation_date": 1466022271, "post_id": 37821659, "comment_id": 63150529, "body": "Ok, after a lot of debugging I figured it out. Turns out I was duplicating some of the shapes. What @Brennan said is correct."}], "answers": [{"tags": [], "owner": {"reputation": 5794, "user_id": 850224, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/65b467905691337e208944fcb34c7f57?s=128&d=identicon&r=PG", "display_name": "Artem Kalinchuk", "link": "https://stackoverflow.com/users/850224/artem-kalinchuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1467215274, "creation_date": 1467215274, "answer_id": 38104455, "question_id": 37821659, "link": "https://stackoverflow.com/questions/37821659/layering-in-rvg/38104455#38104455", "title": "Layering in RVG", "body": "<p>As @Brennan specified, shapes will be drawn in the order they are added.</p>\n"}], "owner": {"reputation": 5794, "user_id": 850224, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/65b467905691337e208944fcb34c7f57?s=128&d=identicon&r=PG", "display_name": "Artem Kalinchuk", "link": "https://stackoverflow.com/users/850224/artem-kalinchuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467215274, "creation_date": 1465936644, "last_edit_date": 1466005794, "question_id": 37821659, "link": "https://stackoverflow.com/questions/37821659/layering-in-rvg", "title": "Layering in RVG", "body": "<p>How can I layer shapes/text in Ruby RVG library? For example, I want to have \"Text 1\" over \"Text 2\":</p>\n\n<pre><code>rvg.text(0, 0, \"Text 1\")\nrvg.text(0, 0, \"Text 2\")\n</code></pre>\n\n<p>Right now it will have \"Text 2\" over \"Text 1\" but I want to have \"Text 1\" over \"Text 2\".</p>\n\n<p><strong>Edit</strong></p>\n\n<p>In the following image I add a shape and then the text but the text is still under the shape. Regardless of which order I use, the text is always underneath.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8eJrS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8eJrS.png\" alt=\"shape and text\"></a></p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 11638, "user_id": 461294, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EQqHn.jpg?s=128&g=1", "display_name": "vich", "link": "https://stackoverflow.com/users/461294/vich"}, "edited": false, "score": 1, "creation_date": 1465936982, "post_id": 37821575, "comment_id": 63107237, "body": "Looks like you may want to explore full text search. Are you using PG or MySQL?"}, {"owner": {"reputation": 149, "user_id": 2105400, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Fl2sA.jpg?s=128&g=1", "display_name": "Atache", "link": "https://stackoverflow.com/users/2105400/atache"}, "reply_to_user": {"reputation": 11638, "user_id": 461294, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EQqHn.jpg?s=128&g=1", "display_name": "vich", "link": "https://stackoverflow.com/users/461294/vich"}, "edited": false, "score": 0, "creation_date": 1465937450, "post_id": 37821575, "comment_id": 63107494, "body": "@mmichael PG. Not familiar with full text search."}, {"owner": {"reputation": 11638, "user_id": 461294, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EQqHn.jpg?s=128&g=1", "display_name": "vich", "link": "https://stackoverflow.com/users/461294/vich"}, "edited": false, "score": 1, "creation_date": 1465938068, "post_id": 37821575, "comment_id": 63107792, "body": "Take a look at the <a href=\"https://github.com/textacular/textacular\" rel=\"nofollow noreferrer\">Textacular gem</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11638, "user_id": 461294, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EQqHn.jpg?s=128&g=1", "display_name": "vich", "link": "https://stackoverflow.com/users/461294/vich"}, "edited": false, "score": 1, "creation_date": 1465936999, "post_id": 37821691, "comment_id": 63107249, "body": "I think you want <code>OR</code> not <code>AND</code>"}, {"owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "reply_to_user": {"reputation": 11638, "user_id": 461294, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EQqHn.jpg?s=128&g=1", "display_name": "vich", "link": "https://stackoverflow.com/users/461294/vich"}, "edited": false, "score": 0, "creation_date": 1465937126, "post_id": 37821691, "comment_id": 63107316, "body": "You are right, I got caught on the original question."}, {"owner": {"reputation": 149, "user_id": 2105400, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Fl2sA.jpg?s=128&g=1", "display_name": "Atache", "link": "https://stackoverflow.com/users/2105400/atache"}, "edited": false, "score": 1, "creation_date": 1465938121, "post_id": 37821691, "comment_id": 63107821, "body": "@Leito what does the asterisk here indicate? <code>*keys.map{ |key| &quot;%#{key}%&quot; }</code>"}], "tags": [], "owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "is_accepted": true, "score": 1, "last_activity_date": 1465937067, "last_edit_date": 1465937067, "creation_date": 1465936827, "answer_id": 37821691, "question_id": 37821575, "link": "https://stackoverflow.com/questions/37821575/rails-query-by-multiple-keywords/37821691#37821691", "title": "Rails query by multiple keywords", "body": "<p><code>.where</code> takes SQL fragments, so just put the AND inside.</p>\n\n<pre><code>Food.where(\"description LIKE ? OR description LIKE ?\", \"%#{keys[0]}%\", \"%#{keys[1]}%\")\n</code></pre>\n\n<p>You could do something like for n, keys:</p>\n\n<pre><code>Food.where((['description LIKE ?'] * keys.size).join(' OR '), *keys.map{ |key| \"%#{key}%\" })\n</code></pre>\n\n<p>EDIT: You probably want OR as pointed out by a commenter in my answer.</p>\n"}], "owner": {"reputation": 149, "user_id": 2105400, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Fl2sA.jpg?s=128&g=1", "display_name": "Atache", "link": "https://stackoverflow.com/users/2105400/atache"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 2, "accepted_answer_id": 37821691, "answer_count": 1, "score": 0, "last_activity_date": 1465937067, "creation_date": 1465936336, "question_id": 37821575, "link": "https://stackoverflow.com/questions/37821575/rails-query-by-multiple-keywords", "title": "Rails query by multiple keywords", "body": "<p>I am trying to create a custom search method for a project I'm working on. Ideally I'd like to be able to have the user input and unlimited number of keywords to filter the results by, but I'm willing to settle for a just a couple. I have my code working for just one keyword. Here is the code in my model:</p>\n\n<pre><code>class Food &lt; ActiveRecord::Base\n  has_many :meal_items, inverse_of: :food_for_meal, foreign_key: 'food_for_meal_id'\n  has_many :user_meals, through: :meal_items\n\n  def self.search (key)\n    Food.where(\"description LIKE ?\", \"%#{key}%\")\n  end\nend\n</code></pre>\n\n<p>Here is one attempt I have made to use multiple keywords:</p>\n\n<pre><code>class Food &lt; ActiveRecord::Base\n  has_many :meal_items, inverse_of: :food_for_meal, foreign_key: 'food_for_meal_id'\n  has_many :user_meals, through: :meal_items\n\n  def self.search (key)\n    keys = key.split('+')\n    Food.where(\"description LIKE ?\", \"%#{keys[0]}%\") \n          AND (\"description LIKE ?\", \"%#{keys[1]}%\")\n  end\nend\n</code></pre>\n\n<p>I have tried moving things in and out of parens and quotes and so forth, but can't seem to nail down the correct syntax. Any help would be appreciated. </p>\n"}]