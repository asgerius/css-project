[{"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 0, "last_activity_date": 1528994515, "creation_date": 1528994515, "answer_id": 50862299, "question_id": 50847702, "link": "https://stackoverflow.com/questions/50847702/how-does-rails-create-a-temp-database-from-a-yml-file/50862299#50862299", "title": "How does rails create a temp database from a yml file?", "body": "<blockquote>\n  <p>I suspect that <code>users.yml</code> became a database</p>\n</blockquote>\n\n<p>Close, but not quite. Contents of <code>users.yml</code> were inserted in your test database (which is configured in <code>database.yml</code>).</p>\n\n<p>This is called <a href=\"http://guides.rubyonrails.org/testing.html#the-low-down-on-fixtures\" rel=\"nofollow noreferrer\">fixtures</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 9938613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b65b5202997870dfbce09ce23e5fb6e?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/9938613/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 50862299, "answer_count": 1, "score": -1, "last_activity_date": 1528994515, "creation_date": 1528932887, "last_edit_date": 1528994217, "question_id": 50847702, "link": "https://stackoverflow.com/questions/50847702/how-does-rails-create-a-temp-database-from-a-yml-file", "title": "How does rails create a temp database from a yml file?", "body": "<p>Following the rails tutorial <a href=\"https://www.railstutorial.org/book/basic_login\" rel=\"nofollow noreferrer\">https://www.railstutorial.org/book/basic_login</a>. </p>\n\n<p><strong>users.yml</strong>\n</p>\n\n<pre><code>michael:\n  name: Michael Example\n  email: michael@example.comm\n  password_digest: &lt;%= User.digest('password') %&gt;\n</code></pre>\n\n\n\n<p><strong>users_login_test.rb</strong></p>\n\n<pre class=\"lang-html prettyprint-override\"><code>require 'test_helper'\n\nclass UsersLoginTest &lt; ActionDispatch::IntegrationTest\n\n  def setup\n    @user = users(:michael)\n  end\n\n  test \"login with valid information\" do\n    get login_path\n    post login_path, params: { session: { email:    @user.email,\n                                          password: 'password' } }\n    assert_redirected_to @user\n    follow_redirect!\n    assert_template 'users/show'\n    assert_select \"a[href=?]\", login_path, count: 0\n    assert_select \"a[href=?]\", logout_path\n    assert_select \"a[href=?]\", user_path(@user)\n  end\nend\n</code></pre>\n\n\n\n<ol>\n<li>Through debugging user Michael can log in without signing up because I suspect that <strong>users.yml</strong> became a database, but how did it do that? </li>\n<li>Is there any way to figure this out through byebug or pry?</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "is_accepted": false, "score": 0, "last_activity_date": 1528936745, "creation_date": 1528936745, "answer_id": 50848110, "question_id": 50847653, "link": "https://stackoverflow.com/questions/50847653/how-display-something-if-check-box-tag-is-checked/50848110#50848110", "title": "How display something if check box tag is checked?", "body": "<p>Since this is for an assignment I will just try to help you along but not give you the whole answer as your teacher wants you to learn it. </p>\n\n<p>I would use the <code>form_for</code> as described in: <a href=\"https://apidock.com/rails/ActionView/Helpers/FormHelper/form_for\" rel=\"nofollow noreferrer\">https://apidock.com/rails/ActionView/Helpers/FormHelper/form_for</a></p>\n\n<p>Then I would build the checkboxes using the <code>collection_check_boxes</code> method as shown here:</p>\n\n<p><a href=\"https://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/collection_check_boxes\" rel=\"nofollow noreferrer\">https://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/collection_check_boxes</a></p>\n\n<p>It is unclear from your question but if the Things for each activity are already set, then you shouldn't need much more than this. If you try the methods above and have problems please edit your original question and I can try and help you further.</p>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 7789913, "user_type": "registered", "profile_image": "https://graph.facebook.com/1454793477904342/picture?type=large", "display_name": "Parakh Garg", "link": "https://stackoverflow.com/users/7789913/parakh-garg"}, "is_accepted": false, "score": 0, "last_activity_date": 1528969934, "creation_date": 1528969934, "answer_id": 50854588, "question_id": 50847653, "link": "https://stackoverflow.com/questions/50847653/how-display-something-if-check-box-tag-is-checked/50854588#50854588", "title": "How display something if check box tag is checked?", "body": "<p>Try doing it via jQuery and ajax request. Create an action in a controller which retrieve data and call that action from the ajax request and then render the response data whereever you want.</p>\n"}], "owner": {"reputation": 1, "user_id": 9938697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b66ab49f796eeb606e9d9a88a75fdd0e?s=128&d=identicon&r=PG&f=1", "display_name": "Clara", "link": "https://stackoverflow.com/users/9938697/clara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528969934, "creation_date": 1528932413, "last_edit_date": 1528932945, "question_id": 50847653, "link": "https://stackoverflow.com/questions/50847653/how-display-something-if-check-box-tag-is-checked", "title": "How display something if check box tag is checked?", "body": "<p>Hello I\u2019m beginner on ruby on rails and I have to build an application for my studies.\nIt will have users who can select differents activities and then have a list of all the things that they need for these activities ( For example if they select \u00ab Fishing \u00bb they will have a list as \u00ab bundles, fishing rod \u2026 \u00bb  ).</p>\n\n<p>I have a bidirectional <code>has_and_belongs_to_many</code> relationship between <code>activities</code> and <code>things</code>.</p>\n\n<p>I would like to display all the activities and if the user selects some activities it should show <code>things</code> related to those activities.</p>\n\n<p>How can I build such a view?</p>\n\n<p>I try to put an \u00ab if check_box true ? \u00bb  but it doesn\u2019t work \u2026. If you can help me, I would be grateful !</p>\n\n<p>To display my list of activities I'm using this : </p>\n\n<pre><code>&lt;%= form_tag do %&gt; &lt;% @activities.each do |activity| %&gt; &lt;li&gt; &lt;%= check_box_tag 'activity_ids[]', activity.id %&gt; &lt;%= activity.name %&gt; &lt;%= activity.content %&gt; &lt;/li&gt; &lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 1, "creation_date": 1528931005, "post_id": 50847442, "comment_id": 88698352, "body": "Sqlite is generally not used in production. You should either use Postgres locally or only use sqlite in the development group. Pretty sure you can&#39;t use sqlite on Heroku."}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1528958372, "post_id": 50847442, "comment_id": 88704849, "body": "Yeah I can agree that there is no sqlite on heroku - pg only."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 7336686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c01414e7eec3b6630015dcaf052d1b78?s=128&d=identicon&r=PG&f=1", "display_name": "naughie", "link": "https://stackoverflow.com/users/7336686/naughie"}, "edited": false, "score": 0, "creation_date": 1529106369, "post_id": 50861116, "comment_id": 88769671, "body": "Thanks for much advise! It&#39;s fine."}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 3, "last_activity_date": 1528990293, "creation_date": 1528990293, "answer_id": 50861116, "question_id": 50847442, "link": "https://stackoverflow.com/questions/50847442/rails-ignores-config-database-yml/50861116#50861116", "title": "Rails ignores config/database.yml", "body": "<p>Rails is using the connection details from the environment variable, not the config file. Rails uses <em>both</em> <code>ENV['DATABASE_URL']</code> and <code>config/database.yml</code> when setting up the database, and in most cases the environment variable has priority.</p>\n\n<p>Take a look at <a href=\"http://guides.rubyonrails.org/configuring.html#configuring-a-database\" rel=\"nofollow noreferrer\">the docs</a> to see how the two ways of configuring the database interact.</p>\n\n<p>The simplest solution in your case is probably to remove the <code>DATABASE_URL</code> varaible from your development machine. It\u2019s unlikely you need it set there, and could possibly cause problems if you accidentally connect to the production database from development.</p>\n\n<p>You could also use the <code>url:</code> key rather than the <code>database:</code> key when specifying the development database, as that key does take precedence over the environment variable. It would look something like:</p>\n\n<pre><code>development:\n  &lt;&lt;: *default\n  url: sqlite:db/development.sqlite3\n</code></pre>\n\n<p>You should also probably remove the <code>adapter</code> from <code>defaults</code>, as you are not using sqlite in production but are merging in that key. What you have will likely work (since the environment variable overrides the setting in the file), but it is confusing. Ideally you would want to look into using the same database in development and production to minimise differences between the two environments.</p>\n"}], "owner": {"reputation": 175, "user_id": 7336686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c01414e7eec3b6630015dcaf052d1b78?s=128&d=identicon&r=PG&f=1", "display_name": "naughie", "link": "https://stackoverflow.com/users/7336686/naughie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1066, "favorite_count": 0, "accepted_answer_id": 50861116, "answer_count": 1, "score": 0, "last_activity_date": 1528990293, "creation_date": 1528930620, "question_id": 50847442, "link": "https://stackoverflow.com/questions/50847442/rails-ignores-config-database-yml", "title": "Rails ignores config/database.yml", "body": "<p>I uses Rails but it does not follow the settings in <code>config/database.yml</code>.</p>\n\n<p>With <code>config/database.yml</code> (<code>$DATABASE_URL</code> is the URL of my Heroku app's database)</p>\n\n<pre><code># SQLite version 3.x\n#   gem install sqlite3\n#\n#   Ensure the SQLite 3 gem is defined in your Gemfile\n#   gem 'sqlite3'\n#\ndefault: &amp;default\n  pool: &lt;%= ENV.fetch(\"RAILS_MAX_THREADS\") { 5 } %&gt;\n  adapter: sqlite3\n  timeout: 5000\n\ndevelopment:\n  &lt;&lt;: *default\n  database: db/development.sqlite3\n\n# Warning: The database defined as \"test\" will be erased and\n# re-generated from your development database when you run \"rake\".\n# Do not set this db to the same as development or production.\ntest:\n  &lt;&lt;: *default\n  database: db/test.sqlite3\n\nproduction:\n  &lt;&lt;: *default\n  url: &lt;%= ENV['DATABASE_URL'] %&gt;\n</code></pre>\n\n<p>I ran <code>rails g controller hoge</code>, then I got errors:</p>\n\n<pre><code>/myapp/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/connection_specification.rb:188:in `rescue in spec': Specified 'postgresql' for database adapter, but the gem is not loaded. Add `gem 'pg'` to your Gemfile (and ensure its version is at the minimum required by ActiveRecord). (Gem::LoadError)\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/connection_specification.rb:185:in `spec'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:880:in `establish_connection'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/connection_handling.rb:58:in `establish_connection'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/railtie.rb:124:in `block (2 levels) in &lt;class:Railtie&gt;'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:69:in `instance_eval'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:69:in `block in execute_hook'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:60:in `with_execution_control'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:65:in `execute_hook'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:50:in `block in run_load_hooks'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:49:in `each'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:49:in `run_load_hooks'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/base.rb:326:in `&lt;module:ActiveRecord&gt;'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/base.rb:25:in `&lt;top (required)&gt;'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `block in require'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:256:in `block in load_dependency'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:662:in `new_constants_in'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:256:in `load_dependency'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n    from /myapp/app/models/application_record.rb:1:in `&lt;top (required)&gt;'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:477:in `load'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:477:in `block in load_file'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:662:in `new_constants_in'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:476:in `load_file'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:374:in `block in require_or_load'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:36:in `block in load_interlock'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies/interlock.rb:12:in `block in loading'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/concurrency/share_lock.rb:149:in `exclusive'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies/interlock.rb:11:in `loading'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:36:in `load_interlock'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:357:in `require_or_load'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:511:in `load_missing_constant'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:202:in `const_missing'\n    from /myapp/app/models/user.rb:1:in `&lt;top (required)&gt;'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:477:in `load'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:477:in `block in load_file'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:662:in `new_constants_in'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:476:in `load_file'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:374:in `block in require_or_load'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:36:in `block in load_interlock'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies/interlock.rb:12:in `block in loading'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/concurrency/share_lock.rb:149:in `exclusive'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies/interlock.rb:11:in `loading'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:36:in `load_interlock'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:357:in `require_or_load'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:511:in `load_missing_constant'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:202:in `const_missing'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/inflector/methods.rb:269:in `const_get'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/inflector/methods.rb:269:in `block in constantize'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/inflector/methods.rb:267:in `each'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/inflector/methods.rb:267:in `inject'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/inflector/methods.rb:267:in `constantize'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:583:in `get'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:614:in `constantize'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise.rb:316:in `get'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/mapping.rb:83:in `to'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/mapping.rb:78:in `modules'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/mapping.rb:95:in `routes'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/mapping.rb:162:in `default_used_route'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/mapping.rb:72:in `initialize'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise.rb:346:in `new'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise.rb:346:in `add_mapping'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/rails/routes.rb:243:in `block in devise_for'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/rails/routes.rb:242:in `each'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/rails/routes.rb:242:in `devise_for'\n    from /myapp/config/routes.rb:2:in `block in &lt;top (required)&gt;'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.6/lib/action_dispatch/routing/route_set.rb:436:in `instance_exec'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.6/lib/action_dispatch/routing/route_set.rb:436:in `eval_block'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.6/lib/action_dispatch/routing/route_set.rb:418:in `draw'\n    from /myapp/config/routes.rb:1:in `&lt;top (required)&gt;'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:286:in `load'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:286:in `block in load'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:258:in `load_dependency'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:286:in `load'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:55:in `block in load_paths'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:55:in `each'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:55:in `load_paths'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:18:in `reload!'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:41:in `block in updater'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/file_update_checker.rb:81:in `execute'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:42:in `updater'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:31:in `execute_if_updated'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/finisher.rb:128:in `block in &lt;module:Finisher&gt;'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/initializable.rb:30:in `instance_exec'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/initializable.rb:30:in `run'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/initializable.rb:59:in `block in run_initializers'\n    from /home/.rbenv/versions/2.5.0/lib/ruby/2.5.0/tsort.rb:228:in `block in tsort_each'\n    from /home/.rbenv/versions/2.5.0/lib/ruby/2.5.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n    from /home/.rbenv/versions/2.5.0/lib/ruby/2.5.0/tsort.rb:431:in `each_strongly_connected_component_from'\n    from /home/.rbenv/versions/2.5.0/lib/ruby/2.5.0/tsort.rb:349:in `block in each_strongly_connected_component'\n    from /home/.rbenv/versions/2.5.0/lib/ruby/2.5.0/tsort.rb:347:in `each'\n    from /home/.rbenv/versions/2.5.0/lib/ruby/2.5.0/tsort.rb:347:in `call'\n    from /home/.rbenv/versions/2.5.0/lib/ruby/2.5.0/tsort.rb:347:in `each_strongly_connected_component'\n    from /home/.rbenv/versions/2.5.0/lib/ruby/2.5.0/tsort.rb:226:in `tsort_each'\n    from /home/.rbenv/versions/2.5.0/lib/ruby/2.5.0/tsort.rb:205:in `tsort_each'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/initializable.rb:58:in `run_initializers'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application.rb:353:in `initialize!'\n    from /myapp/config/environment.rb:5:in `&lt;top (required)&gt;'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `block in require'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:258:in `load_dependency'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/spring-2.0.2/lib/spring/application.rb:102:in `preload'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/spring-2.0.2/lib/spring/application.rb:153:in `serve'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/spring-2.0.2/lib/spring/application.rb:141:in `block in run'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/spring-2.0.2/lib/spring/application.rb:135:in `loop'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/spring-2.0.2/lib/spring/application.rb:135:in `run'\n    from /myapp/vendor/bundle/ruby/2.5.0/gems/spring-2.0.2/lib/spring/application/boot.rb:19:in `&lt;top (required)&gt;'\n    from /home/.rbenv/versions/2.5.0/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n    from /home/.rbenv/versions/2.5.0/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n    from -e:1:in `&lt;main&gt;'\n</code></pre>\n\n<p>In Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngit_source(:github) do |repo_name|\n  repo_name = \"#{repo_name}/#{repo_name}\" unless repo_name.include?(\"/\")\n  \"https://github.com/#{repo_name}.git\"\nend\n\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.1.4'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.7'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.2'\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 3.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '~&gt; 2.13'\n  gem 'selenium-webdriver'\n\n  gem 'pry-rails'\n  gem 'pry-doc'\n  gem 'pry-byebug'\n  gem 'pry-stack_explorer'\n\n  # Use sqlite3 as the database for Active Record\n  gem 'sqlite3'\nend\n\ngroup :development do\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\n  gem 'letter_opener'\n  gem 'letter_opener_web'\nend\n\ngroup :production do\n  gem 'pg', '~&gt; 0.20'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n\ngem 'config'\ngem 'bootstrap-sass'\ngem 'kaminari'\ngem 'jquery-rails'\ngem 'gon'\ngem 'faraday'\ngem 'faraday_middleware'\ngem 'devise'\ngem 'devise-bootstrap-views'\ngem 'data-confirm-modal'\n</code></pre>\n\n<p>My ruby version is v2.5.0 and OS is macOS Sierra 10.12.6.</p>\n\n<p>Why the adapter is set to <code>postgresql</code> in spite of <code>sqlite3</code> in <code>config/database.yml</code>?\nHow can I use the configurations correctly?</p>\n\n<p>I think of migrating developing environment to virtual box (to avoid cumbersome problems like this), but I am afraid that, in the box, I would get such errors as well. Is it OK?</p>\n"}, {"tags": ["ruby", "regex", "nokogiri", "liquid"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1528930320, "post_id": 50847311, "comment_id": 88698179, "body": "Is there any reason you can&#39;t manipulate the compiled output? Trying to dynamically alter liquid templates is not a trivial problem."}, {"owner": {"reputation": 357, "user_id": 1644355, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cUHei.png?s=128&g=1", "display_name": "Przemek Mroczek", "link": "https://stackoverflow.com/users/1644355/przemek-mroczek"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1528935578, "post_id": 50847311, "comment_id": 88699253, "body": "I can&#39;t as I want to introduce dynamic condition and manipulating compiled output doesn&#39;t help me at all."}], "owner": {"reputation": 357, "user_id": 1644355, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cUHei.png?s=128&g=1", "display_name": "Przemek Mroczek", "link": "https://stackoverflow.com/users/1644355/przemek-mroczek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528929701, "creation_date": 1528929701, "question_id": 50847311, "link": "https://stackoverflow.com/questions/50847311/what-will-be-the-best-way-to-parse-and-manipulate-liquid-templates-like-dom", "title": "What will be the best way to parse and manipulate Liquid templates like DOM?", "body": "<p>I want to manipulate liquid templates to add new html nodes and conditions dynamically in the way similar to inserting new nodes in nokogiri or JavaScript to dom. What would be the easiest way to implement such feature?</p>\n\n<p>My ideas:</p>\n\n<ul>\n<li>Using regex</li>\n<li><p>Creating pseudo markup such that I would have for each line in the template(my pseudo code follows): </p>\n\n<pre><code>&lt;div class=\"my-class\"&gt; transform into HtmlNode.new(:start, :div, { class:'my-class' })   \n</code></pre></li>\n</ul>\n\n<p>For liquid something along this lines(pseudo code)</p>\n\n<pre><code>{{ page.title }} transform into LiquidNode.new(:object, 'page.title' )\n</code></pre>\n\n<p>That would be array, then I could insert my code at specific index and convert it back to liquid template</p>\n\n<p>I don't think it's a new problem but I can't find easy solution anywhere in the internet. Maybe I can't name the problem properly. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2063, "user_id": 196834, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1EhzG.jpg?s=128&g=1", "display_name": "Ashley", "link": "https://stackoverflow.com/users/196834/ashley"}, "edited": false, "score": 1, "creation_date": 1528924466, "post_id": 50845927, "comment_id": 88696258, "body": "Prometheus can do this along with this gem - <a href=\"https://github.com/discourse/prometheus_exporter\" rel=\"nofollow noreferrer\">github.com/discourse/prometheus_exporter</a> - you can then plot the req/sec against with Grafana."}], "answers": [{"tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": true, "score": 1, "last_activity_date": 1528924199, "creation_date": 1528924199, "answer_id": 50846321, "question_id": 50845927, "link": "https://stackoverflow.com/questions/50845927/manually-calculate-requests-per-minute-from-a-http-access-log/50846321#50846321", "title": "Manually calculate requests per minute from a HTTP access log", "body": "<p>It's not the prettiest, but this is what you're going to want to do.</p>\n\n<pre><code>require 'time'\nTIMESTAMP_REGEX = %r{\\[(.*?)\\]} # extract everything between the []\n\ndatetimes = log.scan(TIMESTAMP_REGEX).flatten.map { |log_time| DateTime.parse(log_time.sub(\":\", ' ')) } # get the results from the regex and make an array of DateTime objects\n\nresults = Hash.new(0)\n\ndatetimes.each do |datetime|\n  time = datetime.strftime('%Y/%m/%d %H:%M') \n  results[time] += 1 \nend\n\nresults.each do |k,v|\n  puts \"#{k}: #{v} requests\"\nend\n</code></pre>\n\n<p>There are more optimal ways to do this \u2014 including a moderately-lengthy one-liner \u2014 but if you're looking for straightforwardness this is the way to go.</p>\n"}], "owner": {"reputation": 139, "user_id": 2102958, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9c225c9d28de695546f549fe4b36f15?s=128&d=identicon&r=PG", "display_name": "Rubee", "link": "https://stackoverflow.com/users/2102958/rubee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 50846321, "answer_count": 1, "score": 0, "last_activity_date": 1528924199, "creation_date": 1528922362, "last_edit_date": 1528923161, "question_id": 50845927, "link": "https://stackoverflow.com/questions/50845927/manually-calculate-requests-per-minute-from-a-http-access-log", "title": "Manually calculate requests per minute from a HTTP access log", "body": "<p>I have a logfile</p>\n\n<pre><code>123.123.123.123 - - [26/Apr/2000:00:23:48 -0400] \"GET /pics/wpaper.gif HTTP/1.0\" 200 6248 \"http://www.jafsoft.com/asctortf/\" \"Mozilla/4.05 (Macintosh; I; PPC)\"\n123.123.123.123 - - [26/Apr/2000:00:23:47 -0400] \"GET /asctortf/ HTTP/1.0\" 200 8130 \"http://search.netscape.com/Computers/Data_Formats/Document/Text/RTF\" \"Mozilla/4.05 (Macintosh; I; PPC)\"\n123.123.123.123 - - [26/Apr/2000:00:23:48 -0400] \"GET /pics/5star2000.gif HTTP/1.0\" 200 4005 \"http://www.jafsoft.com/asctortf/\" \"Mozilla/4.05 (Macintosh; I; PPC)\"\n123.123.123.123 - - [26/Apr/2000:00:23:50 -0400] \"GET /pics/5star.gif HTTP/1.0\" 200 1031 \"http://www.jafsoft.com/asctortf/\" \"Mozilla/4.05 (Macintosh; I; PPC)\"\n123.123.123.123 - - [26/Apr/2000:00:23:51 -0400] \"GET /pics/a2hlogo.jpg HTTP/1.0\" 200 4282 \"http://www.jafsoft.com/asctortf/\" \"Mozilla/4.05 (Macintosh; I; PPC)\"\n123.123.123.123 - - [26/Apr/2000:00:23:51 -0400] \"GET /cgi-bin/newcount?jafsof3&amp;width=4&amp;font=digital&amp;noshow HTTP/1.0\" 200 36 \"http://www.jafsoft.com/asctortf/\" \"Mozilla/4.05 (Macintosh; I; PPC)\"\n</code></pre>\n\n<p>I want to calculate the requests per minute and output something like this. </p>\n\n<pre><code>2012/01/01 00:00 2\n2012/01/01 00:01 33\n</code></pre>\n\n<p>I was thinking of looping over the whole file and extracting out the timestamps to an array, using regex like this. </p>\n\n<pre><code>File.open(\"log.txt\") do |f|\n f.each_line do |line|\n timestamps &lt;&lt;  line[/\\[(\\d{2})\\/([a-zA-Z]{3})\\/(\\d{4}):(\\d{2}):(\\d{2}) (\\d{2})\\s(-\\d{4})]/]\nend\n</code></pre>\n\n<p>Then using that array to somehow calculate the requests per second, is there a better way I can do this using ruby? Without using CLI tools. </p>\n"}, {"tags": ["json", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 3036, "user_id": 3466415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610a8a95f861678ab9f72ee483d1c1a7?s=128&d=identicon&r=PG&f=1", "display_name": "David K", "link": "https://stackoverflow.com/users/3466415/david-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1528921217, "creation_date": 1528921217, "answer_id": 50845624, "question_id": 50845485, "link": "https://stackoverflow.com/questions/50845485/interpolating-a-json-string-removes-json-quotations/50845624#50845624", "title": "Interpolating a JSON string removes JSON quotations", "body": "<p>Why do you think the first and last quote marks are part of the string? They do not belong to the JSON format. Your program\u2019s behavior looks correct to me. </p>\n\n<p>(Or more precisely, your program seems to be doing exactly what you told it to. Whether your instructions are any good is a question I can\u2019t answer without more context.)</p>\n"}, {"tags": [], "owner": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "is_accepted": false, "score": 0, "last_activity_date": 1528921384, "creation_date": 1528921384, "answer_id": 50845676, "question_id": 50845485, "link": "https://stackoverflow.com/questions/50845485/interpolating-a-json-string-removes-json-quotations/50845676#50845676", "title": "Interpolating a JSON string removes JSON quotations", "body": "<p>It's hard to tell with the small sample, but it looks like you might be getting quotes from your debugger output. assuming the output of <code>.to_json</code> is a string (usually is), then <code>\"#{json_str}\"</code> should be exactly equal to <code>json_str</code>. If it isn't, that's a bug in ruby somehow (doubtful). </p>\n\n<p>If you need the quotes, you need to either add them manually or escape the string using whatever escape function is appropriate for your use case. You could use <code>.to_json</code> as your escape function even (<code>\"#{json_str.to_json}\"</code>, for example).</p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528922655, "creation_date": 1528920729, "last_edit_date": 1528922655, "question_id": 50845485, "link": "https://stackoverflow.com/questions/50845485/interpolating-a-json-string-removes-json-quotations", "title": "Interpolating a JSON string removes JSON quotations", "body": "<p>I have the following two lines of code:</p>\n\n<pre><code>json_str = _cases.to_json\npath += \" #{USER} #{PASS} #{json_str}\"\n</code></pre>\n\n<p>When I use the debugger, I noticed that <code>json_str</code> appears to be formatted as JSON:</p>\n\n<pre><code>\"[[\"FMCE\",\"Wiltone\",\"Wiltone\",\"04/10/2018\",\"Marriage + - DOM\"]]\"\n</code></pre>\n\n<p>However, when I interpolate it into another string, the quotes are removed:</p>\n\n<pre><code>\"node superuser 123456 [[\"FMCE\",\"Wiltone\",\"Wiltone\",\"04/10/2018\",\"Marriage + - DOM\"]]\" \n</code></pre>\n\n<p>Why does string interpolation remove the quotes from JSON string and how can I resolve this?</p>\n\n<p>I did find one solution to the problem, which was manually escaping the string:</p>\n\n<pre><code>json_str = _cases.to_json.gsub('\"','\\\"')\npath += \" #{USER} #{PASS} \\\"#{json_str}\\\"\"\n</code></pre>\n\n<p>So basically I escape the double quotes generated in the to_json call. Then I manually add two escaped quotes around the interpolated variable. This will produce a desired result:</p>\n\n<pre><code>node superuser 123456 \"[[\\\"FMCE\\\",\\\"Wiltone\\\",\\\"Wiltone\\\",\\\"04/10/2018\\\",\\\"Marriage + - DOM\\\"]]\" \n</code></pre>\n\n<p>Notice how the outer quotes around the collection are not escaped, but the strings inside the collection are escaped. That will enable JavaScript to parse it with JSON.parse.</p>\n\n<p>It is important to note that in this part:</p>\n\n<pre><code>json_str = _cases.to_json.gsub('\"','\\\"')\n</code></pre>\n\n<p>it is adding a LITERAL backslash. Not an escape sequence.</p>\n\n<p>But in this part:</p>\n\n<pre><code>path += \" #{USER} #{PASS} \\\"#{json_str}\\\"\"\n</code></pre>\n\n<p>The \\\" wrapping the interpolated variable is an escape sequence and NOT a literal backslash.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 2, "creation_date": 1528919789, "post_id": 50845140, "comment_id": 88694029, "body": "It isn&#39;t a valid class name, but it&#39;s a valid method on a class--see also <code>Hash[]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 789595, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUV0C.jpg?s=128&g=1", "display_name": "fourseventy", "link": "https://stackoverflow.com/users/789595/fourseventy"}, "edited": false, "score": 0, "creation_date": 1528919788, "post_id": 50845179, "comment_id": 88694028, "body": "I see. So that method would return a Class object allowing MyMigration to subclass it?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 33, "user_id": 789595, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUV0C.jpg?s=128&g=1", "display_name": "fourseventy", "link": "https://stackoverflow.com/users/789595/fourseventy"}, "edited": false, "score": 0, "creation_date": 1528919830, "post_id": 50845179, "comment_id": 88694056, "body": "@fourseventy It could return anything it wanted, but if it wasn&#39;t returning a <code>Migration</code> implementation it&#39;d be counter-intuitive."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1528927959, "post_id": 50845179, "comment_id": 88697526, "body": "@DaveNewton: And if it doesn&#39;t return an instance of <code>Class</code>, it&#39;ll be a <code>TypeError</code>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 33, "user_id": 789595, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUV0C.jpg?s=128&g=1", "display_name": "fourseventy", "link": "https://stackoverflow.com/users/789595/fourseventy"}, "edited": false, "score": 2, "creation_date": 1528928124, "post_id": 50845179, "comment_id": 88697579, "body": "@fourseventy: I think the piece of the puzzle you are missing is that you are (wrongly) assuming that the code to the right of <code>&lt;</code> has to be a &quot;class name&quot;. Actually, classes in Ruby don&#39;t <i>have</i> names (at least not in the Java sense of the word). A class is simply an object like any other object. So, the code to the right of the <code>&lt;</code> is simply <i>executable Ruby code</i> that evaluates to an instance of the <code>Class</code> class. You could put something like <code>[Array, Hash].sample</code> there, and your class would randomly inherit from either <code>Array</code> or <code>Hash</code>!"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1528929146, "post_id": 50845179, "comment_id": 88697836, "body": "@J&#246;rgWMittag That&#39;s what all my code does. Makes things more interesting."}, {"owner": {"reputation": 2335, "user_id": 2594250, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ff0460733e711281d30021db7577032?s=128&d=identicon&r=PG", "display_name": "Tanmay", "link": "https://stackoverflow.com/users/2594250/tanmay"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1563339269, "post_id": 50845179, "comment_id": 100661488, "body": "@J&#246;rgWMittag Thanks for your comment. It helped me understand something. SO should give an option to bookmark/star comments."}], "tags": [], "owner": {"reputation": 8973, "user_id": 831564, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b7b5cb565edb37aac67f053f64f0324f?s=128&d=identicon&r=PG", "display_name": "Marlin Pierce", "link": "https://stackoverflow.com/users/831564/marlin-pierce"}, "is_accepted": true, "score": 2, "last_activity_date": 1528919418, "creation_date": 1528919418, "answer_id": 50845179, "question_id": 50845140, "link": "https://stackoverflow.com/questions/50845140/square-brackets-in-activerecordmigration-class-name/50845179#50845179", "title": "Square brackets in ActiveRecord::Migration class name?", "body": "<p>Ruby objects can have <code>[]</code> methods.  They are used in the <code>Array</code> class, but any class can implement them.</p>\n\n<pre><code>def []()\n  ...\nend\n</code></pre>\n\n<p>Since classes are full objects, they too can have square bracket methods.</p>\n"}], "owner": {"reputation": 33, "user_id": 789595, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUV0C.jpg?s=128&g=1", "display_name": "fourseventy", "link": "https://stackoverflow.com/users/789595/fourseventy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "closed_date": 1566102972, "accepted_answer_id": 50845179, "answer_count": 1, "score": 2, "last_activity_date": 1528919418, "creation_date": 1528919285, "question_id": 50845140, "link": "https://stackoverflow.com/questions/50845140/square-brackets-in-activerecordmigration-class-name", "closed_reason": "Duplicate", "title": "Square brackets in ActiveRecord::Migration class name?", "body": "<p>In Ruby on Rails 5.2, migration files contain a class that looks like this.</p>\n\n<p><code>\nclass MyMigration &lt; ActiveRecord::Migration[5.2]\n</code></p>\n\n<p>I know that the <code>[5.2]</code> syntax is specifying what version of rails the migration targets, but I don't understand how this works. <code>Migration[5.2]</code> is not a valid Ruby class name.</p>\n\n<p>What is this square bracket syntax, and how is it not causing ruby syntax errors?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528916400, "post_id": 50844404, "comment_id": 88692292, "body": "If you find ActiveRecord too heavy, <a href=\"https://github.com/jeremyevans/sequel\" rel=\"nofollow noreferrer\">Sequel</a> is worth checking out. It&#39;s not only an adaptable query builder but a model system <i>if</i> you want it. Any database requires migrations if you&#39;re going to use it in a production environment, and Sequel gives you that."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528916431, "post_id": 50844404, "comment_id": 88692308, "body": "That should probably be <code>UPDATE authors SET name = ? WHERE id = ?</code> with no parens around <code>name</code>."}, {"owner": {"reputation": 5565, "user_id": 1695507, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1f7f9576a6f6486bf26e4a8dbbf09868?s=128&d=identicon&r=PG", "display_name": "thumbtackthief", "link": "https://stackoverflow.com/users/1695507/thumbtackthief"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528916663, "post_id": 50844404, "comment_id": 88692405, "body": "The update method works as it is.  At the current time I don&#39;t wish to use any other gems or libraries--this is a learning exercise.  I need to get the code working as it is, and also to understand what&#39;s causing the error."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528916738, "post_id": 50844404, "comment_id": 88692444, "body": "If it&#39;s an academic exercise then that&#39;s an interesting project. I was just concerned this would be for production code, in which case you&#39;re creating a lot of technical debt here that you can never pay off. Does <code>execute</code> raise exceptions on errors or do you need to test the result of that method call manually? Each driver does this differently. I have a feeling you&#39;re getting push-back from your server that you&#39;re not properly capturing and dealing with."}, {"owner": {"reputation": 5565, "user_id": 1695507, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1f7f9576a6f6486bf26e4a8dbbf09868?s=128&d=identicon&r=PG", "display_name": "thumbtackthief", "link": "https://stackoverflow.com/users/1695507/thumbtackthief"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528916893, "post_id": 50844404, "comment_id": 88692515, "body": "This code won&#39;t be developed much past where it is right now, so no worries there.    The rake task db_setup works fine.  I also have a rake task which opens a Pry console, and when in there I can call the create and save methods (as well as my own find, all, and delete methods) without any problems.  The only issue is the seed file (if I cut and paste the code in the seed file to the console, it works fine).  My instinct is that I have a require wrong somewhere."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1528916989, "post_id": 50844404, "comment_id": 88692558, "body": "The <code>require_all</code> method is the lazy way out and it might not be loading everything you expect, or loading it in the correct order. Have you tried, just for experimental purposes, of manually calling <code>require_relative</code> on each of the required files in the order they should be loaded? It&#39;s possible that whatever defines <code>DB</code> isn&#39;t loaded by the time that code is called."}, {"owner": {"reputation": 5565, "user_id": 1695507, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1f7f9576a6f6486bf26e4a8dbbf09868?s=128&d=identicon&r=PG", "display_name": "thumbtackthief", "link": "https://stackoverflow.com/users/1695507/thumbtackthief"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528917162, "post_id": 50844404, "comment_id": 88692640, "body": "I&#39;m fuzzy on how to use require, but <code>require_relative .&#47;lib&#47;author</code> doesn&#39;t fix the error, whether I put it before or after requiring the config/environment file.  Is there something else you think I should try?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528917202, "post_id": 50844404, "comment_id": 88692665, "body": "Where does <code>DB</code> get defined?"}, {"owner": {"reputation": 5565, "user_id": 1695507, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1f7f9576a6f6486bf26e4a8dbbf09868?s=128&d=identicon&r=PG", "display_name": "thumbtackthief", "link": "https://stackoverflow.com/users/1695507/thumbtackthief"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528917484, "post_id": 50844404, "comment_id": 88692805, "body": "in <code>config&#47;environment</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1528917654, "post_id": 50844404, "comment_id": 88692895, "body": "Are you sure you&#39;re loading that in? It&#39;s not in <code>lib&#47;</code> so maybe not in this code."}, {"owner": {"reputation": 5565, "user_id": 1695507, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1f7f9576a6f6486bf26e4a8dbbf09868?s=128&d=identicon&r=PG", "display_name": "thumbtackthief", "link": "https://stackoverflow.com/users/1695507/thumbtackthief"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528984981, "post_id": 50844404, "comment_id": 88721300, "body": "@tadman Yup, that was it.  Thanks!  Do you care enough about rep to turn it into an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1529009658, "creation_date": 1529009658, "answer_id": 50865785, "question_id": 50844404, "link": "https://stackoverflow.com/questions/50844404/ruby-class-expects-class-variable-but-only-in-rake-task/50865785#50865785", "title": "Ruby class expects class variable but only in Rake task", "body": "<p>When you see errors like \"uninitialized constant\" popping up and you're sure you've defined that constant in a file somewhere, make sure you're loading that code in before the method with the error runs.</p>\n\n<p>It looks like in this case <code>config/environment</code> wasn't loaded before <code>DB</code> was referenced, so it can't complete.</p>\n\n<p>Due to how Ruby searches for constants it's presented as <code>Author::DB</code> because the code was running inside of the <code>Author</code> namespace and that's where searches start.</p>\n"}], "owner": {"reputation": 5565, "user_id": 1695507, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1f7f9576a6f6486bf26e4a8dbbf09868?s=128&d=identicon&r=PG", "display_name": "thumbtackthief", "link": "https://stackoverflow.com/users/1695507/thumbtackthief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 50865785, "answer_count": 1, "score": 2, "last_activity_date": 1529009658, "creation_date": 1528916298, "question_id": 50844404, "link": "https://stackoverflow.com/questions/50844404/ruby-class-expects-class-variable-but-only-in-rake-task", "title": "Ruby class expects class variable but only in Rake task", "body": "<p>I am trying to seed my database with some dummy data, so I have this seed file:</p>\n\n<p>db/seeds.rb</p>\n\n<pre><code>require 'require_all'\nrequire_all 'lib'\n\nAuthor.create(name: \"Mark Twain\")\n</code></pre>\n\n<p>My Ruby model and relevant methods:</p>\n\n<p>lib/author.rb</p>\n\n<pre><code>class Author\n\n    attr_accessor :name, :id\n\n    def initialize(name, id=nil)\n        @name = name\n        @id = id\n    end\n\n    def self.make_object_from_row(row)\n        # [1, \"Mark Twain\"]\n        Author.new(row[1], row[0])\n    end\n\n    def self.create(name)\n        author = Author.new(name)\n        author.save\n    end\n\n    def save\n        if self.id.nil?  # doesn't exist in the database yet\n            sql = &lt;&lt;-SQL\n                INSERT INTO authors (name)\n                VALUES (?)\n            SQL\n            DB.execute(sql, self.name)\n            sql = \"SELECT last_insert_rowid()\"\n            self.id = DB.execute(sql)[0][0]\n        else # just update the row in the db\n            sql = &lt;&lt;-SQL\n                UPDATE authors SET (name) = ? WHERE id = ?\n            SQL\n            DB.execute(sql, self.name, self.id)\n        end\n    end\n</code></pre>\n\n<p>Rakefile</p>\n\n<pre><code>require_relative './config/environment'\n\ndesc \"Set up database\"\ntask :db_setup do\n    author_sql = &lt;&lt;-SQL\n        CREATE TABLE IF NOT EXISTS authors(\n            id integer PRIMARY KEY,\n            name varchar(255)\n        );\n    SQL\n    DB.execute(author_sql)\nend\n\ndesc \"Seed database\"\ntask :db_seed do\n    ruby \"db/seeds.rb\"\nend\n</code></pre>\n\n<p>config/environment.rb</p>\n\n<pre><code>require 'bundler/setup'\nBundler.require\n\n# setting up the database connection (old way)\nDB = SQLite3::Database.new(\"db/development.db\")\n\nrequire_relative '../lib/author.rb'\n</code></pre>\n\n<p>When I run the rake task for <code>db_seed</code> I get the error . <code>lib/author.rb:26:in save': uninitialized constant Author::DB (NameError)</code></p>\n\n<p>The <code>db_setup</code> Rake task works fine.  Also if I go into a pry from my console, I can instantiate a new Author without a problem (and it writes to the database).  If I run the seed file from my command line, I get the same error.</p>\n\n<p>I see that it's looking for an attribute <code>DB</code> on the Author class, but I don't see why, or why it's inconsistent in that I can create an Author from the command line but not from the Rake task--if the variable were undefined that shouldn't make a difference, correct?</p>\n\n<p>(I'm also aware that using ActiveRecord would be much easier, but I'm not looking to use it right now)</p>\n"}, {"tags": ["ruby", "heroku", "scheduler"], "answers": [{"tags": [], "owner": {"reputation": 29107, "user_id": 122080, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6fa1cdda524d49996a8bc6917328de3d?s=128&d=identicon&r=PG", "display_name": "Damien MATHIEU", "link": "https://stackoverflow.com/users/122080/damien-mathieu"}, "is_accepted": true, "score": 0, "last_activity_date": 1528963982, "creation_date": 1528963982, "answer_id": 50852675, "question_id": 50844377, "link": "https://stackoverflow.com/questions/50844377/does-heroku-scheduler-add-on-have-a-config-file/50852675#50852675", "title": "Does Heroku Scheduler add-on have a config file?", "body": "<p>Unfortunately, no. The Heroku Scheduler add-on can only be configured through the web app.</p>\n"}], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 50852675, "answer_count": 1, "score": 0, "last_activity_date": 1528963982, "creation_date": 1528916158, "question_id": 50844377, "link": "https://stackoverflow.com/questions/50844377/does-heroku-scheduler-add-on-have-a-config-file", "title": "Does Heroku Scheduler add-on have a config file?", "body": "<p>I was wondering if Heroku Scheduler add-on for Ruby allows some kind of config file where I can set there what tasks to run and when, the same way that I would do it from the Heroku dashboard. </p>\n\n<p>The reason I want this is because I have a lot of apps (development, staging, production) and I am too lazy to go set the Scheduler configuration for each one.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1528926110, "post_id": 50843040, "comment_id": 88696911, "body": "Your question needs to be clarified. You refer to &quot;start date&quot; and have a variable <code>deadline</code>. One would normally think they refer to a project start date and a deadline for completion of the project, but in the example they are the same date. Please edit to clarify. In the example, ensure all inputs are given and show the expected result for the given inputs. Choose data to reflect possible complications such as a vacation starting before the start date or after the completion date, and vacations overlapping if that&#39;s a possibility (and say so if that&#39;s not a possibility)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1528926638, "post_id": 50843040, "comment_id": 88697102, "body": "Another troublesome detail concerns vacations that start after the initial completion date but start before the completion date after the later is pushed later by one or more other vacations. In your edit please clarify whether that is a possibility."}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1528963869, "post_id": 50843040, "comment_id": 88708001, "body": "THanks @CarySwoveland there were some mistakes in the definition, hope it&#39;s clearer now"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1529000018, "post_id": 50843040, "comment_id": 88729553, "body": "Yes, it&#39;s clearer. I seem to have guessed right."}], "answers": [{"tags": [], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "is_accepted": false, "score": 0, "last_activity_date": 1528911627, "last_edit_date": 1528911627, "creation_date": 1528910859, "answer_id": 50843041, "question_id": 50843040, "link": "https://stackoverflow.com/questions/50843040/extend-deadline-with-duration-of-vacation/50843041#50843041", "title": "Extend deadline with duration of vacation", "body": "<p>So here's the first method I designed, I'm writing specs and maybe it's already good but I have doubts</p>\n\n<pre><code># Extends a deadline with extra time provided as \"vacations\"\n#\n# @param range: [Range&lt;Time&gt;]\n# @param vacations: [Array&lt;Range&lt;Time&gt;&gt;]\n#\n# @return [Range]\ndef extend_time_range_with_vacations(range:, vacations:)\n  extended_deadline = range.last.dup\n  vacations.each do |vacation|\n    cover = (range.first..extended_deadline) &amp; vacation\n    next unless cover.present?\n    # Here I need to pick more than just the intersection\n    #   For eg maybe the vacation is 2.weeks long\n    #   but the range started only in the 2nd week of the vacation,\n    #   hence the time extension is 1.week only)\n    actual_cover = cover.first..vacation.last\n    extended_deadline += (actual_cover.last - actual_cover.first)\n  end\n  extended_deadline\nend\n</code></pre>\n\n<p>But it feels like there's a lot to do and maybe something simpler exists ?</p>\n\n<p>EDIT : code changed to use <a href=\"https://stackoverflow.com/a/8415070/2832282\">this range intersection monkeypatch</a></p>\n\n<p>EDIT : Spec</p>\n\n<pre><code>describe '#extend_time_range_with_vacations' do\n  let(:start_d) { Time.parse('2018-04-20 8:42') }\n  let(:end_d) { start_d + 42.days }\n  let(:range) { start_d..end_d }\n  let(:vacations) do\n    [\n      (start_d - 4.days)..(start_d + 4.days), # 4 days extension out of 8\n      (start_d + 10.days)..(start_d + 14.days), # 4 days extension\n      (end_d + 4.days)..(end_d + 8.days), # 4 days extensions unlocked because of previous vacations\n    ]\n  end\n\n  it 'returns the expected extended deadline' do\n    new_range = Utility.extend_time_range_with_vacations(range: range, vacations: vacations)\n    expect(new_range).to be_within(1).of(end_d + (4 * 3).days)\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1529000012, "last_edit_date": 1529000012, "creation_date": 1528919367, "answer_id": 50845160, "question_id": 50843040, "link": "https://stackoverflow.com/questions/50843040/extend-deadline-with-duration-of-vacation/50845160#50845160", "title": "Extend deadline with duration of vacation", "body": "<p>I have addressed the following problem. We are given a start date and the number of days of work required to complete a project. We are also given an array of vacation periods. If the project has begun and by a given date has not been completed, no work is performed on that date if that date falls within any vacation period. Each vacation period is a range of consecutive days which may begin or end before the start date and which may overlap other vacation periods.<sup>1</sup>.</p>\n\n<p>The objective is to determine the date on which the project will be completed.</p>\n\n<p>The question is cast differently, but if my interpretation is accurate other than for the units (e.g., I've assumed date inputs and the date output are strings rather than <code>Time</code> objects`), it would not be difficult to modify my answer to be consistent with requirements.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>require 'date'\nrequire 'set'\n\nDATE_FMT = \"%Y-%m-%d\"\n\ndef end_date(start_date, duration, vacations)\n  start_date = Date.strptime(start_date, DATE_FMT)\n  vacation_dates = construct_vacations_dates_set(vacations)\n  d = start_date\n  while duration &gt; 0\n    duration -= 1 unless vacation_dates.include?(d)\n    d = d.next\n  end\n  d.strftime(DATE_FMT)\nend\n\ndef construct_vacations_dates_set(vacations)\n  vacations.map do |a|\n    s, e = a.map { |s| Date.strptime(s, DATE_FMT) }\n    (s..e).to_a\n  end.\n  reduce(:|).\n  to_set\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>start_date = '2017-12-15'\nvacations = [['2017-11-20', '2017-12-03'],\n             ['2017-12-13', '2017-12-19'],\n             ['2017-12-23', '2018-01-02'],\n             ['2017-12-29', '2018-01-08'],\n             ['2018-01-14', '2018-02-28'],\n             ['2018-05-18', '2018-06-01']]\n\n(1..20).each { |n| puts \"for duration %2d days: %s\" %\n   [n, end_date(start_date, n, vacations)] }\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>for duration  1 days: 2017-12-21\nfor duration  2 days: 2017-12-22\nfor duration  3 days: 2017-12-23\n\nfor duration  4 days: 2018-01-10\nfor duration  5 days: 2018-01-11\nfor duration  6 days: 2018-01-12\nfor duration  7 days: 2018-01-13\nfor duration  8 days: 2018-01-14\n\nfor duration  9 days: 2018-03-02\nfor duration 10 days: 2018-03-03\nfor duration 11 days: 2018-03-04\nfor duration 12 days: 2018-03-05\nfor duration 13 days: 2018-03-06\nfor duration 14 days: 2018-03-07\nfor duration 15 days: 2018-03-08\nfor duration 16 days: 2018-03-09\nfor duration 17 days: 2018-03-10\nfor duration 18 days: 2018-03-11\nfor duration 19 days: 2018-03-12\nfor duration 20 days: 2018-03-13\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>See <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/date/rdoc/Date.html#method-i-strftime\" rel=\"nofollow noreferrer\">Date#strftime</a>, \n<a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/date/rdoc/Date.html#method-c-strptime\" rel=\"nofollow noreferrer\">Date::strptime</a>, <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/date/rdoc/Date.html#method-i-next\" rel=\"nofollow noreferrer\">Date#next</a> (aka <code>next_day</code>) and <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\">Enumerable#reduce</a> (aka <code>inject</code>). <code>reduce</code> takes the \"set union\" of the vacation arrays (of consecutive dates) by applying the method <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-7C\" rel=\"nofollow noreferrer\">Array#|</a>.</p>\n\n<p>I converted the array of vacation dates to a set for fast lookups.\nFor the example given, if the elements of <code>vacation_dates</code> were converted to an array of non-overlapping ranges, and then the range endpoint were converted to date strings, that array would be as follows.</p>\n\n<pre><code>[\"2017-11-20\"..\"2017-12-03\",\n \"2017-12-13\"..\"2017-12-19\",\n \"2017-12-23\"..\"2018-01-08\",\n \"2018-01-14\"..\"2018-02-28\",\n \"2018-05-18\"..\"2018-06-01\"]\n</code></pre>\n\n<p>The first range is wholly before <code>start_date</code>, but there is no need to remove it. More generally, there is no need to remove vacation dates before <code>start_date</code>.</p>\n\n<p>The steps to compute the set of vacation dates can be seen by adding some <code>puts</code> statements. To improve readability I have removed <code>Date</code> objects that fall within ranges in the return value and printed lines, replacing groups of them with <code>,...,</code>. I also abbreviated <code>Date</code> objects. For example, I shortened <code>#&lt;Date: 2017-12-13 ((2458101j,0s,0n),+0s,2299161j)&gt;</code> to <code>#&lt;Date: 2017-12-13...&gt;</code>.</p>\n\n<pre><code>def construct_vacations_dates_set(vacations)\n  vacations.map do |a|\n      puts \"a = #{a}\"\n    s, e = a.map { |s| Date.strptime(s, DATE_FMT) }\n      puts \"  s = #{s}, e = #{e}\"\n    (s..e).to_a.\n      tap { |o| puts \"  (s..e).to_a = #{o}\" }\n  end.\n  reduce(:|).\n    tap { |o| puts \"after reduce(:|) = #{o}\" }.\n  to_set\nend\n\nconstruct_vacations_dates_set([['2017-12-13', '2017-12-19'],\n  ['2017-12-23', '2018-01-02'], ['2017-12-29', '2018-01-08']])\n  #=&gt; #&lt;Set: {#&lt;Date: 2017-12-13...&gt;,..., #&lt;Date: 2017-12-19...&gt;, \n  #           #&lt;Date: 2017-12-23...&gt;,..., #&lt;Date: 2018-01-08...&gt;}&gt;\n</code></pre>\n\n<p>prints (with elements in ranges not shown)</p>\n\n<pre><code>a = [\"2017-12-13\", \"2017-12-19\"]\n  s = 2017-12-13, e = 2017-12-19\n  (s..e).to_a = [#&lt;Date: 2017-12-13...&gt;,.., #&lt;Date: 2017-12-19..&gt;]\na = [\"2017-12-23\", \"2018-01-02\"]\n  s = 2017-12-23, e = 2018-01-02\n  (s..e).to_a = [#&lt;Date: 2017-12-23...&gt;,..., #&lt;Date: 2018-01-02...&gt;]\na = [\"2017-12-29\", \"2018-01-08\"]\n  s = 2017-12-29, e = 2018-01-08\n  (s..e).to_a = [#&lt;Date: 2017-12-29...&gt;,..., #&lt;Date: 2018-01-08...&gt;]\nafter reduce(:|) = [#&lt;Date: 2017-12-13...&gt;,..., #&lt;Date: 2017-12-19...&gt;,\n  #&lt;Date: 2017-12-23...&gt;,..., #&lt;Date: 2018-01-08...&gt;]\n</code></pre>\n\n<p><sup>1 My solution would be the same if it were guaranteed that vacation ranges do not overlap.</sup></p>\n"}], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1529000012, "creation_date": 1528910859, "last_edit_date": 1528963847, "question_id": 50843040, "link": "https://stackoverflow.com/questions/50843040/extend-deadline-with-duration-of-vacation", "title": "Extend deadline with duration of vacation", "body": "<p>Suppose I have some deadline time object <code>deadline = project_start + 34.days</code></p>\n\n<p>Now let's assume there is some sort of vacation/postpone business logic which must make me extend the deadline with the duration of those vacations.</p>\n\n<p>Let's assume my vacations are an array or ranges (or couple start/end date, whatever) And the project started on december 15th</p>\n\n<pre><code>project_start = Time.parse('2017-12-15 0:00') # December 15th\ndeadline = project_start + 34.days            # January 18th\n\nvacations = [\n  Time.parse('2017-12-10 0:00')..Time.parse('2018-01-20 0:00'), # Starts 5 days before the project start, so only 5 out of 10 days extend the deadline\n  Time.parse('2018-01-05 0:00')..Time.parse('2018-01-10 0:00'), # Starts during the project so whole vacation period must extend the deadline\n  Time.parse('2018-01-20 0:00')..Time.parse('2018-01-25 0:00'), # STarts after the original deadline, but dued to previous vacations, this vacation fully extends the deadline\n]\n</code></pre>\n\n<p>How can I (easily) compute the extended deadline taking into account the vacations ?</p>\n\n<p>I tried looking for existing solutions out there, but most gems I found involved static holidays, but I am interested in something that is per-user.</p>\n\n<p>Basically I was thinking of ordering the vacations, and extending the deadline at each step, but I need to take into account that maybe a vacation was started before the actual project start. It's becoming a bit hard to figure out the right thing to do. I'll post my first attempt at this</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "imagemagick"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 6, "creation_date": 1528910773, "post_id": 50843008, "comment_id": 88689520, "body": "You appear to have a space between <code>params</code> and <code>[:images]</code>, here: <code>if params [:images]</code>."}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 1, "creation_date": 1528911242, "post_id": 50843008, "comment_id": 88689756, "body": "And in Ruby, that means you&#39;re calling <code>params</code> with one argument, the one-element array <code>[:images]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1393, "user_id": 6206501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JENfJ.jpg?s=128&g=1", "display_name": "Abhilash Reddy", "link": "https://stackoverflow.com/users/6206501/abhilash-reddy"}, "is_accepted": false, "score": 1, "last_activity_date": 1528998582, "creation_date": 1528998582, "answer_id": 50863236, "question_id": 50843008, "link": "https://stackoverflow.com/questions/50843008/wrong-number-of-arguments-given-1-expected-0/50863236#50863236", "title": "wrong number of arguments (given 1, expected 0)", "body": "<p>In a Rails controller action, <code>params</code> is a Hash value and a Hash value is fetched like below:</p>\n\n<pre><code>params[:name]\n</code></pre>\n\n<p>In your code you're having an unwanted space between <code>params</code> and <code>[:images]</code> which means translates to calling a method by name <code>params</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9142978"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2733, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528998582, "creation_date": 1528910692, "last_edit_date": 1528911028, "question_id": 50843008, "link": "https://stackoverflow.com/questions/50843008/wrong-number-of-arguments-given-1-expected-0", "title": "wrong number of arguments (given 1, expected 0)", "body": "<p>I want to upload photos to my website. After i selected the photos and click on \"Add Photos\" this error comes up. Any ideas how i can solve this?<a href=\"https://i.stack.imgur.com/cECKS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cECKS.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>photos_controller.rb</p>\n\n<pre><code>class PhotosController &lt; ApplicationController\n\ndef create\n@wall = Wall.find(params[:wall_id])\n\nif params [:images]\n  params[:images].each do |img|\n    @wall.photos.create(image: img)\n  end\n\n  @photos = @wall.photos\n  redirect_back(fallback_location: request.referer, notice: \"Saved...\")\n\n end\n\nend\nend\n</code></pre>\n\n<p>walls.controller.rb</p>\n\n<pre><code>class WallsController &lt; ApplicationController\n  before_action :set_wall, except: [:index, :new, :create]\n  before_action :authenticate_user!, except: [:show]\n  before_action :is_authorised, only: [:listing, :pricing, :description, :photo_upload, :location, :update]\n\n  def index\n    @walls = current_user.walls\n  end\n\n  def new\n    @wall = current_user.walls.build\n  end\n\n  def create\n    @wall = current_user.walls.build(wall_params)\n    if @wall.save\n      redirect_to listing_wall_path(@wall), notice: \"Saved...\"\n    else\n      fash[:alert] = \"Something went wrong...\"\n      render :new\n    end\n  end\n\n\n  def photo_upload\n    @photos = @wall.photos\n  end\n\n  def location\n  end\n\n  def update\n    if @wall.update(wall_params)\n      flash[:notice] = \"Saved...\"\n    else\n      flash[:notice] = \"Something went wrong...\"\n    end\n    redirect_back(fallback_location: request.referer)\n  end\n\n  private\n\n    def set_wall\n      @wall = Wall.find(params[:id])\n    end\n\n    def is_authorised\n      redirect_to root_path, alert: \"You don't have permission\" unless current_user.id == @wall.user_id\n    end\n\n    def wall_params\n      params.require(:wall).permit(:size_sqm, :visibility, :traffic, :wall_name, :summary, :address, :price)\n    end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "parsing", "web-scraping", "nokogiri"], "comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1528909976, "post_id": 50842668, "comment_id": 88689084, "body": "Description string continue to change? You can use WATIR to do this Job? When you execute the code it will print what in the place description lies."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1528910023, "post_id": 50842668, "comment_id": 88689111, "body": "If you are ready to WATIR, let me know."}, {"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1528945889, "post_id": 50842668, "comment_id": 88701112, "body": "That&#39;s all stuff that gets added to the dom by React. So you need Watir or similar anyway for this."}, {"owner": {"reputation": 377, "user_id": 9937135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IvjeP.jpg?s=128&g=1", "display_name": "NicoBar", "link": "https://stackoverflow.com/users/9937135/nicobar"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1539856434, "post_id": 50842668, "comment_id": 92656335, "body": "@Rajagopalan I looked into WATIR and it looks like a good solution thank you! how can apply it in my case?"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1539860741, "post_id": 50842668, "comment_id": 92658651, "body": "refer WATIR here <code>http:&#47;&#47;watir.com&#47;guides&#47;</code> In your case, you can write <code>b.p(class: &#39;menu-index-page__item-desc&#39;).span.span.span.text</code>"}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 9770980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a95ff2b5bc3d66aae44bf2886ed92bb4?s=128&d=identicon&r=PG", "display_name": "Vitalii", "link": "https://stackoverflow.com/users/9770980/vitalii"}, "is_accepted": false, "score": 0, "last_activity_date": 1583225160, "creation_date": 1583225160, "answer_id": 60503268, "question_id": 50842668, "link": "https://stackoverflow.com/questions/50842668/scraping-text-within-several-span-tags-ruby-nokogiri/60503268#60503268", "title": "Scraping text within several span tags (Ruby &amp; Nokogiri)", "body": "<p>You can get the required value via xpath\n <code>//text()[contains(.,'Description')]</code></p>\n\n<p>You code and xpath:\n<a href=\"https://i.stack.imgur.com/uSn9q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uSn9q.png\" alt=\"xpath\"></a></p>\n"}], "owner": {"reputation": 377, "user_id": 9937135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IvjeP.jpg?s=128&g=1", "display_name": "NicoBar", "link": "https://stackoverflow.com/users/9937135/nicobar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583225160, "creation_date": 1528909448, "last_edit_date": 1528983840, "question_id": 50842668, "link": "https://stackoverflow.com/questions/50842668/scraping-text-within-several-span-tags-ruby-nokogiri", "title": "Scraping text within several span tags (Ruby &amp; Nokogiri)", "body": "<p>I am trying to scrape \"Description\" from this HTML structure</p>\n\n<pre><code>&lt;div class=\"menu-index-page__item-content\"&gt;\n &lt;h6 class=\"menu-index-page__item-title\"&gt;\n  &lt;span&gt; Item title &lt;/span&gt;\n &lt;/h6&gt;\n &lt;p class=\"menu-index-page__item-desc\"&gt;\n  &lt;span&gt;\n   &lt;span&gt;\n    &lt;span&gt;Description&lt;/span&gt;\n   &lt;/span&gt;\n  &lt;/span&gt;\n</code></pre>\n\n<p>Each tag has an element with it that I don't know how to handle:</p>\n\n<pre><code>data-reactid=\".3wrqgx5340.3.5.0.4:$523105.2.$3959254.$menuItemContent.1.0\"\n</code></pre>\n\n<p>Each data-reactid is different. So if I target this attribute I will scrape stuff I don't want.</p>\n\n<p>I've tried <code>.search</code> <code>.xpath</code>, using tags and classes but nothing seems to work.</p>\n\n<p>Is there a way to say: give me the p tag that has a class=\"menu-index-page__item-desc\" and scrape the 3rd span from there?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails", "slack"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 1, "last_activity_date": 1528911064, "creation_date": 1528911064, "answer_id": 50843086, "question_id": 50842090, "link": "https://stackoverflow.com/questions/50842090/rspec-testing-slack-bot-ruby/50843086#50843086", "title": "RSpec testing - slack bot ruby", "body": "<p>You can use the  <a href=\"https://github.com/DatabaseCleaner/database_cleaner\" rel=\"nofollow noreferrer\">database-cleaner</a> gem to wipe the DB between test runs. It lets you can create records in your test case as needed. It's also a good idea to use the <a href=\"https://github.com/travisjeffery/timecop\" rel=\"nofollow noreferrer\">timecop</a> whenever you are testing anything time-related, since it freezes your test case at any time and removes the unpredictability of <code>Time.now</code>. Assuming you have installed those - </p>\n\n<pre><code>it 'retrieves data and format it' do\n  # Freeze time at a point\n  base_time = Time.zone.now.beginning_of_day + 5.minutes\n  Timecop.freeze(base_time) do\n    # setup, create db records\n    # 2 in the current day, 1 in the previous day\n    Answer.create(slack_identifier: \"s1\", body: \"b1\", created_at: base_time)\n    Answer.create(slack_identifier: \"s2\", body: \"b2\", created_at: base_time + 1.minute)\n    Answer.create(slack_identifier: \"s3\", body: \"b3\", created_at: base_time - 1.day)\n    # call the method and verify the results\n    expect(StartCommand.new.call).to eq(\"s1:\\nb1\\n\\ns2:\\nb2\")\n  end\nend\n</code></pre>\n\n<p>You may also want to add an <code>order</code> to your <code>where</code> query. I don't think you can guarantee that ActiveRecord returns records in the same order each time unless you specify it (see <a href=\"https://stackoverflow.com/questions/5193076/rails-3-what-is-the-default-order-of-mymodel-all\">Rails 3: What is the default order of &quot;MyModel.all&quot;?</a>), and specifying it would make the test more dependable</p>\n"}], "owner": {"reputation": 51, "user_id": 9937206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad5dc0a1ab32d105345cffc4c0475b?s=128&d=identicon&r=PG&f=1", "display_name": "Noname", "link": "https://stackoverflow.com/users/9937206/noname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528911064, "creation_date": 1528907283, "last_edit_date": 1528908588, "question_id": 50842090, "link": "https://stackoverflow.com/questions/50842090/rspec-testing-slack-bot-ruby", "title": "RSpec testing - slack bot ruby", "body": "<p>I'm new at coding and I'm trying to implement RSpec testing to a command I made for my slack bot using Ruby. \nThe command retrieves the data from the database using .where(Time.zone.now.begining_of_day..Time.zone.now.end_of_day) => showed in the code down bellow.\nmap through each of them and format it for the user output</p>\n\n<p>Code:</p>\n\n<pre><code>Class StartCommand\n\n  def call\n    Answer.where(created_at: Time.zone.now.beginning_of_day..Time.zone.now.end_of_day)\n          .map { |answer| \"#{answer.slack_identifier}:\\n#{answer.body}\" }\n          .join(\"\\n\\n\")\n  end\nend\n</code></pre>\n\n<p>RSpec testing:</p>\n\n<pre><code>RSpec.describe RecordCommand do\n  describe '#call' do\n    it 'retrieves data and format it' do\n      StartCommand.new.call\n      expect(Answer.where).to eq()\n  end\nend  \n</code></pre>\n\n<p>As you can see I'm kinda lost how to implement the code in the RSpec testing, any ideas, hints or solutions would be awesome! Help! \nIm using Ruby and Ruby on Rails 4 </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "edited": false, "score": 1, "creation_date": 1528905945, "post_id": 50841540, "comment_id": 88686886, "body": "The second param for <code>slice</code> is length. Won&#39;t it always return a <code>nil</code> if its a negative integer?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528906567, "post_id": 50841540, "comment_id": 88687305, "body": "That is not valid JSON"}, {"owner": {"reputation": 85, "user_id": 3433707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62fa32e817831ca527bded4741db75af?s=128&d=identicon&r=PG&f=1", "display_name": "user13803", "link": "https://stackoverflow.com/users/3433707/user13803"}, "reply_to_user": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "edited": false, "score": 0, "creation_date": 1528909628, "post_id": 50841540, "comment_id": 88688897, "body": "@Sinstein Ah, good catch!  I misread the docs.  Obviously I am very much a beginner in Ruby. :)"}, {"owner": {"reputation": 85, "user_id": 3433707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62fa32e817831ca527bded4741db75af?s=128&d=identicon&r=PG&f=1", "display_name": "user13803", "link": "https://stackoverflow.com/users/3433707/user13803"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528909712, "post_id": 50841540, "comment_id": 88688946, "body": "@engineersmnky Fixed.  I made that up on the spot and it&#39;s not used so it&#39;s not terribly important. :)"}], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1528907252, "post_id": 50841875, "comment_id": 88687696, "body": "I like the second answer best! (But as OP mentioned ruby 2.3, they may not be able to fully utilise that, as you said)"}, {"owner": {"reputation": 85, "user_id": 3433707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62fa32e817831ca527bded4741db75af?s=128&d=identicon&r=PG&f=1", "display_name": "user13803", "link": "https://stackoverflow.com/users/3433707/user13803"}, "edited": false, "score": 0, "creation_date": 1528912914, "post_id": 50841875, "comment_id": 88690594, "body": "Very nice!  I prefer the method of transforming the hash to pass to gsub.  I have a question, though.  For this to work with my code I made the map block <code>my_config=my_config.map...(snip)...end.to_h</code>.  Is that what you would expect?  It looks a bit messy.  Is making a copy via map preferable to or more common than using each_key and then gsub! for in-place modification (like I did before)? Thanks!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528913210, "post_id": 50841875, "comment_id": 88690713, "body": "Indeed, <code>to_h</code> was intended, sorry."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1534698706, "post_id": 50841875, "comment_id": 90789803, "body": "Actually, the equivalent of <code>Hash#transform_values</code> has been around for a long time: <code>h.merge(h) { |_,value,_| ... }</code>."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1528913233, "last_edit_date": 1528913233, "creation_date": 1528906501, "answer_id": 50841875, "question_id": 50841540, "link": "https://stackoverflow.com/questions/50841540/how-do-i-make-these-string-substitutions-using-hash-keys-in-ruby/50841875#50841875", "title": "How do I make these string substitutions using hash keys in Ruby?", "body": "<p>Use <a href=\"https://ruby-doc.org/core/String.html#method-i-gsub\" rel=\"nofollow noreferrer\"><code>String#gsub</code></a> with an initial hash for replacements:</p>\n\n<pre><code>my_config.map do |k, v|\n  [\n    k,\n    v.gsub(/(?&lt;={)[^}]+(?=})/, my_config).gsub(/{(?!})|(?&lt;!{)}/, '')\n  ]\nend.to_h\n#\u21d2 {\"KEY1\"=&gt;\"foo\",\n#   \"KEY2\"=&gt;\"bar\",\n#   \"URL\"=&gt;\"https://bar.com/foo\",\n#   \"IMPORTANT_THING\"=&gt;\"repos/foo\",\n#   \"NOTE\"=&gt;\"This thing is foobared\",\n#   \"PYTHON_ONLY_THING\"=&gt;\"{}/test/{}.py\"}\n</code></pre>\n\n<p>Starting with Ruby 2.4 (or using Rails) it might be done simpler using <code>Hash#transform_values</code>. </p>\n\n<p>If you dislike the second gsubbing, transform the hash upfront:</p>\n\n<pre><code>my_substs = my_config.map { |k, v| [\"{#{k}}\", v] }.to_h\nmy_config.map do |k, v|\n  [k, v.gsub(/{[^}]+}/, my_substs)]\nend.to_h\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1528906851, "post_id": 50841946, "comment_id": 88687464, "body": "<a href=\"https://ruby-doc.org/core/String.html#method-i-gsub\" rel=\"nofollow noreferrer\"><code>String#gsub</code></a> accepts a hash as replacements :)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528906928, "post_id": 50841946, "comment_id": 88687505, "body": "Yeah, true... But this method has a slightly less confusing regex :)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528907503, "post_id": 50841946, "comment_id": 88687804, "body": "It&#39;s also a lot slower since this requires doing N*M passes on the string instead of just N."}, {"owner": {"reputation": 85, "user_id": 3433707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62fa32e817831ca527bded4741db75af?s=128&d=identicon&r=PG&f=1", "display_name": "user13803", "link": "https://stackoverflow.com/users/3433707/user13803"}, "edited": false, "score": 0, "creation_date": 1528913254, "post_id": 50841946, "comment_id": 88690740, "body": "Thank you!  I greatly appreciate the thorough explanations and the additional error checking.  I understood it very quickly and it worked on my test code as-is."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 2, "last_activity_date": 1528906898, "last_edit_date": 1528906898, "creation_date": 1528906783, "answer_id": 50841946, "question_id": 50841540, "link": "https://stackoverflow.com/questions/50841540/how-do-i-make-these-string-substitutions-using-hash-keys-in-ruby/50841946#50841946", "title": "How do I make these string substitutions using hash keys in Ruby?", "body": "<p>Here's a possible solution:</p>\n\n<pre><code>my_config = {\"KEY1\"=&gt;\"foo\",\n             \"KEY2\"=&gt;\"bar\",\n             \"URL\"=&gt;\"https://{KEY2}.com/{KEY1}\",\n             \"IMPORTANT_THING\"=&gt;\"repos/{KEY1}\",\n             \"NOTE\"=&gt;\"This thing is {KEY1}{KEY2}ed\",\n             \"PYTHON_ONLY_THING\"=&gt;\"{}/test/{}.py\"}\n\nmy_config.each_key do |key|\n  placeholders = my_config[key].scan(/{([^}]+)}/).flatten\n  placeholders.each do |placeholder|\n    my_config[key].gsub!(\"{#{placeholder}}\", my_config[placeholder]) if my_config.keys.include?(placeholder)\n  end\nend\n\nputs my_config\n</code></pre>\n\n<ul>\n<li>By using <code>scan</code>, this will substitute all matches, not just the first match.</li>\n<li>Using <code>[[^}]+</code> in the regex, rather than <code>.*</code>, means you won't \"swallow\" too much in this part of the match. For example, if the input contains <code>\"{FOO} bar {BAZ}\"</code>, then you want that pattern to only capture <code>FOO</code> and <code>BAZ</code>, not <code>FOO} bar {BAZ</code>.</li>\n<li>Grouping the scan result, then calling <code>flatten</code>, is an easy way to reject what's outside the capture group, i.e. in this case the <code>{</code> and <code>}</code> characters. (This just makes the code a little less cryptic than using indexes like <code>slice(1,-2)</code>!</li>\n<li><code>my_config.keys.include?(placeholder)</code> checks whether this is actually . a known value, so you don't replace things with <code>nil</code>.</li>\n</ul>\n"}], "owner": {"reputation": 85, "user_id": 3433707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62fa32e817831ca527bded4741db75af?s=128&d=identicon&r=PG&f=1", "display_name": "user13803", "link": "https://stackoverflow.com/users/3433707/user13803"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 50841875, "answer_count": 2, "score": 1, "last_activity_date": 1528913233, "creation_date": 1528905422, "last_edit_date": 1528909448, "question_id": 50841540, "link": "https://stackoverflow.com/questions/50841540/how-do-i-make-these-string-substitutions-using-hash-keys-in-ruby", "title": "How do I make these string substitutions using hash keys in Ruby?", "body": "<p>I have a bunch of JSON files, processed in both Python and Ruby, that look something like this:</p>\n\n<pre><code>{\n    \"KEY1\": \"foo\",\n    \"KEY2\": \"bar\",\n\n    \"URL\": \"https://{KEY2}.com/{KEY1}\",\n    \"IMPORTANT_THING\": \"repos/{KEY1}\",\n    \"NOTE\": \"This thing is {KEY1}{KEY2}ed\",\n    \"PYTHON_ONLY_THING\": \"{}/test/{}.py\"\n}\n</code></pre>\n\n<p>Note that the order that the keys will show up is not consistent, and I'd rather not change the JSON.</p>\n\n<p>Here's my test code showing what I've tried so far:</p>\n\n<pre><code>my_config = {\"KEY1\"=&gt;\"foo\",\n             \"KEY2\"=&gt;\"bar\",\n             \"URL\"=&gt;\"https://{KEY2}.com/{KEY1}\",\n             \"IMPORTANT_THING\"=&gt;\"repos/{KEY1}\",\n             \"NOTE\"=&gt;\"This thing is {KEY1}{KEY2}ed\",\n             \"PYTHON_ONLY_THING\"=&gt;\"{}/test/{}.py\"}\n\nmy_config.each_key do |key|\n    # Braindead, hard-coded solution that works:\n    # my_config[key].gsub!(\"{KEY1}\", my_config[\"KEY1\"])\n    # my_config[key].gsub!(\"{KEY2}\", my_config[\"KEY2\"])\n\n    # More flexible (if it would work):\n    # my_config[key].gsub!(/{.*}/, my_config['\\0'.slice(1,-2)])\n    my_config[key].gsub!(/{.*}/) {|s| my_config[s.slice(1,-2)]}\nend\n\nputs my_config\n</code></pre>\n\n<p>I'm using the braindead solution for now, which produces the expected output:</p>\n\n<pre><code>{\"KEY1\"=&gt;\"foo\", \"KEY2\"=&gt;\"bar\", \"URL\"=&gt;\"https://bar.com/foo\", \"IMPORTANT_THING\"=&gt;\"repos/foo\", \"NOTE\"=&gt;\"This thing is foobared\", \"PYTHON_ONLY_THING\"=&gt;\"{}/test/{}.py\"}\n</code></pre>\n\n<p>But I want to make it more flexible and maintainable.  The first \"better\" solution throws an error apparently because slice operates on '\\0' itself and not the match, plus I'm not sure it would match more than once.  The currently uncommented solution doesn't work because the second part seems to operate on one letter at a time rather than each match like I expected, so it just removes the stuff in curly braces.  Worse, it removes everything between the outer braces in the PYTHON_ONLY_THING, which is no good.</p>\n\n<p>I figure I need to change both my regex and Ruby code if this is going to work, but I'm not sure where to look for more help.  Or perhaps gsub isn't the right tool for this job.  Any ideas?</p>\n\n<p>I am using Ruby 2.3.7 on Linux x86_64.</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "edited": false, "score": 0, "creation_date": 1528907859, "post_id": 50841519, "comment_id": 88687976, "body": "<a href=\"https://stackoverflow.com/a/1732454/2651076\">stackoverflow.com/a/1732454/2651076</a>"}, {"owner": {"reputation": 366, "user_id": 4614867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yFfs7.jpg?s=128&g=1", "display_name": "StragaSevera", "link": "https://stackoverflow.com/users/4614867/stragasevera"}, "reply_to_user": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "edited": false, "score": 0, "creation_date": 1528913189, "post_id": 50841519, "comment_id": 88690704, "body": "Thank you, but I do not intend to parse HTML by Regex - in fact, I explicitly called it &quot;a dumb way&quot; =-)"}], "answers": [{"comments": [{"owner": {"reputation": 366, "user_id": 4614867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yFfs7.jpg?s=128&g=1", "display_name": "StragaSevera", "link": "https://stackoverflow.com/users/4614867/stragasevera"}, "edited": false, "score": 0, "creation_date": 1528912675, "post_id": 50842241, "comment_id": 88690488, "body": "Sorry, but for further processing I need paired tags."}], "tags": [], "owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "is_accepted": false, "score": 0, "last_activity_date": 1528907824, "creation_date": 1528907824, "answer_id": 50842241, "question_id": 50841519, "link": "https://stackoverflow.com/questions/50841519/how-to-insert-paragraph-tags-on-newlines-without-tag-overlapping/50842241#50842241", "title": "How to insert paragraph tags on newlines without tag overlapping?", "body": "<p>Insert HTML <code>&lt;br&gt;</code> tags. They are well-defined as standalone tags that don't have paired end tags. If XHTML were still a thing, they would be <code>&lt;br/&gt;</code> tags.</p>\n"}, {"comments": [{"owner": {"reputation": 366, "user_id": 4614867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yFfs7.jpg?s=128&g=1", "display_name": "StragaSevera", "link": "https://stackoverflow.com/users/4614867/stragasevera"}, "edited": false, "score": 0, "creation_date": 1528912671, "post_id": 50843163, "comment_id": 88690487, "body": "Sorry, but for further processing I need paired tags."}], "tags": [], "owner": {"reputation": 33, "user_id": 9931710, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KynKJuf10kM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1faVisSp7bg5Xn85QkTA91zktRyw/mo/photo.jpg?sz=128", "display_name": "Aeveritt84", "link": "https://stackoverflow.com/users/9931710/aeveritt84"}, "is_accepted": false, "score": 0, "last_activity_date": 1528928266, "last_edit_date": 1528928266, "creation_date": 1528911388, "answer_id": 50843163, "question_id": 50841519, "link": "https://stackoverflow.com/questions/50841519/how-to-insert-paragraph-tags-on-newlines-without-tag-overlapping/50843163#50843163", "title": "How to insert paragraph tags on newlines without tag overlapping?", "body": "<p>By adding a <code>&lt;br&gt;</code> tag you can insert a single line break. It also has no end tag, so no need to try and close it. </p>\n\n<p><a href=\"https://codepen.io/aeveritt84/pen/wXeYMv\" rel=\"nofollow noreferrer\">W3Schools - &lt; br > Tag</a></p>\n\n<h1>UPDATED:</h1>\n\n<p>If you need paired tags you could create a line break using CSS.</p>\n\n<h1><strong>HTML</strong></h1>\n\n<pre><code>&lt;p class=\"break\"&gt;\n  Break right after this and\n  &lt;span&gt;before this&lt;/span&gt;\n&lt;/p&gt;\n</code></pre>\n\n<h1><strong>CSS</strong></h1>\n\n<pre><code>p.break {\n  span {\n    display: table;\n  }\n}\n</code></pre>\n\n<p>As shown here on <a href=\"https://codepen.io/aeveritt84/pen/wXeYMv\" rel=\"nofollow noreferrer\">Codepen</a>.</p>\n"}], "owner": {"reputation": 366, "user_id": 4614867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yFfs7.jpg?s=128&g=1", "display_name": "StragaSevera", "link": "https://stackoverflow.com/users/4614867/stragasevera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1528928266, "creation_date": 1528905358, "last_edit_date": 1528912778, "question_id": 50841519, "link": "https://stackoverflow.com/questions/50841519/how-to-insert-paragraph-tags-on-newlines-without-tag-overlapping", "title": "How to insert paragraph tags on newlines without tag overlapping?", "body": "<p>I have a string with some HTML markup, but without any paragraphs. I want to replace newlines with paragraph tags, but if I do it \"the dumb way\":</p>\n\n<pre><code>html.gsub!(/\\s*\\n+\\s*/, '&lt;/p&gt;&lt;p&gt;')\nhtml = '&lt;p&gt;' + html + '&lt;/p&gt;'\n</code></pre>\n\n<p>, then I will get markup overlapping:</p>\n\n<pre><code>This is text. &lt;b&gt;Bold text.\\n\nStill bold,&lt;/b&gt; now plain.\n</code></pre>\n\n<p>becomes:</p>\n\n<pre><code>&lt;p&gt;This is text. &lt;b&gt;Bold text.&lt;/p&gt;&lt;p&gt;Still bold,&lt;/b&gt; now plain.&lt;/p&gt;\n</code></pre>\n\n<p>I know that HTML5 allows overlapping tags, but it is still very-very ugly. I want to get something like this:</p>\n\n<pre><code>&lt;p&gt;This is text. &lt;b&gt;Bold text.&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Still bold,&lt;/b&gt; now plain.&lt;/p&gt;\n</code></pre>\n\n<p>How can I fix this problem?</p>\n\n<p>UPD. <code>&lt;br/&gt;</code> is not what I need - I intend to use Kramdown with custom parser to generate Markdown from this string, and in the string I need open and closing tag for each paragraph.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "edited": false, "score": 0, "creation_date": 1528907475, "post_id": 50840792, "comment_id": 88687793, "body": "What have you tried so far? Can you share where you are getting stuck?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "edited": false, "score": 0, "creation_date": 1528908083, "post_id": 50840792, "comment_id": 88688079, "body": "@Sinstein . I am not able to figure out how to check or uncheck the admin and superadmin fields so that the boolean for these fields changes in the database."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "edited": false, "score": 0, "creation_date": 1528908214, "post_id": 50840792, "comment_id": 88688154, "body": "@Sinstein please check the update above. how can i uncheck to remove or check to assign so that the boolean for admin or superadmin changes in the database."}], "answers": [{"tags": [], "owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "is_accepted": false, "score": 0, "last_activity_date": 1529482502, "creation_date": 1529482502, "answer_id": 50943458, "question_id": 50840792, "link": "https://stackoverflow.com/questions/50840792/checkbox-to-toggle-admin-in-rails/50943458#50943458", "title": "Checkbox to toggle admin in rails", "body": "<p>One approach can be like this: </p>\n\n<ul>\n<li><p>Change the <code>check_box</code> fields to </p>\n\n<p><pre><code>&lt;%= check_box_tag 'admin', true,  parent.admin, class: 'status', data: {id: parent.id, type: 'admin'} %>\n&lt;%= check_box_tag 'superadmin', true, parent.superadmin, class: 'status', data {id: parent.id, type: 'superadmin' }%></pre></code></p></li>\n<li><p>Add this javascript</p>\n\n<p><pre><code>$(\".status\").on('change', function(){\n    var $this = $(this) \n    var parent_id = $this.data('id'); \n    $.ajax({\n      url: 'status/parent/' + parent_id,\n      type: 'POST',\n      data: {type: $this.data('type'), value: this.checked }\n    });\n  });</pre></code></p></li>\n<li><p>Add this at <code>ParentsController</code></p>\n\n<p><pre><code>def change_status\n   @parent = Parent.find(params[:id])<br>\n   if @parent.update_attributes(params[:type] => params[:value])\n      redirect_to parents_path\n   end\nend</pre></code></p></li>\n<li><p>And this to the <code>routes.rb</code> file </p>\n\n<p><pre><code>post 'status/parent/:id' => 'parents#change_status'</pre></code></p></li>\n</ul>\n\n<p>In the controller the <code>:id</code> from the path ends up in <code>params[:id]</code>. The data from the ajax request also ends up in the params hash, hence <code>params[:type]</code> and <code>params[:value]</code>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "is_accepted": true, "score": 0, "last_activity_date": 1538082471, "creation_date": 1538082471, "answer_id": 52545142, "question_id": 50840792, "link": "https://stackoverflow.com/questions/50840792/checkbox-to-toggle-admin-in-rails/52545142#52545142", "title": "Checkbox to toggle admin in rails", "body": "<pre><code>&lt;%= form_tag update_status_path, :method =&gt; 'patch' do %&gt;\n &lt;tbody&gt;\n  &lt;% @parents.each do |parent| %&gt;\n   &lt;tr&gt; \n    &lt;td&gt;&lt;%= link_to parent.email,parent_path(parent) %&gt;&lt;/td&gt;\n     &lt;td&gt;&lt;%= check_box_tag \"parents[#{parent.id}][admin]\", true, parent.admin, class: 'status', data: {id: parent.id, type: 'admin'} %&gt;&lt;/td&gt;\n     &lt;td&gt;&lt;%= check_box_tag \"parents[#{parent.id}][superadmin]\", true, parent.superadmin, class: 'status', data: {id: parent.id, type: 'superadmin'} %&gt;&lt;/td&gt;\n   &lt;/tr&gt;\n  &lt;% end %&gt;\n &lt;/tbody&gt;\n</code></pre>\n\n<p>parents_controller.rb</p>\n\n<pre><code>def manage_users\n    @parents = Parent.search(params[:search]).order(params[:sort]).admins\n    @parents_to_update = []\nend\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>get 'main-admin/manage-users', to: 'parents#manage_users'\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 52545142, "answer_count": 2, "score": 0, "last_activity_date": 1538082471, "creation_date": 1528903045, "last_edit_date": 1528913961, "question_id": 50840792, "link": "https://stackoverflow.com/questions/50840792/checkbox-to-toggle-admin-in-rails", "title": "Checkbox to toggle admin in rails", "body": "<p>I have a parent table in which there is admin and superadmin field. Superadmin can assign other parents as admin or superadmin. I want a checkbox in front of list of parents showing that if any checkbox is checked shows that the particular parent is admin or superadmin and if nothing is checked shows that the particular parent is neither an admin nor  superadmin.How can a superadmin assign or remove any that particular parent as admin or superadmin by just unchecking the checked box. please help</p>\n\n<p><a href=\"https://i.stack.imgur.com/YkMyg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YkMyg.png\" alt=\"sample image of my requirement\"></a></p>\n\n<p>Update</p>\n\n<pre><code>&lt;td&gt;&lt;%= check_box_tag 'admin', true, parent.admin, :onclick =&gt; 'this.form.submit()'  %&gt;&lt;/td&gt;\n&lt;td&gt;&lt;%= check_box_tag 'superadmin', true, parent.superadmin, :onclick =&gt; 'this.form.submit()'  %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>how can I uncheck the admin or superadmin and that parent is removed as admin or superadmin respectively.</p>\n\n<p>Update\n<a href=\"https://i.stack.imgur.com/1eWvC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1eWvC.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "design-patterns"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1528899525, "post_id": 50839490, "comment_id": 88682803, "body": "What do you mean &quot;<code>else</code> loop&quot;? Why would you <i>modify</i> <code>startDate</code> instead of just validate it? Why are you doing it here instead of in normal validation logic?"}, {"owner": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1528899812, "post_id": 50839490, "comment_id": 88683021, "body": "validating the input is one part of it. i&#39;ll have to assign it a default value if the validation fails based on the user type. These checks are to applied for multiple actions and not just one."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1528900219, "post_id": 50839490, "comment_id": 88683301, "body": "Then this should be done in a validation method or callback. The method can live in a utility class so the business logic is isolated. That said, IMO this is a suspicious requirement: if a user enters an incorrect date they should correct it, not get a default value that may not reflect reality."}, {"owner": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1528900991, "post_id": 50839490, "comment_id": 88683845, "body": "let me elaborate on that.The backend services we make a call to has some data attributed on all the dates. But, the requirement is in a way that when the user type got changed from one to another, we should show the relevant info only from the date the type has changed. So, if a student has become a professor on 15th May and he selects last 3 months as the date range, controller should modify the start date to 15th May because the data attributed to the user before 15th May is invalid and shouldn&#39;t be shown. We can clear DB but it is used by other systems."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1528901332, "post_id": 50839490, "comment_id": 88684075, "body": "IMO the controller should <i>not</i> do that. Controllers are a thin line between the web and the business logic. Business logic should be implemented in models and/or utilities and/or concerns. Transforming data is not the job of a controller."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1528901486, "post_id": 50839490, "comment_id": 88684193, "body": "@DaveNewton - My Hero! POROs for business logic == unicorns and lemon drops."}, {"owner": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "edited": false, "score": 0, "creation_date": 1528901594, "post_id": 50839490, "comment_id": 88684275, "body": "I cannot agree more. How well can a utility be written that doesn&#39;t the if-else loops. Because, there can be reqs where similiar validations can be placed on other params or the number of user types might keep increasing. Is there a polymorphis(for the lack of better word) way of seperating the concerns according to type and keep the code clean"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1528902297, "post_id": 50839490, "comment_id": 88684746, "body": "@Sanjay I don&#39;t know why you keep saying &quot;loop&quot;. There&#39;s no loop. Yes, they&#39;re called &quot;concerns&quot;. Or it can just be a utility class used where needed."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1528907877, "post_id": 50839490, "comment_id": 88687986, "body": "@Sanjay - Did you take a look at my answer? PORO service with no <code>if</code> logic."}], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1528901026, "post_id": 50840031, "comment_id": 88683871, "body": "It seems like you may want <code>start_date = </code> to be <code>params[:start_date] = </code>, no? Otherwise, <code>start_date</code> is just a local variable to <code>set_start_date</code> and doesn&#39;t do anything. Or, perhaps I&#39;m misunderstanding."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 2, "creation_date": 1528901082, "post_id": 50840031, "comment_id": 88683919, "body": "@jvillian more like <code>self.start_date =</code>. No <code>params</code> in the model. :)"}, {"owner": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "edited": false, "score": 0, "creation_date": 1528901126, "post_id": 50840031, "comment_id": 88683946, "body": "true that. it should be params[:start_date] and should be replaced with MIN_STU_START_DATE only if it isn&#39;t already"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "edited": false, "score": 0, "creation_date": 1528901164, "post_id": 50840031, "comment_id": 88683974, "body": "@Sanjay No. There is no <code>params</code> in the model."}, {"owner": {"reputation": 160, "user_id": 5858777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sz22L.jpg?s=128&g=1", "display_name": "Isaiah Fasoldt", "link": "https://stackoverflow.com/users/5858777/isaiah-fasoldt"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1528901257, "post_id": 50840031, "comment_id": 88684027, "body": "Yup, forgot the <code>self</code> thanks @SergioTulentsev  At the point where a before_validation runs, the <code>start_date</code> should have already been set. If not, there should probably be another validation to reject and prompt the user to set one. Or I suppose one could set for the user  since that seems to be the sort of thing this client is into..."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1528901259, "post_id": 50840031, "comment_id": 88684029, "body": "Personally I&#39;d put the date logic somewhere else entirely and refer to it in the <code>User</code> model since OP says this runs across models. That means it&#39;s likely a concern, or a simple utility class. I&#39;d also put the types/dates in a hash, validate the key, and wrap it all up."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1528901270, "post_id": 50840031, "comment_id": 88684037, "body": "Sorry, I was thinking about the original question which was in the context of a controller, not a model. And, I missed the <code>class User</code> in Isaiah&#39;s answer. It is unclear to me from the question whether <code>start_date</code> is an attribute of <code>User</code>... Personally, I would put this in a simple utility class. (Concerns, ew!)"}, {"owner": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1528901290, "post_id": 50840031, "comment_id": 88684051, "body": "@DaveNewton i am sorry, i think we are getting off track, model receives the start Date as one of the parameters. params are definitely controller&#39;s thing. i was just replying to another comment on this thread."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "edited": false, "score": 0, "creation_date": 1528901393, "post_id": 50840031, "comment_id": 88684118, "body": "@Sanjay Params are a controller thing. This is not a controller. Nor does this logic belong in a controller."}, {"owner": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1528901659, "post_id": 50840031, "comment_id": 88684320, "body": "I give up @DaveNewton, i know params are controller thing, code block used in my question is from controller, whereas the class User used in this solution is a Model."}, {"owner": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "edited": false, "score": 0, "creation_date": 1528902211, "post_id": 50840031, "comment_id": 88684673, "body": "@IsaiahFasoldt, as i mentioned in the question, User Model has nothing to do with it, we use user&#39;s type and then pass on the startdate to different models for different actions, like Reports Model to fetch reports, Referral Model, transactions Model etc.. And it doesn&#39;t make sense to add these validations at each model level. so, the best thing in my opinion is to, validate and update before the model comes into picture"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "edited": false, "score": 0, "creation_date": 1528902385, "post_id": 50840031, "comment_id": 88684810, "body": "@Sanjay You&#39;re setting a date on a user. How does the user model have nothing to do with it? Regardless: controllers are not the place to transform data: controllers are a place to take in request data and decide what to do next. Models or business logic services are the place to transform data."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "edited": false, "score": 0, "creation_date": 1528902436, "post_id": 50840031, "comment_id": 88684847, "body": "@Sanjay Correct; this shouldn&#39;t be done in the controller, hence there&#39;s no <code>params</code> in the <code>User</code> model shown here."}, {"owner": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1528902717, "post_id": 50840031, "comment_id": 88685024, "body": "@DaveNewton i think it was my mistake to throw User Model into the question. Based on which user is accessing the website (fetched from User singleton), start date should be modified before passed onto any model(Reports, Downloads, Transactions, Referrals etc..) This logic shouldn&#39;t be in controller and i agree, i am just looking at the best way to approach this, so that the utility/concern doesn&#39;t have if else looping hell."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "edited": false, "score": 1, "creation_date": 1528903871, "post_id": 50840031, "comment_id": 88685725, "body": "@Sanjay There is no loop. I&#39;m not sure what you mean by &quot;singleton&quot; here; if there is a single instance of a <code>User</code> following around requests, you&#39;ve just built a single-user system that two people cannot use at once, which seems bizarre."}], "tags": [], "owner": {"reputation": 160, "user_id": 5858777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sz22L.jpg?s=128&g=1", "display_name": "Isaiah Fasoldt", "link": "https://stackoverflow.com/users/5858777/isaiah-fasoldt"}, "is_accepted": false, "score": 0, "last_activity_date": 1528901221, "last_edit_date": 1528901221, "creation_date": 1528900868, "answer_id": 50840031, "question_id": 50839490, "link": "https://stackoverflow.com/questions/50839490/rails-design-pattern-to-modify-params-based-on-users-type-before-passing-on-to/50840031#50840031", "title": "Rails: Design pattern to modify params based on users type before passing on to model", "body": "<p>As Dave notes, this is odd behavior. However, if you must alter the start_date, consider using a before_validation callback. It's much safer/cleaner NOT to alter the incoming params, but do it at the model level.</p>\n\n<pre><code>class User\n\nMINIMUM_STUDENT_START_DATE = '12-03-2018'\nMINIMUM_PROFESSOR_START_DATE = '01-01-2018'\n\nbefore_validation :set_start_date\n\ndef set_start_date\n  if type == 'student' &amp;&amp; start_date &lt; MINIMUM_STUDENT_START_DATE\n    self.start_date = MINIMUM_STUDENT_START_DATE\n  elsif type == 'professor' &amp;&amp; start_date &lt; MINIMUM_PROFESSOR_START_DATE\n    self.start_date = MINIMUM_PROFESSOR_START_DATE\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "edited": false, "score": 1, "creation_date": 1528909192, "post_id": 50840733, "comment_id": 88688654, "body": "Thanks a ton @jvillian, i was looking for something exactly like this. clean code, a design pattern, no duplication."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "edited": false, "score": 0, "creation_date": 1528910236, "post_id": 50840733, "comment_id": 88689239, "body": "Glad it&#39;s helpful. Good luck!"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 2, "last_activity_date": 1528904681, "last_edit_date": 1528904681, "creation_date": 1528902889, "answer_id": 50840733, "question_id": 50839490, "link": "https://stackoverflow.com/questions/50839490/rails-design-pattern-to-modify-params-based-on-users-type-before-passing-on-to/50840733#50840733", "title": "Rails: Design pattern to modify params based on users type before passing on to model", "body": "<p>Perhaps you could do something like:</p>\n\n<pre><code>before_action :filtered_params\n\ndef filtered_params\n  @filtered_params ||= get_filtered_params\nend\n\ndef get_filtered_params\n  # not sure about this user assignment, but let's go with it...\n  user = User.instance\n  begin\n    \"ParamsFilter::#{user.type.camelize}Service\".constantize.call params\n  rescue NameError =&gt; e\n    # I'm guessing at the default behavior here. You would need to \n    # modify to meet your requirements.\n    return params.require(:query).permit(:start_date)\n  end\nend\n</code></pre>\n\n<p>Then you would need something like:</p>\n\n<pre><code>app\n |- services\n |   |- params_filter\n |   |   |- service_base.rb\n |   |   |- student_service.rb\n |   |   |- professor_service.rb\n |   |- service_base.rb\n</code></pre>\n\n<p>And a service might look something like </p>\n\n<pre><code>class ParamsFilter::StudentService &lt; ParamsFilter::ServiceBase\n\n  MIN_START_DATE = '12-03-2018'\n\n  #======================================================================\n  # Instance Methods\n  #======================================================================\n\n    def call\n      # In this case, given how ServiceBase is defined, the params will \n      # be received as `args`, so you'll need to work with the `args` \n      # variable, which will contain `params`.\n\n      # You could do stuff unique to `student`:\n      student_stuff\n\n      # and then do some common stuff by calling `super`.\n      super\n\n    end\n\n  private\n\n    def student_stuff\n    end\n\nend\n</code></pre>\n\n<p>Where <code>ParamsFilter::ServiceBase</code> might look something like: </p>\n\n<pre><code>class ParamsFilter::ServiceBase &lt; ServiceBase\n\n  #======================================================================\n  # Instance Methods\n  #======================================================================\n\n    def call\n      args[:start_date] = self.class::MIN_START_DATE unless start_date_okay?\n    end\n\n  private \n\n    def start_date_okay?\n      args[:start_date] &gt;= self.class::MIN_START_DATE\n    end\n\nend\n</code></pre>\n\n<p>Where <code>service_base.rb</code> might look something like: </p>\n\n<pre><code>class ServiceBase\n\n  attr_accessor *%w(\n    args\n  ).freeze\n\n  class &lt;&lt; self\n\n    def call(args=nil)\n      new(args).call\n    end\n\n  end # Class Methods\n\n  #======================================================================\n  # Instance Methods\n  #======================================================================\n\n  def initialize(args)\n    @args = args\n  end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5256499, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9598764e53ac390fce6040d2bd8eea49?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/5256499/sanjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 50840733, "answer_count": 2, "score": 0, "last_activity_date": 1528904681, "creation_date": 1528899381, "question_id": 50839490, "link": "https://stackoverflow.com/questions/50839490/rails-design-pattern-to-modify-params-based-on-users-type-before-passing-on-to", "title": "Rails: Design pattern to modify params based on users type before passing on to model", "body": "<p>There are mulitple controller actions that receive startDate as a parameter and pass it on to relevant models to fetch the data. Based on a user property, there are validation rules that has to be applied on this parameter. Validation wouldn't just fail, but instead assigns a default value specific to that user property.</p>\n\n<p>The modification required on startDate is common across all the actions and should be applied in all the cases. So, i assume this logic shouldn't be repeated at each model. Instead, controller's before_action filter, something like filtered_params sounds the right place to do it.</p>\n\n<pre><code>before_action :filtered_params\n\ndef filtered_params\n   params.require(:query).permit(:start_date)\n   user = User.instance\n   if(user.type == 'student') {} # startDate should be Greater than or equal to 12-03-2018. modify params.startDate with the logic\n   elsif(user.type == 'professor') {} // startDate should be Greater than equal to 01-01-2018\n   else {} // do nothing\n   end\nend\n</code></pre>\n\n<p>The above approach works, but i do not want to get stuck in if else loop. Is there a better way to do it ?</p>\n"}, {"tags": ["ruby", "shoes"], "comments": [{"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528905515, "post_id": 50839467, "comment_id": 88686654, "body": "It is unclear what you want to accomplish. Where is your code? If it is about saving a file, you dont need Shoes. You can use Ruby to do that for you."}, {"owner": {"reputation": 1, "user_id": 8168102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fecb2c720a1247397218f5b822ffdb5e?s=128&d=identicon&r=PG&f=1", "display_name": "LWTK", "link": "https://stackoverflow.com/users/8168102/lwtk"}, "reply_to_user": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528909405, "post_id": 50839467, "comment_id": 88688775, "body": "I tried to clarify more in the main question. I didn&#39;t think my code was really applicable to the question as i&#39;m just trying to find a method, but if you think it would help I can post it. I have only been using ruby for 2 weeks so it is pretty rough i&#39;m sure."}, {"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528976772, "post_id": 50839467, "comment_id": 88715994, "body": "Honestly it is still not clear what is your issue? Is your code running or is there a block where your code behaves differently or you need help to understand how to do a very specific task? What is it? You can paste entire code but you would need to help a reader correctly identify snippets where you think should be the problem."}, {"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528976848, "post_id": 50839467, "comment_id": 88716049, "body": "There are multiple issues how you have structured your code but I need to know what is your specific issue with what you want to accomplish."}, {"owner": {"reputation": 1, "user_id": 8168102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fecb2c720a1247397218f5b822ffdb5e?s=128&d=identicon&r=PG&f=1", "display_name": "LWTK", "link": "https://stackoverflow.com/users/8168102/lwtk"}, "reply_to_user": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528981606, "post_id": 50839467, "comment_id": 88719103, "body": "I want a screenshot of the gui at the snippet of code under Fin/Certificate. The code works well enough, I don&#39;t have any unexpected behavior right now."}, {"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528987666, "post_id": 50839467, "comment_id": 88723049, "body": "One way to do what you want is to track progress of what your users are doing. Keep writing them in a file. When they reach your expected state, you can trigger to generate a template pdf stored in your GUI and fill in whatever extra you need. And output that. This is not at all trivial. Many ruby gems are available to generate PDF."}], "owner": {"reputation": 1, "user_id": 8168102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fecb2c720a1247397218f5b822ffdb5e?s=128&d=identicon&r=PG&f=1", "display_name": "LWTK", "link": "https://stackoverflow.com/users/8168102/lwtk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528986419, "creation_date": 1528899337, "last_edit_date": 1528986419, "question_id": 50839467, "link": "https://stackoverflow.com/questions/50839467/print-export-gui-interface-at-current-state-ruby-shoes", "title": "Print/Export GUI interface at current state Ruby Shoes", "body": "<p>Given the simple GUI posted down below, how can I create and save a screenshot of what the results of the code is? I don't care if I need to print it, export it to pdf, or save as a picture but I don't want to ask the user to screenshot or snip the page. </p>\n\n<pre><code>Shoes.app do\n\n# Post and location of logo\n  @moveme =  image 'C:\\Users\\warnerl\\Documents\\RubyFiles\\TK_Dashboard_Logo.jpg', :width =&gt; 200\n  @moveme.move(400,0)\n\n# Gets users first and last name and saves them as variables\n  @UserFirstName = ask(\"Please input your first name.\")\n  @UserLastName = ask(\"Please input your last name.\")\n\n# Create Certificate\n  stack{\n    para 'You got 100%'\n\n     para \"#{@UserFirstName} #{@UserLastName}\"\n     para 'Congratulations you passed!'\n\n}\nend\n</code></pre>\n"}, {"tags": ["ruby", "operator-precedence"], "comments": [{"owner": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "edited": false, "score": 1, "creation_date": 1528899263, "post_id": 50839430, "comment_id": 88682616, "body": "And yes, I know that the solution is just to stick parens around the <code>&amp;:even</code> in the first example."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1528900176, "post_id": 50839430, "comment_id": 88683272, "body": "A clearer example: <code>def s;end; s &amp;false || nil</code>. Returns <code>nil</code> but I would expect a TypeError"}, {"owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "edited": false, "score": 2, "creation_date": 1528902927, "post_id": 50839430, "comment_id": 88685148, "body": "as <code>&amp;</code> is basically making an argument behave like a block, it seems that it has the same precedence as block which is <a href=\"https://ruby-doc.org/core-2.5.0/doc/syntax/precedence_rdoc.html\" rel=\"nofollow noreferrer\">the lowest between all other operators</a>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528910253, "post_id": 50839430, "comment_id": 88689249, "body": "The <code>||</code> operator is really, really aggressive."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "edited": false, "score": 0, "creation_date": 1528915985, "post_id": 50839430, "comment_id": 88692104, "body": "@potashin if this was true then <code>[1,3].any? &amp;:even? or true</code> would return <code>false</code> becuase <code>or</code> would have a higher precedent than the block  so <code>[1,3].any? &amp;(:even? or true) #=&gt; false</code> but the unary <code>&amp;</code> has a higher precedence than <code>or</code> and so does the method call to <code>any?</code> thus the evaluation is <code>[1,3].any?(&amp;(:even?)) or true #=&gt; true</code>"}], "answers": [{"comments": [{"owner": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "edited": false, "score": 0, "creation_date": 1528903428, "post_id": 50840694, "comment_id": 88685434, "body": "I need to digest the last few paras here. I&#39;ll just clarify that <code>and</code> and <code>or</code> is not what I&#39;m wanting - I had distilled down an example which was actually more like <code>if my_array.any? &amp;:predicate? || other_condition</code>, which fired or not based only on the <code>any?</code>"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "edited": false, "score": 1, "creation_date": 1528903650, "post_id": 50840694, "comment_id": 88685580, "body": "That has nothing to do with blocks, that&#39;s just optional parentheses biting you: <code>if foo bar || baz</code> is <code>if foo(bar || baz)</code>"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "edited": false, "score": 0, "creation_date": 1528903865, "post_id": 50840694, "comment_id": 88685719, "body": "@Chowlett and <code>or</code> would fix that bug as well: <code>if my_array.any? &amp;:predicate or other_condition</code> does what you would expect. Though I&#39;d prefer parens since that looks a bit confusing."}, {"owner": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "edited": false, "score": 2, "creation_date": 1528904305, "post_id": 50840694, "comment_id": 88685983, "body": "You should not be using <code>and</code> and <code>or</code> for Boolean combinations, only flow control. And yeah, the fix is obviously to add parens. The point about method-call being greedy is relevant, of course."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528915109, "post_id": 50840694, "comment_id": 88691660, "body": "@Max operational and (<code>&amp;</code>) is a method call but has a higher precendence than logical or (<code>||</code>)  [see my post for examples]. So this seems to fall outside of  <i>&quot;...it slurps up pretty much everything, stopping only at super-low-precedence stuff like if/unless/and/or&quot;</i>. Otherwise I would anticipate things like <code>true &amp; nil || :even?</code> to be parsed as <code>true.&amp;(nil || :even?) #=&gt; true</code> but instead you get <code>true.&amp;(nil) || :even? #=&gt; :even?</code>"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528925930, "post_id": 50840694, "comment_id": 88696827, "body": "@engineersmnky My point isn&#39;t that unary <code>&amp;</code> isn&#39;t a method call (maybe it is?). My point is that it doesn&#39;t behave like other operators because it is only valid in a very specific context, which is enforced at the parsing stage. It <i>has</i> to have the lowest precedence in that context because otherwise the interpreter wouldn&#39;t know ahead of time whether or not an argument represents a block."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528926598, "post_id": 50840694, "comment_id": 88697089, "body": "@max I agree that it is not a method call although it appears to be a mechanism to facilitate one. However clearly it does not have the lowest precedent otherwise your initial example would not work correctly. Not exactly sure where it falls from a precedent standpoint or even how to test such a thing"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 4, "last_activity_date": 1528902792, "creation_date": 1528902792, "answer_id": 50840694, "question_id": 50839430, "link": "https://stackoverflow.com/questions/50839430/precedence-of-to-block-unary/50840694#50840694", "title": "Precedence of to-block unary `&amp;`", "body": "<p>This is what the (wrongly-maligned) <code>and</code> and <code>or</code> keywords are for. You're supposed to write that as</p>\n\n<pre><code>[1,3].any? &amp;:even? or true\n</code></pre>\n\n<p>As for why this happens--I can't find documentation for this--but I think it actually has more to do with optional parentheses and the restrictions of unary &amp;.</p>\n\n<p>Unary <code>&amp;</code> is special. \"Normal\" operators like <code>~</code> are essentially syntactic sugar over method calls; you can put them wherever you want. But <code>&amp;</code> is <em>only allowed in method arguments</em>, and even then only at the end.</p>\n\n<pre><code>foo x, &amp;bar\n# NameError, determined at runtime because it has to see if any of these names are defined\nfoo &amp;bar, x\n# SyntaxError! Didn't even make it past the parser\n\ny = bar\n# NameError\ny = &amp;bar\n# SyntaxError!\n</code></pre>\n\n<p>And when you leave parentheses out from a method call, it slurps up pretty much everything, stopping only at super-low-precedence stuff like if/unless/and/or.</p>\n\n<pre><code>foo bar baz if true\n# same as\nfoo(bar(baz)) if true\n</code></pre>\n\n<p>So your example is equivalent to </p>\n\n<pre><code>[1,3].any?(&amp;:even? || true)\n</code></pre>\n\n<p>Now if <code>&amp;</code> were somehow high-precendence this is either a totally normal value to be evaluated at runtime <code>true</code> or it's a highly-restricted special syntactic construct <code>&amp;:even?</code>. It's not great to discover syntax errors at runtime, so I guess the devs chose to solve it the easy way: make <code>&amp;</code> super low precedence. That way the parser can just verify the syntax rules and ignore the block argument itself (which has to be evaluated at runtime).</p>\n"}, {"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1528987162, "post_id": 50843215, "comment_id": 88722705, "body": "I think the reason it works with <code>nil</code> is because it could be <code>&amp;var</code>, and then there needs to be some way to set <code>var</code> such that <code>block_given?</code> is false. A special exception, but a necessary one."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1528988292, "post_id": 50843215, "comment_id": 88723423, "body": "@Max I agree that it is a strange but necessary evil where by <code>&amp;nil == nil</code> in the context of a method argument where by <code>def block_is_nil?(&amp;block); block == nil; end</code> such that <code>block_is_nil?(&amp;nil) #=&gt; true</code>"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1528919616, "last_edit_date": 1528919616, "creation_date": 1528911651, "answer_id": 50843215, "question_id": 50839430, "link": "https://stackoverflow.com/questions/50839430/precedence-of-to-block-unary/50843215#50843215", "title": "Precedence of to-block unary `&amp;`", "body": "<p>When the <code>&amp;</code> is not preceded by an object (unary) and is immediately followed by by anything else (<code>&amp;nil</code> in this case). It will be parsed as an attempted <code>to_proc</code> method call otherwise it will be treated as a method call on the receiver e.g. </p>\n\n<pre><code> nil&amp;nil\n #=&gt; false  \n</code></pre>\n\n<p>Is equivalent to <code>nil.&amp;(nil)</code> </p>\n\n<p>So in your case (<code>[1,3].any? &amp;nil || :even?</code>) it is being parsed as <code>[1,3].any?(&amp;(nil || :even?))</code> because <code>&amp;</code> (<code>to_proc</code> method call) has a lower precedence than logical <code>||</code> and needs to know the result of <code>nil || :even?</code> to proceed. </p>\n\n<p>However, operational and (<code>&amp;</code>) requires a receiver (not unary) but does hold a higher precedence than the logical or (<code>||</code>)  e.g. <code>[1,3].any? &amp;nil&amp;nil || :even?</code> which would evaluate to </p>\n\n<pre><code>[1,3].any?(&amp;(nil.&amp;(nil) || :even?)\n#=&gt; false\n# Or\n[1,3].any?(&amp;(nil &amp; nil || :even?)\n#=&gt; false\n</code></pre>\n\n<p>Where strangely enough it is clear that operational and (<code>&amp;</code>) has a higher precedence than logical or (<code>||</code>)  </p>\n\n<p>Further examples </p>\n\n<pre><code>true &amp; nil || :even? \n#=&gt; :even?\n\ntrue &amp; :even? \n#=&gt; true\n\n[1,3].any? &amp;true&amp;true || :even?\n#=&gt; TypeError: wrong argument type TrueClass (expected Proc)\n\n# Okay no problem\n\nclass TrueClass\n  def to_proc\n    -&gt;(*_) { true } \n  end\nend \n\n[1,3].any? &amp;true&amp;true || :even?\n#=&gt; true\n[1,3].any? &amp;true || :even?\n#=&gt; true\n</code></pre>\n\n<p>Even stranger is that the unary <code>&amp;</code> allows for <code>nil</code> but essentially ignores it from <code>block_given?</code> but any other object that does not implement <code>to_proc</code> raises a <code>TypeError</code></p>\n\n<pre><code>def no_block\n  block_given? ? yield('Yes') : 'No'\nend\n\nno_block &amp;nil\n#=&gt; \"No\"\n\nno_block &amp;false\n#=&gt; TypeError: wrong argument type FalseClass (expected Proc)\n</code></pre>\n"}], "owner": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1528919616, "creation_date": 1528899232, "question_id": 50839430, "link": "https://stackoverflow.com/questions/50839430/precedence-of-to-block-unary", "title": "Precedence of to-block unary `&amp;`", "body": "<p>Consider the following Ruby code:</p>\n\n<pre><code>[1,3].any? &amp;:even? || true\n# =&gt; false\n[1,3].any? &amp;nil || :even?\n# =&gt; false\n[1,3].any? &amp;nil || :odd?\n# =&gt; true\n</code></pre>\n\n<p>So it seems that Boolean-or <code>||</code> has higher precedence than to-proc unary <code>&amp;</code>. I didn't expect this. Is that right, and is it documented anywhere?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 10912, "user_id": 1681, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dcc2d3a8038cd47219af0eebe0a8a78e?s=128&d=identicon&r=PG", "display_name": "Sixty4Bit", "link": "https://stackoverflow.com/users/1681/sixty4bit"}, "edited": false, "score": 0, "creation_date": 1528897076, "post_id": 50838569, "comment_id": 88681118, "body": "This has been answered before here: <a href=\"https://stackoverflow.com/questions/5924495/how-do-i-create-a-class-instance-from-a-string-name-in-ruby\" title=\"how do i create a class instance from a string name in ruby\">stackoverflow.com/questions/5924495/&hellip;</a>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 10912, "user_id": 1681, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dcc2d3a8038cd47219af0eebe0a8a78e?s=128&d=identicon&r=PG", "display_name": "Sixty4Bit", "link": "https://stackoverflow.com/users/1681/sixty4bit"}, "edited": false, "score": 0, "creation_date": 1528897338, "post_id": 50838569, "comment_id": 88681282, "body": "@Sixty4Bit the mentioned answer is unrelated since it uses the method that is not existing in Ruby."}, {"owner": {"reputation": 10912, "user_id": 1681, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dcc2d3a8038cd47219af0eebe0a8a78e?s=128&d=identicon&r=PG", "display_name": "Sixty4Bit", "link": "https://stackoverflow.com/users/1681/sixty4bit"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528897527, "post_id": 50838569, "comment_id": 88681421, "body": "@mudasobwa it uses const_get just as your answer does. How is that not a part of Ruby? Look at the second example."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 10912, "user_id": 1681, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dcc2d3a8038cd47219af0eebe0a8a78e?s=128&d=identicon&r=PG", "display_name": "Sixty4Bit", "link": "https://stackoverflow.com/users/1681/sixty4bit"}, "edited": false, "score": 0, "creation_date": 1528897582, "post_id": 50838569, "comment_id": 88681450, "body": "@Sixty4Bit ah, indeed, will close this as a dup."}], "answers": [{"comments": [{"owner": {"reputation": 10912, "user_id": 1681, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dcc2d3a8038cd47219af0eebe0a8a78e?s=128&d=identicon&r=PG", "display_name": "Sixty4Bit", "link": "https://stackoverflow.com/users/1681/sixty4bit"}, "edited": false, "score": 0, "creation_date": 1528897055, "post_id": 50838593, "comment_id": 88681102, "body": "You would not need to use const_get with your code because you are passing in constants. If you were passing in Strings then this would work."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 10912, "user_id": 1681, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dcc2d3a8038cd47219af0eebe0a8a78e?s=128&d=identicon&r=PG", "display_name": "Sixty4Bit", "link": "https://stackoverflow.com/users/1681/sixty4bit"}, "edited": false, "score": 1, "creation_date": 1528897276, "post_id": 50838593, "comment_id": 88681245, "body": "@Sixty4Bit excuse me? I am passing strings."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1528897344, "post_id": 50838593, "comment_id": 88681286, "body": "perfect, works perfectly!"}, {"owner": {"reputation": 10912, "user_id": 1681, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dcc2d3a8038cd47219af0eebe0a8a78e?s=128&d=identicon&r=PG", "display_name": "Sixty4Bit", "link": "https://stackoverflow.com/users/1681/sixty4bit"}, "edited": false, "score": 0, "creation_date": 1528897349, "post_id": 50838593, "comment_id": 88681289, "body": "Apologies. Missed the %w."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528899180, "post_id": 50838593, "comment_id": 88682569, "body": "might mention that these classes need to be defined in the current context because when I read the title and this fragment <i>&quot;I need to create a class...&quot;</i> I was a assuming the OP was looking for <code>Class.new</code> and <code>const_set</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528899232, "post_id": 50838593, "comment_id": 88682595, "body": "@engineersmnky thanks, updated."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1528899223, "last_edit_date": 1528899223, "creation_date": 1528896781, "answer_id": 50838593, "question_id": 50838569, "link": "https://stackoverflow.com/questions/50838569/how-to-instatiate-the-class-by-dynamically-receiving-the-class-name/50838593#50838593", "title": "How to instatiate the class by dynamically receiving the class name", "body": "<p>Use <a href=\"https://ruby-doc.org/Module.html#method-i-const_get\" rel=\"nofollow noreferrer\"><code>Module#const_get</code></a> (assuming these classes are already defined in the global namespace):</p>\n\n<pre><code>%w|IndividualContact Legal|.map do |klazz|\n  Kernel.const_get(klazz).new\nend\n</code></pre>\n\n<p>The code above will return an array containing two instances: one instance of <code>IndividualContact</code> and one of <code>Legal</code>.</p>\n"}], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1528897603, "accepted_answer_id": 50838593, "answer_count": 1, "score": 1, "last_activity_date": 1528899223, "creation_date": 1528896718, "question_id": 50838569, "link": "https://stackoverflow.com/questions/50838569/how-to-instatiate-the-class-by-dynamically-receiving-the-class-name", "closed_reason": "Duplicate", "title": "How to instatiate the class by dynamically receiving the class name", "body": "<p>I need to create a class but the condition is, I will receive the class name in strings like shown below</p>\n\n<pre><code> [\"IndividualContact\", \"Legal\"].each do |var|\n      ind = var.new\n    end\n</code></pre>\n\n<p>Now My expectation is, I need to call</p>\n\n<p><code>IndividualContact.new</code> and <code>Legal.new</code> but since var is a string variable, it's calling <code>.new</code> on a string like given below</p>\n\n<pre><code>\"IndividualContact\".new \n</code></pre>\n\n<p>rather than calling</p>\n\n<pre><code>IndividualContact.new\n</code></pre>\n\n<p>Is there any way can I call as I expected?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "rake", "zlib"], "comments": [{"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528894326, "post_id": 50837469, "comment_id": 88679188, "body": "Haven&#39;t worked with zlib in heroku. Can you try running a system command, <code>gunzip -l file.gz</code>. If the file is downloaded properly and is not corrupt, you should see the file contents. try it out from the console."}, {"owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "reply_to_user": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528976024, "post_id": 50837469, "comment_id": 88715493, "body": "I just ran heroku -logs and realised the problem was somewhere else: the file returned by the API exceeded our Heroku quota (Error R15 (Memory quota vastly exceeded)..."}, {"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528977362, "post_id": 50837469, "comment_id": 88716385, "body": "Are each response with a gz file, different? If not, you should consider caching those requests. You can also offload extensive memory eating operations to other services (AWS). Heroku can just serve your app."}, {"owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "reply_to_user": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528978656, "post_id": 50837469, "comment_id": 88717127, "body": "It&#39;s an API containing company data from an official registry, so the idea is to run the script every night to get updates (in case there are any) - so yes, in theory the responses might be different. We&#39;re looking into using a JSON streamer (with not much success so far)."}], "answers": [{"comments": [{"owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "edited": false, "score": 1, "creation_date": 1528898231, "post_id": 50838619, "comment_id": 88681894, "body": "I used <a href=\"https://stackoverflow.com/questions/8684125/how-do-i-read-a-gzip-file-line-by-line\">this SO</a> to get my gzip file unpacked and as mentioned above the script runs locally. Seems like my problem is linked to memory usage (which is limited depending on your Heroku plan), so I&#39;m trying to look into JSOM streaming to hopefully find a workaround."}], "tags": [], "owner": {"reputation": 10912, "user_id": 1681, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dcc2d3a8038cd47219af0eebe0a8a78e?s=128&d=identicon&r=PG", "display_name": "Sixty4Bit", "link": "https://stackoverflow.com/users/1681/sixty4bit"}, "is_accepted": false, "score": 1, "last_activity_date": 1528896864, "creation_date": 1528896864, "answer_id": 50838619, "question_id": 50837469, "link": "https://stackoverflow.com/questions/50837469/heroku-unpacking-a-gzip-file-through-a-rake-task-fails/50838619#50838619", "title": "Heroku: Unpacking a Gzip file through a rake task fails", "body": "<p>Your code snippet does not indicate that you ever close your GzipReader. It is often best to wrap IO's in blocks to ensure they are closed appropriately. Also, the <code>open</code> method may not be the one you want, so just let GzipReader handle opening the file for you and just send in the <code>file_path</code>. </p>\n\n<pre><code>Zlib::GzipReader.new(file_path) do |gz|\n  output = gz.read\n  @companies_array = JSON.parse(output)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1531985618, "creation_date": 1531985618, "answer_id": 51416855, "question_id": 50837469, "link": "https://stackoverflow.com/questions/50837469/heroku-unpacking-a-gzip-file-through-a-rake-task-fails/51416855#51416855", "title": "Heroku: Unpacking a Gzip file through a rake task fails", "body": "<p>The issue was linked to memory limit rather than Gzip unpacking (that's why the problem only occurred in production).</p>\n\n<p>The solution was using a <code>Json::Streamer</code> so that the whole file is not loading into memory at once.</p>\n\n<p><strong>This is the crucial part:</strong> (goes after the code posted in the question)</p>\n\n<pre><code>  puts 'Updating the Company table...'\n  streamer = Json::Streamer.parser(file_io: file, chunk_size: 1024)  # customize your chunk_size\n  streamer.get(nesting_level: 1) do |company|\n    (do your stuff with the API data here...)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 51416855, "answer_count": 2, "score": 1, "last_activity_date": 1531985618, "creation_date": 1528893387, "question_id": 50837469, "link": "https://stackoverflow.com/questions/50837469/heroku-unpacking-a-gzip-file-through-a-rake-task-fails", "title": "Heroku: Unpacking a Gzip file through a rake task fails", "body": "<p>I'm using <strong>Rails 5.2</strong> with <strong>ruby 2.5.1</strong> and am deploying my app to <strong>Heroku</strong>. </p>\n\n<p>I ran into problems when I tried running my local rake task. The task calls an API which responds with a <code>*.gz</code> file, saves it, upzips and then uses the retrieved JSON to populate the database and finally deletes the <code>*.gz</code> file. The task runs smooth in development but when called in production. The last line printed into the console is 'Unzipping the file...', so my guess is that the issues origin from the <code>zlib</code> library.</p>\n\n<p><strong>companies_list.rake</strong></p>\n\n<pre><code>require 'json'\nrequire 'open-uri'\nrequire 'zlib'\nrequire 'openssl'\nrequire 'action_view'\n\ninclude ActionView::Helpers::DateHelper\n\ndesc 'Updates Company table'\ntask update_db: :environment do\n  start = Time.now\n  zip_file_url = 'https://example.com/api/download'\n\n  TEMP_FILE_NAME = 'companies.gz'\n\n  puts 'Creating folders...'\n\n  tempdir = Dir.mktmpdir\n  file_path = \"#{tempdir}/#{TEMP_FILE_NAME}\"\n\n  puts 'Downloading the file...'\n\n  open(file_path, 'wb') do |file|\n    open(zip_file_url, { ssl_verify_mode: OpenSSL::SSL::VERIFY_NONE }) do |uri|\n      file.write(uri.read)\n    end\n  end\n\n  puts 'Download complete.'\n  puts 'Unzipping the file...'\n\n  gz = Zlib::GzipReader.new(open(file_path))\n  output = gz.read\n  @companies_array = JSON.parse(output)\n\n  puts 'Unzipping complete.'\n\n  (...)\nend\n</code></pre>\n\n<p>Has anyone else run into similar issues and knows how to get it to work?</p>\n"}, {"tags": ["arrays", "ruby", "split"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1528891223, "post_id": 50836675, "comment_id": 88677106, "body": "It&#39;s very unclear what you&#39;re asking. what is [1,1,1]? what does the array denote/"}, {"owner": {"reputation": 152, "user_id": 8537414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e5657f119d17b6de0b97b6d89301b0?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio Cipolla", "link": "https://stackoverflow.com/users/8537414/antonio-cipolla"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1528891569, "post_id": 50836675, "comment_id": 88677346, "body": "I&#39;ve edited the question, hope is more clear. It is an array of pictures and I have to compose in certain groups, based if the groups contains horizontal or vertical pictures"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1528892483, "post_id": 50836675, "comment_id": 88677920, "body": "What should be done with 3 consecutive zeros ?"}, {"owner": {"reputation": 152, "user_id": 8537414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e5657f119d17b6de0b97b6d89301b0?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio Cipolla", "link": "https://stackoverflow.com/users/8537414/antonio-cipolla"}, "edited": false, "score": 0, "creation_date": 1528892609, "post_id": 50836675, "comment_id": 88678008, "body": "it should be splitted in 3 different sub-array each one with just one hash"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528893053, "post_id": 50836675, "comment_id": 88678332, "body": "1. Show us what have you tried. SO is not a service to request others to write the code for you for free. 2. If it is guaranteed there are 4 elements in the input, it\u2019s easier to perform using a brute force."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1528893782, "post_id": 50836675, "comment_id": 88678832, "body": "Should the result be greedy? Does <code>0011</code> become <code>0</code> <code>0</code> <code>11</code> or <code>0</code> <code>01</code> <code>1</code>? Does <code>10</code> always have a higher priority than <code>01</code> or is it simply whichever pattern appears first?"}, {"owner": {"reputation": 152, "user_id": 8537414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e5657f119d17b6de0b97b6d89301b0?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio Cipolla", "link": "https://stackoverflow.com/users/8537414/antonio-cipolla"}, "edited": false, "score": 0, "creation_date": 1528894677, "post_id": 50836675, "comment_id": 88679445, "body": "Bigger array should be come first of shorter one, so 0 01 1 it is better than 0 0 11"}, {"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528895022, "post_id": 50836675, "comment_id": 88679702, "body": "You can select elements of Array using <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-select\" rel=\"nofollow noreferrer\">Array#select</a>, fairly simple. Try it and if you face an issue, then open a question."}], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 2, "last_activity_date": 1528896637, "last_edit_date": 1528896637, "creation_date": 1528895408, "answer_id": 50838136, "question_id": 50836675, "link": "https://stackoverflow.com/questions/50836675/split-an-array-in-known-fragment/50838136#50838136", "title": "split an array in known fragment", "body": "<p>You can use the <code>1</code> and <code>0</code> as sort of an imaginary image width. A horizontal image is assumed to be double the width of a vertical image. </p>\n\n<p>You can then proceed to use that to calculate how wide the images on the current row of images is and will the next image still fit on that row.</p>\n\n<p>When <code>width + next element width</code> is larger than what fits a \"row of images\", you start a new row.</p>\n\n<p>Example:</p>\n\n<pre><code>input = [{\"n\"=&gt;\"img01\", \"h\"=&gt;1},\n   {\"n\"=&gt;\"img02\", \"h\"=&gt;1},\n   {\"n\"=&gt;\"img03\", \"h\"=&gt;0},\n   {\"n\"=&gt;\"img04\", \"h\"=&gt;1}]\n\nimage_rows = []\ncurrent_row = []\ncurrent_width = 0.0\ninput.each.with_index(1) do |image_data, idx|\n\n  image_width = image_data['h'] == 1 ? 0.5 : 1.0\n\n  if current_width + image_width &gt; 1.5\n    image_rows &lt;&lt; current_row\n    current_row = [image_data]\n    current_width = image_width\n  else\n    current_row &lt;&lt; image_data\n    current_width += image_width\n  end\n\n  if idx == input.size\n    image_rows &lt;&lt; current_row\n  end\nend\n\nrequire 'json'\nputs JSON.pretty_generate(image_rows)\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>[\n  [\n    {\n      \"n\": \"img01\",\n      \"h\": 1\n    },\n    {\n      \"n\": \"img02\",\n      \"h\": 1\n    }\n  ],\n  [\n    {\n      \"n\": \"img03\",\n      \"h\": 0\n    },\n    {\n      \"n\": \"img04\",\n      \"h\": 1\n    }\n  ]\n]\n</code></pre>\n\n<ul>\n<li>When current row has <code>111</code> the width is <code>0.5 + 0.5 + 0.5 = 1.5</code> => nothing fits in</li>\n<li>When current row has <code>10</code> the width is <code>1.0 + 0.5 = 1.5</code> => nothing fits in</li>\n<li>When current row has <code>01</code> the width is <code>0.5 + 1.0 = 1.5</code> => nothing fits in</li>\n<li>When current row has <code>11</code> the width is <code>0.5 + 0.5 = 1.0</code> => only 0.5 fits in</li>\n<li>When current row has <code>1</code> the width is <code>0.5</code> => either 1.0 or 0.5 fits in</li>\n<li>When current row has <code>0</code> the width is <code>1.0</code> => only 0.5 fits in</li>\n</ul>\n\n<p>You can find the first group containing <code>111</code> by doing <code>image_rows.find { |row| row.size == 3 }</code>.</p>\n"}], "owner": {"reputation": 152, "user_id": 8537414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e5657f119d17b6de0b97b6d89301b0?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio Cipolla", "link": "https://stackoverflow.com/users/8537414/antonio-cipolla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 50838136, "answer_count": 1, "score": -3, "last_activity_date": 1528896637, "creation_date": 1528890996, "last_edit_date": 1528895005, "question_id": 50836675, "link": "https://stackoverflow.com/questions/50836675/split-an-array-in-known-fragment", "title": "split an array in known fragment", "body": "<p>I have an array of hashes that contain a boolean key, like </p>\n\n<pre><code>    [{\"n\"=&gt;\"img01\", \"h\"=&gt;1},\n     {\"n\"=&gt;\"img02\", \"h\"=&gt;1},\n     {\"n\"=&gt;\"img03\", \"h\"=&gt;0},\n     {\"n\"=&gt;\"img04\", \"h\"=&gt;1}]\n</code></pre>\n\n<p>my goal is split the in groups that have one of these condition of h key:\n  <code>[1,1,1]</code> or <code>[1,0]</code> or <code>[0,1]</code> or <code>[1,1]</code> or single value if any of these condition is not possible. In this example the only way to split the array is </p>\n\n<pre><code>     [{\"n\"=&gt;\"img01\", \"h\"=&gt;1},{\"n\"=&gt;\"img02\", \"h\"=&gt;1}] \n</code></pre>\n\n<p>and </p>\n\n<pre><code>     [{\"n\"=&gt;\"img03\", \"h\"=&gt;0},{\"n\"=&gt;\"img04\", \"h\"=&gt;1}]\n</code></pre>\n\n<p>but first it should search for an array done in this way       </p>\n\n<pre><code>          [{\"n\"=&gt;\"img01\", \"h\"=&gt;1},\n           {\"n\"=&gt;\"img02\", \"h\"=&gt;1},\n           {\"n\"=&gt;\"img03\", \"h\"=&gt;1}] \n</code></pre>\n\n<p>and then looking for the other combinations </p>\n\n<p>I've tried to splice the original array in groups of 3 (in test used just an array of 1 and 0)</p>\n\n<pre><code> irb(main):030:0&gt; b=a.each_slice(3).to_a =&gt; [[0, 1, 1], [1, 1, 0], [0, 0, 0], [0]]\n</code></pre>\n\n<p>and then confront the result to the biggest array first [1,1,1], and then try to split again if not </p>\n\n<pre><code> irb(main):055:0&gt; (b[0] -  [1,1,1]).count =&gt; 1\n</code></pre>\n\n<p>so move to next sub array the last value</p>\n\n<pre><code> irb(main):060:0&gt; b[1].push(b[0].pop)=&gt; [1, 1, 0, 1]\n</code></pre>\n\n<p>repeat the search in the first two-elements array</p>\n\n<pre><code>(irb(main):061:0&gt; b[0] - [1,0]).count\n(irb(main):061:0&gt; b[0] - [1,1]).count\n(irb(main):061:0&gt; b[0] - [0,1]).count\n</code></pre>\n\n<p>and then merge the other sub-array, split it again and repeat the search, but it is definitely\n messed up</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch", "searchkick"], "comments": [{"owner": {"reputation": 18271, "user_id": 447344, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hq0lN.jpg?s=128&g=1", "display_name": "Thomas Decaux", "link": "https://stackoverflow.com/users/447344/thomas-decaux"}, "edited": false, "score": 0, "creation_date": 1528896379, "post_id": 50836300, "comment_id": 88680639, "body": "how do you query elasticsearch (search or suggest)?"}, {"owner": {"reputation": 173, "user_id": 4515838, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1664130014/picture?type=large", "display_name": "Yitzhak", "link": "https://stackoverflow.com/users/4515838/yitzhak"}, "reply_to_user": {"reputation": 18271, "user_id": 447344, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hq0lN.jpg?s=128&g=1", "display_name": "Thomas Decaux", "link": "https://stackoverflow.com/users/447344/thomas-decaux"}, "edited": false, "score": 0, "creation_date": 1528898272, "post_id": 50836300, "comment_id": 88681930, "body": "I query it via search"}], "answers": [{"tags": [], "owner": {"reputation": 2875, "user_id": 1177228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2f2287b6054926438eb65f8726cc77d?s=128&d=identicon&r=PG", "display_name": "Andrew Kane", "link": "https://stackoverflow.com/users/1177228/andrew-kane"}, "is_accepted": false, "score": 1, "last_activity_date": 1533871543, "creation_date": 1533871543, "answer_id": 51778488, "question_id": 50836300, "link": "https://stackoverflow.com/questions/50836300/elasticsearch-querying-multiple-indices-while-limiting-the-fields-of-one-index/51778488#51778488", "title": "Elasticsearch querying multiple indices while limiting the fields of one index", "body": "<p>Elasticsearch doesn't provide a way to limit results from a single index.</p>\n\n<p>One approach is to filter the results in Ruby.</p>\n\n<p>Another approach is to use <a href=\"https://github.com/ankane/searchkick#multi-search\" rel=\"nofollow noreferrer\">multi search</a> to limit the results for dive centers.</p>\n"}], "owner": {"reputation": 173, "user_id": 4515838, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1664130014/picture?type=large", "display_name": "Yitzhak", "link": "https://stackoverflow.com/users/4515838/yitzhak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533871543, "creation_date": 1528889938, "last_edit_date": 1528896274, "question_id": 50836300, "link": "https://stackoverflow.com/questions/50836300/elasticsearch-querying-multiple-indices-while-limiting-the-fields-of-one-index", "title": "Elasticsearch querying multiple indices while limiting the fields of one index", "body": "<p>I have an <code>Autocomplete</code> class with a results method that queries two different models to return data. It partially works great, but with one major issue. </p>\n\n<pre><code>  def results\n    Searchkick.search @query, index_name: [Location, DiveCenter]\n  end\n</code></pre>\n\n<p>I need to limit the hits returned from the index <code>DiveCenter</code> because of the way I have the index set up. It's set up this way because a user will either click on a <code>DiveCenter</code> and be taken to the <code>DiveCenter</code> show page OR click on a location and be taken to <code>/search?(city | country)=value</code>. </p>\n\n<pre><code>  searchkick searchable: [:name, :city, :state, :country]\n  def search_data\n    {\n      name: name,\n      city: location.city,\n      state: location.state,\n      country: location.country\n    }\n  end\n</code></pre>\n\n<p>So basically, what I need is this:</p>\n\n<pre><code>  def results\n    Searchkick.search @query, index_name: [Location, DiveCenter], fields: ['location.city', 'location.state', 'location.country', 'dive_center.name']\n  end\n</code></pre>\n"}, {"tags": ["html", "css", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8922392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd819cf8e674a14ae8bcf99537a742d?s=128&d=identicon&r=PG&f=1", "display_name": "Tej Singh", "link": "https://stackoverflow.com/users/8922392/tej-singh"}, "edited": false, "score": 0, "creation_date": 1528890583, "post_id": 50836114, "comment_id": 88676655, "body": "Thank you so much for your answer and helpful formatting!"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 53, "user_id": 8922392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd819cf8e674a14ae8bcf99537a742d?s=128&d=identicon&r=PG&f=1", "display_name": "Tej Singh", "link": "https://stackoverflow.com/users/8922392/tej-singh"}, "edited": false, "score": 0, "creation_date": 1528890663, "post_id": 50836114, "comment_id": 88676719, "body": "You&#39;re welcome, happy to help - I&#39;d recommend having a read through the <a href=\"http://guides.rubyonrails.org/asset_pipeline.html\" rel=\"nofollow noreferrer\">asset pipeline</a> docs. There&#39;s a fair bit going on / you can use :)"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 1, "last_activity_date": 1528890459, "last_edit_date": 1528890459, "creation_date": 1528889367, "answer_id": 50836114, "question_id": 50835998, "link": "https://stackoverflow.com/questions/50835998/background-tag-html-application-html-erb/50836114#50836114", "title": "Background Tag HTML application.html.erb", "body": "<p>For a Rails project, the best approach is to use <a href=\"https://apidock.com/rails/v4.2.7/ActionView/Helpers/AssetUrlHelper/image_path\" rel=\"nofollow noreferrer\"><code>image_path</code></a>.</p>\n\n<p>In your case, something like the following should work:</p>\n\n<pre><code>&lt;%= image_path 'path_to_your_image/bk.jpg' %&gt;\n</code></pre>\n\n<p>However, the correct way to do this is to store the image in the projects <code>app/assets/images</code> folder, and the asset path will look for this there. Then, you just need to update the helper to:</p>\n\n<pre><code>&lt;%= image_path 'bk.jpg' %&gt; \n</code></pre>\n\n<p>So:</p>\n\n<pre><code>&lt;body background=&lt;%= image_path 'bk.jpg' %&gt;&gt;\n# Might need quotes around this: &lt;%= image_path 'bk.jpg' %&gt;, haven't been able to test\n</code></pre>\n\n<p>Or, better:</p>\n\n<pre><code>&lt;%= content_tag :body, style: { background: image_path('bk.jpg') } do %&gt;\n  Your content\n&lt;% end %&gt;\n</code></pre>\n\n<p>Better still would be to have the css background set in the CSS rather than inline, though that's perhaps another question.</p>\n"}], "owner": {"reputation": 53, "user_id": 8922392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd819cf8e674a14ae8bcf99537a742d?s=128&d=identicon&r=PG&f=1", "display_name": "Tej Singh", "link": "https://stackoverflow.com/users/8922392/tej-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 50836114, "answer_count": 1, "score": 1, "last_activity_date": 1528890459, "creation_date": 1528889009, "last_edit_date": 1528889998, "question_id": 50835998, "link": "https://stackoverflow.com/questions/50835998/background-tag-html-application-html-erb", "title": "Background Tag HTML application.html.erb", "body": "<p>I am attempting to create an <code>application.html.erb</code> file that holds a background that will be displayed on all of my pages. </p>\n\n<p>Using the w3school's guide, I put the filename of the background (which is in the same folder as <code>application.html.erb</code>) in the body tag and it does not change anything.</p>\n\n<pre><code>&lt;body background='bk.jpg'&gt;\n  The content goes here\n&lt;/body&gt;\n</code></pre>\n\n<p>Any help solving this issue would be greatly appreciated.</p>\n"}, {"tags": ["ruby", "webhooks", "bigcommerce"], "comments": [{"owner": {"reputation": 2023, "user_id": 8521556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/myGsu.jpg?s=128&g=1", "display_name": "Karen White", "link": "https://stackoverflow.com/users/8521556/karen-white"}, "edited": false, "score": 0, "creation_date": 1528908376, "post_id": 50835892, "comment_id": 88688234, "body": "Could you post your store hash? I can check the server logs to see if the webhook service is firing any hooks for your store."}, {"owner": {"reputation": 558, "user_id": 1680106, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a68c66b64e4b64fb6f239f1a6e7d07d3?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1680106/john"}, "reply_to_user": {"reputation": 2023, "user_id": 8521556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/myGsu.jpg?s=128&g=1", "display_name": "Karen White", "link": "https://stackoverflow.com/users/8521556/karen-white"}, "edited": false, "score": 0, "creation_date": 1528972729, "post_id": 50835892, "comment_id": 88713539, "body": "Sure, @KarenWhite, it&#39;s 3nuz0ojp05"}], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 1680106, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a68c66b64e4b64fb6f239f1a6e7d07d3?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1680106/john"}, "edited": false, "score": 0, "creation_date": 1529060998, "post_id": 50866094, "comment_id": 88750102, "body": "That was the problem indeed! Thanks!"}], "tags": [], "owner": {"reputation": 2023, "user_id": 8521556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/myGsu.jpg?s=128&g=1", "display_name": "Karen White", "link": "https://stackoverflow.com/users/8521556/karen-white"}, "is_accepted": true, "score": 1, "last_activity_date": 1529011120, "creation_date": 1529011120, "answer_id": 50866094, "question_id": 50835892, "link": "https://stackoverflow.com/questions/50835892/cannot-fire-bigcommerce-webhooks/50866094#50866094", "title": "Cannot fire Bigcommerce webhooks", "body": "<p>The exception that I'm seeing in the logs is:</p>\n\n<pre><code>ExceptionMessage: true is not a valid header value\n</code></pre>\n\n<p>The \"is-active\" flag should be sent as part of the request body--your headers, if you choose to include them, would be an arbitrary key value pair that you can check at runtime to verify the hook's origin.</p>\n\n<p>Here's an example request body:</p>\n\n<pre><code>{\n  \"scope\": \"store/order/*\",\n  \"headers\": {\n    \"X-Custom-Auth-Header\": \"{secret_auth_password}\"\n  },\n  \"destination\": \"https://app.example.com/orders\",\n  \"is_active\": true\n}\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 558, "user_id": 1680106, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a68c66b64e4b64fb6f239f1a6e7d07d3?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1680106/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 50866094, "answer_count": 1, "score": 0, "last_activity_date": 1529011120, "creation_date": 1528888669, "question_id": 50835892, "link": "https://stackoverflow.com/questions/50835892/cannot-fire-bigcommerce-webhooks", "title": "Cannot fire Bigcommerce webhooks", "body": "<p>so far I've managed to create two webhooks by using their official gem (<a href=\"https://github.com/bigcommerce/bigcommerce-api-ruby\" rel=\"nofollow noreferrer\">https://github.com/bigcommerce/bigcommerce-api-ruby</a>) with the following events:</p>\n\n<ul>\n<li>store/order/statusUpdated</li>\n<li>store/app/uninstalled</li>\n</ul>\n\n<p>The destination URL is a localhost tunnel managed by ngrok (the https) version.</p>\n\n<pre><code>status_update_hook = Bigcommerce::Webhook.create(connection: connection, headers: { is_active: true }, scope: 'store/order/statusUpdated', destination: 'https://myapp.ngrok.io/bigcommerce/notifications')\nuninstall_hook = Bigcommerce::Webhook.create(connection: connection, headers: { is_active: true }, scope: 'store/app/uninstalled', destination:  'https://myapp.ngrok.io/bigcommerce/notifications')\n</code></pre>\n\n<p>The webhooks seems to be active and correctly created as I can retrieve and list them. </p>\n\n<pre><code>Bigcommerce::Webhook.all(connection:connection)\n</code></pre>\n\n<p>I manually created an order in my store dashboard but no matter to which state or how many states I change it, no notification is fired. Am I missing something?</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "edited": false, "score": 0, "creation_date": 1528880998, "post_id": 50832951, "comment_id": 88670467, "body": "<code>hash_including(environment: instance_of(Puppet::Node::Environment))</code> instead of <code>an_instance </code>?"}, {"owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "reply_to_user": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "edited": false, "score": 1, "creation_date": 1528884050, "post_id": 50832951, "comment_id": 88672570, "body": "Wow that&#39;s exactly right. Could you make that an answer perhaps?"}], "answers": [{"comments": [{"owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "edited": false, "score": 0, "creation_date": 1528889393, "post_id": 50834593, "comment_id": 88675898, "body": "And for anyone reading in the archives, the working version of the code is here <a href=\"https://github.com/alexharv074/elk/commit/8975f6d22c848c4e8fc894b8a6cffcc8d0474e16\" rel=\"nofollow noreferrer\">github.com/alexharv074/elk/commit/&hellip;</a>"}], "tags": [], "owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "is_accepted": true, "score": 1, "last_activity_date": 1528884655, "creation_date": 1528884655, "answer_id": 50834593, "question_id": 50832951, "link": "https://stackoverflow.com/questions/50832951/expect-an-instance-of-a-specific-class-as-a-keyword-argument/50834593#50834593", "title": "Expect an instance of a specific class as a keyword argument", "body": "<p>You can use <code>hash_including</code> together with <code>instance_of</code> matchers (<em>instead of what is written as <code>an_instance</code> in your example</em>):</p>\n\n<pre><code>hash_including(environment: instance_of(Puppet::Node::Environment))\n</code></pre>\n"}], "owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 50834593, "answer_count": 1, "score": 1, "last_activity_date": 1528885016, "creation_date": 1528879895, "last_edit_date": 1528885016, "question_id": 50832951, "link": "https://stackoverflow.com/questions/50832951/expect-an-instance-of-a-specific-class-as-a-keyword-argument", "title": "Expect an instance of a specific class as a keyword argument", "body": "<p>I need to allow a class to receive an instance of another class as an argument in Rspec/Rspec-mocks.</p>\n\n<p>The context is I am trying to create Rspec tests for Puppet (i.e. a Ruby app).</p>\n\n<p>I want to say in Rspec \"something like\" -</p>\n\n<pre><code>allow(Puppet::FileServing::Content.indirection).\n  to receive(:find).with(\n    \"puppet:///modules/profile/logstash/logstash.json\",\n    an_instance # an instance of Puppet::Node::Environment would go  here\n).and_return('bar')\n</code></pre>\n\n<p>Creating a fake instance of a class doesn't seem to be an option, because the instance that is received depends on values computed during the run.</p>\n\n<p>Thus, in my Pry debugger I see this:</p>\n\n<pre><code> =&gt;  99:               Puppet::FileServing::Content.indirection.find(\n    100:                 self[:source],\n    101:                 :environment =&gt; catalog.environment_instance\n    102:               )\n</code></pre>\n\n<p>and</p>\n\n<pre><code>[1] pry(#&lt;Puppet::Type::Elasticsearch_template&gt;)&gt; catalog.environment_instance\n=&gt; &lt;Puppet::Node::Environment:70286646297160 @name=\"rp_env\" @manifest=\"/Users/alexharvey/git/elk/spec/fixtures/manifests\" @modulepath=\"/Users/alexharvey/git/elk/spec/fixtures/modules\" &gt;\n</code></pre>\n\n<p>Where I'm stuck is I don't know how to tell the test to \"allow\" an instance of the Puppet::Node::Environment to receive what I see above in the debugger.</p>\n\n<p>For instance, I don't know what the string \"70286646297160\" is (I guess it identifies the instance of the class somehow?).</p>\n\n<p>And I can't refer to those paths, as they are specific to my laptop and the tests I am writing would then only work on my laptop.</p>\n\n<p>So, how can I \"tell\" Rspec to \"allow\" this class instance I see in my debugger to be received, assuming it is possible to do so.</p>\n\n<p>(I hope this makes sense. Obviously, this is a bit beyond my Rspec/Ruby knowledge.)</p>\n"}, {"tags": ["ruby", "regex", "ipv4"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1528879548, "post_id": 50832666, "comment_id": 88669587, "body": "Just IPv4 addresses?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1528927775, "post_id": 50832666, "comment_id": 88697478, "body": "Please note that <code>[a:b:c::d:e:f]</code> is also a valid IP address, for example, as is <code>[::]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 5, "last_activity_date": 1528879245, "creation_date": 1528879245, "answer_id": 50832729, "question_id": 50832666, "link": "https://stackoverflow.com/questions/50832666/match-all-ip-addresses-in-text-with-regex/50832729#50832729", "title": "Match all IP addresses in text with regex", "body": "<p>You should change the word boundary matcher <code>\\b</code> to an explicit space (and match it with positive lookaheads since you don\u2019t want it to be returned):</p>\n\n<pre><code>IP_ADDR_REGEX = %r{\n  (?&lt;=\\s|^)\n  (25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\n  (?=\\s|$)\n}x\n\nmain \u25b6 'bla bla 192.168.1.1.1.1 bla'[IP_ADDR_REGEX]\n#\u21d2 nil\nmain \u25b6 'bla bla 192.168.1.1.1 bla'[IP_ADDR_REGEX]\n#\u21d2 nil\nmain \u25b6 'bla bla 192.168.1.1 bla'[IP_ADDR_REGEX]\n#\u21d2 \"192.168.1.1\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 4, "last_activity_date": 1528879570, "last_edit_date": 1528879570, "creation_date": 1528879269, "answer_id": 50832740, "question_id": 50832666, "link": "https://stackoverflow.com/questions/50832666/match-all-ip-addresses-in-text-with-regex/50832740#50832740", "title": "Match all IP addresses in text with regex", "body": "<p>You may solve it by adding lookarounds that will fail the match if the IP-like string is preceded with a digit and a dot or is followed with a dot and a digit:</p>\n\n<pre><code>IP_ADDR_REGEX = %r{\n  \\b                                        # Word boundary\n  (?&lt;!\\d\\.)                                 # Negative lookbehind: no \"X.\" before\n  (?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\n  \\b                                        # Word boundary\n  (?!\\.\\d)                                  # Negative lookahead: no \".X\" after\n}x\n</code></pre>\n\n<h1><a href=\"https://regex101.com/r/1fN3MG/3\" rel=\"nofollow noreferrer\">Regex demo #1</a></h1>\n\n<p>Note that in case you only want to limit matches to whitespace-separated substrings use</p>\n\n<pre><code>IP_ADDR_REGEX = %r{\n  (?&lt;!\\S)                                    # Position not preceded with non-whitespace char\n  (?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\n  (?!\\S)                                    # Position not followed with non-whitespace char\n}x\n</code></pre>\n\n<h1><a href=\"https://regex101.com/r/1fN3MG/4\" rel=\"nofollow noreferrer\">Regex demo #2</a></h1>\n\n<p>Note that <code>(?:...)</code> non-capturing group will enable easier usage with <code>String#scan</code> method to collect all matches from strings.</p>\n"}], "owner": {"reputation": 573, "user_id": 1390780, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/aENWq.jpg?s=128&g=1", "display_name": "Kote", "link": "https://stackoverflow.com/users/1390780/kote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 50832740, "answer_count": 2, "score": 2, "last_activity_date": 1528879570, "creation_date": 1528879031, "question_id": 50832666, "link": "https://stackoverflow.com/questions/50832666/match-all-ip-addresses-in-text-with-regex", "title": "Match all IP addresses in text with regex", "body": "<p>Let's say I have string which might contain one or more IP addresses. How to match all of them and only valid ones using regex in ruby?</p>\n\n<p>Currently, my solution looks like this:</p>\n\n<pre><code>IP_ADDR_REGEX = %r{\n  \\b\n  (25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.\n  (25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\n  \\b\n}x\n</code></pre>\n\n<p>This works well when IPs are separated with spaces e.g it extracts <code>192.168.1.1</code> from the text <code>bla bla 192.168.1.1 bla</code>. However it still extracts <code>192.168.1.1</code> in this case: <code>bla bla 192.168.1.1.1.1 bla</code>. </p>\n\n<p>How to make it not match such cases? i.e when it is <code>192.168.1.1.1.1</code> my regex should not return a match. I've looked for many solutions about this problem but could not find what I want. I also tried to figure out the solution myself by matching only whitespaces in the end (because <code>\\b</code> matches a <code>.</code> character as well) but I could not make it work.\nThanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeadmin"], "comments": [{"owner": {"reputation": 2770, "user_id": 1042201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ada99cff697111a404292dbeff3d4313?s=128&d=identicon&r=PG", "display_name": "Kumar", "link": "https://stackoverflow.com/users/1042201/kumar"}, "edited": false, "score": 0, "creation_date": 1528887946, "post_id": 50831372, "comment_id": 88674963, "body": "Do you see data getting posted in the logs?"}, {"owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "reply_to_user": {"reputation": 2770, "user_id": 1042201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ada99cff697111a404292dbeff3d4313?s=128&d=identicon&r=PG", "display_name": "Kumar", "link": "https://stackoverflow.com/users/1042201/kumar"}, "edited": false, "score": 0, "creation_date": 1528941758, "post_id": 50831372, "comment_id": 88700373, "body": "Sorry i didnt get what you mean?"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1528948272, "post_id": 50831372, "comment_id": 88701581, "body": "You need to post your web server logs. What ever window your webserver (<code>rails s</code>) is running, show the output when you click Add New Schedule. Also post your controller code."}], "owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528874768, "creation_date": 1528874768, "question_id": 50831372, "link": "https://stackoverflow.com/questions/50831372/columns-component-in-form-with-has-many-not-working", "title": "columns component in form with has_many not working", "body": "<p>I have two models job and schedule and there association is job has many schedules and schedule belong to job. My problem is that in active admin when i try to add column on f.has_many like: </p>\n\n<pre><code>panel 'schedules' do\n  f.has_many :schedules do |sc|\n    columns do\n      column { sc.input :date, required: true }\n    end\n    columns do\n      column { sc.input :reception }\n      column { sc.input :start_at }\n      column { sc.input :end_at }\n    end\n  end\nend\n</code></pre>\n\n<p>Its shows columns as desire but when i click \"Add new schedule\" field are not appeared on columns as set. It would be great if anyone can help me. thank you</p>\n"}, {"tags": ["ruby", "time", "utc"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 3, "creation_date": 1528874060, "post_id": 50831073, "comment_id": 88666439, "body": "UTC is a time standard, not a time zone. GMT is the timezone with offset +00:00. While they are mostly equivalent, they should not be confused. UTC is what timezones are offset from. Thus, GMT is +00:00 offset from UTC. In this sense, UTC does not have an offset, because it is what the offset is measured <i>from</i>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1528875151, "post_id": 50831073, "comment_id": 88667091, "body": "@Amadan <code>a.gmt?</code> is also <code>false</code>. Ruby seems to use UTC and GMT interchangeably."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1528875561, "post_id": 50831073, "comment_id": 88667328, "body": "@Stefan It does... That&#39;s Ruby being wrong in terminology (associating GMT with UTC instead of with +00:00). From docs: &quot;The <code>Time</code> class treats GMT (Greenwich Mean Time) and UTC (Coordinated Universal Time) as equivalent. <i>GMT is the older way of referring to these baseline times but persists in the names of calls on POSIX systems.</i>&quot; (emphasis mine)."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1528875915, "post_id": 50831073, "comment_id": 88667517, "body": "You can also look at it this way: <code>2018-06-13 09:00:00 +0000</code> is a specific time in Britain; <code>2018-06-13 09:00:00 UTC</code> is a specific time <i>everywhere</i>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528876678, "post_id": 50831073, "comment_id": 88667989, "body": "@mudasobwa: Not so... GB already uses DST, and switches from GMT to BST (British Summer Time). GMT is +00:00, BST and CET are both +01:00"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1528877977, "post_id": 50831073, "comment_id": 88668715, "body": "@Amadan ah, indeed."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1528878024, "post_id": 50831073, "comment_id": 88668746, "body": "<i>&quot;BST and CET are both +01:00&quot;</i> \u2013 although they don&#39;t &quot;occur&quot; at the same time since the time zones are shifted simultaneously (GMT \u2192 BST, CET \u2192 CEST)"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1528878862, "post_id": 50831073, "comment_id": 88669202, "body": "@Stefan a small nitpick - I&#39;m sure you didn&#39;t intend this ambiguity, but - <i>these</i> specific time zones are switched simultaneously, as are now all time zones in Europe among the ones that do employ DST; however, that is not true of other parts of the world, where <a href=\"https://en.wikipedia.org/wiki/Daylight_saving_time_by_country\" rel=\"nofollow noreferrer\">many countries</a> have their own rules as to when they switch."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1528879174, "post_id": 50831073, "comment_id": 88669372, "body": "@Amadan rewording a comment results in at least one typo. Of course: <i>these</i> ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 5, "last_activity_date": 1528878670, "last_edit_date": 1528878670, "creation_date": 1528876818, "answer_id": 50831999, "question_id": 50831073, "link": "https://stackoverflow.com/questions/50831073/understanding-timeutc/50831999#50831999", "title": "Understanding Time#utc?", "body": "<p>Implementation-wise, Ruby's (i.e. MRI) internal <a href=\"https://github.com/ruby/ruby/blob/75d25ede15e664ee0048ebc4e84e9e34838c2313/time.c#L1600-L1605\" rel=\"nofollow noreferrer\">time structure</a> has a <code>gmt</code> field which specifies the time's type:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>PACKED_STRUCT_UNALIGNED(struct time_object {\n    wideval_t timew; /* time_t value * TIME_SCALE.  possibly Rational. */\n    struct vtm vtm;\n    uint8_t gmt:3; /* 0:localtime 1:utc 2:fixoff 3:init */\n    uint8_t tm_got:1;\n});\n</code></pre>\n\n<p>The <code>utc?</code> method merely checks whether <code>gmt</code> is <code>1</code>.</p>\n\n<p>Therefore, a time instance in local time or a time instance with explicit offset will never be <code>utc?</code>, even if your system's timezone offset is UTC+0:</p>\n\n<pre><code>Time.local(2018)      #=&gt; 2018-01-01 00:00:00 +0000\nTime.local(2018).utc? #=&gt; false\n\nTime.new(2018)        #=&gt; 2018-01-01 00:00:00 +0000\nTime.new(2018).utc?   #=&gt; false\n</code></pre>\n\n<p>as opposed to a time instance created via <a href=\"http://ruby-doc.org/core-2.5.1/Time.html#method-c-utc\" rel=\"nofollow noreferrer\"><code>utc</code></a>: (note that the offset is shown as <code>UTC</code>)</p>\n\n<pre><code>Time.utc(2018)        #=&gt; 2018-01-01 00:00:00 UTC\nTime.utc(2018).utc?   #=&gt; true\n</code></pre>\n\n<p>You could check the <a href=\"http://ruby-doc.org/core-2.5.1/Time.html#method-i-utc_offset\" rel=\"nofollow noreferrer\"><code>utc_offset</code></a> instead:</p>\n\n<pre><code>t = Time.new(2018) #=&gt; 2018-01-01 00:00:00 +0000\nt.utc_offset       #=&gt; 0\nt.utc_offset.zero? #=&gt; true\n</code></pre>\n"}], "owner": {"reputation": 2352, "user_id": 57950, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ef34e54174d6947dcb3c3d031a44d83?s=128&d=identicon&r=PG", "display_name": "Georg Ledermann", "link": "https://stackoverflow.com/users/57950/georg-ledermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 50831999, "answer_count": 1, "score": 4, "last_activity_date": 1528878670, "creation_date": 1528873842, "last_edit_date": 1528875277, "question_id": 50831073, "link": "https://stackoverflow.com/questions/50831073/understanding-timeutc", "title": "Understanding Time#utc?", "body": "<p>As I understand, UTC means a time is given in timezone +00:00. But Ruby thinks different in <code>Time#utc?</code>. I've observed this in Ruby 2.5.1:</p>\n\n<pre><code>a = Time.new(2018,6,13, 9,0,0, '+00:00')\n# =&gt; 2018-06-13 09:00:00 +0000 \n\nb = Time.utc(2018,6,13, 9,0,0)\n# =&gt; 2018-06-13 09:00:00 UTC \n\na == b \n# =&gt; true\n\na.utc? \n# =&gt; false (WHY???)\n\nb.utc?\n# =&gt; true\n</code></pre>\n\n<p>IMHO, <code>a.utc?</code> should return true. Is there any explanation?</p>\n\n<p><strong>Addition:</strong> From the <a href=\"https://ruby-doc.org/core-2.5.1/Time.html#method-i-utc-3F\" rel=\"nofollow noreferrer\">Ruby docs</a> for Time#utc?</p>\n\n<blockquote>\n  <p>Returns true if <em>time</em> represents a time in UTC (GMT).</p>\n</blockquote>\n\n<p>What exactly means \"representing a time in UTC/GMT\"? An offset of 0 is not enough, obviously.</p>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1528875771, "post_id": 50830716, "comment_id": 88667438, "body": "<code>App.quit!</code> ? <a href=\"https://github.com/sinatra/sinatra/blob/master/lib/sinatra/base.rb#L1436\" rel=\"nofollow noreferrer\">github.com/sinatra/sinatra/blob/master/lib/sinatra/&hellip;</a>"}, {"owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "reply_to_user": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1528879394, "post_id": 50830716, "comment_id": 88669503, "body": "@PavelMikhailyuk indeed. Make it an answer and I will accept it."}], "answers": [{"tags": [], "owner": {"reputation": 3352, "user_id": 4565485, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8lpRH.jpg?s=128&g=1", "display_name": "ogirginc", "link": "https://stackoverflow.com/users/4565485/ogirginc"}, "is_accepted": false, "score": 0, "last_activity_date": 1528881288, "creation_date": 1528881288, "answer_id": 50833436, "question_id": 50830716, "link": "https://stackoverflow.com/questions/50830716/how-to-shutdown-sinatra-web-app-programmatically/50833436#50833436", "title": "How to shutdown Sinatra web app programmatically?", "body": "<p>You can use both <code>App.quit!</code> or <code>App.stop!</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "is_accepted": true, "score": 4, "last_activity_date": 1528882213, "creation_date": 1528882213, "answer_id": 50833779, "question_id": 50830716, "link": "https://stackoverflow.com/questions/50830716/how-to-shutdown-sinatra-web-app-programmatically/50833779#50833779", "title": "How to shutdown Sinatra web app programmatically?", "body": "<p>Due to <a href=\"https://github.com/sinatra/sinatra/blob/master/lib/sinatra/base.rb#L1436\" rel=\"nofollow noreferrer\">this line</a> you can use <code>App.quit!</code> or its alias <code>App.stop!</code>.</p>\n"}], "owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 50833779, "answer_count": 2, "score": 2, "last_activity_date": 1528882213, "creation_date": 1528872498, "question_id": 50830716, "link": "https://stackoverflow.com/questions/50830716/how-to-shutdown-sinatra-web-app-programmatically", "title": "How to shutdown Sinatra web app programmatically?", "body": "<p>I start it like this:</p>\n\n<pre><code>require 'sinatra/base'\nclass App &lt; Sinatra::Base\n  get '/' do\n    'Hello, world!'\n  end\nend\nApp.run!\n</code></pre>\n\n<p>And it runs. Now I want to shut it down from another thread. How can I do that?</p>\n\n<pre><code>Thread.new do\n  if it_is_time_to_finish\n    # How?\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubocop"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528872255, "post_id": 50830558, "comment_id": 88665421, "body": "Having four conditions in a row concatenated with <code>&amp;&amp;</code> is already a code smell. When you will need to add more conditions you\u2019d better refactor the whole codepiece to avoid <code>if</code>s at all. Early return is a way to go here."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1528872257, "post_id": 50830558, "comment_id": 88665423, "body": "Guard clauses are a specific pattern that prevents the method from being run (or provides early exit) unless preconditions are satisfied. You can have multiple guards, which can simplify the expression somewhat. If you need an <code>else</code> clause, or if you are executing different things based on different conditions, that is not a situation where guard clauses would be used (and I don&#39;t think you&#39;d be getting a warning from Rubocop if that was the situation). Unfortunately, Rubocop can&#39;t read your mind or tell the future, it can only comment on your code as it is in that moment."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1528872641, "post_id": 50830558, "comment_id": 88665656, "body": "neither of these is really readable, mainly because the first line is too long. Simple fix would be to extract that to a method, and split it up on multiple lines (80 chars is a good limit)"}], "answers": [{"tags": [], "owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "is_accepted": true, "score": 1, "last_activity_date": 1528873648, "creation_date": 1528873648, "answer_id": 50831034, "question_id": 50830558, "link": "https://stackoverflow.com/questions/50830558/refactoring-rubocop-style-guardclause-in-a-more-readable-maintainable-way/50831034#50831034", "title": "Refactoring Rubocop Style/GuardClause in a more readable/maintainable way", "body": "<p>I think we can do something like below </p>\n\n<pre><code># issue_flag is boolean so we can directly put it\n# create a new method with all the condition and give a proper name\nreturn unless issue_flag &amp;&amp; send_follow_up? # change name accourdingly\n  email_address = \"sales@test.com\"\n  puts \"Emailing Follow Up #{email_address} - #{sales_order}\"\n  UserMailer.issue_notification(self, email_address).deliver_now\n  update(issue_notification_follow_up_sent: true)\nend\n# document its behaviour\ndef send_follow_up?\n  issue_notification_sent &amp;&amp; !issue_notification_follow_up_sent &amp;&amp; send_follow_up\nend\n</code></pre>\n\n<p>The guard structure is used to send the control out of block so if you need change something or do something after the condition then you will not be able to use the guard clause. Have a look at the below code in such scenarios we will not use guard clause</p>\n\n<pre><code>def test\n  if something_here?\n    do_something\n  end\n\n  do_something_else\n  do_something_else1\n  do_something_else2\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3352, "user_id": 4565485, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8lpRH.jpg?s=128&g=1", "display_name": "ogirginc", "link": "https://stackoverflow.com/users/4565485/ogirginc"}, "is_accepted": false, "score": 0, "last_activity_date": 1528881996, "creation_date": 1528881996, "answer_id": 50833693, "question_id": 50830558, "link": "https://stackoverflow.com/questions/50830558/refactoring-rubocop-style-guardclause-in-a-more-readable-maintainable-way/50833693#50833693", "title": "Refactoring Rubocop Style/GuardClause in a more readable/maintainable way", "body": "<p>I would probably extract most part of the method as privates with clear names that tells the intention. Pseudocode implementation would look like this:</p>\n\n<pre><code>def method_name\n  return unless flag? &amp;&amp; issue_notification_sent_with_follow_up\n\n  log_follow_up\n  UserMailer.issue_notification(self, @email_address).deliver_now\n  update(issue_notification_follow_up_sent: true)\nend\n\nprivate\n\ndef flag?\n  issue_flag == true\nend\n\ndef issue_notification_sent_with_follow_up\n  issue_notification_sent &amp;&amp; !issue_notification_follow_up_sent &amp;&amp; send_follow_up\nend\n\ndef log_follow_up\n  @email_address = \"sales@test.com\"\n  puts \"Emailing Follow Up #{@email_address} - #{sales_order}\"\nend\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 50831034, "answer_count": 2, "score": -1, "last_activity_date": 1528881996, "creation_date": 1528871909, "question_id": 50830558, "link": "https://stackoverflow.com/questions/50830558/refactoring-rubocop-style-guardclause-in-a-more-readable-maintainable-way", "title": "Refactoring Rubocop Style/GuardClause in a more readable/maintainable way", "body": "<p><strong>Rubocop complains:</strong> Style/GuardClause: Use a guard clause instead of wrapping the code inside a conditional expression.\n    if issue_flag == true &amp;&amp; issue_notification_sent &amp;&amp; !issue_notification_follow_up_sent &amp;&amp; send_follow_up\n    ^^</p>\n\n<p>My original code is </p>\n\n<pre><code>if issue_flag == true &amp;&amp; issue_notification_sent &amp;&amp; !issue_notification_follow_up_sent &amp;&amp; send_follow_up\n  email_address = \"sales@test.com\"\n  puts \"Emailing Follow Up #{email_address} - #{sales_order}\"\n  UserMailer.issue_notification(self, email_address).deliver_now\n  update(issue_notification_follow_up_sent: true)\nend\n</code></pre>\n\n<p>and from reading the <a href=\"https://www.rubydoc.info/gems/rubocop/RuboCop/Cop/Style/GuardClause\" rel=\"nofollow noreferrer\">docs</a>, it seems that I can solve this by implementing the following code instead:</p>\n\n<pre><code>return unless issue_flag == true &amp;&amp; issue_notification_sent &amp;&amp; !issue_notification_follow_up_sent &amp;&amp; send_follow_up\nemail_address = \"sales@test.com\"\nputs \"Emailing Follow Up #{email_address} - #{sales_order}\"\nUserMailer.issue_notification(self, email_address).deliver_now\nupdate(issue_notification_follow_up_sent: true)\n</code></pre>\n\n<p>I can see that this essentially breaks early from the method unless the condition is met, but to me, this seems less readable.  It also seems less maintainable as further conditionals cannot be added after this code unless they pass the condition on the first line, for instance, to execute something else if <code>issue_flag == true &amp;&amp; !issue_notification_sent</code> (anything matching this condition would have already returned on line 1 of the refactored code above).</p>\n\n<p>Is there a better way to refactor this so that more conditions could be added after the code below, without the code returning prematurely?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 4, "creation_date": 1528871512, "post_id": 50830390, "comment_id": 88665033, "body": "A little bit of context would help someone trying to help you, because I don&#39;t see any harm in passing them to each function"}, {"owner": {"reputation": 118, "user_id": 6080990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ded713da57161f76d1ed079264c47112?s=128&d=identicon&r=PG&f=1", "display_name": "rohan kharvi", "link": "https://stackoverflow.com/users/6080990/rohan-kharvi"}, "reply_to_user": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1528872689, "post_id": 50830390, "comment_id": 88665681, "body": "In future debugging would be very difficult, if i want to make a small change."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": -1, "last_activity_date": 1528872525, "creation_date": 1528872525, "answer_id": 50830720, "question_id": 50830390, "link": "https://stackoverflow.com/questions/50830390/how-to-avoid-passing-same-parameter-through-multiple-methods/50830720#50830720", "title": "how to avoid passing same parameter through multiple methods", "body": "<p>Answering the question stated: yes, ruby is a stateful OO language, <em>having</em> mutable everything. So in ruby one might introduce <em>instance variables</em>:</p>\n\n<pre><code>class MyClass\n  def foo(a)\n    @a = a\n    # some computation\n    bar(b)\n  end\n\n  def bar(b)\n    @b = b\n    # some computation\n    baz(c)\n  end\n\n  def baz(c)\n    print [@a, @b, c].inspect\n  end\nend\n</code></pre>\n\n<p>In the real life, <strong>the best practice would be to <em>avoid using instance variables wherever possible</em>, and pass everything across methods</strong>. That might save you days of debugging in the future.</p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1528880266, "post_id": 50832215, "comment_id": 88670016, "body": "Just use keyword parameters for that: <code>def baz(**par)</code> and call it like <code>baz(a: 42, b: :foo)</code>."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528958693, "post_id": 50832215, "comment_id": 88705015, "body": "You are right. I didn&#39;t consider this alternative, since I&#39;m working in a project with a Ruby version which doesn&#39;t support keyword parameters yet. Otherwise, it&#39;s of course a feasible alternative."}], "tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 0, "last_activity_date": 1528877554, "creation_date": 1528877554, "answer_id": 50832215, "question_id": 50830390, "link": "https://stackoverflow.com/questions/50830390/how-to-avoid-passing-same-parameter-through-multiple-methods/50832215#50832215", "title": "how to avoid passing same parameter through multiple methods", "body": "<p>There is no single solution which works in every case, and often, passing the parameters explicitly is simply the best choice, especially when it comes to debugging.</p>\n\n<p>You can use instance variables, but I would not introduce a new instance variable for the sole reason not to avoid passing it down the call chain. It should have its own value in addition.</p>\n\n<p>One approach which I can see often in projects, is to us a single parameter hash, where the new parameters are added:</p>\n\n<pre><code>def foo(a)\n  ....\n  bar({a:a, b:b})\nend\n\ndef bar(par)\n  ....\n  par[:c] = c\nend\n\ndef baz(par)\n   par[:a]+par[:b]+par[:c]\nend\n</code></pre>\n\n<p>This is not without drawbacks either. If you, for instance, forget to \"add\" a necessary parameter, this will either yield wrong results or throw an exception (depending on how to used them), while forgetting them explicitly via the parameter list, would be found at compile time already.</p>\n\n<p>I would make the decisiion depending on the length of the parameter lists involved. If the number of parameters to a methods is larger than 5, I would start thinking, whether a different design might be more appropriate.</p>\n"}], "owner": {"reputation": 118, "user_id": 6080990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ded713da57161f76d1ed079264c47112?s=128&d=identicon&r=PG&f=1", "display_name": "rohan kharvi", "link": "https://stackoverflow.com/users/6080990/rohan-kharvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1528877554, "creation_date": 1528871183, "last_edit_date": 1528872252, "question_id": 50830390, "link": "https://stackoverflow.com/questions/50830390/how-to-avoid-passing-same-parameter-through-multiple-methods", "title": "how to avoid passing same parameter through multiple methods", "body": "<pre><code>def foo(a)\n  # some computation\n  bar(a, b)\nend\n\ndef bar(a,b)\n  # some computation\n  baz(a, b, c)\nend\n\ndef baz(a, b ,c)\n  print a\nend\n</code></pre>\n\n<p>How to avoid passing same parameter (a) to all methods? One way is to make parameter <code>a</code> as an instance variable. What is the right way to do this?</p>\n"}, {"tags": ["ruby", "if-statement", "ruby-on-rails-4", "conditional"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1528870992, "post_id": 50830303, "comment_id": 88664824, "body": "Are you sure there is an <code>Admin</code> user with <code>:def_admin</code> role set in the database?"}, {"owner": {"reputation": 3, "user_id": 7283497, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VygvHkWiMU8/AAAAAAAAAAI/AAAAAAAAAEI/vG8DTCLZv_s/photo.jpg?sz=128", "display_name": "Mbasa Dinga", "link": "https://stackoverflow.com/users/7283497/mbasa-dinga"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528879827, "post_id": 50830303, "comment_id": 88669753, "body": "Yes. When Admin user registers, they get the role. I have also checked on the console with has_role? :def_admin."}, {"owner": {"reputation": 3, "user_id": 7283497, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VygvHkWiMU8/AAAAAAAAAAI/AAAAAAAAAEI/vG8DTCLZv_s/photo.jpg?sz=128", "display_name": "Mbasa Dinga", "link": "https://stackoverflow.com/users/7283497/mbasa-dinga"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528880436, "post_id": 50830303, "comment_id": 88670121, "body": "Yes. When Admin user registers, they get the role. I have also checked on the console with has_role? :def_admin."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1528890104, "post_id": 50830303, "comment_id": 88676344, "body": "Why do your role names have a <code>def_</code> prefix?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7283497, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VygvHkWiMU8/AAAAAAAAAAI/AAAAAAAAAEI/vG8DTCLZv_s/photo.jpg?sz=128", "display_name": "Mbasa Dinga", "link": "https://stackoverflow.com/users/7283497/mbasa-dinga"}, "edited": false, "score": 0, "creation_date": 1528880508, "post_id": 50831263, "comment_id": 88670187, "body": "Makes sense. Thank you very much"}, {"owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "reply_to_user": {"reputation": 3, "user_id": 7283497, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VygvHkWiMU8/AAAAAAAAAAI/AAAAAAAAAEI/vG8DTCLZv_s/photo.jpg?sz=128", "display_name": "Mbasa Dinga", "link": "https://stackoverflow.com/users/7283497/mbasa-dinga"}, "edited": false, "score": 0, "creation_date": 1528882883, "post_id": 50831263, "comment_id": 88671735, "body": "@MbasaDinga if the answer satisfy you than accept it so that other might get help from accepted answer."}, {"owner": {"reputation": 3, "user_id": 7283497, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VygvHkWiMU8/AAAAAAAAAAI/AAAAAAAAAEI/vG8DTCLZv_s/photo.jpg?sz=128", "display_name": "Mbasa Dinga", "link": "https://stackoverflow.com/users/7283497/mbasa-dinga"}, "edited": false, "score": 0, "creation_date": 1528897154, "post_id": 50831263, "comment_id": 88681172, "body": "Your answer worked. Thanks. Is the a button to accept your answer? I&#39;m still a rookie at this. @Manishh"}, {"owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "reply_to_user": {"reputation": 3, "user_id": 7283497, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VygvHkWiMU8/AAAAAAAAAAI/AAAAAAAAAEI/vG8DTCLZv_s/photo.jpg?sz=128", "display_name": "Mbasa Dinga", "link": "https://stackoverflow.com/users/7283497/mbasa-dinga"}, "edited": false, "score": 0, "creation_date": 1528897810, "post_id": 50831263, "comment_id": 88681592, "body": "you will see a tick sign near up and down arrow. when you hover it, it will display click to accept this answer."}], "tags": [], "owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "is_accepted": true, "score": 1, "last_activity_date": 1528898151, "last_edit_date": 1528898151, "creation_date": 1528874444, "answer_id": 50831263, "question_id": 50830303, "link": "https://stackoverflow.com/questions/50830303/ruby-why-wont-the-third-conditional-statement-be-true/50831263#50831263", "title": "Ruby: Why won&#39;t the third conditional statement be true?", "body": "<p>Last condition will be met only when we are not able to find Stylist, Client or Admin.\nI thing the issue is with the coditions, Suppose your admin user id is 1 and 1 is the client id as well who has def_client role,\nSo when admin login then we check for id 1 to be present in <code>Client</code> table and finds the client. You should set diffent session for different roles.\nI think after changing session keys this will work.</p>\n\n<pre><code>def current_user\n  @current_user =\n    if session[:stylist_user_id] &amp;&amp; Stylist.find(session[:stylist_user_id]).has_role?(:def_stylist)\n      Stylist.find(session[:stylist_user_id])\n    elsif Client.exists?(session[:client_user_id]) &amp;&amp; Client.find(session[:client_user_id]).has_role?(:def_client)\n      Client.find(session[:client_user_id])\n    elsif Admin.exists?(session[:admin_user_id]) &amp;&amp; Admin.find(session[:admin_user_id]).has_role?(:def_admin)\n      Admin.find(session[:admin_user_id])\n    end\nend\n</code></pre>\n\n<p>Update : You can further reduce the queries by changing your code. Bear in mind that exist triggers a query then you check for roles which again creates a query on Stylist, client or admin then we have find query which we can reduce by changing code to something like below.</p>\n\n<pre><code>def current_user\n  @current_user =\n    if session[:stylist_user_id]\n      stylist = Stylist.find(session[:stylist_user_id])\n      stylist if stylist.has_role?(:def_stylist)\n    elsif session[:client_user_id]\n      client = Client.find(session[:client_user_id])\n      client if client.has_role?(:def_client)\n    elsif session[:admin_user_id]\n      admin = Admin.find(session[:admin_user_id])\n      admin if admin.has_role?(:def_admin)\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7283497, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VygvHkWiMU8/AAAAAAAAAAI/AAAAAAAAAEI/vG8DTCLZv_s/photo.jpg?sz=128", "display_name": "Mbasa Dinga", "link": "https://stackoverflow.com/users/7283497/mbasa-dinga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 50831263, "answer_count": 1, "score": 0, "last_activity_date": 1528898151, "creation_date": 1528870861, "last_edit_date": 1528871116, "question_id": 50830303, "link": "https://stackoverflow.com/questions/50830303/ruby-why-wont-the-third-conditional-statement-be-true", "title": "Ruby: Why won&#39;t the third conditional statement be true?", "body": "<p>can somebody help me out here. With the conditional statement below, only the first and second conditions are ever met, the third (second elsif statement) and last are never met. I've tried moving use case statement, but I get the same result.</p>\n\n<pre><code>def current_user\n  if Stylist.exists?(session[:user_id]) &amp;&amp; Stylist.find(session[:user_id]).has_role?(:def_stylist)\n    @current_user = Stylist.find(session[:user_id])\n  elsif Client.exists?(session[:user_id]) &amp;&amp; Client.find(session[:user_id]).has_role?(:def_client)\n    @current_user = Client.find(session[:user_id])\n  elsif Admin.exists?(session[:user_id]) &amp;&amp; Admin.find(session[:user_id]).has_role?(:def_admin)\n    @current_user = Admin.find(session[:user_id])\n  else\n    @current_user = nil\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "docusignapi"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1528870408, "post_id": 50829947, "comment_id": 88664532, "body": "inspect the full error message, that may tell you why the request is bad."}, {"owner": {"reputation": 135, "user_id": 6316001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ab1ef86e8dff5746b9a14f2d04da693?s=128&d=identicon&r=PG&f=1", "display_name": "Bread", "link": "https://stackoverflow.com/users/6316001/bread"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1528870532, "post_id": 50829947, "comment_id": 88664593, "body": "Hi @kiddorails, they didnt throw me any other error. I only have this though. The error comes from the last line of the code I&#39;ve shown above."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 1, "creation_date": 1528870983, "post_id": 50829947, "comment_id": 88664819, "body": "while creating <code>@api_client</code>, pass <code>debugging = true</code> in config. It will enable http logging giving you insight of what&#39;s happening"}, {"owner": {"reputation": 135, "user_id": 6316001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ab1ef86e8dff5746b9a14f2d04da693?s=128&d=identicon&r=PG&f=1", "display_name": "Bread", "link": "https://stackoverflow.com/users/6316001/bread"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1528871544, "post_id": 50829947, "comment_id": 88665053, "body": "@kiddorails Ah alright thanks. I have more visibility now!"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1528871616, "post_id": 50829947, "comment_id": 88665095, "body": "Look in the request and response body it generates and confirm with docusign&#39;s api reference for bulkenvelopes; that should help you in fixing it. If it doesn&#39;t, you can update with relevant request and response body in question and let me know. (don&#39;t forget to tag in comment)"}, {"owner": {"reputation": 135, "user_id": 6316001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ab1ef86e8dff5746b9a14f2d04da693?s=128&d=identicon&r=PG&f=1", "display_name": "Bread", "link": "https://stackoverflow.com/users/6316001/bread"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1528872295, "post_id": 50829947, "comment_id": 88665453, "body": "@kiddorails Hmm actually I have faced this error in Docusign API for Python before. And I went to edit the source code. However, I am not really sure what to edit for the source code in Ruby. I am still trying to edit it."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 135, "user_id": 6316001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ab1ef86e8dff5746b9a14f2d04da693?s=128&d=identicon&r=PG&f=1", "display_name": "Bread", "link": "https://stackoverflow.com/users/6316001/bread"}, "edited": false, "score": 0, "creation_date": 1528872638, "post_id": 50829947, "comment_id": 88665651, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/173043/discussion-between-kiddorails-and-bread\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 6316001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ab1ef86e8dff5746b9a14f2d04da693?s=128&d=identicon&r=PG&f=1", "display_name": "Bread", "link": "https://stackoverflow.com/users/6316001/bread"}, "is_accepted": false, "score": 1, "last_activity_date": 1528878658, "last_edit_date": 1528878658, "creation_date": 1528876226, "answer_id": 50831800, "question_id": 50829947, "link": "https://stackoverflow.com/questions/50829947/bulkenvelopesapi-docusign-request-data-format/50831800#50831800", "title": "BulkEnvelopesApi Docusign request data format", "body": "<p>With @kiddorails help, I've managed to solve it.</p>\n\n<p>Here's the solution:</p>\n\n<p>First, edit the source code in this format. Main idea is to change the Content-Type into 'text/csv', and input a string into the body.</p>\n\n<pre><code>def update_recipients_with_http_info(account_id, envelope_id, recipient_id, bulk_recipients_request)\n      if @api_client.config.debugging\n        @api_client.config.logger.debug \"Calling API: BulkEnvelopesApi.update_recipients ...\"\n      end\n      # verify the required parameter 'account_id' is set\n      fail ArgumentError, \"Missing the required parameter 'account_id' when calling BulkEnvelopesApi.update_recipients\" if account_id.nil?\n      # verify the required parameter 'envelope_id' is set\n      fail ArgumentError, \"Missing the required parameter 'envelope_id' when calling BulkEnvelopesApi.update_recipients\" if envelope_id.nil?\n      # verify the required parameter 'recipient_id' is set\n      fail ArgumentError, \"Missing the required parameter 'recipient_id' when calling BulkEnvelopesApi.update_recipients\" if recipient_id.nil?\n      # resource path\n      local_var_path = \"/v2/accounts/{accountId}/envelopes/{envelopeId}/recipients/{recipientId}/bulk_recipients\".sub('{format}','json').sub('{' + 'accountId' + '}', account_id.to_s).sub('{' + 'envelopeId' + '}', envelope_id.to_s).sub('{' + 'recipientId' + '}', recipient_id.to_s)\n\n      # query parameters\n      query_params = {}\n\n      # header parameters\n      header_params = {}\n      # HTTP header 'Accept' (if needed)\n      header_params['Accept'] = @api_client.select_header_accept(['application/json'])\n      header_params['Content-Type'] = 'text/csv'\n      # form parameters\n      form_params = {}\n\n      # http body (model)\n      # post_body = @api_client.object_to_http_body(bulk_recipients_request)\n      # puts bulk_recipients_request\n      # post_body = body_params\n      auth_names = []\n      data, status_code, headers = @api_client.call_api(:PUT, local_var_path,\n        :header_params =&gt; header_params,\n        :query_params =&gt; query_params,\n        :form_params =&gt; form_params,\n        :body =&gt; bulk_recipients_request,\n        :auth_names =&gt; auth_names,\n        :return_type =&gt; 'BulkRecipientsSummaryResponse')\n      if @api_client.config.debugging\n        @api_client.config.logger.debug \"API called: BulkEnvelopesApi#update_recipients\\nData: #{data.inspect}\\nStatus code: #{status_code}\\nHeaders: #{headers}\"\n      end\n      return data, status_code, headers\n    end\n  end\n</code></pre>\n\n<p>Secondly, set bulk_recipients_request to be a string (with newlines for each row of data)</p>\n\n<pre><code>\"rowNumber,email,name,Accesscode\\n\"+\"1,berry@gmail.com,Berry,11223\\n\"\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 6316001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ab1ef86e8dff5746b9a14f2d04da693?s=128&d=identicon&r=PG&f=1", "display_name": "Bread", "link": "https://stackoverflow.com/users/6316001/bread"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528878658, "creation_date": 1528869382, "last_edit_date": 1528871631, "question_id": 50829947, "link": "https://stackoverflow.com/questions/50829947/bulkenvelopesapi-docusign-request-data-format", "title": "BulkEnvelopesApi Docusign request data format", "body": "<p>I am stuck when using BulkEnvelopesApi rom Docusign API for Ruby. It keep on returning me this error:</p>\n\n<blockquote>\n  <p>DocuSign_eSign::ApiError (Bad Request): </p>\n</blockquote>\n\n<p>Edit: After @kiddorails suggestion to include debug = True, the error message is:</p>\n\n<blockquote>\n  <p>{   \"errorCode\": \"UNSPECIFIED_ERROR\",   \"message\": \"Value cannot be\n  null.\\r\\nParameter name: stream\" }</p>\n</blockquote>\n\n<p>I am using this gem: <a href=\"https://github.com/docusign/docusign-ruby-client\" rel=\"nofollow noreferrer\">https://github.com/docusign/docusign-ruby-client</a></p>\n\n<p>Is there anything wrong with the format of how I input the data?</p>\n\n<p>Here's my code for reference.</p>\n\n<pre><code>  def self.send_env()\n    self.auth # To initialize the @api_client\n\n    t1 = DocuSign_eSign::TemplatesApi.new(@api_client)\n    signer_placeholder ={\"signers\":[{\"email\":\"bulk@recipient.com\",\"name\":\"Bulk Recipient\",\n                                     \"routingOrder\":1,\"recipientId\":\"1\",\"roleName\":\"Fruit\",\n                                     \"isBulkRecipient\":\"True\"}]}\n    t1.update_recipients(account_id=ENV[\"ACCOUNT_ID_LIVE\"], template_id=ENV[\"TEMPLATE_ID_LIVE\"], template_recipients=signer_placeholder)\n    br = DocuSign_eSign::BulkRecipient.new(\n        {\n            \"accessCode\": '112233',\n            \"email\": 'berry@gmail.com',\n            \"name\": 'Berry',\n            \"rowNumber\":1\n        }\n    )\n\n    brr = DocuSign_eSign::BulkRecipientsRequest.new({\"bulkRecipients\": Array(br)})\n    bea = DocuSign_eSign::BulkEnvelopesApi.new(@api_client)\n    bea.update_recipients(account_id=ENV[\"ACCOUNT_ID_LIVE\"], envelope_id=ENV[\"TEMPLATE_ID_LIVE\"],\n                      recipient_id=\"1\",bulk_recipients_request=brr)\n</code></pre>\n\n<p>I am able to call other Docusign APIs using this similar data format. Only unable to work for BulkEnvelopesAPI.</p>\n\n<p>I am thinking whether is there anything wrong with the source code for this BulkEnvelopesAPI function.</p>\n\n<p>Thank you for reading!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ubuntu", "windows-subsystem-for-linux"], "comments": [{"owner": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "edited": false, "score": 0, "creation_date": 1570542002, "post_id": 50829443, "comment_id": 102939844, "body": "Sometimes, deleting the <code>$GEM_HOME</code> directory fixes this kind of issues."}], "answers": [{"comments": [{"owner": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "edited": false, "score": 1, "creation_date": 1570541993, "post_id": 50829820, "comment_id": 102939837, "body": "<a href=\"https://github.com/calabash/calabash-ios/wiki/Best-Practice%3A--Never-install-gems-with-sudo\" rel=\"nofollow noreferrer\"><b>Never install dependencies with <code>sudo</code>!</b></a>"}], "tags": [], "owner": {"reputation": 429, "user_id": 7617687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb0c380ac37c50e2c0574e0ecec1a98?s=128&d=identicon&r=PG&f=1", "display_name": "radoAngelov", "link": "https://stackoverflow.com/users/7617687/radoangelov"}, "is_accepted": false, "score": 0, "last_activity_date": 1528869390, "last_edit_date": 1528869390, "creation_date": 1528868786, "answer_id": 50829820, "question_id": 50829443, "link": "https://stackoverflow.com/questions/50829443/zsh-usr-bin-bundle-bad-interpreter-usr-bin-ruby-no-such-file-or-directory/50829820#50829820", "title": "zsh: /usr/bin/bundle: bad interpreter: /usr/bin/ruby: no such file or directory", "body": "<p>I can suggest you to run <code>which bundle</code> command. The path it returns contains a ruby version. I'm almost sure that you won't have this ruby version on your local machine. Check that by running <code>rvm list</code>. To solve the problem try either installing the version of ruby or reinstalling <code>bundler</code> using sudo and gem- <code>sudo gem uninstall bundler</code> - > <code>sudo gem install bundler</code>. </p>\n\n<p><strong>NOTE:</strong> your ruby version has to be the same with the one in the Gemfile. </p>\n"}], "owner": {"reputation": 31, "user_id": 9051935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e512a044d9c7acb423a1ebcbd6452fc?s=128&d=identicon&r=PG&f=1", "display_name": "Karan Nagpal", "link": "https://stackoverflow.com/users/9051935/karan-nagpal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4411, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1528890043, "creation_date": 1528866737, "last_edit_date": 1528890043, "question_id": 50829443, "link": "https://stackoverflow.com/questions/50829443/zsh-usr-bin-bundle-bad-interpreter-usr-bin-ruby-no-such-file-or-directory", "title": "zsh: /usr/bin/bundle: bad interpreter: /usr/bin/ruby: no such file or directory", "body": "<p>I am pretty new to ruby and rails development, And I am working on <em>linux subsystem for windows</em>. I have been getting the above mentioned error. Here's what all I have done:</p>\n\n<ul>\n<li>reinstalled rvm</li>\n<li>added <code>export PATH=\"$PATH:/usr/bin:/usr/local/bin/:/usr/share/rvm/bin:/usr/share/rvm/rubies/ruby-2.5.1/bin\"</code> the path in <code>.zshrc</code> file</li>\n</ul>\n\n<p>but the problem is still persisting. another thing I know is rvm is installed in <code>/usr/share/</code> directory</p>\n\n<p>I have also referred this link:\n<a href=\"https://stackoverflow.com/questions/3958092/problem-with-bundle\">problem with bundle</a></p>\n\n<p>Any help would be greatly appreciated!!</p>\n"}, {"tags": ["ruby", "github", "jekyll", "github-pages", "jekyll-theme"], "comments": [{"owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "edited": false, "score": 0, "creation_date": 1528873023, "post_id": 50828760, "comment_id": 88665848, "body": "A repository url can help."}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 10526558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/diI9D.jpg?s=128&g=1", "display_name": "Robert Del Favero", "link": "https://stackoverflow.com/users/10526558/robert-del-favero"}, "is_accepted": false, "score": 0, "last_activity_date": 1540233305, "creation_date": 1540233305, "answer_id": 52935710, "question_id": 50828760, "link": "https://stackoverflow.com/questions/50828760/page-build-failed-due-to-the-plugin-jekyll-scholar/52935710#52935710", "title": "Page Build Failed due to the plugin jekyll-scholar", "body": "<p>GitHub Pages has a whitelist of plugins that it allows. It appears that the plugin you list isn't in the whitelist, so you can't use it on your GitHub Pages site.</p>\n\n<p>See this documentation for how to find out what's in the list. (Note that the \"How to bypass the whitelist\" section only applies to local builds.)</p>\n\n<p><a href=\"https://github.com/github/pages-gem\" rel=\"nofollow noreferrer\">https://github.com/github/pages-gem</a></p>\n"}], "owner": {"reputation": 2231, "user_id": 6410520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f641ad7e7d5b962dc3814f5565d3ea03?s=128&d=identicon&r=PG&f=1", "display_name": "Kathiravan Natarajan", "link": "https://stackoverflow.com/users/6410520/kathiravan-natarajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540233305, "creation_date": 1528861240, "question_id": 50828760, "link": "https://stackoverflow.com/questions/50828760/page-build-failed-due-to-the-plugin-jekyll-scholar", "title": "Page Build Failed due to the plugin jekyll-scholar", "body": "<p>Build is successful locally and the <code>jekyll serve</code> brings the page locally. But when I push the files into github pages repository, I receive an email saying that the page build failed. </p>\n\n<p>Visited the documentation and it was mentioned that the build may fail due to any unsupported plugin. In my config.yml file, I had this plugin: ['jekyll/scholar']. \nAny help is appreciated to fix this build issue ! </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bootstrap-4", "blogs"], "answers": [{"tags": [], "owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "is_accepted": true, "score": 1, "last_activity_date": 1528862377, "creation_date": 1528862377, "answer_id": 50828887, "question_id": 50828752, "link": "https://stackoverflow.com/questions/50828752/bootstrap-in-ruby-on-rails/50828887#50828887", "title": "Bootstrap in Ruby on Rails", "body": "<p>you just need to put that stylesheet link into quotes</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Simpleblog&lt;/title&gt;\n&lt;%= csrf_meta_tags %&gt;\n&lt;%= csp_meta_tag %&gt;\n&lt;%= stylesheet_link_tag 'https://stackpath.bootstrapcdn.com/twitter-bootstrap/2.1.0/css/bootstrap-combined.min.css' %&gt;\n&lt;%= stylesheet_link_tag    'application', media: 'all', 'data- \nturbolinks-track': 'reload' %&gt;\n&lt;%= javascript_include_tag 'application', 'data-turbolinks-track': \n'reload' %&gt;\n&lt;/head&gt;\n\n &lt;body&gt;\n&lt;%= yield %&gt;\n &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8922392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd819cf8e674a14ae8bcf99537a742d?s=128&d=identicon&r=PG&f=1", "display_name": "Tej Singh", "link": "https://stackoverflow.com/users/8922392/tej-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 50828887, "answer_count": 1, "score": 0, "last_activity_date": 1528862377, "creation_date": 1528861189, "question_id": 50828752, "link": "https://stackoverflow.com/questions/50828752/bootstrap-in-ruby-on-rails", "title": "Bootstrap in Ruby on Rails", "body": "<p>I am currently working on this project: <a href=\"https://www.youtube.com/watch?v=pPy0GQJLZUM\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=pPy0GQJLZUM</a></p>\n\n<p>When I try to enable bootstrap, around the 31 minute mark, I insert the latest version from the bootstrap cdn site. My code looks like this:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Simpleblog&lt;/title&gt;\n&lt;%= csrf_meta_tags %&gt;\n&lt;%= csp_meta_tag %&gt;\n&lt;%= stylesheet_link_tag https://stackpath.bootstrapcdn.com/twitter- \nbootstrap/2.1.0/css/bootstrap-combined.min.css %&gt;\n&lt;%= stylesheet_link_tag    'application', media: 'all', 'data- \nturbolinks-track': 'reload' %&gt;\n&lt;%= javascript_include_tag 'application', 'data-turbolinks-track': \n'reload' %&gt;\n&lt;/head&gt;\n\n &lt;body&gt;\n&lt;%= yield %&gt;\n &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>However, when I go to localhost:3000, I receive a nasty error message that is displayed here:\n<a href=\"https://i.stack.imgur.com/ZmGlh.png\" rel=\"nofollow noreferrer\">click here to see error screen</a></p>\n\n<p>What is going on here? Any help to fix this issue would be greatly appreciated. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sinatra"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1528867417, "post_id": 50828696, "comment_id": 88663367, "body": "Looks like this could better go here: <a href=\"https://github.com/sinatra/sinatra/issues\" rel=\"nofollow noreferrer\">github.com/sinatra/sinatra/issues</a>"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1528868319, "post_id": 50828696, "comment_id": 88663672, "body": "This is working for me with <code>Sinatra (v2.0.1)</code> and <code>ruby 2.4.1p111</code>. Maybe you change version to see if there is some incompatibility."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1528871822, "post_id": 50828696, "comment_id": 88665190, "body": "Ok also <code>Sinatra (v2.0.3)</code> and <code>ruby 2.4.1</code>. But <b>problems</b> with <code>Sinatra (v2.0.3)</code> and <code>ruby 2.5.0</code>: <code>cannot load such file -- sinatra (LoadError)</code>"}], "owner": {"reputation": 159, "user_id": 687132, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bea16936fb8c9c2cbe42865ddc575a?s=128&d=identicon&r=PG", "display_name": "Chris Song", "link": "https://stackoverflow.com/users/687132/chris-song"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528860648, "creation_date": 1528860648, "question_id": 50828696, "link": "https://stackoverflow.com/questions/50828696/sinatra-fails-to-start-to-a-very-basic-demo-template-cache-is-nil", "title": "Sinatra fails to start to a very basic demo, template_cache is nil", "body": "<p>After gem install sinatra, I start a very basic demo code myapp.rb</p>\n\n<pre><code>require 'sinatra'\n\nget '/' do\n  'Hello world!'\nend\n</code></pre>\n\n<p>after run \"ruby myapp.rb\", visit <a href=\"http://localhost:4567/\" rel=\"nofollow noreferrer\">http://localhost:4567/</a> got failed</p>\n\n<pre><code>application error\nNoMethodError at / \nundefined method `clear' for nil:NilClass\n\n    file: base.rb location: call! line: 921 \n\n\nBACKTRACE\n\n /var/lib/gems/2.3.0/gems/sinatra-2.0.3/lib/sinatra/base.rb in call! \n\n    def call!(env) # :nodoc:\n      @env      = env\n      @params   = IndifferentHash.new\n      @request  = Request.new(env)\n      @response = Response.new\n      template_cache.clear if settings.reload_templates\n</code></pre>\n\n<p>here template_cache is nil, my sinatra version is 2.0.3 and gem version 2.3.0.</p>\n\n<p>How do I fix it?</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1528857162, "post_id": 50828286, "comment_id": 88661109, "body": "Mock method B, make it return something outlandish or random, and check A returns the same improbable thing?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1528927628, "post_id": 50828286, "comment_id": 88697434, "body": "Why do you want to do this? Why is it important for clients of <code>method_a</code> to know how it obtains its result? The whole point of encapsulation and abstraction is that clients do not, should not, and cannot know how stuff is implemented!"}, {"owner": {"reputation": 383, "user_id": 3985721, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9bee4235ea6f190c87d8162dfcc75009?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Hadik", "link": "https://stackoverflow.com/users/3985721/josh-hadik"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1528928898, "post_id": 50828286, "comment_id": 88697763, "body": "@J&#246;rgWMittag That&#39;s actually something I&#39;ve been wrestling with. As far as I can see I have two options: 1) Retest all of the logic for method a every time it&#39;s used somewhere else in code or 2) Test that method a was called and keep all of the tests for that methods logic contained to the unit test for method a. Neither one seems like a great option to me but I haven&#39;t been able to come up with a third."}, {"owner": {"reputation": 383, "user_id": 3985721, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9bee4235ea6f190c87d8162dfcc75009?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Hadik", "link": "https://stackoverflow.com/users/3985721/josh-hadik"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1528928928, "post_id": 50828286, "comment_id": 88697772, "body": "@J&#246;rgWMittag What are your thoughts on this? Am I missing an option? I&#39;ve only just gotten serious about writing tests in the last six months so your opinion would go a long way in setting me on the right track."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1528957161, "post_id": 50828286, "comment_id": 88704267, "body": "@JoshHadik: <code>method_a</code> has some kind of contract that it promises its callers. That contract is <i>not</i> &quot;I call <code>method_b</code>&quot;. That contract is something like &quot;If you pass me a positive real number, I return you the square root of that number&quot;. So, you write a couple of tests that pass in a perfect square, 0, a very big number, a very small number, a negative number, and so on, and check that the correct result is returned or an exception is raised. You do <i>not</i> assert that <code>square_root_helper</code> is called, because nobody cares what methods you call. They only care that you return the correct result"}], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 5506197, "user_type": "registered", "profile_image": "https://graph.facebook.com/1065312320169114/picture?type=large", "display_name": "\u738b\u4fe1\u51f1", "link": "https://stackoverflow.com/users/5506197/%e7%8e%8b%e4%bf%a1%e5%87%b1"}, "is_accepted": false, "score": 1, "last_activity_date": 1528859206, "creation_date": 1528859206, "answer_id": 50828543, "question_id": 50828286, "link": "https://stackoverflow.com/questions/50828286/how-do-you-test-that-a-ruby-method-returns-the-result-of-another-ruby-method/50828543#50828543", "title": "How do you test that a Ruby method returns the result of another Ruby method?", "body": "<p>you need rspec-mocks(<a href=\"https://relishapp.com/rspec/rspec-mocks/docs/configuring-responses/returning-a-value#specify-a-return-value\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-mocks/docs/configuring-responses/returning-a-value#specify-a-return-value</a>)</p>\n\n<pre><code>RSpec.describe SomeClass do\n  describe '#method_a' do\n    let(:some_class) { SomeClass.new }\n    context 'method_b return foobar' do\n      before { allow(some_class).to receive(:method_b).and_return('foobar') }\n      it 'will return foobar' do\n        allow(some_class).to receive(:method_b).and_return('foobar')\n        expect(some_class.method_a).to eq('foobar')\n      end\n    end\n    context 'method_b return barbar' do\n      before { allow(some_class).to receive(:method_b).and_return('barbar') }\n      it 'will return barbar' do\n        expect(some_class.method_a).to eq('barbar')\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 3985721, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9bee4235ea6f190c87d8162dfcc75009?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Hadik", "link": "https://stackoverflow.com/users/3985721/josh-hadik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528859206, "creation_date": 1528856984, "question_id": 50828286, "link": "https://stackoverflow.com/questions/50828286/how-do-you-test-that-a-ruby-method-returns-the-result-of-another-ruby-method", "title": "How do you test that a Ruby method returns the result of another Ruby method?", "body": "<p>Let's say I have two methods where one of the methods returns the result of the other method:</p>\n\n<pre><code>class SomeClass\n  def method_a\n    method_b\n  end\n\n  def method_b \n    'foobar'\n  end\nend\n</code></pre>\n\n<p>And I'm trying to test method_a without 'retesting' the logic from method b. To do that, I use something like this:</p>\n\n<pre><code>RSpec.describe SomeClass do\n  subject { SomeClass.new }\n\n  describe '#method_a' do\n    expect(subject).to receive(:method_b)\n    subject.method_a\n  end\nend\n</code></pre>\n\n<p>Usually this works just fine, however, in this case it is important that method a actually returns the result of method b, not just that it gets called. How can I do this? (Perhaps theirs a method for this? Potentially named something like #receive_and_return or #return_value_of_method_call or something along those lines.)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1528867591, "last_edit_date": 1528867591, "creation_date": 1528856827, "answer_id": 50828274, "question_id": 50828181, "link": "https://stackoverflow.com/questions/50828181/calculate-how-many-days-since-creation/50828274#50828274", "title": "Calculate how many days since creation", "body": "<p>Almost, but Ruby doesn't understand your way of writing a datetime.</p>\n\n<pre><code>require 'date'\n(DateTime.now - DateTime.new(2018, 2, 16, 18, 40, 53, 0)).to_i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1528867632, "post_id": 50828287, "comment_id": 88663443, "body": "This doesn&#39;t return number of days."}], "tags": [], "owner": {"reputation": 50, "user_id": 7508832, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QKulLVAB2PE/AAAAAAAAAAI/AAAAAAAAJLk/jP2OUoTO6nc/photo.jpg?sz=128", "display_name": "Ngalim Siregar", "link": "https://stackoverflow.com/users/7508832/ngalim-siregar"}, "is_accepted": false, "score": 0, "last_activity_date": 1528930517, "last_edit_date": 1528930517, "creation_date": 1528856989, "answer_id": 50828287, "question_id": 50828181, "link": "https://stackoverflow.com/questions/50828181/calculate-how-many-days-since-creation/50828287#50828287", "title": "Calculate how many days since creation", "body": "<p>You can use</p>\n\n<pre><code>require 'time'\ncreated_at = 'Fri, 16 Feb 2018 18:40:53 UTC +00:00'\n(Time.now - Time.parse(created_at)).to_i / 86400\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1528867467, "last_edit_date": 1528867467, "creation_date": 1528866878, "answer_id": 50829473, "question_id": 50828181, "link": "https://stackoverflow.com/questions/50828181/calculate-how-many-days-since-creation/50829473#50829473", "title": "Calculate how many days since creation", "body": "<p><strong>In rails</strong>\nIf you get the timestamp for the model <code>User</code> from the database (not a timestamp string to parse):</p>\n\n<pre><code>seconds_from_creation = Date.today.to_time - user.created_at.to_time\n</code></pre>\n\n<p>Or directly convert to days (to_i rounds to integer, check if is suitable for you or customise):</p>\n\n<pre><code>((Date.today.to_time - user.created_at.to_time)/(24*60*60)).to_i\n</code></pre>\n\n<p>In a view you could use the following, which returns a string :</p>\n\n<pre><code>time_ago_in_words user.created_at\n# =&gt; 10 days (in my case)\n</code></pre>\n"}], "owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 50828274, "answer_count": 3, "score": 0, "last_activity_date": 1613854378, "creation_date": 1528855831, "last_edit_date": 1613854378, "question_id": 50828181, "link": "https://stackoverflow.com/questions/50828181/calculate-how-many-days-since-creation", "title": "Calculate how many days since creation", "body": "<p>Let's say a record has a created_at timestamp of <code>Fri, 16 Feb 2018 18:40:53 UTC +00:00</code> and I want to find out the amount of days that have passed from  the current time. How could I achieve this?</p>\n<p>Here is what I've tried:</p>\n<pre><code>(Fri, 16 Feb 2018 18:40:53 UTC +00:00 - Time.now).to_i\n</code></pre>\n<p>But that does not work.</p>\n"}, {"tags": ["ruby", "selenium"], "comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1528859732, "post_id": 50828143, "comment_id": 88661594, "body": "Is this your own website you are testing?"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1528864303, "post_id": 50828143, "comment_id": 88662447, "body": "You want to locate both the input fields?"}, {"owner": {"reputation": 664, "user_id": 6496071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222f79483fc338268000d6effe25bbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Monika", "link": "https://stackoverflow.com/users/6496071/monika"}, "edited": false, "score": 0, "creation_date": 1528866157, "post_id": 50828143, "comment_id": 88662959, "body": "Can you please give the full HTML source for this page so that we can find out the unique XPath for you."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9932472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e25d03b9a7436d2c36a94e270c9908?s=128&d=identicon&r=PG&f=1", "display_name": "Romina", "link": "https://stackoverflow.com/users/9932472/romina"}, "edited": false, "score": 0, "creation_date": 1528952056, "post_id": 50830147, "comment_id": 88702411, "body": "thank you everyone for your suggestions.  The dev ended up adding an id for each field, however when i tried them I still get &#39;element not found&#39;.  I wondered if it&#39;s because they have a space (id= First Name &amp; id = Last Name).  I will need to go back to the Dev and ask him to change it.  Thanks again"}, {"owner": {"reputation": 5041, "user_id": 7305183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109a1b8acbf5d01c41e8e725b08411ba?s=128&d=identicon&r=PG&f=1", "display_name": "Murthi", "link": "https://stackoverflow.com/users/7305183/murthi"}, "reply_to_user": {"reputation": 1, "user_id": 9932472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e25d03b9a7436d2c36a94e270c9908?s=128&d=identicon&r=PG&f=1", "display_name": "Romina", "link": "https://stackoverflow.com/users/9932472/romina"}, "edited": false, "score": 0, "creation_date": 1528952173, "post_id": 50830147, "comment_id": 88702446, "body": "Yes, Id value shouldn&#39;t have space in it. Also check whether the elements are inside a frame. if it is inside a frame, you will get not found exception."}], "tags": [], "owner": {"reputation": 5041, "user_id": 7305183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109a1b8acbf5d01c41e8e725b08411ba?s=128&d=identicon&r=PG&f=1", "display_name": "Murthi", "link": "https://stackoverflow.com/users/7305183/murthi"}, "is_accepted": false, "score": 0, "last_activity_date": 1528870267, "creation_date": 1528870267, "answer_id": 50830147, "question_id": 50828143, "link": "https://stackoverflow.com/questions/50828143/find-two-text-field-that-seem-to-have-the-same-class-using-selenium-ruby/50830147#50830147", "title": "Find two text field that seem to have the same class using selenium ruby", "body": "<p>You can try with following x-paths:</p>\n\n<ol>\n<li>First Name element: <code>//div[text()='First Name']/following-sibling::div/div/input</code></li>\n<li>Last Name element: <code>//div[text()='Last Name']/following-sibling::div/div/input</code></li>\n</ol>\n\n<p>In code,</p>\n\n<pre><code>first_name = driver.find_element(:xpath, \"//div[text()='First Name']/following-sibling::div/div/input\")\nfirst_name.send_keys \"FName\"\n\nlast_name = driver.find_element(:xpath, \"//div[text()='Last Name']/following-sibling::div/div/input\")\nlast_name.send_keys \"LName\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 0, "last_activity_date": 1528874070, "creation_date": 1528874070, "answer_id": 50831146, "question_id": 50828143, "link": "https://stackoverflow.com/questions/50828143/find-two-text-field-that-seem-to-have-the-same-class-using-selenium-ruby/50831146#50831146", "title": "Find two text field that seem to have the same class using selenium ruby", "body": "<p>Write the xpath like given below</p>\n\n<pre><code>driver.find_element(xpath: \"//div[normalize-space()='First Name']/following::input\").send_keys \"FirstName\"\n</code></pre>\n\n<p>For LastName</p>\n\n<pre><code>driver.find_element(xpath: \"//div[normalize-space()='Last Name']/following::input\").send_keys \"LastName\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9932472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e25d03b9a7436d2c36a94e270c9908?s=128&d=identicon&r=PG&f=1", "display_name": "Romina", "link": "https://stackoverflow.com/users/9932472/romina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528874070, "creation_date": 1528855496, "last_edit_date": 1528869882, "question_id": 50828143, "link": "https://stackoverflow.com/questions/50828143/find-two-text-field-that-seem-to-have-the-same-class-using-selenium-ruby", "title": "Find two text field that seem to have the same class using selenium ruby", "body": "<p>I am writing a simple script to find and enter text into First name and Last name fields for a web page profile in firefox. I have navigated to the page and inspected the element, however I have tried everything i can think of the find the element but nothing seems to work.  How can I find these fields using ruby, is there another way to inspect the field?</p>\n\n<p>Both of these fields have field labels</p>\n\n<p>First name inspect result </p>\n\n<pre><code>&lt;div class=\"input__label\"&gt;First Name&lt;/div&gt;\n&lt;div class=\"input_row\"&gt;\n&lt;div class=\"split_control\"&gt;\n&lt;input class=\"input__input_wide\" step=\"any\" value=\"Bob\"&gt;\n</code></pre>\n\n<p>Last name inspect result</p>\n\n<pre><code>&lt;div class=\"input__label\"&gt;Last Name&lt;/div&gt;\n&lt;div class=\"input_row\"&gt;\n&lt;div class=\"split_control\"&gt;\n&lt;input class=\"input__input_wide\" step=\"any\" value=\"Smith\"&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "ruby-on-rails-5", "rails-admin"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1528853855, "post_id": 50827896, "comment_id": 88660476, "body": "There are a some gems that provide phone number formatting functionality, you could try them, <a href=\"https://github.com/daddyz/phonelib\" rel=\"nofollow noreferrer\">github.com/daddyz/phonelib</a> is one of them"}], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 5506197, "user_type": "registered", "profile_image": "https://graph.facebook.com/1065312320169114/picture?type=large", "display_name": "\u738b\u4fe1\u51f1", "link": "https://stackoverflow.com/users/5506197/%e7%8e%8b%e4%bf%a1%e5%87%b1"}, "is_accepted": false, "score": 2, "last_activity_date": 1528882373, "creation_date": 1528882373, "answer_id": 50833830, "question_id": 50827896, "link": "https://stackoverflow.com/questions/50827896/changing-value-formatting-in-rails-admins-fields/50833830#50833830", "title": "Changing Value Formatting in Rails Admin&#39;s Fields", "body": "<p>Check wiki again, and you will see <code>Just define them as methods on your model, then configure a field of the same name.</code></p>\n\n<p>so, just define a <code>phone_number_formatted</code> methods in your user model</p>\n\n<p>and use <code>field :phone_number_formatted</code> in rails_admin.rb</p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 8657696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XlVQO.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/8657696/andy"}, "edited": false, "score": 0, "creation_date": 1528931070, "post_id": 50840676, "comment_id": 88698371, "body": "perfect! exactly what I needed"}, {"owner": {"reputation": 332, "user_id": 5238822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23aeccb480cb323503ba983f61598e17?s=128&d=identicon&r=PG", "display_name": "Jigarius", "link": "https://stackoverflow.com/users/5238822/jigarius"}, "edited": false, "score": 0, "creation_date": 1610599953, "post_id": 50840676, "comment_id": 116186063, "body": "Is there a way to apply this to all fields of a specific type? Say, I want all boolean fields to appear as &quot;Yes&quot; or &quot;No&quot;."}, {"owner": {"reputation": 3312, "user_id": 412528, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7a781dab51284428bf9a44f3e0c85b6a?s=128&d=identicon&r=PG", "display_name": "Guillermo Siliceo Trueba", "link": "https://stackoverflow.com/users/412528/guillermo-siliceo-trueba"}, "edited": false, "score": 0, "creation_date": 1610732462, "post_id": 50840676, "comment_id": 116234105, "body": "Booleans by default are checkboxes do you want them to be two radio button with the Yes and No labels right?"}], "tags": [], "owner": {"reputation": 3312, "user_id": 412528, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7a781dab51284428bf9a44f3e0c85b6a?s=128&d=identicon&r=PG", "display_name": "Guillermo Siliceo Trueba", "link": "https://stackoverflow.com/users/412528/guillermo-siliceo-trueba"}, "is_accepted": true, "score": 1, "last_activity_date": 1528902749, "creation_date": 1528902749, "answer_id": 50840676, "question_id": 50827896, "link": "https://stackoverflow.com/questions/50827896/changing-value-formatting-in-rails-admins-fields/50840676#50840676", "title": "Changing Value Formatting in Rails Admin&#39;s Fields", "body": "<p>If you want to keep the rails admin formatting logic contained you can do this</p>\n\n<pre><code>  config.model User do\n    list do\n      field :id\n      field :full_name\n      field :email\n      field :phone_number do\n        formatted_value do\n          value.split('-') # Or whatever you want to do\n        end\n      end\n    end\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 8657696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XlVQO.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/8657696/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1185, "favorite_count": 0, "accepted_answer_id": 50840676, "answer_count": 2, "score": 0, "last_activity_date": 1528902749, "creation_date": 1528853027, "question_id": 50827896, "link": "https://stackoverflow.com/questions/50827896/changing-value-formatting-in-rails-admins-fields", "title": "Changing Value Formatting in Rails Admin&#39;s Fields", "body": "<p>I have a column for my <code>User</code> model that displays <code>phone_numbers</code> lifted directly from the database. I want my Rails Admin to display these number formatted. </p>\n\n<p>For example:\n<code>\n`Current` =&gt; `What I want`\n1234567890 =&gt; (123) 456-7890\n</code></p>\n\n<p>This is currently what I have in my <code>rails_admin.rb</code> file:</p>\n\n<pre><code>  config.model User do\n    list do\n      field :id\n      field :full_name\n      field :email\n      field :phone_number\n    end\n</code></pre>\n\n<p>I tried implementing the virtual field from the wiki (<a href=\"https://github.com/sferik/rails_admin/wiki/Fields\" rel=\"nofollow noreferrer\">https://github.com/sferik/rails_admin/wiki/Fields</a>) but that didn't work</p>\n\n<pre><code># From users.rb - User Model\n  def phone_number_formatted\n    #method to format number\n  end\n\n  # From rails_admin.rb\n  config.model User do\n    list do\n      field :id\n      field :full_name\n      field :email\n      field :phone_number_formatted, :phone_number\n    end\n</code></pre>\n\n<p>Any suggestions? Any help is greatly appreciated. Thanks!</p>\n"}, {"tags": ["ruby", "homebrew", "macos-high-sierra"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1528848816, "post_id": 50827320, "comment_id": 88659483, "body": "did you try the install command with sudo instead of changing the permission of <code>&#47;tmp</code> folder?"}, {"owner": {"reputation": 31, "user_id": 9932939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3812450aa15319abfd02e1f512c4e45?s=128&d=identicon&r=PG&f=1", "display_name": "Queu", "link": "https://stackoverflow.com/users/9932939/queu"}, "reply_to_user": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1528850379, "post_id": 50827320, "comment_id": 88659774, "body": "@Subash I did and it gave me   <code>Error: Running Homebrew as root is extremely dangerous and no longer supported. As Homebrew does not drop privileges on installation you would be giving all build scripts full access to your system.</code>"}, {"owner": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "edited": false, "score": 0, "creation_date": 1528851933, "post_id": 50827320, "comment_id": 88660101, "body": "This might help: <a href=\"https://stackoverflow.com/questions/16432071/how-to-fix-homebrew-permissions\" title=\"how to fix homebrew permissions\">stackoverflow.com/questions/16432071/&hellip;</a>"}], "owner": {"reputation": 31, "user_id": 9932939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3812450aa15319abfd02e1f512c4e45?s=128&d=identicon&r=PG&f=1", "display_name": "Queu", "link": "https://stackoverflow.com/users/9932939/queu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1528847243, "creation_date": 1528847243, "question_id": 50827320, "link": "https://stackoverflow.com/questions/50827320/permission-denied-rb-system-when-attempt-to-install-httpd-using-homebrew", "title": "Permission denied @rb_system when attempt to install httpd using Homebrew", "body": "<p>I want to install httpd using Homebrew but I keep getting this error - </p>\n\n<pre><code>Error: Permission denied @ rb_sysopen - /tmp/github_api_headers20180612-63207-1943ua6\n</code></pre>\n\n<p>I tried - <code>sudo chmod -R 1777 /tmp</code> but that is not working </p>\n\n<p>This is the current permission set for /tmp</p>\n\n<pre><code>drwxr-xr-x    8 _mysql  _mysql   256 Jun 12 18:39 tmp\n</code></pre>\n\n<p>Here is some information on my mac air</p>\n\n<pre><code>System Version: macOS 10.13.5 (17F77) \nKernel Version: Darwin 17.6.0\n</code></pre>\n\n<p>Even when I attempt to update ruby it gives me this error </p>\n\n<pre><code>[2018-06-12 18:13:32] requirements_osx_brew_libs_install\nrequirements_osx_brew_libs_install () \n{ \n    brew install \"$@\" --force || { \n        \\typeset ret=$?;\n        requirements_osx_brew_libs_error \"installation\";\n        case \"$_system_version\" in \n            10.6)\n                rvm_warn \"\nOn OSX 10.6 instead of command line tools install:\n    https://github.com/downloads/kennethreitz/osx-gcc-installer/GCC-10.6.pkg\"\n            ;;\n        esac;\n        return $ret\n    }\n}\ncurrent path: /Users/iivri.andre\nPATH=/Library/Frameworks/Python.framework/Versions/3.5/bin:/Users/iivri.andre/.sdkman/candidates/gradle/current/bin:/opt/local/bin:/opt/local/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/go/bin:/Users/iivri.andre/.rvm/bin\ncommand(10): requirements_osx_brew_libs_install autoconf automake libtool pkg-config coreutils libyaml readline libksba openssl@1.1\n++ brew install autoconf automake libtool pkg-config coreutils libyaml readline libksba openssl@1.1 --force\nError: Permission denied @ rb_sysopen - /tmp/github_api_headers20180612-55209-1k19y8s\n</code></pre>\n\n<p>How can I correct this issue? </p>\n"}, {"tags": ["ruby", "chef-infra"], "answers": [{"tags": [], "owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "is_accepted": false, "score": 1, "last_activity_date": 1528846292, "creation_date": 1528846292, "answer_id": 50827208, "question_id": 50827172, "link": "https://stackoverflow.com/questions/50827172/ruby-chef-recipe-array-conditional/50827208#50827208", "title": "ruby chef recipe array &amp;&amp;= conditional", "body": "<p>Expand the expression like this:</p>\n\n<pre><code>allow_mongodb_instance_run = allow_mongodb_instance_run &amp;&amp; false\n</code></pre>\n\n<p>If <code>allow_mongodb_instance_run</code> is truthy (not <code>false</code> or <code>nil</code>), it becomes <code>false</code>.</p>\n\n<p>If <code>allow_mongodb_instance_run</code> is <code>false</code> it remains <code>false</code>.</p>\n\n<p>if <code>allow_mongodb_instance_run</code> is <code>nil</code>, it remains <code>nil</code>, and does not become <code>false</code>.</p>\n\n<p>No I don't know why someone needs this distinction, but preserving the <code>nil</code> is the only benefit I can think of over just <code>allow_mongodb_instance_run = false</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1528848657, "creation_date": 1528848657, "answer_id": 50827464, "question_id": 50827172, "link": "https://stackoverflow.com/questions/50827172/ruby-chef-recipe-array-conditional/50827464#50827464", "title": "ruby chef recipe array &amp;&amp;= conditional", "body": "<p>It's a slightly awkward way to check if the node is also set up to run the older <code>sc-mongodb</code> cookbook before the two were merged back together because having both would lead to conflicts (both cookbooks trying to configure/install the same things).</p>\n"}], "owner": {"reputation": 1, "user_id": 9932900, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aHZcXqloweA/AAAAAAAAAAI/AAAAAAAAAGg/hUE656ZHSGI/photo.jpg?sz=128", "display_name": "venkat K", "link": "https://stackoverflow.com/users/9932900/venkat-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528848657, "creation_date": 1528846027, "last_edit_date": 1528846071, "question_id": 50827172, "link": "https://stackoverflow.com/questions/50827172/ruby-chef-recipe-array-conditional", "title": "ruby chef recipe array &amp;&amp;= conditional", "body": "<p>I am learning ruby to write chef cookbooks. I was going through this recipe\n<a href=\"https://github.com/sous-chefs/mongodb/blob/master/recipes/default.rb\" rel=\"nofollow noreferrer\">https://github.com/sous-chefs/mongodb/blob/master/recipes/default.rb</a>. I was stumbled at this code block.</p>\n\n<pre><code>conflicting_recipes.each do |recipe| \n  allow_mongodb_instance_run &amp;&amp;= false if node.run_context.loaded_recipe?(recipe)\nend\n</code></pre>\n\n<p>I went through documentation of <code>&amp;&amp;=</code> but it didn't make much sense to me. Can someone please care to explain this to me. Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1528844480, "post_id": 50826798, "comment_id": 88658562, "body": "Number of times I&#39;ve used the built-in documentation for Ruby since 2005: Zero. The web-based versions are always better. That documentation is only relevant if you know you&#39;re going offline for some time, and in that case a printed book is probably better."}, {"owner": {"reputation": 11, "user_id": 9932778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fd0b757c9ac7dde6f42535de790d233?s=128&d=identicon&r=PG&f=1", "display_name": "erik", "link": "https://stackoverflow.com/users/9932778/erik"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1528844851, "post_id": 50826798, "comment_id": 88658667, "body": "@tadman THANK YOU!!! I&#39;ve been stuck waiting to get an appropriate response before moving ahead for a few hours now and have commented on numerous sites. Thanks again, that&#39;s a huge help!!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9932778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fd0b757c9ac7dde6f42535de790d233?s=128&d=identicon&r=PG&f=1", "display_name": "erik", "link": "https://stackoverflow.com/users/9932778/erik"}, "edited": false, "score": 0, "creation_date": 1528843795, "post_id": 50826828, "comment_id": 88658410, "body": "Could you quickly catch up on this conversation I had today ? &lt;<a href=\"https://askubuntu.com/questions/1045780/problem-with-rails-installfest-what-do-i-enter-to-correct-issue-libreadline6-d/1045987#1045987\" title=\"problem with rails installfest what do i enter to correct issue libreadline6 d\">askubuntu.com/questions/1045780/&hellip;</a>&gt;  The issue started yesterday, and I started getting caught up today through the help of someone online and then they disappeared. Is it possible to review that quick exchange as it is the preface for this question and helps illuminate what exactly I&#39;m trying to do which I have a hard time explaining being a newbie haha."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528844519, "post_id": 50826828, "comment_id": 88658569, "body": "You can set up a <code>~&#47;.gemrc</code> with flags to skip generating documentation. Makes installing gems <i>much</i> faster."}, {"owner": {"reputation": 11, "user_id": 9932778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fd0b757c9ac7dde6f42535de790d233?s=128&d=identicon&r=PG&f=1", "display_name": "erik", "link": "https://stackoverflow.com/users/9932778/erik"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528844981, "post_id": 50826828, "comment_id": 88658715, "body": "@tadman based on what you may have picked up in this thread and the link directly above, would you say it&#39;s best to use <code>~&#47;.gemrc</code>? I personally don&#39;t mind wait times if I know nothing will be messed up and everything will function properly."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528850946, "post_id": 50826828, "comment_id": 88659892, "body": "You can use that file to set defaults for your installs, and you can always override as necessary if/when that&#39;s an issue. As most people use <code>bundle install</code> it&#39;s less of a problem these days, but still useful."}], "tags": [], "owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "is_accepted": false, "score": 0, "last_activity_date": 1528843326, "creation_date": 1528843326, "answer_id": 50826828, "question_id": 50826798, "link": "https://stackoverflow.com/questions/50826798/do-i-build-ruby-documentation-in-ubuntu-or-should-i-simply-move-past-this/50826828#50826828", "title": "Do I build Ruby documentation in Ubuntu ? Or should I simply move past this?", "body": "<p>I use RubyMine. When I'm curious about a method, such as <code>render</code>, I put the text caret on it and hit Control+B. RubyMine takes me to the method's definition, where I can read the comment which generates that documentation.</p>\n\n<p>I always build Ruby and Gems with full documentation, and I never bother to read their output...</p>\n"}], "owner": {"reputation": 11, "user_id": 9932778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fd0b757c9ac7dde6f42535de790d233?s=128&d=identicon&r=PG&f=1", "display_name": "erik", "link": "https://stackoverflow.com/users/9932778/erik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528843326, "creation_date": 1528843157, "question_id": 50826798, "link": "https://stackoverflow.com/questions/50826798/do-i-build-ruby-documentation-in-ubuntu-or-should-i-simply-move-past-this", "title": "Do I build Ruby documentation in Ubuntu ? Or should I simply move past this?", "body": "<p>While navigating through <a href=\"http://installfest.railsbridge.org/installfest/linux\" rel=\"nofollow noreferrer\">http://installfest.railsbridge.org/installfest/linux</a>  I made it to step 4 and instead of <code>rvm install 2.3</code> I used <code>rvm install 2.4.4</code> in the Ubuntu command prompt and everything ran fine. Once output was finished, the last two lines said: <br /> <code>Install of ruby-2.4.4 - #complete \nRuby was built without documentation, to build it run: rvm docs generate-ri</code> <br /> What do you fine people think? Build or not?<br /> The above link is meant to be part of an installation process for The Odin Project, which is just a free online web dev course if that helps put things into perspective.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csrf", "turbolinks"], "comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1528844540, "post_id": 50826737, "comment_id": 88658573, "body": "Post your form code and the html it generates."}], "owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1053, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1528900132, "creation_date": 1528842782, "last_edit_date": 1528900132, "question_id": 50826737, "link": "https://stackoverflow.com/questions/50826737/submiting-form-using-turbolinks-from-javascript", "title": "Submiting form using turbolinks from javascript", "body": "<p>Is it possible to submit form from javascript using Turbolinks ? I have form with remote:true but i dont want to send it when submit button is clicked, instead i want to use ordinary button that is outside the form that will send it on click. Is it possible to submit form from js without crazy cheats like simulating click on \"submit button\" ? I dont want to use manual ajax because then i need to build xhr request for each form and attach somehow CRSF token to it. </p>\n\n<p>If i try to do it by </p>\n\n<pre><code>$(\"#form\").submit()\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>ActionController::InvalidAuthenticityToken\n</code></pre>\n\n<p>which is propably cross forgery problem </p>\n\n<p>but I have in my application.html.erb</p>\n\n<pre><code>&lt;%= csrf_meta_tags %&gt;\n</code></pre>\n\n<p>but submitting using jquery doesnt attach token because its xhr... </p>\n\n<p>Or maybe there is a easy way to just attach token to .submit() ?</p>\n\n<p><strong>EDIT 1:</strong></p>\n\n<p>I added this to my form</p>\n\n<pre><code>&lt;input name=\"authenticity_token\" \n           type=\"hidden\" \n           value=\"&lt;%= form_authenticity_token %&gt;\"/&gt;\n</code></pre>\n\n<p>and works</p>\n\n<p>but now submiting form like <code>$(form).submit()</code>, sends it twice with turbolinks... Seems like turbolinks runs and after it normal submit is permorming and site is reload. I guess the more I try cooperate between turbolinks and ordinary js the more problems I find</p>\n\n<p>form.html.erb</p>\n\n<pre><code>&lt;h2&gt;Sign up&lt;/h2&gt;\n\n&lt;%= form_for(resource, as: resource_name, url: registration_path(resource_name), remote: true) do |f| %&gt;\n&lt;input name=\"authenticity_token\" \n               type=\"hidden\" \n               value=\"&lt;%= form_authenticity_token %&gt;\"/&gt;\n  &lt;%= devise_error_messages! %&gt;\n\n&lt;div data-behavior=\"devise-error-messages\"&gt;\n  &lt;%= devise_error_messages! %&gt;\n&lt;/div&gt;\n&lt;div data-behavior=\"flashes\"&gt;\n  &lt;%= flash[:notice] %&gt;\n  &lt;%= flash[:error] %&gt;\n&lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :email %&gt;&lt;br /&gt;\n    &lt;%= f.email_field :email, autofocus: true, autocomplete: \"email\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :password %&gt;\n    &lt;% if @minimum_password_length %&gt;\n    &lt;em&gt;(&lt;%= @minimum_password_length %&gt; characters minimum)&lt;/em&gt;\n    &lt;% end %&gt;&lt;br /&gt;\n    &lt;%= f.password_field :password, autocomplete: \"off\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :password_confirmation %&gt;&lt;br /&gt;\n    &lt;%= f.password_field :password_confirmation, autocomplete: \"off\" %&gt;\n  &lt;/div&gt;\n\n&lt;!--  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit \"Sign up\" %&gt;\n  &lt;/div&gt; --&gt;\n&lt;% end %&gt;\n&lt;div class=\"actions\"&gt;\n    &lt;button id=\"sign_up\"&gt;Sign up&lt;/button&gt;\n&lt;/div&gt;\n&lt;%= render \"devise/shared/links\" %&gt;\n</code></pre>\n\n<p>app.js</p>\n\n<pre><code>$(document).on(\"ready\", function(e){\n\n\n$(document).on(\"submit\", \"#new_user\", function(e){\n\n\n    console.log(e);\n\n\n});\n\n$(document).on(\"click\", \"#sign_up\", function(e){\n\n    $(\"#new_user\").submit();\n\n\n})\n\n});\n</code></pre>\n\n<p><strong>EDIT 2</strong>\nso I changed my click event to this</p>\n\n<pre><code>$(document).on(\"click\", \"#sign_up\", function(e){\n\n var elem = document.getElementById('new_user') \n Rails.fire(elem, 'submit');\n console.log(\"sign up click\");\n})\n</code></pre>\n\n<p>Now it works and form submits once.</p>\n\n<p>Another problem with turbolinks is that when I successfuly sign_up I generate javascript with <code>Turbolinks.visit(\"/user_after_signed_up\")</code></p>\n\n<p>I wanted to prevent back button so, i cant back to my login form, so i turned of cache adding this to application.html:\n <code>&lt;meta name=\"turbolinks-cache-control\" content=\"no-cache\"&gt;</code></p>\n\n<p>Guess what, not working. </p>\n\n<p>in my routes i redirect authenticated users to dashboard if they want to access 'login form', but with turbolinks, when u click back 'address change' and turbolinks serve cached version.</p>\n\n<p>IM NOT ABLE TO TURN OFF this cache, I also tried</p>\n\n<p><code>Turbolinks.cacheClear()</code></p>\n\n<p>in several places and still doesnt work.</p>\n\n<p><strong>EDIT 3</strong></p>\n\n<p>combining both actually make it works\nadd this to application.html\n<code>&lt;meta name=\"turbolinks-cache-control\" content=\"no-cache\"&gt;</code>\nand this in rendered js </p>\n\n<p><code>Turbolinks.cacheClear()</code> before <code>Turbolinks.visit(\"/path_to_redirect\")</code></p>\n\n<p>But it seems unlogic to clear cache where there suppose to be no caching at all...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite"], "comments": [{"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1530712481, "post_id": 50826493, "comment_id": 89333455, "body": "You can use simple command <code>RAILS_ENV=development rails db:setup</code> instead of <code>RAILS_ENV=development rails db:drop db:create db:migrate db:seed</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4071, "user_id": 2354735, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Q33GM.jpg?s=128&g=1", "display_name": "Jet Blue", "link": "https://stackoverflow.com/users/2354735/jet-blue"}, "edited": false, "score": 0, "creation_date": 1528844374, "post_id": 50826676, "comment_id": 88658536, "body": "Oh. I git cloned the repository so my <code>db&#47;development.sqlite3</code> was indeed empty! I managed to get a copy of the original file and copied and pasted it there. I am now getting a <code>Cannot visit Integer</code> error. Searching around shows that the <a href=\"https://stackoverflow.com/a/44102011/2354735\">error might be due to a Rails version incompatibility</a>. Does that mean that the contents of the <code>db&#47;development.sqlite3</code> file is not generic but somehow specific to a Rails/Ruby version and I can&#39;t simply copy&amp;paste? I.e. is there no way to use my old data with the newer gems?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 4071, "user_id": 2354735, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Q33GM.jpg?s=128&g=1", "display_name": "Jet Blue", "link": "https://stackoverflow.com/users/2354735/jet-blue"}, "edited": false, "score": 0, "creation_date": 1528844569, "post_id": 50826676, "comment_id": 88658583, "body": "@JetBlue The database file is normally ignored, because it&#39;s data. You can take a db:dump and reload it, but in general you wouldn&#39;t want to shuffle around the binary DB data as the file format may change etc."}, {"owner": {"reputation": 4071, "user_id": 2354735, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Q33GM.jpg?s=128&g=1", "display_name": "Jet Blue", "link": "https://stackoverflow.com/users/2354735/jet-blue"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1528844700, "post_id": 50826676, "comment_id": 88658631, "body": "@DaveNewton Thanks, how would I do a <code>db:dump</code>?"}, {"owner": {"reputation": 4071, "user_id": 2354735, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Q33GM.jpg?s=128&g=1", "display_name": "Jet Blue", "link": "https://stackoverflow.com/users/2354735/jet-blue"}, "edited": false, "score": 0, "creation_date": 1528848301, "post_id": 50826676, "comment_id": 88659387, "body": "Turns out the <code>Cannot visit Integer</code> error was not related to the database."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 4071, "user_id": 2354735, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Q33GM.jpg?s=128&g=1", "display_name": "Jet Blue", "link": "https://stackoverflow.com/users/2354735/jet-blue"}, "edited": false, "score": 0, "creation_date": 1528849031, "post_id": 50826676, "comment_id": 88659522, "body": "@JetBlue I don&#39;t remember. It might be a gem."}], "tags": [], "owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "is_accepted": true, "score": 1, "last_activity_date": 1528842396, "creation_date": 1528842396, "answer_id": 50826676, "question_id": 50826493, "link": "https://stackoverflow.com/questions/50826493/could-not-find-table-following-upgrade-to-newer-ruby-and-rails-versions/50826676#50826676", "title": "Could not find table (following upgrade to newer Ruby and Rails versions)", "body": "<p>If you're using SQLite and there's no <code>db/development.sqlite3</code> file, something happened with it and you'll have to recreate your database. If this is the development environment and you can clean the database, run the following command:</p>\n\n<pre><code>RAILS_ENV=development rails db:drop db:create db:migrate db:seed\n</code></pre>\n\n<p>This is going to recreate the database, run the migrations and the <code>seeds.rb</code> file.</p>\n\n<p>Note: by default, Rails creates the <code>.gitignore</code> file excluding <code>.sqlite3</code> files. This is going to prevent the SQLite database to be versioned.</p>\n"}], "owner": {"reputation": 4071, "user_id": 2354735, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Q33GM.jpg?s=128&g=1", "display_name": "Jet Blue", "link": "https://stackoverflow.com/users/2354735/jet-blue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 50826676, "answer_count": 1, "score": 0, "last_activity_date": 1530712123, "creation_date": 1528841175, "last_edit_date": 1530712123, "question_id": 50826493, "link": "https://stackoverflow.com/questions/50826493/could-not-find-table-following-upgrade-to-newer-ruby-and-rails-versions", "title": "Could not find table (following upgrade to newer Ruby and Rails versions)", "body": "<p>I had an app (based on <a href=\"https://www.railstutorial.org/book/toy_app\" rel=\"nofollow noreferrer\">this tutorial</a>) that used to work. However, I now get the error:</p>\n\n<blockquote>\n  <p>Could not find table 'users'</p>\n</blockquote>\n\n<p>I had to upgrade the version of Ruby I was using (from 2.0.0 to 2.4.4). With the newer Ruby version, I also had to use newer versions of some of the gems the app uses. In particular, a newer version of sqlite3 which manages the app's database.</p>\n\n<p>Is the new sqlite3 the reason the table can no longer be found? What can I do to resolve the error? I assume upgrading the gem version did not delete the data the table previously contained...</p>\n"}, {"tags": ["ruby", "linux", "signals", "posix"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528864759, "post_id": 50826271, "comment_id": 88662575, "body": "To the Ruby script or to some other process? It could be how Ruby is compiled. Maybe that debugging feature wasn&#39;t built into one. Each distribution has their own Ruby maintainer with different build priorities."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9968247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c090cd5d72f7c891fa71998c1dd2b5e2?s=128&d=identicon&r=PG&f=1", "display_name": "amaia", "link": "https://stackoverflow.com/users/9968247/amaia"}, "is_accepted": false, "score": -1, "last_activity_date": 1532608499, "creation_date": 1532608499, "answer_id": 51538989, "question_id": 50826271, "link": "https://stackoverflow.com/questions/50826271/why-posix-signals-are-ignored-on-some-linux-machines/51538989#51538989", "title": "Why POSIX signals are ignored on some Linux machines?", "body": "<p>One process can programmatically change a signal behaviour (except SIGKILL and SIGSTOP) \n<a href=\"http://man7.org/linux/man-pages/man2/signal.2.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man2/signal.2.html</a></p>\n"}], "owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1532608499, "creation_date": 1528839936, "last_edit_date": 1528871838, "question_id": 50826271, "link": "https://stackoverflow.com/questions/50826271/why-posix-signals-are-ignored-on-some-linux-machines", "title": "Why POSIX signals are ignored on some Linux machines?", "body": "<p>I have a few Linux machines (Ubuntu 16.04 and CentOS 7.5). I run exactly the same Ruby script on all of them. Then, I send <code>kill -CONT pid</code> to each of them (to get <a href=\"https://github.com/frsyuki/sigdump/\" rel=\"nofollow noreferrer\">sigdump</a> log). Some machines react, others completely ignore the signal. What could be the reason?</p>\n\n<p>Cross-posted <a href=\"https://github.com/frsyuki/sigdump/issues/10\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actioncontroller"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1528840124, "post_id": 50826117, "comment_id": 88657330, "body": "what is the result of <code>params.to_h.keys?</code>"}, {"owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1528840343, "post_id": 50826117, "comment_id": 88657411, "body": "I don&#39;t have any <code>params</code> whitelisted yet, so I did this <code>params.to_unsafe_h.keys</code> and got the keys.. which look like this: [&quot;{\\&quot;base_options\\&quot;:{\\&quot;origin\\&quot;:{\\&quot;name\\&quot;:\\&quot;\\&quot;,\\&quot;phone\\&quot;:\\&quot;\\&zwnj;&#8203;&quot;,\\&quot;street_1\\&quot;:\\&quot;\\&quot;,&zwnj;&#8203;\\&quot;street_2\\&quot;:\\&quot;\\&quot;,\\&quot;&zwnj;&#8203;zip\\&quot;:\\&quot;\\&quot;,\\&quot;city\\&quot;:&zwnj;&#8203;\\&quot;\\&quot;,\\&quot;state_iso2\\&quot;:&zwnj;&#8203;\\&quot;\\&quot;,\\&quot;country_iso2\\&zwnj;&#8203;&quot;:\\&quot;US\\&quot;,\\&quot;address_t&zwnj;&#8203;ype\\&quot;:\\&quot;commercial\\&quot;&zwnj;&#8203;},\\&quot;destination\\&quot;:{\\&zwnj;&#8203;&quot;name\\&quot;:\\&quot;\\&quot;,\\&quot;phone&zwnj;&#8203;\\&quot;:\\&quot;\\&quot;,\\&quot;street_1\\&quot;&zwnj;&#8203;:\\&quot;933 Nottingham Dr\\&quot;,\\&quot;street_2\\&quot;:\\&quot;\\&quot;,\\&quot;zip\\&quot;:\\&quot;28211\\&quot;,\\&quot;city\\&quot;:\\&quot;Charlott&zwnj;&#8203;e\\&quot;,\\&quot;state_iso2\\&quot;:\\&zwnj;&#8203;&quot;NC\\&quot;,\\&quot;country_iso2&zwnj;&#8203;\\&quot;:\\&quot;US\\&quot;,\\&quot;address_&zwnj;&#8203;type\\&quot;:\\&quot;residential&zwnj;&#8203;\\&quot;},\\&quot;items\\&quot;:&quot;, &quot;controller&quot;, &quot;action&quot;]"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1528844326, "post_id": 50826117, "comment_id": 88658519, "body": "Are you interacting with AWS here? The <code>&quot;action&quot;=&gt;&quot;amazon_creds&quot;</code> suggests you are. AWS likes JSON so much that it often encodes JSON inside JSON so you might have to dig the right thing out of <code>params</code> and then manually <code>JSON.parse</code> it, and then dig out your SKU."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1528846280, "post_id": 50826117, "comment_id": 88659000, "body": "so it is as it appears from the paste in your question ... the keys of <code>params</code> are JSON encoded strings for some reason. This seems really wierd to me - where is this request coming from?"}, {"owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "edited": false, "score": 0, "creation_date": 1528850707, "post_id": 50826117, "comment_id": 88659842, "body": "Well these params are actually coming from BigCommerce. I&#39;m wondering if somehow they just aren&#39;t right. I&#39;m not sure at this point."}], "answers": [{"tags": [], "owner": {"reputation": 623, "user_id": 572011, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9699d27e5962b8d6c0efea6b6897f34?s=128&d=identicon&r=PG", "display_name": "Luke Eller", "link": "https://stackoverflow.com/users/572011/luke-eller"}, "is_accepted": true, "score": 1, "last_activity_date": 1528858280, "creation_date": 1528858280, "answer_id": 50828426, "question_id": 50826117, "link": "https://stackoverflow.com/questions/50826117/cannot-access-actioncontrollerparameters-no-matter-what-i-try/50828426#50828426", "title": "Cannot access ActionController::Parameters no matter what I try", "body": "<p>Rails will automatically populate the params hash with the deserialized request body if the <code>Content-Type</code> request header is set to <code>application/json</code>. It appears that the header is missing for this request. We're adding the appropriate header now.</p>\n"}], "owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 50828426, "answer_count": 1, "score": 0, "last_activity_date": 1528858280, "creation_date": 1528839128, "question_id": 50826117, "link": "https://stackoverflow.com/questions/50826117/cannot-access-actioncontrollerparameters-no-matter-what-i-try", "title": "Cannot access ActionController::Parameters no matter what I try", "body": "<p>No idea why I can't access these params which are of class ActionController::Parameters. Here are the params:</p>\n\n<pre><code>{\"{\\\"base_options\\\":{\\\"origin\\\":{\\\"name\\\":\\\"\\\",\\\"phone\\\":\\\"\\\",\\\"street_1\\\":\\\"\\\",\\\n\"street_2\\\":\\\"\\\",\\\"zip\\\":\\\"\\\",\\\"city\\\":\\\"\\\",\\\"state_iso2\\\":\\\"\\\",\\\"country_iso2\\\":\\\n\"US\\\",\\\"address_type\\\":\\\"commercial\\\"},\\\"destination\\\":{\\\"name\\\":\\\"\\\",\\\"phone\\\":\\\"\\\",\n\\\"street_1\\\":\\\"932 MyStreet Dr\\\",\\\"street_2\\\":\\\"\\\",\\\"zip\\\":\\\"12345\\\",\\\"city\\\":\\\"Mecio\\\",\n\\\"state_iso2\\\":\\\"NX\\\",\\\"country_iso2\\\":\\\"US\\\",\\\"address_type\\\":\\\"residential\\\"},\n\\\"items\\\":\"=&gt;&lt;ActionController::Parameters {\"{\\\"sku\\\":\\\"\\\",\\\"name\\\":\\\"\\\",\n\\\"length\\\":{\\\"units\\\":\\\"in\\\",\\\"value\\\":0},\\\"width\\\":{\\\"units\\\":\\\"in\\\",\\\"value\\\":0},\n\\\"height\\\":{\\\"units\\\":\\\"in\\\",\\\"value\\\":0},\\\"weight\\\":{\\\"units\\\":\\\"oz\\\",\\\"value\\\":10},\n\\\"discounted_price\\\":{\\\"currency\\\":\\\"USD\\\",\\\"amount\\\":\\\"0\\\"},\n\\\"declared_value\\\":{\\\"currency\\\":\\\"USD\\\",\\\"amount\\\":\\\"17.5\\\"},\\\"quantity\\\":1,\n\\\"attributes\\\":\"=&gt;[{\"}\"=&gt;{\",\\\"customer\\\":{\\\"customer_groups\\\":\"=&gt;{\"\\\"\\\"\"=&gt;{\"},\\\"cart_id\\\":\\\"05\\\"},\n\\\"connection_options\\\":{\\\"auth_token\\\":\\\"adfasdf\\\",\\\"seller_id\\\":\\\"asdf\\\",\\\"marketplace\\\":\\\"5\\\"}\n,\\\"zone_options\\\":\"=&gt;[{\",\\\"rate_options\\\":\"=&gt;[{\"}\"=&gt;nil}]}]}}}}]} permitted: false&gt;, \n\"controller\"=&gt;\"welcome\", \"action\"=&gt;\"amazon_creds\"}\n</code></pre>\n\n<p>I'm trying to get the sku, but all I ever get is <code>nil</code> with anything I try. I've tried the following:</p>\n\n<pre><code>params[:sku]\nparams[\"sku\"]\nparams[:base_options][:sku]\nparams.as_json[:base_options]\nparams.as_json[:sku]\nparams.to_h[:sku]\nparams.to_unsafe_h.slice(:base_options)\nparams.to_unsafe_h[:sku]\nparams[0]\n</code></pre>\n\n<p>And yes I've read this <a href=\"http://edgeapi.rubyonrails.org/classes/ActionController/Parameters.html\" rel=\"nofollow noreferrer\">ActionContoller::Parameters</a></p>\n\n<p>Yea I'm at a loss here, no idea how to access these <code>params</code>. Anyone out there put me out of my misery?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 3, "creation_date": 1528837616, "post_id": 50825685, "comment_id": 88656489, "body": "<code>result[:result][:&#39;1&#39;]</code> at index <code>1</code> does not have a key of <code>:&#39;5&#39;</code> otherwise &quot;not working&quot; is not really an explanation. Formatting helps alot and ruby <code>Array</code>s start at index 0. I think you are looking for <code>result[:result].dig(:&#39;1&#39;,0,:&#39;5&#39;,:&#39;1&#39;,:&#39;1&#39;) #=&gt; &#39;1.0.0&#39;</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1528853805, "post_id": 50825685, "comment_id": 88660465, "body": "In future please pare down your examples to their essential structure. Here I would think your hash need have more than a dozen lines. Also, for hashes, keep keys and values short. For example, shorten <code>&quot;AMtNNDFJl06mR54j2zxFjYIYfGQR22sUKA:1528830206790&quot;</code> to, say, &quot;AMn&quot;. Also, it&#39;s helpful to assign a variable to all input objects (here, say, <code>h = {:result=&gt;...}</code>. That way, readers can  refer to the those variables (here <code>h</code>) in comments and answers without having to define them."}], "answers": [{"tags": [], "owner": {"reputation": 160, "user_id": 5858777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sz22L.jpg?s=128&g=1", "display_name": "Isaiah Fasoldt", "link": "https://stackoverflow.com/users/5858777/isaiah-fasoldt"}, "is_accepted": false, "score": 1, "last_activity_date": 1528837957, "creation_date": 1528837957, "answer_id": 50825892, "question_id": 50825685, "link": "https://stackoverflow.com/questions/50825685/how-use-dig-method-several-for-children-object/50825892#50825892", "title": "How use dig method several for children object", "body": "<p>The idea behind dig is that you can go several levels deep into a hash at the same time and return nil if the key doesn't exist at any level during the 'digging'. So <code>result[:'result'][:'1'][1].dig(:'5', :'1', :'1')</code> will do what you are looking for and clean up your code as well. In fact, you could make it a little safer if you wanted by doing <code>result.dig(:result, :'1', 1, :'5', :'1', :'1')</code></p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1528853970, "last_edit_date": 1528853970, "creation_date": 1528848201, "answer_id": 50827422, "question_id": 50825685, "link": "https://stackoverflow.com/questions/50825685/how-use-dig-method-several-for-children-object/50827422#50827422", "title": "How use dig method several for children object", "body": "<p><code>dig</code> is not a single method, but a family of four methods, all of which made their debut in Ruby v2.3: <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-dig\" rel=\"nofollow noreferrer\">Array#dig</a>, <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-dig\" rel=\"nofollow noreferrer\">Hash#dig</a>, <a href=\"http://ruby-doc.org/core-2.4.0/Struct.html#method-i-dig\" rel=\"nofollow noreferrer\">Struct#dig</a> and <a href=\"https://ruby-doc.org/stdlib-2.3.0/libdoc/ostruct/rdoc/OpenStruct.html#method-i-dig\" rel=\"nofollow noreferrer\">OpenStruct#dig</a>. </p>\n\n<p>For example,</p>\n\n<pre><code>h = { a: [1, { c: 2, d: 3 }], b: 2 }\nh.dig(:a, 1, :d)\n  #=&gt; 3\n</code></pre>\n\n<p>employs <code>Hash#dig</code> because <code>dig</code>'s receiver is a hash. Moreover, one might expect that when, in an intermediate calculation, <code>dig</code> has unearthed <code>[1, { c: 2, d: 3 }]</code> it will pass the shovel to <code>Array#dig</code> for further excavation.</p>\n\n<p>Suppose</p>\n\n<pre><code>h = { a: [1, 2] }\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>h.dig(:a, 1)        #=&gt; 2\nh.dig(:a).dig(1)    #=&gt; 2\n</code></pre>\n\n<p>Does that mean the two are equivalent? Try this:</p>\n\n<pre><code>h.dig('cat', 1)     #=&gt; nil\nh.dig('cat').dig(1) #=&gt; NoMethodError: undefined method `dig' for nil:NilClass\n</code></pre>\n\n<p>The exception is due to the fact that <code>h.dig('cat') #=&gt; nil</code> and <a href=\"http://ruby-doc.org/core-2.4.0/NilClass.html\" rel=\"nofollow noreferrer\">NilClass</a> has no instance method <code>dig</code>, so <code>nil.dig(1)</code> raises the exception. No, the two expressions are not equivalent.</p>\n\n<p>If the value of the variable <code>result</code> is the OPs hash, we have (as pointed out by @Isaiah) the following.</p>\n\n<pre><code>result.dig(:result, :'1', 0, :\"5\", :\"1\", :\"1\")\n  #=&gt; \"1.0.0\"\nresult.dig(:result, :'1', 0, :cat, :\"1\", :\"1\")\n  #=&gt; nil\n</code></pre>\n\n<p>Note that <code>dig</code> will still raise an exception if the wrong data type is used:</p>\n\n<pre><code>[1, 2].dig(:a)\n  #=&gt; TypeError: no implicit conversion of Symbol into Integer\n</code></pre>\n\n<p>To support versions of Ruby prior to 2.3 (where <code>dig</code> is not available) we can write the following, using <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\">Enumerable#reduce</a> (aka <code>inject</code>).</p>\n\n<pre><code>arr = [:result, :'1', 0, :\"5\", :\"1\", :\"1\"]\narr.reduce(result) { |memo, obj| memo &amp;&amp; memo[obj] }\n  #=&gt; \"1.0.0\"\n\narr = [:result, :'1', 0, :cat, :\"1\", :\"1\"]\narr.reduce(result) { |memo, obj| memo &amp;&amp; memo[obj] }\n  #=&gt; nil\n</code></pre>\n"}], "owner": {"reputation": 2138, "user_id": 1377879, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/88ed0b98e028557cf987548411d8138c?s=128&d=identicon&r=PG", "display_name": "Bolo", "link": "https://stackoverflow.com/users/1377879/bolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1528853970, "creation_date": 1528836813, "last_edit_date": 1528841374, "question_id": 50825685, "link": "https://stackoverflow.com/questions/50825685/how-use-dig-method-several-for-children-object", "title": "How use dig method several for children object", "body": "<p>I have an hash</p>\n\n<pre><code>{:result=&gt;\n  {:\"1\"=&gt;\n    [{:\"1\"=&gt;1,\n      :\"2\"=&gt;\"4698192612070913717\",\n      :\"5\"=&gt;\n      {:\"1\"=&gt;{:\"1\"=&gt;\"1.0.0\"},\n        :\"2\"=&gt;\n        {:\"1\"=&gt;1,\n          :\"2\"=&gt;\"1525341956127\",\n          :\"3\"=&gt;1000000000,\n          :\"4\"=&gt;0,\n          :\"5\"=&gt;{:\"1\"=&gt;1000000000}},\n        :\"3\"=&gt;[\"17\"],\n        :\"6\"=&gt;\"4704522736971289334\",\n        :\"8\"=&gt;[\"4618851880555471022\"],\n        :\"9\"=&gt;[1]},\n      :\"6\"=&gt;{:\"3\"=&gt;{:\"2\"=&gt;false}, :\"4\"=&gt;{:\"1\"=&gt;false}},\n      :\"7\"=&gt;{:\"1\"=&gt;1},\n      :\"8\"=&gt;\"production\"},\n    {:\"1\"=&gt;4,\n      :\"2\"=&gt;\"4700283765268993541\",\n      :\"6\"=&gt;{:\"2\"=&gt;{:\"1\"=&gt;200}, :\"3\"=&gt;{:\"2\"=&gt;false}, :\"4\"=&gt;{:\"1\"=&gt;false}},\n      :\"8\"=&gt;\"beta\"},\n    {:\"1\"=&gt;5,\n      :\"2\"=&gt;\"4699074054925986704\",\n      :\"6\"=&gt;{:\"2\"=&gt;{:\"1\"=&gt;100}, :\"3\"=&gt;{:\"2\"=&gt;false}, :\"4\"=&gt;{:\"1\"=&gt;false}},\n      :\"8\"=&gt;\"alpha\"},\n    {:\"1\"=&gt;10,\n      :\"2\"=&gt;\"4697702456121346981\",\n      :\"6\"=&gt;{:\"2\"=&gt;{:\"1\"=&gt;50}, :\"3\"=&gt;{:\"2\"=&gt;false}, :\"4\"=&gt;{:\"1\"=&gt;false}},\n      :\"8\"=&gt;\"internal\"}],\n  :\"3\"=&gt;{:\"1\"=&gt;true, :\"2\"=&gt;{:\"1\"=&gt;{:\"1\"=&gt;false}, :\"2\"=&gt;{:\"1\"=&gt;false}}},\n  :\"4\"=&gt;false},\n:xsrf=&gt;\"AMtNNDFJl06mR54j2zxFjYIYfGQR22sUKA:1528830206790\"}\n</code></pre>\n\n<p>I am looking for simple way to return a value or nil</p>\n\n<p>I have tried this</p>\n\n<pre><code>result[:'result'][:'1'][1].dig(:'5').dig(:'1').dig(:'1')\n</code></pre>\n\n<p>but it's not working</p>\n\n<p>What can I do to avoid this</p>\n\n<pre><code>if result[:'result'][:'1'][1].dig(:'5')\nputs result[:'result'][:'1'][1][:'5'][:'1'][:'1']\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "brakeman"], "answers": [{"tags": [], "owner": {"reputation": 408, "user_id": 370845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mbYfz.jpg?s=128&g=1", "display_name": "Will Mavis", "link": "https://stackoverflow.com/users/370845/will-mavis"}, "is_accepted": false, "score": 2, "last_activity_date": 1529096874, "creation_date": 1529096874, "answer_id": 50882675, "question_id": 50824395, "link": "https://stackoverflow.com/questions/50824395/brakeman-not-skipping-gemfile-lock-with-skip-files-param/50882675#50882675", "title": "Brakeman not skipping Gemfile.lock with --skip-files param", "body": "<p>I believe this is the check to which you are referring:\n<a href=\"https://github.com/presidentbeef/brakeman/blob/master/lib/brakeman/scanner.rb#L39-L40\" rel=\"nofollow noreferrer\">https://github.com/presidentbeef/brakeman/blob/master/lib/brakeman/scanner.rb#L39-L40</a></p>\n\n<pre><code>Brakeman.notify \"Processing gems...\"\nprocess_gems\n</code></pre>\n\n<p>The process_gems function is defined here:\n<a href=\"https://github.com/presidentbeef/brakeman/blob/master/lib/brakeman/scanner.rb#L131-L152\" rel=\"nofollow noreferrer\">https://github.com/presidentbeef/brakeman/blob/master/lib/brakeman/scanner.rb#L131-L152</a></p>\n\n<pre><code>  #Process Gemfile\n  def process_gems\n    gem_files = {}\n    if @app_tree.exists? \"Gemfile\"\n      gem_files[:gemfile] = { :src =&gt; parse_ruby(@app_tree.read(\"Gemfile\")), :file =&gt; \"Gemfile\" }\n    elsif @app_tree.exists? \"gems.rb\"\n      gem_files[:gemfile] = { :src =&gt; parse_ruby(@app_tree.read(\"gems.rb\")), :file =&gt; \"gems.rb\" }\n    end\n\n    if @app_tree.exists? \"Gemfile.lock\"\n      gem_files[:gemlock] = { :src =&gt; @app_tree.read(\"Gemfile.lock\"), :file =&gt; \"Gemfile.lock\" }\n    elsif @app_tree.exists? \"gems.locked\"\n      gem_files[:gemlock] = { :src =&gt; @app_tree.read(\"gems.locked\"), :file =&gt; \"gems.locked\" }\n    end\n\n    if gem_files[:gemfile] or gem_files[:gemlock]\n      @processor.process_gems gem_files\n    end\n  rescue =&gt; e\n    Brakeman.notify \"[Notice] Error while processing Gemfile.\"\n    tracker.error e.exception(e.message + \"\\nWhile processing Gemfile\"), e.backtrace\n  end\n</code></pre>\n\n<p>The AppTree::exists? function is defined here:\n<a href=\"https://github.com/presidentbeef/brakeman/blob/master/lib/brakeman/app_tree.rb#L82-L84\" rel=\"nofollow noreferrer\">https://github.com/presidentbeef/brakeman/blob/master/lib/brakeman/app_tree.rb#L82-L84</a></p>\n\n<pre><code>def exists?(path)\n  File.exist?(File.join(@root, path))\nend\n</code></pre>\n\n<p>The GemProcessor::process_gems function is defined here: \n<a href=\"https://github.com/presidentbeef/brakeman/blob/master/lib/brakeman/processors/gem_processor.rb#L11\" rel=\"nofollow noreferrer\">https://github.com/presidentbeef/brakeman/blob/master/lib/brakeman/processors/gem_processor.rb#L11</a></p>\n\n<pre><code>...lots of code...\n</code></pre>\n\n<p>I don't see any code that would skip this functionality if a certain switch is provided to brakeman.  It also looks like the AppTree::exists? function does not take into account if a file was provided to the --skip-files option.</p>\n\n<p>Unfortunately, I believe the current answer is that you can not ignore the gem files completely.</p>\n\n<p>You could create a PR to do what you want and see if the Brakeman team includes it in the next build:\n<a href=\"https://brakemanscanner.org/docs/contributing/\" rel=\"nofollow noreferrer\">https://brakemanscanner.org/docs/contributing/</a></p>\n\n<p>Let us know if you discover a way to solve your problem.</p>\n"}], "owner": {"reputation": 1317, "user_id": 2013212, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ad34e90fc30380965ee659d6a825b8c?s=128&d=identicon&r=PG", "display_name": "Jonathon Nordquist", "link": "https://stackoverflow.com/users/2013212/jonathon-nordquist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1529096874, "creation_date": 1528831360, "question_id": 50824395, "link": "https://stackoverflow.com/questions/50824395/brakeman-not-skipping-gemfile-lock-with-skip-files-param", "title": "Brakeman not skipping Gemfile.lock with --skip-files param", "body": "<p>I'm adding Brakeman to a Rails product but I'm running into an issue.  I want it to ignore my Gemfile and Gemfile.lock but when I run it with a command like </p>\n\n<pre><code>brakeman --skip-files Gemfile.lock,Gemfile\n</code></pre>\n\n<p>it's still touching the files.  We use other systems to monitor our gems, but is it not possible to ignore the gem files completely?  I can use a brakeman.ignore file of course but would prefer not to.  Thanks for any assistance.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 3, "creation_date": 1528831120, "post_id": 50823925, "comment_id": 88653680, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4333645/use-2-versions-of-gem-at-same-time\">Use 2 versions of gem at same time</a>"}], "answers": [{"tags": [], "owner": {"reputation": 160, "user_id": 5858777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sz22L.jpg?s=128&g=1", "display_name": "Isaiah Fasoldt", "link": "https://stackoverflow.com/users/5858777/isaiah-fasoldt"}, "is_accepted": true, "score": 2, "last_activity_date": 1528830078, "creation_date": 1528830078, "answer_id": 50824107, "question_id": 50823925, "link": "https://stackoverflow.com/questions/50823925/ruby-can-i-import-a-gem-under-an-alias-to-avoid-dependency-issues/50824107#50824107", "title": "Ruby - Can I import a gem under an alias to avoid dependency issues?", "body": "<p>Likely not really possible without some dirty code since importing two versions of the same gem would mean that in practice you would be using two versions of the same class (JWT in this case). A better approach would be to ask the makers of <code>some_other_lib</code> to update their dependencies or, if it's no longer being maintained, fork and update yourself and then put out the updated version for the benefit of the community.</p>\n\n<p>Edit: For more info on the conflicting classes, see <a href=\"https://stackoverflow.com/questions/4333645/use-2-versions-of-gem-at-same-time?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">Use 2 versions of gem at same time</a></p>\n"}], "owner": {"reputation": 53591, "user_id": 26510, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/25ee9a1b9f5a16feb1432882a9ef2f06?s=128&d=identicon&r=PG", "display_name": "Brad Parks", "link": "https://stackoverflow.com/users/26510/brad-parks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 50824107, "answer_count": 1, "score": 0, "last_activity_date": 1528830078, "creation_date": 1528829376, "question_id": 50823925, "link": "https://stackoverflow.com/questions/50823925/ruby-can-i-import-a-gem-under-an-alias-to-avoid-dependency-issues", "title": "Ruby - Can I import a gem under an alias to avoid dependency issues?", "body": "<p>I'm new to Ruby, and am working on a project that has a <code>Gemfile</code> like so:</p>\n\n<h3>Gemfile</h3>\n\n<pre><code>require_relative 'gem_source_url'\ngem_source_url = GemSourceUrl.get_source_url\n\nsource gem_source_url do\n  gem 'jwt'\n  gem 'some_other_lib'\nend\n</code></pre>\n\n<p>My problem is that the gem <code>some_other_lib</code>, includes a version of <code>jwt</code> that is too old (1.5.6), and I can't use, but I can't change anything to do with that gem.</p>\n\n<p>Can I somehow import a newer version of <code>jwt</code> gem under an alias (2.1.0), so I can use the newer version?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "leaflet", "maps"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1528829947, "post_id": 50823728, "comment_id": 88653134, "body": "you should show your attempt that&#39;s failing and the errors you see"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1528830474, "post_id": 50823728, "comment_id": 88653373, "body": "<code>markers: Store.all.map { |store| {latlng: [store.latitude,store.longitude], popup: store.name}</code>. <code>Store.all</code> is an <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Relation.html\" rel=\"nofollow noreferrer\"><code>ActiveRecord::Relation</code></a> and <a href=\"https://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\"><code>map</code></a> is an <code>Enumerable</code> method for iterating an object and creating a new <code>Array</code> from the responses."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1528831998, "post_id": 50824369, "comment_id": 88654049, "body": "Awesome, it works now :) Thanks a bunch for your help."}], "tags": [], "owner": {"reputation": 160, "user_id": 5858777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sz22L.jpg?s=128&g=1", "display_name": "Isaiah Fasoldt", "link": "https://stackoverflow.com/users/5858777/isaiah-fasoldt"}, "is_accepted": false, "score": 3, "last_activity_date": 1528831581, "last_edit_date": 1528831581, "creation_date": 1528831254, "answer_id": 50824369, "question_id": 50823728, "link": "https://stackoverflow.com/questions/50823728/how-do-i-iterate-over-this-ruby-code-so-that-i-can-dynamically-show-markers-on-a/50824369#50824369", "title": "How do I iterate over this Ruby code so that I can dynamically show markers on a map?", "body": "<p><code>markers: Store.all.map { |store| {latlng: [store.latitude,store.longitude], popup: store.name}.</code> is your failing code. </p>\n\n<p>I think your idea is correct, but your missing a closing <code>}</code> for the map block. Try: </p>\n\n<p><code>markers: Store.all.map { |store| { latlng: [store.latitude, store.longitude], popup: store.name } }</code></p>\n\n<p>As for the data structure, it looks like the map method expects a hash (object) where the marker key that should hold an array of marker hashes (objects) which each have an attribute of latlng and popup. The latlng attribute needs to hold an array of the latitude and longitude values, and the popup attribute should hold a string of the data needed to put in the popup.</p>\n"}], "owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531945501, "creation_date": 1528828684, "question_id": 50823728, "link": "https://stackoverflow.com/questions/50823728/how-do-i-iterate-over-this-ruby-code-so-that-i-can-dynamically-show-markers-on-a", "title": "How do I iterate over this Ruby code so that I can dynamically show markers on a map?", "body": "<p>I am building a store locator app and I'm trying to populate a map with markers that represent the stores in my database. I have used the Geocoder gem to convert addresses into latitude and longitude and I am using Leaflet.js and the leaflet-rails gem (basically following this tutorial: <a href=\"https://github.com/axyjo/leaflet-rails\" rel=\"nofollow noreferrer\">https://github.com/axyjo/leaflet-rails</a>). I've been able to get the map to show with markers with the following code:</p>\n\n<pre><code>&lt;% @stores.each do |store| %&gt;\n    &lt;h2&gt;&lt;%= link_to store.name, store_path(store) + ': ' + store.address %&gt;&lt;/h2&gt;\n&lt;% end %&gt;\n\n&lt;%= link_to \"Add Spaeti\", new_store_path %&gt;\n\n&lt;%= map(:center =&gt; {\n    :latlng =&gt; [52.52004797921441, 12.4050235665359283],\n    :zoom =&gt; 3\n  },\n\n  :markers =&gt; [\n    {  \n       :latlng =&gt; [ Store.last.latitude, Store.last.longitude ],\n       :popup =&gt; Store.last.name\n    }\n  ]\n) %&gt;\n</code></pre>\n\n<p>The problem I'm having is getting markers to appear dynamically from the data in my database. I'm relatively new to Ruby and to Rails, so it's proving quite tough. Should I iterate over the lat and lng values with the each method? I've tried doing that, but getting a lot of syntax errors. I'm not even sure what form the last part of the code is in. Is it a nested hash?   </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 444, "user_id": 461835, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XGjbJ.png?s=128&g=1", "display_name": "TomG", "link": "https://stackoverflow.com/users/461835/tomg"}, "edited": false, "score": 0, "creation_date": 1528830004, "post_id": 50823459, "comment_id": 88653163, "body": "@engineersmnky, sorry, my question was lacking. Hopefully the update makes it clearer? Not sure how to do <code>Team.order(@team.&lt;userselect&gt;,@team.&lt;userselect&gt;)</code> and not at all sure that I should be!"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528830007, "post_id": 50823459, "comment_id": 88653164, "body": "Ahhhh now I understand. Can you please post some code as to what these metrics are and how you are submitting the user input (<code>params</code>) it will make it easier to help"}, {"owner": {"reputation": 444, "user_id": 461835, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XGjbJ.png?s=128&g=1", "display_name": "TomG", "link": "https://stackoverflow.com/users/461835/tomg"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528830510, "post_id": 50823459, "comment_id": 88653389, "body": "I&#39;ll post some code for the metrics but I haven&#39;t written the rest as I haven&#39;t worked out an approach."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528830597, "post_id": 50824204, "comment_id": 88653425, "body": "Per the question: metrics are not database values but instead are calculated on a per instance basis"}, {"owner": {"reputation": 444, "user_id": 461835, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XGjbJ.png?s=128&g=1", "display_name": "TomG", "link": "https://stackoverflow.com/users/461835/tomg"}, "edited": false, "score": 0, "creation_date": 1528830690, "post_id": 50824204, "comment_id": 88653466, "body": "Yes, I originally missed that potentially crucial point out! sorry"}], "tags": [], "owner": {"reputation": 135, "user_id": 6876334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8341424e7a8cd10fcc639ecce2468359?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Galloway", "link": "https://stackoverflow.com/users/6876334/matthew-galloway"}, "is_accepted": false, "score": 0, "last_activity_date": 1528830527, "creation_date": 1528830527, "answer_id": 50824204, "question_id": 50823459, "link": "https://stackoverflow.com/questions/50823459/ruby-on-rails-user-input-for-sort-ordering/50824204#50824204", "title": "Ruby on Rails - User input for sort ordering", "body": "<p>ActiveRecord allows multiple arguments to be passed to the order method. So you could do something like:</p>\n\n<p><code>Team.order(:metric2, :metric3, metric1: :desc)</code></p>\n\n<p>Another options is you can also use ActiveRecord to dynamically construct a query. ActiveRecord queries are lazily evaluated, so the SQL won't be executed until you call an operation that requires loading the records.</p>\n\n<p>For example you could construct a scope on Team like this:</p>\n\n<pre><code>class Team &lt; ApplicationRecord\n\n  scope :custom_order, lambda { |sorting_order|\n    sorting_order.each do |metric|\n      order(metric)\n    end\n  }\nend\n</code></pre>\n\n<p>You would then just need to input a collection of attributes in the order you wanted the order by clauses to be executed. For example:</p>\n\n<p><code>Team.custom_order([:metric2, :metric3, :metric1])</code></p>\n"}, {"tags": [], "owner": {"reputation": 444, "user_id": 461835, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XGjbJ.png?s=128&g=1", "display_name": "TomG", "link": "https://stackoverflow.com/users/461835/tomg"}, "is_accepted": true, "score": 0, "last_activity_date": 1531086839, "creation_date": 1531086839, "answer_id": 51236265, "question_id": 50823459, "link": "https://stackoverflow.com/questions/50823459/ruby-on-rails-user-input-for-sort-ordering/51236265#51236265", "title": "Ruby on Rails - User input for sort ordering", "body": "<p>A working but probably awful solution:</p>\n\n<pre><code>class Tournament &lt; ApplicationRecord\n\n  has_many :teams\n\n  serialize :tiebreaker, Array\n\n  TIEBREAKER_WHITELIST = %w[score opponent_score possession].freeze\n\n  def sorted_teams\n    list = teams.shuffle\n    (TIEBREAKER_WHITELIST &amp; tiebreaker).reverse.each do |metric|\n      list = list.sort_by { |team| [team.send(metric), list.find_index(team)] }\n    end\n    list.reverse\n  end\nend\n</code></pre>\n\n<p>Each <code>tournament</code> has many <code>teams</code>. A <code>tournament</code> instance has a serialized field called <code>tiebreaker</code>. This contains an array of strings something like <code>[\"score\", \"possession\"]</code> where each string matches the name of a public instance method on <code>team</code>. Each of these methods returns a number.</p>\n\n<p>The <code>tiebreaker</code> field is in descending order of precedence, so for the above example I would only expect <code>possession</code> to affect sorting for teams with an equal <code>score</code>.</p>\n\n<p><strong><code>list = teams.shuffle</code></strong> - this randomises the list to start with, in case teams are tied for all of the following tiebreakers.</p>\n\n<p><strong><code>(TIEBREAKER_WHITELIST &amp; tiebreaker)</code></strong> - this returns only strings that appear in both the <code>tiebreaker</code> field and the whitelist constant to protect against end users running arbitrary methods.</p>\n\n<p><strong><code>.reverse.each do |metric|</code></strong> - this reverses the array of metrics so that the list is sorted by the lowest precedence metric first.</p>\n\n<p><strong><code>[team.send(metric), list.find_index(team)]</code></strong> - this is the sort for each metric. <code>send</code> turns the string into a method call. I found <code>find_index</code>was necessary to preserver sort order from previous sorts. i.e. if I had first sorted for <code>possession</code> this would preserve the order for teams with the same <code>score</code>.</p>\n\n<p><strong><code>list.reverse</code></strong> - reverse the list then return it. This was because I wanted higher scoring/possession teams first on my list and <code>sort_by</code> sorts ascending.</p>\n\n<p>I wanted some metrics sorted ascending (<code>opponent_score</code>) and others descending (<code>score</code>) so I handled this in the respective methods, returning negative values for <code>opponent_score</code> for example.</p>\n\n<p>I'm not entirely happy with the solution as is but it does seem to work!</p>\n"}], "owner": {"reputation": 444, "user_id": 461835, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XGjbJ.png?s=128&g=1", "display_name": "TomG", "link": "https://stackoverflow.com/users/461835/tomg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 51236265, "answer_count": 2, "score": 0, "last_activity_date": 1531086839, "creation_date": 1528827631, "last_edit_date": 1528831253, "question_id": 50823459, "link": "https://stackoverflow.com/questions/50823459/ruby-on-rails-user-input-for-sort-ordering", "title": "Ruby on Rails - User input for sort ordering", "body": "<p>In order to learn Ruby on Rails I am writing a web app that will be used to sort teams within a tournament given their performance to date.</p>\n\n<p>The complication is that I want each tournament organiser (system user) to be able to use a variety of metrics in an arbitrary order. </p>\n\n<p>Expressed as SQL (my background) I want User 1 to be able to choose:</p>\n\n<pre><code>ORDER BY\n   METRIC1\n  ,METRIC2\n  ,METRIC3\n</code></pre>\n\n<p>Whilst User 2 could choose:</p>\n\n<pre><code>ORDER BY\n   METRIC2\n  ,METRIC3\n  ,METRIC1\n</code></pre>\n\n<hr>\n\n<p><strong>How would I accept this user input and use it to create a query on the Team table?</strong></p>\n\n<hr>\n\n<p><strong>Edit 1</strong> Neglected to mention (sorry) that the metrics themselves are calculated on the fly. Currently they are instance methods (e.g <code>@team.metric1</code> etc). The abortive attempts I have made so far all involve trying to convert user strings to method names which just seems wrong (and I haven't been able to get it to work).</p>\n\n<p><strong>Edit 2</strong> some example code in teams_controller.rb:</p>\n\n<pre><code>class Team &lt; ApplicationRecord\n  belongs_to :tournament\n  has_many :matches\n\n  def score_for\n    matches.sum(:score_for)\n  end\n  def score_diff\n    matches.sum(:score_for) - matches.sum(:score_against)\n  end\nend\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "csv", "sorting", "each"], "answers": [{"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1528831294, "post_id": 50823013, "comment_id": 88653772, "body": "What does <code>join($&#47;)</code> do here? Not seen that usage before."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1528832934, "post_id": 50823013, "comment_id": 88654450, "body": "@SRack it\u2019s platform-dependent line delimiter (<code>&quot;\\n&quot;</code> on unix and <code>&quot;\\r\\n&quot;</code> on Windows.)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1528825825, "creation_date": 1528825825, "answer_id": 50823013, "question_id": 50822807, "link": "https://stackoverflow.com/questions/50822807/passing-elements-from-one-array-to-another-generating-csv/50823013#50823013", "title": "Passing elements from one array to another, generating CSV", "body": "<p>You even don\u2019t need a CSV tool here:</p>\n\n<pre><code>result =\n  student_array.\n     map { |a| a[2] }.            # get nationalities\n     group_by { |e| e }.          # hash\n     map { |n, c| [n, c.count] }. # map values to count\n     transpose.                   # put data in rows\n     map { |row| row.join ',' }.  # join values in a row\n     join($/)                     # join rows\n#\u21d2\u00a0American,Canadian\n#  3,1\n</code></pre>\n\n<p>Now you have a string that is valid CSV, just spit it out to the file.</p>\n"}, {"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 3, "last_activity_date": 1528826537, "last_edit_date": 1528826537, "creation_date": 1528826130, "answer_id": 50823091, "question_id": 50822807, "link": "https://stackoverflow.com/questions/50822807/passing-elements-from-one-array-to-another-generating-csv/50823091#50823091", "title": "Passing elements from one array to another, generating CSV", "body": "<p><a href=\"https://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Array#group_by</a> in Ruby core and <a href=\"https://apidock.com/rails/Hash/transform_values\" rel=\"nofollow noreferrer\">Hash#transform_values</a> in ActiveSupport are two very versitile methods that can be used here:</p>\n\n<pre><code>require 'active_support/all'\nrequire 'csv'\n\nstudent_array = [\n  [\"Mike\", 13, \"American\", \"male\"], \n  [\"Grace\", 12, \"Canadian\", \"female\"],\n  [\"Joey\", 13, \"American\", \"male\"],\n  [\"Lily\", 13, \"American\", \"female\"]\n]\n\ncounts = student_array.group_by { |attrs| attrs[2] }.transform_values(&amp;:length)\n# =&gt; =&gt; {\"American\"=&gt;3, \"Canadian\"=&gt;1}\n\nCSV.open(\"output/redemptions.csv\", \"wb\") do |csv|\n    csv &lt;&lt; counts.keys\n    csv &lt;&lt; counts.values\nend\n\nputs File.read \"output/redemptions.csv\"\n# =&gt; American,Canadian\n#    3,1\n</code></pre>\n\n<p><code>.group_by { |attrs| attrs[2] }</code> turns the array into a hash, where keys are the unique values for <code>attrs[2]</code>, and values are a list of elements that have that <code>attrs[2]</code>. At this point you can use <code>transform_values</code> to turn those values into numbers representing their length (meaning, how many elements have that specific <code>attrs[2]</code>). The keys and values can then be extracted from the hash as separate arrays.</p>\n"}, {"tags": [], "owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "is_accepted": false, "score": 3, "last_activity_date": 1528826174, "creation_date": 1528826174, "answer_id": 50823107, "question_id": 50822807, "link": "https://stackoverflow.com/questions/50822807/passing-elements-from-one-array-to-another-generating-csv/50823107#50823107", "title": "Passing elements from one array to another, generating CSV", "body": "<p>You could use a <code>Hash</code> to group the counts by nationality instead of different arrays.</p>\n\n<pre><code>nationalities_count = student_array.each_with_object(Hash.new(0)) do |student, hash| \n  nationality = student[2]\n  hash[nationality] += 1\nend\n</code></pre>\n\n<p>That will give you a Hash that would look like </p>\n\n<pre><code>{ \"American\" =&gt; 2, \"Canadian\" =&gt; 1 }\n</code></pre>\n\n<p>You could then use <code>Hash#to_a</code> and <code>Array#transpose</code> like so:</p>\n\n<pre><code>hsh = { \"American\" =&gt; 2, \"Canadian\" =&gt; 1 }\n =&gt; {\"American\"=&gt;2, \"Canadian\"=&gt;1}\n2.4.2 :002 &gt; hsh.to_a\n =&gt; [[\"American\", 2], [\"Canadian\", 1]]\n2.4.2 :003 &gt; hsh.to_a.transpose\n =&gt; [[\"American\", \"Canadian\"], [2, 1]]\n</code></pre>\n\n<p>Finally, to output the CSV file all you need to do is write the arrays into the file</p>\n\n<pre><code>nationalities_with_count = hash.to_a.transpose\nCSV.open(\"output/redemptions.csv\", \"wb\") do |csv|\n  csv &lt;&lt; nationalities_with_count[0]\n  csv &lt;&lt; nationalities_with_count[1]\nend\n</code></pre>\n"}], "owner": {"reputation": 1512, "user_id": 5513336, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/bc7pn.jpg?s=128&g=1", "display_name": "Leia_Organa", "link": "https://stackoverflow.com/users/5513336/leia-organa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1528839322, "creation_date": 1528825002, "question_id": 50822807, "link": "https://stackoverflow.com/questions/50822807/passing-elements-from-one-array-to-another-generating-csv", "title": "Passing elements from one array to another, generating CSV", "body": "<p>I'm trying to write a program in Ruby that allows one array to receive information from another array. Basically, I have a multidimensional array called \"student_array\" that contains information on a few students</p>\n\n<pre><code>student_array = [[\"Mike\", 13, \"American\", \"male\"], \n[\"Grace\", 12, \"Canadian\", \"female\"],\n[\"Joey\", 13, \"American\", \"male\"],\n[\"Lily\", 13, \"American\", \"female\"]\n]\n</code></pre>\n\n<p>I also initialized two other arrays that will count nationalities: </p>\n\n<pre><code>nationality_array = Array.new\nnationality_count = Array.new\n</code></pre>\n\n<p>The purpose of this program is to loop through student array, count the different nationalities of the students, and create a CSV file that will contain the headers of the different nationalities, and a count for each one.</p>\n\n<p>Expected output.csv</p>\n\n<pre><code>American, Canadian\n3, 1\n</code></pre>\n\n<p>Here is the code I have so far</p>\n\n<pre><code>student_array.each do |student|\n    #pushes the nationality string into the nationality array\n    nationality_array.push(student[2])   \nend\n</code></pre>\n\n<p>so the nationality_array should currently look like this:</p>\n\n<pre><code>nationality_array = [\"American\", \"Canadian\", \"American\", \"American\"];\nnationality_array.uniq = [\"American\", \"Canadian\"];\n</code></pre>\n\n<p>So I will have two headers - \"American\" and \"Canadian\"</p>\n\n<p>Now I need a way to loop through the student_array, count up each instance of \"American\" and \"Canadian\", and somehow assign it back to the nationality array. I'm having a hard time visualizing how to go about this. This is what I have so far--</p>\n\n<pre><code>american_count = 0;\ncanadian_count = 0;\n\nstudent_array.each do |student|\n    if student[2] = \"American\"\n        american_count++\n    elsif student[2] = \"Canadian\"\n        canadian_count++\n    end\nend\n\nnationality_count.push(american_count);\nnationality_count.push(canadian_count);\n</code></pre>\n\n<p>Okay, now I have those counts in the nationality_count array, but how can I pass it to a CSV, making sure that they are assigned to the right headers? I have a feeling that my code is very awkward and could be much more streamlined as well.</p>\n\n<p>It would probably look something like this?</p>\n\n<pre><code>CSV.open(\"output/redemptions.csv\", \"wb\") do |csv|\n    csv &lt;&lt; [nationality_array]\n    csv &lt;&lt; [nationality_count]\nend\n</code></pre>\n\n<p>Can anyone provide any insight into a cleaner way to go about this?</p>\n"}, {"tags": ["ruby", "rubygems", "gemfile", "gemspecs"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1528824866, "post_id": 50822620, "comment_id": 88650515, "body": "Is there a good reason why you&#39;re using such an old version of ruby? <code>v2.5.1</code> is the current latest. Support for <code>v1.9.x</code> was dropped years ago."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528827277, "post_id": 50822620, "comment_id": 88651769, "body": "what files are you trying to add in your <code>gemspec</code>? Chaces are your error is here <a href=\"https://github.com/ruby/ruby/blob/v1_9_3_551/lib/rubygems/builder.rb#L90\" rel=\"nofollow noreferrer\">github.com/ruby/ruby/blob/v1_9_3_551/lib/rubygems/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 7276748, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zGLXB2IsIeQ/AAAAAAAAAAI/AAAAAAAAABk/jf--8Oqd21s/photo.jpg?sz=128", "display_name": "Pedro Mour&#227;o", "link": "https://stackoverflow.com/users/7276748/pedro-mour%c3%a3o"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1528829266, "post_id": 50822620, "comment_id": 88652808, "body": "@TomLord thank you for your support, but I need to use this version in my project..."}, {"owner": {"reputation": 13, "user_id": 7276748, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zGLXB2IsIeQ/AAAAAAAAAAI/AAAAAAAAABk/jf--8Oqd21s/photo.jpg?sz=128", "display_name": "Pedro Mour&#227;o", "link": "https://stackoverflow.com/users/7276748/pedro-mour%c3%a3o"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528841034, "post_id": 50822620, "comment_id": 88657651, "body": "@engineersmnky I just want to create a new gem..."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528841073, "post_id": 50822620, "comment_id": 88657666, "body": "Right so please post your gemspec"}, {"owner": {"reputation": 13, "user_id": 7276748, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zGLXB2IsIeQ/AAAAAAAAAAI/AAAAAAAAABk/jf--8Oqd21s/photo.jpg?sz=128", "display_name": "Pedro Mour&#227;o", "link": "https://stackoverflow.com/users/7276748/pedro-mour%c3%a3o"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528877014, "post_id": 50822620, "comment_id": 88668207, "body": "@engineersmnky                                                                                    # -<i>- encoding: utf-8 -</i>- Gem::Specification.new do |s|   s.name        = &#39;XXX&#39;   s.version     = &#39;X.X.X&#39;   s.authors     = &#39;XXX   s.description = &#39;XXX&#39;   s.summary     = &#39;XXX&#39;   s.email       = &#39;&#39;   s.homepage    = &#39;&#39;    s.platform    = Gem::Platform::RUBY    s.files = Dir[&#39;<i>&#39;,&#39;*/*</i>&#39;,&#39;<i>/**/*</i>&#39;] end"}], "owner": {"reputation": 13, "user_id": 7276748, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zGLXB2IsIeQ/AAAAAAAAAAI/AAAAAAAAABk/jf--8Oqd21s/photo.jpg?sz=128", "display_name": "Pedro Mour&#227;o", "link": "https://stackoverflow.com/users/7276748/pedro-mour%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528827096, "creation_date": 1528824288, "last_edit_date": 1528827096, "question_id": 50822620, "link": "https://stackoverflow.com/questions/50822620/fileoverflow-when-i-create-a-new-gemfile-in-ruby", "title": "FileOverflow when I create a new gemfile in ruby", "body": "<pre><code>C:\\Ruby193\\lib\\ruby\\gems\\1.9.1\\gems\\myproject&gt; bundle package\n...\n...\n...\nUpdating files in vendor/cache\nYour bundle is complete!\nUse `bundle show [gemname]` to see where a bundled gem is installed.\nUpdating files in vendor/cache\n\nC:\\Ruby193\\lib\\ruby\\gems\\1.9.1\\gems\\myproject&gt; gem build myproject.gemspec\n</code></pre>\n\n<blockquote>\n  <p>WARNING:  licenses is empty<br>\n  WARNING:  no email specified<br>\n  WARNING:  no homepage specified<br>\n  WARNING:  description and summary are identical<br>\n  <strong>ERROR:  While executing gem ... (Gem::Package::TarWriter::FileOverflow)\n      You tried to feed more data than fits in the file.</strong></p>\n</blockquote>\n\n<p>Someone can help me please?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "bundle"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1528831070, "post_id": 50822256, "comment_id": 88653651, "body": "I fail to see how moving <code>mongoid</code> has anything to do with <code>kaminari</code> page rendering? I think your real issue is that you are missing <code>kaminari-core</code> some how"}], "answers": [{"tags": [], "owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "is_accepted": false, "score": 0, "last_activity_date": 1528879518, "creation_date": 1528879518, "answer_id": 50832829, "question_id": 50822256, "link": "https://stackoverflow.com/questions/50822256/what-order-for-rails-require-gems/50832829#50832829", "title": "what order for rails require gems?", "body": "<p>You can use empty lines and/or comments to group the gems, and RuboCop won't bug you about it:</p>\n\n<pre><code>gem 'mongoid', '~&gt; 5.1.5'\n\n# Needs to come after mongoid\ngem 'kaminari-mongoid', '~&gt; 1.0.1'\n\n# Needs to come after kaminari-mongoid\ngem 'kaminari-actionview', '~&gt; 1.0.1'\n</code></pre>\n"}], "owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528879518, "creation_date": 1528822920, "last_edit_date": 1528870229, "question_id": 50822256, "link": "https://stackoverflow.com/questions/50822256/what-order-for-rails-require-gems", "title": "what order for rails require gems?", "body": "<p>For my project, I use <code>Rubocop</code> to check the code style, the <code>Rubocop</code> require gems should be alphabetically sorted within groups. But when I changed the order, the CI failed, the error as below:</p>\n\n<blockquote>\n  <p>bundle exec rake assets:precompile rake aborted! NameError:\n  uninitialized constant Kaminari::Helpers::Paginator</p>\n</blockquote>\n\n<p>I have to put the <code>kaminari-mongoid</code> and <code>kaminari-actionview</code> after <code>mongoid</code>, then the CI will pass:</p>\n\n<pre><code>gem 'mongoid', '~&gt; 5.1.5'\ngem 'kaminari-mongoid', '~&gt; 1.0.1'  # rubocop:disable Bundler/OrderedGems\ngem 'kaminari-actionview', '~&gt; 1.0.1' # rubocop:disable Bundler/OrderedGems\n</code></pre>\n\n<p>Rails how to decide the required order? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "recursion", "hash", "yaml"], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 5804032, "user_type": "registered", "profile_image": "https://graph.facebook.com/1086758154668612/picture?type=large", "display_name": "Junsuk Park", "link": "https://stackoverflow.com/users/5804032/junsuk-park"}, "is_accepted": true, "score": 0, "last_activity_date": 1528824279, "creation_date": 1528824279, "answer_id": 50822616, "question_id": 50822110, "link": "https://stackoverflow.com/questions/50822110/cant-push-in-array-in-recursive-function-in-ruby-ror/50822616#50822616", "title": "Can&#39;t push in array in recursive function in Ruby / RoR", "body": "<p>I think you need to use <code>clone</code> method to make new array because refer to same array object (<code>key &lt;&lt; k</code>)</p>\n\n<p><br><br></p>\n\n<p>Correct: </p>\n\n<pre><code>def ihash(h, key = [], result = [])\n  h.each_pair do |k,v|\n    if v.is_a?(Hash)\n      new_key = key.clone\n      new_key &lt;&lt; k\n      ihash(v, new_key, result)\n    else\n      result &lt;&lt; {full_key: key, key: k, value: v}\n    end\n  end\n  result\nend\n</code></pre>\n\n<p><br>\nHappy coding!</p>\n"}], "owner": {"reputation": 37, "user_id": 8270643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKWw.png?s=128&g=1", "display_name": "Matthieu Mu", "link": "https://stackoverflow.com/users/8270643/matthieu-mu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1528824899, "accepted_answer_id": 50822616, "answer_count": 1, "score": -2, "last_activity_date": 1528824623, "creation_date": 1528822308, "last_edit_date": 1528824623, "question_id": 50822110, "link": "https://stackoverflow.com/questions/50822110/cant-push-in-array-in-recursive-function-in-ruby-ror", "closed_reason": "Duplicate", "title": "Can&#39;t push in array in recursive function in Ruby / RoR", "body": "<p>I want to manipulate the following locales .yml file in Ruby On Rails:</p>\n\n<p><code>fr:\n  back: Retour\n  signup: Inscription\n  helpers:\n    submit:\n      create: \"Cr\u00e9er votre %{model}\"\n  hello: \n    world: \"Bonjour le monde\"\n</code></p>\n\n<p>So I parse it in my controller like :</p>\n\n<p><code>@yml_hash = YAML.load_file(\"config/locales/en.yml\")\n</code></p>\n\n<p>Then I process it with the following helper in my html.erb file :</p>\n\n<pre><code>module TranslationHelper\n\n    def render_hash(hash)\n        return ihash(hash)\n    end\n\n    def ihash(h, key = [], result = [])\n        h.each_pair do |k,v|\n            if v.is_a?(Hash)\n                key &lt;&lt; k\n                ihash(v, key, result)\n            else\n                result &lt;&lt; {full_key: key, key: k, value: v}\n            end\n        end\n        result\n    end\n\nend\n</code></pre>\n\n<p>And it's return the output: </p>\n\n<pre><code>[{:full_key=&gt;[\"fr\", \"helpers\", \"submit\", \"hello\"], :key=&gt;\"back\",\n  :value=&gt;\"Retour\"},\n {:full_key=&gt;[\"fr\", \"helpers\", \"submit\", \"hello\"], :key=&gt;\"signup\",\n  :value=&gt;\"Inscription\"},\n {:full_key=&gt;[\"fr\", \"helpers\", \"submit\", \"hello\"], :key=&gt;\"create\",\n  :value=&gt;\"Cr\u00e9er votre %{model}\"},\n {:full_key=&gt;[\"fr\", \"helpers\", \"submit\", \"hello\"], :key=&gt;\"world\",\n  :value=&gt;\"Bonjour le monde\"}]\n</code></pre>\n\n<hr>\n\n<p>But actually my goal is to have the full key of a value in the hash like this: </p>\n\n<pre><code>[{:full_key=&gt;[\"fr\"], :key=&gt;\"back\", :value=&gt;\"Retour\"},\n {:full_key=&gt;[\"fr\"], :key=&gt;\"signup\", :value=&gt;\"Inscription\"},\n {:full_key=&gt;[\"fr\", \"helpers\", \"submit\"], :key=&gt;\"create\", :value=&gt;\"Cr\u00e9er votre %{model}\"},\n {:full_key=&gt;[\"fr\", \"hello\"], :key=&gt;\"world\", :value=&gt;\"Bonjour le monde\"}]\n</code></pre>\n\n<p>Is there any way to handle hash in my function in order to have those kind of results?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby", "state-machine", "aasm"], "owner": {"reputation": 3091, "user_id": 1290457, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/121ff7202cde3e23e2c73ff3078b5a15?s=128&d=identicon&r=PG", "display_name": "sandre89", "link": "https://stackoverflow.com/users/1290457/sandre89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1528822305, "creation_date": 1528822305, "question_id": 50822109, "link": "https://stackoverflow.com/questions/50822109/ruby-aasm-act-as-state-machine-processing-a-payment-combining-a-before-callb", "title": "Ruby AASM (Act as State Machine): processing a payment: combining a before callback with a guard", "body": "<p>Let's assume a very simple <code>Payment</code> class like this:</p>\n\n<pre><code>class Payment\n  include AASM\n\n  aasm do\n\n    state :created\n    state :paid\n    state :refunded\n\n    event :pay do\n\n      transitions from :created, to :paid\n\n    end\n\n  end\n\nend\n</code></pre>\n\n<p>So one would call <code>payment.pay</code> to trigger the payment, making the appropriate API Calls. </p>\n\n<p>It's very important that the transition from <code>created</code> to <code>paid</code> only happens if the payment actually succeeds. </p>\n\n<p>1) I would assume the API Calls should be put in a <code>before</code> callback in the <code>:pay</code> event, but that would not halt the transition if the API call was unsuccessful (let's assume the API call does NOT raise an exception, it just returns a status).  </p>\n\n<p>2) I then thought that I should combine the <code>before</code> callback with a guard; use the <code>before</code> callback to call the API, and set it's result on the model (using an <code>attr_accessor</code> for instance). Then the guard would only allow it transition from the <code>created</code> to <code>paid</code> state if the payment was successful. </p>\n\n<p>Is that the idiomatic way of handling such an event transition in a state machine with aasm? I read all stack overflow's questions tagged <code>aasm</code> and the gem documentation and still have questions about what's the best way to make these safe transitions. </p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "spreadsheet", "axlsx"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528819960, "post_id": 50821258, "comment_id": 88648339, "body": "Well it is nice to see my code is being used :). Can you please elaborate on the &quot;error&quot; since the part after what you have posted is very important e.g. <i>&quot;undefined method merge_last_row [for XXX]&quot;</i>"}, {"owner": {"reputation": 99, "user_id": 9435011, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-surR8ciCRkU/AAAAAAAAAAI/AAAAAAAAB9E/5G43kwUd2Io/photo.jpg?sz=128", "display_name": "Mohammed Sayer", "link": "https://stackoverflow.com/users/9435011/mohammed-sayer"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528820482, "post_id": 50821258, "comment_id": 88648596, "body": "Hello @engineersmnky thanks for responding, this is the full error that i get undefined method <code>merge_last_row&#39; for #&lt;Axlsx::Worksheet:0x007f82a0139898&gt; Did you mean?  merge_cells excluded from capture: DSN not set ActionView::Template::Error (undefined method </code>merge_last_row&#39; for #&lt;Axlsx::Worksheet:0x007f82a0139898&gt; Did you mean?  merge_cells):`"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528820646, "post_id": 50821258, "comment_id": 88648667, "body": "Have you restarted your sever since you added the initializer? Initializers are only loaded once at start up."}, {"owner": {"reputation": 99, "user_id": 9435011, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-surR8ciCRkU/AAAAAAAAAAI/AAAAAAAAB9E/5G43kwUd2Io/photo.jpg?sz=128", "display_name": "Mohammed Sayer", "link": "https://stackoverflow.com/users/9435011/mohammed-sayer"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528820771, "post_id": 50821258, "comment_id": 88648714, "body": "I have the same issue like the one in the previous question want to merge cells for dynamic row, your answer has six upvotes means it works, but for some reason its not working at my end and its giving me this error, i have place the <code>module</code> file in the initializers folder as u have mentioned in the comments of the previous question @engineersmnky"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528820816, "post_id": 50821258, "comment_id": 88648736, "body": "Yes but have you restarted your rails server since doing so"}, {"owner": {"reputation": 99, "user_id": 9435011, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-surR8ciCRkU/AAAAAAAAAAI/AAAAAAAAB9E/5G43kwUd2Io/photo.jpg?sz=128", "display_name": "Mohammed Sayer", "link": "https://stackoverflow.com/users/9435011/mohammed-sayer"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1528820865, "post_id": 50821258, "comment_id": 88648757, "body": "No i had not, and restarting the server did solve the problem thank you so much"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528851491, "post_id": 50821258, "comment_id": 88660016, "body": "Glad you got it working. If the <code>axlsx</code> code is working well for feel free to up vote my original answer."}, {"owner": {"reputation": 99, "user_id": 9435011, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-surR8ciCRkU/AAAAAAAAAAI/AAAAAAAAB9E/5G43kwUd2Io/photo.jpg?sz=128", "display_name": "Mohammed Sayer", "link": "https://stackoverflow.com/users/9435011/mohammed-sayer"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1528992880, "post_id": 50821258, "comment_id": 88726191, "body": "I already did that, thank you again :) @engineersmnky"}], "owner": {"reputation": 99, "user_id": 9435011, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-surR8ciCRkU/AAAAAAAAAAI/AAAAAAAAB9E/5G43kwUd2Io/photo.jpg?sz=128", "display_name": "Mohammed Sayer", "link": "https://stackoverflow.com/users/9435011/mohammed-sayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528818731, "creation_date": 1528818731, "question_id": 50821258, "link": "https://stackoverflow.com/questions/50821258/merge-multiple-cells-of-multiple-rows-using-rails-axlsx", "title": "Merge multiple cells of multiple rows using rails Axlsx", "body": "<p>I have a rails application where i am trying to export some data in excel format. in my excel sheet i want to merge multiple cells of dynamic row. I am trying to follow <a href=\"https://stackoverflow.com/questions/23657513/axlsx-merge-cells-inside-a-style/23658760?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">this</a> answer but its giving me an error. Following the answer given in that solution i have created an<code>excel.rb</code> file inside my <code>config/initializers</code> directory and pasted this code</p>\n\n<pre><code>module Axlsx\n  class Worksheet\n    def merge_last_row(options={})\n       last_row = rows.last.index + 1\n       first_col,last_col = options[:columns]\n       if first_col &amp;&amp; last_col\n         merge_cells \"#{first_col}#{last_row}:#{last_col}#{last_row}\"\n       else\n         merge_cells sheet.rows.last\n       end\n       rows.last.style = style if options[:style]\n    end\n    def fill_columns(column_count,options={})\n      row_data = options[:row_data] || []\n      (column_count - row.count).times do \n        row_data &lt;&lt; nil\n      end\n      add_row row_data\n    end\n  end\nend\n</code></pre>\n\n<p>and then in my <code>report.xls.axlsx</code> file i have the following code</p>\n\n<pre><code>wb = xlsx_package.workbook\nxlsx_package.use_autowidth = true\n\nwb.add_worksheet(name: \"gold_sheet\") do |sheet|\n    @gold_live_console.each do |item|\n        section = item.room.section.try(:name)\n         time = item.bingning_inserted_at.strftime(\"%Y-%m-%d - %l:%M %p\")\n        if section.present?\n            sheet.add_row %w(Date)\n            sheet.merge_last_row columns:[\"A\",\"E\"]\n            sheet.add_row [time]\n            sheet.add_row %w(  Section  )\n            sheet.add_row [item.room.section.try(:name)]\n            sheet.add_row %w(  Gra_Name  )\n            sheet.add_row [item.room.gra_employee.try(:full_name)]\n            sheet.add_row %w(Room# Credit Beginning_Status PM_Status Notes)\n            sheet.add_row [item.room_location, item.room_credit, item.beginning_status]\n            sheet.add_row()\n        end\n    end\nend\n</code></pre>\n\n<p>When i run this it gives me <code>ActionView::Template::Error (undefined method merge_last_row'</code> error</p>\n\n<p>I want to merge all the columns from A to E for the Row with text Date</p>\n\n<p>How should i use the above method in my axlsx file? I am new to ruby so sorry if my mistake is too silly but can anyone please point me out what i am doing wrong?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1528818888, "post_id": 50821251, "comment_id": 88647792, "body": "Related: <a href=\"https://stackoverflow.com/questions/4493114/developing-gems-and-testing\" title=\"developing gems and testing\">stackoverflow.com/questions/4493114/developing-gems-and-test&zwnj;&#8203;ing</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528821580, "post_id": 50821251, "comment_id": 88648995, "body": "I am assuming by &quot;test&quot; you mean manually debug because testing would be best done through a testing framework like <code>minitest</code> or <code>rspec</code>"}, {"owner": {"reputation": 1602, "user_id": 589254, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/34890ea3a42603929d8a1d22864fcfd5?s=128&d=identicon&r=PG", "display_name": "gdanko", "link": "https://stackoverflow.com/users/589254/gdanko"}, "edited": false, "score": 0, "creation_date": 1528822314, "post_id": 50821251, "comment_id": 88649141, "body": "I have a test script I run and I may want to only test one aspect of the package. Is a test framework the only way around this?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528824801, "post_id": 50821251, "comment_id": 88650465, "body": "I am unsure what you mean by a &quot;test script&quot; but testing frameworks will allow you to run only specific tests or suites of tests"}, {"owner": {"reputation": 1602, "user_id": 589254, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/34890ea3a42603929d8a1d22864fcfd5?s=128&d=identicon&r=PG", "display_name": "gdanko", "link": "https://stackoverflow.com/users/589254/gdanko"}, "edited": false, "score": 0, "creation_date": 1528825635, "post_id": 50821251, "comment_id": 88650924, "body": "A small script that loads the module, creates an instance, and does stuff."}], "owner": {"reputation": 1602, "user_id": 589254, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/34890ea3a42603929d8a1d22864fcfd5?s=128&d=identicon&r=PG", "display_name": "gdanko", "link": "https://stackoverflow.com/users/589254/gdanko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528818715, "creation_date": 1528818715, "question_id": 50821251, "link": "https://stackoverflow.com/questions/50821251/testing-my-ruby-module-local-changes-without-require-relative", "title": "Testing my ruby module local changes without require_relative", "body": "<p>I have a ruby module with a number of class files. Some of them load others. If the module is installed then require 'mymodule/foo' loads foo.rb from the installed module. But what if I want to test code changes that I have made without building a new gem and installing it?</p>\n\n<p>I can do something like this but it's cumbersome:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'mymodule/foo'\n\n# require 'foo.rb'\n</code></pre>\n\n<p>But I have to constantly remember to make sure the right one is commented when building the new gem. I am proficient in Ruby but by no means an expert.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1528825621, "post_id": 50821102, "comment_id": 88650915, "body": "What is <code>order</code> as I do not see a declaration for <code>order</code>. I have a feeling this is <code>let(:order) { Order.new(#...) }</code> and this is your actual error when using <code>before(:all)</code> because it creates a contextual shift between a memoized helper <code>let</code> and a contextual setup <code>before(:all)</code>"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1528886461, "post_id": 50821102, "comment_id": 88674076, "body": "you left out <code>subject</code> declaration - can you paste it as well?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1529005989, "post_id": 50835115, "comment_id": 88732392, "body": "Ah, indeed. While not exactly what is being asked, this is, IMHO, a superior solution. With aggregate_failures, there&#39;s really not much sense in having one-liner tests with expensive setup. I myself use it all the time."}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1529010638, "post_id": 50835115, "comment_id": 88734362, "body": "At some point you also realize that all this setup time adds up, so you want to combine all this expectations for one setup to trim some of the specs time - this is useful then as well."}], "tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 1, "last_activity_date": 1528887571, "last_edit_date": 1528887571, "creation_date": 1528886366, "answer_id": 50835115, "question_id": 50821102, "link": "https://stackoverflow.com/questions/50821102/before-block-in-rspec-is-running-before-every-test-when-it-should-run-only-once/50835115#50835115", "title": "Before block in rspec is running before every test when it should run only once", "body": "<p>You can use <strong>one</strong> <code>specify</code> block approach if nothing else helps: </p>\n\n<pre><code>specify do \n subject.count.should == 34\n subject.pluck(:is_from_offer_special).count(true).should == 4\n #...\nend\n</code></pre>\n\n<p>But this has one drawback: if one expectation fails, the ones after it will not run. But you can fix that if you <a href=\"https://relishapp.com/rspec/rspec-expectations/v/3-7/docs/aggregating-failures\" rel=\"nofollow noreferrer\">aggregate failures</a></p>\n\n<pre><code>specify aggregate_failures: true do \n subject.count.should == 34\n subject.pluck(:is_from_offer_special).count(true).should == 4\n #...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1528887009, "creation_date": 1528887009, "answer_id": 50835331, "question_id": 50821102, "link": "https://stackoverflow.com/questions/50821102/before-block-in-rspec-is-running-before-every-test-when-it-should-run-only-once/50835331#50835331", "title": "Before block in rspec is running before every test when it should run only once", "body": "<blockquote>\n  <p>How can I make the before block run only once.</p>\n</blockquote>\n\n<p><code>before(:all)</code>, you already did that.</p>\n\n<blockquote>\n  <p>When I change it to <code>before(:all)</code> I get an error:</p>\n</blockquote>\n\n<p>That's a different, completely unrelated error. Your block <strong>does</strong> run only once, which is what you asked. The problem here is that a context-level block is trying to access example-level declarations. Kinda like trying to access instance variables from class methods: those variables don't exist yet!</p>\n\n<p>One possible approach is to inline all dependencies (don't use <code>let</code>, put code directly into the block): </p>\n\n<pre><code>before :all do\n  order = create :order # or whatever\n  order.already_went_through_license_worker = true\n  order.save!\n  ...\nend\n</code></pre>\n"}], "owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1167, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1528887571, "creation_date": 1528818265, "question_id": 50821102, "link": "https://stackoverflow.com/questions/50821102/before-block-in-rspec-is-running-before-every-test-when-it-should-run-only-once", "title": "Before block in rspec is running before every test when it should run only once", "body": "<p>I am running a <code>before do</code> at the beginning of my tests. I would like this <code>before to</code> be executed once before running my tests. However at the moment it is running before each test :</p>\n\n<pre><code>context \"worker has failed first time and has generated only part of licenses\" do\n      before do\n        order.already_went_through_license_worker = true\n        order.save!\n        order.pre_calculate_licenses\n        partial_generate_from_bundles(order.expected_license_bundles)\n        LicenseService.new.create_from_order(order.id)\n      end\n      let!(:licenses){ License.where(order_id: order.id)}\n      specify { subject.count.should == 34 }\n      specify { subject.pluck(:is_from_offer_special).count(true).should == 4}\n      specify { subject.pluck(:is_from_offer_special).count(false).should == 30 }\n      specify { subject.pluck(\"license_offer.offer_original_id\").compact.map(&amp;:values).flatten.count(offer.id).should == 30}\n      specify { subject.pluck(\"license_offer_special.offer_special_original_id\").compact.map(&amp;:values).flatten.count(offer_special_cyclic.id).should == 3}\n      specify { subject.pluck(\"license_offer_special.offer_special_original_id\").compact.map(&amp;:values).flatten.count(offer_special_non_cyclic.id).should == 1 }\n    end\n</code></pre>\n\n<p>When I change it to before(:all) I get an error :</p>\n\n<pre><code> let declaration `order` accessed in a `before(:context)` hook at:\n</code></pre>\n\n<p>How can I make the before block run only once.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "join", "ruby-on-rails-5", "jquery-datatables-rails"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "edited": false, "score": 0, "creation_date": 1528817628, "post_id": 50820834, "comment_id": 88647004, "body": "child already has a parent_id and funding already has a child_id. I need this join table to view fundings table in parent view page"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1528817681, "post_id": 50820834, "comment_id": 88647036, "body": "What <code>fundings</code> do you need to view? A parent&#39;s children&#39;s fundings?"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1528823028, "post_id": 50820834, "comment_id": 88649535, "body": "Thanks Navroop - in that case, this updated answer should work (@widjajayd also makes a good point about using as has many through shortcut). Let me know how you get on, or if you have any other questions!"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 0, "last_activity_date": 1528817990, "last_edit_date": 1528817990, "creation_date": 1528817423, "answer_id": 50820834, "question_id": 50820777, "link": "https://stackoverflow.com/questions/50820777/joins-in-rails-between-three-tables/50820834#50820834", "title": "Joins in rails between three tables", "body": "<p>You don't need join tables here - rather a parent ID column on the child record. So, in your case:</p>\n\n<ul>\n<li><code>Child</code> needs an integer column <code>parent_id</code></li>\n<li><code>Funding</code> needs an integer column <code>child_id</code></li>\n</ul>\n\n<p>Join tables only come into play when you're implementing a <code>has_and_belongs_to_many</code> or <code>has_many through</code> relationship.</p>\n\n<p>If you think about how you tie the records together, for a child to belong to a parent, the child merely needs to know which parent its tied to, hence the column.</p>\n\n<p>Now, imagine parents had many children, children had many parents: a single parent ID wouldn't cut it, so the join table comes in to tie the two together, containing (for example) both <code>parent_id</code> and <code>child_id</code> in each row of data. </p>\n\n<p>The database ties the records together using these methods, querying the id or join table as needed.</p>\n\n<p>To access the fundings from the parent record, you can either link the two together if their independently related, or access via the children if not.</p>\n\n<p>For the latter, you can use something like the following.</p>\n\n<p>In your controller:</p>\n\n<pre><code>@parents = Parent.includes(children: :fundings) #\u00a0includes preloads the data, avoiding expensive N + 1 queries\n</code></pre>\n\n<p>In your view:</p>\n\n<pre><code>&lt;% @parents.each do |parent| %&gt;\n  &lt;#% whatever you want to display regarding the parent here %&gt;\n\n  &lt;% parent.children.each do |child| %&gt;\n    &lt;#% whatever you want to display regarding the child here %&gt;\n\n    &lt;% child.fundings.each do |funding| %&gt;\n      &lt;#% whatever you want to display regarding the funding here %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>That's a little messy, so it would be worth separating the data in the controller or partials as suits. Hope that gives you an idea of how to work this though?</p>\n"}, {"tags": [], "owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "is_accepted": false, "score": 0, "last_activity_date": 1528818547, "creation_date": 1528818547, "answer_id": 50821183, "question_id": 50820777, "link": "https://stackoverflow.com/questions/50820777/joins-in-rails-between-three-tables/50821183#50821183", "title": "Joins in rails between three tables", "body": "<p>if you need to access fundings from parent you can use has_many through with declaration in rails as follows: </p>\n\n<p>parent.rb</p>\n\n<pre><code>class Parent &lt; ApplicationRecord\n  has_many :children, dependent: :destroy\n  has_many :fundings, through: :children\nend\n</code></pre>\n\n<p>child.rb</p>\n\n<pre><code>class Child &lt; ApplicationRecord\n  belongs_to :parent\n  has_many :fundings, dependent: :destroy\nend\n</code></pre>\n\n<p>funding.rb</p>\n\n<pre><code>class Funding &lt; ApplicationRecord\n  belongs_to :child\nend\n</code></pre>\n\n<p>you can access funding record through parent with <strong>@parent.fundings</strong></p>\n\n<p>here is reference link for <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association\" rel=\"nofollow noreferrer\">has_many through</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 50820834, "answer_count": 2, "score": 1, "last_activity_date": 1528818547, "creation_date": 1528817238, "question_id": 50820777, "link": "https://stackoverflow.com/questions/50820777/joins-in-rails-between-three-tables", "title": "Joins in rails between three tables", "body": "<p>I have three tables parents, children and fundings. </p>\n\n<p>parent.rb</p>\n\n<pre><code>class Parent &lt; ApplicationRecord\n  has_many :children, dependent: :destroy\nend\n</code></pre>\n\n<p>child.rb</p>\n\n<pre><code>class Parent &lt; ApplicationRecord\n  belongs_to :parent\n  has_many :fundings, dependent: :destroy\nend\n</code></pre>\n\n<p>funding.rb</p>\n\n<pre><code>class Funding &lt; ApplicationRecord\n      belongs_to :child\nend\n</code></pre>\n\n<p>Joins between children and fundings</p>\n\n<pre><code>create_table \"children_fundings\", id: false, force: :cascade do |t|\n    t.integer \"child_id\", null: false\n    t.integer \"funding_id\", null: false\n    t.index [\"child_id\", \"funding_id\"], name: \n    \"index_children_fundings_on_child_id_and_funding_id\"\n    t.index [\"funding_id\", \"child_id\"], name: \n    \"index_children_fundings_on_funding_id_and_child_id\"\nend\n</code></pre>\n\n<p>join between children and parents</p>\n\n<pre><code>  create_table \"children_parents\", id: false, force: :cascade do |t|\n    t.integer \"parent_id\", null: false\n    t.integer \"child_id\", null: false\n    t.index [\"child_id\", \"parent_id\"], name: \n    \"index_children_parents_on_child_id_and_parent_id\"\n    t.index [\"parent_id\", \"child_id\"], name: \n    \"index_children_parents_on_parent_id_and_child_id\"\n  end\n</code></pre>\n\n<p>children table has parent_id, fundings table has child_id. How can I create a join between parents children and fundings table. Please help </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubocop"], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 4, "last_activity_date": 1528818325, "last_edit_date": 1528818325, "creation_date": 1528818023, "answer_id": 50821017, "question_id": 50820735, "link": "https://stackoverflow.com/questions/50820735/rubocop-lint-void-literal-used-in-void-context/50821017#50821017", "title": "Rubocop Lint/Void: Literal used in void context", "body": "<pre><code>2..7.each do |i|\n  # ...\nend\n</code></pre>\n\n<p>...is <strong>invalid code</strong>!! Have you tried running it? You'll see the following error:</p>\n\n<pre><code>NoMethodError: undefined method `each' for 7:Integer\n</code></pre>\n\n<p>To fix this, you need to define the <code>Range</code> in brackets:</p>\n\n<pre><code>(2..7).each do |i|\n  # ...\nend\n</code></pre>\n\n<p>The <code>rubocop</code> error is in relation to this: Since <em>if</em> there were an <code>each</code> method defined on <code>Integer</code> (there isn't, but <code>rubocop</code> doesn't know that), then the code would be valid but the <code>2..&lt;something&gt;</code> range definition would serve no purpose; it's a <em>literal</em> with a <em>void context</em>.</p>\n"}], "owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4359, "favorite_count": 1, "accepted_answer_id": 50821017, "answer_count": 1, "score": 3, "last_activity_date": 1528818325, "creation_date": 1528817116, "question_id": 50820735, "link": "https://stackoverflow.com/questions/50820735/rubocop-lint-void-literal-used-in-void-context", "title": "Rubocop Lint/Void: Literal used in void context", "body": "<p>I have been running rubocop and encountered a <em>Lint/Void: Literal used in void context</em> offence.</p>\n\n<p>the following code:</p>\n\n<pre><code>routes_and_postcodes.each do |hash|\n  2..7.each do |i|\n    route = Route.where(name: hash[:route]).first if postcode.delete(\" \").first(i) == hash[:postcode].delete(\" \")\n  end\nend\n</code></pre>\n\n<p>I have read the <a href=\"https://www.rubydoc.info/gems/rubocop/RuboCop/Cop/Lint/Void\" rel=\"nofollow noreferrer\">docs</a>, but still cant understand what the issue is.\nIn context, the full code is here:</p>\n\n<pre><code>def choose_own_van_route(postcode)\nroute = nil\nroutes_and_postcodes = []\nRoute.all.each do |r|\n  route_postcodes = r.postcode_array\n  route_postcodes.each do |pc|\n    routes_and_postcodes &lt;&lt; { postcode: pc, route: r.name }\n  end\nend\nroutes_and_postcodes.each do |hash|\n  2..7.each do |i|\n    route = Route.where(name: hash[:route]).first if postcode.delete(\" \").first(i) == hash[:postcode].delete(\" \")\n  end\nend\nroute || Route.create(cut_off_time_mins_since_midnight: 0, name: \"BLANK ROUTE HAD TO BE ASSIGNED\")\nend \n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["arrays", "ruby", "iterator"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1528814671, "post_id": 50819916, "comment_id": 88645142, "body": "All <code>row</code>s reference the same object. Use <code>3.times { b &lt;&lt; row.dup }</code>."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1528814682, "post_id": 50819916, "comment_id": 88645149, "body": "There&#39;s only one <code>row</code>."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1528817124, "post_id": 50819965, "comment_id": 88646724, "body": "@SRack save for this question was asked here on SO a dozillion times and a lazy search would bring a dozens closed as duplicate answers."}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 3, "last_activity_date": 1528814990, "last_edit_date": 1528814990, "creation_date": 1528814693, "answer_id": 50819965, "question_id": 50819916, "link": "https://stackoverflow.com/questions/50819916/trying-to-change-single-value-in-array-created-with-iteration-changes-multiple-v/50819965#50819965", "title": "Trying to change single value in array created with iteration changes multiple values. Why?", "body": "<p>The line <code>3.times { b &lt;&lt; row }</code> adds 3 references to the <em>same</em> array to <code>b</code>, so modifying it once changes it three times in the array.</p>\n\n<p>Try updating this to <code>dup</code> the row as you push it into <code>b</code>, i.e. <code>3.times { b &lt;&lt; row.dup }</code>.</p>\n\n<p>(As I'm typing I'm seeing @mudasobwa beat me to it in a comment :) )</p>\n\n<p>This approach will ensure <code>b</code> is filled with three unique arrays, rather than the same one three times.</p>\n\n<p>If you're unsure, you can check the <code>object_id</code>, i.e. <code>b.map(&amp;:object_id)</code> - at present, these will all be the same.</p>\n"}], "owner": {"reputation": 143, "user_id": 9371902, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gwuFGZWgdr4/AAAAAAAAAAI/AAAAAAAABG4/Xvw4EuUOrH4/photo.jpg?sz=128", "display_name": "wilcro", "link": "https://stackoverflow.com/users/9371902/wilcro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1528824920, "accepted_answer_id": 50819965, "answer_count": 1, "score": 0, "last_activity_date": 1528814990, "creation_date": 1528814542, "question_id": 50819916, "link": "https://stackoverflow.com/questions/50819916/trying-to-change-single-value-in-array-created-with-iteration-changes-multiple-v", "closed_reason": "Duplicate", "title": "Trying to change single value in array created with iteration changes multiple values. Why?", "body": "<pre><code>a = [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\nb = []\nrow = []\n3.times { row &lt;&lt; 0 }\n3.times { b &lt;&lt; row }\n\np a #=&gt; [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\np b #=&gt; [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\np a == b                         #=&gt; true\np (a[1][1] = 1) == (b[1][1] = 1) #=&gt; true\n\n# and yet ...\na[1][1] = 1\nb[1][1] = 1\np a #=&gt; [[0, 0, 0], [0, 1, 0], [0, 0, 0]]\np b #=&gt; [[0, 1, 0], [0, 1, 0], [0, 1, 0]]\n</code></pre>\n\n<p>With this code, I'd expect the modified b to be the same as the modified a, but instead, the second element of each nested array is modified.</p>\n\n<p>What am I missing? Why do <code>a[1][1] = 1</code> and <code>b[1][1] = 1</code> produce different results?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-5", "filterrific"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "edited": false, "score": 0, "creation_date": 1529054479, "post_id": 50854493, "comment_id": 88746727, "body": "Thanks a lot, it&#39;s working, i just delete the &quot;I&quot; from ILIKE ! :)"}, {"owner": {"reputation": 443, "user_id": 5997874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1hXYF.png?s=128&g=1", "display_name": "ldl", "link": "https://stackoverflow.com/users/5997874/ldl"}, "reply_to_user": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "edited": false, "score": 0, "creation_date": 1529306225, "post_id": 50854493, "comment_id": 88808446, "body": "That&#39;s ok. For PostgreSQL the keyword ILIKE can be used instead of LIKE to make the match case insensitive."}], "tags": [], "owner": {"reputation": 443, "user_id": 5997874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1hXYF.png?s=128&g=1", "display_name": "ldl", "link": "https://stackoverflow.com/users/5997874/ldl"}, "is_accepted": false, "score": 0, "last_activity_date": 1528969682, "creation_date": 1528969682, "answer_id": 50854493, "question_id": 50819649, "link": "https://stackoverflow.com/questions/50819649/my-filterrific-filter-dont-work/50854493#50854493", "title": "My Filterrific filter don&#39;t work", "body": "<p>The method you used, <code>scope :search_query...</code>, is for finding the input text in one of the 2 database columns you designated, <code>users.mother_tongue</code> and <code>users.locality</code>. Infact the resulting where clause will be <code>\"WHERE LOWER(users.mother_tongue) LIKE ? OR LOWER(users.locality) LIKE ?\"</code>.</p>\n\n<p>If you want to filter values of 2 fields separatelly, you must define 2 input fields with different names, 2 filters and 2 scopes. </p>\n\n<p>The code could be like this:</p>\n\n<p>Model user.rb :</p>\n\n<pre><code>filterrific(\n  default_filter_params: {},\n  available_filters: [\n    :with_mother_tongue,\n    :with_locality,\n    :with_start_time_gte\n  ]\n)\n\nscope :with_mother_tongue, -&gt; (search_string) {\n  where(\"users.mother_tongue ILIKE ?\", (search_string.to_s.gsub('*', '%') + '%').gsub(/%+/, '%'))\n}\n\nscope :with_locality, -&gt; (search_string) {\n  where(\"users.locality ILIKE ?\", (search_string.to_s.gsub('*', '%') + '%').gsub(/%+/, '%'))\n}\n\nscope :with_start_time_gte, lambda { |ref_date|\n  where('availability.start_time &gt;= ?', ref_date)\n}\n</code></pre>\n\n<p>In the index view you must also render the _list partial (see at the end):</p>\n\n<p>index.html.erb:</p>\n\n<pre><code>&lt;% provide(:title, 'Liste des utilisateurs') %&gt;\n&lt;h1&gt;Liste des utilisateurs :&lt;/h1&gt;\n\n&lt;%= form_for_filterrific @filterrific, html: { id: 'filterrific-no-ajax-auto-submit' } do |f| %&gt;\n&lt;div&gt;\n  Langue :\n  &lt;%= f.text_field(\n  :with_mother_tongue,\n  class: 'mother_tongue filterrific-periodically-observed'\n) %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n  Ville :\n    &lt;%= f.text_field(\n  :with_locality,\n  class: 'locality filterrific-periodically-observed'\n) %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n  Date de d\u00e9part :\n    &lt;%= f.text_field(:with_start_time_gte, class: 'js-datepicker') %&gt;\n&lt;/div&gt;\n\n&lt;%= f.submit 'Rechercher' %&gt;\n\n&lt;div&gt;\n  &lt;%= link_to(\n   'Reset filters',\n  reset_filterrific_url,\n) %&gt;\n&lt;/div&gt;\n\n&lt;%= render_filterrific_spinner %&gt;    \n\n#filterrific_results\n  = render 'users/list', users: @users\n</code></pre>\n\n<p>And lastly you have to define the js view called by the index action in the controller when you filter the records filling at least one of the filters input fields:</p>\n\n<p>index.js.erb</p>\n\n<pre><code>&lt;% js = escape_javascript (\n  render(partial: 'users/list', locals: {users: @users})\n) %&gt;\n$(\"#filterrific_results\").html(\"&lt;%= js %&gt;\");\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 516, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530614107, "creation_date": 1528813712, "last_edit_date": 1528829416, "question_id": 50819649, "link": "https://stackoverflow.com/questions/50819649/my-filterrific-filter-dont-work", "title": "My Filterrific filter don&#39;t work", "body": "<p>I try to implement Filterrific on my application to filter Users. I need to filter by mother_tongue, locality and availability start_time. But it doesn't work. There is no errors but there is no filtering...</p>\n\n<p>Model user.rb :</p>\n\n<pre><code>filterrific(\n  default_filter_params: {},\n  available_filters: [\n    :search_query,\n    :search_query,\n    :with_start_time_gte\n  ]\n )\n\nscope :search_query, lambda { |query|\n  return nil  if query.blank?\n\n  terms = query.downcase.split(/\\s+/)\n\n  terms = terms.map { |e|\n    (e.gsub('*', '%') + '%').gsub(/%+/, '%')\n  }\n  num_or_conditions = 2\n  where(\n    terms.map {\n      or_clauses = [\n          \"LOWER(users.mother_tongue) LIKE ?\",\n          \"LOWER(users.locality) LIKE ?\"\n      ].join(' OR ')\n      \"(#{ or_clauses })\"\n    }.join(' AND '),\n    *terms.map { |e| [e] * num_or_conditions }.flatten\n  )\n}\n\nscope :with_start_time_gte, lambda { |ref_date|\n  where('availability.start_time &gt;= ?', ref_date)\n}\n</code></pre>\n\n<p>Users_controller.rb :</p>\n\n<pre><code>def index\n  @filterrific = initialize_filterrific(\n    User,\n    params[:filterrific]\n    #persistence_id: 'shared_key',\n    #default_filter_params: {},\n    #available_filters: [],\n  ) or return\n  @users = @filterrific.find.page(params[:page])\n\n  # Respond to html for initial page load and to js for AJAX filter updates.\n  respond_to do |format|\n    format.html\n    format.js\n  end\n\n  rescue ActiveRecord::RecordNotFound =&gt; e\n    # There is an issue with the persisted param_set. Reset it.\n    puts \"Had to reset filterrific params: #{ e.message }\"\n    redirect_to(reset_filterrific_url(format: :html)) and return\nend\n</code></pre>\n\n<p>index.html.erb :</p>\n\n<pre><code>&lt;% provide(:title, 'Liste des utilisateurs') %&gt;\n&lt;h1&gt;Liste des utilisateurs :&lt;/h1&gt;\n\n&lt;%= form_for_filterrific @filterrific, html: { id: 'filterrific-no-ajax-auto-submit' } do |f| %&gt;\n&lt;div&gt;\n  Langue :\n  &lt;%= f.text_field(\n  :search_query,\n  class: 'mother_tongue filterrific-periodically-observed'\n) %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n  Ville :\n    &lt;%= f.text_field(\n  :search_query,\n  class: 'locality filterrific-periodically-observed'\n) %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n  Date de d\u00e9part :\n    &lt;%= f.text_field(:with_start_time_gte, class: 'js-datepicker') %&gt;\n&lt;/div&gt;\n\n&lt;%= f.submit 'Rechercher' %&gt;\n\n&lt;div&gt;\n  &lt;%= link_to(\n   'Reset filters',\n  reset_filterrific_url,\n) %&gt;\n&lt;/div&gt;\n\n&lt;%= render_filterrific_spinner %&gt;\n</code></pre>\n\n  \n\n  \n\n<p>_list.html.erb :</p>\n\n<pre><code>&lt;div id=\"filterrific_results\"&gt;\n\n&lt;div&gt;\n&lt;%= page_entries_info users %&gt;\n&lt;/div&gt;\n\n&lt;% @users.each do |user| %&gt;\n  &lt;h1&gt;&lt;%= user.fname %&gt; &lt;%= user.lname %&gt;&lt;/h1&gt;\n    &lt;h2&gt;&lt;%= user.mother_tongue %&gt;&lt;/h2&gt;\n  &lt;center&gt;\n    &lt;p&gt;&lt;%= user.postal_code %&gt; &lt;%= user.locality %&gt;&lt;/p&gt;\n\n    &lt;p&gt;&lt;%= link_to \"En savoir plus\", user_path(user) %&gt;&lt;/p&gt;\n  &lt;/center&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p></p>\n\n  \n\n<p>I'm new on rails, so thank you for your help.</p>\n"}, {"tags": ["ruby", "xml", "attributes", "savon"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528812286, "post_id": 50818871, "comment_id": 88643459, "body": "I am not exactly sure what you are asking but have you tried <code>client.call( :method, message: { extID: &#39;X-1234&#39;, attributes!: {&#39;int:policyID&#39;: { &#39;updateVersion&#39;: 0 }})</code>? I cannot guarantee this works since I have never tried to modify the attributes of something that was not contained in the &quot;message&quot; itself"}, {"owner": {"reputation": 26, "user_id": 4008067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e4c73b152f92420400bdc16b884f0aa?s=128&d=identicon&r=PG&f=1", "display_name": "jakohans", "link": "https://stackoverflow.com/users/4008067/jakohans"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528877385, "post_id": 50818871, "comment_id": 88668427, "body": "Thanks, but it is unfortunately not working. I&#39;m getting the error message: Error parsing Element [interfaces-root:policyInList: null] in Document [#document: null]; I&#39;m asking how to set an attribute in a request when it is outside the message. In above example I need to set the updateVersion to &#39;0&#39;,"}], "owner": {"reputation": 26, "user_id": 4008067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e4c73b152f92420400bdc16b884f0aa?s=128&d=identicon&r=PG&f=1", "display_name": "jakohans", "link": "https://stackoverflow.com/users/4008067/jakohans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528816514, "creation_date": 1528811337, "last_edit_date": 1528816514, "question_id": 50818871, "link": "https://stackoverflow.com/questions/50818871/add-attribute-in-savon-request", "title": "Add attribute in Savon request", "body": "<p>How can I add the attribute 'updateVersion' in the request, when using the following format: </p>\n\n<pre><code>response = client.call( \n  :method, :message =&gt; { extID =&gt; 'X-1234', ..., '@updateVersion' =&gt; '0' }\n)\n</code></pre>\n\n<p>I need to set the updateVersion to <code>0</code> for my call to be successful and of course the <code>extID</code>.</p>\n\n<p>When using response = <code>client.call( :method, xml: \"xml\")</code> then it is working as expected, but I'd like to see/test the other option.</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:int=\"http://www.url\"&gt;\n   &lt;soapenv:Body&gt;\n      &lt;int:policyInList&gt;\n         &lt;!--0 to 1000 repetitions:--&gt;\n         &lt;int:policyID main=\"true\" system_id=\"0\" updateVersion=\"?\"&gt;\n            &lt;extID&gt;X-1234&lt;/extID&gt;\n         &lt;/int:policyID&gt;\n      &lt;/int:policyInList&gt;\n   &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "answers": [{"tags": [], "owner": {"reputation": 2958, "user_id": 3597730, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d76b8f632aeb1d920d79d7dd5ab63097?s=128&d=identicon&r=PG", "display_name": "ruby_newbie", "link": "https://stackoverflow.com/users/3597730/ruby-newbie"}, "is_accepted": true, "score": 1, "last_activity_date": 1528812114, "last_edit_date": 1528812114, "creation_date": 1528811813, "answer_id": 50819013, "question_id": 50818704, "link": "https://stackoverflow.com/questions/50818704/test-that-sidekiq-job-called-mailer/50819013#50819013", "title": "Test that Sidekiq job called mailer", "body": "<p>From the rspec docs(<a href=\"https://relishapp.com/rspec/rspec-mocks/v/2-14/docs/message-expectations/expect-message-using-should-receive\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-mocks/v/2-14/docs/message-expectations/expect-message-using-should-receive</a>): </p>\n\n<p>expect a message with an argument\nGiven\na file named \"spec/account_spec.rb\" with:</p>\n\n<pre><code>require \"account\"\nrequire \"spec_helper\"\n\ndescribe Account do\n  context \"when closed\" do\n    it \"logs an account closed message\" do\n      logger = double(\"logger\")\n      account = Account.new logger\n\n      logger.should_receive(:account_closed).with(account)\n\n      account.close\n    end\n  end\nend\n</code></pre>\n\n<p>And\na file named \"lib/account.rb\" with:</p>\n\n<pre><code>Account = Struct.new(:logger) do\n  def close\n    logger.account_closed(self)\n  end\nend\n</code></pre>\n\n<p>When\nI run rspec spec/account_spec.rb\nThen\nthe output should contain \"1 example, 0 failures\"</p>\n\n<p>so in your case:</p>\n\n<pre><code>CampaignMailer.should_receive(:send_csv).with(&lt;expected_email_arg&gt;, &lt;expected_csv_arg&gt;)\n</code></pre>\n\n<p>You can also add on a <code>.and_return(&lt;expected_return_value&gt;)</code> to test the return value.  </p>\n"}], "owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 50819013, "answer_count": 1, "score": 0, "last_activity_date": 1528812114, "creation_date": 1528810845, "question_id": 50818704, "link": "https://stackoverflow.com/questions/50818704/test-that-sidekiq-job-called-mailer", "title": "Test that Sidekiq job called mailer", "body": "<p>I'm testing my Sidekiq job and I'm trying to figure out how to ensure that it called a method within the job with the correct arguments. Here is my actual job:</p>\n\n<h3>JOB:</h3>\n\n<pre><code>def perform\n  csv = Campaign.to_csv\n  email = current_sso_user.email\n\n  CampaignMailer.send_csv(email, csv).deliver_now\nend\n</code></pre>\n\n<p>I'd like to build a test that ensures the CampaignMailer.send_csv was called with the correct args.</p>\n\n<p>Here is what I have currently:</p>\n\n<h3>TEST:</h3>\n\n<pre><code>RSpec.describe CampaignsExortJob, type: :model do\n  subject(:job) { CampaignsExportJob.new }\n\n  describe '#perform' do\n    let(:campaign) { create(:campaign) }\n\n    it 'sends the csv email' do\n      expect(job).to receive(:CampaignMailer.send_csv)\n    end\n  end\nend\n</code></pre>\n\n<p>But this is a syntax error. Can anyone give me some guidance on how to test this properly? Thank You!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "exception", "controller"], "comments": [{"owner": {"reputation": 302, "user_id": 8080972, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3a9cd25a4e17c37e88ce828b98096d3e?s=128&d=identicon&r=PG&f=1", "display_name": "Kiran Pawar", "link": "https://stackoverflow.com/users/8080972/kiran-pawar"}, "edited": false, "score": 0, "creation_date": 1528810871, "post_id": 50817923, "comment_id": 88642506, "body": "Where did you write the rescue_from? In ApplicationController?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528834938, "post_id": 50817923, "comment_id": 88655360, "body": "the error occurs outside of your <code>begin..rescue</code> block most likely here <code>authorize User</code>"}, {"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528867095, "post_id": 50817923, "comment_id": 88663279, "body": "<code>rescue_from</code> is not defined anywhere. @engineersmnky - The error is throw out by the <code>resource_type.constantize.find</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528889617, "post_id": 50817923, "comment_id": 88676033, "body": "Move begin to above authorize does it still not rescue it?"}, {"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1528891599, "post_id": 50817923, "comment_id": 88677362, "body": "Result still remains the same"}], "answers": [{"comments": [{"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1528867250, "post_id": 50828120, "comment_id": 88663315, "body": "I tried it, but still, the exception occurred and <code>rescue</code> block is not in use."}, {"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1528867564, "post_id": 50828120, "comment_id": 88663419, "body": "I&#39;ve added backtrace to the question."}, {"owner": {"reputation": 535, "user_id": 3103697, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ff5aa9bbc12698546625775d34119861?s=128&d=identicon&r=PG&f=1", "display_name": "heinztomato", "link": "https://stackoverflow.com/users/3103697/heinztomato"}, "reply_to_user": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1528965571, "post_id": 50828120, "comment_id": 88709023, "body": "is that the entire backtrace? a 500 internal server error basically means rails does not know how to handle the error it received. You can also try to add a <code>rescue_from</code> statement on <code>ActiveRecord::RecordNotFound</code> to try and catch this error - <a href=\"https://medium.com/spritle-software/handle-activerecord-recordnotfound-more-elegantly-11891c80a644\" rel=\"nofollow noreferrer\">medium.com/spritle-software/&hellip;</a>  <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/Rescuable/ClassMethods.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveSupport/Rescuable/&hellip;</a>"}, {"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1529310550, "post_id": 50828120, "comment_id": 88810584, "body": "I tried <code>rescue_from</code> statement, and the result was the same. I changed the controller method, where rescue is defined in the <code>respond_to</code> block, and catch works fine now."}], "tags": [], "owner": {"reputation": 535, "user_id": 3103697, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ff5aa9bbc12698546625775d34119861?s=128&d=identicon&r=PG&f=1", "display_name": "heinztomato", "link": "https://stackoverflow.com/users/3103697/heinztomato"}, "is_accepted": false, "score": 0, "last_activity_date": 1528855778, "last_edit_date": 1528855778, "creation_date": 1528855237, "answer_id": 50828120, "question_id": 50817923, "link": "https://stackoverflow.com/questions/50817923/why-controller-does-not-catch-error/50828120#50828120", "title": "Why controller does not catch error", "body": "<p>it looks like its catching the error correctly, I am wondering if the real problem is the ordering of the code in the rescue statement. try setting the flash before the render call.</p>\n\n<pre><code>rescue ActiveRecord::RecordNotFound =&gt; e\n  flash[:error] = e.message\n  format.html { render :show }\nend\n</code></pre>\n\n<p>to me, it looks like your returning the <code>error.message</code> and not the render statement. Likewise, you could also try <code>render :show, flash: { error: e.message }</code></p>\n"}, {"tags": [], "owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "is_accepted": true, "score": 0, "last_activity_date": 1529310704, "creation_date": 1529310704, "answer_id": 50905472, "question_id": 50817923, "link": "https://stackoverflow.com/questions/50817923/why-controller-does-not-catch-error/50905472#50905472", "title": "Why controller does not catch error", "body": "<p>Exception handling starts working when the exception is caught at the <code>respond_to</code> block.</p>\n\n<p>I also defined my own exception, but this has no effect on the result.</p>\n\n<pre><code>def create_user_role\n    authorize User\n    # Params Inicialization\n    role = params[:user][:rolify_role].to_sym\n    resource_type = params[:user][:resource_type]\n    resource_id = params[:user][:id]\n\n    respond_to do |format|\n      begin\n        # Make resource as instance of class or set to nil\n        resource = RolifyRoles.build_resource(resource_type, resource_id)\n        if @user.add_role role, resource\n          format.html { redirect_to @user, notice: \"Role #{role} was successfully added.\" }\n          format.json { render :show, status: :created, location: @user }\n        else\n          format.html { render :show }\n          format.json { render json: @user.errors, status: :unprocessable_entity }\n        end\n      # Catch self defined exceptions\n      rescue RolifyRolesException =&gt; e\n        flash[:error] = e.message\n        flash.keep\n        format.html { render :show, flash: { error: e.message } }\n        format.json { render json: e.message, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n"}], "owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 2, "accepted_answer_id": 50905472, "answer_count": 2, "score": 1, "last_activity_date": 1529310704, "creation_date": 1528808512, "last_edit_date": 1528867544, "question_id": 50817923, "link": "https://stackoverflow.com/questions/50817923/why-controller-does-not-catch-error", "title": "Why controller does not catch error", "body": "<p>I've tried to rescue from RecordNotFound error in controller like this:</p>\n\n<pre><code>  def create_user_role\n    authorize User\n    role = params[:user][:rolify_role].to_sym\n    resource_type = params[:user][:resource_type]\n    resource_id = params[:user][:id]\n\n    # Catch RecordNotFound doesn't work\n    begin\n      resource = nil\n      resource = resource_type.constantize.find(resource_id) if RolifyRoles.available_resources.include?(resource_type) &amp;&amp; resource_id.present?\n    rescue ActiveRecord::RecordNotFound =&gt; e\n      format.html { render :show }\n      flash[:error] = e.message\n    end\n  end\n</code></pre>\n\n<p>And when the <code>resource_type.constantize.find(resource_id)</code> cannot find the record, its doesn't caught by the rescue block.</p>\n\n<pre><code> Completed 500 Internal Server Error in 46ms (ActiveRecord: 3.2ms)\n ActiveRecord::RecordNotFound - Couldn't find RequestComment with 'id'=1:\n app/controllers/users_controller.rb:58:in `create_user_role'\n</code></pre>\n\n<p>I've tried to rescue with <code>StandardError</code> or even with <code>Exception</code> and result was the same.</p>\n\n<p>Where is the problem? </p>\n\n<p>I am also calling a method from my <code>module</code> which raise some exceptions, which also aren't handled.</p>\n\n<p>Backtrace:</p>\n\n<pre><code>07:23:29 web.1     | Started POST \"/users/kru0096/create_user_role\" for 10.0.131.29 at 2018-06-13 07:23:29 +0200\n07:23:39 web.1     | Processing by UsersController#create_user_role as HTML\n07:23:39 web.1     |   Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"5kN6MuoP4YntbTvL5cTDPuCZypDdO\no1KPcvIu8dJ6otX0aYPwuWg64/TTTgDe6DRXn6wCs1KvgT9xjkr9g/dyA==\", \"user\"=&gt;{\"rolify_role\"=&gt;\"hoac\", \"resource_type\"=&gt;\"RequestComment\", \"id\"=&gt;\"1\"}, \"commit\"=&gt;\"\", \"id\"=&gt;\"kru0096\"}\n07:23:39 web.1     |   User Load (0.3ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 ORDER BY `users`.`id` ASC LIMIT 1\n07:23:39 web.1     |   User Load (0.3ms)  SELECT  `users`.* FROM `users` WHERE `users`.`login` = 'kru0096' LIMIT 1\n07:23:39 web.1     |   RequestComment Load (0.3ms)  SELECT  `request_comments`.* FROM `request_comments` WHERE `request_comments`.`id` = 1 LIMIT 1\n07:23:39 web.1     | Completed 500 Internal Server Error in 41ms (ActiveRecord: 6.5ms)\n07:23:39 web.1     | \n07:23:39 web.1     | \n07:23:39 web.1     | \n07:23:39 web.1     | ActiveRecord::RecordNotFound - Couldn't find RequestComment with 'id'=1:\n07:23:39 web.1     |   app/controllers/users_controller.rb:92:in `create_user_role'\n07:23:39 web.1     | \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "actioncontroller", "actiondispatch"], "answers": [{"tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": true, "score": 3, "last_activity_date": 1528808118, "creation_date": 1528808118, "answer_id": 50817785, "question_id": 50817063, "link": "https://stackoverflow.com/questions/50817063/dispatch-rails-controller-action-outside-of-http-context-not-in-a-unit-test/50817785#50817785", "title": "Dispatch Rails Controller Action Outside of HTTP context (not in a unit test)", "body": "<p>Ow very interesting problem! </p>\n\n<p>My first idea was to approach it backwards: so create a fake <code>Rack::Request</code> or <code>ActionDispatch::Request</code> and then force it to be handled? Assuming it would go to the right controller and action automatically (so you do not have to call it explicitly). But of course the problem remains: how to create the <code>Request</code> :) </p>\n\n<p>So I was browsing the rails tests and I found the following snippet which might get you started: </p>\n\n<pre><code>SimpleController.action(\"hello\").call(\n  \"REQUEST_METHOD\" =&gt; \"GET\",\n  \"rack.input\" =&gt; -&gt; {}\n)\n</code></pre>\n\n<p>Source: <a href=\"https://github.com/rails/rails/blob/85fcb663363cd27220e8bd3136973cc3408cf7d7/actionpack/test/controller/metal_test.rb\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/85fcb663363cd27220e8bd3136973cc3408cf7d7/actionpack/test/controller/metal_test.rb</a></p>\n\n<p>From my understanding this means you can give a entire fake request environment as a hash with keys being the strings, right? So you could dump the env from a valid request and transpose accordingly. </p>\n\n<p>Not sure if this is really helpful. </p>\n"}], "owner": {"reputation": 6433, "user_id": 1064917, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/219d10e3fc486c3173291954195d537c?s=128&d=identicon&r=PG", "display_name": "Rick", "link": "https://stackoverflow.com/users/1064917/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 2, "accepted_answer_id": 50817785, "answer_count": 1, "score": 1, "last_activity_date": 1528808118, "creation_date": 1528805956, "question_id": 50817063, "link": "https://stackoverflow.com/questions/50817063/dispatch-rails-controller-action-outside-of-http-context-not-in-a-unit-test", "title": "Dispatch Rails Controller Action Outside of HTTP context (not in a unit test)", "body": "<p>I maintain a mature codebase that uses Rails as an API. The Rails app also does some things with MQTT, a realtime, non-web, non-HTTP protocol.</p>\n\n<p>Some users have requested the ability to simulate the same REST commands over the MQTT protocol (avoids the need to auth twice and have two different protocol clients).</p>\n\n<p>I have seen some projects, <a href=\"https://github.com/arsduo/batch_api\" rel=\"nofollow noreferrer\">such as Facebook's API</a> \"simulate\" HTTP by putting parts of the HTTP request into a request using JSON (eg: have a \"header\" and \"method\" property on a JSON payload). This is precisely what I want to do but outside of the HTTP context entirely. It will occur in a background worker that handles MQTT messages.</p>\n\n<p>Is it possible to use ActionDispatch and friends to simulate a controller dispatch in isolation?</p>\n\n<p>I'm having a hard time finding documentation on how to instantiate an <code>ActionDispatch::Request</code> object in isolation outside of RSpec.</p>\n\n<pre><code>MyController.dispatch(\"create\",\n                     ActionDispatch::Request.new({\"???\" =&gt; \"Can't find any docs on this one.\"}),\n                     ActionDispatch::Response.new(\"?\"))\n# =&gt; RuntimeError: Missing rack.input\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1528803745, "post_id": 50816217, "comment_id": 88637432, "body": "Have you tried anything?"}, {"owner": {"reputation": 173, "user_id": 4515838, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1664130014/picture?type=large", "display_name": "Yitzhak", "link": "https://stackoverflow.com/users/4515838/yitzhak"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1528804122, "post_id": 50816217, "comment_id": 88637705, "body": "I&#39;ve been staring at it for 40 minutes trying to wrap my head around how I can pass in multiple hashes to obj or dynamically chain methods based on parameters I pass into the method, but I don&#39;t even know where to begin..."}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1528804393, "post_id": 50816217, "comment_id": 88637903, "body": "It&#39;s unclear for me what you&#39;re asking."}, {"owner": {"reputation": 173, "user_id": 4515838, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1664130014/picture?type=large", "display_name": "Yitzhak", "link": "https://stackoverflow.com/users/4515838/yitzhak"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1528804604, "post_id": 50816217, "comment_id": 88638079, "body": "I&#39;m going to have about 15 different <code>.each_with_object</code> methods to count the number of instances 15 different elements exist in my database. Every single method is going to be exactly like the two above, except they will call different methods on <code>obj</code>. I was hoping for a way to write a single method <code>build_filters</code> instead of like 15"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 4515838, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1664130014/picture?type=large", "display_name": "Yitzhak", "link": "https://stackoverflow.com/users/4515838/yitzhak"}, "edited": false, "score": 0, "creation_date": 1528804916, "post_id": 50816564, "comment_id": 88638303, "body": "this didn&#39;t work, unfortunately. I like how concise it is."}, {"owner": {"reputation": 173, "user_id": 4515838, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1664130014/picture?type=large", "display_name": "Yitzhak", "link": "https://stackoverflow.com/users/4515838/yitzhak"}, "edited": false, "score": 0, "creation_date": 1528805127, "post_id": 50816564, "comment_id": 88638445, "body": "It&#39;s giving  me a type error &lt;DiveCenter...&gt; is not a symbol nor integer"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1528805303, "post_id": 50816564, "comment_id": 88638567, "body": "<code>properties.reduce(obj) { |o, m| o.public_send(m) }</code> works, though."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1528805419, "post_id": 50816564, "comment_id": 88638661, "body": "Ah, indeed. Arity 2. Thank you."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 4, "last_activity_date": 1528805370, "last_edit_date": 1528805370, "creation_date": 1528804492, "answer_id": 50816564, "question_id": 50816217, "link": "https://stackoverflow.com/questions/50816217/combine-two-each-with-object-iterators/50816564#50816564", "title": "Combine two each_with_object iterators", "body": "<pre><code>def build(*properties)\n  @dive_centers.each_with_object(Hash.new(0)) do |obj, counts|\n    index = properties.reduce(obj) { |o, m| o.public_send(m) }\n    counts[index] += 1\n  end\nend\n</code></pre>\n\n<p>And call it like:</p>\n\n<pre><code>build(:dive_center_type)\nbuild(:training_organizations, :first, :short_name)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1528804806, "post_id": 50816588, "comment_id": 88638212, "body": "LOL, it\u2019s funny how we found the exactly opposite parts to be <i>common</i>."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 6, "last_activity_date": 1528804537, "creation_date": 1528804537, "answer_id": 50816588, "question_id": 50816217, "link": "https://stackoverflow.com/questions/50816217/combine-two-each-with-object-iterators/50816588#50816588", "title": "Combine two each_with_object iterators", "body": "<p>The common part seems to be:</p>\n\n<pre><code>@dive_centers.each_with_object(Hash.new(0)) { |obj, counts| counts[...] += 1 }\n</code></pre>\n\n<p>With <code>...</code> being</p>\n\n<pre><code>obj.training_organizations.first.short_name\n</code></pre>\n\n<p>and</p>\n\n<pre><code>obj.dive_center_type\n</code></pre>\n\n<p>Both of the above depend on <code>obj</code>, so we can extract the common part into a separate method and use <code>yield</code> to fetch the key from the caller:</p>\n\n<pre><code>def count_by\n  @dive_centers.each_with_object(Hash.new(0)) { |o, h| h[yield(o)] += 1 }\nend\n</code></pre>\n\n<p>i.e. we provide the specific part by passing a block:</p>\n\n<pre><code>def build_training_organization_filters\n  count_by { |center| center.training_organizations.first.short_name }\nend\n\ndef build_dive_center_type_filters\n  count_by { |center| center.dive_center_type }\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1591736736, "last_edit_date": 1591736736, "creation_date": 1528809074, "answer_id": 50818109, "question_id": 50816217, "link": "https://stackoverflow.com/questions/50816217/combine-two-each-with-object-iterators/50818109#50818109", "title": "Combine two each_with_object iterators", "body": "<p>While this does not use <code>each_with_object</code> it seems like another viable option if you are using ruby >= 2.4. This uses <code>Enumerable#group_by</code> and <code>Hash#transform_values</code> although it does require multiple loops which is less desirable. </p>\n\n<pre><code> def count_by(*chain)\n    @dive_centers.group_by do |obj| \n      chain.reduce(obj) {|o,m| o.public_send(m)}\n    end.transform_values(&amp;:count)\n end\n</code></pre>\n\n<p>Usage</p>\n\n<pre><code>count_by(:dive_center_type)\ncount_by(:training_organizations, :first, :short_name)\n</code></pre>\n\n<p>Usage is the same as @mudasobwa's answer (mostly because signature and reduction was stolen as well.)</p>\n"}], "owner": {"reputation": 173, "user_id": 4515838, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1664130014/picture?type=large", "display_name": "Yitzhak", "link": "https://stackoverflow.com/users/4515838/yitzhak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 50816588, "answer_count": 3, "score": 0, "last_activity_date": 1591736736, "creation_date": 1528803419, "question_id": 50816217, "link": "https://stackoverflow.com/questions/50816217/combine-two-each-with-object-iterators", "title": "Combine two each_with_object iterators", "body": "<p>I have two methods doing almost exactly the same thing. I'd like to combine them into a single method to make them DRY. </p>\n\n<pre><code>  def build_training_organization_filters\n    @dive_centers.each_with_object(Hash.new(0)) { |obj, counts| counts[obj.training_organizations.first.short_name] += 1 }\n  end\n\n  def build_dive_center_type_filters\n    @dive_centers.each_with_object(Hash.new(0)) { |obj, counts| counts[obj.dive_center_type] += 1 }\n  end\n</code></pre>\n\n<p>The output is eventually going to be JSON output like this:</p>\n\n<p><code>{ training_org_filter: &lt;data&gt;, dive_center_filter: &lt;data&gt; }</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "pg"], "comments": [{"owner": {"reputation": 8162, "user_id": 1333133, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/87a3017cfedcddb87f9255dfe42fa0fd?s=128&d=identicon&r=PG", "display_name": "Satya", "link": "https://stackoverflow.com/users/1333133/satya"}, "edited": false, "score": 0, "creation_date": 1528800665, "post_id": 50815357, "comment_id": 88635440, "body": "have you added sudo before the command?"}, {"owner": {"reputation": 53, "user_id": 8922392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd819cf8e674a14ae8bcf99537a742d?s=128&d=identicon&r=PG&f=1", "display_name": "Tej Singh", "link": "https://stackoverflow.com/users/8922392/tej-singh"}, "reply_to_user": {"reputation": 8162, "user_id": 1333133, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/87a3017cfedcddb87f9255dfe42fa0fd?s=128&d=identicon&r=PG", "display_name": "Satya", "link": "https://stackoverflow.com/users/1333133/satya"}, "edited": false, "score": 0, "creation_date": 1528800831, "post_id": 50815357, "comment_id": 88635536, "body": "@Satya Yes, and I receive this message: Running Homebrew as root is extremely dangerous and no longer supported. As Homebrew does not drop privileges on installation you would be giving all build scripts full access to your system."}, {"owner": {"reputation": 4477, "user_id": 703903, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/91ffc6b42d4813fdff4f101d00181744?s=128&d=identicon&r=PG", "display_name": "odlp", "link": "https://stackoverflow.com/users/703903/odlp"}, "edited": false, "score": 0, "creation_date": 1528803521, "post_id": 50815357, "comment_id": 88637253, "body": "I&#39;d advise running <code>brew doctor</code> and if there are any permission issues you can fix. Also this answer may be helpful: <a href=\"https://stackoverflow.com/a/26647594/703903\">stackoverflow.com/a/26647594/703903</a>"}], "owner": {"reputation": 53, "user_id": 8922392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd819cf8e674a14ae8bcf99537a742d?s=128&d=identicon&r=PG&f=1", "display_name": "Tej Singh", "link": "https://stackoverflow.com/users/8922392/tej-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528800785, "creation_date": 1528800575, "last_edit_date": 1528800785, "question_id": 50815357, "link": "https://stackoverflow.com/questions/50815357/postgresql-10-4-is-already-installed-its-just-not-linked", "title": "Postgresql 10.4 is already installed, it&#39;s just not linked", "body": "<p>When I run bundle install when installing gems, I receive this:</p>\n\n<p>Could not find gem 'pg (&lt; 2.0, >= 0.18)' in any of the gem sources listed in your Gemfile.</p>\n\n<p>I used brew install postgresl, a common solution on the web, and receive this:</p>\n\n<p>postgresql 10.4 is already installed, it's just not linked. You can use brew link postgresql to link this version.</p>\n\n<p>I run the link command provided by the terminal, and receive this:</p>\n\n<p>Linking /usr/local/Cellar/postgresql/10.4...</p>\n\n<p>Error: Could not symlink share/man/man7/ABORT.7 /usr/local/share/man/man7 is not writable.</p>\n\n<p>Any help diagnosing and fixing this issue would be appreciated.</p>\n"}, {"tags": ["ruby", "fizzbuzz"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1528800045, "post_id": 50815043, "comment_id": 88635092, "body": "What is &quot;an array of integers, &#39;Fizz&#39;, &#39;Buzz&#39; or &#39;FizzBuzz&#39;&quot;? It does not make sense."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1528800059, "post_id": 50815043, "comment_id": 88635098, "body": "Both of them work and produce the correct FizzBuzz problem output. What exactly fails? The question is confusingly confusing. What version is wrong, why is it wrong, is there an error, what is Rubocop&#39;s complaint, what did you do about it, and what seems to be the problem? &quot;My solution with style fails but if I use &quot;.zero?&quot; it fails&quot; fails to communicate the issue."}, {"owner": {"reputation": 46, "user_id": 9929719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29afb8286542c1f2bae48faf79208f1d?s=128&d=identicon&r=PG&f=1", "display_name": "Grr La", "link": "https://stackoverflow.com/users/9929719/grr-la"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1528803299, "post_id": 50815043, "comment_id": 88637105, "body": "@Amadan Criticism accepted and noted. I hope it is more readable now. It was my first post."}, {"owner": {"reputation": 46, "user_id": 9929719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29afb8286542c1f2bae48faf79208f1d?s=128&d=identicon&r=PG&f=1", "display_name": "Grr La", "link": "https://stackoverflow.com/users/9929719/grr-la"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1528803347, "post_id": 50815043, "comment_id": 88637136, "body": "@sawa Elaborated on the TODO of the exercise. I hope it adds clarity. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 9929719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29afb8286542c1f2bae48faf79208f1d?s=128&d=identicon&r=PG&f=1", "display_name": "Grr La", "link": "https://stackoverflow.com/users/9929719/grr-la"}, "edited": false, "score": 0, "creation_date": 1528804232, "post_id": 50816385, "comment_id": 88637775, "body": "I get it now. Thanks for your clarity and speed. Answer accepted and upvoted. You are no fool ;) &quot;Thanks for the feedback! Votes cast by those with less than 15 reputation are recorded, but do not change the publicly displayed post score.&quot;"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 46, "user_id": 9929719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29afb8286542c1f2bae48faf79208f1d?s=128&d=identicon&r=PG&f=1", "display_name": "Grr La", "link": "https://stackoverflow.com/users/9929719/grr-la"}, "edited": false, "score": 0, "creation_date": 1528804440, "post_id": 50816385, "comment_id": 88637943, "body": "Fools can only learn; when you think you know something, you stop learning. It&#39;s a good reminder. Good on you, most people just think I misspelled Amanda. :P And don&#39;t worry about my score, I&#39;ll live :)"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 46, "user_id": 9929719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29afb8286542c1f2bae48faf79208f1d?s=128&d=identicon&r=PG&f=1", "display_name": "Grr La", "link": "https://stackoverflow.com/users/9929719/grr-la"}, "edited": false, "score": 0, "creation_date": 1528814592, "post_id": 50816385, "comment_id": 88645089, "body": "Just remembered, I should say, there&#39;s much cooler ways to get sequential numbers into an array in Ruby than prepending them in a <code>while</code> loop; for example, <code>(1..number).map {...}</code> is short and sweet."}, {"owner": {"reputation": 46, "user_id": 9929719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29afb8286542c1f2bae48faf79208f1d?s=128&d=identicon&r=PG&f=1", "display_name": "Grr La", "link": "https://stackoverflow.com/users/9929719/grr-la"}, "edited": false, "score": 0, "creation_date": 1528814818, "post_id": 50816385, "comment_id": 88645249, "body": "Thanks. I had seen that in the given solution when I was refactoring (see the last paragraph in the question where it is given). There is nothing further to refactor than that is there?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 46, "user_id": 9929719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29afb8286542c1f2bae48faf79208f1d?s=128&d=identicon&r=PG&f=1", "display_name": "Grr La", "link": "https://stackoverflow.com/users/9929719/grr-la"}, "edited": false, "score": 0, "creation_date": 1528814978, "post_id": 50816385, "comment_id": 88645338, "body": "Err, I&#39;m blind tonight. Of course, it&#39;s right there. The only other thing I can think of is that <code>(i % 3).zero? &amp;&amp; (i % 5).zero?</code> is equivalent to <code>(x % 15).zero?</code>, but you have that as well. The former is a tad slower and a tad clearer. So, nope, that&#39;s pretty much perfect."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 1, "last_activity_date": 1528804566, "last_edit_date": 1528804566, "creation_date": 1528803959, "answer_id": 50816385, "question_id": 50815043, "link": "https://stackoverflow.com/questions/50815043/method-fail-when-i-follow-ruby-rubocop-style-guide-and-use-zero-instead-of/50816385#50816385", "title": "Method fail when I follow Ruby rubocop style guide and use .zero? instead of == 0", "body": "<p>Now that we see the failing code, here's why it fails:</p>\n\n<p>You have an array <code>a</code> which I suppose you intended to contain the results. You prepend the numbers to it, and fix the numbers that need to say \"Fizz\" or \"Buzz\" or \"FizzBuzz\". This would work, but for one critical failure: you process the array <em>in every iteration of the loop</em>. If you just fixed it once, just before you return it, it would have been fine. However, this way, what happens is (e.g. for input value <code>4</code>):</p>\n\n<ul>\n<li>You start your array with <code>4</code></li>\n<li>You run the fixes, but <code>4</code> is good, does not need fixing</li>\n<li>You prepend <code>3</code></li>\n<li>You run the fixes; the array is now <code>[\"Fizz\", 4]</code>. So far so good.</li>\n<li>You prepend <code>2</code>; the array is <code>[2, \"Fizz\", 4]</code></li>\n<li>You run the fixes. <code>2</code> passes with no intervention, then it's <code>\"Fizz\"</code>'s turn.</li>\n<li><code>\"Fizz\"</code> is not a number, so you don't invoke <code>Number#%</code>, the remainder operator, but <code>String#%</code>, the formatting operator. There's no format sigils in the string <code>\"Fizz\"</code>, so the formatting operator does nothing interesting and returns the string <code>\"Fizz\"</code>.</li>\n<li>Then you test if it's zero. When you tried <code>\"Fizz\" == 0</code>, it would have been \"Duh, no\" and just returned <code>false</code>, since all classes (starting with <code>BasicObject</code>) define <code>#==</code>. But <code>\"Fizz\".zero?</code> fails, because unlike <code>Number#zero?</code>, <code>String#zero?</code> is not a thing.</li>\n</ul>\n"}], "owner": {"reputation": 46, "user_id": 9929719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29afb8286542c1f2bae48faf79208f1d?s=128&d=identicon&r=PG&f=1", "display_name": "Grr La", "link": "https://stackoverflow.com/users/9929719/grr-la"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "accepted_answer_id": 50816385, "answer_count": 1, "score": -3, "last_activity_date": 1581780881, "creation_date": 1528799573, "last_edit_date": 1581780881, "question_id": 50815043, "link": "https://stackoverflow.com/questions/50815043/method-fail-when-i-follow-ruby-rubocop-style-guide-and-use-zero-instead-of", "title": "Method fail when I follow Ruby rubocop style guide and use .zero? instead of == 0", "body": "<p>I am trying to complete a coding exercise in Ruby, which is as follows:</p>\n\n<blockquote>\n  <p>TODO: starting with an array of integers, return an array with integers and 'Fizz', 'Buzz' or 'FizzBuzz' </p>\n  \n  <p>Write a method <code>fizz_buzz</code>, which takes a <code>number</code> as an argument, and return\n  an array of <code>number</code> elements from 1 to <code>number</code>, but replaces some of\n  them according to these rules:</p>\n  \n  <ul>\n  <li>If the number is divisible by <code>3</code>, then replace it by <code>'Fizz'</code></li>\n  <li>If the number is divisible by <code>5</code>, then replace it by <code>'Buzz'</code></li>\n  <li>If the number is divisible by both <code>3</code> and <code>5</code>, then replace it by <code>'FizzBuzz'</code>Write</li>\n  </ul>\n</blockquote>\n\n<p>If I follow a <code>rubocop style guide</code>, which we have been asked to use after completed the task, and, as instructed, use <code>.zero</code> instead of <code>== 0?</code> my method fails and I don't get why.</p>\n\n<p>My now failing solution with the edits required by my style guide: </p>\n\n<pre><code>def fizz_buzz(number)\n  fail ArgumentError, \"#{number} is less than 1\" if number &lt; 1\n  a = [number]\n  while number &gt; 1\n    number = number - 1\n    a.unshift(number)\n    a.map! { |x| (x % 15).zero? ? 'FizzBuzz' : x }\n    a.map! { |x| (x % 3).zero? ? 'Fizz' : x }\n    a.map! { |x| (x % 5).zero? ? 'Buzz' : x }\n  end\n  a\nend\n\n  should return the array [ 1, 2, 'Fizz' ] for number 3 (FAILED - 1)\n  should return the array [ 1, 2, 'Fizz', 4, 'Buzz', 'Fizz', 7 ] for number 7 (FAILED - 2)\n  should return an array with 'FizzBuzz' at the 15th element of the array (15 is divisible by both 3 and 5) (FAILED - 3)\n</code></pre>\n\n<p>Failures:</p>\n\n<pre><code>  1) fizz_buzz should return the array [ 1, 2, 'Fizz' ] for number 3\n     Failure/Error: a.map! { |x| (x % 5).zero? ? 'Buzz' : x }\n\n NoMethodError:\n   undefined method `zero?' for \"Fizz\":String\n # ./lib/fizz_buzz.rb:12:in `block in fizz_buzz'\n # ./lib/fizz_buzz.rb:12:in `map!'\n # ./lib/fizz_buzz.rb:12:in `fizz_buzz'\n # ./spec/fizz_buzz_spec.rb:13:in `block (2 levels) in &lt;top (required)&gt;'\n\n  2) fizz_buzz should return the array [ 1, 2, 'Fizz', 4, 'Buzz', 'Fizz', 7 ] for number 7\n     Failure/Error: a.map! { |x| (x % 5).zero? ? 'Buzz' : x }\n\n NoMethodError:\n   undefined method `zero?' for \"Fizz\":String\n # ./lib/fizz_buzz.rb:12:in `block in fizz_buzz'\n # ./lib/fizz_buzz.rb:12:in `map!'\n # ./lib/fizz_buzz.rb:12:in `fizz_buzz'\n # ./spec/fizz_buzz_spec.rb:17:in `block (2 levels) in &lt;top (required)&gt;'\n\n  3) fizz_buzz should return an array with 'FizzBuzz' at the 15th element of the array (15 is divisible by both 3 and 5)\n     Failure/Error: a.map! { |x| (x % 5).zero? ? 'Buzz' : x }\n\n NoMethodError:\n   undefined method `zero?' for \"Fizz\":String\n # ./lib/fizz_buzz.rb:12:in `block in fizz_buzz'\n # ./lib/fizz_buzz.rb:12:in `map!'\n # ./lib/fizz_buzz.rb:12:in `fizz_buzz'\n # ./spec/fizz_buzz_spec.rb:21:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>My working solution which fails the style guide:</p>\n\n<pre><code>def fizz_buzz(number)\n  fail ArgumentError, \"#{number} is less than 1\" if number &lt; 1\n  a = [number]\n  while number &gt; 1\n    number = number - 1\n    a.unshift(number)\n    a.map! { |x| (x % 15) == 0 ? 'FizzBuzz' : x }\n    a.map! { |x| (x % 3) == 0 ? 'Fizz' : x }\n    a.map! { |x| (x % 5) == 0 ? 'Buzz' : x }\n  end\n  a\nend\n</code></pre>\n\n<p>Solution supplied with the task assigned:</p>\n\n<pre><code># def fizz_buzz(number)\n#   fail ArgumentError, \"#{number} should be greater than 1\" if number &lt; 1\n#   (1..number).map do |i|\n#     if (i % 3).zero? &amp;&amp; (i % 5).zero?\n#       'FizzBuzz'\n#     elsif (i % 3).zero?\n#       'Fizz'\n#     elsif (i % 5).zero?\n#       'Buzz'\n#     else\n#       i\n#     end\n#   end\n# end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails"], "answers": [{"tags": [], "owner": {"reputation": 1578, "user_id": 522897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7bad61c729086a40e92e6d2bcd70a4e?s=128&d=identicon&r=PG", "display_name": "Onur Kucukkece", "link": "https://stackoverflow.com/users/522897/onur-kucukkece"}, "is_accepted": false, "score": 0, "last_activity_date": 1528798463, "creation_date": 1528798463, "answer_id": 50814674, "question_id": 50814540, "link": "https://stackoverflow.com/questions/50814540/how-to-initialize-general-context-variables-before-testing-any-methods-within-a/50814674#50814674", "title": "How to initialize general context variables before testing any methods within a class with rspec", "body": "<p>Try this way</p>\n\n<pre><code>RSpec.describe MyService do\n  describe \"#create_from_order\" do\n    let(:product){create(:product)}\n    let(:article_student){ create(:article, targets: [:student], vat_type: vat_type, product: product)} #target student\n    let(:article_teacher){ create(:article, targets: [:teacher], vat_type: vat_type, product: product) }#target teacher\n    # creer des offres\n    let(:offer){create(:offer, target: :student, license_length: :m12)}\n    let(:offer_special_cyclic){create(:offer_special, cyclic_amount: true, free_article_id: article_teacher.id, minimum_amount: 10, license_length: :m12)} # free article @article_teacher\n    let(:offer_special_non_cyclic){create(:offer_special, cyclic_amount: false, free_article_id: article_teacher.id, minimum_amount: 10, license_length: :m12)} # free article @article_teacher\n    let(:order){ create(:order, establishment_account: establishment_account)}\n\n    context \"first time worker runs\" do\n      order.already_went_through_license_worker = false\n      order.save!\n      LicenseService.new.create_from_order(@order.id)\n      let(:licenses){ License.where(order_id: @order.id)}\n      specify { subject.count.to eq 34 }\n      specify { subject.pluck(:is_from_offer_special).count(true).to eq 4}\n      specify { subject.pluck(:is_from_offer_special).count(false).to eq 30 }\n    end\n  end\nend\n</code></pre>\n\n<p>Also <code>let</code> method is being run if only the objects is called. If you want it to be run no matter what, you should use <code>let!</code> method.</p>\n\n<p>Hope it helps</p>\n"}, {"comments": [{"owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "edited": false, "score": 0, "creation_date": 1528801262, "post_id": 50814940, "comment_id": 88635782, "body": "that made it work, apparently you cannot modify the variable you create with let! after they are created... I tried to writte <code>product.owner == &quot;someone&quot; </code> after <code>let!(:product){create(:product)}</code> but that throws an error : <code>product` is not available on an example group (e.g. a `describe` or `context` block)</code>. Do you know any way to bypass that ?"}, {"owner": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "reply_to_user": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "edited": false, "score": 0, "creation_date": 1528802019, "post_id": 50814940, "comment_id": 88636287, "body": "Checkout this summary: <a href=\"https://robots.thoughtbot.com/four-phase-test\" rel=\"nofollow noreferrer\">robots.thoughtbot.com/four-phase-test</a>, most importantly the example at the bottom of the page. That should be the preferred way to set up a test, since you can use <code>let(:user)</code> to define an object, and then modify it within the example. Another good example can be found here: <a href=\"https://robots.thoughtbot.com/how-we-test-rails-applications#model-specs\" rel=\"nofollow noreferrer\">robots.thoughtbot.com/&hellip;</a>"}, {"owner": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "reply_to_user": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "edited": false, "score": 0, "creation_date": 1528802072, "post_id": 50814940, "comment_id": 88636317, "body": "As a rule of thumb, you cannot interact with variables in <code>context</code> or <code>describe</code> blocks, only within an example (<code>it</code>)."}], "tags": [], "owner": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "is_accepted": true, "score": 0, "last_activity_date": 1528799292, "creation_date": 1528799292, "answer_id": 50814940, "question_id": 50814540, "link": "https://stackoverflow.com/questions/50814540/how-to-initialize-general-context-variables-before-testing-any-methods-within-a/50814940#50814940", "title": "How to initialize general context variables before testing any methods within a class with rspec", "body": "<p>First, move your <code>let</code> statements out of the <code>before</code> block. <code>let</code> is lazily evaluated, which means the blocks you define (<code>let(:foo) { block }</code>) is only executed when <code>foo</code> is called. But by wrapping the statements in a <code>before</code> block, you are not actually calling them, so nothing will happen.</p>\n\n<p>To execute the statements before each test, use <code>let!</code>. This is not lazily evaluated, and gets executed as soon as you define the statement, which is what you want in this case.</p>\n\n<pre><code>RSpec.describe MyService do\n  let!(:product){create(:product)}\n  let!(:article_student){ create(:article, targets: [:student], vat_type: vat_type, product: product)} #target student\n  let!(:article_teacher){ create(:article, targets: [:teacher], vat_type: vat_type, product: product) } #target teacher\n  # creer des offres\n  let!(:offer){create(:offer, target: :student, license_length: :m12)}\n  let!(:offer_special_cyclic){create(:offer_special, cyclic_amount: true, free_article_id: article_teacher.id, minimum_amount: 10, license_length: :m12)} # free article @article_teacher\n  let!(:offer_special_non_cyclic){create(:offer_special, cyclic_amount: false, free_article_id: article_teacher.id, minimum_amount: 10, license_length: :m12)} # free article @article_teacher\n  let!(:order){ create(:order, establishment_account: establishment_account)}\nend\n</code></pre>\n\n<p>Now, to modify the objects, use a <code>before</code> block within the context. And make sure you are not mixing <code>order</code> and <code>@order</code>.</p>\n\n<pre><code>context \"first time worker runs\" do\n  before do\n    order.already_went_through_license_worker = false\n    order.save!\n    LicenseService.new.create_from_order(order.id)\n  end\n\n  let(:licenses){ License.where(order_id: order.id)}\n\n  specify { subject.count.to eq 34 }\n  specify { subject.pluck(:is_from_offer_special).count(true).to eq 4}\n  specify { subject.pluck(:is_from_offer_special).count(false).to eq 30 }\nend\n</code></pre>\n\n<p>That should solve your issue.</p>\n"}], "owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1455, "favorite_count": 0, "accepted_answer_id": 50814940, "answer_count": 2, "score": 0, "last_activity_date": 1528799292, "creation_date": 1528798083, "question_id": 50814540, "link": "https://stackoverflow.com/questions/50814540/how-to-initialize-general-context-variables-before-testing-any-methods-within-a", "title": "How to initialize general context variables before testing any methods within a class with rspec", "body": "<p>I am new to rspec. I am writting a test for a service class and I would like a bunch of instances to be initialized before I run in any of the describe block.\nI do something like :</p>\n\n<pre><code>RSpec.describe MyService do\nbefore :each do\n\n    let(:product){create(:product)}\n    let(:article_student){ create(:article, targets: [:student], vat_type: vat_type, product: product)} #target student\n    let(:article_teacher){ create(:article, targets: [:teacher], vat_type: vat_type, product: product) }#target teacher\n    # creer des offres\n    let(:offer){create(:offer, target: :student, license_length: :m12)}\n    let(:offer_special_cyclic){create(:offer_special, cyclic_amount: true, free_article_id: article_teacher.id, minimum_amount: 10, license_length: :m12)} # free article @article_teacher\n    let(:offer_special_non_cyclic){create(:offer_special, cyclic_amount: false, free_article_id: article_teacher.id, minimum_amount: 10, license_length: :m12)} # free article @article_teacher\n    let(:order){ create(:order, establishment_account: establis\n\nhment_account)}\nend\n</code></pre>\n\n<p>then I will have several describe block (testing the different methods in MyService and I would like in each of them to modify the previously created variables in my before :each block.\nFor instance :</p>\n\n<pre><code>  describe \"#create_from_order\" do\n    subject{ licenses }\n    context \"first time worker runs\" do\n      order.already_went_through_license_worker = false\n      order.save!\n      LicenseService.new.create_from_order(@order.id)\n      let(:licenses){ License.where(order_id: @order.id)}\n      specify { subject.count.to eq 34 }\n      specify { subject.pluck(:is_from_offer_special).count(true).to eq 4}\n      specify { subject.pluck(:is_from_offer_special).count(false).to eq 30 }\nend\nend\n</code></pre>\n\n<p>However when I try to run my test I get that the <code>order</code> inside my <code>context</code> block is not defined...</p>\n\n<pre><code>undefined local variable or method `order' for #&lt;Class:0x007fc689ddfdb8&gt;\n</code></pre>\n\n<p>Im realising my before :each code is never entered. What is the good way to achieve this, that is initialize a bunch of instance variable general context before testing any methods within the class.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "edited": false, "score": 0, "creation_date": 1528793015, "post_id": 50812777, "comment_id": 88774592, "body": "There is an <i>almost</i> standard gem in order to manage sorted records: <a href=\"https://github.com/swanandp/acts_as_list\" rel=\"nofollow noreferrer\">github.com/swanandp/acts_as_list</a> Otherwise you could add a <code>position</code> column and manage it manually"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 2316010, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/364734f05343abeb08d82e0e348cd88b?s=128&d=identicon&r=PG&f=1", "display_name": "ruby24", "link": "https://stackoverflow.com/users/2316010/ruby24"}, "edited": false, "score": 1, "creation_date": 1528796241, "post_id": 50812882, "comment_id": 88632739, "body": "Amazing, thanks! Was a bit wary of adding dependencies early on, didn&#39;t know acts_as_list was as &quot;standard&quot;."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 189, "user_id": 2316010, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/364734f05343abeb08d82e0e348cd88b?s=128&d=identicon&r=PG&f=1", "display_name": "ruby24", "link": "https://stackoverflow.com/users/2316010/ruby24"}, "edited": false, "score": 1, "creation_date": 1528797600, "post_id": 50812882, "comment_id": 88633643, "body": "You&#39;re welcome, happy to help - I remember having the same dilemma, and coming across a number of edge cases and performance problems when going it alone. Hope this works out well!"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 1, "last_activity_date": 1528793074, "creation_date": 1528793074, "answer_id": 50812882, "question_id": 50812777, "link": "https://stackoverflow.com/questions/50812777/rails-how-to-store-custom-order-rank-of-associations-postgres/50812882#50812882", "title": "Rails: How to store custom order / rank of associations (postgres)", "body": "<p>Personally, I'd recommend using <a href=\"https://github.com/swanandp/acts_as_list\" rel=\"nofollow noreferrer\"><code>acts_as_list</code></a> - it makes reordering a breeze. It doesn't seem like overkill here, rather the correct scenario for it :) </p>\n\n<p>You can then add a default order to the <code>Question</code> model, using: <code>default_scope { order(:rank_id) }</code>. This will ensure your questions are retrieved in the order expected.</p>\n\n<p>The gem itself actually recommends adding the <code>order</code> directly to the association:</p>\n\n<pre><code>has_many :todo_items, -&gt; { order(position: :asc) }\n</code></pre>\n\n<p>It also defaults to using a column named <code>position</code> instead of <code>rank_id</code>, though you can overwrite this. In your case, in the <code>Question</code> model:</p>\n\n<pre><code>acts_as_list scope: :survey, column: :rank_id\n</code></pre>\n\n<p>And in the <code>Survey</code> model:</p>\n\n<pre><code> has_many :questions, -&gt; { order(rank_id: :asc) }\n</code></pre>\n\n<p>Happy to expand on any of that if you need - let me know.</p>\n"}], "owner": {"reputation": 189, "user_id": 2316010, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/364734f05343abeb08d82e0e348cd88b?s=128&d=identicon&r=PG&f=1", "display_name": "ruby24", "link": "https://stackoverflow.com/users/2316010/ruby24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 50812882, "answer_count": 1, "score": 0, "last_activity_date": 1528793074, "creation_date": 1528792747, "question_id": 50812777, "link": "https://stackoverflow.com/questions/50812777/rails-how-to-store-custom-order-rank-of-associations-postgres", "title": "Rails: How to store custom order / rank of associations (postgres)", "body": "<p>Rails newbie having a question about storing the order of associations. Background is I'm thinking about building a super simple survey app for learning purposes. The idea is to have multiple surveys and corresponding questions.</p>\n\n<p>Models are straightforward:</p>\n\n<pre><code>class Survey\n  has_many :questions\nend\n\nclass Question\n  belongs_to :survey\nend\n</code></pre>\n\n<p>My question now - where and how would you store the custom order / sequence of the questions in the survey? Questions may be moved around, added and removed and should retain answers from survey responses.</p>\n\n<p>I was thinking about introducing a \"rank_id\" (inside the question or survey model?), or some kind of new question_list model (<code>survey has_one :question_list, has_many :questions through :question_list</code>). But even with the question_list model, I don't really know how to retain order. Googling led me to <a href=\"https://stackoverflow.com/questions/7721163/saving-the-order-of-associated-records-in-a-rails-has-many-through-association\">Saving the order of associated records in a Rails has_many :through association\n</a> and it recommends the <a href=\"https://github.com/swanandp/acts_as_list\" rel=\"nofollow noreferrer\">acts_as_list gem</a>, but that seems like too much for this use case?</p>\n\n<p>Thanks in advance for any suggestions!</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "rails-activestorage"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 2668629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92f0967bc7d24adabc35a73b9b817e1c?s=128&d=identicon&r=PG", "display_name": "Correlator", "link": "https://stackoverflow.com/users/2668629/correlator"}, "edited": false, "score": 0, "creation_date": 1579899783, "post_id": 50871528, "comment_id": 105934262, "body": "This will error if you serve images with webpacker as the default value will need to be served with an <code>image_pack_tag</code> rather than an <code>image_tag</code>"}], "tags": [], "owner": {"reputation": 2735, "user_id": 7006199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFqCJ.jpg?s=128&g=1", "display_name": "Nimish Gupta", "link": "https://stackoverflow.com/users/7006199/nimish-gupta"}, "is_accepted": true, "score": 9, "last_activity_date": 1529050192, "creation_date": 1529050192, "answer_id": 50871528, "question_id": 50811749, "link": "https://stackoverflow.com/questions/50811749/how-to-add-a-default-attachment-in-rails-activestorage/50871528#50871528", "title": "How to add a default attachment in rails Activestorage", "body": "<p>If you want to attach a default image to post if one is not present then you can do this in a callback</p>\n\n<pre><code># 1. Save a default image in Rails.root.join(\"app\", \"assets\", \"images\", \"default.jpeg\")\n\n# 2. In post.rb\n\nafter_commit :add_default_cover, on: [:create, :update]\n\n\nprivate def add_default_cover\n  unless cover.attached?\n    self.cover.attach(io: File.open(Rails.root.join(\"app\", \"assets\", \"images\", \"default.jpeg\")), filename: 'default.jpg' , content_type: \"image/jpg\")\n  end\nend\n\n# 3. And in your view \n&lt;%= image_tag(@post.cover, class: 'card-img-top img-fluid') %&gt;\n</code></pre>\n\n<p>Or, If you don't want to attach the default cover to post but still want to show a image on post's show page</p>\n\n<pre><code># 1. Save a default image in Rails.root.join(\"app\", \"assets\", \"images\", \"default.jpeg\")\n\n# 2. In post.rb\n\ndef cover_attachment_path\n  cover.attached? ? cover : 'default.jpeg'\nend\n\n# 3. And in your view\n&lt;%= image_tag(@post.cover_attachment_path, class: 'card-img-top img-fluid') %&gt;\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 8138553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H157qx2xlSI/AAAAAAAAAAI/AAAAAAAAACU/vF_Dw33EIZc/photo.jpg?sz=128", "display_name": "Nijeesh K J", "link": "https://stackoverflow.com/users/8138553/nijeesh-k-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1949, "favorite_count": 1, "accepted_answer_id": 50871528, "answer_count": 1, "score": 5, "last_activity_date": 1529306348, "creation_date": 1528789220, "last_edit_date": 1529306348, "question_id": 50811749, "link": "https://stackoverflow.com/questions/50811749/how-to-add-a-default-attachment-in-rails-activestorage", "title": "How to add a default attachment in rails Activestorage", "body": "<p>I have a model <code>Post</code> with</p>\n\n<pre><code>has_one_attached :cover\n</code></pre>\n\n<p>Having an attachment is not necessary.\nSo, is there any way that I can add a default attachment even if the user doesn't provide one.</p>\n\n<p>So, when the post is displayed there is a cover image I can show.</p>\n\n<pre><code>&lt;% if @post.cover.attached? %&gt;\n    &lt;%= image_tag(@post.cover, class: 'card-img-top img-fluid') %&gt;\n&lt;% else %&gt;\n    &lt;div class=\"text-align-center img-place-holder\"&gt;\n          No Image Added Please add One\n   &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Is there any way other than checking if something is attached and trying to resolve it like this.</p>\n\n<p>So, I could use,</p>\n\n<pre><code>&lt;%= image_tag(@post.cover, class: 'card-img-top img-fluid') %&gt;\n</code></pre>\n\n<p>directly without any if condition</p>\n\n<p>thank you</p>\n"}, {"tags": ["ruby", "rubygems", "ubuntu-16.04", "em-websocket"], "comments": [{"owner": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "edited": false, "score": 0, "creation_date": 1528852269, "post_id": 50811681, "comment_id": 88660154, "body": "Do you have <code>build-essentials</code> installed? <code>sudo apt-get install build-essential</code>"}, {"owner": {"reputation": 1, "user_id": 2189425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/947ad002532359b9af3e5225fb2c8283?s=128&d=identicon&r=PG", "display_name": "indrajit guha", "link": "https://stackoverflow.com/users/2189425/indrajit-guha"}, "reply_to_user": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "edited": false, "score": 0, "creation_date": 1528870504, "post_id": 50811681, "comment_id": 88664580, "body": "i did that already. i think it is trying to compile with gcc instead of g++.but dont know how to resolve."}, {"owner": {"reputation": 1, "user_id": 2189425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/947ad002532359b9af3e5225fb2c8283?s=128&d=identicon&r=PG", "display_name": "indrajit guha", "link": "https://stackoverflow.com/users/2189425/indrajit-guha"}, "reply_to_user": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "edited": false, "score": 0, "creation_date": 1528872236, "post_id": 50811681, "comment_id": 88665409, "body": "I have tried to copy all the cpp header in the cpp files itself.but still it persist."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2189425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/947ad002532359b9af3e5225fb2c8283?s=128&d=identicon&r=PG", "display_name": "indrajit guha", "link": "https://stackoverflow.com/users/2189425/indrajit-guha"}, "is_accepted": false, "score": 0, "last_activity_date": 1528906014, "creation_date": 1528906014, "answer_id": 50841717, "question_id": 50811681, "link": "https://stackoverflow.com/questions/50811681/unable-to-install-ruby-em-websocket-giving-fatal-error-in-ubuntu-16-04/50841717#50841717", "title": "unable to install ruby em-websocket: giving fatal error in Ubuntu 16.04", "body": "<p>iostream was introduced in libstc++-6.Installing libstdc++6-4.4-dev by <code>sudo apt-get install libstdc++6-4.4-dev</code>. it will delete currently installed g++.Then run <code>sudo apt-get install g++</code>.This solved my problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 2189425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/947ad002532359b9af3e5225fb2c8283?s=128&d=identicon&r=PG", "display_name": "indrajit guha", "link": "https://stackoverflow.com/users/2189425/indrajit-guha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1528906014, "creation_date": 1528789008, "last_edit_date": 1528791666, "question_id": 50811681, "link": "https://stackoverflow.com/questions/50811681/unable-to-install-ruby-em-websocket-giving-fatal-error-in-ubuntu-16-04", "title": "unable to install ruby em-websocket: giving fatal error in Ubuntu 16.04", "body": "<p>websocket via <code>gem install em-websocket</code>. Got this error:</p>\n\n<pre><code>compiling binder.cpp\ncc1plus: warning: command line option \u2018-Wimplicit-int\u2019 is valid for C/ObjC but not for C++\ncc1plus: warning: command line option \u2018-Wdeclaration-after-statement\u2019 is valid for C/ObjC but not for C++\ncc1plus: warning: command line option \u2018-Wimplicit-function-declaration\u2019 is valid for C/ObjC but not for C++\nIn file included from binder.cpp:20:0:\nproject.h:25:20: fatal error: iostream: No such file or directory\ncompilation terminated.\nMakefile:233: recipe for target 'binder.o' failed\nmake: *** [binder.o] Error 1\nmake failed, exit code 2\n...\n</code></pre>\n\n<p>How to deal with this?</p>\n"}, {"tags": ["ruby", "zip"], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 5804032, "user_type": "registered", "profile_image": "https://graph.facebook.com/1086758154668612/picture?type=large", "display_name": "Junsuk Park", "link": "https://stackoverflow.com/users/5804032/junsuk-park"}, "is_accepted": true, "score": 0, "last_activity_date": 1528790554, "creation_date": 1528790554, "answer_id": 50812116, "question_id": 50811539, "link": "https://stackoverflow.com/questions/50811539/collect-all-the-zip-files-having-same-name-and-zip-it-again-ruby/50812116#50812116", "title": "Collect all the zip files having same name and zip it again Ruby", "body": "<p><br><br>\nI think you miss filename when <code>zip.add(fileName, logFolder)</code>\n<br><br></p>\n\n<p>Correct:\n<code>zip.add(fileName, File.join(logFolder, fileName))</code></p>\n\n<p>Happy Coding! :)</p>\n"}], "owner": {"reputation": 153, "user_id": 5129887, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/41d94c75c838dde47111f2430741a337?s=128&d=identicon&r=PG&f=1", "display_name": "anjali rai", "link": "https://stackoverflow.com/users/5129887/anjali-rai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 50812116, "answer_count": 1, "score": 0, "last_activity_date": 1528790554, "creation_date": 1528788521, "question_id": 50811539, "link": "https://stackoverflow.com/questions/50811539/collect-all-the-zip-files-having-same-name-and-zip-it-again-ruby", "title": "Collect all the zip files having same name and zip it again Ruby", "body": "<p>I have a directory which contains multiple logs for same script with timestamp. I want to collect all the zip files and make a new zip.</p>\n\n<pre><code>Directory Structure:\nTest_1_Run_Logs_06-12-2018_10_15_35.zip\nTest_1_Integration_Logs_06-12-2018_10_15_35.zip\nTest_1_Interface_Logs_06-12-2018_10_15_35.zip\nTest_2_Run_Logs_06-12-2018_10_30_35.zip\nTest_2_Integration_Logs_06-12-2018_10_30_35.zip\nTest_2_Interface_Logs_06-12-2018_10_30_35.zip\n</code></pre>\n\n<p>I have separated all the files having same name. The zip file is not moving all the zip files. How to do it in ruby</p>\n\n<pre><code>Code\nrequire 'fileUtils'\nrequire 'zip'\nscriptNameArr = []\nlogFolder = 'C:/Users/Desktop/logs/'\ncopyFolder = \"C:/Users/admin/Desktop/Test/Ruby Test/copyFolder/\"\n\n# Collect all the files present in logFolder separating by timestamp\nDir.entries(\"#{logFolder}/\").each do |fName|\n    unless (File.directory? \"#{logFolder}#{fName}\")\n         scriptNameArr &lt;&lt; fName.split(\"/\").last.split(/_\\d+-\\d+-/)[0]\n    end\nend\nscriptNameArr.uniq!\n\n# Create a new zip into copy \nscriptNameArr.each do |scriptName|\n    zipName = \"#{copyFolder}#{scriptName}.zip\"\n    Dir.mkdir(copyFolder) unless (Dir.exist?(copyFolder))\n    FileUtils.rm(zipName) if File.exist? (zipName)\n    Zip::File.open(zipName, Zip::File::CREATE) do |zip|\n         Dir.glob(\"#{logFolder}#{scriptName}*\") { |file|\n             fileName = file.split(\"/\").last\n             zip.add(fileName, logFolder)\n         }\n    end\nend\n</code></pre>\n\n<p>It is creating empty zip everytime. What should i do to copy the zip file and paste in new location?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "exception"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 2, "creation_date": 1528787272, "post_id": 50811055, "comment_id": 88627626, "body": "First of all, <a href=\"https://stackoverflow.com/questions/10048173/why-is-it-bad-style-to-rescue-exception-e-in-ruby\">don&#39;t rescue <code>Exception</code></a>. Second, do you have <code>begin</code> keyword in <code>create_user_role</code> method, or not?"}, {"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1528787325, "post_id": 50811055, "comment_id": 88627658, "body": "I used <code>Exception</code> only because of testing. Now the <code>begin</code> keyword is not used, but I tried it with the keyword and result was the same."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1528787395, "post_id": 50811055, "comment_id": 88627692, "body": "You will probably need to show the whole <code>create_user_role</code> method."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 2, "creation_date": 1528787421, "post_id": 50811055, "comment_id": 88627705, "body": "@MarekLipka i don&#39;t think the <code>begin</code> is needed here, e.g. <code>def foo; rescue; end</code> works fine. Also, Jan, I don&#39;t see why you&#39;re getting this behavior. Yes, please show the whole method."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1528787467, "post_id": 50811055, "comment_id": 88627725, "body": "@maxpleaner I didn&#39;t say it&#39;s needed, I asked if there is one."}, {"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1528787607, "post_id": 50811055, "comment_id": 88627802, "body": "@MarekLipka Question was edited with the whole method."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1528787682, "post_id": 50811055, "comment_id": 88627845, "body": "Ok, it still doesn&#39;t explain this behavior. So my next question: What is the backtrace of this error?"}, {"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1528787903, "post_id": 50811055, "comment_id": 88627992, "body": "@MarekLipka backtrace was added."}], "answers": [{"tags": [], "owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "is_accepted": true, "score": 0, "last_activity_date": 1529311000, "creation_date": 1529311000, "answer_id": 50905530, "question_id": 50811055, "link": "https://stackoverflow.com/questions/50811055/catch-exception-raised-by-lib-in-controller/50905530#50905530", "title": "Catch exception raised by lib in controller", "body": "<p>I solved catching exception there <a href=\"https://stackoverflow.com/questions/50817923/why-controller-does-not-catch-error\">Why controller does not catch error</a>. </p>\n\n<p>When the exception is caught at the <code>respond_to</code> block, then it works correctly.</p>\n"}], "owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 1, "accepted_answer_id": 50905530, "answer_count": 1, "score": 1, "last_activity_date": 1529311000, "creation_date": 1528786826, "last_edit_date": 1528801661, "question_id": 50811055, "link": "https://stackoverflow.com/questions/50811055/catch-exception-raised-by-lib-in-controller", "title": "Catch exception raised by lib in controller", "body": "<p>I have module saved in <code>lib/rolify_roles.rb</code></p>\n\n<pre><code>module RolifyRoles\n  path = File.join(Rails.root, 'config', 'rolify_roles.yml')\n  @config = YAML.load_file(path)\n\n  def add_role(role, target = nil)\n    raise \"Role is not defined!\" if RolifyRoles.config[role].nil?\n    ...\n  end\nend\n</code></pre>\n\n<p>This lib is prepended by <code>models/user.rb</code> which using the <code>add_role</code> method.</p>\n\n<p>Then in <code>controllers/users_controller.rb</code> i have method which uses the <code>add_role</code> method:</p>\n\n<pre><code>  def create_user_role\n    authorize User\n      role = params[:user][:rolify_role].to_sym\n      resource_type = params[:user][:resource_type]\n      resource_id = params[:user][:id]\n\n      resource = nil\n      resource = resource_type.constantize.find(resource_id) unless resource_type.blank? || resource_id.blank?\n\n\n      respond_to do |format|\n        if @user.add_role role, resource\n          format.html { redirect_to @user, notice: \"Role #{role} was successfully added.\" }\n          format.json { render :show, status: :created, location: @user }\n        else\n          format.html { render :show }\n          format.json { render json: @call.errors, status: :unprocessable_entity }\n        end\n      end\n\n    # Add_role exceptions\n    rescue Exception =&gt; e\n       format.html { render :show }\n       format.json { render json: @call.errors, status: :unprocessable_entity }\n\n  end\n</code></pre>\n\n<p>I am trying to catch the exception from the module <code>RolifyRoles</code> in the controller method.</p>\n\n<p>But when the exception is raised (<code>Role is not defined!</code>) it ends up in the module and it's not handled by the controller.\n<code>User#add_role  lib/rolify_roles.rb, line 31</code></p>\n\n<p>How can I handle this behavior in the controller?</p>\n\n<p>Backtrace:\n<a href=\"https://i.stack.imgur.com/UX2rW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UX2rW.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Edit:</h3>\n\n<p>I've tried to <code>rescue</code> from <code>RecordNotFound</code> error in controller like this:</p>\n\n<pre><code>  def create_user_role\n    authorize User\n    role = params[:user][:rolify_role].to_sym\n    resource_type = params[:user][:resource_type]\n    resource_id = params[:user][:id]\n\n    # Catch RecordNotFound doesn't work\n    begin\n      resource = nil\n      resource = resource_type.constantize.find(resource_id) if RolifyRoles.available_resources.include?(resource_type) &amp;&amp; resource_id.present?\n    rescue ActiveRecord::RecordNotFound =&gt; e\n      format.html { render :show }\n      flash[:error] = e.message\n    end\n  end\n</code></pre>\n\n<p>And when the <code>resource_type.constantize.find(resource_id)</code> cannot find the record, its doesnt raise the <code>rescue</code> block.</p>\n\n<pre><code> Completed 500 Internal Server Error in 46ms (ActiveRecord: 3.2ms)\n ActiveRecord::RecordNotFound - Couldn't find RequestComment with 'id'=1:\n app/controllers/users_controller.rb:58:in `create_user_role'\n</code></pre>\n"}, {"tags": ["ruby", "object", "pageobjects", "page-object-gem"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1528785722, "post_id": 50810389, "comment_id": 88626810, "body": "What happens when you try these methods above?"}, {"owner": {"reputation": 15, "user_id": 941245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4e35e035ea921f387901c5c32dd9bd?s=128&d=identicon&r=PG", "display_name": "Mohsin Khan", "link": "https://stackoverflow.com/users/941245/mohsin-khan"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1528787033, "post_id": 50810389, "comment_id": 88627502, "body": "timed out after 30 seconds, waiting for #&lt;Watir::Anchor: located: false; {:name=&gt;&quot;content-frame&quot;, :tag_name=&gt;&quot;iframe&quot;} --&gt; {:value=&gt;&quot;search&quot;, :tag_name=&gt;&quot;a&quot;}&gt; to be located; Watir treated [&quot;value&quot;] as a non-HTML compliant attribute, ensure that was intended. I tried to add the frame and got this"}], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 4876405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vmiys.png?s=128&g=1", "display_name": "Praveen P.", "link": "https://stackoverflow.com/users/4876405/praveen-p"}, "is_accepted": true, "score": 0, "last_activity_date": 1529092878, "creation_date": 1529092878, "answer_id": 50881977, "question_id": 50810389, "link": "https://stackoverflow.com/questions/50810389/clicking-a-link-thats-nested-inside-a-div-using-page-object-gem/50881977#50881977", "title": "Clicking a link that&#39;s nested inside a div using page-object gem", "body": "<p>To access the underlying methods for that link using Page Object gem you would need to add '_element' as a suffix to the name.</p>\n\n<pre><code>link(:more_restaurants, text: 'More Restaurants')\nmore_restaurants_element\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 941245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4e35e035ea921f387901c5c32dd9bd?s=128&d=identicon&r=PG", "display_name": "Mohsin Khan", "link": "https://stackoverflow.com/users/941245/mohsin-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 50881977, "answer_count": 1, "score": 0, "last_activity_date": 1529092878, "creation_date": 1528784282, "last_edit_date": 1528786456, "question_id": 50810389, "link": "https://stackoverflow.com/questions/50810389/clicking-a-link-thats-nested-inside-a-div-using-page-object-gem", "title": "Clicking a link that&#39;s nested inside a div using page-object gem", "body": "<p>I have a page that has a link <code>More restaurants</code>. I'm not sure how to access it using page-object gem by Cheezy.</p>\n\n<p>When I click the link, it opens up a modal showing more restaurants than the ten in a list that it shows by default. </p>\n\n<pre><code>&lt;div class=\"singleselect-radio-footer\"&gt;\n    &lt;a href=\"\" ng-click=\"toggleModal('singleselecRadioMoreOptionsModal.html')\" r_test=\"singleselect-link-SelectRestaurant-more\" ng-show=\"alwaysShowMoreLink || items.length &gt; limit\" class=\"ng-binding\"&gt;More Restaurants&lt;/a&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I tried to use link</p>\n\n<pre><code>link(:more_restaurants, text: 'More Restaurants')\n\nmore_restaurants.click\n</code></pre>\n\n<p>and </p>\n\n<pre><code>div(:more_restaurants, class: 'singleselect-radio-footer')\n\ndef try_to_click\n  sleep(2)\n  self.more_restaurants_element.click\nend\n</code></pre>\n\n<p>I'm wondering what the easiest way is to access such elements without an id. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1528785672, "post_id": 50809552, "comment_id": 88626777, "body": "Why do <code>option_1</code> / <code>_2</code> / <code>_3</code> have to be <code>false</code> in the first place instead of just staying <code>nil</code>? Have you tried to remove those lines? I wouldn&#39;t be surprised if the code runs fine without it."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1528791535, "post_id": 50809552, "comment_id": 88629966, "body": "@Stefan Those lines ensure that the options exist. If they don&#39;t exist then subsequent <code>if</code>/<code>unless</code> tests are going to fail."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1528791712, "post_id": 50809552, "comment_id": 88630065, "body": "What do you mean by <i>&quot;ensure that the options exist&quot;</i>? There&#39;s no difference between <code>if false</code> and <code>if nil</code> ..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1528793578, "post_id": 50809552, "comment_id": 88631132, "body": "The two are equivalent , even if the variable (e.g., <code>option_1</code>) <i>has not been initialized!</i>"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1528797142, "post_id": 50809552, "comment_id": 88633350, "body": "If I use a non-existent variable in <code>if foo ... end</code> then I get a <code>NameError</code>, but not when in <code>do_something if foo.nil?</code>, right?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1528797309, "post_id": 50809552, "comment_id": 88633472, "body": "<i>&quot;If I use a non-existent variable ... I get a NameError&quot;</i> \u2013 yes, that&#39;s correct. But where do these local variables come from? Why are they not always defined? It seems to me as if the problem is being fixed on the wrong end."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1528801683, "post_id": 50809552, "comment_id": 88636055, "body": "@Stefan Because the template is referenced in another ERuby file like <code>&lt;%= render &#39;category&#47;page&#39;, option_2: value, option_4: value, option_7: value %&gt;</code>, which makes all variables optional."}], "answers": [{"comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 1, "creation_date": 1528780382, "post_id": 50809591, "comment_id": 88624866, "body": "So <code>a ||= b</code> runs when <code>a</code> is either <code>nil</code> or <code>false</code> instead of <code>nil</code>-only?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1528780592, "post_id": 50809591, "comment_id": 88624940, "body": "You got it. That&#39;s a subtle but sometimes important difference. In this particular case it doesn&#39;t seem to matter. If the assignment wasn&#39;t <code>false</code> but <code>super_expensive_method_call</code> which could under some circumstances return <code>false</code> then it&#39;d be hugely different."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1528780677, "post_id": 50809591, "comment_id": 88624956, "body": "You mean the use of <code>a = b if a.nil?</code> is primarily a performance concern?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 1, "creation_date": 1528780763, "post_id": 50809591, "comment_id": 88624986, "body": "If sometimes in the code <code>b</code> is an expensive operation then it&#39;s perhaps done for consistency&#39;s sake. If that isn&#39;t the case this might be a pointless habit, or worse, <a href=\"https://en.wikipedia.org/wiki/Cargo_cult_programming\" rel=\"nofollow noreferrer\">cargo cult programming</a> where the reasons for doing it that way aren&#39;t understood but the tradition persists. Personally I think trailing <code>if</code> clauses are &quot;surprise conditions&quot; and should be avoided because they impair readability."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1528780784, "post_id": 50809591, "comment_id": 88624994, "body": "Thank you for your detailed explanation!"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 7, "last_activity_date": 1528780047, "creation_date": 1528780047, "answer_id": 50809591, "question_id": 50809552, "link": "https://stackoverflow.com/questions/50809552/difference-between-a-b-and-a-b-if-a-nil/50809591#50809591", "title": "Difference between `a ||= b` and `a = b if a.nil?", "body": "<p>In this particular case there's no difference, but it could be out of habit. Whenever I see <code>nil?</code> being used, it's almost always used inappropriately. In Ruby very few things are logically false, only literal <code>false</code> and <code>nil</code> are.</p>\n\n<p>That means code like <code>if (!x.nil?)</code> is almost always better expressed as <code>if (x)</code> unless there's an expectation that <code>x</code> might be literal <code>false</code>.</p>\n\n<p>I'd switch that to <code>||= false</code> because that has the same outcome, but it's largely a matter of preference. The only downside is that assignment will happen every time that line is run instead of once with the <code>.nil?</code> test.</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1528803221, "creation_date": 1528803221, "answer_id": 50816132, "question_id": 50809552, "link": "https://stackoverflow.com/questions/50809552/difference-between-a-b-and-a-b-if-a-nil/50816132#50816132", "title": "Difference between `a ||= b` and `a = b if a.nil?", "body": "<p>Instead of defining the missing local variables, you can use <a href=\"http://api.rubyonrails.org/classes/ActionView/Template.html#method-i-local_assigns\" rel=\"nofollow noreferrer\"><code>local_assigns</code></a> in your views to reference local variables without causing a <code>NameError</code>. </p>\n\n<p>So instead of:</p>\n\n<pre><code>&lt;% option_1 ||= false %&gt;\n&lt;% option_2 ||= false %&gt;\n&lt;% option_3 ||= false %&gt;\n\n&lt;% if option_1 %&gt;\n  ...\n&lt;% end %&gt;\n\n&lt;% if option_2 %&gt;\n  ...\n&lt;% end %&gt;\n</code></pre>\n\n<p>You have:</p>\n\n<pre><code>&lt;% if local_assigns[:option_1] %&gt;\n  ...\n&lt;% end %&gt;\n\n&lt;% if local_assigns[:option_2] %&gt;\n  ...\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 50809591, "answer_count": 2, "score": 5, "last_activity_date": 1528803221, "creation_date": 1528779831, "question_id": 50809552, "link": "https://stackoverflow.com/questions/50809552/difference-between-a-b-and-a-b-if-a-nil", "title": "Difference between `a ||= b` and `a = b if a.nil?", "body": "<p>I'm inspecting a Rails project. On an ERuby HTML template page I saw a few lines like this:</p>\n\n<pre><code>&lt;% option_1 = false if option_1.nil? %&gt;\n&lt;% option_2 = false if option_2.nil? %&gt;\n&lt;% option_3 = false if option_3.nil? %&gt;\n</code></pre>\n\n<p>I can't understand why it isn't written like this:</p>\n\n<pre><code>&lt;% option_1 ||= false %&gt;\n</code></pre>\n\n<p>What's the difference of <code>||=</code> and <code>if nil?</code> in this case?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1528779711, "post_id": 50809490, "comment_id": 88624622, "body": "<code>users.where(department_id: department_id)</code>"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1528781357, "post_id": 50809490, "comment_id": 88625170, "body": "<code>Users.where(department_id: params[:department_id])</code>"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1528785835, "post_id": 50809490, "comment_id": 88626865, "body": "<i>&quot;... it executes a function in its model ...&quot;</i> - @iGian you don&#39;t have access to <code>params</code> inside a model."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1528790879, "post_id": 50809490, "comment_id": 88629634, "body": "@JagdeepSingh, does it skip the controller?"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1528798324, "post_id": 50809490, "comment_id": 88634109, "body": "@iGian this line of code is present in model and models don&#39;t know about <code>params</code>."}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 4627150, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/930915593607785/picture?type=large", "display_name": "Mariel", "link": "https://stackoverflow.com/users/4627150/mariel"}, "edited": false, "score": 0, "creation_date": 1528781731, "post_id": 50809572, "comment_id": 88625286, "body": "for some reason, it is still not working. Is there something I am missing?"}, {"owner": {"reputation": 169, "user_id": 4627150, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/930915593607785/picture?type=large", "display_name": "Mariel", "link": "https://stackoverflow.com/users/4627150/mariel"}, "edited": false, "score": 0, "creation_date": 1528781951, "post_id": 50809572, "comment_id": 88625360, "body": "i have noticed that the multiple select is not returning its value <code>department_id</code>. how can i fix this?"}, {"owner": {"reputation": 413, "user_id": 5149471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Sqr06HaqS7s/AAAAAAAAAAI/AAAAAAAAABc/0GICbgbAH0A/photo.jpg?sz=128", "display_name": "Akash Pinnaka", "link": "https://stackoverflow.com/users/5149471/akash-pinnaka"}, "reply_to_user": {"reputation": 169, "user_id": 4627150, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/930915593607785/picture?type=large", "display_name": "Mariel", "link": "https://stackoverflow.com/users/4627150/mariel"}, "edited": false, "score": 0, "creation_date": 1528783953, "post_id": 50809572, "comment_id": 88626042, "body": "What are the params you are getting?"}, {"owner": {"reputation": 169, "user_id": 4627150, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/930915593607785/picture?type=large", "display_name": "Mariel", "link": "https://stackoverflow.com/users/4627150/mariel"}, "edited": false, "score": 0, "creation_date": 1528784955, "post_id": 50809572, "comment_id": 88626452, "body": "the department_id is returning NULL"}, {"owner": {"reputation": 413, "user_id": 5149471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Sqr06HaqS7s/AAAAAAAAAAI/AAAAAAAAABc/0GICbgbAH0A/photo.jpg?sz=128", "display_name": "Akash Pinnaka", "link": "https://stackoverflow.com/users/5149471/akash-pinnaka"}, "reply_to_user": {"reputation": 169, "user_id": 4627150, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/930915593607785/picture?type=large", "display_name": "Mariel", "link": "https://stackoverflow.com/users/4627150/mariel"}, "edited": false, "score": 0, "creation_date": 1528786549, "post_id": 50809572, "comment_id": 88627259, "body": "try <code>&lt;%= f.select :department_id, Department.all.map { |d| [d.name, d.id] }, {include_blank: true, multiple: true} %&gt;</code> and tell me if it still happens"}, {"owner": {"reputation": 169, "user_id": 4627150, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/930915593607785/picture?type=large", "display_name": "Mariel", "link": "https://stackoverflow.com/users/4627150/mariel"}, "edited": false, "score": 0, "creation_date": 1528792150, "post_id": 50809572, "comment_id": 88630315, "body": "it became a single selection which is working from the start."}, {"owner": {"reputation": 413, "user_id": 5149471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Sqr06HaqS7s/AAAAAAAAAAI/AAAAAAAAABc/0GICbgbAH0A/photo.jpg?sz=128", "display_name": "Akash Pinnaka", "link": "https://stackoverflow.com/users/5149471/akash-pinnaka"}, "reply_to_user": {"reputation": 169, "user_id": 4627150, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/930915593607785/picture?type=large", "display_name": "Mariel", "link": "https://stackoverflow.com/users/4627150/mariel"}, "edited": false, "score": 0, "creation_date": 1528800443, "post_id": 50809572, "comment_id": 88635313, "body": "You try using select_tag instead of f.select"}, {"owner": {"reputation": 169, "user_id": 4627150, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/930915593607785/picture?type=large", "display_name": "Mariel", "link": "https://stackoverflow.com/users/4627150/mariel"}, "edited": false, "score": 0, "creation_date": 1528801145, "post_id": 50809572, "comment_id": 88635719, "body": "It is still the same. I&#39;ve noticed that when adding the <code>multiple: true</code> in it the name of the select changes from <code>filter_user[department_id]</code> to  <code>filter_user[department_id][]</code>. is there anyway to call <code>filter_user[department_id][]</code> in the model?"}, {"owner": {"reputation": 413, "user_id": 5149471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Sqr06HaqS7s/AAAAAAAAAAI/AAAAAAAAABc/0GICbgbAH0A/photo.jpg?sz=128", "display_name": "Akash Pinnaka", "link": "https://stackoverflow.com/users/5149471/akash-pinnaka"}, "reply_to_user": {"reputation": 169, "user_id": 4627150, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/930915593607785/picture?type=large", "display_name": "Mariel", "link": "https://stackoverflow.com/users/4627150/mariel"}, "edited": false, "score": 0, "creation_date": 1528801609, "post_id": 50809572, "comment_id": 88636002, "body": "Can you post the params you are seeing?"}], "tags": [], "owner": {"reputation": 413, "user_id": 5149471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Sqr06HaqS7s/AAAAAAAAAAI/AAAAAAAAABc/0GICbgbAH0A/photo.jpg?sz=128", "display_name": "Akash Pinnaka", "link": "https://stackoverflow.com/users/5149471/akash-pinnaka"}, "is_accepted": false, "score": 0, "last_activity_date": 1528780406, "last_edit_date": 1528780406, "creation_date": 1528779936, "answer_id": 50809572, "question_id": 50809490, "link": "https://stackoverflow.com/questions/50809490/filter-based-on-multiple-select-in-ruby/50809572#50809572", "title": "Filter based on multiple select in Ruby", "body": "<p>Its similar approach even for multiple select.</p>\n\n<p>Lets say you want to filter using department and location:</p>\n\n<pre><code>&lt;%= f.label :department_id %&gt;&lt;br&gt;\n&lt;%= f.select :department_id, Department.all.map { |d| [d.name, d.id] }, {include_blank: true}, multiple: true %&gt;\n&lt;%= f.label :location_id %&gt;&lt;br&gt;\n&lt;%= f.select :location_id, Location.all.map { |d| [d.name, d.id] }, {include_blank: true}, multiple: true %&gt;\n</code></pre>\n\n<p>Change the function in your model to have the following content:</p>\n\n<pre><code>@users = User.where([\"department_id = ?\", department_id]) if department_id.present?\n@users = @users.where([\"location_id = ?\", location_id]) if location_id.present?\n</code></pre>\n\n<p>In the above, first line filters using department. In the second line, it filters the already filtered users with location.</p>\n"}], "owner": {"reputation": 169, "user_id": 4627150, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/930915593607785/picture?type=large", "display_name": "Mariel", "link": "https://stackoverflow.com/users/4627150/mariel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528782660, "creation_date": 1528779470, "last_edit_date": 1528782660, "question_id": 50809490, "link": "https://stackoverflow.com/questions/50809490/filter-based-on-multiple-select-in-ruby", "title": "Filter based on multiple select in Ruby", "body": "<p>How to filter my users table using multiple select? I've tried changing it to just single selection and the filter works and it's properly executing the sql but i want to change it to multiple select. I've tried it and the filter is not working. How can I accomplish it?\n<br>\nI have this in my form: </p>\n\n<pre><code>&lt;%= f.label :department_id %&gt;&lt;br&gt;\n&lt;%= f.select :department_id, Department.all.map { |d| [d.name, d.id] }, {include_blank: true}, multiple: true %&gt;\n</code></pre>\n\n<p>After the form has been submitted, it executes a function in its model. This is the piece of code that made the single selection work but it won't work in multiple selection: <code>users = User.where([\"users.department_id = ?\", department_id]) if department_id.present?</code>. How can I make it work on multiple selection?</p>\n\n<p>Edit: I've noticed that it's not returning anything when it's multiple select. How can i fix this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528773466, "post_id": 50808711, "comment_id": 88623154, "body": "Please share how do you build a request and what the value of response is."}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1528773695, "post_id": 50808711, "comment_id": 88623183, "body": "depending on your library it may have already parsed the JSON into a hash; do a <code>puts data.class</code> before <code>info = JSON...</code> and check it out"}, {"owner": {"reputation": 21, "user_id": 9928003, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LrdoByu_iNw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2QukRw-eLIwbitt-wYyBnnsa1_BQ/mo/photo.jpg?sz=128", "display_name": "Alex Treichler", "link": "https://stackoverflow.com/users/9928003/alex-treichler"}, "edited": false, "score": 0, "creation_date": 1528775722, "post_id": 50808711, "comment_id": 88623605, "body": "Hey Josh, I went ahead and did that and it spit out &quot;string&quot;"}, {"owner": {"reputation": 21, "user_id": 9928003, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LrdoByu_iNw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2QukRw-eLIwbitt-wYyBnnsa1_BQ/mo/photo.jpg?sz=128", "display_name": "Alex Treichler", "link": "https://stackoverflow.com/users/9928003/alex-treichler"}, "edited": false, "score": 0, "creation_date": 1528775876, "post_id": 50808711, "comment_id": 88623630, "body": "I have added the whole script.  I first have to get a session ID and then use that to open the string."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528776112, "post_id": 50808711, "comment_id": 88623677, "body": "What would happen if you have <code>quirks_more</code> parameter removed?"}, {"owner": {"reputation": 21, "user_id": 9928003, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LrdoByu_iNw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2QukRw-eLIwbitt-wYyBnnsa1_BQ/mo/photo.jpg?sz=128", "display_name": "Alex Treichler", "link": "https://stackoverflow.com/users/9928003/alex-treichler"}, "edited": false, "score": 0, "creation_date": 1528779159, "post_id": 50808711, "comment_id": 88624453, "body": "I originally did not have it and was receiving the error.  After some research I found someone online suggesting it, but did not work in this case."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1528782739, "post_id": 50808711, "comment_id": 88625641, "body": "Can you post the data string that&#39;s actually generating the error? Or it is the full string between &#39; &#39; in the yellow quote? In that case there seems to be a strange <code>}{</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1528927058, "post_id": 50808711, "comment_id": 88697249, "body": "The data is not valid JSON. Therefore, you cannot parse it with a JSON parser."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9928003, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LrdoByu_iNw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2QukRw-eLIwbitt-wYyBnnsa1_BQ/mo/photo.jpg?sz=128", "display_name": "Alex Treichler", "link": "https://stackoverflow.com/users/9928003/alex-treichler"}, "edited": false, "score": 0, "creation_date": 1528809693, "post_id": 50811453, "comment_id": 88641622, "body": "Thank you for this information.  I tried this solution, however it is still producing an error for me."}], "tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 2, "last_activity_date": 1528788247, "creation_date": 1528788247, "answer_id": 50811453, "question_id": 50808711, "link": "https://stackoverflow.com/questions/50808711/json-parse-error-handling-invalid-non-json-format/50811453#50811453", "title": "&#39;JSON.parse&#39; error handling invalid/non JSON format", "body": "<p>The endpoint you are using is documented in <a href=\"https://developer.tradier.com/documentation/markets/create-events-session\" rel=\"nofollow noreferrer\">Tradier API docs</a> and it's a <a href=\"https://developer.tradier.com/documentation/overview/streaming\" rel=\"nofollow noreferrer\">streaming endpoint</a>.</p>\n\n<p>It appears that the response is not chunked to contain just one JSON document per chunk. It however does appear that the documents are separated by linefeeds, making the response look like:</p>\n\n<pre><code>{ \"json\": \"data\" }\n{ \"more\": \"data\" }\n</code></pre>\n\n<p>And that is not valid JSON. You probably need to parse them one by one by doing something like:</p>\n\n<pre><code>http.request request do |response|\n  response.read_body do |data|\n    data.each_line do |chunk|\n      info = JSON.parse(chunk)\n      puts info.inspect\n    end\n  end\nend\n</code></pre>\n\n<p>If the response chunking happens in the middle of JSON documents, you must use some kind of buffered reader.</p>\n"}], "owner": {"reputation": 21, "user_id": 9928003, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LrdoByu_iNw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2QukRw-eLIwbitt-wYyBnnsa1_BQ/mo/photo.jpg?sz=128", "display_name": "Alex Treichler", "link": "https://stackoverflow.com/users/9928003/alex-treichler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528788247, "creation_date": 1528773017, "last_edit_date": 1528775846, "question_id": 50808711, "link": "https://stackoverflow.com/questions/50808711/json-parse-error-handling-invalid-non-json-format", "title": "&#39;JSON.parse&#39; error handling invalid/non JSON format", "body": "<p>I request information from an HTTP streaming service. It provides data in JSON format. Here is <a href=\"https://developer.tradier.com/documentation/streaming/get-markets-events\" rel=\"nofollow noreferrer\">the documentation</a>. Here is a part of the code I am using:</p>\n\n<pre><code>require 'uri'\nrequire 'net/https'\nrequire 'json'\n\n\nuri = URI(\"https://api.tradier.com/v1/markets/events/session\")\nhttp = Net::HTTP.new(uri.host, uri.port)\nrequest = Net::HTTP::Post.new(uri.request_uri)\nhttp.read_timeout = 30\nhttp.use_ssl = true\nhttp.verify_mode = OpenSSL::SSL::VERIFY_PEER\n\n# Headers\n\nrequest[\"Accept\"] = \"application/json\"\nrequest[\"Authorization\"] = \"Bearer xxx\"\n\n# Send synchronously\n\nresponse = http.request(request)\n\n# parses response\n\nparse = JSON.parse(response.body)\n\n#out puts values only from response\n\nsessionid = parse.values[0][\"sessionid\"]\nurl = parse.values[0][\"url\"]\n\n\nuri = URI(\"#{url}?sessionid=#{sessionid}&amp;symbols=aapl\")\nhttp = Net::HTTP.new(uri.host, uri.port)\nrequest = Net::HTTP::Post.new(uri.request_uri)\nhttp.read_timeout = 30\nhttp.use_ssl = true\nhttp.verify_mode = OpenSSL::SSL::VERIFY_PEER\n\n# Headers\n\nrequest[\"Accept\"] = \"application/json\"\nrequest[\"Authorization\"] = \"Bearer xxx\"\n\n\nhttp.request request do |response|\n  response.read_body do |data|\n    puts data.class\n  #  info = JSON.parse(data, :quirks_mode =&gt; true)\n  #  puts info.values\n    end\nend\n</code></pre>\n\n<p>I want to have the system continue the program. It seems that I need to use <code>begin</code> and <code>rescue</code>, but I cannot get them to work. When I request data, I get the following error:</p>\n\n<blockquote>\n  <p>`parse': 757: unexpected token at '{\"type\":\"trade\",\"symbol\":\"AAPL\",\"exch\":\"Q\",\"price\":\"191.23\",\"size\":\"1081622\",\"cvol\":\"18308460\",\"date\":\"1528747200000\",\"last\":\"191.23\"}{\"type\":\"summary\",\"symbol\":\"AAPL\",\"open\":\"191.35\",\"high\":\"191.97\",\"low\":\"190.21\",\"prevClose\":\"191.7\",\"close\":\"191.23\"}' (JSON::ParserError)</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1528770701, "post_id": 50808251, "comment_id": 88622614, "body": "You are missing some build tools notably g++."}, {"owner": {"reputation": 27, "user_id": 5020245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70b44547cf1c764ea556320339fbba4b?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/5020245/austin"}, "reply_to_user": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1528771715, "post_id": 50808251, "comment_id": 88622786, "body": "Hey Joe, is there some documentation on how to add the missing build tools? I am not familiar with this."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5020245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70b44547cf1c764ea556320339fbba4b?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/5020245/austin"}, "edited": false, "score": 0, "creation_date": 1528800304, "post_id": 50809341, "comment_id": 88635226, "body": "Thank you! This worked. I was unable to run <code>sudo apt-get install build-essential</code> on the Codeanywhere but I ran <code>curl -sL https:&#47;&#47;deb.nodesource.com&#47;setup_8.x | sudo -E bash -</code> first. I also ran <code>sudo apt-get install gcc g++ make</code>"}], "tags": [], "owner": {"reputation": 1393, "user_id": 6206501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JENfJ.jpg?s=128&g=1", "display_name": "Abhilash Reddy", "link": "https://stackoverflow.com/users/6206501/abhilash-reddy"}, "is_accepted": true, "score": 2, "last_activity_date": 1528778402, "creation_date": 1528778402, "answer_id": 50809341, "question_id": 50808251, "link": "https://stackoverflow.com/questions/50808251/error-failed-to-build-gem-native-extension-stock-quote-gem/50809341#50809341", "title": "ERROR: Failed to build gem native extension (stock_quote gem)", "body": "<p>C++ compiler is not installed on your system. If you're using Ubuntu run the below command:</p>\n\n<pre><code>sudo apt-get install build-essential\n</code></pre>\n\n<p>Normally I install several other packages which might be helpful during software development.</p>\n\n<pre><code>curl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -\ncurl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -\necho \"deb https://dl.yarnpkg.com/debian/ stable main\" | sudo tee /etc/apt/sources.list.d/yarn.list\n\nsudo apt-get update\nsudo apt-get install git-core curl zlib1g-dev build-essential libssl-dev libreadline-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt1-dev libcurl4-openssl-dev software-properties-common libffi-dev nodejs yarn\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5020245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70b44547cf1c764ea556320339fbba4b?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/5020245/austin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1099, "favorite_count": 0, "accepted_answer_id": 50809341, "answer_count": 1, "score": 0, "last_activity_date": 1528778402, "creation_date": 1528768559, "question_id": 50808251, "link": "https://stackoverflow.com/questions/50808251/error-failed-to-build-gem-native-extension-stock-quote-gem", "title": "ERROR: Failed to build gem native extension (stock_quote gem)", "body": "<p>I am getting a strange error when trying to add the <code>stock_quote</code> gem to my gemfile.</p>\n\n<p>The error is:</p>\n\n<pre><code>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\ncurrent directory:\n/home/cabox/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/unf_ext-0.0.7.5/ext/unf_ext\n/home/cabox/.rbenv/versions/2.4.2/bin/ruby -r ./siteconf20180611-2823-17z0ly6.rb extconf.rb\nchecking for -lstdc++... no\ncreating Makefile\n\ncurrent directory:\n/home/cabox/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/unf_ext-0.0.7.5/ext/unf_ext\nmake \"DESTDIR=\" clean\n\ncurrent directory:\n/home/cabox/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/unf_ext-0.0.7.5/ext/unf_ext\nmake \"DESTDIR=\"\ncompiling unf.cc\nmake: g++: Command not found\nmake: *** [unf.o] Error 127\n\nmake failed, exit code 2\n\nGem files will remain installed in\n/home/cabox/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/unf_ext-0.0.7.5 for inspection.\nResults logged to\n/home/cabox/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/extensions/x86_64-linux/2.4.0-static/unf_ext-0.0.7.5/gem_make.out\n\nAn error occurred while installing unf_ext (0.0.7.5), and Bundler cannot continue.\nMake sure that `gem install unf_ext -v '0.0.7.5'` succeeds before bundling.\n\nIn Gemfile:\n  stock_quote was resolved to 2.0.0, which depends on\n    rest-client was resolved to 2.0.2, which depends on\n      http-cookie was resolved to 1.0.3, which depends on\n        domain_name was resolved to 0.5.20180417, which depends on\n          unf was resolved to 0.1.4, which depends on\n            unf_ext\n</code></pre>\n\n<p>After seeing that, I tried to install <code>gem install unf_ext -v '0.0.7.5</code> on it's own but received a similar error.</p>\n\n<p>I found posts with a <em>similar</em> error, but I was unable to resolve it by following those.</p>\n\n<p>Perhaps the issue is that I am using a <a href=\"http://blog.thefirehoseproject.com/posts/setting-codeanywhere-development-environment/\" rel=\"nofollow noreferrer\">CodeAnywhere Firehose box</a></p>\n\n<p>Other than that, I am not too sure what it could be. If you would like to see my repo please let me know or if more information is needed let me know.</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 2, "last_activity_date": 1528761268, "creation_date": 1528761268, "answer_id": 50807536, "question_id": 50807345, "link": "https://stackoverflow.com/questions/50807345/how-to-write-a-custom-messageexpectation-in-rspec/50807536#50807536", "title": "How to write a custom MessageExpectation in rspec?", "body": "<p>Given that subclassing MessageExpectation is probably going to result in pain, the easiest approach is to make a little custom helper method:</p>\n\n<pre><code>module ReceiveHelpers\n  def receive_with_flat_str(method, *expected)\n    receive(method) do |*args|\n      expect(args.flatten.compact.map(&amp;:to_s)).to eql(expected)\n    end\n  end\nend\n\ndescribe ... do\n  include ReceiveHelpers\n\n  it do\n    expect(Foo).to receive_with_flat_str(:shell_out, \"foo\", \"bar\")\n  end\nend\n</code></pre>\n\n<p>That can either be included in just the example groups that need it, or all groups via the RSpec configuration block.</p>\n"}], "owner": {"reputation": 3556, "user_id": 506908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c874984f69ef596764255efcd79113?s=128&d=identicon&r=PG", "display_name": "lamont", "link": "https://stackoverflow.com/users/506908/lamont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 50807536, "answer_count": 1, "score": 0, "last_activity_date": 1528761268, "creation_date": 1528759528, "last_edit_date": 1528760465, "question_id": 50807345, "link": "https://stackoverflow.com/questions/50807345/how-to-write-a-custom-messageexpectation-in-rspec", "title": "How to write a custom MessageExpectation in rspec?", "body": "<p>I've got a test that I can write using receive() with the block argument to custom validate arguments like this:</p>\n\n<pre><code>expect(provider).to receive(:shell_out!) do |*args|\n  expect(args.flatten.compact.map(&amp;:to_s)).to eql([\"useradd\", \"-m\", \"adam\"])\nend\n</code></pre>\n\n<p>I have hundreds of these tests to write and I'd like to shorten that to:</p>\n\n<pre><code>expect(provider).to receive(:shell_out!).with_flat_compact_str(\"useradd\", \"-m\", \"adam\")\n</code></pre>\n\n<p>I'm currently heading down the road of monkeypatching in a custom method to implement that into the <code>RSpec::Mocks::MessageExpectation</code> class, and I'm wondering if there's a simpler way to get what I want?</p>\n\n<p>Note that the purpose of this is that the <code>shell_out!(*args)</code> API will take its splat args and run <code>args.flatten.compact.map(&amp;:to_s)</code> over them and I want to allow setting up expectations on the message which won't fail if the caller makes inconsequential changes to the call (i.e. treat <code>shell_out!(a, b, c)</code> and <code>shell_out!(a, nil, [b, c])</code> as the same.  I also explicitly do not want to call it with one method and then setup an expectation on an internal API call after the splat has been normalized.</p>\n\n<p>Also note that I went down the road of trying to write a custom matcher that looked like this:</p>\n\n<pre><code>receive(:shell_out).with(flat_compact_str(\"useradd\", \"-m\", \"adam\"))\n</code></pre>\n\n<p>What I found though is that does not work with splat args (at least I couldn't figure it out).  It would work if there was one argument that was an Array, but not across all the args.  Splat arg matchers have special magic in them.</p>\n"}, {"tags": ["ruby", "elasticsearch", "logstash", "gzip", "packetbeat"], "answers": [{"comments": [{"owner": {"reputation": 4328, "user_id": 56855, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c589d6e290574099803b7ab15089a39c?s=128&d=identicon&r=PG", "display_name": "Lusid", "link": "https://stackoverflow.com/users/56855/lusid"}, "edited": false, "score": 0, "creation_date": 1529103590, "post_id": 50853069, "comment_id": 88769220, "body": "Thank you, but I should have clarified that we have it working this way now. I am wanting to enable gzip compression for all of our client applications that connect to Elasticsearch to decrease outgoing bandwidth by about 90% from Elasticsearch. So, to meet my requirements, when &quot;Accept-Encoding: gzip&quot; is sent, I need the response to be returned in gzip but the logs from Packetbeat to be written in plaintext. I do appreciate your response though."}], "tags": [], "owner": {"reputation": 541, "user_id": 4991719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b369c68d311e36cc89a4a93a05c7f6?s=128&d=identicon&r=PG&f=1", "display_name": "Parag Naik", "link": "https://stackoverflow.com/users/4991719/parag-naik"}, "is_accepted": false, "score": 0, "last_activity_date": 1528965200, "creation_date": 1528965200, "answer_id": 50853069, "question_id": 50807296, "link": "https://stackoverflow.com/questions/50807296/decoding-gzip-response-body-from-packetbeat/50853069#50853069", "title": "Decoding gzip response body from Packetbeat", "body": "<p>I had a different situation and was able to resolve my issue. Posting it here, see if it helps your case.</p>\n\n<p>I was using postman tool to test my REST API services locally. My Packetbeat used following config.</p>\n\n<pre><code>  type: http\n  ports: [80, 8080, 8000, 5000, 8002]\n  send_all_headers: true\n  include_body_for: [\"application/json\", \"x-www-form-urlencoded\"]\n  send_request: true\n  send_response: true\n</code></pre>\n\n<p>I was getting following output in body.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uwnLK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uwnLK.png\" alt=\"enter image description here\"></a></p>\n\n<p>I was able to get http.response.body in clear text when i added following to my postman request.</p>\n\n<pre><code>Accept-Encoding: application/json \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9dohh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9dohh.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 4328, "user_id": 56855, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c589d6e290574099803b7ab15089a39c?s=128&d=identicon&r=PG", "display_name": "Lusid", "link": "https://stackoverflow.com/users/56855/lusid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528965200, "creation_date": 1528759113, "question_id": 50807296, "link": "https://stackoverflow.com/questions/50807296/decoding-gzip-response-body-from-packetbeat", "title": "Decoding gzip response body from Packetbeat", "body": "<p>I am using Packetbeat to monitor the requests/responses into/out of Elasticsearch client nodes using the http protocol watcher on port 9200. I am sending the output of Packetbeat through Logstash, and then from there out to a different instance of Elasticsearch. We have compression support enabled in the Elasticsearch that is being monitored, so I occasionally see requests with \"Accept-Encoding: gzip, deflate\" headers returning responses that are gzipped. Unfortunately, I have not been able to decode any of these gzip responses using any tools I have at my disposal (including the web-based converters, the gzip command line tool, and using Zlib::GzipReader in a Logstash ruby filter script). They all report that it is not a gzip format.</p>\n\n<p>Does anyone know why I can't seem to decode the gzip content?</p>\n\n<p>I have provided a sample of the filter I'm using in Logstash to try to do this on the fly as the event passes through Logstash (and it always reports that http.response.body is not in gzip format).</p>\n\n<pre><code>filter {\n  if [type] == \"http\" {\n    if [http][response][headers][content-encoding] == \"gzip\" {\n      ruby {\n        init =&gt; \"\n          require 'zlib'\n          require 'stringio'\n        \"\n        code =&gt; \"\n          body = event.get('[http][response][body]').to_s\n          sio = StringIO.new(body)\n          gz = Zlib::GzipReader.new(sio)\n          result = gz.read.to_s\n          event.set('[http][response][body]', result)\n        \"\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>I'm also providing a sample of the logged event here which includes the gzip content in case you would like to try to decompress it yourself:</p>\n\n<pre><code>{\n  \"_index\": \"packetbeat-6.2.3-2018.05.19\",\n  \"_type\": \"doc\",\n  \"_id\": \"oH0bemMB2mAXfg5euIiP\",\n  \"_score\": 1,\n  \"_source\": {\n    \"server\": \"\",\n    \"client_server\": \"\",\n    \"bytes_in\": 160,\n    \"bytes_out\": 361,\n    \"@timestamp\": \"2018-05-19T20:33:46.470Z\",\n    \"client_port\": 55863,\n    \"path\": \"/\",\n    \"type\": \"http\",\n    \"client_proc\": \"\",\n    \"query\": \"GET /\",\n    \"port\": 9200,\n    \"host\": \"gke-main-production-elastic-clients-5728bab3-t1z8\",\n    \"@version\": \"1\",\n    \"responsetime\": 0,\n    \"fields\": {\n      \"nodePool\": \"production-elastic-clients\"\n    },\n    \"response\": \"HTTP/1.1 200 OK\\r\\ncontent-type: application/json; charset=UTF-8\\r\\ncontent-encoding: gzip\\r\\ncontent-length: 250\\r\\n\\r\\n\\u001f\ufffd\\b\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000T\ufffd\ufffdn\ufffd0\\u0014Fw\ufffd\ufffd\ufffd\\u001c\\u0010\\u0018\ufffd\ufffd\ufffd\ufffd\ufffd&amp;\ufffd\ufffdvH\\u0016d\ufffdK\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\\u0010\ufffd\ufffd\\u000b\ufffdC\\u0018\ufffd\ufffd\ufffd\ufffd{\ufffd\ufffd\\u0010]\\u0001\ufffd\\u001aap1W\\u0012\ufffd\\u0018\\u0017\ufffd,y)\ufffd\ufffd\ufffdoC\ufffd\\n\ufffd\ufffdA\ufffd\ufffd\\u001b\ufffd6/\ufffd\ufffd\\u001a\ufffd\\u000e\ufffd\ufffd\\\"l+\ufffd\ufffd\ufffd\ufffd\ufffd\\u001d\\u000f\\u0005y/\ufffd\ufffd\ufffdk\ufffd?\ufffd\\u0005\ufffd\\u0005\ufffd\ufffd\ufffd3\ufffd\ufffd\ufffdY\ufffd_[\ufffd\ufffd\ufffdMh\ufffd\\u0007nzo\ufffdT\ufffd\ufffd\ufffd\ufffdC\ufffd1\ufffd\\u0011\ufffd]\ufffd\ufffd\ufffd\ufffd\\u0007H\ufffd\\u0015q\ufffd\ufffd)\ufffd&amp;i\ufffd\ufffdu^%iF\ufffdk\ufffdi6\ufffd\u078cs\ufffdc\ufffd\ufffd\ufffd)\ufffd9hh^\ufffd0\ufffdT2&lt;\ufffd&lt;\ufffd\ufffd\ufffd.J\ufffd\ufffd\ufffd\ufffdx\ufffd\ufffd\ufffd}\ufffd:c\ufffd\\u0011\ufffd\ufffd=\ufffd\ufffd\ufffd\\u001f\\u0000\\u0000\\u0000\ufffd\ufffd\\u0003\\u0000\ufffd\ufffd.\ufffdS\\u0001\\u0000\\u0000\",\n    \"proc\": \"\",\n    \"request\": \"GET / HTTP/1.1\\r\\nUser-Agent: vscode-restclient\\r\\nhost: es-http-dev.elastic-prod.svc.cluster.local:9200\\r\\naccept-encoding: gzip, deflate\\r\\nConnection: keep-alive\\r\\n\\r\\n\",\n    \"beat\": {\n      \"name\": \"gke-main-production-elastic-clients-5728bab3-t1z8\",\n      \"version\": \"6.2.3\",\n      \"hostname\": \"gke-main-production-elastic-clients-5728bab3-t1z8\"\n    },\n    \"status\": \"OK\",\n    \"method\": \"GET\",\n    \"client_ip\": \"10.24.20.6\",\n    \"http\": {\n      \"response\": {\n        \"phrase\": \"OK\",\n        \"headers\": {\n          \"content-encoding\": \"gzip\",\n          \"content-length\": 250,\n          \"content-type\": \"application/json; charset=UTF-8\"\n        },\n        \"body\": \"\\u001f\ufffd\\b\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000T\ufffd\ufffdn\ufffd0\\u0014Fw\ufffd\ufffd\ufffd\\u001c\\u0010\\u0018\ufffd\ufffd\ufffd\ufffd\ufffd&amp;\ufffd\ufffdvH\\u0016d\ufffdK\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\\u0010\ufffd\ufffd\\u000b\ufffdC\\u0018\ufffd\ufffd\ufffd\ufffd{\ufffd\ufffd\\u0010]\\u0001\ufffd\\u001aap1W\\u0012\ufffd\\u0018\\u0017\ufffd,y)\ufffd\ufffd\ufffdoC\ufffd\\n\ufffd\ufffdA\ufffd\ufffd\\u001b\ufffd6/\ufffd\ufffd\\u001a\ufffd\\u000e\ufffd\ufffd\\\"l+\ufffd\ufffd\ufffd\ufffd\ufffd\\u001d\\u000f\\u0005y/\ufffd\ufffd\ufffdk\ufffd?\ufffd\\u0005\ufffd\\u0005\ufffd\ufffd\ufffd3\ufffd\ufffd\ufffdY\ufffd_[\ufffd\ufffd\ufffdMh\ufffd\\u0007nzo\ufffdT\ufffd\ufffd\ufffd\ufffdC\ufffd1\ufffd\\u0011\ufffd]\ufffd\ufffd\ufffd\ufffd\\u0007H\ufffd\\u0015q\ufffd\ufffd)\ufffd&amp;i\ufffd\ufffdu^%iF\ufffdk\ufffdi6\ufffd\u078cs\ufffdc\ufffd\ufffd\ufffd)\ufffd9hh^\ufffd0\ufffdT2&lt;\ufffd&lt;\ufffd\ufffd\ufffd.J\ufffd\ufffd\ufffd\ufffdx\ufffd\ufffd\ufffd}\ufffd:c\ufffd\\u0011\ufffd\ufffd=\ufffd\ufffd\ufffd\\u001f\\u0000\\u0000\\u0000\ufffd\ufffd\\u0003\\u0000\ufffd\ufffd.\ufffdS\\u0001\\u0000\\u0000\",\n        \"code\": 200\n      },\n      \"request\": {\n        \"params\": \"\",\n        \"headers\": {\n          \"connection\": \"keep-alive\",\n          \"user-agent\": \"vscode-restclient\",\n          \"content-length\": 0,\n          \"host\": \"es-http-dev.elastic-prod.svc.cluster.local:9200\",\n          \"accept-encoding\": \"gzip, deflate\"\n        }\n      }\n    },\n    \"tags\": [\n      \"beats\",\n      \"beats_input_raw_event\"\n    ],\n    \"ip\": \"10.24.41.5\"\n  },\n  \"fields\": {\n    \"@timestamp\": [\n      \"2018-05-19T20:33:46.470Z\"\n    ]\n  }\n}\n</code></pre>\n\n<p>And this is the response for that message that I receive at the client after it has been decompressed successfully by the client:</p>\n\n<pre><code>HTTP/1.1 200 OK\ncontent-type: application/json; charset=UTF-8\ncontent-encoding: gzip\ncontent-length: 250\n\n{\n  \"name\": \"es-client-7688c8d9b9-qp9l7\",\n  \"cluster_name\": \"esprod\",\n  \"cluster_uuid\": \"8iRwLMMSR72F76ZEONYcUg\",\n  \"version\": {\n    \"number\": \"5.6.3\",\n    \"build_hash\": \"1a2f265\",\n    \"build_date\": \"2017-10-06T20:33:39.012Z\",\n    \"build_snapshot\": false,\n    \"lucene_version\": \"6.6.1\"\n  },\n  \"tagline\": \"You Know, for Search\"\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "initialization", "rake", "rake-task"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528771443, "post_id": 50807266, "comment_id": 88622741, "body": "How is this error <i>similar</i> to the previous one? <code>bundle exec</code> is necessary to ensure that the local gemset is used. The latter error message clearly says how to resolve the issue."}, {"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528772146, "post_id": 50807266, "comment_id": 88622882, "body": "@mudasobwa That gem error was a separate thing that&#39;s been showing up for a while. I should have deleted those lines from the my question, but in any case I now added the gem and updated the error output I&#39;m getting."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528772264, "post_id": 50807266, "comment_id": 88622915, "body": "Is Windows\u2019 file system (is it still NTFS?) case sensitive? I wonder what does mean <code>Ruby24-x64</code> vs <code>ruby24-x64</code> in your logs. If yes, you might want to delete one of them."}, {"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528772478, "post_id": 50807266, "comment_id": 88622960, "body": "@mudasobwa Strange, I&#39;m not sure why it&#39;s writing &quot;ruby24-x64&quot;. I only have <code>Ruby24-x64</code> on my computer."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1528772584, "post_id": 50807266, "comment_id": 88622974, "body": "Well, that seems to cause the issue. It somehow distinguishes <code>R</code> and <code>r</code> and hence tries to read the files twice."}, {"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1528774013, "post_id": 50807266, "comment_id": 88623246, "body": "@mudasobwa Yeah, that appears to have been the problem. I reinstalled everything locally instead of globally and that fixed it."}], "answers": [{"tags": [], "owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "is_accepted": true, "score": 0, "last_activity_date": 1528774115, "creation_date": 1528774115, "answer_id": 50808826, "question_id": 50807266, "link": "https://stackoverflow.com/questions/50807266/sudden-already-initialized-constant-errors-when-running-rake-tasks/50808826#50808826", "title": "Sudden &quot;already initialized constant&quot; errors when running rake tasks", "body": "<p>For some reason, my server was confused about the casing of my Ruby folder, and seemed to think there were two, although there weren't. I had to reinstall everything locally in my app instead of globally, like so:</p>\n\n<pre><code>bundle install --path vendor/cache\n</code></pre>\n\n<p>and it works with no warnings now.</p>\n"}], "owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1051, "favorite_count": 0, "accepted_answer_id": 50808826, "answer_count": 1, "score": 1, "last_activity_date": 1528774115, "creation_date": 1528758844, "last_edit_date": 1528773981, "question_id": 50807266, "link": "https://stackoverflow.com/questions/50807266/sudden-already-initialized-constant-errors-when-running-rake-tasks", "title": "Sudden &quot;already initialized constant&quot; errors when running rake tasks", "body": "<p>I've been running rake tasks no problem for a while, on a Windows machine. Then I suddenly started getting an error when I ran anything rake-related. It happened for the first time after I ran <code>rake db:migrate</code>, and I think that may have been after I altered a migration without rolling it back first. Now, every rake command gives this:</p>\n\n<pre><code>&gt; rake db:rollback\n\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_utils.rb:10: warning: already initialized constant FileUtils::RUBY\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_utils.rb:10: warning: previous definition of RUBY was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_utils.rb:109: warning: already initialized constant FileUtils::LN_SUPPORTED\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_utils.rb:109: warning: previous definition of LN_SUPPORTED was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_utils_ext.rb:17: warning: already initialized constant Rake::FileUtilsExt::DEFAULT\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_utils_ext.rb:17: warning: previous definition of DEFAULT was here\nWARNING: Possible conflict with Rake extension: String#ext already exists\nWARNING: Possible conflict with Rake extension: String#pathmap already exists\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:44: warning: already initialized constant Rake::FileList::ARRAY_METHODS\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:44: warning: previous definition of ARRAY_METHODS was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:47: warning: already initialized constant Rake::FileList::MUST_DEFINE\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:47: warning: previous definition of MUST_DEFINE was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:51: warning: already initialized constant Rake::FileList::MUST_NOT_DEFINE\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:51: warning: previous definition of MUST_NOT_DEFINE was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:55: warning: already initialized constant Rake::FileList::SPECIAL_RETURN\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:55: warning: previous definition of SPECIAL_RETURN was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:61: warning: already initialized constant Rake::FileList::DELEGATING_METHODS\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:61: warning: previous definition of DELEGATING_METHODS was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:86: warning: already initialized constant Rake::FileList::GLOB_PATTERN\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:86: warning: previous definition of GLOB_PATTERN was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:381: warning: already initialized constant Rake::FileList::DEFAULT_IGNORE_PATTERNS\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:381: warning: previous definition of DEFAULT_IGNORE_PATTERNS was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:387: warning: already initialized constant Rake::FileList::DEFAULT_IGNORE_PROCS\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/file_list.rb:387: warning: previous definition of DEFAULT_IGNORE_PROCS was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:3: warning: already initialized constant Rake::VERSION\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:3: warning: previous definition of VERSION was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:6: warning: already initialized constant Rake::Version::MAJOR\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:6: warning: previous definition of MAJOR was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:6: warning: already initialized constant Rake::Version::MINOR\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:6: warning: previous definition of MINOR was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:6: warning: already initialized constant Rake::Version::BUILD\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:6: warning: previous definition of BUILD was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:6: warning: already initialized constant Rake::Version::OTHER\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:6: warning: previous definition of OTHER was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:8: warning: already initialized constant Rake::Version::NUMBERS\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/version.rb:8: warning: previous definition of NUMBERS was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/linked_list.rb:110: warning: already initialized constant Rake::LinkedList::EMPTY\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/linked_list.rb:110: warning: previous definition of EMPTY was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/scope.rb:41: warning: already initialized constant Rake::Scope::EMPTY\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/scope.rb:41: warning: previous definition of EMPTY was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/promise.rb:12: warning: already initialized constant Rake::Promise::NOT_SET\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/promise.rb:12: warning: previous definition of NOT_SET was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/application.rb:13: warning: already initialized constant Rake::CommandLineOptionError\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/application.rb:13: warning: previous definition of CommandLineOptionError was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/application.rb:41: warning: already initialized constant Rake::Application::DEFAULT_RAKEFILES\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/application.rb:41: warning: previous definition of DEFAULT_RAKEFILES was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/task_arguments.rb:108: warning: already initialized constant Rake::EMPTY_TASK_ARGS\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/task_arguments.rb:108: warning: previous definition of EMPTY_TASK_ARGS was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/invocation_chain.rb:55: warning: already initialized constant Rake::InvocationChain::EMPTY\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/invocation_chain.rb:55: warning: previous definition of EMPTY was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/early_time.rb:21: warning: already initialized constant Rake::EARLY\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/early_time.rb:21: warning: previous definition of EARLY was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/late_time.rb:17: warning: already initialized constant Rake::LATE\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/late_time.rb:17: warning: previous definition of LATE was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/backtrace.rb:4: warning: already initialized constant Rake::Backtrace::SYS_KEYS\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/backtrace.rb:4: warning: previous definition of SYS_KEYS was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/backtrace.rb:5: warning: already initialized constant Rake::Backtrace::SYS_PATHS\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/backtrace.rb:5: warning: previous definition of SYS_PATHS was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/backtrace.rb:8: warning: already initialized constant Rake::Backtrace::SUPPRESSED_PATHS\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/backtrace.rb:8: warning: previous definition of SUPPRESSED_PATHS was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/backtrace.rb:12: warning: already initialized constant Rake::Backtrace::SUPPRESSED_PATHS_RE\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/backtrace.rb:12: warning: previous definition of SUPPRESSED_PATHS_RE was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/backtrace.rb:16: warning: already initialized constant Rake::Backtrace::SUPPRESS_PATTERN\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake/backtrace.rb:16: warning: previous definition of SUPPRESS_PATTERN was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake.rb:70: warning: already initialized constant FileList\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake.rb:70: warning: previous definition of FileList was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake.rb:71: warning: already initialized constant RakeFileUtils\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/rake-12.3.0/lib/rake.rb:71: warning: previous definition of RakeFileUtils was here\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/activesupport-5.1.4/lib/active_support/core_ext/load_error.rb:2: warning: already initialized constant LoadError::REGEXPS\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/activesupport-5.1.4/lib/active_support/core_ext/load_error.rb:2: warning: previous definition of REGEXPS was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/activemodel-5.1.4/lib/active_model/validations/clusivity.rb:6: warning: already initialized constant ActiveModel::Validations::Clusivity::ERROR_MESSAGE\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/activemodel-5.1.4/lib/active_model/validations/clusivity.rb:6: warning: previous definition of ERROR_MESSAGE was here\n</code></pre>\n\n<p>I found a few related threads saying that the problem was that I needed to type \"bundle exec\" before the command. I've never had to do that before, but I tried it. I got a shorter, but similar, error:</p>\n\n<pre><code>&gt; bundle exec rake db:rollback\n\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/activesupport-5.1.4/lib/active_support/core_ext/load_error.rb:2: warning: already initialized constant LoadError::REGEXPS\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/activesupport-5.1.4/lib/active_support/core_ext/load_error.rb:2: warning: previous definition of REGEXPS was here\nc:/ruby24-x64/lib/ruby/gems/2.4.0/gems/activemodel-5.1.4/lib/active_model/validations/clusivity.rb:6: warning: already initialized constant ActiveModel::Validations::Clusivity::ERROR_MESSAGE\nc:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/activemodel-5.1.4/lib/active_model/validations/clusivity.rb:6: warning: previous definition of ERROR_MESSAGE was here\n</code></pre>\n\n<p>Anyone know what's causing this?</p>\n\n<hr>\n\n<p>UPDATE</p>\n\n<p>For some reason my computer was confused about the location of Ruby, so I had to reinstall everything locally instead of globally like so:</p>\n\n<pre><code>bundle install --path vendor/cache\n</code></pre>\n"}, {"tags": ["ruby", "hash"], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 4, "last_activity_date": 1528823266, "last_edit_date": 1528823266, "creation_date": 1528764952, "answer_id": 50807893, "question_id": 50807228, "link": "https://stackoverflow.com/questions/50807228/mutability-and-summing-ruby-hash-values/50807893#50807893", "title": "Mutability and Summing Ruby Hash Values", "body": "<p>Your problem is basically the following.</p>\n\n<pre><code>a = [\"dog\", \"cat\"]\nb = [:d1, :d2] \nc = { :f=&gt;1 }\n\nh = a.each_with_object({}) { |pet, h| h[pet] = b.product([c]).to_h }\n  #=&gt; {\"dog\"=&gt;{:d1=&gt;{:f=&gt;1}, :d2=&gt;{:f=&gt;1}},\n  #    \"cat\"=&gt;{:d1=&gt;{:f=&gt;1}, :d2=&gt;{:f=&gt;1}}\n</code></pre>\n\n<p>Now let's change the value of <code>:f</code> in one of the hashes <code>{ :f=&gt;1 }</code></p>\n\n<pre><code>h[\"cat\"][:d2][:f] = 2\n</code></pre>\n\n<p>and then observe the new value of <code>h</code>.</p>\n\n<pre><code>h #=&gt; {\"dog\"=&gt;{:d1=&gt;{:f=&gt;2}, :d2=&gt;{:f=&gt;2}},\n  #    \"cat\"=&gt;{:d1=&gt;{:f=&gt;2}, :d2=&gt;{:f=&gt;2}}}\n</code></pre>\n\n<p>You were expecting <code>h</code> to equal:</p>\n\n<pre><code>#=&gt; {\"dog\"=&gt;{:d1=&gt;{:f=&gt;1}, :d2=&gt;{:f=&gt;1}},\n#    \"cat\"=&gt;{:d1=&gt;{:f=&gt;1}, :d2=&gt;{:f=&gt;2}}}\n</code></pre>\n\n<p>To see why we get this result, replace each hash <code>{ :f=&gt;1 }</code> with its <code>object_id</code>.</p>\n\n<pre><code>a.each { |aa| d.each { |bb| h[aa][bb] = h[aa][bb].object_id } }\nh #=&gt; {\"dog\"=&gt;{:d1=&gt;36327481, :d2=&gt;36327481},\n  #    \"cat\"=&gt;{:d1=&gt;36327481, :d2=&gt;36327481}}\n</code></pre>\n\n<p>As you see all four of these hashes are the same object. It should therefore be expected that if the object is changed the change will appear wherever the hash appears.</p>\n\n<p>Here is one way to fix the problem.</p>\n\n<pre><code>h = a.each_with_object({}) { |pet, h| h[pet] = b.map { |d| [d, c.dup] }.to_h }\n  #=&gt; {\"dog\"=&gt;{:d1=&gt;{:f=&gt;1}, :d2=&gt;{:f=&gt;1}},\n  #    \"cat\"=&gt;{:d1=&gt;{:f=&gt;1}, :d2=&gt;{:f=&gt;1}}}\n\nh[\"cat\"][:d2][:f] = 2\n  #=&gt; 2\nh #=&gt; {\"dog\"=&gt;{:d1=&gt;{:f=&gt;1}, :d2=&gt;{:f=&gt;1}},\n  #    \"cat\"=&gt;{:d1=&gt;{:f=&gt;1}, :d2=&gt;{:f=&gt;2}}}\n</code></pre>\n\n<p>A word of warning: if <code>{ :f=&gt;1 }</code> contained nested elements, such as <code>{ :f=&gt;{ :g=&gt;1 } }</code> we could not simply dup it (because a change to <code>{ :g=&gt;1 }</code> would affect all the hashes); instead we would require a <a href=\"https://www.thoughtco.com/making-deep-copies-in-ruby-2907749\" rel=\"nofollow noreferrer\">deep copy</a>.    </p>\n"}], "owner": {"reputation": 47, "user_id": 6288896, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59ec264f37ff0c05973fb4fe4cb77df1?s=128&d=identicon&r=PG&f=1", "display_name": "martinmsf", "link": "https://stackoverflow.com/users/6288896/martinmsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50807893, "answer_count": 1, "score": 0, "last_activity_date": 1528823266, "creation_date": 1528758510, "question_id": 50807228, "link": "https://stackoverflow.com/questions/50807228/mutability-and-summing-ruby-hash-values", "title": "Mutability and Summing Ruby Hash Values", "body": "<p>I'm attempting to sum values from a hash, and I'm running into some unexpected (to me) behavior. Below is code which reproduces the behavior. </p>\n\n<pre><code>records = [\n  { \"id\" =&gt; 5062311, \"period\" =&gt; \"May 27, 2018\", \"items\" =&gt; 2, \"compliant_items\" =&gt; 2 },\n  { \"id\" =&gt; 5062311, \"period\" =&gt; \"May 20, 2018\", \"items\" =&gt; 3, \"compliant_items\" =&gt; 1 },\n  { \"id\" =&gt; 5062311, \"period\" =&gt; \"May 13, 2018\", \"items\" =&gt; 7, \"compliant_items\" =&gt; 7 },\n  { \"id\" =&gt; 5062311, \"period\" =&gt; \"May 13, 2018\", \"items\" =&gt; 8, \"compliant_items\" =&gt; 7 },\n  { \"id\" =&gt; 5062311, \"period\" =&gt; \"Jun 03, 2018\", \"items\" =&gt; 6, \"compliant_items\" =&gt; 6 }\n]\n</code></pre>\n\n<p>Create Output Hash</p>\n\n<pre><code>items  =  records.flat_map { |item| item[\"id\"] }.uniq\nweeks  =  records.flat_map { |item| item[\"period\"] }.uniq\ntemp   =  items.each_with_object({}) { |item, hash| hash[item] = weeks.product([\"total\" =&gt; 0, \"compliant\" =&gt; 0]).to_h }\n</code></pre>\n\n<p>Output for \"temp\" is as follows...</p>\n\n<pre><code>{\n  5062311=&gt;{\n   \"May 27, 2018\"=&gt;{\"total\"=&gt;0, \"compliant\"=&gt;0},\n   \"May 20, 2018\"=&gt;{\"total\"=&gt;0, \"compliant\"=&gt;0}, \n   \"May 13, 2018\"=&gt;{\"total\"=&gt;0, \"compliant\"=&gt;0}, \n   \"Jun 03, 2018\"=&gt;{\"total\"=&gt;0, \"compliant\"=&gt;0}\n  }\n}\n</code></pre>\n\n<p>Now if I attempt to modify a particular key's value, every other key is also updated. For example, the following:</p>\n\n<pre><code>temp[5062311][\"May 20, 2018\"][\"total\"] += 5\n</code></pre>\n\n<p>yields...</p>\n\n<pre><code>{\n  5062311=&gt;{\n   \"May 27, 2018\"=&gt;{\"total\"=&gt;5, \"compliant\"=&gt;0},\n   \"May 20, 2018\"=&gt;{\"total\"=&gt;5, \"compliant\"=&gt;0}, \n   \"May 13, 2018\"=&gt;{\"total\"=&gt;5, \"compliant\"=&gt;0}, \n   \"Jun 03, 2018\"=&gt;{\"total\"=&gt;5, \"compliant\"=&gt;0}\n  }\n}\n</code></pre>\n\n<p>I would expect that only the May 20th record to be updated, and all other values to remain 0. I'm not sure how to rewrite this to get around this behavior. Any suggestions? Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1528786173, "post_id": 50806782, "comment_id": 88627036, "body": "Why do you want it like that? May be your controller code is easier to modify rather than customizing the params."}], "answers": [{"tags": [], "owner": {"reputation": 1704, "user_id": 3076240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aecba75e7673597442c574d786cec2f?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/3076240/jon"}, "is_accepted": true, "score": 0, "last_activity_date": 1528756752, "creation_date": 1528756752, "answer_id": 50806997, "question_id": 50806782, "link": "https://stackoverflow.com/questions/50806782/arrangement-of-values-that-were-not-selected/50806997#50806997", "title": "arrangement of values that were not selected", "body": "<p>You could use hidden fields to send radio/checkbox inputs that are not selected.</p>\n\n<p>for example</p>\n\n<pre><code>&lt;input type=\"radio\" name=\"selected_privilege[1]\" value=\"3\"&gt;\n&lt;input type=\"hidden\" id=\"no_selected_privilege_three\" name=\"no_selected_privilege[1]\" value=\"3\" /&gt;\n</code></pre>\n\n<p>with that set up, you can use javascript to empty or add the value of no_selected_privilege[1] if selected_privilege[1] is selected/deselected. </p>\n\n<p>If the hidden fields have a value they will be sent to the server, if they have no value they will not be sent to the server.</p>\n"}], "owner": {"reputation": 93, "user_id": 9447658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737e381a3fe807cf38cc4cf88c67c14a?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Ruiz Perez", "link": "https://stackoverflow.com/users/9447658/sebastian-ruiz-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 50806997, "answer_count": 1, "score": 0, "last_activity_date": 1543731861, "creation_date": 1528755285, "last_edit_date": 1543731861, "question_id": 50806782, "link": "https://stackoverflow.com/questions/50806782/arrangement-of-values-that-were-not-selected", "title": "arrangement of values that were not selected", "body": "<p>I'm using Ruby on rails </p>\n\n<p>how to make me send an arrangement with the values \u200b\u200bof radio buttons and checbox that were not selected</p>\n\n<p>For example </p>\n\n<pre><code>&lt;input type=\"checkbox\" name=\"selected_privilege[0]\" value=\"1\" /&gt;\n&lt;input type=\"radio\" name=\"selected_privilege[1]\" value=\"2\"&gt;\n&lt;input type=\"radio\" name=\"selected_privilege[1]\" value=\"3\"&gt;\n</code></pre>\n\n<p>for example if you selected the checkbox and the firts radio</p>\n\n<pre><code>\"selected_privilege\"=&gt;{\"0\" =&gt;\"1\",\"1\"=&gt;\"2\"}\n</code></pre>\n\n<p>I also want to send me an arrangement like this</p>\n\n<pre><code>\"no_selected_privilege\"=&gt;{\"1\" =&gt;\"3\"}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "amazon-s3", "aws-sdk"], "answers": [{"tags": [], "owner": {"reputation": 4797, "user_id": 177154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f719bc9e36272f09feca03728b4a160c?s=128&d=identicon&r=PG", "display_name": "draganstankovic", "link": "https://stackoverflow.com/users/177154/draganstankovic"}, "is_accepted": true, "score": 1, "last_activity_date": 1528758384, "last_edit_date": 1528758384, "creation_date": 1528756259, "answer_id": 50806932, "question_id": 50806729, "link": "https://stackoverflow.com/questions/50806729/what-is-the-connection-limit-to-s3-using-aws-sdk-ruby-gem/50806932#50806932", "title": "What is the connection limit to S3 using AWS SDK Ruby gem?", "body": "<p>Not sure what you trying to do but check this: <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/request-rate-perf-considerations.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/AmazonS3/latest/dev/request-rate-perf-considerations.html</a> that is also mentioned in the answer here: <a href=\"https://stackoverflow.com/a/37432967/177154\">https://stackoverflow.com/a/37432967/177154</a></p>\n\n<p>Also not sure if you have already checked this:\n<a href=\"https://github.com/aws/aws-sdk-ruby/blob/master/gems/aws-sdk-core/lib/seahorse/client/net_http/connection_pool.rb\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-ruby/blob/master/gems/aws-sdk-core/lib/seahorse/client/net_http/connection_pool.rb</a> ?</p>\n\n<p>As a protip - fairly early in the S3 doc article, there is a link to open a support case on AWS support. This might seem odd and it is often neglected by devs but there are reports that opening a case like this could end up with a really good info/solution for whatever the extraordinary case you might have.</p>\n"}], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "accepted_answer_id": 50806932, "answer_count": 1, "score": 0, "last_activity_date": 1528758384, "creation_date": 1528754945, "question_id": 50806729, "link": "https://stackoverflow.com/questions/50806729/what-is-the-connection-limit-to-s3-using-aws-sdk-ruby-gem", "title": "What is the connection limit to S3 using AWS SDK Ruby gem?", "body": "<p>Is there a connection pool for aws-sdk?</p>\n\n<p>How many concurrent connections can I have to S3 from a single app instance? Is there a config for this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sequel"], "answers": [{"comments": [{"owner": {"reputation": 1007, "user_id": 5351714, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed8a93ea89809e3812bdfb926389ff96?s=128&d=identicon&r=PG&f=1", "display_name": "lolix", "link": "https://stackoverflow.com/users/5351714/lolix"}, "edited": false, "score": 0, "creation_date": 1528755082, "post_id": 50806694, "comment_id": 88619340, "body": "yes, but I got this error: undefined local variable or method `label&#39; for main:Object (NameError)"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1528754715, "creation_date": 1528754715, "answer_id": 50806694, "question_id": 50806665, "link": "https://stackoverflow.com/questions/50806665/pass-relation-in-a-function-argument-sequel/50806694#50806694", "title": "pass relation in a function argument (sequel)", "body": "<p>This is to do with how argument are passed in Ruby. If you accept one argument you can't call it with <em>N</em>. Fix is this:</p>\n\n<pre><code>def query(*relations)\n  Album.eager(*relations)\nend\n</code></pre>\n\n<p>Where now you accept zero or more arguments and pass them through as-is using the <em>splat operator</em>.</p>\n"}], "owner": {"reputation": 1007, "user_id": 5351714, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed8a93ea89809e3812bdfb926389ff96?s=128&d=identicon&r=PG&f=1", "display_name": "lolix", "link": "https://stackoverflow.com/users/5351714/lolix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528754715, "creation_date": 1528754538, "question_id": 50806665, "link": "https://stackoverflow.com/questions/50806665/pass-relation-in-a-function-argument-sequel", "title": "pass relation in a function argument (sequel)", "body": "<p>I have a rails project that I am using the <code>sequel gem</code> (ORM). I would like to understand if is it possible to pass the relation in a function argument.</p>\n\n<p>Something like this (This solution doesn't work):</p>\n\n<pre><code>def query(relation)\n  Album.eager(relation)\nend\n\nquery(artist: label)\nquery(:artist)\nquery(:artist, :tracks)\n</code></pre>\n\n<p>Documentation:\n<a href=\"http://sequel.jeremyevans.net/rdoc/classes/Sequel/Model/Associations/DatasetMethods.html\" rel=\"nofollow noreferrer\">http://sequel.jeremyevans.net/rdoc/classes/Sequel/Model/Associations/DatasetMethods.html</a></p>\n"}, {"tags": ["ruby", "rubygems", "bundle"], "comments": [{"owner": {"reputation": 528, "user_id": 225796, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qqgax.png?s=128&g=1", "display_name": "Waheed", "link": "https://stackoverflow.com/users/225796/waheed"}, "edited": false, "score": 0, "creation_date": 1530460339, "post_id": 50805898, "comment_id": 89234530, "body": "did you try to delete lock file?"}, {"owner": {"reputation": 298, "user_id": 9050348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2qqpq.png?s=128&g=1", "display_name": "maguri", "link": "https://stackoverflow.com/users/9050348/maguri"}, "edited": false, "score": 0, "creation_date": 1530873650, "post_id": 50805898, "comment_id": 89397891, "body": "be sure you are in the right env. I recommend you to use <a href=\"https://rvm.io\" rel=\"nofollow noreferrer\">rvm</a> or <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">rbenv</a> to manage this thinks easier and do not get dirty your system."}], "answers": [{"tags": [], "owner": {"reputation": 302, "user_id": 1584664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095160eefd3dbd22195a0f7c402693ba?s=128&d=identicon&r=PG", "display_name": "Kavitha", "link": "https://stackoverflow.com/users/1584664/kavitha"}, "is_accepted": false, "score": 3, "last_activity_date": 1528871796, "creation_date": 1528871796, "answer_id": 50830537, "question_id": 50805898, "link": "https://stackoverflow.com/questions/50805898/bundle-cant-find-gem-that-is-clearly-installed/50830537#50830537", "title": "Bundle can&#39;t find gem that is clearly installed", "body": "<p>This is happening because of a path mismatch. Bundler is looking at a path which is not your local path. Either specifically mention </p>\n\n<blockquote>\n  <p>gem install --path</p>\n</blockquote>\n\n<p>or set </p>\n\n<blockquote>\n  <p>BUNDLE_DISABLE_SHARED_GEMS: 0</p>\n</blockquote>\n\n<p>in .bundle/config file. This is set to true(1) by default. Use this with caution though as resetting this bundler setting will enable use of system-wide installed gems.</p>\n"}, {"tags": [], "owner": {"reputation": 1579, "user_id": 2251689, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KFFuV.jpg?s=128&g=1", "display_name": "atefth", "link": "https://stackoverflow.com/users/2251689/atefth"}, "is_accepted": false, "score": 2, "last_activity_date": 1530731665, "creation_date": 1530731665, "answer_id": 51179734, "question_id": 50805898, "link": "https://stackoverflow.com/questions/50805898/bundle-cant-find-gem-that-is-clearly-installed/51179734#51179734", "title": "Bundle can&#39;t find gem that is clearly installed", "body": "<p>Try installing the gems in the system's directory, it might solve the problem as it seems your gems are installed in 2 separate directories <strong>C:/Users/rperkins/.gem/ruby/2.5.0</strong> and <strong>C:/Ruby25-x64/lib/ruby/gems/2.5.0</strong>.</p>\n\n<p>Install the gems with bundler using the following command:</p>\n\n<pre><code>bundle install --system\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1676, "user_id": 7848529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439048b68a313b2407a5cd6c405e39a1?s=128&d=identicon&r=PG&f=1", "display_name": "aabiro", "link": "https://stackoverflow.com/users/7848529/aabiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1530871684, "creation_date": 1530871684, "answer_id": 51207984, "question_id": 50805898, "link": "https://stackoverflow.com/questions/50805898/bundle-cant-find-gem-that-is-clearly-installed/51207984#51207984", "title": "Bundle can&#39;t find gem that is clearly installed", "body": "<p>Using this might work getting the index directly from rubygems:</p>\n\n<p><code>bundle install --full-index</code></p>\n"}], "owner": {"reputation": 1060, "user_id": 39143, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d53fbf8400845d4539ea89c40a0ddae?s=128&d=identicon&r=PG", "display_name": "The Digital Ninja", "link": "https://stackoverflow.com/users/39143/the-digital-ninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3877, "favorite_count": 1, "answer_count": 3, "score": 6, "last_activity_date": 1530871684, "creation_date": 1528750626, "question_id": 50805898, "link": "https://stackoverflow.com/questions/50805898/bundle-cant-find-gem-that-is-clearly-installed", "title": "Bundle can&#39;t find gem that is clearly installed", "body": "<p>I'm having a really weird issue in which I can clearly see that a gem file is installed and so can bundle, but then when I try to run it I get an error that bundle can't find it.</p>\n\n<p>Gem File: </p>\n\n<pre><code>source \"https://rubygems.org/\"\n\ngem 'kitchen-terraform'\n</code></pre>\n\n<p>Bundle env:</p>\n\n<pre><code>## Environment\n\n```\nBundler       1.16.2\n  Platforms   ruby, x64-mingw32\nRuby          2.5.1p57 (2018-03-29 revision 63029) [x64-mingw32]\n  Full Path   C:/Ruby25-x64/bin/ruby.exe\n  Config Dir  C:/ProgramData\nRubyGems      2.7.6\n  Gem Home    C:/Ruby25-x64/lib/ruby/gems/2.5.0\n  Gem Path    C:/Users/rperkins/.gem/ruby/2.5.0;C:/Ruby25-x64/lib/ruby/gems/2.5.0\n  User Path   C:/Users/rperkins/.gem/ruby/2.5.0\n  Bin Dir     C:/Ruby25-x64/bin\nTools\n  Git         2.7.2.windows.1\n  RVM         not installed\n  rbenv       not installed\n  chruby      not installed\n```\n\n## Bundler Build Metadata\n\n```\nBuilt At          2018-05-16\nGit SHA           9f7bf0ac3\nReleased Version  true\n```\n\n## Gemfile\n\n### Gemfile\n\n```ruby\nsource \"https://rubygems.org/\"\n\ngem 'kitchen-terraform'\n```\n\n### Gemfile.lock\n\n```\nGEM\n  remote: https://rubygems.org/\n  specs:\n    addressable (2.5.2)\n      public_suffix (&gt;= 2.0.2, &lt; 4.0)\n    aws-sdk (2.11.65)\n      aws-sdk-resources (= 2.11.65)\n    aws-sdk-core (2.11.65)\n      aws-sigv4 (~&gt; 1.0)\n      jmespath (~&gt; 1.0)\n    aws-sdk-resources (2.11.65)\n      aws-sdk-core (= 2.11.65)\n    aws-sigv4 (1.0.2)\n    azure_mgmt_resources (0.16.0)\n      ms_rest_azure (~&gt; 0.10.0)\n    builder (3.2.3)\n    coderay (1.1.2)\n    concurrent-ruby (1.0.5)\n    declarative (0.0.10)\n    declarative-option (0.1.0)\n    diff-lcs (1.3)\n    digest-crc (0.4.1)\n    docker-api (1.34.2)\n      excon (&gt;= 0.47.0)\n      multi_json\n    domain_name (0.5.20180417)\n      unf (&gt;= 0.0.5, &lt; 1.0.0)\n    dry-configurable (0.7.0)\n      concurrent-ruby (~&gt; 1.0)\n    dry-container (0.6.0)\n      concurrent-ruby (~&gt; 1.0)\n      dry-configurable (~&gt; 0.1, &gt;= 0.1.3)\n    dry-core (0.4.6)\n      concurrent-ruby (~&gt; 1.0)\n    dry-equalizer (0.2.1)\n    dry-inflector (0.1.2)\n    dry-logic (0.4.2)\n      dry-container (~&gt; 0.2, &gt;= 0.2.6)\n      dry-core (~&gt; 0.2)\n      dry-equalizer (~&gt; 0.2)\n    dry-types (0.13.2)\n      concurrent-ruby (~&gt; 1.0)\n      dry-container (~&gt; 0.3)\n      dry-core (~&gt; 0.4, &gt;= 0.4.4)\n      dry-equalizer (~&gt; 0.2)\n      dry-inflector (~&gt; 0.1, &gt;= 0.1.2)\n      dry-logic (~&gt; 0.4, &gt;= 0.4.2)\n    dry-validation (0.12.0)\n      concurrent-ruby (~&gt; 1.0)\n      dry-configurable (~&gt; 0.1, &gt;= 0.1.3)\n      dry-core (~&gt; 0.2, &gt;= 0.2.1)\n      dry-equalizer (~&gt; 0.2)\n      dry-logic (~&gt; 0.4, &gt;= 0.4.0)\n      dry-types (~&gt; 0.13.1)\n    erubis (2.7.0)\n    excon (0.62.0)\n    faraday (0.15.2)\n      multipart-post (&gt;= 1.2, &lt; 3)\n    faraday-cookie_jar (0.0.6)\n      faraday (&gt;= 0.7.4)\n      http-cookie (~&gt; 1.0.0)\n    faraday_middleware (0.12.2)\n      faraday (&gt;= 0.7.4, &lt; 1.0)\n    ffi (1.9.25-x64-mingw32)\n    google-api-client (0.19.8)\n      addressable (~&gt; 2.5, &gt;= 2.5.1)\n      googleauth (&gt;= 0.5, &lt; 0.7.0)\n      httpclient (&gt;= 2.8.1, &lt; 3.0)\n      mime-types (~&gt; 3.0)\n      representable (~&gt; 3.0)\n      retriable (&gt;= 2.0, &lt; 4.0)\n    google-cloud (0.51.1)\n      google-cloud-bigquery (~&gt; 1.1)\n      google-cloud-bigquery-data_transfer (~&gt; 0.1)\n      google-cloud-container (~&gt; 0.1)\n      google-cloud-dataproc (~&gt; 0.1)\n      google-cloud-datastore (~&gt; 1.4)\n      google-cloud-dlp (~&gt; 0.1)\n      google-cloud-dns (~&gt; 0.28)\n      google-cloud-error_reporting (~&gt; 0.30)\n      google-cloud-firestore (~&gt; 0.21)\n      google-cloud-language (~&gt; 0.30)\n      google-cloud-logging (~&gt; 1.5)\n      google-cloud-monitoring (~&gt; 0.27)\n      google-cloud-os_login (~&gt; 0.1)\n      google-cloud-pubsub (~&gt; 0.30)\n      google-cloud-resource_manager (~&gt; 0.29)\n      google-cloud-spanner (~&gt; 1.3)\n      google-cloud-speech (~&gt; 0.29)\n      google-cloud-storage (~&gt; 1.10)\n      google-cloud-trace (~&gt; 0.31)\n      google-cloud-translate (~&gt; 1.2)\n      google-cloud-video_intelligence (~&gt; 1.0)\n      google-cloud-vision (~&gt; 0.28)\n    google-cloud-bigquery (1.5.0)\n      concurrent-ruby (~&gt; 1.0)\n      google-api-client (~&gt; 0.19.8)\n      google-cloud-core (~&gt; 1.2)\n      googleauth (~&gt; 0.6.2)\n    google-cloud-bigquery-data_transfer (0.1.0)\n      google-gax (~&gt; 1.0)\n    google-cloud-container (0.1.0)\n      google-gax (~&gt; 1.0.1)\n    google-cloud-core (1.2.0)\n      google-cloud-env (~&gt; 1.0)\n    google-cloud-dataproc (0.1.0)\n      google-gax (~&gt; 1.0.0)\n    google-cloud-datastore (1.4.0)\n      google-cloud-core (~&gt; 1.2)\n      google-gax (~&gt; 1.0)\n      google-protobuf (~&gt; 3.3)\n    google-cloud-dlp (0.4.0)\n      google-gax (~&gt; 1.0)\n    google-cloud-dns (0.28.0)\n      google-api-client (~&gt; 0.19.0)\n      google-cloud-core (~&gt; 1.2)\n      googleauth (~&gt; 0.6.2)\n      zonefile (~&gt; 1.04)\n    google-cloud-env (1.0.1)\n      faraday (~&gt; 0.11)\n    google-cloud-error_reporting (0.30.0)\n      google-cloud-core (~&gt; 1.2)\n      google-gax (~&gt; 1.0)\n      stackdriver-core (~&gt; 1.3)\n    google-cloud-firestore (0.21.1)\n      concurrent-ruby (~&gt; 1.0)\n      google-cloud-core (~&gt; 1.2)\n      google-gax (~&gt; 1.0)\n    google-cloud-language (0.30.0)\n      google-gax (~&gt; 1.0)\n    google-cloud-logging (1.5.0)\n      google-cloud-core (~&gt; 1.2)\n      google-gax (~&gt; 1.0)\n      stackdriver-core (~&gt; 1.3)\n    google-cloud-monitoring (0.28.0)\n      google-gax (~&gt; 1.0)\n    google-cloud-os_login (0.1.0)\n      google-gax (~&gt; 1.0.0)\n    google-cloud-pubsub (0.30.2)\n      concurrent-ruby (~&gt; 1.0)\n      google-cloud-core (~&gt; 1.2)\n      google-gax (~&gt; 1.0)\n      grpc-google-iam-v1 (~&gt; 0.6.9)\n    google-cloud-resource_manager (0.29.0)\n      google-api-client (~&gt; 0.19.8)\n      google-cloud-core (~&gt; 1.2)\n      googleauth (~&gt; 0.6.2)\n    google-cloud-spanner (1.4.0)\n      concurrent-ruby (~&gt; 1.0)\n      google-cloud-core (~&gt; 1.2)\n      google-gax (~&gt; 1.0)\n      grpc-google-iam-v1 (~&gt; 0.6.9)\n    google-cloud-speech (0.29.0)\n      google-cloud-core (~&gt; 1.2)\n      google-gax (~&gt; 1.0)\n    google-cloud-storage (1.12.0)\n      digest-crc (~&gt; 0.4)\n      google-api-client (~&gt; 0.19.0)\n      google-cloud-core (~&gt; 1.2)\n      googleauth (~&gt; 0.6.2)\n    google-cloud-trace (0.33.0)\n      google-cloud-core (~&gt; 1.2)\n      google-gax (~&gt; 1.0)\n      stackdriver-core (~&gt; 1.3)\n    google-cloud-translate (1.2.0)\n      faraday (~&gt; 0.13)\n      google-cloud-core (~&gt; 1.2)\n      googleauth (~&gt; 0.6.2)\n    google-cloud-video_intelligence (1.0.0)\n      google-gax (~&gt; 1.0)\n    google-cloud-vision (0.28.0)\n      google-cloud-core (~&gt; 1.2)\n      google-gax (~&gt; 1.0)\n    google-gax (1.0.1)\n      google-protobuf (~&gt; 3.2)\n      googleapis-common-protos (&gt;= 1.3.5, &lt; 2.0)\n      googleauth (~&gt; 0.6.2)\n      grpc (&gt;= 1.7.2, &lt; 2.0)\n      rly (~&gt; 0.2.3)\n    google-protobuf (3.5.1.2-x64-mingw32)\n    googleapis-common-protos (1.3.7)\n      google-protobuf (~&gt; 3.0)\n      googleapis-common-protos-types (~&gt; 1.0)\n      grpc (~&gt; 1.0)\n    googleapis-common-protos-types (1.0.1)\n      google-protobuf (~&gt; 3.0)\n    googleauth (0.6.2)\n      faraday (~&gt; 0.12)\n      jwt (&gt;= 1.4, &lt; 3.0)\n      logging (~&gt; 2.0)\n      memoist (~&gt; 0.12)\n      multi_json (~&gt; 1.11)\n      os (~&gt; 0.9)\n      signet (~&gt; 0.7)\n    grpc (1.12.0-x64-mingw32)\n      google-protobuf (~&gt; 3.1)\n      googleapis-common-protos-types (~&gt; 1.0.0)\n      googleauth (&gt;= 0.5.1, &lt; 0.7)\n    grpc-google-iam-v1 (0.6.9)\n      googleapis-common-protos (&gt;= 1.3.1, &lt; 2.0)\n      grpc (~&gt; 1.0)\n    gssapi (1.2.0)\n      ffi (&gt;= 1.0.1)\n    gyoku (1.3.1)\n      builder (&gt;= 2.1.2)\n    hashie (3.5.7)\n    htmlentities (4.3.4)\n    http-cookie (1.0.3)\n      domain_name (~&gt; 0.5)\n    httpclient (2.8.3)\n    inifile (3.0.0)\n    inspec (2.2.10)\n      addressable (~&gt; 2.4)\n      faraday (&gt;= 0.9.0)\n      faraday_middleware (~&gt; 0.12.2)\n      hashie (~&gt; 3.4)\n      htmlentities\n      json (&gt;= 1.8, &lt; 3.0)\n      method_source (~&gt; 0.8)\n      mixlib-log\n      parallel (~&gt; 1.9)\n      parslet (~&gt; 1.5)\n      pry (~&gt; 0)\n      rspec (~&gt; 3)\n      rspec-its (~&gt; 1.2)\n      rubyzip (~&gt; 1.1)\n      semverse\n      sslshake (~&gt; 1.2)\n      thor (~&gt; 0.20)\n      tomlrb (~&gt; 1.2)\n      train (~&gt; 1.4.11)\n    jmespath (1.4.0)\n    json (2.1.0)\n    jwt (2.1.0)\n    kitchen-inspec (0.23.1)\n      hashie (~&gt; 3.4)\n      inspec (&gt;= 0.34.0, &lt; 3.0.0)\n      test-kitchen (~&gt; 1.6)\n    kitchen-terraform (3.3.1)\n      dry-types (~&gt; 0.9)\n      dry-validation (~&gt; 0.10)\n      kitchen-inspec (~&gt; 0.18)\n      mixlib-shellout (~&gt; 2.2)\n      test-kitchen (~&gt; 1.16)\n    little-plugger (1.1.4)\n    logging (2.2.2)\n      little-plugger (~&gt; 1.1)\n      multi_json (~&gt; 1.10)\n    memoist (0.16.0)\n    method_source (0.9.0)\n    mime-types (3.1)\n      mime-types-data (~&gt; 3.2015)\n    mime-types-data (3.2016.0521)\n    mixlib-install (3.10.0)\n      mixlib-shellout\n      mixlib-versioning\n      thor\n    mixlib-log (2.0.4)\n    mixlib-shellout (2.3.2-universal-mingw32)\n      win32-process (~&gt; 0.8.2)\n      wmi-lite (~&gt; 1.0)\n    mixlib-versioning (1.2.2)\n    ms_rest (0.7.2)\n      concurrent-ruby (~&gt; 1.0)\n      faraday (~&gt; 0.9)\n      timeliness (~&gt; 0.3)\n    ms_rest_azure (0.10.8)\n      concurrent-ruby (~&gt; 1.0)\n      faraday (~&gt; 0.9)\n      faraday-cookie_jar (~&gt; 0.0.6)\n      ms_rest (~&gt; 0.7.2)\n    multi_json (1.13.1)\n    multipart-post (2.0.0)\n    net-scp (1.2.1)\n      net-ssh (&gt;= 2.6.5)\n    net-ssh (4.2.0)\n    net-ssh-gateway (1.3.0)\n      net-ssh (&gt;= 2.6.5)\n    nori (2.6.0)\n    os (0.9.6)\n    parallel (1.12.1)\n    parslet (1.8.2)\n    pry (0.11.3)\n      coderay (~&gt; 1.1.0)\n      method_source (~&gt; 0.9.0)\n    public_suffix (3.0.2)\n    representable (3.0.4)\n      declarative (&lt; 0.1.0)\n      declarative-option (&lt; 0.2.0)\n      uber (&lt; 0.2.0)\n    retriable (3.1.2)\n    rly (0.2.3)\n    rspec (3.7.0)\n      rspec-core (~&gt; 3.7.0)\n      rspec-expectations (~&gt; 3.7.0)\n      rspec-mocks (~&gt; 3.7.0)\n    rspec-core (3.7.1)\n      rspec-support (~&gt; 3.7.0)\n    rspec-expectations (3.7.0)\n      diff-lcs (&gt;= 1.2.0, &lt; 2.0)\n      rspec-support (~&gt; 3.7.0)\n    rspec-its (1.2.0)\n      rspec-core (&gt;= 3.0.0)\n      rspec-expectations (&gt;= 3.0.0)\n    rspec-mocks (3.7.0)\n      diff-lcs (&gt;= 1.2.0, &lt; 2.0)\n      rspec-support (~&gt; 3.7.0)\n    rspec-support (3.7.1)\n    rubyntlm (0.6.2)\n    rubyzip (1.2.1)\n    semverse (2.0.0)\n    signet (0.8.1)\n      addressable (~&gt; 2.3)\n      faraday (~&gt; 0.9)\n      jwt (&gt;= 1.5, &lt; 3.0)\n      multi_json (~&gt; 1.10)\n    sslshake (1.2.0)\n    stackdriver-core (1.3.0)\n      google-cloud-core (~&gt; 1.2)\n    test-kitchen (1.21.2)\n      mixlib-install (~&gt; 3.6)\n      mixlib-shellout (&gt;= 1.2, &lt; 3.0)\n      net-scp (~&gt; 1.1)\n      net-ssh (&gt;= 2.9, &lt; 5.0)\n      net-ssh-gateway (~&gt; 1.2)\n      thor (~&gt; 0.19)\n      winrm (~&gt; 2.0)\n      winrm-elevated (~&gt; 1.0)\n      winrm-fs (~&gt; 1.1)\n    thor (0.20.0)\n    timeliness (0.3.8)\n    tomlrb (1.2.6)\n    train (1.4.11)\n      aws-sdk (~&gt; 2)\n      azure_mgmt_resources (~&gt; 0.15)\n      docker-api (~&gt; 1.26)\n      google-api-client (~&gt; 0.19.8)\n      google-cloud (~&gt; 0.51.1)\n      googleauth (~&gt; 0.6.2)\n      inifile\n      json (&gt;= 1.8, &lt; 3.0)\n      mixlib-shellout (~&gt; 2.0)\n      net-scp (~&gt; 1.2)\n      net-ssh (&gt;= 2.9, &lt; 5.0)\n      winrm (~&gt; 2.0)\n      winrm-fs (~&gt; 1.0)\n    uber (0.1.0)\n    unf (0.1.4)\n      unf_ext\n    unf_ext (0.0.7.5-x64-mingw32)\n    win32-process (0.8.3)\n      ffi (&gt;= 1.0.0)\n    winrm (2.2.3)\n      builder (&gt;= 2.1.2)\n      erubis (~&gt; 2.7)\n      gssapi (~&gt; 1.2)\n      gyoku (~&gt; 1.0)\n      httpclient (~&gt; 2.2, &gt;= 2.2.0.2)\n      logging (&gt;= 1.6.1, &lt; 3.0)\n      nori (~&gt; 2.0)\n      rubyntlm (~&gt; 0.6.0, &gt;= 0.6.1)\n    winrm-elevated (1.1.0)\n      winrm (~&gt; 2.0)\n      winrm-fs (~&gt; 1.0)\n    winrm-fs (1.2.0)\n      erubis (~&gt; 2.7)\n      logging (&gt;= 1.6.1, &lt; 3.0)\n      rubyzip (~&gt; 1.1)\n      winrm (~&gt; 2.0)\n    wmi-lite (1.0.0)\n    zonefile (1.06)\n\nPLATFORMS\n  x64-mingw32\n\nDEPENDENCIES\n  kitchen-terraform\n\nBUNDLED WITH\n   1.16.2\n```\n</code></pre>\n\n<p>Bundle Doctor:</p>\n\n<pre><code>The Gemfile's dependencies are satisfied\nNo issues found with the installed bundle\n</code></pre>\n\n<p>Alright, awesome everything is clearly installed, so lets try this.</p>\n\n<p><strong>Bundle exec kitchen test</strong>: </p>\n\n<pre><code>Could not find aws-sdk-core-2.11.65 in any of the sources\nRun `bundle install` to install missing gems.\n</code></pre>\n\n<p>How can this be, it was clearly installed when we ran bundle install and we can see that in the bundle env above. </p>\n\n<p>Bundle info aws-sdk-core:</p>\n\n<pre><code>  * aws-sdk-core (2.11.65)\n        Summary: AWS SDK for Ruby - Core\n        Homepage: http://github.com/aws/aws-sdk-ruby\n        Path: C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/aws-sdk-core-2.11.65\n</code></pre>\n\n<p>Bundle show aws-sdk-core:</p>\n\n<pre><code>C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/aws-sdk-core-2.11.65\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 692, "user_id": 4256719, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ESoCR.jpg?s=128&g=1", "display_name": "Jagdish", "link": "https://stackoverflow.com/users/4256719/jagdish"}, "edited": false, "score": 0, "creation_date": 1528751258, "post_id": 50805826, "comment_id": 88618006, "body": "You  wanna print all the fundings for each child? If yes, you can use HTML partial for each funding"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 692, "user_id": 4256719, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ESoCR.jpg?s=128&g=1", "display_name": "Jagdish", "link": "https://stackoverflow.com/users/4256719/jagdish"}, "edited": false, "score": 0, "creation_date": 1528752798, "post_id": 50805826, "comment_id": 88618583, "body": "I can print fundings for each child in child show table. but the problem comes when I try to print in application.html.erb which is for admin view. An undefined local variable error shows up.  The parent acts as admin when admin field is set to true and parent is directed to the application.html.erb page if he is an admin."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1528786274, "post_id": 50805826, "comment_id": 88627085, "body": "You don&#39;t have a question in there?"}, {"owner": {"reputation": 692, "user_id": 4256719, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ESoCR.jpg?s=128&g=1", "display_name": "Jagdish", "link": "https://stackoverflow.com/users/4256719/jagdish"}, "edited": false, "score": 0, "creation_date": 1528822983, "post_id": 50805826, "comment_id": 88649501, "body": "Can you post error which you are getting for undefined local variable?"}], "answers": [{"comments": [{"owner": {"reputation": 390, "user_id": 3780322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1db92ee60ab7f3058da16ec168a22e5?s=128&d=identicon&r=PG&f=1", "display_name": "cubsker", "link": "https://stackoverflow.com/users/3780322/cubsker"}, "edited": false, "score": 0, "creation_date": 1528752922, "post_id": 50806277, "comment_id": 88618615, "body": "what comes back when you have that child object and do child.fundings ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "edited": false, "score": 0, "creation_date": 1528766392, "post_id": 50806277, "comment_id": 88621750, "body": "it is the funding application for a particular activity"}, {"owner": {"reputation": 605, "user_id": 3182764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KaNKE.jpg?s=128&g=1", "display_name": "Alvaro Cantador", "link": "https://stackoverflow.com/users/3182764/alvaro-cantador"}, "edited": false, "score": 0, "creation_date": 1528803662, "post_id": 50806277, "comment_id": 88637372, "body": "@NAVROOPSINGHSIDHU If the fundings are undefined, you should include it in the query, like: <code>Child.includes(:funding)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 605, "user_id": 3182764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KaNKE.jpg?s=128&g=1", "display_name": "Alvaro Cantador", "link": "https://stackoverflow.com/users/3182764/alvaro-cantador"}, "edited": false, "score": 0, "creation_date": 1528811487, "post_id": 50806277, "comment_id": 88642938, "body": "@AlvaroCantador I have included child.includes(:fundings) in the controller. The problem is I am running the following code and it just runs for one child and the next parent or their children doesn&#39;t show up. see the update above"}, {"owner": {"reputation": 390, "user_id": 3780322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1db92ee60ab7f3058da16ec168a22e5?s=128&d=identicon&r=PG&f=1", "display_name": "cubsker", "link": "https://stackoverflow.com/users/3780322/cubsker"}, "edited": false, "score": 0, "creation_date": 1528822332, "post_id": 50806277, "comment_id": 88649149, "body": "you&#39;re only going to see something for the child if that child has at least one funding."}], "tags": [], "owner": {"reputation": 390, "user_id": 3780322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1db92ee60ab7f3058da16ec168a22e5?s=128&d=identicon&r=PG&f=1", "display_name": "cubsker", "link": "https://stackoverflow.com/users/3780322/cubsker"}, "is_accepted": false, "score": 0, "last_activity_date": 1528752448, "creation_date": 1528752448, "answer_id": 50806277, "question_id": 50805826, "link": "https://stackoverflow.com/questions/50805826/view-for-admin-in-rails/50806277#50806277", "title": "View for admin in rails", "body": "<p>you can do child.fundings.each do |funding| and then do all the attributes for funding.  </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528811516, "creation_date": 1528750275, "last_edit_date": 1528811516, "question_id": 50805826, "link": "https://stackoverflow.com/questions/50805826/view-for-admin-in-rails", "title": "View for admin in rails", "body": "<p>I have a parent table, child Table, funding table. Parent logs in, add his children and then apply for funding for each child.</p>\n\n<p>parent.rb</p>\n\n<pre><code>class Parent &lt; ApplicationRecord\n    has_many :children, dependent: :destroy\n    has_many :secondaryparents, dependent: :destroy\nend\n</code></pre>\n\n<p>funding.rb</p>\n\n<pre><code>class Funding &lt; ApplicationRecord\n    has_many :organisations, dependent: :destroy\n    belongs_to :child\nend\n</code></pre>\n\n<p>child.rb</p>\n\n<pre><code>class Child &lt; ApplicationRecord\n    belongs_to :parent\n    has_many :fundings, dependent: :destroy\nend\n</code></pre>\n\n<p>Parent has a field as admin. if set as true parent acts as admin. application.html.erb is the view of admin. I am able to display all the primary parents and their children in front of each other. I need help with displaying the funding applications of the children in front of them.</p>\n\n<p>application.html.erb</p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n&lt;!-- .main_column_css --&gt;\n  &lt;div class=\"col-sm-9 col-xs-12\"&gt;\n    &lt;div class=\"content\" role=\"main\" id=\"main-content\"&gt;\n      &lt;article&gt;\n        &lt;div &gt;&lt;h1&gt;Application Status&lt;/h1&gt;\n            &lt;div class=\"table-responsive\"&gt;\n              &lt;table class=\"table table-bordered\"&gt;\n                &lt;thead&gt;\n                  &lt;tr&gt;\n                   &lt;th&gt;Primary Parent Name&lt;/th&gt;\n                   &lt;!--  &lt;th&gt;Financial Status&lt;/th&gt; --&gt;\n                    &lt;th&gt;Child Name&lt;/th&gt;\n                    &lt;th&gt;Activity&lt;/th&gt;\n                    &lt;th&gt;Organisation&lt;/th&gt;\n                    &lt;th&gt;Activity Start Date&lt;/th&gt;\n                    &lt;th&gt;Date Submitted&lt;/th&gt;\n                    &lt;th&gt;Amount Requested&lt;/th&gt;\n                    &lt;th&gt;Funds Available&lt;/th&gt;\n                    &lt;th&gt;Status&lt;/th&gt;\n                  &lt;/tr&gt;\n                &lt;/thead&gt;\n                &lt;tbody&gt;\n  &lt;% @parents.each do |parent| %&gt;\n    &lt;% parent.children.each do |child| %&gt;\n      &lt;tr&gt; \n        &lt;td&gt;&lt;%= parent.parent_1_firstname %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= child.firstname %&gt;&lt;/td&gt;\n\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;/tbody&gt;      \n              &lt;/table&gt;\n            &lt;/div&gt;\n            &lt;div class=\"clearfix\"&gt;&lt;/div&gt;\n          &lt;/div&gt;           \n      &lt;/article&gt;\n    &lt;/div&gt;\n    &lt;!-- .content --&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>financial status, activity, activity start date, date submitted, amount requested,  funds available are all fields of funding table. Funding table has the child_id. child table has parent_id. Kindly help</p>\n\n<p>Update</p>\n\n<pre><code>&lt;% @parents.each do |parent| %&gt;\n    &lt;% parent.children.each do |child| %&gt;\n     &lt;% child.fundings.each do |funding| %&gt;\n      &lt;tr&gt; \n        &lt;td&gt;&lt;%= parent.parent_1_firstname %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= child.firstname %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= funding.type_of_activity %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 0, "creation_date": 1528748521, "post_id": 50805429, "comment_id": 88616888, "body": "Is that the entire error message? It could be that other gems are producing the above message. If so- can you post the full error message?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1528748556, "post_id": 50805429, "comment_id": 88616897, "body": "because <code>~&gt;</code> will only increment the TEENY version in that case . Essentially this mean &gt;= 1.0.0 and &lt; 1.1"}, {"owner": {"reputation": 4071, "user_id": 2354735, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Q33GM.jpg?s=128&g=1", "display_name": "Jet Blue", "link": "https://stackoverflow.com/users/2354735/jet-blue"}, "edited": false, "score": 0, "creation_date": 1528748562, "post_id": 50805429, "comment_id": 88616900, "body": "It is. <code>rails</code> is the first gem it tries to install."}, {"owner": {"reputation": 4071, "user_id": 2354735, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Q33GM.jpg?s=128&g=1", "display_name": "Jet Blue", "link": "https://stackoverflow.com/users/2354735/jet-blue"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528748657, "post_id": 50805429, "comment_id": 88616941, "body": "@engineersmnky interesting! You should write it as an answer so I can accept it."}], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 2041781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bb2528f353f3a89e73f9c82f27e4b5f2?s=128&d=identicon&r=PG", "display_name": "cryptic0", "link": "https://stackoverflow.com/users/2041781/cryptic0"}, "edited": false, "score": 0, "creation_date": 1552447143, "post_id": 50805637, "comment_id": 97008683, "body": "And what is the solution to this problem?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 215, "user_id": 2041781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bb2528f353f3a89e73f9c82f27e4b5f2?s=128&d=identicon&r=PG", "display_name": "cryptic0", "link": "https://stackoverflow.com/users/2041781/cryptic0"}, "edited": false, "score": 1, "creation_date": 1552447320, "post_id": 50805637, "comment_id": 97008717, "body": "@cryptic0 one could use <code>gem install bundler -v &#39;~&gt; 1.0.0&#39;</code>; however the question posed was &quot;If I have bundler version 1.16.2, why is it not considered to meet the ~&gt; 1.0.0 criteria?&quot; Which is why I answered the way I did."}, {"owner": {"reputation": 215, "user_id": 2041781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bb2528f353f3a89e73f9c82f27e4b5f2?s=128&d=identicon&r=PG", "display_name": "cryptic0", "link": "https://stackoverflow.com/users/2041781/cryptic0"}, "edited": false, "score": 0, "creation_date": 1552447460, "post_id": 50805637, "comment_id": 97008744, "body": "I had been getting a similar error, except it was expecting version 1.16.  So on a whim, I changed the gem file and updated the version to what I have on my system (2.0.1) and that did the trick.  For the record, I am trying to install a jekyll theme called Ed."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 2, "last_activity_date": 1528749359, "creation_date": 1528749359, "answer_id": 50805637, "question_id": 50805429, "link": "https://stackoverflow.com/questions/50805429/bundler-could-not-find-compatible-version-of-gem-despite-it-being-there/50805637#50805637", "title": "Bundler could not find compatible version of gem despite it being there?", "body": "<p>The <code>~&gt;</code> notation allows for the delineation of the incrementation whereby the least significant digit is allowed to differ from the specification. </p>\n\n<p>So in this case <code>~&gt; 1.0.0</code> means any version that is >= 1.0.0 and &lt; 1.1. </p>\n\n<p>However a notation of <code>~&gt; 1.0</code> would mean any version >= 1.0 and &lt; 2.0</p>\n\n<p>In your case <code>1.16.2</code> is clearly greater than <code>1.1</code> and thus fails the requirement set forth</p>\n"}], "owner": {"reputation": 4071, "user_id": 2354735, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Q33GM.jpg?s=128&g=1", "display_name": "Jet Blue", "link": "https://stackoverflow.com/users/2354735/jet-blue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 50805637, "answer_count": 1, "score": 1, "last_activity_date": 1528749359, "creation_date": 1528748410, "question_id": 50805429, "link": "https://stackoverflow.com/questions/50805429/bundler-could-not-find-compatible-version-of-gem-despite-it-being-there", "title": "Bundler could not find compatible version of gem despite it being there?", "body": "<p>I don't understand this error I receive when I run <code>bundle install</code>:</p>\n\n<pre><code>Bundler could not find compatible versions for gem \"bundler\":\n  In Gemfile:\n    rails (= 3.0.0) was resolved to 3.0.0, which depends on\n      bundler (~&gt; 1.0.0)\n\n  Current Bundler version:\n    bundler (1.16.2)\nThis Gemfile requires a different version of Bundler.\n</code></pre>\n\n<p>If I have bundler version <code>1.16.2</code>, why is it not considered to meet the <code>~&gt; 1.0.0</code> criteria?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528750096, "post_id": 50805684, "comment_id": 88617549, "body": "The form need not be submitted a simple <code>ajax</code> call would suffice. I am assuming this is what you mean in First One but your opening statement is a bit misleading"}, {"owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528750184, "post_id": 50805684, "comment_id": 88617584, "body": "@engineersmnky totally agree with you, So that I don&#39;t really prefer this solution and instead using <code>ajax</code> of course."}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528752685, "post_id": 50805684, "comment_id": 88618541, "body": "I have edited my post to provide my code chunck. @engineersmnky, can you also provide an example to work with ajax"}], "tags": [], "owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "is_accepted": false, "score": 1, "last_activity_date": 1528749603, "creation_date": 1528749603, "answer_id": 50805684, "question_id": 50805333, "link": "https://stackoverflow.com/questions/50805333/how-to-pass-selected-value-from-dropdown-and-access-it-as-a-parameter-for-cascad/50805684#50805684", "title": "How to pass selected value from dropdown and access it as a parameter for cascading dropdowns in rails", "body": "<p>So as I understand, You got more than one drop down list but the got dependency, Like <code>selected</code> value from <code>drop-down list 1</code> will affect values in <code>drop-down list 2</code>, In this case reaching the controller action will need the form to be submitted, If what I'm thinking about is right I have more than one idea:</p>\n\n<p><strong>First one</strong></p>\n\n<p>You will use <code>javascript</code> or <code>JQuery</code> library to add this dynamic behavior to you page, the scenario is going to be like this:</p>\n\n<p>1- User will select value</p>\n\n<p>2- an <code>actionListner</code> is fired using <code>js</code> when <code>select</code>.</p>\n\n<p>3- send a request to the server</p>\n\n<p>4- get data according to parameters you sent to the server</p>\n\n<p>5- enable the next drop-down list after binding returned data from the server.</p>\n\n<p>This solution won't need you to refresh the page, Which I think will make user satisfied.</p>\n\n<p><strong>Second solution</strong></p>\n\n<p>You will put <code>actionListner</code> on <code>drop-down</code> and submit the form when user select value.</p>\n\n<p>This gonna need a little bit validation in you server-side plus a little bit effort to save data that was filled if there is other inputs(saving them in instance variables I mean like <code>@select_drop_1</code> and use them in inputs as user gonna feel that values are not missed).</p>\n\n<p><strong>Third solution</strong></p>\n\n<p>If it is applicable that you make this data available once user opened the form, By this I mean <code>grouping</code> this data, Making a query that groups cities by these distinct names, So that when user select a name, a simple <code>js</code> code will run enabling and binding data to the next <code>drop-down</code> and so on.</p>\n\n<p>If I were you I would choose either <code>first</code> or <code>third</code> option, Pardon me because I don't know the schema of your application, I don't know if it is applicable to make <code>grouping</code> I'm imagining that Names got its table and there is another one called <code>City</code>.</p>\n\n<p>Hope it helps. </p>\n"}], "owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1528752632, "creation_date": 1528747940, "last_edit_date": 1528752632, "question_id": 50805333, "link": "https://stackoverflow.com/questions/50805333/how-to-pass-selected-value-from-dropdown-and-access-it-as-a-parameter-for-cascad", "title": "How to pass selected value from dropdown and access it as a parameter for cascading dropdowns in rails", "body": "<p><strong>Edited:</strong>\nI am trying to achieve cascading dropdown.</p>\n\n<p>In my 1st dropdown, I get all the distinct Names.</p>\n\n<pre><code>&lt;%= f.input :names, collection: names.distinctnames, :label =&gt; \"Select Name\" %&gt;\n</code></pre>\n\n<p>On selecting the name, how to access the value and pass it to controller/model so that I can filter based on the values and bind it to the next dropdown.</p>\n\n<p>In my Model, I have the following scope</p>\n\n<pre><code>scope :distinctnames, -&gt;{ Names.distinct.pluck(:names)}\n</code></pre>\n\n<p>Here, I want to add another scope that gives the cities for the selected name.</p>\n\n<p>So, how would I get the data selected in  my view and get all the values in the next dropdown.</p>\n\n<p>If this is the wrong approach, can someone suggest me the alternative one with and example.</p>\n\n<p>My code</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;script&gt;\n        $(document).on('change', '#names_id', function(){\n          var custId = $(this).val();\n          return custId;\n\n        });\n&lt;/head&gt;\n&lt;body&gt;\n&lt;div class=\"container\"&gt;\n  &lt;div class=\"row\"&gt;\n    &lt;div class=\"col-lg-6 col-lg-offset-3\"&gt;\n      &lt;div class=\"panel panel-primary\"&gt;\n        &lt;div class=\"panle-heading\"&gt;Panel Primary&lt;/div&gt;\n        &lt;div class=\"panel-body\"&gt;\n          &lt;%= simple_form_for @ruby, url:{action: 'create'}, html: {class: 'form'}  do |f| %&gt;\n            &lt;%= f.select :names_id, options_for_select(Names.distinctnames), {}, {:multiple =&gt; true} %&gt;\n            &lt;%= f.select :city_name, options_for_select(Names.where(names_id: custId).pluck(:city_name)), {}, {:multiple =&gt; true} %&gt;\n          &lt;% end %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Here, at the time of loading the the view I get undefined local variable or method `custId' for #&lt;#\n\n<p>How to load the all other dropdowns empty and then bind the value from the selected dropdown value to the second one.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "rails-admin"], "comments": [{"owner": {"reputation": 504, "user_id": 6007401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5db6f7de076ae3e9e278f1cffa02326?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6007401/john-doe"}, "edited": false, "score": 0, "creation_date": 1528747447, "post_id": 50805078, "comment_id": 88616441, "body": "Did you try to reset the db as described here <a href=\"https://stackoverflow.com/questions/19097558/pg-undefinedtable-error-relation-users-does-not-exist\" title=\"pg undefinedtable error relation users does not exist\">stackoverflow.com/questions/19097558/&hellip;</a>?"}, {"owner": {"reputation": 153, "user_id": 8334151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6758c1aa78966372db24e441484a264?s=128&d=identicon&r=PG&f=1", "display_name": "KH_", "link": "https://stackoverflow.com/users/8334151/kh"}, "reply_to_user": {"reputation": 504, "user_id": 6007401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5db6f7de076ae3e9e278f1cffa02326?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6007401/john-doe"}, "edited": false, "score": 0, "creation_date": 1528747783, "post_id": 50805078, "comment_id": 88616580, "body": "Yes, i tried all of those but nothing worked. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 504, "user_id": 6007401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5db6f7de076ae3e9e278f1cffa02326?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6007401/john-doe"}, "is_accepted": true, "score": 16, "last_activity_date": 1528748131, "creation_date": 1528748131, "answer_id": 50805372, "question_id": 50805078, "link": "https://stackoverflow.com/questions/50805078/pgundefinedtable-error-relation-active-storage-attachments-does-not-exist/50805372#50805372", "title": "PG::UndefinedTable - ERROR: relation &quot;active_storage_attachments&quot; does not exist", "body": "<p>Did you run <code>rails active_storage:install</code> as described on <a href=\"https://github.com/rails/rails/blob/d3893ec38ec61282c2598b01a298124356d6b35a/activestorage/README.md\" rel=\"noreferrer\">this page</a>? I believe this error might be due to your product attachments and the configuration which you mentioned.</p>\n"}], "owner": {"reputation": 153, "user_id": 8334151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6758c1aa78966372db24e441484a264?s=128&d=identicon&r=PG&f=1", "display_name": "KH_", "link": "https://stackoverflow.com/users/8334151/kh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3443, "favorite_count": 1, "accepted_answer_id": 50805372, "answer_count": 1, "score": 7, "last_activity_date": 1528748131, "creation_date": 1528746686, "question_id": 50805078, "link": "https://stackoverflow.com/questions/50805078/pgundefinedtable-error-relation-active-storage-attachments-does-not-exist", "title": "PG::UndefinedTable - ERROR: relation &quot;active_storage_attachments&quot; does not exist", "body": "<p>I just created a simple application for products and shopping cart with names, price and attachments. It's working fine without any issues. I decided to create admin and authentication using rails-admin gem and devise respectively.</p>\n\n<p>I have followed the instructions as explained <a href=\"https://codepany.com/blog/rails-5-user-accounts-with-3-types-of-roles-devise-rails_admin-cancancan/\" rel=\"noreferrer\">here</a>. It all worked fine until I got to the rails_admin part. I did everything as described except using rails_admin 1.3 version as described on the github page. I also tried the older version on the link but I encounter this error each time </p>\n\n<blockquote>\n<pre><code>PG::UndefinedTable - ERROR:  relation \"active_storage_attachments\" does    not exist\n LINE 8:                WHERE a.attrelid = '\"active_storage_attachmen...\n</code></pre>\n</blockquote>\n\n<p>I do not have any table by the name 'active_storage_attachments'. I found active_storage on the config file so I'm guessing this might be something caused by Rails configuration. Any assistance will be appreciated. If there is need to show some code from my app, I'll do that, although it's quite a huge code already.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bank"], "comments": [{"owner": {"reputation": 55, "user_id": 7246386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab63d3b1f5468ac5530747456b80501c?s=128&d=identicon&r=PG&f=1", "display_name": "Djodjo", "link": "https://stackoverflow.com/users/7246386/djodjo"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528747096, "post_id": 50804957, "comment_id": 88616277, "body": "Thanks for the reply, i changed with to what you said, and it spits this error app/controllers/patient_page_controller.rb:10:in `import_camt&#39;   Rendering /Users/Djodjo/.rvm/gems/ruby-2.4.0@global/gems/actionpack-5.&zwnj;&#8203;0.2/lib/action_dispa&zwnj;&#8203;tch/middleware/templ&zwnj;&#8203;ates/rescues/diagnos&zwnj;&#8203;tics.html.erb within rescues/layout   Rendering /Users/Djodjo/.rvm/gems/ruby-2.4.0@global/gems/actionpack-5.&zwnj;&#8203;0.2/lib/action_dispa&zwnj;&#8203;tch/middleware/templ&zwnj;&#8203;ates/rescues/_source&zwnj;&#8203;.html.erb   Rendered /Users/Djodjo/.rvm/gems/ruby-2.4.0@global/gems/actionpack-5.&zwnj;&#8203;0.2/lib/action_dispa&zwnj;&#8203;tch/middleware/templ&zwnj;&#8203;ates/rescues/_source&zwnj;&#8203;.html.erb"}, {"owner": {"reputation": 55, "user_id": 7246386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab63d3b1f5468ac5530747456b80501c?s=128&d=identicon&r=PG&f=1", "display_name": "Djodjo", "link": "https://stackoverflow.com/users/7246386/djodjo"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528747223, "post_id": 50804957, "comment_id": 88616338, "body": "and some more lines that I can paste if needed"}, {"owner": {"reputation": 55, "user_id": 7246386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab63d3b1f5468ac5530747456b80501c?s=128&d=identicon&r=PG&f=1", "display_name": "Djodjo", "link": "https://stackoverflow.com/users/7246386/djodjo"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528748128, "post_id": 50804957, "comment_id": 88616724, "body": "Works like a charm, thanks man!"}, {"owner": {"reputation": 55, "user_id": 7246386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab63d3b1f5468ac5530747456b80501c?s=128&d=identicon&r=PG&f=1", "display_name": "Djodjo", "link": "https://stackoverflow.com/users/7246386/djodjo"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528748545, "post_id": 50804957, "comment_id": 88616895, "body": "Could you explain me a bit more into details what is happening?"}], "answers": [{"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 0, "last_activity_date": 1528749540, "last_edit_date": 1528749540, "creation_date": 1528749116, "answer_id": 50805579, "question_id": 50804957, "link": "https://stackoverflow.com/questions/50804957/parse-a-xml-uploaded-with-camt-parser-rails-gem/50805579#50805579", "title": "Parse a xml uploaded with camt_parser rails gem", "body": "<p><code>CamtParser::File.parse</code> is expecting a file path but you are passing an <code>ActionDispatch::Http::UploadedFile</code> object. </p>\n\n<p>When you upload a file in rails the file is wrapped in an instance of <code>ActionDispatch::Http::UploadedFile</code>. To access the file itself there is an attribute called <code>tempfile</code>.</p>\n\n<p>This will return the <code>Tempfile</code> that represents the actual file that is being uploaded. A <code>Tempfile</code> has a <code>path</code> method which is the path to the file itself so since <code>CamtParser::File.parse</code> is expecting a file path it can be called as follows </p>\n\n<pre><code>CamtParser::File.parse(uploaded_file.tempfile.path) \n</code></pre>\n\n<p><code>CamtParser</code> also has a <code>String</code> class that can parse an appropriate string so you could call this as </p>\n\n<pre><code>CamtParser::String.parse(uploaded_file.read)\n</code></pre>\n\n<p>This works because <code>ActionDispatch::Http::UploadedFile</code> exposes the method <code>read</code> which is the same as calling <code>uploaded_file.tempfile.read</code></p>\n"}], "owner": {"reputation": 55, "user_id": 7246386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab63d3b1f5468ac5530747456b80501c?s=128&d=identicon&r=PG&f=1", "display_name": "Djodjo", "link": "https://stackoverflow.com/users/7246386/djodjo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 50805579, "answer_count": 1, "score": 0, "last_activity_date": 1528749540, "creation_date": 1528746114, "question_id": 50804957, "link": "https://stackoverflow.com/questions/50804957/parse-a-xml-uploaded-with-camt-parser-rails-gem", "title": "Parse a xml uploaded with camt_parser rails gem", "body": "<p>I installed the camt_parser gem in my rails app.\nMy goal is to upload and parse camt_file (.xml).</p>\n\n<p>It works perfectly when I parse from a local file this way:</p>\n\n<pre><code>require 'camt_parser'\nrequire 'camt'\ncamt = CamtParser::File.parse 'CAMT053_140518.xml'\nputs camt.group_header.creation_date_time\ncamt.statements.each do |statement|\n    statement.entries.each do |entry|\n        # Access individual entries/bank transfers\n     #   puts \"-&gt;\"\n     puts entry.description\n     puts entry.debit\n     p entry.transactions[0].iban\n     p entry.transactions[0].transaction_id\n     puts entry.transactions[0].debitor.iban\n    end\nend\n</code></pre>\n\n<p>But when I try to upload it from my view as a file using this code:</p>\n\n<pre><code>&lt;%= form_tag '/patient_page/import_camt', :multipart =&gt; true do %&gt;\n    &lt;label for=\"file\"&gt;Upload text File&lt;/label&gt; &lt;%= file_field_tag \"file\" %&gt;\n    &lt;%= submit_tag %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>and </p>\n\n<p>the corresponding method:</p>\n\n<pre><code>def import_camt\n    uploaded_file = params[:file]\n    parsed_file = uploaded_file.read\n    camt = CamtParser::File.parse uploaded_file\n    puts camt.group_header.creation_date_time\n    camt.statements.each do |statement|\n        statement.entries.each do |entry|\n\n        puts entry.description\n        puts entry.debit\n        p entry.transactions[0].iban\n        p entry.transactions[0].transaction_id\n        puts entry.transactions[0].debitor.iban\n        end\n    end\n  end\n</code></pre>\n\n<p>I get the following error</p>\n\n<p>\"no implicit conversion of ActionDispatch::Http::UploadedFile into String\"\nat the line when I try to parse the uploaded file.</p>\n\n<p>Any hints?</p>\n\n<p>Thx!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1528744946, "post_id": 50804682, "comment_id": 88615382, "body": "What is <code>2, 6</code>? A string? An Array? Why are you using a regular expression? Seems like an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>."}, {"owner": {"reputation": 93, "user_id": 9447658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737e381a3fe807cf38cc4cf88c67c14a?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Ruiz Perez", "link": "https://stackoverflow.com/users/9447658/sebastian-ruiz-perez"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1528745010, "post_id": 50804682, "comment_id": 88615404, "body": "@jvillian it is an array"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1528926695, "post_id": 50804682, "comment_id": 88697124, "body": "Can you explain what this has to do with regular expressions? Why are you asking about regular expressions and then accept an answer that doesn&#39;t use one?"}], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 2, "last_activity_date": 1528745024, "creation_date": 1528745024, "answer_id": 50804715, "question_id": 50804682, "link": "https://stackoverflow.com/questions/50804682/regular-expression-that-only-leaves-the-second-number/50804715#50804715", "title": "Regular expression that only leaves the second number", "body": "<pre><code>{\"1\"=&gt;\"2\", \"3\"=&gt;\"6\"}.values\n</code></pre>\n\n<p>will give you: </p>\n\n<pre><code>[\"2\", \"6\"] \n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 9447658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737e381a3fe807cf38cc4cf88c67c14a?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Ruiz Perez", "link": "https://stackoverflow.com/users/9447658/sebastian-ruiz-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 50804715, "answer_count": 1, "score": -4, "last_activity_date": 1528775855, "creation_date": 1528744874, "last_edit_date": 1528775855, "question_id": 50804682, "link": "https://stackoverflow.com/questions/50804682/regular-expression-that-only-leaves-the-second-number", "title": "Regular expression that only leaves the second number", "body": "<p>I'm trying to make a regular expression that leaves only the second number.</p>\n\n<pre><code>{\"1\"=&gt;\"2\", \"3\"=&gt;\"6\"}\n</code></pre>\n\n<p>For example, that leaves only the numbers:</p>\n\n<pre><code>2, 6\n</code></pre>\n\n<p>I tried this:</p>\n\n<pre><code>(([0-9]+)[=&gt;]*([0-9]+))\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528741528, "post_id": 50803901, "comment_id": 88613803, "body": "<code>idvalues.map</code> instead of <code>each</code>"}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528741903, "post_id": 50803901, "comment_id": 88613976, "body": "@engineersmnky tried that before but that returns all ids with <code>2 and 3</code>. I just want the first record for each ids. Also if I try  <code>array_object.find(id=id_value).first</code> it returns just 2 object with same id"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528741993, "post_id": 50803901, "comment_id": 88614025, "body": "sorry you need to change <code>find</code> to <code>find {|cp| cp.id == id_value}</code> not even sure how this is working for you right now if <code>array_object</code> is actually an <code>Array</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1528742239, "post_id": 50803901, "comment_id": 88614127, "body": "<code>idvalues.map {|id| array_object.find { |o| o.id == id} }</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1528743421, "post_id": 50803901, "comment_id": 88614684, "body": "where are these values coming from as it seems like the database would be the best place to handle this e.g. <code>CustomPrice.distinct.where(id: idvalues)</code>"}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528744750, "post_id": 50803901, "comment_id": 88615298, "body": "@engineersmnky These are not real database fields. These are from recurring event rules. An event can span multiple days. I am now figuring out a way to fetch pricing based on the overlapping of events(like full overlapping, partial and so on). So will pick a pricing based on the overlapping. Almost done with all those then I encountered this. Actually can store event itself instead of ids and thats a workaround as no need to do these mapping again. But was curious on how to make this work and thought could be just a simple <code>map</code> or <code>each</code> thing... :) Thank you for the support"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1528742373, "post_id": 50804022, "comment_id": 88614193, "body": "<code>array_object.group_by(&amp;:id).values_at(*id_values).map(&amp;:firs&zwnj;&#8203;t)</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1528742443, "post_id": 50804022, "comment_id": 88614225, "body": "Easier, but slower :) <code>group_by</code> seems to be a proper way to go."}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1528742573, "post_id": 50804022, "comment_id": 88614281, "body": "@engineersmnky yes its still returning same ids"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1528742648, "post_id": 50804022, "comment_id": 88614310, "body": "@Abhilash no, it won&#39;t (unless the idvalues array has duplicate ids, which according to the question is not the case - the pricings are duplicate)"}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1528742989, "post_id": 50804022, "comment_id": 88614471, "body": "@pascalbetz contains duplicate as I generated it using icecube recurring. As there is no database record for that I put same ids to easily reference back to the event."}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1528743220, "post_id": 50804022, "comment_id": 88614593, "body": "@pascalbetz that <code>uniq</code> wont work here as I have another date value which is different in each event. I removed that and some other fields from op as to make the question simpler. :)..Sorry for the confusion caused though.."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1528743344, "post_id": 50804022, "comment_id": 88614641, "body": "@Abhilash making the &quot;question simpler&quot; can make it harder to help please clarify the problem in your question because as of right now all of these alternative approaches are valid"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 1, "creation_date": 1528743508, "post_id": 50804022, "comment_id": 88614723, "body": "I&#39;m sure you&#39;ll find a answer that works for you :-)"}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1528745107, "post_id": 50804022, "comment_id": 88615434, "body": "@pascalbetz Thank you for the support. Still didn&#39;t fix my problem but this answers the op also got an idea on how to approach this kind of problem.. I will have a better look at this tomorrow. Now simply can&#39;t think any further. :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1528759342, "post_id": 50804022, "comment_id": 88620347, "body": "I considered <code>array_object.uniq(&amp;:id).select { |o| idvalues.include?(o) }</code>.  While <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-uniq\" rel=\"nofollow noreferrer\">Enumerable#uniq</a> is guaranteed to be order-preserving, <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-select\" rel=\"nofollow noreferrer\">Array#select</a> evidently is not. I therefore could not be certain that now or in future this would return the first element in <code>array_object</code> with <code>:id</code> having a given value in <code>idvalues</code>. (cont.)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1528759404, "post_id": 50804022, "comment_id": 88620368, "body": "...Similarly, the doc for <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerable#group_by</a> does not guarantee the order of the elements in each value of the hash returned. One would expect both of these methods would return values whose order is consistent with their order in <code>array_object</code>, but we must of course be certain of that. It may be that the specs for these methods contain an ordering test, but I am reluctant to make assumptions beyond the official doc for the method."}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1528773173, "post_id": 50804022, "comment_id": 88623103, "body": "@pascalbetz both <code>selected = idvalues.map {|id| array_object.find { |o| o.id == id} }</code> and  <code>selected =array_object.group_by(&amp;:id).values_at(*id_values).map(&amp;:fir&zwnj;&#8203;st)</code> working for me. Which one could be more efficient?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1528778601, "post_id": 50804022, "comment_id": 88624292, "body": "Abhilash, if <code>n = array_object.size</code> and <code>m = id_values.size</code>, computational efficiency is <code>O(n*m)</code> for the former and <code>O(n+m)</code> for the latter. That is, the problem with the former is that part of <code>array_object</code> must be traversed for each element of <code>id_values</code>. As I explained in my comments, however, the use of <code>group_by</code> does not appear to guarantee the production of a correct solution."}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1528864952, "post_id": 50804022, "comment_id": 88662618, "body": "@CarySwoveland  Thank you for the time in explaining this. Have a better understanding now."}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": true, "score": 3, "last_activity_date": 1528742993, "last_edit_date": 1528742993, "creation_date": 1528742017, "answer_id": 50804022, "question_id": 50803901, "link": "https://stackoverflow.com/questions/50803901/how-to-find-records-from-array-object-based-on-values-of-another-array-in-ruby/50804022#50804022", "title": "How to find records from array object based on values of another array in ruby", "body": "<p>One solution would be:</p>\n\n<pre><code>grouped = array_object.group_by(&amp;:id)\nselected = idvalues.uniq.map { |id| grouped[id].first }\n</code></pre>\n\n<p>(the uniq can be removed if the idvalues array does not contain any duplicates)</p>\n\n<p>Or another version </p>\n\n<pre><code>selected = array_object.group_by(&amp;:id).values_at(*id_values).map(&amp;:first)\n</code></pre>\n\n<p>(see comment by @mudasobwa to this answer)</p>\n\n<p>This first groups the pricings by <code>id</code> and then uses <code>map</code> to find a mapping of ids to a the first pricing with that ID.</p>\n\n<p>But the comment to your question by @mudasobwa shows a easier way to solve this:</p>\n\n<pre><code>selected = idvalues.map {|id| array_object.find { |o| o.id == id} }\n</code></pre>\n\n<p>Question remaining: why does <code>array_object</code> even contains duplicate pricings?</p>\n\n<p>If they were unique you could just use select:</p>\n\n<pre><code>selected = array_object.select { |pricing| idvalues.includes?(pricing.id) }\n</code></pre>\n\n<p>You could make the array uniq first:</p>\n\n<pre><code>selected = array_object.select { |pricing| idvalues.includes?(pricing.id) }\n</code></pre>\n\n<p>(if the objects in the array have a proper equality operator implemented)</p>\n\n<p>But honestly I think the array should not contain duplicate items in the first place. This sounds like a Query that could be optimized?</p>\n"}, {"comments": [{"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1528776437, "post_id": 50807315, "comment_id": 88623734, "body": "Thank you will have a look at this. In the accepted answer both <code>selected = idvalues.map {|id| array_object.find { |o| o.id == id} }</code> and  <code>selected =array_object.group_by(&amp;:id).values_at(*id_values).map(&amp;:fir&zwnj;&#8203;st)</code>  works for me. Is this approach more efficient than these?"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1528759277, "creation_date": 1528759277, "answer_id": 50807315, "question_id": 50803901, "link": "https://stackoverflow.com/questions/50803901/how-to-find-records-from-array-object-based-on-values-of-another-array-in-ruby/50807315#50807315", "title": "How to find records from array object based on values of another array in ruby", "body": "<p>Here is a way to extract the desired instances from <code>array_object</code> that is intended to be relatively efficient.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>require 'set'\n\ndef extract(array_object, id_values)\n  idv = id_values.to_set\n  arr = []\n  array_object.each do |obj|\n    id = obj[:id]\n    if idv.include?(id)\n      arr &lt;&lt; obj\n      idv.delete(id)\n    end\n    break if idv.empty?\n  end \n  idv.empty? ? arr : nil\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>id_values = [2, 3]\n\nCustomPricing = Struct.new(:id, :base_price) {}\narray_object = [[3, 700], [2, 500], [4, 900], [2, 500]].map do |id, bp|\n  CustomPricing.new(id, bp)\nend\n  #=&gt; [#&lt;struct CustomPricing id=3, base_price=700&gt;,\n  #    #&lt;struct CustomPricing id=2, base_price=500&gt;,\n  #    #&lt;struct CustomPricing id=4, base_price=900&gt;,\n  #    #&lt;struct CustomPricing id=2, base_price=500&gt;]\n</code></pre>\n\n<p>Readers unfamiliar with structs (or needing a brush-up) may wish to read <a href=\"https://www.leighhalliday.com/ruby-struct\" rel=\"nofollow noreferrer\">this article</a>. </p>\n\n<pre><code>extract(array_object, id_values)\n  #=&gt; [#&lt;struct CustomPricing id=3, base_price=700&gt;,\n  #    #&lt;struct CustomPricing id=2, base_price=500&gt;]\n</code></pre>\n\n<p>If the objects are to ordered by the values of <code>:id</code> that reflect their order in <code>id_values</code>, the penultimate line (<code>idv.empty? ? arr : nil</code>) can be replaced by the following.</p>\n\n<pre><code>idv.empty? ? arr.sort_by { |obj| id_values.index(obj[:id]) } : nil\n</code></pre>\n\n<p>which produces the following return value.</p>\n\n<pre><code>[#&lt;struct CustomPricing id=2, base_price=500&gt;,\n #&lt;struct CustomPricing id=3, base_price=700&gt;]\n</code></pre>\n"}], "owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 50804022, "answer_count": 2, "score": 1, "last_activity_date": 1528759277, "creation_date": 1528741452, "question_id": 50803901, "link": "https://stackoverflow.com/questions/50803901/how-to-find-records-from-array-object-based-on-values-of-another-array-in-ruby", "title": "How to find records from array object based on values of another array in ruby", "body": "<p>Lets say we have an array containing ids of objects that need to be fetched</p>\n\n<p>This is the ids that need to fetched from another object array</p>\n\n<pre><code>`idvalues=[2,3]`\n</code></pre>\n\n<p>This is the object array</p>\n\n<pre><code> array_object=[#&lt;CustomPricing id: 2, base_price: 500&gt;, #&lt;CustomPricing id: 3, base_price: 700&gt;, #&lt;CustomPricing id: 4, base_price: 900&gt;, #&lt;CustomPricing id: 2, base_price: 500&gt;]\n</code></pre>\n\n<p>How can we fetch objects with the <code>id's</code> <code>2</code> &amp; <code>3</code> and put them in new array. Here also there are multiple records with same id so just want the first record only.</p>\n\n<p>I tried like this       </p>\n\n<pre><code>events = idvalues.each {|id_value| array_object.find(id=id_value)}\n</code></pre>\n\n<p>but this returned the <code>idvalue</code> itself which is <code>[2,3]</code>. How can we achieve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 116, "user_id": 7755288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d667a4f6415eddb5abbd701b6296eadc?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh V", "link": "https://stackoverflow.com/users/7755288/rajesh-v"}, "edited": false, "score": 0, "creation_date": 1528736514, "post_id": 50802694, "comment_id": 88611441, "body": "Can you remove Gemfile.lock and try?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9726814"}, "edited": false, "score": 1, "creation_date": 1528736578, "post_id": 50802694, "comment_id": 88611470, "body": "Try to run <code>bundle doctor</code> or <code>bundle show</code> and post any unusual results. Just a guess."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1528736729, "post_id": 50802694, "comment_id": 88611556, "body": "Try uninstalling it and installing it again. Sometimes it&#39;s &quot;installed&quot; but the dependencies are broken so it can&#39;t load. Also try a minimal script like <code>require &#39;nokogiri&#39;</code> to see if that works or not."}, {"owner": {"reputation": 298, "user_id": 2771419, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3359ecf8fb3a7695dd897d7a93ae3646?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy", "link": "https://stackoverflow.com/users/2771419/timmy"}, "edited": false, "score": 0, "creation_date": 1528746990, "post_id": 50802694, "comment_id": 88616236, "body": "Thanks for the suggestions.  I removed the Gemfile.lock  - to no avail.  I ran bundle doctor and received &quot;The Gemfile&#39;s dependencies are satisfied. No issues found with the installed bundle.&quot; I tried &#39;require nokogiri&#39; in IRB and it returns true.  Any other suggestions?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528812646, "post_id": 50802694, "comment_id": 88643719, "body": "@Timmy given your output you ran <code>bundle install</code> in a different folder than where you are running the rake task from e.g. <i>&quot;my_folder/name_generator$ bundle install&quot;</i> and <i>&quot;John_Gray/name_generator$ bundle exec rake db:migrate:reset&quot;</i> This will cause an issue and you should run the install from the root where you intend to run the rake task from"}, {"owner": {"reputation": 298, "user_id": 2771419, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3359ecf8fb3a7695dd897d7a93ae3646?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy", "link": "https://stackoverflow.com/users/2771419/timmy"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528900060, "post_id": 50802694, "comment_id": 88683191, "body": "Thanks @engineersmnky, Thanks, that&#39;s a good catch.  That log is from my flurry of trying to figure out what is going on.   Running everything from the /John_Gray/name_generator produces the same &quot;Could not find nokogiri...&quot; error.   On top of that I&#39;m running this in a Ruby 2.5.1 with Rails 5.1.6 environment via RVM.  When I try to run anything in this environment (even create a blank scaffold) any rake tasks return the &quot;Could not find nokogiri...&quot; error.  If I revert to Ruby 2.4.2 with Rails 4.x or 5.0.x the error does not come up and everything is successful.  So I figure it may be RVM?"}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 7755288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d667a4f6415eddb5abbd701b6296eadc?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh V", "link": "https://stackoverflow.com/users/7755288/rajesh-v"}, "edited": false, "score": 0, "creation_date": 1528737511, "post_id": 50802930, "comment_id": 88611908, "body": "I like the way you look so closely at things :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1528737756, "post_id": 50802930, "comment_id": 88612010, "body": "The actual terminal error shows the correct spelling so this appears to just be a transposition typo and I am not sure that this qualifies as an &quot;answer&quot;"}], "tags": [], "owner": {"reputation": 13948, "user_id": 283342, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e3ef6dbec3a443e7cda5b5624311ca08?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/283342/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1528737173, "creation_date": 1528737173, "answer_id": 50802930, "question_id": 50802694, "link": "https://stackoverflow.com/questions/50802694/could-not-find-nokogiri-1-8-2-however-it-is-installed/50802930#50802930", "title": "&quot;Could not find nokogiri-1.8.2..&quot; However, it is installed", "body": "<p>Your error message says \"nokkogiri\" but the gem's name is \"nokogiri.\" (Only one 'k').</p>\n"}, {"comments": [{"owner": {"reputation": 298, "user_id": 2771419, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3359ecf8fb3a7695dd897d7a93ae3646?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy", "link": "https://stackoverflow.com/users/2771419/timmy"}, "edited": false, "score": 0, "creation_date": 1528747064, "post_id": 50803193, "comment_id": 88616268, "body": "Thanks Rajesh.  I tried this method and get the same error.  It looks like it is installed, but does not run.  I also am able to <code>require &#39;nokogiri&#39;</code> in an IRB console and it works."}, {"owner": {"reputation": 116, "user_id": 7755288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d667a4f6415eddb5abbd701b6296eadc?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh V", "link": "https://stackoverflow.com/users/7755288/rajesh-v"}, "reply_to_user": {"reputation": 298, "user_id": 2771419, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3359ecf8fb3a7695dd897d7a93ae3646?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy", "link": "https://stackoverflow.com/users/2771419/timmy"}, "edited": false, "score": 0, "creation_date": 1528796578, "post_id": 50803193, "comment_id": 88632959, "body": "Can you also try un/re install bundler,  Also what version of Ruby are you using, if you have version manager like RVM and Rbenv then try to remove that Ruby verision and reinstall it as well."}], "tags": [], "owner": {"reputation": 116, "user_id": 7755288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d667a4f6415eddb5abbd701b6296eadc?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh V", "link": "https://stackoverflow.com/users/7755288/rajesh-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1528738221, "creation_date": 1528738221, "answer_id": 50803193, "question_id": 50802694, "link": "https://stackoverflow.com/questions/50802694/could-not-find-nokogiri-1-8-2-however-it-is-installed/50803193#50803193", "title": "&quot;Could not find nokogiri-1.8.2..&quot; However, it is installed", "body": "<p>Try these</p>\n\n<pre><code>bundle config build.nokogiri --use-system-libraries\nbundle install\n</code></pre>\n\n<p>also see these installation options \n<a href=\"http://www.nokogiri.org/tutorials/installing_nokogiri.html\" rel=\"nofollow noreferrer\">http://www.nokogiri.org/tutorials/installing_nokogiri.html</a></p>\n"}], "owner": {"reputation": 298, "user_id": 2771419, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3359ecf8fb3a7695dd897d7a93ae3646?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy", "link": "https://stackoverflow.com/users/2771419/timmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2721, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528738792, "creation_date": 1528736184, "last_edit_date": 1528738792, "question_id": 50802694, "link": "https://stackoverflow.com/questions/50802694/could-not-find-nokogiri-1-8-2-however-it-is-installed", "title": "&quot;Could not find nokogiri-1.8.2..&quot; However, it is installed", "body": "<p>Really weird error I've never gotten before, hoping someone else has seen this.</p>\n\n<p>I'm trying to <code>bundle exec rake db:migrate:reset</code> and I'm getting</p>\n\n<blockquote>\n  <p>Could not find nokogiri-1.8.2 in any of the sources.  Run 'bundle install' to install missing gems.</p>\n</blockquote>\n\n<p>I have ran <code>bundle install</code> and I see nokogiri installed:</p>\n\n<pre><code>cli:~/projects/interviews/my_folder/name_generator$ bundle install\nUsing rake 12.3.1\nUsing concurrent-ruby 1.0.5\nUsing i18n 1.0.1\nUsing minitest 5.11.3\nUsing thread_safe 0.3.6\nUsing tzinfo 1.2.5\nUsing activesupport 5.1.6\nUsing builder 3.2.3\nUsing erubi 1.7.1\nUsing mini_portile2 2.3.0\nUsing nokogiri 1.8.2 &lt;------------ Here?!\nUsing rails-dom-testing 2.0.3\nUsing crass 1.0.4\nUsing loofah 2.2.2\nUsing rails-html-sanitizer 1.0.4\nUsing actionview 5.1.6\nUsing rack 2.0.5\nUsing rack-test 1.0.0\nUsing actionpack 5.1.6\nUsing nio4r 2.3.1\nUsing websocket-extensions 0.1.3\nUsing websocket-driver 0.6.5\nUsing actioncable 5.1.6\nUsing globalid 0.4.1\nUsing activejob 5.1.6\nUsing mini_mime 1.0.0\nUsing mail 2.7.0\nUsing actionmailer 5.1.6\nUsing activemodel 5.1.6\nUsing arel 8.0.0\nUsing activerecord 5.1.6\nUsing activerecord-import 0.23.0\nUsing public_suffix 3.0.2\nUsing addressable 2.5.2\nUsing bindex 0.5.0\nUsing bundler 1.16.2\nUsing byebug 10.0.2\nUsing xpath 3.0.0\nUsing capybara 2.18.0\nUsing ffi 1.9.23\nUsing childprocess 0.9.0\nUsing coderay 1.1.2\nUsing coffee-script-source 1.12.2\nUsing execjs 2.7.0\nUsing coffee-script 2.4.1\nUsing method_source 0.9.0\nUsing thor 0.20.0\nUsing railties 5.1.6\nUsing coffee-rails 4.2.2\nUsing multi_json 1.13.1\nUsing jbuilder 2.7.0\nUsing rb-fsevent 0.10.3\nUsing rb-inotify 0.9.10\nUsing ruby_dep 1.5.0\nUsing listen 3.1.5\nUsing pg 1.0.0\nUsing pry 0.11.3\nUsing puma 3.11.4\nUsing sprockets 3.7.1\nUsing sprockets-rails 3.2.1\nUsing rails 5.1.6\nUsing rubyzip 1.2.1\nUsing sass-listen 4.0.0\nUsing sass 3.5.6\nUsing tilt 2.0.8\nUsing sass-rails 5.0.7\nUsing selenium-webdriver 3.12.0\nUsing spring 2.0.2\nUsing spring-watcher-listen 2.0.1\nUsing turbolinks-source 5.1.0\nUsing turbolinks 5.1.1\nUsing uglifier 4.1.10\nUsing web-console 3.6.2\nBundle complete! 18 Gemfile dependencies, 73 gems now installed.\nUse `bundle info [gemname]` to see where a bundled gem is installed.\nclil:~/projects/interviews/John_Gray/name_generator$ bundle exec rake db:migrate:reset\nCould not find nokogiri-1.8.2 in any of the sources\nRun `bundle install` to install missing gems.\ncli:~/projects/interviews/John_Gray/name_generator$ \n</code></pre>\n"}]