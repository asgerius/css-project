[{"tags": ["ruby-on-rails", "ruby", "linux", "windows"], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 11137033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sCsSkrYNAxY/AAAAAAAAAAI/AAAAAAAAC08/WSC-0W77zzY/photo.jpg?sz=128", "display_name": "Mahmoud Mousa Hamad", "link": "https://stackoverflow.com/users/11137033/mahmoud-mousa-hamad"}, "edited": false, "score": 1, "creation_date": 1565278374, "post_id": 57404619, "comment_id": 101312135, "body": "Running the command worked, which answered my question, but I didn&#39;t have a chance to write to it. I understand that, in a Linux environment, you would normally add a <code>--wait</code> flag or something similar when specifying the editor so that you can have a chance to edit it. Do you happen to know how can I make the editor wait for me to make edits and then save?"}, {"owner": {"reputation": 429, "user_id": 11887947, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5pQAXxfFqFI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfZs4NiEK4h3cmWvHJWbXG3Y85vMw/photo.jpg?sz=128", "display_name": "CodingSomething", "link": "https://stackoverflow.com/users/11887947/codingsomething"}, "reply_to_user": {"reputation": 199, "user_id": 11137033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sCsSkrYNAxY/AAAAAAAAAAI/AAAAAAAAC08/WSC-0W77zzY/photo.jpg?sz=128", "display_name": "Mahmoud Mousa Hamad", "link": "https://stackoverflow.com/users/11137033/mahmoud-mousa-hamad"}, "edited": false, "score": 0, "creation_date": 1565283473, "post_id": 57404619, "comment_id": 101314619, "body": "I do not have a Windows computer to test it. But from what I&#39;ve heard from my colleagues, adding --wait to atom works."}], "tags": [], "owner": {"reputation": 429, "user_id": 11887947, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5pQAXxfFqFI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfZs4NiEK4h3cmWvHJWbXG3Y85vMw/photo.jpg?sz=128", "display_name": "CodingSomething", "link": "https://stackoverflow.com/users/11887947/codingsomething"}, "is_accepted": true, "score": 3, "last_activity_date": 1565233367, "creation_date": 1565233367, "answer_id": 57404619, "question_id": 57402435, "link": "https://stackoverflow.com/questions/57402435/how-to-run-rails-credentialsedit-on-windows-10-without-installing-a-linux-sub/57404619#57404619", "title": "How to run &#39;rails credentials:edit&#39; on Windows 10 without installing a Linux Subsystem", "body": "<p>I would suggest you switch to non-windows based system if you're trying to do any rails development as I used to work on a windows machine until I caved in and switched entirely to Mate Linux. It would be so much easier to develop Rails application on Linux platform since you would see almost all gems compiling without any issue and all the rails terminal commands are working without further setup.</p>\n\n<p>However, if you would like to edit your credentials, you need a text editor (Usually vim on Linux) setup before running credentials:edit.</p>\n\n<p>First run <code>SET EDITOR=\"notepad_path\"</code> and then try running <code>rails credentials:edit</code></p>\n\n<p>You can change notepad_path to any other text editor you prefer. However, some editors like Atom was giving weird issues for me. </p>\n"}, {"comments": [{"owner": {"reputation": 2828, "user_id": 3330613, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/a8pQr.jpg?s=128&g=1", "display_name": "MSC", "link": "https://stackoverflow.com/users/3330613/msc"}, "edited": false, "score": 0, "creation_date": 1569747082, "post_id": 57913618, "comment_id": 102690445, "body": "This doesn&#39;t work. Notepad doesn&#39;t open yet Rails displays: &quot;New credentials encrypted and saved.&quot;"}, {"owner": {"reputation": 29, "user_id": 11677301, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCv8w_CNXkE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfH3aTjr2I2ne3znlCRSDW5wtdeBQ/mo/photo.jpg?sz=128", "display_name": "Jonathan Johnson", "link": "https://stackoverflow.com/users/11677301/jonathan-johnson"}, "reply_to_user": {"reputation": 2828, "user_id": 3330613, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/a8pQr.jpg?s=128&g=1", "display_name": "MSC", "link": "https://stackoverflow.com/users/3330613/msc"}, "edited": false, "score": 0, "creation_date": 1570038729, "post_id": 57913618, "comment_id": 102791627, "body": "Notepad should open in a new window with the decyphered info if not check your settings and make sure CMD ( or terminal of choice ) has access to open the text editor you are using. also, make sure no other settings are blocking this process. if you have any questions on my instructions let me know I tried my best to lay everything out as clearly as possible but I probably could have explained it better"}], "tags": [], "owner": {"reputation": 29, "user_id": 11677301, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCv8w_CNXkE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfH3aTjr2I2ne3znlCRSDW5wtdeBQ/mo/photo.jpg?sz=128", "display_name": "Jonathan Johnson", "link": "https://stackoverflow.com/users/11677301/jonathan-johnson"}, "is_accepted": false, "score": 2, "last_activity_date": 1570038054, "last_edit_date": 1570038054, "creation_date": 1568317734, "answer_id": 57913618, "question_id": 57402435, "link": "https://stackoverflow.com/questions/57402435/how-to-run-rails-credentialsedit-on-windows-10-without-installing-a-linux-sub/57913618#57913618", "title": "How to run &#39;rails credentials:edit&#39; on Windows 10 without installing a Linux Subsystem", "body": "<ol>\n<li>find your pathing to your local text editor (for windows its Notepad) you can search notepad and right-click and open the file location </li>\n<li>right-click notepad and open properties then copy the Target:(EX.( \"%windir%\\system32\\notepad.exe\"))</li>\n<li>now paste the target in SET EDITOR=\"target_path\"\nEX. <code>SET EDITOR=\"%windir%\\system32\\notepad.exe\"</code></li>\n<li>now you can run <code>bundle exec rails credentials:edit</code> and notepad should come up with the decrypted info </li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 12478479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f256246c3c7542e2f98118dbdd68c83?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Ryan", "link": "https://stackoverflow.com/users/12478479/dale-ryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1575450714, "creation_date": 1575450714, "answer_id": 59172430, "question_id": 57402435, "link": "https://stackoverflow.com/questions/57402435/how-to-run-rails-credentialsedit-on-windows-10-without-installing-a-linux-sub/59172430#59172430", "title": "How to run &#39;rails credentials:edit&#39; on Windows 10 without installing a Linux Subsystem", "body": "<h1>I'm using windows 10 and here are the steps that I took:</h1>\n\n<ol>\n<li>make sure you have the path of your text editor in <b>environment variables PATH</b>\n\n<ul>\n<li>to do that, copy the file location of your text editor</li>\n<li>right click on my computer(This PC) > select properties > advanced system settings > environment variables</li>\n<li>on System variable box, click for \"Path\" > click edit > new > paste text editor file location</li>\n</ul></li>\n<li>restart command line then try to open text editor using the command line. I'm using sublime and entering \"subl\" will open sublime text editor</li>\n<li>cd to your project folder then run the following command:</li>\n</ol>\n\n<pre class=\"lang-sh prettyprint-override\"><code>set EDITOR=subl --wait\n</code></pre>\n\n<ul>\n<li>where subl is the executable file of the text editor</li>\n<li>also without double or single quote, this will work since subl is an executable file and was registered on environment variable (if using notepad use: notepad).</li>\n<li>Without the --wait flag, your <b>credentials.yml.enc</b> will be saved immediately without giving you the chance to edit.</li>\n<li>alternatively you can directly set EDITOR similar to this:</li>\n</ul>\n\n<pre class=\"lang-sh prettyprint-override\"><code>set EDITOR=\"C:\\filepath\\to\\your\\editor --wait\"\n</code></pre>\n\n<ul>\n<li><p>this time with quotes</p>\n\n<ol start=\"4\">\n<li>Finally run:</li>\n</ol></li>\n</ul>\n\n<pre><code>rails credentials:edit\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66009, "user_id": 23368, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ace1b52352e1260c6a42df36e36f356?s=128&d=identicon&r=PG", "display_name": "Daniel Rikowski", "link": "https://stackoverflow.com/users/23368/daniel-rikowski"}, "edited": false, "score": 2, "creation_date": 1582018801, "post_id": 59291916, "comment_id": 106622451, "body": "You can use <code>SET EDITOR=&quot;C:&#47;Program Files&#47;Notepad++&#47;notepad++.exe&quot; -multiInst -notabbar -nosession -noPlugin</code> to get a single-file instance which doesn&#39;t interfere with your regular instance. This is the same command line which Git for Windows uses."}], "tags": [], "owner": {"reputation": 91, "user_id": 3356802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bd2e110ef8285ca2f00c1e167f27e83?s=128&d=identicon&r=PG&f=1", "display_name": "user3356802", "link": "https://stackoverflow.com/users/3356802/user3356802"}, "is_accepted": false, "score": 7, "last_activity_date": 1576088776, "creation_date": 1576088776, "answer_id": 59291916, "question_id": 57402435, "link": "https://stackoverflow.com/questions/57402435/how-to-run-rails-credentialsedit-on-windows-10-without-installing-a-linux-sub/59291916#59291916", "title": "How to run &#39;rails credentials:edit&#39; on Windows 10 without installing a Linux Subsystem", "body": "<p>I didn't find any of the answers above worked for me. Notepad complained about the directory being incorrect and gave me a blank file.</p>\n\n<p>I got it to work with Notepad++ by doing the following:</p>\n\n<pre><code>SET EDITOR=\"C:\\Program Files\\Notepad++\\notepad++.exe\"\nrails credentials:edit\n</code></pre>\n\n<p>I didn't need to use the <code>--wait</code> flag.</p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 5254729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8enGT.png?s=128&g=1", "display_name": "zmd94", "link": "https://stackoverflow.com/users/5254729/zmd94"}, "is_accepted": false, "score": 0, "last_activity_date": 1587384475, "last_edit_date": 1587384475, "creation_date": 1587380386, "answer_id": 61320838, "question_id": 57402435, "link": "https://stackoverflow.com/questions/57402435/how-to-run-rails-credentialsedit-on-windows-10-without-installing-a-linux-sub/61320838#61320838", "title": "How to run &#39;rails credentials:edit&#39; on Windows 10 without installing a Linux Subsystem", "body": "<p>[Windows 8.1]</p>\n\n<p>I'm using <code>SET EDITOR=\"C:\\Program Files (x86)\\Notepad++\\notepad++.exe\" -multiInst -notabbar -nosession -noPlugin</code> command to set the editor and it works. </p>\n\n<p>Next, just run <code>rails credentials:edit</code> command. Then you can edit the <code>credentials.yml</code> file. Save it and close the Notepad++ windows. Then the credentials is encrypted and saved automatically.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12700088, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDXpi5J2CIB1vlzkze1L08Eg24OnOzGDApISr613g=k-s128", "display_name": "Vladimir Ojeda", "link": "https://stackoverflow.com/users/12700088/vladimir-ojeda"}, "is_accepted": false, "score": 1, "last_activity_date": 1588966673, "creation_date": 1588966673, "answer_id": 61686811, "question_id": 57402435, "link": "https://stackoverflow.com/questions/57402435/how-to-run-rails-credentialsedit-on-windows-10-without-installing-a-linux-sub/61686811#61686811", "title": "How to run &#39;rails credentials:edit&#39; on Windows 10 without installing a Linux Subsystem", "body": "<p>If you are in a Windows environment, I highly recommend to use the classic notepad. In my experience using Notepad++, sometimes it opened correctly but didn't save, instead it works perfect with the classic notepad. </p>\n\n<p>Also to run those mentioned commands, better use the classic cmd shell console, it might not work properly in PS (Power Shell) console. Good luck!</p>\n"}, {"comments": [{"owner": {"reputation": 68, "user_id": 9618146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Apoorv Chandurkar", "link": "https://stackoverflow.com/users/9618146/apoorv-chandurkar"}, "edited": false, "score": 0, "creation_date": 1603261671, "post_id": 63611824, "comment_id": 113977253, "body": "Thanks, it&#39;s the cleanest solution!"}], "tags": [], "owner": {"reputation": 419, "user_id": 5476956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99dbd04180098b944b7303fdfab9eb2?s=128&d=identicon&r=PG&f=1", "display_name": "Molp Burnbright", "link": "https://stackoverflow.com/users/5476956/molp-burnbright"}, "is_accepted": false, "score": 6, "last_activity_date": 1598515989, "creation_date": 1598515989, "answer_id": 63611824, "question_id": 57402435, "link": "https://stackoverflow.com/questions/57402435/how-to-run-rails-credentialsedit-on-windows-10-without-installing-a-linux-sub/63611824#63611824", "title": "How to run &#39;rails credentials:edit&#39; on Windows 10 without installing a Linux Subsystem", "body": "<p>I'm using VS Code and Powershell within VS Code, and this works for me:</p>\n<pre><code>&gt; $env:EDITOR=&quot;code --wait&quot;\n&gt; rails credentials:edit\n</code></pre>\n<p>Credit goes to this article <a href=\"https://flexpoint.tech/2020/05/16/editing-rails-6-0-credentials-on-windows/\" rel=\"noreferrer\">https://flexpoint.tech/2020/05/16/editing-rails-6-0-credentials-on-windows/</a> by J. Pablo Fern\u00e1ndez</p>\n"}, {"tags": [], "owner": {"reputation": 368, "user_id": 6069435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5688uZP2XRI/AAAAAAAAAAI/AAAAAAAAAMo/bKqKG-U3uJw/photo.jpg?sz=128", "display_name": "Ruan Nawe", "link": "https://stackoverflow.com/users/6069435/ruan-nawe"}, "is_accepted": false, "score": 1, "last_activity_date": 1607556923, "creation_date": 1607556923, "answer_id": 65226469, "question_id": 57402435, "link": "https://stackoverflow.com/questions/57402435/how-to-run-rails-credentialsedit-on-windows-10-without-installing-a-linux-sub/65226469#65226469", "title": "How to run &#39;rails credentials:edit&#39; on Windows 10 without installing a Linux Subsystem", "body": "<pre><code>No $EDITOR to open file in. Assign one like this:\n\nEDITOR=&quot;mate --wait&quot; bin/rails credentials:edit\n\nFor editors that fork and exit immediately, it's important to pass a wait flag,\notherwise the credentials will be saved immediately with no chance to edit.\n</code></pre>\n<p>solution:</p>\n<pre><code>$env:EDITOR=&quot;notepad&quot;\nrails credentials:edit\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 11137033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sCsSkrYNAxY/AAAAAAAAAAI/AAAAAAAAC08/WSC-0W77zzY/photo.jpg?sz=128", "display_name": "Mahmoud Mousa Hamad", "link": "https://stackoverflow.com/users/11137033/mahmoud-mousa-hamad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2431, "favorite_count": 0, "accepted_answer_id": 57404619, "answer_count": 8, "score": 7, "last_activity_date": 1607556923, "creation_date": 1565212797, "question_id": 57402435, "link": "https://stackoverflow.com/questions/57402435/how-to-run-rails-credentialsedit-on-windows-10-without-installing-a-linux-sub", "title": "How to run &#39;rails credentials:edit&#39; on Windows 10 without installing a Linux Subsystem", "body": "<p>I am trying to run the following command on my Rails app on my Windows 10 machine:</p>\n\n<pre><code>rails credentials:edit\n</code></pre>\n\n<p>But I get the following error message:</p>\n\n<blockquote>\n  <p>No $EDITOR to open file in. Assign one like this:</p>\n  \n  <p>EDITOR=\"mate --wait\" bin/rails credentials:edit</p>\n  \n  <p>For editors that fork and exit immediately, it's important to pass a\n  wait flag, otherwise the credentials will be saved immediately with no\n  chance to edit.</p>\n</blockquote>\n\n<p>I did some research, and I understand that most people who want to run such aforementioned command on Windows 10 will need to install a Linux Subsystem on their Windows machines. However, such option is not available for me because I don't have admin rights on my machine. I have attempted installing a Linux subsystem by using resources like the one <a href=\"https://superuser.com/questions/1271682/is-there-a-way-of-installing-windows-subsystem-for-linux-on-win10-v1709-withou\">here</a> without luck.</p>\n"}, {"tags": ["ruby", "net-http", "duckduckgo"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 1, "creation_date": 1565212058, "post_id": 57402270, "comment_id": 101286130, "body": "See <a href=\"https://duckduckgo.com/api\" rel=\"nofollow noreferrer\">duckduckgo.com/api</a>"}, {"owner": {"reputation": 1, "user_id": 11898531, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-M7Km28CtlYg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdcTufTyXG5cx1QIa1s9FIf9yYdLA/photo.jpg?sz=128", "display_name": "Zoli Gera", "link": "https://stackoverflow.com/users/11898531/zoli-gera"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1565212167, "post_id": 57402270, "comment_id": 101286162, "body": "Thanks Holger, but is only working for simple queries, for a query &#39;whytheluckystaff&#39;, returning empty result as they don&#39;t have proper api solution for search results, etc. this is throwing an empty json:   <a href=\"https://api.duckduckgo.com/?q=whytheluckystaff&amp;format=json\" rel=\"nofollow noreferrer\">api.duckduckgo.com/?q=whytheluckystaff&amp;format=json</a>"}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1565212610, "post_id": 57402270, "comment_id": 101286296, "body": "DuckDockGo doesn&#39;t have then necessary rights to fully allow this (as explained on the site I linked to). As such, using the data you attempt to scrape there will very likely be copyright infringement."}, {"owner": {"reputation": 1, "user_id": 11898531, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-M7Km28CtlYg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdcTufTyXG5cx1QIa1s9FIf9yYdLA/photo.jpg?sz=128", "display_name": "Zoli Gera", "link": "https://stackoverflow.com/users/11898531/zoli-gera"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1565212761, "post_id": 57402270, "comment_id": 101286344, "body": "Well, is for personal educational use, so should not breach any copyright, however wondering if there any solution for my issue."}, {"owner": {"reputation": 61, "user_id": 6841853, "user_type": "registered", "profile_image": "https://graph.facebook.com/797929556976822/picture?type=large", "display_name": "Kuanish Esenbaev", "link": "https://stackoverflow.com/users/6841853/kuanish-esenbaev"}, "edited": false, "score": 3, "creation_date": 1565240170, "post_id": 57402270, "comment_id": 101291907, "body": "Try to use gems like <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">HTTParty</a> for net/http requests, and <a href=\"https://github.com/sparklemotion/nokogiri\" rel=\"nofollow noreferrer\">Nokogiri</a> in order to parse html response"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11898531, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-M7Km28CtlYg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdcTufTyXG5cx1QIa1s9FIf9yYdLA/photo.jpg?sz=128", "display_name": "Zoli Gera", "link": "https://stackoverflow.com/users/11898531/zoli-gera"}, "edited": false, "score": 0, "creation_date": 1565297263, "post_id": 57417102, "comment_id": 101320175, "body": "Thanks Kris, this is what I was looking for."}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 0, "last_activity_date": 1565282011, "creation_date": 1565282011, "answer_id": 57417102, "question_id": 57402270, "link": "https://stackoverflow.com/questions/57402270/duckduckgo-com-to-get-the-first-n-results-for-the-specified-phrase-using-neth/57417102#57417102", "title": "duckduckgo.com to get the first N results for the specified phrase, using Net::HTTP ruby", "body": "<p>An example with <a href=\"https://nokogiri.org/\" rel=\"nofollow noreferrer\">Nokogiri</a>:</p>\n\n<pre><code>require 'nokogiri'\n\npage = Nokogiri::HTML(open(\"https://duckduckgo.com/?q=#{str}\").read)\npage.doc.css('a').first.attr(:href)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11898531, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-M7Km28CtlYg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdcTufTyXG5cx1QIa1s9FIf9yYdLA/photo.jpg?sz=128", "display_name": "Zoli Gera", "link": "https://stackoverflow.com/users/11898531/zoli-gera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565282011, "creation_date": 1565211927, "last_edit_date": 1565212659, "question_id": 57402270, "link": "https://stackoverflow.com/questions/57402270/duckduckgo-com-to-get-the-first-n-results-for-the-specified-phrase-using-neth", "title": "duckduckgo.com to get the first N results for the specified phrase, using Net::HTTP ruby", "body": "<p>I am trying to parse results from duckduckgo search with Net::HTTP and store the links of the results of the array. However the result comes as a string. Any idea how get it any other type of data back as result or how to get the links from the string if there is no option to get the response in another type? </p>\n\n<pre><code>def getlinks(str, num_results)\n    uri = URI.parse(\"https://duckduckgo.com/?q=#{str}\")\n    response = Net::HTTP.get_response(uri)\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1565211122, "post_id": 57401937, "comment_id": 101285826, "body": "Use <code>p</code> instead of <code>puts</code>, you&#39;re gonna see the <code>nil</code> values you&#39;re getting."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1565212132, "post_id": 57401937, "comment_id": 101286151, "body": "And keeping an extra counter <code>i</code> is redundant anyway because <code>each_with_index</code>."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 11898480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a25e53351a90774da3551690a7abd81f?s=128&d=identicon&r=PG&f=1", "display_name": "jong park", "link": "https://stackoverflow.com/users/11898480/jong-park"}, "is_accepted": false, "score": 6, "last_activity_date": 1565211635, "last_edit_date": 1565211635, "creation_date": 1565211161, "answer_id": 57402151, "question_id": 57401937, "link": "https://stackoverflow.com/questions/57401937/cant-understand-why-this-code-to-convert-a-simple-array-into-a-simple-hash-isn/57402151#57402151", "title": "Can&#39;t understand why this code to convert a simple array into a simple hash isn&#39;t working", "body": "<p>Not sure what you are trying to achieve here, but when you are doing arrayy[i,0] in the loop, you are saying that you want to grab zero elements. </p>\n\n<p>When you pass in two numbers as the argument against an array, the first number is the index of the target value and the second number is the length. For example:</p>\n\n<pre><code>arr = ['a', 'b', 'c', 'd', 'e']\nputs arr[2, 3] \n</code></pre>\n\n<p>This would put out ['c','d','e'], which is 'starting from the element with index 2, grab 3 elements'. </p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1565212392, "post_id": 57402293, "comment_id": 101286221, "body": "&quot;You&#39;re requesting zero elements&quot; - yes, that&#39;s what the code ends up doing, but the intention was to do <code>arrayy[i][0]</code>, I think."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1565212485, "post_id": 57402293, "comment_id": 101286251, "body": "@SergioTulentsev That&#39;s a good interpretation of what was actually coded. I&#39;ve added a note to that effect."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 4, "last_activity_date": 1565212593, "last_edit_date": 1565212593, "creation_date": 1565212072, "answer_id": 57402293, "question_id": 57401937, "link": "https://stackoverflow.com/questions/57401937/cant-understand-why-this-code-to-convert-a-simple-array-into-a-simple-hash-isn/57402293#57402293", "title": "Can&#39;t understand why this code to convert a simple array into a simple hash isn&#39;t working", "body": "<p>You're requesting zero elements, which is an empty array, so you're keying everything on an empty array and all elements collide. To fix that, just use the iterator, as <code>each</code> gives you the elements you need:</p>\n\n<pre><code>arrayy = [[1,'one'],[2,'two'],[3,'three']]\n\nhashy = {}\narrayy.each do |key, value|\n  hashy[key] = value\nend\n\np hashy\n# =&gt; {1=&gt;\"one\", 2=&gt;\"two\", 3=&gt;\"three\"}\n</code></pre>\n\n<p>In your code the actual result you're getting is this:</p>\n\n<pre><code>p hashy\n# =&gt; {[]=&gt;[[3, \"three\"]]}\n</code></pre>\n\n<p>Where here you can see the <code>[]</code> key being used. The <code>p</code> method is really handy for looking at the internal structure of something. <code>p hashy</code> is equivalent to <code>puts hashy.inspect</code>.</p>\n\n<p>As Sergio points out you were probably referencing the arrays the wrong way. To navigate two levels deep you do this:</p>\n\n<pre><code>hashy[arrayy[i][0]] = arrayy [i][1]\n</code></pre>\n\n<p>Where <code>[i,0]</code> means \"at index of the array <em>i</em> select the next <em>0</em> elements\" whereas <code>[i][0]</code> means \"at the array at index <em>i</em> select the value at index <em>0</em>\".</p>\n\n<p>It's worth noting that the simplest solution is to use <a href=\"https://ruby-doc.org/core-2.6/Array.html#method-i-to_h\" rel=\"nofollow noreferrer\"><code>Array#to_h</code></a> which already does this:</p>\n\n<pre><code>arrayy = [[1,'one'],[2,'two'],[3,'three']]\n\nhashy = array.to_h\n\np hashy\n# =&gt; {1=&gt;\"one\", 2=&gt;\"two\", 3=&gt;\"three\"}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11891710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lMRD.jpg?s=128&g=1", "display_name": "AidanofVT", "link": "https://stackoverflow.com/users/11891710/aidanofvt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57402293, "answer_count": 2, "score": 0, "last_activity_date": 1565212593, "creation_date": 1565209908, "question_id": 57401937, "link": "https://stackoverflow.com/questions/57401937/cant-understand-why-this-code-to-convert-a-simple-array-into-a-simple-hash-isn", "title": "Can&#39;t understand why this code to convert a simple array into a simple hash isn&#39;t working", "body": "<p>Code attached below.</p>\n\n<pre><code> arrayy = [[1,'one'],[2,'two'],[3,'three']]\n hashy = {}\n i = 0\n arrayy.each do\n   hashy[arrayy[i,0]] = arrayy [i,1]\n   i = i+1\n end\n puts hashy[1]\n puts hashy[2]\n puts hashy[3]\nend\n</code></pre>\n\n<p>This code doesn't output anything. No errors. So, I'm guessing that the problem is that nothing is being added to the hash.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1565211402, "post_id": 57401761, "comment_id": 101285942, "body": "If you do <code>puts sed_command</code> instead of <code>p sed_command</code> you&#39;ll see that escaping the backslash <a href=\"https://repl.it/@jrunning/TidyImperfectExams\" rel=\"nofollow noreferrer\">worked exactly as intended</a>."}], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 11744097, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--_CSWfqF3tQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzBBPcl2w1PZhBaW5zcKAhfur-_Q/photo.jpg?sz=128", "display_name": "Ken Jenney", "link": "https://stackoverflow.com/users/11744097/ken-jenney"}, "edited": false, "score": 0, "creation_date": 1565209860, "post_id": 57401819, "comment_id": 101285351, "body": "I don&#39;t get what you get. I get <code>&quot;sed &#39;\\\\#&#47;,#d&#39; &#47;tmp&#47;dest_sorted&quot;</code>"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 128, "user_id": 11744097, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--_CSWfqF3tQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzBBPcl2w1PZhBaW5zcKAhfur-_Q/photo.jpg?sz=128", "display_name": "Ken Jenney", "link": "https://stackoverflow.com/users/11744097/ken-jenney"}, "edited": false, "score": 0, "creation_date": 1565210490, "post_id": 57401819, "comment_id": 101285610, "body": "How did  you get it? How do you want to execute this command?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 128, "user_id": 11744097, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--_CSWfqF3tQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzBBPcl2w1PZhBaW5zcKAhfur-_Q/photo.jpg?sz=128", "display_name": "Ken Jenney", "link": "https://stackoverflow.com/users/11744097/ken-jenney"}, "edited": false, "score": 2, "creation_date": 1565211167, "post_id": 57401819, "comment_id": 101285845, "body": "@KenJenney You&#39;re getting <code>&quot;sed &#39;\\\\#&#47;,#d&#39; &#47;tmp&#47;dest_sorted&quot;</code> because you&#39;re using <code>p</code>, which calls <code>inspect</code> on its arguments. @mrzasa is using <code>puts</code>."}, {"owner": {"reputation": 128, "user_id": 11744097, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--_CSWfqF3tQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzBBPcl2w1PZhBaW5zcKAhfur-_Q/photo.jpg?sz=128", "display_name": "Ken Jenney", "link": "https://stackoverflow.com/users/11744097/ken-jenney"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1565213342, "post_id": 57401819, "comment_id": 101286526, "body": "@JordanRunning that was it. I was using p. Thanks!"}, {"owner": {"reputation": 128, "user_id": 11744097, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--_CSWfqF3tQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzBBPcl2w1PZhBaW5zcKAhfur-_Q/photo.jpg?sz=128", "display_name": "Ken Jenney", "link": "https://stackoverflow.com/users/11744097/ken-jenney"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1565213345, "post_id": 57401819, "comment_id": 101286527, "body": "@JordanRunning that was it. I was using p. Thanks!"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1565209323, "creation_date": 1565209323, "answer_id": 57401819, "question_id": 57401761, "link": "https://stackoverflow.com/questions/57401761/ruby-escape-backslash-for-sed-command/57401819#57401819", "title": "Ruby Escape Backslash For Sed Command", "body": "<p>You can use single-quoted (verbatim) strings and escape single quotes inside them:</p>\n\n<pre><code>puts 'sed \\'\\#/,#d\\' /tmp/dest_sorted'\n#&gt; sed '\\#/,#d' /tmp/dest_sorted\n</code></pre>\n"}], "owner": {"reputation": 128, "user_id": 11744097, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--_CSWfqF3tQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzBBPcl2w1PZhBaW5zcKAhfur-_Q/photo.jpg?sz=128", "display_name": "Ken Jenney", "link": "https://stackoverflow.com/users/11744097/ken-jenney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1565209700, "creation_date": 1565209059, "last_edit_date": 1565209700, "question_id": 57401761, "link": "https://stackoverflow.com/questions/57401761/ruby-escape-backslash-for-sed-command", "title": "Ruby Escape Backslash For Sed Command", "body": "<p>I have a <code>sed</code> command:</p>\n\n<pre><code>sed \"\\#/,#d\" /tmp/dest_sorted\n</code></pre>\n\n<p>I need to run this command in my Ruby script. I've tried this:</p>\n\n<pre><code>sed_command = \"sed '\\#/,#d' /tmp/dest_sorted\"\np sed_command\n</code></pre>\n\n<p>I get the following result:</p>\n\n<pre><code>\"sed '#/,#d' /tmp/dest_sorted\"\n</code></pre>\n\n<p>I've tried adding a second backslash:</p>\n\n<pre><code>sed_command = \"sed '\\\\#/,#d' /tmp/dest_sorted\"\n</code></pre>\n\n<p>but I get this:</p>\n\n<pre><code>\"sed '\\\\#/,#d' /tmp/dest_sorted\"\n</code></pre>\n\n<p>How can I preserve the single backslash at the beginning of my <code>sed</code> command?</p>\n"}, {"tags": ["arrays", "ruby", "hash", "group-by"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1565206801, "post_id": 57401255, "comment_id": 101284153, "body": "What&#39;s the input data?"}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1565206939, "post_id": 57401255, "comment_id": 101284210, "body": "Updated the beginning of my question, the store consists of objects like [obj1, obj2, obj3] with attributes date, task, staff, etc."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1565207099, "post_id": 57401255, "comment_id": 101284277, "body": "You can add an example of your input data. I&#39;m not gonna tell anybody how your data looks like."}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1565207278, "post_id": 57401255, "comment_id": 101284356, "body": "I am using an external SDK an get objects back as described. Not sure if the input data is really relevant. I can only access certain methods of the objects as described. Do you expect a class and some methods?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1565207417, "post_id": 57401255, "comment_id": 101284410, "body": "No, if your expected output is like in the answer, there should be a <code>&quot;18.07.2019&quot;</code>, <code>1001</code>, <code>[1,2,3]</code>, ... in somewhere."}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1565207764, "post_id": 57401255, "comment_id": 101284537, "body": "Got you. [obj.date, obj.task, obj.staff] is indeed [&quot;18.07.2019&quot;, 1001, 1] or [&quot;18.07.2019&quot;, 1001, 2] or [&quot;18.07.2019&quot;, 1001, 2]"}], "answers": [{"comments": [{"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1565209982, "post_id": 57401732, "comment_id": 101285422, "body": "Reads easy, I&#39;ll give it a go. Nice alternative approach. ||= is nice, Really appreciated!"}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1565210103, "post_id": 57401732, "comment_id": 101285473, "body": "Don&#39;t ask why I use this old version :D"}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1565210340, "post_id": 57401732, "comment_id": 101285564, "body": "Works perfectly fine!"}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 1, "last_activity_date": 1565208944, "creation_date": 1565208944, "answer_id": 57401732, "question_id": 57401255, "link": "https://stackoverflow.com/questions/57401255/how-to-build-a-hash-using-array-of-objects/57401732#57401732", "title": "How to build a hash using array of objects?", "body": "<p>Unfortunately, I don't have an actual Ruby 1.6 available since its last update was releases in 2002 and it doesn't compile on any modern system anymore. As such, I wasn't able to test if this code actually works on this Ruby version.</p>\n\n<p>Still, you should be able to get your desired result with something like this:</p>\n\n<pre><code>result = {}\nstore.each do |obj|\n  date = obj.date.to_s\n  staff = obj.staff\n  task = obj.task\n\n  # An Array of Hashes for each date in the result hash\n  result[date] ||= []\n\n  # Find an existing Hash for the current staff id\n  staff_obj = result[date].find { |hash| hash[:staff] == staff }\n\n  # If we don't have a Hash for the current staff id yet, create a new one\n  # and add it to the result Hash\n  unless staff_obj\n    staff_obj = { :staff =&gt; staff, :tasks =&gt; [] }\n    result[date] &lt;&lt; staff_obj\n  end\n\n  # Finally, we add the current task id to the list of tasks for\n  # the current date and staff\n  staff_obj[:tasks] &lt;&lt; task\nend\n\nputs result.inspect\n</code></pre>\n\n<p>Note that this can be rather inefficient to create your desired data structure if there are a lot of different staff ids since we have to find the existing hash for the date and staff in each loop. This could be improved by using a different result structure such as:</p>\n\n<pre><code>{\n  \"18.07.2019\" =&gt; {\n    1001 =&gt; [1, 2, 3],\n    1002 =&gt; [1, 2, 4]\n  },\n  \"19.07.2019\" =&gt; {\n    1001 =&gt; [2, 3],\n    1002 =&gt; [1, 2]\n  },\n  ...\n}\n</code></pre>\n\n<p>To create this structure, you could use this simplified approach which should be quite efficient:</p>\n\n<pre><code>result = {}\nstore.each do |obj|\n  date = obj.date.to_s\n  staff = obj.staff\n  task = obj.task\n\n  result[date] ||= {}\n  result[date][staff] ||= []\n  result[date][staff] &lt;&lt; task\nend\n</code></pre>\n"}], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 57401732, "answer_count": 1, "score": 0, "last_activity_date": 1566485012, "creation_date": 1565206604, "last_edit_date": 1566485012, "question_id": 57401255, "link": "https://stackoverflow.com/questions/57401255/how-to-build-a-hash-using-array-of-objects", "title": "How to build a hash using array of objects?", "body": "<p>I have a store which holds objects like [obj1, obj2, obj3] with attributes date, task, staff, etc. The objects contains data like date \"18.07.2019\", staff 1001, task 1  </p>\n\n<p>My initial idea was to group them somehow, but I miserably failed.\nI'd like build a structure as shown at the bottom of the post, either from the objects itselves or from an contructed array holding only three (or maybe more) attributes.</p>\n\n<p><strong>Challenge:</strong></p>\n\n<p><strong>As I am using an very old ruby 1.6 I can't use all the modern easy methods.</strong></p>\n\n<p>The store consists of objects like [obj1, obj2, obj3] with attributes date, task, staff. </p>\n\n<pre><code>    all_items = []\n    store.each do |obj|\n      all_items &lt;&lt; [obj.date, obj.task, obj.staff]\n    end\n</code></pre>\n\n<p><strong>My attempt:</strong></p>\n\n<p>I tried a lot like </p>\n\n<pre><code>    h = {}\n    h[date] = []\n    h[date] &lt;&lt; [obj.date, obj.task, obj.staff]\n    h[date].to_h\n</code></pre>\n\n<p><strong>Current state:</strong> </p>\n\n<pre><code>    h = {}\n    all_items = []\n    store.each do |obj|\n      h[obj.date.to_s] = []\n      h[obj.date.to_s] &lt;&lt; { obj.date.to_s =&gt; [obj.staff, obj.task] }\n      all_items &lt;&lt; Hash[*h[obj.date.to_s].flatten]\n    end\n    puts all_items.inspect\n</code></pre>\n\n<p>looks like this (still nothing I can work with): </p>\n\n<pre><code>[ \n  {\"18.07.2019\"=&gt;[1001, 2]}, \n  {\"18.07.2019\"=&gt;[1001, 2]}, \n  {\"18.07.2019\"=&gt;[1001, 3]}, \n  {\"19.07.2019\"=&gt;[1001, 1]}, \n  {\"20.07.2019\"=&gt;[1002, 3]},\n  ...\n]\n</code></pre>\n\n<p><strong>Expected format:</strong></p>\n\n<p>I would love to come out with something like this, so that I know who has which tasks on which date in order to work with the data later in my program.</p>\n\n<pre><code>{\n  \"18.07.2019\" =&gt; [\n    { staff: 1001, tasks: [1, 2, 3]},\n    { staff: 1002, tasks: [1, 2, 4]}\n  ],\n  \"19.07.2019\" =&gt; [\n    { staff: 1001, tasks: [2, 3]},\n    { staff: 1002, tasks: [1, 2]}\n  ],\n  ...\n}\n</code></pre>\n"}, {"tags": ["ruby", "cucumber"], "answers": [{"comments": [{"owner": {"reputation": 15789, "user_id": 650475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Feoda.png?s=128&g=1", "display_name": "Grant Birchmeier", "link": "https://stackoverflow.com/users/650475/grant-birchmeier"}, "edited": false, "score": 0, "creation_date": 1565280002, "post_id": 57403015, "comment_id": 101313004, "body": "That is actually perfect for what I need!  It&#39;d be nice to have the other stuff, but this nails my need."}], "tags": [], "owner": {"reputation": 1959, "user_id": 1020168, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f97951f0a41a76e04e3bf542dc171a58?s=128&d=identicon&r=PG", "display_name": "MothOnMars", "link": "https://stackoverflow.com/users/1020168/mothonmars"}, "is_accepted": true, "score": 1, "last_activity_date": 1565216948, "creation_date": 1565216948, "answer_id": 57403015, "question_id": 57401242, "link": "https://stackoverflow.com/questions/57401242/can-i-see-the-active-cucumber-options-from-within-a-ruby-step-definition/57403015#57403015", "title": "Can I see the active Cucumber options from within a Ruby step definition?", "body": "<p>I'm not sure how to access all the run-time options, but you can access the current coloring option via <code>Cucumber::Term::ANSIColor.coloring?</code>.</p>\n"}], "owner": {"reputation": 15789, "user_id": 650475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Feoda.png?s=128&g=1", "display_name": "Grant Birchmeier", "link": "https://stackoverflow.com/users/650475/grant-birchmeier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 57403015, "answer_count": 1, "score": 0, "last_activity_date": 1565216948, "creation_date": 1565206551, "question_id": 57401242, "link": "https://stackoverflow.com/questions/57401242/can-i-see-the-active-cucumber-options-from-within-a-ruby-step-definition", "title": "Can I see the active Cucumber options from within a Ruby step definition?", "body": "<p>I'd like my step definition to have conditional behavior based on cuke's run-time options.  For example, I don't want my step to print terminal color codes if <code>cucumber</code> was executed with <code>--no-color</code>.</p>\n\n<p>Is there any way that I can programmatically see the cucumber run-time options from within the step definition?</p>\n"}, {"tags": ["ruby", "lambda", "proc"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565206447, "post_id": 57401127, "comment_id": 101284007, "body": "What is the desired return value?"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565208085, "post_id": 57401127, "comment_id": 101284668, "body": "I want to throw in \u201830\u2019 as a variable for a return array with values over 30.  But this is more than just this example.  I\u2019m wanting generalized <code>procs</code> that I can throw <code>params</code> at."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565208187, "post_id": 57401127, "comment_id": 101284691, "body": "Yes.  But I\u2019m trying to implement the <code>proc</code> version so I can learn them."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565248874, "post_id": 57401127, "comment_id": 101295137, "body": "What are you trying to do here, currying?"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1565290706, "post_id": 57401127, "comment_id": 101317639, "body": "I don&#39;t know that term.  I thought throwing a parameter into the proc would be a normal thing.  I&#39;m reviewing the other replies."}], "answers": [{"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1565208330, "post_id": 57401580, "comment_id": 101284743, "body": "At the end you could do <code>p1.select(&amp;@qualify_30)</code> or it could be done inline like <code>p1.select(&amp;qualify.curry.call(30))</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1565209368, "post_id": 57401580, "comment_id": 101285151, "body": "There&#39;s no need to use an instance variable unless this needs to be persisted, and if so, could be a constant instead. You can also use a shorter notation: <code>@qualify_30[40]</code> where <code>[]</code> is an alias to <code>call</code>."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 4, "last_activity_date": 1565213795, "last_edit_date": 1565213795, "creation_date": 1565208123, "answer_id": 57401580, "question_id": 57401127, "link": "https://stackoverflow.com/questions/57401127/ruby-proc-with-parameter/57401580#57401580", "title": "Ruby Proc with Parameter", "body": "<p>In order to use <code>qualify</code> in as <code>select</code> predicate, you need to reduce its arity (number of accepted arguments) through partial application. In other words - you need a new proc that would have <code>other</code> set to <code>30</code>. It can be done with <a href=\"https://ruby-doc.org/core-2.5.3/Method.html#method-i-curry\" rel=\"nofollow noreferrer\"><code>Method#curry</code></a>, but it requires changing order of parameters:</p>\n\n<pre><code>qualify = proc { |other, age| age &gt; other }\nqualify.curry.call(30).call(10)\n# =&gt; false\nqualify.curry.call(30).call(40)\n#=&gt; true\n</code></pre>\n\n<p>I order to be able to pass this proc to select using <code>&amp;</code>, you need to assign it so that it's available in the main object, e.g. by assigning it to an instance variable:</p>\n\n<pre><code>@qualify_30 = qualify.curry.call(30)\n</code></pre>\n\n<p>Now you can call:</p>\n\n<pre><code>p1.select{ |age| @qualify_30.call(age)  }\n# =&gt; [54, 45, 76, 67]\n</code></pre>\n\n<p>or: </p>\n\n<pre><code>p1.select(&amp;@qualify_30)\n# =&gt; [54, 45, 76, 67]\n</code></pre>\n\n<p>or inline:</p>\n\n<pre><code>p1.select(&amp;qualify.curry.call(30))\n# =&gt; [54, 45, 76, 67]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565249192, "post_id": 57401858, "comment_id": 101295296, "body": "&quot;the only methods that can be used ... are zero-argument ones&quot; - but <code>qualify</code> here has arity of 1. And it&#39;s not even a method. Perhaps, this assertion can be reworded somehow."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565249564, "post_id": 57401858, "comment_id": 101295479, "body": "And methods with params can be used, of course. Because the <code>&amp;</code> doesn&#39;t see the method call. Only its result. <a href=\"https://repl.it/repls/EuphoricPunctualBetatest\" rel=\"nofollow noreferrer\">repl.it/repls/EuphoricPunctualBetatest</a>"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1565291006, "post_id": 57401858, "comment_id": 101317765, "body": "I see you&#39;ve taken the required out of the role as <code>parameter</code>, so that really is just another hard coded <code>proc</code> as I see it.  Doesn&#39;t really respect <code>DRY</code>.  I assumed it would be easy to throw in the <code>param</code>."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 4, "last_activity_date": 1565286765, "last_edit_date": 1565286765, "creation_date": 1565209525, "answer_id": 57401858, "question_id": 57401127, "link": "https://stackoverflow.com/questions/57401127/ruby-proc-with-parameter/57401858#57401858", "title": "Ruby Proc with Parameter", "body": "<p>The easy way is to shuffle up how you define this:</p>\n\n<pre><code>p1 = [54, 21, 45, 76, 12, 11, 67, 5]\n\nqualify = proc { |age| age &gt; 30 }\n\nputs p1.select(&amp;qualify).join(',')\n</code></pre>\n\n<p>By moving the <code>30</code> into the <code>qualify</code> proc you've baked in the condition, it's no longer dynamic. Remember, the only methods that can be used with the shorthand <code>&amp;:</code> trick are zero-argument ones, or single argument ones with <code>&amp;</code> on a proc.</p>\n\n<p>You could also use a <em>closure</em> to have the comparison variable exposed:</p>\n\n<pre><code>p1 = [54, 21, 45, 76, 12, 11, 67, 5]\n\nrequired = 30\n\nqualify = proc { |age| age &gt; required }\n\nputs p1.select(&amp;qualify).join(',')\n\nrequired = 10\n\nputs p1.select(&amp;qualify).join(',')\n</code></pre>\n\n<p>The better way is to just spell it out, that's what Ruby is all about. Here in a more idiomatic form:</p>\n\n<pre><code>p1 = [54, 21, 45, 76, 12, 11, 67, 5]\n\nputs p1.select { |age| age &gt; 30 }\n</code></pre>\n\n<p>The only reason for an intermediate Proc is if you'd want to, for some reason, save that somewhere and re-use it later.</p>\n"}, {"comments": [{"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1565290775, "post_id": 57406608, "comment_id": 101317679, "body": "Excellent.  So you just tossed the array into the proc as a variable itself.  I was stuck on the iterator."}], "tags": [], "owner": {"reputation": 802, "user_id": 8728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376ec53188ea3ec0271198a862516657?s=128&d=identicon&r=PG&f=1", "display_name": "Dyaniyal Wilson", "link": "https://stackoverflow.com/users/8728218/dyaniyal-wilson"}, "is_accepted": true, "score": 3, "last_activity_date": 1565246643, "creation_date": 1565246643, "answer_id": 57406608, "question_id": 57401127, "link": "https://stackoverflow.com/questions/57401127/ruby-proc-with-parameter/57406608#57406608", "title": "Ruby Proc with Parameter", "body": "<p>Use the select statement in the proc itself, so that the proc would calculate and return an array.</p>\n\n<pre><code>2.1.5 :119 &gt;   qualify = proc { |age_array, age_limit| age_array.select { |age| age &gt; age_limit } }\n =&gt; #&lt;Proc:0xe7bc2cc@(irb):119&gt; \n2.1.5 :120 &gt; \n2.1.5 :121 &gt;   \n2.1.5 :122 &gt;   qualify.call(p1, 30)\n =&gt; [54, 45, 76, 67] \n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 57406608, "answer_count": 3, "score": 3, "last_activity_date": 1565286765, "creation_date": 1565206005, "last_edit_date": 1565209677, "question_id": 57401127, "link": "https://stackoverflow.com/questions/57401127/ruby-proc-with-parameter", "title": "Ruby Proc with Parameter", "body": "<p>I'm trying to send a parameter to a Ruby <code>proc</code></p>\n\n<pre><code>p1 = [54, 21, 45, 76, 12, 11, 67, 5]\n\nqualify = proc { |age, other| age &gt; other }\n\nputs p1.select(&amp;qualify(30))\n</code></pre>\n\n<p>This is the error I get:</p>\n\n<pre><code>undefined method `qualify' for main:Object\n</code></pre>\n\n<p><strong>age</strong> comes from the iteration of the <code>array</code>, and I want to have that last <code>parameter</code> (<strong>30</strong>) to get into the <code>proc</code>.  </p>\n\n<p>Is a <code>proc</code> the right tool to be using for this?  I'm new to proc.  I'm unclear how to get that <code>parameter</code> in there.  </p>\n"}, {"tags": ["ruby", "ubuntu", "selenium-webdriver", "watir"], "answers": [{"comments": [{"owner": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "edited": false, "score": 0, "creation_date": 1565243964, "post_id": 57403372, "comment_id": 101293011, "body": "How would this work on a remote server where I can&#39;t be signed in to Google or install a browser?"}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "reply_to_user": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "edited": false, "score": 0, "creation_date": 1565272131, "post_id": 57403372, "comment_id": 101308416, "body": "Hmm, not with this gem, maybe using curl or using an http client to make the get requests you need."}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "reply_to_user": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "edited": false, "score": 0, "creation_date": 1565646156, "post_id": 57403372, "comment_id": 101410243, "body": "e.g. curl -d &#39;username=myname&amp;password=sEcReTwOrD123&amp;csrf=123456&#39; <a href=\"http://example.com/login\" rel=\"nofollow noreferrer\">example.com/login</a>, which is basically a post request to a login for of a website. (see here: <a href=\"https://tech.saigonist.com/b/code/how-login-any-website-using-curl-command-line-or-shell-script.html\" rel=\"nofollow noreferrer\">tech.saigonist.com/b/code/&hellip;</a>)"}], "tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": false, "score": 0, "last_activity_date": 1565220337, "creation_date": 1565220337, "answer_id": 57403372, "question_id": 57400155, "link": "https://stackoverflow.com/questions/57400155/how-to-use-ruby-to-scrape-a-react-website-from-a-remote-linux-server/57403372#57403372", "title": "How to use ruby to scrape a react website from a remote linux server?", "body": "<blockquote>\n  <p>You'll get that error if Firefox isn't installed, or isn't accessible on your path. Reinstall if you already have it.  </p>\n</blockquote>\n\n<p>Source: <a href=\"https://stackoverflow.com/questions/56523308\">selenium/webdriver/firefox/binary.rb:134:in `path&#39;: can&#39;t modify frozen String (FrozenError)</a></p>\n\n<p>So, you might want to use Firecast, a reinstall might help. In case you have a different browser, you could test with Chrome for instance. </p>\n\n<p>Some more things to look at: </p>\n\n<ol>\n<li><p>You might also need to install the right webdriver. You can also use <a href=\"https://github.com/titusfortner/webdrivers\" rel=\"nofollow noreferrer\">https://github.com/titusfortner/webdrivers</a></p></li>\n<li><p>I have got the same error as you posted, then I ran <code>gem install webdrivers</code> and used it in the code, also I switched to chrome:</p></li>\n</ol>\n\n<pre><code>require 'watir'\nrequire 'webdrivers'\nbrowser = Watir::Browser.new :chrome, headless: true\nbrowser.goto(\"https://www.pinterest.com\")\n</code></pre>\n\n<p>Finally, without webdrivers you get something like </p>\n\n<blockquote>\n  <p>C:/tools/ruby26/lib/ruby/gems/2.6.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/common/service.rb:136:in `binary_path': Unable to find chromedriver. Please download the server from (Selenium::WebDriver::Error::WebDriverError)\n  <a href=\"https://chromedriver.storage.googleapis.com/index.html\" rel=\"nofollow noreferrer\">https://chromedriver.storage.googleapis.com/index.html</a> and place it somewhere on your PATH.\n  More info at <a href=\"https://github.com/SeleniumHQ/selenium/wiki/ChromeDriver\" rel=\"nofollow noreferrer\">https://github.com/SeleniumHQ/selenium/wiki/ChromeDriver</a>.</p>\n</blockquote>\n\n<p>and with all set up correctly you might get something like (most likely related to Chrome):</p>\n\n<blockquote>\n  <p>DevTools listening on ws://127.0.0.1:57725/devtools/browser/34a42518-c3d9-4e14-af8e-9a137b11625b\n  [0808/012434.304:INFO:CONSOLE(0)] \"The Content-Security-Policy directive 'prefetch-src' is implemented behind a flag which is currently disabled.\n  \", source: <a href=\"https://www.pinterest.com/\" rel=\"nofollow noreferrer\">https://www.pinterest.com/</a> (0)\n  [0808/012437.286:INFO:CONSOLE(240)] \"No signed in Google accounts available - visit accounts.google.com to ensure that at least one account is signed in, otherwise no data will be returned from this API.\", source: <a href=\"https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.IdentityYoloWebModuleset.en_US.fUFh6X86RzU.es5.O/am=Aw/d=1/rs=AOaEmlH5BdY58S_qoulxSYv6tYMpThlVYw/m=yolo_frame_library\" rel=\"nofollow noreferrer\">https://www.gstatic.com/<em>/mss/boq-identity/</em>/js/k=boq-identity.IdentityYoloWebModuleset.en_US.fUFh6X86RzU.es5.O/am=Aw/d=1/rs=AOaEmlH5BdY58S_qoulxSYv6tYMpThlVYw/m=yolo_frame_library</a> (240)</p>\n</blockquote>\n"}], "owner": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565277220, "creation_date": 1565201717, "last_edit_date": 1565277220, "question_id": 57400155, "link": "https://stackoverflow.com/questions/57400155/how-to-use-ruby-to-scrape-a-react-website-from-a-remote-linux-server", "title": "How to use ruby to scrape a react website from a remote linux server?", "body": "<p>I want to scrape a react website using the ruby watir gem on a remote linux server but keep getting the following error:</p>\n\n<blockquote>\n  <p>/var/lib/gems/2.3.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/firefox/binary.rb:134:in\n  <code>path': can't modify frozen String (RuntimeError)     from\n  /var/lib/gems/2.3.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/common/service.rb:45:in\n  </code>firefox'</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>require 'watir'\nbrowser = Watir::Browser.new :firefox, headless: true\nbrowser.goto(\"https://www.pinterest.com\")\n</code></pre>\n\n<p>There is a similar question <a href=\"https://stackoverflow.com/questions/3861871/can-i-use-watir-to-scrape-data-from-a-website-on-a-linux-server-without-monitor/3863321\">here</a> but the links either return 404 or are archived and the code deprecated.</p>\n\n<p>I need to login, then get a new page and push buttons on that page to download a report file for a date range.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 3, "creation_date": 1565205812, "post_id": 57399799, "comment_id": 101283731, "body": "I would argue that concerns are something different \u2013 mainly code fragments that can be re-used in several classes. Therefore for extensions to external libraries I would still use the <code>lib</code> folder."}], "answers": [{"comments": [{"owner": {"reputation": 1959, "user_id": 1020168, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f97951f0a41a76e04e3bf542dc171a58?s=128&d=identicon&r=PG", "display_name": "MothOnMars", "link": "https://stackoverflow.com/users/1020168/mothonmars"}, "edited": false, "score": 1, "creation_date": 1565212246, "post_id": 57402268, "comment_id": 101286178, "body": "Thank you - that was the gut-check I needed."}], "tags": [], "owner": {"reputation": 808, "user_id": 496517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/091bc95204caaf52b0d299bd9ac59540?s=128&d=identicon&r=PG", "display_name": "Mason Stewart", "link": "https://stackoverflow.com/users/496517/mason-stewart"}, "is_accepted": true, "score": 1, "last_activity_date": 1565211907, "creation_date": 1565211907, "answer_id": 57402268, "question_id": 57399799, "link": "https://stackoverflow.com/questions/57399799/where-should-we-place-core-extensions-or-extensions-to-gems-in-rails-5/57402268#57402268", "title": "Where should we place core extensions or extensions to gems in Rails 5?", "body": "<p>Rails concerns are a convenient way to share and test reusable code across models, controllers, and other classes. Because the primary use is making class and instance methods (and scopes, before and after filters, etc) reusable, they're probably an unnecessary abstraction if you just want to add a method to a single class. For your use case, <code>lib/extensions</code> is still completely reasonable in Rails 5.</p>\n"}], "owner": {"reputation": 1959, "user_id": 1020168, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f97951f0a41a76e04e3bf542dc171a58?s=128&d=identicon&r=PG", "display_name": "MothOnMars", "link": "https://stackoverflow.com/users/1020168/mothonmars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "closed_date": 1565244773, "accepted_answer_id": 57402268, "answer_count": 1, "score": 1, "last_activity_date": 1565211907, "creation_date": 1565200086, "last_edit_date": 1565200734, "question_id": 57399799, "link": "https://stackoverflow.com/questions/57399799/where-should-we-place-core-extensions-or-extensions-to-gems-in-rails-5", "closed_reason": "Opinion-based", "title": "Where should we place core extensions or extensions to gems in Rails 5?", "body": "<p>Our Rails 4 application includes a module that adds a method to a class in the <code>geoip</code> gem, following the pattern documented <a href=\"https://www.justinweiss.com/articles/3-ways-to-monkey-patch-without-making-a-mess/\" rel=\"nofollow noreferrer\">here</a>. Currently, that extension is in the lib/extensions/ directory:</p>\n\n<pre><code>#lib/extensions/geoip_extensions.rb\nmodule GeoipExtensions\n  module GeoIP\n    module City\n      def location_name\n        [city_name, real_region_name, country_name].reject(&amp;:blank?).join(', ')\n      end\n    end\n  end\nend\n\nGeoIP::City.include GeoipExtensions::GeoIP::City\n</code></pre>\n\n<pre><code>#config/initializers/extensions/geoip.rb\nrequire 'geoip_extensions'\n</code></pre>\n\n<p>In Rails 5, is <code>lib/extensions</code> still the appropriate place for extensions to gems or to core classes, or should this be converted to a <code>concern</code>?</p>\n"}, {"tags": ["ruby", "utf-8", "byte-order-mark"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565197100, "post_id": 57399001, "comment_id": 101279851, "body": "please don&#39;t use wetransfer or other file hosting that is not readable before downloading.  Better off with <a href=\"https://pastebin.com/\" rel=\"nofollow noreferrer\">pastebin.com</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1565198107, "post_id": 57399001, "comment_id": 101280350, "body": "<i>&quot;a text file with a an UTF-8 Bom&quot;</i> \u2013 your file starts with <code>0xFF</code> <code>0xFE</code> which is the byte order mark for UTF-16 (little endian)."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1565198419, "post_id": 57399001, "comment_id": 101280482, "body": "The fact that Ruby shows the encoding as utf-8 means very little. Ruby can very easily get the encoding wrong in which case that value is meaningless and you need to fix it yourself."}, {"owner": {"reputation": 51, "user_id": 7584545, "user_type": "registered", "profile_image": "https://graph.facebook.com/614161225459664/picture?type=large", "display_name": "Carlos Monteserin", "link": "https://stackoverflow.com/users/7584545/carlos-monteserin"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565265390, "post_id": 57399001, "comment_id": 101304028, "body": "@lacostenycoder: I couldn&#39;t make that to work. You can create myFile.txt in ruby like this: myFile = File.new(&#39;myFile.txt&#39;, &quot;w&quot;) myFile.write &quot;\\uFEFF&quot; myFile.write &quot;Hello\\n&quot; myFile.write &quot;I may contain UTF-8 characters as D&#248;RBLAD\\n&quot; myFile.flush myFile.close"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1565283102, "creation_date": 1565283102, "answer_id": 57417350, "question_id": 57399001, "link": "https://stackoverflow.com/questions/57399001/how-to-read-a-file-with-a-utf-8-bom-using-file-foreach-in-ruby/57417350#57417350", "title": "How to read a file with a UTF-8 BOM using File.foreach in ruby", "body": "<p>The problem seems to be that you have a file with mixed encodings of which we can't be sure of the source.  So determining how to \"read\" this data is not as easy as just convert it to whatever.  However, you might try this to see what's going on.</p>\n\n<pre><code>File.read('myFile.txt').encode(\"Windows-1252\", invalid: :replace, undef: :replace)\n=&gt; \"?Hello\\nI may contain UTF-8 characters as D\\xF8RBLAD\\n\"\n</code></pre>\n\n<p>This may not be a complete answer but you may want to refer to <a href=\"https://www.justinweiss.com/articles/3-steps-to-fix-encoding-problems-in-ruby/\" rel=\"nofollow noreferrer\">this article</a> which covers ideas about how to go about solving your issue.</p>\n"}], "owner": {"reputation": 51, "user_id": 7584545, "user_type": "registered", "profile_image": "https://graph.facebook.com/614161225459664/picture?type=large", "display_name": "Carlos Monteserin", "link": "https://stackoverflow.com/users/7584545/carlos-monteserin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1565283102, "creation_date": 1565196356, "last_edit_date": 1565243656, "question_id": 57399001, "link": "https://stackoverflow.com/questions/57399001/how-to-read-a-file-with-a-utf-8-bom-using-file-foreach-in-ruby", "title": "How to read a file with a UTF-8 BOM using File.foreach in ruby", "body": "<p>I would like to read a text file with a an UTF-8 Bom using ruby's file.foreach. The bom is inserted in the file by adding as first line:\n<code>myFile.write \"\\uFEFF\"</code>. \nDownload the myFile.txt from this link:</p>\n\n<p><a href=\"https://wetransfer.com/downloads/b42363faaff561e7e3ca2edbe850d88d20190807164816/c6e4e1\" rel=\"nofollow noreferrer\">https://wetransfer.com/downloads/b42363faaff561e7e3ca2edbe850d88d20190807164816/c6e4e1</a></p>\n\n<p>I tried simply to read the file like this</p>\n\n<pre><code>  File.foreach(myFile).with_index do |line, line_num|\n    puts \"line = \" + line\n    puts \"line.bytes = \" + line.bytes.to_s()\n    puts \"line.bytes.map(&amp;:chr) = \" + line.bytes.map(&amp;:chr).to_s()\n  end\n</code></pre>\n\n<p>Problem is that line looks like empty every line of the file. However I can see there is something there using bytes. Also tried using encoding argument of File.foreach as follows</p>\n\n<pre><code>  File.foreach(myFile, :encoding=&gt; 'r:bom|utf-8').with_index do |line,line_num|\n    puts \"line = \" + line\n    puts \"line.bytes = \" + line.bytes.to_s()\n    puts \"line.bytes.map(&amp;:chr) = \" + line.bytes.map(&amp;:chr).to_s()\n  end\n</code></pre>\n\n<p>But I am getting the same results. In both cases seems like ruby recognises the utf-8 bom because  <code>puts line.encoding</code> results in 'utf-8'. But I cannot access the chars of line string as usual. For example using myFile.txt the condition below is never triggered. </p>\n\n<pre><code>   if line[0,5] == 'Hello'\n     puts \"Hello catched\"\n   end  \n</code></pre>\n\n<p>Do you know how can I read my files using file.foreach command?</p>\n\n<p>Regards</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redis", "jwt"], "comments": [{"owner": {"reputation": 1928, "user_id": 6193734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yNKciMo2y_0/AAAAAAAAAAI/AAAAAAAACGs/Hg_DmZMu7Lw/photo.jpg?sz=128", "display_name": "Matthieu Libeer", "link": "https://stackoverflow.com/users/6193734/matthieu-libeer"}, "edited": false, "score": 0, "creation_date": 1565203893, "post_id": 57398793, "comment_id": 101282877, "body": "Did you try adding the <code>connect</code> block like in the example project? <a href=\"https://gitlab.com/gitlab-examples/redis/blob/master/.gitlab-ci.yml\" rel=\"nofollow noreferrer\">gitlab.com/gitlab-examples/redis/blob/master/.gitlab-ci.yml</a>"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "reply_to_user": {"reputation": 1928, "user_id": 6193734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yNKciMo2y_0/AAAAAAAAAAI/AAAAAAAACGs/Hg_DmZMu7Lw/photo.jpg?sz=128", "display_name": "Matthieu Libeer", "link": "https://stackoverflow.com/users/6193734/matthieu-libeer"}, "edited": false, "score": 0, "creation_date": 1565206819, "post_id": 57398793, "comment_id": 101284161, "body": "@MatthieuLibeer I&#39;ve just tried it and got an error. I&#39;ve put it in the update in my question."}, {"owner": {"reputation": 1928, "user_id": 6193734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yNKciMo2y_0/AAAAAAAAAAI/AAAAAAAACGs/Hg_DmZMu7Lw/photo.jpg?sz=128", "display_name": "Matthieu Libeer", "link": "https://stackoverflow.com/users/6193734/matthieu-libeer"}, "edited": false, "score": 0, "creation_date": 1565207440, "post_id": 57398793, "comment_id": 101284419, "body": "It looks like you need to set the <code>REDIS_URL</code> environment variable to let Rails talk to Redis. See See the full conversation here: <a href=\"https://github.com/dokku/dokku-redis/issues/114\" rel=\"nofollow noreferrer\">github.com/dokku/dokku-redis/issues/114</a>"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "reply_to_user": {"reputation": 1928, "user_id": 6193734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yNKciMo2y_0/AAAAAAAAAAI/AAAAAAAACGs/Hg_DmZMu7Lw/photo.jpg?sz=128", "display_name": "Matthieu Libeer", "link": "https://stackoverflow.com/users/6193734/matthieu-libeer"}, "edited": false, "score": 0, "creation_date": 1565208710, "post_id": 57398793, "comment_id": 101284899, "body": "I don&#39;t have ENV[&quot;REDIS_URL&quot;] in my application even though the redis gem says the env variable is provided. How and where should I use the env var?"}, {"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1584687637, "post_id": 57398793, "comment_id": 107518202, "body": "Did you resolve the problem? I&#39;m running into the same error now"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "reply_to_user": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1584779451, "post_id": 57398793, "comment_id": 107545694, "body": "@JanKrupa yes, see my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "is_accepted": false, "score": 1, "last_activity_date": 1584779429, "creation_date": 1584779429, "answer_id": 60785840, "question_id": 57398793, "link": "https://stackoverflow.com/questions/57398793/using-redis-on-gitlab-ci-for-a-rails-project/60785840#60785840", "title": "Using Redis on Gitlab CI for a Rails project", "body": "<p>This is my final .gitlab-ci.yml file</p>\n\n<pre><code>image: \"ruby:2.4.0\"\n\nservices:\n  - postgres:latest\n  - redis:latest\n  - name: docker.elastic.co/elasticsearch/elasticsearch:6.5.4\n    alias: elasticsearch\n\nvariables:\n  POSTGRES_DB: lauber_backend_test\n  POSTGRES_USER: runner\n  POSTGRES_PASSWORD: \"\"\n  REDIS_HOST: redis\n  REDIS_URL: redis://redis:6379\n  ELASTICSEARCH_URL: \"http://elasticsearch:9200\"\n\nbefore_script:\n  - apt-get update -qq &amp;&amp; apt-get install -y -qq nodejs libpq-dev cmake libicu-dev\n  - echo \"$RAILS_MASTER_KEY\" -&gt; config/master.key\n  - RAILS_ENV=test bundle install --jobs $(nproc)  \"${FLAGS[@]}\"\n  - cp config/database.yml.example config/database.yml\n  - RAILS_ENV=test rails db:setup\n\nrspec:\n  script:\n    - bundle exec rspec\n</code></pre>\n\n<p>Plus sidekiq config</p>\n\n<pre><code>redis = { db: 4, url: ENV['REDIS_URL'] }\n\nSidekiq.configure_client do |config|\n  config.redis = redis\nend\n\nSidekiq.configure_server do |config|\n  config.redis = redis\nend\n</code></pre>\n\n<p>I think the problem was with REDIS_URL env var not set in my sidekiq config.</p>\n"}], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1584779429, "creation_date": 1565195458, "last_edit_date": 1592644375, "question_id": 57398793, "link": "https://stackoverflow.com/questions/57398793/using-redis-on-gitlab-ci-for-a-rails-project", "title": "Using Redis on Gitlab CI for a Rails project", "body": "<p>I am trying to set up Gitlab CI for my Rails project and for this I need Redis. I have added redis to the config file but I am getting an error</p>\n<pre><code>Redis::CannotConnectError:\n  Error connecting to Redis on 127.0.0.1:6379 (Errno::ECONNREFUSED)\n</code></pre>\n<p>I am using <code>JWTSession</code> for token-based authentication and this relies on Redis. This is my setup.</p>\n<h3>.gitlab-ci.yml</h3>\n<pre><code>image: ruby:2.5.1\n\nservices:\n  - postgres:10.1\n  - redis:latest\n\nvariables:\n  BUNDLE_PATH: vendor/bundle\n  DISABLE_SPRING: 1\n  DB_HOST: postgres\n  REDIS_URL: redis\n\nbefore_script:\n  - apt-get update -qq &amp;&amp; apt-get install nodejs -y\n  - bundle check || bundle install --jobs $(nproc)\n  - cp config/database.yml.ci config/database.yml\n  - bundle exec rails db:create RAILS_ENV=test\n  - bundle exec rails db:schema:load RAILS_ENV=test\n\nstages:\n  - test\n\nTests:\n  stage: test\n  script:\n    - bundle exec rspec spec/\n  only:\n    - merge_requests\n</code></pre>\n<h3>config/initializers/redis.rb</h3>\n<pre><code>require 'redis'\n$redis = Redis.new(url: 'redis://redis:6379/0')\n</code></pre>\n<h3>config/initializers/jwt_sessions.rb</h3>\n<pre><code>JWTSessions.encryption_key = Rails.application.credentials.secret_jwt_encryption_key\nJWTSessions.token_store = :redis, {\n  redis_url: 'redis://localhost:6379',\n  token_prefix: 'jwt_'\n}\n</code></pre>\n<p>I can't seem to figure out how to get this to work. Any hint will be appreciated. Thank you!</p>\n<h3>UPDATE</h3>\n<p>I've just tried the <code>connect</code> block, but got this error:</p>\n<pre><code>connect:\n  # Connect to PostgreSQL database as user postgres, without password\n  image: redis\n  script:\n  - redis-cli -h redis PING\n\n</code></pre>\n<pre><code>Redis::CannotConnectError:\n        Error connecting to Redis on localhost:6379 (Errno::EADDRNOTAVAIL)\n--- Caused by: ---\n      # Errno::EADDRNOTAVAIL:\n      #   Cannot assign requested address - connect(2) for [::1]:6379\n</code></pre>\n"}, {"tags": ["ruby", "cucumber"], "comments": [{"owner": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1565193605, "post_id": 57397674, "comment_id": 101278159, "body": "Looks like you need to pass a <code>Core::Ast::DataTable</code> in your call to <code>super</code>. Maybe this class is not as deprecated as you think?"}, {"owner": {"reputation": 8714, "user_id": 306084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/546ee016aba112078e62861bdc38ae69?s=128&d=identicon&r=PG", "display_name": "pjmorse", "link": "https://stackoverflow.com/users/306084/pjmorse"}, "reply_to_user": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1565376724, "post_id": 57397674, "comment_id": 101349126, "body": "Well, <code>Core::Ast::DataTable</code> apparently isn&#39;t (wasn&#39;t) the same as <code>Cucumber::Ast::DataTable</code>. I&#39;ve worked out that <code>Cucumber::MultilineArgument::DataTable</code> expects a <code>Core::Ast::DataTable</code> as an argument (instead of the array I&#39;ve been passing), and it has a class method <code>from()</code> which will take an Array and return some flavor of <code>DataTable</code>. I&#39;m trying to initialize <code>ParsedTable</code> with the output of <code>Cucumber::MultilineArgument::DataTable#from</code> but it&#39;s not really playing well yet."}], "answers": [{"comments": [{"owner": {"reputation": 8714, "user_id": 306084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/546ee016aba112078e62861bdc38ae69?s=128&d=identicon&r=PG", "display_name": "pjmorse", "link": "https://stackoverflow.com/users/306084/pjmorse"}, "edited": false, "score": 0, "creation_date": 1565381040, "post_id": 57436106, "comment_id": 101350525, "body": "This is reasonable, but the trick is it&#39;s not happening in Cucumber steps - it&#39;s helper methods setting up test data for rspec, and the tables are coming in strings. (See the <code>create_roles</code> method in my third snippet above.)"}], "tags": [], "owner": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "is_accepted": true, "score": 1, "last_activity_date": 1565379138, "creation_date": 1565379138, "answer_id": 57436106, "question_id": 57397674, "link": "https://stackoverflow.com/questions/57397674/why-do-i-need-to-initialize-a-cucumber-datatable-with-a-cucumber-datatable/57436106#57436106", "title": "Why do I need to initialize a Cucumber DataTable with a Cucumber DataTable?", "body": "<p>The API documentation for Cucumber states that the constructor for Cucumber::MultilineArgument::DataTable takes a <code>Core::Ast::DataTable</code> object.</p>\n\n<p>Source: <a href=\"https://www.rubydoc.info/gems/cucumber/Cucumber/MultilineArgument/DataTable#constructor_details\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/cucumber/Cucumber/MultilineArgument/DataTable#constructor_details</a></p>\n\n<p>You will need an instance of <code>Core::Ast::DataTable</code> rather than custom parsing it from a string.</p>\n\n<blockquote>\n  <p>Creates a new instance. +raw+ should be an Array of Array of String or an Array of Hash You don't typically create your own DataTable objects - Cucumber will do it internally and pass them to your Step Definitions.</p>\n</blockquote>\n\n<p>Source: <a href=\"https://www.rubydoc.info/gems/cucumber-core/1.3.1/Cucumber/Core/Ast/DataTable#constructor_details\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/cucumber-core/1.3.1/Cucumber/Core/Ast/DataTable#constructor_details</a></p>\n\n<p>It looks like cucumber should have already parsed the table as a <code>Core::Ast::DataTable</code> object in the step binding, so all you should need to do is pass this along to the constructor of your <code>ParsedTable</code> class.</p>\n\n<p>When this isn't available, then you'll need to provide an array of array of strings instead.</p>\n"}, {"tags": [], "owner": {"reputation": 8714, "user_id": 306084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/546ee016aba112078e62861bdc38ae69?s=128&d=identicon&r=PG", "display_name": "pjmorse", "link": "https://stackoverflow.com/users/306084/pjmorse"}, "is_accepted": false, "score": 0, "last_activity_date": 1565381433, "creation_date": 1565381433, "answer_id": 57436550, "question_id": 57397674, "link": "https://stackoverflow.com/questions/57397674/why-do-i-need-to-initialize-a-cucumber-datatable-with-a-cucumber-datatable/57436550#57436550", "title": "Why do I need to initialize a Cucumber DataTable with a Cucumber DataTable?", "body": "<p>Greg Burghardt's answer has the right cause for this; the <code>Cucumber::MultilineArgument::DataTable</code> class requires a <code>Core::Ast::DataTable</code> as an argument, which wasn't true of the old <code>Cucumber::Ast::DataTable</code>. (This class in general is a bit of a moving target between Cucumber 1.4.x and the current version.)</p>\n\n<p>In the end I solved this by avoiding the problem. Looking carefully at the methods which used the custom <code>ParsedTable</code> class, I saw they didn't really depend on the class, but instead counted on calling <code>hashes</code> on each instance. What I needed was something which responded to <code>hashes</code> with the appropriate response.</p>\n\n<p>So, rather than subclassing <code>Cucumber::MultilineArgument::DataTable</code> simply to get a custom constructor, I replaced the subclass definition with a method which accepted a string, split it into rows, and fed that <code>Array</code> of rows to <code>Cucumber::MultilineArgument::DataTable#from</code>. That returned an instance of <code>Cucumber::MultilineArgument::DataTable</code> which I could call <code>hashes</code> on. And that works.</p>\n"}], "owner": {"reputation": 8714, "user_id": 306084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/546ee016aba112078e62861bdc38ae69?s=128&d=identicon&r=PG", "display_name": "pjmorse", "link": "https://stackoverflow.com/users/306084/pjmorse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 57436106, "answer_count": 2, "score": 1, "last_activity_date": 1565381433, "creation_date": 1565191256, "question_id": 57397674, "link": "https://stackoverflow.com/questions/57397674/why-do-i-need-to-initialize-a-cucumber-datatable-with-a-cucumber-datatable", "title": "Why do I need to initialize a Cucumber DataTable with a Cucumber DataTable?", "body": "<p>We recently started to drag a very old Rails app up to date (or at least out of obsolescence). One of the changes was an update of Cucumber from 1.3.x to 2.99.</p>\n\n<p>Many of our rspec specs on this app used a helper for loading test data which leveraged <code>Cucumber::Ast::DataTable</code>. (The helper declared its own subclass which inherited from <code>Cucumber::Ast::DataTable</code>.) This was deprecated, so as suggested, I replaced the inheritance with <code>Cucumber::MultilineArgument::DataTable</code>.</p>\n\n<p>The subclass looks like this:</p>\n\n<pre><code>class ParsedTable &lt; ::Cucumber::MultilineArgument::DataTable\n  def initialize(string)\n    super(string.split(\"\\n\").map do |line|\n      line = line.split('|').map(&amp;:squish)\n      line.slice(1, line.length)\n    end)\n  end\nend\n</code></pre>\n\n<p>Then there are a bunch of test helpers which create test data like this (assume \"role\" is a model we'll be testing against):</p>\n\n<pre><code>def create_roles(string)\n  table = ParsedTable.new(string)\n  table.hashes.each do |hash|\n    create :role,\n      name: hash['Name'],\n      short_name: hash['Short Name'],\n      contracted_work_day: hash['Contracted workday in minutes']\n  end\nend\n</code></pre>\n\n<p>These helpers get called like this:</p>\n\n<pre><code>create_roles &lt;&lt;-eos\n  | Name      | Contracted workday in minutes |\n  | Therapist | 390                           |\neos\n</code></pre>\n\n<p>But when that kind of call goes in, I get <code>ArgumentError: data must be a Core::Ast::DataTable</code>. The stack says this exception is from <code>lib/cucumber/multiline_argument/data_table.rb:93:in 'initialize'</code> which is the <code>super</code> call in the <code>ParsedTable</code> definition.</p>\n\n<p>I've been trying to chase this around the Cucumber source and I can't figure out what I'm doing wrong.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "block"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1565190589, "post_id": 57397278, "comment_id": 101276559, "body": "You can just pass that, what you want in the block as an argument. Is there a specific reason you want to use a block?"}, {"owner": {"reputation": 53, "user_id": 11885305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42514adbf8ec46977e9f547e4dfc5f30?s=128&d=identicon&r=PG&f=1", "display_name": "DEv", "link": "https://stackoverflow.com/users/11885305/dev"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1565191037, "post_id": 57397278, "comment_id": 101276797, "body": "You have to deliver right away - <code>return_dto_object { Comment.where(product_id: id) }</code>??"}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 3, "last_activity_date": 1565191509, "creation_date": 1565191509, "answer_id": 57397752, "question_id": 57397278, "link": "https://stackoverflow.com/questions/57397278/how-pass-yield-in-method-as-param/57397752#57397752", "title": "How pass yield in method as param", "body": "<p><code>where</code> is able to receive a hash as an argument, so, whenever you do:</p>\n\n<pre><code>Comment.where(product_id: id)\n</code></pre>\n\n<p>It's equivalent to:</p>\n\n<pre><code>Comment.where({ product_id: id })\n</code></pre>\n\n<p>You can create a hash with \"dynamic\" keys the way:</p>\n\n<pre><code>{ key =&gt; value }\n</code></pre>\n\n<p>So, passing product_id, it'd be:</p>\n\n<pre><code>attribute = :product_id\n{ attribute =&gt; 1 } #\u00a0{:product_id=&gt;1}\n</code></pre>\n\n<p>Which is the valid syntax for invoking <code>where</code>:</p>\n\n<pre><code>def return_dto_object(attribute, id)\n  Comment.where(attribute =&gt; id)\nend\n</code></pre>\n\n<p>If it's confusing, you can first create the hash, and pass it to where.</p>\n"}], "owner": {"reputation": 53, "user_id": 11885305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42514adbf8ec46977e9f547e4dfc5f30?s=128&d=identicon&r=PG&f=1", "display_name": "DEv", "link": "https://stackoverflow.com/users/11885305/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57397752, "answer_count": 1, "score": 1, "last_activity_date": 1565191509, "creation_date": 1565189964, "question_id": 57397278, "link": "https://stackoverflow.com/questions/57397278/how-pass-yield-in-method-as-param", "title": "How pass yield in method as param", "body": "<p>I have method:</p>\n\n<pre><code>def return_dto_object(id)\n    Comment.where(product_id: id)\nend\n</code></pre>\n\n<p>And i wanna pass block and put it instead of <code>product_id</code>\nFor Example:</p>\n\n<pre><code>def return_dto_object(id)\n    Comment.where(yield: id)\nend\n\n=&gt; return_dto_object(1) { product_id }\n=&gt; return_dto_object(1) { id }\n</code></pre>\n\n<p>I just wanna change the column that the records will search for. This possible, that i want?</p>\n"}, {"tags": ["ruby", "enums", "static-analysis"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 4, "creation_date": 1565188953, "post_id": 57395939, "comment_id": 101275651, "body": "Can you clarify enums? Rails has enums, there&#39;s a couple ruby gems for enums. Are you talking about a custom made enum class or an existing implementation?"}, {"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 2, "creation_date": 1565192922, "post_id": 57395939, "comment_id": 101277809, "body": "If we define the word &quot;enum&quot; (not defined yet by OP) to mean &quot;array of symbols&quot; (or any other literal value), then yes, we absolutely can do this kind of static analysis with AST-based tools like rubocop, because the enum values are static (they appear as literal nodes in the AST). It&#39;s not possible though, to statically analyze certain expressions in case statements, however. For example: <code>when &#47;regex&#47;</code>. So, our analysis is limited to case statements that use simple equality comparison."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565199149, "post_id": 57395939, "comment_id": 101280831, "body": "It would be helpful to have an example. In Ruby an enum is an instance of the class <a href=\"https://ruby-doc.org/core-2.6.3/Enumerator.html\" rel=\"nofollow noreferrer\">Enumerator</a> and a &quot;switch statement&quot; is called a &quot;case statement&quot; and uses <code>===</code> methods for comparisons when <code>case</code> takes an argument (e.g., <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-3D-3D-3D\" rel=\"nofollow noreferrer\">String#===</a>)."}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1565220337, "post_id": 57395939, "comment_id": 101288221, "body": "Thanks for your feedback, I have added an example, does this help ? I was really talking about an enum as a finite set, and we want to make sure our case statement will have as many <code>when</code> clauses as the number of items in the enum set. Then this set could be an <code>Array</code>, a <code>Set</code> containing just <code>Symbols</code> or even other types of custom <code>Object</code>s, whatever is more appropriate to tackling the problem of exhaustiveness"}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1565246456, "post_id": 57395939, "comment_id": 101294010, "body": "If you&#39;re making a &quot;Java-like&quot; enum (which mean all the value are object) you can do the following :   - Define a method in ErrorEnum that calls the correct method from sender (<code>render_gone</code> for example) using a instance variable of ErrorEnum.   - Instead of using a <code>case when</code> (where you&#39;re 100% sure you can&#39;t check if all the enum value are checked without making a mock) you&#39;ll just call <code>policy.call_error_render_of(self)</code>. This way all the value should have a &quot;error_render&quot; and if you forgot to define one, it&#39;ll raise an error."}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1565272015, "post_id": 57395939, "comment_id": 101308346, "body": "Okay so basically you&#39;re suggesting an inversion of control where the Enum/policy calls the render method of the controller ? This doesn&#39;t seem sound clean from an archi point of view : the Enum does not need to know how the error will be rendered, just to provide basic metadata regarding the error and then the controller renders an appropriate html/json response to add the relevant http status code, etc."}], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 452, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565220769, "creation_date": 1565185568, "last_edit_date": 1565220769, "question_id": 57395939, "link": "https://stackoverflow.com/questions/57395939/how-to-ensure-exhaustivity-of-enum-based-case-statements-in-ruby-like-with-switc", "title": "How to ensure exhaustivity of enum-based case statements in Ruby like with switch statements in Java", "body": "<p>First of all, this question is related but not solved by </p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/1461286/advanced-java-like-enums-in-ruby\">Advanced Java-like enums in Ruby</a></li>\n<li><a href=\"https://stackoverflow.com/questions/50607799/static-analysis-of-exhaustive-switch-statements-of-enums\">Static analysis of exhaustive switch statements of enums</a></li>\n</ul>\n\n<p>Then about the question itself : when programming in Java with IDEs like Eclipse, it's possible to have a warning when we implement a switch statement on an enum, and we forgot some cases in the switch statement (very useful after adding an extra possible value to the enum and we forget to edit all switches based on this enum)</p>\n\n<p>Is it possible to have the same kind of static analysis in Ruby ? Is there a way to implement enums so that we'd get a warning (maybe after running rubocop or something) if we forget to implement a case ?</p>\n\n<p>EDIT</p>\n\n<p>This \"enum\" I'm talking about could be any type of <code>Set</code> like object with a finite number of values, the most simplest form being an array of symbols, but maybe it is not enough/convenient to perform analysis with it hence why I am starting this question</p>\n\n<p>On of my use case involve checking all possible errors after performing Policy checks</p>\n\n<pre><code>class CanShowArticlePolicy\n  def call\n    list_of_exceptions = [:unpublished, :deleted, \n  :offensive_content_detected]\n    # business logic that returns either true or false and add exception information exception, can be mocked as\n    @error = list_of_exceptions.sample\n    false\n  end\nend\n\n# in another file like a controller or service\narticle = Article.find(id)\npolicy = CanShowArticlePolicy.new(article)\nif policy.call\n  render_article\nelse\n  # Where I'm trying to be exhaustive\n  case policy.error # &lt;== Goal : detect here we are swithing on an \"enum\" with finite values and we should be exhaustive\n  when :unpublished\n    render_unpublished_error\n  when :deleted\n    render_gone\n  # &lt;&lt;= Here I would like to get a rubocop error because we've forgotten to handle the `:offensive_content_detected` case\n  end\n</code></pre>\n\n<p>Maybe a solution would be to have instead something like an annotation</p>\n\n<pre><code>case enum_value # @exhaustive-case with ::CanShowArticlePolicy::ErrorEnum\n</code></pre>\n\n<p>and the annotation would have for effect of the static analysis trying to find a <code>::CanShowArticlePolicy::ErrorEnum</code> array containing the symbols, and making sure there are as many <code>when</code> statements as number of items in the frozen ErrorEnum</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "sphinx", "thinking-sphinx"], "comments": [{"owner": {"reputation": 1928, "user_id": 6193734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yNKciMo2y_0/AAAAAAAAAAI/AAAAAAAACGs/Hg_DmZMu7Lw/photo.jpg?sz=128", "display_name": "Matthieu Libeer", "link": "https://stackoverflow.com/users/6193734/matthieu-libeer"}, "edited": false, "score": 0, "creation_date": 1565204888, "post_id": 57395447, "comment_id": 101283368, "body": "Try <code>includes</code> instead of <code>include</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "is_accepted": true, "score": 1, "last_activity_date": 1565228697, "creation_date": 1565228697, "answer_id": 57404178, "question_id": 57395447, "link": "https://stackoverflow.com/questions/57395447/how-to-include-associations-in-thinking-sphinx-rails/57404178#57404178", "title": "How to include associations in thinking sphinx rails", "body": "<p>Since <a href=\"https://freelancing-gods.com/thinking-sphinx/v3/searching.html#advanced\" rel=\"nofollow noreferrer\">Thinking Sphinx v3</a>, the <code>:include</code> option is now within the <code>:sql</code> option:</p>\n\n<pre><code>Article.search :sql =&gt; {:include =&gt; :pictures}\n</code></pre>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 57404178, "answer_count": 1, "score": 0, "last_activity_date": 1565228697, "creation_date": 1565183914, "question_id": 57395447, "link": "https://stackoverflow.com/questions/57395447/how-to-include-associations-in-thinking-sphinx-rails", "title": "How to include associations in thinking sphinx rails", "body": "<p>Using <code>thinking-sphinx</code> to fetch records and it works fine. But the issue is that I want to fetch associated records also in results to improve site performance.</p>\n\n<p>Like I want to fetch pictures of articles also along with articles .</p>\n\n<p>Tried this one but its not working</p>\n\n<pre><code> Article.search :include =&gt; [:pictures]\n</code></pre>\n\n<p>How can I do that?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-6"], "comments": [{"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565194600, "post_id": 57395140, "comment_id": 101278624, "body": "Can you include your current code for your edit form?"}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "reply_to_user": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565215009, "post_id": 57395140, "comment_id": 101287035, "body": "@Doughtz Yes of course, i&#39;m still new to the stack community and how to display images the link down below shows how the form looks ."}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565220503, "post_id": 57395140, "comment_id": 101288250, "body": "Which javascript framework are you using? Just plain old Javascript or JQuery or something else? Or nothing yet?"}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "reply_to_user": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565228871, "post_id": 57395140, "comment_id": 101289791, "body": "the solution you are suggesting only takes effect in <code>show.html.erb</code> and what i want is to make a field either shown/hidden in <code>index.html.erb</code> where user information is displayed. i&#39;m just using the standard rails 6 with webpacker"}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565229096, "post_id": 57395140, "comment_id": 101289826, "body": "Oh okay. So you don\u2019t want the input box filled. You want to hide the attribute that is displayed on a different page?"}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "reply_to_user": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565230698, "post_id": 57395140, "comment_id": 101290113, "body": "yes exactly, i have been searching around for 2 days and couldn&#39;t find a way to implement it."}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565230986, "post_id": 57395140, "comment_id": 101290166, "body": "So you want a button that hides multiple fields at once, or multiple buttons that hide one field each?"}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "reply_to_user": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565231077, "post_id": 57395140, "comment_id": 101290188, "body": "i think it&#39;s better to have multiple buttons for each field"}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565231150, "post_id": 57395140, "comment_id": 101290204, "body": "Okay. Can you post the code for the page where you want the attributes hidden? I\u2019ll update it so you can hide them with a button click. It\u2019ll be very similar to my previous answer."}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "reply_to_user": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565231400, "post_id": 57395140, "comment_id": 101290252, "body": "Thanks! could your please specify which code, because what i have done with devise registration edit.html.erb, i created custom routes and split the form into multiple small forms. i&#39;ll post the codes"}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565231862, "post_id": 57395140, "comment_id": 101290331, "body": "Just the code for the page index.html.erb because that\u2019s where you want to toggle the hide/show"}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "reply_to_user": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565232044, "post_id": 57395140, "comment_id": 101290370, "body": "there&#39;s only simple piece of html i&#39;m experimenting with ` &lt;div class=&quot;text-dark&quot;&gt; &lt;%= @user.email %&gt; &lt;/div&gt;"}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565233116, "post_id": 57395140, "comment_id": 101290538, "body": "Okay check out my answer now."}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565282194, "post_id": 57395140, "comment_id": 101314076, "body": "Can you please mark my answer as correct since it worked for you?"}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "reply_to_user": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565284500, "post_id": 57395140, "comment_id": 101315062, "body": "it works but not the how i want it, i think i would need additional fields (Boolean) to toggle those options. They can be added to user model and displayed in the devise edit registration form. Then i can conditionally render fields within my views based on those booleans.  by the way when i try to mark answers as corret, i get this message : Thanks for the feedback! Votes cast by those with less than 15 reputation are recorded, but do not change the publicly displayed post score."}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565284640, "post_id": 57395140, "comment_id": 101315130, "body": "I see. You want to save that preference of the info being hidden?"}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "reply_to_user": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565284998, "post_id": 57395140, "comment_id": 101315272, "body": "yes i guess so, i would need to generate a migration to user model with type of boolean and the rest i don&#39;t know how to achieve especially the conditions ."}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565285164, "post_id": 57395140, "comment_id": 101315359, "body": "You would just create a migration like you said. rails g migration AddHiddenFieldsToShop hide_email:boolean hide_name:boolean"}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565285217, "post_id": 57395140, "comment_id": 101315385, "body": "Then use the button to update the user model with the change of the value"}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "reply_to_user": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565286454, "post_id": 57395140, "comment_id": 101315889, "body": "so how i can associate the new AddHiddenFieldsToUser(in my case) with the previous migration (AddExtraFieldsToUser) ?"}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565374795, "post_id": 57395140, "comment_id": 101348375, "body": "What do you mean by associate them?"}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "reply_to_user": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565485833, "post_id": 57395140, "comment_id": 101369447, "body": "I thought that ill be needing only one field <code>is_visible:boolean</code> and then i have created a condition in the view :  <code>&lt;% if @user.is_visible? %&gt;   &lt;div class=&quot;text-dark&quot;&gt; &lt;%= @user.email %&gt; &lt;&#47;div&gt; &lt;% end %&gt;</code> and it worked just fine as i wanted it to be, now all i need to do is implement your suggestion for all the fields that i want to make invisble. thank you so much !!"}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565488305, "post_id": 57395140, "comment_id": 101369636, "body": "yeah just need to create Ajax to change hide/show when the button is clicked."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1565234259, "post_id": 57403534, "comment_id": 101290733, "body": "thanks it works like a charm, is it only related to the current user or all users who visit the current user profile ?"}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "reply_to_user": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1565234311, "post_id": 57403534, "comment_id": 101290745, "body": "It will work for whoever the user is that is visiting that page."}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "reply_to_user": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1565234337, "post_id": 57403534, "comment_id": 101290754, "body": "You can test it by creating another user and you will see that it works for that user also."}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1565234678, "post_id": 57403534, "comment_id": 101290830, "body": "that gonna takes some time, my routes are missed up and haven&#39;t got around to get user path by id, i have a lot to learn about rails but thank you so much for your effort and valuable time !!"}, {"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "reply_to_user": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 1, "creation_date": 1565234727, "post_id": 57403534, "comment_id": 101290840, "body": "Sure thing! Good luck! If you could, please mark this answer as correct :)"}], "tags": [], "owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "is_accepted": false, "score": 1, "last_activity_date": 1565233062, "last_edit_date": 1565233062, "creation_date": 1565221769, "answer_id": 57403534, "question_id": 57395140, "link": "https://stackoverflow.com/questions/57395140/how-to-add-show-hide-action-in-rails-forms-only-in-the-view-template/57403534#57403534", "title": "How to add show/hide action in rails forms only in the view template", "body": "<p>You'll want to do 3 things:</p>\n\n<ul>\n<li>Add a button with an onclick handler that allows the user to click on it to hide/show the field</li>\n<li>Add an ID to the div you are using to show the attribute</li>\n<li>Create a javascript function to show/hide that div</li>\n</ul>\n\n<p>So add the button outside the div you are hiding and include the onclick</p>\n\n<pre><code>&lt;%= button_tag \"Hide/Show\", :onclick =&gt; \"hideInput()\" %&gt;\n</code></pre>\n\n<p>Then add the ID to the div you are hiding. In your case, do something like this. You can use any ID you want. Mine is just an example.</p>\n\n<pre><code>&lt;div id=\"emailDisplayed\" class=\"text-dark\"&gt; &lt;%= @user.email %&gt; &lt;/div&gt;\n</code></pre>\n\n<p>Then you want to add the hideInput function in your javascript file. Preferably in <code>assets/javascripts/[file_name]</code></p>\n\n<pre><code>function hideInput() {\n  var emailDiv = document.getElementById(\"emailDisplayed\");\n  emailDiv.style.display === \"block\" ?  emailDiv.style.display = 'none' : emailDiv.style.display = 'block';\n}\n</code></pre>\n\n<p>Now when the user clicks on the button, it will hide/show your div that contains the user email.</p>\n"}], "owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565233062, "creation_date": 1565182936, "last_edit_date": 1565231729, "question_id": 57395140, "link": "https://stackoverflow.com/questions/57395140/how-to-add-show-hide-action-in-rails-forms-only-in-the-view-template", "title": "How to add show/hide action in rails forms only in the view template", "body": "<p>I'm new to rails and using to devise for authentication, what i want to accomplish is user privacy. </p>\n\n<p>Meaning in edit form i want to add a toggle switch action for example 'Email field' to give the user the ability to show/hide fields in his profile but the form still displayed in the edit view.</p>\n\n<pre><code>&lt;%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %&gt;\n  &lt;%= f.error_notification %&gt;\n\n  &lt;div class=\"form-inputs\"&gt;\n    &lt;div class=\"container mt-5\"&gt;\n      &lt;div class=\"row\"&gt;\n        &lt;div class=\"col-sm-3\"&gt;\n          &lt;!-- Left menu links --&gt;        \n          &lt;ul class=\"nav-item pl-0\"&gt;\n            &lt;h4 class=\"nav-link disabled mb-0 text-dark font-weight-bold\"&gt;Settings&lt;/h4&gt;\n            &lt;%= link_to 'Personal information', \"/users/edit\", class: \"nav-link text-dark font-weight-bold\" %&gt;\n            &lt;%= link_to 'Account settings', \"/account/settings\", class: \"nav-link text-dark font-weight-bold\" %&gt;\n            &lt;%= link_to 'Password settings', \"/account/passwords\", class: \"nav-link text-dark font-weight-bold\" %&gt;\n            &lt;%= link_to 'Security', \"/account/security\", class: \"nav-link text-dark font-weight-bold\" %&gt;\n          &lt;/ul&gt;\n        &lt;/div&gt;\n\n        &lt;!-- Right from inputs --&gt;\n        &lt;div class=\"col-sm-9 shadow-sm border border-dark p-3 mb-5 mx-3 mx-sm-0 mx-lg-0 mx-xl-0 bg-white rounded\"&gt;\n\n          &lt;div class=\"form-inline form-group\"&gt;\n            &lt;div class=\"col-sm-2\"&gt;\n              &lt;label class=\"text-dark font-weight-bold  justify-content-start\"&gt;First name:&lt;/label&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-sm-4\"&gt;\n              &lt;%= f.input :first_name, label: false, input_html: { class: \"form-control w-100 border-top-0 border-right-0 border-left-0 rounded-0\", placeholder: \"First name\"} %&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n\n          &lt;div class=\"form-inline form-group\"&gt;\n            &lt;div class=\"col-sm-2\"&gt;\n              &lt;label class=\"text-dark font-weight-bold  justify-content-start\"&gt;Last name:&lt;/label&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-sm-4\"&gt;\n              &lt;%= f.input :last_name, label: false, input_html: { class: \"form-control w-100 border-top-0 border-right-0 border-left-0 rounded-0\", placeholder: \"Last name\"} %&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n\n          &lt;div class=\"dropdown-divider my-4\"&gt;&lt;/div&gt;\n          &lt;label class=\"text-dark font-weight-bold px-3 mb-4\"&gt;Biography&lt;/label&gt;\n          &lt;div class=\"form-inline form-group\"&gt;\n            &lt;div class=\"col-sm-2\"&gt;\n              &lt;label class=\"text-dark font-weight-bold  justify-content-start\"&gt;About:&lt;/label&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-sm-10\"&gt;\n              &lt;%= f.input :about, label: false, input_html: { class: \"form-control w-100 border-top-0 border-right-0 border-left-0 rounded-0\", placeholder: \"Write in few lines something about yourself and what you are passionate about\"} %&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n\n          &lt;div class=\"dropdown-divider mt-5 mb-4\"&gt;&lt;/div&gt;\n          &lt;label class=\"text-dark font-weight-bold px-3 mb-4\"&gt;Career&lt;/label&gt;\n          &lt;div class=\"form-inline form-group\"&gt;\n            &lt;div class=\"col-sm-2\"&gt;\n              &lt;label class=\"text-dark font-weight-bold  justify-content-start\"&gt;Company:&lt;/label&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-sm-10\"&gt;\n              &lt;%= f.input :company, label: false, input_html: { class: \"form-control w-100 border-top-0 border-right-0 border-left-0 rounded-0\", placeholder: \"Where do you work?\"} %&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n\n          &lt;div class=\"form-inline form-group\"&gt;\n            &lt;div class=\"col-sm-2\"&gt;\n              &lt;label class=\"text-dark font-weight-bold  justify-content-start\"&gt;Job title:&lt;/label&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-sm-10\"&gt;\n              &lt;%= f.input :job_title, label: false, input_html: { class: \"form-control w-100 border-top-0 border-right-0 border-left-0 rounded-0\", placeholder: \"Current working position?\"} %&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n          &lt;div class=\"form-inline form-group\"&gt;\n            &lt;div class=\"col-sm-2\"&gt;\n              &lt;label class=\"text-dark font-weight-bold  justify-content-start\"&gt;School / University:&lt;/label&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-sm-10\"&gt;\n              &lt;%= f.input :school, label: false, input_html: { class: \"form-control w-100 border-top-0 border-right-0 border-left-0 rounded-0\", placeholder: \"Name of school or university\"} %&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n\n          &lt;!-- Right update button --&gt;\n          &lt;div class=\"form-inline justify-content-end py-2 px-3\"&gt;\n            &lt;div class=\"col-sm-2\"&gt;\n              &lt;%= f.button :submit, \"Update\", class: \"btn btn-primary btn-sm btn-block\" %&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;   \n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>i made a custom devise registration controller </p>\n\n<pre><code>app/controllers/registations_controller.rb\n\nclass RegistrationsController &lt; Devise::RegistrationsController\n\n  def update\n    self.resource = resource_class.to_adapter.get!(send(:\"current_#{resource_name}\").to_key)\n    prev_unconfirmed_email = resource.unconfirmed_email if resource.respond_to?(:unconfirmed_email)\n\n    resource_updated = update_resource(resource, account_update_params)\n    yield resource if block_given?\n    if resource_updated\n      set_flash_message_for_update(resource, prev_unconfirmed_email)\n      bypass_sign_in resource, scope: resource_name if sign_in_after_change_password?\n      respond_with resource, location: after_update_path_for(resource)\n    else\n      clean_up_passwords resource\n      set_minimum_password_length\n      session[:return_to] ||= request.referer\n      redirect_to session.delete(:return_to), alert: resource.errors.full_messages[0]\n\n    end\n  end\n\n\n  def settings\n      @user = current_user\n      if @user\n          render :settings\n      else\n          render file: 'public/404', status: 404, formats: [:html]\n       end \n  end\n\n  def passwords\n    @user = current_user\n    if @user\n      render :passwords\n    else\n      render file: 'public/404', status: 404, formats: [:html]\n    end\n  end\n\n  def security\n    @user = current_user\n    if @user\n      render :security\n    else\n      render file: 'public/404', status: 404, formats: [:html]\n    end\n  end  \nend\n</code></pre>\n\n<pre><code>app/controllers/users_controller.rb\n\nclass UsersController &lt; ApplicationController\n  before_action :authenticate_user!\n  def show\n    @user = current_user\n  end\nend\n\n</code></pre>\n\n<pre><code>routes.rb\n\nRails.application.routes.draw do\n  get 'users/show'\n  root 'pages#home'\n  # For details on the DSL available within this file, see https://guides.rubyonrails.org/routing.html\n\n  devise_for :users, controllers: { registrations: \"registrations\" }\n  resources :user, only: [:show]\n  devise_scope :user do \n    get 'accounts/settings', to: 'registrations#settings', as: :settings\n    get 'accounts/passwords', to: 'registrations#passwords', as: :passwords\n    get 'accounts/security', to: 'registrations#security', as: :security\n  end \nend\n</code></pre>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 339, "user_id": 3705088, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/760511451f02c9b65551b912054e8d81?s=128&d=identicon&r=PG&f=1", "display_name": "Doughtz", "link": "https://stackoverflow.com/users/3705088/doughtz"}, "edited": false, "score": 0, "creation_date": 1565194792, "post_id": 57395052, "comment_id": 101278722, "body": "Can you just add .where(status: &quot;good&quot;) to your query? Request.where(status: &quot;good&quot;).group(&quot;date(created_at)&quot;).count"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 8731239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6406cb32c55193f324eab9d7b17bfaa4?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/8731239/yassine"}, "edited": false, "score": 0, "creation_date": 1565185327, "post_id": 57395350, "comment_id": 101273385, "body": "Thanks but this does not work, it just counts the number per status, not the number of consecutive good."}], "tags": [], "owner": {"reputation": 39, "user_id": 11692147, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-539gFQ9wkoc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdn638bq29FFTZPIHuJrgtwZlUH5Q/mo/photo.jpg?sz=128", "display_name": "patel MaMtA", "link": "https://stackoverflow.com/users/11692147/patel-mamta"}, "is_accepted": false, "score": 0, "last_activity_date": 1565183621, "creation_date": 1565183621, "answer_id": 57395350, "question_id": 57395052, "link": "https://stackoverflow.com/questions/57395052/rails-sql-count-the-number-of-consecutive-records-having-a-specific-status/57395350#57395350", "title": "Rails/SQL: count the number of consecutive records having a specific status", "body": "<p><strong>Try this one</strong></p>\n\n<pre><code>Request.group('DATE(created_at)', :status).count\n</code></pre>\n\n<p>This gives the result</p>\n\n<pre><code>a = {[Fri, 15 Jun 2012, \"good\"]=2, [Fri, 30 Jan 2015, \"good\"]=&gt;1, [Thu, 02 Oct 2008, \"bad\"]=&gt;3, [Thu, 26 Jul 2018, \"good\"]=&gt;1}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 180, "user_id": 1881608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef99f58ba5a8d821ac4cb357b4478d0?s=128&d=identicon&r=PG", "display_name": "Praveen", "link": "https://stackoverflow.com/users/1881608/praveen"}, "is_accepted": false, "score": -1, "last_activity_date": 1565360628, "last_edit_date": 1565360628, "creation_date": 1565191836, "answer_id": 57397850, "question_id": 57395052, "link": "https://stackoverflow.com/questions/57395052/rails-sql-count-the-number-of-consecutive-records-having-a-specific-status/57397850#57397850", "title": "Rails/SQL: count the number of consecutive records having a specific status", "body": "<p>You can do it by creating chunks and then count like this</p>\n\n<pre><code>Request.order(\"created_at\").all.map(&amp;:status).chunk{|status| status==\"good\"}.count{|good_group_count,arr| good_group_count}\n</code></pre>\n\n<p>Also we can select only status column to optimise query like below</p>\n\n<pre><code>Request.order(\"created_at\").select(\"status\").map(&amp;:status).chunk{|status| status==\"good\"}.count{|good_group_count,arr| good_group_count}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 11347906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qoAGArQpAPQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVLjRNnqCXF01NVMsS2UXMwZJKCg/mo/photo.jpg?sz=128", "display_name": "Y.Z", "link": "https://stackoverflow.com/users/11347906/y-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1565360628, "creation_date": 1565182666, "question_id": 57395052, "link": "https://stackoverflow.com/questions/57395052/rails-sql-count-the-number-of-consecutive-records-having-a-specific-status", "title": "Rails/SQL: count the number of consecutive records having a specific status", "body": "<p>I'm trying to count the number of groups of consecutive requests, having a specific status.</p>\n\n<pre><code>Example:\n\nRequest 1 status=bad\nRequest 2 status=good\nRequest 3 status=good\nRequest 4 status=bad\nRequest 5 status=bad\nRequest 6 status=bad\nRequest 7 status=good\nRequest 8 status=bad\n</code></pre>\n\n<p>So we're having here two groups of consecutive <code>good</code>: <code>[2, 3] and [7]</code>.</p>\n\n<p>The goal then is to have <code>result = 2</code>.</p>\n\n<p>Here is what I'm using right now:</p>\n\n<pre><code>Request.group(\"date(created_at)\").count\n</code></pre>\n\n<p>With a result:</p>\n\n<pre><code>SELECT COUNT(*) AS count_all, date(created_at) AS date_created_at FROM \"requests\" GROUP BY date(created_at)\n\n{Wed, 07 Aug 2019=&gt;240, Mon, 05 Aug 2019=&gt;245, Tue, 06 Aug 2019=&gt;511}\n</code></pre>\n\n<p>But this counts all requests, not the number of consecutive <code>good</code>.</p>\n"}, {"tags": ["ruby", "algorithm", "floating-point", "ieee-754", "enumerable"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 8, "creation_date": 1565181598, "post_id": 57394493, "comment_id": 101270891, "body": "A comment in the <a href=\"https://github.com/ruby/ruby/blob/4ea5c5610aeadecf78fdd2b7d6faad8574953620/enum.c#L3898\" rel=\"nofollow noreferrer\"><code>sum</code> source</a> points to <a href=\"http://link.springer.com/article/10.1007/s00607-005-0139-x\" rel=\"nofollow noreferrer\">A Generalized Kahan-Babu\u0161ka-Summation-Algorithm</a>, which explains why <code>sum</code> is more accurate."}, {"owner": {"reputation": 1616, "user_id": 2020801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9981dde909678f98fb25eed05cc9f23f?s=128&d=identicon&r=PG", "display_name": "Erik Madsen", "link": "https://stackoverflow.com/users/2020801/erik-madsen"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1565182108, "post_id": 57394493, "comment_id": 101271204, "body": "That must be the answer. Thank you!  Trying to search for the term led me to <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Kahan_summation_algorithm</a> which explains the general principle well."}], "answers": [{"tags": [], "owner": {"reputation": 1616, "user_id": 2020801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9981dde909678f98fb25eed05cc9f23f?s=128&d=identicon&r=PG", "display_name": "Erik Madsen", "link": "https://stackoverflow.com/users/2020801/erik-madsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1565292601, "creation_date": 1565292601, "answer_id": 57419479, "question_id": 57394493, "link": "https://stackoverflow.com/questions/57394493/how-does-enumerablesum-avoid-floating-point-rounding-errors/57419479#57419479", "title": "How does Enumerable#sum avoid floating point rounding errors?", "body": "<p><a href=\"https://stackoverflow.com/users/240443/amadan\">Amadan</a> gave the answer in a <a href=\"https://stackoverflow.com/questions/57394493/how-does-enumerablesum-avoid-floating-point-rounding-errors#comment101270891_57394493\">comment</a>.</p>\n\n<p>For floating point values <code>Enumerable#sum</code> uses an algorithm that compensates for the accumulation of error as the summation progresses.</p>\n\n<p>As mentioned in the comment, the source code links to <a href=\"http://link.springer.com/article/10.1007/s00607-005-0139-x\" rel=\"nofollow noreferrer\">this paper</a> and Wikipedia has an article on a variation of the described algorithm known as the <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow noreferrer\">Kahan Summation Algorithm</a>.</p>\n"}], "owner": {"reputation": 1616, "user_id": 2020801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9981dde909678f98fb25eed05cc9f23f?s=128&d=identicon&r=PG", "display_name": "Erik Madsen", "link": "https://stackoverflow.com/users/2020801/erik-madsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 57419479, "answer_count": 1, "score": 5, "last_activity_date": 1565292762, "creation_date": 1565180764, "last_edit_date": 1565292762, "question_id": 57394493, "link": "https://stackoverflow.com/questions/57394493/how-does-enumerablesum-avoid-floating-point-rounding-errors", "title": "How does Enumerable#sum avoid floating point rounding errors?", "body": "<p>I was playing around with some toy examples of floating point rounding errors in Ruby, and I noticed the following behaviour which surprised me.</p>\n\n<p>First, an unsurprising example, where the rounding error occurs:</p>\n\n<pre><code>numbers = Array.new(10, 0.1)\n#=&gt; [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]\n\nnumbers.inject(0, :+)\n#=&gt; 0.9999999999999999\n</code></pre>\n\n<p>Now try the same with <code>Enumerable#sum</code>:</p>\n\n<pre><code>numbers.sum\n#=&gt; 1.0\n</code></pre>\n\n<p>The only thing I could find in the documentation that would hint at an explanation is</p>\n\n<blockquote>\n  <p>sum method may not respect method redefinition of \u201c+\u201d methods such as Integer#+.</p>\n</blockquote>\n\n<p>so I suppose there's some kind of native code implementation in place to speed up things, but I would assume C floating points are also subject to IEEE-754 related imprecise arithmetic.</p>\n\n<p>What is the reason for the behaviour in the second example? How is the <code>sum</code> method able to avoid the rounding error?</p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565177534, "post_id": 57393053, "comment_id": 101268624, "body": "please post full code and full backtrace errors in your question or we can&#39;t figure out where your error is even being raised."}, {"owner": {"reputation": 135, "user_id": 3858468, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e06a293d8ab8d474d1f92bc1bac9fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Neosapien", "link": "https://stackoverflow.com/users/3858468/neosapien"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565178685, "post_id": 57393053, "comment_id": 101269269, "body": "I&#39;ve added the full error message."}, {"owner": {"reputation": 654, "user_id": 6683147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b3599d7eab61ae82354d60a4464703?s=128&d=identicon&r=PG&f=1", "display_name": "Gilg Him", "link": "https://stackoverflow.com/users/6683147/gilg-him"}, "edited": false, "score": 0, "creation_date": 1565181953, "post_id": 57393053, "comment_id": 101271092, "body": "can you try to output only the <code>config</code> and see what the result? Also, try to pin down on which line/ where exactly, the error is occurring. the error message you posted does not elaborate much on that"}, {"owner": {"reputation": 135, "user_id": 3858468, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e06a293d8ab8d474d1f92bc1bac9fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Neosapien", "link": "https://stackoverflow.com/users/3858468/neosapien"}, "edited": false, "score": 0, "creation_date": 1565182275, "post_id": 57393053, "comment_id": 101271310, "body": "I printed out config[:host] and it&#39;s the name of the server that I am trying to connect to. Putting the config prints out {host=&gt;&quot;server02&quot;}"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565184665, "post_id": 57393053, "comment_id": 101272926, "body": "how and where is config defined?  I was able to get the same error but config is not defined so I added a line to define it in the first line of the run method."}, {"owner": {"reputation": 135, "user_id": 3858468, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e06a293d8ab8d474d1f92bc1bac9fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Neosapien", "link": "https://stackoverflow.com/users/3858468/neosapien"}, "edited": false, "score": 0, "creation_date": 1565185568, "post_id": 57393053, "comment_id": 101273533, "body": "I can print the value of config and config[:host] out so I&#39;m guessing it is a built-in construct which works similar to using argparse in python."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 3858468, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e06a293d8ab8d474d1f92bc1bac9fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Neosapien", "link": "https://stackoverflow.com/users/3858468/neosapien"}, "edited": false, "score": 0, "creation_date": 1565255602, "post_id": 57397718, "comment_id": 101298566, "body": "Thanks @lacostenycoder. However it seems my version of Ruby (2.0.0) does not support net-ssh version &gt; 1.1.4. Version 5.2.0 needs Ruby 2.2.6."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 135, "user_id": 3858468, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e06a293d8ab8d474d1f92bc1bac9fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Neosapien", "link": "https://stackoverflow.com/users/3858468/neosapien"}, "edited": false, "score": 0, "creation_date": 1565284521, "post_id": 57397718, "comment_id": 101315071, "body": "@Neosapien see updated answer. Looks like I found a working gem version for ruby 2.0.0"}, {"owner": {"reputation": 135, "user_id": 3858468, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e06a293d8ab8d474d1f92bc1bac9fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Neosapien", "link": "https://stackoverflow.com/users/3858468/neosapien"}, "edited": false, "score": 0, "creation_date": 1565375263, "post_id": 57397718, "comment_id": 101348562, "body": "Brilliant! That did it! Also had to add require &#39;etc&#39; to the script because it threw a &quot;Check failed to run: uninitialized constant Net::SSH::Etc&quot; error. Thank you."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1565284497, "last_edit_date": 1565284497, "creation_date": 1565191403, "answer_id": 57397718, "question_id": 57393053, "link": "https://stackoverflow.com/questions/57393053/how-to-fix-no-implicit-conversion-of-symbol-into-hash-in-ruby/57397718#57397718", "title": "How to fix &#39;no implicit conversion of Symbol into Hash&#39; in Ruby", "body": "<h3>Updated</h3>\n\n<p>I was able to find a compatible version with your ruby version. I tested this with ruby version </p>\n\n<blockquote>\n  <p><code>ruby 2.0.0p648 (2015-12-16 revision 53162) [x86_64-darwin18.2.0]</code></p>\n</blockquote>\n\n<p>With that version followed by:</p>\n\n<pre><code>gem install net-ssh --version 3.0.2\n</code></pre>\n\n<p>I was able to get my code below working without your error.</p>\n\n<h3>Original answer</h3>\n\n<p>The problem appears to be in the old version of <code>net-ssh</code> I tried a basic test with a working SSH server and got the same error with your version, but using the latest version <code>5.2.0</code> with no error.  I also used this format:</p>\n\n<pre><code>def run\n  puts \"SSHing #{config[:host]} ...\"\n  Net::SSH.start( config[:host],\n                  :password=&gt; 'password',\n                  :port=&gt; 22,\n                  :username=&gt; 'username') do |ssh|\n\n    puts ssh.exec!('hostname')\n    puts \"Logging out...\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 3858468, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e06a293d8ab8d474d1f92bc1bac9fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Neosapien", "link": "https://stackoverflow.com/users/3858468/neosapien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 57397718, "answer_count": 1, "score": 1, "last_activity_date": 1565284497, "creation_date": 1565176202, "last_edit_date": 1565179320, "question_id": 57393053, "link": "https://stackoverflow.com/questions/57393053/how-to-fix-no-implicit-conversion-of-symbol-into-hash-in-ruby", "title": "How to fix &#39;no implicit conversion of Symbol into Hash&#39; in Ruby", "body": "<p>I'm just starting to learn Ruby, and I tried making a simple script to ssh into a server. Here's the code snippet from my class:</p>\n\n<pre><code>require 'rubygems' if RUBY_VERSION &lt; '1.9.0'\nrequire 'sensu-plugin/check/cli'\ngem 'net-ssh', '= 1.1.4'\nrequire 'net/ssh'\n\nclass SshServer &lt; Sensu::Plugin::Check::CLI\n\n  option :host,\n         short: '-h HOST',\n         description: 'Server to ssh into',\n         required: true\n\n  def run\n    puts \"SSHing #{config[:host]} ...\"\n    Net::SSH.start(config[:host]) do |ssh|\n      puts ssh.exec!('hostname')\n      puts \"Logging out...\"\n    end\nend\n</code></pre>\n\n<p>I tried putting out the value of config[:host] and hard-coding the server name, and also config.get. No luck. I'm on Ruby version 2.0.0.</p>\n\n<p>This is the full error message. Sorry couldn't put it in a code block because it was triggering the 'too much code' warning:</p>\n\n<p>Check failed to run: </p>\n\n<pre><code>no implicit conversion of Symbol into Hash, [\n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:141:in `merge'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:141:in `register'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/definition-context.rb:123:in `method_missing'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh/transport/ossl/hmac/services.rb:30:in `block (2 levels) in register_services'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh/transport/ossl/hmac/services.rb:29:in `each'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh/transport/ossl/hmac/services.rb:29:in `block in register_services'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:107:in `define'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:250:in `block in namespace_define'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:177:in `call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:177:in `block in namespace'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:42:in `call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:42:in `block in call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:40:in `synchronize'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:40:in `call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/service-point.rb:122:in `instance'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:308:in `get'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:251:in `namespace_define'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh/transport/ossl/hmac/services.rb:26:in `register_services'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:365:in `require'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/definition-context.rb:77:in `require'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh/transport/ossl/services.rb:34:in `block in register_services'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:107:in `define'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:250:in `block in namespace_define'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:177:in `call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:177:in `block in namespace'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:42:in `call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:42:in `block in call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:40:in `synchronize'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:40:in `call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/service-point.rb:122:in `instance'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:308:in `get'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:251:in `namespace_define'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh/transport/ossl/services.rb:30:in `register_services'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:365:in `require'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/definition-context.rb:77:in `require'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh/transport/services.rb:137:in `block in register_services'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:107:in `define'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:250:in `block in namespace_define'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:177:in `call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:177:in `block in namespace'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:42:in `call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:42:in `block in call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:40:in `synchronize'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/lifecycle/singleton.rb:40:in `call'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/service-point.rb:122:in `instance'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:308:in `get'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:251:in `namespace_define'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh/transport/services.rb:23:in `register_services'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:365:in `require'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/definition-context.rb:77:in `require'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh/session.rb:126:in `block in initialize'\", \n\"/u/user/.gem/ruby/gems/needle-1.3.0/lib/needle/container.rb:107:in `define'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh/session.rb:106:in `initialize'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh.rb:47:in `new'\", \n\"/u/user/.gem/ruby/gems/net-ssh-1.1.4/lib/net/ssh.rb:47:in `start'\", \"check-directory-exists.rb:59:in `run'\", \n\"/u/user/.gem/ruby/gems/sensu-plugin-1.4.7/lib/sensu-plugin/cli.rb:58:in `block in &lt;class:CLI&gt;'\"\n]\n</code></pre>\n"}, {"tags": ["html", "ruby", "sinatra"], "comments": [{"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 1, "creation_date": 1565173886, "post_id": 57391552, "comment_id": 101266573, "body": "Cannot find <code>player_1_name</code>. Because it&#39;s not the path /names you visited in the test. I thingk, if you do <code>visit(&#39;&#47;names&#39;)</code>, the problem will be solved."}, {"owner": {"reputation": 109, "user_id": 11804875, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o5pyP52JmPA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfVHl72LM-BWim9v3wOol2NCA5XWw/photo.jpg?sz=128", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/11804875/mario-garcia"}, "reply_to_user": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1565174241, "post_id": 57391552, "comment_id": 101266766, "body": "Hi Demir, I&#39;ve tried that already and didn&#39;t work. Thanks"}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1565175014, "post_id": 57391552, "comment_id": 101267175, "body": "I think there&#39;s an error in the path. What is the path to this view? Could it be &#39;/battles&#39; or &#39;/battle/names&#39; ?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1565183260, "post_id": 57391552, "comment_id": 101272000, "body": "Try to <code>save_and_open_page</code> after calling <code>visit</code> and inspect the page under test in your browser. Maybe the elements are missing or you are simply on the wrong page."}, {"owner": {"reputation": 3597, "user_id": 2112512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9689bb4f705b8bede56deddf66c87ef?s=128&d=identicon&r=PG", "display_name": "Jake Worth", "link": "https://stackoverflow.com/users/2112512/jake-worth"}, "edited": false, "score": 0, "creation_date": 1565202546, "post_id": 57391552, "comment_id": 101282235, "body": "Setting aside the test for a minute, what happens when you visit the root path (<code>&#47;</code>) in a browser? Do you see the form you expect to be there?"}, {"owner": {"reputation": 109, "user_id": 11804875, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o5pyP52JmPA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfVHl72LM-BWim9v3wOol2NCA5XWw/photo.jpg?sz=128", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/11804875/mario-garcia"}, "edited": false, "score": 0, "creation_date": 1565265281, "post_id": 57391552, "comment_id": 101303970, "body": "Yes, in the homepage I expect to see <code>&#39;Testing infrastructure working!&#39;</code>, as I said, I tried changing the path to /names and still getting the same error."}], "answers": [{"tags": [], "owner": {"reputation": 3597, "user_id": 2112512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9689bb4f705b8bede56deddf66c87ef?s=128&d=identicon&r=PG", "display_name": "Jake Worth", "link": "https://stackoverflow.com/users/2112512/jake-worth"}, "is_accepted": true, "score": 1, "last_activity_date": 1565203494, "last_edit_date": 1565203494, "creation_date": 1565203153, "answer_id": 57400493, "question_id": 57391552, "link": "https://stackoverflow.com/questions/57391552/unable-to-find-field-player-1-name-that-is-not-disabled/57400493#57400493", "title": "Unable to find field &quot;player_1_name&quot; that is not disabled", "body": "<p>My guess is that if you visit the root path, you'll see <code>Testing infrastructure working!</code>. That's because <code>get '/'</code> is defined twice, and in my version of Sinatra (v2.0.5), the first declaration wins.</p>\n\n<p>Here's a simple version of this server that renders the form. It should pass the test:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app.rb\n\nrequire 'sinatra'\n\n# get '/' defined once\nget '/' do\n  erb :index\nend\n\npost '/names' do\n  @player_1_name = params[:player_1_name]\n  @player_2_name = params[:player_2_name]\n  erb :play\nend\n</code></pre>\n\n<p>Run with:</p>\n\n<pre><code>$ ruby app.rb\n</code></pre>\n\n<p>Caveat: you'll have to add a second equals sign to the play view as well, so ERB knows <code>@player_2_name</code> is a Ruby expression.</p>\n\n<pre><code># views/play.erb\n\n&lt;%= @player_1_name %&gt; vs. &lt;%= @player_2_name %&gt;\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 11804875, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o5pyP52JmPA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfVHl72LM-BWim9v3wOol2NCA5XWw/photo.jpg?sz=128", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/11804875/mario-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 57400493, "answer_count": 1, "score": 0, "last_activity_date": 1565203556, "creation_date": 1565171412, "last_edit_date": 1565203556, "question_id": 57391552, "link": "https://stackoverflow.com/questions/57391552/unable-to-find-field-player-1-name-that-is-not-disabled", "title": "Unable to find field &quot;player_1_name&quot; that is not disabled", "body": "<p>I just started this code by a walkthrough that I've been given. And my feature test should work but it gives me this error:</p>\n\n<h1><code>Unable to find field \"player_1_name\" that is not disabled</code></h1>\n\n<p>I have tried changing the quotes, the path, using [], and still giving me the same error.</p>\n\n<ul>\n<li>My ruby version.\nruby 2.6.3p62 (2019-04-16 revision 67580) [x86_64-darwin18]</li>\n<li>Also, I am using shotgun, sinatra, apart from Rspec and capybara.\nIn the code below I'll specify which file are each code.</li>\n</ul>\n\n<pre><code>#features/entre_names_spec.rp\n\nfeature \"Enter names\" do\n  scenario \"submitting names\" do\n    visit('/')\n    fill_in \"player_1_name\", with: 'Dave'\n    fill_in \"player_2_name\", with: 'Mittens'\n    click_button 'Submit'\n    expect(page).to have_content 'Dave vs. Mittens'\n  end\nend\n</code></pre>\n\n<pre><code>#app.rb\nrequire 'sinatra/base'\n\nclass Battle &lt; Sinatra::Base\n  get '/' do\n    'Testing infrastructure working!'\n  end\n\n  get '/' do\n    erb :index\n  end\n\n  post '/names' do\n    @player_1_name = params[:player_1_name]\n    @player_2_name = params[:player_2_name]\n    erb :play\n  end\n\n  # start the server if ruby file executed directly\n  run! if app_file == $0\nend\n</code></pre>\n\n<pre><code>views/index.erb\n&lt;form action= \"names\" method= \"post\"&gt;\n  &lt;input type= \"text\" name= \"player_1_name\"&gt;\n  &lt;input type= \"text\" name= \"player_2_name\"&gt;\n  &lt;input type= \"submit\" value= \"Submit\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<pre><code>#views/play.erb\n&lt;%= @player_1_name %&gt; vs. &lt;% @player_2_name %&gt;\n</code></pre>\n\n<pre><code>Failures:\n\n  1) Enter names submitting names\n     Failure/Error: fill_in \"player_1_name\", with: \"Dave\"\n\n     Capybara::ElementNotFound:\n       Unable to find field \"player_1_name\" that is not disabled\n     # /Users/student/.rvm/gems/ruby-2.6.3/gems/capybara-3.28.0/lib/capybara/node/finders.rb:296:in `block in synced_resolve'\n     # /Users/student/.rvm/gems/ruby-2.6.3/gems/capybara-3.28.0/lib/capybara/node/base.rb:83:in `synchronize'\n     # /Users/student/.rvm/gems/ruby-2.6.3/gems/capybara-3.28.0/lib/capybara/node/finders.rb:287:in `synced_resolve'\n     # /Users/student/.rvm/gems/ruby-2.6.3/gems/capybara-3.28.0/lib/capybara/node/finders.rb:52:in `find'\n     # /Users/student/.rvm/gems/ruby-2.6.3/gems/capybara-3.28.0/lib/capybara/node/actions.rb:91:in `fill_in'\n     # /Users/student/.rvm/gems/ruby-2.6.3/gems/capybara-3.28.0/lib/capybara/session.rb:749:in `block (2 levels) in &lt;class:Session&gt;'\n     # /Users/student/.rvm/gems/ruby-2.6.3/gems/capybara-3.28.0/lib/capybara/dsl.rb:51:in `block (2 levels) in &lt;module:DSL&gt;'\n     # ./spec/features/enter_names_spec.rb:4:in `block (2 levels) in &lt;top (required)&gt;'\n\nFinished in 0.07645 seconds (files took 0.94706 seconds to load)\n2 examples, 1 failure\n\nFailed examples:\n\nrspec ./spec/features/enter_names_spec.rb:2 # Enter names submitting names\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake", "basic-authentication"], "comments": [{"owner": {"reputation": 610, "user_id": 7438993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7hbh.jpg?s=128&g=1", "display_name": "Krupa Suthar", "link": "https://stackoverflow.com/users/7438993/krupa-suthar"}, "edited": false, "score": 0, "creation_date": 1565172480, "post_id": 57391542, "comment_id": 101265800, "body": "What you want to do here? authenticate all other paths than &quot;home/users/&quot; or authenticate path with &quot;/^\\/home/&quot; and exclude &quot;home/users/&quot;?"}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1565172753, "post_id": 57391542, "comment_id": 101265955, "body": "If you add the <code>return @app.call(env) if request.path.eql?(&#39;home&#47;users&#47;&#39;)</code> line before the if condition, the problem may be resolved."}, {"owner": {"reputation": 73, "user_id": 9300153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0534f6a813fd8264d1263ec05345544d?s=128&d=identicon&r=PG&f=1", "display_name": "Praful Patel", "link": "https://stackoverflow.com/users/9300153/praful-patel"}, "reply_to_user": {"reputation": 610, "user_id": 7438993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7hbh.jpg?s=128&g=1", "display_name": "Krupa Suthar", "link": "https://stackoverflow.com/users/7438993/krupa-suthar"}, "edited": false, "score": 0, "creation_date": 1565173773, "post_id": 57391542, "comment_id": 101266510, "body": "@KrupaSuthar Thanks, I am looking for that only, but may you give any lead how to exclude the paths containing &quot;home/users&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 9300153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0534f6a813fd8264d1263ec05345544d?s=128&d=identicon&r=PG&f=1", "display_name": "Praful Patel", "link": "https://stackoverflow.com/users/9300153/praful-patel"}, "edited": false, "score": 0, "creation_date": 1565175137, "post_id": 57392516, "comment_id": 101267244, "body": "Thanks @krupa suthar"}, {"owner": {"reputation": 610, "user_id": 7438993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7hbh.jpg?s=128&g=1", "display_name": "Krupa Suthar", "link": "https://stackoverflow.com/users/7438993/krupa-suthar"}, "reply_to_user": {"reputation": 73, "user_id": 9300153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0534f6a813fd8264d1263ec05345544d?s=128&d=identicon&r=PG&f=1", "display_name": "Praful Patel", "link": "https://stackoverflow.com/users/9300153/praful-patel"}, "edited": false, "score": 0, "creation_date": 1565175995, "post_id": 57392516, "comment_id": 101267715, "body": "Let me know if need any further help."}], "tags": [], "owner": {"reputation": 610, "user_id": 7438993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7hbh.jpg?s=128&g=1", "display_name": "Krupa Suthar", "link": "https://stackoverflow.com/users/7438993/krupa-suthar"}, "is_accepted": true, "score": 1, "last_activity_date": 1565174394, "creation_date": 1565174394, "answer_id": 57392516, "question_id": 57391542, "link": "https://stackoverflow.com/questions/57391542/ruby-on-rails-how-to-exclude-certain-path-from-rack-middleware-authentication/57392516#57392516", "title": "Ruby on rails: how to exclude certain path from rack middleware authentication?", "body": "<p>If you want to exclude only \"home/users/\" path then you middleware should have following structure,</p>\n\n<pre><code>def call(env)\n  request = Rack::Request.new(env)\n  return @app.call(env) if request.path == \"home/users/\"\n  # your middleware logic of authentication here.\nend\n</code></pre>\n\n<p>For more information of rack, you can refer <a href=\"https://blog.solutelabs.com/rack-an-interface-b-w-ruby-based-application-and-web-server-cb9d6ee757d1\" rel=\"nofollow noreferrer\">this</a>.</p>\n"}], "owner": {"reputation": 73, "user_id": 9300153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0534f6a813fd8264d1263ec05345544d?s=128&d=identicon&r=PG&f=1", "display_name": "Praful Patel", "link": "https://stackoverflow.com/users/9300153/praful-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 57392516, "answer_count": 1, "score": 0, "last_activity_date": 1565174394, "creation_date": 1565171384, "question_id": 57391542, "link": "https://stackoverflow.com/questions/57391542/ruby-on-rails-how-to-exclude-certain-path-from-rack-middleware-authentication", "title": "Ruby on rails: how to exclude certain path from rack middleware authentication?", "body": "<p>I am trying to use rack middleware authentication. I want to exclude certain path from the authentication. \nIs it possible to exclude some specific path?</p>\n\n<p>This will authenticate all the routes starts with home.   </p>\n\n<pre><code>def call(env)\n  request = Rack::Request.new(env)\n  if request.path =~ /^\\/home/\n    super\n  else\n    @app.call(env)\n  end\nend\n</code></pre>\n\n<p>I want that the path \"home/users/\" should be excluded from the authentication. All other path starting from \"home/\" should be authenticate.\nAny lead please, thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1565168847, "post_id": 57390636, "comment_id": 101263831, "body": "Would default values in html input tags work for you?"}, {"owner": {"reputation": 2019, "user_id": 9595653, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jNAfm9c6bRo/AAAAAAAAAAI/AAAAAAAAABA/2JGGWk6fJl8/photo.jpg?sz=128", "display_name": "Clara", "link": "https://stackoverflow.com/users/9595653/clara"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1565169560, "post_id": 57390636, "comment_id": 101264206, "body": "No, because I calculate the bonus without going via a bonus form, it shouldjust get generated when a transacition is made"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 2, "creation_date": 1565169660, "post_id": 57390636, "comment_id": 101264263, "body": "I would do it with a new model for the bonus levels. The admin will be able to manage this percentages and levels. For example, the new model would be have two columns: percentage and threshold. If the transaction amount is higher than the threshold, then you will applicate the percentage of the bonus level. The admin will be able to add or update the bonus levels without having any impact on existing transactions"}, {"owner": {"reputation": 2019, "user_id": 9595653, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jNAfm9c6bRo/AAAAAAAAAAI/AAAAAAAAABA/2JGGWk6fJl8/photo.jpg?sz=128", "display_name": "Clara", "link": "https://stackoverflow.com/users/9595653/clara"}, "edited": false, "score": 0, "creation_date": 1565169977, "post_id": 57390636, "comment_id": 101264443, "body": "@excanxr So that would mean there is one record, which holds the default values. That was my idea too, but I don&#39;t find it very elegant, because this record will float around with only the purpose of holding the default values"}, {"owner": {"reputation": 654, "user_id": 6683147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b3599d7eab61ae82354d60a4464703?s=128&d=identicon&r=PG&f=1", "display_name": "Gilg Him", "link": "https://stackoverflow.com/users/6683147/gilg-him"}, "edited": false, "score": 0, "creation_date": 1565170276, "post_id": 57390636, "comment_id": 101264607, "body": "I think that was a convenient way for this scenario. Since the value needs to be changed dynamically by an actor that is not the system itself(admin). It makes sense to have this record that is going to be updated. I don&#39;t know why you want to do it differently?"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1565171539, "post_id": 57390636, "comment_id": 101265259, "body": "@Clara Not only one record, as much as you want for each threshold. :) I&#39;m using something like this for the service fees on one of my app and it&#39;s the easier way to do it I think. It doesn&#39;t require any maintenance when it&#39;s launched, the admin has just to adjust the values"}, {"owner": {"reputation": 2019, "user_id": 9595653, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jNAfm9c6bRo/AAAAAAAAAAI/AAAAAAAAABA/2JGGWk6fJl8/photo.jpg?sz=128", "display_name": "Clara", "link": "https://stackoverflow.com/users/9595653/clara"}, "edited": false, "score": 0, "creation_date": 1565173894, "post_id": 57390636, "comment_id": 101266577, "body": "Ok, thanks for your input. So I guess there is no magical way of setting default values as a callback on the model and then change those somehow?!"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1565179893, "post_id": 57390636, "comment_id": 101269937, "body": "@Clara Well, if you want a default value, on the model who has a transaction, you just need a <code>before_create</code> callback where you put the default value of your choice, then update this value when you&#39;ll know the transaction amount to adapt the bonus level. It would be easier to explain if you show your code, what default value you want, and what value is expected after the transaction (:"}], "owner": {"reputation": 2019, "user_id": 9595653, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jNAfm9c6bRo/AAAAAAAAAAI/AAAAAAAAABA/2JGGWk6fJl8/photo.jpg?sz=128", "display_name": "Clara", "link": "https://stackoverflow.com/users/9595653/clara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1565170263, "creation_date": 1565168423, "question_id": 57390636, "link": "https://stackoverflow.com/questions/57390636/setting-default-values-according-to-user-input-rails", "title": "Setting default values according to user input Rails", "body": "<p>I have an app which has a bonus system for users. According to certain transactions, they receive a bonus which is staggered according to value of the transaction.</p>\n\n<p>Now there are default percentages for each bonus level. But I was wondering how to dynamically set those default values. The admin of the app should be able to change them.\nFor now I created a dummy record that holds those default values. If the admin decides to change the levels, this record gets updated.</p>\n\n<p>But is the a more elegant solution to change default values for a model?</p>\n"}, {"tags": ["ruby", "keycloak"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 15023914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/549c9e5ae6f228730924d7ef3b7e8594?s=128&d=identicon&r=PG&f=1", "display_name": "Martin01478", "link": "https://stackoverflow.com/users/15023914/martin01478"}, "edited": false, "score": 0, "creation_date": 1618327586, "post_id": 57416390, "comment_id": 118565779, "body": "The links seem to be broken unfortunately, along with the functionality which still doesn&#39;t work."}], "tags": [], "owner": {"reputation": 113, "user_id": 6076185, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pUdSo1uJof8/AAAAAAAAAAI/AAAAAAAAAFs/5Eq7ZXUYe2E/photo.jpg?sz=128", "display_name": "Merlin", "link": "https://stackoverflow.com/users/6076185/merlin"}, "is_accepted": true, "score": 7, "last_activity_date": 1565279208, "creation_date": 1565279208, "answer_id": 57416390, "question_id": 57390389, "link": "https://stackoverflow.com/questions/57390389/the-realmroles-parameter-is-ignored-when-adding-a-user-via-the-keycloak-api/57416390#57416390", "title": "The &quot;realmRoles&quot; parameter is ignored when adding a user via the Keycloak API", "body": "<p><strong>You did nothing wrong. It is a bug in the Keycloak API.</strong></p>\n\n<p>This request should work:</p>\n\n<pre><code>Keycloak::Admin.generic_post('users', nil, { username: 'someone', realmRoles: ['owner'] }, access_token)\n</code></pre>\n\n<p>Unfortunately the API documentation is wrong because the 'realmRoles' attribute doesn't work when trying to create/update a user/group.</p>\n\n<p>You can find more informations about the behavior on the official bug tracker of Keycloak :</p>\n\n<ul>\n<li><a href=\"https://issues.jboss.org/browse/KEYCLOAK-3410\" rel=\"noreferrer\">https://issues.jboss.org/browse/KEYCLOAK-3410</a></li>\n<li><a href=\"https://issues.jboss.org/browse/KEYCLOAK-10876\" rel=\"noreferrer\">https://issues.jboss.org/browse/KEYCLOAK-10876</a></li>\n<li><a href=\"https://issues.jboss.org/browse/KEYCLOAK-5038\" rel=\"noreferrer\">https://issues.jboss.org/browse/KEYCLOAK-5038</a></li>\n<li>...</li>\n</ul>\n\n<p>For now the only solution is to make multiple requests on the API, using the RoleMappers to map a role to a user.</p>\n\n<p>Documentation about those operations : <a href=\"https://www.keycloak.org/docs-api/6.0/rest-api/index.html#_role_mapper_resource\" rel=\"noreferrer\">https://www.keycloak.org/docs-api/6.0/rest-api/index.html#_role_mapper_resource</a></p>\n"}], "owner": {"reputation": 4005, "user_id": 4200092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saOd8.png?s=128&g=1", "display_name": "GoBusto", "link": "https://stackoverflow.com/users/4200092/gobusto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1334, "favorite_count": 0, "accepted_answer_id": 57416390, "answer_count": 1, "score": 4, "last_activity_date": 1565279208, "creation_date": 1565167584, "question_id": 57390389, "link": "https://stackoverflow.com/questions/57390389/the-realmroles-parameter-is-ignored-when-adding-a-user-via-the-keycloak-api", "title": "The &quot;realmRoles&quot; parameter is ignored when adding a user via the Keycloak API", "body": "<p>I am trying to create a user via the Keycloak API, and I would like to assign a realm-level role to them when they are first added. However, it doesn't seem to work like the documentation says it should.</p>\n\n<p>I know that I could simply make a second add-role-to-user API request after the initial create-user one, but:</p>\n\n<ul>\n<li>The documentation indicates that I shouldn't need to do this.</li>\n<li>The second API request could fail, leaving the user in an \"incomplete\" state.</li>\n<li>It would make the code I'm writing more complex than it needs to be.</li>\n</ul>\n\n<p>To test this in <code>irb</code>, using the <a href=\"https://rubygems.org/gems/keycloak\" rel=\"nofollow noreferrer\">keycloak</a> Ruby gem, I first request an access token from Keycloak:</p>\n\n<pre><code>require 'keycloak'\njson = Keycloak::Client.get_token_by_client_credentials\naccess_token = JSON.parse(json)['access_token']\n</code></pre>\n\n<p>All of the following create a user within Keycloak, but without the \"owner\" role:</p>\n\n<pre><code>Keycloak::Admin.generic_post('users', nil, { username: 'someone', realmRoles: ['owner'] }, access_token)\nKeycloak::Admin.generic_post('users', nil, { username: 'someone', realmRoles: ['1fff5f5f-7357-4f73-b45d-65ccd01f3bc8'] }, access_token)\nKeycloak::Admin.generic_post('users', nil, { username: 'someone', realmRoles: ['{\"id\":\"1fff5f5f-7357-4f73-b45d-65ccd01f3bc8\",\"name\":\"owner\",\"description\":\"Indicates that a user is the owner of an organisation.\",\"composite\":false,\"clientRole\":false,\"containerId\":\"MyRealmName\"}'] }, access_token)\n</code></pre>\n\n<p>Attempting to use a role-hash instead of a string causes an error:</p>\n\n<pre><code>Keycloak::Admin.generic_post('users', nil, { username: 'someone', realmRoles: [{\"id\"=&gt;\"1fff5f5f-7357-4f73-b45d-65ccd01f3bc8\", \"name\"=&gt;\"owner\", \"description\"=&gt;\"Indicates that a user is the owner of an organisation.\", \"composite\"=&gt;false, \"clientRole\"=&gt;false, \"containerId\"=&gt;\"MyRealmName\"}] }, access_token)\n\nTraceback (most recent call last):\n      16: from /home/thomas/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/irb-1.0.0/exe/irb:11:in `&lt;top (required)&gt;'\n      15: from (irb):8\n      14: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/keycloak-3.0.0/lib/keycloak.rb:541:in `generic_post'\n      13: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/keycloak-3.0.0/lib/keycloak.rb:943:in `generic_request'\n      12: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/keycloak-3.0.0/lib/keycloak.rb:915:in `block in generic_request'\n      11: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/rest-client-2.0.2/lib/restclient.rb:71:in `post'\n      10: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/rest-client-2.0.2/lib/restclient/request.rb:52:in `execute'\n        9: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/rest-client-2.0.2/lib/restclient/request.rb:145:in `execute'\n        8: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/rest-client-2.0.2/lib/restclient/request.rb:715:in `transmit'\n        7: from /home/thomas/.rvm/rubies/ruby-2.6.3/lib/ruby/2.6.0/net/http.rb:920:in `start'\n        6: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/rest-client-2.0.2/lib/restclient/request.rb:725:in `block in transmit'\n        5: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/rest-client-2.0.2/lib/restclient/request.rb:807:in `process_result'\n        4: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/keycloak-3.0.0/lib/keycloak.rb:916:in `block (2 levels) in generic_request'\n        3: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/keycloak-3.0.0/lib/keycloak.rb:958:in `rescue_response'\n        2: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/rest-client-2.0.2/lib/restclient/abstract_response.rb:103:in `return!'\n        1: from /home/thomas/.rvm/gems/ruby-2.6.3/gems/rest-client-2.0.2/lib/restclient/abstract_response.rb:223:in `exception_with_response'\nRestClient::InternalServerError (500 Internal Server Error)\n</code></pre>\n\n<p>Keycloak prints the following, indicating that - as expected - the roles should be an array of strings, not hashes:</p>\n\n<pre><code>08:53:27,889 ERROR [org.keycloak.services.error.KeycloakErrorHandler] (default task-22) Uncaught server error: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize instance of `java.lang.String` out of START_OBJECT token\nat [Source: (io.undertow.servlet.spec.ServletInputStreamImpl); line: 1, column: 37] (through reference chain: org.keycloak.representations.idm.UserRepresentation[\"realmRoles\"]-&gt;java.util.ArrayList[0])\n</code></pre>\n\n<p>The same thing happens if I pass a single string instead of an array, like:</p>\n\n<pre><code>Keycloak::Admin.generic_post('users', nil, { username: 'someone', realmRoles: 'owner' }, access_token)\n</code></pre>\n\n<p>Am I doing something wrong, or is this simply a bug in the Keycloak API?</p>\n\n<h2>Reference</h2>\n\n<ul>\n<li><a href=\"https://www.keycloak.org/docs-api/6.0/rest-api/index.html#_createuser\" rel=\"nofollow noreferrer\">https://www.keycloak.org/docs-api/6.0/rest-api/index.html#_createuser</a></li>\n<li><a href=\"https://www.keycloak.org/docs-api/6.0/rest-api/index.html#_userrepresentation\" rel=\"nofollow noreferrer\">https://www.keycloak.org/docs-api/6.0/rest-api/index.html#_userrepresentation</a></li>\n</ul>\n\n<h2>Similar questions</h2>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/54567270/4200092\">Keycloak : unable to map user roles when creating user for api</a></li>\n<li><a href=\"https://stackoverflow.com/q/56206472/4200092\">Keycloak: roles not assigned when user is created via CLI</a></li>\n</ul>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "is_accepted": true, "score": 3, "last_activity_date": 1565183912, "last_edit_date": 1565183912, "creation_date": 1565163361, "answer_id": 57389207, "question_id": 57389091, "link": "https://stackoverflow.com/questions/57389091/proper-way-to-compare-rand-variables-inside-of-a-class/57389207#57389207", "title": "Proper way to compare rand variables inside of a class?", "body": "<p>You define <code>randNum</code> within a class. You then try and call it outside the class.</p>\n\n<p>If this is just a script, you should use:</p>\n\n<pre><code>randNum = rand(6)\nrandNum2 = rand(6)\n\n\nif randNum == randNum2\n  puts(\"the numbers you rolled matched\")\nelse\n  puts(\"the numbers you rolled did not match\")\nend\n</code></pre>\n\n<p>However if you're wanting to use a class, something along the following would work:</p>\n\n<pre><code>class Random\n  attr_accessor :rand_1, :rand_2     \n\n  def initialize\n    self.rand_1 = rand(6)\n    self.rand_2 = rand(6)\n  end\n\n  def match?\n    rand_1 == rand_2\n  end\n\n  def does_match?\n    if match?\n      puts(\"the numbers you rolled matched\")\n    else\n      puts(\"the numbers you rolled did not match\")\n    end\n  end\n\nend\n\ngenerator = Random.new\ngenerator.does_match?\n</code></pre>\n\n<p>Also note that <code>rand(1)</code> will always return 0, so you probably want to just use <code>rand</code> or define a different parameter eg. <code>6</code></p>\n"}], "owner": {"reputation": 105, "user_id": 11887050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18e57543929144f5ab081dcd9aa0f9f7?s=128&d=identicon&r=PG&f=1", "display_name": "gingervitiis", "link": "https://stackoverflow.com/users/11887050/gingervitiis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 57389207, "answer_count": 1, "score": 1, "last_activity_date": 1566169795, "creation_date": 1565162984, "last_edit_date": 1566169795, "question_id": 57389091, "link": "https://stackoverflow.com/questions/57389091/proper-way-to-compare-rand-variables-inside-of-a-class", "title": "Proper way to compare rand variables inside of a class?", "body": "<p>In this example:</p>\n\n<pre><code>class random\n  randNum = rand(1)\n  randNum2 = rand(1)\nend\n\nif randNum == randNum2\n  puts(\"the numbers you rolled matched\")\nelse\n  puts(\"the numbers you rolled did not match\")\nend\n</code></pre>\n\n<p>The error I receive is:</p>\n\n<p><code>&lt;main&gt;': undefined local variable or method</code>randNum' for main:Object (NameError)\nDid you mean?  rand</p>\n\n<p>What is this proper way to compare these?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 16407, "user_id": 157752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qgx5T.jpg?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/157752/thilo"}, "edited": false, "score": 1, "creation_date": 1565161594, "post_id": 57387615, "comment_id": 101260210, "body": "Could you please include the actual command you&#39;re trying to run - are you loading this in the consolse? Trying to build the gem? And also the actual error message."}, {"owner": {"reputation": 16407, "user_id": 157752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qgx5T.jpg?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/157752/thilo"}, "edited": false, "score": 1, "creation_date": 1565161680, "post_id": 57387615, "comment_id": 101260253, "body": "Also, the way this is formatted here, with hard line breaks in some of the comments, makes this invalid ruby. If that is just an artifact of posting the code here, it would help if you posted it <i>exactly</i> as on your local machine."}, {"owner": {"reputation": 1, "user_id": 10297519, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TcmlEeH6hCI/AAAAAAAAAAI/AAAAAAAAGJ8/WGbfTIna8VQ/photo.jpg?sz=128", "display_name": "Dale Terrell", "link": "https://stackoverflow.com/users/10297519/dale-terrell"}, "reply_to_user": {"reputation": 16407, "user_id": 157752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qgx5T.jpg?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/157752/thilo"}, "edited": false, "score": 0, "creation_date": 1565431226, "post_id": 57387615, "comment_id": 101358729, "body": "To run this gem, I am cd&#39;ing to the directory, and running ./bin/practical, the name of the gem."}, {"owner": {"reputation": 16407, "user_id": 157752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qgx5T.jpg?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/157752/thilo"}, "edited": false, "score": 0, "creation_date": 1565522090, "post_id": 57387615, "comment_id": 101374240, "body": "Sorry, but without at least the actual error message nobody will be able to help..."}], "owner": {"reputation": 1, "user_id": 10297519, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TcmlEeH6hCI/AAAAAAAAAAI/AAAAAAAAGJ8/WGbfTIna8VQ/photo.jpg?sz=128", "display_name": "Dale Terrell", "link": "https://stackoverflow.com/users/10297519/dale-terrell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565156378, "creation_date": 1565156378, "question_id": 57387615, "link": "https://stackoverflow.com/questions/57387615/gemspec-is-broken-cli-wont-run", "title": "gemspec is broken, cli won&#39;t run", "body": "<p>I keep running into a problem, this gemspec is invalid.  Can someone please help me?</p>\n\n<pre><code>lib = File.expand_path(\"../lib\", __FILE__)\n$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)\nrequire \"Practical/version\"\n\nGem::Specification.new do |spec|\n  spec.name          = \"Practical\"\n  spec.version       = Practical::VERSION\n  spec.authors       = [\"'D'\"]\n  spec.email         = [\"'@gmail.com'\"]\n\nspec.summary       = %q{TODO: Write a short summary, because \nRubyGems requires one.}\nspec.description   = %q{TODO: Write a longer description or delete \nthis line.}\nspec.homepage      = \"TODO: Put your gem's website or public repo \nURL here.\"\nspec.license       = \"MIT\"\n\n# Prevent pushing this gem to RubyGems.org. To allow pushes either \nset the 'allowed_push_host'\n# to allow pushing to a single host or delete this section to allow \npushing to any host.\nif spec.respond_to?(:metadata)\nspec.metadata[\"allowed_push_host\"] = \"TODO: Set to \n'http://mygemserver.com'\"\n\nspec.metadata[\"homepage_uri\"] = spec.homepage\nspec.metadata[\"source_code_uri\"] = \"TODO: Put your gem's public repo \nURL here.\"\nspec.metadata[\"changelog_uri\"] = \"TODO: Put your gem's CHANGELOG.md \nURL here.\"\n  else\nraise \"RubyGems 2.0 or newer is required to protect against \"\n  \"public gem pushes.\"\nend\n\n# Specify which files should be added to the gem when it is \nreleased.\n# The `git ls-files -z` loads the files in the RubyGem that have \nbeen added into git.\nspec.files         = Dir.chdir(File.expand_path('..', __FILE__)) do\n`git ls-files -z`.split(\"\\x0\").reject { |f| \nf.match(%r{^(test|spec|features)/}) }\nend\nspec.bindir        = \"exe\"\nspec.executables   = spec.files.grep(%r{^exe/}) { |f| \nFile.basename(f) }\nspec.require_paths = [\"lib\"]\n\nspec.add_development_dependency \"bundler\", \"~&gt; 1.17\"\nspec.add_development_dependency \"rake\", \"~&gt; 10.0\"\n\nspec.add_dependency \"nokogiri\"`enter code here`\nend  \n</code></pre>\n\n<p>I'm not sure what changed.  This worked a few months ago, but now it's broken.  Basically, I'm stuck just getting this to run, the interpreter keeps telling me I have an error in my gemspec.  I can't find it.</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565159209, "post_id": 57387291, "comment_id": 101259206, "body": "You need to give us the rules in order for us to make useful suggestions. Presumably the string of interest follows <code>&quot;Policy &quot;</code>. Your example shows the first 3 characters to be <code>&quot;PO-&quot;</code>. Are the characters before the hyphen always capital letters? How many might there be? Between the hyphen and first forward slash you have <code>&quot;EXW1900000955&quot;</code>. Is that length fixed? Does it always begin with 3 capital letters followed by digits? After that you have <code>&quot;&#47;00&#47;00&quot;</code>. Are there always 2 3-character substrings consisting of a forward slash and followed by two digits?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": false, "score": 1, "last_activity_date": 1565154850, "creation_date": 1565154850, "answer_id": 57387356, "question_id": 57387291, "link": "https://stackoverflow.com/questions/57387291/extract-a-policy-id-from-the-given-string-using-regex/57387356#57387356", "title": "extract a policy Id from the given string using RegEx", "body": "<p>Well, your expression works just fine, if you like, maybe you could modify that to some expression such as:</p>\n\n<pre><code>re = /(?&lt;=Policy\\s)[A-Z]+-[A-Z0-9]+\\/[0-9]+\\/\\d+/\nstr = 'Policy PO-EXW1900000955/00/00'\n\nstr.match(re) do |match|\n    puts match.to_s\nend\n</code></pre>\n\n<p>The expression is explained on the top right panel of <a href=\"https://regex101.com/r/hiAoTD/1/\" rel=\"nofollow noreferrer\">regex101.com</a>, if you wish to explore/simplify/modify it, and in <a href=\"https://regex101.com/r/hiAoTD/1/debugger\" rel=\"nofollow noreferrer\">this link</a>, you can watch how it would match against some sample inputs, if you like.</p>\n"}, {"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1565188651, "post_id": 57391872, "comment_id": 101275480, "body": "Thats great, Thank you."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 0, "last_activity_date": 1565191103, "last_edit_date": 1565191103, "creation_date": 1565172286, "answer_id": 57391872, "question_id": 57387291, "link": "https://stackoverflow.com/questions/57387291/extract-a-policy-id-from-the-given-string-using-regex/57391872#57391872", "title": "extract a policy Id from the given string using RegEx", "body": "<blockquote>\n  <p>I feel like I repeat this \\w+ every single word. Is there any other better way to avoid this repeated \\w+?</p>\n</blockquote>\n\n<p>Yes! You could name the subpattern, then invoke it later:</p>\n\n<pre><code>/(?&lt;=Policy) (?&lt;word&gt;\\w+)-\\g&lt;word&gt;\\/\\g&lt;word&gt;\\/\\g&lt;word&gt;/\n</code></pre>\n\n<p>or the prettified version:</p>\n\n<pre><code>%r{\n  (?&lt;word&gt;\n    \\w+\n  ){0}\n\n  (?&lt;=Policy) [ ] \\g&lt;word&gt; - \\g&lt;word&gt; / \\g&lt;word&gt; / \\g&lt;word&gt;\n}x\n</code></pre>\n\n<p>(Note that this is restricted to Oniguruma/Onigmo, so it's only going to work in this form in Ruby and a small number of other tools.)</p>\n"}], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 57391872, "answer_count": 2, "score": 1, "last_activity_date": 1565191103, "creation_date": 1565154490, "question_id": 57387291, "link": "https://stackoverflow.com/questions/57387291/extract-a-policy-id-from-the-given-string-using-regex", "title": "extract a policy Id from the given string using RegEx", "body": "<p>I have to extract the given below string</p>\n\n<pre><code>PO-EXW1900000955/00/00\n</code></pre>\n\n<p>I have written the following regex </p>\n\n<pre><code>/(?&lt;=Policy) \\w+-\\w+\\/\\w+\\/\\w+/\n</code></pre>\n\n<p>The above one works fine but I feel like I repeat this \\w+ every single word. Is there any other better way to avoid this repeated \\w+?</p>\n"}, {"tags": ["c++", "ruby", "llvm", "sorbet"], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 537862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2419732d3fbaf4b86de1f2bbab2931d?s=128&d=identicon&r=PG", "display_name": "user537862", "link": "https://stackoverflow.com/users/537862/user537862"}, "is_accepted": true, "score": 2, "last_activity_date": 1565159461, "creation_date": 1565159461, "answer_id": 57388212, "question_id": 57384896, "link": "https://stackoverflow.com/questions/57384896/how-to-build-sorbet-on-centos-7-missing-llvm-toolchain/57388212#57388212", "title": "How to build Sorbet on Centos 7 (missing llvm_toolchain)", "body": "<p>The location that needs to be modified is \nactually <a href=\"https://github.com/DarkDimius/bazel-toolchain/blob/dp-srb-now/toolchain/internal/llvm_distributions.bzl#L52\" rel=\"nofollow noreferrer\">https://github.com/DarkDimius/bazel-toolchain/blob/dp-srb-now/toolchain/internal/llvm_distributions.bzl#L52</a></p>\n\n<p>Sorbet needs LLVM 8.0 to build(as we're using some of the recent parts of C++ language and standard library) and thus we download LLVM to get the toolchain that we develop with.</p>\n\n<p>As can be seen at <a href=\"http://releases.llvm.org/\" rel=\"nofollow noreferrer\">http://releases.llvm.org/</a>, LLVM no longer publishes CentOS builds and thus, I'd expect it to be easier for you to build it inside a ubuntu docker container than to use a custom version of llvm.</p>\n\n<p>Alternatively, you could attempt to pass <code>--crosstool_top=@bazel_tools//tools/cpp:toolchain --host_crosstool_top=@bazel_tools//tools/cpp:toolchain</code> to force our build to use your local C++ toolchain rather than the one we attempt to download. Note that if your toolchain isn't recent enough it may fail to compile Sorbet. We also do not test performance on any other toolchain than LLVM8 and we have seen in past substantial regressions when compiled with GCC. </p>\n"}], "owner": {"reputation": 4800, "user_id": 46871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H7vPm.jpg?s=128&g=1", "display_name": "tlehman", "link": "https://stackoverflow.com/users/46871/tlehman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 57388212, "answer_count": 1, "score": 0, "last_activity_date": 1565159461, "creation_date": 1565131436, "question_id": 57384896, "link": "https://stackoverflow.com/questions/57384896/how-to-build-sorbet-on-centos-7-missing-llvm-toolchain", "title": "How to build Sorbet on Centos 7 (missing llvm_toolchain)", "body": "<p>I am trying to build Stripe's Sorbet binary on Centos 7.5, and I have bazel 0.28.1 installed.</p>\n\n<p>I tried building using <code>bazel build //main:sorbet --config=dbg</code>, but got this failure:</p>\n\n<pre><code>WARNING: The following configs were expanded more than once: [debugsymbols]. \nFor repeatable flags, repeats are counted twice and may lead to unexpected behavior.\nINFO: Invocation ID: 1b2a6940-59ff-419f-ae57-f6e4129c2102\nERROR: /data/home/elemental/sorbet/main/BUILD:9:1: every rule of type cc_binary \nimplicitly depends upon the target '@llvm_toolchain//:toolchain',\nbut this target could not be found because of: \n  no such package '@llvm_toolchain//': Traceback (most recent call last):\n...\n</code></pre>\n\n<p>It looked like I was just missing llvm and llvm-toolset-7, but installing those did not help. What am I missing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1565159561, "post_id": 57384654, "comment_id": 101259339, "body": "This error tells you that you are calling <code>valid_car_type?</code> in <code>nil</code>. But in your code, you never even call <code>valid_car_type?</code> nor it shows how you initialized the instance. Please show the code or the test that lead to that error message."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3899296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee804351dd48d90433f9df5da39092d?s=128&d=identicon&r=PG&f=1", "display_name": "Raynald", "link": "https://stackoverflow.com/users/3899296/raynald"}, "is_accepted": false, "score": 0, "last_activity_date": 1565145967, "creation_date": 1565145967, "answer_id": 57386304, "question_id": 57384654, "link": "https://stackoverflow.com/questions/57384654/validation-error-when-missing-attribute-undefined-method-valid-car-type-for/57386304#57386304", "title": "Validation error when missing attribute (undefined method `valid_car_type?&#39; for nil:NilClass)", "body": "<p>Use active record call back for example 'before_save, after_save, etc...' and call the valid_car_type?</p>\n\n<pre><code>class Car    \n    include ActiveModel::Model\n    validates_presence_of :subject :valid_object\n    before_save :valid_car_type?\n\n    def valid_car_type?\n       valid_object.car_type == \"truck\"\n    end\n  end\n</code></pre>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565145967, "creation_date": 1565129489, "question_id": 57384654, "link": "https://stackoverflow.com/questions/57384654/validation-error-when-missing-attribute-undefined-method-valid-car-type-for", "title": "Validation error when missing attribute (undefined method `valid_car_type?&#39; for nil:NilClass)", "body": "<p>What's the best way to handle this type of error? As the mode requires a valid_object, but when it does not get it, it correctly provides validation error for the missing attribute, but then is raises a nil object error on <code>valid_car_type?</code>.</p>\n\n<p>This is just a simplified example.</p>\n\n<h2>Model</h2>\n\n<pre><code> class Car    \n    include ActiveModel::Model\n    validates_presence_of :subject :valid_object\n    validate :valid_car_type\n\n    def valid_car_type?\n       valid_object.car_type == \"truck\"\n    end\n  end\n\n\n NoMethodError:\n   undefined method `valid_car_type?' for nil:NilClass\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565131987, "post_id": 57384436, "comment_id": 101253832, "body": "Is it guaranteed that there will be at least one deposit and one withdrawal? If not, what is to be returned if there are none of either type?"}], "answers": [{"tags": [], "owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "is_accepted": true, "score": 6, "last_activity_date": 1565282594, "last_edit_date": 1565282594, "creation_date": 1565129556, "answer_id": 57384665, "question_id": 57384436, "link": "https://stackoverflow.com/questions/57384436/finding-the-smallest-negative-number-and-the-smallest-positive-number-in-an-arra/57384665#57384665", "title": "Finding the smallest negative number and the smallest positive number in an array of transactions using .each", "body": "<p>How about leveraging Ruby's builtin operations to define suitable subsets for withdrawals and deposits?</p>\n\n<pre><code>smallest_withdrawal = transactions.select { |x| x &lt; 0 }.max\nsmallest_deposit = transactions.select { |x| x &gt; 0 }.min\n</code></pre>\n\n<p>This could also be written as:</p>\n\n<pre><code>smallest_withdrawal = transactions.select(&amp;:negative?).max\nsmallest_deposit = transactions.select(&amp;:positive?).min\n</code></pre>\n\n<p>Yet another variant would be:</p>\n\n<pre><code>negatives, positives = transactions.partition(&amp;:negative?)\nsmallest_withdrawal = negatives.max\nsmallest_deposit = positives.min\n</code></pre>\n\n<p>Finally, if you're willing to go arcane to get a one-liner:</p>\n\n<pre><code>smallest_withdrawal, smallest_deposit = transactions.partition(&amp;:negative?).map(&amp;:minmax).flatten[1..2]\n</code></pre>\n\n<p>I wouldn't recommend that for readability reasons, though.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 5, "last_activity_date": 1565187535, "last_edit_date": 1565187535, "creation_date": 1565135348, "answer_id": 57385307, "question_id": 57384436, "link": "https://stackoverflow.com/questions/57384436/finding-the-smallest-negative-number-and-the-smallest-positive-number-in-an-arra/57385307#57385307", "title": "Finding the smallest negative number and the smallest positive number in an array of transactions using .each", "body": "<p>One can make a single pass through the array. It it were guaranteed there would be at least one deposit and one withdrawal, one could write:</p>\n\n<pre><code>def closest_to_zero(transactions)\n  transactions.minmax_by { |t| 1.0/t }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>closest_to_zero(transactions)\n  #=&gt; [-800, 4000]\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-minmax_by\" rel=\"nofollow noreferrer\">Enumerable#minmax_by</a>. If there could be no deposits or no withdrawals (but there were at least two transactions) we'd have to uglify the code:</p>\n\n<pre><code>def closest_to_zero(transactions) \n  transactions.minmax_by { |t| 1.0/t }.then do |mn,mx|\n    [mn &gt; 0 ? nil : mn, mx &lt; 0 ? nil : mx]\n  end\nend\n\nclosest_to_zero [ 1,  2,  3]\n  #=&gt; [nil, 1] \nclosest_to_zero [-1, -2, -3]\n  #=&gt; [-1, nil] \n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-then\" rel=\"nofollow noreferrer\">Object#then</a> (aka <code>yield_self</code>). <code>yield_self</code> was new in Ruby v2.5, <code>then</code> in v2.6.</p>\n"}], "owner": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "accepted_answer_id": 57384665, "answer_count": 2, "score": 2, "last_activity_date": 1565282594, "creation_date": 1565128063, "question_id": 57384436, "link": "https://stackoverflow.com/questions/57384436/finding-the-smallest-negative-number-and-the-smallest-positive-number-in-an-arra", "title": "Finding the smallest negative number and the smallest positive number in an array of transactions using .each", "body": "<p>I have an array of transaction data:</p>\n\n<pre><code>transactions = [50_000, -2_000, -25_000, 4_000, -12_000, 5_000, -800, -900, 43_000, -30_000, 15_000, 62_000, -50_000, 42_000]\n</code></pre>\n\n<p>and I want to retrieve the largest negative number (smallest withdrawal) and the smallest positive number (smallest deposit) from that list. Withdrawals are represented by negative numbers. Deposits are all positive numbers. </p>\n\n<p>I am having trouble understanding the logic I would need to get the desired results (smallest withdrawal and smallest deposit)</p>\n\n<p>Below, I am currently getting the largest withdrawal and largest deposit from the array:</p>\n\n<pre><code>smallest_withdrawal = 0\ntransactions.each do |transaction|\n  if transaction &lt; smallest_withdrawal\n    smallest_withdrawal = transaction\n  end\nend\nputs smallest_withdrawal\n\nsmallest_deposit = 0\ntransactions.each do |transaction|\n  if transaction &gt; smallest_deposit\n    smallest_deposit = transaction\n  end\nend\nputs smallest_deposit\n</code></pre>\n\n<p>I am not getting error messages, but instead of getting my desired results, I am getting their opposites. I need help with my logical operators.</p>\n"}, {"tags": ["ruby", "rspec", "ruby-on-rails-5", "simplecov"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8022165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b18da90ff145c3a8195273c435a010f?s=128&d=identicon&r=PG&f=1", "display_name": "batch", "link": "https://stackoverflow.com/users/8022165/batch"}, "edited": false, "score": 1, "creation_date": 1565127578, "post_id": 57384275, "comment_id": 101252714, "body": "I&#39;m all set up when it comes to that stuff, but if it helps, I&#39;ll put it in my original question.:  Just to restate the problem, Simplecov hangs after the test suite finishes."}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "reply_to_user": {"reputation": 1, "user_id": 8022165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b18da90ff145c3a8195273c435a010f?s=128&d=identicon&r=PG&f=1", "display_name": "batch", "link": "https://stackoverflow.com/users/8022165/batch"}, "edited": false, "score": 0, "creation_date": 1565128490, "post_id": 57384275, "comment_id": 101252999, "body": "Thanks for your configuration. I quickly tested ruby 2.6.3 with 0.17 and unfortunately cannot see the issue."}], "tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": false, "score": 1, "last_activity_date": 1565127119, "creation_date": 1565127119, "answer_id": 57384275, "question_id": 57384062, "link": "https://stackoverflow.com/questions/57384062/simplecov-fails-to-exit-on-rspec-suite-completion-in-ruby-2-6-3/57384275#57384275", "title": "Simplecov fails to exit on rspec suite completion in Ruby 2.6.3", "body": "<p>From <a href=\"https://github.com/colszowka/simplecov\" rel=\"nofollow noreferrer\">https://github.com/colszowka/simplecov</a></p>\n\n<blockquote>\n  <p>If you're making a Rails application, SimpleCov comes with built-in configurations (see below for information on profiles) that will get you started with groups for your Controllers, Views, Models and Helpers. To use it, the first two lines of your test_helper should be like this:</p>\n</blockquote>\n\n<pre><code>require 'simplecov'\nSimpleCov.start 'rails'\n</code></pre>\n\n<p>The documenation also states: </p>\n\n<blockquote>\n  <p>Load and launch SimpleCov at the very top of your test/test_helper.rb (or spec_helper.rb, rails_helper, cucumber env.rb, or whatever your preferred test framework uses):</p>\n</blockquote>\n\n<pre><code>require 'simplecov'\nSimpleCov.start\n</code></pre>\n\n<p>If this does not help, please share your simplecov entry in your Gemfile and the test-, spec-, rails_helper.</p>\n"}], "owner": {"reputation": 1, "user_id": 8022165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b18da90ff145c3a8195273c435a010f?s=128&d=identicon&r=PG&f=1", "display_name": "batch", "link": "https://stackoverflow.com/users/8022165/batch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 847, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573237069, "creation_date": 1565125924, "last_edit_date": 1565127717, "question_id": 57384062, "link": "https://stackoverflow.com/questions/57384062/simplecov-fails-to-exit-on-rspec-suite-completion-in-ruby-2-6-3", "title": "Simplecov fails to exit on rspec suite completion in Ruby 2.6.3", "body": "<p>So after upgrading the Ruby version used with my app from 2.5.5 to 2.6.3, simplecov 0.17.0 now hangs silently and permanently at the end of my test suite.</p>\n\n<p>I'm running Ruby 2.6.3 and Rails 5.2.3.</p>\n\n<p>As for what else may be relevant, I have capybara 3.26.0 running and I'm using RSpec.</p>\n\n<p>One thing I tried is adding \"use_merging false\" to my SimpleCov.start block, as I saw that suggested out and about. No luck for me.</p>\n\n<p>Here's an example of the output I get:</p>\n\n<pre><code>138 examples, 0 failures, 1 pending\n\nRandomized with seed 29475\n</code></pre>\n\n<p>Then that's where it hangs.</p>\n\n<p>Any help is greatly appreciated!</p>\n\n<p>Edit: SimpleCov config:</p>\n\n<pre><code>SimpleCov.start :rails do\n  add_filter \"/app/channels/\"\n  add_filter \"/app/jobs/\"\n  add_filter \"/app/mailers\"\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565130857, "post_id": 57383951, "comment_id": 101253628, "body": "You need to remove spaces at the ends of the lines <code>&quot;name,age,city &quot;</code> and <code>&quot;abd,45,TUY &quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1565166094, "last_edit_date": 1565166094, "creation_date": 1565129050, "answer_id": 57384595, "question_id": 57383951, "link": "https://stackoverflow.com/questions/57383951/how-to-call-hash-values-outside-class-from-defined-hash-map-inside-class-methods/57384595#57384595", "title": "How to call hash values outside class from defined hash map inside class methods?", "body": "<p>Let's create the CSV file.</p>\n\n<pre><code>str =&lt;&lt;END\nname,age,city\nabd,45,TUY\nkjh,65,HJK\nEND\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>FName = 'temp/persons.csv'\n\nFile.write(FName, str)\n  #=&gt; 36\n</code></pre>\n\n<p>Now let's create a class:</p>\n\n<pre><code>klass = Class.new\n  #=&gt; #&lt;Class:0x000057d0519de8a0&gt;\n</code></pre>\n\n<p>and name it:</p>\n\n<pre><code>class_name = File.basename(FName, \".csv\").capitalize\n  #=&gt; \"Persons\"\nObject.const_set(class_name, klass)\n  #=&gt; Persons\nPersons.class\n  #=&gt; Class\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/File.html#method-c-basename\" rel=\"nofollow noreferrer\">File::basename</a>, <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-capitalize\" rel=\"nofollow noreferrer\">String#capitalize</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Module.html#method-i-const_set\" rel=\"nofollow noreferrer\">Module#const_set</a>.</p>\n\n<p>Next read the CSV file with headers into a <code>CSV::Table</code> object:</p>\n\n<pre><code>require 'csv'\n\ncsv = CSV.read(FName, headers: true)\n  #=&gt; #&lt;CSV::Table mode:col_or_row row_count:3&gt; \ncsv.class\n  #=&gt; CSV::Table\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/csv/rdoc/CSV.html#method-c-read\" rel=\"nofollow noreferrer\">CSV#read</a>. We may now create the methods <code>name</code>, <code>age</code> and <code>city</code>.</p>\n\n<pre><code> csv.headers.each { |header| klass.define_method(header) { csv[header] } }\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/csv/rdoc/CSV.html#method-i-headers\" rel=\"nofollow noreferrer\">CSV#headers</a>, <a href=\"https://ruby-doc.org/core-2.6.3/Module.html\" rel=\"nofollow noreferrer\">Module::define_method</a> and <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/csv/rdoc/CSV/Row.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">CSV::Row#[]</a>.</p>\n\n<p>We can now confirm they work as intended:</p>\n\n<pre><code>k = klass.new\nk.name\n  #=&gt; [\"abd\", \"kjh\"] \nk.age\n  #=&gt; [\"45\", \"65\"] \nk.city\n  #=&gt; [\"TUY\", \"HJK\"]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>p = Persons.new\n  #=&gt; #&lt;Persons:0x0000598dc6b01640&gt; \np.name\n  #=&gt; [\"abd\", \"kjh\"]\n</code></pre>\n\n<p>and so on.</p>\n"}], "owner": {"reputation": 1, "user_id": 11666817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94bfbc906f8ac86327d3f953cea3315?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Kannojia", "link": "https://stackoverflow.com/users/11666817/abhinav-kannojia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 57384595, "answer_count": 1, "score": -1, "last_activity_date": 1565166094, "creation_date": 1565125285, "last_edit_date": 1565125932, "question_id": 57383951, "link": "https://stackoverflow.com/questions/57383951/how-to-call-hash-values-outside-class-from-defined-hash-map-inside-class-methods", "title": "How to call hash values outside class from defined hash map inside class methods?", "body": "<p>Read a csv format file and construct a new class with the name of the file dynamically. So if the csv is persons.csv, the ruby class should be person, if it's places.csv, the ruby class should be places \nAlso create methods for reading and displaying each value in \"csv\" file and values in first row of csv file will act as name of the function. \nConstruct an array of objects and associate each object with the row of a csv file. For example the content of the csv file could be </p>\n\n<pre><code>name,age,city \nabd,45,TUY \nkjh,65,HJK\n</code></pre>\n\n<p>Previous code :</p>\n\n<pre><code>require 'csv'\n\nclass Feed\n  def initialize(source_name, column_names = [])\n    if column_names.empty?\n      column_names = CSV.open(source_name, 'r', &amp;:first)\n    end\n    columns = column_names.reduce({}) { |columns, col_name| columns[col_name] = []; columns }\n\n    define_singleton_method(:columns) { column_names }\n\n    column_names.each do |col_name|\n      define_singleton_method(col_name.to_sym) { columns[col_name] }\n    end\n\n    CSV.foreach(source_name, headers: true) do |row|\n      column_names.each do |col_name|\n        columns[col_name] &lt;&lt; row[col_name]\n      end\n    end\n  end\nend\n\nfeed = Feed.new('input.csv')\nputs feed.columns #[\"name\", \"age\", \"city\"]\nputs feed.name # [\"abd\", \"kjh\"]\nputs feed.age # [\"45\", \"65\"]\nputs feed.city # [\"TUY\", \"HJK\"] \n</code></pre>\n\n<p>I am trying to refine this solution using class methods and split code into smaller methods. Calling values outside the class using key names but facing errors like  \"undefined method `age' for Feed:Class\". Is that a way I can access values outside the class ?\nMy solution looks like -</p>\n\n<pre><code>require 'csv'\nclass Feed\n  attr_accessor :column_names\n  def self.col_name(source_name, column_names = [])\n    if column_names.empty?\n      @column_names = CSV.open(source_name, :headers =&gt; true)\n    end\n    columns = @column_names.reduce({}) { |columns, col_name| columns[col_name] = []; columns }\n  end\n\n  def self.get_rows(source_name)\n    col_name(source_name, column_names = [])\n    define_singleton_method(:columns) { column_names }\n\n    column_names.each do |col_name|\n      define_singleton_method(col_name.to_sym) { columns[col_name] }\n    end\n\n    CSV.foreach(source_name, headers: true) do |row|\n      @column_names.each do |col_name|\n        columns[col_name] &lt;&lt; row[col_name]\n      end\n    end\n  end\nend\n\nobj = Feed.new\nFeed.get_rows('Input.csv')\nputs obj.class.columns\nputs obj.class.name\nputs obj.class.age\nputs obj.class.city \n</code></pre>\n\n<p>Expected Result - </p>\n\n<pre><code>input = Input.new\np input.name  # [\"abd\", \"kjh\"]\np input.age # [\"45\", \"65\"]\ninput.name ='XYZ' # Value must be appended to array\ninput.age = 25\np input.name # [\"abd\", \"kjh\", \"XYZ\"]\np input.age # [\"45\", \"65\", \"25\"]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565121566, "post_id": 57382786, "comment_id": 101250685, "body": "What data type is <code>teams</code> I am assuming <code>JSON</code> which would explain the conversion because <code>JSON</code> keys are <code>String</code>s ?"}, {"owner": {"reputation": 71, "user_id": 8222405, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cc783dd0549b2a0a70b2061d0f85a7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Tristin", "link": "https://stackoverflow.com/users/8222405/tristin"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565121934, "post_id": 57382786, "comment_id": 101250843, "body": "@engineersmnky I updated my Q, it is JSONB.  Is this just a native &#39;feature&#39; of JSON that I will need to work around?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1565127762, "post_id": 57382786, "comment_id": 101252772, "body": "Yes json keys must be strings"}], "owner": {"reputation": 71, "user_id": 8222405, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cc783dd0549b2a0a70b2061d0f85a7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Tristin", "link": "https://stackoverflow.com/users/8222405/tristin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565121794, "creation_date": 1565119653, "last_edit_date": 1565121794, "question_id": 57382786, "link": "https://stackoverflow.com/questions/57382786/how-to-update-models-with-hashes-without-conversion-of-integers-to-strings", "title": "How to update models with hashes without conversion of integers to strings", "body": "<p>I often build hashes in my controllers which I used to update models, and just ran into an issue when using integers for keys.  Ruby will convert integer keys into strings, but not for integers in arrays I use as values.  Is there a way to ensure that Ruby maintains the keys as integers?</p>\n\n<p>Example:</p>\n\n<pre><code>team_attribute = {\"teams\"=&gt;{1=&gt;[\"tom\",3,\"rob\"],2=&gt;[5,\"bill\",\"jim\"]}}\n@model.update(team_attribute)\n</code></pre>\n\n<p>Will end up</p>\n\n<pre><code>@model.teams\n{\"1\"=&gt;[\"tom\",3,\"rob\"],\"2\"=&gt;[5,\"bill\",\"jim\"]}\n</code></pre>\n\n<p>While I can deal with the keys as strings with some work-arounds, I want the keys integers for loop simplicity later on. Thanks.</p>\n\n<p>Edit: The datatype is JSONB, and 'team' is an attribute of @model in this example.</p>\n"}, {"tags": ["ruby", "github", "octokit"], "comments": [{"owner": {"reputation": 392, "user_id": 7044855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8853c5bb96a922687efac6e58c25bf0?s=128&d=identicon&r=PG", "display_name": "prieber", "link": "https://stackoverflow.com/users/7044855/prieber"}, "edited": false, "score": 0, "creation_date": 1565122565, "post_id": 57382677, "comment_id": 101251049, "body": "Get all pull requests, filter them in your app code.  i.e. if you had 200, you get all 200 from the API, loop over each one and check for if the date matches your search criteria.  Not efficient, but it does work."}, {"owner": {"reputation": 3014, "user_id": 4058910, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/100003324732050/picture?type=large", "display_name": "Shravan Ramamurthy", "link": "https://stackoverflow.com/users/4058910/shravan-ramamurthy"}, "reply_to_user": {"reputation": 392, "user_id": 7044855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8853c5bb96a922687efac6e58c25bf0?s=128&d=identicon&r=PG", "display_name": "prieber", "link": "https://stackoverflow.com/users/7044855/prieber"}, "edited": false, "score": 0, "creation_date": 1565148300, "post_id": 57382677, "comment_id": 101256474, "body": "Currently I am doing that, but it is causing the application to run slow. So, I am looking for the alternate approach to improve the performance."}, {"owner": {"reputation": 392, "user_id": 7044855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8853c5bb96a922687efac6e58c25bf0?s=128&d=identicon&r=PG", "display_name": "prieber", "link": "https://stackoverflow.com/users/7044855/prieber"}, "edited": false, "score": 0, "creation_date": 1565191743, "post_id": 57382677, "comment_id": 101277193, "body": "I haven&#39;t used the graphql API but perhaps it has some options for you? <a href=\"https://developer.github.com/v4/query/\" rel=\"nofollow noreferrer\">developer.github.com/v4/query</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3014, "user_id": 4058910, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/100003324732050/picture?type=large", "display_name": "Shravan Ramamurthy", "link": "https://stackoverflow.com/users/4058910/shravan-ramamurthy"}, "is_accepted": false, "score": 0, "last_activity_date": 1565198500, "creation_date": 1565198500, "answer_id": 57399472, "question_id": 57382677, "link": "https://stackoverflow.com/questions/57382677/using-ruby-octokit-how-do-i-return-all-the-pull-requests-created-since-specifie/57399472#57399472", "title": "Using ruby Octokit, how do I return all the Pull Requests created since specified date", "body": "<p>I found the following alternate option, <code>Octokit.GitHubClient.list_issues</code>.\nPlease refer to <a href=\"https://www.rubydoc.info/github/pengwynn/octokit/Octokit%2FClient%2FIssues:list_issues\" rel=\"nofollow noreferrer\">this link</a> for more detail.</p>\n\n<p>example:\n<code>Octokit.GitHubClient.list_issues(REPO, state: state, since: DateTime.now - 1)</code>\nwhere <code>DateTime.now - 1</code> indicates the PR's created during previous 1 day period.</p>\n"}], "owner": {"reputation": 3014, "user_id": 4058910, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/100003324732050/picture?type=large", "display_name": "Shravan Ramamurthy", "link": "https://stackoverflow.com/users/4058910/shravan-ramamurthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565198500, "creation_date": 1565119211, "question_id": 57382677, "link": "https://stackoverflow.com/questions/57382677/using-ruby-octokit-how-do-i-return-all-the-pull-requests-created-since-specifie", "title": "Using ruby Octokit, how do I return all the Pull Requests created since specified date", "body": "<p>How do I get all the closed Pull Requests created since specified date time, using ruby octokit library? I tried  <a href=\"https://octokit.github.io/octokit.rb/Octokit/Client/PullRequests.html#pull_requests-instance_method\" rel=\"nofollow noreferrer\"><code>Octokit.GitHubClient.pull_requests</code></a>, but this method doesn't accept <code>since</code> date, so, it pulls down all the PRs for the specified state.</p>\n"}, {"tags": ["ruby", "xpath", "nokogiri"], "comments": [{"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1565112826, "post_id": 57381145, "comment_id": 101246970, "body": "Have you tried with <code>doc.search(&quot;&#47;&#47;rooms&#47;&#47;room[@beds=2 and @windows=0]&quot;).count</code>?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1577224185, "post_id": 57381145, "comment_id": 105125639, "body": "<code>&#47;&#47;rooms&#47;&#47;room</code> should be <code>&#47;&#47;rooms&#47;room</code>. <code>&#47;&#47;</code> and <code>&#47;</code> are different. See <a href=\"https://stackoverflow.com/q/36019544/128421\">stackoverflow.com/q/36019544/128421</a>."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 9486016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-2e0nuSWKDGE/AAAAAAAAAAI/AAAAAAAAAIE/JYcps_nk_FY/photo.jpg?sz=128", "display_name": "No&#233;mie Harvey", "link": "https://stackoverflow.com/users/9486016/no%c3%a9mie-harvey"}, "edited": false, "score": 0, "creation_date": 1565112742, "post_id": 57381216, "comment_id": 101246929, "body": "Can I get it in string instead of float ?"}, {"owner": {"reputation": 15659, "user_id": 9448090, "user_type": "registered", "profile_image": "https://graph.facebook.com/600951510246447/picture?type=large", "display_name": "Jack Fleeting", "link": "https://stackoverflow.com/users/9448090/jack-fleeting"}, "reply_to_user": {"reputation": 109, "user_id": 9486016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-2e0nuSWKDGE/AAAAAAAAAAI/AAAAAAAAAIE/JYcps_nk_FY/photo.jpg?sz=128", "display_name": "No&#233;mie Harvey", "link": "https://stackoverflow.com/users/9486016/no%c3%a9mie-harvey"}, "edited": false, "score": 1, "creation_date": 1565112962, "post_id": 57381216, "comment_id": 101247035, "body": "@No&#233;mieHarvey - yes, just wrap the whole thing once again with <code>string()</code>."}], "tags": [], "owner": {"reputation": 15659, "user_id": 9448090, "user_type": "registered", "profile_image": "https://graph.facebook.com/600951510246447/picture?type=large", "display_name": "Jack Fleeting", "link": "https://stackoverflow.com/users/9448090/jack-fleeting"}, "is_accepted": true, "score": 4, "last_activity_date": 1577222609, "last_edit_date": 1577222609, "creation_date": 1565112352, "answer_id": 57381216, "question_id": 57381145, "link": "https://stackoverflow.com/questions/57381145/nokogiri-xpath-count-occurences-of-xml-element-with-conditions-on-attributes/57381216#57381216", "title": "Nokogiri xpath - count occurences of XML element with conditions on attributes", "body": "<p>Try wrapping the XPath expressions with <code>count()</code>. So:</p>\n\n<pre><code>count(//rooms//room[@beds=1 and @windows=0])\n</code></pre>\n\n<p>and </p>\n\n<pre><code>count(/rooms//room[@beds=2 and @windows=0])\n</code></pre>\n\n<p>should output <code>1</code> and <code>2</code>, respectively.</p>\n"}], "owner": {"reputation": 109, "user_id": 9486016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-2e0nuSWKDGE/AAAAAAAAAAI/AAAAAAAAAIE/JYcps_nk_FY/photo.jpg?sz=128", "display_name": "No&#233;mie Harvey", "link": "https://stackoverflow.com/users/9486016/no%c3%a9mie-harvey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 57381216, "answer_count": 1, "score": 0, "last_activity_date": 1577222609, "creation_date": 1565112025, "question_id": 57381145, "link": "https://stackoverflow.com/questions/57381145/nokogiri-xpath-count-occurences-of-xml-element-with-conditions-on-attributes", "title": "Nokogiri xpath - count occurences of XML element with conditions on attributes", "body": "<p>I have this tags in my XML :</p>\n\n<pre><code>&lt;rooms&gt;\n   &lt;room id=\"1\" beds=\"1\" windows=\"0\"/&gt;\n   &lt;room id=\"2\" beds=\"2\" windows=\"0\"/&gt;\n   &lt;room id=\"3\" beds=\"2\" windows=\"0\"/&gt;\n &lt;/rooms&gt;\n</code></pre>\n\n<p>And I would like to count the occurences of rooms with 1 bed and no window and to count the occurences of rooms with 2 beds and no window. I use nokogiri xpath in Ruby, so I am looking for something like this :</p>\n\n<p>count of this -> <code>xpath: \"//rooms//room[@beds=1 and @windows=0]\"</code></p>\n\n<p>count of this -> <code>xpath: \"//rooms//room[@beds=2 and @windows=0]\"</code></p>\n\n<p>Thanks !</p>\n"}, {"tags": ["ruby", "bootstrap-4", "rails-activerecord"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565108234, "post_id": 57379786, "comment_id": 101244930, "body": "why are you inline styling?  also can you add a screenshot somehow illustrating the problem?"}, {"owner": {"reputation": 1, "user_id": 10769547, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kTHmgR19Yl4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jVowzUea7EmH7pbnWjqmdllpyFFg/mo/photo.jpg?sz=128", "display_name": "Konstantin Venberg", "link": "https://stackoverflow.com/users/10769547/konstantin-venberg"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565150372, "post_id": 57379786, "comment_id": 101256858, "body": "@lacostenycoder Saying inline do you mean rows instead of columns or something else? Thank you for all comments)  Here is screen of trouble - it appears when page is resizing <a href=\"https://pasteboard.co/Irx7Q3r.png\" rel=\"nofollow noreferrer\">https://pasteboard.co/Irx7Q3r.png</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565176965, "post_id": 57379786, "comment_id": 101268283, "body": "This is going to be hard to help you with unless you can share the project or a subset needed to work with your data and styles.  Can you share it along with products data on a github repo or gist or something?"}], "owner": {"reputation": 1, "user_id": 10769547, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kTHmgR19Yl4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jVowzUea7EmH7pbnWjqmdllpyFFg/mo/photo.jpg?sz=128", "display_name": "Konstantin Venberg", "link": "https://stackoverflow.com/users/10769547/konstantin-venberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565106614, "creation_date": 1565106614, "question_id": 57379786, "link": "https://stackoverflow.com/questions/57379786/how-to-make-equal-column-height-for-different-hash-values-of-activerecord", "title": "How to make equal column height for different hash values of ActiveRecord", "body": "<p>guys!\nThere is a puzzle with .erb-view in Sinatra and Bootstrap grid: how to make equal height of columns, which created through \"each\" cycle?\nValue in Row 3 \"c\" could have various length.</p>\n\n<p>My stack is:\nRuby 2.5.3\nGem Sinatra\nGem Sinatra-Activerecord\nbootstrap 4.3.1</p>\n\n<p>I've tried to use various combinations with rows and columns: d-flex class, flex-fill options, text-truncate as last chance, but I understand that is not exactly I need, because columns created for each product item with different data.</p>\n\n<p>1)In app.rb:</p>\n\n<pre><code>get'/main' do\n  @products = Product.all\n  erb :index\nend\n</code></pre>\n\n<p>2) In index.erb:</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n\n  &lt;div class=\"row justify-content-center\"&gt;\n    &lt;% @products.each do |prod| %&gt;\n    &lt;div class=\"col-4 p-3 mx-1 mb-5 shadow bg-white rounded\" style=\"min-width: 160px; max-width: 32%\"&gt;\n\n    &lt;div class=\"row justify-content-left\"&gt;&lt;b&gt;&lt;%= prod.a%&gt;&lt;/b&gt;&lt;/div&gt;\n\n        &lt;div class=\"row justify-content-center\"&gt;\n    &lt;img class=\"img-fluid\" src=\"&lt;%= prod.b %&gt;\" style=\"justify-content-center\"&gt;&lt;/div&gt;\n\n        &lt;div class=\"row justify-content-left\" style=\"min-height: 50px\"&gt;\n      &lt;div class=\"col my-auto py-sm-0\" style=\"min-height: 70px; max-height: 90px\"&gt;\n&lt;i&gt;Description: &lt;%=**prod.c**%&gt;&lt;/i&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n\n      &lt;/div&gt;\n    &lt;% end %&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>As a result I need to see 3 columns with equal width and height, and 3 equal rows into each column.\nNow, row 3 breaks the solid view.</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1565101840, "post_id": 57378346, "comment_id": 101241320, "body": "What is the output you want here, and also are you using a programming language with your regex package?"}, {"owner": {"reputation": 612, "user_id": 2630890, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/cdd840a40a420deceb4a3067fd0f403e?s=128&d=identicon&r=PG", "display_name": "Gibbo", "link": "https://stackoverflow.com/users/2630890/gibbo"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1565102115, "post_id": 57378346, "comment_id": 101241494, "body": "Ruby. Using <code>string.scan</code>. I basically need a capture group for each line. So one for each species, then one that holds the food type, length of time and the unit of time. The order matters as index 0 of the species would match index 0 of meat and milk. That make sense? Sorry for not being clear."}, {"owner": {"reputation": 18299, "user_id": 2191572, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWbVr.png?s=128&g=1", "display_name": "MonkeyZeus", "link": "https://stackoverflow.com/users/2191572/monkeyzeus"}, "edited": false, "score": 0, "creation_date": 1565104742, "post_id": 57378346, "comment_id": 101242987, "body": "Any reason that you are not splitting the string on newlines, looping, and using conditions to test which type of line entry you are looking at?"}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1565105969, "post_id": 57378346, "comment_id": 101243729, "body": "Do you mean getting consecutive groups? <code>(?:(Cattle): (Sheep): (Pigs):.*\\r?\\n|\\G)(\\S+ *\u2013\\d+ \\S+) (\\S+ *\u2013 \\d+ \\S+) (\\S+ *\u2013 \\d+ \\S+)\\r?\\n|((?&lt;=\\G).+)</code> <a href=\"https://rubular.com/r/csd2raX1TRHCdb\" rel=\"nofollow noreferrer\">Rubular demo</a> Or to see the highlighted groups <a href=\"https://regex101.com/r/kW8yPz/1\" rel=\"nofollow noreferrer\">regex101.com/r/kW8yPz/1</a>"}, {"owner": {"reputation": 612, "user_id": 2630890, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/cdd840a40a420deceb4a3067fd0f403e?s=128&d=identicon&r=PG", "display_name": "Gibbo", "link": "https://stackoverflow.com/users/2630890/gibbo"}, "reply_to_user": {"reputation": 18299, "user_id": 2191572, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWbVr.png?s=128&g=1", "display_name": "MonkeyZeus", "link": "https://stackoverflow.com/users/2191572/monkeyzeus"}, "edited": false, "score": 0, "creation_date": 1565106808, "post_id": 57378346, "comment_id": 101244224, "body": "@MonkeyZeus the string is already split on new lines, basically at each iteration I want to capture the groups that are there so I can take them and organize them in a readable manner. That&#39;s why I thought a capture group for each type and since they are ordered, index 0 on each line would have the matching data."}, {"owner": {"reputation": 18299, "user_id": 2191572, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWbVr.png?s=128&g=1", "display_name": "MonkeyZeus", "link": "https://stackoverflow.com/users/2191572/monkeyzeus"}, "edited": false, "score": 0, "creation_date": 1565107099, "post_id": 57378346, "comment_id": 101244386, "body": "So <code>IF line starts with cattle then do x ELSEIF line starts with Meat then do y ELSEIF line starts with Milk then do z</code> is not plausible?"}, {"owner": {"reputation": 612, "user_id": 2630890, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/cdd840a40a420deceb4a3067fd0f403e?s=128&d=identicon&r=PG", "display_name": "Gibbo", "link": "https://stackoverflow.com/users/2630890/gibbo"}, "edited": false, "score": 0, "creation_date": 1565107523, "post_id": 57378346, "comment_id": 101244614, "body": "Nope. I have 3,000 documents to parse. This particular regex is only one of the edge cases, not to mention all the typos, random spaces, periods etc. Basically whoever is in charge of maintaining them...is useless."}, {"owner": {"reputation": 18299, "user_id": 2191572, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWbVr.png?s=128&g=1", "display_name": "MonkeyZeus", "link": "https://stackoverflow.com/users/2191572/monkeyzeus"}, "edited": false, "score": 0, "creation_date": 1565111756, "post_id": 57378346, "comment_id": 101246487, "body": "You should consider showing a more diverse set of data which is representative of your situation and explain how you plan to use it because a pure regex solution could be difficult..."}, {"owner": {"reputation": 612, "user_id": 2630890, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/cdd840a40a420deceb4a3067fd0f403e?s=128&d=identicon&r=PG", "display_name": "Gibbo", "link": "https://stackoverflow.com/users/2630890/gibbo"}, "edited": false, "score": 0, "creation_date": 1565111956, "post_id": 57378346, "comment_id": 101246585, "body": "Yeah, it&#39;s proving a pain in the ass but @Cary Swoveland has provided a solution that does exactly what I am looking for."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565110947, "post_id": 57380886, "comment_id": 101246157, "body": "Is this what you are looking for?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565111738, "post_id": 57380886, "comment_id": 101246477, "body": "There may be an issue with the value of <code>\u2013</code> it&#39;s not what it appears to be if you cut and paste from the OP&#39;s example. Paste this in irb <code>&#39;\u2013&#39; == &#39;-&#39;</code>"}, {"owner": {"reputation": 612, "user_id": 2630890, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/cdd840a40a420deceb4a3067fd0f403e?s=128&d=identicon&r=PG", "display_name": "Gibbo", "link": "https://stackoverflow.com/users/2630890/gibbo"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565111827, "post_id": 57380886, "comment_id": 101246524, "body": "@lacostenycoder Yep, it&#39;s not the same as <code>-</code>. It caught me off guard. Unfortunately there are instances of both of them existing."}, {"owner": {"reputation": 612, "user_id": 2630890, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/cdd840a40a420deceb4a3067fd0f403e?s=128&d=identicon&r=PG", "display_name": "Gibbo", "link": "https://stackoverflow.com/users/2630890/gibbo"}, "edited": false, "score": 0, "creation_date": 1565111909, "post_id": 57380886, "comment_id": 101246564, "body": "@CarySwoveland This is exactly what I am looking for, this will allow me to simple build a proper object out of the data. Thank you."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 612, "user_id": 2630890, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/cdd840a40a420deceb4a3067fd0f403e?s=128&d=identicon&r=PG", "display_name": "Gibbo", "link": "https://stackoverflow.com/users/2630890/gibbo"}, "edited": false, "score": 1, "creation_date": 1565112388, "post_id": 57380886, "comment_id": 101246756, "body": "@Gibbo can you chime in on the problems with <code>-</code> ? if you meant to have two diff characters for them in your example or not. That problem caused us lots of hair pulling trying to make a regex based off of subtly different ascii characters."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1565113627, "post_id": 57380886, "comment_id": 101247316, "body": "@lacostenycoder, a wise man from the east once said, &quot;hair-pulling builds character&quot;."}, {"owner": {"reputation": 612, "user_id": 2630890, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/cdd840a40a420deceb4a3067fd0f403e?s=128&d=identicon&r=PG", "display_name": "Gibbo", "link": "https://stackoverflow.com/users/2630890/gibbo"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1565115467, "post_id": 57380886, "comment_id": 101248061, "body": "@lacostenycoder I didn&#39;t make that example up, I have pulled it right from a parsed docx file. It is full of stuff like that. Only way around it so far is to log everything and look where data is missing. It&#39;s not bad since I have the file name attached to the log output, so if I see it skipping over an entire section, I can investigate to make sure that there are no weird ascii characters.  EDIT: It&#39;s been nearly 2 weeks at this. I&#39;m dead inside."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 612, "user_id": 2630890, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/cdd840a40a420deceb4a3067fd0f403e?s=128&d=identicon&r=PG", "display_name": "Gibbo", "link": "https://stackoverflow.com/users/2630890/gibbo"}, "edited": false, "score": 0, "creation_date": 1565119131, "post_id": 57380886, "comment_id": 101249586, "body": "@Gibbo, consider cleaning up the string as follows: <code>str.gsub(&#47;(?&lt;= ). ?(?=\\d+ +(?:days|hours))&#47;, &#39;- &#39;) #=&gt; &quot;Cattle: Sheep: Pigs: \\nMeat - 0 days Meat - 0 days Meat - 0 days\\nMilk - 0 hours Milk - 0 hours\\n&quot;</code>. This regex (which I expect you&#39;d have to modify) matches any character (a hyphen, emdash, etc.) optionally followed by a space, the match being immediately preceded by a space (<i>positive lookbehind</i>) and immediately followed by one or more digits followed by one or more spaces folllowed by <code>&quot;days&quot;</code> or <code>&quot;hours&quot;</code> (<i>positive lookahead</i>)."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1565110915, "creation_date": 1565110915, "answer_id": 57380886, "question_id": 57378346, "link": "https://stackoverflow.com/questions/57378346/regex-capture-word-follow-by-a-number-as-a-group/57380886#57380886", "title": "Regex capture word follow by a number as a group", "body": "<pre><code>str =&lt;&lt;END\nCattle: Sheep: Pigs: \nMeat \u20130 days Meat \u2013 0 days Meat \u2013 0 days\nMilk \u2013 0 hours Milk \u2013 0 hours\nEND\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>str.each_line.map { |line| line.chomp.downcase.split(/(?&lt;=:|days|hours) */) }\n  #=&gt; [[\"cattle:\", \"sheep:\", \"pigs:\"],\n  #    [\"meat \u20130 days\", \"meat \u2013 0 days\", \"meat \u2013 0 days\"],\n  #    [\"milk \u2013 0 hours\", \"milk \u2013 0 hours\"]]\n</code></pre>\n\n<p>The regular expression reads, \"match one or more spaces that are immediately preceded by a colon, the word 'days' or the word 'hours', <code>(?&lt;=:|days|hours)</code> being a positive <em>lookbehind</em>. </p>\n"}], "owner": {"reputation": 612, "user_id": 2630890, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/cdd840a40a420deceb4a3067fd0f403e?s=128&d=identicon&r=PG", "display_name": "Gibbo", "link": "https://stackoverflow.com/users/2630890/gibbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57380886, "answer_count": 1, "score": 1, "last_activity_date": 1565110915, "creation_date": 1565101714, "last_edit_date": 1565107123, "question_id": 57378346, "link": "https://stackoverflow.com/questions/57378346/regex-capture-word-follow-by-a-number-as-a-group", "title": "Regex capture word follow by a number as a group", "body": "<p>I need to match this string:</p>\n\n<pre><code>Cattle: Sheep: Pigs: \nMeat \u20130 days Meat \u2013 0 days Meat \u2013 0 days\nMilk \u2013 0 hours Milk \u2013 0 hours\n</code></pre>\n\n<p>To create the following capture groups:</p>\n\n<pre><code>[cattle:, sheep:, pigs:]\n[meat - 0 days, meat - 0 days, meat - 0 days]\n[milk - 0 days, milk - 0 days]\n</code></pre>\n\n<hr>\n\n<p>I've tried to have a go myself but I am getting nowhere, I currently have something like this but it matches digits and spaces all over the string</p>\n\n<pre><code>(?!Cattle|Sheep|Pigs)(\\b[Meat\\s-\\s\\d*]\\b)\n</code></pre>\n\n<p>I am capturing the cattle, speed and pigs strings in a different regex, hence the neg lookahead.</p>\n\n<p>EDIT: Sorry I should have specific more. These are all on a separate line split into an array.</p>\n"}, {"tags": ["ruby", "logging", "rspec"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565104774, "post_id": 57377164, "comment_id": 101242995, "body": "What exactly are you trying to test?  This seem convoluted. What is the expectation of your test?"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1565106505, "post_id": 57377164, "comment_id": 101244033, "body": "what is the error message? what is not working? what are you trying to achieve?"}, {"owner": {"reputation": 11, "user_id": 6527462, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zetmbEbogxs/AAAAAAAAAAI/AAAAAAAAADQ/UA7gc-bxTxM/photo.jpg?sz=128", "display_name": "Ankur Saxena", "link": "https://stackoverflow.com/users/6527462/ankur-saxena"}, "edited": false, "score": 0, "creation_date": 1565178424, "post_id": 57377164, "comment_id": 101269145, "body": "I need to use logger in all the files, but ruby doesn&#39;t allow multiple inheritance."}], "owner": {"reputation": 11, "user_id": 6527462, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zetmbEbogxs/AAAAAAAAAAI/AAAAAAAAADQ/UA7gc-bxTxM/photo.jpg?sz=128", "display_name": "Ankur Saxena", "link": "https://stackoverflow.com/users/6527462/ankur-saxena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565178305, "creation_date": 1565097960, "last_edit_date": 1565178305, "question_id": 57377164, "link": "https://stackoverflow.com/questions/57377164/use-of-logger-with-ruby-and-rspec", "title": "Use of Logger with Ruby and RSpec", "body": "<p>I have created logger object in \"spec/logger.rb\" and returned it.\nI have created logger object in \"spec/test1.rb\" in describe method and can use it. it is working in same directory. If i need to use logger by creating logger object or by including file in different directory with and without class, then is there any way to do it ?</p>\n\n<p><code>spec/logger.rb</code></p>\n\n<pre><code>class Logging\n    def initialize_logger()    \n        log = Logger.new(\"test.log\")\n        return log\n    end\nend\n</code></pre>\n\n<p><code>spec/test1.rb</code></p>\n\n<pre><code>require 'java'\nrequire 'rspec'\nrequire 'logger'\n\nrequire \"logger.rb\"\n\nclass SingleTest\n  describe 'Verify Single Test' do\n    # create logger object\n    logger_object = Logging.new\n    logger = logger_object.initialize_logger()\n    logger.info 'Checking Logger'\n\n    it 'Verify Single Test for logger is present' do\n      logger.info 'Creating logger'\n    end\n  end\nend\n</code></pre>\n\n<p><code>lib/test_lib1.rb</code></p>\n\n<pre><code>require 'httparty'\nrequire '../utility/logger.rb'\n\n@logger_object = Logging.new\n@logger = @logger_object.initialize_logger()\n\n@logger.info 'Checking Logger'\n\ndef first()\n  @logger.info \"first logger in lib\"\nend\n\ndef perform_url_request()\n  @logger.info \"URL\"\n  @logger.info \"Request Method\"\nend\n</code></pre>\n\n<p><code>lib/test_lib2.rb</code></p>\n\n<pre><code>require '../utility/logger.rb'\n\nclass TestFile\n  def initialize()\n    @logger_object = Logging.new\n    @logger = @logger_object.initialize_logger()\n    @logger.info \"I am intialize\"\n  end\n\n  def test_method()\n    @logger.info \"******\"\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1, "user_id": 11889652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd8c3a8f41e5feaa6f149e29b8ad3e15?s=128&d=identicon&r=PG&f=1", "display_name": "brnrob", "link": "https://stackoverflow.com/users/11889652/brnrob"}, "edited": false, "score": 0, "creation_date": 1565099589, "post_id": 57376348, "comment_id": 101239816, "body": "The above code is from my event index page which renders a form"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10469184, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hjoMSco0tU4/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUisnPpfLMEUB1mOi41fBd5i3MPhQ/mo/photo.jpg?sz=128", "display_name": "\u6b65\u60ca\u4e91", "link": "https://stackoverflow.com/users/10469184/%e6%ad%a5%e6%83%8a%e4%ba%91"}, "is_accepted": false, "score": 0, "last_activity_date": 1565142009, "creation_date": 1565142009, "answer_id": 57385920, "question_id": 57376348, "link": "https://stackoverflow.com/questions/57376348/how-to-create-partial-table-that-is-linked-to-another-controller-on-ror/57385920#57385920", "title": "How to create partial table that is linked to another controller on RoR", "body": "<p>Yes, for the partial page generate the form content.</p>\n\n<p>in the form_for doc;</p>\n\n<pre><code>form_for(record, options = {}, &amp;block)\n\nThe rightmost argument to form_for is an optional hash of options:\n\n:url - The URL the form is submitted to. It takes the same fields you pass to url_for or link_to. In particular you may pass here a named route directly as well. Defaults to the current action.\n\n:namespace - A namespace for your form to ensure uniqueness of id attributes on form elements. The namespace attribute will be prefixed with underscore on the generated HTML id.\n\n:html - Optional HTML attributes for the form tag.\n</code></pre>\n\n<p>So, as a solution, you should add a url params to partial.</p>\n"}], "owner": {"reputation": 1, "user_id": 11889652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd8c3a8f41e5feaa6f149e29b8ad3e15?s=128&d=identicon&r=PG&f=1", "display_name": "brnrob", "link": "https://stackoverflow.com/users/11889652/brnrob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1565142009, "creation_date": 1565095359, "question_id": 57376348, "link": "https://stackoverflow.com/questions/57376348/how-to-create-partial-table-that-is-linked-to-another-controller-on-ror", "title": "How to create partial table that is linked to another controller on RoR", "body": "<p>I am trying to link guests that are attending an event that has been created. They are in separate controllers but I want to show the guests details on the details of the event page. </p>\n\n<p>I know that this a partial and can show it in a form but then it links back to the controller form when I want it to stay on the event page.</p>\n\n<p>Created a partial form.</p>\n\n<pre><code>&lt;div class=\"events show\"&gt;\n  &lt;h2&gt;&lt;%=@event.name%&gt;&lt;/h2&gt;\n\n  &lt;table summary=\"Event view\"&gt;\n    &lt;tr&gt;\n\n      &lt;td&gt;&lt;% if @event.cover_photo.attached? %&gt;\n        &lt;image src=\"&lt;%=(url_for(@event.cover_photo)) %&gt;\"&gt;\n          &lt;% end %&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n\n    &lt;tr&gt;\n      &lt;th&gt;Date of Event&lt;/th&gt;\n      &lt;td&gt;&lt;%= @event.date_of_event.strftime(\"%-d/%-m/%y %H:%M %Z\") %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Description&lt;/th&gt;\n      &lt;td&gt;&lt;%= @event.description %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Location&lt;/th&gt;\n      &lt;td&gt;&lt;%= @event.location %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n\n\n    &lt;tr&gt;\n      &lt;th&gt;Response Cut-Off&lt;/th&gt;\n      &lt;td&gt;&lt;%= @event.rsvp_cut_off.strftime(\"%-d/%-m/%y %H:%M %Z\") %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Created&lt;/th&gt;\n      &lt;td&gt;&lt;%= @event.created_at.strftime(\"%-d/%-m/%y %H:%M %Z\") %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Updated&lt;/th&gt;\n      &lt;td&gt;&lt;%= @event.updated_at.strftime(\"%-d/%-m/%y %H:%M %Z\") %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n\n&lt;/div&gt;\n&lt;div &gt;\n  &lt;%= render @event.guestlists %&gt;\n\n  &lt;h2&gt;Add a guest:&lt;/h2&gt;\n  &lt;%= render 'guestlists/form', guestlist: @event.guestlists.build %&gt;\n&lt;/div&gt;\n\n&lt;%= link_to 'Edit', edit_event_path(@event) %&gt; |\n&lt;%= link_to 'Back', events_path %&gt;\n</code></pre>\n\n<p>No errors, it shows the form to complete to create a guest but then takes the created guest and inputs it into the guestlist controller.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "client-server", "impersonation"], "comments": [{"owner": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "edited": false, "score": 1, "creation_date": 1597756606, "post_id": 57375936, "comment_id": 112233139, "body": "Hi, I know it&#39;s been a while but did you manage to implement this feature? Did you maybe try any of those gems you listed above?"}], "owner": {"reputation": 1148, "user_id": 6591347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/muykQ.png?s=128&g=1", "display_name": "Oleksii Filonenko", "link": "https://stackoverflow.com/users/6591347/oleksii-filonenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 626, "favorite_count": 1, "protected_date": 1603155744, "answer_count": 0, "score": 4, "last_activity_date": 1603154689, "creation_date": 1565094036, "question_id": 57375936, "link": "https://stackoverflow.com/questions/57375936/implementing-user-impersonation-in-rails-api-react-client", "title": "Implementing user impersonation in Rails API + React client", "body": "<p>So, I found gems like <a href=\"https://github.com/ankane/pretender\" rel=\"nofollow noreferrer\">pretender</a>, <a href=\"https://github.com/userimpersonate/user_impersonate2\" rel=\"nofollow noreferrer\">user_impersonate2</a> and <a href=\"https://github.com/flyerhzm/switch_user\" rel=\"nofollow noreferrer\">switch_user</a>. They all seem to accomplish the similar goal - switching <code>current_user</code> for systems like Devise, for \"monolith\" Rails apps.</p>\n\n<p>I have a React client talking to a Rails app. The admin page is implemented directly in Rails (it's a view), and the client is separated. Currently, client makes POST requests to Devise routes that provide an <code>access_token</code> via <a href=\"https://github.com/waiting-for-dev/devise-jwt\" rel=\"nofollow noreferrer\"><code>devise-jwt</code></a>, and saves the token in browser's <code>localstorage</code>.</p>\n\n<p>Is there a recommended way on allowing administrators to log in as users and be redirected from the admin (Rails) page to the client (React) page? Preferably with minimum changes to the frontend code, but I can make do with that.</p>\n\n<p>I thought about sharing cookies via a shared root domain, but that smells of security issues to me.</p>\n\n<p>I'm not sure how can I make the client app to \"listen\" for the token change made in the Rails app, or any similar way of changing the current user from the client's perspective.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "edited": false, "score": 0, "creation_date": 1565095939, "post_id": 57376226, "comment_id": 101237396, "body": "I used the command from <a href=\"https://stackoverflow.com/questions/22778784/rake-assetsprecompile-rails-env-production-not-working-as-required\">this question</a>"}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 2, "last_activity_date": 1565094927, "creation_date": 1565094927, "answer_id": 57376226, "question_id": 57375653, "link": "https://stackoverflow.com/questions/57375653/dont-know-how-to-build-task-bundle-ruby-on-rails/57376226#57376226", "title": "Don&#39;t know how to build task &#39;bundle&#39; - Ruby on Rails", "body": "<p>You seem to have mixed up your commands so that you are attempting to call two commands as one.</p>\n\n<p>It appears, you are actually trying to call only this:</p>\n\n<pre><code>RAILS_ENV=production bundle exec rake assets:precompile\n</code></pre>\n\n<p>With the command you have used originally, you are trying to call the rake tasks named <code>assets:precompile</code>, <code>bundle</code>, <code>exec</code>, <code>rake</code> and again <code>assets:precompile</code>. Since you don't have a rake task named <code>bundle</code>, you got the error you quoted.</p>\n"}], "owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 0, "accepted_answer_id": 57376226, "answer_count": 1, "score": 2, "last_activity_date": 1565124083, "creation_date": 1565092967, "last_edit_date": 1565124083, "question_id": 57375653, "link": "https://stackoverflow.com/questions/57375653/dont-know-how-to-build-task-bundle-ruby-on-rails", "title": "Don&#39;t know how to build task &#39;bundle&#39; - Ruby on Rails", "body": "<p>I am trying to precompile my assets:</p>\n\n<pre><code>rake assets:precompile RAILS_ENV=production bundle exec rake assets:precompile\n</code></pre>\n\n<p>and getting the following error: </p>\n\n<blockquote>\n  <p>Don't know how to build task 'bundle' (See the list of available tasks with \"rake --tasks\")</p>\n</blockquote>\n\n<p>After <code>--trace</code>:</p>\n\n<pre><code>** Invoke assets:precompile (first_time)\n** Invoke assets:environment (first_time)\n** Execute assets:environment\n** Invoke environment (first_time)\n** Execute environment\n** Invoke yarn:install (first_time)\n** Execute yarn:install\nyarn install v1.17.3\n[1/4] \ud83d\udd0d  Resolving packages...\nsuccess Already up-to-date.\n\u2728  Done in 0.04s.\n** Execute assets:precompile\nrake aborted!\nDon't know how to build task 'bundle' (See the list of available tasks with `rake --tasks`)\n/Users/anton/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.3/lib/rake/task_manager.rb:59:in `[]'\n/Users/anton/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:159:in `invoke_task'\n/Users/anton/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:116:in `block (2 levels) in top_level'\n/Users/anton/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:116:in `each'\n/Users/anton/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:116:in `block in top_level'\n/Users/anton/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:125:in `run_with_threads'\n/Users/anton/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:110:in `top_level'\n/Users/anton/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:83:in `block in run'\n/Users/anton/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:186:in `standard_exception_handling'\n/Users/anton/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:80:in `run'\n/Users/anton/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.3/exe/rake:27:in `&lt;top (required)&gt;'\n/Users/anton/.rbenv/versions/2.6.3/bin/rake:22:in `load'\n/Users/anton/.rbenv/versions/2.6.3/bin/rake:22:in `&lt;main&gt;'\n</code></pre>\n\n<p>How to fix this problem? I tried to update my gems, re-installed everything, added <code>gem 'rake'</code> and still getting the same error. Thank you very much for your help.</p>\n\n<p>Rails version: <code>~&gt; 5.1.6</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "watir", "ruby-watir"], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "edited": false, "score": 0, "creation_date": 1565252433, "post_id": 57376603, "comment_id": 101296868, "body": "I have tried still shows the error of:  #&lt;Watir::Font: located: false; {:index=&gt;1, :tag_name=&gt;&quot;table&quot;} --&gt; {:tag_name=&gt;&quot;tr&quot;} --&gt; {:class=&gt;&quot;spy14&quot;, :tag_name=&gt;&quot;font&quot;}&gt; to be located; Watir treated [&quot;scope&quot;] as a non-HTML compliant attribute, ensure that was intended (Watir::Exception::UnknownObjectException) ...... im trying to get all the proxies and ports of this page <a href=\"http://spys.one/proxies/\" rel=\"nofollow noreferrer\">spys.one/proxies</a>"}, {"owner": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "edited": false, "score": 0, "creation_date": 1565263507, "post_id": 57376603, "comment_id": 101303018, "body": "@Rajagopalan can u help me in this topic too ?"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "reply_to_user": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "edited": false, "score": 0, "creation_date": 1565269742, "post_id": 57376603, "comment_id": 101306761, "body": "@AstritShuli, thanks for providing the actual page. Part of the problem is that the table you need is not the second one - <code>index: 1</code>. Updated the answer with a solution that finds the right rows without the table index."}, {"owner": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "edited": false, "score": 0, "creation_date": 1565280555, "post_id": 57376603, "comment_id": 101313290, "body": "Thank you for everything"}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": false, "score": 0, "last_activity_date": 1565269677, "last_edit_date": 1565269677, "creation_date": 1565096181, "answer_id": 57376603, "question_id": 57374884, "link": "https://stackoverflow.com/questions/57374884/ruby-on-rails-how-to-get-every-row-of-a-specific-column-of-table-loop-through-r/57376603#57376603", "title": "Ruby on Rails how to get every row of a specific column of table? Loop through rows?", "body": "<p>You will want to:</p>\n\n<ol>\n<li>Get a collection of the table rows</li>\n<li>Iterate through each row to get the specific cell text.</li>\n</ol>\n\n<p>Try:</p>\n\n<pre><code>browser.trs(class: /spy1x/, onmouseover: true).map { |tr| tr.font(class: 'spy14').text }\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1568740499, "creation_date": 1565090485, "last_edit_date": 1568740499, "question_id": 57374884, "link": "https://stackoverflow.com/questions/57374884/ruby-on-rails-how-to-get-every-row-of-a-specific-column-of-table-loop-through-r", "title": "Ruby on Rails how to get every row of a specific column of table? Loop through rows?", "body": "<p>I have this table like in the image showed below:\nI am using Ruby Watir to get every row of the first column.</p>\n\n<p><a href=\"https://dominiumestate.com/wp-content/uploads/2019/08/Capture.jpg\" rel=\"nofollow noreferrer\">https://dominiumestate.com/wp-content/uploads/2019/08/Capture.jpg</a></p>\n\n<p>I have tried this but I can't get every row of the table only the first one with</p>\n\n<pre><code>puts t.tr(:index =&gt; 2, class: ['spy1xx']).td(:index =&gt; 0).font(class: ['spy14']).text \n</code></pre>\n\n<p><code>t = browser.table(:index =&gt; 1).tbody()</code></p>\n\n<pre><code> puts t.trs(:index =&gt; 2, class: ['spy1xx']).each do |s|\n puts s.td(:index =&gt; 0).font(class: ['spy14']).text\n end\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "model-view-controller", "filter"], "comments": [{"owner": {"reputation": 149, "user_id": 6843054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6539be961385a57301cc3b1efd2d3ff3?s=128&d=identicon&r=PG&f=1", "display_name": "SujoyD", "link": "https://stackoverflow.com/users/6843054/sujoyd"}, "edited": false, "score": 0, "creation_date": 1565087330, "post_id": 57373695, "comment_id": 101232636, "body": "What will be the merge result?? it will show first one or second one??"}, {"owner": {"reputation": 520, "user_id": 6507755, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/IUwxM.png?s=128&g=1", "display_name": "2017kamb", "link": "https://stackoverflow.com/users/6507755/2017kamb"}, "edited": false, "score": 0, "creation_date": 1565087441, "post_id": 57373695, "comment_id": 101232688, "body": "You can do like, Ofertum.all.group_by(&amp;:name)"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 1, "creation_date": 1565087732, "post_id": 57373695, "comment_id": 101232826, "body": "use this   <code>@oferta = Ofertum.select(&#39;distinct on (sign) *&#39;)</code> , it will fetch uniq names. let me know if its not working"}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1565112860, "post_id": 57373695, "comment_id": 101246987, "body": "@oferta have sig and each sig have name, image, etc. I want when the name is duplicate to merge the name in the filter.   &lt;%=  item.name%&gt;"}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1565112876, "post_id": 57373695, "comment_id": 101246990, "body": "Nothing of these solution works"}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565136939, "post_id": 57373695, "comment_id": 101254621, "body": "@Vishal It remove the full offer  (B. WAKACJE) not the name that duplicate (SERFER)"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565157945, "post_id": 57373695, "comment_id": 101258722, "body": "@nourza I don&#39;t get you."}], "answers": [{"comments": [{"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1565368977, "post_id": 57428483, "comment_id": 101346188, "body": "Thank you so much Teja, Finally it work after spending two days on it :)"}], "tags": [], "owner": {"reputation": 46, "user_id": 11906833, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5qDNl9KRfrs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reXn0ew75HGGyZ0xF6z4-uncIdjSQ/photo.jpg?sz=128", "display_name": "teja rajana", "link": "https://stackoverflow.com/users/11906833/teja-rajana"}, "is_accepted": true, "score": 1, "last_activity_date": 1565347696, "creation_date": 1565347696, "answer_id": 57428483, "question_id": 57373695, "link": "https://stackoverflow.com/questions/57373695/how-to-merge-duplicates-in-a-column-in-ruby-on-rails/57428483#57428483", "title": "How to merge duplicates in a column in Ruby on Rails?", "body": "<pre class=\"lang-rb prettyprint-override\"><code>&lt;% for item in o.sigs %&gt;\n   &lt;button class=\"btn\"  onclick=\"filterSelection('&lt;%= item.name %&gt;')\"&gt;&lt;%=  item.name%&gt;&lt;br&gt;&lt;/button&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>instead of for loop try</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;% o.sigs.pluck(:name).uniq.each do |name| %&gt;\n    &lt;button class=\"btn\"  onclick=\"filterSelection('&lt;%= name %&gt;')\"&gt;&lt;%= name %&gt;&lt;br&gt;/button&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 57428483, "answer_count": 1, "score": 0, "last_activity_date": 1565347696, "creation_date": 1565086204, "question_id": 57373695, "link": "https://stackoverflow.com/questions/57373695/how-to-merge-duplicates-in-a-column-in-ruby-on-rails", "title": "How to merge duplicates in a column in Ruby on Rails?", "body": "<p>I have this filter here for sign name. What I want to do is if I have more than one name of the sign to merge the content together\nCheck the image attached. I have two serfer names. I want to display just one<a href=\"https://i.stack.imgur.com/QCsST.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QCsST.png\" alt=\"enter image description here\"></a></p>\n\n<p>Please help me on this! Thanks</p>\n\n<pre><code>&lt;div class=\"categories\"&gt;\n      &lt;% @oferta.each do |o| %&gt;\n        &lt;ul class=\"cat\"&gt;\n          &lt;li class=\"pull-left\"&gt;&lt;h2&gt;&lt;%= link_to o.offer,o %&gt;&lt;/h2&gt;&lt;br&gt;&lt;h4&gt;&lt;%= o.description %&gt;&lt;/h4&gt;\n            &lt;div class=\"main\"&gt;\n              &lt;% if o.sigs.exists? %&gt;\n                &lt;div id=\"myBtnContainer\"&gt;\n                  &lt;button class=\"btn active\"  onclick=\"filterSelection('o')\"&gt;All&lt;/button&gt;\n                  &lt;% for item in o.sigs %&gt;\n                    &lt;button class=\"btn\"  onclick=\"filterSelection('&lt;%= item.name %&gt;')\"&gt;&lt;%=  item.name%&gt;&lt;br&gt;&lt;/button&gt;\n                  &lt;% end %&gt;\n                &lt;/div&gt;\n                &lt;div class=\"row\"&gt;\n\n                  &lt;% for item in o.sigs %&gt;\n                    &lt;div class=\"column &lt;%= item.name %&gt;\"&gt;\n                      &lt;div class=\"content\"&gt;\n                        &lt;%= image_tag item.image.url(), style: \"width:100%\"%&gt;\n                        &lt;h4&gt;&lt;br&gt;&lt;%=link_to item.name,item %&gt;&lt;/h4&gt;\n                        &lt;p&gt;&lt;%= item.comment %&gt;&lt;/p&gt;    \n                      &lt;/div&gt;\n                    &lt;/div&gt;\n                  &lt;% end %&gt;&lt;br&gt;&lt;br&gt;\n                &lt;/div&gt;\n              &lt;% end %&gt;&lt;br&gt;\n            &lt;/div&gt;\n          &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>here is the oferta_controller.rb</p>\n\n<pre><code>class OfertaController &lt; ApplicationController\n  before_action :find_ofertum, only: [:destroy,:edit,:update,:show]\n  def new\n    @ofertum= Ofertum.new\n  end\n\n  def create\n    @ofertum= Ofertum.new(ofertum_attributes)\n    if @ofertum.save\n      redirect_to oferta_path, notice: \"Thank you... Your offer was created successfully.\"\n    else\n      flash.now[:error] = \"Please correct the form\"\n      redirect_to new_ofertum_path\n    end\n  end\n  def index\n    @oferta = Ofertum.all\n  end\n\n  def show\n    @ofertum = Ofertum.find(params[:id])\n    @sig = @ofertum.sigs.build\n  end\n  private\n  def ofertum_attributes\n    ofertum_attributes = params.require(:ofertum).permit([:offer,:description,:sign,:place,:sig])\n  end\n  def find_ofertum\n    @ofertum = Ofertum.find(params[:id])\n  end\n\nend\n</code></pre>\n\n<p>in oferta model</p>\n\n<pre><code>class Ofertum &lt; ApplicationRecord\n  has_many :sigs\nend\n</code></pre>\n\n<p>in sig model</p>\n\n<pre><code>class Sig &lt; ApplicationRecord\n  belongs_to :ofertum\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "dynamic", "apache-cocoon"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565104535, "post_id": 57373567, "comment_id": 101242879, "body": "do not use <code>attr_accessor</code> in a model unless you have an extremely specific reason for doing so (which should never include overwriting relationships or attributes). I fear that you have created some form of ambiguity by adding <code>attr_accessor :oids</code> where the <code>has_many</code> is not overriding this. Thus <code>model.oids #=&gt; nil</code> because the method is actually <code>def oids; @oids; end</code>"}, {"owner": {"reputation": 21, "user_id": 4899775, "user_type": "registered", "profile_image": "https://graph.facebook.com/891503697574711/picture?type=large", "display_name": "JuanMartinez", "link": "https://stackoverflow.com/users/4899775/juanmartinez"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565104969, "post_id": 57373567, "comment_id": 101243117, "body": "yep i changed that before, but i still have the same error. Why if i do this returns nil? Theres got to be something wrong with the oid controller maybe? <code>Oid.reflect_on_association(:owner)</code> This should return MonitorCategory since i put the <code>belongs_to</code> in the Oid class."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4899775, "user_type": "registered", "profile_image": "https://graph.facebook.com/891503697574711/picture?type=large", "display_name": "JuanMartinez", "link": "https://stackoverflow.com/users/4899775/juanmartinez"}, "edited": false, "score": 0, "creation_date": 1565089845, "post_id": 57374187, "comment_id": 101233930, "body": "Hello, i updated my post explaining a little bit more what im trying to do, since this is not working and i have the same error.  Thank you for your time."}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "reply_to_user": {"reputation": 21, "user_id": 4899775, "user_type": "registered", "profile_image": "https://graph.facebook.com/891503697574711/picture?type=large", "display_name": "JuanMartinez", "link": "https://stackoverflow.com/users/4899775/juanmartinez"}, "edited": false, "score": 0, "creation_date": 1565090147, "post_id": 57374187, "comment_id": 101234095, "body": "If you want to use the form with cocoon that you posted, the form needs to be in the monitor_category new view. It will then dynamically build the children oids onto the parent monitor_category. Your form is not pointing to your oid controller."}, {"owner": {"reputation": 21, "user_id": 4899775, "user_type": "registered", "profile_image": "https://graph.facebook.com/891503697574711/picture?type=large", "display_name": "JuanMartinez", "link": "https://stackoverflow.com/users/4899775/juanmartinez"}, "edited": false, "score": 0, "creation_date": 1565090476, "post_id": 57374187, "comment_id": 101234247, "body": "yes i know. my dynamic form is part of the new_monitor_category view, thats not the problem. The problem is i cant even load that view because of the error `reflect on association which i dont know how to solve. I will keep searching for info since im getting nowhere here, thanks."}], "tags": [], "owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "is_accepted": false, "score": 0, "last_activity_date": 1565087959, "creation_date": 1565087959, "answer_id": 57374187, "question_id": 57373567, "link": "https://stackoverflow.com/questions/57373567/dynamic-forms-with-cocoon-undefined-method-reflect-on-association-for-nilcla/57374187#57374187", "title": "Dynamic Forms with Cocoon - undefined method `reflect_on_association&#39; for NilClass:Class:", "body": "<p>I think it's because your form is for a <code>monitor_category</code> and the url is pointing to the <code>create_monitor_category_path</code>. But you're showing us the <code>OidController</code>. You would need something like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MonitorCategoryController &lt; ApplicationController\n  def new\n    @monitor_category = MonitorCategory.new\n    @monitor_category.oids.build\n  end\nend\n</code></pre>\n\n<p>This will initialize the parent object and then build the child association. You need to build at least one child for the fields to show up when using fields for. </p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 4899775, "user_type": "registered", "profile_image": "https://graph.facebook.com/891503697574711/picture?type=large", "display_name": "JuanMartinez", "link": "https://stackoverflow.com/users/4899775/juanmartinez"}, "edited": false, "score": 0, "creation_date": 1565164705, "post_id": 57382562, "comment_id": 101261652, "body": "Hello thank you for your answer. I thought about that before, but if i delete de url and change it to <code>@monitor_category</code>, like im doing on the <code>edit_monitor_category</code>, which is working good, i get an &quot;undefined method <code>model_name</code> por nil:NilClass. The thing is im working with code done by other people long time ago, so maybe they had their reasons to put :monitor_category. What i still dont get is why i get nil if i do @oid = Oid.new"}, {"owner": {"reputation": 21, "user_id": 4899775, "user_type": "registered", "profile_image": "https://graph.facebook.com/891503697574711/picture?type=large", "display_name": "JuanMartinez", "link": "https://stackoverflow.com/users/4899775/juanmartinez"}, "edited": false, "score": 0, "creation_date": 1565164933, "post_id": 57382562, "comment_id": 101261747, "body": "And furthermore, if that was the problem, wont the other f.inputs would be failing too, since &quot;f&quot; is nill as you said?"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "reply_to_user": {"reputation": 21, "user_id": 4899775, "user_type": "registered", "profile_image": "https://graph.facebook.com/891503697574711/picture?type=large", "display_name": "JuanMartinez", "link": "https://stackoverflow.com/users/4899775/juanmartinez"}, "edited": false, "score": 0, "creation_date": 1565258654, "post_id": 57382562, "comment_id": 101300371, "body": "It is not <code>f</code> that is nil, but <code>f.object</code>. Is <code>@monitor_category</code> set in the controller? If this is only used in the <code>new</code> action (normally the form is shared between new and edit), you could also write <code>simple_form_for MonitorCategory.new, ..</code> (but just for test). For reference: <a href=\"https://stackoverflow.com/questions/5181143/simpleform-without-for-non-model-form\" title=\"simpleform without for non model form\">stackoverflow.com/questions/5181143/&hellip;</a>"}], "tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": false, "score": 1, "last_activity_date": 1565118683, "creation_date": 1565118683, "answer_id": 57382562, "question_id": 57373567, "link": "https://stackoverflow.com/questions/57373567/dynamic-forms-with-cocoon-undefined-method-reflect-on-association-for-nilcla/57382562#57382562", "title": "Dynamic Forms with Cocoon - undefined method `reflect_on_association&#39; for NilClass:Class:", "body": "<p>The problem is this line </p>\n\n<pre><code>simple_form_for(:monitor_category, url: create_monitor_category_path, :html =&gt; { :remote =&gt; true, :method =&gt; :post }) do |f| \n</code></pre>\n\n<p>This creates a form for a <code>MonitorCategory</code> but does not set an object. So when you then call <code>f.simple_fields_for</code> there is no object to iterate over the associations. </p>\n\n<p>Normally in the controller you set a <code>@monitor_category</code> instance variable, which is either set to an existing instance (when editing) or a newly created item. </p>\n\n<p>And then you can write: </p>\n\n<pre><code>simple_form_for(@monitor_category, :html =&gt; { :remote =&gt; true, :method =&gt; :post }) do |f| \n</code></pre>\n\n<p>Rails is smart enough to deduce the url from the object, it will either create a new one or update an existing one. </p>\n\n<p>Is that clear enough?</p>\n"}], "owner": {"reputation": 21, "user_id": 4899775, "user_type": "registered", "profile_image": "https://graph.facebook.com/891503697574711/picture?type=large", "display_name": "JuanMartinez", "link": "https://stackoverflow.com/users/4899775/juanmartinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565118683, "creation_date": 1565085726, "last_edit_date": 1565089700, "question_id": 57373567, "link": "https://stackoverflow.com/questions/57373567/dynamic-forms-with-cocoon-undefined-method-reflect-on-association-for-nilcla", "title": "Dynamic Forms with Cocoon - undefined method `reflect_on_association&#39; for NilClass:Class:", "body": "<p>im using the cocoon gem to build some dynamic form in which i can add new text fields. Ive read others people same problem but i dont know what im doing wrong, i know it has to be something with the associations but i dont seem to get it.</p>\n\n<p>So these are my models:</p>\n\n<pre><code>class MonitorCategory &lt; ActiveRecord::Base\n\n  validates :operation, presence: true\n  attr_accessor :oid, :oid2, :oids, :snmp_oper, :custom_tab_name, :custom_tab_unit, :redfish, :ipmi\n  has_many :oids\n  has_and_belongs_to_many :sensors\n\n  accepts_nested_attributes_for :oids\n\nclass Oid &lt; ActiveRecord::Base\n  belongs_to :monitor_category\n end\n</code></pre>\n\n<p>And my form:</p>\n\n<pre><code>&lt;%= simple_form_for(:monitor_category, url: create_monitor_category_path, :html =&gt; { :remote =&gt; true, :method =&gt; :post }) do |f| %&gt;\n&lt;div id='oids'&gt;\n    &lt;%= f.simple_fields_for :oids do |oid| %&gt;\n    &lt;%= render 'oids_fields', :f =&gt; oid %&gt;\n    &lt;% end %&gt;\n    &lt;div class='links'&gt;\n      &lt;%= link_to_add_association 'add oid', f, :oids %&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>with the partial _oids_fields.html.erb:</p>\n\n<pre><code>&lt;div class='nested-fields'&gt;\n&lt;%= f.input :oids %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>What am i doing wrong?  Im getting undefined method `reflect_on_association' for NilClass:Class:.  Form is okay since i was looking at the page of cocoon and is the same syntax, so i guess it must be something with the associations but i dont really know, im kind of new to the rails world. Maybe since it says nilClass, i need to create a controller for the Oid model in which i make a new method or something? im lost. </p>\n\n<p>Apparently this doesnt work either, i have the same error:</p>\n\n<pre><code>class OidController &lt; ApplicationController\n\n  def new\n    @oid = Oid.new\n  end\n\nend  \n</code></pre>\n\n<p>thank you for every answer.</p>\n\n<p>edit: just to be more clear, because im very confused.</p>\n\n<p>Before trying to implement this dynamic form, i already have a form which is working correctly. For example, last two fields are these:</p>\n\n<pre><code>      &lt;div class=\"col-md-12\"&gt;\n        &lt;%= f.input :oid, label: 'SNMP OID', as: :search, placeholder: 'Output stored in var1.', required: false, novalidate: true, input_html: {data: { autocomplete_source: get_oids_path }} %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"col-md-12\"&gt;\n        &lt;%= f.input :oid2, label: 'SNMP OID 2', as: :search, placeholder: 'Output stored in var2.', required: false, novalidate: true, input_html: {data: { autocomplete_source: get_oids_path }} %&gt;\n      &lt;/div&gt;\n</code></pre>\n\n<p>So basically here im storing the values entered on the attribute :oid and :oid2 from the model .</p>\n\n<p>but instead of having these two fields, i want to have only one, and add more dynamically, so i can enter for example 6 values and saved them all on the :oids attribute. Since i was saving the valued on an attribute, i dont know if i have to create a model for Oid, like a did before, and make it belong_to monitor_category. Or if i can just add an attribute   <code>:oids</code> to the controller and store all the values in that variable. </p>\n"}, {"tags": ["regex", "ruby", "regex-lookarounds", "regex-negation"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1565084366, "post_id": 57373123, "comment_id": 101231050, "body": "You are right, <i>it is not possible to use <code>+</code> or <code>*</code> in ... lookbehind pattern</i>. Are you extracting, replacing, removing, or maybe splitting?"}, {"owner": {"reputation": 54, "user_id": 1577825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8c1c3011e0174db3fea85197730ef4?s=128&d=identicon&r=PG", "display_name": "jtraulle", "link": "https://stackoverflow.com/users/1577825/jtraulle"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1565085982, "post_id": 57373123, "comment_id": 101231982, "body": "Your comment gave me an idea. It is about replacing the dashes by &lt;hr&gt; tags as part of a forum migration (from BBCode syntax to Markdown) but only if they are not in a code tag."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1565086041, "post_id": 57373123, "comment_id": 101232004, "body": "Ok, and can <code>[code]</code> tags be nested? Note that <code>&#47;\\[code\\].*?\\[\\&#47;code\\]&#47;m</code> will match <code>[code] abc [code] def [&#47;code]</code>, and <code>&#47;\\[code\\](?:(?!\\[\\&#47;?code\\]).)*\\[\\&#47;code\\]&#47;m</code> will only match <code>[code] def [&#47;code]</code>, but neither will match <code>[code] abc [code] def [&#47;code] ghi [&#47;code]</code> in full."}, {"owner": {"reputation": 54, "user_id": 1577825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8c1c3011e0174db3fea85197730ef4?s=128&d=identicon&r=PG", "display_name": "jtraulle", "link": "https://stackoverflow.com/users/1577825/jtraulle"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1565086228, "post_id": 57373123, "comment_id": 101232105, "body": "No, they cannot.  I could start by matching and removing all code portion from the message (storing them in an array) and replacing them by a marker in the message, then running my replacements and finally putting the code portions back from the temporary array ;)"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1565086317, "post_id": 57373123, "comment_id": 101232152, "body": "|Well, then use <code>s.gsub(&#47;(\\[code\\].*?\\[\\&#47;code\\])|-{5,100}&#47;m) { $1 || &quot;&lt;hr&#47;&gt;&quot; }</code> or <code>s.gsub(&#47;(\\[code\\](?:(?!\\[\\&#47;?code\\]).)*\\[\\&#47;code\\])|-{5,100}&#47;m&zwnj;&#8203;) { $1 || &quot;&lt;hr&#47;&gt;&quot; }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1565085336, "post_id": 57373308, "comment_id": 101231591, "body": "You do not need <code>[\\s\\S]</code> workaround if <code>m</code> flag is used (and OP uses it), <code>.</code> is enough."}], "tags": [], "owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "is_accepted": false, "score": 2, "last_activity_date": 1565085779, "last_edit_date": 1565085779, "creation_date": 1565084940, "answer_id": 57373308, "question_id": 57373123, "link": "https://stackoverflow.com/questions/57373123/regex-pattern-that-matches-only-if-not-included-in-another-pattern/57373308#57373308", "title": "Regex pattern that matches only if not included in another pattern", "body": "<p>One possibility if the tags are not nested is to match from the opening till the closing tag to match what you don't want. Then use an alternation to capture in a group what you do want, in this case 5 - 100 times a hyphen.</p>\n\n<pre><code>\\[code\\](?:(?!\\[\\/?code\\]).)*\\[\\/code]|(-{5,100})/m\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<ul>\n<li><code>\\[code\\]</code> Match <code>[code]</code></li>\n<li><code>(?:</code> Non capturing group\n\n<ul>\n<li><code>(?!\\[\\/?code\\]).</code> Assert if what is on the right is not <code>[code]</code> with an optional <code>/</code> after the opening <code>[</code> Then match any character.</li>\n</ul></li>\n<li><code>)*</code> Repeat non capturing group and repeat 0+ times</li>\n<li><code>\\[\\/code]</code> Match <code>[/code]</code></li>\n<li><code>|</code> Or</li>\n<li><code>(-{5,100})</code> Capture in group 1 matching 5 - 100 times a hyphen</li>\n</ul>\n\n<p><a href=\"https://rubular.com/r/9x7OXeLdXlYSO7\" rel=\"nofollow noreferrer\">Regex demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1565119572, "last_edit_date": 1565119572, "creation_date": 1565112011, "answer_id": 57381143, "question_id": 57373123, "link": "https://stackoverflow.com/questions/57373123/regex-pattern-that-matches-only-if-not-included-in-another-pattern/57381143#57381143", "title": "Regex pattern that matches only if not included in another pattern", "body": "<p>I don't believe a regular expression is the right tool for the job here.</p>\n\n<pre><code>str = &lt;&lt;END\n---------\n[code]\n-------------------------------------------------------------------------------\nSome text\n----------------------------------\nSome other text\n-------------------------------------------------------------------------------\ntest\n[/code]\n------------\n---\n[code]\nSome text\n-------------------------------------------\n[/code]\n------------\nEND\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>within = false\nstr.split(\"\\n\").select do |line|\n  case line\n  when \"[code]\"\n    within = true\n    false\n  when \"[/code]\"\n    within = false\n    false\n  else\n    within == false\n  end\nend\n  #=&gt; [\"---------\", \"------------\", \"---\", \"------------\"] \n</code></pre>\n\n<p>I would have used the to-some-beloved <a href=\"https://nithinbekal.com/posts/ruby-flip-flop/\" rel=\"nofollow noreferrer\">flip-flip operator</a> had it not been deprecated.</p>\n\n<pre><code> str.split(\"\\n\").reject do |line|\n   true if line == \"[code]\"..line == \"[/code]\"\n end\n   #=&gt; [\"---------\", \"------------\", \"---\", \"------------\"]\n</code></pre>\n\n<p><a href=\"https://en.wiktionary.org/wiki/Talk:hold_the_phone#targetText=Talk%3Ahold%20the%20phone&amp;targetText=I%20believe%20this%20expression%20originated,editors%20from%20public%20phone%20boxes.\" rel=\"nofollow noreferrer\">Hold the phone!</a> It looks like Matz has <a href=\"https://www.reddit.com/r/ruby/comments/cjk8e1/undeprecate_flipflop/?ref=readnext\" rel=\"nofollow noreferrer\">un-deprecated it</a>! (Scroll to end.)</p>\n"}], "owner": {"reputation": 54, "user_id": 1577825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8c1c3011e0174db3fea85197730ef4?s=128&d=identicon&r=PG", "display_name": "jtraulle", "link": "https://stackoverflow.com/users/1577825/jtraulle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565119572, "creation_date": 1565084291, "question_id": 57373123, "link": "https://stackoverflow.com/questions/57373123/regex-pattern-that-matches-only-if-not-included-in-another-pattern", "title": "Regex pattern that matches only if not included in another pattern", "body": "<p>I am trying to understand how to make a regular expression that only matches a pattern if this pattern is not included in another one.</p>\n\n<p>In the following example, I want to match dashes only if they are not into a [code][/code] tag.</p>\n\n<pre><code>---------\n\n[code]\n-------------------------------------------------------------------------------------\n\nSome text\n\n-----------------\n\nSome other text\n\n-------------------------------------------------------------------------------------\ntest\n\n[/code]\n</code></pre>\n\n<p>I have searched for explanations about lookahead and lookbehind but cannot understand if and how it could be suitable for what I need.</p>\n\n<p>I wanted to use a combination of negative lookbehind and negative lookahead but it seems that it is not possible to use + or * in negative lookbehind pattern.</p>\n\n<p>So, for example, this won't work (because of the + in the negative look behind)</p>\n\n<pre><code>/(?&lt;!\\[code\\].+?)(-{5,100})(?!.+?\\[\\/code\\])/m\n</code></pre>\n\n<p>How can I achieve that in another way ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "answers": [{"comments": [{"owner": {"reputation": 314, "user_id": 2916803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf4d2b53d362ecf102683795a5c2d07b?s=128&d=identicon&r=PG&f=1", "display_name": "drifterOcean19", "link": "https://stackoverflow.com/users/2916803/drifterocean19"}, "edited": false, "score": 0, "creation_date": 1565084433, "post_id": 57373102, "comment_id": 101231079, "body": "I tried your suggestion and got this : <code>undefined method `-&#39; for &quot;20 Feb 2020&quot;:String Did you mean?  -@</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 314, "user_id": 2916803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf4d2b53d362ecf102683795a5c2d07b?s=128&d=identicon&r=PG&f=1", "display_name": "drifterOcean19", "link": "https://stackoverflow.com/users/2916803/drifterocean19"}, "edited": false, "score": 0, "creation_date": 1565085377, "post_id": 57373102, "comment_id": 101231616, "body": "Sorry, I tried that in a pure Ruby environment, without realizing both variables are strings. See the updated answer."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1565085429, "last_edit_date": 1565085429, "creation_date": 1565084232, "answer_id": 57373102, "question_id": 57372981, "link": "https://stackoverflow.com/questions/57372981/finding-range-between-two-dates-in-haml/57373102#57373102", "title": "finding range between two dates in haml", "body": "<p>What you have there is a range of days, which is a Range object that doesn't implement the <code>&gt;=</code> method.</p>\n\n<p>What you need is to get the number of days of difference between each date object, using <code>to_date</code> for that:</p>\n\n<pre><code>p (booking.end_on.to_date - booking.start_on.to_date).to_i # 14\n</code></pre>\n\n<p>So, for your case:</p>\n\n<pre><code>- if (booking.end_on.to_date - booking.start_on.to_date).to_i &gt;= 4\n  ...\n</code></pre>\n\n<p>It's a Ruby error, not Haml.</p>\n"}], "owner": {"reputation": 314, "user_id": 2916803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf4d2b53d362ecf102683795a5c2d07b?s=128&d=identicon&r=PG&f=1", "display_name": "drifterOcean19", "link": "https://stackoverflow.com/users/2916803/drifterocean19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57373102, "answer_count": 1, "score": 2, "last_activity_date": 1565085429, "creation_date": 1565083787, "last_edit_date": 1565084518, "question_id": 57372981, "link": "https://stackoverflow.com/questions/57372981/finding-range-between-two-dates-in-haml", "title": "finding range between two dates in haml", "body": "<p>I'm not experienced in haml and at the moment trying to learn as I go along. Below is my haml code. I'm trying to show a button when the date range is equal to 4 or more days. Basically the requirement is that the button is hidden when it is only 4 days until the end date..</p>\n\n<pre><code>  - range = booking.start_on..booking.end_on\n  - if range &gt;= 4\n    = link_to \"#\",\n      class: 'btn-flat btn-flat-split',\n      title: \"Extend Booking\",\n      data: { method: request.primary_action.method } do\n      = \"Extend Booking\"\n      %i.icon-chevron-right\n</code></pre>\n\n<p>I'm getting this error :</p>\n\n<pre><code>NoMethodError at /ideas/50114\nundefined method `&gt;=' for \"06 Feb 2020\"..\"20 Feb 2020\":Range\n</code></pre>\n\n<p>I'm not 100% sure if the range is getting the right output or declared correctly..?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565083791, "post_id": 57372739, "comment_id": 101230754, "body": "you want to add this values at the end of hash or in between hash?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565089033, "post_id": 57372739, "comment_id": 101233476, "body": "This is a fundamentally bad idea. Hashes happen to be implemented to maintain insertion order in ruby, but as a concept, it&#39;s an unordered data structure. Some languages even explicitly randomize order every time you try to read from a hashmap. If you need order, use an array."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1565091565, "post_id": 57372739, "comment_id": 101234808, "body": "The front end is setup to expect a hash with a list of inputs so I don&#39;t have much choice here although I appreciate your points about hashes being unordered"}], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 2, "last_activity_date": 1565084077, "creation_date": 1565084077, "answer_id": 57373063, "question_id": 57372739, "link": "https://stackoverflow.com/questions/57372739/re-ordering-hash-items-to-have-some-appear-at-the-end/57373063#57373063", "title": "Re-ordering hash items to have some appear at the end", "body": "<p>You can try following,</p>\n\n<pre><code>(hash.keys - end_keys + end_keys).map { |key| [key, hash[key]] }.to_h\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1565109409, "creation_date": 1565109409, "answer_id": 57380511, "question_id": 57372739, "link": "https://stackoverflow.com/questions/57372739/re-ordering-hash-items-to-have-some-appear-at-the-end/57380511#57380511", "title": "Re-ordering hash items to have some appear at the end", "body": "<pre><code>hash = { \"body\"=&gt;:text, \"button_text\"=&gt;:string, \"category\"=&gt;:integer,\n         \"dashboard\"=&gt;:boolean, \"feature\"=&gt;:integer }\nenders = [\"button_text\", \"dashboard\"]\n\nhash.dup.tap { |h| enders.each { |k| h.update(k=&gt;h.delete(k)) } }\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-tap\" rel=\"nofollow noreferrer\">Object#tap</a>, <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-update\" rel=\"nofollow noreferrer\">Hash#update</a> (aka <code>merge!</code>) and <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-delete\" rel=\"nofollow noreferrer\">Hash#delete</a>.</p>\n\n<p><code>dup</code> may of course be removed if <code>hash</code> can be mutated, which may be reasonable as only the keys are being reordered. </p>\n"}], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 57373063, "answer_count": 2, "score": 0, "last_activity_date": 1565109409, "creation_date": 1565082927, "last_edit_date": 1565088748, "question_id": 57372739, "link": "https://stackoverflow.com/questions/57372739/re-ordering-hash-items-to-have-some-appear-at-the-end", "title": "Re-ordering hash items to have some appear at the end", "body": "<p>I'm returning a hash of form inputs, which at the moment looks like:</p>\n\n<pre><code>hash = {\n \"body\"=&gt;:text,\n \"button_text\"=&gt;:string,\n \"category\"=&gt;:integer,\n \"dashboard\"=&gt;:boolean,\n \"feature\"=&gt;:integer,\n \"featured_from\"=&gt;:datetime,\n \"featured_to\"=&gt;:datetime,\n \"global\"=&gt;:boolean,\n \"hyperlink\"=&gt;:string,\n \"jobs\"=&gt;:boolean,\n \"labs\"=&gt;:boolean,\n \"leaderboard\"=&gt;:boolean,\n \"management\"=&gt;:boolean,\n \"news\"=&gt;:boolean,\n \"objectives\"=&gt;:boolean,\n \"only_for_enterprise_users\"=&gt;:boolean,\n \"published_at\"=&gt;:datetime,\n \"title\"=&gt;:string,\n \"workflow_state\"=&gt;:string\n}\n</code></pre>\n\n<p>I need to place the following keys at the end:</p>\n\n<pre><code>[\"dashboard\", \"jobs\", \"labs\", \"management\", \"news\", \"objectives\", \"global\"]\n</code></pre>\n\n<p>Which will leave me with:</p>\n\n<pre><code>{\n \"body\"=&gt;:text,\n \"button_text\"=&gt;:string,\n \"category\"=&gt;:integer,\n \"feature\"=&gt;:integer,\n \"featured_from\"=&gt;:datetime,\n \"featured_to\"=&gt;:datetime,\n \"hyperlink\"=&gt;:string,\n \"only_for_enterprise_users\"=&gt;:boolean,\n \"published_at\"=&gt;:datetime,\n \"title\"=&gt;:string,\n \"workflow_state\"=&gt;:string,\n \"dashboard\"=&gt;:boolean,\n \"jobs\"=&gt;:boolean,\n \"labs\"=&gt;:boolean,\n \"leaderboard\"=&gt;:boolean,\n \"management\"=&gt;:boolean,\n \"news\"=&gt;:boolean,\n \"objectives\"=&gt;:boolean,\n \"global\"=&gt;:boolean\n}\n</code></pre>\n\n<p>All the links I've found relate to transforming keys / values without re-ordering, and outside of manually deleting each key and then reinserting I can't see another way of getting my desired output.</p>\n\n<p>Is there an easy way to achieve what I need? </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "session", "devise"], "comments": [{"owner": {"reputation": 653, "user_id": 8036445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb5ed1c3c2b3b03d10f179fb8f4078c?s=128&d=identicon&r=PG", "display_name": "Velusamy Venkatraman", "link": "https://stackoverflow.com/users/8036445/velusamy-venkatraman"}, "edited": false, "score": 0, "creation_date": 1565080350, "post_id": 57371369, "comment_id": 101228873, "body": "Set time in that session. if it valid means use it else remove it.."}, {"owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "reply_to_user": {"reputation": 653, "user_id": 8036445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb5ed1c3c2b3b03d10f179fb8f4078c?s=128&d=identicon&r=PG", "display_name": "Velusamy Venkatraman", "link": "https://stackoverflow.com/users/8036445/velusamy-venkatraman"}, "edited": false, "score": 0, "creation_date": 1565080462, "post_id": 57371369, "comment_id": 101228924, "body": "@VelusamyVenkatraman Time in session for variable, right? How can i do this?"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 1, "creation_date": 1565086230, "post_id": 57371369, "comment_id": 101232107, "body": "Let&#39;s admit that you want to store a value and reuse it later with an expiration verification. You can store a hash in the session like this : <code>session[:my_key] = { value: &#39;whatever&#39;, time: Time.current }</code> then when you will want to check if it&#39;s valid you will be able to do something like <code>session.dig(:my_key, :time) &gt; 15.seconds.ago ? what_you_want : session.delete(:my_key)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": true, "score": 2, "last_activity_date": 1565150887, "creation_date": 1565150887, "answer_id": 57386812, "question_id": 57371369, "link": "https://stackoverflow.com/questions/57371369/session-variable-rails/57386812#57386812", "title": "Session variable Rails", "body": "<p>By default, Rails will use <code>CookieStore</code> to store the session. This means all of sessions data will be stored in the cookie at the Client side. And, by this way, you can do sth like</p>\n\n<pre><code>session['your_key'] = 'Session Content'\nsession['your_key_expired_at'] = Time.current + 15.minutes\n</code></pre>\n\n<p>Then, later (for ex: <code>authenticate_user</code>), you can check</p>\n\n<pre><code>if session['your_key_expired_at'] &lt; Time.current\n   session.delete('your_key')\nend\n</code></pre>\n\n<p>If you want the data still available after user closes the app, you can use <code>Cookies</code>, as below</p>\n\n<pre><code>cookies[:your_key] = {:value =&gt; \"session stuff\"}, :expires =&gt; 15.minutes.from_now}\n</code></pre>\n\n<p>You can use <code>signed cookies</code> to encrypt your cookies with the apps secret_token, as using <code>session</code></p>\n\n<pre><code>cookies.signed[:login] = {:value =&gt; @user.id, :expires =&gt; 1.day.from_now}\n</code></pre>\n\n<p>Another option, in order to make it more secure, you can use <code>ActiveRecordStore</code> to manage and store session. You just pass the session id to your client, and you can easily manage your session at sever side because you know its <code>created_at</code></p>\n"}], "owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 57386812, "answer_count": 1, "score": 1, "last_activity_date": 1565150887, "creation_date": 1565078093, "question_id": 57371369, "link": "https://stackoverflow.com/questions/57371369/session-variable-rails", "title": "Session variable Rails", "body": "<p>How do I store a session variable for a specific time?</p>\n\n<p>Or how to reset a variable after a certain time?</p>\n\n<p>I need to use <code>session.delete ('my_key')</code> 15 seconds after the event.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 3, "creation_date": 1565074625, "post_id": 57370055, "comment_id": 101226138, "body": "I think the default starting value is the first element of the array. You can&#39;t specify default values of 0 or 1, otherwise  <code>[].reduce(:+)</code> and <code>[].reduce(:*)</code> wouldn&#39;t return nil (as they do, you can check in irb)"}, {"owner": {"reputation": 93, "user_id": 10670615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85af9be695c67f862896c21e62dfe6c6?s=128&d=identicon&r=PG&f=1", "display_name": "LiMi", "link": "https://stackoverflow.com/users/10670615/limi"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1565076470, "post_id": 57370055, "comment_id": 101227022, "body": "@maxpleaner it worked! In case there is no initial value, I set the first value of accumulator as initial and iterate through the tail of array."}, {"owner": {"reputation": 93, "user_id": 10670615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85af9be695c67f862896c21e62dfe6c6?s=128&d=identicon&r=PG&f=1", "display_name": "LiMi", "link": "https://stackoverflow.com/users/10670615/limi"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1565076914, "post_id": 57370055, "comment_id": 101227260, "body": "@maxpleaner Please post your comment as an answer"}, {"owner": {"reputation": 93, "user_id": 10670615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85af9be695c67f862896c21e62dfe6c6?s=128&d=identicon&r=PG&f=1", "display_name": "LiMi", "link": "https://stackoverflow.com/users/10670615/limi"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1565079503, "post_id": 57370055, "comment_id": 101228466, "body": "sorry, I meant &quot;I set the first value of array&quot; not accumulator"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1565084048, "post_id": 57370055, "comment_id": 101230886, "body": "<i>&quot;checking operation in the block&quot;</i> \u2013 the block argument is basically a black box. You can&#39;t determine what&#39;s going on inside. It&#39;s implementation might be as simple as <code>{ |a, b| a * b }</code>, but it could also be much more complex. Setting the initial value to <code>1</code> just because <code>yield(3, 2)</code> returns <code>6</code> is very brittle."}, {"owner": {"reputation": 93, "user_id": 10670615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85af9be695c67f862896c21e62dfe6c6?s=128&d=identicon&r=PG&f=1", "display_name": "LiMi", "link": "https://stackoverflow.com/users/10670615/limi"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1565093104, "post_id": 57370055, "comment_id": 101235732, "body": "@Stefan yeah, I realise that now"}], "answers": [{"comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1565093798, "post_id": 57371910, "comment_id": 101236138, "body": "With your <code>my_reduce</code> method, you always just return the first element of the array (or the given accumulator) and throw away all of the later computation. The method only has any effect at all if the block mutates the accumulator (which it can&#39;t with e.g. integers). However, it definitely doesn&#39;t implement <code>Enumerable#reduce</code>."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1565110534, "post_id": 57371910, "comment_id": 101245970, "body": "Lol thanks for the comments. Yall right I messed up there. Just deleted all that"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 0, "last_activity_date": 1565110512, "last_edit_date": 1565110512, "creation_date": 1565080210, "answer_id": 57371910, "question_id": 57370055, "link": "https://stackoverflow.com/questions/57370055/an-elegant-way-to-check-the-block-operation/57371910#57371910", "title": "An elegant way to check the block operation?", "body": "<p>The default starting item of reduce is the first element in the array/enumerable.</p>\n\n<p>If you special cased <code>+</code> and <code>*</code> to have default starting values of 0 and 1 respectively (not sure how you would do this, anyway), then <code>[].reduce(&amp;:+)</code> and <code>[].reduce(&amp;:*)</code> would also return 0 and 1 respectively. However, if you try in irb you will see that both expressions return nil.</p>\n"}, {"tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": false, "score": 1, "last_activity_date": 1565183111, "creation_date": 1565183111, "answer_id": 57395190, "question_id": 57370055, "link": "https://stackoverflow.com/questions/57370055/an-elegant-way-to-check-the-block-operation/57395190#57395190", "title": "An elegant way to check the block operation?", "body": "<p>A simplified version of <code>inject</code> / <code>reduce</code> could look like this:</p>\n\n<pre><code># A special undefined value which is the only value which\n# can not be used in the Enumerable or as a memo. See below\n# for considerations\nUNDEFINED=Object.new\n\ndef inject(memo=UNDEFINED)\n  each do |element|\n    # If we didn't get an initial value, we use the first element\n    # but it won't be yielded in its own.\n    if UNDEFINED.equal?(memo)\n      memo = element\n      next\n    end\n\n    # In the first each loop (if we got an explicit memo) or\n    # in the second loop (if we didn't), we pass both value\n    # to the provided block and use the returned value as\n    # the new memo\n    memo = yield(memo, element)\n  end\n\n  # If the memo is still UNDEFINED here, it means that the `each`\n  # method above has not yielded any value, most likely because\n  # `self` is an empty enumerable (such as an empty Array or Hash).\n  # In that case, we return `nil`.\n  UNDEFINED.equal?(memo) ? nil : memo\nend\n</code></pre>\n\n<p>This method was adapted from <a href=\"https://github.com/rubinius/rubinius/blob/v4.5/core/enumerable.rb#L370-L403\" rel=\"nofollow noreferrer\">the implementation in Rubinius</a> where they use a similar approach.</p>\n\n<p>Compared to the method available on the Enumerable module, this one has a few restrictions. Most importantly, it doesn't support to pass the operator as a symbol instead of a block. With the Ruby's version, you could e.g. run <code>[1,2,3].inject(:+)</code> and get <code>6</code> back.</p>\n\n<p>In the code above, please note the technique to detect wether the user passed an argument. This is required since any value the user could explicitly pass (including <code>nil</code>) would be a valid value for the <code>memo</code> and would thus change the flow. As such, we have to specifically detect whether the user passed an argument at all (with any possible value), compared to the default case where they didn't pass an argument.</p>\n\n<p>In MRI (the \"default\" Ruby implementation), they use a different technique in the C code as they count the number of passed arguments directly. You can learn more about these techniques on my blog at <a href=\"https://holgerjust.de/2016/detecting-default-arguments-in-ruby/\" rel=\"nofollow noreferrer\">https://holgerjust.de/2016/detecting-default-arguments-in-ruby/</a></p>\n"}], "owner": {"reputation": 93, "user_id": 10670615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85af9be695c67f862896c21e62dfe6c6?s=128&d=identicon&r=PG&f=1", "display_name": "LiMi", "link": "https://stackoverflow.com/users/10670615/limi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 57371910, "answer_count": 2, "score": 0, "last_activity_date": 1565183111, "creation_date": 1565072742, "last_edit_date": 1565093320, "question_id": 57370055, "link": "https://stackoverflow.com/questions/57370055/an-elegant-way-to-check-the-block-operation", "title": "An elegant way to check the block operation?", "body": "<p>I'm writing my own <code>each</code> and <code>reduce</code> functions. The reduce function receives the initial value of accumulator and a block applied to each element. The tests I must pass, however, have assertions without specifying the accumulator, it means that it must be set by default. The problem is that for multiplication the accumulator's initial value must be equal '1' and for addition - '0'.</p>\n\n<p>My tests check the following:</p>\n\n<pre><code>func = -&gt; (acc, element) { acc * element }\n\narray.my_reduce(&amp;func) \narray.my_reduce(2, &amp;func)\n</code></pre>\n\n<p>and also addition:</p>\n\n<pre><code>array.my_reduce(&amp;:+)\n</code></pre>\n\n<p>I couldn't find a better way than doing it with hard-coded values:</p>\n\n<pre><code>def my_reduce(acc = 0)\n  acc += 1 if yield(3, 2) == 3 * 2 &amp;&amp; acc == 0\n  my_each { |el| acc = yield(acc, el) }\n  acc\nend\n</code></pre>\n\n<p>Is there a more elegant way of checking operation in the block or setting the accumulator's initial value conditionally?</p>\n\n<p>Update:\nAs @maxpleaner suggested, I used the first array item as the initial accumulator value, iterating the tail of the array. Now it looks like this:</p>\n\n<pre><code>def my_reduce(initial = nil)\n  acc = initial.nil? ? self[0] : initial\n  tail = initial.nil? ? self[1..(length - 1)] : self\n  tail.my_each { |el| acc = yield(acc, el) }\n  acc\nend\n</code></pre>\n"}, {"tags": ["ruby", "object", "file-upload", "carrierwave"], "owner": {"reputation": 83, "user_id": 5399092, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10207291762148616/picture?type=large", "display_name": "Helen_M", "link": "https://stackoverflow.com/users/5399092/helen-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565066859, "creation_date": 1565066022, "last_edit_date": 1565066859, "question_id": 57368985, "link": "https://stackoverflow.com/questions/57368985/carrierwave-object-update-with-existing-file-url", "title": "CarrierWave object update with existing file url", "body": "<p>I'm using <strong>CarrierWave</strong> for file upload in my project. At the beginning of the implementation process, we've made a mistake and eventually a bunch of objects been uploaded to s3 with minor file naming issues. This was fixed shortly for new uploads.\nNow we need to fix all this (let's say thousands) CarierWave/s3 objects broken paths. \nIs there any good way to change CarrierWave object with no reuploading? \nThe part with s3 path update is already done, all I need to do is to change CarrierWave object.</p>\n\n<p>Tried:</p>\n\n<pre><code>img.update(...)\nimg.raw_attributes_update(...)\n  ...\nimg.file=...\n(with further internal updates to define 'skip' upload var)\n</code></pre>\n\n<blockquote>\n  <p>Note: re-uploading of all the images is our worst scenario, which I\n  really want to avoid.</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "edited": false, "score": 0, "creation_date": 1565068032, "post_id": 57368757, "comment_id": 101223866, "body": "Have you added this method in <code>before_action</code>?"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "edited": false, "score": 0, "creation_date": 1565068468, "post_id": 57368757, "comment_id": 101223997, "body": "Yes, and I&#39;m 100% positive it&#39;s executing because the pragma header is set only when I call the function with before_action."}, {"owner": {"reputation": 671, "user_id": 3445936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cd8z6.jpg?s=128&g=1", "display_name": "Rohit Lingayat", "link": "https://stackoverflow.com/users/3445936/rohit-lingayat"}, "edited": false, "score": 0, "creation_date": 1565075518, "post_id": 57368757, "comment_id": 101226564, "body": "@CannonMoyer you must try this <code>response.set_header(&quot;Header-Name&quot;, &quot;Header value&quot;)</code>"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565064132, "creation_date": 1565064132, "question_id": 57368757, "link": "https://stackoverflow.com/questions/57368757/cannot-set-http-headers", "title": "Cannot Set HTTP Headers", "body": "<p>I am running Rails 5.2.2 in development mode (have the same problem in production too) and I'm trying to prevent some pages from caching. In my <code>application_controller.rb</code> file I have the following code </p>\n\n<pre><code>def \n  response.headers[\"Cache-Control\"] = \"no-cache, no-store, max-age=0, must-revalidate\"\n  response.headers[\"Pragma\"] = \"no-cache\"\n  response.headers[\"Expires\"] = \"Fri, 01 Jan 1990 00:00:00 GMT\"\nend\n</code></pre>\n\n<p>This code above produces the following Cache-Control header in Chrome &amp; Firefox.</p>\n\n<pre><code>Cache-Control: no-cache, no-store\n</code></pre>\n\n<p>What am I doing wrong that prevents the Cache-Control header from being set to the value I provided in my code?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "ibm-watson"], "comments": [{"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 1, "creation_date": 1565060719, "post_id": 57368345, "comment_id": 101222356, "body": "Please include the complete stack trace"}, {"owner": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "edited": false, "score": 0, "creation_date": 1565106687, "post_id": 57368345, "comment_id": 101244152, "body": "What is the params that you&#39;re passing to this method?"}], "owner": {"reputation": 49, "user_id": 9220180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91608bfb773fa82da320d390aa980a1a?s=128&d=identicon&r=PG&f=1", "display_name": "thelacaning", "link": "https://stackoverflow.com/users/9220180/thelacaning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565060461, "creation_date": 1565060461, "question_id": 57368345, "link": "https://stackoverflow.com/questions/57368345/watson-api-request-returns-exception-nomethoderror-undefined-method-f", "title": "Watson API request returns &quot;exception&quot;: &quot;#&lt;NoMethodError: undefined method `+&#39; for nil:NilClass&gt;&quot;,", "body": "<p>When I use postman to bounce the call off of my API it returns the error</p>\n\n<p>\"exception\": \"#\",</p>\n\n<p>I don't understand why I am getting this error at all, so I haven't really tried anything. </p>\n\n<p>class NluCallsController &lt; ApplicationController\n    include IBMWatson\n    require \"json\"\n    require \"ibm_watson/natural_language_understanding_v1\"\n    include DeriveText</p>\n\n<pre><code>def create\n    @nlu_call = NluCall.new\n    @nlu_call.url = params[:url]\n\n    r = IBMWatson::NaturalLanguageUnderstandingV1.new(\n        version: \"2018-11-16\",\n        iam_apikey: ENV[\"NATURAL_LANGUAGE_UNDERSTANDING_IAM_APIKEY\"],\n        url: ENV[\"NATURAL_LANGUAGE_UNDERSTANDING_URL\"]\n    ).analyze(\n        url: @nlu_call.url,\n        features: {concepts: {limit:5}}\n    )\n    @nlu_call.response = r\n\n    if @nlu_call.save!\n        respond_to do |format|\n            format.json @nlu_call.response\n        end\n    end\nend\n</code></pre>\n\n<p>end</p>\n\n<p>It should return a JSON object with the categories analyzed from the URL it is given. Instead it returns:\n<code>NoMethodError (undefined method</code>+' for nil:NilClass):<code>\nbecause of this line:\n</code>).analyze(`</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "is_accepted": false, "score": 2, "last_activity_date": 1565058926, "creation_date": 1565058926, "answer_id": 57368194, "question_id": 57368122, "link": "https://stackoverflow.com/questions/57368122/last-element-of-the-ruby-array-is-nil/57368194#57368194", "title": "Last element of the ruby array is nil", "body": "<p>Thats because when you do <code>Array.new(numStocks.to_i)</code> it initializes an array with 3 nil values and you keep adding on to it, </p>\n\n<p>the proper way to get rid of <code>nil</code> from array is to use <code>.compact</code> on the array but I suggest you change your logic,</p>\n\n<p>maybe something like this</p>\n\n<pre><code>puts(\"How many stocks do you want to track ?\")\nnumStocks = gets.chomp()\nputs(\"Please enter #{numStocks} stock symbols: \")\n\narray = Array.new() # or array = []\nnumStocks.to_i.times do\n  array &lt;&lt; gets.chomp()\nend\n\nputs(\"Stock symbols entered ... #{array}\")\n</code></pre>\n\n<p>or you could ask the user to enter the comma separated symbols, so you don't have to loop, and split them,</p>\n\n<pre><code>puts(\"Please enter #{numStocks} stock symbols separated by commas (a,b): \")\nsymbols = gets.chomp().split(',')\nputs(\"Stock symbols entered ... #{array}\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "reply_to_user": {"reputation": 13337, "user_id": 775936, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/52fa9069824aa7f202cecbb4daf4fe93?s=128&d=identicon&r=PG", "display_name": "Ashish Agarwal", "link": "https://stackoverflow.com/users/775936/ashish-agarwal"}, "edited": false, "score": 0, "creation_date": 1565060737, "post_id": 57368205, "comment_id": 101222360, "body": "I just updated my answer with a little more info as well. Glad I could help!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1565079182, "post_id": 57368205, "comment_id": 101228323, "body": "<code>Array.new(num_stocks.to_i) { gets.chomp }</code> would also work."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565097593, "post_id": 57368205, "comment_id": 101238466, "body": "As a note this statement is untrue <i>&quot;Array.new(2, &#39;a&#39;) is the same as [&#39;a&#39;, &#39;a&#39;].&quot;</i>. In <code>Array.new(2, &#39;a&#39;)</code> both elements in the <code>Array</code> are the same object as proven by <code>b = Array.new(2, &#39;a&#39;); b[1] &lt;&lt; &#39;h&#39;; b #=&gt; [&quot;ah&quot;,&quot;ah&quot;]</code>; however in <code>[&#39;a&#39;,&#39;a&#39;]</code> each element is a distinct object that simply happens to have a equal value and representation, and thus <code>b = [&#39;a&#39;,&#39;a&#39;]; b[1] &lt;&lt; &#39;h&#39;; b #=&gt; [&quot;a&quot;, &quot;ah&quot;]</code>"}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565097718, "post_id": 57368205, "comment_id": 101238551, "body": "That\u2019s an excellent point @engineersmnky. I\u2019m so used to frozen string literals nowadays. (Rubocop never lets me forget the magic comment.)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565097820, "post_id": 57368205, "comment_id": 101238601, "body": "@Nate literal strings is merely a simple example as opposed to <code>Array.new(4, MyObject.new)</code> or even <code>Array.new(4,String.new(&#39;a&#39;))</code>"}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 1, "creation_date": 1565098002, "post_id": 57368205, "comment_id": 101238730, "body": "Right. Point being, Array.new passes the same object instance into all indices, where a literal would be separate instances unless I used a variable. Such as <code>val = &#39;a&#39;; array = [val, val]</code>"}], "tags": [], "owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "is_accepted": true, "score": 2, "last_activity_date": 1565060945, "last_edit_date": 1565060945, "creation_date": 1565059037, "answer_id": 57368205, "question_id": 57368122, "link": "https://stackoverflow.com/questions/57368122/last-element-of-the-ruby-array-is-nil/57368205#57368205", "title": "Last element of the ruby array is nil", "body": "<p><code>Array.new</code> creates a new array, filling it with the quantity of elements you specified. <code>Array.new(3)</code> is the same as <code>[nil, nil, nil]</code>. <code>Array.new(2, 'a')</code> is the same as <code>['a', 'a']</code>.</p>\n\n<p>You then use <code>array.insert</code> which adds instead of replaces the elements. You could use <code>array[i-1] = gets.chomp()</code> to set the values, but there's really no reason to initialize the array this way at all.</p>\n\n<p>A \"more Ruby\" way to write this all would be:</p>\n\n<pre><code>puts 'How many stocks do you want to track ?'\nnum_stocks = gets.chomp\nputs \"Please enter #{num_stocks} stock symbols: \"\n\narray = 1.upto(num_stocks.to_i).map do\n  gets.chomp\nend\n\nputs \"Stock symbols entered ... #{array}\"\n</code></pre>\n\n<p>EDIT:\nAlso, it\u2019s worth mentioning that in Ruby, arrays are not a fixed size. You can add and remove elements from them as you please. If I had to guess, you\u2019re used to languages like C, where you have to define the size of your array up front and then it\u2019s just that size forever (that\u2019s what I\u2019m guessing you were trying to do anyways).</p>\n\n<p>And another thing, in Ruby it\u2019s not very common to use <code>Array.new</code>. Most times people just define an array by typing an array literal.</p>\n\n<pre><code>array = [1,2,3]\n</code></pre>\n\n<p>A ruby array is more like a List in other languages. It supports <code>push</code> (though <code>&lt;&lt;</code> is a more common method for adding to an array), <code>pop</code>, and other list-like features. </p>\n"}], "owner": {"reputation": 13337, "user_id": 775936, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/52fa9069824aa7f202cecbb4daf4fe93?s=128&d=identicon&r=PG", "display_name": "Ashish Agarwal", "link": "https://stackoverflow.com/users/775936/ashish-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 57368205, "answer_count": 2, "score": 2, "last_activity_date": 1565060945, "creation_date": 1565058317, "question_id": 57368122, "link": "https://stackoverflow.com/questions/57368122/last-element-of-the-ruby-array-is-nil", "title": "Last element of the ruby array is nil", "body": "<p>I have a simple ruby program that has 2 steps so far\n1. Ask the user for the number of stock market symbols they want to track\n2. Ask the user to input these symbols </p>\n\n<pre><code>puts(\"How many stocks do you want to track ?\")\nnumStocks = gets.chomp()\nputs(\"Please enter #{numStocks} stock symbols: \")\n\narray = Array.new(numStocks.to_i)\nfor i in 1..numStocks.to_i do \n    array.insert(i-1, gets.chomp())\nend\n\nputs(\"Stock symbols entered ... #{array}\")\n</code></pre>\n\n<p>The output that is printed onto the console is \n<code>Stock symbols entered ... [\"aapl\", nil]</code> </p>\n\n<p>Why is the last element of the array <code>nil</code> in this case and what's the proper way to get rid of it ?</p>\n"}, {"tags": ["ruby", "tomcat", "rspec", "serverspec"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 9745095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I2xHEkOekJE/AAAAAAAAAAI/AAAAAAAAAGg/RFSs2_ehcy0/photo.jpg?sz=128", "display_name": "Sunil Cyriac", "link": "https://stackoverflow.com/users/9745095/sunil-cyriac"}, "edited": false, "score": 2, "creation_date": 1565070250, "post_id": 57368856, "comment_id": 101224491, "body": "Thanks @Alex . Yes you are right. I was having the same problem so I was using the directory tests. Just wanted to see if there was any alternate way using rspec-serverspec. Thanks for the links I will have a look at those now."}], "tags": [], "owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "is_accepted": true, "score": 2, "last_activity_date": 1565064953, "creation_date": 1565064953, "answer_id": 57368856, "question_id": 57367848, "link": "https://stackoverflow.com/questions/57367848/is-there-a-way-to-test-whether-a-particular-version-of-java-or-tomcat-is-install/57368856#57368856", "title": "Is there a way to test whether a particular version of java or tomcat is installed during deployment using rspec-serverspec?", "body": "<p>There are related questions on how to check the versions of these applications here at Stack Overflow:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/14925073/how-to-find-out-running-tomcat-version\">Tomcat</a></li>\n<li><a href=\"https://stackoverflow.com/questions/47627270/how-to-check-java-version-at-linux-redhat6\">Java</a></li>\n</ul>\n\n<p>But the problem you may have is that for Serverspec to run the Java command (needed in both), you may need to already know the path to the Java command, which depends on the version of Java and/or Tomcat.</p>\n\n<p>For this reason, use of the directory, as you are already doing, is most probably the simplest solution.</p>\n\n<p>(And it is also what I do, e.g. in this project <a href=\"https://github.com/alexharv074/elk/blob/7c9dd82c2c46b4813d19026e049ebdd5d0a50471/spec/acceptance/role_elk_stack_spec.rb#L225-L227\" rel=\"nofollow noreferrer\">here</a>.)</p>\n"}], "owner": {"reputation": 171, "user_id": 9745095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I2xHEkOekJE/AAAAAAAAAAI/AAAAAAAAAGg/RFSs2_ehcy0/photo.jpg?sz=128", "display_name": "Sunil Cyriac", "link": "https://stackoverflow.com/users/9745095/sunil-cyriac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 57368856, "answer_count": 1, "score": 2, "last_activity_date": 1565064953, "creation_date": 1565055492, "last_edit_date": 1592644375, "question_id": 57367848, "link": "https://stackoverflow.com/questions/57367848/is-there-a-way-to-test-whether-a-particular-version-of-java-or-tomcat-is-install", "title": "Is there a way to test whether a particular version of java or tomcat is installed during deployment using rspec-serverspec?", "body": "<p>I have an environment built by using puppet.\nI was planning to write some rspec-ruby script that can be executed once the puppet build is complete to test whether all the directories, packages, users and roles are created.</p>\n<blockquote>\n<p>What I would like is to test using rspec whether the particular version of Java and Tomcat (ex for tomcat: 9.0.17) is installed during the puppet build.</p>\n<p>What I was doing so far was to test whether the directory is present for tomcat or java by including their version number in the directory name as well like the following:</p>\n</blockquote>\n<pre><code>describe file('/opt/tomcat/9.0.17') do\n  it { should be_directory }\nend\n</code></pre>\n<p>Is there any other way apart from this?\nOr like the way we test for the package installation?</p>\n"}, {"tags": ["ruby", "google-chrome", "jenkins", "open-uri"], "comments": [{"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1565060475, "post_id": 57367814, "comment_id": 101222311, "body": "Your program makes two HTTP requests, a GET then a POST. Which of these two requests receives the 400 response? Please include more of the stack trace."}, {"owner": {"reputation": 353, "user_id": 10641015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rb6K-6eC5TI/AAAAAAAAAAI/AAAAAAAAAGw/E-daD0VOiz0/photo.jpg?sz=128", "display_name": "jadejoe", "link": "https://stackoverflow.com/users/10641015/jadejoe"}, "reply_to_user": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1565102295, "post_id": 57367814, "comment_id": 101241602, "body": "thanks comment,  I add error occur line please look code this program post keyword later get value   It seems that this error occurred during post  thanks"}, {"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1565191249, "post_id": 57367814, "comment_id": 101276905, "body": "Try to <code>rescue</code> the <code>OpenURI::HTTPError</code> and <code>inspect</code> the error to see if it has any more information."}, {"owner": {"reputation": 353, "user_id": 10641015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rb6K-6eC5TI/AAAAAAAAAAI/AAAAAAAAAGw/E-daD0VOiz0/photo.jpg?sz=128", "display_name": "jadejoe", "link": "https://stackoverflow.com/users/10641015/jadejoe"}, "reply_to_user": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1566096891, "post_id": 57367814, "comment_id": 101546725, "body": "sorry i misstake select code. change problem code show you"}], "owner": {"reputation": 353, "user_id": 10641015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rb6K-6eC5TI/AAAAAAAAAAI/AAAAAAAAAGw/E-daD0VOiz0/photo.jpg?sz=128", "display_name": "jadejoe", "link": "https://stackoverflow.com/users/10641015/jadejoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1566096743, "creation_date": 1565055103, "last_edit_date": 1566096743, "question_id": 57367814, "link": "https://stackoverflow.com/questions/57367814/why-does-google-co-jp-respond-with-400-bad-request", "title": "Why does google.co.jp respond with 400 Bad Request?", "body": "<p>using build ruby program for jenkins</p>\n\n<p>The content of the program is to access google</p>\n\n<p>I have this title problem error</p>\n\n<p>Here is mycode</p>\n\n<pre><code>file.each do |line|\n    keyword = line.chomp\n    base_url = 'http://www.google.com/complete/search?h1=ja&amp;output=toolbar'\n    url = \"#{base_url}&amp;q=#{keyword}\"\n    doc = REXML::Document.new(open(url).read.encode(\"UTF-8\"))\n    doc.elements.each('toplevel/CompleteSuggestion/suggestion') do |value|\n</code></pre>\n\n<p>If you want other code information, add it</p>\n\n<p>Thank you</p>\n\n<p>add</p>\n\n<p>Post full error text</p>\n\n<pre><code>/var/lib/jenkins/.rbenv/versions/2.5.1/lib/ruby/2.5.0/open-uri.rb:377:in `open_http': 400 Bad Request (OpenURI::HTTPError)\n    from /var/lib/jenkins/.rbenv/versions/2.5.1/lib/ruby/2.5.0/open-uri.rb:755:in `buffer_open'\n    from /var/lib/jenkins/.rbenv/versions/2.5.1/lib/ruby/2.5.0/open-uri.rb:226:in `block in open_loop'\n    from /var/lib/jenkins/.rbenv/versions/2.5.1/lib/ruby/2.5.0/open-uri.rb:224:in `catch'\n    from /var/lib/jenkins/.rbenv/versions/2.5.1/lib/ruby/2.5.0/open-uri.rb:224:in `open_loop'\n    from /var/lib/jenkins/.rbenv/versions/2.5.1/lib/ruby/2.5.0/open-uri.rb:165:in `open_uri'\n    from /var/lib/jenkins/.rbenv/versions/2.5.1/lib/ruby/2.5.0/open-uri.rb:735:in `open'\n    from /var/lib/jenkins/.rbenv/versions/2.5.1/lib/ruby/2.5.0/open-uri.rb:35:in `open'\n    from suggest-word.rb:17:in `block (2 levels) in &lt;main&gt;'\n    from suggest-word.rb:13:in `each'\n    from suggest-word.rb:13:in `block in &lt;main&gt;'\n    from suggest-word.rb:12:in `open'\n    from suggest-word.rb:12:in `&lt;main&gt;'\nBuild step 'Execute shell' marked build as failure\nArchiving artifacts\nFinished: FAILURE\n</code></pre>\n\n<p>The corresponding 17th line is this implementation</p>\n\n<pre><code>doc = REXML::Document.new(open(url).read.encode(\"UTF-8\"))\n</code></pre>\n\n<p>It works fine in the local environment for reference</p>\n"}, {"tags": ["ruby", "linux", "chef-infra", "redhat"], "answers": [{"tags": [], "owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "is_accepted": false, "score": 0, "last_activity_date": 1565070853, "creation_date": 1565070853, "answer_id": 57369687, "question_id": 57367687, "link": "https://stackoverflow.com/questions/57367687/chef-recipe-sssd-configuration/57369687#57369687", "title": "Chef Recipe, sssd configuration", "body": "<p>you did not specify which chef version are you using since there is <a href=\"https://docs.chef.io/deprecations_attributes.html\" rel=\"nofollow noreferrer\">a deprecation of methods of setting\\reading the node attribute</a>.</p>\n\n<p>try to use <code>node.default</code>, rather then <code>default</code>.</p>\n\n<p>setting a node attribute in a recipe is usually done because of the value is only known at chef-client convergance phase. if that is not the case, consider moving the node attribute to an attribute file.</p>\n\n<p>note that i am using this cookbook and i have no issue with it.</p>\n"}], "owner": {"reputation": 21, "user_id": 11838623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2e3864425ea51cab88314208115c0c?s=128&d=identicon&r=PG&f=1", "display_name": "ZMan007", "link": "https://stackoverflow.com/users/11838623/zman007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565070853, "creation_date": 1565053558, "last_edit_date": 1565055879, "question_id": 57367687, "link": "https://stackoverflow.com/questions/57367687/chef-recipe-sssd-configuration", "title": "Chef Recipe, sssd configuration", "body": "<p>I am trying to get a recipe to work in Chef.  However, it is failing...</p>\n\n<p>I can use \"default\" in an attribute, but I can't use it in a recipe, and for some reason, it's squawking...  Looking to see if someone might know what I'm doing wrong here... any help would be awesome, thank you!</p>\n\n<p>I edited the names of the cookbooks/recipe's/groups to keep my code anonymous.</p>\n\n<pre><code>default['sssd']['simple']['allow_groups'] = 'GroupName' if node.chef_environment == 'production'\ndefault['sssd']['simple']['allow_groups'] = 'GroupName' unless node.chef_environment == 'test'\n</code></pre>\n\n<h2>NameError</h2>\n\n<pre><code>undefined local variable or method `default' for cookbook: COOKBOOK_NAME, recipe: RECIPE:NAME :Chef::Recipe\n</code></pre>\n\n<h2>Cookbook Trace:</h2>\n\n<pre><code>/var/chef/cache/cookbooks/COOKBOOK_NAME/recipes/RECIPE_NAME.rb:4:in `from_file'\n</code></pre>\n\n<h2>Relevant File Content:</h2>\n\n<p><code>/var/chef/cache/cookbooks/COOKBOOK_NAME/recipes/RECIPE_NAME.rb</code>:</p>\n\n<pre><code> 1:  # Comments\n 2:\n 3:  default['sssd']['simple']['allow_groups'] = 'GROUP_NAME' if node.chef_environment == 'production'\n 4&gt;&gt; default['sssd']['simple']['allow_groups'] = 'GROUP_NAME' unless node.chef_environment == 'production'\n 5:\n 6:  if node.chef_environment == 'production'\n 7:    sudo 'sudoers_file' do\n 8:      group '%GROUP_NAME'\n 9:    end\n10:  else\n11:    sudo 'sudoers_file' do\n12:      group '%GROUP_NAME'\n13:    end\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1565062489, "post_id": 57367002, "comment_id": 101222665, "body": "Are you getting the output you want? If not, can you show the desired output?"}, {"owner": {"reputation": 5, "user_id": 11843356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97322b341111990382b02a7c965973aa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/11843356/abhishek"}, "reply_to_user": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1565067932, "post_id": 57367002, "comment_id": 101223842, "body": "Yes I&#39;m getting correct output. I just wanted to implement it in another way."}, {"owner": {"reputation": 5, "user_id": 11843356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97322b341111990382b02a7c965973aa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/11843356/abhishek"}, "reply_to_user": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1565067940, "post_id": 57367002, "comment_id": 101223844, "body": "Name of the product: egg Imported?: y Exempted from sales tax? n Price: 56 Do you want to add more items to your list(y/n): n | name | imported | exempted | price | price including tax  |  egg |        y |        n |  56.0 |                56.0"}, {"owner": {"reputation": 5, "user_id": 11843356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97322b341111990382b02a7c965973aa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/11843356/abhishek"}, "reply_to_user": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1565068026, "post_id": 57367002, "comment_id": 101223864, "body": "Above is the sequence of questions asked from user and then based on them final list get displayed."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11843356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97322b341111990382b02a7c965973aa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/11843356/abhishek"}, "edited": false, "score": 0, "creation_date": 1565115774, "post_id": 57369915, "comment_id": 101248196, "body": "Awesome.. thanks a lot, with few adjustments it worked."}, {"owner": {"reputation": 5, "user_id": 11843356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97322b341111990382b02a7c965973aa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/11843356/abhishek"}, "edited": false, "score": 0, "creation_date": 1565116148, "post_id": 57369915, "comment_id": 101248345, "body": "One small request, Can you please also explain a bit how below code works ?            row_string += &#39;| &#39; + sprintf(&quot;%#{ key.size }s&quot;, value) + &#39; &#39;                           Specifically key.size"}, {"owner": {"reputation": 51, "user_id": 4219131, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ll5S2_aOLwk/AAAAAAAAAAI/AAAAAAAADEQ/3SZDqxHXY24/photo.jpg?sz=128", "display_name": "dismir", "link": "https://stackoverflow.com/users/4219131/dismir"}, "reply_to_user": {"reputation": 5, "user_id": 11843356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97322b341111990382b02a7c965973aa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/11843356/abhishek"}, "edited": false, "score": 0, "creation_date": 1565172947, "post_id": 57369915, "comment_id": 101266062, "body": "@Abhishek key.size is the same as key.length and returns length of string or symbol."}], "tags": [], "owner": {"reputation": 51, "user_id": 4219131, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ll5S2_aOLwk/AAAAAAAAAAI/AAAAAAAADEQ/3SZDqxHXY24/photo.jpg?sz=128", "display_name": "dismir", "link": "https://stackoverflow.com/users/4219131/dismir"}, "is_accepted": true, "score": 0, "last_activity_date": 1565072105, "creation_date": 1565072105, "answer_id": 57369915, "question_id": 57367002, "link": "https://stackoverflow.com/questions/57367002/is-there-any-way-to-replace-attributes-with-item-objects-inside-this-display-tab/57369915#57369915", "title": "Is there any way to replace attributes with item objects inside this display_table method?", "body": "<p>If I understood you right this would work</p>\n\n<pre><code>def create_data_array\n  item_list.map do |item|\n    {\n      name: item.name,\n      imported: item.imported,\n      exempted: item.exempted,\n      price: item.price,\n      price_including_tax: item.price_including_tax\n    }\n  end\nend\n\nclass FormatDisplay\n  def initialize(data_array)\n    @data_array = data_array\n    @column_width = 0\n  end\n\n  def display_table\n    @data_array.each do |fieldset|\n      row_string = ''\n\n      fieldset.each_pair do |key, value|\n        row_string += '| ' + sprintf(\"%#{ key.size }s\", value) + ' '\n      end\n\n      puts row_string\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11843356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97322b341111990382b02a7c965973aa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/11843356/abhishek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 57369915, "answer_count": 1, "score": 0, "last_activity_date": 1565072105, "creation_date": 1565046220, "last_edit_date": 1565048037, "question_id": 57367002, "link": "https://stackoverflow.com/questions/57367002/is-there-any-way-to-replace-attributes-with-item-objects-inside-this-display-tab", "title": "Is there any way to replace attributes with item objects inside this display_table method?", "body": "<p>Creating a program to get calculate sales tax as per provided details and some standard rates defined in this program. Now I want to simplify this format display class by replacing attributes inside \"@max_length_fields[@data_array[0][i]]}s\" and replace it with objects. </p>\n\n<p>I have tried to push all fields directly inside this class but that further complicates the code. \nThe Data array used within Format display class is pushed from another Invoice class containing method names as create_data_array : </p>\n\n<pre><code>  def create_data_array\n    data_array = []\n    data_array.push([\"name\", \"imported\", \"exempted\", \"price\", \"price including tax\"])\n    @item_list.each do |item|\n      data_array.push([item.name, item.imported, item.exempted, item.price, item.price_including_tax])\n    end\n    data_array\n  end\n</code></pre>\n\n<p>Now I want to simplify the code by using item objects rather using attributes inside array, class below displays final output of this program and need to be rectified -</p>\n\n<pre><code>class FormatDisplay\n  def initialize(data_array)\n    @data_array = data_array\n    @max_length_fields = {}\n    @column_width = 0\n    @data_array[0].each { |field| @max_length_fields[field] = field.length}\n  end\n\n  def display_table\n    @data_array.each do |fieldset|\n      row_string = ''\n      fieldset.each_with_index do |field, i|\n        row_string += '| ' + sprintf(\"%#{@max_length_fields[@data_array[0][i]]}s\", field) + \" \"\n      end\n      puts row_string\n    end\n  end\nend\n</code></pre>\n\n<p>Expected Result : Replacing attribute from \"@max_length_fields[@data_array[0][i]]}s\" with item object something like option.title </p>\n"}, {"tags": ["ruby", "minitest"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 0, "last_activity_date": 1565060554, "creation_date": 1565060554, "answer_id": 57368356, "question_id": 57366993, "link": "https://stackoverflow.com/questions/57366993/how-to-test-helper-with-params/57368356#57368356", "title": "How to test helper with params", "body": "<p>A pretty generic approach is to use dependency injection.</p>\n\n<p>First, change the method to accept params as an argument:</p>\n\n<pre><code>def get_commands(filter, params)\n  order_by = params[:order_by]\n  something else(filter)\nend\n</code></pre>\n\n<p>Make sure to include this new argument in the controller when you call the method.</p>\n\n<p>Then you can pass a mock parameter set in your test:</p>\n\n<pre><code>test 'get_commands works' do\n  filter = something\n  mock_params = ActionController::Parameters.new(order_by: :id)\n  res = get_commands(filter, mock_params)\n  # ... make your expectation about the result. \nend\n</code></pre>\n\n<p>As a caveat, dependency injection is sometimes treated like an antipattern. Rails does have some built in helpers for testing controllers, see <a href=\"https://guides.rubyonrails.org/testing.html#functional-tests-for-your-controllers\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/testing.html#functional-tests-for-your-controllers</a>. But using dependency injection like this would definitely work, and is a bit simpler. </p>\n"}], "owner": {"reputation": 13, "user_id": 11809980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5315e3b0609d7628d7bc64194d9cec9?s=128&d=identicon&r=PG&f=1", "display_name": "hhqhhq", "link": "https://stackoverflow.com/users/11809980/hhqhhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 57368356, "answer_count": 1, "score": 1, "last_activity_date": 1565071805, "creation_date": 1565046113, "last_edit_date": 1565071805, "question_id": 57366993, "link": "https://stackoverflow.com/questions/57366993/how-to-test-helper-with-params", "title": "How to test helper with params", "body": "<p>I tried to test a method in helper with params[:a]. I'm not using Rspec so don't know how to solve it.</p>\n\n<p>In helper file:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def get_commands(filter)\n  order_by = params[:order_by]\n  something else(filter)\nend\n</code></pre>\n\n<p>and the test file:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>test 'get_commands works' do\n  filter = something\n  res = get_commands(filter)\nend\n</code></pre>\n\n<p>It shows: <code>NameError: undefined local variable or method `params'</code>\nand it also doesn't work if I just add \n<code>params[:order_by]='desc'</code></p>\n"}, {"tags": ["ruby", "kotlin"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1565040396, "post_id": 57365902, "comment_id": 101218762, "body": "Noting that <code>with</code> can lead to confusing code, and difficult analysis; one reason it was deprecated in JS. I&#39;ve never been a fan."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1565065451, "post_id": 57365902, "comment_id": 101223255, "body": "To stitch onto others, if you know a part of the code will always apply to a certain object, it is a very good argument for making that code into a method on that object."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1565099417, "post_id": 57365902, "comment_id": 101239697, "body": "I second @Amadan&#39;s concept however I have leveraged such techniques as module methods in the past for generic error handling since the error will bubble out of the instance_eval block scope. e.g. <code>module R; def self.with_error_handle(obj,&amp;block); obj.instance_eval(&amp;block) rescue &quot;oops #{$!}&quot;; end; end</code>"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565098437, "post_id": 57366307, "comment_id": 101239016, "body": "Beautiful. I cannot think of a more simplistic example"}], "tags": [], "owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "is_accepted": true, "score": 9, "last_activity_date": 1565040553, "creation_date": 1565040553, "answer_id": 57366307, "question_id": 57365902, "link": "https://stackoverflow.com/questions/57365902/kotlins-with-for-ruby/57366307#57366307", "title": "Kotlin&#39;s With, for ruby", "body": "<p>Yes, you can build your own <code>with</code> using <code>instance_eval</code>.</p>\n\n<pre><code>def with(obj, &amp;block)\n  obj.instance_eval(&amp;block)\nend\n\nwith(\" banana \") {\n  puts strip\n  puts reverse\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>banana\n ananab \n</code></pre>\n"}], "owner": {"reputation": 12683, "user_id": 273119, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6b7f0d7d95b3a1f9547274129582b434?s=128&d=identicon&r=PG", "display_name": "Daniel Gomez Rico", "link": "https://stackoverflow.com/users/273119/daniel-gomez-rico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 57366307, "answer_count": 1, "score": 3, "last_activity_date": 1565040553, "creation_date": 1565038058, "last_edit_date": 1565040003, "question_id": 57365902, "link": "https://stackoverflow.com/questions/57365902/kotlins-with-for-ruby", "title": "Kotlin&#39;s With, for ruby", "body": "<p>Is there any function or way to simulate this <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/with.html\" rel=\"nofollow noreferrer\">with</a> in ruby?</p>\n\n<p>It helps you to organize the code that acts over the same object, something like:</p>\n\n<pre><code>with(callDao) {\n            whenever(deleteAll()).thenComplete()\n            whenever(insertAll(any())).thenComplete()\n}\n</code></pre>\n\n<p>vs </p>\n\n<pre><code>            whenever(callDao.deleteAll()).thenComplete()\n            whenever(callDao.insertAll(any())).thenComplete()\n</code></pre>\n"}, {"tags": ["ruby", "csv", "merge", "duplicates", "sku"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565038074, "post_id": 57365853, "comment_id": 101218023, "body": "what have you tried so far? Do you have any code you can add to your question?  see <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 21, "user_id": 11886411, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hU9GYHX6nkw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUum24S8DBE5QY7tLakwBZRh8rng/photo.jpg?sz=128", "display_name": "Antonis Iliadis", "link": "https://stackoverflow.com/users/11886411/antonis-iliadis"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565038255, "post_id": 57365853, "comment_id": 101218103, "body": "i tried code from this question but i couldnt make it work for me, <a href=\"https://stackoverflow.com/questions/10973182/merge-rows-csv-by-id-ruby\" title=\"merge rows csv by id ruby\">stackoverflow.com/questions/10973182/merge-rows-csv-by-id-ru&zwnj;&#8203;by</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565052681, "post_id": 57365853, "comment_id": 101221084, "body": "You example before the edits contained several instances of commas preceded and/or followed by one or more spaces. There should be none. If, for example, the first line were, <code>&quot;SKU , Title,Category,Price&quot;</code> the first two fields would be read as <code>&quot;SKU &quot;</code> and <code>&quot; Title&quot;</code>. The alternative is to remove the spaces after the line is parsed, which should not be required."}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1565043993, "creation_date": 1565043993, "answer_id": 57366765, "question_id": 57365853, "link": "https://stackoverflow.com/questions/57365853/ruby-merge-csv-duplicate-columns-with-same-sku/57366765#57366765", "title": "Ruby - Merge CSV duplicate columns with same SKU", "body": "<p>It seems that in order for this to be correct, we must assume the SKU number and the price are always the same.  Since you know the only key you want to merge data between is <code>Category</code> here is how you can do it.</p>\n\n<p>Assuming this is your test.csv in the same path as the ruby script:</p>\n\n<pre><code># test.csv\nSKU,Title,Category,Price\n001,Soap,Bathroom,0.5\n001,Soap,Kitchen,0.5\n002,Water,Kitchen,0.4\n002,Water,Garage,0.4\n003,Juice,Kitchen,0.8\n</code></pre>\n\n<p>Ruby script in same directory as your <code>test.csv</code> file</p>\n\n<pre><code># fix_csv.rb\nrequire 'csv'\nrows = CSV.read 'test.csv', :headers =&gt; true\nskews = rows.group_by{|row| row['SKU']}.keys.uniq\nvalues = rows.group_by{|row| row['SKU']}\n\nmerged = skews.map do |key|\n  group = values.select{|k,v| k == key}.values.flatten.map(&amp;:to_h)\n  category = group.map{|k,v| k['Category']}.join('/')\n  new_data = group[0]\n  new_data['Category'] = category\n  new_data\nend\n\nCSV.open('merged_data.csv', 'w') do |csv|\n  csv &lt;&lt; merged.first.keys # writes the header row\n  merged.each do |hash|\n    csv &lt;&lt; hash.values\n  end\nend\n\nputs 'see contents of merged_data.csv'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565102760, "post_id": 57367065, "comment_id": 101241856, "body": "@CarySwoveland yes I was mistaken. Thanks."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1565148784, "last_edit_date": 1565148784, "creation_date": 1565046807, "answer_id": 57367065, "question_id": 57365853, "link": "https://stackoverflow.com/questions/57365853/ruby-merge-csv-duplicate-columns-with-same-sku/57367065#57367065", "title": "Ruby - Merge CSV duplicate columns with same SKU", "body": "<p>It's my understand you wish to read a CSV file, perform some operations on the data and then write the result to a new CSV file. You could do that as follows.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>require 'csv'\n\ndef convert(csv_file_in, csv_file_out, group_field, aggregate_field)\n  csv = CSV.read(FNameIn, headers: true)\n  headers = csv.headers\n  arr = csv.group_by { |row| row[group_field] }.\n            map do |_,a|\n              headers.map { |h| h==aggregate_field ?\n                (a.map { |row| row[aggregate_field] }.join('/')) : a.first[h] }\n            end\n  CSV.open(FNameOut, \"wb\") do |csv|\n    csv &lt;&lt; headers\n    arr.each { |row| csv &lt;&lt; row }\n  end\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<p>Let's create a CSV file with the following data:</p>\n\n<pre><code>s =&lt;&lt;_\nSKU,Title,Category,Price\n001,Soap,Bathroom,0.5\n001,Soap,Kitchen,0.5\n002,Water,Kitchen,0.4\n002,Water,Garage,0.4\n003,Juice,Kitchen,0.8\n_\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>FNameIn  = 'testin.csv'\nFNameOut = 'testout.csv'\n\nIO.write(FNameIn, s)\n  #=&gt; 135\n</code></pre>\n\n<h1><p></p></h1>\n\n<p>Now execute the method with these values:</p>\n\n<pre><code>convert(FNameIn, FNameOut, \"SKU\", \"Category\")\n</code></pre>\n\n<p>and confirm <code>FNameOut</code> was written correctly:</p>\n\n<pre><code>puts IO.read(FNameOut)\nSKU,Title,Category,Price\n001,Soap,Bathroom/Kitchen,0.5\n002,Water,Kitchen/Garage,0.4\n003,Juice,Kitchen,0.8\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The steps are as follows:</p>\n\n<pre><code>csv_file_in = FNameIn\ncsv_file_out = FNameOut\ngroup_field = \"SKU\"\naggregate_field = \"Category\"\ncsv = CSV.read(FNameIn, headers: true)\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/csv/rdoc/CSV.html#method-c-read\" rel=\"nofollow noreferrer\">CSV::read</a>.</p>\n\n<pre><code>headers = csv.headers\n  #=&gt; [\"SKU\", \"Title\", \"Category\", \"Price\"] \nh = csv.group_by { |row| row[group_field] }\n  #=&gt; {\"001\"=&gt;[\n         #&lt;CSV::Row \"SKU\":\"001\" \"Title\":\"Soap\" \"Category\":\"Bathroom\" \"Price\":\"0.5\"&gt;,\n  #      #&lt;CSV::Row \"SKU\":\"001\" \"Title\":\"Soap\" \"Category\":\"Kitchen\" \"Price\":\"0.5\"&gt;\n  #    ],\n  #    \"002\"=&gt;[\n  #      #&lt;CSV::Row \"SKU\":\"002\" \"Title\":\"Water\" \"Category\":\"Kitchen\" \"Price\":\"0.4\"&gt;,\n  #      #&lt;CSV::Row \"SKU\":\"002\" \"Title\":\"Water\" \"Category\":\"Garage\" \"Price\":\"0.4\"&gt;\n  #    ],\n  #    \"003\"=&gt;[\n  #      #&lt;CSV::Row \"SKU\":\"003\" \"Title\":\"Juice\" \"Category\":\"Kitchen\" \"Price\":\"0.8\"&gt;\n  #    ]\n  #   } \narr = h.map do |_,a|\n        headers.map { |h| h==aggregate_field ?\n          (a.map { |row| row[aggregate_field] }.join('/')) : a.first[h] }\n      end\n   #=&gt; [[\"001\", \"Soap\", \"Bathroom/Kitchen\", \"0.5\"],\n   #    [\"002\", \"Water\", \"Kitchen/Garage\", \"0.4\"],\n   #    [\"003\", \"Juice\", \"Kitchen\", \"0.8\"]] \n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/csv/rdoc/CSV.html#method-i-headers\" rel=\"nofollow noreferrer\">CSV#headers</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerable#group_by</a>, an oft-used method. Lastly, write the output file: </p>\n\n<pre><code>CSV.open(FNameOut, \"wb\") do |csv|\n  csv &lt;&lt; headers\n  arr.each { |row| csv &lt;&lt; row }\nend\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/csv/rdoc/CSV.html#method-c-open\" rel=\"nofollow noreferrer\">CSV::open</a>. Now let's return to the calculation of <code>arr</code>. This is most easily explained by inserting some <code>puts</code> statements and executing the code.</p>\n\n<pre><code>arr = h.map do |_,a|\n          puts \"  _=#{_}\"\n          puts \"  a=#{a}\"\n          headers.map do |h|\n            puts \"    header=#{h}\"\n            if h==aggregate_field\n              a.map { |row| row[aggregate_field] }.join('/')\n            else\n              a.first[h]\n            end.\n            tap { |s| puts \"    mapped to #{s}\" }\n          end\n        end\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-tap\" rel=\"nofollow noreferrer\">Object#tap</a>. The following is displayed.</p>\n\n<pre><code>  _=001\n  a=[#&lt;CSV::Row \"SKU\":\"001\" \"Title\":\"Soap\" \"Category\":\"Bathroom\" \"Price\":\"0.5\"&gt;,\n     #&lt;CSV::Row \"SKU\":\"001\" \"Title\":\"Soap\" \"Category\":\"Kitchen\" \"Price\":\"0.5\"&gt;]\n    header=SKU\n    mapped to 001\n    header=Title\n    mapped to Soap\n    header=Category\n    mapped to Bathroom/Kitchen\n    header=Price\n    mapped to 0.5\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>  _=002\n  a=[#&lt;CSV::Row \"SKU\":\"002\" \"Title\":\"Water\" \"Category\":\"Kitchen\" \"Price\":\"0.4\"&gt;,\n     #&lt;CSV::Row \"SKU\":\"002\" \"Title\":\"Water\" \"Category\":\"Garage\" \"Price\":\"0.4\"&gt;]\n    header=SKU\n    mapped to 002\n    header=Title\n    mapped to Water\n    header=Category\n    mapped to Kitchen/Garage\n    header=Price\n    mapped to 0.4\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>  _=003\n  a=[#&lt;CSV::Row \"SKU\":\"003\" \"Title\":\"Juice\" \"Category\":\"Kitchen\" \"Price\":\"0.8\"&gt;]\n    header=SKU\n    mapped to 003\n    header=Title\n    mapped to Juice\n    header=Category\n    mapped to Kitchen\n    header=Price\n    mapped to 0.8\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11886411, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hU9GYHX6nkw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUum24S8DBE5QY7tLakwBZRh8rng/photo.jpg?sz=128", "display_name": "Antonis Iliadis", "link": "https://stackoverflow.com/users/11886411/antonis-iliadis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1565148784, "creation_date": 1565037802, "last_edit_date": 1565047628, "question_id": 57365853, "link": "https://stackoverflow.com/questions/57365853/ruby-merge-csv-duplicate-columns-with-same-sku", "title": "Ruby - Merge CSV duplicate columns with same SKU", "body": "<p>I have created a CSV file about my eshop that contains multiple items with different SKUs. Some SKUs appear more than once because they can be in more than one category (but the Title and Price will always be the same for a given SKU). Example:</p>\n\n<pre><code>SKU,Title,Category,Price    \n001,Soap,Bathroom,0.5    \n001,Soap,Kitchen,0.5\n002,Water,Kitchen,0.4\n002,Water,Garage,0.4\n003,Juice,Kitchen,0.8    \n</code></pre>\n\n<p>I now wish to create from that file another CSV file that has no duplicate SKU's and aggregates the \"Category\" attributes as follows:</p>\n\n<pre><code>SKU,Title,Category,Price\n001,Soap,Bathroom/Kitchen,0.5    \n002,Water,Kitchen/Garage,0.4\n003,Juice,Kitchen,0.8\n</code></pre>\n\n<p>How can I do that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "paper-trail-gem"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565037341, "post_id": 57365544, "comment_id": 101217766, "body": "The issue here is that <code>Version</code> is not the same as <a href=\"https://github.com/paper-trail-gem/paper_trail/blob/master/lib/paper_trail/model_config.rb#L171\" rel=\"nofollow noreferrer\"><code>PaperTrail::Version</code></a> it looks like the supported mechanism for this is to create a module and pass that through <a href=\"https://github.com/paper-trail-gem/paper_trail/blob/v10.3.1/README.md#5b-configuring-the-versions-association\" rel=\"nofollow noreferrer\">See Here</a> or creating your own class <a href=\"https://github.com/paper-trail-gem/paper_trail/blob/v10.3.1/README.md#6a-custom-version-classes\" rel=\"nofollow noreferrer\">See Here</a>"}, {"owner": {"reputation": 11, "user_id": 6565505, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MrVSKhHgr3s/AAAAAAAAAAI/AAAAAAAAABc/YBRvaBuncEY/photo.jpg?sz=128", "display_name": "H&#233;ctor V&#225;squez", "link": "https://stackoverflow.com/users/6565505/h%c3%a9ctor-v%c3%a1squez"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565037762, "post_id": 57365544, "comment_id": 101217928, "body": "@engineersmnky you were right, since I&#39;m using a custom class I had to specify the <code>class_name</code> as <code>has_paper_trail versions: { class_name: &#39;Version&#39; }</code>. Thanks a lot!"}], "answers": [{"tags": [], "owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "is_accepted": false, "score": 0, "last_activity_date": 1565062766, "creation_date": 1565062766, "answer_id": 57368604, "question_id": 57365544, "link": "https://stackoverflow.com/questions/57365544/why-ar-callbacks-are-not-triggered-for-versions-created-by-paper-trail/57368604#57368604", "title": "Why AR callbacks are not triggered for `Version`s created by paper_trail?", "body": "<blockquote>\n  <blockquote>\n    <p>The issue here is that Version is not the same as PaperTrail::Version it looks like the supported mechanism for this is to create a module and pass that through See Here or creating your own class See Here \u2013 engineersmnky</p>\n  </blockquote>\n  \n  <p>@engineersmnky you were right, since I'm using a custom class I had to specify the class_name as has_paper_trail versions: { class_name: 'Version' }. Thanks a lot! \u2013 H\u00e9ctor V\u00e1squez</p>\n</blockquote>\n\n<ul>\n<li><a href=\"https://github.com/paper-trail-gem/paper_trail/blob/v10.3.1/README.md#5b-configuring-the-versions-association\" rel=\"nofollow noreferrer\">https://github.com/paper-trail-gem/paper_trail/blob/v10.3.1/README.md#5b-configuring-the-versions-association</a></li>\n<li><p><a href=\"https://github.com/paper-trail-gem/paper_trail/blob/v10.3.1/README.md#6a-custom-version-classes\" rel=\"nofollow noreferrer\">https://github.com/paper-trail-gem/paper_trail/blob/v10.3.1/README.md#6a-custom-version-classes</a></p></li>\n- \n</ul>\n"}], "owner": {"reputation": 11, "user_id": 6565505, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MrVSKhHgr3s/AAAAAAAAAAI/AAAAAAAAABc/YBRvaBuncEY/photo.jpg?sz=128", "display_name": "H&#233;ctor V&#225;squez", "link": "https://stackoverflow.com/users/6565505/h%c3%a9ctor-v%c3%a1squez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565062766, "creation_date": 1565036165, "question_id": 57365544, "link": "https://stackoverflow.com/questions/57365544/why-ar-callbacks-are-not-triggered-for-versions-created-by-paper-trail", "title": "Why AR callbacks are not triggered for `Version`s created by paper_trail?", "body": "<p>I'm trying to do something each time a Version is created by paper_trail by setting up a callback on the same model but it does not work.</p>\n\n<p>I'm using Rails v6.0.0.beta3 and paper_trail v10.3.0. I tried creating the Version manually (<code>Version.create</code>) and it works.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Version\n  after_commit :do_something, on: :create\n\n  private\n\n  def do_something\n    p('doing something') # never gets called\n  end\nend\n\nclass SomeModel\n  has_paper_trail\nend\n\n# creates both SomeModel and a Version but version's callbacks\n# are not called/executed.\nSomeModel.create\n</code></pre>\n\n<p>I expected <code>Version#do_something</code> to be called, but it never happens.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9727525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43a4208ab4d1ae761883a29972b6af0e?s=128&d=identicon&r=PG&f=1", "display_name": "Ethanph892", "link": "https://stackoverflow.com/users/9727525/ethanph892"}, "edited": false, "score": 0, "creation_date": 1565035233, "post_id": 57365260, "comment_id": 101216983, "body": "This worked! Thank you! I did the joins(:rigs) and changed the view to match what you suggested."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 47, "user_id": 9727525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43a4208ab4d1ae761883a29972b6af0e?s=128&d=identicon&r=PG&f=1", "display_name": "Ethanph892", "link": "https://stackoverflow.com/users/9727525/ethanph892"}, "edited": false, "score": 1, "creation_date": 1565035329, "post_id": 57365260, "comment_id": 101217026, "body": "Nice! Take a look to the <code>select</code> part, to get only what you need. Glad to help."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 1, "last_activity_date": 1565034745, "creation_date": 1565034745, "answer_id": 57365260, "question_id": 57365152, "link": "https://stackoverflow.com/questions/57365152/how-to-list-nested-attribute-values-on-index-view/57365260#57365260", "title": "How to list nested attribute values on &#39;index&#39; view?", "body": "<p>Try using <code>joins</code> instead <code>includes</code>. It'll get any <code>rig</code> associated with a <code>djob</code>:</p>\n\n<pre><code>def index_photography\n  @djobs = Djob.order(:id).joins(:rigs)\nend\n\n&lt;tbody&gt;\n  &lt;% @djobs.each do |djob| %&gt;\n    &lt;tr&gt;\n      &lt;td class=\"dotted\"&gt;\n        &lt;%= djob.jobtype %&gt;\n      &lt;/td&gt;\n\n      &lt;td class=\"dotted\" &gt;\n        &lt;% djob.rigs.each do |rig| %&gt;\n          &lt;%= rig.name %&gt;\n        &lt;% end %&gt;\n      &lt;/td&gt;\n     &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>The <code>.all</code> isn't necessary. You can try also selecting the needed columns from both tables:</p>\n\n<pre><code>Djob.order(:id).joins(:rigs).select(:jobtype, 'rigs.name')\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9727525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43a4208ab4d1ae761883a29972b6af0e?s=128&d=identicon&r=PG&f=1", "display_name": "Ethanph892", "link": "https://stackoverflow.com/users/9727525/ethanph892"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 57365260, "answer_count": 1, "score": 1, "last_activity_date": 1565034745, "creation_date": 1565034243, "question_id": 57365152, "link": "https://stackoverflow.com/questions/57365152/how-to-list-nested-attribute-values-on-index-view", "title": "How to list nested attribute values on &#39;index&#39; view?", "body": "<p>I have a table named \"djobs\". This table has a nested table named \"rigs\" that is connected through the column 'djob_id'. Each djob has_many rigs associated with it. The issue is, I have a table of information being displayed on the djob index view. In this table, I want to display each djob, and within each djob, display each rig  name associated with that particular job. I can' figure out how to only display the rig names for that particular djob. It always displays every rig name in every djob.</p>\n\n<p>I've tried various solutions found online, but they all result in each djob displaying every single rig name and not just the rigs associated with that particular djob. For example, for job 1, it should display rigs \"A\", \"B\", \"C\". But instead, it displays every rig name that has ever been associated to a djob.</p>\n\n<p>controller djobs:</p>\n\n<pre><code>def index_photography\n  @djobs = Djob.all.order(:id).includes(:rigs)\n  @djob_id = @djobs.map(&amp;:id)\n  @djob_rigs = Rig.where(:djob_id =&gt; @djob_id)\nend\n</code></pre>\n\n<p>model djobs:</p>\n\n<pre><code>class Djob &lt; ActiveRecord::Base\n  has_many :rigs\n  accepts_nested_attributes_for :rigs, allow_destroy: true\nend\n</code></pre>\n\n<p>model rigs:</p>\n\n<pre><code>class Rig &lt; ActiveRecord::Base\n  belongs_to :djob\nend\n</code></pre>\n\n<p>view:</p>\n\n<pre><code>&lt;tbody&gt;\n  &lt;% @djobs.each do |djob| %&gt;\n    &lt;tr&gt;\n\n      &lt;td class=\"dotted\" &gt;&lt;%= djob.jobtype %&gt;&lt;/td&gt;\n\n      &lt;td class=\"dotted\" &gt;\n        &lt;% @djob_rigs.each do |rig| %&gt;\n          &lt;%= rig.name %&gt;\n        &lt;% end %&gt;\n      &lt;/td&gt;\n\n     &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>I expect a view with a table that has two columns: jobtype and rigs. Where each row lists the one jobtype and all of the rig names associated with that djob. Instead I get the jobtype and every rig names ever associated to a djob.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "checkbox"], "comments": [{"owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1565037623, "post_id": 57365033, "comment_id": 101217876, "body": "@jvillian, thank you - i added the code. What do you mean by console log?"}, {"owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1565038655, "post_id": 57365033, "comment_id": 101218241, "body": "@jvillian thank you. feeling super dumb now. I added the logs above!"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "edited": false, "score": 1, "creation_date": 1565073406, "post_id": 57366204, "comment_id": 101225555, "body": "That solved it. Thank you so much, that was explained excellent! It worked without my profile model having a company_ids attribute - I guess rails does that automatically due to the association?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "edited": false, "score": 1, "creation_date": 1565096699, "post_id": 57366204, "comment_id": 101237866, "body": "I guess so. Pretty interesting. Are you sure the association is being created?"}, {"owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "edited": false, "score": 1, "creation_date": 1565256600, "post_id": 57366204, "comment_id": 101299154, "body": "yes it is. I can run profile.companies and it returns me the associated companies."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 1, "last_activity_date": 1565039872, "creation_date": 1565039872, "answer_id": 57366204, "question_id": 57365033, "link": "https://stackoverflow.com/questions/57365033/rails-does-not-create-associated-model/57366204#57366204", "title": "Rails does not create associated model", "body": "<p>A couple of things. First, as you can see from the <code>Unpermitted parameter: :company_ids</code> message:</p>\n\n<pre><code>Started POST \"/profiles\" for ::1 at 2019-08-05 22:54:36 +0200\nProcessing by ProfilesController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"bmmqCdtWvTcDjlbR6yGrdZTGj+t3O2NMwNKanY5qP84eCSsCuBVF4SdzDkQ+0YOe5q+CapWx5NLaftunZ+ANSg==\", \"profile\"=&gt;{\"name\"=&gt;\"test 4\", \"status\"=&gt;\"employed but open for a new challenge\", \"company_ids\"=&gt;[\"\", \"17\", \"31\", \"32\"], \"content\"=&gt;\"rrr\"}, \"commit\"=&gt;\"Save your profile\"}\n  User Load (0.3ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 16], [\"LIMIT\", 1]]\nUnpermitted parameter: :company_ids\n   (0.1ms)  BEGIN\n   (0.1ms)  ROLLBACK\n  Rendering profiles/new.html.erb within layouts/application\n  Company Load (2.6ms)  SELECT \"companies\".* FROM \"companies\"\n  CACHE Company Load (0.0ms)  SELECT \"companies\".* FROM \"companies\"\n  CACHE Company Load (0.0ms)  SELECT \"companies\".* FROM \"companies\"\n  Rendered profiles/new.html.erb within layouts/application (29.2ms)\n  Rendered shared/_navbar.html.erb (1.4ms)\n  Rendered shared/_flashes.html.erb (0.4ms)\nCompleted 200 OK in 178ms (Views: 170.6ms | ActiveRecord: 3.2ms)\n</code></pre>\n\n<p>...you are using <code>permit</code> incorrectly and <code>company_ids</code>, therefore, is not being permitted.</p>\n\n<p>It should look something more like: </p>\n\n<pre><code>def params_profile\n  params.require(:profile).permit(:status, :name, :content, company_ids: [])\nend\n</code></pre>\n\n<p>...since <code>company_ids</code> is an array. Permitted arrays should go at the end of the <code>permit</code> list, see <a href=\"https://edgeguides.rubyonrails.org/action_controller_overview.html#permitted-scalar-values\" rel=\"nofollow noreferrer\">the docs</a> for more information.</p>\n\n<p>Second, your <code>Profile</code> model doesn't have a <code>company_ids</code> attribute. So, you <em>may</em> get an error when you do: </p>\n\n<pre><code>@profile = Profile.new(params_profile)\n</code></pre>\n\n<p>(TBH, I forget how smart (or not) rails is in this type of circumstance.) Which is a whole other thing you'll have to deal with.</p>\n\n<p>Third, your <code>Profile</code> model includes <code>belongs_to :user</code>, but you never assign a user which is why your transaction is getting the <code>ROLLBACK</code>. In general, to see why you're getting a <code>ROLLBACK</code>, you can do something like: </p>\n\n<pre><code>if @profile.save!\n</code></pre>\n\n<p>...and the bang (!) will cause an error and provide an explanation. </p>\n\n<p>To set the <code>user_id</code>, I would suggest you do something like: </p>\n\n<pre><code>@profile = current_user.build_profile(params_profile)\n</code></pre>\n\n<p>This assumes that <code>User</code> <code>has_one :profile</code>. See <a href=\"https://guides.rubyonrails.org/association_basics.html#methods-added-by-has-one\" rel=\"nofollow noreferrer\">the docs</a> for more information.</p>\n"}], "owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 57366204, "answer_count": 1, "score": 1, "last_activity_date": 1565039872, "creation_date": 1565033660, "last_edit_date": 1565038623, "question_id": 57365033, "link": "https://stackoverflow.com/questions/57365033/rails-does-not-create-associated-model", "title": "Rails does not create associated model", "body": "<p>I created a form where a user can create a profile. In the form the user can select multiple companies. A profile has many companies through a join-table named profile_companies. My code does create a new profile, but it does not create the association. Meaning that when I hit in the console: Profile.last.companies it returns an empty array. When I check the params before a profile is created, it does show me a full array for company_ids. So it looks like it cannot pass these values and create the association. Does anyone have an idea where the error is?</p>\n\n<p>Here is my Profile model: </p>\n\n<pre><code>class Profile &lt; ApplicationRecord\n  belongs_to :user\n  has_many :profile_companies\n  has_many :companies, through: :profile_companies\n\n  STATUSES = [\"currently looking for a job\", \"employed but open for a new challenge\"]\n  validates :status, inclusion: {in: STATUSES}\nend\n</code></pre>\n\n<p>here is my company model:</p>\n\n<pre><code>class Company &lt; ApplicationRecord\n  has_many :vacancies\n  has_many :profile_companies\n  has_many :profiles, through: :profile_companies\nend\n</code></pre>\n\n<p>here is my profiles controller:</p>\n\n<pre><code>class ProfilesController &lt; ApplicationController\n  def new\n    @profile = Profile.new\n  end\n  def create\n    @profile = Profile.new(params_profile)\n\n    if @profile.save\n      redirect_to profile_path\n    else\n      render :new\n    end\n  end\n\n  private\n\n  def params_profile\n    params.require(:profile).permit(:status, :name, :content, :company_ids)\n  end\n\nend\n</code></pre>\n\n<p>And here is my pry to show the params handed to the controller:</p>\n\n<pre><code>[1] pry(#&lt;ProfilesController&gt;)&gt; params[:profile] =&gt; &lt;ActionController::Parameters {\"name\"=&gt;\"test 4\", \"status\"=&gt;\"employed but open for a new challenge\", \"company_ids\"=&gt;[\"\", \"31\", \"34\"], \"content\"=&gt;\"test 4\"} permitted: false&gt;\n</code></pre>\n\n<p>And here are my Logs:</p>\n\n<pre><code>Started POST \"/profiles\" for ::1 at 2019-08-05 22:54:36 +0200\nProcessing by ProfilesController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"bmmqCdtWvTcDjlbR6yGrdZTGj+t3O2NMwNKanY5qP84eCSsCuBVF4SdzDkQ+0YOe5q+CapWx5NLaftunZ+ANSg==\", \"profile\"=&gt;{\"name\"=&gt;\"test 4\", \"status\"=&gt;\"employed but open for a new challenge\", \"company_ids\"=&gt;[\"\", \"17\", \"31\", \"32\"], \"content\"=&gt;\"rrr\"}, \"commit\"=&gt;\"Save your profile\"}\n  User Load (0.3ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 16], [\"LIMIT\", 1]]\nUnpermitted parameter: :company_ids\n   (0.1ms)  BEGIN\n   (0.1ms)  ROLLBACK\n  Rendering profiles/new.html.erb within layouts/application\n  Company Load (2.6ms)  SELECT \"companies\".* FROM \"companies\"\n  CACHE Company Load (0.0ms)  SELECT \"companies\".* FROM \"companies\"\n  CACHE Company Load (0.0ms)  SELECT \"companies\".* FROM \"companies\"\n  Rendered profiles/new.html.erb within layouts/application (29.2ms)\n  Rendered shared/_navbar.html.erb (1.4ms)\n  Rendered shared/_flashes.html.erb (0.4ms)\nCompleted 200 OK in 178ms (Views: 170.6ms | ActiveRecord: 3.2ms)\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1565029696, "post_id": 57364206, "comment_id": 101214656, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3581156/how-can-i-read-a-file-bytes-at-a-time-in-ruby\">how can I read a file, bytes at a time in Ruby?</a>"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1565081938, "post_id": 57364206, "comment_id": 101229728, "body": "You can have a look at <a href=\"https://www.rubydoc.info/stdlib/core/IO.foreach\" rel=\"nofollow noreferrer\">IO#foreach</a> - which does not read the entire file at once and provides each line of file."}, {"owner": {"reputation": 2536, "user_id": 162793, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/747b0480986bd8ac5d91aafd74bea043?s=128&d=identicon&r=PG", "display_name": "sheldonh", "link": "https://stackoverflow.com/users/162793/sheldonh"}, "reply_to_user": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1565180189, "post_id": 57364206, "comment_id": 101270080, "body": "@Surya The example code shows reading input one line at a time. The question is about a situation where one line at a time is too much, because of very long lines."}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1565192765, "post_id": 57364206, "comment_id": 101277733, "body": "@sheldonh : If just changing the large line in a large file is the only end goal then probably look at <code>sed</code> command."}], "owner": {"reputation": 2536, "user_id": 162793, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/747b0480986bd8ac5d91aafd74bea043?s=128&d=identicon&r=PG", "display_name": "sheldonh", "link": "https://stackoverflow.com/users/162793/sheldonh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565030216, "creation_date": 1565029616, "last_edit_date": 1565030216, "question_id": 57364206, "link": "https://stackoverflow.com/questions/57364206/very-long-lines-of-input-in-ruby", "title": "Very long lines of input in Ruby", "body": "<p>I have a Ruby script that performs some substitutions on the output of <code>mysqldump</code>.</p>\n\n<p>The input can have very long lines (hundreds of MB), because a single line can represent a multi-row INSERT statement for all the data in a table. The <code>mysqldump</code> utility can be coerced to produce one INSERT statement per row, but I don't have control of every client.</p>\n\n<p>My script naively expects <code>IO#each_line</code> to control memory usage:</p>\n\n<pre><code>$stdin.each_line do |line|\n  next if options[:entity_excludes].any? { |entity| line =~ /^(DROP TABLE IF EXISTS|INSERT INTO) `custom_#{entity}(s|_meta)`/ }\n  line.gsub!(/^CREATE TABLE `/, \"CREATE TABLE IF NOT EXISTS `\")\n  line.gsub!('{{__OPF_SITEURL__}}', siteurl) if siteurl\n  $stdout.write(line)\nend\n</code></pre>\n\n<p>I've already seen input with maximum line length over 400MB, and this translates directly into process resident memory.</p>\n\n<p>Are there libraries for Ruby that allow text transforms on an input stream using buffers instead of relying on line-delimited input?</p>\n\n<p>This was marked as a duplicate of a <a href=\"https://stackoverflow.com/questions/3581156/how-can-i-read-a-file-bytes-at-a-time-in-ruby\">simpler question</a>. But there's quite a bit more to this. You need to keep track of multiple buffers and test for application of transforms even when they apply across a buffer boundary. It's easy to get wrong, which is why I'm hoping a library already exists.</p>\n"}, {"tags": ["ruby", "methods", "error-handling", "null"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 3, "creation_date": 1565026696, "post_id": 57363479, "comment_id": 101213499, "body": "What do you mean &quot;how to handle null response&quot;? What do you want to happen? What is not working?"}], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 3388910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18f7059930a766248b3b2613b9d0b760?s=128&d=identicon&r=PG", "display_name": "BrianDiesel", "link": "https://stackoverflow.com/users/3388910/briandiesel"}, "is_accepted": false, "score": 0, "last_activity_date": 1565101644, "creation_date": 1565101644, "answer_id": 57378318, "question_id": 57363479, "link": "https://stackoverflow.com/questions/57363479/how-to-validate-the-exception-thrown-in-ruby-cucumber/57378318#57378318", "title": "how to validate the exception thrown in ruby cucumber", "body": "<p>Do you mean a response with an empty body?</p>\n\n<p>Rspec has built in http status matchers <a href=\"https://relishapp.com/rspec/rspec-rails/docs/matchers/have-http-status-matcher\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-rails/docs/matchers/have-http-status-matcher</a></p>\n\n<p>If you would like to check for a 500 status you can use this matcher:</p>\n\n<pre><code>expect(response).to have_http_status(500)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9596894, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9596894", "link": "https://stackoverflow.com/users/9596894/user9596894"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565101644, "creation_date": 1565026393, "last_edit_date": 1565056981, "question_id": 57363479, "link": "https://stackoverflow.com/questions/57363479/how-to-validate-the-exception-thrown-in-ruby-cucumber", "title": "how to validate the exception thrown in ruby cucumber", "body": "<p>How to handle null response in case if 500 response code\nin ruby cucumber. </p>\n\n<p>Below code snippet is to validate response code</p>\n\n<pre><code>expect (@response.code.to_s).to \neq(response_code.to_s)\nputs ( @response.code)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "symbols"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1565026309, "post_id": 57363267, "comment_id": 101213361, "body": "I agree, it&#39;s very confusing."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1565029541, "post_id": 57363267, "comment_id": 101214584, "body": "Maybe they&#39;re trying to differentiate between the various types of things called <code>Fred</code>, or not. Keep in mind that matz isn&#39;t a native English speaker and a lot of this probably originated with him. Might be worth doing <code>def m;end</code> in <code>irb</code>, the result of that expression is <code>:m</code> and <code>(def m;end).object_id == :m.object_id</code>; or that might just confuse things further."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565034944, "post_id": 57364791, "comment_id": 101216880, "body": "I am not sure this makes anything clearer as your first 3 <code>Fred</code>s are not symbols at all  but rather a <code>Class</code>,an <code>Integer</code>, and <code>nil</code> (in that order)"}], "tags": [], "owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "is_accepted": false, "score": 0, "last_activity_date": 1565032347, "creation_date": 1565032347, "answer_id": 57364791, "question_id": 57363267, "link": "https://stackoverflow.com/questions/57363267/ruby-documentation-over-symbol-objects-is-misleading/57364791#57364791", "title": "Ruby documentation over Symbol objects is misleading", "body": "<p>My understanding is it's meant to illustrate the fact that all of the other \"Fred's\" do nothing to alter the fact that the symbol <code>:Fred</code> is unchanged in every context.  Maybe changing the <code>object_id</code> list at the bottom of the example to something like this would make it more clear:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>p One::Fred.object_id  #=&gt; 70222371662500\np Two::Fred.object_id  #=&gt; 3\np Fred().object_id     #=&gt; 8\np $f1.object_id        #=&gt; 2514190\np $f2.object_id        #=&gt; 2514190\np $f3.object_id        #=&gt; 2514190\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 2, "last_activity_date": 1565082089, "last_edit_date": 1565082089, "creation_date": 1565039006, "answer_id": 57366069, "question_id": 57363267, "link": "https://stackoverflow.com/questions/57363267/ruby-documentation-over-symbol-objects-is-misleading/57366069#57366069", "title": "Ruby documentation over Symbol objects is misleading", "body": "<p>When you use a symbol Ruby looks at list of existing symbols so when you reuse a symbol you are not creating a separate object in memory.</p>\n\n<pre><code>irb(main):006:0&gt; :foo.object_id == :foo.object_id\n=&gt; true\n</code></pre>\n\n<p>You can contrast this with a string:</p>\n\n<pre><code>irb(main):007:0&gt; \"foo\".object_id == \"foo\".object_id\n=&gt; false\n</code></pre>\n\n<p>This combined with the fact that they are so cheap to compare is what makes symbols so effective as hash keys. </p>\n\n<p>What that pretty confusing example demonstrates is that symbols are not private to a scope - the table of symbols is global. It would be a bit less confusing if an instance variable was used instead of a global variable. I think it also attempts to demonstrate that module and class names are constants.</p>\n\n<pre><code>irb(main):016:0&gt; Fred = Module.new do; end # this is the same as using the module keyword\nirb(main):017:0&gt; Fred.object_id != :Fred.object_id\n=&gt; true\n</code></pre>\n\n<p>Which means that <code>Fred</code> is a reference to the module while <code>:Fred</code> is a value (a symbol).</p>\n\n<p>Symbols like strings are a value and thus cannot be a used as a reference. This is very much like <code>true</code>, <code>false</code> and <code>nil</code> which are singleton objects.</p>\n\n<pre><code>irb(main):008:0&gt; true.class\n=&gt; TrueClass\nirb(main):09:0&gt; true.object_id == true.object_id\n=&gt; true\n# you can even use the singletons as hash keys\nirb(main):010:0&gt; { true =&gt; 1, false =&gt; 2, nil =&gt; 3 }[true]\n=&gt; 1\n</code></pre>\n\n<p>The Rails example is not really that complicated. <code>:which_layout</code> is just an argument passed to the layout method. The layout method has a conditional which uses Object#send to dynamically call the :which_layout method if it exists. A string argument is instead used straight away to construct a glob.</p>\n"}], "owner": {"reputation": 2743, "user_id": 11758901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554e9af043165631ca992d1ec312395b?s=128&d=identicon&r=PG&f=1", "display_name": "jperl", "link": "https://stackoverflow.com/users/11758901/jperl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "accepted_answer_id": 57366069, "answer_count": 2, "score": 4, "last_activity_date": 1565181164, "creation_date": 1565025378, "last_edit_date": 1565181164, "question_id": 57363267, "link": "https://stackoverflow.com/questions/57363267/ruby-documentation-over-symbol-objects-is-misleading", "title": "Ruby documentation over Symbol objects is misleading", "body": "<p>I'm a newbie to Ruby and like others I had trouble wrapping my head around Ruby symbols. I know this subject has been brought up many times but I believe this post might slightly differ from the others. If not, my apologies. Take for instance this piece of code from the <a href=\"https://ruby-doc.org/core-2.5.0/Symbol.html\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n\n<pre><code>module One\n  class Fred\n  end\n  $f1 = :Fred\nend\nmodule Two\n  Fred = 1\n  $f2 = :Fred\nend\ndef Fred()\nend\n$f3 = :Fred\n$f1.object_id   #=&gt; 2514190\n$f2.object_id   #=&gt; 2514190\n$f3.object_id   #=&gt; 2514190\n</code></pre>\n\n<p>My gripe is that it makes us think there is a link between the class, the module or the function and the <code>:Fred</code> symbol. No wonder people ask things like \"can I assign a value to a symbol\" or is the symbol a reference to another thing.</p>\n\n<p>This code adds to the confusion :</p>\n\n<pre><code>class TestController &lt; ApplicationController\n\n    layout :which_layout\n\n    def index\n        ...\n    end\n\n    private\n\n    def which_layout\n        if condition\n            \"layout1\"\n        else\n            \"layout2\"\n        end\n    end\nend\n\n</code></pre>\n\n<p>At first, I thought there was a reference to the function but in fact it's just that the behavior of the <a href=\"https://apidock.com/rails/ActionView/Layouts/ClassMethods/layout\" rel=\"nofollow noreferrer\">layout</a> method will vary base on whether we'll pass a <code>String</code> (the template name) or a <code>Symbol</code> (call the method specified by the symbol) as stated by the documentation. (Does it look for a <code>method.to_sym</code> that is equivalent to the symbol we passed as argument?)</p>\n\n<p>What I believe I've read however is that when creating a class, his symbol counterpart will be automatically created, that is :Fred will already exist in subsequent calls. But that's just it?</p>\n\n<p>My question is : why did they have to include a class, a variable and a function to illustrate this? The context? Then why having the same name? Why not just do :</p>\n\n<pre><code>$f1 = :Fred\n$f2 = :Fred\n$f3 = :Fred\n\n$f1.object_id   #=&gt; 2514190\n$f2.object_id   #=&gt; 2514190\n$f3.object_id   #=&gt; 2514190\n</code></pre>\n"}, {"tags": ["ruby", "testing", "rspec", "internationalization"], "owner": {"reputation": 304, "user_id": 1046317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99260bd1182482ecdd7bc522965c0da3?s=128&d=identicon&r=PG", "display_name": "Gonzalo Moreno Caballero", "link": "https://stackoverflow.com/users/1046317/gonzalo-moreno-caballero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1565024069, "creation_date": 1565024069, "question_id": 57362960, "link": "https://stackoverflow.com/questions/57362960/how-to-translate-default-messages-in-rspec", "title": "How to translate default messages in Rspec?", "body": "<p>I am creating some tests with Rspec to validate that some exercises done in plain Ruby are valid and for that I need to know if it is possible to translate some messages that Rspec throws by default.\nFor example:</p>\n\n<p>I have a custom matcher called <code>should_have_attr_accessor.rb</code> and it has the following:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>RSpec::Matchers.define :have_attr_accessor do |field|\n  match do |object_instance|\n    object_instance.respond_to?(field) &amp;&amp;\n      object_instance.respond_to?(\"#{field}=\")\n  end\n\n  failure_message do |object_instance|\n    \"se espera un attr_accessor llamado #{field} en #{object_instance}\"\n  end\n\n  failure_message_when_negated do |object_instance|\n    \"se espera un attr_accessor llamado #{field} no definido en #{object_instance}\"\n  end\n\n  description do\n    \"afirmar que hay un attr_accessor de un nombre dado en el objeto proporcionado\"\n  end\nend\n</code></pre>\n\n<p>and I have my spec like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require \"spec_helper\"\nrequire_relative \"../lib/cuenta_bancaria\"\n\ndescribe CuentaBancaria do\n  context \"cuando es inicializada con cantidad de argumentos correctos\" do\n    subject { CuentaBancaria.new(\"Gonzalo\", 12345678 ) }\n    it { expect(subject).to   have_attr_accessor(:nombre_de_usuario) }\n  end\nend\n\n</code></pre>\n\n<p>The output of Rspec is as follows:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>\u279c rspec spec/cuenta_bancaria_spec.rb \n\nCuentaBancaria\n  cuando es inicializada con cantidad de argumentos correctos\n    should afirmar que hay un attr_accessor de un nombre dado en el objeto proporcionado\n</code></pre>\n\n<p>I want to translate \u201cshould\u201d to \u201cdeber\u00eda\u201d</p>\n\n<p>PD: I know I could leave it all in English and students should learn it, but I want to know if it is possible to translate the requested.</p>\n"}, {"tags": ["ruby", "algorithm"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1565023365, "post_id": 57362760, "comment_id": 101212081, "body": "What do you mean with &quot;continuous&quot;, and what do you mean with &quot;result should be 3&quot;?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 2, "creation_date": 1565023580, "post_id": 57362760, "comment_id": 101212194, "body": "Did a semester start or something? Seems early."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1565026058, "post_id": 57362760, "comment_id": 101213261, "body": "Please see the <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a> page."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1565026348, "post_id": 57362760, "comment_id": 101213373, "body": "...Also, though we know what you mean by &quot;sub arrays of zeroes&quot; it would be more accurate to say something like, &quot;numbers of groups of consecutive zeros&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 4, "last_activity_date": 1565023917, "last_edit_date": 1565023917, "creation_date": 1565023584, "answer_id": 57362836, "question_id": 57362760, "link": "https://stackoverflow.com/questions/57362760/find-count-of-sub-arrays-of-zeros-in-an-array/57362836#57362836", "title": "Find count of sub arrays of zeros in an array", "body": "<p><a href=\"https://ruby-doc.org/core-2.6.1/Enumerable.html#method-i-chunk_while\" rel=\"nofollow noreferrer\"><code>chunk_while</code></a> and <a href=\"https://ruby-doc.org/core-2.6.1/Enumerable.html#method-i-count\" rel=\"nofollow noreferrer\"><code>count</code></a> might work:</p>\n\n<pre><code>array\n  .chunk_while(&amp;:==)               # [[1, 1, 1], [0, 0], [1, 1, 1, 1], [0], [1, 1, 1], [0, 0, 0], [1]]\n  .count { |arr| arr.include?(0) } # 3\n</code></pre>\n\n<p>Or <a href=\"https://ruby-doc.org/core-2.6.1/Array.html#method-i-join\" rel=\"nofollow noreferrer\"><code>join</code></a>, <a href=\"https://ruby-doc.org/core-2.6.1/String.html#method-i-scan\" rel=\"nofollow noreferrer\"><code>scan</code></a> and <a href=\"https://ruby-doc.org/core-2.6.1/String.html#method-i-length\" rel=\"nofollow noreferrer\"><code>length</code></a>:</p>\n\n<pre><code>arr\n  .join         #\u00a0\"11100111101110001\"\n  .scan(/(0+)/) # [[\"00\"], [\"0\"], [\"000\"]]\n  .length       # 3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565027425, "post_id": 57362984, "comment_id": 101213780, "body": "What if <code>array</code> begins with a zero?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565027530, "post_id": 57362984, "comment_id": 101213817, "body": "Providing a C++ solution here is not especially helpful given the Ruby tag. That&#39;s because there&#39;s really only one way to obtain a solution with C++: step through the array looking for zeroes, then see if the zero is preceded by (or followed by) a zero. By contrast, the other answers illustrate the myriad ways the problem can be addressed using Ruby. If it were a different problem with a Ruby tag it&#39;s possible an innovate C++ solution might suggest a worthwhile Ruby approach, but that seems a stretch."}, {"owner": {"reputation": 1135, "user_id": 10829805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWjzQ.jpg?s=128&g=1", "display_name": "Faruk Hossain", "link": "https://stackoverflow.com/users/10829805/faruk-hossain"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565030541, "post_id": 57362984, "comment_id": 101215002, "body": "This solution will work also if array begins with a zero. In that case second if condition will be executed and that will increment <code>cnt</code>. @CarySwoveland"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565034886, "post_id": 57362984, "comment_id": 101216858, "body": "Yes. My mistake."}], "tags": [], "owner": {"reputation": 1135, "user_id": 10829805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWjzQ.jpg?s=128&g=1", "display_name": "Faruk Hossain", "link": "https://stackoverflow.com/users/10829805/faruk-hossain"}, "is_accepted": false, "score": 0, "last_activity_date": 1565024196, "creation_date": 1565024196, "answer_id": 57362984, "question_id": 57362760, "link": "https://stackoverflow.com/questions/57362760/find-count-of-sub-arrays-of-zeros-in-an-array/57362984#57362984", "title": "Find count of sub arrays of zeros in an array", "body": "<p>I am providing this solution to understand the basic solution's idea of this problem. </p>\n\n<p>This is <strong>c++</strong> solution for counting number of <strong>0</strong> sub-array. Increment result when we get a <strong>0</strong>. And when we get more than one zero then don't count for them.</p>\n\n<pre><code>int n = arr.size();\nint cnt = 0;\nfor(int i = 0; i &lt; n; i++) {\n    if(i &gt; 0 &amp;&amp; arr[i] == arr[i-1]) {\n        continue;\n    }\n    if(arr[i] == 0) {\n        cnt++;\n    }\n}\ncout &lt;&lt; cnt &lt;&lt; endl;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1565028638, "post_id": 57363180, "comment_id": 101214220, "body": "Clever use of <code>#squeeze</code> but the unspoken assumption is that the arrays are always as presented (i.e. only zeros and ones)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1565029184, "post_id": 57363180, "comment_id": 101214444, "body": "@muistooshort, I don&#39;t think that assumption is necessary provide the element of interest is a single digit. Note that I could have just squeezed the zeroes. In fact, that would probably be better. I debated whether that solution is a hack and came down on the side it&#39;s not."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 5, "last_activity_date": 1565216409, "last_edit_date": 1565216409, "creation_date": 1565025018, "answer_id": 57363180, "question_id": 57362760, "link": "https://stackoverflow.com/questions/57362760/find-count-of-sub-arrays-of-zeros-in-an-array/57363180#57363180", "title": "Find count of sub arrays of zeros in an array", "body": "<pre><code>array.join.squeeze('0').count('0')\n  #=&gt; 3\n</code></pre>\n\n<p>We have</p>\n\n<pre><code>s = array.join\n  #=&gt; \"11100111101110001\" \nt = s.squeeze('0')\n  #=&gt; \"11101111011101\" \nt.count('0')\n  #=&gt; 3 \n</code></pre>\n\n<p>Note one could squeeze all the characters, not just the zeroes (<code>squeeze</code> as opposed to <code>squeeze('0')</code>).</p>\n\n<p>Another way:</p>\n\n<pre><code>array = [1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0]\n\narray.select.with_index(1) { |n,i| n.zero? &amp;&amp; array[i] != 0 }.size\n  #=&gt; 3\n</code></pre>\n\n<p>When, as here, the last element of <code>array</code> is a zero, <code>array[i] #=&gt; nil</code> when <code>i = array.size</code> (since <code>i</code> goes from <code>1</code> to <code>array.size</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1565033504, "post_id": 57364717, "comment_id": 101216308, "body": "It took me a while to figure out the <code>chunk(&amp;:zero?)</code> step, thanks for the explanation."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 3, "last_activity_date": 1565033154, "last_edit_date": 1565033154, "creation_date": 1565032000, "answer_id": 57364717, "question_id": 57362760, "link": "https://stackoverflow.com/questions/57362760/find-count-of-sub-arrays-of-zeros-in-an-array/57364717#57364717", "title": "Find count of sub arrays of zeros in an array", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-chunk\" rel=\"nofollow noreferrer\"><code>Enumerable#chunk</code></a> and <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-count\" rel=\"nofollow noreferrer\"><code>Enumerable#count</code></a> to handle this as well like so:</p>\n\n<p><strong>Option 1:</strong></p>\n\n<pre><code>arr = [1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1]\narr.chunk(&amp;:zero?).count(&amp;:first)\n#=&gt; 3 \n</code></pre>\n\n<p><code>chunk</code> will group consecutive elements together by their return value in the form of <code>[return_value, [*elements]]</code> so in this case <code>chunk(&amp;:zero?)</code> will create groups like so </p>\n\n<pre><code>arr.chunk(&amp;:zero?).to_a\n#=&gt;  [[false, [1, 1, 1]], \n#     [true, [0, 0]], \n#     [false, [1, 1, 1, 1]], \n#     [true, [0]], \n#     [false, [1, 1, 1]], \n#     [true, [0, 0, 0]], \n#     [false, [1]]]\n</code></pre>\n\n<p>However <code>chunk</code> does not create a new <code>Array</code> (thus the <code>to_a</code> above to show the structure) instead it creates an <code>Enumerator</code> that stores this block of code and evaluates the return value upon subsequent method calls. </p>\n\n<p>In this case we are then calling <code>count(&amp;:first)</code> since <code>count</code> will only count the elements for which the block returns a truthy value (not <code>nil</code> or <code>false</code>).</p>\n\n<p><strong>Option 2:</strong></p>\n\n<pre><code>arr.chunk {|e| e.zero? || nil}.count\n#=&gt; 3 \n</code></pre>\n\n<p>Very similar to Option 1 this works because <code>chunk</code> will drop all elements where the return value is <code>nil</code> meaning </p>\n\n<pre><code>arr.chunk {|e| e.zero? || nil}.to_a \n#=&gt; [[true, [0, 0]], [true, [0]], [true, [0, 0, 0]]] \n</code></pre>\n\n<p><strong>Bonus:</strong> (just for fun in case you need to count other consecutive elements) </p>\n\n<pre><code>groups = arr.chunk(&amp;:itself)\n  .each_with_object(Hash.new {|h,k| h[k] =[]}) do |(e,arr),obj| \n    obj[e] &lt;&lt; arr\n  end\n#=&gt; {1=&gt;[[1, 1, 1], [1, 1, 1, 1], [1, 1, 1], [1]], \n#    0=&gt;[[0, 0], [0], [0, 0, 0]]}\ngroups[0].size \n#=&gt; 3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1565035303, "creation_date": 1565035303, "answer_id": 57365378, "question_id": 57362760, "link": "https://stackoverflow.com/questions/57362760/find-count-of-sub-arrays-of-zeros-in-an-array/57365378#57365378", "title": "Find count of sub arrays of zeros in an array", "body": "<p>Yet another way...</p>\n\n<pre><code>array.each_with_object([]){ |a, ary| ary &lt;&lt; a unless ary.last == a }.count(&amp;:zero?)\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 11347906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qoAGArQpAPQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVLjRNnqCXF01NVMsS2UXMwZJKCg/mo/photo.jpg?sz=128", "display_name": "Y.Z", "link": "https://stackoverflow.com/users/11347906/y-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 57362836, "answer_count": 5, "score": -3, "last_activity_date": 1565216409, "creation_date": 1565023301, "last_edit_date": 1565023556, "question_id": 57362760, "link": "https://stackoverflow.com/questions/57362760/find-count-of-sub-arrays-of-zeros-in-an-array", "title": "Find count of sub arrays of zeros in an array", "body": "<p>I need to find the count of sub arrays of zeros in an array:</p>\n\n<pre><code>array = [1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1]\n</code></pre>\n\n<p>Result should be: <code>3</code> because we have <code>0, 0</code>, <code>0</code> and <code>0, 0, 0</code>.</p>\n\n<p>Counting the number of zeros (6) will not work.</p>\n"}, {"tags": ["ruby", "mongodb", "mongoid"], "comments": [{"owner": {"reputation": 9592, "user_id": 9540925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhOpI.png?s=128&g=1", "display_name": "D. SM", "link": "https://stackoverflow.com/users/9540925/d-sm"}, "edited": false, "score": 0, "creation_date": 1565026889, "post_id": 57362715, "comment_id": 101213561, "body": "You say:  &gt;     Person.find(the_very_same_id_obtained_above)  However, <code>the_very_same_id_obtained_above</code> is not defined anywhere in your question."}, {"owner": {"reputation": 1, "user_id": 697559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aefcbf4d0ffffd2d7abdf4344cead8f?s=128&d=identicon&r=PG", "display_name": "Sante Rotondi", "link": "https://stackoverflow.com/users/697559/sante-rotondi"}, "reply_to_user": {"reputation": 9592, "user_id": 9540925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhOpI.png?s=128&g=1", "display_name": "D. SM", "link": "https://stackoverflow.com/users/9540925/d-sm"}, "edited": false, "score": 0, "creation_date": 1565080599, "post_id": 57362715, "comment_id": 101229012, "body": "It is referred to the id of the person found in the first query"}, {"owner": {"reputation": 9592, "user_id": 9540925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhOpI.png?s=128&g=1", "display_name": "D. SM", "link": "https://stackoverflow.com/users/9540925/d-sm"}, "edited": false, "score": 0, "creation_date": 1565656439, "post_id": 57362715, "comment_id": 101412271, "body": "Most likely you made a mistake in your code somewhere and are not querying for the IDs returned by the database. Maybe there are unexpected type conversions involved. Another possibility is you are using other old software which has bugs. IDs can be generated by the application and are not required to be in a particular format. Consider creating a small but complete reproduce case illustrating the problem."}], "answers": [{"tags": [], "owner": {"reputation": 3077, "user_id": 1257369, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UVwvN.gif?s=128&g=1", "display_name": "everyman", "link": "https://stackoverflow.com/users/1257369/everyman"}, "is_accepted": false, "score": 0, "last_activity_date": 1567163725, "creation_date": 1567163725, "answer_id": 57725720, "question_id": 57362715, "link": "https://stackoverflow.com/questions/57362715/how-to-fix-document-not-found-errors-with-find/57725720#57725720", "title": "How to Fix Document Not Found errors with find", "body": "<p>That's the default:</p>\n\n<pre><code> # Raise an error when performing a #find and the document is not found.\n # (default: true)\n raise_not_found_error: true\n</code></pre>\n\n<p>Source: <a href=\"https://docs.mongodb.com/mongoid/current/tutorials/mongoid-configuration/#anatomy-of-a-mongoid-config\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/mongoid/current/tutorials/mongoid-configuration/#anatomy-of-a-mongoid-config</a></p>\n\n<p>If this doesn't answer your question, it's very likely the <code>find</code> method is overridden somewhere in your code!</p>\n"}], "owner": {"reputation": 1, "user_id": 697559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aefcbf4d0ffffd2d7abdf4344cead8f?s=128&d=identicon&r=PG", "display_name": "Sante Rotondi", "link": "https://stackoverflow.com/users/697559/sante-rotondi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1567163725, "creation_date": 1565023098, "last_edit_date": 1565080648, "question_id": 57362715, "link": "https://stackoverflow.com/questions/57362715/how-to-fix-document-not-found-errors-with-find", "title": "How to Fix Document Not Found errors with find", "body": "<p>I have a collection of Person, stored in a legacy mongodb server (2.4) and accessed with the mongoid gem via the ruby mongodb driver.</p>\n\n<p>If I perform a </p>\n\n<pre><code>    Person.where(email: 'some.existing.email@server.tld').first\n</code></pre>\n\n<p>I get a result (let's assume I store the id in a variable called \"the_very_same_id_obtained_above\")</p>\n\n<p>If I perform a </p>\n\n<pre><code>    Person.find(the_very_same_id_obtained_above)\n</code></pre>\n\n<p>I got a </p>\n\n<pre><code>    Mongoid::Errors::DocumentNotFound\n</code></pre>\n\n<p>exception</p>\n\n<p>If I use the javascript syntax to perform the query, the result is found</p>\n\n<pre><code>   Person.where(\"this._id == #{the_very_same_id_obtained_above}\").first # this works!\n</code></pre>\n\n<p>I'm currently trying to migrate the data to a newever version. Currently mongodbrestore-ing on amazon documentdb to make tests (mongodb 3.6 compatible) and the issue remains.</p>\n\n<p>One thing I noticed is that those object ids are peculiar:</p>\n\n<p>5ce24b1169902e72c9739ff6 this works anyway</p>\n\n<p>59de48f53137ec054b000004 this requires the trick</p>\n\n<p>The small number of zeroes toward the end of the id seems to be highly correlated with the problem (I have no idea of the reason).</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "user-input"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1565023518, "post_id": 57362705, "comment_id": 101212166, "body": "What have you tried googling? This answer should be in the first hit. Also, you&#39;re constructing your array incorrectly."}], "answers": [{"tags": [], "owner": {"reputation": 560, "user_id": 11883546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab46bcd1aad9d7d7e8629d555d263a90?s=128&d=identicon&r=PG", "display_name": "Violeta", "link": "https://stackoverflow.com/users/11883546/violeta"}, "is_accepted": false, "score": 0, "last_activity_date": 1565027666, "creation_date": 1565027666, "answer_id": 57363787, "question_id": 57362705, "link": "https://stackoverflow.com/questions/57362705/how-to-print-correlating-index-number-in-an-array-based-on-user-input/57363787#57363787", "title": "How to print correlating index number in an array based on user input", "body": "<p>If you want to access an element in array you need to store the value of the input as Integer. So, you need to use the method <strong>to_i</strong>:</p>\n\n<pre><code>response = gets.chomp.to_i\n</code></pre>\n\n<p>By default, the <strong>gets</strong> method takes the user input as a String, so you need to explicitly convert it to Integer.</p>\n\n<p>Now, you can easily access a particular element in the array:</p>\n\n<pre><code>puts \"The word is #{array[response]}.\"\n</code></pre>\n\n<p>Where <strong>array</strong> is the name of the array and <strong>response</strong> is the number that the user entered.</p>\n\n<p>Find more informations here:\n<a href=\"https://docs.ruby-lang.org/en/2.0.0/Array.html\" rel=\"nofollow noreferrer\">class Array</a>\n<a href=\"https://apidock.com/ruby/String/to_i\" rel=\"nofollow noreferrer\">to_i</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11885551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f51431f3d43252488110bfccb8aa290d?s=128&d=identicon&r=PG&f=1", "display_name": "hailey_chicago", "link": "https://stackoverflow.com/users/11885551/hailey-chicago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565027666, "creation_date": 1565023045, "question_id": 57362705, "link": "https://stackoverflow.com/questions/57362705/how-to-print-correlating-index-number-in-an-array-based-on-user-input", "title": "How to print correlating index number in an array based on user input", "body": "<p>I am new to coding, started learning Ruby arrays this week. I am a bit stuck on this problem that asks: </p>\n\n<p>Create a program that asks a user to enter four different words, one at a time. Then, the computer will ask the user to choose a number between 0 and 3. The computer will then display the word corresponding to the correct number:</p>\n\n<p>array = [\"response_zero\", \"response_one\", \"response_two\", \"response_three\"]</p>\n\n<p>puts \"Welcome! Enter 4 words, one at a time:\"</p>\n\n<ol start=\"4\">\n<li><p>times do</p>\n\n<p>response = gets.chomp</p>\n\n<p>end </p></li>\n</ol>\n\n<p>puts \"Now, guess a number between 0 and 3.\"</p>\n\n<p>response = gets.chomp</p>\n\n<p>** stuck right here on how to get the users entered number to print out the correlating array index. My professor hinted at only needing one line of code below the second response = gets.chomp, but haven't been able to figure it out for the past day.</p>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "performance", "rest-client"], "comments": [{"owner": {"reputation": 3597, "user_id": 2112512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9689bb4f705b8bede56deddf66c87ef?s=128&d=identicon&r=PG", "display_name": "Jake Worth", "link": "https://stackoverflow.com/users/2112512/jake-worth"}, "edited": false, "score": 0, "creation_date": 1565019150, "post_id": 57361664, "comment_id": 101210213, "body": "This seems unusual. Is it happening consistently when you POST to this endpoint?"}, {"owner": {"reputation": 538, "user_id": 1524350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CzH1W.jpg?s=128&g=1", "display_name": "Sasha B.", "link": "https://stackoverflow.com/users/1524350/sasha-b"}, "reply_to_user": {"reputation": 3597, "user_id": 2112512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9689bb4f705b8bede56deddf66c87ef?s=128&d=identicon&r=PG", "display_name": "Jake Worth", "link": "https://stackoverflow.com/users/2112512/jake-worth"}, "edited": false, "score": 0, "creation_date": 1565020259, "post_id": 57361664, "comment_id": 101210730, "body": "yes, currently only on POST!"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1565020670, "post_id": 57361664, "comment_id": 101210890, "body": "I had a similar issue previously, one of old gems caused the issue and slowed my development project. If im not wrong it was one of logging gems..."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565020973, "post_id": 57361664, "comment_id": 101211021, "body": "It could be compiling assets. Can you post the contents of <code>config&#47;environments&#47;development.rb</code> ?"}, {"owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1565028341, "post_id": 57361664, "comment_id": 101214104, "body": "Also post your gemfile"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1565061320, "post_id": 57361664, "comment_id": 101222467, "body": "Does that happen on any action or only that one? Use a gem like byebug, put a <code>byebug</code> breakpoint at the beginning of the action and move through the code to narrow the cause down. Do you use any external API?"}], "answers": [{"tags": [], "owner": {"reputation": 538, "user_id": 1524350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CzH1W.jpg?s=128&g=1", "display_name": "Sasha B.", "link": "https://stackoverflow.com/users/1524350/sasha-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1565104119, "last_edit_date": 1565104119, "creation_date": 1565079435, "answer_id": 57371726, "question_id": 57361664, "link": "https://stackoverflow.com/questions/57361664/why-rails-response-takes-one-minute-in-development-mode/57371726#57371726", "title": "Why Rails response takes one minute in development mode?", "body": "<p>Found cause of slow down.\nSomebody of our team added delayed service into the controller.</p>\n\n<p>After commenting <code>#require 'sidekiq/testing/inline'</code> in the <code>config/environments/development.rb</code> and running separate <code>sidekiq -C config/sidekiq.yml</code> it solved the problem, now service is running asynchronously.</p>\n\n<p>But problem was inside the service where was the call <code>RestClient.post(endpoint, payload.to_json, 'api-key': api_key)</code> which was wrapped into <code>begin rescue end</code> block that catch the error (that raises in a minute by RestClient timeout).</p>\n\n<pre><code>Completed 401 Unauthorized in 62562ms (ActiveRecord: 191.5ms)\n\nRestClient::Exceptions::ReadTimeout (Timed out reading data from server):\n</code></pre>\n"}], "owner": {"reputation": 538, "user_id": 1524350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CzH1W.jpg?s=128&g=1", "display_name": "Sasha B.", "link": "https://stackoverflow.com/users/1524350/sasha-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1565104235, "creation_date": 1565018767, "last_edit_date": 1565104235, "question_id": 57361664, "link": "https://stackoverflow.com/questions/57361664/why-rails-response-takes-one-minute-in-development-mode", "title": "Why Rails response takes one minute in development mode?", "body": "<p>Can't understand why my rails app become make response ultra-slow - in 1 minute!</p>\n\n<p>As i see total time Rails should be: Views 0.2ms +  ActiveRecord 219.5ms + Solr 379.7ms = 599.4ms</p>\n\n<p>But it takes 62615ms, where is it spending the rest of time 62015.6ms?</p>\n\n<pre><code>Started POST \"/applications/135\" for ::1 at 2019-08-05 17:59:04 +0300\nProcessing by ApplicationController#create as JS\n\n...\n\nCompleted 200 OK in 62615ms (Views: 0.2ms | ActiveRecord: 219.5ms | Solr: 379.7ms)\n</code></pre>\n\n<p><code>config/environments/development.rb</code>:</p>\n\n<pre><code># frozen_string_literal: true\n\nrequire 'sidekiq/testing/inline'\n\nRails.application.configure do\n  # Settings specified here will take precedence over those in config/application.rb.\n  # Verifies that versions and hashed value of the package contents in the project's package.json\n  config.webpacker.check_yarn_integrity = false\n\n  # In the development environment your application's code is reloaded on\n  # every request. This slows down response time but is perfect for development\n  # since you don't have to restart the web server when you make code changes.\n  config.cache_classes = false\n\n  # Do not eager load code on boot.\n  config.eager_load = false\n\n  # Show full error reports and disable caching.\n  config.consider_all_requests_local       = true\n  config.action_controller.perform_caching = false\n\n  # Print deprecation notices to the Rails logger.\n  config.active_support.deprecation = :log\n\n  # Raise an error on page load if there are pending migrations.\n  config.active_record.migration_error = :page_load\n\n  # Debug mode disables concatenation and preprocessing of assets.\n  # This option may cause significant delays in view rendering with a large\n  # number of complex assets.\n  config.assets.debug = false\n\n  # Asset digests allow you to set far-future HTTP expiration dates on all assets,\n  # yet still be able to expire them through the digest params.\n  config.assets.digest = true\n\n  # Adds additional error checking when serving assets at runtime.\n  # Checks for improperly declared sprockets dependencies.\n  # Raises helpful error messages.\n  config.assets.raise_runtime_errors = true\n\n  # Raises error for missing translations\n  # config.action_view.raise_on_missing_translations = true\n\n  # SMTP configuration\n  config.action_mailer.default_url_options = {\n    host: ENV['HOST']\n  }\n  config.action_mailer.delivery_method = :letter_opener\n  config.action_mailer.perform_deliveries = true\n  # Care if the mailer can't send.\n  config.action_mailer.raise_delivery_errors = true\nend\n</code></pre>\n"}, {"tags": ["ruby", "haskell", "scheme", "continuations", "continuation-passing"], "comments": [{"owner": {"reputation": 81784, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 1, "creation_date": 1565020672, "post_id": 57361469, "comment_id": 101210893, "body": "<code>call&#47;cc(f) = f(cc)</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 81784, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 1, "creation_date": 1565021277, "post_id": 57361469, "comment_id": 101211155, "body": "@rampion That is intuitive, but wrong (AFAICS). It would cause <code>g(call&#47;cc(f)) = g(f(cc)) = call&#47;cc(g . f)</code>, where the last <code>.</code> denotes function composition, and this is clearly not what we want. The point is that, intuitively, <code>f</code> should receive the continuation &quot;without <code>f</code> itself&quot;, when <code>f(cc)</code> includes <code>f</code> in the continuation."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1565024636, "post_id": 57361469, "comment_id": 101212664, "body": "Haskell <i>doesn&#39;t</i> natively support continuations. Delimited continuations can be implemented in the language (e.g., the <code>ContT r</code> monad transformer and various CPSish things like <code>Codensity</code>), but there is no support whatsoever for undelimited continuations like Scheme has."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1565026252, "last_edit_date": 1565026252, "creation_date": 1565021135, "answer_id": 57362290, "question_id": 57361469, "link": "https://stackoverflow.com/questions/57361469/can-the-cps-styled-call-cc-be-written-in-terms-of-a-hypothetical-non-cps-style/57362290#57362290", "title": "Can the CPS-styled `call/cc` be written in terms of a hypothetical non-CPS-styled `cc&#39;`?", "body": "<p>Here's my attempt (warning: I am an inexperienced schemer). Let <code>get-cc</code> be the function returning the current continuation.</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>(define (get-cc)\n  (call-with-current-continuation (lambda (k) k)))\n</code></pre>\n\n<p>Then, we can define:</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>(define (callCC f)\n  (let ((w (get-cc)))\n    (if (pair? w)\n      (car w)\n      (f (lambda (x) (w (cons x '())))))))\n</code></pre>\n\n<p>The first time this function is called, <code>w</code> is bound to the current continuation. So, <code>(pair? w)</code> is false, and we call <code>f</code> with continuation <code>(lambda (x) (w (cons x '()))</code>.</p>\n\n<p>When <code>w</code> is called though <code>f</code> (with argument <code>(cons x '())</code>), then the body of the <code>let</code> is entered again, where <code>w</code> is now bound to <code>(cons x '())</code>.\nNow, <code>(pair? w)</code> is true, and we can return <code>(car w)</code> which is <code>x</code>.</p>\n\n<p>The pair wrapper is used so as to distinguish what is \"the continuation for <code>f</code>\" from \"the result <em>from</em> <code>f</code>\", so to speak.</p>\n\n<p>A quick test shows this to be working, but I'm not completely confident of its correctness.</p>\n\n<p>You probably noticed that <code>w</code> is bound to values of different types. That is why I resorted to an untyped language like Scheme instead of Haskell.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10082400"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1565026252, "creation_date": 1565017981, "last_edit_date": 1565026014, "question_id": 57361469, "link": "https://stackoverflow.com/questions/57361469/can-the-cps-styled-call-cc-be-written-in-terms-of-a-hypothetical-non-cps-style", "title": "Can the CPS-styled `call/cc` be written in terms of a hypothetical non-CPS-styled `cc&#39;`?", "body": "<p>In a language which supports continuation, e.g. Scheme, Ruby, and Haskell, suppose there is a function <code>cc'</code> which takes no argument and return the current continuation, so that the caller that obtains a continuation by calling <code>cc'</code> can then invoke the continuation anywhere and as often as it likes. </p>\n\n<p><code>cc'</code> can be written in terms of the CPS-styled <code>call/cc</code>, by passing an identity function as an argument to <code>call/cc</code>.</p>\n\n<p>Conversely, can the CPS-styled <code>call/cc</code> be written in terms of the non-CPS-styled <code>cc'</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "is_accepted": false, "score": 0, "last_activity_date": 1565018129, "last_edit_date": 1565018129, "creation_date": 1565014279, "answer_id": 57360370, "question_id": 57360294, "link": "https://stackoverflow.com/questions/57360294/rails-install-fail-by-permission-denied/57360370#57360370", "title": "Rails install fail by permission denied", "body": "<p>Try</p>\n\n<pre><code>sudo chown -R $USER /usr/local/lib/ruby\n</code></pre>\n\n<p>And bundle install again or gem install again and netter not use sudo on gem install</p>\n"}], "owner": {"reputation": 131, "user_id": 11620467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AagId.png?s=128&g=1", "display_name": "KAEDE", "link": "https://stackoverflow.com/users/11620467/kaede"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1565018129, "creation_date": 1565014033, "question_id": 57360294, "link": "https://stackoverflow.com/questions/57360294/rails-install-fail-by-permission-denied", "title": "Rails install fail by permission denied", "body": "<h1>nokogiri install failure</h1>\n\n<h2>What I want</h2>\n\n<p>Install ruby on rails</p>\n\n<h3>error</h3>\n\n<p>Gemfile is done, and I want to install rails.<br>\nObaying the document, <code>bundle install --path=vendor/bundle</code><br>\nbut \nAn error occurred while installing nokogiri (1.10.3), \nand Bundler cannot continue. The error is here.  </p>\n\n<pre><code>Make sure that `gem install nokogiri -v '1.10.3'\n--source 'https://rubygems.org/'` succeeds before bundling.\n</code></pre>\n\nanswer\n\n<p>I searched google for the error message, then find<br>\n[incompatible-library-version]\n(<a href=\"https://stackoverflow.com/questions/18818926/incompatible-library-version-nokogiri-bundle-requires-version-11-0-0-or-later\">Incompatible library version: nokogiri.bundle requires version 11.0.0 or later, but libxml2.2.dylib</a>)</p>\n\n<pre><code> sudo gem uninstall nokogiri\n gem uninstall nokogiri\n</code></pre>\n\n<p>sudo gem uninstall nokogiri\nI obaied the command but it cause new error:  </p>\n\n<pre><code>Permission denied @ rb_sysopen - /usr/local/lib/ruby/gems/2.6.0/gems/nokogiri-1.10.3/LICENSE-DEPENDENCIES.md\n</code></pre>\n\n<p>There 1614 lines dependencies document, \nbut I cannot find out what to do next.</p>\n\n<p>Please help me (>&lt;)</p>\n"}, {"tags": ["ruby", "imap"], "answers": [{"comments": [{"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 0, "creation_date": 1565017167, "post_id": 57360569, "comment_id": 101209249, "body": "Also make sure you&#39;re configured for SSL."}, {"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 0, "creation_date": 1565017211, "post_id": 57360569, "comment_id": 101209283, "body": "It also looks like it&#39;s trying to connect via IPv6, which may not be configured properly?"}], "tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1565015810, "last_edit_date": 1565015810, "creation_date": 1565014904, "answer_id": 57360569, "question_id": 57358883, "link": "https://stackoverflow.com/questions/57358883/using-net-imap-connecting-to-imap-google-gives-error/57360569#57360569", "title": "Using net/imap connecting to imap.google gives error", "body": "<p>Based on error backtrace its trying to connect via tcp port 143:</p>\n\n<pre><code>Network is unreachable - connect(2) for [2a00:1450:400c:c07::6d]:143\n</code></pre>\n\n<p>and you tested it via 993:</p>\n\n<pre><code>radoslav@radoslav-VirtualBox:~/Documents/Ruby/imap$ telnet imap.gmail.com 993\n</code></pre>\n\n<p>143 is a default value for imap based on <a href=\"https://ruby-doc.org/stdlib-2.5.3/libdoc/net/imap/rdoc/Net/IMAP.html#method-c-new\" rel=\"nofollow noreferrer\"><code>docs</code></a> so change this line to pass correct port number:</p>\n\n<pre><code>imap = Net::IMAP.new('imap.gmail.com', port: 993)\n</code></pre>\n"}], "owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565015810, "creation_date": 1565009110, "last_edit_date": 1565009432, "question_id": 57358883, "link": "https://stackoverflow.com/questions/57358883/using-net-imap-connecting-to-imap-google-gives-error", "title": "Using net/imap connecting to imap.google gives error", "body": "<p>I am trying connect to my mail server using <code>net/imap</code> i get the following error </p>\n\n<blockquote>\n  <p>Traceback (most recent call last):\n              12: from imap.rb:15:in <code>&lt;main&gt;'\n              11: from imap.rb:5:in</code>method_name'\n              10: from imap.rb:5:in <code>new'\n               9: from /home/radoslav/.rbenv/versions/2.6.1/lib/ruby/2.6.0/net/imap.rb:1089:in</code>initialize'\n               8: from /home/radoslav/.rbenv/versions/2.6.1/lib/ruby/2.6.0/net/imap.rb:1132:in <code>tcp_socket'\n               7: from /home/radoslav/.rbenv/versions/2.6.1/lib/ruby/2.6.0/socket.rb:631:in</code>tcp'\n               6: from /home/radoslav/.rbenv/versions/2.6.1/lib/ruby/2.6.0/socket.rb:227:in <code>foreach'\n               5: from /home/radoslav/.rbenv/versions/2.6.1/lib/ruby/2.6.0/socket.rb:227:in</code>each'\n               4: from /home/radoslav/.rbenv/versions/2.6.1/lib/ruby/2.6.0/socket.rb:641:in <code>block in tcp'\n               3: from /home/radoslav/.rbenv/versions/2.6.1/lib/ruby/2.6.0/socket.rb:137:in</code>connect'\n               2: from /home/radoslav/.rbenv/versions/2.6.1/lib/ruby/2.6.0/socket.rb:56:in <code>connect_internal'\n               1: from /home/radoslav/.rbenv/versions/2.6.1/lib/ruby/2.6.0/socket.rb:1213:in</code>connect_nonblock'\n      /home/radoslav/.rbenv/versions/2.6.1/lib/ruby/2.6.0/socket.rb:1213:in `__connect_nonblock': Network is unreachable - connect(2) for [2a00:1450:400c:c07::6d]:143 (Errno::ENETUNREACH)</p>\n</blockquote>\n\n<p>and this is the code I am using:</p>\n\n<pre><code>require 'net/imap'\n\ndef method_name\n    imap = Net::IMAP.new('imap.gmail.com')\n    imap.authenticate('LOGIN', 'my.name.here@gmail.com', 'mypasshere')\n    imap.examine('INBOX')\n    imap.search([\"RECENT\"]).each do |message_id|\n        puts \"#{message_id}\"\n    end\n    puts \"Hello\"\nend\n\n\nmethod_name()\n</code></pre>\n\n<p>I suspect this has something to do with the system rather than the gem itself but couldn't find the solution in internet.</p>\n\n<p>The machine has internet access for sure. </p>\n\n<pre><code>radoslav@radoslav-VirtualBox:~/Documents/Ruby/imap$ telnet imap.gmail.com 993\nTrying 74.125.140.109...\nConnected to gmail-imap.l.google.com.\n</code></pre>\n"}, {"tags": ["ruby", "email", "ruby-on-rails-4", "heroku", "sendgrid"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1565008420, "post_id": 57358357, "comment_id": 101204333, "body": "Are there any entries in the log files, when you create a user? The <code>delay</code> in <code>UserMailer.delay.signup_email</code> implies that you are using some kind of background jobs. How did you configure those jobs runners?"}, {"owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1565013808, "post_id": 57358357, "comment_id": 101207361, "body": "I ran &quot;heroku rake jobs:work&quot; and got this message:  ``` UserMailer#signup_email: processed outbound mail in 20.7ms [Worker(host:bb4cc50d-c1fc-475a-b1ff-2004358ed429 pid:4)] Job UserMailer.signup_email (id=1) FAILED (0 prior attempts) with ActionView::Template::Error: no implicit conversion of Hash into String 2019-08-05T13:55:12+0000: [Worker(host:bb4cc50d-c1fc-475a-b1ff-2004358ed429 pid:4)] Job UserMailer.signup_email (id=1) FAILED (0 prior attempts) with ActionView::Template::Error: no implicit conversion of Hash into String ```"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565015226, "post_id": 57358357, "comment_id": 101208196, "body": "can you post full backtrace errors in your question?  Looks like the error is telling you where the problem is."}, {"owner": {"reputation": 602, "user_id": 657776, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/100000443919472/picture?type=large", "display_name": "pedrofs", "link": "https://stackoverflow.com/users/657776/pedrofs"}, "edited": false, "score": 0, "creation_date": 1565016385, "post_id": 57358357, "comment_id": 101208826, "body": "@MaxRah it says you have an error in your View. Please, post the view file and the full stack trace."}, {"owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "edited": false, "score": 0, "creation_date": 1565019740, "post_id": 57358357, "comment_id": 101210490, "body": "Fixed the issue. There were several syntax errors in the <code>user mailer</code> view. Thanks, everyone."}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "is_accepted": false, "score": 0, "last_activity_date": 1565019960, "creation_date": 1565019960, "answer_id": 57361994, "question_id": 57358357, "link": "https://stackoverflow.com/questions/57358357/rails-user-mailer-not-sending-emails-in-production/57361994#57361994", "title": "Rails user mailer not sending emails in production", "body": "<p>The issue was in the <code>signup_email.html.erb</code> file. The image source links had errors so I changed the line: </p>\n\n<p><code>&lt;img src=\"&lt;%= Rails.application.config.action_mailer.default_url_options %&gt;</code> </p>\n\n<p>to this:</p>\n\n<p><code>&lt;img src=\"&lt;%= Rails.application.config.action_mailer.default_url_options[:host] %&gt;</code></p>\n\n<p>This is because default_url_options is a <code>hash</code>.</p>\n"}], "owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565019960, "creation_date": 1565007093, "question_id": 57358357, "link": "https://stackoverflow.com/questions/57358357/rails-user-mailer-not-sending-emails-in-production", "title": "Rails user mailer not sending emails in production", "body": "<p>I have a user model with a method that should send a welcome email when a user submits their email address. After setting up sendgrid, no emails are fired when I submit an email.</p>\n\n<p>Here's my production.rb code:</p>\n\n<pre><code>config.action_mailer.default_url_options = { :host =&gt; ENV['DEFAULT_MAILER_HOST'] }\n\n  config.action_mailer.delivery_method = :smtp\n  config.action_mailer.smtp_settings = {\n    :address =&gt; 'smtp.sendgrid.net',\n    :port =&gt; '587',\n    :authentication =&gt; :plain,\n    :user_name =&gt; ENV['SENDGRID_USERNAME'],\n    :password =&gt; ENV['SENDGRID_PASSWORD'],\n    :domain =&gt; 'heroku.com',\n    :enable_starttls_auto =&gt; true\n  }\n</code></pre>\n\n<p>Parts of the user model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  validates :email, presence: true, uniqueness: true, format: {\n    with: /\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/i,\n    message: 'Invalid email format.'\n  }\n\n  after_create :send_welcome_email\n\n  private\n\n  def send_welcome_email\n    UserMailer.delay.signup_email(self)\n  end\nend\n</code></pre>\n\n<p>The user mail code:</p>\n\n<pre><code>class UserMailer &lt; ActionMailer::Base\n  default from: \"Example &lt;welcome@example.com&gt;\"\n\n  def signup_email(user)\n    @user = user\n\n    mail(:to =&gt; user.email, :subject =&gt; \"Thank you for joining!\")\n  end\nend\n\n</code></pre>\n\n<p>The heroku logs</p>\n\n<pre><code>2019-08-04T20:23:22.053028+00:00 app[web.1]:  (2.0ms)  COMMIT\n2019-08-04T20:23:22.054171+00:00 app[web.1]:  (0.6ms)  BEGIN\n2019-08-04T20:23:22.056282+00:00 app[web.1]: User Exists (0.8ms)  SELECT  1 AS one FROM \"users\" WHERE \"users\".\"email\" = 'max.ston@protonmail.com' LIMIT 1\n2019-08-04T20:23:22.058729+00:00 app[web.1]: User Exists (1.6ms)  SELECT  1 AS one FROM \"users\" WHERE \"users\".\"referral_code\" IS NULL LIMIT 1\n2019-08-04T20:23:22.067815+00:00 app[web.1]: User Load (0.8ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"referral_code\" = $1 LIMIT 1  [[\"referral_code\", \"49af69325b\"]]\n2019-08-04T20:23:22.072798+00:00 app[web.1]: SQL (1.2ms)  INSERT INTO \"users\" (\"email\", \"created_at\", \"updated_at\", \"referral_code\") VALUES ($1, $2, $3, $4) RETURNING \"id\"  [[\"email\", \"max.ston@protonmail.com\"], [\"created_at\", \"2019-08-04 20:23:22.059018\"], [\"updated_at\", \"2019-08-04 20:23:22.059018\"], [\"referral_code\", \"49af69325b\"]]\n2019-08-04T20:23:22.109242+00:00 app[web.1]: SQL (1.3ms)  INSERT INTO \"delayed_jobs\" (\"handler\", \"run_at\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3, $4) RETURNING \"id\"  [[\"handler\", \"--- !ruby/object:Delayed::PerformableMailer\\nobject: !ruby/class 'UserMailer'\\nmethod_name: :signup_email\\nargs:\\n- !ruby/object:User\\n  raw_attributes:\\n    email: max.ston@protonmail.com\\n    id: '3'\\n    referral_code: 49af69325b\\n    created_at: &amp;1 2019-08-04 20:23:22.059018923 Z\\n    updated_at: *1\\n    referrer_id: \\n  attributes: !ruby/object:ActiveRecord::AttributeSet\\n    attributes: !ruby/object:ActiveRecord::LazyAttributeHash\\n      types:\\n        id: &amp;3 !ruby/object:ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Integer\\n          precision: \\n          scale: \\n          limit: \\n          range: !ruby/range\\n            begin: -2147483648\\n            end: 2147483648\\n            excl: true\\n        email: &amp;2 !ruby/object:ActiveRecord::Type::String\\n          precision: \\n          scale: \\n          limit: \\n        referral_code: *2\\n        referrer_id: *3\\n        created_at: &amp;5 !ruby/object:ActiveRecord::AttributeMethods::TimeZoneConversion::TimeZoneConverter\\n          subtype: &amp;4 !ruby/object:ActiveRecord::ConnectionAdapters::PostgreSQL::OID::DateTime\\n            precision: \\n            scale: \\n            limit: \\n        updated_at: &amp;6 !ruby/object:ActiveRecord::AttributeMethods::TimeZoneConversion::TimeZoneConverter\\n          subtype: *4\\n      values:\\n        id: \\n        email: \\n        referral_code: \\n        referrer_id: \\n        created_at: \\n        updated_at: \\n      additional_types: {}\\n      materialized: true\\n      delegate_hash:\\n        email: !ruby/object:ActiveRecord::Attribute::FromUser\\n          name: email\\n          value_before_type_cast: max.ston@protonmail.com\\n          type: *2\\n          value: max.ston@protonmail.com\\n        id: !ruby/object:ActiveRecord::Attribute::FromUser\\n          name: id\\n          value_before_type_cast: '3'\\n          type: *3\\n          value: 3\\n        referral_code: !ruby/object:ActiveRecord::Attribute::FromUser\\n          name: referral_code\\n          value_before_type_cast: 49af69325b\\n          type: *2\\n          value: 49af69325b\\n        created_at: !ruby/object:ActiveRecord::Attribute::FromUser\\n          name: created_at\\n          value_before_type_cast: *1\\n          type: *5\\n          value: 2019-08-04 20:23:22.059018923 Z\\n        updated_at: !ruby/object:ActiveRecord::Attribute::FromUser\\n          name: updated_at\\n          value_before_type_cast: *1\\n          type: *6\\n          value: 2019-08-04 20:23:22.059018923 Z\\n        referrer_id: !ruby/object:ActiveRecord::Attribute::FromDatabase\\n          name: referrer_id\\n          value_before_type_cast: \\n          type: *3\\n  new_record: false\\n  active_record_yaml_version: 0\\n\"], [\"run_at\", \"2019-08-04 20:23:22.105001\"], [\"created_at\", \"2019-08-04 20:23:22.105297\"], [\"updated_at\", \"2019-08-04 20:23:22.105297\"]]\n2019-08-04T20:23:22.112611+00:00 app[web.1]:  (1.8ms)  COMMIT\n2019-08-04T20:23:22.113058+00:00 app[web.1]: Redirected to https://enigmatic-temple-XXXXX.herokuapp.com/refer-a-friend\n2019-08-04T20:23:22.113229+00:00 app[web.1]: Completed 302 Found in 70ms (ActiveRecord: 16.4ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1565006670, "post_id": 57358238, "comment_id": 101203259, "body": "What&#39;s the whole error you&#39;re getting? Is <code>my_attribute</code> really in the database as a table column?"}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 1, "creation_date": 1565006780, "post_id": 57358238, "comment_id": 101203320, "body": "Please include your models and the line of code the error is pointing to"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565018878, "post_id": 57358238, "comment_id": 101210094, "body": "see <a href=\"https://stackoverflow.com/questions/10301794/difference-between-rake-dbmigrate-dbreset-and-dbschemaload\" title=\"difference between rake dbmigrate dbreset and dbschemaload\">stackoverflow.com/questions/10301794/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 0, "last_activity_date": 1565038788, "last_edit_date": 1565038788, "creation_date": 1565038100, "answer_id": 57365912, "question_id": 57358238, "link": "https://stackoverflow.com/questions/57358238/must-boot-rails-console-before-dbseeds-for-seeds-to-work/57365912#57365912", "title": "Must boot rails console before db:seeds for seeds to work", "body": "<p>If you plan to do this all in 1 shot then in <code>db:seed</code> you will need to call <a href=\"https://apidock.com/rails/ActiveRecord/ModelSchema/ClassMethods/reset_column_information\" rel=\"nofollow noreferrer\"><code>ModelName.reset_column_information</code></a> for each model you intend to interact with.</p>\n\n<p>The reason for this is when the code is loaded the class <code>ModelName</code> does not have a table. The dynamic attribute methods are loaded from the table columns but since there is no table, there are no columns, and thus no methods. This result is cached with the model to avoid having to make this round trip every time you reference the model. </p>\n\n<p>Calling <code>reset_column_information</code> causes <code>ModelName</code> to reset this cache. This way the next time this model is referenced it will go back to the table (that now exists), reload all the columns (that now exist), and dynamically generate the methods pertinent to these columns.</p>\n\n<p>You must do this anytime you plan to: </p>\n\n<ul>\n<li>create a table or add columns to a table and;</li>\n<li>change the data in that table or new column during the <strong>same task run</strong> </li>\n</ul>\n\n<p>Please note <strong>same task run</strong> does not necessarily mean same migration or even same task itself. It can be any migration or seeding that could occur to complete the full run of a given task(s) like <code>db:migrate</code> or in your case <code>db:migrate db:seed</code>   </p>\n"}], "owner": {"reputation": 1588, "user_id": 3442951, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/oqtiY.png?s=128&g=1", "display_name": "Will Taylor", "link": "https://stackoverflow.com/users/3442951/will-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 57365912, "answer_count": 1, "score": -1, "last_activity_date": 1565038788, "creation_date": 1565006605, "last_edit_date": 1565014990, "question_id": 57358238, "link": "https://stackoverflow.com/questions/57358238/must-boot-rails-console-before-dbseeds-for-seeds-to-work", "title": "Must boot rails console before db:seeds for seeds to work", "body": "<p>On a project I'm working on, <code>rake db:drop db:create db:migrate db:seed</code> won't work. It raises <code>undefined method 'my_attribute=' for #&lt;MyObject:0x00007fd1af863908&gt;</code> error when running the db:seed task. There is seemingly nothing preventing MyObject calling my_attribute - it's a very standard enum field. If you remove the field a similar undefined method error occurs on other standard fields such a datetime field.</p>\n\n<p>However, running <code>rake db:drop db:create db:migrate</code>, then <code>rails console</code>, exiting the console, then running <code>rake db:seed</code> works fine.</p>\n\n<p>Has anyone experienced this?</p>\n\n<p>EDIT:</p>\n\n<p>The entire error is:</p>\n\n<pre><code>rake aborted!\nNoMethodError: undefined method `my_attribute=' for #&lt;MyObject:0x00007fa53bae34d0&gt;\n/Users/Will/.gems/ruby/2.5.0/gems/activemodel-5.2.2/lib/active_model/attribute_methods.rb:430:in `method_missing'\n/Users/Will/.gems/ruby/2.5.0/gems/pg_search-2.1.6/lib/pg_search.rb:81:in `method_missing'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/attribute_assigner.rb:16:in `public_send'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/attribute_assigner.rb:16:in `block (2 levels) in object'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/attribute_assigner.rb:15:in `each'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/attribute_assigner.rb:15:in `block in object'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/attribute_assigner.rb:14:in `tap'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/attribute_assigner.rb:14:in `object'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/evaluation.rb:13:in `object'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/strategy/create.rb:9:in `result'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/factory.rb:43:in `run'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/factory_runner.rb:29:in `block in run'\n/Users/Will/.gems/ruby/2.5.0/gems/activesupport-5.2.2/lib/active_support/notifications.rb:170:in `instrument'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/factory_runner.rb:28:in `run'\n/Users/Will/.gems/ruby/2.5.0/gems/factory_bot-5.0.2/lib/factory_bot/strategy_syntax_method_registrar.rb:20:in `block in define_singular_strategy_method'\n/my-project/db/seeds.rb:449:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>Where seeds.rb 499 is a factorybot.create task:</p>\n\n<pre><code>valid_opportunity = FactoryBot.create(:opportunity,\n  slug: 'french-sardines-required',\n  title: 'French sardines required',\n  response_due_on: 9.months.from_now,\n  author: editor,\n  service_provider: paris,\n  countries: [france],\n  sectors: [agriculture],\n  types: [private_sector],\n  values: [hundred_thousand],\n  created_at: 2.weeks.ago,\n  first_published_at: Time.zone.today,\n  source: :post,\n  status: :publish)\n</code></pre>\n\n<p>In the model we have:</p>\n\n<pre><code>class MyModel &lt; ApplicationRecord\n\n  enum my_attribute: { pending: 1, publish: 2, draft: 3, trash: 4 }\n\nend\n</code></pre>\n\n<p>Note that my_attribute is a real field in the database, and also that if the line around my_attribute is removed, a different field in the database for this model flags up a similar error.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "haml"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565000265, "post_id": 57356432, "comment_id": 101199981, "body": "<code>check_box_tag</code> is server-side concept. So is HAML. They don&#39;t exist in javascript. Do it similarly to how you do in your other JS file."}], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1565000341, "post_id": 57356553, "comment_id": 101200023, "body": "Creating a checkbox like this does not enable me to catch the value of it in rails params though, does it?"}, {"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565006764, "post_id": 57356553, "comment_id": 101203313, "body": "@SergioTulentsev I thought I had, however I did not specify the &#39;value&#39; attribute. The params list now contains the checkboxes that had been checked only."}, {"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1565007845, "post_id": 57356553, "comment_id": 101203989, "body": "@StefanN Is there a way to make the default value of the checkbox blank, or false? I need a way to require the params for the checkboxes inside of my join table model."}, {"owner": {"reputation": 746, "user_id": 8843654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2f2a8d854857043c173662b483811e?s=128&d=identicon&r=PG&f=1", "display_name": "StefanN", "link": "https://stackoverflow.com/users/8843654/stefann"}, "edited": false, "score": 0, "creation_date": 1565007926, "post_id": 57356553, "comment_id": 101204037, "body": "just add <code>checked=&quot;false&quot;</code> to the checkbox element ==&gt; <code>&lt;input type=&quot;checkbox&quot; checked=&quot;false&quot; &#47;&gt;</code>"}, {"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1565010061, "post_id": 57356553, "comment_id": 101205193, "body": "This seems to check the checkbox by default. When I uncheck it, it is not stored in params."}], "tags": [], "owner": {"reputation": 746, "user_id": 8843654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2f2a8d854857043c173662b483811e?s=128&d=identicon&r=PG&f=1", "display_name": "StefanN", "link": "https://stackoverflow.com/users/8843654/stefann"}, "is_accepted": true, "score": 1, "last_activity_date": 1565000249, "creation_date": 1565000249, "answer_id": 57356553, "question_id": 57356432, "link": "https://stackoverflow.com/questions/57356432/can-you-create-a-check-box-tag-inside-javascript/57356553#57356553", "title": "Can you create a check_box_tag inside javascript", "body": "<p>Just replace your HTML string with the following:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>$('#unorderedRight').append('&lt;li value=\"' + $(this).val() + '\" style=\"display:inline;\" title=\"'+ $(this).text()+'\" onclick=\"selectLi(this)\" selected=false&gt;&lt;input type=\"checkbox\" name=\"'+ $(this).text()+'\" value=\"'+ $(this).text()+'\" /&gt; '+$(this).text()+'&lt;/li&gt;&lt;br id=\"'+ $(this).text()+'_br\"&gt;');\n</code></pre>\n"}], "owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 57356553, "answer_count": 1, "score": 0, "last_activity_date": 1581308526, "creation_date": 1564999812, "last_edit_date": 1581308526, "question_id": 57356432, "link": "https://stackoverflow.com/questions/57356432/can-you-create-a-check-box-tag-inside-javascript", "title": "Can you create a check_box_tag inside javascript", "body": "<p>The way that elements are being created on the view is mainly through JavaScript. I'd like to be able to add a check_box_tag dynamically alongside a list item that is also created dynamically so that I can access the checkboxes in params.</p>\n\n<p>There is a haml file that is rendered alongside the JavaScript files, so I created a javascript function and called this in the JavaScript file that creates the rest of the elements.</p>\n\n<p>Script inside JS file:</p>\n\n<pre><code>$(options).each(function()\n        {\n          genCheckbox();\n          $('#unorderedRight').append('&lt;li value=\"' + $(this).val() + '\" style=\"display:inline;\" title=\"'+ $(this).text()+'\" onclick=\"selectLi(this)\" selected=false&gt;'+$(this).text()+'&lt;/li&gt;&lt;br id=\"'+ $(this).text()+'_br\"&gt;');\n}\n</code></pre>\n\n<p>Script inside haml file:</p>\n\n<pre><code>%script#genCheckbox\n  :plain\n    function genCheckbox()\n    {\n      $(\"#unorderedRight\").append(\"=check_box_tag 'someid', 'somename', false \");\n    }\n</code></pre>\n\n<p>The expected result is that a checkbox appears alongside the list item. It is instead showing \"=check_box_tag 'someid', 'somename', false\"</p>\n"}, {"tags": ["regex", "ruby", "string", "gsub"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1564999294, "post_id": 57356093, "comment_id": 101199476, "body": "It&#39;s very simple: <code>$N</code> means &quot;content of the N-th capture group from the match&quot;. It&#39;s in the <a href=\"https://ruby-doc.org/core-2.6.3/Regexp.html#class-Regexp-label-Special+global+variables\" rel=\"nofollow noreferrer\">docs</a>, BTW."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 2, "creation_date": 1564999441, "post_id": 57356093, "comment_id": 101199557, "body": "The regexp is weird though. Why <code>\\w+{2}</code>? It works, but... Weeeird. And depending on how the engine is implemented, might be inefficient. I&#39;d write <code>\\w{2,}</code>..."}, {"owner": {"reputation": 41, "user_id": 10166610, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212420616047247/picture?type=large", "display_name": "Rey", "link": "https://stackoverflow.com/users/10166610/rey"}, "edited": false, "score": 0, "creation_date": 1565000405, "post_id": 57356093, "comment_id": 101200057, "body": "Missed it in the docs. Thanks for the help with my pretty stupid question."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10166610, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212420616047247/picture?type=large", "display_name": "Rey", "link": "https://stackoverflow.com/users/10166610/rey"}, "edited": false, "score": 0, "creation_date": 1565000292, "post_id": 57356337, "comment_id": 101199996, "body": "So .gsub finds the matching criteria in the string as per the requirements of the regex and replaces each match with that specified in the string literal. Correct?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 41, "user_id": 10166610, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212420616047247/picture?type=large", "display_name": "Rey", "link": "https://stackoverflow.com/users/10166610/rey"}, "edited": false, "score": 1, "creation_date": 1565000828, "post_id": 57356337, "comment_id": 101200304, "body": "@Rey in the block form, <code>gsub</code> replaces each match with the block&#39;s result."}, {"owner": {"reputation": 348, "user_id": 4067389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4ba5b696cfd1a7690ebf43c92cde736?s=128&d=identicon&r=PG&f=1", "display_name": "Pritilender", "link": "https://stackoverflow.com/users/4067389/pritilender"}, "reply_to_user": {"reputation": 41, "user_id": 10166610, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212420616047247/picture?type=large", "display_name": "Rey", "link": "https://stackoverflow.com/users/10166610/rey"}, "edited": false, "score": 1, "creation_date": 1565004730, "post_id": 57356337, "comment_id": 101202267, "body": "@Rey yes, but it&#39;s not each <i>match</i>, it&#39;s each <b>capturing group</b>. Following regex won&#39;t work: <code>&#47;\\w\\w+{2}\\w&#47;</code>."}], "tags": [], "owner": {"reputation": 348, "user_id": 4067389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4ba5b696cfd1a7690ebf43c92cde736?s=128&d=identicon&r=PG&f=1", "display_name": "Pritilender", "link": "https://stackoverflow.com/users/4067389/pritilender"}, "is_accepted": true, "score": 1, "last_activity_date": 1564999489, "creation_date": 1564999489, "answer_id": 57356337, "question_id": 57356093, "link": "https://stackoverflow.com/questions/57356093/the-passing-of-a-string-incl-regex-parameters-to-a-block-of-code/57356337#57356337", "title": "The passing of a string (incl. regex parameters) to a block of code", "body": "<p>In your regex, you have 3 capturing groups: <code>\\w</code>, <code>\\w+{2}</code> and again <code>\\w</code>. When you later say <code>$N</code> (where <code>N</code> is some number), you are actually referring to the capturing group from the regex.</p>\n\n<p>The <code>String#gsub</code> methods populates these variables for you (<a href=\"https://ruby-doc.org/core-2.4.2/String.html#method-i-gsub\" rel=\"nofollow noreferrer\">Ruby doc</a>).</p>\n"}], "owner": {"reputation": 41, "user_id": 10166610, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212420616047247/picture?type=large", "display_name": "Rey", "link": "https://stackoverflow.com/users/10166610/rey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 57356337, "answer_count": 1, "score": -1, "last_activity_date": 1564999489, "creation_date": 1564998607, "last_edit_date": 1564999335, "question_id": 57356093, "link": "https://stackoverflow.com/questions/57356093/the-passing-of-a-string-incl-regex-parameters-to-a-block-of-code", "title": "The passing of a string (incl. regex parameters) to a block of code", "body": "<p>A string of length 4 letters or more needs to be returned in the following format:</p>\n\n<p>\"#{firstLetter}#{string.length-2}#{lastLetter}\"</p>\n\n<p>InputString = stackoverflow</p>\n\n<p>ExpectedString = s11w</p>\n\n<p>Here is the code that results in the correct expected output.</p>\n\n<pre><code>string.gsub /(\\w)(\\w+{2})(\\w)/ do |word|       \n      \"#{$1}#{word.length-2}#{$3}\"        \nend\n</code></pre>\n\n<p>I sort of get what's going on here but don't understand the exact relation between the regex and the use of $1 and $3. Sorta get it... but not enough to be able to use it in my own way for new problems.</p>\n"}, {"tags": ["ruby", "dry-validation"], "answers": [{"tags": [], "owner": {"reputation": 5563, "user_id": 282051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e864e5088627498df8f9b911a9bc3219?s=128&d=identicon&r=PG", "display_name": "solnic", "link": "https://stackoverflow.com/users/282051/solnic"}, "is_accepted": false, "score": 1, "last_activity_date": 1571650017, "creation_date": 1571650017, "answer_id": 58483400, "question_id": 57354801, "link": "https://stackoverflow.com/questions/57354801/how-prevent-dry-validation-execute-rule-if-schema-validation-did-not-passed/58483400#58483400", "title": "How prevent dry-validation execute rule if schema validation did not passed?", "body": "<p>A rule without any keys specified will always be executed. That's by design. If you want it to not be executed, simply provide which keys it depends on, ie:</p>\n\n<pre><code>rule(:title, :content) do\n  # won't be executed unless both title and content passed\n  # the schema checks\nend\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 5332839, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W124KKtHHPQ/AAAAAAAAAAI/AAAAAAAAABk/eKg3XVGBfww/photo.jpg?sz=128", "display_name": "Uysim Ty", "link": "https://stackoverflow.com/users/5332839/uysim-ty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1571650017, "creation_date": 1564993805, "last_edit_date": 1565014084, "question_id": 57354801, "link": "https://stackoverflow.com/questions/57354801/how-prevent-dry-validation-execute-rule-if-schema-validation-did-not-passed", "title": "How prevent dry-validation execute rule if schema validation did not passed?", "body": "<pre class=\"lang-rb prettyprint-override\"><code>class PostSchema &lt; Dry::Validation::Contract\n  params do\n    required(:title).value(:string, size: 20)\n    required(:content).value(:string, size: 50)\n  end \n\n  rule do \n     # prevent this rule to execute if shema validation did not passed\n  end\nend\n</code></pre>\n\n<p>My current work around is use result.schema_result.success?. Even this working but I look at the source code at <a href=\"https://github.com/dry-rb/dry-validation/blob/master/lib/dry/validation/result.rb#L41\" rel=\"nofollow noreferrer\">https://github.com/dry-rb/dry-validation/blob/master/lib/dry/validation/result.rb#L41</a>. It is private api. Anyone has any idea about this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "authentication", "devise", "doorkeeper"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1564989082, "post_id": 57353726, "comment_id": 101194796, "body": "did you restart server ?"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1564989718, "post_id": 57353726, "comment_id": 101195042, "body": "@Vishal My server is not starting it throws me this error :1: from /home/rubyians/.rvm/gems/ruby-2.6.3/gems/bootsnap-1.4.4/lib/&zwnj;&#8203;bootsnap/load_path_c&zwnj;&#8203;ache/core_ext/active&zwnj;&#8203;_support.rb:8:in without_bootsnap_cache&#39; /home/rubyians/.rvm/gems/ruby-2.6.3/gems/bootsnap-1.4.4/lib/&zwnj;&#8203;bootsnap/load_path_c&zwnj;&#8203;ache/core_ext/active&zwnj;&#8203;_support.rb:79:inblo&zwnj;&#8203;ck in load_missing_constant&#39;: uninitialized constant CustomTokenResponse (NameError)"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1564991124, "post_id": 57353726, "comment_id": 101195649, "body": "in the application.rb file did you write this <code>config.autoload_paths &lt;&lt; &quot;#{Rails.root}&#47;lib&quot;</code>?"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1564993888, "post_id": 57353726, "comment_id": 101196891, "body": "@Vishal Thanks ! That&#39;s seemed to work for my second issue. Now my first issue is remaining it shows unauthorized even if give correct access token."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1564994702, "post_id": 57353726, "comment_id": 101197244, "body": "Did you added token type <code>bearer</code> before token?"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1564995503, "post_id": 57353726, "comment_id": 101197627, "body": "@Vishal yes i did"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565001750, "post_id": 57353726, "comment_id": 101200739, "body": "It should work. try to login again with oauth token. and use it . again. make sure you didn&#39;t use devise authentication method <code>authenticate_user!</code> instead of doorkeeper method <code>doorkeeper_authorize!</code>"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565002081, "post_id": 57353726, "comment_id": 101200892, "body": "@Vishal yeah i tried replacing it with doorkeeper authorize but it now throws me error undefined user_project which i defined with      user_projects = current_user.user_projects.includes(:project)"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565002143, "post_id": 57353726, "comment_id": 101200921, "body": "Is this because it&#39;s not using the devise authentication?"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565008658, "post_id": 57353726, "comment_id": 101204445, "body": "In doorkeeper you can access current_user with <code>current_resource_owner</code>"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565065315, "post_id": 57353726, "comment_id": 101223228, "body": "Thanks a lot ! I had to do some more configuration you know Jayakrishnan aka JK ? He worked with you in moodit app he helped me."}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565067380, "post_id": 57353726, "comment_id": 101223693, "body": "Nope i am working in another project in the same company and he is my mentor."}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565067716, "post_id": 57353726, "comment_id": 101223779, "body": "Ya i will pass it to him."}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565067986, "post_id": 57353726, "comment_id": 101223858, "body": "Hey bro he asked you to contact him i will give you his contact number where shall i send it to you ?"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565068865, "post_id": 57353726, "comment_id": 101224100, "body": "Yea i will send it over there."}], "owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564988976, "creation_date": 1564988976, "question_id": 57353726, "link": "https://stackoverflow.com/questions/57353726/uninitialized-constant-customtokenresponsenameerror-and-unauthorized-access-fo", "title": "Uninitialized constant CustomTokenResponse(NameError) and Unauthorized Access for Valid Token", "body": "<p>I have been trying to migrate my rails app to api and i just installed doorkeeper gem for authentication and it generates me a token for a valid user. Now i have two problems </p>\n\n<ol>\n<li><p>It shows unauthorized access in logs when i try to get page even though my access token is correct</p></li>\n<li><p>I tried to put a custom token response for login and logout because it wasn't showing me any but it is now throwing me an error when i tried to run rails server</p></li>\n</ol>\n\n<p>I have followed this guide for the process </p>\n\n<p><a href=\"https://scotch.io/@jiggs/rails-api-doorkeeper-devise\" rel=\"nofollow noreferrer\">https://scotch.io/@jiggs/rails-api-doorkeeper-devise</a></p>\n\n<pre><code># frozen_string_literal: true\n\n#Doorkeeper.rb\n\nDoorkeeper.configure do\n  # Change the ORM that doorkeeper will use (needs plugins)\n  orm :active_record\n\n  # This block will be called to check whether the resource owner is authenticated or not.\n  resource_owner_authenticator do\n    # raise \"Please configure doorkeeper resource_owner_authenticator block located in #{__FILE__}\"\n    # Put your resource owner authentication logic here.\n    # Example implementation:\n    current_user || warden.authenticate!(:scope =&gt; :user)\n  end\n\n   resource_owner_from_credentials do |routes|\n    user = User.find_for_database_authentication(:email =&gt; params[:email])\n    if user &amp;&amp; user.valid_for_authentication? { user.valid_password?(params[:password]) }\n      user\n    end\n  end\n\n  skip_authorization do\n    true\n  end\n\n  Doorkeeper::OAuth::TokenResponse.send :prepend, CustomTokenResponse\n  Doorkeeper::OAuth::ErrorResponse.send :prepend, CustomTokenErrorResponse\n\n  # WWW-Authenticate Realm (default \"Doorkeeper\").\n  #\n  # realm \"Doorkeeper\"\nend\n\n\n</code></pre>\n\n<pre><code># lib/custom_token_response.rb\n\nmodule CustomTokenResponse\n  def body\n    user_details = User.find(@token.resource_owner_id)\n    # call original `#body` method and merge its result with the additional data hash\n       super.merge({\n           status_code: 200,\n           message: I18n.t('devise.sessions.signed_in'),\n           result: user_details\n       })\n  end\nend\n</code></pre>\n\n<pre><code># lib/custom_token_error_response.rb\n\nmodule CustomTokenErrorResponse\n  def body\n    {\n      status_code: 401,\n      message: I18n.t('devise.failure.invalid', authentication_keys: User.authentication_keys.join('/')),\n      result: []\n    }\n    # or merge with existing values by\n    # super.merge({key: value})\n  end\nend\n</code></pre>\n\n<p>1: from /home/rubyians/.rvm/gems/ruby-2.6.3/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/active_support.rb:8:in <code>without_bootsnap_cache'\n/home/rubyians/.rvm/gems/ruby-2.6.3/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/active_support.rb:79:in</code>block in load_missing_constant': uninitialized constant CustomTokenResponse (NameError)</p>\n"}, {"tags": ["ruby", "bash", "shell", "erb"], "comments": [{"owner": {"reputation": 17600, "user_id": 793796, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mk3lA.jpg?s=128&g=1", "display_name": "anishsane", "link": "https://stackoverflow.com/users/793796/anishsane"}, "edited": false, "score": 2, "creation_date": 1564982159, "post_id": 57352257, "comment_id": 101192693, "body": "<code>ruby</code> will <code>cat</code> your file as it is, except that the content between <code>&lt;%</code> and <code>%&gt;</code> will be preprocessed by ruby. So, this is expected behavior."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1565000747, "post_id": 57352257, "comment_id": 101200265, "body": "You could separate template and evaluation, e.g. have a clean template file without a shebang called <code>foo.erb</code> and a executable <code>foo</code> which evaluates the template."}], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1564997182, "creation_date": 1564997182, "answer_id": 57355674, "question_id": 57352257, "link": "https://stackoverflow.com/questions/57352257/shebang-line-shows-up-in-erb-output/57355674#57355674", "title": "Shebang line shows up in erb output", "body": "<p>ERb will process <em>only</em> whatever is <em>inside</em> ERb tags. Everything else will be passed without change.</p>\n\n<p>So, the only solution you have is to remove the shebang line.</p>\n"}], "owner": {"reputation": 263, "user_id": 6382710, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/94e7081de3f92eb721fe73aa03a016b5?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen Chu", "link": "https://stackoverflow.com/users/6382710/stephen-chu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564997182, "creation_date": 1564979724, "question_id": 57352257, "link": "https://stackoverflow.com/questions/57352257/shebang-line-shows-up-in-erb-output", "title": "Shebang line shows up in erb output", "body": "<p>When I use <code>#! /usr/bin/env erb</code> in an executable file <code>./foo</code>, the output my the ERB template always shows the shebang line at the top first before the actual ERB output.</p>\n\n<p>I tried <em>not</em> using <code>/usr/bin/env</code> and directly use <code>/usr/bin/erb</code> in my shebang, and other ERB version, but no luck to get rid of the shebang line in my output.</p>\n\n<p>Given:</p>\n\n<pre><code>\u203a cat ./foo\n#! /usr/bin/env erb\nHello, &lt;%= ARGF.read %&gt;\n</code></pre>\n\n<p>When I run:</p>\n\n<pre><code>\u203a ./foo &lt;(echo world)\n#! /usr/bin/env erb\nHello,\nworld\n</code></pre>\n\n<p>But I do <em>not</em> want the shebang line to show in the output.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "rails-activestorage", "ruby-on-rails-5.2"], "comments": [{"owner": {"reputation": 325, "user_id": 8649274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-udQ1w4pehi4/AAAAAAAAAAI/AAAAAAAAADU/IzCu7r15rFU/photo.jpg?sz=128", "display_name": "Foram", "link": "https://stackoverflow.com/users/8649274/foram"}, "edited": false, "score": 0, "creation_date": 1564978690, "post_id": 57352045, "comment_id": 101191994, "body": "Please check out this documentation for getting s3 image <a href=\"https://chrisherring.co/posts/private-files-for-your-rails-app-using-s3\" rel=\"nofollow noreferrer\">chrisherring.co/posts/private-files-for-your-rails-app-using&zwnj;&#8203;-s3</a>"}, {"owner": {"reputation": 29, "user_id": 9166373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6582445a4949dfc25f9ebdde573b19c?s=128&d=identicon&r=PG", "display_name": "user9166373", "link": "https://stackoverflow.com/users/9166373/user9166373"}, "reply_to_user": {"reputation": 325, "user_id": 8649274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-udQ1w4pehi4/AAAAAAAAAAI/AAAAAAAAADU/IzCu7r15rFU/photo.jpg?sz=128", "display_name": "Foram", "link": "https://stackoverflow.com/users/8649274/foram"}, "edited": false, "score": 0, "creation_date": 1564991202, "post_id": 57352045, "comment_id": 101195686, "body": "Thanks for the link. This is fine. But I want to know how can I link an already uploaded file into s3 to an object via active storage. Like user  has_one_attached :image (where the image is already uploaded to s3)"}], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 3388910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18f7059930a766248b3b2613b9d0b760?s=128&d=identicon&r=PG", "display_name": "BrianDiesel", "link": "https://stackoverflow.com/users/3388910/briandiesel"}, "is_accepted": false, "score": 0, "last_activity_date": 1565102515, "creation_date": 1565102515, "answer_id": 57378608, "question_id": 57352045, "link": "https://stackoverflow.com/questions/57352045/how-to-map-already-uploaded-s3-image-with-activestorage/57378608#57378608", "title": "How to map already uploaded s3 image with ActiveStorage", "body": "<p>Can the rails app access the file through s3?</p>\n\n<p>You can attach an existing using an IO object as documented here:  </p>\n\n<p><a href=\"https://edgeguides.rubyonrails.org/active_storage_overview.html#attaching-file-io-objects\" rel=\"nofollow noreferrer\">https://edgeguides.rubyonrails.org/active_storage_overview.html#attaching-file-io-objects</a></p>\n"}], "owner": {"reputation": 29, "user_id": 9166373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6582445a4949dfc25f9ebdde573b19c?s=128&d=identicon&r=PG", "display_name": "user9166373", "link": "https://stackoverflow.com/users/9166373/user9166373"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1565102515, "creation_date": 1564977560, "question_id": 57352045, "link": "https://stackoverflow.com/questions/57352045/how-to-map-already-uploaded-s3-image-with-activestorage", "title": "How to map already uploaded s3 image with ActiveStorage", "body": "<p><strong>My workflow</strong></p>\n\n<p>I have created a bucket in s3.</p>\n\n<p>When somebody drops an image over there an SNS notification comes to my rails app in response got the image name.</p>\n\n<p>By the image name, I can get the user info.</p>\n\n<p>Now I need to create an active storage relation with the user which will map that s3 URL in active storage table.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11843356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97322b341111990382b02a7c965973aa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/11843356/abhishek"}, "edited": false, "score": 0, "creation_date": 1564985137, "post_id": 57351962, "comment_id": 101193415, "body": "Thanks a lot sir... that was a great advise."}, {"owner": {"reputation": 5, "user_id": 11843356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97322b341111990382b02a7c965973aa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/11843356/abhishek"}, "edited": false, "score": 0, "creation_date": 1564985328, "post_id": 57351962, "comment_id": 101193463, "body": "Sir I&#39;m trying to implement it in my code but failing to do so, can you please help me with that.. I am still unclear how to I implement it in my code."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 0, "last_activity_date": 1564987621, "last_edit_date": 1564987621, "creation_date": 1564976738, "answer_id": 57351962, "question_id": 57351121, "link": "https://stackoverflow.com/questions/57351121/how-to-perform-arithmetic-operations-on-multiple-attributes-in-an-expression-usi/57351962#57351962", "title": "How to perform arithmetic operations on multiple attributes in an expression using binding?", "body": "<p>First, your <code>get_binding</code> is useless: it returns the current binding, but you don't assign it to anything, so it's forgotten.</p>\n\n<p>Even if you used it, it would likely be incorrect: when you do <code>eval(\"x = 4\")</code>, it creates a new binding, assigns <code>x</code> in that binding, and then destroys the binding since you're not using it any more. A subsequent <code>binding</code> call will instantiate a <em>new</em> binding, unrelated to the one that was inside <code>eval</code>, and then <code>binding.eval(\"x\")</code> will complain (rightly) that <code>x</code> is unknown. You have to return the <code>eval</code> binding for future evaluations.</p>\n\n<p>This would work:</p>\n\n<pre><code>current_binding = binding\nvalue, current_binding = current_binding.eval('[x = 25, binding]')\nvalue, current_binding = current_binding.eval('[y = 35, binding]')\nvalue, current_binding = current_binding.eval('[x + y, binding]')\nvalue\n# =&gt; 60\n</code></pre>\n\n<p>Two key points: you need to take the binding from inside the <code>eval</code> to preserve the values in it, and you need to start the evaluation with the previously captured binding.</p>\n\n<p>It would be irresponsible to not also note that passing user input into <code>eval</code> is extremely dangerous from the security standpoint, especially if you're accepting input from somewhere that normally doesn't have your level of access to the system (e.g. a website). For example, an input of <code>`rm -rf ~`</code> would delete all of your files.</p>\n\n<p>EDIT: Per comment, here's a short demo of the concept (I can't implement it in your code, as it has too many errors):</p>\n\n<pre><code>current_binding = binding\nuntil (line = gets.chomp!) == 'q'\n  value, current_binding = current_binding.eval(\"[#{line}, binding]\")\n  puts value unless value.nil?\nend\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11843356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97322b341111990382b02a7c965973aa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/11843356/abhishek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 57351962, "answer_count": 1, "score": 0, "last_activity_date": 1564987621, "creation_date": 1564965688, "question_id": 57351121, "link": "https://stackoverflow.com/questions/57351121/how-to-perform-arithmetic-operations-on-multiple-attributes-in-an-expression-usi", "title": "How to perform arithmetic operations on multiple attributes in an expression using binding?", "body": "<p>I am trying to implement an interactive program which return results of arithmetic operations performed on attributes entered by user. \nTried to store the values of attributes dynamically and then access those values to perform operations on my given expressions like:\n'x + y'\nwhen x and y can assume arbitrary values. ( need to be fetched by user).</p>\n\n<p>I am implementing below logic :</p>\n\n<p>Take user input in a loop</p>\n\n<pre><code>There can be 3 cases now:\n  Concat each input into a string\n  ..\n  execute the string if input is blank\n  ..\n  exit if key `q` is pressed\n</code></pre>\n\n<p>I have given inputs as x = 25 and y = 35, then tried to calculate 'x + y' expression . Faced error saying \"<code>eval': undefined local variable or method</code>x' for Demo:Class\"\nCan someone please help me with this ?</p>\n\n<pre><code>class Demo\n  def self.method(expr)\n    if expr =~ /^.*=.*$/\n      @object = eval(expr)\n      get_binding\n    else\n      @object = eval(expr) \n      l_operand, op, r_operand = expr.partition(%r{[/*+-]})\n      output = ''\n      puts output += eval(l_operand)\n      print output += op.to_s\n      print output += eval(r_operand)\n      @object =  eval(output)\n      get_binding\n    end\n  end\n\n  def self.get_binding\n    binding\n  end\nend\n\nuser_input = ''\nuntil user_input == 'q' do\n user_input = gets.chomp\n   b3 = Demo.method(user_input)\n   puts eval('@object', b3)\nend\n</code></pre>\n\n<p>Expected Result: \nx+y \n=> 60</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "omniauth", "omniauth-linkedin"], "comments": [{"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1564970369, "post_id": 57350959, "comment_id": 101190794, "body": "Do you have required permissions to get the positions data? If you do, can you share the response json object so that the structure is seen. Refer this answer for reference: <a href=\"https://stackoverflow.com/a/54086287/6548745\">stackoverflow.com/a/54086287/6548745</a>"}, {"owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "reply_to_user": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1564970599, "post_id": 57350959, "comment_id": 101190834, "body": "I just checked the app on LinkedIn &amp; it days I can only access the email/name. For some reason, they only allow me to use r_email r_liteprofile and w_member_social"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1564970866, "post_id": 57350959, "comment_id": 101190878, "body": "Correct, positions data is not public, you need to apply for retrieving such data."}, {"owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "reply_to_user": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1564970945, "post_id": 57350959, "comment_id": 101190886, "body": "Unfortunately. I\u2019ll have to let my boss know tomorrow. They may be able to seek permission for it. But the red tape is crazy in that place. Thanks anyway."}], "owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564962624, "creation_date": 1564962624, "question_id": 57350959, "link": "https://stackoverflow.com/questions/57350959/how-do-i-retrieve-iterate-over-and-save-the-users-positions-to-a-model-w-linkedi", "title": "How do I retrieve/iterate over and save the users positions to a model w/LinkedIn? omniauth-linkedin-oauth2 Rails 5.2", "body": "<p>I've been able to complete the oauth2 login process and grant the current_user access to the application with Devise. My main goal was to iterate over the user's positions from LinkedIn and create a Position.create(..) object for each individual position &amp; then save their user_id to the object after a successful LinkedIn login attempt. Afterwards, I would just display the information inside of the app. It should check for a Position where its first_or_create, to avoid duplicating the data on each login attempt. How can I get the user's positions and company hash (JSON object) to store inside of the database?</p>\n\n<p>I created a position model with a company JSON serializable attribute. I attempted to retrieve the user's profile using the auth.extra.info.positions fields. Afterwards, I tried to retrieve the information from the user in session. I could not succeed in getting an array of Positions back.</p>\n\n<p>create_positions.rb | migration</p>\n\n<pre><code>class CreatePositions &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :positions do |t|\n      t.string :title\n      t.text :summary\n      t.date :start_date\n      t.date :end_date\n      t.boolean :is_current\n      t.json :company\n      t.references :user, foreign_key: true\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>user.rb</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :validatable, :omniauthable, :trackable, :confirmable,\n         :omniauth_providers =&gt; [:twitter, :facebook, :linkedin, :google_oauth2,\n                                 *(:developer if Rails.env.development?)]\n\n  has_many :positions\n\n  def self.from_omniauth(auth)\n    where(provider: auth.provider, uid: auth.uid).first_or_create do |user|\n      user.email = auth.info.email\n      user.name = auth.info.name\n      user.password = Devise.friendly_token[0, 20]\n      user.provider = auth.provider\n      user.uid = auth.uid\n    end\n  end\n\n  protected\n  def confirmation_required?\n    false\n  end\nend\n</code></pre>\n\n<p>position.rb</p>\n\n<pre><code>class Position &lt; ApplicationRecord\n  serialize :company, JSON\n  belongs_to :user, dependent: :destroy\n end\n</code></pre>\n\n<p>omniauth_callbacks_controller.rb</p>\n\n<pre><code># frozen_string_literal: true\n\nclass Users::OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController\n  skip_before_action :verify_authenticity_token\n\n  def sign_in_with(provider_name)\n    @user = User.from_omniauth(request.env['omniauth.auth'])\n    sign_in_and_redirect @user, event: :authentication\n    set_flash_message(:notice, :success, kind: provider_name) if is_navigational_format?\n  end\n\n  def save_user_positions\n     Position.create(:title =&gt; auth.extra.info.positions['title'], :summary =&gt; auth.extra.info.positions['summary'], :start_date =&gt; auth.extra.info.positions['start-date'], :end_date =&gt; auth.extra.info.positions['end-date'], :is_current =&gt; auth.extra.info.positions['is-current'], company: {id: auth.extra.info.positions.company['id']})\n</code></pre>\n\n<p>end\n      def facebook\n        sign_in_with 'Facebook'\n      end</p>\n\n<pre><code>  def linkedin\n    sign_in_with 'LinkedIn'\n  end\n\n  def twitter\n    sign_in_with 'Twitter'\n  end\n\n  def google_oauth2\n    sign_in_with 'Google'\n  end\n\n  def developer\n    sign_in_with 'Developer'\n  end\nend\n</code></pre>\n\n<p>Expected Results: When User logs into LinkedIn through omniauth, their positions/companies are saved to the rails database.</p>\n\n<p>Actual Results: Only user email/name/basic attributes are retrievable.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "edited": false, "score": 0, "creation_date": 1617321138, "post_id": 57350823, "comment_id": 118279149, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/4014352/how-to-get-a-particular-line-from-a-file\">How to get a particular line from a file</a>"}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "reply_to_user": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "edited": false, "score": 0, "creation_date": 1617361846, "post_id": 57350823, "comment_id": 118288151, "body": "Uh no, imagine an exaggerated situation of having a hundred GB file. When you run <code>tail 100_GB_file</code>, tail will read only the last 10 lines or given lines. You don&#39;t essentially need to run billions of iterations and call <code>.next()</code> on <code>IO.foreach(file, splitter)</code>, or you can&#39;t read entire file in puny 8 GB RAM. I don&#39;t know if that&#39;s possible in Ruby. But I have solved this problem with Ruby C Extension, especially reading the file in C. This truly solves my problem: <a href=\"https://www.geeksforgeeks.org/implement-your-own-tail-read-last-n-lines-of-a-huge-file/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/&hellip;</a> . But it isn&#39;t a true ruby solution..."}, {"owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "edited": false, "score": 0, "creation_date": 1617366170, "post_id": 57350823, "comment_id": 118289536, "body": "Good to know about your solution but your Question isn&#39;t about tail."}], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1564961671, "post_id": 57350866, "comment_id": 101189563, "body": "Yes, it consumes a good amount of memory! Only <code>readpartial</code> doesn&#39;t eat up that much..."}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1564962179, "post_id": 57350866, "comment_id": 101189622, "body": "Because the file contains ASCII text, I can do this: <code>ch = &#39;&#39;.tap { |a| File.open(&#39;hello.txt&#39;) { |x| loop until a.concat(x.readpartial(1))[-1] == ?\\n } }</code> for now, without causing any memory issues... This will read the first line. But if the first line contains a newline character, it will take that empty line. <code>strip</code> can be used to strip off the extra leading spaces or new lines. The answer still causes memory problem, but thanks for attempting to answer."}], "tags": [], "owner": {"reputation": 679, "user_id": 1391598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884f2cefcf98aa542f22a6870c8de9e2?s=128&d=identicon&r=PG", "display_name": "Yoav Epstein", "link": "https://stackoverflow.com/users/1391598/yoav-epstein"}, "is_accepted": false, "score": 0, "last_activity_date": 1564961368, "creation_date": 1564961368, "answer_id": 57350866, "question_id": 57350823, "link": "https://stackoverflow.com/questions/57350823/how-do-i-read-the-nth-line-of-a-file-efficiently-in-ruby/57350866#57350866", "title": "How do I read the nth line of a file efficiently in Ruby?", "body": "<p>have you tried <code>readline</code> instead of <code>readlines</code>?</p>\n\n<pre><code>File.open('file-name') { |f| f.readline }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1564962636, "post_id": 57350947, "comment_id": 101189680, "body": "Thanks, <code>IO.foreach(&#39;hello.txt&#39;).first</code> works flawlessly! Or <code>IO.foreach(&#39;hello.txt&#39;).take(2).to_a[1]</code> for getting the second line..."}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 0, "last_activity_date": 1564962540, "creation_date": 1564962540, "answer_id": 57350947, "question_id": 57350823, "link": "https://stackoverflow.com/questions/57350823/how-do-i-read-the-nth-line-of-a-file-efficiently-in-ruby/57350947#57350947", "title": "How do I read the nth line of a file efficiently in Ruby?", "body": "<p>What about <a href=\"https://stackoverflow.com/a/1728941/3784008\"><code>IO.foreach</code></a>?</p>\n\n<pre><code>IO.foreach('filename') { |line| p line; break }\n</code></pre>\n\n<p>That should read the first line, print it, and then stop. It does not read the entire file; it reads one line at a time.</p>\n"}, {"comments": [{"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1565012167, "post_id": 57356408, "comment_id": 101206404, "body": "Thanks for answering. But it&#39;s terrible choice to use shell inside Ruby. I always try to avoid that. You are calling a separate binary. Also, one problem is that it&#39;s not a Ruby way. Your system with Ruby will have the IO and the File class. But your system may be missing cat! The other thing is that calling binaries is slow. I have benchmarked the <code>clear</code> method and <code>print &quot;\\e[2J\\e[H\\e[3J&quot;</code>. Both do the same job, but the ANSI one is a 100k times faster. I would use these things only for MRuby but my question is for general Ruby or MRI. Sorry but -1 for that..."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1565384633, "post_id": 57356408, "comment_id": 101351652, "body": "@S.Goswami I would remove the downvote. <a href=\"https://stackoverflow.com/help/privileges/vote-down\">Use your downvotes whenever you encounter an egregiously sloppy, no-effort-expended post, or an answer that is clearly and perhaps dangerously incorrect.</a> This answer is functionally correct, even if it isn&#39;t optimal or perfect for your use-case, and would in many circumstances work exactly as someone would expect."}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1565410378, "post_id": 57356408, "comment_id": 101355562, "body": "@anothermh, I got you, but your program in such case depends on cat and head. You don&#39;t need to do that because Ruby has everything built in for you. It&#39;s helpful for those using MRuby. For example, <code>IO.foreach</code> is available on Linux, Windows, and Mac, and Android, and whatnot, but if you follow the answerer, you are left with Linux / Unix... And also <code>exec(...)</code> will cause your program to exit after the commands are executed... Yes, it&#39;s another possibility to call shell, but if you do a benchmark of reading a gig file and read the first line 100K times, you will surely know the difference!"}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1565411033, "post_id": 57356408, "comment_id": 101355642, "body": "@anothermh, this is correct answer, but it&#39;s not Ruby right? You can use Perl / Python / Lua etc. inside of <code>Kernel#``</code> / <code>exec</code> / <code>Kernel#system</code> / <code>IO#popen</code> etc. instead of the BASH script, which will be slower but will work. That&#39;s why I think there&#39;s not much effort given to write the answer. It&#39;s simply not thinking in the Ruby way..."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1565411583, "post_id": 57356408, "comment_id": 101355705, "body": "We can choose to disagree. But I\u2019d remind you that there\u2019s a difference between inefficient and incorrect, and between \u201ccorrect for some platforms but not others\u201d and incorrect."}], "tags": [], "owner": {"reputation": 392, "user_id": 9910110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTTsN.jpg?s=128&g=1", "display_name": "Sandra", "link": "https://stackoverflow.com/users/9910110/sandra"}, "is_accepted": false, "score": 1, "last_activity_date": 1564999740, "creation_date": 1564999740, "answer_id": 57356408, "question_id": 57350823, "link": "https://stackoverflow.com/questions/57350823/how-do-i-read-the-nth-line-of-a-file-efficiently-in-ruby/57356408#57356408", "title": "How do I read the nth line of a file efficiently in Ruby?", "body": "<p>I would use commands line. For example, in this way:</p>\n\n<pre><code>exec(\"cat #{filename} | head -#{nth_line} | tail -1\")\n</code></pre>\n\n<p>I hope it useful for you.</p>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "is_accepted": false, "score": 0, "last_activity_date": 1565419738, "creation_date": 1565419738, "answer_id": 57439988, "question_id": 57350823, "link": "https://stackoverflow.com/questions/57350823/how-do-i-read-the-nth-line-of-a-file-efficiently-in-ruby/57439988#57439988", "title": "How do I read the nth line of a file efficiently in Ruby?", "body": "<p>So I have came with a code that does the job quite efficiently.</p>\n\n<h3>Firstly, we can use the <code>IO#each_line</code> method. Say we need the line at 3,000,000:</h3>\n\n<pre><code>#!/usr/bin/ruby -w\n\nfile = File.open(File.join(__dir__, 'hello.txt'))\nfinal = nil\nread_upto = 3_000_000 - 1\n\nfile.each_line.with_index do |l, i|\n    if i == read_upto\n        final = l\n        break\n    end\nend\n\nfile.close\np final\n</code></pre>\n\n<p>Running with the <code>time</code> shell builtin:</p>\n\n<p>[I have a big hello.txt file with #!/usr/bin/ruby -w #lineno in it!!]</p>\n\n<pre><code>$ time ruby p.rb\n\"#!/usr/bin/ruby -w #3000000\\n\"\n\nreal    0m1.298s\nuser    0m1.240s\nsys 0m0.043s\n</code></pre>\n\n<p>We can also get the 1st line very easily! You got it...</p>\n\n<h3>Secondly, extending anothermh's answer:</h3>\n\n<pre><code>#!/usr/bin/ruby -w\n\nenum = IO.foreach(File.join(__dir__, 'hello.txt'))\n\n# Getting the first line\np enum.first\n\n# Getting the 100th line\n# This can still cause memory issues because it\n# creates an array out of each line\np enum.take(100)[-1]\n\n# The time consuming but memory efficient way\n# reading the 3,000,000th line\n# While loops are fastest\n\nindex, i = 3_000_000 - 1, 0\nenum.next &amp;&amp; i += 1 while i &lt; index\np enum.next    # reading the 3,000,000th line\n</code></pre>\n\n<p>Running with <code>time</code>:</p>\n\n<pre><code>time ruby p.rb \n\"#!/usr/bin/ruby -w #1\\n\"\n\"#!/usr/bin/ruby -w #100\\n\"\n\"#!/usr/bin/ruby -w #3000000\\n\"\n\nreal    0m2.341s\nuser    0m2.274s\nsys 0m0.050s\n</code></pre>\n\n<p>There could be other ways like the <code>IO#readpartial</code>, <code>IO#sysread</code> and so on. But The <code>IO.foreach</code>, and <code>IO#each_line</code> are the easiest and quite fast to work with.</p>\n\n<p><strong>Hope this helps!</strong></p>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 57350947, "answer_count": 4, "score": 0, "last_activity_date": 1565419738, "creation_date": 1564960700, "last_edit_date": 1564962714, "question_id": 57350823, "link": "https://stackoverflow.com/questions/57350823/how-do-i-read-the-nth-line-of-a-file-efficiently-in-ruby", "title": "How do I read the nth line of a file efficiently in Ruby?", "body": "<p>I have a 2 GiB file, and I want to read the first line of the file.\nI can call the <code>File#readlines</code> method which returns array, and use <code>[0]</code> bracket syntax, <code>at(0)</code>, or the <code>slice(0)</code> or <code>first</code> methods.</p>\n\n<p>But there's a problem. My PC has 3.7 GiB RAM, and the usage goes from 1.1 GiB all the way up to 3.7 GiB. But all I want is the first line of the file. Is there an efficient way to do that?</p>\n"}, {"tags": ["ruby", "rubygems", "rbenv"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1564958643, "post_id": 57350289, "comment_id": 101189175, "body": "I don&#39;t know the answer, but might be worth sharing your version of rbenv? And are you getting the same behavior when you <code>gem install</code> versus installing from a Gemfile?"}, {"owner": {"reputation": 4159, "user_id": 3925041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/nUSoq.png?s=128&g=1", "display_name": "SexxLuthor", "link": "https://stackoverflow.com/users/3925041/sexxluthor"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1564964742, "post_id": 57350289, "comment_id": 101190028, "body": "Hey, thanks. It&#39;s the current version (I&#39;d tried updating things in case of a fix), upgraded via Homebrew. Updating RubyGems with <code>gem update --system</code> also produced a similar doc output directory <code>rubygems-update-3.0.4</code>. I haven&#39;t changed anything about the way I do things, and this has worked happily for years. Installing with a Gemfile/Bundler does <i>not</i> appear to generate the docs, when examining the same rbenv version doc directory (after seeing them there/clearing when using RubyGems directly)."}], "answers": [{"tags": [], "owner": {"reputation": 4159, "user_id": 3925041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/nUSoq.png?s=128&g=1", "display_name": "SexxLuthor", "link": "https://stackoverflow.com/users/3925041/sexxluthor"}, "is_accepted": true, "score": 2, "last_activity_date": 1567858121, "creation_date": 1567858121, "answer_id": 57833546, "question_id": 57350289, "link": "https://stackoverflow.com/questions/57350289/rubygems-ignoring-gemrc/57833546#57833546", "title": "RubyGems ignoring `.gemrc`?", "body": "<p>I think the answer may be found <a href=\"https://stackoverflow.com/a/17201281\">here</a>.</p>\n\n<p>My <code>.gemrc</code> was using <code>--no-ri</code> and <code>--no-rdoc</code> and while I read that these were deprecated, they may no longer be supported at all. Using <code>--no-document</code> instead seems to have solved the problem.</p>\n"}], "owner": {"reputation": 4159, "user_id": 3925041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/nUSoq.png?s=128&g=1", "display_name": "SexxLuthor", "link": "https://stackoverflow.com/users/3925041/sexxluthor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 57833546, "answer_count": 1, "score": 2, "last_activity_date": 1567858121, "creation_date": 1564953585, "question_id": 57350289, "link": "https://stackoverflow.com/questions/57350289/rubygems-ignoring-gemrc", "title": "RubyGems ignoring `.gemrc`?", "body": "<p>This has been going on for a while, and I'm finally annoyed enough to post.</p>\n\n<p>I've been using <code>--no-rdoc --no-ri</code> settings in a <code>.gemrc</code> file with rbenv-installed Ruby versions for many years, and this has always worked to suppress the addition of docs during gem installs.</p>\n\n<p>But some time ago this stopped working, despite no changes to basic configurations or methods of installing new gems or ruby versions. So differences among these has had no effect upon the problem.</p>\n\n<p><code>gem env</code> shows configuration settings of \"--no-rdoc --no-ri\" for both \"install\" and \"update,\" so RubyGems sees the settings.</p>\n\n<p>Any idea what's going on? Some change to RubyGems or other? (Typically someone else would have posted, but searching multiple times hasn't turned up a recent surge of questions related to this.)</p>\n\n<p>[Please note that this is not related to other Ruby version managers, or system-installed Ruby on MacOS.]</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite"], "comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1564958434, "post_id": 57350003, "comment_id": 101189144, "body": "sqlite needs to be installed separately yes. But please do yourself a favor and use a real db, postgres or mysql, it will save you mane headaches."}], "answers": [{"comments": [{"owner": {"reputation": 1126, "user_id": 871280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/227aed03fe3234b0412fb3fdbd93343a?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/871280/andy"}, "edited": false, "score": 0, "creation_date": 1564995389, "post_id": 57352645, "comment_id": 101197581, "body": "Is it included with msys2 though? I installed that, and I saw libsqlite3 was installed along with it."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1126, "user_id": 871280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/227aed03fe3234b0412fb3fdbd93343a?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/871280/andy"}, "edited": false, "score": 0, "creation_date": 1565001309, "post_id": 57352645, "comment_id": 101200542, "body": "I am not familiar with msys2 and do not know what packages are installed with msys2 per default. But there is a <a href=\"https://github.com/msys2/MSYS2-packages/tree/master/sqlite\" rel=\"nofollow noreferrer\">sqlite package</a> for msys2, therefore it seems possible."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1564986338, "last_edit_date": 1564986338, "creation_date": 1564983176, "answer_id": 57352645, "question_id": 57350003, "link": "https://stackoverflow.com/questions/57350003/does-sqlite3-engine-need-to-be-installed-separately-from-rails/57352645#57352645", "title": "does sqlite3 engine need to be installed separately from rails?", "body": "<p>Quote from the <a href=\"https://github.com/sparklemotion/sqlite3-ruby\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>This module allows Ruby programs to interface with the SQLite3 database engine (www.sqlite.org). You must have the SQLite engine installed in order to build this module.</p>\n</blockquote>\n\n<p><code>gem install sqlite3</code> or a running bundler with Gemfile including <code>gem 'sqlite3'</code> will only install the database driver \u2013 the interface you need to connect a Ruby application with an SQLite database. </p>\n\n<p>The same is true for other well-known database drivers \u2013 like <code>mysql2</code> or <code>pg</code>. The database engine itself must be installed separately and it usually has be installed before installing the gem.</p>\n"}], "owner": {"reputation": 1126, "user_id": 871280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/227aed03fe3234b0412fb3fdbd93343a?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/871280/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564986338, "creation_date": 1564950430, "last_edit_date": 1564969832, "question_id": 57350003, "link": "https://stackoverflow.com/questions/57350003/does-sqlite3-engine-need-to-be-installed-separately-from-rails", "title": "does sqlite3 engine need to be installed separately from rails?", "body": "<p>Does <strong>gem install sqlite3</strong> takes care of installing both the underlying engine as well as the ruby module (gem)?</p>\n\n<p>Do I need to install sqlite3 from the sqlite3 website first, and then install the sqlite3 gem with the gem command?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "edited": false, "score": 0, "creation_date": 1564950060, "post_id": 57349953, "comment_id": 101187673, "body": "was working before I generated the below: <code>&#39;rails generate migration add_reset_to_users reset_digest:stringreset_sent_at:datetime&#39;</code> this created an issue, I believe because of the  missed space so I ran this: <code>&#39;rails generate migration add_reset_to_users reset_digest:string reset_sent_at:datetime&#39;</code> &amp; then <code>&#39;rails generate migration add_reset_sent_at_to_users reset_sent_at:datetime&#39;</code> which fixed the previous issue, but now tests don&#39;t work"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1564950313, "post_id": 57349953, "comment_id": 101187728, "body": "What do you mean with &quot;don&#39;t work&quot;, can you elaborate your question?"}, {"owner": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1564950897, "post_id": 57349953, "comment_id": 101187834, "body": "When the tests are run using <code>rails test:mailers</code> it gives the error as above and the suggested fixes from other posts haven&#39;t rectified the problem:"}, {"owner": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1564950903, "post_id": 57349953, "comment_id": 101187836, "body": "ERROR[&quot;test_account_activation&quot;, UserMailerTest, 0.21548007300043537]  test_account_activation#UserMailerTest (0.22s) ActiveRecord::StatementInvalid:         ActiveRecord::StatementInvalid: Could not find table &#39;users&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "edited": false, "score": 0, "creation_date": 1564952605, "post_id": 57350108, "comment_id": 101188151, "body": "Hi I&#39;ve tried the above, still coming up with the same error&#39;s. Now tested on development website and appears the users table is no longer there either, can&#39;t see how it would have been deleted"}, {"owner": {"reputation": 23741, "user_id": 117603, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4404b2eff76f077ebe78c50c4df6d37f?s=128&d=identicon&r=PG", "display_name": "Mike Trpcic", "link": "https://stackoverflow.com/users/117603/mike-trpcic"}, "reply_to_user": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "edited": false, "score": 0, "creation_date": 1564952794, "post_id": 57350108, "comment_id": 101188196, "body": "Is the users table in your <code>schema.rb</code>? Perhaps you need to <code>rake db:migrate</code> in your development environment to get it back into your <code>schema.rb</code> properly, and then my commands above might work?"}, {"owner": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "edited": false, "score": 0, "creation_date": 1564953024, "post_id": 57350108, "comment_id": 101188229, "body": "I found the issue defined in the schema, related to the above typo <code>ActiveRecord::Schema.define(version: 20190804192901) do  # Could not dump table &quot;users&quot; because of following StandardError #   Unknown type &#39;stringreset_sent_at&#39; for column &#39;reset_digest&#39;</code> I missed the space earlier, but now not sure how I can rectify this, maybe I can rollback the database?"}, {"owner": {"reputation": 23741, "user_id": 117603, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4404b2eff76f077ebe78c50c4df6d37f?s=128&d=identicon&r=PG", "display_name": "Mike Trpcic", "link": "https://stackoverflow.com/users/117603/mike-trpcic"}, "reply_to_user": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "edited": false, "score": 0, "creation_date": 1564953180, "post_id": 57350108, "comment_id": 101188255, "body": "If you don&#39;t have production data to worry about, you can simply fix the migration and then <code>rake db:drop</code>, <code>rake db:create</code>, <code>rake db:migrate</code>."}, {"owner": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "edited": false, "score": 0, "creation_date": 1564954184, "post_id": 57350108, "comment_id": 101188414, "body": "Thanks, worked after I deleted the original migrate file I made with typo - fixed and I now understand migrations more, cheers"}], "tags": [], "owner": {"reputation": 23741, "user_id": 117603, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4404b2eff76f077ebe78c50c4df6d37f?s=128&d=identicon&r=PG", "display_name": "Mike Trpcic", "link": "https://stackoverflow.com/users/117603/mike-trpcic"}, "is_accepted": true, "score": 0, "last_activity_date": 1564951456, "creation_date": 1564951456, "answer_id": 57350108, "question_id": 57349953, "link": "https://stackoverflow.com/questions/57349953/activerecordstatementinvalid-could-not-find-table-users-rails-5-tutorial/57350108#57350108", "title": "ActiveRecord::StatementInvalid: Could not find table &#39;users&#39; Rails 5 tutorial", "body": "<p>It's important to remember that each environment in Rails has its own database. Just because your application is working when you're doing development (<code>RAILS_ENV=development</code>), it doesn't mean the database is there when running tests (<code>RAILS_ENV=test</code>).</p>\n\n<p>You may simply need to prepare your test database (create it and migrate it):</p>\n\n<pre><code># Drop any test DB you already have\nbundle exec rake db:drop RAILS_ENV=test\n\n# Create a clean fresh one\nbundle exec rake db:create RAILS_ENV=test\n\n# Import the Schema from your schema.rb, rather than run all migrations\nbundle exec rake db:schema:load RAILS_ENV=test\n</code></pre>\n\n<p>If you do the above and then run your tests, they should work as expected.</p>\n"}], "owner": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 57350108, "answer_count": 1, "score": 0, "last_activity_date": 1564951456, "creation_date": 1564949944, "last_edit_date": 1564951173, "question_id": 57349953, "link": "https://stackoverflow.com/questions/57349953/activerecordstatementinvalid-could-not-find-table-users-rails-5-tutorial", "title": "ActiveRecord::StatementInvalid: Could not find table &#39;users&#39; Rails 5 tutorial", "body": "<p>Running tests on Rails on the built Sample App (Michael Hartl Rails 5), When running tests I get the above error, which suggests it can't find the table 'users', it's available in my db migrate folder and also listed in the development.sqlite3 file, So not sure what the issue is</p>\n\n<p>Tried the recommended fixes running rake db:test:prepare, rails db:migrate:reset testing to see if User.new(name: 'foo') creates a user neither have fixed the problem and the latter creates fine in the console so can't understand why it can't find the table</p>\n\n<p>_create_users.rb</p>\n\n<pre><code>  def change\n    create_table :users do |t|\n      t.string :name\n      t.string :email\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>tests to run errors run when attempting 'rails test:mailers' and more when using 'rails test'</p>\n\n<p><a href=\"https://i.stack.imgur.com/SYuwf.png\" rel=\"nofollow noreferrer\">db:migrate</a>\n<a href=\"https://i.stack.imgur.com/EH1NY.png\" rel=\"nofollow noreferrer\">SQLite</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "bundler", "staging"], "comments": [{"owner": {"reputation": 3597, "user_id": 2112512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9689bb4f705b8bede56deddf66c87ef?s=128&d=identicon&r=PG", "display_name": "Jake Worth", "link": "https://stackoverflow.com/users/2112512/jake-worth"}, "edited": false, "score": 1, "creation_date": 1564948651, "post_id": 57349768, "comment_id": 101187361, "body": "Does your Gemfile specify a Ruby version? If so, what is it?"}, {"owner": {"reputation": 26, "user_id": 11077837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Gfmm.jpg?s=128&g=1", "display_name": "BrianisWinston", "link": "https://stackoverflow.com/users/11077837/brianiswinston"}, "reply_to_user": {"reputation": 3597, "user_id": 2112512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9689bb4f705b8bede56deddf66c87ef?s=128&d=identicon&r=PG", "display_name": "Jake Worth", "link": "https://stackoverflow.com/users/2112512/jake-worth"}, "edited": false, "score": 1, "creation_date": 1564948944, "post_id": 57349768, "comment_id": 101187415, "body": "@JakeWorth It doesn&#39;t specify in the gemfile actually. I will try to set it as the working ruby version - 2.3.4 and let you know the status. Thanks!"}, {"owner": {"reputation": 3597, "user_id": 2112512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9689bb4f705b8bede56deddf66c87ef?s=128&d=identicon&r=PG", "display_name": "Jake Worth", "link": "https://stackoverflow.com/users/2112512/jake-worth"}, "edited": false, "score": 0, "creation_date": 1564958622, "post_id": 57349768, "comment_id": 101189171, "body": "Glad to hear @BrianisWinston. I&#39;ve written this up as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 3597, "user_id": 2112512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9689bb4f705b8bede56deddf66c87ef?s=128&d=identicon&r=PG", "display_name": "Jake Worth", "link": "https://stackoverflow.com/users/2112512/jake-worth"}, "is_accepted": false, "score": 0, "last_activity_date": 1564958534, "creation_date": 1564958534, "answer_id": 57350678, "question_id": 57349768, "link": "https://stackoverflow.com/questions/57349768/heroku-rails-deployment-build-error-could-not-find-bundler-version-required/57350678#57350678", "title": "Heroku Rails deployment/build error: Could not find &#39;bundler&#39; (version) required by your Gemfile.lock", "body": "<p>The solution to issues like these it to ensure all environments (development, staging, production, CI) share the same Ruby version. This will make development and testing much more predictable.</p>\n\n<p>Specify your Ruby version in the Gemfile (this build worked with Ruby 2.3.4, so that's what we'll use):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># Gemfile\n\nruby '2.3.4'\n</code></pre>\n"}], "owner": {"reputation": 26, "user_id": 11077837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Gfmm.jpg?s=128&g=1", "display_name": "BrianisWinston", "link": "https://stackoverflow.com/users/11077837/brianiswinston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564970757, "creation_date": 1564948376, "last_edit_date": 1564970757, "question_id": 57349768, "link": "https://stackoverflow.com/questions/57349768/heroku-rails-deployment-build-error-could-not-find-bundler-version-required", "title": "Heroku Rails deployment/build error: Could not find &#39;bundler&#39; (version) required by your Gemfile.lock", "body": "<p>I have a Ruby on Rails and Redux/React app I have already pushed dozens of times to heroku via \"git push heroku master\" and it builds correctly. I recently tried to create a staging environment. After setting the remote, I run </p>\n\n<pre><code>git push staging master\n</code></pre>\n\n<p>And the webpack portion builds correctly, but once Heroku tries to build the Rails portion I get this error.</p>\n\n<pre><code>remote:  !     Could not detect rake tasks\nremote:  !     ensure you can run `$ bundle exec rake -P` against your app\nremote:  !     and using the production group of your Gemfile.\nremote:  !     Activating bundler (2.0.1) failed:\nremote:  !     Could not find 'bundler' (2.0.1) required by your /tmp/build_687b8b1cf6d6cbb297288640ccb0d405/Gemfile.lock.\nremote:  !     To update to the latest version installed on your system, run `bundle update --bundler`.\nremote:  !     To install the missing version, run `gem install bundler:2.0.1`\nremote:  !     Checked in 'GEM_PATH=vendor/bundle/ruby/2.5.0', execute `gem env` for more information\nremote:  !     \nremote:  !     To install the version of bundler this project requires, run `gem install bundler -v '2.0.1'`\n</code></pre>\n\n<p>To create the staging environment, I ran </p>\n\n<pre><code>heroku create --remote staging\n</code></pre>\n\n<p>in the root folder of the project. </p>\n\n<p>I also have tried updating the bundler.</p>\n\n<pre><code>bundle update --bundler\n</code></pre>\n\n<p>&amp;</p>\n\n<pre><code>gem install bundler:2.0.1\n</code></pre>\n\n<p>I tried precompiling assets as well, but nothing.</p>\n\n<pre><code>RAILS_ENV=production bundle exec rake assets:precompile\n</code></pre>\n\n<p>I ran </p>\n\n<pre><code>bundle exec rake -P\n</code></pre>\n\n<p>as suggested, but that did not fix it as well.</p>\n\n<p>Another thing is when I push successfully, in the logs it shows I am using a different ruby version</p>\n\n<pre><code>Using Ruby version: ruby-2.3.4\nremote: -----&gt; Installing dependencies using bundler 2.0.2\n</code></pre>\n\n<p>In the staging logs it shows </p>\n\n<pre><code>Using Ruby version: ruby-2.5.5\nremote: -----&gt; Installing dependencies using bundler 2.0.2\n</code></pre>\n\n<p>Not sure if that helps. But any possible solutions can help!</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1564949097, "post_id": 57349343, "comment_id": 101187447, "body": "Please elaborate &quot;shapes&quot;. Is <code>arr1</code> always an array of arrays that do not contain arrays? Is <code>arr2</code> always an array of element that are not arrays?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1564951015, "post_id": 57349343, "comment_id": 101187870, "body": "Note that whenever the two elements being zipped are the same size, you could use <code>Array#transpose</code> instead: <code>[arr1, arr2].transpose.map { |e1,e2| [*e1, e2] }</code> (though the latter creates two intermediate arrays as compared to <code>zip</code>&#39;s one)."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1564948296, "post_id": 57349383, "comment_id": 101187271, "body": "<code>flatten</code> works, provided that (as in the example) none of the elements of <code>arr1</code> or <code>arr2</code> are arrays."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1564977733, "post_id": 57349383, "comment_id": 101191802, "body": "@CarySwoveland What do you mean? <code>arr1</code> elements are arrays. And it works."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1564978787, "post_id": 57349383, "comment_id": 101192011, "body": "@Amadan, what I meant to write is the substance of my first comment on the question, but I got it wrong. I&#39;ll fix that."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1564978991, "post_id": 57349383, "comment_id": 101192052, "body": "I meant that <code>flatten</code> works provided that (as in the example) none of the elements of <code>arr1</code> contain arrays and none of the elements of <code>arr2</code> are arrays. If, for example, <code>arr1 = [[1,[2]], [3,4]]</code> and <code>arr2 = [&#39;A&#39;, [&#39;B&#39;]]</code>, presumably the desired return value would be <code>[[1,[2],&#39;A&#39;], [3,4,[&#39;B&#39;]]</code>, not <code>[[1,2,&#39;A&#39;], [3,4,&#39;B&#39;]]</code>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1564979271, "post_id": 57349383, "comment_id": 101192099, "body": "It would still work though. <code>arr1 = [&quot;a&quot;, [&quot;B&quot;]]; arr2 = [[1, 2], 3]; arr1.zip(arr2).map(&amp;:flatten)</code> gives the correct <code>[[&quot;a&quot;, 1, 2], [&quot;B&quot;, 3]]</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1564979416, "post_id": 57349383, "comment_id": 101192135, "body": "@Amadan, the question is not clear on that point, and it may be moot."}], "tags": [], "owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "is_accepted": true, "score": 4, "last_activity_date": 1564945175, "last_edit_date": 1564945175, "creation_date": 1564944867, "answer_id": 57349383, "question_id": 57349343, "link": "https://stackoverflow.com/questions/57349343/seeking-a-variation-on-zip/57349383#57349383", "title": "Seeking a variation on `zip`", "body": "<p>Flatten each array after zipping:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>arr1.zip(arr2).map(&amp;:flatten)\n</code></pre>\n\n<p>Alternatively, <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-zip\" rel=\"nofollow noreferrer\"><code>Enumerable#zip</code></a> takes an optional block, in which case it invokes the block for each combination, without returning a value though.</p>\n\n<p>Thus, you could write it as follows, which is slightly less elegant:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[].tap { |res| arr1.zip(arr2) { |a, b| res.push(a + [b]) } }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1564948683, "post_id": 57349564, "comment_id": 101187369, "body": "Is there any particular reason you went with <code>a + [b]</code> rather than <code>a &lt;&lt; b</code>?  I&#39;m curious about tradeoffs."}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1564948890, "post_id": 57349564, "comment_id": 101187408, "body": "Ah, I just noticed that <code>a &lt;&lt; b</code> will modify the original <code>arr1</code>."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1564949011, "post_id": 57349564, "comment_id": 101187426, "body": "That looks nice @CarySwoveland, I&#39;ll edit. And yes pjs, <code>+</code> for returning the third array from the concatenation of both others. In this case, it&#39;d mutate <code>arr1</code>."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 2, "last_activity_date": 1564949051, "last_edit_date": 1564949051, "creation_date": 1564946344, "answer_id": 57349564, "question_id": 57349343, "link": "https://stackoverflow.com/questions/57349343/seeking-a-variation-on-zip/57349564#57349564", "title": "Seeking a variation on `zip`", "body": "<p>You can add each element in arr2 to arr1 according to its corresponding index using <code>map</code>, <code>with_index</code> and <code>+</code>:</p>\n\n<pre><code>p arr1.map.with_index { |e, i| e + [arr2[i]] }\n# [[\"apple\", \"aardvark\", \"A\"], [\"banana\", \"beach\", \"B\"]]\n</code></pre>\n\n<p>Or zipping arr1 with arr2 and mapping the sum of the elements in arr2 as an array with the elements in arr1:</p>\n\n<pre><code>p arr1.zip(arr2).map { |a, b| [*a, b] }\n# [[\"apple\", \"aardvark\", \"A\"], [\"banana\", \"beach\", \"B\"]]\n</code></pre>\n"}], "owner": {"reputation": 1518, "user_id": 3984943, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/DdHWC.jpg?s=128&g=1", "display_name": "jayqui", "link": "https://stackoverflow.com/users/3984943/jayqui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 57349383, "answer_count": 2, "score": 2, "last_activity_date": 1565005200, "creation_date": 1564944485, "last_edit_date": 1565005200, "question_id": 57349343, "link": "https://stackoverflow.com/questions/57349343/seeking-a-variation-on-zip", "title": "Seeking a variation on `zip`", "body": "<p>I have two arrays of the following shapes that I would like to combine.</p>\n\n<p>arrays:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>arr1 = [[\"apple\", \"aardvark\"], [\"banana\", \"beach\"]]\narr2 = ['A', 'B']\n</code></pre>\n\n<p>desired result: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[[\"apple\", \"aardvark\", \"A\"], [\"banana\", \"beach\", \"B\"]]\n</code></pre>\n\n<p>I'm wondering what would be an idiomatic way to do this in Ruby.</p>\n\n<p>I can obviously just do a loop, such as</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>i = 0\nwhile i &lt; arr1.length\n  arr1[i] &lt;&lt; arr2[i]\n  i += 1\nend\n</code></pre>\n\n<p>But I'm wondering if there's an elegant one-liner I'm just overlooking. <code>zip</code> is the closest I could think of, but it's not quite there:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>arr1.zip(arr2)\n# =&gt; [[[\"apple\", \"aardvark\"], \"A\"], [[\"banana\", \"beach\"], \"B\"]]\n</code></pre>\n"}, {"tags": ["ruby", "tiny-tds"], "comments": [{"owner": {"reputation": 1976, "user_id": 1177200, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99ddd63eb79f04e76156db21c172c7f1?s=128&d=identicon&r=PG", "display_name": "taylorthurlow", "link": "https://stackoverflow.com/users/1177200/taylorthurlow"}, "edited": false, "score": 0, "creation_date": 1566259943, "post_id": 57348821, "comment_id": 101592010, "body": "For what it&#39;s worth I just did a recent reinstall of 10.14.6, and I had no issues doing a <code>brew install freetds</code>. So your memory is correct."}, {"owner": {"reputation": 1976, "user_id": 1177200, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99ddd63eb79f04e76156db21c172c7f1?s=128&d=identicon&r=PG", "display_name": "taylorthurlow", "link": "https://stackoverflow.com/users/1177200/taylorthurlow"}, "edited": false, "score": 0, "creation_date": 1566260218, "post_id": 57348821, "comment_id": 101592064, "body": "It&#39;s a long shot, but per a comment <a href=\"https://stackoverflow.com/questions/22140907/freetds-undefined-symbols-for-architecture-x86-64\">on this post</a>, maybe try reinstalling <code>readline</code> via homebrew, and then rebuilding your Ruby from scratch to get it to build with the newly reinstalled <code>readline</code>? EDIT: I don&#39;t know how <code>asdf</code> works but this will only apply if you&#39;re building Ruby locally. Maybe try with a Ruby from <code>rbenv</code> instead?"}], "answers": [{"tags": [], "owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "is_accepted": false, "score": 2, "last_activity_date": 1566291290, "creation_date": 1566291290, "answer_id": 57570027, "question_id": 57348821, "link": "https://stackoverflow.com/questions/57348821/unable-to-install-tiny-tds-on-mac/57570027#57570027", "title": "Unable to install tiny_tds on mac", "body": "<p>My guess is that you have old ruby.  In your case you have ruby <code>2.4.5</code>.  </p>\n\n<p>From quick check of the <a href=\"https://github.com/rails-sqlserver/tiny_tds/blob/d8cb94e1033d124dfdd5a08780a530fd8c995101/ext/tiny_tds/result.c\" rel=\"nofollow noreferrer\">source code</a> I think you need to have ruby <code>2.6.0</code> or newer for the latest <code>tiny_tds</code> gem.</p>\n"}, {"comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1566330271, "post_id": 57579534, "comment_id": 101620759, "body": "I recommend explaining in greater detail what &quot;blowing away all that stuff&quot; means to assist anyone else that may experience a similar issue in the future."}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "edited": false, "score": 0, "creation_date": 1566374655, "post_id": 57579534, "comment_id": 101631786, "body": "Huh?  Could you specify what kind of version of <code>tiny_tds</code> did you use with what ruby?  I don&#39;t think the latest <code>tiny_tds</code> will work your specified ruby version."}], "tags": [], "owner": {"reputation": 748, "user_id": 464889, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c74a76a3bfbbc5f9ed041245c378de3b?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/464889/chad"}, "is_accepted": true, "score": -1, "last_activity_date": 1566325385, "creation_date": 1566325385, "answer_id": 57579534, "question_id": 57348821, "link": "https://stackoverflow.com/questions/57348821/unable-to-install-tiny-tds-on-mac/57579534#57579534", "title": "Unable to install tiny_tds on mac", "body": "<p>So in the end, it turned out that the machine I received was not wiped clean from a previous user and all of my problems are due to there being another gcc as well as ancient tds libraries in /usr/local. Blowing away all that stuff has resolved my issues.</p>\n"}], "owner": {"reputation": 748, "user_id": 464889, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c74a76a3bfbbc5f9ed041245c378de3b?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/464889/chad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 57579534, "answer_count": 2, "score": 3, "last_activity_date": 1566325385, "creation_date": 1564939987, "question_id": 57348821, "link": "https://stackoverflow.com/questions/57348821/unable-to-install-tiny-tds-on-mac", "title": "Unable to install tiny_tds on mac", "body": "<p>I am trying to set up a new mac and have been unable to get tiny_tds to compile. I am running OSX Mojave (10.14.6) and have ruby 2.4.5 installed via asdf. When I try to bundle, installing tiny_tds fails and the logs show:</p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n  \"_dbanydatecrack\", referenced from:\n      _t in conftest-f13825.o\nld: symbol(s) not found for architecture x86_64\n</code></pre>\n\n<p>I have searched for this and largely the only solutions I have found suggested are to <code>brew install freetds</code> which I've already done, and to try and run it with:</p>\n\n<pre><code>sudo ARCHFLAGS=\"-arch x86_64\" gem install tiny_tds\n</code></pre>\n\n<p>Which does not work either. </p>\n\n<p>I'm open to any suggestions, I had tiny_tds installed fine on my last mac and I'm not sure what's different here. From my memory, all I've ever had to do was brew install freetds and then bundle. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "internationalization", "yaml", "translation"], "answers": [{"comments": [{"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1564937610, "post_id": 57347966, "comment_id": 101184714, "body": "can you explain data variable what is it doing"}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1564940974, "post_id": 57347966, "comment_id": 101185580, "body": "I don\u2019t see you using the <code>translations</code> variable anywhere, so I believe this is just essentially doing <code>{}.to_yaml</code> at the moment."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1564941090, "post_id": 57347966, "comment_id": 101185605, "body": "I see. My error. Will fix. I changed the variable name when cleaning up and missed this occurence."}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1564941091, "post_id": 57347966, "comment_id": 101185607, "body": "If I\u2019m reading this right, the <code>data</code> inside of the <code>Translation.all.each</code> loop should actually be <code>translations</code>."}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1564941489, "post_id": 57347966, "comment_id": 101185725, "body": "I don\u2019t have a good way to run this, but I think it\u2019ll work! +1 from me"}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": true, "score": 4, "last_activity_date": 1564941107, "last_edit_date": 1564941107, "creation_date": 1564933438, "answer_id": 57347966, "question_id": 57347897, "link": "https://stackoverflow.com/questions/57347897/how-to-turn-a-translations-table-into-yaml-translation-files-in-ruby-on-rails/57347966#57347966", "title": "How to turn a translations table into YAML translation files in ruby on rails", "body": "<p>You can try something like this (I don't have any DB backed Rails Translations to try this)</p>\n\n<pre><code>def assign(parts, value, data)\n  key, *rest = parts\n  if rest.empty?\n    data[key] = value\n  else\n    data[key] ||= {}\n    assign(rest, value, data[key])\n  end\nend\n\ntranslations = {}\nTranslation.all.each do |translation|\n  path = [translation.locale] + translation.key.split(\".\")\n  assign(path, translation.value, translations)\nend\n\nFile.write(\"translations.yml\", translations.to_yaml)\n</code></pre>\n\n<p>Of course you can modify to only export the translations of a single locale or specific keys (by changing the <code>all</code> to a <code>where</code> query).</p>\n\n<p>The code works as following:</p>\n\n<p>It iterates all the Translations, and builds a hash with all the translations.\nThe key <code>footer.new_car_make</code> of the <code>en</code> translation will end up in a nested hash like:</p>\n\n<pre><code>{\n  \"en\" =&gt; {\n    \"footer\" =&gt; {\n      \"new_car_make\" =&gt; \"Whatever text you have in the DB\"\n    }\n  }\n}\n</code></pre>\n\n<p>and then this hash is saved as YAML format in a file.</p>\n\n<p>The <code>assign</code> method is called with the full key (it contains the locale as well) represented as an array (<code>['en', 'footer', 'new_car_make']</code>) and deconstructs into a head (first value in the array) and the rest (remaining parts).\nIf the remaining part is empty, it means we've reached the last element and can assign the value, otherwise we add a nested hash and recurse.</p>\n\n<p>You can try this in the console (just copy paste it). As mentioned this might not run right out of the box, let me know if you have troubles.</p>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 57347966, "answer_count": 1, "score": -1, "last_activity_date": 1564941107, "creation_date": 1564932886, "last_edit_date": 1564937150, "question_id": 57347897, "link": "https://stackoverflow.com/questions/57347897/how-to-turn-a-translations-table-into-yaml-translation-files-in-ruby-on-rails", "title": "How to turn a translations table into YAML translation files in ruby on rails", "body": "<p>My app is currently using the gem <code>i18n-active_record</code> for translations, storing them in a table <code>translations</code> which has more than 5000 records.</p>\n\n<p>To improve performance, I want to move the translations to YAML files, e.g. <code>en.yml</code> and <code>ar.yml</code>.</p>\n\n<p>I tried <code>File.open(Rails.root+'config/locales/en.yml', 'w') {|f| f.write translation.to_yaml }</code> but the output generated is the following:</p>\n\n<pre><code>    raw_attributes:\n    id: 1\n    locale: en\n    key: footer.new_car_make\n    value: New %{title} Cars\n    interpolations: \n    is_proc: 0\n    created_at: &amp;4 2012-08-15 06:25:59.000000000 Z\n    updated_at: &amp;5 2012-08-15 06:25:59.000000000 Z\n</code></pre>\n\n<p>Is there any easy way to make the conversion?</p>\n"}, {"tags": ["ruby", "api", "github", "oauth", "faraday"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 8512262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66eb7b174fdba1e3a0fa1aec8eef915b?s=128&d=identicon&r=PG", "display_name": "JRiggles", "link": "https://stackoverflow.com/users/8512262/jriggles"}, "edited": false, "score": 0, "creation_date": 1565002699, "post_id": 57350822, "comment_id": 101201211, "body": "I gave it a shot! I&#39;m afraid I&#39;m still getting code 400."}, {"owner": {"reputation": 35, "user_id": 8512262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66eb7b174fdba1e3a0fa1aec8eef915b?s=128&d=identicon&r=PG", "display_name": "JRiggles", "link": "https://stackoverflow.com/users/8512262/jriggles"}, "edited": false, "score": 0, "creation_date": 1565003184, "post_id": 57350822, "comment_id": 101201467, "body": "<i>Additional Information</i> - Using either the token type &quot;Bearer&quot; or &quot;Token&quot; in Paw gives me code 200...for some reason it&#39;s working there, and it doesn&#39;t seem to matter which I use."}], "tags": [], "owner": {"reputation": 679, "user_id": 1391598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884f2cefcf98aa542f22a6870c8de9e2?s=128&d=identicon&r=PG", "display_name": "Yoav Epstein", "link": "https://stackoverflow.com/users/1391598/yoav-epstein"}, "is_accepted": false, "score": 0, "last_activity_date": 1564960699, "creation_date": 1564960699, "answer_id": 57350822, "question_id": 57347496, "link": "https://stackoverflow.com/questions/57347496/i-keep-receiving-bad-status-codes-400-401-403-when-making-a-request-to-the-g/57350822#57350822", "title": "I keep receiving bad status codes (400, 401, 403) when making a request to the GitHub API via Faraday", "body": "<p>Seems like using Faraday to make pocket requests is working for you, which suggests that you are probably using it correctly.</p>\n\n<p>Looking at the GitHub documentation <a href=\"https://developer.github.com/v3/#authentication\" rel=\"nofollow noreferrer\">https://developer.github.com/v3/#authentication</a> I would suggest replacing 'Bearer' with 'token' and see if that helps.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 8512262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66eb7b174fdba1e3a0fa1aec8eef915b?s=128&d=identicon&r=PG", "display_name": "JRiggles", "link": "https://stackoverflow.com/users/8512262/jriggles"}, "is_accepted": true, "score": 0, "last_activity_date": 1565046703, "creation_date": 1565046703, "answer_id": 57367048, "question_id": 57347496, "link": "https://stackoverflow.com/questions/57347496/i-keep-receiving-bad-status-codes-400-401-403-when-making-a-request-to-the-g/57367048#57367048", "title": "I keep receiving bad status codes (400, 401, 403) when making a request to the GitHub API via Faraday", "body": "<p>I figured it out! I am a potato.</p>\n\n<p>There is a typo in the header parameters for my GitHub API request:</p>\n\n<pre><code>'Accept ': 'application/vnd.github.v3+json'\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>'Accept': 'application/vnd.github.v3+json',\n</code></pre>\n\n<p><strong><em>I had a space after 'Accept'!</em></strong></p>\n"}], "owner": {"reputation": 35, "user_id": 8512262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66eb7b174fdba1e3a0fa1aec8eef915b?s=128&d=identicon&r=PG", "display_name": "JRiggles", "link": "https://stackoverflow.com/users/8512262/jriggles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 57367048, "answer_count": 2, "score": 2, "last_activity_date": 1565046703, "creation_date": 1564929700, "last_edit_date": 1564931991, "question_id": 57347496, "link": "https://stackoverflow.com/questions/57347496/i-keep-receiving-bad-status-codes-400-401-403-when-making-a-request-to-the-g", "title": "I keep receiving bad status codes (400, 401, 403) when making a request to the GitHub API via Faraday", "body": "<p>I'm working on a little Ruby program to collect GitHub URLs from my Pocket account and then star those repos on my GitHub account. I've been able to connect to Pocket's API and get the URLs from my feed, but I'm having trouble with my requests to the \"<a href=\"https://api.github.com/user/starred\" rel=\"nofollow noreferrer\">https://api.github.com/user/starred</a>\" endpoint.</p>\n\n<p><strong>This is what I'm using</strong></p>\n\n<ul>\n<li><a href=\"https://lostisland.github.io/faraday/usage/\" rel=\"nofollow noreferrer\">https://lostisland.github.io/faraday/usage/</a></li>\n<li><a href=\"https://paw.cloud/client\" rel=\"nofollow noreferrer\">https://paw.cloud/client</a></li>\n</ul>\n\n<p>I initially used Paw on my Mac to get the authorization tokens for both Pocket and GitHub - the Pocket API is working perfectly in both Paw and in my Rub, but the GitHub request is only working in Paw.</p>\n\n<p>I've tried both flavors of the Faraday request syntax (you can see them in the code), using Faraday.new and a simple Faraday.get</p>\n\n<pre><code>require 'faraday'\nrequire 'json'\n\ngithub = Faraday.new(\n  url: 'https://api.github.com/user/starred',\n  headers: {\n    'Accept ': 'application/vnd.github.v3+json',\n    'Authorization': 'Bearer ***SUPER_SECRET_SAUCE***',\n    'User-Agent': 'jriggles'\n  }\n)\n\npocket = Faraday.get(\n  'https://getpocket.com/v3/get?consumer_key=***MY_POCKET_KEY**&amp;access_token=***MY_POCKET_TOKEN***&amp;contentType=article&amp;detailType=simple&amp;sort=newest&amp;domain=github.com&amp;count=100',\n  'Content-Type': 'application/json; charset=UTF8',\n  'X-Accept': 'application/json',\n  'User-Agent': 'jriggles'\n)\n\nif pocket.status == 200\n  parsed_response = JSON.parse(pocket.body)\n  parsed_response['list'].each do |_key, val|\n    owner = val['given_url'].split('/')[3]\n    repo = val['given_url'].split('/')[4]\n    puts github.get(\"/#{owner}/#{repo}\").status\n  end\nelse puts \"Connection to Pocket failed - Code #{pocket.status}\"\nend\n</code></pre>\n\n<p>This is the line that's returning the HTTP status codes:</p>\n\n<pre><code>puts github.get(\"#{owner}/#{repo}\").status\n</code></pre>\n\n<p>I've tried a few permutations, and I've only been getting [401], [403], and in this current iteration [400]. I'm not sure if it's an issue with my GitHub authorization or with my Faraday syntax, or both.</p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "mitmproxy"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 8432513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0012f1b786445960451d3e87074b43d0?s=128&d=identicon&r=PG&f=1", "display_name": "twelve40", "link": "https://stackoverflow.com/users/8432513/twelve40"}, "reply_to_user": {"reputation": 15, "user_id": 11765063, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Qw6y75FdXM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf6PUSNxaF8val7lDE3hzdUVxnorQ/photo.jpg?sz=128", "display_name": "VladislavKh", "link": "https://stackoverflow.com/users/11765063/vladislavkh"}, "edited": false, "score": 0, "creation_date": 1566589682, "post_id": 57600704, "comment_id": 101717880, "body": "@VladislavKh great! could you please accept this answer - thank you!"}], "tags": [], "owner": {"reputation": 321, "user_id": 8432513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0012f1b786445960451d3e87074b43d0?s=128&d=identicon&r=PG&f=1", "display_name": "twelve40", "link": "https://stackoverflow.com/users/8432513/twelve40"}, "is_accepted": true, "score": 0, "last_activity_date": 1566434586, "creation_date": 1566434586, "answer_id": 57600704, "question_id": 57347288, "link": "https://stackoverflow.com/questions/57347288/mitmdump-does-not-working-with-selenium-webdriver/57600704#57600704", "title": "Mitmdump does not working with selenium-webDriver", "body": "<p>The latest Selenium/Chrome combo silently ignores the \"chromeOptions\" option, the new syntax for that is \"goog:chromeOptions\" <a href=\"https://github.com/SeleniumHQ/docker-selenium/issues/674\" rel=\"nofollow noreferrer\">https://github.com/SeleniumHQ/docker-selenium/issues/674</a></p>\n"}], "owner": {"reputation": 15, "user_id": 11765063, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Qw6y75FdXM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf6PUSNxaF8val7lDE3hzdUVxnorQ/photo.jpg?sz=128", "display_name": "VladislavKh", "link": "https://stackoverflow.com/users/11765063/vladislavkh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 57600704, "answer_count": 1, "score": 1, "last_activity_date": 1566434586, "creation_date": 1564928092, "question_id": 57347288, "link": "https://stackoverflow.com/questions/57347288/mitmdump-does-not-working-with-selenium-webdriver", "title": "Mitmdump does not working with selenium-webDriver", "body": "<p>I use Selenium::WebDriver::Remote::Capabilities.chrome and chromeOptions with --proxy-server (mitmdump is used like proxy-server). But when I run the code and go to check ip, it's still mine.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>args = [\n      \"mitmdump\",\n      \"--listen-host\", \"127.0.0.1\",\n      \"--listen-port\", @port,\n      \"--mode\", \"upstream:http://#{proxy.ip}:#{proxy.port}\",\n      \"--upstream-auth\", #{proxy.login}:#{proxy.password}\n    ]\n\nserver = ChildProcess.build(*args)\nserver.start\nraise \"Oops\" unless server.alive?\n\nCapybara.register_driver :selenium do |app|\n      caps = Selenium::WebDriver::Remote::Capabilities.chrome(\n        \"chromeOptions\" =&gt; {\n          \"args\" =&gt; [\n            \"--headless\",\n            \"--proxy-server=http://127.0.0.1:@port\",\n            \"--disable-dev-shm-usage\",\n            \"--blink-settings=imagesEnabled=true\",\n            \"window-size=1440,900\",\n            \"--no-sandbox\"\n          ]\n        }\n      )\n      Capybara::Selenium::Driver.new(app, browser: :chrome, desired_capabilities: caps)\n    end\n\n    Capybara.javascript_driver = :chrome\n    Capybara.configure do |config|\n      config.default_max_wait_time = 20\n      config.default_driver = :selenium\n    end\n\n    session = Capybara::Session.new(:selenium)\n\n    session.visit(\"https://www.2ip.ru\")\n</code></pre>\n"}, {"tags": ["ruby", "html-lists", "nokogiri", "screen-scraping"], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 3396971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c75295766cfc6c5950bb398fa6c7e2?s=128&d=identicon&r=PG", "display_name": "NemyaNation", "link": "https://stackoverflow.com/users/3396971/nemyanation"}, "is_accepted": false, "score": 0, "last_activity_date": 1575645874, "last_edit_date": 1575645874, "creation_date": 1575644749, "answer_id": 59215632, "question_id": 57343672, "link": "https://stackoverflow.com/questions/57343672/how-do-i-get-text-for-each-li-tag-under-the-same-div-class-using-nokogiri/59215632#59215632", "title": "How do i get text for each &lt;li&gt; tag under the same div class using Nokogiri", "body": "<p>Firstly, your list of ingredients is within <code>div.ingredients</code> which is inside <code>div.easyrecipe</code>.</p>\n\n<p>Second, you're just printing all of the list text out for each section. Instead of adding the text of each section. You want to add the text of each ingredient.</p>\n\n<p>I would instead change it to:</p>\n\n<pre><code>ingredients = page.css(\"div.easyrecipe\").each do |section|\n  section.css(\"li.ingredient\").each do |ingredient|\n    ingredient.text\n</code></pre>\n\n<p>Resulting in:</p>\n\n<pre><code>p ingredients\n= [\"1 tbsp ground flax\",\"3 tbsp warm water\",\"\u00bd cup spelt\"]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11198182, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gyDlvshwuRM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTamF1DOC9ZDkKXSzLfKqeTo8j6g/mo/photo.jpg?sz=128", "display_name": "BrittJavs", "link": "https://stackoverflow.com/users/11198182/brittjavs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1600000088, "creation_date": 1564890977, "last_edit_date": 1600000088, "question_id": 57343672, "link": "https://stackoverflow.com/questions/57343672/how-do-i-get-text-for-each-li-tag-under-the-same-div-class-using-nokogiri", "title": "How do i get text for each &lt;li&gt; tag under the same div class using Nokogiri", "body": "<p>I am scraping ingredients of a recipe with Nokogiri (HTML/CSS). Each ingredient is in an li under an ingredient div. Right now my code is collecting all the ingredients without separation in a string. How can I get each li text into an array? </p>\n\n<p>The site has this</p>\n\n<pre><code>&lt;div class=\"easyrecipe\"&gt;\n &lt;div class=\"ingredients\"&gt;\n  &lt;ul&gt;\n   &lt;li class=\"ingredient\" itemprop=\"recipeIngredient\"&gt; 1 tbsp flax&lt;/l&gt;\n   &lt;li class=\"ingredient\" itemprop=\"recipeIngredient\"&gt; 3 tbsp water&lt;/l&gt;\n   &lt;li class=\"ingredient\" itemprop=\"recipeIngredient\"&gt; \u00bd cup spelt&lt;/l&gt;\n  &lt;/ul&gt;\n</code></pre>\n\n<p>i tried this to try to parse it and get the ingredients into an array </p>\n\n<pre><code>ingredients = page.css(\"div.easyrecipe\").each do |section|\n      section.css(\"li.ingredient\").text\n</code></pre>\n\n<p>I am getting this\n\"1 tbsp ground flax3 tbsp warm water\u00bd cup spelt\"</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1564892496, "post_id": 57343647, "comment_id": 101175635, "body": "&quot;if you are running a program, which has an infinite loop and a counter which increases many hundreds or thousands of times a second, and you have to run it 24 * 365&quot; - if that code runs for a few billion years, <i>then</i> your descendants might start noticing the slowdown."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1564892840, "post_id": 57343647, "comment_id": 101175674, "body": "You may wish to read <a href=\"http://patshaughnessy.net/2014/1/9/how-big-is-a-bignum\" rel=\"nofollow noreferrer\">this article</a> by Pat Shaughnessy"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1564892876, "post_id": 57343647, "comment_id": 101175678, "body": "&quot;before it gets to Float::INFINITY&quot; - you can&#39;t &quot;count to infinity&quot;, that&#39;s the whole point of the concept. Unless you&#39;re Chuck Norris, that is. Then you can."}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1564895280, "post_id": 57343647, "comment_id": 101175991, "body": "But I don&#39;t get it why <code>eval(&quot;0x#{?f * 800000000}&quot;).to_i.bit_length</code> returns <code>3200000000</code>!! That&#39;s huge! Warning: This will use about 2.9 GiB 3 GB of RAM!!"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1564901832, "post_id": 57343647, "comment_id": 101177049, "body": "&quot;But I don&#39;t get it why <code>eval(&quot;0x#{?f * 800000000}&quot;).to_i.bit_length</code> returns <code>3200000000</code>!!&quot; \u2013 Because that number requires 3200000000 bits to represent."}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1564901920, "post_id": 57343647, "comment_id": 101177067, "body": "I mean if 33549731 is the maximum value before Integer gets to Float::INFINITY, how the code <code>eval(&quot;0x#{?f * 800000000}&quot;).to_i.bit_length</code> can return 3200000000?"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1564902051, "post_id": 57343647, "comment_id": 101177095, "body": "Because there are no floats involved when you do that?"}], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 2, "last_activity_date": 1564906240, "last_edit_date": 1564906240, "creation_date": 1564905658, "answer_id": 57344893, "question_id": 57343647, "link": "https://stackoverflow.com/questions/57343647/what-determines-the-length-of-an-integer-in-ruby/57344893#57344893", "title": "What determines the length of an Integer in Ruby?", "body": "<blockquote>\n  <p><em>What could be the maximum length of Integer before it gets to Float::INFINITY.</em></p>\n</blockquote>\n\n<p>Integer operations in Ruby will (almost) never return Infinity. An Integer can be as big as you have memory to hold it.</p>\n\n<p><code>Float</code> is implemented as a classic <a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format\" rel=\"nofollow noreferrer\">double precision-floating point number</a> with an upper limit of about 1.7976931348623157e+308 and will return <code>Float::Infinity</code> if you go to high.</p>\n\n<pre><code>1.7976931348623157e+308.to_f + 10**307\n =&gt; Infinity \n</code></pre>\n\n<p>Some languages, like Perl 5, upgrade integers to doubles to get more space to work. So you will get Infinity if you go too high.</p>\n\n<pre><code>$ perl -wle 'printf \"%f\\n\", 10**308'\n100000000000000001097906362944045541740492309677311846336810682903157585404911491537163328978494688899061249669721172515611590283743140088328307009198146046031271664502933027185697489699588559043338384466165001178426897626212945177628091195786707458122783970171784415105291802893207873272974885715430223118336.000000\n$ perl -wle 'printf \"%f\\n\", 10**308 + 10**308'\nInf\n</code></pre>\n\n<p>But Ruby's <code>Integer</code>s have no limit but your memory. When Integers get too large they switch to using the <a href=\"https://en.wikipedia.org/wiki/GNU_Multiple_Precision_Arithmetic_Library\" rel=\"nofollow noreferrer\">GNU Multiple Precision Arithmetic Library</a> which supports <a href=\"https://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic\" rel=\"nofollow noreferrer\">arbitrary precision arithmetic</a>.</p>\n\n<p>There are a few operations which can result in Infinity, like power.</p>\n\n<pre><code>10**10000000\n(irb):5: warning: in a**b, b may be too big\n =&gt; Infinity \n</code></pre>\n\n<p>But multiplication has no such limit.</p>\n\n<pre><code>a = 10**1000000\n...\na *= a\n...\na *= a\n...\na *= a\n...\na.bit_length\n =&gt; 26575425\n</code></pre>\n\n<blockquote>\n  <p>Thus, if you are running a program, which has an infinite loop and a counter which increases many hundreds or thousands of times a second, and you have to run it 24 * 365, that may cause bugs I think.</p>\n</blockquote>\n\n<p>This is a real world concern for 32 bit integers which becomes <a href=\"https://en.wikipedia.org/wiki/Year_2038_problem\" rel=\"nofollow noreferrer\">a pressing problem as 2038 approaches</a>, but not 64 bit integers. If we incremented a counter a million times a second it would take almost 300,000 years. What I've just described is 64 bit time with microsecond resolution.</p>\n\n<p>But in Ruby you can make a simple counter effectively as large as you want.</p>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564906240, "creation_date": 1564890551, "last_edit_date": 1564901838, "question_id": 57343647, "link": "https://stackoverflow.com/questions/57343647/what-determines-the-length-of-an-integer-in-ruby", "title": "What determines the length of an Integer in Ruby?", "body": "<p>I have been wondering what could be the maximum length of Integer before it gets to Float::INFINITY.</p>\n\n<h1>On my 64 bit (Arch Linux) system:</h1>\n\n<pre><code>&gt; 1023.**(3355446).bit_length\n# =&gt; 33549731\n\n&gt; 1023.**(3355446).+(1000000 ** 1000000).+(1000 ** 100).bit_length\n# =&gt; 33549731\n</code></pre>\n\n<p>In fact:</p>\n\n<pre><code>&gt; a = 1023.**(3355446) ; ''\n# =&gt; \"\"\n\n&gt; b = 1023.**(3355446).+(1000000 ** 1000000).+(1000 ** 100) ; ''\n# =&gt; \"\"\n\n&gt; a.to_s.length == b.to_s.length\n# =&gt; true\n</code></pre>\n\n<h1>The above takes some time, but this one doesn't</h1>\n\n<pre><code>a, b, length_of = 1023.**(3355446), 1023.**(3355446).+(1000000 ** 1000000).+(1000 ** 100), lambda { |x| Math.log10(x).to_i.next } ; ''\n# =&gt; \"\"\n\nlength_of.(a).eql?(length_of.(b))\n# =&gt; true\n</code></pre>\n\n<p>Thus, if you are running a program, which has an infinite loop and a counter which increases many hundreds or thousands of times a second, and you have to run it 24 * 365, that may cause bugs I think.</p>\n\n<p>So the question is what determines the length of the Integer in Ruby? Does it differ on 32 bit and 64 bit systems?</p>\n\n<h1>Edit:</h1>\n\n<p>On my rapsberry pi 3 model B:</p>\n\n<pre><code>2.**(31580669).bit_length\n# =&gt; 31580670\n\n2.**(31580669).next.bit_length\n# =&gt; 31580670\n\n&gt; l = -&gt;(x) { Math.log10(x).to_i.next }\n# =&gt; #&lt;Proc:0x00a46df0@(irb):1 (lambda)&gt;\n\n&gt; l === 2.**(31580669)\n# =&gt; 9506729\n\n&gt; l === 2.**(31580669) + 100 ** 100\n# =&gt; 9506729\n</code></pre>\n\n<p>So the question on Ruby 2.3 and older would be how big could be a Bignum. From Ruby 2.4+ the question is how big can be an Integer?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "omniauth", "omniauth-linkedin"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1564896545, "post_id": 57343576, "comment_id": 101176169, "body": "the error is a validation error, UID is null, that is the problem.  So it appears you already have a user record persisted in the DB with a nil UID. Your validation is not allowing you to add another users with a nil UID.  So somehow your UID is not getting passed through correctly so your validation will fail."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1564937139, "post_id": 57343576, "comment_id": 101184596, "body": "I would start by writing a test and using OmniAuths test mode with a mocked auth hash to ensure that your code actually works as intended. Then you should add some NOT NULL database constraints and a compound index and error handling so that you don&#39;t get invalid rows in the identities table and user records without an identity."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1564937391, "post_id": 57343576, "comment_id": 101184658, "body": "Then you can try in developing with an actual call to the provider and byebug if you are getting the expected auth hash. You also have another potential problem which is <code>session[&quot;devise.#{provider}_data&quot;] = env[&quot;omniauth.auth&quot;]</code> - the omniauth readme warns against copying the entire auth hash into the session as it can exceed the size limit imposed by cookies. Use slice and only take what you need."}, {"owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "edited": false, "score": 0, "creation_date": 1564938708, "post_id": 57343576, "comment_id": 101184970, "body": "I actually solved this problem with a totally different approach. For future references, keep an eye on this project. It works 100% <a href=\"https://github.com/monkbroc/omniauth-demo\" rel=\"nofollow noreferrer\">github.com/monkbroc/omniauth-demo</a> &amp; don&#39;t forget to set your callback redirect urls on Google Dev, etc. Mine was <a href=\"http://127.0.0.1:3000/users/auth/linkedin/callback\" rel=\"nofollow noreferrer\">127.0.0.1:3000/users/auth/linkedin/callback</a>"}], "owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1564889353, "creation_date": 1564889353, "question_id": 57343576, "link": "https://stackoverflow.com/questions/57343576/activerecordrecordinvalid-validation-failed-uid-cant-be-blank-omniauth-lin", "title": "ActiveRecord::RecordInvalid (Validation failed: Uid can&#39;t be blank) Omniauth LinkedIn Devise", "body": "<p>While saving the User model, I receive (Validation failed: Uid can't be blank). Uid itself, belongs to the Identity object - which serves as a single identity access point for multiple identity types. In other words, you will be able to use facebook, twitter, or linkedin omniauth strategies within the app without creating multiple accounts. It doesn't seem to work as advertised. Given that I cannot create a user after logging in on LinkedIn from the app. </p>\n\n<p>I tried to swap out the env reference for request.env. Because, it doesn't exist in its current scope. I attempted to locate the error, but couldn't find exactly why the Identity model was not storing the identity before creating the user. It fails right after the User object is created, instead of checking if the User exist w/an identity attached or should be created.</p>\n\n<p>Server development log</p>\n\n<pre><code>Started GET \"/users/auth/linkedin\" for 127.0.0.1 at 2019-08-03 22:56:03 -0400\nI, [2019-08-03T22:56:04.789247 #23148]  INFO -- omniauth: (linkedin) Request phase initiated.\nStarted GET \"/users/auth/linkedin/callback?oauth_token=77--2555555-5555-4444-ssfs-dcsfsfsfsfsf93&amp;oauth_verifier=28090\" for 127.0.0.1 at 2019-08-03 22:56:31 -0400\nI, [2019-08-03T22:56:32.422234 #23148]  INFO -- omniauth: (linkedin) Callback phase initiated.\nProcessing by OmniauthCallbacksController#linkedin as HTML\n  Parameters: {\"oauth_token\"=&gt;\"77--2555555-5555-4444-ssfs-dcsfsfsfsfsf93\", \"oauth_verifier\"=&gt;\"28090\"}\n  Identity Load (1.4ms)  SELECT  \"identities\".* FROM \"identities\" WHERE \"identities\".\"uid\" IS NULL AND \"identities\".\"provider\" = ? LIMIT ?  [[\"provider\", \"linkedin\"], [\"LIMIT\", 1]]\n  \u00e2\u2020\u00b3 app/models/identity.rb:7\n   (0.2ms)  begin transaction\n  \u00e2\u2020\u00b3 app/models/identity.rb:7\n  Identity Exists (1.1ms)  SELECT  1 AS one FROM \"identities\" WHERE \"identities\".\"uid\" IS NULL AND \"identities\".\"provider\" = ? LIMIT ?  [[\"provider\", \"linkedin\"], [\"LIMIT\", 1]]\n  \u00e2\u2020\u00b3 app/models/identity.rb:7\n   (0.2ms)  rollback transaction\n  \u00e2\u2020\u00b3 app/models/identity.rb:7\n   (0.2ms)  begin transaction\n  \u00e2\u2020\u00b3 app/models/user.rb:47\n  User Exists (2.0ms)  SELECT  1 AS one FROM \"users\" WHERE \"users\".\"email\" = ? LIMIT ?  [[\"email\", \"change@me--linkedin.com\"], [\"LIMIT\", 1]]\n  \u00e2\u2020\u00b3 app/models/user.rb:47\n  User Create (44.3ms)  INSERT INTO \"users\" (\"email\", \"encrypted_password\", \"created_at\", \"updated_at\", \"confirmed_at\") VALUES (?, ?, ?, ?, ?)  [[\"email\", \"change@me--linkedin.com\"], [\"encrypted_password\", \"$2a\"], [\"created_at\", \"2019-08-04 02:56:33.928307\"], [\"updated_at\", \"2019-08-04 02:56:33.928307\"], [\"confirmed_at\", \"2019-08-04 02:56:33.921311\"]]\n  \u00e2\u2020\u00b3 app/models/user.rb:47\n   (134.0ms)  commit transaction\n  \u00e2\u2020\u00b3 app/models/user.rb:47\n   (0.1ms)  begin transaction\n  \u00e2\u2020\u00b3 app/models/user.rb:54\n  Identity Exists (2.1ms)  SELECT  1 AS one FROM \"identities\" WHERE \"identities\".\"uid\" IS NULL AND \"identities\".\"provider\" = ? LIMIT ?  [[\"provider\", \"linkedin\"], [\"LIMIT\", 1]]\n  \u00e2\u2020\u00b3 app/models/user.rb:54\n   (0.2ms)  rollback transaction\n  \u00e2\u2020\u00b3 app/models/user.rb:54\nCompleted 422 Unprocessable Entity in 879ms (ActiveRecord: 191.3ms)\n\n\n\nActiveRecord::RecordInvalid (Validation failed: Uid can't be blank):\n\napp/models/user.rb:54:in `find_for_oauth'\n(eval):3:in `linkedin'\n</code></pre>\n\n<p>omniauth_callbacks_controller.rb</p>\n\n<pre><code>class OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController\n\n  def self.provides_callback_for(provider)\n    class_eval %Q{\n      def #{provider}\n        @user = User.find_for_oauth(request.env[\"omniauth.auth\"], current_user)\n\n        if @user.persisted?\n          sign_in_and_redirect @user, event: :authentication\n          set_flash_message(:notice, :success, kind: \"#{provider}\".capitalize) if is_navigational_format?\n        else\n          session[\"devise.#{provider}_data\"] = env[\"omniauth.auth\"]\n          redirect_to new_user_registration_url\n        end\n      end\n    }\n  end\n\n  [:facebook, :linkedin].each do |provider|\n    provides_callback_for provider\n  end\n\n  def after_sign_in_path_for(resource)\n    if resource.email_verified?\n      super resource\n    else\n      finish_signup_path(resource)\n    end\n  end\n\n  def failure\n    redirect_to root_path\n  end\nend\n</code></pre>\n\n<p>identity.rb</p>\n\n<pre><code>class Identity &lt; ApplicationRecord\n  belongs_to :user\n  validates_presence_of :uid, :provider\n  validates_uniqueness_of :uid, :scope =&gt; :provider\n\n  def self.find_for_oauth(auth)\n    find_or_create_by(uid: auth.uid, provider: auth.provider)\n  end\nend\n</code></pre>\n\n<p>user.rb</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  TEMP_EMAIL_PREFIX = 'change@me'\n  TEMP_EMAIL_REGEX = /\\Achange@me/\n\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :validatable, :omniauthable, :trackable, :confirmable\n\n  validates_format_of :email, :without =&gt; TEMP_EMAIL_REGEX, on: :update\n\n  def self.find_for_oauth(auth, signed_in_resource = nil)\n\n    # Get the identity and user if they exist\n    identity = Identity.find_for_oauth(auth)\n\n    # If a signed_in_resource is provided it always overrides the existing user\n    # to prevent the identity being locked with accidentally created accounts.\n    # Note that this may leave zombie accounts (with no associated identity) which\n    # can be cleaned up at a later date.\n    user = if signed_in_resource then\n             signed_in_resource\n           else\n             identity.user\n           end\n\n    # Create the user if needed\n    if user.nil?\n\n      # Get the existing user by email if the provider gives us a verified email.\n      # If no verified email was provided we assign a temporary email and ask the\n      # user to verify it on the next step via UsersController.finish_signup\n      email_is_verified = auth.info.email &amp;&amp; (auth.info.verified || auth.info.verified_email)\n      email = auth.info.email if email_is_verified\n      user = User.where(:email =&gt; email).first if email\n\n      # Create the user if it's a new registration\n      if user.nil?\n        user = User.new(\n            name: auth.extra.raw_info.name,\n            #username: auth.info.nickname || auth.uid,\n            email: email ? email : \"#{TEMP_EMAIL_PREFIX}-#{auth.uid}-#{auth.provider}.com\",\n            password: Devise.friendly_token[0,20]\n        )\n        user.skip_confirmation!\n        user.save!\n      end\n    end\n\n    # Associate the identity with the user if needed\n    if identity.user != user\n      identity.user = user  \n      identity.save!     # Where error occurs\n    end\n    user\n  end\n\n  def email_verified?\n    self.email &amp;&amp; self.email !~ TEMP_EMAIL_REGEX\n  end\n\n  protected\n  def confirmation_required?\n    false\n  end\nend\n</code></pre>\n\n<p>Expected behavior: A user will successfully log into their Linkedin account and be redirected to the app to complete their registration.</p>\n\n<p>Actual results: The user object creates, and then it fails to save the Identity and leaves the Uid blank.</p>\n"}, {"tags": ["ruby", "quicksort"], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 2, "last_activity_date": 1564889520, "last_edit_date": 1564889520, "creation_date": 1564888863, "answer_id": 57343542, "question_id": 57343346, "link": "https://stackoverflow.com/questions/57343346/quick-sort-algorithm-in-ruby-stack-level-too-deep/57343542#57343542", "title": "Quick Sort Algorithm in Ruby - Stack Level Too Deep", "body": "<p>If we throw a debugging <code>p \"Left #{left}, Right #{right}</code>...</p>\n\n<pre><code>def quicksort(arr = [], left = 0, right = 0)\n  right = arr.length - 1 if right &lt; 1\n  if left &lt; right\n    index = partition(arr, left, right)\n    quicksort(arr, left, index - 1)\n    ...\n</code></pre>\n\n<p>We find there's a problem. <code>left</code> is never set. It's always the default of 0. And right is doing its own thing.</p>\n\n<pre><code>\"Left 0, Right 10\"\n\"Left 0, Right 8\"\n\"Left 0, Right 2\"\n\"Left 0, Right 1\"\n\"Left 0, Right 10\"\n\"Left 0, Right 7\"\n\"Left 0, Right 6\"\n\"Left 0, Right 5\"\n\"Left 0, Right 2\"\n\"Left 0, Right 1\"\n\"Left 0, Right 10\"\n\"Left 0, Right 4\"\n\"Left 0, Right 2\"\n\"Left 0, Right 1\"\n\"Left 0, Right 10\"\n\"Left 0, Right 5\"\n\"Left 0, Right 2\"\n\"Left 0, Right 1\"\n\"Left 0, Right 10\"\n\"Left 0, Right 5\"\n\"Left 0, Right 2\"\n\"Left 0, Right 1\"\n</code></pre>\n\n<p>The problem is <code>right = arr.length - 1 if right &lt; 1</code>. If <code>right</code> is ever &lt; 1 it's set back to the end of the array. <code>left</code> is always 0 so <code>left</code> is always less than <code>right</code>. <code>quicksort(arr, 0, index - 1)</code> is recursed into over and over again. <code>quicksort(arr, index, right)</code> is never reached.</p>\n\n<hr>\n\n<p>Your <code>partition</code> is fine, and good eye noticing <code>pivot</code> can be calculated inside <code>pivot</code>.</p>\n\n<p>What tripped you up is those defaults. You're setting a default for <code>right</code> any time it's less than 1. But it should only be set if it isn't passed in at all.</p>\n\n<pre><code>def quicksort(arr, left = 0, right = arr.length - 1)\n  if left &lt; right\n    index = partition(arr, left, right)\n    quicksort(arr, left, index - 1)\n    quicksort(arr, index, right)\n  end\n  arr\nend\n</code></pre>\n\n<p>Now <code>quicksort(array)</code> is equivalent to <code>quicksort(array, 0, array.length - 1)</code>. Subsequent recursive calls pass <code>left</code> and <code>right</code> in, so no need for defaults.</p>\n\n<p>And no default for the array. If they forget to pass an array in that should be an <a href=\"https://ruby-doc.org/core/ArgumentError.html\" rel=\"nofollow noreferrer\">ArgumentError</a>.</p>\n\n<hr>\n\n<p>I prefer the public wrapper approach used in the video. If someone accidentally passes in too many arguments they get a clear ArgumentError rather than something weird happening.</p>\n\n<pre><code># Using the ! convention for functions which alter their arguments.\ndef quicksort!(array)\n  _quicksort!(array, 0, array.length - 1)\nend\n\nprivate def _quicksort!(array, left, right)\n  ...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 0, "last_activity_date": 1564971954, "creation_date": 1564971954, "answer_id": 57351583, "question_id": 57343346, "link": "https://stackoverflow.com/questions/57343346/quick-sort-algorithm-in-ruby-stack-level-too-deep/57351583#57351583", "title": "Quick Sort Algorithm in Ruby - Stack Level Too Deep", "body": "<p>If sorting large arrays, the stack space can be limited to O(log(n)), but worst case time complexity will remain at O(n^2). I don't know ruby syntax, but the ideal is to only recurse on the smaller partition, and loop back for the larger partition:</p>\n\n<pre><code>def quicksort(arr, left = 0, right = arr.length - 1)\n  while left &lt; right\n    index = partition(arr, left, right)\n    if((index - left) &lt; (right-index))\n        quicksort(arr, left, index - 1)\n        left = index\n    else\n        quicksort(arr, index, right)\n        right = index-1\n  end\n  arr\nend\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 1515316, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/lLdvb.jpg?s=128&g=1", "display_name": "wise_gremlin", "link": "https://stackoverflow.com/users/1515316/wise-gremlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 57343542, "answer_count": 2, "score": 1, "last_activity_date": 1564971954, "creation_date": 1564885529, "question_id": 57343346, "link": "https://stackoverflow.com/questions/57343346/quick-sort-algorithm-in-ruby-stack-level-too-deep", "title": "Quick Sort Algorithm in Ruby - Stack Level Too Deep", "body": "<p>I am trying to implement a quick sort algorithm in Ruby. I got a simple one working pretty quickly but it involved creating temporary arrays on the fly. I'm trying to implement a more streamlined quick sort that only swaps elements in place without the need to create additional arrays.</p>\n\n<p>Does anyone know why this code doesn't work? I've been following the pattern laid out <a href=\"https://www.youtube.com/watch?v=SLauY6PpjW4&amp;list=PLI1t_8YX-ApvMthLj56t1Rf-Buio5Y8KL&amp;index=7\" rel=\"nofollow noreferrer\">here</a> in exact detail but I can't get it to work properly.</p>\n\n<pre><code>def quicksort(arr = [], left = 0, right = 0)\n  right = arr.length - 1 if right &lt; 1\n  if left &lt; right\n    index = partition(arr, left, right)\n    quicksort(arr, left, index - 1)\n    quicksort(arr, index, right)\n  end\n  arr\nend\n\ndef partition(arr, left, right)\n  pivot = arr[(left + right) / 2]\n  while left &lt;= right\n    left += 1 while arr[left] &lt; pivot\n    right -= 1 while arr[right] &gt; pivot\n    if left &lt;= right\n      arr[left], arr[right] = arr[right], arr[left]\n      left += 1\n      right -= 1\n    end\n  end\n  left\nend\n\narr = [8, 10, 13, 5, 6, 20, 2, 43, 9, 11, 15]\np quicksort(arr)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "bootstrap-datepicker"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8615985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec0bc944dc621fbea401a8c71a2ed6a?s=128&d=identicon&r=PG&f=1", "display_name": "cag", "link": "https://stackoverflow.com/users/8615985/cag"}, "edited": false, "score": 1, "creation_date": 1564916245, "post_id": 57344750, "comment_id": 101179789, "body": "Wow!  What a simple solution.  That worked.  Thank you so much for sharing your knowledge!"}], "tags": [], "owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "is_accepted": true, "score": 0, "last_activity_date": 1564904112, "creation_date": 1564904112, "answer_id": 57344750, "question_id": 57342532, "link": "https://stackoverflow.com/questions/57342532/rails-bootstrap-datepicker-calendar-is-covered-by-drop-down-list-when-adding-n/57344750#57344750", "title": "Rails bootstrap datepicker - Calendar is covered by drop down list when adding new record", "body": "<p>one of alternatif solution for your problem is to turned off autocomplete field, you can turned off html autocomplete from previous input with this command below</p>\n\n<pre><code>&lt;%= form_for @your_data , :html =&gt; {:autocomplete=&gt; 'off'} do |f| %&gt;\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8615985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec0bc944dc621fbea401a8c71a2ed6a?s=128&d=identicon&r=PG&f=1", "display_name": "cag", "link": "https://stackoverflow.com/users/8615985/cag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 57344750, "answer_count": 1, "score": 0, "last_activity_date": 1564904112, "creation_date": 1564871605, "question_id": 57342532, "link": "https://stackoverflow.com/questions/57342532/rails-bootstrap-datepicker-calendar-is-covered-by-drop-down-list-when-adding-n", "title": "Rails bootstrap datepicker - Calendar is covered by drop down list when adding new record", "body": "<p>I have some strange behavior happening with bootstrap datepicker in a rails form. I'm using form_for in a partial for edit and new. When editing, the calendar shows perfectly when clicking on the date field but when adding a new record, the calendar is covered over by a dropdown list containing about 6 dates recently entered via the form. The calendar control is also open under the list. I can see the right edge of it. Also, when I move the browser window around or go to another open app and then back to the browser, only the calendar is there...the drop down list disappears.  So odd!</p>\n\n<p>I've been searching for a solution for several weeks and have scoured the internet and the datepicker documentation but just can't figure this out.  Any guidance appreciated!</p>\n\n<p>Here is the text_field within my form_for.</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n&lt;%= f.text_field :visit_date, {\"data-provide\" =&gt; 'datepicker', \n\"data-date-format\" =&gt; \"yyyy-mm-dd\", \"data-date-autoclose\" =&gt; \n\"true\"} %&gt;\n &lt;%= f.text_area :location, placeholder: \"Add visit location...\" %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I have the gem in my gem file as:</p>\n\n<pre><code>gem 'bootstrap-datepicker-rails', '~&gt; 1.8.0'\n</code></pre>\n\n<p>I have the following in my application.js file:</p>\n\n<pre><code>//= require bootstrap-datepicker\n</code></pre>\n\n<p>And I have this in my application.css.scss file:</p>\n\n<pre><code> *= require_tree .\n *= require_self\n *= require bootstrap-datepicker3\n */\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "isomorphic", "hyperstack"], "answers": [{"comments": [{"owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "edited": false, "score": 0, "creation_date": 1564875118, "post_id": 57342523, "comment_id": 101173743, "body": "This would almost work.  The problem is <code>new</code> only creates a component but does not actually render it.  You would have to use the <code>insert_element</code> method instead of new.  Otherwise pretty good answer for somebody who never used Hyperstack :-)"}], "tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": false, "score": 2, "last_activity_date": 1564871545, "creation_date": 1564871545, "answer_id": 57342523, "question_id": 57342385, "link": "https://stackoverflow.com/questions/57342385/can-i-use-something-along-the-lines-of-stringconstantize-to-initialize-a-hypers/57342523#57342523", "title": "Can I use something along the lines of String#constantize to initialize a Hyperstack::Component?", "body": "<p>Never used HyperStack, but this should give you the right idea.</p>\n\n<pre><code>class Thing &lt; ApplicationRecord\n  OBJECT_TYPES = { 'A': 'CommponentA' }.freeze\n\n  def to_component\n    @to_component ||= OBJECT_TYPES[self.name].constantize.new(self)\n  end \nend \n</code></pre>\n\n<p>You could just <code>\"Component#{self.name}\".constantize.new(self)</code> but I've found that to be rather confusing to other developers when they jump in on a project.</p>\n\n<p>Keep in mind <code>String#constantize</code> will return the actual constant, and not just a string that's constantized (camelcased and what have you) so you can call <code>#new</code> or <code>#call</code> or whatever you want on it.</p>\n"}, {"tags": [], "owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1564874948, "creation_date": 1564874948, "answer_id": 57342769, "question_id": 57342385, "link": "https://stackoverflow.com/questions/57342385/can-i-use-something-along-the-lines-of-stringconstantize-to-initialize-a-hypers/57342769#57342769", "title": "Can I use something along the lines of String#constantize to initialize a Hyperstack::Component?", "body": "<p>Every component class defines a method of the same name as the class.  When you say for example </p>\n\n<pre><code>ComponentA(data: object)\n</code></pre>\n\n<p>you are calling a method named <code>ComponentA</code> that is tied the the ComponentA class.</p>\n\n<p>So to dynamically reference the component you would use the <code>send</code> method:</p>\n\n<pre><code>send('Component' + object.name, data: object)\n</code></pre>\n\n<p>Alternatively each component class has a class method <code>insert_element</code> which will render an instance of the component class, and insert it into the rendering buffer.  For example:</p>\n\n<pre><code>('Component' + object.name).constantize.insert_element(data: object)\n</code></pre>\n\n<p>I bring this up because while it is longer, you could use it to generalize this idea of yours (which I think is pretty cool)</p>\n\n<pre><code>class ApplicationRecord &lt; ActiveRecord::Base\n  def render(opts = {})\n    ('Component' + object.name).constantize.insert_element(opts, data: object)\n  end\nend\n</code></pre>\n\n<p>Now you can say</p>\n\n<pre><code>some_record.render\n</code></pre>\n\n<p>Of course to generalize it like this you might want to use something other than <code>name</code>.  Anyway you could really have fun with this !</p>\n"}], "owner": {"reputation": 13, "user_id": 11350995, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohMaylliJM0/AAAAAAAAAAI/AAAAAAAAFqA/1xAhNIid3fc/photo.jpg?sz=128", "display_name": "Tim Blokdijk", "link": "https://stackoverflow.com/users/11350995/tim-blokdijk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 57342769, "answer_count": 2, "score": 1, "last_activity_date": 1564874948, "creation_date": 1564869736, "question_id": 57342385, "link": "https://stackoverflow.com/questions/57342385/can-i-use-something-along-the-lines-of-stringconstantize-to-initialize-a-hypers", "title": "Can I use something along the lines of String#constantize to initialize a Hyperstack::Component?", "body": "<p>I have some objects in my DB that I like to render with a dedicated Hyperstack view Component.\nLets say my objects have a unique <code>name</code> property from A to J. Now I would like to loop through them with <code>each</code> and render a <code>ComponentA</code>, <code>ComponentB</code>, <code>ComponentC</code>, ... depending on the <code>name</code> of my object, and pass my object as a param to the component.</p>\n\n<p>What I do now is:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>DB_Objects.each do |object|\n  if    object.name == 'A'\n    ComponentA(data: object)\n  elsif object.name == 'B'\n    ComponentB(data: object)\n  elsif object.name == 'C'\n    ComponentC(data: object)\n  elsif ...\n</code></pre>\n\n<p>What I want to do is something like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>DB_Objects.each do |object|\n  ('Component' + object.name).constantize(data: object)\nend\n</code></pre>\n\n<p>This is pseudo code as you can't give variables to constantize.\nBut it shows what I would like to do.</p>\n\n<p>How can I prevent a manual mapping of a object to its view.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "cloud9-ide", "cloud9", "aws-cloud9"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "edited": false, "score": 0, "creation_date": 1564865162, "post_id": 57341816, "comment_id": 101172274, "body": "Wow, great! Not sure how that worked, but it did - thank you"}, {"owner": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "edited": false, "score": 1, "creation_date": 1564940787, "post_id": 57341816, "comment_id": 101185526, "body": "No worries. Did as you said, the above worked using the &quot;XXX&quot;, but I&#39;ve now updated the :host to match the root URL -  thanks will also look into the links in future to get more of an understanding"}], "tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": true, "score": 0, "last_activity_date": 1564864263, "last_edit_date": 1564864263, "creation_date": 1564863593, "answer_id": 57341816, "question_id": 57341676, "link": "https://stackoverflow.com/questions/57341676/missing-host-to-link-to-please-provide-the-host-parameter-set-default-url-opt/57341816#57341816", "title": "Missing host to link to! Please provide the :host parameter, set default_url_options[:host]", "body": "<p>If you are using Rails 5, try this: </p>\n\n<p><code>Rails.application.routes.default_url_options[:host] = \"XXX\"</code></p>\n\n<p>Found <a href=\"https://stackoverflow.com/questions/36131936/missing-host-to-link-to-please-provide-the-host-parameter-for-rails-4/41336950\">here</a> and there was a similar discussion on <a href=\"https://github.com/rails/rails/issues/32500\" rel=\"nofollow noreferrer\">Github</a></p>\n"}], "owner": {"reputation": 25, "user_id": 11656173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdba6af2c7c8c42d2c8ed9ed2a3fd453?s=128&d=identicon&r=PG&f=1", "display_name": "marca", "link": "https://stackoverflow.com/users/11656173/marca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 57341816, "answer_count": 1, "score": 1, "last_activity_date": 1564898347, "creation_date": 1564862149, "last_edit_date": 1564898347, "question_id": 57341676, "link": "https://stackoverflow.com/questions/57341676/missing-host-to-link-to-please-provide-the-host-parameter-set-default-url-opt", "title": "Missing host to link to! Please provide the :host parameter, set default_url_options[:host]", "body": "<p>Trying to preview my mailer in development, but I'm getting the above error.\n(Using Michael Hartl Tutorial).</p>\n\n<p>I believe it's not working because of my host. However, using cloud 9 I'm struggling to find what my host is. In the book it's defined as <code>host ='rails-tutorial-mhartl.c9users.io'</code> for the Cloud IDE, but this is unique to the book writer.</p>\n\n<p>I tried using localhost, which hasn't worked and my dev url is different to whats in the book if this relates: <code>\"..0.vfs.cloud9.us-east-2.amazonaws.com/\"</code></p>\n\n<p>Essentially if I can find out my unique Cloud IDE host the problem  should get fixed, but I don't know where to locate this</p>\n\n<p>development.rb</p>\n\n<pre><code>config.action_mailer.raise_delivery_errors = true  \nconfig.action_mailer.delivery_method = :test  \nhost = 'localhost:8080' \nconfig.action_mailer.default_url_options = { host: host, protocol: 'http' }\n</code></pre>\n\n<p>account_activation.html.erb</p>\n\n<pre><code>&lt;h1&gt;Sample App&lt;/h1&gt;\n&lt;p&gt;Hi &lt;%= @user.name %&gt;,&lt;/p&gt;\n\n&lt;p&gt;\n  Welcome to the Sample App! Click on the link below to activate your account:\n&lt;/p&gt;\n\n&lt;%= link_to \"Activate\", edit_account_activation_url(@user.activation_token,\n                                                email: @user.email) %&gt;\n</code></pre>\n\n<p>The page should load with the email preview, but full error message is: </p>\n\n<blockquote>\n  <p>Missing host to link to! Please provide the :host parameter, set default_url_options[:host], or set :only_path to true</p>\n</blockquote>\n"}]