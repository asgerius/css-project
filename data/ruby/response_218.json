[{"tags": ["ruby"], "comments": [{"owner": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1552523415, "post_id": 55152746, "comment_id": 97046631, "body": "Interesting article.  Are you saying that splats work in a different way when the sub elements are hashes, and so that is why it is not working?  If so, do you want to write up an answer that I can accept."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1552527268, "post_id": 55152746, "comment_id": 97047591, "body": "I updated my answer which may also help you understand this better."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552554197, "post_id": 55152979, "comment_id": 97056145, "body": "<i>&quot;it has unintended side-effects when you call it on an array of hashes&quot;</i> \u2013 an array of hashes is still an array. Furthermore, if <code>scores</code> is an array, <code>call([*scores])</code> is equivalent to <code>call(scores)</code> so you&#39;ll end up wrapping your array in an extra array within the method, i.e. <code>[[{a: 1}, {b: 3}]]</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1552567769, "post_id": 55152979, "comment_id": 97064800, "body": "<i>&quot;Your hash gets converted to an array&quot;</i> \u2013 only if you splat a hash. But in the OP&#39;s example, <code>scores</code> is an array. <code>*scores</code> does <b>not</b> convert the hashes within <code>scores</code> to arrays. The error is caused by passing multiple hashes to a method that also accepts keyword arguments."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 3, "last_activity_date": 1552601215, "last_edit_date": 1552601215, "creation_date": 1552522059, "answer_id": 55152979, "question_id": 55152746, "link": "https://stackoverflow.com/questions/55152746/optional-key-word-argument-needed-after-splat-argument-when-sub-elements-are-not/55152979#55152979", "title": "optional key word argument needed after splat argument when sub-elements are not arrays", "body": "<p>The splat operator splits the array into arguments.</p>\n\n<p>However if you wrap it in an array it works again but now it's an array inside an array and still treated as a single argument passed to your method.</p>\n\n<pre><code>call([*scores]) #no error\n</code></pre>\n\n<p>But also to illustrate why you got the error look what happens here:</p>\n\n<pre><code>def call(*scores, alpha: nil)\n  puts scores.inspect\nend\n\ncall(*scores[0]) #=&gt; #[[:a, 1]]\n</code></pre>\n\n<p>UPDATED:  Thanks to @Stefan, the reason for the error is actually that your method accepts keyword arguments, which is apparently a known bug. See <a href=\"https://stackoverflow.com/questions/42848700/keyword-arguments-unpacking-splat-in-ruby\">Keyword arguments unpacking (splat) in Ruby</a></p>\n\n<p>The reason your last example works is that by passing a 2nd argument to your method, the splat handles the first argument as an array instead of trying to split it up into 2 arguments.</p>\n\n<p>Fore more see <a href=\"https://stackoverflow.com/questions/921403/ruby-source-code-of-splat\">Ruby, Source Code of Splat?</a></p>\n\n<p>Also see <a href=\"https://www.rubyguides.com/2018/07/ruby-operators/#Ruby_Splat_Operator\" rel=\"nofollow noreferrer\">https://www.rubyguides.com/2018/07/ruby-operators/#Ruby_Splat_Operator</a></p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 2, "last_activity_date": 1552555293, "last_edit_date": 1552555293, "creation_date": 1552553816, "answer_id": 55158399, "question_id": 55152746, "link": "https://stackoverflow.com/questions/55152746/optional-key-word-argument-needed-after-splat-argument-when-sub-elements-are-not/55158399#55158399", "title": "optional key word argument needed after splat argument when sub-elements are not arrays", "body": "<p><code>*</code> converts the array elements to an argument list, so:</p>\n\n<pre><code>call(*[{a: 1}, {b: 3}])\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>call({a: 1}, {b: 3})\n</code></pre>\n\n<p>Ruby also converts hashes to keyword arguments implicitly (without <code>**</code>), so the above is equivalent to:<sup>\u2020</sup></p>\n\n<pre><code>call({a: 1}, b: 3)\n</code></pre>\n\n<p>Therefore, <code>{a: 1}</code> is treated as a <em>positional argument</em>, and <code>b: 3</code> (or <code>{b: 3}</code>) as a <em>keyword argument</em>. And because <code>call</code> doesn't take a keyword argument named <code>b</code> you get <code>ArgumentError: unknown keyword: b</code>.</p>\n\n<p>To avoid this, you can pass an extra empty hash<sup>\u2021</sup> as the last argument:</p>\n\n<pre><code>call({a:1}, {b:2}, {})\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>call(*[{a:1}, {b:2}], {})\n</code></pre>\n\n<p>or</p>\n\n<pre><code>scores = [{a:1}, {b:2}]\ncall(*scores, {})\n</code></pre>\n\n<hr>\n\n<p><sup>\u2020</sup> There's a <a href=\"https://bugs.ruby-lang.org/issues/14183\" rel=\"nofollow noreferrer\">feature request</a> to add \"real\" keyword arguments in Ruby 3.</p>\n\n<hr>\n\n<p><sup>\u2021</sup> IMO, it would be more correct to use <code>call(*scores, **{})</code> to indicate \"no keyword arguments\", but due to a <a href=\"https://bugs.ruby-lang.org/issues/15052\" rel=\"nofollow noreferrer\">bug</a> this currently doesn't work. You could however use <code>call(*scores, **Hash.new)</code></p>\n"}], "owner": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 55152979, "answer_count": 2, "score": 4, "last_activity_date": 1552601215, "creation_date": 1552520237, "last_edit_date": 1552524403, "question_id": 55152746, "link": "https://stackoverflow.com/questions/55152746/optional-key-word-argument-needed-after-splat-argument-when-sub-elements-are-not", "title": "optional key word argument needed after splat argument when sub-elements are not arrays", "body": "<p>According to this <a href=\"https://www.rubyguides.com/2018/06/rubys-method-arguments/\" rel=\"nofollow noreferrer\">post</a>, it is possible to have an optional key word argument after a splat argument.  This works if the splat argument is introducing an array of arrays, but not when it is an array of hashes</p>\n\n<p>For example if the method being called is defined as</p>\n\n<pre><code>def call(*scores, alpha: nil)\n  puts scores\nend\n</code></pre>\n\n<p>then this works</p>\n\n<pre><code>scores = [[1,2],[3,4]]\ncall(*scores)\n</code></pre>\n\n<p>but this does not</p>\n\n<pre><code>scores = [ {a: 1}, {b: 3}]\ncall(*scores)\n</code></pre>\n\n<p>giving the following (with ruby 2.4.4)</p>\n\n<pre><code>ArgumentError: unknown keyword: b\n</code></pre>\n\n<p>but this works</p>\n\n<pre><code>scores = [ {a: 1}, {b: 3}]\ncall(*scores, alpha: nil)\n</code></pre>\n\n<p>What is going wrong here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postman", "hashtag"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1552520225, "post_id": 55152502, "comment_id": 97045837, "body": "Nice example of why it is error prone to generate URLs with string concatenation or interpolation instead of using a proper URI builder."}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "edited": false, "score": 0, "creation_date": 1552534923, "post_id": 55152502, "comment_id": 97049246, "body": "You have <code>content=</code> twice in you request"}], "answers": [{"comments": [{"owner": {"reputation": 2480, "user_id": 1561081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/acd9e93464c089acdf36bf1d8ce793c9?s=128&d=identicon&r=PG", "display_name": "lrleon", "link": "https://stackoverflow.com/users/1561081/lrleon"}, "edited": false, "score": 1, "creation_date": 1552569723, "post_id": 55152641, "comment_id": 97066258, "body": "With gratitude, I upvote and accept your answer. Regards"}], "tags": [], "owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "is_accepted": true, "score": 2, "last_activity_date": 1552519421, "creation_date": 1552519421, "answer_id": 55152641, "question_id": 55152502, "link": "https://stackoverflow.com/questions/55152502/passing-symbol-to-params-hash-in-rails/55152641#55152641", "title": "passing # symbol to params hash in rails", "body": "<p>You need to make sure <a href=\"https://ruby-doc.org/stdlib-2.5.3/libdoc/uri/rdoc/URI/Escape.html\" rel=\"nofollow noreferrer\">you encode</a> whatever you are sending over in param.</p>\n\n<pre><code>URI.encode(\"This string contains this #hashtag and this #one\")\n\n#=&gt; This%20string%20contains%20this%20%23hashtag%20and%20this%20%23one\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "is_accepted": false, "score": 1, "last_activity_date": 1552535514, "last_edit_date": 1552535514, "creation_date": 1552535114, "answer_id": 55154656, "question_id": 55152502, "link": "https://stackoverflow.com/questions/55152502/passing-symbol-to-params-hash-in-rails/55154656#55154656", "title": "passing # symbol to params hash in rails", "body": "<p>Update your postman request to replace the <code>#</code> with <code>%23</code></p>\n\n<pre><code>{{url}}/add?content=This string contains this %23hashtag and this %23one\n</code></pre>\n\n<p>In the future when doing something like this you can select a part of the params(or the whole thing) and right click and select <code>EncodeURIComponent</code>, as explained <a href=\"https://learning.getpostman.com/docs/postman/sending_api_requests/requests/#url\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 2480, "user_id": 1561081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/acd9e93464c089acdf36bf1d8ce793c9?s=128&d=identicon&r=PG", "display_name": "lrleon", "link": "https://stackoverflow.com/users/1561081/lrleon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 55152641, "answer_count": 2, "score": 1, "last_activity_date": 1552535514, "creation_date": 1552518529, "question_id": 55152502, "link": "https://stackoverflow.com/questions/55152502/passing-symbol-to-params-hash-in-rails", "title": "passing # symbol to params hash in rails", "body": "<p>I am handling some hashtag processing in a rails application.</p>\n\n<p>Say us that I have programmed an endpoint which receives through <code>params</code> hash a string containing some hashtags. Some like that</p>\n\n<p><code>This string contains this #hashtag and this #one</code>.</p>\n\n<p>I am using postman for testing my endpoints.</p>\n\n<p>Now, when in postman I perform some like this:</p>\n\n<p><code>{{url}}/add?content=content=This string contains this #hashtag and this #one</code></p>\n\n<p>I receive in the <code>params</code> the string <code>\"content\"=&gt;\"This string contains this \"</code>. That is, from the first occurrence of symbol <code>#</code> the remaining string is cut.</p>\n\n<p>Very aware that my question is some naive, I dare to ask why that? What have I done wrong? and how could I manage for passing strings containing the <code>#</code> symbol?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake"], "answers": [{"tags": [], "owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "is_accepted": false, "score": 1, "last_activity_date": 1552518765, "creation_date": 1552518765, "answer_id": 55152546, "question_id": 55152200, "link": "https://stackoverflow.com/questions/55152200/how-to-fix-nameerror-uninitialized-constant-uglifier/55152546#55152546", "title": "How to fix &quot;NameError: uninitialized constant Uglifier&quot;", "body": "<p>This just means that you have some syntax somewhere, most likely in a JS file. Check the last files you have worked on and look for a syntax error.</p>\n"}], "owner": {"reputation": 41, "user_id": 10274489, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PqcouUOvXEs/AAAAAAAAAAI/AAAAAAAACiE/E5Yl-GaL0mA/photo.jpg?sz=128", "display_name": "Md. Tanvir Rahaman", "link": "https://stackoverflow.com/users/10274489/md-tanvir-rahaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1552573010, "creation_date": 1552516638, "last_edit_date": 1552573010, "question_id": 55152200, "link": "https://stackoverflow.com/questions/55152200/how-to-fix-nameerror-uninitialized-constant-uglifier", "title": "How to fix &quot;NameError: uninitialized constant Uglifier&quot;", "body": "<p>When I run <code>rake db:setup</code> I get the error:</p>\n\n<blockquote>\n  <p>deploy@Exchange:~/.rbenv/peatio$ bundle exec rake db:setup\n  peatio_production already exists\n  rake aborted!\n  NameError: uninitialized constant Uglifier\n  /home/deploy/.rbenv/peatio/config/environments/production.rb:26:in <code>block in &lt;top (required)&gt;</code>\n  <br> /home/deploy/.rbenv/peatio/vendor/bundle/ruby/2.5.0/gems/railties-4.2.11.1/lib/rails/railtie.rb:210:in <code>instance_eval</code>\n  <br>/home/deploy/.rbenv/peatio/vendor/bundle/ruby/2.5.0/gems/railties-4.2.11.1/lib/rails/railtie.rb:210:in <code>configure</code>\n  <br>/home/deploy/.rbenv/peatio/vendor/bundle/ruby/2.5.0/gems/railties-4.2.11.1/lib/rails/railtie.rb:182:in <code>configure</code>\n  <br>/home/deploy/.rbenv/peatio/config/environments/production.rb:1:in <code>&lt;top (required)&gt;</code></p>\n</blockquote>\n\n<p>Can somebody help me with it?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-4", "rails-console"], "owner": {"reputation": 65, "user_id": 5009179, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fONrH5SuAIQ/AAAAAAAAAAI/AAAAAAAABOA/obJfG5aYtKo/photo.jpg?sz=128", "display_name": "Denis Gubaua", "link": "https://stackoverflow.com/users/5009179/denis-gubaua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552515756, "creation_date": 1552515756, "question_id": 55152051, "link": "https://stackoverflow.com/questions/55152051/rails-4-sql-genereted-by-console-is-different-of-executed-by-action", "title": "Rails 4 SQL genereted by console is different of executed by action", "body": "<p>I tried to create a job with search of results using a text field containing a date (YYYY-MM-DD), where it should bring me only 1 result for each month.</p>\n\n<p><strong>For example:</strong>\nIf they have two or more records with dates of the same month, even if they are different days, only the first record of the month must be returned.</p>\n\n<p>The problem is when I run the command on the console, it runs my query exactly as it should, when it executes via an action Rails generates a different SQL.</p>\n\n<p><strong>I already tried this:</strong></p>\n\n<p>1) <code>Model.select(\"DISTINCT DATE_FORMAT(date_column, '%Y-%m') as date\").where(id: model_id)</code></p>\n\n<p>2) <code>Model.select(\"DATE_FORMAT(date_column, '%Y-%m') as date\").where(id: model_id).distinct</code></p>\n\n<p><strong>Console query:</strong></p>\n\n<p>1 and 2 return same query\n<code>SELECT DISTINCT DATE_FORMAT(date_column, '%Y-%m') as date FROM model WHERE model.id = 1</code></p>\n\n<p><strong>Action query:</strong></p>\n\n<p>1) <code>SELECT COUNT (*) FROM model WHERE model.id = 1</code></p>\n\n<p>2) <code>SELEC DISTINC id FROM model WHERE model.id = 1</code></p>\n\n<p>What am I doing wrong or how could I do this search correctly?</p>\n\n<p><strong>I use:</strong></p>\n\n<p>Rails 4\nMariaDB\nUnicorn\nIrb</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552511888, "post_id": 55151300, "comment_id": 97043006, "body": "JFYI, there&#39;s no such thing as &quot;render tag&quot;. Nor  &quot;link_to tag&quot;, etc."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1552541457, "post_id": 55151300, "comment_id": 97050736, "body": "Can you explain what, precisely, is unclear to you about the documentation of the <code>render</code> method? That way, the Rails developers can improve the documentation so that future programmers don&#39;t run into the same problem."}, {"owner": {"reputation": 19, "user_id": 7390596, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mc2RiEGjOPE/AAAAAAAAAAI/AAAAAAAAE6A/RuMs4VQeyWs/photo.jpg?sz=128", "display_name": "jericoluislua", "link": "https://stackoverflow.com/users/7390596/jericoluislua"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552589354, "post_id": 55151300, "comment_id": 97079159, "body": "Sorry just started with Ruby a few weeks back, what would be the correct term for it? ^_^ @SergioTulentsev"}, {"owner": {"reputation": 19, "user_id": 7390596, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mc2RiEGjOPE/AAAAAAAAAAI/AAAAAAAAE6A/RuMs4VQeyWs/photo.jpg?sz=128", "display_name": "jericoluislua", "link": "https://stackoverflow.com/users/7390596/jericoluislua"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1552589361, "post_id": 55151300, "comment_id": 97079164, "body": "Sorry, I actually haven&#39;t checked the documentation, I am just working on some worksheets the school gave. I will totally give it a look @J&#246;rgWMittag"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1552512037, "post_id": 55151332, "comment_id": 97043075, "body": "Ah, but that&#39;s controller&#39;s <code>render</code>. Not the same thing as view&#39;s render."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1552512751, "post_id": 55151332, "comment_id": 97043392, "body": "@SergioTulentsev - Ugh! Ok. So, is <a href=\"https://apidock.com/rails/ActionView/Helpers/RenderingHelper/render\" rel=\"nofollow noreferrer\">ActionView::Helpers::RenderingHelper</a> the correct reference? Or???"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1552513040, "post_id": 55151332, "comment_id": 97043541, "body": "Yep, this one is better :)"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1552513408, "post_id": 55151332, "comment_id": 97043689, "body": "Thanks, pal. Tough crowd around here."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 6, "creation_date": 1552513632, "post_id": 55151332, "comment_id": 97043764, "body": "Well, you know, nerds love nothing more than correcting other nerds :)"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 1, "last_activity_date": 1552511725, "creation_date": 1552511725, "answer_id": 55151332, "question_id": 55151300, "link": "https://stackoverflow.com/questions/55151300/are-there-other-uses-for-the-render-tag-in-ruby/55151332#55151332", "title": "Are there other uses for the render tag in ruby?", "body": "<p>According to the <a href=\"https://guides.rubyonrails.org/layouts_and_rendering.html#using-render\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>There are a variety of ways to customize the behavior of render. You can render the default view for a Rails template, or a specific template, or a file, or inline code, or nothing at all. You can render text, JSON, or XML. You can specify the content type or HTTP status of the rendered response as well.</p>\n</blockquote>\n"}], "owner": {"reputation": 19, "user_id": 7390596, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mc2RiEGjOPE/AAAAAAAAAAI/AAAAAAAAE6A/RuMs4VQeyWs/photo.jpg?sz=128", "display_name": "jericoluislua", "link": "https://stackoverflow.com/users/7390596/jericoluislua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1552511725, "creation_date": 1552511600, "question_id": 55151300, "link": "https://stackoverflow.com/questions/55151300/are-there-other-uses-for-the-render-tag-in-ruby", "title": "Are there other uses for the render tag in ruby?", "body": "<p>Is the &lt;%= render \"example\" %> tag only for partial views or are there actually other uses for this tag?</p>\n"}, {"tags": ["arrays", "ruby", "substring"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1552510144, "post_id": 55150658, "comment_id": 97042217, "body": "I guess you could use a regex, but I don&#39;t know if that&#39;s really a better way."}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1552510381, "post_id": 55150658, "comment_id": 97042342, "body": "@maxpleaner Yeah, I thought about that too, but I don&#39;t see a way to use a regex that doesn&#39;t involve iterating the array. Do you?"}], "answers": [{"comments": [{"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1552511996, "post_id": 55151270, "comment_id": 97043058, "body": "Mighty interesting. I&#39;m getting a little better at regex all the time, and I knew you could use the <code>\\1</code> in a block with <code>gsub</code>, but I didn&#39;t know you could use it this way. Very cool. I&#39;ll study it a bit and see if I can adapt it to get any specific set of contiguous character locations in each word as well, which is in the end what I&#39;m looking for."}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1552523107, "post_id": 55151270, "comment_id": 97046553, "body": "After your idea of using a regex on the string, I came up with this one: <code>string.split.scan(&#47;^\\w|(?&lt;=\\W)\\w&#47;).join</code>. I used <code>}W</code> because some of the words were hyphenated instead of spaced."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1552526386, "post_id": 55151270, "comment_id": 97047378, "body": "Cool im not really that good at regex, never got around to learning the lookaheads"}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1552583492, "post_id": 55151270, "comment_id": 97076084, "body": "I&#39;m just getting started with it. That one is actually a lookbehind, from what I&#39;m told. So, as I understand it, the <code>\\w</code> following the captured string <code>(?&lt;=\\W)</code> is compared to the captured string. The captured string is asking whether the immediately preceding character matches <code>\\W</code>, or a non-alphanumeric character. (I have since realized that this also matches apostrophes, which doesn&#39;t suit my needs, so I have changed it to <code>(?&lt;=[ -])</code> since I only want to match spaces or hyphens.) Are you familiar with <a href=\"https://rubular.com\" rel=\"nofollow noreferrer\">rubular.com</a>, by the way? I&#39;ve been learning a lot from tinkering there."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1552586499, "post_id": 55151270, "comment_id": 97077817, "body": "Yeah, rubular is nice. By the way you can feel free to accept your own answer on this one, so it doesn&#39;t appear unsolved."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 3, "last_activity_date": 1552511449, "creation_date": 1552511449, "answer_id": 55151270, "question_id": 55150658, "link": "https://stackoverflow.com/questions/55150658/ruby-getting-charactern-from-each-element-of-an-array-of-strings-strictly-wi/55151270#55151270", "title": "Ruby: getting character[n] from each element of an array of strings, strictly with array notation", "body": "<p>Here's a fancy regex way to do it, if you have the word combined in a single space-delimited string:</p>\n\n<pre><code>string = \"greater yellow bandicooot\"\nstring.gsub /([^ ])[^ ]* */, '\\1'\n# =&gt; \"gyb\"\n</code></pre>\n\n<p>Explanation of the regex:</p>\n\n<ul>\n<li><code>([^ ])</code>: match group - single nonspace char</li>\n<li><code>[^ ]* *</code>: optional sequence of nonspace chars, followed by any optional sequence of space chars.</li>\n</ul>\n\n<p>As you can read about here: <a href=\"https://stackoverflow.com/questions/26457321/ruby-regex-gsub-only-captured-group\">Ruby regex - gsub only captured group</a>, when using <code>gsub</code> everything in the entire regex is replaced, regardless of if it's in a match group. So you need to use the special variable <code>\\1</code> in the <code>gsub</code> call (must be in a single quoted string, by the way) to refer to the first match group, that you want to use as the output.</p>\n"}, {"comments": [{"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1552522868, "post_id": 55151784, "comment_id": 97046498, "body": "Very interesting. I&#39;ll keep it in mind for large datasets. Thanks for sharing."}], "tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": false, "score": 2, "last_activity_date": 1552514135, "creation_date": 1552514135, "answer_id": 55151784, "question_id": 55150658, "link": "https://stackoverflow.com/questions/55150658/ruby-getting-charactern-from-each-element-of-an-array-of-strings-strictly-wi/55151784#55151784", "title": "Ruby: getting character[n] from each element of an array of strings, strictly with array notation", "body": "<blockquote>\n  <p>And if you can't do it with array notation, is there a better way to do it than using map and join</p>\n</blockquote>\n\n<p>Well, the short (and wrong :)) answer is \"this is impossible\" - to get each nth character of each string in an array you obviously have to iterate (and yes, regexp is iteration too - most probably less performant than array iteration).</p>\n\n<p>But let's imagine you have a real app where you should perform this operation very very often and the list of strings is huge (so iterations are painful). On the other hand, the list of strings is rarely changed and you almost never need the original strings back. </p>\n\n<p>In this case, you could borrow the idea behind column storages and transform the original array into something like</p>\n\n<p><code>transposed_x = [\"gyb\", \"rea\", \"eln\", \"ald\", \"toi\", \"ewc\", \"r_o\", \"__o\", \"__o\", \"__t\"]</code></p>\n\n<p>where each nth element is just a concatenation of nth char of each original strings (here I replace \"missing\" character with _ for clarity). With this data model you can perform the original task 1) with just an array notation and 2) in O(1). As an obvious tradeoff, you will have to iterate for every other operation (fetching the original string back, adding/removing/updating etc)...</p>\n"}, {"comments": [{"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1553548860, "post_id": 55326672, "comment_id": 97417932, "body": "Interesting. Now, if you use lowercase <code>\\s</code>, it matches the two characters preceded by spaces but not the first character. So why do neither <code>\\s</code> nor <code>\\S</code> match the first character? Either it is or isn&#39;t preceded by a whitespace character, one would think. Is there some special characteristic of the first character in a string from a regex perspective?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 1, "creation_date": 1553551981, "post_id": 55326672, "comment_id": 97419058, "body": "Suppose I wrote the positive lookbehind as <code>(?&lt;=\\p{Alpha})</code>. Then <code>&quot;g&quot;</code> in <code>&quot;greater&quot;</code> is not preceded by a letter, so it&#39;s not a match and therefore is not converted to an empty string. The remaining characters are all preceded by a spae or a letter. The characters that match the regex are those  preceded by a letter. That&#39;s all spaces (since there is only one between words) and all letters other than the first of each word. I wrote <code>(?&lt;=\\S)</code> rather than <code>(?&lt;=\\p{Alpha})</code> so that all characters preceded by anything other than a whitespace character would be converted to an empty string."}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1553707669, "post_id": 55326672, "comment_id": 97488328, "body": "Oh, I see! You&#39;re matching every character of any type that is preceded by an alpha character. Therefore, characters preceded by a space or by nothing at all will not match. Perfect. Thanks for explaining."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1553711837, "last_edit_date": 1553711837, "creation_date": 1553449505, "answer_id": 55326672, "question_id": 55150658, "link": "https://stackoverflow.com/questions/55150658/ruby-getting-charactern-from-each-element-of-an-array-of-strings-strictly-wi/55326672#55326672", "title": "Ruby: getting character[n] from each element of an array of strings, strictly with array notation", "body": "<p>I don't believe there is a way to do what you want, but you could do the following. </p>\n\n<pre><code>str = %w(greater yellow bandicooot).join(' ')\n  #=&gt; \"greater yellow bandicooot\"\n\nstr.gsub(/(?&lt;=\\S)./, '')\n  #=&gt; \"gyb\"\n</code></pre>\n\n<p>The regular expression matches any character that is preceded by a non-whitespace character; that is, it matches all characters other than the first character of the string and characters preceded by a whitespace character.</p>\n\n<p>If one is given the string and there could be multiple spaces between words, one could write:</p>\n\n<pre><code>str.squeeze(' ').gsub(/(?&lt;=\\S)./, '')\n</code></pre>\n"}], "owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 55326672, "answer_count": 3, "score": 2, "last_activity_date": 1553711837, "creation_date": 1552508836, "last_edit_date": 1552511350, "question_id": 55150658, "link": "https://stackoverflow.com/questions/55150658/ruby-getting-charactern-from-each-element-of-an-array-of-strings-strictly-wi", "title": "Ruby: getting character[n] from each element of an array of strings, strictly with array notation", "body": "<p>Suppose I have this:</p>\n\n<pre><code>x = %w(greater yellow bandicooot)\n</code></pre>\n\n<p>And I want to get a specific letter of each string as a string. Of course, I can do something like this (to get the first letter):</p>\n\n<pre><code>x.map { |w| w[0] }.join  # =&gt; 'gyb'\n</code></pre>\n\n<p>But I'd like to know whether or not there's a way to do it using just array notation. I've tried this:</p>\n\n<pre><code>x[0][0]..x[-1][0]\n</code></pre>\n\n<p>Which returns, in this case, the not-so-helpful <code>\"g\"..\"b\"</code>. I could also use array notation like this in this case:</p>\n\n<pre><code>x[0][0] + x[1][0] + x[2][0]\n</code></pre>\n\n<p>But I'm looking for a non-case-specific solution that doesn't require iteration.</p>\n\n<p>Is there a way to do this strictly with array notation, or is it necessary to do some sort of iteration? And if you can't do it with array notation, is there a better way to do it than using <code>map</code> and <code>join</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1552505999, "post_id": 55150012, "comment_id": 97040333, "body": "Safer way: <code>ht_filepath = id_filepath.sub &#39;&#47;ht&#47;&#39;, &#39;&#47;id&#47;&#39;</code>"}, {"owner": {"reputation": 1765, "user_id": 1507704, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/785573f088dadbefb15252caa1fcbbfc?s=128&d=identicon&r=PG", "display_name": "Farooq", "link": "https://stackoverflow.com/users/1507704/farooq"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552506138, "post_id": 55150012, "comment_id": 97040412, "body": "Thanks @SergioTulentsev"}], "tags": [], "owner": {"reputation": 1765, "user_id": 1507704, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/785573f088dadbefb15252caa1fcbbfc?s=128&d=identicon&r=PG", "display_name": "Farooq", "link": "https://stackoverflow.com/users/1507704/farooq"}, "is_accepted": false, "score": 0, "last_activity_date": 1552505939, "creation_date": 1552505939, "answer_id": 55150012, "question_id": 55149791, "link": "https://stackoverflow.com/questions/55149791/how-to-modify-a-files-dirname-path/55150012#55150012", "title": "How to modify a file&#39;s dirname/path?", "body": "<p>I think I figured out the answer:</p>\n\n<p><code>ht_filepath = id_filepath.sub /ht/, 'id'</code></p>\n"}], "owner": {"reputation": 1765, "user_id": 1507704, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/785573f088dadbefb15252caa1fcbbfc?s=128&d=identicon&r=PG", "display_name": "Farooq", "link": "https://stackoverflow.com/users/1507704/farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1552507084, "creation_date": 1552505071, "last_edit_date": 1552507084, "question_id": 55149791, "link": "https://stackoverflow.com/questions/55149791/how-to-modify-a-files-dirname-path", "title": "How to modify a file&#39;s dirname/path?", "body": "<p>So I have an array called <code>ArrayHT</code> of xml docs. I want to search in that array for a particular xml document by the full path, but one part of the path needs to changed before searching.</p>\n\n<p>My setup:</p>\n\n<pre><code>ArrayID.each do |file| #loops through all elements of ArrayID\n  id_filepath = File.path(file) #creates id_filepath variable that contains the full filepath of the file/element currently in the loop\n  # =&gt; \"/some/path/ht/name/doc.xml\"\nend\n</code></pre>\n\n<p><strong>Problem</strong>: At this point I want to take the <code>id_filepath</code> variable and change <code>ht</code> to <code>id</code> and then I execute the following to find if the modified <code>id_filepath</code> exists in the <code>ArrayHT</code> array:</p>\n\n<pre><code>ht_filepath = ArrayHT.find { |e| e.match(id_filepath) } #searches another array, ArrayHT for the file\n</code></pre>\n\n<p>How best to do address the problem?</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3", "aws-lambda", "aws-sdk"], "comments": [{"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "edited": false, "score": 0, "creation_date": 1552559853, "post_id": 55149062, "comment_id": 97059733, "body": "Why do you create S3 resource inside the lambda if the goal is to process already uploaded stuff? As far as I understood, the lambda itself is triggered by the uploaded file, right? In this case, you should use S3 event payload which contains the name of the file (see here <a href=\"https://docs.aws.amazon.com/en_us/lambda/latest/dg/with-s3.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/en_us/lambda/latest/dg/with-s3.html</a>)"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "edited": false, "score": 0, "creation_date": 1552590103, "post_id": 55149062, "comment_id": 97079535, "body": "Hm, so you&#39;re saying, even if I could specify the file, I couldn&#39;t even change it because it&#39;s not in the s3 bucket yet since the lambda is ahead of that?"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552502126, "creation_date": 1552502126, "question_id": 55149062, "link": "https://stackoverflow.com/questions/55149062/specifying-the-file-that-triggers-to-event-in-lambda-code", "title": "Specifying the file that triggers to event in Lambda code", "body": "<p><strong>issue:</strong> I am unable to specify the file that triggers the event.  The goal is to add a watermark to uploaded video files.  I have successfully done this within elastic transcoder by creating a pipeline and job, but the goal is to now automate this process once files are uploaded.</p>\n\n<p>I now want to automate this process on file uploads to the s3 bucket.</p>\n\n<p><strong>This is my attempt (will explain my issue after code):</strong></p>\n\n<pre><code>require 'json'\nrequire 'aws-sdk-elastictranscoder'\nrequire \"aws-sdk-s3\"\n\n\ndef lambda_handler(event:, context:)\n  client = Aws::ElasticTranscoder::Client.new(region: 'us-east-1')\n\n  s3 = Aws::S3::Resource.new()\n  # object = s3.bucket(bucket_name).object(object_name)\n  # bucket_name = event[\"s3\"][\"bucket\"][\"name\"]\n  # object_name = event[\"s3\"][\"object\"][\"key\"]\n\n    resp = client.create_job({\n  pipeline_id: \"1552343938210-qevnz1\", # required\n  input: {\n    key: \"#{s3}\",\n    },\n  output: {\n    key: \"#{s3}\",\n   preset_id: \"1351620000001-000001\",\n    watermarks: [\n      {\n        preset_watermark_id: \"TopRight\",\n        input_key: \"uploads/listing/image/10/listing_howard-stern.jpg\",\n       },\n    ],\n  }\n  })\n\nend\n</code></pre>\n\n<p>see, where:</p>\n\n<pre><code>key: \"#{s3}\",\n    },\n</code></pre>\n\n<p>This is where i have issues.  I am unsure on how to call the exact file that is triggering the event.  I want to file that is being uploaded to have a watermark added to it, and then output'ed into the same file name in same location.</p>\n\n<p><strong>this gives me back:</strong></p>\n\n<p><code>input=#&lt;Aws::S3::Resource:0x000055bc11bb4388&gt;\\</code> and nothing happens, the job fails due to the input not being specified.</p>\n\n<p>How can i define or specify the file?</p>\n\n<p>I cannot find a way so far.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "serialization"], "comments": [{"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552496596, "post_id": 55147242, "comment_id": 97035395, "body": "Which Rails version are you using? With 4.0.0 and basic setup, everything works as expected (<code>#&lt;SerializeTest id: 1, data: #&lt;SerializeableObject id: nil, foo: &quot;test&quot;&gt;&gt;</code>)"}, {"owner": {"reputation": 613, "user_id": 431691, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aecfabeba74672ceec012e4ad48baebb?s=128&d=identicon&r=PG", "display_name": "luckyjazzbo", "link": "https://stackoverflow.com/users/431691/luckyjazzbo"}, "reply_to_user": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552497300, "post_id": 55147242, "comment_id": 97035845, "body": "I&#39;m using 4.2.10"}, {"owner": {"reputation": 613, "user_id": 431691, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aecfabeba74672ceec012e4ad48baebb?s=128&d=identicon&r=PG", "display_name": "luckyjazzbo", "link": "https://stackoverflow.com/users/431691/luckyjazzbo"}, "reply_to_user": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552500128, "post_id": 55147242, "comment_id": 97037355, "body": "@MrShemek I&#39;ve pushed my project with instructions how to reproduce in the readme <a href=\"https://github.com/luckyjazzbo/rails4-serialize-example\" rel=\"nofollow noreferrer\">github.com/luckyjazzbo/rails4-serialize-example</a>"}, {"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552500855, "post_id": 55147242, "comment_id": 97037727, "body": "it looks like the SerializeableObject has to be saved in DB first. After that, when it is &quot;attached&quot;, you can modify it (<code>s.data.foo = &#39;test 2&#39;</code>). When saving the main object (<code>s</code>), the data attribute will be updated and SerializeableObject (save in db) will remain the same. However, I still do not know why this happens."}, {"owner": {"reputation": 613, "user_id": 431691, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aecfabeba74672ceec012e4ad48baebb?s=128&d=identicon&r=PG", "display_name": "luckyjazzbo", "link": "https://stackoverflow.com/users/431691/luckyjazzbo"}, "reply_to_user": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552501516, "post_id": 55147242, "comment_id": 97038072, "body": "this does not help much.. the whole point of this field is storing data of not yet ready objects"}, {"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552512384, "post_id": 55147242, "comment_id": 97043223, "body": "I have tested your code with different Rails versions and it looks like a bug in Rails that was fixed in 5.0.0."}], "owner": {"reputation": 613, "user_id": 431691, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aecfabeba74672ceec012e4ad48baebb?s=128&d=identicon&r=PG", "display_name": "luckyjazzbo", "link": "https://stackoverflow.com/users/431691/luckyjazzbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552495814, "creation_date": 1552495814, "question_id": 55147242, "link": "https://stackoverflow.com/questions/55147242/serialization-of-activerecordbase-descendants-dont-work-in-rails-4", "title": "Serialization of ActiveRecord::Base descendants don&#39;t work in Rails 4", "body": "<p>I have a string field <code>data</code> in <code>SerializeTest</code> model and I want to store JSON presentation of another ActiveRecord model in it. Does not matter what I do it keeps storing <code>NULL</code> to database.</p>\n\n<p>The same code works when <code>SerializeableObject</code> is a plain object, not a descendant of <code>ActiveRecord::Base</code>.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class SerializeTest &lt; ActiveRecord::Base\n  serialize :data, SerializeableObject\nend\n\nclass SerializeableObject &lt; ActiveRecord::Base\n  class &lt;&lt; self\n    def load(data)\n      new JSON.load(data)\n    end\n\n    def dump(obj)\n      obj.to_json\n    end\n  end\nend\n</code></pre>\n\n<p>Here is how to reproduce it</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>s = SerializeTest.new\ns.data.foo = 'test'\ns.save\ns.reload\ns.data.foo # should be 'test' but equals nil\n</code></pre>\n\n<p>Migrations</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class CreateSerializeTests &lt; ActiveRecord::Migration\n  def change\n    create_table :serialize_tests do |t|\n      t.string :data\n    end\n  end\nend\n\nclass CreateSerializeableObjects &lt; ActiveRecord::Migration\n  def change\n    create_table :serializeable_objects do |t|\n      t.string :foo\n    end\n  end\nend\n</code></pre>\n\n<p>Any ideas how to fix this?</p>\n\n<p>P.S. It was working fine in Rails 3 but does not work in Rails 4.</p>\n"}, {"tags": ["arrays", "ruby", "algorithm", "match"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1552496596, "post_id": 55146731, "comment_id": 97035396, "body": "I don&#39;t have the time to code it now but would it be possible to get all matching elements from the array, find their index in the parent arrays, and find the longest common elements that have sequential indices?"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1552544201, "post_id": 55146731, "comment_id": 97051658, "body": "You can probably improve things by doing <code>array1 &amp; array2</code>, that gives <code>[&#39;hello&#39;, &#39;world&#39;, &#39;the&#39;]</code>. Then take the shortest of the <code>array1 and array2</code>, and check if that intersection is there in that order. If not - take each 2 elements sub arrays (probably you can ignore <code>[&#39;hello&#39;, &#39;the&#39;]</code>) and check again."}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1552580324, "last_edit_date": 1552580324, "creation_date": 1552495820, "answer_id": 55147243, "question_id": 55146731, "link": "https://stackoverflow.com/questions/55146731/efficient-way-in-ruby-to-determine-largest-matching-sequence-in-an-array-stri/55147243#55147243", "title": "Efficient way (in Ruby), to determine largest matching sequence in an array/string?", "body": "<p>Until I learned about the \"longest common substring/sequence problem\" (see @Dustin's answer) I did not think there is an approach that is better than the one you outlined in the question: start with the largest possible subarray (<code>array2</code> itself), then sequentially reduce the size of subarrays by one until a match is found (or it is determined that the two arrays contain no common element). Though I now see there is more efficient way, your idea is certainly not a bad one, particularly if the substrings are not too large, and it is easier to implement than the dynamic programming solution Dustin referenced. I've implemented your idea below. </p>\n\n<p>I have chosen to use a regular expression to identify matches, so I need to convert <code>array1</code> to a string.</p>\n\n<pre><code>str1 = array1.join(' ')\n  #=&gt; \"hello world i am in the world\" \n</code></pre>\n\n<p>The calculation is as follows.</p>\n\n<pre><code>[array1.size, array2.size].min.downto(1).each do |n|\n  a = array2.each_cons(n).find { |a| str1.match?(/\\b#{a.join(' ')}\\b/) }\n  break a unless a.nil? \nend\n  #=&gt; [\"hello\", \"world\"] \n</code></pre>\n\n<p><code>nil</code> is returned if <code>array1</code> and <code>array2</code> have no common element. If desired one could first test <code>(array1 &amp; array2).empty?</code>.</p>\n\n<p>Here is a possible improvement to what I have above. The idea is to attempt to reduce <code>m</code> in <code>m.downto(1)</code>.</p>\n\n<pre><code>h1 = array1.each_with_object(Hash.new(0)) { |word, h| h[word] += 1 }\n  #=&gt; {\"hello\"=&gt;1, \"world\"=&gt;2, \"i\"=&gt;1, \"am\"=&gt;1, \"in\"=&gt;1, \"the\"=&gt;1} \nh2 = array1.each_with_object(Hash.new(0)) { |word, h| h[word] += 1 }\n  #=&gt; {\"hello\"=&gt;1, \"world\"=&gt;2, \"i\"=&gt;1, \"am\"=&gt;1, \"in\"=&gt;1, \"the\"=&gt;1} \nm = [array1.size, array2.size, h2.sum { |k,v| [v, h2[k]].min }].min\n  #=&gt; [7, 6, 7].min\n  #=&gt; 6\n</code></pre>\n\n<p>This does not help here, but it might if the arrays <code>array1</code> and <code>array2</code> were different.</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1552497706, "post_id": 55147320, "comment_id": 97036092, "body": "<a href=\"https://en.wikibooks.org/wiki/Algorithm_Implementation/Strings/Longest_common_substring#Ruby\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Algorithm_Implementation/Strings/&hellip;</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552498311, "post_id": 55147320, "comment_id": 97036405, "body": "BTW, the algorithm works for sequences in general, not just strings in the narrower sense. And Ruby makes it even easier by providing identical methods to access string characters and array elements (<code>[]</code>, <code>slice</code> etc) \u2013 a Ruby implementation should work for both."}], "tags": [], "owner": {"reputation": 71, "user_id": 10392146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe6416d1c69ae27069a9f9ba541d6904?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin Harmon", "link": "https://stackoverflow.com/users/10392146/dustin-harmon"}, "is_accepted": false, "score": 2, "last_activity_date": 1552496037, "creation_date": 1552496037, "answer_id": 55147320, "question_id": 55146731, "link": "https://stackoverflow.com/questions/55146731/efficient-way-in-ruby-to-determine-largest-matching-sequence-in-an-array-stri/55147320#55147320", "title": "Efficient way (in Ruby), to determine largest matching sequence in an array/string?", "body": "<p>This seems to be a take on the \"longest common substring\" problem, but using words instead of characters in strings.  </p>\n\n<p>This wiki (<a href=\"https://en.wikipedia.org/wiki/Longest_common_substring_problem\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Longest_common_substring_problem</a>) outlines the dynamic programming approach to locate the largest common match in pseudo code and could be ported over to ruby passing the two arrays as the params.</p>\n\n<pre><code>function LCSubstr(S[1..r], T[1..n])\nL := array(1..r, 1..n)\nz := 0\nret := {}\nfor i := 1..r\n    for j := 1..n\n        if S[i] == T[j]\n            if i == 1 or j == 1\n                L[i,j] := 1\n            else\n                L[i,j] := L[i-1,j-1] + 1\n            if L[i,j] &gt; z\n                z := L[i,j]\n                ret := {S[i-z+1..i]}\n            else\n            if L[i,j] == z\n                ret := ret \u222a {S[i-z+1..i]}\n        else\n            L[i,j] := 0\nreturn ret\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1552497289, "post_id": 55147476, "comment_id": 97035836, "body": "This sounds promising, but maybe you can do better. Try finding all the words in <code>array1</code> that are not in <code>array2</code> and then vice-versa. Let&#39;s see some code."}, {"owner": {"reputation": 19518, "user_id": 968969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802303aaa5f03f4cec652171dffcbc7?s=128&d=identicon&r=PG", "display_name": "Tony Hopkinson", "link": "https://stackoverflow.com/users/968969/tony-hopkinson"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1552567630, "post_id": 55147476, "comment_id": 97064707, "body": "Why? Should be trivial."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1552581229, "post_id": 55147476, "comment_id": 97074731, "body": "I am reminded of two mathematicians who were discussing a theorem. &quot;A&quot; states in an off-hand way that the proof is trivial. &quot;B&quot; requests an explanation. &quot;A&quot; spends the next 20 twenty minutes explaining the proof. &quot;B&quot; then agrees the proof is trivial."}], "tags": [], "owner": {"reputation": 19518, "user_id": 968969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802303aaa5f03f4cec652171dffcbc7?s=128&d=identicon&r=PG", "display_name": "Tony Hopkinson", "link": "https://stackoverflow.com/users/968969/tony-hopkinson"}, "is_accepted": false, "score": 2, "last_activity_date": 1552496485, "creation_date": 1552496485, "answer_id": 55147476, "question_id": 55146731, "link": "https://stackoverflow.com/questions/55146731/efficient-way-in-ruby-to-determine-largest-matching-sequence-in-an-array-stri/55147476#55147476", "title": "Efficient way (in Ruby), to determine largest matching sequence in an array/string?", "body": "<p>Do the \"six word\" test straight off\nThen I'd the go through each word in the second array and test to see if it's in the 1st. \nIf it is then look for it and the one after, if both then look for the next. </p>\n\n<p>ie once you've discovered \"This\" is not present in the first array, you've also discarded the five other potential candidates starting with this.</p>\n"}, {"comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 1, "creation_date": 1552557267, "post_id": 55148036, "comment_id": 97058079, "body": "That&#39;s excellent, thanks.  I think it is very efficient, especially since in my case i&#39;m going to be comparing a long string (eg description) against a short string (search term).  I think that first step of only considering the shared words cuts the number of operations down massively."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1552561010, "post_id": 55148036, "comment_id": 97060449, "body": "Thanks @MaxWilliams - that was my thinking. Seems a nice way of running things. Appreciate the feedback, and let me know if you run into any hitches with it / come up with optimisations down the line."}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 2, "last_activity_date": 1552553892, "last_edit_date": 1552553892, "creation_date": 1552498428, "answer_id": 55148036, "question_id": 55146731, "link": "https://stackoverflow.com/questions/55146731/efficient-way-in-ruby-to-determine-largest-matching-sequence-in-an-array-stri/55148036#55148036", "title": "Efficient way (in Ruby), to determine largest matching sequence in an array/string?", "body": "<p>Here's a fast working solution, cutting down the comparison to only those element in common across arrays:</p>\n\n<pre><code>array1 = [\"hello\", \"world\", \"i\", \"am\", \"in\", \"the\", \"world\"]\narray2 = [\"This\", \"is\", \"the\", \"hello\", \"world\", \"message\"]\n\ncommon_words = array1 &amp; array2\n\nstringified_array1 = array1.join(' ')\nstringified_array2 = array2.join(' ')\n\n(common_words.length - 1).downto(0).map do |n|\n  stringified_combo = array1[0..n].join(' ')\n\n  if stringified_array1.include?(stringified_combo) &amp;&amp; stringified_array2.include?(stringified_combo)\n    stringified_combo.split($,)\n  end \nend.compact.max\n</code></pre>\n\n<p>This you get the words in common between the two arrays, and tests these from largest to smallest. You check they're in order in the first array, then if they exist in the second.</p>\n\n<p>I believe this holds up and is pretty efficient, though happy to receive any comments and feedback,</p>\n"}, {"comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1552556756, "post_id": 55153341, "comment_id": 97057744, "body": "Thanks a lot - in my case, one of the strings will be short and the other might be quite long.  (it&#39;s as part of a text search, so you have the long indexed text, and a short search term).  I wonder if that makes any difference to the implementation?"}, {"owner": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1552590560, "post_id": 55153341, "comment_id": 97079787, "body": "If I understand you correctly then lcs() becomes find? Definitely not the original question so maybe I don&#39;t understand."}], "tags": [], "owner": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "is_accepted": false, "score": 1, "last_activity_date": 1552524844, "creation_date": 1552524844, "answer_id": 55153341, "question_id": 55146731, "link": "https://stackoverflow.com/questions/55146731/efficient-way-in-ruby-to-determine-largest-matching-sequence-in-an-array-stri/55153341#55153341", "title": "Efficient way (in Ruby), to determine largest matching sequence in an array/string?", "body": "<p>This was part of an implementation in Ruby of similar_text from PHP. Using strings:</p>\n\n<pre><code>def substrings(str)\n  (0...str.size).flat_map do |i|\n    (i...str.size).map { |j| str[i..j] }\n  end\nend\n\ndef lcs(str1, str2)\n  (substrings(str1) &amp; substrings(str2)).max_by(&amp;:size)\nend\n\nputs \"'#{lcs(\"hello world i am in the world\", \"This is the hello world message\")}'\"\n\n=&gt; 'hello world '\n</code></pre>\n\n<p>Brute force for the substrings might be a candidate for a Rust FFI call? We weren't doing very big compares so it worked for us.</p>\n"}], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 55148036, "answer_count": 5, "score": 5, "last_activity_date": 1552580324, "creation_date": 1552494271, "question_id": 55146731, "link": "https://stackoverflow.com/questions/55146731/efficient-way-in-ruby-to-determine-largest-matching-sequence-in-an-array-stri", "title": "Efficient way (in Ruby), to determine largest matching sequence in an array/string?", "body": "<p>Lets's say I have two arrays of words:</p>\n\n<pre><code>array1 = [\"hello\", \"world\", \"i\", \"am\", \"in\", \"the\", \"world\"]\narray2 = [\"This\", \"is\", \"the\", \"hello\", \"world\", \"message\"]\n</code></pre>\n\n<p>which, could just as easily be represented by two strings:</p>\n\n<pre><code>string1 = \"hello world i am in the world\"\nstring2 = \"This is the hello world message\"\n</code></pre>\n\n<p>Lets assume I'm going with arrays for now.  </p>\n\n<p>I want to find the largest sub-array of array2 which appears <strong>in the same order</strong> in array1.  </p>\n\n<p>So, if you were going to do it in the slowest way imaginable, say, you would say:</p>\n\n<ul>\n<li>get all the 6-word subarrays (of which there is one) from array2.  \n\n<ul>\n<li>does it appear in array1, in that order? NO</li>\n</ul></li>\n<li>get all the 5-word subarrays (of which there are two) from array2.  \n\n<ul>\n<li>do either of them appear in array1, in that order? NO</li>\n</ul></li>\n<li>get all the 4-word subarrays from array2.  \n\n<ul>\n<li>do any of them appear in array1, in that order? NO</li>\n</ul></li>\n<li>etc, until we get to</li>\n<li>get all the 2-word subarrays from array2.  \n\n<ul>\n<li>do any of them appear in array1, in that order? YES: [\"hello\", \"world\"] does.  STOP.</li>\n</ul></li>\n</ul>\n\n<p>But, this feels like it would be quite inefficient.  Can anyone see a better method?  I'm using Ruby, but i'd be interested in a general algorithm as well as how to do it in that specific language.  </p>\n\n<p>Note that this isn't just array intersection because that (at least in ruby) doesn't care about the <strong>order of elements</strong>, which I do care about.  </p>\n\n<p>thanks!</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe"], "answers": [{"comments": [{"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "edited": false, "score": 0, "creation_date": 1552554195, "post_id": 55158266, "comment_id": 97056143, "body": "I need to know if the <code>log-agent</code> version installed is <code>212121</code>"}, {"owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "reply_to_user": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "edited": false, "score": 0, "creation_date": 1552560002, "post_id": 55158266, "comment_id": 97059821, "body": "@tuk: and if it is not <code>212121</code> you probably want to do (or not do) something... so use a guard...."}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "edited": false, "score": 0, "creation_date": 1552567627, "post_id": 55158266, "comment_id": 97064704, "body": "I want to do <code>include_recipe</code> if the version is not 212121 . I think <code>guard</code> does not work with <code>include_receipe</code>."}], "tags": [], "owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "is_accepted": false, "score": 0, "last_activity_date": 1552553307, "creation_date": 1552553307, "answer_id": 55158266, "question_id": 55146670, "link": "https://stackoverflow.com/questions/55146670/how-to-execute-dpkg-query-in-chef-14/55158266#55158266", "title": "How to execute dpkg-query in chef 14?", "body": "<p>you can execute system command in many ways... from your question it is not clear whether you want to grub the output of the command or just use it a <a href=\"https://docs.chef.io/resource_common.html#guards\" rel=\"nofollow noreferrer\">guard</a>.</p>\n\n<p>if you only want to execute it, you can use <a href=\"https://docs.chef.io/resource_execute.html\" rel=\"nofollow noreferrer\"><code>execute</code></a>, <a href=\"https://docs.chef.io/resource_bash.html\" rel=\"nofollow noreferrer\"><code>bash</code></a> and even <a href=\"https://docs.chef.io/resource_ruby_block.html\" rel=\"nofollow noreferrer\"><code>ruby_block</code></a> to achieve it.</p>\n"}], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552811308, "creation_date": 1552494102, "last_edit_date": 1552811308, "question_id": 55146670, "link": "https://stackoverflow.com/questions/55146670/how-to-execute-dpkg-query-in-chef-14", "title": "How to execute dpkg-query in chef 14?", "body": "<p>Can someone let me know how can I execute the below command using chef-14?</p>\n\n<p><code>dpkg-query --status log-agent | grep -q  '^Version: 212121</code></p>\n\n<p>I am able to find a <a href=\"https://docs.chef.io/resource_dpkg_package.html\" rel=\"nofollow noreferrer\">dpkg_package</a> resource. But not anything for <code>dpkg-query</code>. I intend to use the above command in <code>include_recipe</code> so using <code>guards</code> is not an option for me.</p>\n\n<p>If possible I would like to avoid <code>shell_out</code>. </p>\n"}, {"tags": ["regex", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1315, "user_id": 7412183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a73ddfb4eba2ce63e534ab68317210dc?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7412183/dennis"}, "edited": false, "score": 0, "creation_date": 1552493832, "post_id": 55146526, "comment_id": 97033759, "body": "Awesome! But let me say something. When I check domain name, I also need email (full e-mail) to return. Can you show me another example besides this to fetch email inside <code>&lt;&gt;</code>?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 1315, "user_id": 7412183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a73ddfb4eba2ce63e534ab68317210dc?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7412183/dennis"}, "edited": false, "score": 1, "creation_date": 1552493983, "post_id": 55146526, "comment_id": 97033858, "body": "Updated the answer."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1552493953, "last_edit_date": 1552493953, "creation_date": 1552493660, "answer_id": 55146526, "question_id": 55146154, "link": "https://stackoverflow.com/questions/55146154/validating-email-recipients-domain-name-with-regex-in-ruby/55146526#55146526", "title": "Validating email recipient&#39;s domain name with regex in Ruby", "body": "<p>Use <a href=\"https://ruby-doc.org/core/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\"><code>String#[]</code></a> with the following regular expression:</p>\n\n<pre><code>'Pratha@mydomain.com &lt;another@gmail.com&gt;'[/(?&lt;=\\@)[^@]*?(?=&gt;\\z)/]\n#\u21d2 \"gmail.com\"\n</code></pre>\n\n<p>The regular expression is:</p>\n\n<pre><code>/(?&lt;=\\@)[^@]*?(?=&gt;\\z)/\n</code></pre>\n\n<p>Anything in between of the <code>@</code> and closing last <code>&gt;</code>, which does not contain <code>@</code>.</p>\n\n<hr>\n\n<p>You can simply compare it against the list of valid domains, or whatever. It grabs the domain and returns it as a string.</p>\n\n<hr>\n\n<p>Another way would be to grab an email address and check if it ends with what you need:</p>\n\n<pre><code>from[/(?&lt;=&lt;)[^&lt;&gt;]*?(?=&gt;\\z)/]\n#\u21d2 \"another@gmail.com\"\nfrom[/(?&lt;=&lt;)[^&lt;&gt;]*?(?=&gt;\\z)/].end_with?('@gmail.com')\n#\u21d2 true\n</code></pre>\n"}], "owner": {"reputation": 1315, "user_id": 7412183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a73ddfb4eba2ce63e534ab68317210dc?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7412183/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 55146526, "answer_count": 1, "score": 0, "last_activity_date": 1552493953, "creation_date": 1552492542, "last_edit_date": 1552493453, "question_id": 55146154, "link": "https://stackoverflow.com/questions/55146154/validating-email-recipients-domain-name-with-regex-in-ruby", "title": "Validating email recipient&#39;s domain name with regex in Ruby", "body": "<p>I would like to check if given recipient has a correct domain in it with regex but whatever I do I always get <code>false</code></p>\n\n<p>Code:</p>\n\n<pre><code>from = \"Pratha Burna &lt;prathab@mydomain.com&gt;\" # or just \"&lt;prathab@mydomain.com&gt;\"\nfrom.gsub!(/^\\s*&lt;\\s*(.*)\\s*&gt;\\s*$/, '\\1')\nfrom.downcase!\nputs \"checking for #{from}\" # this should give only email. But whole from is here.\n\nif from !~ /@mydomain.com$/\n    puts \"false\"\nelse\n    puts \"true\"\nend\n\nif from !~ /@another.com$/\n    puts \"false\"\nelse\n    puts \"true\"\nend\n</code></pre>\n\n<p>Sample app: <a href=\"https://ideone.com/arAkKm\" rel=\"nofollow noreferrer\">https://ideone.com/arAkKm</a></p>\n\n<p>What I need to is check if <code>@mydomain.com</code> is in <code>from</code> variable as an email. Because, user can put <code>@mydomain.com</code> to name section and trick the server. What I need to is check inside <code>&lt;&gt;</code></p>\n\n<p>For example this should <strong>fail</strong>:</p>\n\n<pre><code>Pratha@mydomain.com &lt;another@gmail.com&gt;\n</code></pre>\n\n<p>Because <code>@mydomain.com</code> is not in <code>&lt;&gt;</code></p>\n\n<p>How can I properly clean from and check against domain?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1552492742, "post_id": 55146127, "comment_id": 97033001, "body": "&quot;Mysql2::Error::ConnectionError: Access denied for user &#39;rails_user&#39;@&#39;localhost&#39; (using password: NO)&quot; your database configuration is trying to use a user called &quot;rails_user&quot; to access the database but that user either doe not exist or cannot login with the credentials provided"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1552494120, "post_id": 55146127, "comment_id": 97033926, "body": "Either <a href=\"https://dev.mysql.com/doc/refman/8.0/en/adding-users.html\" rel=\"nofollow noreferrer\">add a MySQL user</a> <code>rails_user</code> or set a different one in your <code>database.yml</code>."}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1552573817, "post_id": 55146127, "comment_id": 97069353, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6886583/ruby-on-rails-mysql-error-access-denied-for-user-rootlocalhost\">Ruby on Rails MYSQL error Access denied for user &#39;root@localhost&#39;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 8939480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7RZX.png?s=128&g=1", "display_name": "Monwabisi Labeanzo", "link": "https://stackoverflow.com/users/8939480/monwabisi-labeanzo"}, "is_accepted": false, "score": 0, "last_activity_date": 1554365783, "creation_date": 1554365783, "answer_id": 55511013, "question_id": 55146127, "link": "https://stackoverflow.com/questions/55146127/mysql2errorconnectionerror-access-denied-for-user/55511013#55511013", "title": "Mysql2::Error::ConnectionError: Access denied for user", "body": "<p>Login to your mysql  and add user (rails_user). Then grant the user privileges to the database you have created for your application beacuse it may happen that you already have the user(rails_user) but the use does not have privileges to the database of your application. then go to database.yml and put the require credentials for user which is (rails_user). </p>\n"}], "owner": {"reputation": 1, "user_id": 11196463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d14c3822634377d01ba6844b39f2e89b?s=128&d=identicon&r=PG&f=1", "display_name": "R.Silva", "link": "https://stackoverflow.com/users/11196463/r-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 699, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1554365783, "creation_date": 1552492459, "last_edit_date": 1552573780, "question_id": 55146127, "link": "https://stackoverflow.com/questions/55146127/mysql2errorconnectionerror-access-denied-for-user", "title": "Mysql2::Error::ConnectionError: Access denied for user", "body": "<p>I get the error when trying to run <code>rails db:schema:dump</code></p>\n\n<pre><code>Ric$ rails db:schema:dump\n  rails aborted!\n  Mysql2::Error::ConnectionError: Access denied for user 'rails_user'@'localhost' (using password: NO)\n  /Users/ricardosilva/.rvm/gems/ruby-2.6.0/gems/mysql2-0.5.2/lib/mysql2/client.rb:90:in `connect'\n  /Users/ricardosilva/.rvm/gems/ruby-2.6.0/gems/mysql2-0.5.2/lib/mysql2/client.rb:90:in `initialize'\n  /Users/ricardosilva/.rvm/gems/ruby-2.6.0/gems/activerecord-5.2.2/lib/active_record\n</code></pre>\n\n<p>I have tried as well <code>rails server</code> and it doesn't work too. Also tried to reinstall all packs - nothing.</p>\n\n<p>I'm using OS X 10.14 on x86_6,4 brew 2.0.4, rails 5.2.2, ruby 2.6.0, mysql  8.0.15</p>\n\n<p>Looking for an answer.</p>\n"}, {"tags": ["ruby", "windows", "selenium-webdriver", "winappdriver"], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 7319303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb9c594cf93f33679f672f71eeae102?s=128&d=identicon&r=PG&f=1", "display_name": "nova_rubo", "link": "https://stackoverflow.com/users/7319303/nova-rubo"}, "is_accepted": true, "score": 0, "last_activity_date": 1554994480, "creation_date": 1554994480, "answer_id": 55635506, "question_id": 55145658, "link": "https://stackoverflow.com/questions/55145658/right-click-on-application-in-system-tray-using-winapp-driver/55635506#55635506", "title": "right click on application in system tray using winapp driver", "body": "<p>just an issue with a element\ndriver.action.context_click(element).perform is the correct syntax as long as the element is identified correctly</p>\n"}], "owner": {"reputation": 47, "user_id": 7319303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb9c594cf93f33679f672f71eeae102?s=128&d=identicon&r=PG&f=1", "display_name": "nova_rubo", "link": "https://stackoverflow.com/users/7319303/nova-rubo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 55635506, "answer_count": 1, "score": 0, "last_activity_date": 1554994480, "creation_date": 1552491140, "question_id": 55145658, "link": "https://stackoverflow.com/questions/55145658/right-click-on-application-in-system-tray-using-winapp-driver", "title": "right click on application in system tray using winapp driver", "body": "<p>I am trying to automate a right click on antivirus icon in the system tray but been out of luck with it. Is there a different way to implement it.</p>\n\n<hr>\n\n<p>the code that i am trying is given below</p>\n\n<hr>\n\n<pre><code>require 'selenium-webdriver'\n\n\ndef caps \n    {\n        platformName: \"WINDOWS\", platform: \"WINDOWS\", deviceName: \"mydevice\", app: \"Root\"\n    }\nend\n\n\n\ndriver = Selenium::WebDriver.for(:remote, :url =&gt; \"http://127.0.0.1:4723/\", :desired_capabilities =&gt; caps )\n\ndriver.find_element(:name, 'Notification Chevron').click\nsleep(5)\nelement = driver.find_element(:name, 'Avast')[0]\ndriver.action.context_click(element).perform()\n</code></pre>\n\n<p>I see below error when i try to run this method</p>\n\n<blockquote>\n  <p>NoMethodError: undefined method <code>[]' for nil:NilClass\n   C:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/selenium-webdriver-3.5.2/lib/selenium/webdriver/common/action_builder.rb:357:in</code>perform'</p>\n</blockquote>\n"}, {"tags": ["ruby", "dry-rb"], "answers": [{"tags": [], "owner": {"reputation": 134, "user_id": 2690094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FUkZx.jpg?s=128&g=1", "display_name": "AMHOL", "link": "https://stackoverflow.com/users/2690094/amhol"}, "is_accepted": true, "score": 0, "last_activity_date": 1558076743, "creation_date": 1558076743, "answer_id": 56181261, "question_id": 55145576, "link": "https://stackoverflow.com/questions/55145576/drywebcontainer-yielding-different-objects-with-multiple-calls-to-resolve/56181261#56181261", "title": "Dry::Web::Container yielding different objects with multiple calls to resolve", "body": "<p><strong>TL;DR</strong> - <a href=\"https://dry-rb.org/gems/dry-system/test-mode/\" rel=\"nofollow noreferrer\">https://dry-rb.org/gems/dry-system/test-mode/</a></p>\n\n<hr>\n\n<p>Hi, to get the behaviour you're asking for, you'd need to use the <code>memoize</code> option when registering items with your container.</p>\n\n<p>Note that <code>Dry::Web::Container</code> inherits <code>Dry::System::Container</code>, which includes <code>Dry::Container::Mixin</code>, so while the following example is using <code>dry-container</code>, it's still applicable:</p>\n\n<pre><code>require 'bundler/inline'\n\ngemfile(true) do\n  source 'https://rubygems.org'\n\n  gem 'dry-container'\nend\n\nclass MyItem; end\n\nclass MyContainer\n  extend Dry::Container::Mixin\n\n  register(:item) { MyItem.new }\n  register(:memoized_item, memoize: true) { MyItem.new }\nend\n\nMyContainer[:item].object_id\n# =&gt; 47171345299860\nMyContainer[:item].object_id\n# =&gt; 47171345290240\n\nMyContainer[:memoized_item].object_id\n# =&gt; 47171345277260\nMyContainer[:memoized_item].object_id\n# =&gt; 47171345277260\n</code></pre>\n\n<p>However, to do this from dry-web, you'd need to either <a href=\"https://github.com/dry-rb/dry-system/pull/99\" rel=\"nofollow noreferrer\">memoize all objects auto-registered under the same path</a>, or add the <code># auto_register: false</code> magic comment to the top of the files that define the dependencies and <a href=\"https://dry-rb.org/gems/dry-system/booting/\" rel=\"nofollow noreferrer\">boot them manually</a>.</p>\n\n<p>Memoizing could cause concurrency issues depending on which app server you're using and whether or not your objects are mutated during the request lifecycle, hence the design of dry-container to not memoize by default.</p>\n\n<p>Another, arguably better option, is to use <a href=\"https://dry-rb.org/gems/dry-system/test-mode/\" rel=\"nofollow noreferrer\">stubs</a>:</p>\n\n<pre><code># Extending above code\nrequire 'dry/container/stub'\nMyContainer.enable_stubs!\nMyContainer.stub(:item, 'Some string')\n\nMyContainer[:item]\n# =&gt; \"Some string\"\n</code></pre>\n\n<p>Side note:</p>\n\n<p><code>dry-system</code> provides an <a href=\"https://dry-rb.org/gems/dry-system/auto-import/\" rel=\"nofollow noreferrer\">injector</a> so that you don't need to call the container manually in your objects, so your process controller would become something like:</p>\n\n<pre><code>class ProcessController\n  include My::Importer['operation1', 'operation2']\n\n  def call(input)\n    [operation1, operation2].each do |operation|\n      operation.(input)\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4584808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2fab1bbc473298ae2d8e2669d156959?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/4584808/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 56181261, "answer_count": 1, "score": 1, "last_activity_date": 1558076743, "creation_date": 1552490924, "question_id": 55145576, "link": "https://stackoverflow.com/questions/55145576/drywebcontainer-yielding-different-objects-with-multiple-calls-to-resolve", "title": "Dry::Web::Container yielding different objects with multiple calls to resolve", "body": "<p>I'm trying write a test to assert that all defined operations are called on a successful run. I have the operations for a given process defined in a list and resolve them from a container, like so:</p>\n\n<pre><code>class ProcessController\n  def call(input)\n    operations.each { |o| container[o].(input) }\n  end\n\n  def operations\n    ['operation1', 'operation2']\n  end\n\n  def container\n    My::Container # This is a Dry::Web::Container\n  end\nend\n</code></pre>\n\n<p>Then I test is as follows:</p>\n\n<pre><code>RSpec.describe ProcessController do\n  let(:container) { My::Container } \n\n  it 'executes all operations' do\n    subject.operations.each do |op|\n      expect(container[op]).to receive(:call).and_call_original\n    end\n\n    expect(subject.(input)).to be_success\n  end\nend\n</code></pre>\n\n<p>This fails because calling <code>container[operation_name]</code> from inside <code>ProcessController</code> and from inside the test yield different instances of the operations. I can verify it by comparing the object ids. Other than that, I know the code is working correctly and all operations are being called.</p>\n\n<p>The container is configured to auto register these operations and has been finalized before the test begins to run.</p>\n\n<p>How do I make resolving the same key return the same item?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10749227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cfd24ed84691ff5357a5dc5a38626ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevCF", "link": "https://stackoverflow.com/users/10749227/devcf"}, "edited": false, "score": 0, "creation_date": 1552491613, "post_id": 55145669, "comment_id": 97032166, "body": "Thanks for replying so quickly. The model I am using to create the check-boxes is User, with role being a column on the user model. With the change above, I get the following error:  undefined method `name&#39; for [&quot;admin&quot;, 0]:Array"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 57, "user_id": 10749227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cfd24ed84691ff5357a5dc5a38626ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevCF", "link": "https://stackoverflow.com/users/10749227/devcf"}, "edited": false, "score": 0, "creation_date": 1552491751, "post_id": 55145669, "comment_id": 97032258, "body": "Welcome @DevCF :) Could you do me a favour and edit your question to include the output of <code>User.roles</code> please? Drop me a comment when done and I&#39;ll update my answer."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 57, "user_id": 10749227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cfd24ed84691ff5357a5dc5a38626ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevCF", "link": "https://stackoverflow.com/users/10749227/devcf"}, "edited": false, "score": 0, "creation_date": 1552491857, "post_id": 55145669, "comment_id": 97032336, "body": "Saying that, I&#39;ve taken a punt based on what you&#39;ve shown in your comment. The above may now work, though I can clarify when you&#39;ve update the question."}, {"owner": {"reputation": 57, "user_id": 10749227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cfd24ed84691ff5357a5dc5a38626ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevCF", "link": "https://stackoverflow.com/users/10749227/devcf"}, "edited": false, "score": 0, "creation_date": 1552494333, "post_id": 55145669, "comment_id": 97034057, "body": "Thanks, I&#39;ve included the output of User.roles. I tried updating my code as per your suggestion but still no luck, the labels are not showing (but nothing is breaking which is a positive at least?)."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 57, "user_id": 10749227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cfd24ed84691ff5357a5dc5a38626ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevCF", "link": "https://stackoverflow.com/users/10749227/devcf"}, "edited": false, "score": 0, "creation_date": 1552571946, "post_id": 55145669, "comment_id": 97067928, "body": "Thanks for the update @DevCF - try the above, that should work for you :)"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 0, "last_activity_date": 1552571848, "last_edit_date": 1552571848, "creation_date": 1552491171, "answer_id": 55145669, "question_id": 55145452, "link": "https://stackoverflow.com/questions/55145452/labels-showing-for-form-multiple-check-box/55145669#55145669", "title": "Labels showing for form multiple check box", "body": "<p>Looks to me as if the issue is corrected by the below change:</p>\n\n<p><strong>Changes based on your recent update: <code>User.roles</code> is a hash which we destructure and pass in as follows:</strong></p>\n\n<pre><code>    &lt;% roles = User.roles %&gt;\n    &lt;% roles.each do |name, value| %&gt;\n      #                v here v\n      &lt;%= f.label :role, name %&gt;\n      &lt;%= f.check_box :role, { multiple: true }, value, nil %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>You're likely passing an <code>Enumerator</code>  to the label, rather than the role itself. Try calling <code>User.roles.each</code> in the console without a block, you'll get something like: <code>#&lt;Enumerator: ...&gt;</code>.</p>\n\n<p>As a quick side note, it's preferable to carry out assignment outside of the view: you'd be better placed assigning <code>@roles = User.roles</code> in your controller, and using the instance variable in your view.</p>\n\n<p>Hope that helps - let me know how you get on.</p>\n"}, {"tags": [], "owner": {"reputation": 423, "user_id": 2029932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c5fbea96c3b8c76a0ae4b266f058c9?s=128&d=identicon&r=PG", "display_name": "Leonardo Prado", "link": "https://stackoverflow.com/users/2029932/leonardo-prado"}, "is_accepted": false, "score": 0, "last_activity_date": 1552495063, "creation_date": 1552495063, "answer_id": 55146980, "question_id": 55145452, "link": "https://stackoverflow.com/questions/55145452/labels-showing-for-form-multiple-check-box/55146980#55146980", "title": "Labels showing for form multiple check box", "body": "<p>My code is like SRack answers, but I've adjusted it for the hash output and edited the role name, so we can click on the text and it will activate the option :)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;% User.roles.each do |name, value| %&gt;\n  &lt;%= f.label \"role_#{value}\" do %&gt;\n    &lt;%= f.check_box :role, { multiple: true }, value, nil %&gt;\n    &lt;%= name %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10749227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cfd24ed84691ff5357a5dc5a38626ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevCF", "link": "https://stackoverflow.com/users/10749227/devcf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55145669, "answer_count": 2, "score": 0, "last_activity_date": 1552571848, "creation_date": 1552490552, "last_edit_date": 1552494199, "question_id": 55145452, "link": "https://stackoverflow.com/questions/55145452/labels-showing-for-form-multiple-check-box", "title": "Labels showing for form multiple check box", "body": "<p>I'm creating a form with multiple check-boxes, the options being a list of user roles, with my view as follows:</p>\n\n<pre><code>        &lt;% roles = User.roles %&gt;\n        &lt;% roles.each do |role| %&gt;\n          &lt;%= f.label roles.each do %&gt;\n            &lt;%= f.check_box :role, { multiple: true }, role, nil %&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>The issue I am having is that the check boxes are being created, and the correct User role correspond to each checkbox (as confirmed by using Developer Tools), but I cannot get labels to show up next to the check boxes. </p>\n\n<p>The output of User.roles is as follows:</p>\n\n<pre><code>{\"admin\"=&gt;0, \"developer_admin\"=&gt;1, \"division_admin\"=&gt;2, \"development_admin\"=&gt;3, \"site_admin\"=&gt;4}\n</code></pre>\n\n<p>What obvious thing am I overlooking here?</p>\n"}, {"tags": ["ruby", "exception", "ruby-on-rails-2", "unhandled-exception", "rescue"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1552490298, "post_id": 55145234, "comment_id": 97031259, "body": "Sorry, but what is <code>rescue_action_in_public</code>?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552493999, "post_id": 55145234, "comment_id": 97033869, "body": "@Stefan aparently it is a rails 2 method <a href=\"https://apidock.com/rails/ActionController/Rescue/rescue_action_in_public\" rel=\"nofollow noreferrer\"><code>ActionController::Rescue#rescue_action_in_public</code></a>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552494218, "post_id": 55145234, "comment_id": 97033983, "body": "The code above raises during class loading stage btw."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552494668, "post_id": 55145234, "comment_id": 97034256, "body": "You could log the exception&#39;s <a href=\"http://ruby-doc.org/core-1.8.7/Exception.html#method-i-backtrace\" rel=\"nofollow noreferrer\"><code>backtrace</code></a> and traverse the listed file locations to find the root cause."}, {"owner": {"reputation": 67, "user_id": 4532001, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tE618zDgASs/AAAAAAAAAAI/AAAAAAAAAHA/IDeU1Cmk2lI/photo.jpg?sz=128", "display_name": "Newton Sarker", "link": "https://stackoverflow.com/users/4532001/newton-sarker"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552546705, "post_id": 55145234, "comment_id": 97052539, "body": "Yes @Stefan you are right about logging the backtrace, which is done already using airbrake/errbit. As its a huge traffic application, now we want these logs in <a href=\"https://www.elastic.co/elk-stack\" rel=\"nofollow noreferrer\">ELK</a> stack to find out the pattern and prioritize."}], "answers": [{"tags": [], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "is_accepted": false, "score": 1, "last_activity_date": 1552491366, "creation_date": 1552491366, "answer_id": 55145744, "question_id": 55145234, "link": "https://stackoverflow.com/questions/55145234/how-to-get-ruby-class-name-when-an-exception-is-thrown-in-ruby/55145744#55145744", "title": "How to get ruby class name when an exception is thrown in Ruby", "body": "<p>Something to think about is using a customized error type - </p>\n\n<pre><code>class ErrorsWithCallerClass &lt; StandardError # or something more appropriate\n    attr_reader :klass\n    def initialize(msg, klass) \n       @klass = klass \n       super(msg)\n    end\nend\n</code></pre>\n\n<p>then use that with </p>\n\n<pre><code>raise ErrorsWithCallerClass.new(\"bad stuff\", Trap) \n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4532001, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tE618zDgASs/AAAAAAAAAAI/AAAAAAAAAHA/IDeU1Cmk2lI/photo.jpg?sz=128", "display_name": "Newton Sarker", "link": "https://stackoverflow.com/users/4532001/newton-sarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1552547368, "creation_date": 1552489908, "last_edit_date": 1552547368, "question_id": 55145234, "link": "https://stackoverflow.com/questions/55145234/how-to-get-ruby-class-name-when-an-exception-is-thrown-in-ruby", "title": "How to get ruby class name when an exception is thrown in Ruby", "body": "<p>Cracking down an age-old ruby application written in version 1.8.7\nto log all the unhandled exceptions overriding <strong>rescue_action_in_public</strong> by <strong>rescue_action_in_public_with_custom</strong>. I can see the error stack. However, if I can extract the error originator class name, it would be a great help. For example - </p>\n\n<pre><code>module Module1\n   module Module2\n      class Trap\n         raise 'exception raised and not handled'\n         def do_something\n            raise 'something happened in runtime and not handled'\n         end\n      end\n   end\nend\n</code></pre>\n\n<p>I want to log the class name \"Trap\" from within <strong>rescue_action_in_public_with_custom</strong>. Any help/ideas are appreciated.</p>\n"}, {"tags": ["ruby", "sinatra", "alexa"], "owner": {"reputation": 31, "user_id": 1879832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6acdab540f4564160409129f531ae10f?s=128&d=identicon&r=PG", "display_name": "fitchMitch", "link": "https://stackoverflow.com/users/1879832/fitchmitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552507141, "creation_date": 1552489794, "last_edit_date": 1592644375, "question_id": 55145196, "link": "https://stackoverflow.com/questions/55145196/alexa-fires-an-audioplayer-playbackstopped-intent-4-seconds-after-audioplayer-pl", "title": "Alexa fires an AudioPlayer.PlaybackStopped intent 4 seconds after AudioPlayer.PlaybackStarted intent", "body": "<h3>Context:</h3>\n<p>Working with ruby sinatra, ralyxa gem and ngrok to set my local as an endpoint, I cannot find out why Alexa fires this event 'on its own'</p>\n<p>The intent is written as follows :</p>\n<pre><code>current_https_host = 'https://0eaf626d.ngrok.io'\ndefault_token = '1234AAAABBBBCCCCCDDDDEEEEEFFFF'\nshort_mp3 = 'count_1_to_15.mp3'\nstart_offset = 0\n\nintent 'son_du_jour' do\n  token = request.user_access_token || default_token\n  audio_player.play(\n    &quot;#{current_https_host}/#{short_mp3}&quot;,\n    token,\n    offset_in_milliseconds: start_offset\n  ).to_json\nend\n</code></pre>\n<p>sinatra server's logs show some interruption with a bi-tone signal from alexa, line 11 of the following</p>\n<h2>Logs</h2>\n<pre><code>54.240.197.2 - - [13/Mar/2019:15:47:07 +0100] &quot;POST / HTTP/1.1&quot; 200 232 0.4098\n54.240.197.106 - - [13/Mar/2019:15:47:14 +0100] &quot;POST / HTTP/1.1&quot; 200 297 0.0027\n78.193.235.11 - - [13/Mar/2019:15:47:14 +0100] &quot;HEAD /1_a_15.mp3 HTTP/1.1&quot; 200 326765 0.0013\n78.193.235.11 - - [13/Mar/2019:15:47:15 +0100] &quot;GET /1_a_15.mp3 HTTP/1.1&quot; 200 326765 0.0035\nD, [2019-03-13T15:47:16.574979 #19349] DEBUG -- : Playback starts here ...\nD, [2019-03-13T15:47:16.575122 #19349] DEBUG -- : offsetInMilliseconds : 0\n54.240.197.35 - - [13/Mar/2019:15:47:16 +0100] &quot;POST / HTTP/1.1&quot; 200 54 0.0039\nD, [2019-03-13T15:47:16.994625 #19349] DEBUG -- : Time to add up another playback from the list\n54.240.197.106 - - [13/Mar/2019:15:47:16 +0100] &quot;POST / HTTP/1.1&quot; 200 54 0.0034\n54.240.197.35 - - [13/Mar/2019:15:47:20 +0100] &quot;POST / HTTP/1.1&quot; 200 107 0.0027\n==&gt; D, [2019-03-13T15:47:20.937185 #19349] DEBUG -- : PlaybackStopped: interruption with a bi-tone\nD, [2019-03-13T15:47:20.937364 #19349] DEBUG -- : offsetInMilliseconds : 4096\n54.240.197.73 - - [13/Mar/2019:15:47:20 +0100] &quot;POST / HTTP/1.1&quot; 200 54 0.0035\nD, [2019-03-13T15:47:22.059574 #19349] DEBUG -- : Playback starts here ...\nD, [2019-03-13T15:47:22.059684 #19349] DEBUG -- : offsetInMilliseconds : 4096\n54.240.197.75 - - [13/Mar/2019:15:47:22 +0100] &quot;POST / HTTP/1.1&quot; 200 54 0.0038\nD, [2019-03-13T15:47:22.698245 #19349] DEBUG -- : Time to add up another playback from the list\n54.240.197.105 - - [13/Mar/2019:15:47:22 +0100] &quot;POST / HTTP/1.1&quot; 200 54 0.0031\nD, [2019-03-13T15:47:29.513338 #19349] DEBUG -- : PlaybackFinished intent fired\n54.240.197.75 - - [13/Mar/2019:15:47:29 +0100] &quot;POST / HTTP/1.1&quot; 200 97 0.0048\n\n</code></pre>\n<p>While amazon intents look this way :</p>\n<pre><code>require 'byebug'\nrequire 'logger'\n\nlogger = Logger.new STDOUT\nempty_response = {\n  version: '1.0',\n  response: {\n    shouldEndSession: true\n  }\n}.to_json\n\nintent 'LaunchRequest' do\n  message = &quot;&lt;audio src='soundbank://soundlibrary/home/amzn_sfx_door_open_01'/&gt;Bonjour! Que voulez-vous \u00e9couter ?&quot;\n  intonation_message = &quot;&lt;speak&gt;#{message}&lt;/speak&gt;&quot;\n  ask(intonation_message, ssml: true).to_json\nend\n\nintent 'AMAZON.StopIntent' do\n  tell('Bye Bye !')\nend\n\nintent 'AudioPlayer.PlaybackStarted' do\n  logger.debug('Playback starts here ...')\n  logger.debug(\n    'offsetInMilliseconds : ' \\\n    &quot;#{request.request['request']['offsetInMilliseconds']}&quot;\n  )\n  empty_response\nend\n\nintent 'AudioPlayer.PlaybackStopped' do\n  logger.debug('PlaybackStopped: interruption with a bi-tone')\n  logger.debug(\n    'offsetInMilliseconds : ' \\\n    &quot;#{request.request['request']['offsetInMilliseconds']}&quot;\n  )\n  empty_response\nend\n\nintent 'AudioPlayer.PlaybackNearlyFinished' do\n  logger.debug('Time to add up another playback from the list')\n  empty_response\nend\n\nintent 'AudioPlayer.PlaybackFinished' do\n  error_count = 0\n  logger.debug('PlaybackFinished intent fired')\n  (JSON.parse audio_player.stop).tap do |response|\n    response['response']['shouldEndSession'] = true\n  end.to_json\nend\n\nintent 'System.ExceptionEncountered' do\n  failure_details = request.request['request']\n  error_details = failure_details['error']\n  logger.debug(&quot;Error timestamp : #{failure_details['timestamp']}&quot;)\n  logger.error('Error details (message) : ' \\\n               &quot;##{error_count} - #{error_details['message']}&quot;)\nend\n\n</code></pre>\n<p>The interruption does not have the reading of the mp3 file start over, it just beeps (bi-tone), then pauses and resumes the stream reading, on its own.\nI wonder if the previous intent response is the actual cause of this playback interruption. Any idea would be helpful.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routing"], "owner": {"reputation": 41, "user_id": 1760141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b985167230bd6929a529ef146498f967?s=128&d=identicon&r=PG", "display_name": "epipenguin", "link": "https://stackoverflow.com/users/1760141/epipenguin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1552488607, "creation_date": 1552488607, "question_id": 55144777, "link": "https://stackoverflow.com/questions/55144777/rails-4-redirects-to-true-host-url-instead-of-current-host-url", "title": "Rails 4 Redirects to True Host URL instead of Current Host URL", "body": "<p>Our Rails application lives on a website, <code>app.example.com</code> and sits behind a AWS Cloudfront system using a Lamdba method that determines which traffic to pass through from <code>cf.example.com</code> to <code>app.example.com</code> or <code>app2.example.com</code>. So if I navigate to <code>cf.example.com/my_page</code> it displays content from <code>app.example.com/my_page</code> without editing the hostname.</p>\n\n<p>On any Rails redirects (redirect_to or router method redirect) it is changing my url from <code>cf.example.com</code> to <code>app.example.com</code>.</p>\n\n<p>Example:</p>\n\n<pre><code>/routes.rb\nroot to: redirect('/log_in')\n</code></pre>\n\n<p>On <code>cf.example.com</code>, Rails returns 302 where location is <code>app.example.com/log_in</code></p>\n\n<p>I need to keep this url as <code>cf.example.com/log_in</code>. How can I stop Rails 4 from changing my location to its hosted location?</p>\n\n<p>I am using Passenger with Ruby on Rails 4.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake", "actionmailer", "rake-task"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1552488464, "creation_date": 1552488464, "answer_id": 55144718, "question_id": 55144420, "link": "https://stackoverflow.com/questions/55144420/run-mailer-only-after-rake-task-is-finished/55144718#55144718", "title": "Run mailer only after rake task is finished", "body": "<p>Unless you execute <code>rake</code> from inside the same Ruby machine as your mailer (which I doubt,) they do not share the environment, even if you were trying to use the global variable (setting local variables has zero effect at all in any case, even inside your last two methods in <code>rake</code> those are <em>different variables</em>.)</p>\n\n<p>What you need is to write <code>.pid</code> file and check it\u2019s existence on the file system, or use any other external source of truth, like <code>redis</code>, or even <code>DB</code>.</p>\n"}], "owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 55144718, "answer_count": 1, "score": 0, "last_activity_date": 1552488464, "creation_date": 1552487695, "question_id": 55144420, "link": "https://stackoverflow.com/questions/55144420/run-mailer-only-after-rake-task-is-finished", "title": "Run mailer only after rake task is finished", "body": "<p>I only want to run my <code>mailer</code> if my rake task is NOT running. If I run both the api gets throttled.</p>\n\n<p>So I'm trying to define a variable in a method on my <code>OrderMailer</code> and just watch for a <code>true</code> value on that variable, but I can't seem to get it to work. </p>\n\n<p>This is my code so far:</p>\n\n<pre><code>class OrderMailer &lt; ActionMailer::Base\n  default from: 'todd@gmail.com'\n  attr_reader :sheet\n  attr_accessor :amazon_api_is_free\n\ndef order_report\n    Rails.logger.info\"Is the api free? #{amazon_api_is_free}\"\n    sleep(30) until amazon_api_is_free\n    shops = Shop.where(subscribed: true, setup: true)\n    shops.each do |shop|\n      @sheet = OrderReport.new(shop)\n      @sheet.create_order_workbook\n      # get_data_for_inside_email\n      time = Time.now\n      if File.exist?(\"problem_orders_#{shop.id}.xlsx\")\n        mail(to: \"todd@gmail.com\", \n        subject: \"FBA Shipping Report for #{time.strftime(\"%B %d\")}\").attachments[\"problem_orders_#{shop.id}.xlsx\"] = File.read(\"problem_orders_#{shop.id}.xlsx\")\n        # mail(to: \"todd.trimakas@gmail.com\", subject: \"FBA Shipping Report for #{time.strftime(\"%B %d\")}\")\n      end\n    end\n  end\n\n  def self.is_amazon_api_available\n    @amazon_api_is_free\n  end\n</code></pre>\n\n<p>And then my example rake task:</p>\n\n<pre><code>desc 'Passing the buck'\ntask :just_a_test =&gt; :environment do\n  puts \"testing\"\n  start\nend\n\n  def start\n    not_available\n    pp \"From the rake is the api free? #{OrderMailer.is_amazon_api_available}\"\n    pp \"making sure its running\"\n    sleep(20)\n    available\n  end\n\n  def not_available\n    is_amazon_api_available = false\n  end\n\n  def available\n    is_amazon_api_available = true\n  end\n</code></pre>\n"}, {"tags": ["ruby", "docker", "web"], "comments": [{"owner": {"reputation": 934, "user_id": 4317250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvtAr.jpg?s=128&g=1", "display_name": "Steve Boyd", "link": "https://stackoverflow.com/users/4317250/steve-boyd"}, "edited": false, "score": 2, "creation_date": 1552487677, "post_id": 55144337, "comment_id": 97029319, "body": "Please review how to provide an <a href=\"https://stackoverflow.com/help/mcve\">MVCE</a>. In this case, a copy of the <code>Dockerfile</code> and the command line arguments you used to start the container would be helpful."}, {"owner": {"reputation": 579, "user_id": 5672673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fXPQ.jpg?s=128&g=1", "display_name": "Linh Chi Nguyen", "link": "https://stackoverflow.com/users/5672673/linh-chi-nguyen"}, "reply_to_user": {"reputation": 934, "user_id": 4317250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvtAr.jpg?s=128&g=1", "display_name": "Steve Boyd", "link": "https://stackoverflow.com/users/4317250/steve-boyd"}, "edited": false, "score": 0, "creation_date": 1552489795, "post_id": 55144337, "comment_id": 97030908, "body": "Sorry, I have pushed the docker image and gave my command line."}, {"owner": {"reputation": 934, "user_id": 4317250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvtAr.jpg?s=128&g=1", "display_name": "Steve Boyd", "link": "https://stackoverflow.com/users/4317250/steve-boyd"}, "edited": false, "score": 0, "creation_date": 1552579418, "post_id": 55144337, "comment_id": 97073501, "body": "Please post your <code>Dockerfile</code> and <code>app.rb</code> here so that we may better assist you."}, {"owner": {"reputation": 579, "user_id": 5672673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fXPQ.jpg?s=128&g=1", "display_name": "Linh Chi Nguyen", "link": "https://stackoverflow.com/users/5672673/linh-chi-nguyen"}, "reply_to_user": {"reputation": 934, "user_id": 4317250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvtAr.jpg?s=128&g=1", "display_name": "Steve Boyd", "link": "https://stackoverflow.com/users/4317250/steve-boyd"}, "edited": false, "score": 0, "creation_date": 1552582971, "post_id": 55144337, "comment_id": 97075757, "body": "Hello, I put <code>app.rb</code>, <code>Dockerfile</code>, server log and curl log. When I post data with curl, the data is actually sent but the server hangs up on me."}], "answers": [{"comments": [{"owner": {"reputation": 579, "user_id": 5672673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fXPQ.jpg?s=128&g=1", "display_name": "Linh Chi Nguyen", "link": "https://stackoverflow.com/users/5672673/linh-chi-nguyen"}, "edited": false, "score": 0, "creation_date": 1552489884, "post_id": 55144422, "comment_id": 97030970, "body": "Yes I did try. If you have more suggestion after this step, I would like to hear."}, {"owner": {"reputation": 1, "user_id": 5545819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sA-TzX7rulQ/AAAAAAAAAAI/AAAAAAAAAXg/v0S-toOoFkE/photo.jpg?sz=128", "display_name": "Volodymyr Komarov", "link": "https://stackoverflow.com/users/5545819/volodymyr-komarov"}, "reply_to_user": {"reputation": 579, "user_id": 5672673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fXPQ.jpg?s=128&g=1", "display_name": "Linh Chi Nguyen", "link": "https://stackoverflow.com/users/5672673/linh-chi-nguyen"}, "edited": false, "score": 0, "creation_date": 1552526487, "post_id": 55144422, "comment_id": 97047399, "body": "Try to see is a service has been started or listen to your connections via: - <code>docker ps -a</code> - <code>docker logs {my-container-id}</code>"}], "tags": [], "owner": {"reputation": 1, "user_id": 5545819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sA-TzX7rulQ/AAAAAAAAAAI/AAAAAAAAAXg/v0S-toOoFkE/photo.jpg?sz=128", "display_name": "Volodymyr Komarov", "link": "https://stackoverflow.com/users/5545819/volodymyr-komarov"}, "is_accepted": false, "score": 0, "last_activity_date": 1552487699, "creation_date": 1552487699, "answer_id": 55144422, "question_id": 55144337, "link": "https://stackoverflow.com/questions/55144337/webservice-does-not-work-after-being-packaged-into-a-docker-image/55144422#55144422", "title": "Webservice does not work after being packaged into a Docker image", "body": "<p>Have a look at this article: <a href=\"https://docs.docker.com/config/containers/container-networking/\" rel=\"nofollow noreferrer\">https://docs.docker.com/config/containers/container-networking/</a></p>\n\n<p>In few words - try to publish your exposed ports via <code>-p</code> argument.</p>\n\n<p>For example:</p>\n\n<pre><code>$ docker run -it -p 4567 my-local-image\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 579, "user_id": 5672673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fXPQ.jpg?s=128&g=1", "display_name": "Linh Chi Nguyen", "link": "https://stackoverflow.com/users/5672673/linh-chi-nguyen"}, "edited": false, "score": 0, "creation_date": 1552489843, "post_id": 55144878, "comment_id": 97030951, "body": "Thanks but I did try this. After trying this, do you know what other cue can I check?"}], "tags": [], "owner": {"reputation": 316, "user_id": 7660079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3CawQ.jpg?s=128&g=1", "display_name": "Aweston", "link": "https://stackoverflow.com/users/7660079/aweston"}, "is_accepted": false, "score": 0, "last_activity_date": 1552488901, "last_edit_date": 1592644375, "creation_date": 1552488901, "answer_id": 55144878, "question_id": 55144337, "link": "https://stackoverflow.com/questions/55144337/webservice-does-not-work-after-being-packaged-into-a-docker-image/55144878#55144878", "title": "Webservice does not work after being packaged into a Docker image", "body": "<p>From <a href=\"https://docs.docker.com/config/containers/container-networking/\" rel=\"nofollow noreferrer\">the documentation</a>:</p>\n<blockquote>\n<p>Flag value    Description</p>\n<p>-p 8080:80    Map TCP port 80 in the container to port 8080 on the Docker host.</p>\n</blockquote>\n<p>You need to map the TCP port 4567 in the container to a port on the Docker host. For example, to map it to port 8080:</p>\n<pre><code>$ docker run -it -p 8080:4567 image-goes-here\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 579, "user_id": 5672673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fXPQ.jpg?s=128&g=1", "display_name": "Linh Chi Nguyen", "link": "https://stackoverflow.com/users/5672673/linh-chi-nguyen"}, "edited": false, "score": 0, "creation_date": 1552586201, "post_id": 55168487, "comment_id": 97077656, "body": "okay, this works for the get / method. I still got trouble with posting data to it though. would have to inspect further. but this answers the question. in production, do you use Puma?"}, {"owner": {"reputation": 8517, "user_id": 2336650, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lpq4b.jpg?s=128&g=1", "display_name": "Mostafa Hussein", "link": "https://stackoverflow.com/users/2336650/mostafa-hussein"}, "reply_to_user": {"reputation": 579, "user_id": 5672673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fXPQ.jpg?s=128&g=1", "display_name": "Linh Chi Nguyen", "link": "https://stackoverflow.com/users/5672673/linh-chi-nguyen"}, "edited": false, "score": 1, "creation_date": 1552586360, "post_id": 55168487, "comment_id": 97077742, "body": "Yes you can depend on puma, unicorn, passenger whatever works for you and also you may use <code>nginx</code> in front of your application. For the<code>POST</code> method i couldn&#39;t try it but it will be an issue related to the code not the communication between your host and docker"}], "tags": [], "owner": {"reputation": 8517, "user_id": 2336650, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lpq4b.jpg?s=128&g=1", "display_name": "Mostafa Hussein", "link": "https://stackoverflow.com/users/2336650/mostafa-hussein"}, "is_accepted": true, "score": 2, "last_activity_date": 1552584111, "last_edit_date": 1592644375, "creation_date": 1552583680, "answer_id": 55168487, "question_id": 55144337, "link": "https://stackoverflow.com/questions/55144337/webservice-does-not-work-after-being-packaged-into-a-docker-image/55168487#55168487", "title": "Webservice does not work after being packaged into a Docker image", "body": "<p>This issue is happening because Sinatra by default (development environment) listen on 127.0.0.1 which not works in case of external connection to container</p>\n<blockquote>\n<p><strong>:bind</strong> - server hostname or IP address</p>\n<p>String specifying the hostname or IP address of the interface to listen on when the :run setting is enabled. The default value in the development environment is 'localhost' which means the server is only available from the local machine. In other environments the default is '0.0.0.0', which causes the server to listen on all available interfaces.</p>\n</blockquote>\n<p>So if you will continue on running in development mode, you need to change it to 0.0.0.0, for example:</p>\n<pre><code>docker run -p 4567:4567 --name stack eivor/ruby bash -c 'ruby ./app.rb -o 0.0.0.0'\n</code></pre>\n<p>Which can be used in Dockerfile as:</p>\n<pre><code>CMD [&quot;ruby&quot;, &quot;./app.rb&quot;, &quot;-o&quot;, &quot;0.0.0.0&quot;]\n</code></pre>\n<p>Or you can use the following within your script:</p>\n<pre><code>set :bind, '0.0.0.0'\n</code></pre>\n<p>Then from outside the container you can get the result:</p>\n<pre><code>curl -v localhost:4567\n*   Trying ::1...\n* TCP_NODELAY set\n* Connected to localhost (::1) port 4567 (#0)\n&gt; GET / HTTP/1.1\n&gt; Host: localhost:4567\n&gt; User-Agent: curl/7.64.0\n&gt; Accept: */*\n&gt; \n&lt; HTTP/1.1 200 OK \n&lt; Content-Type: text/html;charset=utf-8\n&lt; Content-Length: 13\n&lt; X-Xss-Protection: 1; mode=block\n&lt; X-Content-Type-Options: nosniff\n&lt; X-Frame-Options: SAMEORIGIN\n&lt; Server: WEBrick/1.3.1 (Ruby/2.3.8/2018-10-18)\n&lt; Date: Thu, 14 Mar 2019 17:17:20 GMT\n&lt; Connection: Keep-Alive\n&lt; \n* Connection #0 to host localhost left intact\nhello, world!\n</code></pre>\n<p>For more configuration check the following: <a href=\"http://sinatrarb.com/configuration.html\" rel=\"nofollow noreferrer\">CONFIGURING SETTINGS\n</a></p>\n"}], "owner": {"reputation": 579, "user_id": 5672673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fXPQ.jpg?s=128&g=1", "display_name": "Linh Chi Nguyen", "link": "https://stackoverflow.com/users/5672673/linh-chi-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 55168487, "answer_count": 3, "score": 0, "last_activity_date": 1552584111, "creation_date": 1552487424, "last_edit_date": 1552582926, "question_id": 55144337, "link": "https://stackoverflow.com/questions/55144337/webservice-does-not-work-after-being-packaged-into-a-docker-image", "title": "Webservice does not work after being packaged into a Docker image", "body": "<p>I write a simple webservice in ruby with sinatra. If I run <code>ruby app.rb</code> it runs on localhost:4567. I write a Dockerfile to make an image and expose port 4567.</p>\n\n<p>However, when I run the docker image the webservice runs but if I try to connect (with curl and browser) to port 4567, it says <code>Connection reset by peer</code>.</p>\n\n<p>Anyone has any suggestion? Because I do not know what to check in this case. I have tried some vague things but still..</p>\n\n<p>The webservice runs normally outside docker.</p>\n\n<p>EDIT 1:</p>\n\n<p>I have pushed the image to <code>eivor/ruby</code>. If you run it and go to browser to check it would say <code>connection reset</code>. Yes I tried <code>docker run -p 4567:4567 eivor/ruby</code> as said before posting the question.</p>\n\n<p>EDIT 2: Here is the <code>app.rb</code></p>\n\n<pre><code>require 'sinatra'\nrequire 'referal' # this is the gem that calculate reward points to users\nrequire 'json'\nrequire 'byebug'\n\nget '/' do\n  'hello, world!'\nend\n\n# inside docker image, even get / returns connection reset by peer\n# not to mention post data to it\n\npost '/' do\n  data = JSON.parse(request.body.read)\n  input = []\n  data.each do | key, value |\n    input &lt;&lt; value\n  end\n  invs, users = input.reduce([[],[]]) do | results, instruction |\n    results = classify(instruction, results[0], results[1])\n    results\n  end\n  res = export(users)\n  # byebug\n  puts res\nend\n\npost '/text' do\n  @data = request.body.readlines\n  #byebug\n  @processed = @data.map{ |s| process(s) }\n  @invs, @users = @processed.reduce([[],[]]) do | results, instruction |\n    results = classify(instruction, results[0], results[1])\n    results\n  end\n  @jsn = export(@users)\n  puts @jsn\nend\n\n</code></pre>\n\n<p>Here is the Dockerfile, i build a lightweight ruby from alpine</p>\n\n<pre><code>FROM alpine:3.5\nENV BUILD_PACKAGES bash curl-dev ruby-dev build-base git libstdc++ tzdata ca-certificates\nENV RUBY_PACKAGES ruby&gt;2.3 ruby-irb ruby-rake ruby-io-console ruby-bigdecimal ruby-json\n\nRUN apk update &amp;&amp; apk upgrade\nRUN apk add $BUILD_PACKAGES &amp;&amp; apk add $RUBY_PACKAGES\nRUN apk add ruby-bundler&gt;1.17\n\nRUN echo 'gem: --no-document' &gt; /etc/gemrc &amp;&amp; rm -rf /var/cach/apk/*\n\nRUN gem install bundler\n\nRUN mkdir /usr/app\nWORKDIR /usr/app\nRUN git init\n\nCOPY . /usr/app\n\nRUN bundle install\n\nRUN bundle exec rake install\n\nEXPOSE 4567\n\nCMD [\"ruby\", \"./app.rb\"]\n</code></pre>\n\n<p>If I run outside docker with command <code>ruby app.rb</code> or <code>bundle exec rerun app.rb</code> it works normally. But using docker image, it does not. I run the command:</p>\n\n<pre><code>docker run -p 4567:4567 eivor/ruby\n</code></pre>\n\n<p>The server runs, </p>\n\n<pre><code>[2019-03-14 16:59:59] INFO  WEBrick 1.3.1\n[2019-03-14 16:59:59] INFO  ruby 2.3.8 (2018-10-18) [x86_64-linux-musl]\n== Sinatra (v2.0.5) has taken the stage on 4567 for development with backup from WEBrick\n[2019-03-14 16:59:59] INFO  WEBrick::HTTPServer#start: pid=1 port=4567\n\n</code></pre>\n\n<p>but when I try to access with browser or curl, it says <code>connection reset by peer</code>. If I try to post with curl, the data is actually sent but it does not respond, it hangs up on me instead.</p>\n\n<pre><code>curl -v localhost:4567 --data-binary @test/input\n</code></pre>\n\n<pre><code>* Rebuilt URL to: localhost:4567/\n*   Trying 127.0.0.1...\n* TCP_NODELAY set\n* Connected to localhost (127.0.0.1) port 4567 (#0)\n&gt; POST / HTTP/1.1\n&gt; Host: localhost:4567\n&gt; User-Agent: curl/7.58.0\n&gt; Accept: */*\n&gt; Content-Length: 369\n&gt; Content-Type: application/x-www-form-urlencoded\n&gt; \n* upload completely sent off: 369 out of 369 bytes\n* Recv failure: Connection reset by peer\n* stopped the pause stream!\n* Closing connection 0\ncurl: (56) Recv failure: Connection reset by peer\n\n</code></pre>\n"}, {"tags": ["node.js", "ruby", "webstorm", "bundler", "compass"], "comments": [{"owner": {"reputation": 492, "user_id": 8283700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3cb88d8a8fd714de32bd4bc9587ce93?s=128&d=identicon&r=PG&f=1", "display_name": "Oksana", "link": "https://stackoverflow.com/users/8283700/oksana"}, "edited": false, "score": 0, "creation_date": 1552491135, "post_id": 55144114, "comment_id": 97031875, "body": "Have you tried running the same command out of the IDE in the command line? Do you get the same error?"}, {"owner": {"reputation": 122, "user_id": 3410154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoTPk.jpg?s=128&g=1", "display_name": "ntiedt", "link": "https://stackoverflow.com/users/3410154/ntiedt"}, "reply_to_user": {"reputation": 492, "user_id": 8283700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3cb88d8a8fd714de32bd4bc9587ce93?s=128&d=identicon&r=PG&f=1", "display_name": "Oksana", "link": "https://stackoverflow.com/users/8283700/oksana"}, "edited": false, "score": 0, "creation_date": 1552492519, "post_id": 55144114, "comment_id": 97032821, "body": "Output is: Traceback (most recent call last):         2: from F:/Cloud/Zoho WorkDrive (Gedankenfolger&#174; GmbH)/General/Kunden 2019/Uhlmann/TYPO3/Wonder by Uhlmann TYPO3 87/gems/ruby/2.6.0/bin/compass:23:in <code>&lt;main&gt;&#39;         1: from C:&#47;Ruby26-x64&#47;lib&#47;ruby&#47;site_ruby&#47;2.6.0&#47;rubygems.rb:302:in </code>activate_bin_path&#39; C:/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems.rb:283:in `find_spec_for_exe&#39;: can&#39;t find gem compass (&gt;= 0.a) with executable compass (Gem::GemNotFoundException)"}], "answers": [{"comments": [{"owner": {"reputation": 122, "user_id": 3410154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoTPk.jpg?s=128&g=1", "display_name": "ntiedt", "link": "https://stackoverflow.com/users/3410154/ntiedt"}, "edited": false, "score": 0, "creation_date": 1552552618, "post_id": 55148762, "comment_id": 97055276, "body": "The thing is i want a project specific installation not a global this is why i use the --path option"}, {"owner": {"reputation": 122, "user_id": 3410154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoTPk.jpg?s=128&g=1", "display_name": "ntiedt", "link": "https://stackoverflow.com/users/3410154/ntiedt"}, "edited": false, "score": 0, "creation_date": 1552554521, "post_id": 55148762, "comment_id": 97056353, "body": "My originally reason was to handle different gem versions but i get errors with the newest version of sass and my needed version for this project. Rvm seems a solution but not for windows. Pik is outdated and uru seems also a bit complicated for me. Also the documentation is a bit frustrating."}, {"owner": {"reputation": 7555, "user_id": 100852, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ebc95603a264f87d8cd670d8976ef4f2?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 Go\u015bcicki", "link": "https://stackoverflow.com/users/100852/pawe%c5%82-go%c5%9bcicki"}, "reply_to_user": {"reputation": 122, "user_id": 3410154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoTPk.jpg?s=128&g=1", "display_name": "ntiedt", "link": "https://stackoverflow.com/users/3410154/ntiedt"}, "edited": false, "score": 0, "creation_date": 1552568764, "post_id": 55148762, "comment_id": 97065501, "body": "I wouldn&#39;t worry about global gems installation. You still need to use <code>bundle exec</code> in most local installs. Just install without path and execute with <code>bundle exec</code> and all should be fine."}, {"owner": {"reputation": 122, "user_id": 3410154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoTPk.jpg?s=128&g=1", "display_name": "ntiedt", "link": "https://stackoverflow.com/users/3410154/ntiedt"}, "edited": false, "score": 0, "creation_date": 1552632272, "post_id": 55148762, "comment_id": 97092089, "body": "What is <code>bundle exec</code> for? I didn&#180;t needed it before. And as i wrote before i had problems with global gems in combination with different version of sass."}, {"owner": {"reputation": 7555, "user_id": 100852, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ebc95603a264f87d8cd670d8976ef4f2?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 Go\u015bcicki", "link": "https://stackoverflow.com/users/100852/pawe%c5%82-go%c5%9bcicki"}, "reply_to_user": {"reputation": 122, "user_id": 3410154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoTPk.jpg?s=128&g=1", "display_name": "ntiedt", "link": "https://stackoverflow.com/users/3410154/ntiedt"}, "edited": false, "score": 0, "creation_date": 1552644260, "post_id": 55148762, "comment_id": 97097956, "body": "Your problems most likely stemmed from the fact that you didn&#39;t use <code>bundle exec</code>. Read more about it here: <a href=\"https://bundler.io/man/bundle-exec.1.html\" rel=\"nofollow noreferrer\">bundler.io/man/bundle-exec.1.html</a> or just google for it."}, {"owner": {"reputation": 122, "user_id": 3410154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoTPk.jpg?s=128&g=1", "display_name": "ntiedt", "link": "https://stackoverflow.com/users/3410154/ntiedt"}, "edited": false, "score": 0, "creation_date": 1552652942, "post_id": 55148762, "comment_id": 97103115, "body": "Thanks in advance. Much to read and understand here. Especially because i do not run a ruby app only sass etc. for precompiling my scss files with a watcher inside phpstorm."}, {"owner": {"reputation": 7555, "user_id": 100852, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ebc95603a264f87d8cd670d8976ef4f2?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 Go\u015bcicki", "link": "https://stackoverflow.com/users/100852/pawe%c5%82-go%c5%9bcicki"}, "reply_to_user": {"reputation": 122, "user_id": 3410154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoTPk.jpg?s=128&g=1", "display_name": "ntiedt", "link": "https://stackoverflow.com/users/3410154/ntiedt"}, "edited": false, "score": 0, "creation_date": 1552928756, "post_id": 55148762, "comment_id": 97187777, "body": "You thank the users who answer your questions here by upvoting and accepting their answers ;)"}], "tags": [], "owner": {"reputation": 7555, "user_id": 100852, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ebc95603a264f87d8cd670d8976ef4f2?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 Go\u015bcicki", "link": "https://stackoverflow.com/users/100852/pawe%c5%82-go%c5%9bcicki"}, "is_accepted": false, "score": 0, "last_activity_date": 1552500992, "creation_date": 1552500992, "answer_id": 55148762, "question_id": 55144114, "link": "https://stackoverflow.com/questions/55144114/cant-find-gem-compass-0-a-with-executable-compass/55148762#55148762", "title": "Can&#39;t find gem compass (&gt;= 0.a) with executable compass", "body": "<p>I wouldn't install with such <code>--path</code> option. I'd just execute <code>bundle install</code>.</p>\n\n<p>(You might want to delete the <code>.bundle/config</code> file too first).</p>\n"}], "owner": {"reputation": 122, "user_id": 3410154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoTPk.jpg?s=128&g=1", "display_name": "ntiedt", "link": "https://stackoverflow.com/users/3410154/ntiedt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1177, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552502366, "creation_date": 1552486805, "last_edit_date": 1552502366, "question_id": 55144114, "link": "https://stackoverflow.com/questions/55144114/cant-find-gem-compass-0-a-with-executable-compass", "title": "Can&#39;t find gem compass (&gt;= 0.a) with executable compass", "body": "<p>I can't get PhpStorm to work with a relative installed bundler package.</p>\n\n<p>I\u00b4m using bundler with following gemfile:</p>\n\n<pre><code>source \"http://rubygems.org\"\n\ngem \"susy\", \"~&gt;2.2.14\"\ngem \"sass\", \"~&gt;3.4.22\"\ngem \"compass\", \"~&gt; 1.1.0.alpha.3\"\ngem \"breakpoint\", \"~&gt;2.5.0\"\ngem \"font-awesome-sass\", \"~&gt;4.6.2\"\n</code></pre>\n\n<p>At the PhpStorm terminal I'm executing the following command to install the gems to the relative directory <code>gems/</code>:</p>\n\n<pre><code>bundle install --path gems/\n</code></pre>\n\n<p>Bundler installed all to the directory <code>gems/</code> without any error.</p>\n\n<p><a href=\"https://i.stack.imgur.com/6Vf2U.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6Vf2U.gif\" alt=\"Installed relative ruby folder structure\"></a></p>\n\n<p>My watcher task looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VzRJj.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VzRJj.gif\" alt=\"screenshot watcher\"></a>.</p>\n\n<p>If I make some changes in my scss file the watcher throws</p>\n\n<pre><code>cmd.exe /D /C call \"F:\\Cloud\\Zoho WorkDrive (Gedankenfolger\u00ae GmbH)\\General\\Kunden 2019\\Uhlmann\\TYPO3\\Wonder by Uhlmann TYPO3 87\\gems\\ruby\\2.6.0\\bin\\compass.bat\" compile \"F:\\Cloud\\Zoho WorkDrive (Gedankenfolger\u00ae GmbH)\\General\\Kunden 2019\\Uhlmann\\TYPO3\\Wonder by Uhlmann TYPO3 87\\fileadmin\\templates\"\nC:/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems.rb:283:in `find_spec_for_exe': can't find gem compass (&gt;= 0.a) with executable compass (Gem::GemNotFoundException)\nfrom C:/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems.rb:302:in `activate_bin_path'\nfrom F:/Cloud/Zoho WorkDrive (Gedankenfolger\ufffd GmbH)/General/Kunden 2019/Uhlmann/TYPO3/Wonder by Uhlmann TYPO3 87/gems/ruby/2.6.0/bin/compass:23:in `&lt;main&gt;'\n\nProcess finished with exit code 1\n</code></pre>\n\n<p>How can I get this to work?</p>\n\n<p>System environment:</p>\n\n<ul>\n<li>Windows 10 Pro / Version 1809 / Build 17763.316</li>\n<li>PhpStorm 2018.3.4</li>\n<li>ruby 2.6.1p33 (2019-01-30 revision 66950) [x64-mingw32]</li>\n<li>npm 6.4.1</li>\n<li>bundler 2.0.1</li>\n</ul>\n"}, {"tags": ["ruby", "rubygems", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1552533719, "post_id": 55145356, "comment_id": 97048950, "body": "Thank you! I have implemented this at <a href=\"https://github.com/keithrbennett/rexe/blob/070766f6925cb097442d9f57f168f04f66c4e753/exe/rexe?#L379-L394\" rel=\"nofollow noreferrer\">github.com/keithrbennett/rexe/blob/&hellip;</a>. I hope there would be a better long term solution (a Bundler option maybe), but at least this works around the problem."}], "tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": false, "score": 1, "last_activity_date": 1552490300, "creation_date": 1552490300, "answer_id": 55145356, "question_id": 55144094, "link": "https://stackoverflow.com/questions/55144094/bundler-doesnt-permit-using-gems-in-project-home-directory/55145356#55145356", "title": "Bundler doesn&#39;t permit using gems in project home directory", "body": "<p>Not a complete answer, just a direction: try adding the path to the requested gem to <code>$LOAD_PATH</code> explicitly before requiring the gem. For example:</p>\n\n<pre><code>pry(main)&gt; require \"awesome_print\"                                                                    \nLoadError: cannot load such file -- awesome_print\n</code></pre>\n\n<p>But then</p>\n\n<pre><code>pry(main)&gt; $LOAD_PATH &lt;&lt; \"&lt;home&gt;/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/awesome_print-1.8.0/lib/\";\npry(main)&gt; require \"awesome_print\"\n=&gt; true\n</code></pre>\n\n<p>Voila! The question is how to get the proper path for the gem, maybe <code>gem which</code> could help...</p>\n"}], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552490300, "creation_date": 1552486740, "question_id": 55144094, "link": "https://stackoverflow.com/questions/55144094/bundler-doesnt-permit-using-gems-in-project-home-directory", "title": "Bundler doesn&#39;t permit using gems in project home directory", "body": "<p>I'm working on a program that assists in running Ruby code on the command line (at <a href=\"https://github.com/keithrbennett/rexe\" rel=\"nofollow noreferrer\">https://github.com/keithrbennett/rexe</a>, <code>gem install rexe</code>).</p>\n\n<p>When I <code>gem install</code> it, and cd to the project root, and try to <code>require</code> a file not in the Gemfile, it fails:</p>\n\n<pre><code>\u279c  rexe git:(master) \u2717  \uf8ff rexe -r awesome_print -oa '\"hello\"'\nTraceback (most recent call last):\n    12: from /Users/kbennett/.rvm/gems/ruby-2.6.0/bin/ruby_executable_hooks:24:in `&lt;main&gt;'\n    11: from /Users/kbennett/.rvm/gems/ruby-2.6.0/bin/ruby_executable_hooks:24:in `eval'\n    10: from /Users/kbennett/.rvm/gems/ruby-2.6.0/bin/rexe:23:in `&lt;main&gt;'\n     9: from /Users/kbennett/.rvm/gems/ruby-2.6.0/bin/rexe:23:in `load'\n     8: from /Users/kbennett/work/rexe/exe/rexe:403:in `&lt;top (required)&gt;'\n     7: from /Users/kbennett/.rvm/gems/ruby-2.6.0/gems/bundler-2.0.1/lib/bundler.rb:313:in `with_clean_env'\n     6: from /Users/kbennett/.rvm/gems/ruby-2.6.0/gems/bundler-2.0.1/lib/bundler.rb:562:in `with_env'\n     5: from /Users/kbennett/.rvm/gems/ruby-2.6.0/gems/bundler-2.0.1/lib/bundler.rb:313:in `block in with_clean_env'\n     4: from /Users/kbennett/work/rexe/exe/rexe:403:in `block in &lt;top (required)&gt;'\n     3: from /Users/kbennett/work/rexe/exe/rexe:385:in `call'\n     2: from /Users/kbennett/work/rexe/exe/rexe:385:in `each'\n     1: from /Users/kbennett/work/rexe/exe/rexe:385:in `block in call'\n/Users/kbennett/work/rexe/exe/rexe:385:in `require': cannot load such file -- awesome_print (LoadError)\n</code></pre>\n\n<p>However, when I <code>cd ~</code>, it works fine:</p>\n\n<pre><code>\u279c  ~  \uf8ff rexe -r awesome_print -oa '\"hello\"'\n\"hello\"%\n</code></pre>\n\n<p>I wrapped my code in <code>Bundler.with_clean_env</code>, which I thought should take care of this.</p>\n\n<p>I can use the Ruby interpreter directly and it works:</p>\n\n<pre><code>\u279c  rexe git:(master) \u2717  \uf8ff ruby -r awesome_print -e \"ap 'hello'\"\n\"hello\"\n</code></pre>\n\n<p>So I guess Bundler is making an assumption that non-Gemfile-listed gems should not be permitted to be loaded, and that is almost always reasonable, but in my case, where the program should be able to load any gem whatsoever, it is an impediment.</p>\n\n<p>I understand that Bundler is finding the Gemfile[.lock] and doing what it thinks is right, but is there any way around this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "rest-client", "airborne"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1552484011, "creation_date": 1552484011, "answer_id": 55143144, "question_id": 55142986, "link": "https://stackoverflow.com/questions/55142986/how-to-send-api-request-with-authentication-in-ruby/55143144#55143144", "title": "How to send api request with authentication in ruby", "body": "<p><code>-u</code> option sends a basic auth header to the client.</p>\n\n<p>The very top of <a href=\"https://github.com/brooklynDev/airborne#making-requests\" rel=\"nofollow noreferrer\"><code>README</code></a> of <em>Airborne</em> shows how to send an auth header:</p>\n\n<pre><code>describe 'Test to GET' do\n  it 'should get the existing data' do\n    get \"https://example.com/api/v2/tests.json\",\n        { 'x-auth-token' =&gt; 'my_token' }\n    expect_status(200)\n  end\nend\n</code></pre>\n\n<p>How to get the token out of <code>user</code>:<code>password</code> pair I\u2019d leave for you as a homework (e. g. you might simply log <code>curl</code> request.)</p>\n\n<p>You also might set the auth header globally via <a href=\"https://github.com/brooklynDev/airborne#configuration\" rel=\"nofollow noreferrer\"><em>Airborne</em> config</a>.</p>\n"}], "owner": {"reputation": 147, "user_id": 7064728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c5105e5db6a36de015bef57e986b503?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley", "link": "https://stackoverflow.com/users/7064728/ashley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 55143144, "answer_count": 1, "score": 0, "last_activity_date": 1552484011, "creation_date": 1552483520, "last_edit_date": 1552483546, "question_id": 55142986, "link": "https://stackoverflow.com/questions/55142986/how-to-send-api-request-with-authentication-in-ruby", "title": "How to send api request with authentication in ruby", "body": "<p>I have this curl command to send api request with authentication. I am writing a test using airborne where I need to send an api request inside the test. \ncurl command</p>\n\n<pre><code>curl https://example.com/api/v2/tests.json \\\n  -v -u test@email.com:Abcd1234\n</code></pre>\n\n<p>I have the test like below but I need to add the authentication. How do i do it?</p>\n\n<pre><code>describe 'Test to GET' do\n  it 'should get the existing data'do\n  get \"https://example.com/api/v2/tests.json\",\"test@email.com\":\"Abcd1234\"\n  expect_status(200)\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1552482335, "post_id": 55142515, "comment_id": 97025368, "body": "Did you consider using a <code>Hash</code> instead of an <code>Array</code> to store your instances? If you want to update the instances later on, how do you want to find the records? Is there something unique on each of the instances?"}, {"owner": {"reputation": 81, "user_id": 10928405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14ed86a9772fbc1074edaa2ddcb427f?s=128&d=identicon&r=PG&f=1", "display_name": "Niall", "link": "https://stackoverflow.com/users/10928405/niall"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1552482642, "post_id": 55142515, "comment_id": 97025590, "body": "each vehicle gets a unique vehicle registration mark (vrm) so can be identified using that.  The array was simply to see if it would take the data, previously everything was stored in a hash with vrm as the key for each record. It worked perfectly but I don&#39;t feel having a giant global variable containing all my data is best practice."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 10928405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14ed86a9772fbc1074edaa2ddcb427f?s=128&d=identicon&r=PG&f=1", "display_name": "Niall", "link": "https://stackoverflow.com/users/10928405/niall"}, "edited": false, "score": 0, "creation_date": 1552487717, "post_id": 55142828, "comment_id": 97029360, "body": "Exactly what I needed. I incorrectly assumed that pushing the object to hash would store it as string. Thank you. I did vote, but my rep is too low to count."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 0, "last_activity_date": 1552483069, "creation_date": 1552483069, "answer_id": 55142828, "question_id": 55142515, "link": "https://stackoverflow.com/questions/55142515/ruby-accessing-procedurally-generated-objects/55142828#55142828", "title": "Ruby - Accessing procedurally generated objects", "body": "<p>You can use a <code>Hash</code> instead of an <code>Array</code> to store your instances and use the <code>vrm</code> as a key:</p>\n\n<pre><code># initialize the hash\ncars_by_vrm = {}\n\n# when creating the instances\n$all_vehicles.each do |a_vehicle|\n  car = Car.new(a_vehicle[1][0], a_vehicle[1][1], a_vehicle[1][3], a_vehicle[1][2], a_vehicle[0], a_vehicle[1][4])\n  cars_by_vrm[car.vrm] = car\nend\n\n# when you want to load a specific car later on\ncar = cars_by_vrm['some_vrm']\n</code></pre>\n\n<p>Note replace <code>cars_by_vrm</code> with a variable type or method that makes sense in your application. </p>\n"}], "owner": {"reputation": 81, "user_id": 10928405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14ed86a9772fbc1074edaa2ddcb427f?s=128&d=identicon&r=PG&f=1", "display_name": "Niall", "link": "https://stackoverflow.com/users/10928405/niall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 55142828, "answer_count": 1, "score": 0, "last_activity_date": 1552483069, "creation_date": 1552482070, "question_id": 55142515, "link": "https://stackoverflow.com/questions/55142515/ruby-accessing-procedurally-generated-objects", "title": "Ruby - Accessing procedurally generated objects", "body": "<p><strong>tldr: I am generating multiple similar objects at startup and want to be able to view, edit or otherwise manipulate each object. <em>How would you do this</em>?</strong></p>\n\n<p>the program I'm writing records vehicle details (make, model, colour, description, manufacture date and a registration number). Previously I was generating the objects and dumping the data into a global variable which I then used to search, edit and save. </p>\n\n<p>I am now trying to do away with this variable and interact directly with the objects.</p>\n\n<p>All tutorials I have seen seem to rely on a hardcoded variable when initiating an object. For example</p>\n\n<pre><code>class Paragraph\n\nattr_accessor :font, :size, :weight, :justification\n\nend\n\np = Paragraph.new\np.font = 'Times'\np.size = 14\np.weight = 300\np.justification = 'right'\n\nputs \"#{p.font}, #{p.size}, #{p.weight}, #{p.justification}\"\n# =&gt; Times, 14, 300, right\n</code></pre>\n\n<p>so you can just use p.whatever to call each field. \nIn my script I can't hardcode this as I have no idea how many objects are going to be created. This is the start of my script which loads previous records from a json and recreates the objects. </p>\n\n<pre><code>require 'json'\n\nclass Car\n attr_accessor :vrm\n attr_accessor :make\n attr_accessor :model\n attr_accessor :description\n attr_accessor :colour\n attr_accessor :date\n\ndef initialize(aMake, aModel, aDescription, aColour, aVRM, aManufactureDate)\n  @vrm = aVRM\n  @make = aMake\n  @model = aModel\n  @description = aDescription\n  @colour = aColour\n  @date = aManufactureDate\nend\n\ndef text_format\n  return \"Vehicle details: Reg number #{@vrm}, Make #{@make}, Model #{@model}, Description #{@description}, Colour: #{@colour},  Date #{@date}\"\nend\nend\n\ndef open_file\n if File.file?(\"vehicles.json\")\n   File.open('vehicles.json') do |f|\n   $all_vehicles = JSON.parse(f.read)\n end\n $all_vehicles.each do |a_vehicle|\n   Car.new(a_vehicle[1][0], a_vehicle[1][1], a_vehicle[1][3], a_vehicle[1][2], a_vehicle[0], a_vehicle[1][4])\n  end\n   count\n   p $vehicle_id\n else\n   p 'Unable to find file, creating blank file'\n   save_to_file\n end\nend\n</code></pre>\n\n<p>I can capture the object IDs in an array as it is created, but I can't see how to use that to call the object. </p>\n\n<pre><code>$all_vehicles.each do |a_vehicle|\n  file &lt;&lt; Car.new(a_vehicle[1][0], a_vehicle[1][1], a_vehicle[1][3], a_vehicle[1][2], a_vehicle[0], a_vehicle[1][4])\n  $vehicle_id &lt;&lt; file.object_id\nend\n</code></pre>\n\n<p>I would like to do something like this</p>\n\n<pre><code>def search\nlist_vehicles = all Car objects\n\nlist_vehicles.each do |vehicle|\ncompare vehicle with search criteria\n\nend\nend\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "sorting"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1552478334, "post_id": 55140877, "comment_id": 97022782, "body": "What about <code>[&quot;pending&quot;, 1]</code> \u2013 should it be removed because <code>&quot;pending&quot;</code> is not an element of <code>order_array</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1552504846, "post_id": 55140877, "comment_id": 97039804, "body": "RE <code>order_array[2]</code>:  chant, &quot; &#39;I&#39; before &#39;E&#39; except after &#39;C&#39; or when sounding like &#39;A&#39; in &#39;neighbor&#39; or &#39;weigh&#39; &quot;. (Exceptions exist.)"}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552477120, "post_id": 55141003, "comment_id": 97021994, "body": "That does not give what the OP wanted."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552477375, "post_id": 55141003, "comment_id": 97022164, "body": "Can see it&#39;s including <code>pending</code>, which I hadn&#39;t noticed was missing above @sawa. Your approach makes more sense if this is essential. Cheers for the comment."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552477440, "post_id": 55141003, "comment_id": 97022206, "body": "What is the output that you really wanted?"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552477645, "post_id": 55141003, "comment_id": 97022351, "body": "I think this fits with the OP&#39;s question? The output is added to my answer: it matches the required output, albeit with <code>[&quot;pending&quot;, 1]</code> bumped to the back of the array."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552477735, "post_id": 55141003, "comment_id": 97022400, "body": "As you have noted, <code>[&quot;pending&quot;, 1]</code> is added at the end, which the OP has not wanted (according to the question)."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552477824, "post_id": 55141003, "comment_id": 97022454, "body": "Yep, agree - I&#39;ve upvoted yours, and mentioned above I prefer your approach due to that. Overlooked the mistake ahead of your comment. This seems to fit Selim&#39;s requirements, although yours is definitely the correct one as per the question."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552483078, "post_id": 55141003, "comment_id": 97025913, "body": "Edited to include a working solution, which I think is pretty effective @SelimAlawwa."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1552500002, "post_id": 55141003, "comment_id": 97037298, "body": "Very good! Maybe you want to add the link to the benchmark directly in your answer."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1552505927, "post_id": 55141003, "comment_id": 97040300, "body": "@SRack, I noticed that the benchmark is on Ruby 2.5 environment, so, the last two methods from Sawa don&#39;t return the expected result. Tested on 2.6 are still a lot faster. I edited my post with a further option."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1552556032, "post_id": 55141003, "comment_id": 97057275, "body": "Thanks @iGian - I&#39;d tested the same on my machine with better results, though hadn&#39;t realised Repl.it was on 2.5. Appreciate the clarification."}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 4, "last_activity_date": 1552500276, "last_edit_date": 1552500276, "creation_date": 1552477071, "answer_id": 55141003, "question_id": 55140877, "link": "https://stackoverflow.com/questions/55140877/sort-an-array-of-arrays-based-on-the-order-in-another-array/55141003#55141003", "title": "Sort an array of arrays based on the order in another array", "body": "<p>You're almost there with this: <code>index</code> isn't working as you're comparing the full array, rather than the first element of it. This will work: </p>\n\n<pre><code>result = x.sort_by { |u| order_array.index(u[0]) || 100 }\n#=&gt; [[\"ready\", 5], [\"shipped\", 1], [\"scheduled\", 1], [\"delivered\", 23], [\"canceled\", 51], [\"refunded\", 1], [\"pending\", 1]]\n</code></pre>\n\n<p>Please note, the <code>100</code> is there to default to the back of the sort if the value isn't found in <code>order_array</code>.</p>\n\n<hr>\n\n<p><strong>Edit</strong> </p>\n\n<p>This was initially accepted, despite including <code>[\"pending\", 1]</code> suggesting it fit the requirements; however, here's a solution to avoid the unwanted entry, which also handles duplicates should the need arise.</p>\n\n<pre><code>order_array.each_with_object([]) { |ordered_by, array| array.push(*x.select { |item| item[0] == ordered_by }) }\n#=&gt; [[\"ready\", 5], [\"shipped\", 1], [\"scheduled\", 1], [\"delivered\", 23], [\"canceled\", 51], [\"refunded\", 1]]\n</code></pre>\n\n<p>Or, very fast though still allowing for duplicate values under each ordered item:</p>\n\n<pre><code>hash = x.each_with_object(Hash.new { |h,k| h[k] = [] }) { |item, h| h[item[0]] &lt;&lt; item[1] }\norder_array.flat_map { |key| [key, hash[key]] }\n</code></pre>\n\n<hr>\n\n<p><strong>Benchmark</strong></p>\n\n<p>Here's a benchmark for this scenario with a larger dataset: <a href=\"https://repl.it/repls/SentimentalAdequateClick\" rel=\"nofollow noreferrer\">https://repl.it/repls/SentimentalAdequateClick</a>. Looks like Sawa's methods lead the way, though my last effort works handily should there be duplicate values in future. Also, my second effort sucks (which surprised me a little) :)</p>\n"}, {"comments": [{"owner": {"reputation": 409, "user_id": 8863925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e99b5af75de208cba57edda978af54df?s=128&d=identicon&r=PG&f=1", "display_name": "Selim Alawwa", "link": "https://stackoverflow.com/users/8863925/selim-alawwa"}, "edited": false, "score": 0, "creation_date": 1552477320, "post_id": 55141008, "comment_id": 97022131, "body": "Thanks this works but @SRack solution is much simple."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552478656, "post_id": 55141008, "comment_id": 97022997, "body": "@Stefan Right. I implicitly assumed so."}, {"owner": {"reputation": 409, "user_id": 8863925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e99b5af75de208cba57edda978af54df?s=128&d=identicon&r=PG&f=1", "display_name": "Selim Alawwa", "link": "https://stackoverflow.com/users/8863925/selim-alawwa"}, "edited": false, "score": 1, "creation_date": 1552479347, "post_id": 55141008, "comment_id": 97023438, "body": "these is no duplicates.  second solution is also perfect!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1552479847, "post_id": 55141008, "comment_id": 97023798, "body": "Nice, I didn&#39;t know that 2.6 added a block variant for <code>to_h</code>. That voids my above comment."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1552480161, "post_id": 55141008, "comment_id": 97024000, "body": "@Stefan It was according to my request."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 5, "last_activity_date": 1552479647, "last_edit_date": 1552479647, "creation_date": 1552477077, "answer_id": 55141008, "question_id": 55140877, "link": "https://stackoverflow.com/questions/55140877/sort-an-array-of-arrays-based-on-the-order-in-another-array/55141008#55141008", "title": "Sort an array of arrays based on the order in another array", "body": "<pre><code>h = x.to_h\n# =&gt; {\"ready\"=&gt;5,\n# \"shipped\"=&gt;1,\n# \"pending\"=&gt;1,\n# \"refunded\"=&gt;1,\n# \"delivered\"=&gt;23,\n# \"scheduled\"=&gt;1,\n# \"canceled\"=&gt;51}\n\norder_array.map{|key| [key, h[key]] if h.key?(key)}.compact\n# =&gt; [[\"ready\", 5],\n# [\"shipped\", 1],\n# [\"scheduled\", 1],\n# [\"delivered\", 23],\n# [\"canceled\", 51],\n# [\"refunded\", 1]]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>h = x.to_h{|k, v| [k, [k, v]]}\n#=&gt; {\"ready\"=&gt;[\"ready\", 5],\n# \"shipped\"=&gt;[\"shipped\", 1],\n# \"pending\"=&gt;[\"pending\", 1],\n# \"refunded\"=&gt;[\"refunded\", 1],\n# \"delivered\"=&gt;[\"delivered\", 23],\n# \"scheduled\"=&gt;[\"scheduled\", 1],\n# \"canceled\"=&gt;[\"canceled\", 51]}\n\norder_array.map{|k| h[k]}.compact\n#=&gt; [[\"ready\", 5],\n# [\"shipped\", 1],\n# [\"scheduled\", 1],\n# [\"delivered\", 23],\n# [\"canceled\", 51],\n# [\"refunded\", 1]]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>h = x.to_h{|k, v| [k, [k, v]]}\n#=&gt; {\"ready\"=&gt;[\"ready\", 5],\n# \"shipped\"=&gt;[\"shipped\", 1],\n# \"pending\"=&gt;[\"pending\", 1],\n# \"refunded\"=&gt;[\"refunded\", 1],\n# \"delivered\"=&gt;[\"delivered\", 23],\n# \"scheduled\"=&gt;[\"scheduled\", 1],\n# \"canceled\"=&gt;[\"canceled\", 51]}\n\nh.values_at(*order_array).compact\n#=&gt; [[\"ready\", 5],\n# [\"shipped\", 1],\n# [\"scheduled\", 1],\n# [\"delivered\", 23],\n# [\"canceled\", 51],\n# [\"refunded\", 1]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1552478286, "post_id": 55141318, "comment_id": 97022739, "body": "This was my thought as an edit for mine when I realised my mistake, though it&#39;s more complex that @sawa&#39;s answer, so didn&#39;t think it worthwhile. Still pretty readable though."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1552479993, "post_id": 55141318, "comment_id": 97023894, "body": "I found it looping 2 times (increasing complexity) and also <code>index</code> is quite slow in case of large array."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1552492059, "post_id": 55141318, "comment_id": 97032468, "body": "@ray, actually the benchmark surprised me. Maybe you can double check? I considered the array to be small in for te OP case."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1552497308, "post_id": 55141318, "comment_id": 97035848, "body": "@iGian credit where it&#39;s due - this does outperform both Ray&#39;s and my second answer, even as it scales. I&#39;ve benchmarked with a larger dataset (<a href=\"https://repl.it/repls/SentimentalAdequateClick\" rel=\"nofollow noreferrer\">here</a>) and it&#39;s basically possible to conclude Sawa is king :)"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 2, "last_activity_date": 1552505776, "last_edit_date": 1552505776, "creation_date": 1552478113, "answer_id": 55141318, "question_id": 55140877, "link": "https://stackoverflow.com/questions/55140877/sort-an-array-of-arrays-based-on-the-order-in-another-array/55141318#55141318", "title": "Sort an array of arrays based on the order in another array", "body": "<p>I'd suggest</p>\n\n<pre><code>x.keep_if { |e| order_array.include? e[0] }.sort_by { |e| order_array.index(e[0]) }\n</code></pre>\n\n<p>Since some values are not elements of <code>order_array</code>, for example <code>\"pending\"</code>.</p>\n\n<pre><code>#=&gt; [[\"ready\", 5], [\"shipped\", 1], [\"scheduled\", 1], [\"delivered\", 23], [\"canceled\", 51], [\"refunded\", 1]]\n</code></pre>\n\n<p><hr>\nBenchmarked the answers up to now <code>500.times</code>:</p>\n\n<pre><code>#        user       system     total       real\n# sawa   0.006698   0.000132   0.006830 (  0.006996) # on the first method\n# ray    0.005543   0.000123   0.005666 (  0.005770)\n# igian  0.001923   0.000003   0.001926 (  0.001927)\n# srack  0.005270   0.000168   0.005438 (  0.005540) # on the last method\n</code></pre>\n\n<p><hr>\nJust for fun I tried to find a faster method for Ruby 2.5:</p>\n\n<pre><code>xx = x.to_h # less than Ruby 2.6\norder_array.each.with_object([]) { |k, res| res &lt;&lt; [k, xx[k]] if xx.has_key? k }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 1, "last_activity_date": 1552479822, "creation_date": 1552479822, "answer_id": 55141834, "question_id": 55140877, "link": "https://stackoverflow.com/questions/55140877/sort-an-array-of-arrays-based-on-the-order-in-another-array/55141834#55141834", "title": "Sort an array of arrays based on the order in another array", "body": "<p>You can try below code to find output efficiently,</p>\n\n<pre><code>order_array.map { |p| x.detect { |y| y[0] == p } }.compact\n# =&gt; [[\"ready\", 5], [\"shipped\", 1], [\"scheduled\", 1], [\"delivered\", 23], [\"canceled\", 51], [\"refunded\", 1]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1552492292, "post_id": 55145827, "comment_id": 97032640, "body": "Never seen nor heard of <code>assoc</code> before - +1 for bringing it into my life :) Great answer."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1552500139, "post_id": 55145827, "comment_id": 97037363, "body": "You know that hash is faster :) <a href=\"https://stackoverflow.com/a/5552062/5239030\">stackoverflow.com/a/5552062/5239030</a>"}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 4, "last_activity_date": 1552491606, "creation_date": 1552491606, "answer_id": 55145827, "question_id": 55140877, "link": "https://stackoverflow.com/questions/55140877/sort-an-array-of-arrays-based-on-the-order-in-another-array/55145827#55145827", "title": "Sort an array of arrays based on the order in another array", "body": "<p><a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-assoc\" rel=\"nofollow noreferrer\">assoc</a> seems helpful: \"Searches through an array whose elements are also arrays comparing obj with the first element of each contained array using obj.==.\"</p>\n\n<pre><code>order_array.map{|e| x.assoc(e) }.compact\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1552515119, "last_edit_date": 1552515119, "creation_date": 1552514254, "answer_id": 55151801, "question_id": 55140877, "link": "https://stackoverflow.com/questions/55140877/sort-an-array-of-arrays-based-on-the-order-in-another-array/55151801#55151801", "title": "Sort an array of arrays based on the order in another array", "body": "<p>I've assumed:</p>\n\n<ul>\n<li>the first element of each element of <code>x</code> is not necessarily unique;</li>\n<li>all elements of <code>x</code> whose first element is the same and whose first element is a member of <code>order_array</code> appear consecutively in the returned (sorted) array in the order in which those elements appear in <code>x</code>;</li>\n<li>any elements of <code>x</code> whose first element is not a member of <code>order_array</code> appears in the returned (sorted) array after all elements whose first element is in <code>sorted_array</code>, and all such elements appear in the returned array (at the end) in the order in which they occur in <code>x</code>; and</li>\n<li>efficiency is paramount.</li>\n</ul>\n\n<h1><p></p></h1>\n\n<pre><code>x = [\n  [\"ready\", 5], [\"shipped\", 1], [\"pending\", 1], [\"refunded\", 1], [\"originated\", 3],\n  [\"delivered\", 23], [\"scheduled\", 1], [\"ready\", 8], [\"canceled\", 51]\n]\n\norder_array = [\n  \"ready\", \"in_progress\", \"received\", \"shipped\", \"scheduled\", \"pick_up\",\n  \"delivered\", \"canceled\", \"failed\", \"refunded\", \"refund_failed\"\n]\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>order_pos = order_array.each_with_object({}) { |word,h| h[word] = [] }\n  #=&gt; {\"ready\"=&gt;[], \"in_progress\"=&gt;[], \"received\"=&gt;[], \"shipped\"=&gt;[],\n  #    \"scheduled\"=&gt;[], \"pick_up\"=&gt;[], \"delivered\"=&gt;[], \"canceled\"=&gt;[],\n  #    \"failed\"=&gt;[], \"refunded\"=&gt;[], \"refund_failed\"=&gt;[]} \nback = x.each_with_index.with_object([]) { |((word,v),i),back|\n  order_pos.key?(word) ? (order_pos[word] &lt;&lt; i) : back &lt;&lt; [word,v] }\n  #=&gt; [[\"pending\", 1], [\"originated\", 3]] \norder_pos.flat_map { |word,offsets| offsets.map { |i| x[i] } }.concat(back)\n  #=&gt; [[\"ready\", 5], [\"ready\", 8], [\"shipped\", 1], [\"scheduled\", 1],\n  #    [\"delivered\", 23], [\"canceled\", 51], [\"refunded\", 1], [\"pending\", 1],\n  #    [\"originated\", 3]] \n</code></pre>\n\n<p>Note:</p>\n\n<pre><code>order_pos\n  #=&gt; {\"ready\"=&gt;[0, 7], \"in_progress\"=&gt;[], \"received\"=&gt;[], \"shipped\"=&gt;[1],\n  #    \"scheduled\"=&gt;[6], \"pick_up\"==&gt;[], \"delivered\"=&gt;[5], \"canceled\"=&gt;[8],\n  #    \"failed\"=&gt;[], \"refunded\"=&gt;[3], \"refund_failed\"=&gt;[]} \n</code></pre>\n\n<p>It is necessary to initialise <code>order_pos</code> in order for its keys to be ordered by <code>order_arr</code>. This is an example of the worth of a controversial change made in Ruby 1.9 which guaranteed that hash keys will remain in key-insertion order.</p>\n"}], "owner": {"reputation": 409, "user_id": 8863925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e99b5af75de208cba57edda978af54df?s=128&d=identicon&r=PG&f=1", "display_name": "Selim Alawwa", "link": "https://stackoverflow.com/users/8863925/selim-alawwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 55141008, "answer_count": 6, "score": 0, "last_activity_date": 1552515119, "creation_date": 1552476625, "last_edit_date": 1552477342, "question_id": 55140877, "link": "https://stackoverflow.com/questions/55140877/sort-an-array-of-arrays-based-on-the-order-in-another-array", "title": "Sort an array of arrays based on the order in another array", "body": "<p>I have an array of arrays:</p>\n\n<pre><code>x = [\n  [\"ready\", 5], [\"shipped\", 1], [\"pending\", 1], [\"refunded\", 1],\n  [\"delivered\", 23], [\"scheduled\", 1], [\"canceled\", 51]\n]\n</code></pre>\n\n<p>My sorting array is </p>\n\n<pre><code>order_array = [\n  \"ready\", \"in_progress\", \"recieved\", \"shipped\", \"scheduled\", \"pick_up\",\n \"delivered\", \"canceled\", \"failed\", \"refunded\", \"refund_failed\"\n]\n</code></pre>\n\n<p>I need to order <code>x</code> based on the value of the first element in each subarray. The required sorted array is:</p>\n\n<pre><code>[\n  [\"ready\", 5], [\"shipped\", 1], [\"scheduled\", 1], [\"delivered\", 23],\n  [\"canceled\", 51], [\"refunded\", 1]\n]\n</code></pre>\n\n<p>Using <code>sort_by</code> doesn't result in the required sorting, it leads to the same array.</p>\n\n<pre><code>result = x.sort_by {|u| order_array.index(u)}\n# =&gt; [\n#      [\"ready\", 5], [\"shipped\", 1], [\"pending\", 1], [\"refunded\", 1],\n#      [\"delivered\", 23], [\"scheduled\", 1], [\"canceled\", 51]\n# ]\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 9718, "user_id": 8186898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0cEU.jpg?s=128&g=1", "display_name": "Nino Filiu", "link": "https://stackoverflow.com/users/8186898/nino-filiu"}, "edited": false, "score": 2, "creation_date": 1552476010, "post_id": 55140475, "comment_id": 97021343, "body": "Please <a href=\"https://stackoverflow.com/questions/55140475/edit\">edit your question</a> so as to include your code as text instead of an image."}, {"owner": {"reputation": 1141, "user_id": 1404905, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/IYSNE.jpg?s=128&g=1", "display_name": "beniutek", "link": "https://stackoverflow.com/users/1404905/beniutek"}, "edited": false, "score": 0, "creation_date": 1552476042, "post_id": 55140475, "comment_id": 97021359, "body": "Your thinking seems right regarding this challenge. Do you already have a piece of code that is not working? Please paste it so that we have something to work on"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552478103, "post_id": 55140475, "comment_id": 97022617, "body": "Write the question here. Do not expect the reader to follow the link for you."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1552478391, "post_id": 55140475, "comment_id": 97022813, "body": "If it&#39;s a tutorial with a challenge, then usually everything you need to know to solve it is in the previous chapters. Try re-reading those, it should help."}, {"owner": {"reputation": 351, "user_id": 11196706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f06fbb48577defe7d7b222b6a05a98f?s=128&d=identicon&r=PG&f=1", "display_name": "juemura7", "link": "https://stackoverflow.com/users/11196706/juemura7"}, "edited": false, "score": 0, "creation_date": 1552478707, "post_id": 55140475, "comment_id": 97023037, "body": "Thanks guys - sorry first ever post on Stack Overflow ever so tried to post the question in the neatest  way but have edited it to remove the image :)"}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 1, "creation_date": 1552482528, "post_id": 55140475, "comment_id": 97025509, "body": "Do not put your code in a comment.  If you read the help section for the site, you&#39;ll see that it is a requirement to put your code in the question itself.  Please edit the question and delete the comment containing the code."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552478562, "post_id": 55141095, "comment_id": 97022918, "body": "<code>String#*</code> is cool and all, but calling <code>print</code> in a loop would be more within means of a complete beginner."}, {"owner": {"reputation": 351, "user_id": 11196706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f06fbb48577defe7d7b222b6a05a98f?s=128&d=identicon&r=PG&f=1", "display_name": "juemura7", "link": "https://stackoverflow.com/users/11196706/juemura7"}, "edited": false, "score": 1, "creation_date": 1552478757, "post_id": 55141095, "comment_id": 97023067, "body": "Thank you so much ashmaroli, that has really helped! :)"}, {"owner": {"reputation": 4449, "user_id": 7681659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bc1a3b7231505d61b7f80642bc1a14?s=128&d=identicon&r=PG&f=1", "display_name": "ashmaroli", "link": "https://stackoverflow.com/users/7681659/ashmaroli"}, "edited": false, "score": 0, "creation_date": 1552479219, "post_id": 55141095, "comment_id": 97023365, "body": "There&#39;s more than one way to do things in Ruby. The joy lies in learning the game and then the tricks."}], "tags": [], "owner": {"reputation": 4449, "user_id": 7681659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bc1a3b7231505d61b7f80642bc1a14?s=128&d=identicon&r=PG&f=1", "display_name": "ashmaroli", "link": "https://stackoverflow.com/users/7681659/ashmaroli"}, "is_accepted": false, "score": 2, "last_activity_date": 1552478135, "last_edit_date": 1552478135, "creation_date": 1552477390, "answer_id": 55141095, "question_id": 55140475, "link": "https://stackoverflow.com/questions/55140475/simple-bar-graph-challenge-using-arrays/55141095#55141095", "title": "Simple bar graph challenge using arrays", "body": "<p>Since this a challenge, I will not give you the answer explicitly but rather some clues which will help you in solving the challenge.</p>\n\n<p>To start with, your program accepts a <em>comma separated value</em> string:</p>\n\n<pre><code>10,4,2,7,5,1\n</code></pre>\n\n<p>This can be converted into an array of elements by using the <code>String#split</code> method and then converting each element to an integer by calling <code>String#to_i</code> on each element.</p>\n\n<pre><code>array = '10,4,2,7,5,1'.split(',')\narray.map! { |item| item.to_i }\n</code></pre>\n\n<p>The above two steps will give you an <em>array of numbers</em>.</p>\n\n<p>Calling <code>each</code> on the array will let you <em>iterate</em> through the array passing a num to a block given to the <code>each</code> method:</p>\n\n<pre><code>array.each do |num|\n  # print_dashes(num)\nend\n</code></pre>\n\n<p>Printing dashes is easy. There are two simple methods available to print objects to your terminal: <code>print</code> and <code>puts</code>\nEvery call to <code>print x</code> will print <code>x</code> <em>on the same line</em>\nEvery call to <code>puts x</code> will print <code>x</code> <em>on a new line</em></p>\n\n<p>A string can be multiplied to extend itself. For example:</p>\n\n<pre><code>dashes = '-' * 10\nprint(dashes)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 2, "creation_date": 1552482677, "post_id": 55141570, "comment_id": 97025621, "body": "With no explanation?  That&#39;s a lot for a beginner to unpack."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": -1, "last_activity_date": 1552478952, "creation_date": 1552478952, "answer_id": 55141570, "question_id": 55140475, "link": "https://stackoverflow.com/questions/55140475/simple-bar-graph-challenge-using-arrays/55141570#55141570", "title": "Simple bar graph challenge using arrays", "body": "<pre><code>gets.split(\",\"){|x| puts \"-\" * Integer(x, exception: false)}\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 11196706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f06fbb48577defe7d7b222b6a05a98f?s=128&d=identicon&r=PG&f=1", "display_name": "juemura7", "link": "https://stackoverflow.com/users/11196706/juemura7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1552478952, "creation_date": 1552475359, "last_edit_date": 1552478432, "question_id": 55140475, "link": "https://stackoverflow.com/questions/55140475/simple-bar-graph-challenge-using-arrays", "title": "Simple bar graph challenge using arrays", "body": "<p>I am trying to solve the following challenge, which is to create a bar graph program:</p>\n\n<p>\"Write a program that draws bar graphs. It should:\n 1. Ask the user for a list of numbers. The user enters them separated by commas, e.g. 10,4,2,7,5,1.\n 2. Print a horizontal bar graph of the numbers in order. \n 3. Bars should be made up of '-'</p>\n\n<p>For example</p>\n\n<pre><code>10,4,2,7\n----------\n----\n--\n-------\n</code></pre>\n\n<p>Note: you can assume the user will only enter integers separated by commas with no spaces.\" </p>\n\n<p>This is a challenge that comes as part of a tutorial on Arrays, so I think that the aim is to use an array.</p>\n\n<p>My thinking is to convert the user's input into an array, iterate over each number and print the corresponding number of dashes for each number. I can't work out how to do this however. Any advice would be appreciated.</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552473650, "post_id": 55139894, "comment_id": 97019942, "body": "Your <code>Langs</code> is invalid."}], "answers": [{"comments": [{"owner": {"reputation": 2138, "user_id": 1377879, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/88ed0b98e028557cf987548411d8138c?s=128&d=identicon&r=PG", "display_name": "Bolo", "link": "https://stackoverflow.com/users/1377879/bolo"}, "edited": false, "score": 0, "creation_date": 1552484264, "post_id": 55140196, "comment_id": 97026762, "body": "filename can be &#39;fr-ca-test.png&#39; or test-&#39;fr-ca.png&#39; or &#39;blalb-fr-CA-bllb.png&#39;"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 2138, "user_id": 1377879, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/88ed0b98e028557cf987548411d8138c?s=128&d=identicon&r=PG", "display_name": "Bolo", "link": "https://stackoverflow.com/users/1377879/bolo"}, "edited": false, "score": 1, "creation_date": 1552484507, "post_id": 55140196, "comment_id": 97026935, "body": "You might want to use <code>include?</code> instead of <code>start_with?</code> in that case. Furthermore, make sure that your <code>LANGUAGES</code> array is sorted from the most specific to less specific code because <code>find</code> returned the first match."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1552484341, "last_edit_date": 1552484341, "creation_date": 1552474539, "answer_id": 55140196, "question_id": 55139894, "link": "https://stackoverflow.com/questions/55139894/regex-to-extract-iso-code-in-a-string-in-ruby/55140196#55140196", "title": "Regex to extract iso code in a string in ruby", "body": "<p>I wouldn't use a regexp in this simple example. Using <code>start_with?</code> will very likely be faster and IMHO it is easier to read and to understand:</p>\n\n<pre><code>image_basename = 'fr-ca-test.png'\nLANGUAGES = ['fr-CA', 'en-CA', 'ca']\n\nLANGUAGES.find { |code| image_basename.start_with?(code.downcase) }\n#=&gt; \"fr-CA\"\n</code></pre>\n"}], "owner": {"reputation": 2138, "user_id": 1377879, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/88ed0b98e028557cf987548411d8138c?s=128&d=identicon&r=PG", "display_name": "Bolo", "link": "https://stackoverflow.com/users/1377879/bolo"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1552486273, "accepted_answer_id": 55140196, "answer_count": 1, "score": -2, "last_activity_date": 1552486320, "creation_date": 1552473585, "last_edit_date": 1552486320, "question_id": 55139894, "link": "https://stackoverflow.com/questions/55139894/regex-to-extract-iso-code-in-a-string-in-ruby", "closed_reason": "Duplicate", "title": "Regex to extract iso code in a string in ruby", "body": "<pre><code>image_basename = 'fr-ca-test.png'\n\nLangs = {'ca', 'fr-CA', 'en-CA'}\n\nLangs.each do |locale_code|\n  return locale_code /(\\b|\\_|-)#{locale_code}(\\b|\\_|-)/i.match(image_basename)\n\n  end\nend\n</code></pre>\n\n<p>When the filename contains fr-CA or en-CA. I would like to returns fr-CA not Ca.</p>\n\n<p>How I can fix my regex?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "vue.js", "cross-domain", "axios"], "comments": [{"owner": {"reputation": 2659, "user_id": 483133, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NcB9j.jpg?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/483133/phil"}, "edited": false, "score": 0, "creation_date": 1552479688, "post_id": 55137752, "comment_id": 97023677, "body": "Have you tried calling  <a href=\"http://localhost:3000/foo.json\" rel=\"nofollow noreferrer\">localhost:3000/foo.json</a> to force the request to use the JSON variant (rather than relying on the header)?"}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 11175176, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3TLMQ2M_Y9w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3red0iDgbXQ1ZujXwg38HYEc4oOM9w/mo/photo.jpg?sz=128", "display_name": "tcharlyson", "link": "https://stackoverflow.com/users/11175176/tcharlyson"}, "is_accepted": true, "score": 3, "last_activity_date": 1552468867, "creation_date": 1552468867, "answer_id": 55138208, "question_id": 55137752, "link": "https://stackoverflow.com/questions/55137752/rails-5-2-returning-406-with-axios-request/55138208#55138208", "title": "Rails 5.2 returning 406 with Axios Request", "body": "<p>I think your problem comes from your view, do you have a file named index.html.erb. Otherwise, you can define multiple response format as following : </p>\n\n<pre><code>class FooController &lt; ApplicationController\n\ndef index\n  @foo = foo.all\n  respond_to do |format|\n    format.html { render :index }\n    format.json { render json: @foo, status: 200 }\n  end\nend\n\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1564, "user_id": 1200678, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/26517746a2cc28508d790cb7106374ff?s=128&d=identicon&r=PG", "display_name": "Steffan Perry", "link": "https://stackoverflow.com/users/1200678/steffan-perry"}, "is_accepted": false, "score": 0, "last_activity_date": 1578290321, "creation_date": 1578290321, "answer_id": 59607339, "question_id": 55137752, "link": "https://stackoverflow.com/questions/55137752/rails-5-2-returning-406-with-axios-request/59607339#59607339", "title": "Rails 5.2 returning 406 with Axios Request", "body": "<p>I was having the exact same issue. Everything worked perfectly in my specs and in postman, but for some reason I was getting a 406 with vue/axios.</p>\n\n<p>After much hair pulling I discovered a typo in my routes file:</p>\n\n<pre><code>namespace :v1, default: { format: :json } do\n</code></pre>\n\n<p>It should have been defaults (plural)</p>\n\n<pre><code>namespace :v1, defaults: { format: :json } do\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9613337, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "adrilef", "link": "https://stackoverflow.com/users/9613337/adrilef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "accepted_answer_id": 55138208, "answer_count": 2, "score": 2, "last_activity_date": 1578290321, "creation_date": 1552467310, "last_edit_date": 1552477237, "question_id": 55137752, "link": "https://stackoverflow.com/questions/55137752/rails-5-2-returning-406-with-axios-request", "title": "Rails 5.2 returning 406 with Axios Request", "body": "<p>I have a rails API in Rails 5.2 and a frontend in Vuejs, using Axios to request API.\nWhen I request with postman on route </p>\n\n<blockquote>\n  <p>[GET] <a href=\"http://localhost:3000/foo\" rel=\"nofollow noreferrer\">http://localhost:3000/foo</a></p>\n</blockquote>\n\n<p>I get the expected JSON response.</p>\n\n<p>But when I request with Axios :</p>\n\n<pre><code>import axios from 'axios'\n\nexport default {\n  getAll () {\n    return axios.get('http://localhost:3000/foo', {\n      headers: { 'Content-Type': 'application/json' }\n    })\n  }\n}\n</code></pre>\n\n<p>I got this response from the server :</p>\n\n<blockquote>\n  <p>CleanwalksController#index is missing a template for this request format and variant. request.formats: [\"text/html\"] request.variant: []</p>\n</blockquote>\n\n<p>I have the following config/cors.rb :</p>\n\n<pre><code>Rails.application.config.middleware.insert_before 0, Rack::Cors do\n  allow do\n    origins '*'\n    resource '*',\n      headers: :any,\n      methods: [:get, :post, :put, :patch, :delete, :options, :head]\n  end\nend\n</code></pre>\n\n<p>I got the same issue when I try to access to <strong><a href=\"http://localhost:3000/foo\" rel=\"nofollow noreferrer\">http://localhost:3000/foo</a></strong> directly.</p>\n\n<p>Here is my controller :</p>\n\n<pre><code>class FooController &lt; ApplicationController\n\n  def index\n    @foo = foo.all\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ios", "ruby-on-rails", "ruby", "jwt"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552467496, "post_id": 55137700, "comment_id": 97015980, "body": "<code>ec_key</code> should be an instance of <a href=\"https://ruby-doc.org/stdlib-2.6.1/libdoc/openssl/rdoc/OpenSSL/PKey/EC.html\" rel=\"nofollow noreferrer\"><code>OpenSSL::PKey::EC</code></a>, not a string (the former responds to <a href=\"https://ruby-doc.org/stdlib-2.6.1/libdoc/openssl/rdoc/OpenSSL/PKey/EC.html#method-i-group\" rel=\"nofollow noreferrer\"><code>group</code></a>, the latter does not)"}, {"owner": {"reputation": 59, "user_id": 6903761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ccfad1521f49b1a2781193665abc55?s=128&d=identicon&r=PG&f=1", "display_name": "megamind79", "link": "https://stackoverflow.com/users/6903761/megamind79"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552468343, "post_id": 55137700, "comment_id": 97016495, "body": "I tried to create ec_key like this : OpenSSL::PKey::EC.new(private_key_string), but I&#39;m getting this error - OpenSSL::PKey::ECError: unknown curve name (private_key_string)"}], "owner": {"reputation": 59, "user_id": 6903761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ccfad1521f49b1a2781193665abc55?s=128&d=identicon&r=PG&f=1", "display_name": "megamind79", "link": "https://stackoverflow.com/users/6903761/megamind79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552467632, "creation_date": 1552467070, "last_edit_date": 1552467632, "question_id": 55137700, "link": "https://stackoverflow.com/questions/55137700/unable-to-create-a-jwt-token-with-es256", "title": "Unable to create a JWT token with ES256", "body": "<p>I'm unable to create a token with ES256 to call device_check api in apple documentation.</p>\n\n<p>I'm using ruby-2.2.3</p>\n\n<pre><code>jwt_token = JWT.encode({iss: team_id, iat: Time.now.to_i}, ec_key, 'ES256', {kid: key_id})\n</code></pre>\n\n<p>But I'm getting this error</p>\n\n<pre><code>NoMethodError: undefined method `group' for #&lt;String:0x007..&gt;\nfrom ~/.rvm/gems/ruby-2.2.3/gems/jwt-1.5.1/lib/jwt.rb:49:in `sign_ecdsa'\n</code></pre>\n\n<p>But this works fine with another encryption say HS256</p>\n\n<p>Can someone please help me with creating this token with ES256</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1552467023, "post_id": 55137632, "comment_id": 97015710, "body": "See <a href=\"https://stackoverflow.com/questions/2030336/how-do-i-create-a-hash-in-ruby-that-compares-strings-ignoring-case\">How do I create a hash in Ruby that compares strings, ignoring case?</a>"}, {"owner": {"reputation": 2486, "user_id": 3149988, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e372b773ea8ee0931b8173763e0b758d?s=128&d=identicon&r=PG&f=1", "display_name": "echan00", "link": "https://stackoverflow.com/users/3149988/echan00"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1552467826, "post_id": 55137632, "comment_id": 97016192, "body": "@WiktorStribi\u017cI think this is a possible solution but it doesn&#39;t seem to work with gsub and rewriting more of the hash class seems like a bad idea"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1552468027, "post_id": 55137632, "comment_id": 97016304, "body": "See the second answer. <code>&quot;12 aaa aAa AAA aaaword ddd&quot;.gsub(regexp) { | x | dict_texts[x.downcase] }</code>. This will work as your keys are all in lower case."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1552468423, "post_id": 55137632, "comment_id": 97016551, "body": "BTW, wrapping a regex literal in a <code>Regexp.new</code> call is superfluous. It&#39;s like writing <code>String.new(&quot;foo&quot;)</code> instead of just <code>&quot;foo&quot;</code>."}, {"owner": {"reputation": 2486, "user_id": 3149988, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e372b773ea8ee0931b8173763e0b758d?s=128&d=identicon&r=PG&f=1", "display_name": "echan00", "link": "https://stackoverflow.com/users/3149988/echan00"}, "edited": false, "score": 0, "creation_date": 1552469106, "post_id": 55137632, "comment_id": 97016991, "body": "I think it does matter, doesn&#39;t it? Without the wrapping, &quot;cloudaaa&quot; becomes &quot;cloudaaa&quot; which is good (i&#39;m not sure why it doesn&#39;t work for &quot;aaacloud&quot; -&gt; &quot;bBbcloud&quot; though)"}, {"owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "edited": false, "score": 0, "creation_date": 1552469417, "post_id": 55137632, "comment_id": 97017170, "body": "@echan00 It works correctly in my environment. Could you provide a concrete example?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552469432, "post_id": 55137632, "comment_id": 97017182, "body": "@echan00 <code>regexp == Regexp.new(regexp) #=&gt; true</code> \u2013 must be something else."}, {"owner": {"reputation": 2486, "user_id": 3149988, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e372b773ea8ee0931b8173763e0b758d?s=128&d=identicon&r=PG&f=1", "display_name": "echan00", "link": "https://stackoverflow.com/users/3149988/echan00"}, "edited": false, "score": 0, "creation_date": 1552470132, "post_id": 55137632, "comment_id": 97017671, "body": "Yes, it is my error, thank you all for your help!"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552471407, "post_id": 55137632, "comment_id": 97018523, "body": "There is no such thing as <code>Regex</code> or <code>Regex.union</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2486, "user_id": 3149988, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e372b773ea8ee0931b8173763e0b758d?s=128&d=identicon&r=PG&f=1", "display_name": "echan00", "link": "https://stackoverflow.com/users/3149988/echan00"}, "edited": false, "score": 0, "creation_date": 1552468810, "post_id": 55138031, "comment_id": 97016811, "body": "&quot;AAAword&quot;.gsub(regexp, dict_texts) results in &quot;bBbword&quot; and &quot;wordAAA&quot;.gsub(regexp, dict_texts) resuts in &quot;wordAAA&quot;, would you know why?"}, {"owner": {"reputation": 2486, "user_id": 3149988, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e372b773ea8ee0931b8173763e0b758d?s=128&d=identicon&r=PG&f=1", "display_name": "echan00", "link": "https://stackoverflow.com/users/3149988/echan00"}, "edited": false, "score": 0, "creation_date": 1552468897, "post_id": 55138031, "comment_id": 97016868, "body": "Preferably, I want &quot;wordAAA&quot; in both cases"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 2486, "user_id": 3149988, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e372b773ea8ee0931b8173763e0b758d?s=128&d=identicon&r=PG&f=1", "display_name": "echan00", "link": "https://stackoverflow.com/users/3149988/echan00"}, "edited": false, "score": 1, "creation_date": 1552469354, "post_id": 55138031, "comment_id": 97017138, "body": "@echan00 your example regexp <code>&#47;\\b(?:aaa|ccc)\\b&#47;ix</code> won&#39;t match either of these because of the word boundaries <code>\\b</code>."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 2, "last_activity_date": 1552468223, "creation_date": 1552468223, "answer_id": 55138031, "question_id": 55137632, "link": "https://stackoverflow.com/questions/55137632/regex-with-regex-union-but-case-insensitive-gsub-find-and-replace/55138031#55138031", "title": "Regex with Regex.union but case insensitive gsub find and replace", "body": "<p>Either pass a block to <code>gsub</code> to <a href=\"http://ruby-doc.org/core-2.6.1/String.html#method-i-downcase\" rel=\"nofollow noreferrer\"><code>downcase</code></a> the key: (given that all hash keys are lowercase)</p>\n\n<pre><code>\"12 aaa aAa AAA aaaword ddd\".gsub(regexp) { |s| dict_texts[s.downcase] }\n#=&gt; \"12 bBb bBb bBb aaaword ddd\"\n</code></pre>\n\n<p>Or use a hash with a <a href=\"http://ruby-doc.org/core-2.6.1/Hash.html#method-i-default_proc-3D\" rel=\"nofollow noreferrer\"><code>default_proc</code></a> which does this for you:</p>\n\n<pre><code>dict_texts.default_proc = -&gt;(h, k) { h.fetch(k.downcase, nil) }\n\n\"12 aaa aAa AAA aaaword ddd\".gsub(regexp, dict_texts)\n#=&gt; \"12 bBb bBb bBb aaaword ddd\"\n</code></pre>\n"}], "owner": {"reputation": 2486, "user_id": 3149988, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e372b773ea8ee0931b8173763e0b758d?s=128&d=identicon&r=PG&f=1", "display_name": "echan00", "link": "https://stackoverflow.com/users/3149988/echan00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 55138031, "answer_count": 1, "score": -2, "last_activity_date": 1552471375, "creation_date": 1552466837, "last_edit_date": 1552471375, "question_id": 55137632, "link": "https://stackoverflow.com/questions/55137632/regex-with-regex-union-but-case-insensitive-gsub-find-and-replace", "title": "Regex with Regex.union but case insensitive gsub find and replace", "body": "<p>I am trying to do a case-insensitive word-based 'find and replace' on a string. I have this:</p>\n\n<pre><code>string = \"12 aaa aAa AAA aaaword ddd\"\ndict_texts = {\"aaa\" =&gt; \"bBb\", \"ccc\" =&gt; \"dDd\"}\n</code></pre>\n\n<p>I want this:</p>\n\n<pre><code>\"12 bBb b8b b8b aaaword ddd\"\n</code></pre>\n\n<p>I did this:</p>\n\n<pre><code>regexp = /\\b(?:#{ Regexp.union(dict_texts.keys).source })\\b/ix\n#=&gt; /\\b(?:aaa|ccc)\\b/ix\nstring.gsub(regexp, dict_texts)\n#=&gt; \"12 bBb   aaaword ddd\"\n</code></pre>\n\n<p>I'm pretty close. but still having some trouble.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routing"], "comments": [{"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552464908, "post_id": 55136799, "comment_id": 97014597, "body": "Can you please show us the output of <code>rails routes</code> with the <code>rubizza_promo_pages_path</code> line?"}, {"owner": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "reply_to_user": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552465399, "post_id": 55136799, "comment_id": 97014833, "body": "updated queston body"}], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "edited": false, "score": 0, "creation_date": 1552465330, "post_id": 55137150, "comment_id": 97014797, "body": "Thanks, but this methods very many + I thought to implement it by means of routing"}], "tags": [], "owner": {"reputation": 909, "user_id": 9534861, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HEqJQasw6sM/AAAAAAAAAAI/AAAAAAAABHA/HiEIzDPH-l0/photo.jpg?sz=128", "display_name": "Saqib Shahzad", "link": "https://stackoverflow.com/users/9534861/saqib-shahzad"}, "is_accepted": false, "score": 0, "last_activity_date": 1552464972, "creation_date": 1552464972, "answer_id": 55137150, "question_id": 55136799, "link": "https://stackoverflow.com/questions/55136799/how-to-remove-resource-name-from-route-helper/55137150#55137150", "title": "How to remove resource name from route helper?", "body": "<p>what you can do is define this path in your <code>application controller</code>:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  ...\n  def rubizza_path\n    rubizza_promo_pages_path\n  end\n\n  helper_method :rubizza_path\nend\n</code></pre>\n\n<p>in your <code>routes.rb</code>:</p>\n\n<pre><code>resources :promo_pages, path: 'promo' do\n   get :promo_rubizza, on: :collection, path: 'rubizza', as: :rubizza\nend\n</code></pre>\n\n<p>That way, you can still use rubizza_path in your views, helpers, controllers, etc. but it uses the full nested route instead.</p>\n"}, {"tags": [], "owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "is_accepted": false, "score": 0, "last_activity_date": 1552467150, "last_edit_date": 1552467150, "creation_date": 1552465517, "answer_id": 55137279, "question_id": 55136799, "link": "https://stackoverflow.com/questions/55136799/how-to-remove-resource-name-from-route-helper/55137279#55137279", "title": "How to remove resource name from route helper?", "body": "<p>Customising the routes names details are available <a href=\"https://guides.rubyonrails.org/routing.html#customizing-resourceful-routes\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>What about defining the path based on controller and action?</p>\n\n<pre><code> get 'promo_pages/promo_rubizza', to: 'promo_pages#promo_rubizza', as: :rubizza\n</code></pre>\n\n<p>it will return:</p>\n\n<pre><code> Prefix Verb URI Pattern                          Controller#Action\nrubizza GET  /promo_pages/promo_rubizza(.:format) promo_pages#promo_rubizza\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "edited": false, "score": 0, "creation_date": 1552466064, "post_id": 55137337, "comment_id": 97015212, "body": "Thanks! I did that, but I wanted to keep the nesting, so I&#39;m asking"}, {"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "reply_to_user": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "edited": false, "score": 0, "creation_date": 1552468063, "post_id": 55137337, "comment_id": 97016331, "body": "I think that with nesting routes you can only do the solution suggested by Saqib (adding a method in controller)"}], "tags": [], "owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "is_accepted": true, "score": 1, "last_activity_date": 1552465754, "creation_date": 1552465754, "answer_id": 55137337, "question_id": 55136799, "link": "https://stackoverflow.com/questions/55136799/how-to-remove-resource-name-from-route-helper/55137337#55137337", "title": "How to remove resource name from route helper?", "body": "<p>In routes, please define the following route (put it on the same level as <code>resources</code>, without nesting):</p>\n\n<pre><code>get 'promo/rubizza', to: 'promo_pages#promo_rubizza', as: 'rubizza'\n</code></pre>\n\n<p>Then, you should be able to use <code>rubizza_path</code> and <code>rubizza_url</code>.</p>\n"}], "owner": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 55137337, "answer_count": 3, "score": 1, "last_activity_date": 1552467150, "creation_date": 1552463493, "last_edit_date": 1552465137, "question_id": 55136799, "link": "https://stackoverflow.com/questions/55136799/how-to-remove-resource-name-from-route-helper", "title": "How to remove resource name from route helper?", "body": "<p>I have a route:</p>\n\n<pre><code>resources :promo_pages, path: 'promo' do\n    get :promo_rubizza, on: :collection, path: 'rubizza', as: :rubizza\nend\n</code></pre>\n\n<p>This route is created - <code>rubizza_promo_pages_path</code></p>\n\n<p>But I'd like to have - <code>rubizza_path</code>. </p>\n\n<p><strong>How to implement it?</strong><br>\nI wanted to implement this as <code>resources :promo_pages, path: 'promo', as: ''</code>, but it created <code>rubizza__index_path</code></p>\n\n<p><strong>UPD:</strong> output <code>rails routes</code></p>\n\n<pre><code>rubizza_promo_pages GET    /promo/rubizza(.:format)       promo_pages#promo_rubizza\n</code></pre>\n"}, {"tags": ["ruby"], "owner": {"reputation": 21, "user_id": 11190500, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ygrwUHQKvXQ/AAAAAAAAAAI/AAAAAAAAAAA/r2HwJQ4KMBM/photo.jpg?sz=128", "display_name": "Pooja Chamarthi", "link": "https://stackoverflow.com/users/11190500/pooja-chamarthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 362, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1552453826, "creation_date": 1552453826, "question_id": 55134787, "link": "https://stackoverflow.com/questions/55134787/how-to-resolve-mixlibshelloutshellcommandfailed-error", "title": "How to resolve Mixlib::ShellOut::ShellCommandFailed error", "body": "<p>I am trying to mock the data of node and run chefspec. But facing this error. Chefspec version=7.3.4 \nChef version=13.9.1\nIs there any problem with the simulation? how do I resolve the handler error? \nIs there something I'm missing here? How can I debug the  Mixlib::ShellOut::CommandTimeout?</p>\n\n<pre><code>================================================================================\nError executing action `install` on resource 'python_package[setuptools]'\n================================================================================\n\nMixlib::ShellOut::ShellCommandFailed\n------------------------------------\nExpected process to exit with [0], but received '1'\n---- Begin output of [\"/usr/bin/python2.7\", \"-\", \"setuptools==40.5.0\"] ----\nSTDOUT: \nSTDERR: No handlers could be found for logger \"pip._internal.index\"\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 43, in &lt;module&gt;\n  File \"/usr/local/lib/python2.7/dist-packages/pip/_internal/index.py\", line 543, in find_requirement\n    'No matching distribution found for %s' % req\npip._internal.exceptions.DistributionNotFound: No matching distribution found for setuptools==40.5.0\n---- End output of [\"/usr/bin/python2.7\", \"-\", \"setuptools==40.5.0\"] ----\nRan [\"/usr/bin/python2.7\", \"-\", \"setuptools==40.5.0\"] returned 1\n\nResource Declaration:\n---------------------\n# In /chef-recipes/cookbooks/poise-python/files/halite_gem/poise_python/python_providers/base.rb\n\n138:         python_package 'setuptools' do\n139:           parent_python new_resource\n140:           version setuptools_version if setuptools_version.is_a?(String)\n141:         end\n142:       end\n\nCompiled Resource:\n------------------\n# Declared in /chef-recipes/cookbooks/poise-python/files/halite_gem/poise_python/python_providers/base.rb:138:in `install_setuptools'\n\npython_package(\"setuptools\") do\n  package_name \"setuptools\"\n  action [:install]\n  default_guard_interpreter :default\n  declared_type :python_package\n  cookbook_name :\"poise-python\"\n  parent_python python_runtime[2]\n  version \"40.5.0\"\n  timeout 900\nend\n\nSystem Info:\n------------\nchef_version=13.9.1\nplatform=ubuntu\nplatform_version=16.04\nruby=ruby 2.4.2p198 (2017-09-14 revision 59899) [x86_64-linux]\nprogram_name=/usr/local/rvm/gems/ruby-2.4.2/bin/rspec\nexecutable=/usr/local/rvm/gems/ruby-2.4.2/bin/ruby_executable_hooks\n</code></pre>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3", "aws-lambda", "amazon-elastic-transcoder"], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1552486279, "post_id": 55135822, "comment_id": 97028217, "body": "It requires an input, which i need to specify the file (where input key is).  Is there a way to not specify a file, and just specify a file ending? and how?"}, {"owner": {"reputation": 2738, "user_id": 6941447, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208823848651706/picture?type=large", "display_name": "Ninad Gaikwad", "link": "https://stackoverflow.com/users/6941447/ninad-gaikwad"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1552488205, "post_id": 55135822, "comment_id": 97029721, "body": "When lambda is triggered by file upload event, it sends the details of the file to the lambda as parameters. You can get the key from there"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1552488266, "post_id": 55135822, "comment_id": 97029771, "body": "But how? I don&#39;t see any way in the docs to define the file that is triggering the lambda"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1552488365, "post_id": 55135822, "comment_id": 97029827, "body": "I tried using <code>lambda_handler</code> but that didn&#39;t do it"}, {"owner": {"reputation": 2738, "user_id": 6941447, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208823848651706/picture?type=large", "display_name": "Ninad Gaikwad", "link": "https://stackoverflow.com/users/6941447/ninad-gaikwad"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1552488876, "post_id": 55135822, "comment_id": 97030203, "body": "I use python and am not really familiar with Ruby. I did find a similar solution that someone had posted though. <a href=\"https://dev.to/maartenvanvliet/using-serverless-ruby-on-aws-lambda-to-resize-images-m93\" rel=\"nofollow noreferrer\">dev.to/maartenvanvliet/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2738, "user_id": 6941447, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208823848651706/picture?type=large", "display_name": "Ninad Gaikwad", "link": "https://stackoverflow.com/users/6941447/ninad-gaikwad"}, "is_accepted": false, "score": 0, "last_activity_date": 1552459797, "last_edit_date": 1552459797, "creation_date": 1552459159, "answer_id": 55135822, "question_id": 55134091, "link": "https://stackoverflow.com/questions/55134091/triggering-lambda-on-s3-video-upload/55135822#55135822", "title": "Triggering Lambda on s3 video upload?", "body": "<p>The extension field is Optional. If you don't specify anything in it, the lambda will be triggered no matter what file is uploaded. You can then check if it's the type of file you want and proceed. </p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 297, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1579582859, "creation_date": 1552448919, "last_edit_date": 1579582859, "question_id": 55134091, "link": "https://stackoverflow.com/questions/55134091/triggering-lambda-on-s3-video-upload", "title": "Triggering Lambda on s3 video upload?", "body": "<p>I am testing adding a watermark to a video once uploaded.  I am running into an issue where lamdba wants me to specify which file to change on upload.  but i want it to trigger when any (really, any file that ends in .mov, .mp4, etc.) file is uploaded.</p>\n\n<p>To clarify, this all works manually in creating a pipeline and job.</p>\n\n<p><strong>Here's my code:</strong></p>\n\n<pre><code>    require 'json'\n    require 'aws-sdk-elastictranscoder'\n\n\n    def lambda_handler(event:, context:)\n      client = Aws::ElasticTranscoder::Client.new(region: 'us-east-1')\n\n        resp = client.create_job({\n      pipeline_id: \"15521341241243938210-qevnz1\", # required\n      input: {\n        key: File, #this is where my issue\n        },\n      output: {\n    key: \"CBtTw1XLWA6VSGV8nb62gkzY\",\n    # thumbnail_pattern: \"ThumbnailPattern\",\n    # thumbnail_encryption: {\n    #   mode: \"EncryptionMode\",\n    #   key: \"Base64EncodedString\",\n    #   key_md_5: \"Base64EncodedString\",\n    #   initialization_vector: \"ZeroTo255String\",\n    # },\n    # rotate: \"Rotate\",\n    preset_id: \"1351620000001-000001\",\n    # segment_duration: \"FloatString\",\n    watermarks: [\n      {\n        preset_watermark_id: \"TopRight\",\n        input_key: \"uploads/2354n.jpg\",\n        # encryption: {\n        #   mode: \"EncryptionMode\",\n        #   key: \"zk89kg4qpFgypV2fr9rH61Ng\",\n        #   key_md_5: \"Base64EncodedString\",\n        #   initialization_vector: \"ZeroTo255String\",\n        # },\n      },\n    ],\n  }\n  })\n\nend\n</code></pre>\n\n<p><strong>How do i specify just <code>any</code> file that is uploaded, or files that are a specific format?</strong> for the input: key: ?</p>\n\n<p>Now, my issue is that i am using active storage so it doesn't end in .jpg or .mov, etc., it just is a random generated string (they have reasons for doing this).  I am trying to find a reason to use active storage and this is my final step to making it work like other alternatives before it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "roda"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1552461807, "post_id": 55133315, "comment_id": 97013214, "body": "you might get other errors, but maybe patch on the <code>authorization</code> method? View the source here <a href=\"https://apidock.com/rails/ActionDispatch/Request/authorization\" rel=\"nofollow noreferrer\">apidock.com/rails/ActionDispatch/Request/authorization</a>"}], "owner": {"reputation": 10442, "user_id": 471313, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/FqmpL.jpg?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/471313/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552442964, "creation_date": 1552442964, "question_id": 55133315, "link": "https://stackoverflow.com/questions/55133315/is-it-possible-to-use-rails-authenticate-with-http-token-with-roda-app", "title": "Is it possible to use Rails authenticate_with_http_token with Roda app?", "body": "<p>I made an API with Rails that authenticates using  <code>authenticate_with_http_token</code> method. This is working great. </p>\n\n<p>The API uses <a href=\"https://github.com/janko/tus-ruby-server\" rel=\"nofollow noreferrer\">tus-ruby-server</a> for resumable file uploads. <code>Tus::Server</code> is a Roda app. I can use <a href=\"https://github.com/janko/tus-ruby-server#hooks\" rel=\"nofollow noreferrer\">hooks</a> to add authentication. It is working inside the Rails app (its endpoints are mounted in <code>routes.rb</code>).</p>\n\n<p>Rails already provides <code>authenticate_with_http_token</code> which is a very well crafted implementation to authenticate via tokens. Is it possible to use this method somehow in the Roda app inside these hooks?</p>\n\n<p>So far I couldn't succeed in doing so and I ended implementing a simpler way to read the header and parse the token that leaved me with a feeling that I over-implemented something already provided by Rails and that the solution I did is much less robust of what Rails already provides.</p>\n\n<p>I tried to include the Rails method this way.</p>\n\n<pre><code># config/initializers/tus.rb\nTus::Server.before \n   extend ActionController::HttpAuthentication::Token::ControllerMethods\n   authenticate_with_http_token { |token| User.find_by(token: token) }\nend\n</code></pre>\n\n<p>But ended up with this error. </p>\n\n<pre><code>NoMethodError: undefined method `authorization' for #&lt;Tus::Server::RodaRequest:0x00007f9fe3b48450&gt;\n</code></pre>\n\n<p>The roda request does not understands the <code>ActionDispatch::Request#authorization</code> called <a href=\"https://github.com/rails/rails/blob/master/actionpack/lib/action_controller/metal/http_authentication.rb#L458\" rel=\"nofollow noreferrer\">here</a>. I got stuck here as I don't understand how it may be possible to add ActionDispatch methods in the <code>RodaRequest</code> object. </p>\n\n<p>I may be missing something obvious but so far I'm not seeing it. </p>\n\n<p>Am I missing something more fundamental to get the <code>authenticate_with_http_token</code> method working inside the <code>Tus::Server</code> hook?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "heroku", "multiple-databases"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1552442426, "post_id": 55133214, "comment_id": 97007778, "body": "Did you run the <code>heroku config:set</code> command to set those env vars?"}, {"owner": {"reputation": 27, "user_id": 8451201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KI9cF.jpg?s=128&g=1", "display_name": "Birivera", "link": "https://stackoverflow.com/users/8451201/birivera"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1552442889, "post_id": 55133214, "comment_id": 97007857, "body": "Yes I did. After that I got the env vars values I posted"}, {"owner": {"reputation": 120562, "user_id": 78845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3325b0d3557f7c7ec02f0b95f7bc3c9?s=128&d=identicon&r=PG&f=1", "display_name": "Johnsyweb", "link": "https://stackoverflow.com/users/78845/johnsyweb"}, "edited": false, "score": 0, "creation_date": 1552455762, "post_id": 55133214, "comment_id": 97010829, "body": "You might want to change those credentials :-O"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1552456783, "post_id": 55133214, "comment_id": 97011193, "body": "Are the database URLs your real production configuration settings? If that is the case you should change the password immediately. And if there is already data in that databases you might need to inform your data protection officer."}, {"owner": {"reputation": 27, "user_id": 8451201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KI9cF.jpg?s=128&g=1", "display_name": "Birivera", "link": "https://stackoverflow.com/users/8451201/birivera"}, "edited": false, "score": 0, "creation_date": 1552474879, "post_id": 55133214, "comment_id": 97020694, "body": "Those are just dummy data, a copy of an old DB, nothing important."}, {"owner": {"reputation": 2659, "user_id": 483133, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NcB9j.jpg?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/483133/phil"}, "edited": false, "score": 0, "creation_date": 1552479771, "post_id": 55133214, "comment_id": 97023746, "body": "Have you tried placing the URIs in quotes in the yaml file? I have had issues with certain characters breaking yaml in the past."}, {"owner": {"reputation": 27, "user_id": 8451201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KI9cF.jpg?s=128&g=1", "display_name": "Birivera", "link": "https://stackoverflow.com/users/8451201/birivera"}, "edited": false, "score": 0, "creation_date": 1552480686, "post_id": 55133214, "comment_id": 97024343, "body": "Tried with and without quotes in the yaml and in the config vars of heroku, no one worked. Also tried again hardcoding the URI and now it works but won\u2019t work for too long as heroku rotates the credentials. It\u2019s like is not properly reading the ENV VAR. I\u2019ve tried changing the URI of another database and still getting the same error."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8451201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KI9cF.jpg?s=128&g=1", "display_name": "Birivera", "link": "https://stackoverflow.com/users/8451201/birivera"}, "edited": false, "score": 0, "creation_date": 1552501502, "post_id": 55146316, "comment_id": 97038065, "body": "I&#39;ve tried this in the ruby console:  <code>uri = URI.parse(&lt;URI&gt;) uri.user uri.password</code>  etc  they all work"}], "tags": [], "owner": {"reputation": 696, "user_id": 6999833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0e26a82fa2dccaae910c7fa87dd8e8?s=128&d=identicon&r=PG", "display_name": "Stan Mazhara", "link": "https://stackoverflow.com/users/6999833/stan-mazhara"}, "is_accepted": false, "score": 2, "last_activity_date": 1552493055, "creation_date": 1552493055, "answer_id": 55146316, "question_id": 55133214, "link": "https://stackoverflow.com/questions/55133214/uriinvalidurierror-bad-uriis-not-uri-when-deploying-heroku-app-with-multip/55146316#55146316", "title": "URI::InvalidURIError: bad URI(is not URI?) when deploying HEROKU app with multiple databases", "body": "<p>Make sure that <code>URI.parse(&lt;DATABASE_DAVILA_URL here&gt;)</code> succeeds. Chances are you have non-url safe characters in your database username/password. You will need to<code>URI.encode</code> them.</p>\n"}], "owner": {"reputation": 27, "user_id": 8451201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KI9cF.jpg?s=128&g=1", "display_name": "Birivera", "link": "https://stackoverflow.com/users/8451201/birivera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 954, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1552493055, "creation_date": 1552442040, "last_edit_date": 1552474800, "question_id": 55133214, "link": "https://stackoverflow.com/questions/55133214/uriinvalidurierror-bad-uriis-not-uri-when-deploying-heroku-app-with-multip", "title": "URI::InvalidURIError: bad URI(is not URI?) when deploying HEROKU app with multiple databases", "body": "<p>Im trying to deploy a heroku app with multiple databases (2 at the moment). I was following this tutorial</p>\n\n<p><a href=\"http://www.ostinelli.net/setting-multiple-databases-rails-definitive-guide/\" rel=\"nofollow noreferrer\">Multiple database guide</a></p>\n\n<p>that said that I need to configure a file like this</p>\n\n<pre><code>production:\n  adapter: postgresql\n  encoding: utf8\n  url:  &lt;%= ENV[\"DATABASE_DAVILA_URL\"] %&gt;\n  pool: &lt;%= ENV[\"DB_POOL\"] || 5 %&gt;\n</code></pre>\n\n<p>The problem is when im trying to deploy to heroku, this error happens</p>\n\n<pre><code>-----&gt; Detecting rake tasks\n-----&gt; Preparing app for Rails asset pipeline\n       Running: rake assets:precompile\n       rake aborted!\n       URI::InvalidURIError: bad URI(is not URI?): &lt;%= ENV[\"DATABASE_DAVILA_URL\"] %&gt;\n</code></pre>\n\n<p>It's like is not parsing the link correctly because I even tried to hardcode the URI in the variable and didn't work. Here is the important part of the env vars:</p>\n\n<pre><code>DATABASE_DAVILA_URL:         postgres://somethinguser:somethingpass@somethinghost.compute-1.amazonaws.com:5432/somethingdb\nDATABASE_URL:                postgres://somethinguser:somethingpass@somethinghost.compute-1.amazonaws.com:5432/somethingdb\nHEROKU_POSTGRESQL_MAUVE_URL: postgres://somethinguser:somethingpass@somethinghost.compute-1.amazonaws.com:5432/somethingdb\n</code></pre>\n\n<p>I followed almost every tutorial that I've found, but I keep getting the same error. I even tried something I read like \"not loading the env vars in the precompiling phase\" with this code, but didn't change anything</p>\n\n<pre><code>module Indicadoresrails\n  class Application &lt; Rails::Application\n\n    config.load_defaults 5.2\n\n    config.assets.initialize_on_precompile = false\n  end\nend\n</code></pre>\n\n<p>Please help :(</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1552440034, "post_id": 55132967, "comment_id": 97007298, "body": "<code>allow(:researchable).to receive(:whitelabel).and_return OpenStruct.new(applicants_income_average: 12_000)</code> should do it"}, {"owner": {"reputation": 1, "user_id": 11131844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/817c3762fda8fdd5ef5e714b96501094?s=128&d=identicon&r=PG&f=1", "display_name": "Jzr", "link": "https://stackoverflow.com/users/11131844/jzr"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1552446731, "post_id": 55132967, "comment_id": 97008613, "body": "I get this error  can&#39;t define singleton I&#39;m doing some thing bad?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1552446797, "post_id": 55132967, "comment_id": 97008626, "body": "What is the class of researchable? Can you include the error trace in your question?"}, {"owner": {"reputation": 1, "user_id": 11131844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/817c3762fda8fdd5ef5e714b96501094?s=128&d=identicon&r=PG&f=1", "display_name": "Jzr", "link": "https://stackoverflow.com/users/11131844/jzr"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1552447951, "post_id": 55132967, "comment_id": 97008843, "body": "researchable is polyphormic class of user and just have this error TypeError:        can&#39;t define singleton      # ./spec/models/concerns/product_application_alerts_concern_sp&zwnj;&#8203;ec.rb:23:in `block (3 levels) in &lt;top (required)&gt;&#39; in the console"}, {"owner": {"reputation": 1, "user_id": 11131844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/817c3762fda8fdd5ef5e714b96501094?s=128&d=identicon&r=PG&f=1", "display_name": "Jzr", "link": "https://stackoverflow.com/users/11131844/jzr"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1552449146, "post_id": 55132967, "comment_id": 97009106, "body": "Thanks for you help I cant resolve this with before do       allow(researchable).to receive(:whitelabel).         and_return whitelabel       allow(whitelabel).to receive(:average_credit_requested).         and_return(12_000)       allow(whitelabel).to receive(:applicants_income_average).         and_return(12_000)     end"}], "answers": [{"tags": [], "owner": {"reputation": 2301, "user_id": 19317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47035e07012da3162b6e83650ee3abe0?s=128&d=identicon&r=PG", "display_name": "aridlehoover", "link": "https://stackoverflow.com/users/19317/aridlehoover"}, "is_accepted": false, "score": 0, "last_activity_date": 1552545264, "creation_date": 1552545264, "answer_id": 55156293, "question_id": 55132967, "link": "https://stackoverflow.com/questions/55132967/how-to-assign-data-dummy-in-a-method-with-rspec/55156293#55156293", "title": "how to assign data dummy in a method with rspec", "body": "<p>The following setup will mock the researchable object and its whitelabel method to return testable values for both <code>income_average</code> and <code>credit_average</code>.</p>\n\n<p>HTH</p>\n\n<pre><code>describe Foo do\n  subject(:foo) { described_class.new }\n\n  describe '#benchmarks_alerts' do\n    subject(:benchmarks_alerts) { foo.benchmarks_alerts(researchable) }\n\n    let(:researchable) { instance_double('researchable', whitelabel: whitelabel) }\n    let(:whitelabel) { instance_double('whitelabel') }\n    let(:income_average) { 123 }\n    let(:credit_average) { 456 }\n\n    before do\n      allow(whitelabel)\n        .to receive(:applicants_income_average)\n        .and_return(income_average)\n\n      allow(whitelabel)\n        .to receive(:average_credit_requested)\n        .and_return(credit_average)\n    end\n\n    it 'does something' do\n      # your test goes here\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11131844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/817c3762fda8fdd5ef5e714b96501094?s=128&d=identicon&r=PG&f=1", "display_name": "Jzr", "link": "https://stackoverflow.com/users/11131844/jzr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1552545264, "creation_date": 1552439892, "last_edit_date": 1552469954, "question_id": 55132967, "link": "https://stackoverflow.com/questions/55132967/how-to-assign-data-dummy-in-a-method-with-rspec", "title": "how to assign data dummy in a method with rspec", "body": "<p>Hello guys I have a question with rspec for rails, how I can assign data for a variable inside of my method for example <code>income_average = 12_00</code>0 without execute the code <code>researchable.whitelabel.applicants_income_average</code></p>\n\n<pre><code>def benchmarks_alerts(researchable)\n  income_average = researchable.whitelabel.applicants_income_average\n  credit_averange = researchable.whitelabel.average_credit_requested\n  errors = {}\n\n  errors = errors.merge(income_in_the_mean: false) unless researchable.within_the_incomes_averenge?(income_average)\n  errors = errors.merge(credit_in_the_mean: false) unless within_the_credit_averenge?(credit_averange)\n\n  errors\nend\n</code></pre>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "edited": false, "score": 3, "creation_date": 1552447338, "post_id": 55132651, "comment_id": 97008720, "body": "Your description contradicts with your expected output. You might need to add more details in your question, more specific rules about your extraction."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552456162, "post_id": 55132651, "comment_id": 97010956, "body": "What is an &quot;empty space&quot;?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1552457855, "post_id": 55132651, "comment_id": 97011578, "body": "I gave my answer based on your original statement (sic), &#39;I want to get <code>string2</code> from <code>string1</code> which is anything between first space &quot; &quot; and &quot;.lname&quot;`. That seems clear enough, but now I notice that you say the desired result is &quot;fname.lname&quot;. The first space follows the word &quot;my&quot; and since &quot;between&quot; is not inclusive, your statement can only mean that you want to return &quot;name is fname&quot;. Please explain."}, {"owner": {"reputation": 19, "user_id": 4735413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AEYPn.jpg?s=128&g=1", "display_name": "AnujGorasia", "link": "https://stackoverflow.com/users/4735413/anujgorasia"}, "edited": false, "score": 0, "creation_date": 1552501980, "post_id": 55132651, "comment_id": 97038344, "body": "@ CarySwoveland .yeah it was confusing. I just want to return &quot;fname.lname&quot;. forget about white/empty space."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1552502717, "post_id": 55132651, "comment_id": 97038741, "body": "The question is not confusing, it&#39;s contradictory. If you want to return <code>&quot;fname.lname&quot;</code> just return that literal string. If you want to return a string that satisfies a given rule, which in the example would return <code>&quot;fname.lname&quot;</code>, then what&#39;s the rule? For example, do you want the first substring containing no spaces that ends <code>.lname</code> (in which case <code>string1[&#47;\\S+\\.lname\\b&#47;] #=&gt; &quot;fname.lname&quot;</code>)? Isn&#39;t it obvious that a rule is needed?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4735413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AEYPn.jpg?s=128&g=1", "display_name": "AnujGorasia", "link": "https://stackoverflow.com/users/4735413/anujgorasia"}, "edited": false, "score": 0, "creation_date": 1552502038, "post_id": 55132692, "comment_id": 97038370, "body": "sorry, i confused you guys. I just want to return &quot;fname.lname&quot;. forget about white/empty space."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1552453451, "last_edit_date": 1552453451, "creation_date": 1552437509, "answer_id": 55132692, "question_id": 55132651, "link": "https://stackoverflow.com/questions/55132651/how-to-extract-substring-between-two-characters-substrings/55132692#55132692", "title": "How to extract substring between two characters/substrings", "body": "<pre><code>string1[/(?&lt;= ).*?(?=\\.lname\\b)/]\n  #=&gt; \"name is fname\" \n</code></pre>\n\n<p><code>(?&lt;= )</code> is a <em>positive lookbehind</em> that requires the first character matched be immediately preceded by a space, but that space is not part of the match.</p>\n\n<p><code>(?=\\.lname\\b)</code> is a <em>positive lookahead</em> that requires the last character matched is immediately followed by the string <code>\".lname\"</code><sup>1</sup>\n, which is itself followed by a <em>word break</em> (<code>\\b</code>), but that string is not part of the match. That ensures, for example, that <code>\"\\.lnamespace\"</code> is not matched. If that should be matched, remove <code>\\b</code>.</p>\n\n<p><code>.*?</code> matches zero more characters (<code>.*</code>), non-greedily (<code>?</code>). (Matches are by default <em>greedy</em>.) The non-greedy qualifier has the following effect: </p>\n\n<pre><code>\"my name is fname.lname and fname.lname\"[/(?&lt;= ).*(?=\\.lname\\b)/]\n  #=&gt; \"name is fname.lname and fname\" \n\"my name is fname.lname and fname.lname\"[/(?&lt;= ).*?(?=\\.lname\\b)/]\n  #=&gt; \"name is fname\" \n</code></pre>\n\n<p>In other words, the non-greedy (greedy) match matches the first (last) occurrence of <code>\".lname\"</code> in the string.</p>\n\n<p>This could alternatively be written with a capture group and no lookarounds:</p>\n\n<pre><code>string1[/ (.*?)\\.lname\\b/, 1]\n  #=&gt; \"name is fname\"\n</code></pre>\n\n<p>This regular expression reads, \"mactch a space followed by zero or more characters, saved in capture group 1, followed by the string <code>\".name\"</code> followed by a word break. This uses the form of <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">String#[]</a> that has two arguments, a reference to a capture group.</p>\n\n<p>Yet another way follows.</p>\n\n<pre><code>string1[(string1 =~ / /)+1..(string1 =~ /\\.lname\\b/)-1]\n  #=&gt; \"name is fname\"\n</code></pre>\n\n<p><sup>1 The period in <code>\".lname\"</code> must be escaped because an unescaped period in a regular expression (except in a character class) matches <em>any</em> character.</sup></p>\n"}], "owner": {"reputation": 19, "user_id": 4735413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AEYPn.jpg?s=128&g=1", "display_name": "AnujGorasia", "link": "https://stackoverflow.com/users/4735413/anujgorasia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1552456089, "creation_date": 1552437069, "last_edit_date": 1552456089, "question_id": 55132651, "link": "https://stackoverflow.com/questions/55132651/how-to-extract-substring-between-two-characters-substrings", "title": "How to extract substring between two characters/substrings", "body": "<p>I have a string:</p>\n\n<pre><code>string1 = \"my name is fname.lname and i live in xyz. my lname is not common\"\n</code></pre>\n\n<p>I want to extract a substring from <code>string1</code> that is anything between the first empty space <code>\" \"</code> and <code>\".lname\"</code>. In the case above, the answer should be \"fname.lname\"`.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "rspec", "rspec-rails"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 7064728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c5105e5db6a36de015bef57e986b503?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley", "link": "https://stackoverflow.com/users/7064728/ashley"}, "edited": false, "score": 0, "creation_date": 1552467806, "post_id": 55136736, "comment_id": 97016177, "body": "I tried using get inside the test but I am not sure how to use the authentication. I should use the username and password with the call. Curl looks like this &quot;curl <a href=\"https://example.com/api/v2/tests.json\" rel=\"nofollow noreferrer\">example.com/api/v2/tests.json</a> \\   -v -u test@gmail.com:Abcd1234&quot;"}, {"owner": {"reputation": 540, "user_id": 9286337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pE94D.png?s=128&g=1", "display_name": "Fito von Zastrow", "link": "https://stackoverflow.com/users/9286337/fito-von-zastrow"}, "reply_to_user": {"reputation": 147, "user_id": 7064728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c5105e5db6a36de015bef57e986b503?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley", "link": "https://stackoverflow.com/users/7064728/ashley"}, "edited": false, "score": 1, "creation_date": 1552498721, "post_id": 55136736, "comment_id": 97036623, "body": "@Jane I&#39;ve updated my answer to include basic auth."}, {"owner": {"reputation": 147, "user_id": 7064728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c5105e5db6a36de015bef57e986b503?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley", "link": "https://stackoverflow.com/users/7064728/ashley"}, "edited": false, "score": 0, "creation_date": 1552516854, "post_id": 55136736, "comment_id": 97044892, "body": "I tried to use the same format for post and delete and delete doesn&#39;t seem to work. I am getting 401 unauthorised error. any pointers? Post works fine."}, {"owner": {"reputation": 540, "user_id": 9286337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pE94D.png?s=128&g=1", "display_name": "Fito von Zastrow", "link": "https://stackoverflow.com/users/9286337/fito-von-zastrow"}, "reply_to_user": {"reputation": 147, "user_id": 7064728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c5105e5db6a36de015bef57e986b503?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley", "link": "https://stackoverflow.com/users/7064728/ashley"}, "edited": false, "score": 0, "creation_date": 1552530463, "post_id": 55136736, "comment_id": 97048281, "body": "Hmm the delete and post methods should work the same. Could it be a problem on the API side?"}, {"owner": {"reputation": 147, "user_id": 7064728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c5105e5db6a36de015bef57e986b503?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley", "link": "https://stackoverflow.com/users/7064728/ashley"}, "edited": false, "score": 0, "creation_date": 1552556447, "post_id": 55136736, "comment_id": 97057532, "body": "i tried it with Faraday and delete works with Faraday. But with Faraday, I seem to have trouble with using Airborne expect_status or any other assertions which seem to work with the code you suggested with rest_client"}], "tags": [], "owner": {"reputation": 540, "user_id": 9286337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pE94D.png?s=128&g=1", "display_name": "Fito von Zastrow", "link": "https://stackoverflow.com/users/9286337/fito-von-zastrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1552498676, "last_edit_date": 1552498676, "creation_date": 1552463207, "answer_id": 55136736, "question_id": 55132531, "link": "https://stackoverflow.com/questions/55132531/ruby-airbourne-rspec-api-testing/55136736#55136736", "title": "Ruby - Airbourne Rspec API testing", "body": "<p>You are using <a href=\"https://github.com/brooklynDev/airborne\" rel=\"nofollow noreferrer\">airborne</a> which uses <a href=\"https://github.com/rest-client/rest-client\" rel=\"nofollow noreferrer\">rest_client</a> to make API calls.\nIn order to use airborne's matchers (<code>expect_json</code>, etc), you need to make your API call inside the test. This means you your test should look like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>describe 'Test to GET' do\n  it 'should return 200' do\n    authorization_token = Base64.encode64('test@gmail.com:Abcd1234')\n    get(\n      \"https://example.com/api/v2/tests.json\",\n      { 'Authorization' =&gt; \"Basic #{authorization_token}\" }\n    )\n    expect_json_types(name: :string)\n    expect_json(name: 'test')\n    expect_status(200)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 7064728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c5105e5db6a36de015bef57e986b503?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley", "link": "https://stackoverflow.com/users/7064728/ashley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 55136736, "answer_count": 1, "score": 0, "last_activity_date": 1552498676, "creation_date": 1552436002, "question_id": 55132531, "link": "https://stackoverflow.com/questions/55132531/ruby-airbourne-rspec-api-testing", "title": "Ruby - Airbourne Rspec API testing", "body": "<p>I am trying to write an api test but I can't figure out how to do it. \nI converted curl to ruby and got a block like below</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>require 'net/http'\r\nrequire 'uri'\r\n\r\nuri = URI.parse(\"https://example.com/api/v2/tests.json\")\r\nrequest = Net::HTTP::Get.new(uri)\r\nrequest.basic_auth(\"test@gmail.com\", \"Abcd1234\")\r\n\r\nreq_options = {\r\n  use_ssl: uri.scheme == \"https\",\r\n}\r\n\r\nresponse = Net::HTTP.start(uri.hostname, uri.port, req_options) do |http|\r\n  http.request(request)\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I wrote the test as below </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>describe 'Test to GET' do\r\n  it 'should return 200' do\r\n  \r\n  expect_json_types(name: :string)\r\n  expect_json(name: 'test')\r\n    expect_status(200)\r\n  end\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>My question how do i use the api call to test this. Should i add it in a separate file or in the same file above describe. I haven't worked with Ruby before and couldn't find anything online as well. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 1, "last_activity_date": 1552435647, "creation_date": 1552435647, "answer_id": 55132484, "question_id": 55132405, "link": "https://stackoverflow.com/questions/55132405/rails-5-2-show-methods-dont-need-to-exist/55132484#55132484", "title": "Rails 5.2 show methods don&#39;t need to exist", "body": "<p>This is part of rail's \"convention over configuration\" philosophy. As stated in the <a href=\"https://guides.rubyonrails.org/layouts_and_rendering.html#rendering-by-default-convention-over-configuration-in-action\" rel=\"nofollow noreferrer\">guide</a>: </p>\n\n<blockquote>\n  <p>You've heard that Rails promotes \"convention over configuration\". Default rendering is an excellent example of this. By default, controllers in Rails automatically render views with names that correspond to valid routes. </p>\n</blockquote>\n\n<p>While it may seem very wrong to you, it is the explicitly intended behavior.</p>\n"}], "owner": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 55132484, "answer_count": 1, "score": 0, "last_activity_date": 1552435647, "creation_date": 1552435005, "question_id": 55132405, "link": "https://stackoverflow.com/questions/55132405/rails-5-2-show-methods-dont-need-to-exist", "title": "Rails 5.2 show methods don&#39;t need to exist", "body": "<p>Has anyone else noticed that in rails 5.2 (not sure if this happens in other versions), you can scaffold out a controller and then delete the show method, provided the view for show action still exists rails will render the show action with the relevant data.</p>\n\n<p>This seems very very wrong to me. Has anyone else noticed this? If this is intended behavior I think a console warning or something should be added. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "windows"], "comments": [{"owner": {"reputation": 1606, "user_id": 2497650, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/9qcHe.jpg?s=128&g=1", "display_name": "Natus Drew", "link": "https://stackoverflow.com/users/2497650/natus-drew"}, "edited": false, "score": 0, "creation_date": 1552436108, "post_id": 55132128, "comment_id": 97006522, "body": "which operating system are you using? Linux and OSX should work."}, {"owner": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "reply_to_user": {"reputation": 1606, "user_id": 2497650, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/9qcHe.jpg?s=128&g=1", "display_name": "Natus Drew", "link": "https://stackoverflow.com/users/2497650/natus-drew"}, "edited": false, "score": 0, "creation_date": 1552436158, "post_id": 55132128, "comment_id": 97006533, "body": "@nathantech333 windows 10"}], "owner": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552433121, "creation_date": 1552433121, "question_id": 55132128, "link": "https://stackoverflow.com/questions/55132128/ruby-on-rails-not-reloading-in-development", "title": "Ruby on rails not reloading in development", "body": "<p>I have recently noticed that when running a rails 5.2 project locally on my PC it doesn't auto detect changes to controllers and models. The only way I can get around it is to stop and start the server.</p>\n\n<p>I have had a look around and I did find a couple of posts suggesting that I un-comment <code>config.file_watcher = ActiveSupport::EventedFileUpdateChecker</code> in my development config and add the <code>gem listen</code>. This was mostly on forums relating to running rails on docker.</p>\n\n<p>This does solve the problem(ish) - its very slow. I would still like to know why the default behaviour suddenly stopped working. </p>\n\n<p>This is happening on all my rails projects on this machine which previously worked fine.</p>\n\n<p>The only change I ever made to any config file was to add the devise mailer config, other than that its all defaults.</p>\n\n<p>Has anyone else experienced this problem? Or does anyone have any advice on solving it?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby", "selenium"], "comments": [{"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1552424115, "post_id": 55130346, "comment_id": 97002576, "body": "Not sure why do you want to add the doc to your project. You can just provide the link your post in your README.md file."}, {"owner": {"reputation": 346, "user_id": 4911426, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1087083604639482/picture?type=large", "display_name": "Shahboz", "link": "https://stackoverflow.com/users/4911426/shahboz"}, "reply_to_user": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1552425328, "post_id": 55130346, "comment_id": 97003054, "body": "How can adding it to my README helps me with my code completion? @supputuri"}, {"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1552425693, "post_id": 55130346, "comment_id": 97003224, "body": "what do you mean by code completion, I thought you are referring to that link to understand the implementation/available methods. Sorry, I did not get it correctly."}, {"owner": {"reputation": 346, "user_id": 4911426, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1087083604639482/picture?type=large", "display_name": "Shahboz", "link": "https://stackoverflow.com/users/4911426/shahboz"}, "reply_to_user": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1552425904, "post_id": 55130346, "comment_id": 97003301, "body": "@supputuri Code Completion = Give me suggestion of which methods to use from Selenium Web Driver as I&#39;m typing. <a href=\"https://www.jetbrains.com/help/ruby/auto-completing-code.html\" rel=\"nofollow noreferrer\">jetbrains.com/help/ruby/auto-completing-code.html</a>"}, {"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1552452798, "post_id": 55130346, "comment_id": 97010020, "body": "Got you. I have been using the <code>live templates</code> for a while, but never tried to load the selenium doc itself. Interesting question..."}], "owner": {"reputation": 346, "user_id": 4911426, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1087083604639482/picture?type=large", "display_name": "Shahboz", "link": "https://stackoverflow.com/users/4911426/shahboz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552423423, "creation_date": 1552423423, "question_id": 55130346, "link": "https://stackoverflow.com/questions/55130346/how-to-add-selenium-docs-to-rubymine", "title": "How to add Selenium Docs to RubyMine?", "body": "<p>I am using RubyMine 2016.2.4 and looking for a Selenium Doc that I can add to the project. It is better for code completion and suggestions. Any ideas? I refer to this web page for help, but how do I add the doc to the project? <a href=\"https://www.rubydoc.info/gems/selenium-webdriver/Selenium/WebDriver\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/selenium-webdriver/Selenium/WebDriver</a> </p>\n"}, {"tags": ["ruby", "google-api", "gmail", "gmail-api", "google-api-ruby-client"], "answers": [{"tags": [], "owner": {"reputation": 429, "user_id": 678483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5838d15ded7a409e1d8f20a9a11cd12?s=128&d=identicon&r=PG", "display_name": "Leo", "link": "https://stackoverflow.com/users/678483/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1552493284, "creation_date": 1552493284, "answer_id": 55146399, "question_id": 55129649, "link": "https://stackoverflow.com/questions/55129649/google-api-server-to-server-communication-not-working-ruby-implementation/55146399#55146399", "title": "Google API Server-to-Server Communication not working (Ruby implementation)", "body": "<p>Finally, I got it working. Turns out, you need to use this line to use the sub method to the \"impersonated user\" to be able to connect.</p>\n\n<pre><code>authorizer.sub = @person\n</code></pre>\n\n<p>And, for your delight, here is the updated test code for reading Gmail messages so you can follow in case you want to use it. Just remember to save the credentials.json file in your project folder to make it work and use the same scope you added in the GSuite Dashboard.</p>\n\n<pre><code>class Gsuite::ServiceAccount\n\n  def initialize(person: nil)\n    @person = person\n  end\n\n  def read_messages\n    client = service_account_access\n    inbox = client.list_user_messages(@person, max_results: 5, label_ids: \"INBOX\" )\n    if inbox.result_size_estimate.nonzero?\n      inbox.messages.each do |message|\n        response = client.get_user_message(@person, message.id)\n      end\n    end\n  end\n\nprivate\n\n  def service_account_access\n    token = authorized_client\n    client = Signet::OAuth2::Client.new(access_token: token['access_token'])\n    client.expires_in = Time.current + token[\"expires_in\"]\n    auth_client = Google::Apis::GmailV1::GmailService.new\n    auth_client.authorization = client\n    auth_client\n  end\n\n  def authorized_client\n    authorizer = Google::Auth::ServiceAccountCredentials.make_creds(\n      json_key_io: StringIO.new(File.read AppConfig[:credentials_file]),\n      scope: AppConfig[:gsuite_scope]).dup\n    authorizer.sub = @person\n    authorizer.fetch_access_token!\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 678483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5838d15ded7a409e1d8f20a9a11cd12?s=128&d=identicon&r=PG", "display_name": "Leo", "link": "https://stackoverflow.com/users/678483/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552493284, "creation_date": 1552420269, "question_id": 55129649, "link": "https://stackoverflow.com/questions/55129649/google-api-server-to-server-communication-not-working-ruby-implementation", "title": "Google API Server-to-Server Communication not working (Ruby implementation)", "body": "<p>I have followed all the steps to set up a Domain-Wide Delegation of Authority (<a href=\"https://developers.google.com/admin-sdk/reports/v1/guides/delegation\" rel=\"nofollow noreferrer\">https://developers.google.com/admin-sdk/reports/v1/guides/delegation</a>) and followed this link too (<a href=\"https://developers.google.com/identity/protocols/OAuth2ServiceAccount#delegatingauthority\" rel=\"nofollow noreferrer\">https://developers.google.com/identity/protocols/OAuth2ServiceAccount#delegatingauthority</a>) and I ended up creating this class in Ruby.</p>\n\n<pre><code>class Gsuite::ServiceAccount\n\ndef initialize(person: nil)\nend \n\ndef authorized_client\n      Google::Auth::ServiceAccountCredentials.make_creds(\n    authorizer = Google::Auth::ServiceAccountCredentials.make_creds(\n      json_key_io: StringIO.new(File.read AppConfig[:gsuite_service_account] \n [:credentials_file]),\n      scope: AppConfig[:gsuite_service_account][:scope])\n    client = authorizer.fetch_access_token!\n  end\nend\n</code></pre>\n\n<p>This class returns me this hash</p>\n\n<pre><code>{\"access_token\"=&gt;\"a_long_token_string_here\", \"expires_in\"=&gt;3600, \"token_type\"=&gt;\"Bearer\"}\n</code></pre>\n\n<p>Then, I've created this method (within my Admin class) to connect to Gmail Service</p>\n\n<pre><code>def gsuite_client_access\n    @client ||= Gsuite::ServiceAccount.new(person: self.email.to_s).authorized_client\n    authorized_client = Google::Apis::GmailV1::GmailService.new\n    authorized_client.authorization = @client\n    authorized_client\n  end\n</code></pre>\n\n<p>So, when I try to list my Gmail Messages with this line in another part of the code</p>\n\n<pre><code>inbox = current_admin.gsuite_client_access.list_user_messages('me', max_results: 10)\n</code></pre>\n\n<p>I get the following error message =></p>\n\n<pre><code>Sending HTTP get https://www.googleapis.com/gmail/v1/users/me/messages?maxResults=10\n401\n#&lt;Hurley::Response GET https://www.googleapis.com/gmail/v1/users/me/messages?maxResults=10 == 401 (238 bytes) 645ms&gt;\nCaught error Unauthorized\nError - #&lt;Google::Apis::AuthorizationError: Unauthorized&gt;\n\nRetrying after authentication failure\nGoogle::Apis::AuthorizationError: Unauthorized\n</code></pre>\n\n<p>Any ideas what's missing here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-admin"], "comments": [{"owner": {"reputation": 2659, "user_id": 483133, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NcB9j.jpg?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/483133/phil"}, "edited": false, "score": 0, "creation_date": 1552485081, "post_id": 55129127, "comment_id": 97027351, "body": "It looks to me like the home request is being performed as an AJAX request and pushing the result into the DOM in a strange place. Do you have control over the home link? Maybe ensure it doesn&#39;t have <code>data-remote=true</code> or that it is definitely making an HTML request."}, {"owner": {"reputation": 13, "user_id": 10993544, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217159607614965/picture?type=large", "display_name": "Usman Ijaz", "link": "https://stackoverflow.com/users/10993544/usman-ijaz"}, "reply_to_user": {"reputation": 2659, "user_id": 483133, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NcB9j.jpg?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/483133/phil"}, "edited": false, "score": 0, "creation_date": 1552502407, "post_id": 55129127, "comment_id": 97038582, "body": "Hi, thanks for your response... I am using rails_admin gem: <a href=\"https://github.com/sferik/rails_admin\" rel=\"nofollow noreferrer\">github.com/sferik/rails_admin</a>. I don&#39;t really have control over the home button (I think so). One thing to note is that if I refresh the admin page and then click on the home button then it&#39;s working perfectly fine - but if I click directly onto the home button without that it does what is shown above"}, {"owner": {"reputation": 13, "user_id": 10993544, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217159607614965/picture?type=large", "display_name": "Usman Ijaz", "link": "https://stackoverflow.com/users/10993544/usman-ijaz"}, "reply_to_user": {"reputation": 2659, "user_id": 483133, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NcB9j.jpg?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/483133/phil"}, "edited": false, "score": 0, "creation_date": 1554908137, "post_id": 55129127, "comment_id": 97924717, "body": "Hi, I still have not been able to figure it out... Any help?"}], "owner": {"reputation": 13, "user_id": 10993544, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217159607614965/picture?type=large", "display_name": "Usman Ijaz", "link": "https://stackoverflow.com/users/10993544/usman-ijaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552501733, "creation_date": 1552418097, "last_edit_date": 1592644375, "question_id": 55129127, "link": "https://stackoverflow.com/questions/55129127/rails-admin-home-button-messing-up-with-my-main-page", "title": "Rails Admin Home Button Messing up with my main page", "body": "<p>I have tried looking for an answer online regarding this but I can't seem to find any solution.\nI am using the rails_admin gem in my rails application. Everything seems to work fine but when I click the Home button in the Admin Workspace portal it messes up with the layout of my application, for which I have to refresh the page to get it back to normal. Would really appreciate help on this. Please check the images.</p>\n<p><img src=\"https://i.stack.imgur.com/gaYZj.png\" alt=\"Screen 1\" /> <img src=\"https://i.stack.imgur.com/zciu4.png\" alt=\"Home Button\" /> <img src=\"https://i.stack.imgur.com/NLF4a.png\" alt=\"Layout Error\" /></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested-forms"], "comments": [{"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 1, "creation_date": 1552417407, "post_id": 55128857, "comment_id": 96999437, "body": "Did you have the <code>accepts_nested_attributes_for</code> on your Purchase model?"}, {"owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "reply_to_user": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 0, "creation_date": 1552417548, "post_id": 55128857, "comment_id": 96999510, "body": "i do! forgot to include that in my code sample"}, {"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 1, "creation_date": 1552417639, "post_id": 55128857, "comment_id": 96999559, "body": "You should use <code>_attributes</code>, may you can try to use the address plural, like <code>addresses</code>, <code>addresses_attributes</code>"}, {"owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "reply_to_user": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 0, "creation_date": 1552419382, "post_id": 55128857, "comment_id": 97000427, "body": "no matter what i do, console output always says <code>unpermitted parameter: address</code>. also, <code>purchase</code> belongs to everything else, so <code>address</code> should remain singular, not plural. i think? also, i tried the <code>_attributes</code>. it says it in the controller code"}, {"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 1, "creation_date": 1552419694, "post_id": 55128857, "comment_id": 97000565, "body": "Wait, you have a error in your relations: Address has_many purchases? you cant create a address form a purchase with this relations. You shoud use Purchase has_many address instead, i will detail it in a answer"}, {"owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "reply_to_user": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 0, "creation_date": 1552419966, "post_id": 55128857, "comment_id": 97000680, "body": "Is that an error though? I want addresses to store only the <code>user_id</code>, so that they can be referenced in other <code>purchases</code>. It seems to me that doing this would require that <code>purchase</code> hold the foreign keys."}, {"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 1, "creation_date": 1552420220, "post_id": 55128857, "comment_id": 97000810, "body": "Why you don&#39;t relate it with a user model instead?"}, {"owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "reply_to_user": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 0, "creation_date": 1552420995, "post_id": 55128857, "comment_id": 97001181, "body": "Thank you for the help! My <code>address</code> is associated with the <code>user</code> model. It <code>belongs_to :user</code>. I could have something confused, but what I want is for the <code>purchase</code> model to hold the foreign keys for everything else - <code>sender</code>, <code>recipient</code>, <code>item</code>, and <code>address</code> - so that their records can be referenced in other <code>purchases</code>. A <code>sender</code> makes a <code>purchase</code> for an <code>item</code> and provides an <code>address</code>. The <code>item</code> has its own <code>address</code>, and was provided by a <code>recipient</code>. When the <code>purchase</code> is successfully transferred to the <code>sender</code>, the <code>item</code> <code>address</code> is changed to the new one"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1552424795, "post_id": 55128857, "comment_id": 97002856, "body": "Not only you have to use <code>address_attributes</code> in the strong params method, that&#39;s what your form should send too."}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1552422189, "post_id": 55129607, "comment_id": 97001772, "body": "You can use <code>accepts_nested_attributes_for</code> on a <code>belongs_to</code> association - you just need to set <code>optional: true</code> as the presence validation will get in the way."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1552423983, "post_id": 55129607, "comment_id": 97002528, "body": "The OP actually has the correct setup if you want to be able to link a single address to multiple purchases yet keep track of where a specific purchase was delivered. Inversing the foreign keys or placing it on the users table does not do the job."}], "tags": [], "owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "is_accepted": false, "score": 1, "last_activity_date": 1552420090, "creation_date": 1552420090, "answer_id": 55129607, "question_id": 55128857, "link": "https://stackoverflow.com/questions/55128857/should-nested-resources-and-strong-params-use-model-or-model-attributes-and/55129607#55129607", "title": "Should nested resources and strong params use &#39;model&#39; or &#39;model_attributes&#39; and why? (unpermitted parameter: model)", "body": "<p>You should use <code>address_attributes</code>. The problems is your relations:</p>\n\n<p>To use the <code>accepts_nested_attributes_for</code> you must use <code>has_many</code> or <code>has_one</code>, and you using <code>belongs_to</code>.</p>\n\n<p>In your case, relations are inverted, see: </p>\n\n<blockquote>\n  <p>Purchase belongs_to Address </p>\n  \n  <p>Address has_many purchases</p>\n</blockquote>\n\n<p>You can't create a address because according your relations, address is a parent model (of purchase) see <a href=\"https://www.pluralsight.com/guides/ruby-on-rails-nested-attributes\" rel=\"nofollow noreferrer\">this link</a>.</p>\n\n<blockquote>\n  <p>Nested Attributes is a feature that allows you to save attributes of a record through its associated parent.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 0, "creation_date": 1552439532, "post_id": 55130271, "comment_id": 97007205, "body": "Thank you for this! A couple things: <code>:address</code> <i>does</i> need to be present. And - I&#39;m still getting the <code>Unpermitted parameter: address</code> in console, even with <code>optional: true</code> and whitelisted <code>address_attributes</code>, and your form setup."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 1, "creation_date": 1552439858, "post_id": 55130271, "comment_id": 97007266, "body": "No - it has nothing to do with your associations. Rather you just have to make sure that your form is sending the right parameters and that you are whitelisting the correct parameters. I would start by reading the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html\" rel=\"nofollow noreferrer\">Rails API docs on nested attributes</a> and the <a href=\"https://edgeguides.rubyonrails.org/action_controller_overview.html#strong-parameters\" rel=\"nofollow noreferrer\">guides on whitelisting</a> instead of just relying on wild guesses."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 1, "creation_date": 1552440148, "post_id": 55130271, "comment_id": 97007324, "body": "The reason you are getting <code>Unpermitted parameter: address</code> is that <code>f.fields_for @address, as: :address</code> creates the wrong parameters."}, {"owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 0, "creation_date": 1552440520, "post_id": 55130271, "comment_id": 97007385, "body": "Thanks for continuing to offer help. I am using your suggestion for the form, tho: <code>&lt;%= f.fields_for :address do |address| %&gt;</code>. This whole issue is occurring in last step of a wizard (which uses <code>ActiveModel::Model</code>), and I&#39;m wondering if that has something to do with it."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 1, "creation_date": 1552440606, "post_id": 55130271, "comment_id": 97007407, "body": "Yeah, if you look at that params hash you can see that the root key is <code>transaction_wizard</code>."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 1, "creation_date": 1552440718, "post_id": 55130271, "comment_id": 97007431, "body": "Also you are not even passing the params whitelist to anything in your confirmation method."}, {"owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 0, "creation_date": 1552441131, "post_id": 55130271, "comment_id": 97007515, "body": "I&#39;ve updated my code with the <code>#confirm</code> and <code>#create</code> actions. The address params are being passed into <code>@transaction_wizard.transaction.attributes</code> and then into a session variable until everything is valid and can be created. Sorry for leaving that out before! I thought it was maybe not relevant."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 1, "creation_date": 1552441425, "post_id": 55130271, "comment_id": 97007584, "body": "There still are way to many question marks for me to be able to troubleshoot this line by line, and its kind of out of scope of your original question. You might want to setup a simple example of  nested attributes so that you actually understand how it works before trying to apply it to a very complex case"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 1, "creation_date": 1552441649, "post_id": 55130271, "comment_id": 97007639, "body": "Nested attributes is one of those things that trip up almost everybody when learning due to the complexity and that you have to get the model, view and controller right."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1552424892, "last_edit_date": 1552424892, "creation_date": 1552423045, "answer_id": 55130271, "question_id": 55128857, "link": "https://stackoverflow.com/questions/55128857/should-nested-resources-and-strong-params-use-model-or-model-attributes-and/55130271#55130271", "title": "Should nested resources and strong params use &#39;model&#39; or &#39;model_attributes&#39; and why? (unpermitted parameter: model)", "body": "<p>You can setup nested attributes through a belongs_to association but the association must be set as optional (unless you are using Rails 4 or earlier):</p>\n\n<pre><code>class Address &lt; ApplicationRecord\n  has_many :purcases\nend\n\nclass Purchase &lt; ApplicationRecord\n  belongs_to :address, optional: true\n  accepts_nested_attributes_for :address\nend\n</code></pre>\n\n<hr>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe Purchase, type: :model do\n  it \"accepts nested attributes\" do\n    purchase = Purchase.create!(address_attributes: { name:  'foo', street: 'bar' })\n    address = purchase.address\n    expect(address.persisted?).to be_truthy\n    expect(address.name).to eq 'foo'\n    expect(address.street).to eq 'bar'\n  end\nend\n</code></pre>\n\n<p>This is because nested attributes is built to work with <code>has_one</code> associations so the \"parent\" record is validated before the nested record so that the foreign key (the parent id) can be set on the nested record.</p>\n\n<p>You should be whitelisting <code>address_attributes</code>. Nested attributes creates a setter based on the first argument:</p>\n\n<pre><code>accepts_nested_attributes_for :foo\naccepts_nested_attributes_for :bars\n</code></pre>\n\n<p>This will accept <code>foo_attributes=</code> and <code>bars_attributes=</code>. This of course should follow the plurization of your assocation (singular for has_one/belongs_to, plural for has_many). </p>\n\n<p>The <code>address=</code> setter on your model has nothing to with nested attributes - its created by the <code>belongs_to :address</code> association and takes an Address instance. In fact if you whitelisted that param you will get an <code>ActiveRecord::AssociationTypeMismatch</code> exception.</p>\n\n<pre><code>irb(main):004:0&gt; Purchase.new.address = { street: 'foo' }\nActiveRecord::AssociationTypeMismatch: Address(#70264542836680) expected, got {:street=&gt;\"foo\"} which is an instance of Hash(#70264511691080)\n    from (irb):4\n</code></pre>\n\n<p>You also need to setup the form as:</p>\n\n<pre><code>&lt;%= f.fields_for :address do |address| %&gt;\n  # ...\n&lt;% end %&gt;\n</code></pre>\n\n<p>When using <code>fields_for</code> just pass the name of the association. You should not need to pass an instance and using <code>as: :address</code> gives the wrong parameter.</p>\n"}], "owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552440774, "creation_date": 1552417085, "last_edit_date": 1552440774, "question_id": 55128857, "link": "https://stackoverflow.com/questions/55128857/should-nested-resources-and-strong-params-use-model-or-model-attributes-and", "title": "Should nested resources and strong params use &#39;model&#39; or &#39;model_attributes&#39; and why? (unpermitted parameter: model)", "body": "<p>I have a nested form that creates an <code>@address</code> with each successful <code>@purchase</code>. </p>\n\n<p>My schema and model associations are set up so that <code>Purchase</code> holds the foreign keys for everything else:</p>\n\n<p><strong>address.rb</strong></p>\n\n<pre><code>belongs_to :user\nhas_many :purchases, foreign_key: :address_id\nhas_many :items, foreign_key: :address_id\n</code></pre>\n\n<p><strong>purchase.rb</strong></p>\n\n<pre><code>belongs_to :sender, class_name: \"User\"\nbelongs_to :recipient, class_name: \"User\"\nbelongs_to :address\nbelongs_to :item\naccepts_nested_attributes_for :address\n</code></pre>\n\n<p><strong>item.rb</strong></p>\n\n<pre><code>belongs_to :user\nhas_many :purchases, foreign_key: :item_id\nbelongs_to :address\n</code></pre>\n\n<p>I've found <a href=\"https://stackoverflow.com/questions/14656812/associationtypemismatch-object-expected-got-hashwithindifferentaccess-in-rail\">some answers</a> that suggest whitelisting the nested attribute params in my controller with a <code>.permit(address_attributes: [:name])</code> in the controller instead of <code>.permit(address: [:name])</code>, but neither of the two create the record.</p>\n\n<p><strong>purchases_controller.rb</strong></p>\n\n<pre><code>def confirmation\n @item = Item.friendly.find(params[:item_id])\n @address = @transaction_wizard.transaction.build_address\nend\n\ndef confirm\n current_step = params[:current_step]\n @item = Item.friendly.find(params[:item_id])\n @transaction_wizard = wizard_transaction_for_step(current_step)\n @transaction_wizard.transaction.attributes = address_params\n session[:transaction_attributes] = @transaction_wizard.transaction.attributes\n\n if @transaction_wizard.valid?\n  next_step = wizard_transaction_next_step(current_step)\n  create and return unless next_step\n\n  redirect_to action: next_step\n else\n  redirect_to action: current_step\n end\nend\n\ndef create\n if @transaction_wizard.transaction.save\n  redirect_to root_path, notice: \"Bid sent. If you would like to cancel before it's approved, you can do so #{view_context.link_to('here', transactions_sent_unapproved_path)}.\".html_safe\n else\n  redirect_to item_path(@transaction_wizard.transaction.item), notice: 'There was a problem making this bid.'\n end\nend\n\nprivate\ndef address_params\n params.require(:transaction_wizard).permit(address_attributes: [:name, :street, :street_2, :city, :state, :zip_code])\nend\n</code></pre>\n\n<p>Whether I use <code>address_attributes</code> or <code>address</code>, the result is the same:</p>\n\n<pre><code>Parameters: {\"transaction_wizard\"=&gt;\n             {\"address\"=&gt;\n              {\"name\"=&gt;\"name\", \n               \"street\"=&gt;\"123 st\", \n               \"street_2\"=&gt;\"apt 5\", \n               \"state\"=&gt;\"AL\", \n               \"zip_code\"=&gt;\"48489\"}\n             }, \n             \"current_step\"=&gt;\"confirmation\", \n             \"commit\"=&gt;\"Complete offer\", \n             \"item_id\"=&gt;\"friendly-item-id\"\n            }\nUnpermitted parameter: address\n</code></pre>\n\n<p>This is my form:</p>\n\n<pre><code>&lt;%= form_for @transaction_wizard, as: :transaction_wizard, url: confirm_item_transaction_wizard_path(@item) do |f| %&gt;\n &lt;%= f.fields_for :address do |address| %&gt;\n  &lt;%= address.text_field :name %&gt;\n  &lt;%= address.text_field :street %&gt;\n  &lt;%= address.text_field :street_2 %&gt;\n  &lt;%= address.text_field :city %&gt;\n  &lt;%= address.text_field :state %&gt;\n  &lt;%= address.text_field :zip_code %&gt;\n &lt;% end %&gt;\n\n &lt;%= f.submit \"Submit\" } %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What gives? How can I make my controller accept these params?</p>\n\n<hr>\n\n<p>Update: Changing <code>address</code> to <code>addresses</code> requires that I change that <code>@address</code> variable in the controller to <code>@address = @transaction_wizard.transaction.build_addresses</code>. This causes an <code>uninitialized constant Transaction::Addresses</code> error. </p>\n"}, {"tags": ["ruby", "google-calendar-api"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7560488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4b4a07c3a9ab72b3b2ae168645df680?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando", "link": "https://stackoverflow.com/users/7560488/fernando"}, "edited": false, "score": 0, "creation_date": 1552582766, "post_id": 55135197, "comment_id": 97075634, "body": "I found the problem, the problem was that rails creates a record using UTC as default time zone. So I had to change, the default timezone. TY."}], "tags": [], "owner": {"reputation": 717, "user_id": 10549958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e4512e217a4ac6ce060785ece3e7a3?s=128&d=identicon&r=PG&f=1", "display_name": "Jacque", "link": "https://stackoverflow.com/users/10549958/jacque"}, "is_accepted": true, "score": 1, "last_activity_date": 1552456115, "creation_date": 1552456115, "answer_id": 55135197, "question_id": 55128590, "link": "https://stackoverflow.com/questions/55128590/google-calendar-api-ruby-datetime-timezone/55135197#55135197", "title": "Google calendar API ruby, datetime timezone", "body": "<p>You are inputting the time as <code>17:50:00</code> in <code>UTC+0</code> (the <code>+00:00</code> from your <code>date_time</code> stands for <code>UTC</code> or <code>UTC+0</code>), however, you specified a <code>time_zone</code> where you used Monterrey which follows the time zone <code>UTC-6</code>.</p>\n\n<p>My guess here is that, your code takes <code>17:50:00</code> in <code>UTC+0</code> then converts it to Monterrey time zone <code>UTC-6</code> which results to <code>11:50:00</code>. Either try removing the <code>+00:00</code> or try making it <code>-06:00</code>.</p>\n"}], "owner": {"reputation": 47, "user_id": 7560488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4b4a07c3a9ab72b3b2ae168645df680?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando", "link": "https://stackoverflow.com/users/7560488/fernando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 55135197, "answer_count": 1, "score": 1, "last_activity_date": 1552456115, "creation_date": 1552415957, "last_edit_date": 1552420938, "question_id": 55128590, "link": "https://stackoverflow.com/questions/55128590/google-calendar-api-ruby-datetime-timezone", "title": "Google calendar API ruby, datetime timezone", "body": "<p>I have this code. which creates a event in my google calendar.</p>\n\n<pre><code>    client = Signet::OAuth2::Client.new(client_options)\n    client.update!(session[:authorization])\n\n    service = Google::Apis::CalendarV3::CalendarService.new\n    service.authorization = client\n\n    event = Google::Apis::CalendarV3::Event.new({\n        start: Google::Apis::CalendarV3::EventDateTime.new(\n            date_time: cf_event.starts_at.to_datetime.rfc3339,\n            time_zone: 'America/Monterrey'\n        ),\n        end: Google::Apis::CalendarV3::EventDateTime.new(\n            date_time: cf_event.ends_at.to_datetime.rfc3339,\n            time_zone: 'America/Monterrey'  \n        ),\n\n        summary: cf_event.title\n    })\n</code></pre>\n\n<p>It is a basic example my <code>cf_event</code> object has the <code>starts_at</code> attr, which is a timeWithZone.</p>\n\n<p>so i had to do <code>cf_event.starts_at.to_datetime.rfc3339</code>.</p>\n\n<p>Output \n    \"2019-03-15T17:50:00+00:00\"</p>\n\n<p>The problem is, that the code creates, the event but with -6 hours.</p>\n\n<p>If i go to google calendars my event it\u00b4s the day 15 at (11 - 11:50), and not (17 - 17:50)</p>\n\n<p>what am i doing wrong?</p>\n"}, {"tags": ["css", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552416140, "post_id": 55128582, "comment_id": 96998801, "body": "Probably another CSS overwrites your code (has higher priority). To verify that, use <code>font-weight: bold !important;</code> and check if the label is bold."}, {"owner": {"reputation": 1, "user_id": 10985390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CsA0po66_7A/AAAAAAAAAAI/AAAAAAAAL34/C1J9bZn60_U/photo.jpg?sz=128", "display_name": "Kunal Narang", "link": "https://stackoverflow.com/users/10985390/kunal-narang"}, "reply_to_user": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552418860, "post_id": 55128582, "comment_id": 97000176, "body": "Hi, I used your approach, and after making your modification it works! Thanks! I got confused because I did not see any overwriting behavior from the other style sheets."}, {"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552418954, "post_id": 55128582, "comment_id": 97000227, "body": "Definitely there is something because <code>!important</code> priorities the &quot;attribute&quot;. I will post my comment as a reply so it will be visible to everyone."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1552434824, "post_id": 55128582, "comment_id": 97006213, "body": "You should note that using <code>!important</code> is the nuclear option and generally not a good idea. <a href=\"https://j11y.io/css/dont-use-important/\" rel=\"nofollow noreferrer\">j11y.io/css/dont-use-important</a>"}, {"owner": {"reputation": 1, "user_id": 10985390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CsA0po66_7A/AAAAAAAAAAI/AAAAAAAAL34/C1J9bZn60_U/photo.jpg?sz=128", "display_name": "Kunal Narang", "link": "https://stackoverflow.com/users/10985390/kunal-narang"}, "edited": false, "score": 0, "creation_date": 1552436431, "post_id": 55128582, "comment_id": 97006608, "body": "Is there any way to avoid using !important then?"}, {"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1552459408, "post_id": 55128582, "comment_id": 97012185, "body": "@KunalNarang of course there is :) You have to check what CSS rule is more important than yours. Here is a guide how to check which CSS rule is used: <a href=\"https://atendesigngroup.com/blog/how-determine-which-css-styling-element\" rel=\"nofollow noreferrer\">atendesigngroup.com/blog/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "is_accepted": false, "score": 1, "last_activity_date": 1552418986, "creation_date": 1552418986, "answer_id": 55129344, "question_id": 55128582, "link": "https://stackoverflow.com/questions/55128582/how-to-apply-specific-formatting-to-a-label-in-rails/55129344#55129344", "title": "How to apply specific formatting to a label in rails", "body": "<p>Probably another CSS overwrites your code (has higher priority). </p>\n\n<p>To verify that, use <code>font-weight: bold !important;</code> and check if the label is bold.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 3911151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae59218fb690f911b47bbf992f63d50?s=128&d=identicon&r=PG&f=1", "display_name": "Aula", "link": "https://stackoverflow.com/users/3911151/aula"}, "is_accepted": false, "score": 0, "last_activity_date": 1563454635, "creation_date": 1563454635, "answer_id": 57095017, "question_id": 55128582, "link": "https://stackoverflow.com/questions/55128582/how-to-apply-specific-formatting-to-a-label-in-rails/57095017#57095017", "title": "How to apply specific formatting to a label in rails", "body": "<p>Write your label like:</p>\n\n<pre><code>&lt;label for=\"name\"&gt;Name&lt;/label&gt;\n</code></pre>\n\n<p>The write your css like:</p>\n\n<pre><code>label[for=\"name\"]{\n/*write your styles here*/\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10985390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CsA0po66_7A/AAAAAAAAAAI/AAAAAAAAL34/C1J9bZn60_U/photo.jpg?sz=128", "display_name": "Kunal Narang", "link": "https://stackoverflow.com/users/10985390/kunal-narang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563454635, "creation_date": 1552415926, "question_id": 55128582, "link": "https://stackoverflow.com/questions/55128582/how-to-apply-specific-formatting-to-a-label-in-rails", "title": "How to apply specific formatting to a label in rails", "body": "<p>I want to make the email label bold in my _email.html.erb view. For doing this I mentioned this in my _email.html.erb:</p>\n\n<pre><code>&lt;tr&gt;\n  &lt;td&gt;&lt;label for=\"user_email\" class=\"label_account_request\"&gt;E-mail address: &lt;/label&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;%= text_field 'user', 'email', class: \"form-control width-250\"  %&gt;&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>My application using some custom formats like this:</p>\n\n<pre><code>@import \"font-awesome\";\n@import \"jquery.ui.all\";\n@import \"jquery.datetimepicker\";\n@import \"ajaxtabs\";\n@import \"balloontip\";\n@import \"colorbox\";\n@import \"dddropdownpanel\";\n@import \"flash_messages\";\n@import \"grades\";\n@import \"goldberg\";\n@import \"layout_2\";\n@import \"redbox\";\n@import \"react-simpletabs/dist/react-simpletabs\";\n@import \"jquery.datetimepicker\";\n$icon-font-path: \"bootstrap-sass/assets/fonts/bootstrap/\";\n@import \"bootstrap-sass/assets/stylesheets/bootstrap-sprockets\";\n@import \"bootstrap-sass/assets/stylesheets/bootstrap\";\n@import \"navbar\";\n@import \"tree_display\";\n@import \"awesomplete\";\n@import \"user_pastebins\";\n@import \"login_form\";\n@import \"three_state_toogle\";\n@import \"table_sorter\";\n@import \"response\";\n@import \"confirm_box\";\n@import \"inner-pages\";\n@import \"homepage\";\n@import \"account_request\";\n</code></pre>\n\n<p>The file that I am trying to use is account_request.scss. It's contents are :</p>\n\n<pre><code>.label_account_request{\n  font-weight: bold;\n}\n</code></pre>\n\n<p>However, I am not able to view the result of my email field. Here is a screenshot. What do I need to change in my code?</p>\n\n<p><a href=\"https://i.stack.imgur.com/20qtm.png\" rel=\"nofollow noreferrer\">Screenshot</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1500, "user_id": 2566838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f56a6e1b74d7ba48be15b92e244e9a93?s=128&d=identicon&r=PG", "display_name": "Dave Powers", "link": "https://stackoverflow.com/users/2566838/dave-powers"}, "edited": false, "score": 0, "creation_date": 1552418827, "post_id": 55128465, "comment_id": 97000155, "body": "Are you trying to set the page title using an HTML title tag? Or are you simply rendering this text to the page? Also, are these actions all part of the same controller?"}, {"owner": {"reputation": 779, "user_id": 6767060, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tBxeApcpf2E/AAAAAAAAAAI/AAAAAAAACuo/qF9nJcUnUoI/photo.jpg?sz=128", "display_name": "Guy Yogev", "link": "https://stackoverflow.com/users/6767060/guy-yogev"}, "edited": false, "score": 0, "creation_date": 1552420100, "post_id": 55128465, "comment_id": 97000751, "body": "Looks like a classic <a href=\"https://stackoverflow.com/questions/948135/how-to-write-a-switch-statement-in-ruby\">switch case</a>"}, {"owner": {"reputation": 3, "user_id": 10386813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jg2Qyybmt5w/AAAAAAAAAAI/AAAAAAAAAAg/00fqvVdn8Mk/photo.jpg?sz=128", "display_name": "Caroline Nguyen", "link": "https://stackoverflow.com/users/10386813/caroline-nguyen"}, "reply_to_user": {"reputation": 1500, "user_id": 2566838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f56a6e1b74d7ba48be15b92e244e9a93?s=128&d=identicon&r=PG", "display_name": "Dave Powers", "link": "https://stackoverflow.com/users/2566838/dave-powers"}, "edited": false, "score": 0, "creation_date": 1552424512, "post_id": 55128465, "comment_id": 97002732, "body": "@DavePowers I&#39;m trying to utilize DRY in my HTML code so I want to render the text to the page. All the actions are in different controllers, that&#39;s why I put my method in application_helper."}], "answers": [{"comments": [{"owner": {"reputation": 1500, "user_id": 2566838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f56a6e1b74d7ba48be15b92e244e9a93?s=128&d=identicon&r=PG", "display_name": "Dave Powers", "link": "https://stackoverflow.com/users/2566838/dave-powers"}, "edited": false, "score": 0, "creation_date": 1552423777, "post_id": 55129938, "comment_id": 97002433, "body": "This won&#39;t work as written. The <a href=\"https://apidock.com/rails/ActionView/Helpers/UrlHelper/current_page%3f\" rel=\"nofollow noreferrer\"><code>current_page?</code> method</a> is missing a required argument."}, {"owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "reply_to_user": {"reputation": 1500, "user_id": 2566838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f56a6e1b74d7ba48be15b92e244e9a93?s=128&d=identicon&r=PG", "display_name": "Dave Powers", "link": "https://stackoverflow.com/users/2566838/dave-powers"}, "edited": false, "score": 1, "creation_date": 1552425218, "post_id": 55129938, "comment_id": 97003010, "body": "@DavePowers Thanks for spotting that. I&#39;ve made an edit to use <code>current_path</code> instead. Funny how both answers missed the same thing."}, {"owner": {"reputation": 3, "user_id": 10386813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jg2Qyybmt5w/AAAAAAAAAAI/AAAAAAAAAAg/00fqvVdn8Mk/photo.jpg?sz=128", "display_name": "Caroline Nguyen", "link": "https://stackoverflow.com/users/10386813/caroline-nguyen"}, "edited": false, "score": 0, "creation_date": 1552431324, "post_id": 55129938, "comment_id": 97005293, "body": "@Unixmonkey I keep getting an <code>undefined local variable or method &#39;current_path&#39;</code> error using <code>case current_path</code>. Tried a couple different combos and nothing&#39;s worked so far."}, {"owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "reply_to_user": {"reputation": 3, "user_id": 10386813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jg2Qyybmt5w/AAAAAAAAAAI/AAAAAAAAAAg/00fqvVdn8Mk/photo.jpg?sz=128", "display_name": "Caroline Nguyen", "link": "https://stackoverflow.com/users/10386813/caroline-nguyen"}, "edited": false, "score": 0, "creation_date": 1552433658, "post_id": 55129938, "comment_id": 97005928, "body": "@CarolineNguyen Sorry, I forgot that <code>current_path</code> isn&#39;t built-in to Rails. I&#39;ve edited the answer with a simple implementation that should work for you."}, {"owner": {"reputation": 3, "user_id": 10386813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jg2Qyybmt5w/AAAAAAAAAAI/AAAAAAAAAAg/00fqvVdn8Mk/photo.jpg?sz=128", "display_name": "Caroline Nguyen", "link": "https://stackoverflow.com/users/10386813/caroline-nguyen"}, "edited": false, "score": 0, "creation_date": 1552434018, "post_id": 55129938, "comment_id": 97006011, "body": "Works perfectly! Thank you so much!"}], "tags": [], "owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "is_accepted": true, "score": 0, "last_activity_date": 1552433565, "last_edit_date": 1552433565, "creation_date": 1552421483, "answer_id": 55129938, "question_id": 55128465, "link": "https://stackoverflow.com/questions/55128465/generating-page-headings-by-path-in-rails/55129938#55129938", "title": "Generating Page Headings by Path in Rails", "body": "<p>A more compact way would be with a case statement:</p>\n\n<pre><code>def current_path\n  request.env['PATH_INFO']\nend\n\ndef page_headings\n  case current_path\n  when about_path then \"about\"\n  when members_path then \"members\"\n  when sponsors_path then \"sponsors\"\n  when events_path then \"events\"\n  when membership_path then \"join us\"\n  when womens_path then \"women's page\"\n  when new_session_path then \"log in\"\n  when new_user_path then \"register\"\n  else\n    puts \"PAGE TITLE MISSING\" if Rails.env.development?\n    \"My App Name\"\n  end\nend\n</code></pre>\n\n<p>However a common pattern for this in Rails is to consider the title as part of the view layer, and use <code>provide</code> and <code>yield</code> from your views like this:</p>\n\n<pre><code># app/layouts/application.html.erb\n&lt;title&gt;&lt;%= yield(:title) + ' | ' if content_for?(:title) %&gt;My App&lt;/title&gt;\n\n# app/views/about/index.html.erb\n&lt;% provide(:title, \"About\") %&gt;\n&lt;h1&gt;About&lt;/h1&gt;\n\n# app/views/sponsors/index.html.erb\n&lt;% provide(:title, \"Sponsored by #{@sponsor.name}\") %&gt;\n&lt;h1&gt;Sponsored by &lt;%= @sponsor.name %&gt;&lt;/h1&gt;\n</code></pre>\n\n<p>The upside of the case statement is it's easy to keep everything all in one place, but the downside is that it's far away from where you actually define what a page looks like, and could potentially use content from instance variables in the title.</p>\n"}], "owner": {"reputation": 3, "user_id": 10386813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jg2Qyybmt5w/AAAAAAAAAAI/AAAAAAAAAAg/00fqvVdn8Mk/photo.jpg?sz=128", "display_name": "Caroline Nguyen", "link": "https://stackoverflow.com/users/10386813/caroline-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 55129938, "answer_count": 1, "score": 0, "last_activity_date": 1552433565, "creation_date": 1552415460, "last_edit_date": 1552425398, "question_id": 55128465, "link": "https://stackoverflow.com/questions/55128465/generating-page-headings-by-path-in-rails", "title": "Generating Page Headings by Path in Rails", "body": "<p>I'm trying to auto generate page headings by path and currently I have this in my application_helper. The method works but is there a simpler way to write this?</p>\n\n<pre><code>def page_headings\n  if current_page? about_path\n    \"about\"\n  elsif\n    current_page? members_path\n      \"members\"\n  elsif\n    current_page? sponsors_path\n      \"sponsors\"\n  elsif\n    current_page? events_path\n      \"events\"\n  elsif\n    current_page? membership_path\n      \"join us\"\n  elsif\n    current_page? womens_path\n      \"women's page\"\n  elsif\n    current_page? new_session_path\n      \"log in\"\n  elsif\n    current_page? new_user_path\n      \"register\"\n  end\nend\n</code></pre>\n\n<p>Then, in my partial, I add this:</p>\n\n<pre><code>&lt;%= page_headings.upcase %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "irb"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552416692, "post_id": 55128369, "comment_id": 96999085, "body": "Python behaves this way because there assignment is a <i>statement</i> (that is, doesn&#39;t have value). In ruby assignment is an expression, with everything that this entails."}, {"owner": {"reputation": 6388, "user_id": 436287, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71203ed4d0cb59fa9334380fc9d1ea5b?s=128&d=identicon&r=PG", "display_name": "onlynone", "link": "https://stackoverflow.com/users/436287/onlynone"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552503606, "post_id": 55128369, "comment_id": 97039210, "body": "@SergioTulentsev yeah, I see what you&#39;re saying. Also if a python expression returns <code>None</code> the console doesn&#39;t print anything. I just with there was a way to prevent irb from printing the output of an expression if the expression was assignment"}], "answers": [{"tags": [], "owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "is_accepted": false, "score": 0, "last_activity_date": 1552416778, "creation_date": 1552416778, "answer_id": 55128783, "question_id": 55128369, "link": "https://stackoverflow.com/questions/55128369/prevent-ruby-rails-from-printing-results-of-assignment-expressions/55128783#55128783", "title": "Prevent ruby/rails from printing results of assignment expressions", "body": "<p>I guess it is caused by the fact that in Ruby assignment returns the assigned value automatically, i.e.</p>\n\n<pre><code>a = 1\n#=&gt; 1\n</code></pre>\n\n<p>If you dig into documentation for <code>conf.echo</code> you will see that it is used to control whatever to print return value or not.</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1552416923, "post_id": 55128802, "comment_id": 96999194, "body": "That&#39;s not <i>quite</i> what&#39;s being asked though. They only want to suppress output from assignments."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1552418257, "post_id": 55128802, "comment_id": 96999877, "body": "@SergioTulentsev that&#39;s a good distinction, I glossed over that when I was reading. I don&#39;t think there&#39;s a setting for that behavior in IRB but this might be good enough for now. I just add a <code>;</code> after a statement (in pry) when I want to suppress output"}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 0, "last_activity_date": 1552416851, "creation_date": 1552416851, "answer_id": 55128802, "question_id": 55128369, "link": "https://stackoverflow.com/questions/55128369/prevent-ruby-rails-from-printing-results-of-assignment-expressions/55128802#55128802", "title": "Prevent ruby/rails from printing results of assignment expressions", "body": "<p>Create a file named <code>.irbrc</code> in your <code>~</code> folder, or in your current folder. Inside, add:</p>\n\n<pre><code>IRB.conf[:ECHO] = false\n</code></pre>\n\n<p>That should disable echo.</p>\n\n<p>If you <code>puts IRB.conf</code> you'll see other settings you can adjust as well.</p>\n\n<p>More info is found in the <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/irb/rdoc/IRB.html#module-IRB-label-Configuration\" rel=\"nofollow noreferrer\">irb documentation</a></p>\n"}, {"tags": [], "owner": {"reputation": 6388, "user_id": 436287, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71203ed4d0cb59fa9334380fc9d1ea5b?s=128&d=identicon&r=PG", "display_name": "onlynone", "link": "https://stackoverflow.com/users/436287/onlynone"}, "is_accepted": true, "score": 1, "last_activity_date": 1610049325, "last_edit_date": 1610049325, "creation_date": 1553112278, "answer_id": 55269316, "question_id": 55128369, "link": "https://stackoverflow.com/questions/55128369/prevent-ruby-rails-from-printing-results-of-assignment-expressions/55269316#55269316", "title": "Prevent ruby/rails from printing results of assignment expressions", "body": "<h3>Edit:</h3>\n<p>A version of the MR referenced below was merged to irb, but tweaked a few times since then. So to get the behavior you want it depends on the irb version:</p>\n<p>If you have at least <code>1.2.0</code>, but less than <code>1.2.6</code>: the default behavior is to <em>not</em> print anything for assignment statements. You have to set <code>IRB.conf[:ECHO_ON_ASSIGNMENT] = true</code> if you want the old behavior (of always printing everything).</p>\n<p>If you have <code>1.2.6</code>, the default value for <code>ECHO_ON_ASSIGNMENT</code> was changed to <code>true</code>, and a new config value: <code>OMIT_ON_ASSIGNMENT</code> was added which will truncate long output for assignment statements, it defaults to <code>true</code>. So you have to set <code>IRB.conf[:ECHO_ON_ASSIGNMENT] = false</code> if you don't want anything to be printed for assignment statements. You have to set <code>IRB.conf[:OMIT_ON_ASSIGNMENT] = false</code> if you want the old behavior (of always printing everything).</p>\n<p>If you have <code>1.2.7</code> or above, <code>OMIT_ON_ASSIGNMENT</code> was removed in favor of letting <code>ECHO_ON_ASSIGNMENT</code> accept <code>true</code>, <code>false</code>, or <code>:truncate</code>, with the default value being <code>:truncate</code>. A value of <code>true</code> will print everything for assignment statements, <code>false</code> will print nothing, and <code>:truncate</code> will print a truncated version (like setting <code>OMIT_ON_ASSIGNMENT</code> to <code>true</code> in <code>1.2.6</code>).</p>\n<p>Note that the versions above versions of the <em>irb</em> gem, not ruby versions (even though <code>irb</code> is included in ruby's standard library). You can check what version of <code>irb</code> you have by looking at <code>IRB::VERSION</code>. Very old versions of <code>irb</code> don't set this constant, so if it's missing, you definitely have a version lower than <code>1.2.0</code>.</p>\n<h3>Original answer:</h3>\n<p>Until <a href=\"https://github.com/ruby/irb/pull/12\" rel=\"nofollow noreferrer\">this pull request</a> (or one like it) is merged, you can put the following into your <code>~/.irbrc</code> file:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>require 'ripper'\nmodule IRB\n  class Irb\n    ASSIGNMENT_NODE_TYPES = [:assign, :opassign, :massign]\n    def assignment_expression?(line)\n      ASSIGNMENT_NODE_TYPES.include?(Ripper.sexp(line)&amp;.dig(1,-1,0))\n    end\n\n    def output_value # :nodoc:\n      return if assignment_expression?(@context.last_line)\n      printf @context.return_format, @context.inspect_last_value\n    end\n  end\n\n  class Context\n    attr_accessor :last_line\n    def evaluate(line, line_no, exception: nil) # :nodoc:\n      @line_no = line_no\n      @last_line = line\n      if exception\n        line = &quot;begin ::Kernel.raise _; rescue _.class; #{line}; end&quot;\n        @workspace.local_variable_set(:_, exception)\n      end\n      set_last_value(@workspace.evaluate(self, line, irb_path, line_no))\n    end\n  end\nend\n</code></pre>\n<p>Note that since this monkey-patches <code>IRB::Irb</code> and <code>IRB::Context</code>, there's no guarantee that it will be compatible with future releases.</p>\n"}], "owner": {"reputation": 6388, "user_id": 436287, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71203ed4d0cb59fa9334380fc9d1ea5b?s=128&d=identicon&r=PG", "display_name": "onlynone", "link": "https://stackoverflow.com/users/436287/onlynone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 55269316, "answer_count": 3, "score": 1, "last_activity_date": 1610049325, "creation_date": 1552415124, "last_edit_date": 1553695505, "question_id": 55128369, "link": "https://stackoverflow.com/questions/55128369/prevent-ruby-rails-from-printing-results-of-assignment-expressions", "title": "Prevent ruby/rails from printing results of assignment expressions", "body": "<p>When I do something like this in rails:</p>\n\n<pre><code>irb(main):060:0&gt; users = User.where(name: \"Joe\")\n</code></pre>\n\n<p>The console will evaluate <code>users</code> and print it out (maybe with <code>inspect</code>, or <code>to_s</code>, I'm not 100% sure). This results in hundreds of lines of output that I don't really want.</p>\n\n<p>I know I can do something like this to prevent the output on one specific line:</p>\n\n<pre><code>irb(main):060:0&gt; users = User.where(name: \"Joe\"); nil\n</code></pre>\n\n<p>Because <code>nil</code> will be evaluated and printed out instead of <code>users</code>.</p>\n\n<p>I could also turn off all evaluations with:</p>\n\n<pre><code>irb(main):060:0&gt; conf.echo = false\n</code></pre>\n\n<p>The first solutions is annoying because you have to remember to add that on every line you want to suppress output. And the second is annoying, because sometimes you do want output. Many times you just want to type the name of a variable to have it printed.</p>\n\n<p>Python doesn't seem to have this problem. If I type <code>a = {1: 2}</code>, the python shell doesn't evaluate <code>a</code>, it just shows the prompt again. But if I type <code>{1: 2}</code> or just <code>a</code>, it does print out the value.</p>\n\n<p>It seems like python's console checks whether there's a left-hand-side of the statement being evaluated to decide whether to print the result or not.</p>\n\n<h3>Question:</h3>\n\n<p>Can something like that be done in ruby's console? So that statements like <code>a = {1 =&gt; 2}</code> are not evaluated, but statements like <code>a</code> and <code>{1 =&gt; 2}</code> are?</p>\n\n<h3>Update:</h3>\n\n<p>I pushed this merge request to the irb repo, perhaps it'll be accepted and then there <em>will</em> be a way: <a href=\"https://github.com/ruby/irb/pull/12\" rel=\"nofollow noreferrer\">https://github.com/ruby/irb/pull/12</a> .</p>\n"}, {"tags": ["ruby", "selenium", "google-chrome", "selenium-webdriver", "capybara"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1552414304, "post_id": 55128031, "comment_id": 96997846, "body": "You should not be minimizing the window, but it should work in Chromes headless mode, assuming the page is not detecting headless mode and showing different content - how are you enabling headless? What version of Capybara are you using?"}, {"owner": {"reputation": 837, "user_id": 1200751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d0f34945e7331ffadd9a044d9158fa15?s=128&d=identicon&r=PG", "display_name": "wachichornia", "link": "https://stackoverflow.com/users/1200751/wachichornia"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1552414656, "post_id": 55128031, "comment_id": 96998027, "body": "headless is enabled by default with kimurai according to their github: <a href=\"https://github.com/vifreefly/kimuraframework#available-engines\" rel=\"nofollow noreferrer\">github.com/vifreefly/kimuraframework#available-engines</a>  :selenium_chrome Chrome in headless mode driven by selenium. Modern headless browser solution with proper javascript rendering.   I&#39;m using capybara 3.14"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1552415607, "post_id": 55128031, "comment_id": 96998530, "body": "Have you tried outputting <code>browser.html</code> to see what the page actually is, and verify the page isn&#39;t detecting headless mode and displaying alternate content. -- Also if you just want the first matching element, you&#39;re going to be better off using <code>first</code> rather than <code>all</code> and indexing."}, {"owner": {"reputation": 837, "user_id": 1200751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d0f34945e7331ffadd9a044d9158fa15?s=128&d=identicon&r=PG", "display_name": "wachichornia", "link": "https://stackoverflow.com/users/1200751/wachichornia"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1552420816, "post_id": 55128031, "comment_id": 97001091, "body": "You&#39;re right! It is displaying alternate content! I output the HTML and the whole website was replaced by a big message &quot;Oops! This window is too narrow for your calendar.&quot; Widening it!"}, {"owner": {"reputation": 894, "user_id": 3512053, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eNnJE.jpg?s=128&g=1", "display_name": "Asyranok", "link": "https://stackoverflow.com/users/3512053/asyranok"}, "edited": false, "score": 1, "creation_date": 1552422187, "post_id": 55128031, "comment_id": 97001771, "body": "I don&#39;t personally run headless mode, but I know that running headless for chrome can be wonky if you do not explicitly set the window size (even though there is no visible window). I&#39;ve never touched Ruby, so I don&#39;t know the syntax here, but find the Ruby Selenium API to set the window size to what would be a normal size that renders content as you would expect. This may fix that issue you mention about, and will help with the driver clicking the x,y coordinates it intends to click."}], "owner": {"reputation": 837, "user_id": 1200751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d0f34945e7331ffadd9a044d9158fa15?s=128&d=identicon&r=PG", "display_name": "wachichornia", "link": "https://stackoverflow.com/users/1200751/wachichornia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552413856, "creation_date": 1552413856, "question_id": 55128031, "link": "https://stackoverflow.com/questions/55128031/ruby-kimurai-capybara-selenium-chrome-clicking-only-works-when-the-window-is-vi", "title": "Ruby/Kimurai/Capybara/Selenium/Chrome: clicking only works when the window is visible. Is this expected behaviour?", "body": "<p>This code works perfectly well when I have headless=false and the browser window is actually on the screen:</p>\n\n<pre><code>require 'kimurai'\nrequire \"capybara\"\nrequire \"capybara/sessionkeeper\"\n\nCapybara.register_driver :chrome do |app|\n  Capybara::Selenium::Driver.new(app, browser: :chrome)\nend\n\nclass SimpleSpider &lt; Kimurai::Base\n  @name = \"simple_spider\"\n  @engine = :selenium_chrome\n  @start_urls = [\"some_url\"]\n  @config = {\n    cookies: YAML.load_file('./config/cookies.yml')\n  }\n\n  def parse(response, url:, data: {})\n    yaml_str = browser.cookies_to_yaml\n    File.write('./config/cookies.yml', yaml_str)\n    browser.all(:xpath, '//div[contains(text(), \"17\")]')[0].click \n  end\nend\n\nSimpleSpider.crawl!\n</code></pre>\n\n<p>If I run it in headless mode or I simply minimize the window, I get an error:</p>\n\n<pre><code>undefined method `click' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p>Is this normal? does the screen has to be on the display for this to work? If not, how to fix it?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "edited": false, "score": 2, "creation_date": 1552413256, "post_id": 55127567, "comment_id": 96997316, "body": "It&#39;s <i>extremely</i> bad idea to use model callbacks for sending emails. I&#39;d suggest moving the mailers-related stuff to the controllers layer instead..."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11006464, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oCi39JL4Ek8/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN0xELL9rAft-JmGLcHxSfF4WFf5A/mo/photo.jpg?sz=128", "display_name": "kimchi_sweet_kimchi", "link": "https://stackoverflow.com/users/11006464/kimchi-sweet-kimchi"}, "is_accepted": false, "score": -3, "last_activity_date": 1552413464, "creation_date": 1552413464, "answer_id": 55127921, "question_id": 55127567, "link": "https://stackoverflow.com/questions/55127567/send-email-after-user-delete-account-before-destroy-in-rails-5/55127921#55127921", "title": "Send email after user delete account (before_destroy) in rails 5", "body": "<p>I think that it is your delete method and not your callback that doesn't work. Just try to replace it by 'destroy', and it should work fine.</p>\n"}, {"tags": [], "owner": {"reputation": 1113, "user_id": 4701098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QnL4.jpg?s=128&g=1", "display_name": "Samy Kacimi", "link": "https://stackoverflow.com/users/4701098/samy-kacimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1552469563, "creation_date": 1552469563, "answer_id": 55138432, "question_id": 55127567, "link": "https://stackoverflow.com/questions/55127567/send-email-after-user-delete-account-before-destroy-in-rails-5/55138432#55138432", "title": "Send email after user delete account (before_destroy) in rails 5", "body": "<p>As @konstantin-strukov suggests, you should avoid using callbacks, especially for sending emails. You are out of the scope of what a Model is supposed to do in MVC, i.e interacting with the database.</p>\n\n<p>You could move this in the controller, for instance :</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  ...\n  def destroy\n    UserMailer.bye_email(@user).deliver_now\n    @user.destroy!\n\n    redirect_to ...\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10835737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Qyx1mYciteo/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYbQivn5FXtcQYAsRNLMinrljjjHg/mo/photo.jpg?sz=128", "display_name": "Amine ", "link": "https://stackoverflow.com/users/10835737/amine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552574682, "creation_date": 1552412226, "last_edit_date": 1552574682, "question_id": 55127567, "link": "https://stackoverflow.com/questions/55127567/send-email-after-user-delete-account-before-destroy-in-rails-5", "title": "Send email after user delete account (before_destroy) in rails 5", "body": "<p>I'm kinda new to ruby, so my problem is I'm trying to send an email after user creation, update and deletion.</p>\n\n<p>It works for create and update, I do receive confirmation's email, but it doesn't work for the <code>destroy</code>, maybe because I'm not properly using the callback <code>before_destroy</code>.</p>\n\n<p>my model <code>user.rb</code> : </p>\n\n<pre><code>class User &lt; ApplicationRecord\n    after_create :welcome_send\n    before_destroy :goodbye_user, prepend: true\n    after_update :update_user\n\n    def welcome_send\n        UserMailer.welcome_email(self).deliver_now\n    end\n\n    def goodbye_user\n        UserMailer.bye_email(self).deliver_now\n    end\n\n    def update_user\n        UserMailer.update_info(self).deliver_now\n    end\nend\n</code></pre>\n\n<p>and my <code>user_mailer</code> is : </p>\n\n<pre><code>class UserMailer &lt; ApplicationMailer\n    default from: 'no-reply@monsite.fr'\n\n    def welcome_email(user)\n      @user = user \n      @url  = 'http://monsite.fr/login' \n      mail(to: @user.email, subject: 'Bienvenue dans la team  !') \n    end\n\n    def bye_email(user)\n        @user = user\n        mail(to: @user.email, subject: 'A bient\u00f4t !') \n    end\n\n    def update_info(user)\n        @user = user\n        @url = 'http://monsite.fr/login'\n        mail(to: @user.email, subject: 'Modification de vos param\u00e8tres')\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1552411399, "post_id": 55127316, "comment_id": 96996251, "body": "Those aren&#39;t two hashes. They are two arrays of hashes."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1552411521, "post_id": 55127316, "comment_id": 96996324, "body": "Can we assume two hashes with the same <i>user</i> always have the same array index? (Assuming you want to merge hashes with the same <i>user</i>.)"}], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 3, "creation_date": 1552412550, "post_id": 55127598, "comment_id": 96996917, "body": "Instead of using <code>v[0].deep_merge(v[1])</code> you could also use <code>v.reduce(:deep_merge)</code>, which also works for group sizes other than 2."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1552412582, "post_id": 55127598, "comment_id": 96996940, "body": "You can also do <code>.values.map { |v|</code> to skip the key if the keys aren&#39;t relevant."}], "tags": [], "owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "is_accepted": true, "score": 2, "last_activity_date": 1552412781, "last_edit_date": 1552412781, "creation_date": 1552412381, "answer_id": 55127598, "question_id": 55127316, "link": "https://stackoverflow.com/questions/55127316/join-values-of-two-hashes/55127598#55127598", "title": "Join values of two hashes", "body": "<p>If you are using Ruby on Rails, you can do something like this:</p>\n\n<pre><code>h1 = [\n  {:user=&gt;\"Maria\", :alerts=&gt;{:rfc=&gt;\"This rfc is invalid\"}},\n  {:user=&gt;\"Juan\", :alerts=&gt;{:email=&gt;\"This email is invalid\"}}\n]\n\nh2 = [\n  {:user=&gt;\"Maria\", :alerts=&gt;{:income_in_the_mean=&gt;true, :credit_in_the_mean=&gt;true}},\n  {:user=&gt;\"Juan\", :alerts=&gt;{:income_in_the_mean=&gt;false, :credit_in_the_mean=&gt;true}}\n]\n\n(h1+h2).group_by{|h| h[:user]}.values.map{|v| v.reduce(:deep_merge)}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>[\n  {:user=&gt;\"Maria\", :alerts=&gt;{:rfc=&gt;\"This rfc is invalid\", :income_in_the_mean=&gt;true, :credit_in_the_mean=&gt;true}},\n  {:user=&gt;\"Juan\", :alerts=&gt;{:email=&gt;\"This email is invalid\", :income_in_the_mean=&gt;false, :credit_in_the_mean=&gt;true}}\n]\n</code></pre>\n\n<p><s>Keep in mind that it will work only if you have exactly two hashes for each user.</s></p>\n\n<p>I have updated my answer thanks to @tadman and @3limin4t0r</p>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1552412709, "creation_date": 1552412709, "answer_id": 55127698, "question_id": 55127316, "link": "https://stackoverflow.com/questions/55127316/join-values-of-two-hashes/55127698#55127698", "title": "Join values of two hashes", "body": "<p>The simple index based approach might look something like this:</p>\n\n<pre><code>array_1 = [\n  {:user=&gt;\"Maria\", :alerts=&gt;{:rfc=&gt;\"This rfc is invalid\"}},\n  {:user=&gt;\"Juan\", :alerts=&gt;{:email=&gt;\"This email is invalid\"}}\n]\n\narray_2 = [\n  {:user=&gt;\"Maria\", :alerts=&gt;{:income_in_the_mean=&gt;true, :credit_in_the_mean=&gt;true}},\n  {:user=&gt;\"Juan\", :alerts=&gt;{:income_in_the_mean=&gt;false, :credit_in_the_mean=&gt;true}}\n]\n\narray_1.zip(array_2).map { |item_1, item_2| item_1.deep_merge(item_2) }\n#=&gt; [\n#   {:user=&gt;\"Maria\", :alerts=&gt;{:rfc=&gt;\"This rfc is invalid\", :income_in_the_mean=&gt;true, :credit_in_the_mean=&gt;true}},\n#   {:user=&gt;\"Juan\", :alerts=&gt;{:email=&gt;\"This email is invalid\", :income_in_the_mean=&gt;false, :credit_in_the_mean=&gt;true}}\n# ]\n</code></pre>\n\n<p>Using <a href=\"http://ruby-doc.org/core-2.6.1/Array.html#method-i-zip\" rel=\"nofollow noreferrer\"><code>Array#zip</code></a> and Rails <a href=\"https://api.rubyonrails.org/classes/Hash.html#method-i-deep_merge\" rel=\"nofollow noreferrer\"><code>#deep_merge</code></a>. For this to work the arrays have to be the same size and the elements to merge must be on the same index position.</p>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1552413718, "post_id": 55127896, "comment_id": 96997570, "body": "I&#39;d personally go for <code>rescue v2</code> instead of <code>rescue v1</code>, since it&#39;s more consistent with the <code>#merge!</code> method that defaults to the new value, not the old value. Of course this depends on the use-case."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1552457080, "post_id": 55127896, "comment_id": 97011288, "body": "@3limin4t0r If those are not hashes, key is <code>:user</code> and (check the accumulating strategy) <code>v1 \u2261 v2</code> :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1552413404, "creation_date": 1552413404, "answer_id": 55127896, "question_id": 55127316, "link": "https://stackoverflow.com/questions/55127316/join-values-of-two-hashes/55127896#55127896", "title": "Join values of two hashes", "body": "<p>Just out of curiosity, plain old good ruby solution:</p>\n\n<pre><code>[h1 + h2].each_with_object(Hash.new { |h, k| h[k] = {} }) do |h, acc|\n  acc[h[:user]].merge!(h) { |_, v1, v2| v1.merge(v2) rescue v1 }\nend.values\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1552418795, "last_edit_date": 1552418795, "creation_date": 1552417422, "answer_id": 55128960, "question_id": 55127316, "link": "https://stackoverflow.com/questions/55127316/join-values-of-two-hashes/55128960#55128960", "title": "Join values of two hashes", "body": "<p>This is a pure-Ruby solution.</p>\n\n<pre><code>arr = [\n  [\n    {:user=&gt;\"Maria\",\n     :alerts=&gt;{:rfc=&gt;\"This rfc is invalid\"}},\n    {:user=&gt;\"Juan\",\n     :alerts=&gt;{:email=&gt;\"This email is invalid\"}}\n  ],\n  [\n    {:user=&gt;\"Maria\",\n       :alerts=&gt;{:income_in_the_mean=&gt;true, :credit_in_the_mean=&gt;true}},\n    {:user=&gt;\"Juan\",\n       :alerts=&gt;{:income_in_the_mean=&gt;false, :credit_in_the_mean=&gt;true}}\n  ]\n]\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>arr.flatten.group_by { |h| h[:user] }.map do |user,a|\n  { user: user, alerts: a.reduce({}) { |h,g| h.merge(g[:alerts]) } }\nend\n  #=&gt; [{:user=&gt;\"Maria\",\n  #     :alerts=&gt;{:rfc=&gt;\"This rfc is invalid\", :income_in_the_mean=&gt;true,\n  #               :credit_in_the_mean=&gt;true}},\n  #    {:user=&gt;\"Juan\",\n  #     :alerts=&gt;{:email=&gt;\"This email is invalid\", :income_in_the_mean=&gt;false,\n  #               :credit_in_the_mean=&gt;true}}] \n</code></pre>\n\n<p>Note:</p>\n\n<pre><code>arr.flatten.group_by { |h| h[:user] }\n  #=&gt; {\"Maria\"=&gt;[{:user=&gt;\"Maria\", :alerts=&gt;{:rfc=&gt;\"This rfc is invalid\"}},\n  #              {:user=&gt;\"Maria\", :alerts=&gt;{:income_in_the_mean=&gt;true,\n  #                 :credit_in_the_mean=&gt;true}}],\n  #    \"Juan\" =&gt;[{:user=&gt;\"Juan\", :alerts=&gt;{:email=&gt;\"This email is invalid\"}},\n  #              {:user=&gt;\"Juan\", :alerts=&gt;{:income_in_the_mean=&gt;false,\n  #                 :credit_in_the_mean=&gt;true}}]} \n</code></pre>\n\n<p><code>arr</code> can be of any size, of course.</p>\n"}], "owner": {"reputation": 1, "user_id": 11131844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/817c3762fda8fdd5ef5e714b96501094?s=128&d=identicon&r=PG&f=1", "display_name": "Jzr", "link": "https://stackoverflow.com/users/11131844/jzr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 55127598, "answer_count": 4, "score": -2, "last_activity_date": 1552418795, "creation_date": 1552411281, "last_edit_date": 1552411400, "question_id": 55127316, "link": "https://stackoverflow.com/questions/55127316/join-values-of-two-hashes", "title": "Join values of two hashes", "body": "<p>I have a question how i can merge the contain of two hashes for example</p>\n\n<pre><code>[\n  {:user=&gt;\"Maria\", :alerts=&gt;{:rfc=&gt;\"This rfc is invalid\"}},\n  {:user=&gt;\"Juan\", :alerts=&gt;{:email=&gt;\"This email is invalid\"}}\n]\n\n[\n  {:user=&gt;\"Maria\", :alerts=&gt;{:income_in_the_mean=&gt;true, :credit_in_the_mean=&gt;true}},\n  {:user=&gt;\"Juan\", :alerts=&gt;{:income_in_the_mean=&gt;false, :credit_in_the_mean=&gt;true}}\n]\n</code></pre>\n\n<p>and get one only value for alert in each user</p>\n\n<pre><code>[\n  {:user=&gt;\"Maria\", :alerts=&gt;{:rfc=&gt;\"This rfc is invalid\", :income_in_the_mean=&gt;true, :credit_in_the_mean=&gt;true}},\n  {:user=&gt;\"Juan\", :alerts=&gt;{:email=&gt;\"This email is invalid\",:income_in_the_mean=&gt;false, :credit_in_the_mean=&gt;true}}\n]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "scope", "policy", "pundit"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11101899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a3016846b328ba49fcd6fecc1e46da?s=128&d=identicon&r=PG&f=1", "display_name": "Julie", "link": "https://stackoverflow.com/users/11101899/julie"}, "edited": false, "score": 0, "creation_date": 1552488646, "post_id": 55132190, "comment_id": 97030042, "body": "Thanks Max, it seems to be on a good way but returns me this error : &quot;undefined local variable or method `garden_class&#39; for #&lt;GardensController:0x00007f76d21b68e0&gt; Did you mean? garden_url&quot; . I have no ideo how to solve it.. do you? :)"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1552433562, "creation_date": 1552433562, "answer_id": 55132190, "question_id": 55127082, "link": "https://stackoverflow.com/questions/55127082/pundit-how-to-give-the-possibility-to-the-user-to-have-access-either-to-all-th/55132190#55132190", "title": "Pundit : how to give the possibility to the user to have access either to all the gardens or only to his ownes?", "body": "<p>You can solve this simply by creating a separate scope.</p>\n\n<pre><code>class GardenPolicy &lt; ApplicationPolicy\n  # ...\n  class MyScope &lt; ApplicationPolicy::Scope\n    def resolve\n      scope.where(user: user)\n    end\n  end \nend\n</code></pre>\n\n<p>Use the <code>policy_scope_class</code> option to tell Pundit about your custom scope:</p>\n\n<pre><code>class GardensController &lt; ApplicationController\n  # ...\n  def my_gardens\n    @gardens = policy_scope(Garden, policy_scope_class: GardenPolicy::MyScope)\n  end\nend\n</code></pre>\n\n<p>Its detailed in <a href=\"https://github.com/varvet/pundit#scopes\" rel=\"nofollow noreferrer\">the readme</a>.</p>\n"}], "owner": {"reputation": 15, "user_id": 11101899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a3016846b328ba49fcd6fecc1e46da?s=128&d=identicon&r=PG&f=1", "display_name": "Julie", "link": "https://stackoverflow.com/users/11101899/julie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552433562, "creation_date": 1552410451, "question_id": 55127082, "link": "https://stackoverflow.com/questions/55127082/pundit-how-to-give-the-possibility-to-the-user-to-have-access-either-to-all-th", "title": "Pundit : how to give the possibility to the user to have access either to all the gardens or only to his ownes?", "body": "<p>I'm trying to define 2 possible index for the users, to give them either the possibility to have access to all the published gardens or only to the one they pusblished on their own (2 different pages). I am completely lost when doing it with pundit as it doesn't depend on the status of the user, but only on what he wants to display. Any Idea ?? Thank you :)</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery with: :exception\n  before_action :authenticate_user!\ninclude Pundit\n\n  # Pundit: white-list approach.\n  after_action :verify_authorized, except: [:index, :my_gardens], unless: :skip_pundit?\n  after_action :verify_policy_scoped, only: [:index, :my_gardens], unless: :skip_pundit?\n\n  # Uncomment when you *really understand* Pundit!\n  rescue_from Pundit::NotAuthorizedError, with: :user_not_authorized\n  def user_not_authorized\n    flash[:alert] = \"You are not authorized to perform this action.\"\n    redirect_to(root_path)\n  end\n\n  private\n\n  def skip_pundit?\n    devise_controller? || params[:controller] =~ /(^(rails_)?admin)|(^pages$)/\n  end\nend\n</code></pre>\n\n<p><strong>garden_controller.rb</strong></p>\n\n<pre><code>class GardensController &lt; ApplicationController\n  before_action :set_garden, only: [:show, :destroy, :edit, :update ]\n  def new\n    @garden = Garden.new\n    authorize @garden\n  end\n\n  def create\n    @garden = Garden.new(garden_params)\n    authorize @garden\n\n    @garden.user = current_user\n# OU :     @garden = current_user.gardens.build(garden_params)\n\n    respond_to do |format|\n      if @garden.save\n        format.html { redirect_to @garden, notice: 'Garden was successfully created.' }\n        format.json { render :show, status: :created, location: @garden }\n      else\n        format.html { render :new }\n        format.json { render json: @garden.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  def index\n      @gardens = policy_scope(Garden)\n  end\n\n  def my_gardens\n    @gardens = policy_scope(Garden).find(params[user_id: current_user.id])\n  end\n\n  def show\n    authorize @garden\n  end\n\n  def destroy\n    authorize @garden\n\n    @garden.destroy\n    respond_to do |format|\n      format.html { redirect_to gardens_url, notice: 'garden was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  def edit\n    authorize @garden\n  end\n\n def update\n  authorize @garden\n\n  respond_to do |format|\n    if @garden.update(garden_params)\n      format.html { redirect_to @garden, notice: 'Garden was successfully updated.' }\n      format.json { render :show, status: :ok, location: @garden }\n    else\n      format.html { render :edit }\n      format.json { render json: @garden.errors, status: :unprocessable_entity }\n    end\n  end\nend\n\n  private\n\n  def garden_params\n    params.require(:garden).permit(:title, :details, :surface, :address)\n  end\n\n  def set_garden\n    @garden = Garden.find(params[:id])\n  end\nend\n</code></pre>\n\n<p><strong>application_policy.rb</strong></p>\n\n<pre><code>class ApplicationPolicy\n  attr_reader :user, :record\n\n  def initialize(user, record)\n    @user = user\n    @record = record\n  end\n\n  def index?\n    false\n  end\n\n  def my_gardens?\n    false\n  end\n\n  def show?\n    scope.where(:id =&gt; record.id).exists?\n  end\n\n  def create?\n    false\n  end\n\n  def new?\n    create?\n  end\n\n  def update?\n    false\n  end\n\n  def edit?\n    update?\n  end\n\n  def destroy?\n    false\n  end\n\n  def scope\n    Pundit.policy_scope!(user, record.class)\n  end\n\n  class Scope\n    attr_reader :user, :scope\n\n    def initialize(user, scope)\n      @user = user\n      @scope = scope\n    end\n\n    def resolve\n      scope\n    end\n  end\nend\n</code></pre>\n\n<p><strong>garden_policy.rb</strong> </p>\n\n<pre><code>class GardenPolicy &lt; ApplicationPolicy\n  class Scope &lt; Scope\n    def resolve\n      scope.all #&gt;&gt; permet d'afficher tous les restos dans index\n    end\n  end\n\n  def create?\n    true\n  end\n\n  def update?\n    user_is_the_owner_or_admin?\n  end\n\n  def destroy?\n    user_is_the_owner_or_admin?\n  end\n\n  def index?\n    true\n  end\n\n  def show\n    scope.where(:id =&gt; record.id).exists?\n  end\n\n  private\n\n  def user_is_the_owner_or_admin?\n    user.admin || record.user == user\n  end\nend\n</code></pre>\n\n<p><strong>schema.rb</strong></p>\n\n<pre><code>  create_table \"gardens\", force: :cascade do |t|\n    t.string \"title\"\n    t.text \"details\"\n    t.integer \"surface\"\n    t.text \"address\"\n    t.bigint \"user_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.string \"email\", default: \"\", null: false\n    t.string \"encrypted_password\", default: \"\", null: false\n    t.string \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.boolean \"admin\", default: false\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n    t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n  end\n</code></pre>\n"}, {"tags": ["ruby", "net-http"], "comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 5, "creation_date": 1552409573, "post_id": 55126655, "comment_id": 96995199, "body": "Could be timing out to prevent <a href=\"https://guides.rubyonrails.org/security.html#csrf-countermeasures\" rel=\"nofollow noreferrer\">CSRF</a>. Out of curiosity, why is it you want to do this?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1552409984, "post_id": 55126655, "comment_id": 96995442, "body": "If you need JavaScript you may need a full browser solution. Maybe something like <a href=\"http://phantomjs.org\" rel=\"nofollow noreferrer\">Phantom.js</a>?"}, {"owner": {"reputation": 134, "user_id": 6574099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60c946d0a70388b5fec228bd7a486bee?s=128&d=identicon&r=PG&f=1", "display_name": "K Nugal", "link": "https://stackoverflow.com/users/6574099/k-nugal"}, "edited": false, "score": 0, "creation_date": 1553520445, "post_id": 55126655, "comment_id": 97402923, "body": "Hello SRack, to make it simple our application has some issue when rebooting. Everytime i need to login 2 times to make it work normal. Otherwise the first 2 people that log in cannot use any functionalities (some caching issue) so before we remove those cookie issues i would like to implement a work around."}], "answers": [{"tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 1, "last_activity_date": 1552468278, "creation_date": 1552468278, "answer_id": 55138040, "question_id": 55126655, "link": "https://stackoverflow.com/questions/55126655/using-ruby-script-to-perform-a-login/55138040#55138040", "title": "Using Ruby Script to perform a login", "body": "<p>As it seems to have gained some traction as a comment, I thought I'd move it to an answer.</p>\n\n<p>There's a good chance this will be timing out to prevent CSRF attacks. Here's a link to the Rails docs explaining this: <a href=\"https://guides.rubyonrails.org/security.html#csrf-countermeasures\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/security.html#csrf-countermeasures</a>.</p>\n\n<p>In a nutshell, sites will send (and require) an authenticity token along with any potentially transformative request (<code>POST</code>, <code>PUT</code>, <code>DELETE</code>, etc.), in order to prevent people from sending such requests from outside the domain - as you're doing.</p>\n\n<p>I'm not suggesting you have ill intent, though this prevents someone attempting to gain access to something they shouldn't, should their actions be designed to work in a manner beyond what the site intends.</p>\n"}], "owner": {"reputation": 134, "user_id": 6574099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60c946d0a70388b5fec228bd7a486bee?s=128&d=identicon&r=PG&f=1", "display_name": "K Nugal", "link": "https://stackoverflow.com/users/6574099/k-nugal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552468278, "creation_date": 1552409033, "question_id": 55126655, "link": "https://stackoverflow.com/questions/55126655/using-ruby-script-to-perform-a-login", "title": "Using Ruby Script to perform a login", "body": "<p>my goal is to use a ruby script to perform a login.\nThe website uses javascript to render the login form therefore I cannot use mechanize. I want to avoid using selenium,</p>\n\n<p>If I were to login with false data, I can see under the network section, that an action url is performed -> \nRequest URL: <a href=\"https://www.example.com/admin/bocontroller/bocontroller.cfm?action=dologin\" rel=\"nofollow noreferrer\">https://www.example.com/admin/bocontroller/bocontroller.cfm?action=dologin</a></p>\n\n<p>further down I can see the Form Data\n-> \nusername: Sample\npassword: 12345678</p>\n\n<p>Based on this I tried to write several scripts (this being the closest i hope...)</p>\n\n<pre><code>require \"net/http\"\nrequire \"uri\"\n\nuri = URI.parse(\"https://www.eample.com/admin/bocontroller/bocontroller.cfm?action=dologin\")\n\n\nhttp = Net::HTTP.new(uri.host, uri.port)\n\nrequest = Net::HTTP::Post.new(uri.request_uri)\nrequest.set_form_data({'username' =&gt; 'Sample', 'password' =&gt; '12345678'})\n\nrequest[\"Content-Type\"] = \"application/json\"\n\nresponse = http.request(request)\n</code></pre>\n\n<p>Unfortunately My script just stops running... and I am kind of lost. Can anyone give me some hints to lead me into the right direction? IS this the right approach?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552406018, "post_id": 55125581, "comment_id": 96992914, "body": "<i>Sidenote:</i> unless you explicitly sort the query, you might easily get <code>stock_3</code> as the first result of the query."}, {"owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552406163, "post_id": 55125581, "comment_id": 96993042, "body": "you are right thanks for pointing  this"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 2, "creation_date": 1552407770, "post_id": 55125581, "comment_id": 96994109, "body": "one more comment, do not use things like <code>@stock_2nd.quantity -= item.quantity.to_i</code>, this can cause you problems in big projects, why ?, some one else might be buying the same variant, the code could load the same quantities for both requests which will lead to bad calculations."}], "answers": [{"comments": [{"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 3, "creation_date": 1552406423, "post_id": 55125812, "comment_id": 96993213, "body": "Should also wrap it in a transaction, and raise if all stocks combined cannot fulfill the quantity."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1552406447, "post_id": 55125812, "comment_id": 96993234, "body": "@TamerShlash yep, indeed, but it\u2019s unclear what to do in such a case and transaction would overcomplicate this already too multilined answer."}, {"owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "edited": false, "score": 0, "creation_date": 1552407492, "post_id": 55125812, "comment_id": 96993917, "body": "it says` undefined local variable or method <code>quantity&#39; for #&lt;Sale:0x007fd99651bab8&gt;</code>my remove_from_stock method is in the Sale model"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1552407569, "post_id": 55125812, "comment_id": 96993963, "body": "I was sure you could figure it out yourself. <code>item.quantity</code> or how is it called in your code. Updated the answer."}, {"owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "edited": false, "score": 0, "creation_date": 1552408251, "post_id": 55125812, "comment_id": 96994412, "body": "I am having troubles sorry, for example I order 2 articles, so it remove 1 article in in stock_1, and it removes 2 article in stock_2"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1552408496, "post_id": 55125812, "comment_id": 96994560, "body": "No way. The code above removes exactly the requested amount."}, {"owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "edited": false, "score": 0, "creation_date": 1552480467, "post_id": 55125812, "comment_id": 97024190, "body": "Did some more tests and I really have a problem: according to my example, if i order 5 articles my <code>stock_1 = 0</code> i am ok ,` stock_2 = 0<code>I am ok,  but </code>stock_3= 0` I am not :) how can I fix this please?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552481629, "post_id": 55125812, "comment_id": 97024934, "body": "The above perfectly answers the question stated. If you have any other questions, post other questions. Besides that, until you learn how to format text and use punctuation, I am unable to understand that gibberish."}, {"owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "edited": false, "score": 0, "creation_date": 1552482250, "post_id": 55125812, "comment_id": 97025321, "body": "Okay @Aleksei, I am sorry for my gibberish... I edited my question, let me know please if you can help on this one or if I &#39;d better ask a new question."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552482490, "post_id": 55125812, "comment_id": 97025480, "body": "There is no way it removes all. Once again: the code above is correct. If you want me to troubleshoot anything, at least provide the info about starting conditions, quantity to remove etc. I am not a mind reader."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552483530, "post_id": 55125812, "comment_id": 97026223, "body": "Parentheses are required, otherwise the <code>leftover</code> is assigned to the result of inequality. I have updated the answer. Also, while you copy-pasted my answer you made a mistake (probably you received an error back, induced by the lack of parentheses and blindly substituted <code>quantity</code> to <code>item.quantity.to_i</code> which makes zero sense.)"}, {"owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "edited": false, "score": 0, "creation_date": 1552484741, "post_id": 55125812, "comment_id": 97027101, "body": "Sorry for blindly substituting, I am learning, and thanks for you help"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1552483380, "last_edit_date": 1552483380, "creation_date": 1552406281, "answer_id": 55125812, "question_id": 55125581, "link": "https://stackoverflow.com/questions/55125581/remove-quantity-in-the-next-object-if-first-object-quantity-0/55125812#55125812", "title": "Remove quantity in the next object if first object quantity == 0", "body": "<p>You should retrieve the whole stockset and <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\"><code>Enumerable#reduce</code></a> it unless the whole quantity is distributed:</p>\n\n<pre><code>Stock.\n    where(variant_id: item.variant_id).\n    where('quantity &gt; 0').\n    order(:created_at).\n    reduce(item.quantity.to_i) do |quantity, stock|\n\n  if (leftover = quantity - stock.quantity) &lt;= 0\n    stock.update_attributes! quantity: stock.quantity - quantity\n    break\n  else\n    stock.update_attributes! quantity: 0\n    leftover\n  end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55125812, "answer_count": 1, "score": 1, "last_activity_date": 1552483380, "creation_date": 1552405597, "last_edit_date": 1552482799, "question_id": 55125581, "link": "https://stackoverflow.com/questions/55125581/remove-quantity-in-the-next-object-if-first-object-quantity-0", "title": "Remove quantity in the next object if first object quantity == 0", "body": "<p>My <strong>Stock</strong> model has <code>quantity</code> and <code>variant_id</code> attributes.</p>\n\n<p>I add new stock once a week for a variant like so:</p>\n\n<pre><code>stock_1 = id: 1, variant_id: 1, quantity: 1, created_at:  Tue, 19 Feb 2019 15:19:00 UTC +00:00\n\nstock_2 = id: 2, variant_id: 1, quantity: 3, created_at:  Tue, 26 Feb 2019 15:19:20 UTC +00:00\n\nstock_3 = id: 3, variant_id: 1, quantity: 10, created_at:  Tue, 05 Mar 2019 15:19:39 UTC +00:00\n</code></pre>\n\n<p>When I sell an article, I want to remove it from the first stock where quantity is higher than 0.</p>\n\n<p>I tried this method which almost do the job. </p>\n\n<p>The problem is if I order 3 articles in the same variant:\n3 quantity will be removed from stock_1\nSo the stock will be negative... </p>\n\n<p>What would you suggest me to remove the rest from the  stock_2... </p>\n\n<p>Is there a way to improve the idea? </p>\n\n<pre><code>@stock_1st = Stock.where(variant_id:1).where('quantity &gt; 0').first\n\nif @stock_1st.quantity == 0\n  @stock_2nd = Stock.where(variant_id: item.variant_id).where('quantity &gt; 0').first\n  @stock_2nd.quantity -= item.quantity.to_i\n  @stock_2nd.save\nelse\n  @stock_1st.quantity -= item.quantity.to_i\n  @stock_1st.save\nend\n</code></pre>\n\n<h1>EDIT</h1>\n\n<p>thanks to  Aleksei Matiushkin for your precious help, but I am still having troubles </p>\n\n<p>here the method: </p>\n\n<pre><code> def remove_from_stock\n  self.items.each do |item|\n    Stock.where(variant_id: item.variant_id).where('quantity &gt; 0').order(:created_at).reduce(item.quantity.to_i) do |quantity, stock|\n      if leftover = item.quantity.to_i - stock.quantity &lt;= 0\n        stock.update_attributes! quantity: stock.quantity - item.quantity.to_i \n        break\n      else\n        stock.update_attributes! quantity: 0\n        leftover\n       end\n      end\n    end\n   end\n</code></pre>\n\n<p>Did some more tests and I really have a problem: according to my example (which is above too). </p>\n\n<p>My initial stock for <code>variant_id: 1</code></p>\n\n<pre><code>stock_1 = id: 1, variant_id: 1, quantity: 1, created_at:  Tue, 19 Feb 2019 15:19:00 UTC +00:00\n\nstock_2 = id: 2, variant_id: 1, quantity: 3, created_at:  Tue, 26 Feb 2019 15:19:20 UTC +00:00\n\nstock_3 = id: 3, variant_id: 1, quantity: 10, created_at:  Tue, 05 Mar 2019 15:19:39 UTC +00:00\n</code></pre>\n\n<p>If I order 5 articles in this <code>variant_id: 1</code></p>\n\n<p>my remaining stock is 0 everywhere... </p>\n\n<pre><code>stock_1 = 0   #1/1 article is removed from this stock\nstock_2 = 0   #3/3 articles are removed from this stock \nstock_3 = 0   #Only 1/10 should be removed, but stock.update_attributes!  set to quantity: 0 \n</code></pre>\n\n<p>How can I fix this please?</p>\n"}, {"tags": ["ruby", "binary"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552405408, "post_id": 55125275, "comment_id": 96992488, "body": "5 b<b>Y</b>tes or 5 b<b>i</b>ts? For 5 bytes just unpack 4 and then unpack 1."}, {"owner": {"reputation": 55, "user_id": 7646302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35248258395e688ffcbfffb968b4cbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell", "link": "https://stackoverflow.com/users/7646302/mitchell"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552405720, "post_id": 55125275, "comment_id": 96992710, "body": "Bytes. So i can do just something like data.unpack(&quot;LC&quot;) ?"}], "answers": [{"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1552417294, "creation_date": 1552417294, "answer_id": 55128924, "question_id": 55125275, "link": "https://stackoverflow.com/questions/55125275/ruby-unpack-binary/55128924#55128924", "title": "Ruby unpack binary", "body": "<p>To literally unpack five bytes: <code>str.unpack 'C5'</code></p>\n\n<p>That gives you five byte values as unsigned ints. The question is how to reinterpret those ints as a single data type. Pack/unpack only recognize the standard power of two sizes, so you'll have to do that part manually.</p>\n\n<p>For example, to get a little endian unsigned 40-bit int</p>\n\n<pre><code>bytes = str.unpack 'C5'\nint = bytes.map.with_index { |byte, i| byte &lt;&lt; (i * 8) }.reduce(:+)\n</code></pre>\n\n<p>If you need to do something more sophisticated like a signed type or a float... good luck.</p>\n"}], "owner": {"reputation": 55, "user_id": 7646302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35248258395e688ffcbfffb968b4cbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell", "link": "https://stackoverflow.com/users/7646302/mitchell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552417294, "creation_date": 1552404681, "question_id": 55125275, "link": "https://stackoverflow.com/questions/55125275/ruby-unpack-binary", "title": "Ruby unpack binary", "body": "<p>I am working on unpacking a binary file for the first time in Ruby. Already found the unpack method which works pretty nice. Which according to the docs works perfect for 8(1 byte),16(2 byte),32(4 byte) and 64 bit(8 byte). </p>\n\n<p>But now I have to unpack 5 bytes. How do I do this?</p>\n\n<p>Thx in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 245, "user_id": 4442366, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/93b81597ad229a826a8c6cfd64a1ea29?s=128&d=identicon&r=PG&f=1", "display_name": "ccoeder", "link": "https://stackoverflow.com/users/4442366/ccoeder"}, "edited": false, "score": 0, "creation_date": 1552401216, "post_id": 55123901, "comment_id": 96989520, "body": "Can you elaborate your question? What do you mean by saying &quot;One of the objects has images attached, I have to display these images and allow user to add new ones.&quot; Is this object a database object or api result?"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1552401291, "post_id": 55123901, "comment_id": 96989577, "body": "If your Rails app has to works like an API, you could encode your image to Base64, send it then manage it within your old app"}, {"owner": {"reputation": 72, "user_id": 7769088, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ln4Bo0cgJV4/AAAAAAAAAAI/AAAAAAAAAHU/FtsGPSnqEm0/photo.jpg?sz=128", "display_name": "adominey", "link": "https://stackoverflow.com/users/7769088/adominey"}, "reply_to_user": {"reputation": 245, "user_id": 4442366, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/93b81597ad229a826a8c6cfd64a1ea29?s=128&d=identicon&r=PG&f=1", "display_name": "ccoeder", "link": "https://stackoverflow.com/users/4442366/ccoeder"}, "edited": false, "score": 0, "creation_date": 1552401632, "post_id": 55123901, "comment_id": 96989814, "body": "@ccoeder in database there are objects (geographic locations in this case) and image needs to know id of that object (not important for my problem)."}, {"owner": {"reputation": 245, "user_id": 4442366, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/93b81597ad229a826a8c6cfd64a1ea29?s=128&d=identicon&r=PG&f=1", "display_name": "ccoeder", "link": "https://stackoverflow.com/users/4442366/ccoeder"}, "edited": false, "score": 0, "creation_date": 1552401790, "post_id": 55123901, "comment_id": 96989914, "body": "@adominey I still couldn&#39;t understand, do you store that objects in your rails app database or are they coming from an api?"}, {"owner": {"reputation": 72, "user_id": 7769088, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ln4Bo0cgJV4/AAAAAAAAAAI/AAAAAAAAAHU/FtsGPSnqEm0/photo.jpg?sz=128", "display_name": "adominey", "link": "https://stackoverflow.com/users/7769088/adominey"}, "edited": false, "score": 0, "creation_date": 1552402259, "post_id": 55123901, "comment_id": 96990226, "body": "they are coming from api. I&#39;m getting list of objects from api and want to add images to these objects. nothing is stored in my database."}, {"owner": {"reputation": 245, "user_id": 4442366, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/93b81597ad229a826a8c6cfd64a1ea29?s=128&d=identicon&r=PG&f=1", "display_name": "ccoeder", "link": "https://stackoverflow.com/users/4442366/ccoeder"}, "edited": false, "score": 0, "creation_date": 1552403172, "post_id": 55123901, "comment_id": 96990920, "body": "okay, so just do what oshan said. You need to make a request to the java api."}], "answers": [{"tags": [], "owner": {"reputation": 1377, "user_id": 3011280, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mkyAT.jpg?s=128&g=1", "display_name": "Oshan Wisumperuma", "link": "https://stackoverflow.com/users/3011280/oshan-wisumperuma"}, "is_accepted": false, "score": 1, "last_activity_date": 1552402252, "creation_date": 1552402252, "answer_id": 55124392, "question_id": 55123901, "link": "https://stackoverflow.com/questions/55123901/rails-receive-and-send-images/55124392#55124392", "title": "Rails: receive and send images", "body": "<p>there are few ways to communicate with java from ruby.</p>\n\n<ol>\n<li>REST API - expose Java functionalities through endpoints. then use an <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">HTTP client</a>.</li>\n<li>Remote Procedure Call - <a href=\"https://thrift.apache.org/\" rel=\"nofollow noreferrer\">Apache Thrift</a> </li>\n<li>JRuby - embedded java programme into Ruby</li>\n</ol>\n\n<p>however, I think maybe you can just proxy the Java API without going through the rails application.</p>\n"}], "owner": {"reputation": 72, "user_id": 7769088, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ln4Bo0cgJV4/AAAAAAAAAAI/AAAAAAAAAHU/FtsGPSnqEm0/photo.jpg?sz=128", "display_name": "adominey", "link": "https://stackoverflow.com/users/7769088/adominey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552421883, "creation_date": 1552400856, "last_edit_date": 1552421883, "question_id": 55123901, "link": "https://stackoverflow.com/questions/55123901/rails-receive-and-send-images", "title": "Rails: receive and send images", "body": "<p>I'm writing rails application. My task is to show data from old java application. One of the objects has images attached, I have to display these images and allow user to add new ones.</p>\n\n<p>I want to know what is the best way to let user uploading images to old app.</p>\n\n<p>Old app has http post method for adding images with params: multipart file, md5 hash of the image and object id.</p>\n\n<p>I tried using paperclip or carrierwave but their documentation is about saving  uploaded images and I just want to transfer them somewhere else and not save anything.</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552402336, "post_id": 55123808, "comment_id": 96990286, "body": "Take a look at Onigmo&#39;s <a href=\"https://github.com/k-takata/Onigmo/blob/master/tool/enc-unicode.rb\" rel=\"nofollow noreferrer\">enc-unicode.rb</a>: <i>&quot;Creates the data structures needed by Oniguruma to map Unicode codepoints to property names and POSIX character classes&quot;</i>"}], "answers": [{"comments": [{"owner": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "edited": false, "score": 0, "creation_date": 1552401073, "post_id": 55123921, "comment_id": 96989416, "body": "Thank you, that I know it, but how to get all the symbols that matches the <code>[[:punct:]]</code> POSIX bracket expressions?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "edited": false, "score": 0, "creation_date": 1552401294, "post_id": 55123921, "comment_id": 96989579, "body": "@ZedTuX: did you open the page? It has the list. If all else fails, you can always copy/paste character codes into an array."}, {"owner": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "edited": false, "score": 0, "creation_date": 1552401339, "post_id": 55123921, "comment_id": 96989622, "body": "Sorry but my question is about to get that list using Ruby."}, {"owner": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "edited": false, "score": 0, "creation_date": 1552401384, "post_id": 55123921, "comment_id": 96989653, "body": "I want to show the list of matching symbols available the user can use (apparently it depends on the machine&#39;s unicode)."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "edited": false, "score": 0, "creation_date": 1552401387, "post_id": 55123921, "comment_id": 96989654, "body": "@ZedTuX: or another, totally wild idea: loop from 1 to whatever is the maximum character number in unicode now, treat that as a character code and generate one-char string and match it against <code>[[:punct:]]</code> regex."}, {"owner": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "edited": false, "score": 0, "creation_date": 1552401468, "post_id": 55123921, "comment_id": 96989715, "body": "Well that&#39;s kind of what I&#39;m actually trying right now, so it probably confirm that the way to do it :). Thank you."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "edited": false, "score": 1, "creation_date": 1552402637, "post_id": 55123921, "comment_id": 96990515, "body": "@ZedTuX given the number of punctuation characters, it might make more sense to show some common examples rather than all available symbols to the user."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1552406764, "post_id": 55123921, "comment_id": 96993462, "body": "<code>.upto(65535)</code>?! Are you writing from 1997?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552406830, "post_id": 55123921, "comment_id": 96993504, "body": "Also, another option would be to parse Consortium\u2019s official Unicode spec, as, for instance, <i>Elixir</i> does :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552409858, "post_id": 55123921, "comment_id": 96995363, "body": "@AlekseiMatiushkin: well that already gives me range errors. But please, I accept edits :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552410113, "post_id": 55123921, "comment_id": 96995522, "body": "It would give you range errors even with <code>.upto(128)</code> :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552410647, "post_id": 55123921, "comment_id": 96995841, "body": "@AlekseiMatiushkin: actually no, it does not"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552411191, "post_id": 55123921, "comment_id": 96996135, "body": "o_O indeed. Ruby is smart. <code>1.upto(65535).detect { |x| !x.chr(Encoding::UTF_8) rescue true } #\u21d2\u00a055296</code> \u2192 <code>128.chr(Encoding::UTF_8) #\u21d2\u00a0&quot;\\u0080&quot;</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1552546394, "post_id": 55123921, "comment_id": 97052460, "body": "Nice answer. You could avoid dealing with the <code>nil</code>&#39;s  by using <code>each_with_object</code> instead of <code>map</code>: <code>(2 &lt;&lt; 15).times.with_object([]) do |n,a|; c = n.chr(Encoding::UTF_8); a &lt;&lt; c if c.match?(&#47;\\p{Punct}&#47;); rescue RangeError; end</code>."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 7, "last_activity_date": 1552402080, "last_edit_date": 1552402080, "creation_date": 1552400904, "answer_id": 55123921, "question_id": 55123808, "link": "https://stackoverflow.com/questions/55123808/how-to-get-the-ruby-regexp-punctuation-list-from-the-punct/55123921#55123921", "title": "How to get the Ruby Regexp punctuation list from the `[[:punct:]]`?", "body": "<p><code>[[:punct:]]</code> refers to what is considered punctuation in unicode. For example: <a href=\"https://www.fileformat.info/info/unicode/category/Po/list.htm\" rel=\"noreferrer\">https://www.fileformat.info/info/unicode/category/Po/list.htm</a></p>\n\n<pre><code>s = \"foo\\u1368bar\" # =&gt; \"foo\u1368bar\"\ns.split(/[[:punct:]]/) # =&gt; [\"foo\", \"bar\"]\n</code></pre>\n\n<blockquote>\n  <p>Sorry but my question is about to get that list using Ruby.</p>\n</blockquote>\n\n<p>For the lack of a better idea, you can always loop from 1 to whatever is the maximum character number in unicode now, treat that as a character code, generate one-char string and match it against <code>[[:punct:]]</code> regex. Here's the quick and dirty implementation</p>\n\n<pre><code>punct = 1.upto(65535).map do |x|\n  x.chr(Encoding::UTF_8)\nrescue RangeError\n  nil\nend.reject(&amp;:nil?).select do |s|\n  s =~ /[[:punct:]]/\nend\n</code></pre>\n\n<p>Result (as displayed by my macos):</p>\n\n<p><a href=\"https://i.stack.imgur.com/PJn6d.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/PJn6d.png\" alt=\"unicode punctuation\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1552403146, "creation_date": 1552403146, "answer_id": 55124731, "question_id": 55123808, "link": "https://stackoverflow.com/questions/55123808/how-to-get-the-ruby-regexp-punctuation-list-from-the-punct/55124731#55124731", "title": "How to get the Ruby Regexp punctuation list from the `[[:punct:]]`?", "body": "<p>If you just want an example of punctuation (because the full list is rather unwieldy), I would pick an example that you like and then ensure it actually matches the pattern:</p>\n\n<pre><code>example_punctuation = '(*!@$#jfas,./'.gsub(/[^[:punct:]]/, '')\n# \"(*!@$#,./\"\n</code></pre>\n"}], "owner": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 55123921, "answer_count": 2, "score": 0, "last_activity_date": 1552403146, "creation_date": 1552400619, "question_id": 55123808, "link": "https://stackoverflow.com/questions/55123808/how-to-get-the-ruby-regexp-punctuation-list-from-the-punct", "title": "How to get the Ruby Regexp punctuation list from the `[[:punct:]]`?", "body": "<p>I'm using the <code>devise-security</code> gem and I setup it in order to require a <code>symbol</code> in the password (through <code>config.password_complexity</code>).</p>\n\n<p>Now I want to show the possible symbols to be used.</p>\n\n<p>Looking around in the gem's code, I found out that <a href=\"https://github.com/devise-security/devise-security/blob/5f06e98907aa93a2ebd190a82725b261bdf7f091/lib/devise-security/validators/password_complexity_validator.rb#L15\" rel=\"nofollow noreferrer\">they're actually using the Regexp <code>[[:punct:]]</code></a>.</p>\n\n<p>Can you please tell me how to get the list of symbols out of the <code>[[:punct:]]</code> POSIX bracket expressions from the Ruby code?</p>\n\n<p>I'm expecting to get a string like <code>#$%^*)</code>.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1552400631, "post_id": 55123395, "comment_id": 96989052, "body": "You can dump just the tables you need. See <a href=\"https://stackoverflow.com/questions/7359827/creating-a-database-dump-for-specific-tables-and-entries-postgres\" title=\"creating a database dump for specific tables and entries postgres\">stackoverflow.com/questions/7359827/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 11191060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f012b358f17886ff416ed1fe55e432a9?s=128&d=identicon&r=PG&f=1", "display_name": "kuhinja", "link": "https://stackoverflow.com/users/11191060/kuhinja"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1552402505, "post_id": 55123395, "comment_id": 96990420, "body": "I dont want to dump specific tables. I want to ignore or remove columns inside some tables."}, {"owner": {"reputation": 31012, "user_id": 25398, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3690dee254e9aa9d98ff964a70e89f23?s=128&d=identicon&r=PG", "display_name": "Cody Caughlan", "link": "https://stackoverflow.com/users/25398/cody-caughlan"}, "edited": false, "score": 2, "creation_date": 1552405694, "post_id": 55123395, "comment_id": 96992691, "body": "Probably simplest to add those &quot;old&quot; columns to your new database so you can most easily import the dump; then remove those columns after."}, {"owner": {"reputation": 33, "user_id": 11191060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f012b358f17886ff416ed1fe55e432a9?s=128&d=identicon&r=PG&f=1", "display_name": "kuhinja", "link": "https://stackoverflow.com/users/11191060/kuhinja"}, "reply_to_user": {"reputation": 31012, "user_id": 25398, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3690dee254e9aa9d98ff964a70e89f23?s=128&d=identicon&r=PG", "display_name": "Cody Caughlan", "link": "https://stackoverflow.com/users/25398/cody-caughlan"}, "edited": false, "score": 0, "creation_date": 1552417469, "post_id": 55123395, "comment_id": 96999473, "body": "@CodyCaughlan yes I&#39;m aware of that. thanks"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11191060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f012b358f17886ff416ed1fe55e432a9?s=128&d=identicon&r=PG&f=1", "display_name": "kuhinja", "link": "https://stackoverflow.com/users/11191060/kuhinja"}, "edited": false, "score": 0, "creation_date": 1552405171, "post_id": 55124772, "comment_id": 96992313, "body": "I understand what you want to say, but sql file does not work like this.  I updated my question. Thanks"}], "tags": [], "owner": {"reputation": 1454, "user_id": 1477940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f10a7263b299645bfbdcf747c0179297?s=128&d=identicon&r=PG", "display_name": "DonPaulie", "link": "https://stackoverflow.com/users/1477940/donpaulie"}, "is_accepted": false, "score": -1, "last_activity_date": 1552403267, "creation_date": 1552403267, "answer_id": 55124772, "question_id": 55123395, "link": "https://stackoverflow.com/questions/55123395/read-and-edit-database-dump-file-in-ruby/55124772#55124772", "title": "Read and edit database dump file in Ruby", "body": "<p>You need to open the file (1), separate commands (2), then do some operation to edit the SQL code (3) and finally run it (4). </p>\n\n<pre><code>contents = File.read('path/to/file.sql') # (1) If the file is huge, do not read it whole, but line by line\ncommands = contents.split(';') # (2) probably you'll need something more clever (hint: regex) because of the ; character in the data\ncommands.each do |command|\n  stripped_command = strip_some_columns(command) # (3)\n  ActiveRecord::Base.connection.execute(stripped_command) # (4)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 11191060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f012b358f17886ff416ed1fe55e432a9?s=128&d=identicon&r=PG&f=1", "display_name": "kuhinja", "link": "https://stackoverflow.com/users/11191060/kuhinja"}, "edited": false, "score": 0, "creation_date": 1552417501, "post_id": 55125772, "comment_id": 96999491, "body": "This is what I was looking for. I will try this out and type my own script for dump. Thanks"}, {"owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "reply_to_user": {"reputation": 33, "user_id": 11191060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f012b358f17886ff416ed1fe55e432a9?s=128&d=identicon&r=PG&f=1", "display_name": "kuhinja", "link": "https://stackoverflow.com/users/11191060/kuhinja"}, "edited": false, "score": 0, "creation_date": 1552462401, "post_id": 55125772, "comment_id": 97013495, "body": "kuhinja, if it&#39;s working for you, just accept the answer."}], "tags": [], "owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "is_accepted": true, "score": 1, "last_activity_date": 1552406157, "creation_date": 1552406157, "answer_id": 55125772, "question_id": 55123395, "link": "https://stackoverflow.com/questions/55123395/read-and-edit-database-dump-file-in-ruby/55125772#55125772", "title": "Read and edit database dump file in Ruby", "body": "<p>You have to 'update' the original sql file, by removing the columns (not available in new DB) and data of those columns.</p>\n\n<p>Just read line by line, modify it according your logic and write to other file. Consider that some lines are the columns info and other are the data.</p>\n\n<pre><code>\npath = '/tmp/source'\ntemp_file = Tempfile.new('output')\nbegin\n  File.open(path, 'r') do |file|\n    file.each_line do |line|\n      # change the line according your logic\n      temp_file.puts  new_line\n    end\n  end\n  temp_file.close\nensure\n  temp_file.close\n  temp_file.unlink\nend\n</code></pre>\n\n<p>After that, the target file can be restored with <a href=\"https://stackoverflow.com/questions/2732474/restore-a-postgres-backup-file-using-the-command-line\">pg commands</a>.</p>\n\n<pre><code>psql -U &lt;username&gt; -d &lt;dbname&gt; -1 -f &lt;filename&gt;.sql\n</code></pre>\n\n<p>or</p>\n\n<pre><code>pg_restore -U &lt;username&gt; -d &lt;dbname&gt; -1 &lt;filename&gt;.dump\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11191060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f012b358f17886ff416ed1fe55e432a9?s=128&d=identicon&r=PG&f=1", "display_name": "kuhinja", "link": "https://stackoverflow.com/users/11191060/kuhinja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 55125772, "answer_count": 2, "score": 2, "last_activity_date": 1552406157, "creation_date": 1552399447, "last_edit_date": 1552405149, "question_id": 55123395, "link": "https://stackoverflow.com/questions/55123395/read-and-edit-database-dump-file-in-ruby", "title": "Read and edit database dump file in Ruby", "body": "<p>I want to import database dump to new database that does not have all columns that old database had.</p>\n\n<p>So, to ignore/remove those columns, my idea is to edit dump.sql. </p>\n\n<p>How can I read and edit sql file in ruby?</p>\n\n<p>Dump created:</p>\n\n<pre><code>pg_dump --data-only old_database &gt; dump_data_12_3_2019.sql;\n</code></pre>\n\n<p>Using: </p>\n\n<ul>\n<li>PostgreSQL 9.5</li>\n<li>Ruby 2.5.1</li>\n</ul>\n\n<p>Inside sql file:</p>\n\n<pre><code>COPY public.images (id, file, created_at, updated_at, rotation) FROM stdin;\n255 31265d7843.JPG  2018-11-15 09:05:43.37898   2018-11-15 09:05:43.37898   0\n256 78e834e4e7.JPG  2018-11-15 09:05:43.571389  2018-11-15 09:05:43.571389  0\n257 7b6662659b.JPG  2018-11-15 09:05:44.275989  2018-11-15 09:05:44.275989  0\n215 6fe307f4b5.jpg  2018-10-15 11:08:59.42583   2018-10-15 11:12:25.284024  0\n</code></pre>\n\n<p>Header is starting with COPY, column names are inside <code>( )</code> and data is below with space for separator.</p>\n\n<p>How can I remove column rotation and his data? </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2292, "user_id": 6051596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CDh6.jpg?s=128&g=1", "display_name": "Atmanirbhar Bharat", "link": "https://stackoverflow.com/users/6051596/atmanirbhar-bharat"}, "edited": false, "score": 1, "creation_date": 1552398621, "post_id": 55122923, "comment_id": 96987632, "body": "What is the exact question here ??"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1552399172, "post_id": 55122923, "comment_id": 96987993, "body": "<code>detect</code> is Array&#39;s method to find first match."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552456371, "post_id": 55122923, "comment_id": 97011019, "body": "Note that &quot;starting with letters <code>&quot;wa&quot;</code> &quot; and &quot;starting with a substring <code>&quot;wa&quot;</code>&quot; mean different things."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1552403050, "post_id": 55123151, "comment_id": 96990828, "body": "<code>word.is_a?(String)</code> \u2013 the variable name makes this check look redundant :-)"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1552398733, "creation_date": 1552398733, "answer_id": 55123151, "question_id": 55122923, "link": "https://stackoverflow.com/questions/55122923/returning-the-first-word-in-an-array-that-begins-with-wa/55123151#55123151", "title": "Returning the first word in an array that begins with &quot;wa&quot;", "body": "<p>You need to pass the <code>array</code> to your method, otherwise, it is not visible in the scope of the method. Furthermore, I suggest a simple refactoring:</p>\n\n<pre><code>array = [\"candy\", :pepper, \"wall\", :ball, \"wacky\"]\n\ndef starts_with_wa(words)\n  words.find { |word| word.is_a?(String) &amp;&amp; word.start_with?('wa') }\nend \n\nstarts_with_wa(array)\n#=&gt; \"wall\"\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 11127396, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FMSsbyWTmLk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVZbUWrz5PMNjt9bA8BxRpUrEOfA/mo/photo.jpg?sz=128", "display_name": "Zubair Maqsood", "link": "https://stackoverflow.com/users/11127396/zubair-maqsood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 55123151, "answer_count": 1, "score": -1, "last_activity_date": 1552456297, "creation_date": 1552398113, "last_edit_date": 1552456297, "question_id": 55122923, "link": "https://stackoverflow.com/questions/55122923/returning-the-first-word-in-an-array-that-begins-with-wa", "title": "Returning the first word in an array that begins with &quot;wa&quot;", "body": "<p>I have an array that contains a mixture of strings and symbols.</p>\n\n<pre><code>array = [\"candy\", :pepper, \"wall\", :ball, \"wacky\"]\n</code></pre>\n\n<p>The aim is to return the first word that begins with the letters <code>\"wa\"</code>.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>def starts_with_wa\n  deleted_words = array.delete_if{|word| word.class == Symbol}\n  ## deletes the symbols in the original array\n  deleted_words.find do |w|\n  ##it should iterate through the deleted_Words array but it shows error of undefined local variable or method \"array\" for main:Object\n    w.start_with?('wa')\n  end\nend\n\nstarts_with_wa\n</code></pre>\n"}, {"tags": ["ruby", "integration", "sage-erp", "sdata"], "comments": [{"owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "edited": false, "score": 0, "creation_date": 1552466795, "post_id": 55122325, "comment_id": 97015585, "body": "I am pretty sure that there is some official api documentation like <a href=\"http://sage.github.io/SData-2.0/pages/core/0601/\" rel=\"nofollow noreferrer\">sage.github.io/SData-2.0/pages/core/0601</a> ? Have you tried these examples?"}], "answers": [{"tags": [], "owner": {"reputation": 553, "user_id": 886432, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3d6cea6632e81e287c5e16fd4cda1a01?s=128&d=identicon&r=PG", "display_name": "FunkMonkey33", "link": "https://stackoverflow.com/users/886432/funkmonkey33"}, "is_accepted": false, "score": 4, "last_activity_date": 1552493970, "creation_date": 1552493970, "answer_id": 55146620, "question_id": 55122325, "link": "https://stackoverflow.com/questions/55122325/sdata-rest-apis-for-sage-100-erp/55146620#55146620", "title": "sData REST APIs for sage 100 ERP", "body": "<p>I'm not familiar with SData.  But I did find a link that will help: <a href=\"https://sagecity.na.sage.com/support_communities/sage100_erp/f/sage-100-business-object-interface/72926/sdata-install-training\" rel=\"nofollow noreferrer\">https://sagecity.na.sage.com/support_communities/sage100_erp/f/sage-100-business-object-interface/72926/sdata-install-training</a></p>\n\n<p>From the read, it doesn't really look mature.  </p>\n\n<p>I use the SOTAMAS90 ODBC DSN to read Sage 100 data, and the Business Objects Interface (BOI) to write objects back to Sage 100.  For reading data, you just read like with any ODBC data source, providing the Connection string \"DSN=SOTAMAS90; UID=; PWD=; Company = ABC\" </p>\n\n<p>For writing back to Sage you would typically use the BOI, which is a COM object that gets installed with Sage.  There is a ton of sample code on the BOI forum, which is here: <a href=\"https://sagecity.na.sage.com/support_communities/sage100_erp/f/sage-100-business-object-interface\" rel=\"nofollow noreferrer\">https://sagecity.na.sage.com/support_communities/sage100_erp/f/sage-100-business-object-interface</a>.</p>\n\n<p>Good luck.  Let us know if you need more help.</p>\n\n<p>Aaron</p>\n"}], "owner": {"reputation": 1099, "user_id": 2024073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mETW6.jpg?s=128&g=1", "display_name": "Sarwan Kumar", "link": "https://stackoverflow.com/users/2024073/sarwan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1173, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552493970, "creation_date": 1552396396, "last_edit_date": 1552456407, "question_id": 55122325, "link": "https://stackoverflow.com/questions/55122325/sdata-rest-apis-for-sage-100-erp", "title": "sData REST APIs for sage 100 ERP", "body": "<p>I have a business partner account. And, I have setup sage SData and Sage ERP 100 on window server machine. I can access some resources in the browser like:</p>\n\n<pre><code>https://sage.lvh.me/SData/MasApp/MasContract/ABX/AR_Customer\n</code></pre>\n\n<p>It returns a huge file of XML.\nMy problem is that,\nI need to integrate Sage ERP with my Rails application. Which will fetch products from Sage ERP and also make order for those products from rails application?</p>\n\n<p>So, I need a complete sample API request which accepts some parameters (like page, perpage, type of request GET or POST) in request and return parseable XML/JSON response.</p>\n\n<p>Any help in this regard will be appreciated.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1552395653, "post_id": 55121896, "comment_id": 96985566, "body": "You can usually omit <code>STDIN</code> and just call <a href=\"http://ruby-doc.org/core-2.6.1/Kernel.html#method-i-gets\" rel=\"nofollow noreferrer\"><code>gets</code></a>, i.e. without a receiver."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1552397019, "post_id": 55121928, "comment_id": 96986491, "body": "<i>&quot;Apply chomp after gets&quot;</i> \u2013 maybe you can briefly explain why the text is displayed on two lines and what <code>chomp</code> does to avoid it."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 4, "last_activity_date": 1552397114, "last_edit_date": 1552397114, "creation_date": 1552395048, "answer_id": 55121928, "question_id": 55121896, "link": "https://stackoverflow.com/questions/55121896/how-could-i-display-a-text-on-the-same-line/55121928#55121928", "title": "How could I display a text on the same line?", "body": "<p>The method <code>gets</code> without any option receives the input including the terminating end of line. If you simply interpolate that as a part of a string, that end of line will be printed as a line break.</p>\n\n<p>To avoid line break, pass the parameter <code>chomp</code> with value <code>true</code> to <code>gets</code>:</p>\n\n<pre><code>$name = STDIN.gets(chomp: true)\n</code></pre>\n\n<p>In the old school way, apply <code>chomp</code> after <code>gets</code> like:</p>\n\n<pre><code>$name = STDIN.gets.chomp\n</code></pre>\n\n<p><code>chomp</code> removes white space characters from the end of the string, thus it avoids the line break.</p>\n\n<p>Other things wrong about your code are:</p>\n\n<ul>\n<li>You missed to capitalize the sentence <code>whats your name?</code>.</li>\n<li>You missed an apostrophe in <code>whats</code>.</li>\n<li>You should avoid using a global variable like <code>$name</code>. Try using another type of variable.</li>\n<li>You missed a period at the end of the sentence <code>Oh #$name, nice to meet you</code>.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1552396752, "post_id": 55122186, "comment_id": 96986308, "body": "It is not clear what you mean by your second point. What you pointed out as what <code>chomp</code> is doing is actually what <code>gets</code> does."}, {"owner": {"reputation": 43, "user_id": 10963363, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MhfhxQC4YO0/AAAAAAAAAAI/AAAAAAAABuM/Q1nxFvQt30E/photo.jpg?sz=128", "display_name": "Honey", "link": "https://stackoverflow.com/users/10963363/honey"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552406900, "post_id": 55122186, "comment_id": 96993552, "body": "You can refer to following documentation <a href=\"https://ruby-doc.org/docs/ruby-doc-bundle/Tutorial/part_02/user_input.html\" rel=\"nofollow noreferrer\">ruby-doc.org/docs/ruby-doc-bundle/Tutorial/part_02/&hellip;</a>"}], "tags": [], "owner": {"reputation": 43, "user_id": 10963363, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MhfhxQC4YO0/AAAAAAAAAAI/AAAAAAAABuM/Q1nxFvQt30E/photo.jpg?sz=128", "display_name": "Honey", "link": "https://stackoverflow.com/users/10963363/honey"}, "is_accepted": false, "score": 0, "last_activity_date": 1552396659, "last_edit_date": 1552396659, "creation_date": 1552395877, "answer_id": 55122186, "question_id": 55121896, "link": "https://stackoverflow.com/questions/55121896/how-could-i-display-a-text-on-the-same-line/55122186#55122186", "title": "How could I display a text on the same line?", "body": "<ul>\n<li><code>gets</code> is used to input data from the user and includes a line break at the end.</li>\n<li><p><code>chomp</code> is used to return and store data as a string value.</p>\n\n<pre><code>$name = STDIN.gets.chomp\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552396611, "post_id": 55122306, "comment_id": 96986209, "body": "It is not clear what you mean by &quot;regular&quot; variable. There is no strangeness to variables."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9485690"}, "is_accepted": false, "score": 1, "last_activity_date": 1552396663, "last_edit_date": 1552396663, "creation_date": 1552396306, "answer_id": 55122306, "question_id": 55121896, "link": "https://stackoverflow.com/questions/55121896/how-could-i-display-a-text-on-the-same-line/55122306#55122306", "title": "How could I display a text on the same line?", "body": "<p>I would suggest changing that global variable to a local variable. If you do, you'll have to change the way you interpolate. </p>\n\n<p>Also, I would suggest using the <code>gets.chomp</code> method and leave out <code>STDIN</code>. </p>\n\n<p>Example:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>puts \"What's your name?\"\nname = gets.chomp \nputs \"Oh, #{name}, nice to meet you.\"\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11191160, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zFdx7qAoAYk/AAAAAAAAAAI/AAAAAAAAAsE/bNiUrPDdmLs/photo.jpg?sz=128", "display_name": "Sasha Bisset", "link": "https://stackoverflow.com/users/11191160/sasha-bisset"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 55121928, "answer_count": 3, "score": 0, "last_activity_date": 1552397114, "creation_date": 1552394956, "last_edit_date": 1552395377, "question_id": 55121896, "link": "https://stackoverflow.com/questions/55121896/how-could-i-display-a-text-on-the-same-line", "title": "How could I display a text on the same line?", "body": "<p>I accept text input from a user. When I use the received text within a line as follows,</p>\n\n<pre><code>puts \"whats your name?\"\n$name = STDIN.gets\nputs \"Oh #$name, nice to meet you\"\n</code></pre>\n\n<p>it is displayed on a separate line. It puts the name and then the <code>\"nice to meet you\"</code> on a new line.</p>\n\n<p>Is there a way to fix this? Also if you see something wrong, please tell me.</p>\n"}, {"tags": ["ruby", "rspec", "factory-bot"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552392524, "post_id": 55121099, "comment_id": 96983696, "body": "Do you have a model called <code>ActivityFitFile</code>?"}, {"owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552392963, "post_id": 55121099, "comment_id": 96983941, "body": "@SergioTulentsev No. I don&#39;t think there should be. The model is Activity and this is just an activity factory with different data. Typing that out though made me realize there is no way for factorybot to know what the actual model is called so I must have done something wrong there"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 7, "last_activity_date": 1552393061, "creation_date": 1552393061, "answer_id": 55121273, "question_id": 55121099, "link": "https://stackoverflow.com/questions/55121099/factorybot-uninitialized-constant-factoryname/55121273#55121273", "title": "FactoryBot uninitialized constant FactoryName", "body": "<p>You can have custom factory names, but you have to specify the actual classes then.</p>\n\n<pre><code>factory :activity_fit_file, class: 'Activity' do\n  \u00b7\u00b7\u00b7\nend\n</code></pre>\n"}], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1107, "favorite_count": 0, "accepted_answer_id": 55121273, "answer_count": 1, "score": 2, "last_activity_date": 1552393362, "creation_date": 1552392414, "question_id": 55121099, "link": "https://stackoverflow.com/questions/55121099/factorybot-uninitialized-constant-factoryname", "title": "FactoryBot uninitialized constant FactoryName", "body": "<p>I have the factory </p>\n\n<pre><code>FactoryBot.define do\n    factory :activity_fit_file do\n        association :user, factory: :user\n        activity_type {:cycling}\n        after(:build) do |activity|\n            activity.original_activity_log_file.attach(\n                io: File.open(\"#{Rails.root}/spec/files/example_fit_file.fit\"),\n                filename: 'example_fit_file.fit',\n                content_type: 'application/vnd.ant.fit'\n            )\n        end\n    end\nend\n</code></pre>\n\n<p>and in my spec I have</p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe \"Activity upload fixer\" do\n    it 'converts fit files to gpx' do\n        activity = FactoryBot.create(:activity_fit_file)\n    end\nend\n</code></pre>\n\n<p>Running the spec gives the error</p>\n\n<pre><code> NameError:\n   uninitialized constant ActivityFitFile\n</code></pre>\n\n<p>Not quite sure what is wrong because it seems the same as other working factories.</p>\n"}, {"tags": ["ruby", "rspec", "factory-bot"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 5, "creation_date": 1552388312, "post_id": 55119360, "comment_id": 96981140, "body": "Try <code>first_name { &#39;John&#39; }</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1552390515, "post_id": 55119360, "comment_id": 96982493, "body": "^^^ what Sergio said. <a href=\"https://github.com/thoughtbot/factory_bot/blob/master/GETTING_STARTED.md#static-attributes\" rel=\"nofollow noreferrer\">Static attributes</a> were removed in factory_bot 5."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1552390861, "post_id": 55119360, "comment_id": 96982685, "body": "@Stefan: the error message could have been better, though. It&#39;s useless as it is."}, {"owner": {"reputation": 343, "user_id": 682038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0d3e1cd54a505c5b2c73eb473ecbf25?s=128&d=identicon&r=PG", "display_name": "denBelg", "link": "https://stackoverflow.com/users/682038/denbelg"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552391939, "post_id": 55119360, "comment_id": 96983358, "body": "@Stefan: Yes that&#39;s the problem. Thanks! And yes the message could be better..."}], "answers": [{"tags": [], "owner": {"reputation": 2352, "user_id": 157931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986d255e94481d2249bae7911e7845e8?s=128&d=identicon&r=PG", "display_name": "Danilo Cabello", "link": "https://stackoverflow.com/users/157931/danilo-cabello"}, "is_accepted": true, "score": 10, "last_activity_date": 1552409005, "last_edit_date": 1552409005, "creation_date": 1552392839, "answer_id": 55121212, "question_id": 55119360, "link": "https://stackoverflow.com/questions/55119360/updating-from-factorygirl-to-factorybot-results-in-nomethoderror/55121212#55121212", "title": "Updating from FactoryGirl to factoryBot results in NoMethodError", "body": "<p>Like people said in the comments static attributes like <code>first_name 'John'</code> have been deprecated on v4 (check <a href=\"https://thoughtbot.com/blog/deprecating-static-attributes-in-factory_bot-4-11\" rel=\"noreferrer\">this guide</a>) and then removed on v5, the alternative is to make them like dynamic attributes: <code>first_name { 'John' }</code>.</p>\n\n<p>They even included a Rubocop to help you fix all of your factories:</p>\n\n<pre><code>rubocop \\\n  --require rubocop-rspec \\\n  --only FactoryBot/AttributeDefinedStatically \\\n  --auto-correct\n</code></pre>\n\n<p>My recommendation is to migrate slowly but surely, go from <code>FactoryGirl</code> to <code>FactoryBot</code> using a similar version, run your specs, check for all deprecation warnings, run the custom Rubocop to auto-correct your factories, then only migrate major versions after reading the <a href=\"https://github.com/thoughtbot/factory_bot/blob/master/NEWS.md\" rel=\"noreferrer\">changelog</a>.</p>\n\n<p>I agree the message could be a bit better, usually the main goal of deprecation is to simplify code and reduce branching logic, so once the deprecation warning was there for enough time and it is time to remove it, any detection of the old usage would be extra code that had to be removed, common result in open source projects.</p>\n\n<p>Glad you found your way out.</p>\n"}], "owner": {"reputation": 343, "user_id": 682038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0d3e1cd54a505c5b2c73eb473ecbf25?s=128&d=identicon&r=PG", "display_name": "denBelg", "link": "https://stackoverflow.com/users/682038/denbelg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 1, "accepted_answer_id": 55121212, "answer_count": 1, "score": 4, "last_activity_date": 1552409005, "creation_date": 1552386831, "question_id": 55119360, "link": "https://stackoverflow.com/questions/55119360/updating-from-factorygirl-to-factorybot-results-in-nomethoderror", "title": "Updating from FactoryGirl to factoryBot results in NoMethodError", "body": "<p>I tried to convert from FactoryGirl to FactoryBot. This should not be a big issue but i do not get it to work. The code:</p>\n\n<p>Added to Gem File</p>\n\n<pre><code>gem 'factory_bot'\n</code></pre>\n\n<p>Added to spec_helper</p>\n\n<pre><code>FactoryBot.definition_file_paths = %w(spec/factories)\nFactoryBot.find_definitions\n\nconfig.include FactoryBot::Syntax::Methods\n</code></pre>\n\n<p>Factory</p>\n\n<pre><code>FactoryBot.define do\n  factory :user do\n    first_name 'John'\n    last_name  'Doe'\n    birthdate  { 21.years.ago }\n    admin false\n  end\nend\n</code></pre>\n\n<p>When i try to run a rspec test i get following error:</p>\n\n<pre><code>NoMethodError: undefined method 'first_name' in 'user' factory!\n   Method_missing at C:/jruby-9.1.17.0/lib/ruby/gems/shared/gems/factory_bot-5.0.2/lib/factory_bot/definition_proxy.rb:97\n   block in (root) at &lt;path to factory&gt;\n</code></pre>\n\n<p>It seems to me the gem is correctly loaded into the project, the factoryBot code is executed. But for some reason it does not recognize the structure of the factory.</p>\n\n<p>Note:\n- I did a bundle install/update</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 453, "user_id": 477550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48eae66165da33bca4c2950d4f76be02?s=128&d=identicon&r=PG", "display_name": "beeman", "link": "https://stackoverflow.com/users/477550/beeman"}, "edited": false, "score": 2, "creation_date": 1556101449, "post_id": 55116268, "comment_id": 98320293, "body": "I had to execute the command like this:   <code>gem install concurrent-ruby-ext -v 1.1.5</code>"}], "tags": [], "owner": {"reputation": 121, "user_id": 8252541, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0PAEU.jpg?s=128&g=1", "display_name": "\u6c5f\u6d0b\u5927\u76d7", "link": "https://stackoverflow.com/users/8252541/%e6%b1%9f%e6%b4%8b%e5%a4%a7%e7%9b%97"}, "is_accepted": false, "score": 7, "last_activity_date": 1564124901, "last_edit_date": 1564124901, "creation_date": 1552376223, "answer_id": 55116268, "question_id": 55116034, "link": "https://stackoverflow.com/questions/55116034/unable-to-activate-concurrent-ruby-ext-1-1-3-because-concurrent-ruby-1-1-4-conf/55116268#55116268", "title": "Unable to activate concurrent-ruby-ext-1.1.3, because concurrent-ruby-1.1.4 conflicts with concurrent-ruby (= 1.1.3) (Gem::ConflictError)", "body": "<p>I solved the problem by <code>gem install concurrent-ruby-ext -v 1.1.5</code></p>\n\n<p>gem 'concurrent-ruby-ext' has always same version as gem 'concurrent-ruby'</p>\n\n<p>You can refer to\n<a href=\"https://www.rubydoc.info/gems/concurrent-ruby-ext/1.1.5\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/concurrent-ruby-ext/1.1.5</a></p>\n\n<pre><code>gem list | grep concurrent\nconcurrent-ruby (1.1.5, 1.1.4, 1.1.3, 1.0.2)\nconcurrent-ruby-ext (1.1.5, 1.1.3)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 2424375, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dda9517314a0bdc075c8be8cee841317?s=128&d=identicon&r=PG", "display_name": "\u9648\u5065 Mark", "link": "https://stackoverflow.com/users/2424375/%e9%99%88%e5%81%a5-mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1572349112, "creation_date": 1572349112, "answer_id": 58606720, "question_id": 55116034, "link": "https://stackoverflow.com/questions/55116034/unable-to-activate-concurrent-ruby-ext-1-1-3-because-concurrent-ruby-1-1-4-conf/58606720#58606720", "title": "Unable to activate concurrent-ruby-ext-1.1.3, because concurrent-ruby-1.1.4 conflicts with concurrent-ruby (= 1.1.3) (Gem::ConflictError)", "body": "<p>@\u6c5f\u6d0b\u5927\u76d7 is right, if the build system or <code>gemfile.lock</code> lock the build toolchain version, you may need to down-grade the <code>concurrent-ruby</code> and <code>concurrent-ruby-ext</code> version. Command as below.</p>\n\n<pre><code>$ gem uninstall concurrent-ruby -v 1.1.4\n\nor \n\n$ gem uninstall concurrent-ruby-ext -v 1.1.5\n</code></pre>\n\n<p>Hope it will help.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5668582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1sJ24.jpg?s=128&g=1", "display_name": "kia", "link": "https://stackoverflow.com/users/5668582/kia"}, "is_accepted": false, "score": 0, "last_activity_date": 1585247284, "creation_date": 1585247284, "answer_id": 60873888, "question_id": 55116034, "link": "https://stackoverflow.com/questions/55116034/unable-to-activate-concurrent-ruby-ext-1-1-3-because-concurrent-ruby-1-1-4-conf/60873888#60873888", "title": "Unable to activate concurrent-ruby-ext-1.1.3, because concurrent-ruby-1.1.4 conflicts with concurrent-ruby (= 1.1.3) (Gem::ConflictError)", "body": "<p>You can update your gem with <code>gem update</code> then create your project with <code>rails new upload_app</code></p>\n"}], "owner": {"reputation": 121, "user_id": 8252541, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0PAEU.jpg?s=128&g=1", "display_name": "\u6c5f\u6d0b\u5927\u76d7", "link": "https://stackoverflow.com/users/8252541/%e6%b1%9f%e6%b4%8b%e5%a4%a7%e7%9b%97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1046, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1585247284, "creation_date": 1552375186, "question_id": 55116034, "link": "https://stackoverflow.com/questions/55116034/unable-to-activate-concurrent-ruby-ext-1-1-3-because-concurrent-ruby-1-1-4-conf", "title": "Unable to activate concurrent-ruby-ext-1.1.3, because concurrent-ruby-1.1.4 conflicts with concurrent-ruby (= 1.1.3) (Gem::ConflictError)", "body": "<p>ruby version  2.5.3 </p>\n\n<p>When I typed <code>rails new upload_app</code>, the following error occurred</p>\n\n<p>The error is below</p>\n\n<pre><code>Traceback (most recent call last):\n    39: from /Users/zhangjiachen/.rvm/gems/ruby-2.5.3/bin/rails:23:in `&lt;main&gt;'\n    38: from /Users/zhangjiachen/.rvm/gems/ruby-2.5.3/bin/rails:23:in `load'\n    37: from /Users/zhangjiachen/.rvm/gems/ruby-2.5.3@global/gems/railties-5.2.2/exe/rails:10:in `&lt;top (required)&gt;'\n    36: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    35: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    34: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.2/lib/rails/cli.rb:12:in `&lt;top (required)&gt;'\n    33: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    32: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    31: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.2/lib/rails/command.rb:3:in `&lt;top (required)&gt;'\n    30: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    29: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    28: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support.rb:27:in `&lt;top (required)&gt;'\n    27: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    26: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    25: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/dependencies/autoload.rb:3:in `&lt;top (required)&gt;'\n    24: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    23: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    22: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/inflector/methods.rb:3:in `&lt;top (required)&gt;'\n    21: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    20: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    19: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/inflections.rb:3:in `&lt;top (required)&gt;'\n    18: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    17: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    16: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/inflector/inflections.rb:3:in `&lt;top (required)&gt;'\n    15: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    14: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    13: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/concurrent-ruby-1.1.4/lib/concurrent/map.rb:3:in `&lt;top (required)&gt;'\n    12: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    11: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    10: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/concurrent-ruby-1.1.4/lib/concurrent/synchronization.rb:5:in `&lt;top (required)&gt;'\n     9: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/concurrent-ruby-1.1.4/lib/concurrent/utility/native_extension_loader.rb:30:in `load_native_extensions'\n     8: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/concurrent-ruby-1.1.4/lib/concurrent/utility/native_extension_loader.rb:30:in `each'\n     7: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/concurrent-ruby-1.1.4/lib/concurrent/utility/native_extension_loader.rb:30:in `block in load_native_extensions'\n     6: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/concurrent-ruby-1.1.4/lib/concurrent/utility/native_extension_loader.rb:62:in `try_load_c_extension'\n     5: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:34:in `require'\n     4: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:123:in `rescue in require'\n     3: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems.rb:217:in `try_activate'\n     2: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems.rb:224:in `rescue in try_activate'\n     1: from /Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/specification.rb:1441:in `activate'\n/Users/zhangjiachen/.rvm/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/specification.rb:2332:in `raise_if_conflicts': Unable to activate concurrent-ruby-ext-1.1.3, because concurrent-ruby-1.1.4 conflicts with concurrent-ruby (= 1.1.3) (Gem::ConflictError)\n</code></pre>\n\n<p>I tried something</p>\n\n<ol>\n<li><p>gem list | grep concurrent\n=><br>\nconcurrent-ruby (1.1.4, 1.1.3, 1.0.2)\nconcurrent-ruby-ext (1.1.3)</p></li>\n<li><p>gem uninstall concurrent-ruby-1.1.3\n=>\nGem 'concurrent-ruby-1.1.3' is not installed</p></li>\n<li><p>gem install concurrent-ruby-ext\nERROR:  Could not find a valid gem 'concurrent-ruby-ext' (>= 0), here is why:\n      Unable to download data from <a href=\"https://rubygems.org/\" rel=\"nofollow noreferrer\">https://rubygems.org/</a> - no such name (<a href=\"https://rubygems.org/specs.4.8.gz\" rel=\"nofollow noreferrer\">https://rubygems.org/specs.4.8.gz</a>)</p></li>\n</ol>\n"}, {"tags": ["ruby", "redis", "sidekiq", "ruby-on-rails-4.2"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1552375374, "post_id": 55116009, "comment_id": 96973668, "body": "It looks like the message from Postgresql. Are you sure your DB config is correct?"}, {"owner": {"reputation": 329, "user_id": 1752251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/18234c3c6b04ac08d8afb1eeb2e20269?s=128&d=identicon&r=PG", "display_name": "Avinash", "link": "https://stackoverflow.com/users/1752251/avinash"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1552375466, "post_id": 55116009, "comment_id": 96973711, "body": "yes, because the app is running on the server with proper data."}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1552376144, "post_id": 55116009, "comment_id": 96974065, "body": "However, @MarekLipka is right: you have an issue with DB connection. I guess, you have to provide <i>environment</i> when start Sidekiq. Otherwise, your Sidekiq uses <i>development</i> settings instead of <i>production</i> one."}, {"owner": {"reputation": 329, "user_id": 1752251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/18234c3c6b04ac08d8afb1eeb2e20269?s=128&d=identicon&r=PG", "display_name": "Avinash", "link": "https://stackoverflow.com/users/1752251/avinash"}, "edited": false, "score": 0, "creation_date": 1552378110, "post_id": 55116009, "comment_id": 96974948, "body": "Just found out, we are using RDS. But i guess somehow redis is unable to connect to rds db ?"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 1, "creation_date": 1552379046, "post_id": 55116009, "comment_id": 96975429, "body": "You got Postgresql error, not Redis one. Try to specify <i>environment</i> like <code>bundle exec sidekiq -e production</code>."}, {"owner": {"reputation": 329, "user_id": 1752251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/18234c3c6b04ac08d8afb1eeb2e20269?s=128&d=identicon&r=PG", "display_name": "Avinash", "link": "https://stackoverflow.com/users/1752251/avinash"}, "edited": false, "score": 0, "creation_date": 1552380023, "post_id": 55116009, "comment_id": 96975945, "body": "Its working now. I changed the permissions for redis(it was on root level). &amp; started with the production environment for sidekiq."}], "answers": [{"tags": [], "owner": {"reputation": 329, "user_id": 1752251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/18234c3c6b04ac08d8afb1eeb2e20269?s=128&d=identicon&r=PG", "display_name": "Avinash", "link": "https://stackoverflow.com/users/1752251/avinash"}, "is_accepted": false, "score": 0, "last_activity_date": 1552452987, "creation_date": 1552452987, "answer_id": 55134671, "question_id": 55116009, "link": "https://stackoverflow.com/questions/55116009/sidekiq-on-production-server-gives-error-on-runing/55134671#55134671", "title": "Sidekiq on production server gives error on runing", "body": "<p>Closing this thread as it has been fixed.</p>\n\n<p>Changed the permissions for Redis from root level to user level.\nAnd running sidekiq in production mode.</p>\n"}], "owner": {"reputation": 329, "user_id": 1752251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/18234c3c6b04ac08d8afb1eeb2e20269?s=128&d=identicon&r=PG", "display_name": "Avinash", "link": "https://stackoverflow.com/users/1752251/avinash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552452987, "creation_date": 1552375101, "question_id": 55116009, "link": "https://stackoverflow.com/questions/55116009/sidekiq-on-production-server-gives-error-on-runing", "title": "Sidekiq on production server gives error on runing", "body": "<p>We are using Amazon AWS Ubuntu machine for our server.\nRails 4.2.7 and Ruby 2.3</p>\n\n<p>I have installed redis with these instructions (<a href=\"https://redis.io/topics/quickstart\" rel=\"nofollow noreferrer\">Redis</a>)</p>\n\n<p>and installed sidekiq with <a href=\"https://thomasroest.com/2017/03/04/properly-setting-up-redis-and-sidekiq-in-production-ubuntu-16-04.html\" rel=\"nofollow noreferrer\">Sidekiq</a></p>\n\n<p>I started redis, then starting sidekiq with just <code>bundle exec sidekiq</code> it give me error as running the jobs</p>\n\n<pre><code>FATAL:  password authentication failed for user \"ubuntu\"\n</code></pre>\n\n<p>Not sure why this error. Any suggestions ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "imagemagick", "rmagick"], "answers": [{"comments": [{"owner": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "edited": false, "score": 0, "creation_date": 1552384712, "post_id": 55115805, "comment_id": 96978813, "body": "But this also is wasting unnecessary resources right, I am trying to avoid that. I want to check for transparency and do these steps only if its detected"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "edited": false, "score": 0, "creation_date": 1552387926, "post_id": 55115805, "comment_id": 96980888, "body": "Maybe you are looking for the instance method <code>alpha?</code>: <a href=\"https://rmagick.github.io/image1.html#alpha_q\" rel=\"nofollow noreferrer\">rmagick.github.io/image1.html#alpha_q</a> | In case, see my edit."}, {"owner": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "edited": false, "score": 0, "creation_date": 1552457358, "post_id": 55115805, "comment_id": 97011396, "body": "I just checked image.alpha? and it returns false for an image with transparency in it."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "edited": false, "score": 0, "creation_date": 1552462465, "post_id": 55115805, "comment_id": 97013530, "body": "I tested some images and <code>alpha?</code> is working fine for me."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1552387751, "last_edit_date": 1552387751, "creation_date": 1552374177, "answer_id": 55115805, "question_id": 55115359, "link": "https://stackoverflow.com/questions/55115359/is-there-anyway-i-an-detect-transparent-pixels-in-an-image-using-rmagick/55115805#55115805", "title": "Is there anyway I an detect transparent pixels in an image using rmagick?", "body": "<p>Try if this way is ok for you: composite the image to a white background of the image size. For example, given the alpha channel image <code>img.png</code>:</p>\n\n<pre><code>require 'rmagick'\ninclude Magick\n\nimage = Magick::Image.read(\"img.png\").first\nw = image.columns\nh = image.rows\n\nif image.alpha?\n  bg = Image.new(w,h) { self.background_color = \"white\" } # create a white background\n  image = bg.composite(image, NorthWestGravity, 0, 0, OverCompositeOp) # compose\nend\n\nimage.write(\"img_out.png\")\n</code></pre>\n\n<p>Look for <a href=\"https://rmagick.github.io/constants.html\" rel=\"nofollow noreferrer\">rmagick constants</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "edited": false, "score": 0, "creation_date": 1552457295, "post_id": 55125841, "comment_id": 97011373, "body": "Can you please let me know what does this part mean? <code>-format &quot;%[fx:mean]&quot; info:)</code>. I checked rmagick manual and saw they have an alpha method with argument <code>ExtractAlphaChannel</code>. The explanation given is: Creates a grayscale mask of the image&#39;s shape by copying the alpha channel values into all the color channels, and then turning off the image&#39;s transparency. Where do I go from here to calculate the average?"}, {"owner": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "reply_to_user": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "edited": false, "score": 1, "creation_date": 1552494978, "post_id": 55125841, "comment_id": 97034429, "body": "See <a href=\"https://imagemagick.org/script/escape.php\" rel=\"nofollow noreferrer\">imagemagick.org/script/escape.php</a>. It computes the mean of the whole image and reports that back so that it can be put into a variable."}, {"owner": {"reputation": 4259, "user_id": 1031454, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/5Om4z.jpg?s=128&g=1", "display_name": "supersan", "link": "https://stackoverflow.com/users/1031454/supersan"}, "edited": false, "score": 0, "creation_date": 1605605488, "post_id": 55125841, "comment_id": 114694956, "body": "works perfectly! thanks for the link to docs also.. i also couldn&#39;t find any info on how these % tags work!"}, {"owner": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "edited": false, "score": 0, "creation_date": 1605630375, "post_id": 55125841, "comment_id": 114706920, "body": "fx is the calculator in ImageMagick. It can be used to compute one value or process the whole image. See <a href=\"https://imagemagick.org/script/escape.php\" rel=\"nofollow noreferrer\">imagemagick.org/script/escape.php</a> and <a href=\"https://imagemagick.org/Usage/transform/#fx_escapes\" rel=\"nofollow noreferrer\">imagemagick.org/Usage/transform/#fx_escapes</a> and <a href=\"https://imagemagick.org/script/fx.php\" rel=\"nofollow noreferrer\">imagemagick.org/script/fx.php</a>"}], "tags": [], "owner": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "is_accepted": false, "score": 2, "last_activity_date": 1552406357, "creation_date": 1552406357, "answer_id": 55125841, "question_id": 55115359, "link": "https://stackoverflow.com/questions/55115359/is-there-anyway-i-an-detect-transparent-pixels-in-an-image-using-rmagick/55125841#55125841", "title": "Is there anyway I an detect transparent pixels in an image using rmagick?", "body": "<p>In command line Imagemagick, extract the alpha channel and test if its average is less than 1. If so, then it has transparency. If exactly 1, then no transparency.</p>\n\n<pre><code>value=$(convert image -alpha extract -format \"%[fx:mean]\" info:)\n\nor\n\nvalue=$(convert image -alpha extract -scale 1x1! -format \"%[fx:u]\" info:)\n\nif [ \"$value\" = 1 ]; then\necho \"opaque\"\nelse\necho \"transparent\"\nfi\n</code></pre>\n\n<p>Sorry, I do not know RMagick.</p>\n"}], "owner": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1552406357, "creation_date": 1552372042, "question_id": 55115359, "link": "https://stackoverflow.com/questions/55115359/is-there-anyway-i-an-detect-transparent-pixels-in-an-image-using-rmagick", "title": "Is there anyway I an detect transparent pixels in an image using rmagick?", "body": "<p>I am using Rmagick to generate icons for iOS. And for this I need to remove transparency. For now I am deactivating the alpha channel and flattening all the images. Here is the code I use for this.</p>\n\n<pre><code>app_store_icon = ImageList.new(app_store_icon_url)\napp_store_icon.alpha(DeactivateAlphaChannel)\napp_store_icon.flatten_images\n</code></pre>\n\n<p>But I would like to avoid this unnecessary steps if the user uploads a proper png image without transparency. So how do check if there are any transparency in the image and do the above stpes only if required?</p>\n"}, {"tags": ["ruby-on-rails", "node.js", "ruby", "reactjs", "heroku"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1552360307, "post_id": 55113507, "comment_id": 96969378, "body": "The <code>App not compatible with buildpack</code> error message is giving you a hint. Have you set the buildpacks needed for deploying your application? You might take a look to the <a href=\"https://devcenter.heroku.com/articles/buildpacks#officially-supported-buildpacks\" rel=\"nofollow noreferrer\">docs</a>."}, {"owner": {"reputation": 9, "user_id": 7739916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YM855.jpg?s=128&g=1", "display_name": "Sergio Torres", "link": "https://stackoverflow.com/users/7739916/sergio-torres"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1552360830, "post_id": 55113507, "comment_id": 96969479, "body": "hi Sebastian! hahaha yes.. i did check that.. i have this two: heroku/nodejs heroku/ruby  i added them with this command: heroku buildpacks:add heroku/nodejs --index 1 heroku buildpacks:add heroku/ruby --index 2"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1552361167, "post_id": 55113507, "comment_id": 96969551, "body": "Which of both applications is throwing the buildpack incompatibility? Just checking, is that file really called &quot;pachage.json&quot;? not &quot;package.json&quot;?"}, {"owner": {"reputation": 9, "user_id": 7739916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YM855.jpg?s=128&g=1", "display_name": "Sergio Torres", "link": "https://stackoverflow.com/users/7739916/sergio-torres"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1552361626, "post_id": 55113507, "comment_id": 96969632, "body": "About the first question, i think is the ruby app.. cause it says that the build is OK and it reads and compile my components, even found one or two warnings in them... about the second question, just a typo. Already edited."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1552362011, "post_id": 55113507, "comment_id": 96969727, "body": "Can you try clearing the buildpack and setting it again?"}, {"owner": {"reputation": 9, "user_id": 7739916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YM855.jpg?s=128&g=1", "display_name": "Sergio Torres", "link": "https://stackoverflow.com/users/7739916/sergio-torres"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1552362519, "post_id": 55113507, "comment_id": 96969835, "body": "yes, i did it. even created a new app and added the builpacks before the deploy.. same error. :("}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1552396743, "post_id": 55113507, "comment_id": 96986292, "body": "Do you really need to deploy them in the same package? From a maintenance perspective it seems like a much better idea to deploy each separately which also lets you scale the resources appropriately for the separate needs of the API / frontend."}, {"owner": {"reputation": 9, "user_id": 7739916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YM855.jpg?s=128&g=1", "display_name": "Sergio Torres", "link": "https://stackoverflow.com/users/7739916/sergio-torres"}, "edited": false, "score": 0, "creation_date": 1552424910, "post_id": 55113507, "comment_id": 97002897, "body": "maybe you are right.. do you know some tutorial to do just that? :) thanks!"}], "owner": {"reputation": 9, "user_id": 7739916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YM855.jpg?s=128&g=1", "display_name": "Sergio Torres", "link": "https://stackoverflow.com/users/7739916/sergio-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552361178, "creation_date": 1552359821, "last_edit_date": 1552361178, "question_id": 55113507, "link": "https://stackoverflow.com/questions/55113507/heroku-deploy-react-rails-separate-folders", "title": "heroku: deploy react rails separate folders", "body": "<p>I'm trying to deploy my app to heroku, but i can't find a way. I have in the root two folders, 'back' and 'front', the first is a rails api app and the second is a react app.</p>\n\n<p>I think the react deploy is OK, but ruby is not. \nI have the buildpacks needed:\nheroku/nodejs\nheroku/tuby</p>\n\n<p>Please help me out! :)</p>\n\n<p>/package.json</p>\n\n<pre><code>{\n  \"name\": \"sophia\",\n  \"license\": \"MIT\",\n  \"engines\": {\n    \"node\": \"6.3.1\"\n  },\n  \"scripts\": {\n    \"build\": \"cd front &amp;&amp; npm install &amp;&amp; npm run build &amp;&amp; cd ..\",\n    \"deploy\": \"cp -a front/build/. back/public/\",\n    \"postinstall\": \"npm run build &amp;&amp; npm run deploy &amp;&amp; echo 'Client built!'\"\n  }\n}\n\n</code></pre>\n\n<p>Procfile</p>\n\n<pre><code>web: cd front &amp;&amp; PORT=3000 npm start\napi: cd back PORT=3001 &amp;&amp; bundle exec rails s\n</code></pre>\n\n<p>/front/package.json</p>\n\n<pre><code>{\n  \"name\": \"client\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"proxy\": \"http://localhost:3001\",\n  \"dependencies\": {\n    \"react\": \"^16.8.4\",\n    \"react-dom\": \"^16.8.4\",\n    \"react-scripts\": \"2.1.8\"\n  },\n  \"scripts\": {\n    \"start\": \"react-scripts start\",\n    \"build\": \"react-scripts build\",\n    \"test\": \"react-scripts test --env=jsdom\",\n    \"eject\": \"react-scripts eject\"\n  },\n  \"eslintConfig\": {\n    \"extends\": \"react-app\"\n  },\n  \"browserslist\": [\n    \"&gt;0.2%\",\n    \"not dead\",\n    \"not ie &lt;= 11\",\n    \"not op_mini all\"\n  ]\n}\n\n</code></pre>\n\n<p>Heroku error</p>\n\n<pre><code>remote:          \"homepage\" :\nremote:        \nremote:        The build folder is ready to be deployed.\nremote:        You may serve it with a static server:\nremote:        \nremote:          yarn global add serve\nremote:          serve -s build\nremote:        \nremote:        Find out more about deployment here:\nremote:        \nremote:          \nremote:        \nremote:        \nremote: -----&gt; Caching build\nremote:        - node_modules\nremote:        \nremote: -----&gt; Pruning devDependencies\nremote:        \nremote: -----&gt; Build succeeded!\nremote:  !     Unmet dependencies don't fail npm install but may cause runtime issues\nremote:        github.com/npm/npm/issues/7494\nremote: \nremote: \nremote: -----&gt; Change to Node.js build process \nremote:        Heroku has begun executing the \"build\" script defined in package.json\nremote:        during Node.js builds.\nremote: \nremote:        Read more: https://devcenter.heroku.com/changelog-items/1573\nremote: \nremote: -----&gt; App not compatible with buildpack: buildpack-registry.s3.amazonaws.com/buildpacks/heroku/ruby.tgz\nremote:        More info: devcenter.heroku.com/articles/buildpacks#detection-failure\nremote: \nremote:  !     Push failed\nremote: Verifying deploy...\nremote: \nremote: !       Push rejected to sophia-social-network.\nremote: \nTo git.heroku.com/sophia-social-network.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\nerror: failed to push some refs to 'hgit.heroku.com/sophia-social-network.git'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 520, "user_id": 6507755, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/IUwxM.png?s=128&g=1", "display_name": "2017kamb", "link": "https://stackoverflow.com/users/6507755/2017kamb"}, "edited": false, "score": 1, "creation_date": 1552360910, "post_id": 55113214, "comment_id": 96969495, "body": "Try to reinstall ruby then rails and then try, what happens?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 4, "creation_date": 1552362114, "post_id": 55113214, "comment_id": 96969747, "body": "Upgrade your Ruby to at least 2.3, that&#39;s when the safe navigation operator (<code>&amp;.</code>) was added: <a href=\"https://www.ruby-lang.org/en/news/2015/12/25/ruby-2-3-0-released/\" rel=\"nofollow noreferrer\">ruby-lang.org/en/news/2015/12/25/ruby-2-3-0-released</a>"}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552370548, "post_id": 55114900, "comment_id": 96971787, "body": "Why Ruby 2.5.0 now? It is neither the oldest required for <code>&amp;.</code>, nor the newest available."}, {"owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552371066, "post_id": 55114900, "comment_id": 96971985, "body": "I have tried in my local system for rails new app. it is working fine. so i suggested."}], "tags": [], "owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1552369790, "creation_date": 1552369790, "answer_id": 55114900, "question_id": 55113214, "link": "https://stackoverflow.com/questions/55113214/getting-syntax-error-when-running-rails-new/55114900#55114900", "title": "Getting syntax error when running &quot;rails new&quot;", "body": "<p>Try to use rvm and then install rails.</p>\n\n<pre><code>rvm install 2.5.0\n</code></pre>\n\n<p>Reference : <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">https://rvm.io/rvm/install</a></p>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1552370517, "creation_date": 1552370517, "answer_id": 55115038, "question_id": 55113214, "link": "https://stackoverflow.com/questions/55113214/getting-syntax-error-when-running-rails-new/55115038#55115038", "title": "Getting syntax error when running &quot;rails new&quot;", "body": "<p>The safe navigation operator <code>&amp;.</code> is invalid in Ruby &lt; 2.3. And you are using Ruby 2.2. That is the cause of the syntax error.</p>\n"}], "owner": {"reputation": 101, "user_id": 6425652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c1cce2c8bb0bd9a2074247a14f233b7?s=128&d=identicon&r=PG&f=1", "display_name": "goodjobbin85", "link": "https://stackoverflow.com/users/6425652/goodjobbin85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1552370691, "creation_date": 1552357567, "last_edit_date": 1552370691, "question_id": 55113214, "link": "https://stackoverflow.com/questions/55113214/getting-syntax-error-when-running-rails-new", "title": "Getting syntax error when running &quot;rails new&quot;", "body": "<p>When I try to create a new project by running:</p>\n\n<pre><code>rails new app \n</code></pre>\n\n<p>I get the following error message:</p>\n\n<pre><code>/usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:121:in `require': /usr/lib/ruby/vendor_ruby/did_you_mean/spell_checkers/method_name_checker.rb:9: syntax error, unexpected '.' (SyntaxError)\n      @has_args    = !exception.args&amp;.empty?\n                                      ^\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:121:in `require'\n    from /usr/lib/ruby/vendor_ruby/did_you_mean.rb:6:in `&lt;top (required)&gt;'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:121:in `require'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:121:in `require'\n    from /var/lib/gems/2.2.0/gems/thor-0.20.3/lib/thor/error.rb:4:in `&lt;class:Thor&gt;'\n    from /var/lib/gems/2.2.0/gems/thor-0.20.3/lib/thor/error.rb:1:in `&lt;top (required)&gt;'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n    from /var/lib/gems/2.2.0/gems/thor-0.20.3/lib/thor/base.rb:4:in `&lt;top (required)&gt;'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n    from /var/lib/gems/2.2.0/gems/thor-0.20.3/lib/thor.rb:2:in `&lt;top (required)&gt;'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:121:in `require'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:121:in `require'\n    from /var/lib/gems/2.2.0/gems/railties-5.1.4/lib/rails/command.rb:7:in `&lt;top (required)&gt;'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n    from /var/lib/gems/2.2.0/gems/railties-5.1.4/lib/rails/cli.rb:10:in `&lt;top (required)&gt;'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n    from /usr/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n    from /var/lib/gems/2.2.0/gems/railties-5.1.4/exe/rails:9:in `&lt;top (required)&gt;'\n    from /usr/local/bin/rails:23:in `load'\n    from /usr/local/bin/rails:23:in `&lt;main&gt;'\n</code></pre>\n\n<p>I'm not sure what's going on. What's this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeadmin"], "comments": [{"owner": {"reputation": 1641, "user_id": 790737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b5cec3d638d5eeefd2b32800907397?s=128&d=identicon&r=PG", "display_name": "Sjors Branderhorst", "link": "https://stackoverflow.com/users/790737/sjors-branderhorst"}, "edited": false, "score": 0, "creation_date": 1552472614, "post_id": 55112024, "comment_id": 97019276, "body": "Please have a look at <a href=\"https://activeadmin.info/2-resource-customization.html#disabling-actions-on-a-resource\" rel=\"nofollow noreferrer\">activeadmin.info/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11005433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6007bd27bbc5f5f43cde8c9224b241?s=128&d=identicon&r=PG&f=1", "display_name": "Yogi", "link": "https://stackoverflow.com/users/11005433/yogi"}, "edited": false, "score": 0, "creation_date": 1552415161, "post_id": 55112220, "comment_id": 96998332, "body": "What file would I put this in? Config/initializer/active_admin.rb ? I tried putting the code in there but it doesn&#39;t change anything."}, {"owner": {"reputation": 1223, "user_id": 2002995, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d6b193206347ca769933ef83812a4f8e?s=128&d=identicon&r=PG", "display_name": "Manoj Sehrawat", "link": "https://stackoverflow.com/users/2002995/manoj-sehrawat"}, "reply_to_user": {"reputation": 19, "user_id": 11005433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6007bd27bbc5f5f43cde8c9224b241?s=128&d=identicon&r=PG&f=1", "display_name": "Yogi", "link": "https://stackoverflow.com/users/11005433/yogi"}, "edited": false, "score": 0, "creation_date": 1552441240, "post_id": 55112220, "comment_id": 97007548, "body": "Aah no, you have to put this code inside your active admin resource file, ex: <code>app&#47;admin&#47;admin_users.rb</code> in your case. It is generated when you setup the active admin via <code>rails g active_admin:install</code> command"}, {"owner": {"reputation": 19, "user_id": 11005433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6007bd27bbc5f5f43cde8c9224b241?s=128&d=identicon&r=PG&f=1", "display_name": "Yogi", "link": "https://stackoverflow.com/users/11005433/yogi"}, "edited": false, "score": 0, "creation_date": 1552524487, "post_id": 55112220, "comment_id": 97046890, "body": "I have added as suggested but it still isn&#39;t making any changes. I even restarted the server"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1552575451, "post_id": 55112220, "comment_id": 97070568, "body": "Add <code>config.remove_action_item(:destroy)</code> right after <code>ActiveAdmin.register AdminUser do</code>"}], "tags": [], "owner": {"reputation": 1223, "user_id": 2002995, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d6b193206347ca769933ef83812a4f8e?s=128&d=identicon&r=PG", "display_name": "Manoj Sehrawat", "link": "https://stackoverflow.com/users/2002995/manoj-sehrawat"}, "is_accepted": true, "score": 2, "last_activity_date": 1552441434, "last_edit_date": 1552441434, "creation_date": 1552349445, "answer_id": 55112220, "question_id": 55112024, "link": "https://stackoverflow.com/questions/55112024/activeadmin-removing-delete-admin-user-option/55112220#55112220", "title": "ActiveAdmin - Removing Delete admin user option", "body": "<p>You have 2 options to remove it.</p>\n\n<p>One way to remove it with <code>config</code> variable in your <code>active_admin</code> resource file like</p>\n\n<pre><code>    ActiveAdmin.register MyUser do\n        config.remove_action_item(:destroy)\n        ...\n    end    \n</code></pre>\n\n<p>Otherwise you can skip this action via <code>actions</code> method like:</p>\n\n<pre><code>    ActiveAdmin.register MyUser do\n      actions :all, except: [:destroy]\n      ...\n    end\n</code></pre>\n\n<p>ActiveAdmin resource files will be in <code>app/admin</code> directory in the code. For example <code>app/admin/admin_users.rb</code></p>\n"}], "owner": {"reputation": 19, "user_id": 11005433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6007bd27bbc5f5f43cde8c9224b241?s=128&d=identicon&r=PG&f=1", "display_name": "Yogi", "link": "https://stackoverflow.com/users/11005433/yogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 55112220, "answer_count": 1, "score": -1, "last_activity_date": 1552575415, "creation_date": 1552347939, "last_edit_date": 1552575415, "question_id": 55112024, "link": "https://stackoverflow.com/questions/55112024/activeadmin-removing-delete-admin-user-option", "title": "ActiveAdmin - Removing Delete admin user option", "body": "<p>I am trying to get rid of the option so an admin is not able to delete themselves. </p>\n\n<p>Currently, as the picture shows, the admin is able to delete themselves. </p>\n\n<p>I am unsure on how to go about this? I inspected my system and I can see the code for ActiveAdmin layout. However, I am unable to view this. </p>\n\n<p>Remove admin user button:</p>\n\n<p><a href=\"https://i.stack.imgur.com/48Ps5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/48Ps5.png\" alt=\"enter image description here\"></a></p>\n\n<p>app/admin/admin_user.rb:</p>\n\n<pre><code>ActiveAdmin.register AdminUser do\n  index do\n    selectable_column\n    id_column\n    column :email\n    column :current_sign_in_at\n    column :sign_in_count\n    column :created_at\n    actions\n  end\n\n  filter :email\n  filter :current_sign_in_at\n  filter :sign_in_count\n  filter :created_at\n\n  form do |f|\n    f.inputs do\n      f.input :email\n      f.input :password\n      f.input :password_confirmation\n    end\n    f.actions\n  end\nend\n</code></pre>\n\n<p>I added:</p>\n\n<pre><code>ActiveAdmin.register MyUser do\n  config.remove_action_item(:destroy)\nend\n</code></pre>\n\n<p>As suggested, I have added the code but I am still receiving the \"Delete admin user\" button. </p>\n"}, {"tags": ["ruby", "automated-tests", "capybara", "qa"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 2, "last_activity_date": 1552351897, "creation_date": 1552351897, "answer_id": 55112533, "question_id": 55111732, "link": "https://stackoverflow.com/questions/55111732/ruby-capybara-how-to-use-multiple-spec-helper-rb-files/55112533#55112533", "title": "Ruby / Capybara - How to use multiple spec_helper.rb files", "body": "<p><code>spec_helper.rb</code> is not special, it's just a ruby file that you then require from other files (generally the files that define your specs).  You can change the name (or have multiple differently named files) that you then require when needed. </p>\n\n<p>Beyond that your question asking about setting up different blocks of code for different projects doesn't make a lot of sense since different projects would each have their own <code>spec_helper.rb</code> by default.</p>\n"}], "owner": {"reputation": 113, "user_id": 11159536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08b835cc5eaaca8bcd7d3e8beaa6bedd?s=128&d=identicon&r=PG&f=1", "display_name": "drkvader", "link": "https://stackoverflow.com/users/11159536/drkvader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55112533, "answer_count": 1, "score": 0, "last_activity_date": 1552351897, "creation_date": 1552345856, "question_id": 55111732, "link": "https://stackoverflow.com/questions/55111732/ruby-capybara-how-to-use-multiple-spec-helper-rb-files", "title": "Ruby / Capybara - How to use multiple spec_helper.rb files", "body": "<p>I would like to create and use more than one \"spec_helper.rb\" to set up different block of codes for each project. </p>\n\n<p>Is that possible? If so, how can I call a specific \"spec_helper.rb\" in my test file?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "friendly-id"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1552344531, "post_id": 55110770, "comment_id": 96965750, "body": "<code>post_path</code> is the <i>show</i> action, whereas you&#39;re performing an <i>edit</i> action - therefore this will always redirect. Do you actually want this <code>before_action</code> to trigger on the <code>edit</code> action?"}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1552347105, "post_id": 55110770, "comment_id": 96966372, "body": "@TomLord Oh no, I don&#39;t actually as it would always be the up-to-date URL via <code>@post = Post.friendly.find(params[:id])</code> I only wanted to implement this from the docs to solve any old URLs in case I update them."}], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1552344615, "post_id": 55111540, "comment_id": 96965769, "body": "It would be more conventional to write <code>before_action :find_post, only: :show</code>"}, {"owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1552344719, "post_id": 55111540, "comment_id": 96965801, "body": "@TomLord Possibly, but <code>find_post</code> could also be useful for the other actions...you just don&#39;t want to redirect for all of them. Another good option would be extract that into a separate <code>before_action :redirect_to_canonical_route, only: :show</code>."}, {"owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1552344934, "post_id": 55111540, "comment_id": 96965849, "body": "@TomLord I&#39;ve incorporated this into my answer as an alternative."}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1552347368, "post_id": 55111540, "comment_id": 96966421, "body": "What are the benefits of handling the redirecting behavior separately from the pre-load? Anything worth the extra code?"}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1552351305, "post_id": 55111540, "comment_id": 96967446, "body": "@TomLord I have to agree with you, I do like the simplicity of simply having to add <code>, only: :show</code> to my code for everything to work."}], "tags": [], "owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "is_accepted": true, "score": 1, "last_activity_date": 1552344895, "last_edit_date": 1552344895, "creation_date": 1552344541, "answer_id": 55111540, "question_id": 55110770, "link": "https://stackoverflow.com/questions/55110770/friendly-id-preventing-edit-new-pages-due-to-before-action-find-post/55111540#55111540", "title": "Friendly_id preventing edit/new pages due to before_action :find_post", "body": "<p>It sounds to me like you may want to skip that redirect logic for anything but the <code>show</code> action, since <code>redirect_to @post</code> only sends you to the show route.</p>\n\n<pre><code>def find_post\n  @post = Post.find params[:id]\n\n  if action_name == 'show' &amp;&amp; request.path != post_path(@post)\n    return redirect_to @post, :status =&gt; :moved_permanently\n  end\nend\n</code></pre>\n\n<p>Alternately, you can decouple the redirecting behavior from the pre-loading of the post with something like this:</p>\n\n<pre><code>before_action :find_post\nbefore_action :redirect_to_canonical_route, only: :show\n\ndef find_post\n  @post = Post.find params[:id]\nend\n\ndef redirect_to_canonical_route\n  if request.path != post_path(@post)\n    return redirect_to @post, :status =&gt; :moved_permanently\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 55111540, "answer_count": 1, "score": 0, "last_activity_date": 1552347115, "creation_date": 1552340154, "last_edit_date": 1552347115, "question_id": 55110770, "link": "https://stackoverflow.com/questions/55110770/friendly-id-preventing-edit-new-pages-due-to-before-action-find-post", "title": "Friendly_id preventing edit/new pages due to before_action :find_post", "body": "<p>I am using the friendly_id gem to handle URL Slugs and when applying a fix to avoid 404's when the slug changes from the <a href=\"http://norman.github.io/friendly_id/file.Guide.html#History__Avoiding_404_s_When_Slugs_Change\" rel=\"nofollow noreferrer\">documentation</a>, my code doesn't work properly.</p>\n\n<p>The problem is that it simply redirects to the post's show view when I click on the edit button and won't let me make a new post because it \"can't find post with ID...\" because it's using the <code>find_post</code> method.</p>\n\n<p>I do have the <code>friendly_id_slugs</code> table to store history as well.</p>\n\n<p>In my Post Model:</p>\n\n<pre><code>class Post &lt; ApplicationRecord\n  extend FriendlyId\n  friendly_id :title, use: :slugged\n\n  ...\n\n  def should_generate_new_friendly_id?\n    slug.nil? || title_changed?\n  end\nend\n</code></pre>\n\n<p>Post Controller:</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n  before_action :find_post\n\n  ...\n\n  def find_post\n    @post = Post.friendly.find(params[:id])\n\n    # If an old id or a numeric id was used to find the record, then\n    # the request path will not match the post_path, and we should do\n    # a 301 redirect that uses the current friendly id.\n    if request.path != post_path(@post)\n      return redirect_to @post, :status =&gt; :moved_permanently\n    end\n  end\nend\n</code></pre>\n\n<p>I've tried using <code>before_filter</code> but asks me if I mean <code>before_action</code> and I've tried the <code>find_post</code> method in both the public &amp; <code>private</code> section of my controller.</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 4, "creation_date": 1552339258, "post_id": 55109944, "comment_id": 96963965, "body": "WHY do you need a regex for this?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1552340478, "post_id": 55109944, "comment_id": 96964418, "body": "What is your rule? Are we to skip the first word, make the second word the first element of the array and the remainder of the spring to be the second element of the array?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1552361383, "post_id": 55109944, "comment_id": 96969593, "body": "Kindly answer my question. Whoops, I see I wrote &quot;spring&quot; where I meant &quot;string&quot;."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1552543075, "post_id": 55109944, "comment_id": 97051251, "body": "I asked a question. You saw my question but did not respond. I asked for you to respond. You saw that as well but have remained silent. I&#39;ve awarded you a downvote in exchange for your rudeness."}], "answers": [{"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1552339239, "post_id": 55110146, "comment_id": 96963957, "body": "Your demo doesn&#39;t provide the answer the OP&#39;s question."}, {"owner": {"reputation": 2123, "user_id": 7385447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49e3f8e9fbe1149a46d0a8bd19823190?s=128&d=identicon&r=PG", "display_name": "SalmonKiller", "link": "https://stackoverflow.com/users/7385447/salmonkiller"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1552339339, "post_id": 55110146, "comment_id": 96963988, "body": "@lacostenycoder You&#39;re right, I should have been more clear that this &quot;demo&quot; only shows the regex working for the given string format."}], "tags": [], "owner": {"reputation": 2123, "user_id": 7385447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49e3f8e9fbe1149a46d0a8bd19823190?s=128&d=identicon&r=PG", "display_name": "SalmonKiller", "link": "https://stackoverflow.com/users/7385447/salmonkiller"}, "is_accepted": false, "score": 1, "last_activity_date": 1552339922, "last_edit_date": 1552339922, "creation_date": 1552337120, "answer_id": 55110146, "question_id": 55109944, "link": "https://stackoverflow.com/questions/55109944/return-array-that-matches-this/55110146#55110146", "title": "Return array that matches this", "body": "<p>What about using the capturing feature in Ruby?</p>\n\n<p><code>/\\A\\/create (?&lt;command&gt;[[:alpha:]]+) (?&lt;message&gt;.+)\\Z</code></p>\n\n<p>When you match it to your string with <code>matching = &lt;regex&gt;.match(input)</code>, you can then access your command and message with <code>matching[\"command\"]</code> and <code>matching[\"message\"]</code>. Like this:</p>\n\n<pre><code>matching = /\\A\\/create (?&lt;command&gt;[[:alpha:]]+) (?&lt;message&gt;.+)\\Z/.match(str)\narr = [matching[\"command\"], matching[\"message\"]]\n</code></pre>\n\n<p>Here is a demo of the regex working: <a href=\"https://rubular.com/r/Cam99r2rkRdSt2\" rel=\"nofollow noreferrer\">https://rubular.com/r/Cam99r2rkRdSt2</a>.</p>\n\n<p>More info can be found in the Ruby Docs about regex: <a href=\"https://ruby-doc.org/core-2.2.0/Regexp.html\" rel=\"nofollow noreferrer\">Ruby Regexp Documentation</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1552344038, "post_id": 55110888, "comment_id": 96965630, "body": "Not often you see a good use-case for <code>drop(1)</code>, either."}, {"owner": {"reputation": 1523, "user_id": 6896906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JiWcO.jpg?s=128&g=1", "display_name": "Zach Tuttle", "link": "https://stackoverflow.com/users/6896906/zach-tuttle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1552515747, "post_id": 55110888, "comment_id": 97044528, "body": "@tadman that&#39;s not true. Sometimes you might use it when you want to skip the first element when looping so you can do a <code>array.each.drop(1)....</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1523, "user_id": 6896906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JiWcO.jpg?s=128&g=1", "display_name": "Zach Tuttle", "link": "https://stackoverflow.com/users/6896906/zach-tuttle"}, "edited": false, "score": 1, "creation_date": 1552518091, "post_id": 55110888, "comment_id": 97045251, "body": "@Zach, is not &quot;often&quot; in the eye of the beholder? btw, <code>deop</code> is an enumerable (<a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-drop\" rel=\"nofollow noreferrer\">Enumerable#drop</a>), so you don&#39;t need <code>each</code> in <code>array.each.drop(1)</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 1523, "user_id": 6896906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JiWcO.jpg?s=128&g=1", "display_name": "Zach Tuttle", "link": "https://stackoverflow.com/users/6896906/zach-tuttle"}, "edited": false, "score": 0, "creation_date": 1552539749, "post_id": 55110888, "comment_id": 97050271, "body": "@ZachTuttle Most of the time I just iterate over a portion of the array, or instead shift off unwanted parts."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 5, "last_activity_date": 1552344493, "last_edit_date": 1552344493, "creation_date": 1552340764, "answer_id": 55110888, "question_id": 55109944, "link": "https://stackoverflow.com/questions/55109944/return-array-that-matches-this/55110888#55110888", "title": "Return array that matches this", "body": "<pre><code>str = '/create   channel welcome message, hello there, any words you like...'\n\nstr.split(/\\s+/,3).drop(1)\n  #=&gt; [\"channel\", \"welcome message, hello there, any words you like...\"]\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-split\" rel=\"nofollow noreferrer\">String#split</a>, specifically, the use of the optional second argument, <code>limit</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 11039705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed46b79784e84723a0e1d71b9e392148?s=128&d=identicon&r=PG&f=1", "display_name": "kbi", "link": "https://stackoverflow.com/users/11039705/kbi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1552370748, "answer_count": 2, "score": -3, "last_activity_date": 1552370815, "creation_date": 1552336350, "last_edit_date": 1552370815, "question_id": 55109944, "link": "https://stackoverflow.com/questions/55109944/return-array-that-matches-this", "closed_reason": "Needs more focus", "title": "Return array that matches this", "body": "<p>Using a string:</p>\n\n<pre><code>\"/create channel welcome message, hello there, any words you like...\"\n</code></pre>\n\n<p>I need to return an array that looks like:</p>\n\n<pre><code>[\"channel\", \"welcome message, hello there, any words you like...\"]\n</code></pre>\n\n<p>using regex.</p>\n\n<p>What would be the best way to get the array?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552338252, "post_id": 55109804, "comment_id": 96963522, "body": "That&#39;s why you <i>start</i> with tests..."}], "answers": [{"tags": [], "owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1552341806, "creation_date": 1552341806, "answer_id": 55111077, "question_id": 55109804, "link": "https://stackoverflow.com/questions/55109804/rspec-spec-controller/55111077#55111077", "title": "Rspec spec controller", "body": "<p>There's some methods here that I can't see where they came from to properly stub, but you probably want something very close to this, that tests every code path significant to the request, and it's side effects (Sending an email):</p>\n\n<pre><code>require \"spec_helper\"\n\ndescribe \"V1::ForgotPasswordsController\" do\n  let(:user) { User.create(email: \"user@example.com\") }\n\n  describe \"#create\" do\n    context \"with a valid user\" do\n      it \"sends an email to the user and acknowledges the request as accepted\" do\n        expect(UserMailer).to receive(:forgot_password).with(user, anything).and_call_original\n        post v1_create_path, params: { email: user.email }\n        expect(response).to be_accepted\n        expect(JSON.parse(response.body)[:message]).to eq I18n.t(\"forgot_password.send_instructions\")\n      end\n    end\n\n    context \"without a valid user\" do\n      it \"rejects the request\" do\n        post v1_create_path, params: { email: \"not_user@example.com\" }\n        expect(response).to be_unprocessable_entity\n        expect(JSON.parse(response.body)[:message]).to eq I18n.t(\"forgot_password.error_email\")\n      end\n    end\n  end\n\n  describe \"#update\" do\n    context \"with valid token\" do\n      before { allow_any_instance_of(V1::ForgotPasswordsController).to receive(:token_valid?).and_return(true) }\n\n      context \"with update_passwords not including false\" do\n        before { allow_any_instance_of(V1::ForgotPasswordsController).to recieve(:update_passwords).and_return([]) }\n\n        it \"acknowledges the request as accepted\" do\n          put v1_update_path(user), params: { email: user.email }\n          expect(response).to be_accepted\n          expect(JSON.parse(response.body)[:message]).to eq I18n.t(\"forgot_password.updated\")\n        end\n      end\n\n      context \"with update_passwords including false\" do\n        before { allow_any_instance_of(V1::ForgotPasswordsController).to recieve(:update_passwords).and_return([false]) }\n\n        it \"rejects the request\" do\n          put v1_update_path(user), params: { email: user.email }\n          expect(response).to be_unprocessable_entity\n          expect(JSON.parse(response.body)[:message]).to eq I18n.t(\"forgot_password.error_password\")\n        end\n      end\n    end\n\n    context \"with an invalid token\" do\n      before { allow_any_instance_of(V1::ForgotPasswordsController).to receive(:token_valid?).and_return(false) }\n\n      it \"rejects the request as bad\" do\n        put v1_update_path(user), params: { email: user.email }\n        expect(response).to be_bad_request\n        expect(JSON.parse(response.body)[:message]).to eq I18n.t(\"forgot_password.error_token\")\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10928060"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552341806, "creation_date": 1552335784, "last_edit_date": 1552338112, "question_id": 55109804, "link": "https://stackoverflow.com/questions/55109804/rspec-spec-controller", "title": "Rspec spec controller", "body": "<p>I no idea, how to test code like this, I want to test without Factory Bot, because it is only example:</p>\n\n<pre><code>class V1::ForgotPasswordsController &lt; V1::BaseController\n  skip_before_action :authenticate_user!\n\n  expose(:verified_object) { verifier.verify(params[:token]) }\n  expose(:user) { User.find_by_email(params[:email] || verified_object.first) }\n  expose(:accounts) { User.by_email(verified_object.first) }\n\n  def create\n    if user\n      verify = verifier.generate([user.email, 1.hour.from_now])\n      UserMailer.forgot_password(user, verify).deliver_later\n      render json: { message: I18n.t('forgot_password.send_instructions') }, status: :accepted\n    else\n      render json: { message: I18n.t('forgot_password.error_email') }, status: :unprocessable_entity\n    end\n  end\n\n  def update\n    if token_valid?\n      return render json: { message: I18n.t('forgot_password.updated') }, status: :accepted unless update_passwords.include?(false)\n\n      render json: { message: I18n.t('forgot_password.error_password') }, status: :unprocessable_entity\n    else\n      render json: { message: I18n.t('forgot_password.error_token') }, status: 400\n    end\n  end\n</code></pre>\n\n<p>end</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "monkeypatching", "rails-activestorage"], "answers": [{"comments": [{"owner": {"reputation": 12483, "user_id": 2123922, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e1269993bc2c97b8eef7134917b89565?s=128&d=identicon&r=PG", "display_name": "Benj", "link": "https://stackoverflow.com/users/2123922/benj"}, "edited": false, "score": 0, "creation_date": 1552641033, "post_id": 55174183, "comment_id": 97095965, "body": "Ok I defined geter and setter instead of <code>attr_accessor</code>. Will see how it goes. Thanks"}], "tags": [], "owner": {"reputation": 1211, "user_id": 10993539, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NKkKh.png?s=128&g=1", "display_name": "localhostdotdev", "link": "https://stackoverflow.com/users/10993539/localhostdotdev"}, "is_accepted": false, "score": 2, "last_activity_date": 1553099711, "last_edit_date": 1553099711, "creation_date": 1552612071, "answer_id": 55174183, "question_id": 55109738, "link": "https://stackoverflow.com/questions/55109738/monkey-patching-activestorageattachment-gets-lost/55174183#55174183", "title": "Monkey patching ActiveStorage::Attachment gets lost", "body": "<p>Seems to have to do with <code>delegate_missing_to</code>, e.g.</p>\n\n<pre><code>delegate_missing_to :blob\n</code></pre>\n\n<p><a href=\"https://github.com/rails/rails/blob/master/activestorage/app/models/active_storage/attachment.rb#L14\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/master/activestorage/app/models/active_storage/attachment.rb#L14</a></p>\n\n<p>Going to <a href=\"https://github.com/rails/rails/blob/master/activesupport/lib/active_support/core_ext/module/delegation.rb#L278\" rel=\"nofollow noreferrer\">where it's defined</a>:</p>\n\n<p>Anyway it might have to do with how <code>attr_accessor</code> works, I would try:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def url\n  @url\nend\n\ndef url=(url)\n  @url = url\nend\n</code></pre>\n\n<p>Instead of <code>attr_accessor</code> (which is a C function actually).</p>\n\n<p>Otherwise a really really hacky way to solve this would be to check for <code>ActiveStorage::Attachment.instance_methods.include?(:url)</code> and monkey patch / include / prepend when not present.</p>\n"}, {"tags": [], "owner": {"reputation": 830, "user_id": 5136200, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/gBAqD.jpg?s=128&g=1", "display_name": "Archer", "link": "https://stackoverflow.com/users/5136200/archer"}, "is_accepted": false, "score": 5, "last_activity_date": 1552853939, "creation_date": 1552853939, "answer_id": 55211505, "question_id": 55109738, "link": "https://stackoverflow.com/questions/55109738/monkey-patching-activestorageattachment-gets-lost/55211505#55211505", "title": "Monkey patching ActiveStorage::Attachment gets lost", "body": "<p>I placed my <code>ActiveStorage::Attachment</code>MonkeyPatch in <strong>/app/models/active_storage/</strong><br>\nI've added a callback to get informed if the Attachment has changed. It works fine, all the time.</p>\n\n<p>Maybe this is the issue.</p>\n"}, {"comments": [{"owner": {"reputation": 12483, "user_id": 2123922, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e1269993bc2c97b8eef7134917b89565?s=128&d=identicon&r=PG", "display_name": "Benj", "link": "https://stackoverflow.com/users/2123922/benj"}, "edited": false, "score": 0, "creation_date": 1553158084, "post_id": 55264840, "comment_id": 97283363, "body": "Seems to be the method I needed to know about. Thanks"}], "tags": [], "owner": {"reputation": 314, "user_id": 1734963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72c2a0218fa149a3ed6aefeb4ed319c?s=128&d=identicon&r=PG", "display_name": "afrase", "link": "https://stackoverflow.com/users/1734963/afrase"}, "is_accepted": true, "score": 2, "last_activity_date": 1553096726, "creation_date": 1553096726, "answer_id": 55264840, "question_id": 55109738, "link": "https://stackoverflow.com/questions/55109738/monkey-patching-activestorageattachment-gets-lost/55264840#55264840", "title": "Monkey patching ActiveStorage::Attachment gets lost", "body": "<p>You are probably losing your monkey patch because the code gets reloaded and your <strong>ext/active_storage/attachment</strong> isn't re-required.</p>\n\n<p>You can tell Rails to run a callback at startup and every time code is reloaded like this.</p>\n\n<pre><code>Rails.configuration.to_prepare do\n  require 'ext/active_storage/attachment'\nend\n</code></pre>\n"}], "owner": {"reputation": 12483, "user_id": 2123922, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e1269993bc2c97b8eef7134917b89565?s=128&d=identicon&r=PG", "display_name": "Benj", "link": "https://stackoverflow.com/users/2123922/benj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 720, "favorite_count": 1, "accepted_answer_id": 55264840, "answer_count": 3, "score": 9, "last_activity_date": 1553099711, "creation_date": 1552335456, "last_edit_date": 1552381774, "question_id": 55109738, "link": "https://stackoverflow.com/questions/55109738/monkey-patching-activestorageattachment-gets-lost", "title": "Monkey patching ActiveStorage::Attachment gets lost", "body": "<p>So I decided to add an <code>url</code> attr_accessor to ActiveStorage::Attachment objects.</p>\n\n<p>In <em>development</em> the patch holds for a while until it seems to \"have been lost\". Meaning it works for few minutes, then it does not work anymore. Then I need to restart the server in order to get the patch applied again. I believe I am not patching correctly and I would need advises in that mater.</p>\n\n<hr>\n\n<p>Here is what I tried:</p>\n\n<p><strong>lib/ext/active_storage/attachment.rb</strong></p>\n\n<p>First try :</p>\n\n<pre><code>module ActiveStorageUrl\n  extend ActiveSupport::Concern\n\n  included do\n    attr_accessor :url\n  end\nend\n\nActiveStorage::Attachment.send :include, ActiveStorageUrl\n\n</code></pre>\n\n<p>Second try</p>\n\n<pre><code>class ActiveStorage::Attachment &lt; ActiveRecord::Base\n  attr_accessor :url\nend\n</code></pre>\n\n<hr>\n\n<p>And by the way in both case it's loaded with this:</p>\n\n<p><strong>config/initializers/monkey_patches.rb</strong></p>\n\n<pre><code>require 'ext/active_storage/attachment'\n</code></pre>\n\n<hr>\n\n<p>So when it work I have no error message, but after a while the patch \"diseapear\" (lacking better terms), and I get the following error, telling me  my attr_accessor is not there anymore. Rails must have reloaded ActiveStorage classes and my patch is lost.</p>\n\n<pre><code>Module::DelegationError in Products#images\nurl delegated to blob, but blob is nil\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1552342491, "post_id": 55109646, "comment_id": 96965114, "body": "please put your code in a code block  as well as stack trace errors.  Look for the <code>{}}</code> icon in the editor to wrap your code"}, {"owner": {"reputation": 21, "user_id": 10056102, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3LVy3eowqAI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxSBi2b-GLawk8VbYD2qyxR5sXjg/mo/photo.jpg?sz=128", "display_name": "Abhishek Pillai", "link": "https://stackoverflow.com/users/10056102/abhishek-pillai"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1552412074, "post_id": 55109646, "comment_id": 96996645, "body": "I did what you asked"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1553869785, "post_id": 55109646, "comment_id": 97558337, "body": "Check your assets, some times when there&#39;s an asset compilation error it is not shown properly on the error page (try removing the javascript and stylesheet lines for a quick test). If removing one of those lines fixes the error then you need to inspect your assets, try <code>RAILS_ENV=production bundle exec rails assets:precompile</code> too."}], "owner": {"reputation": 21, "user_id": 10056102, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3LVy3eowqAI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxSBi2b-GLawk8VbYD2qyxR5sXjg/mo/photo.jpg?sz=128", "display_name": "Abhishek Pillai", "link": "https://stackoverflow.com/users/10056102/abhishek-pillai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552401687, "creation_date": 1552335076, "last_edit_date": 1552401687, "question_id": 55109646, "link": "https://stackoverflow.com/questions/55109646/unexpected-in-haml-file-after-updating-ruby", "title": "Unexpected = in haml file after updating Ruby", "body": "<p>I am running a rails application (rails: 4.2 and ruby 2.2.3). I am trying to update my ruby to 2.4.4 and have been able to successfully run bundle install. However, when I start the server and go to the home page of my application, I encounter a unexpected = in the application.html.haml file for this line: \n= favicon_link_tag 'favicon.ico'\nHas anyone here encountered an error like this? </p>\n\n<p>P.S. if this question has been posted before can someone redirect me to it as I cannot find this problem.</p>\n\n<pre><code>   %head\n\n    %base{:href =&gt; \"/dashboard\"}\n    %title Title Page\n    = favicon_link_tag 'favicon.ico'\n    = stylesheet_link_tag \"application\", :media =&gt; nil\n    = javascript_include_tag \"application\"\n    = csrf_meta_tags\n\n  %body{'ng-app'=&gt;'thumper','ng-controller'=&gt;'MainController'}\n    - if signed_in?\n      .navbar.navbar-inverse.navbar-fixed-top{:style =&gt; 'padding-top:0px;height: 30px;'}\n        .container\n          %button.navbar-toggle{\"data-target\" =&gt; \".navbar-collapse\", \"data-toggle\" =&gt; \"collapse\"}\n          %a.navbar-brand{:href =&gt; \"/\", :target =&gt; \"_self\"}\n            = image_tag \"main_image.png\", :style =&gt; 'width:65px;', :alt =&gt; 'company_name'\n\n          .navbar-collapse.collapse\n            %ul.nav.navbar-nav\n              %li\n                %a{:href =&gt; \"/faq\", :target =&gt; \"_self\"}\n                  %i.fa.fa-lightbulb-o\n                  FAQ\n              %li\n\n</code></pre>\n\n<p>This is my initial part of my application.html.haml file. I get the following error:</p>\n\n<pre><code>DEPRECATED: Please use restforce (https://github.com/ejholmes/restforce) instead.\n=&gt; Booting Thin\n=&gt; Rails 4.2.11 application starting in development on http://localhost:3000\n=&gt; Run `rails server -h` for more startup options\n=&gt; Ctrl-C to shutdown server\nThin web server (v1.7.2 codename Bachmanity)\nMaximum connections set to 1024\nListening on localhost:3000, CTRL+C to stop\n\n\nStarted GET \"/testpage\" for 127.0.0.1 at 2019-03-12 09:32:47 -0500\n  ActiveRecord::SchemaMigration Load (44.9ms)  SELECT `schema_migrations`.* FROM `schema_migrations`\nProcessing by TestController#foo as HTML\nHERE\n  Rendered test/foo.html within layouts/application (2.9ms)\nCompleted 500 Internal Server Error in 1964ms (ActiveRecord: 0.0ms)\n\nExecJS::RuntimeError - SyntaxError: [stdin]:959:20: unexpected =:\n  app/views/layouts/application.html.haml:7:in `_app_views_layouts_application_html_haml___861496224579637971_70314333220700'\n  app/lib/cors.rb:12:in `call'\n  app/lib/cors.rb:12:in `call'\n\n\n\nStarted POST \"/__better_errors/1f18681361fed4ae/variables\" for 127.0.0.1 at 2019-03-12 09:32:50 -0500\n</code></pre>\n\n<p>The web  browser looks like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/SW3qY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SW3qY.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "hash", "attributes", "chef-infra"], "answers": [{"comments": [{"owner": {"reputation": 1014, "user_id": 69785, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/aaa7bb2d45811c934d3723278836dac3?s=128&d=identicon&r=PG&f=1", "display_name": "\uc5d0\uc774\ubc14", "link": "https://stackoverflow.com/users/69785/%ec%97%90%ec%9d%b4%eb%b0%94"}, "edited": false, "score": 0, "creation_date": 1553117643, "post_id": 55111793, "comment_id": 97272243, "body": "I think you&#39;re right. I did some more debugging and found that Dir.foreach was not finding the directory. I&#39;m not sure the reason for that but I just went with manually creating the attributes. Thanks."}], "tags": [], "owner": {"reputation": 1376, "user_id": 427117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c91d05b02cc6a43fadcbe417b66bceb4?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/427117/roland"}, "is_accepted": true, "score": 1, "last_activity_date": 1552346293, "creation_date": 1552346293, "answer_id": 55111793, "question_id": 55109571, "link": "https://stackoverflow.com/questions/55109571/chef-create-a-user-account-with-public-key-access/55111793#55111793", "title": "Chef create a user account with public key access", "body": "<p>Have you tried to set the attributes manually? I think the Ruby code starting with \"Dir.foreach\" doesn't work and is against the best practices of chef, anyway.</p>\n"}], "owner": {"reputation": 1014, "user_id": 69785, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/aaa7bb2d45811c934d3723278836dac3?s=128&d=identicon&r=PG&f=1", "display_name": "\uc5d0\uc774\ubc14", "link": "https://stackoverflow.com/users/69785/%ec%97%90%ec%9d%b4%eb%b0%94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 55111793, "answer_count": 1, "score": 0, "last_activity_date": 1552346293, "creation_date": 1552334751, "last_edit_date": 1552336366, "question_id": 55109571, "link": "https://stackoverflow.com/questions/55109571/chef-create-a-user-account-with-public-key-access", "title": "Chef create a user account with public key access", "body": "<p>I'm trying to create a recipe which looks in my recipe's files dir and creates a user per public key in the directory.</p>\n\n<p><code>cookbooks/users/files/default</code> dir contains:</p>\n\n<p><code>id_rsa_123456789.pub</code>\n<code>id_rsa_234567890.pub</code></p>\n\n<p>Based on these two files I would like to create 2 user accounts named <code>123456789</code> and <code>234567890</code> and put their public key in /home/$USER/.ssh/ respectively.</p>\n\n<p><code>cookbooks/users/attributes/default.rb</code> contains:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>default['users']['pub_keys'] = {}\n\nDir.foreach('../files/default/') do |pub_key|\n  if pub_key =~ /\\d.pub/\n    default['users']['pub_keys'][pub_key] = pub_key.match(/[0-9]{9}/)\n  end\nend\n</code></pre>\n\n<p>This code should create the following:</p>\n\n<p><code>default['users']['pub_keys'] = {'id_rsa_123456789.pub' =&gt; '123456789', 'id_rsa_234567890.pub' =&gt; '234567890' }</code></p>\n\n<p><code>cookbooks/users/recipes/default.rb</code> contains:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>node['users']['pub_keys'].each do |pub_key, sso|\n  user sso do\n    action :create\n    group 'sudoers'\n    home \"/home/#{sso}\"\n  end\n  directory \"/home/#{sso}/.ssh\" do\n    action :create\n  end\n  cookbook_file \"/home/#{sso}/.ssh/#{pub_key}\" do\n    source pub_key\n    owner sso\n    group sso\n    mode '0400'\n    action :create\n  end\nend\n</code></pre>\n\n<p>I think my recipe is not able to read my hash var but I'm not sure why or how to fix.</p>\n\n<pre><code> Relevant File Content:\n       ----------------------\n       /tmp/kitchen/cache/cookbooks/users/recipes/default.rb:\n\n         1:  #\n         2:  # Cookbook:: users\n         3:  # Recipe:: default\n         4:  #\n         5:  \n         6:\n         7&gt;&gt; node['users']['pub_keys'].each do |pub_key, sso|\n         8:    user sso do\n         9:      action :create\n        10:      group 'sudoers'\n        11:      home \"/home/#{sso}\"\n        13:    directory \"/home/#{sso}/.ssh\" do\n        14:      action :create\n        15:    end\n        16:    cookbook_file \"/home/#{sso}/.ssh/#{pub_key}\" do\n\n       System Info:\n       ------------\n       chef_version=14.11.21\n       platform=centos\n       platform_version=7.6.1810\n       ruby=ruby 2.5.3p105 (2018-10-18 revision 65156) [x86_64-linux]\n       program_name=/opt/chef/bin/chef-solo\n       executable=/opt/chef/bin/chef-solo\n\n\n       Running handlers:\n       [2019-03-11T19:28:18+00:00] ERROR: Running exception handlers\n       Running handlers complete\n       [2019-03-11T19:28:18+00:00] ERROR: Exception handlers complete\n       Chef Client failed. 0 resources updated in 00 seconds\n       [2019-03-11T19:28:18+00:00] FATAL: Stacktrace dumped to /tmp/kitchen/cache/chef-stacktrace.out\n       [2019-03-11T19:28:18+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report\n       [2019-03-11T19:28:18+00:00] FATAL: NoMethodError: undefined method `[]' for nil:NilClass\n</code></pre>\n"}, {"tags": ["ruby", "elasticsearch", "searchkick"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1552342859, "post_id": 55109459, "comment_id": 96965258, "body": "what happens if you try <code>Searchkick.search cross_field_query</code> without index name?"}, {"owner": {"reputation": 755, "user_id": 509776, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7a78e62851585c5a92d51e8d54ba90d7?s=128&d=identicon&r=PG", "display_name": "Conor", "link": "https://stackoverflow.com/users/509776/conor"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1552381939, "post_id": 55109459, "comment_id": 96977058, "body": "@lacostenycoder thanks for replying. It seems to just hit the first index but I do get a set of results. The issue is that ultimately I would like to run the query across two indexes, I can&#39;t find anything in the searchkick docs about where else to specify the set of indexes to be targeted"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1552401354, "post_id": 55109459, "comment_id": 96989634, "body": "how is <code>query: query,</code> the value of query defined?"}, {"owner": {"reputation": 755, "user_id": 509776, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7a78e62851585c5a92d51e8d54ba90d7?s=128&d=identicon&r=PG", "display_name": "Conor", "link": "https://stackoverflow.com/users/509776/conor"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1552408685, "post_id": 55109459, "comment_id": 96994686, "body": "it&#39;s just a string, so something like &quot;baked potatoes&quot;, &#39;restaurants london&#39; etc."}], "answers": [{"comments": [{"owner": {"reputation": 755, "user_id": 509776, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7a78e62851585c5a92d51e8d54ba90d7?s=128&d=identicon&r=PG", "display_name": "Conor", "link": "https://stackoverflow.com/users/509776/conor"}, "edited": false, "score": 0, "creation_date": 1552402100, "post_id": 55123945, "comment_id": 96990101, "body": "@lacotenycoder thanks for you reply. I really appreciate it. Yeah, I have been using the multi-index query but I wanted to move to using cross_fields to improve the results. I thought reading the docs that it should be possible to pass in query body and specify the indexes but it seems not.  Maybe I should look at using the elasticsearch-ruby client directly"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 755, "user_id": 509776, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7a78e62851585c5a92d51e8d54ba90d7?s=128&d=identicon&r=PG", "display_name": "Conor", "link": "https://stackoverflow.com/users/509776/conor"}, "edited": false, "score": 0, "creation_date": 1552427932, "post_id": 55123945, "comment_id": 97004124, "body": "@Conor yeah worth a shot. You using rails or not?"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1552400991, "creation_date": 1552400991, "answer_id": 55123945, "question_id": 55109459, "link": "https://stackoverflow.com/questions/55109459/different-results-from-model-search-and-searchkick-search-with-a-named-index/55123945#55123945", "title": "different results from Model.search and SearchKick.search with a named_index", "body": "<p>I'm not sure you can search across multiple indices with Searchkick, see this issue <a href=\"https://github.com/ankane/searchkick/issues/744\" rel=\"nofollow noreferrer\">https://github.com/ankane/searchkick/issues/744</a></p>\n\n<p>But you can do stuff like:</p>\n\n<pre><code>Searchkick.search \"milk\", index_name: [Product, Category]\n</code></pre>\n\n<p>However you can probably get it to work with some monkey patching if you have a look here <a href=\"https://stackoverflow.com/questions/24315753/elasticsearch-querying-multiple-indexes-is-possible\">elasticsearch - querying multiple indexes is possible?</a></p>\n"}], "owner": {"reputation": 755, "user_id": 509776, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7a78e62851585c5a92d51e8d54ba90d7?s=128&d=identicon&r=PG", "display_name": "Conor", "link": "https://stackoverflow.com/users/509776/conor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 884, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552400991, "creation_date": 1552334298, "question_id": 55109459, "link": "https://stackoverflow.com/questions/55109459/different-results-from-model-search-and-searchkick-search-with-a-named-index", "title": "different results from Model.search and SearchKick.search with a named_index", "body": "<p>I'm seeing different results from Model.search and SearchKick.search with a index_name.</p>\n\n<p>I'm trying to apply apply a cross_fields query to multiple indexes. I got some strange results so I started sanity checking the query against a single index and in that scenario I'm getting sero results returned despite the searchkick query object being identical as far as I can tell</p>\n\n<pre><code>cross_field_query = {\n        body: {\n            query: {\n               multi_match: {\n                            query: query,\n                            type: \"cross_fields\",\n                            operator: \"and\"\n                        }\n                   }\n          }\n        }\n  results = TaggedTree.search cross_field_query\n  results.total_count  -&gt; 29\n  results = Searchkick.search cross_field_query, index_name: [TaggedTree]\n  results.total_count  -&gt; 0\n</code></pre>\n\n<p>I ran the queries with execute: false and they seemed to be the same. Here are the to_curl outputs</p>\n\n<pre><code>results = TaggedTree.search advanced_query, execute: false\nresults.to_curl\n\n\"curl http://localhost:9200/tagged_trees_development/_search?pretty -H 'Content-Type: application/json' -d '{\\\"query\\\":{\\\"dis_max\\\":{\\\"queries\\\":[{\\\"multi_match\\\":{\\\"query\\\":\\\"{:body=\\\\u003e{:query=\\\\u003e{:multi_match=\\\\u003e{:query=\\\\u003e\\\\\\\"oak malahide\\\\\\\", :type=\\\\u003e\\\\\\\"cross_fields\\\\\\\", :operator=\\\\u003e\\\\\\\"and\\\\\\\"}}}}\\\",\\\"boost\\\":10,\\\"operator\\\":\\\"and\\\",\\\"analyzer\\\":\\\"searchkick_search\\\",\\\"fields\\\":[\\\"*.analyzed\\\"],\\\"type\\\":\\\"best_fields\\\"}},{\\\"multi_match\\\":{\\\"query\\\":\\\"{:body=\\\\u003e{:query=\\\\u003e{:multi_match=\\\\u003e{:query=\\\\u003e\\\\\\\"oak malahide\\\\\\\", :type=\\\\u003e\\\\\\\"cross_fields\\\\\\\", :operator=\\\\u003e\\\\\\\"and\\\\\\\"}}}}\\\",\\\"boost\\\":10,\\\"operator\\\":\\\"and\\\",\\\"analyzer\\\":\\\"searchkick_search2\\\",\\\"fields\\\":[\\\"*.analyzed\\\"],\\\"type\\\":\\\"best_fields\\\"}},{\\\"multi_match\\\":{\\\"query\\\":\\\"{:body=\\\\u003e{:query=\\\\u003e{:multi_match=\\\\u003e{:query=\\\\u003e\\\\\\\"oak malahide\\\\\\\", :type=\\\\u003e\\\\\\\"cross_fields\\\\\\\", :operator=\\\\u003e\\\\\\\"and\\\\\\\"}}}}\\\",\\\"boost\\\":1,\\\"operator\\\":\\\"and\\\",\\\"analyzer\\\":\\\"searchkick_search\\\",\\\"fuzziness\\\":1,\\\"prefix_length\\\":0,\\\"max_expansions\\\":3,\\\"fuzzy_transpositions\\\":true,\\\"fields\\\":[\\\"*.analyzed\\\"],\\\"type\\\":\\\"best_fields\\\"}},{\\\"multi_match\\\":{\\\"query\\\":\\\"{:body=\\\\u003e{:query=\\\\u003e{:multi_match=\\\\u003e{:query=\\\\u003e\\\\\\\"oak malahide\\\\\\\", :type=\\\\u003e\\\\\\\"cross_fields\\\\\\\", :operator=\\\\u003e\\\\\\\"and\\\\\\\"}}}}\\\",\\\"boost\\\":1,\\\"operator\\\":\\\"and\\\",\\\"analyzer\\\":\\\"searchkick_search2\\\",\\\"fuzziness\\\":1,\\\"prefix_length\\\":0,\\\"max_expansions\\\":3,\\\"fuzzy_transpositions\\\":true,\\\"fields\\\":[\\\"*.analyzed\\\"],\\\"type\\\":\\\"best_fields\\\"}}]}},\\\"timeout\\\":\\\"11s\\\",\\\"_source\\\":false,\\\"size\\\":10000,\\\"from\\\":0}'\"\n\nresults = Searchkick.search index_advanced_query, index_name: TaggedTree, execute: false\nresults.to_curl\n\n\"curl http://localhost:9200/tagged_trees_development/_search?pretty -H 'Content-Type: application/json' -d '{\\\"query\\\":{\\\"dis_max\\\":{\\\"queries\\\":[{\\\"multi_match\\\":{\\\"query\\\":\\\"{:body=\\\\u003e{:query=\\\\u003e{:multi_match=\\\\u003e{:query=\\\\u003e\\\\\\\"oak malahide\\\\\\\", :type=\\\\u003e\\\\\\\"cross_fields\\\\\\\", :operator=\\\\u003e\\\\\\\"and\\\\\\\"}}}}\\\",\\\"boost\\\":10,\\\"operator\\\":\\\"and\\\",\\\"analyzer\\\":\\\"searchkick_search\\\",\\\"fields\\\":[\\\"*.analyzed\\\"],\\\"type\\\":\\\"best_fields\\\"}},{\\\"multi_match\\\":{\\\"query\\\":\\\"{:body=\\\\u003e{:query=\\\\u003e{:multi_match=\\\\u003e{:query=\\\\u003e\\\\\\\"oak malahide\\\\\\\", :type=\\\\u003e\\\\\\\"cross_fields\\\\\\\", :operator=\\\\u003e\\\\\\\"and\\\\\\\"}}}}\\\",\\\"boost\\\":10,\\\"operator\\\":\\\"and\\\",\\\"analyzer\\\":\\\"searchkick_search2\\\",\\\"fields\\\":[\\\"*.analyzed\\\"],\\\"type\\\":\\\"best_fields\\\"}},{\\\"multi_match\\\":{\\\"query\\\":\\\"{:body=\\\\u003e{:query=\\\\u003e{:multi_match=\\\\u003e{:query=\\\\u003e\\\\\\\"oak malahide\\\\\\\", :type=\\\\u003e\\\\\\\"cross_fields\\\\\\\", :operator=\\\\u003e\\\\\\\"and\\\\\\\"}}}}\\\",\\\"boost\\\":1,\\\"operator\\\":\\\"and\\\",\\\"analyzer\\\":\\\"searchkick_search\\\",\\\"fuzziness\\\":1,\\\"prefix_length\\\":0,\\\"max_expansions\\\":3,\\\"fuzzy_transpositions\\\":true,\\\"fields\\\":[\\\"*.analyzed\\\"],\\\"type\\\":\\\"best_fields\\\"}},{\\\"multi_match\\\":{\\\"query\\\":\\\"{:body=\\\\u003e{:query=\\\\u003e{:multi_match=\\\\u003e{:query=\\\\u003e\\\\\\\"oak malahide\\\\\\\", :type=\\\\u003e\\\\\\\"cross_fields\\\\\\\", :operator=\\\\u003e\\\\\\\"and\\\\\\\"}}}}\\\",\\\"boost\\\":1,\\\"operator\\\":\\\"and\\\",\\\"analyzer\\\":\\\"searchkick_search2\\\",\\\"fuzziness\\\":1,\\\"prefix_length\\\":0,\\\"max_expansions\\\":3,\\\"fuzzy_transpositions\\\":true,\\\"fields\\\":[\\\"*.analyzed\\\"],\\\"type\\\":\\\"best_fields\\\"}}]}},\\\"timeout\\\":\\\"11s\\\",\\\"_source\\\":false,\\\"size\\\":10000,\\\"from\\\":0}'\"\n</code></pre>\n\n<p>searchkick version: 3.1.2\nElastic Search Version:\nVersion: 6.5.2, Build: default/tar/9434bed/2018-11-29T23:58:20.891072Z, JVM: 1.8.0_20</p>\n\n<p>Any help at all with getting to the bottom of this would be greatly appreciated</p>\n"}, {"tags": ["ruby", "selenium", "watir"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1552346996, "post_id": 55108350, "comment_id": 96966350, "body": "You want an aggregated log?  Quick/dirty way: write to a file in append mode (after each get)."}, {"owner": {"reputation": 153, "user_id": 3686493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c37c9aebb618c60f901fbc1baaadf03?s=128&d=identicon&r=PG&f=1", "display_name": "pan0ramic", "link": "https://stackoverflow.com/users/3686493/pan0ramic"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1552348499, "post_id": 55108350, "comment_id": 96966715, "body": "I want to use the log like an array, but I&#39;d rather not store its state somewhere. I have to check the log at different places in different classes. I guess I could create a static var (or use your way) but I was hoping there was just a way to poll <code>browser.driver.manage.logs.get(:browser)</code> (get without clearing)"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1552397587, "post_id": 55108350, "comment_id": 96986942, "body": "I believe managing logs is different per browser. Which browser are you using?"}, {"owner": {"reputation": 153, "user_id": 3686493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c37c9aebb618c60f901fbc1baaadf03?s=128&d=identicon&r=PG&f=1", "display_name": "pan0ramic", "link": "https://stackoverflow.com/users/3686493/pan0ramic"}, "edited": false, "score": 0, "creation_date": 1552531122, "post_id": 55108350, "comment_id": 97048413, "body": "I&#39;m using a Chrome browser"}], "owner": {"reputation": 153, "user_id": 3686493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c37c9aebb618c60f901fbc1baaadf03?s=128&d=identicon&r=PG&f=1", "display_name": "pan0ramic", "link": "https://stackoverflow.com/users/3686493/pan0ramic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552531135, "creation_date": 1552329628, "last_edit_date": 1552531135, "question_id": 55108350, "link": "https://stackoverflow.com/questions/55108350/browers-logs-clear-on-repeat-calls-to-browser-driver-manage-logs-getbrowser", "title": "Browers Logs Clear on Repeat calls to browser.driver.manage.logs.get(:browser)", "body": "<p>If I pull the logs in my Selenium/Watir projects using <code>browser.driver.manage.logs.get(:browser)</code> I notice that it clears the logs so that repeats calls do not produce the same results.</p>\n\n<p>Is there way to just POLL the logs so you can make repeated calls and get the same results? (Using Chrome)</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 3, "creation_date": 1552325360, "post_id": 55107155, "comment_id": 96957677, "body": "What did you try so far? Where are you stuck?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1552326487, "post_id": 55107155, "comment_id": 96958248, "body": "Why don&#39;t you want to use <code>map(&amp;:chr)</code>?  The answer you&#39;ve accepted as a solution to your problem is pretty much still doing this, anyway -- the only difference is that it&#39;s doing the <code>split</code> in a separate step, and using <code>each</code> instead of <code>map</code>; appending to a result array."}], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 5, "creation_date": 1552327475, "post_id": 55107383, "comment_id": 96958700, "body": "What&#39;s with all the instance variables?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9485690"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1552327588, "post_id": 55107383, "comment_id": 96958747, "body": "Compulsive habit with writing them. I&#39;m currently programming a database that has to use a ton..."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 4, "creation_date": 1552328228, "post_id": 55107383, "comment_id": 96959038, "body": "This answer&#39;s code has an unneeded complexity. Maybe that&#39;s the reason of the downvotes."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1552329912, "post_id": 55107383, "comment_id": 96959771, "body": "Don&#39;t stress out about it. While we all appreciate your contributions, this use of instance variables isn&#39;t really appropriate and ends up promoting bad habits. Instead of taking the feedback so negatively, take it into account and become a better programmer. One of the true strengths of Ruby is how little you have to do to get the right outcome. In this case: <code>string.split(&quot; &quot;).map(&amp;:chr).join(&quot;&quot;)</code> is enough. Your solution works, but could be a lot more minimal, like omitting <code>return</code> and using <code>map</code> instead of <code>each</code>. Always use <code>map</code> when you want to <i>return</i> something from each element."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1552329971, "post_id": 55107383, "comment_id": 96959804, "body": "The solution here using <code>chr</code> is actually more minimal than the others and avoids falling into the regular expression trap, but this is lost in the other stuff going on which makes it seem way more complicated and verbose. There&#39;s an elegant solution here if you remove all the chaff."}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 2, "creation_date": 1552330458, "post_id": 55107383, "comment_id": 96960034, "body": "This is really unidiomatic. You should not use this code, every other answer is much more idiomatic Ruby. &quot;code that actually does the task&quot; is very low bar to judge answers; you should write <i>good code</i> in the style of the language. <code>string.split(&#47;\\w&#47;).map { |word| word[0] }.join</code> or some other version of <code>split</code>/<code>map</code>/join` is how you should write this in Ruby, not by creating an accumulator and adding onto it, and definitely not with <code>@</code> variables which you should use when you actually need them, not arbitrarily."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1552331859, "post_id": 55107383, "comment_id": 96960651, "body": "Your attitude is childish and most importantly, is not in your own best interest. If you can&#39;t take criticism you cannot hope to improve the quality of your code. What you should be  doing is reviewing the comments carefully and editing your answer to incorporate the better ones. If you wish to thank the author of the comment do so in a comment. While writing this I see you&#39;ve edited your answer. Good, but you&#39;ve only added to what you had before. It would more helpful to readers if you completely rewrote your answer, presenting only what you now regard as your best advice."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1552333447, "post_id": 55107383, "comment_id": 96961386, "body": "Here are some points and suggestions about your edit. 1. You need to enclose the string method within <code>class String ... end</code>. 2. <code>.self</code> is not needed, but does no harm. 3. <code>split</code> without an argument is the same as <code>split(&#47;\\s+&#47;)</code>, which is preferred to <code>split(&#39; &#39;)</code> because it splits on one or more contiguous spaces. (cont.)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1552333487, "post_id": 55107383, "comment_id": 96961407, "body": "...4. The keyword <code>return</code> is not needed (without <code>return</code> the value of the last statement executed--here <code>final_string</code>-- is returned).  5. It is more idiomatic to write <code>split.each_with_object(&#39;&#39;) do |word, final_string|...</code>, allowing you to remove <code>final_string = &#39;&#39;</code> and <code>final_string</code> at the end."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9485690"}, "edited": false, "score": 0, "creation_date": 1552344828, "post_id": 55107383, "comment_id": 96965823, "body": "Sorry about my childish attitude."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1552349699, "post_id": 55107383, "comment_id": 96967011, "body": "It gave me no joy to use those words, but I thought it was something you needed to hear. To learn we all need to be open to criticism, in fact, to seek it. People are here to help, and most believe we can be most useful by being direct and not mincing words. Members have collectively devoted considerable time writing comments on your question. Their motivation certainly was not to put you down. Even if you don&#39;t see it that way, the bottom line is that you can learn something from each of those comments."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9485690"}, "edited": false, "score": 2, "creation_date": 1552354546, "post_id": 55107383, "comment_id": 96968177, "body": "I see my error in perspective and I have adjusted it."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1552389987, "post_id": 55107383, "comment_id": 96982186, "body": "I&#39;d recommend also removing al the instance variables from the &quot;old&quot; answer. The code works perfectly fine without them. This doesn&#39;t change the concept of the answer, but removes the bad habits this answer might introduce to people who don&#39;t exactly know what they&#39;re doing."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9485690"}, "is_accepted": true, "score": 1, "last_activity_date": 1552391626, "last_edit_date": 1552391626, "creation_date": 1552325539, "answer_id": 55107383, "question_id": 55107155, "link": "https://stackoverflow.com/questions/55107155/how-to-get-the-first-letter-of-each-word/55107383#55107383", "title": "How to get the first letter of each word", "body": "<p>Here is a method I wrote.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def first_chars\n  final_string = \"\"\n\n  self.split(\" \").each do |word|\n    final_string += word.chr\n  end\n\n  return final_string\nend\n</code></pre>\n\n<p>You would use this instead like <code>\"hello world\".first_chars</code>, which would return <code>hw</code>.</p>\n\n<p>What this does is: splits the given string, self, by spaces into an array. Then it adds the first letter of that word using the <code>.chr</code> method in the <code>.each</code> loop, appends that letter to a string that ends up getting returned. </p>\n\n<p>It could be shortened like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def first_chars \n   final_string = \"\"\n   self.split(\" \").each { |word| final_string += word.chr }\n   return final_string\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1552334709, "post_id": 55107702, "comment_id": 96961970, "body": "Alternatively, <code>.map { |word| word[0] }</code> could be replaced with <code>.map(&amp;:first)</code>. The split parameter could also be left out, if <code>$;</code> is not set split will default to whitespace."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1552335376, "post_id": 55107702, "comment_id": 96962228, "body": "@3limin4t0r <code>String#first</code> is an ActiveSupport method; not vanilla ruby. You&#39;re right about <code>split</code>, but I prefer to be explicit."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 5, "last_activity_date": 1552326878, "creation_date": 1552326878, "answer_id": 55107702, "question_id": 55107155, "link": "https://stackoverflow.com/questions/55107155/how-to-get-the-first-letter-of-each-word/55107702#55107702", "title": "How to get the first letter of each word", "body": "<p>I'm not sure why you don't want to use <code>map(&amp;:chr)</code>, but here's a solution without it:</p>\n\n<pre><code>def first_chars(string)\n  string                     # e.g. \"Hello world\"\n    .split(' ')              # converts it to [\"Hello\", \"world\"]\n    .map { |word| word[0] }  # converts it to [\"H\", \"w\"] (You could also use map(&amp;:chr) here.)\n    .join                    # converts it to \"Hw\"\nend\n\nfirst_chars(\"Hello world\")   #=&gt; \"Hw\"\n</code></pre>\n\n<p>The key parts to understand here are:</p>\n\n<ul>\n<li><code>split</code> takes a <code>String</code> and converts it to an <strong><code>Array</code> (list) of <code>String</code>s</strong>.</li>\n<li><code>map</code> loops through the <code>Array</code>, and converts each item by the specified operation. (In this case, taking only the first letter.)</li>\n<li><code>join</code> merges the <code>Array</code> back into a single <code>String</code>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1552329403, "last_edit_date": 1552329403, "creation_date": 1552327784, "answer_id": 55107929, "question_id": 55107155, "link": "https://stackoverflow.com/questions/55107155/how-to-get-the-first-letter-of-each-word/55107929#55107929", "title": "How to get the first letter of each word", "body": "<pre><code>gets.gsub(/(?&lt;=\\S)\\S+\\s*/, \"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 5, "last_activity_date": 1552330353, "last_edit_date": 1552330353, "creation_date": 1552328226, "answer_id": 55108024, "question_id": 55107155, "link": "https://stackoverflow.com/questions/55107155/how-to-get-the-first-letter-of-each-word/55108024#55108024", "title": "How to get the first letter of each word", "body": "<pre><code>puts \"Oh, happy   day\".gsub(/ |(?&lt;=\\S)./, '')\n  #=&gt; \"Ohd\"\n</code></pre>\n\n<p>The regular expression reads, \"match a space or (<code>|</code>) match any character (<code>.</code>) preceded by any character that is not whitespace (<code>\\S</code>), <code>(?&lt;=\\S)</code> being a <em>positive lookbehind</em>.</p>\n"}], "owner": {"reputation": 37, "user_id": 11059895, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s6hJpgYfShc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNkckjuhULnA3-mJ9RgU5JWaq7eNA/mo/photo.jpg?sz=128", "display_name": "J Teruo", "link": "https://stackoverflow.com/users/11059895/j-teruo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "closed_date": 1552347157, "accepted_answer_id": 55107383, "answer_count": 4, "score": 0, "last_activity_date": 1552391626, "creation_date": 1552324708, "last_edit_date": 1552328379, "question_id": 55107155, "link": "https://stackoverflow.com/questions/55107155/how-to-get-the-first-letter-of-each-word", "closed_reason": "Needs more focus", "title": "How to get the first letter of each word", "body": "<p>I am looking to get user input, then for each word input, I want to take the first letter and display it. For example, if a user puts <code>\"Hello there\"</code>, it should return <code>\"Ht\"</code>. I don't want to use <code>map:chr</code>. If you use <code>gsub</code> or <code>split</code> to get the desired outcome, could you explain how it works?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "caching", "static-files"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1552321173, "post_id": 55106105, "comment_id": 96955329, "body": "so, it looks like your browser is caching the files ?, just hard reload a page and the request will load the files again. In a Mac you do it with shift + command + r."}], "answers": [{"comments": [{"owner": {"reputation": 3266, "user_id": 5179478, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/P2K06.jpg?s=128&g=1", "display_name": "ceckenrode", "link": "https://stackoverflow.com/users/5179478/ceckenrode"}, "edited": false, "score": 0, "creation_date": 1552321601, "post_id": 55106169, "comment_id": 96955566, "body": "Thanks @rewritten, seems like this works but I&#39;m going to mess with it for a few minutes before accepting this answer. I&#39;ve mostly worked with node in the past and haven&#39;t had this issue there. Just to clarify, this is because Rails sends headers along with public files to the browser telling it to cache the response?"}, {"owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "reply_to_user": {"reputation": 3266, "user_id": 5179478, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/P2K06.jpg?s=128&g=1", "display_name": "ceckenrode", "link": "https://stackoverflow.com/users/5179478/ceckenrode"}, "edited": false, "score": 3, "creation_date": 1552321802, "post_id": 55106169, "comment_id": 96955669, "body": "If the server sends no header, then the browser is free to choose. It does not depend on it being rails. When you worked with node, you probably had some webpack-based asset server that managed it for you, even pushing and hot-reloading assets. With rails, if you use a recent webpacker, it should behave the same way, but sprocket is older and does not manage the cache headers for you."}, {"owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "edited": false, "score": 1, "creation_date": 1552327794, "post_id": 55106169, "comment_id": 96958842, "body": "Additionally, chrome dev tools include a &quot;disable cache&quot; option under the network tab. I believe it only applies while dev tools are open. Personally, I&#39;d prefer this solution, so I don&#39;t have to change the server code."}, {"owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "edited": false, "score": 0, "creation_date": 1552383225, "post_id": 55106169, "comment_id": 96977819, "body": "That&#39;s exactly what I meant with &quot;or you disable browser cache completely&quot; @kennycok"}], "tags": [], "owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "is_accepted": true, "score": 10, "last_activity_date": 1552321121, "creation_date": 1552321121, "answer_id": 55106169, "question_id": 55106105, "link": "https://stackoverflow.com/questions/55106105/how-to-turn-off-rails-caching-during-development/55106169#55106169", "title": "How to turn off Rails caching during development", "body": "<p>It's not rails who caches, it's your browser.</p>\n\n<p>Either you explicitly set</p>\n\n<pre><code>config.public_file_server.headers = {\n  'Cache-Control' =&gt; \"no-cache\"\n}\n</code></pre>\n\n<p>(and clean your browser cache, who has all old and valid versions of your files), or you disable browser cache completely.</p>\n"}], "owner": {"reputation": 3266, "user_id": 5179478, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/P2K06.jpg?s=128&g=1", "display_name": "ceckenrode", "link": "https://stackoverflow.com/users/5179478/ceckenrode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2753, "favorite_count": 3, "accepted_answer_id": 55106169, "answer_count": 1, "score": 12, "last_activity_date": 1552321121, "creation_date": 1552320861, "question_id": 55106105, "link": "https://stackoverflow.com/questions/55106105/how-to-turn-off-rails-caching-during-development", "title": "How to turn off Rails caching during development", "body": "<p>I'm on Rails 5.2.2 and I'm building a web app that uses some static HTML, CSS, and JavaScript that I'm serving from inside of the <code>public</code> directory. Much of the time when I update a file it doesn't update in my browser when I refresh, but if I go into private browsing it works -- until it caches again and then I need to open a new private window.</p>\n\n<p>How can I turn off caching for file in the <code>public</code> folder? Or if it's easier, how can I turn off all caching during development?</p>\n\n<p>This is what my <code>development.rb</code> looks like. I tried commenting out the entire <code>if Rails.root.join('tmp', 'caching-dev.txt').exist?</code> block but that didn't do anything.</p>\n\n<p>I'm also open to installing a gem to solve this if it can't be fixed with a setting.</p>\n\n<pre><code>Rails.application.configure do\n  # Settings specified here will take precedence over those in config/application.rb.\n\n  # In the development environment your application's code is reloaded on\n  # every request. This slows down response time but is perfect for development\n  # since you don't have to restart the web server when you make code changes.\n  config.cache_classes = false\n\n  # Do not eager load code on boot.\n  config.eager_load = false\n\n  # Show full error reports.\n  config.consider_all_requests_local = true\n\n  config.file_watcher = ActiveSupport::FileUpdateChecker\n\n  # Enable/disable caching. By default caching is disabled.\n  # Run rails dev:cache to toggle caching.\n  if Rails.root.join('tmp', 'caching-dev.txt').exist?\n    config.action_controller.perform_caching = true\n\n    config.cache_store = :memory_store\n    config.public_file_server.headers = {\n      'Cache-Control' =&gt; \"public, max-age=#{2.days.to_i}\"\n    }\n  else\n    config.action_controller.perform_caching = false\n\n    config.cache_store = :null_store\n  end\n\n  # Store uploaded files on the local file system (see config/storage.yml for options)\n  config.active_storage.service = :local\n\n  # Don't care if the mailer can't send.\n  config.action_mailer.raise_delivery_errors = false\n\n  config.action_mailer.perform_caching = false\n\n  # Print deprecation notices to the Rails logger.\n  config.active_support.deprecation = :log\n\n  # Raise an error on page load if there are pending migrations.\n  config.active_record.migration_error = :page_load\n\n  # Highlight code that triggered database queries in logs.\n  config.active_record.verbose_query_logs = true\n\n  # Add devide default mailer url\n  config.action_mailer.default_url_options = { host: 'localhost', port: 3000 }\n\n\n  # Raises error for missing translations\n  # config.action_view.raise_on_missing_translations = true\n\n  # Use an evented file watcher to asynchronously detect changes in source code,\n  # routes, locales, etc. This feature depends on the listen gem.\n  config.file_watcher = ActiveSupport::EventedFileUpdateChecker\nend\n</code></pre>\n"}, {"tags": ["ruby", "automated-tests", "ui-automation", "watir"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1552320866, "post_id": 55105572, "comment_id": 96955157, "body": "Welcome to SO.  Can you post the (minimal amount of) HTML to reproduce the issue?  Given that <code>watir-webdriver</code> is deprecated, you should probably add the environmental info (e.g. browser, OS, browser drivers, etc)."}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 1, "creation_date": 1552321159, "post_id": 55105572, "comment_id": 96955320, "body": "What is the locator that you are passing in? From what I recall and can tell from the code, <code>:css</code> locator wouldn&#39;t normally be going to <code>assert_valid_as_attribute</code>."}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1552323033, "post_id": 55105572, "comment_id": 96956396, "body": "Providing the full stack trace might also help us narrow down the problem."}, {"owner": {"reputation": 3, "user_id": 11172708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UBrTmWVQ3gw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdMethXjkbqrp6CL-XlhrEoYxgkwA/mo/photo.jpg?sz=128", "display_name": "John Nguyen", "link": "https://stackoverflow.com/users/11172708/john-nguyen"}, "edited": false, "score": 0, "creation_date": 1552324784, "post_id": 55105572, "comment_id": 96957373, "body": "Added additional info."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11172708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UBrTmWVQ3gw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdMethXjkbqrp6CL-XlhrEoYxgkwA/mo/photo.jpg?sz=128", "display_name": "John Nguyen", "link": "https://stackoverflow.com/users/11172708/john-nguyen"}, "edited": false, "score": 0, "creation_date": 1552336746, "post_id": 55108676, "comment_id": 96962880, "body": "I somehow ended up with an additional, old version of watir-webdriver installed (0.6.4) in parallel with the newer version, and it worked after I uninstalled the older version of the gem! Thank you so much."}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 1, "last_activity_date": 1552330998, "creation_date": 1552330998, "answer_id": 55108676, "question_id": 55105572, "link": "https://stackoverflow.com/questions/55105572/why-do-i-get-an-invalid-attribute-exception-from-watir-webdriver-method-asser/55108676#55108676", "title": "Why do I get an &#39;invalid attribute&#39; exception from watir-webdriver method &quot;assert_valid_as_attribute&quot; when passing in &#39;:css&#39;?", "body": "<p>There appears to be a version mismatch.</p>\n\n<p>In v0.6.4, the following will thrown the exception:</p>\n\n<pre><code>gem 'selenium-webdriver', '=2.53.4'\ngem 'watir-webdriver', '=0.6.7'\n\nrequire 'watir-webdriver'\n\nbrowser = Watir::Browser.new :chrome\nat_exit { browser.close }\np browser.divs(:css =&gt; 'div').count\n#=&gt; `assert_valid_as_attribute': invalid attribute: :css (Watir::Exception::MissingWayOfFindingObjectException)\n</code></pre>\n\n<p>In this version, the only support for the <code>:css</code> locator was when it was by itself. The above example would include the <code>:tag_name</code> locator, which is the reason for the exception. You would have had to use <code>#elements</code> instead of <code>divs</code>.</p>\n\n<p>This was addressed in v0.6.8 (<a href=\"https://github.com/watir/watir/pull/244\" rel=\"nofollow noreferrer\">https://github.com/watir/watir/pull/244</a>). I would expect that your code base was created with at least v0.6.8.</p>\n"}], "owner": {"reputation": 3, "user_id": 11172708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UBrTmWVQ3gw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdMethXjkbqrp6CL-XlhrEoYxgkwA/mo/photo.jpg?sz=128", "display_name": "John Nguyen", "link": "https://stackoverflow.com/users/11172708/john-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 55108676, "answer_count": 1, "score": 0, "last_activity_date": 1552330998, "creation_date": 1552319123, "last_edit_date": 1552324595, "question_id": 55105572, "link": "https://stackoverflow.com/questions/55105572/why-do-i-get-an-invalid-attribute-exception-from-watir-webdriver-method-asser", "title": "Why do I get an &#39;invalid attribute&#39; exception from watir-webdriver method &quot;assert_valid_as_attribute&quot; when passing in &#39;:css&#39;?", "body": "<p>I recently inherited a Ruby test suite which is running watir-webdriver (0.6.4), and I'm in the unfortunate situation where the suite runs just fine on my colleague's machine, but several cases error out on mine. I've tried locking every version of all my gems to exactly what's on his machine to try to solve the compatibility issue, but no dice. The core error seems to be that I get the following exception originating from watir's internal `assert_valid_as_attribute' method:</p>\n\n<p><code>(Watir::Exception::MissingWayOfFindingObjectException: invalid attribute: :css)</code></p>\n\n<p>The originating call in my code is:</p>\n\n<p><code>search_results.selectable_cards_plural.take(assets_selected).each { |assets| assets.fire_event (\"onclick\") }</code></p>\n\n<p><code>search_results{...}.take</code> returns an array of divs. </p>\n\n<p>Has anyone seen this issue before? I've seen two other SO posts mentioning this issue, but neither of them seemed to address my particular issue.</p>\n\n<p>I've included a portion of my gemfile.lock below, in case anyone can easily spot the compatibility issue. I'm running Ruby 2.5.0.  And yes, I plan to update tests to run newer gem versions in the near future, but I want to have these legacy regression tests running in the meanwhile.</p>\n\n<p>Selectors mentioned above:\n<code>def search_results; @browser.div(:class, 'search-results-grid') end</code>\n<code>def selectable_cards_plural; divs(:css =&gt; 'div.p-card-hover.p-card-selectable:not(.p-card-selected)') end</code></p>\n\n<p>The element being selected is:\nclass=\"p-card-hover p-card-selectable css-g6ribn-StyledCardHover-visible-visible-visible-visible-StyledCardHover erkh22a0\"</p>\n\n<p>Environment info:\nMacOS macOS 10.14.3 (Mojave)\nChrome Version 72.0.3626.121\nBrowser driver: @browser = Watir::Browser.new :chrome, :prefs => chrome_prefs, switches: %w[--window-size=1600,900 --ignore-certificate-errors --disable-popup-blocking --disable-translate]</p>\n\n<p>Stack trace:</p>\n\n<pre><code>Asset Section: Adding # When selecting specific # from search adds assets to section\n     Failure/Error: search_results.selectable_cards_plural.take(assets_selected).each { |assets| assets.fire_event (\"onclick\") }\n\n     Watir::Exception::MissingWayOfFindingObjectException:\n       invalid attribute: :css\n     # /Users/jnguyen/.rvm/gems/ruby-2.5.0/gems/watir-webdriver-0.6.4/lib/watir-webdriver/locators/element_locator.rb:238:in `assert_valid_as_attribute'\n     # /Users/jnguyen/.rvm/gems/ruby-2.5.0/gems/watir-webdriver-0.6.4/lib/watir-webdriver/locators/element_locator.rb:219:in `normalize_selector'\n     # /Users/jnguyen/.rvm/gems/ruby-2.5.0/gems/watir-webdriver-0.6.4/lib/watir-webdriver/locators/element_locator.rb:198:in `block in normalized_selector'\n     # /Users/jnguyen/.rvm/gems/ruby-2.5.0/gems/watir-webdriver-0.6.4/lib/watir-webdriver/locators/element_locator.rb:195:in `each'\n     # /Users/jnguyen/.rvm/gems/ruby-2.5.0/gems/watir-webdriver-0.6.4/lib/watir-webdriver/locators/element_locator.rb:195:in `normalized_selector'\n     # /Users/jnguyen/.rvm/gems/ruby-2.5.0/gems/watir-webdriver-0.6.4/lib/watir-webdriver/locators/element_locator.rb:98:in `find_all_by_multiple'\n     # /Users/jnguyen/.rvm/gems/ruby-2.5.0/gems/watir-webdriver-0.6.4/lib/watir-webdriver/locators/element_locator.rb:46:in `locate_all'\n     # /Users/jnguyen/.rvm/gems/ruby-2.5.0/gems/watir-webdriver-0.6.4/lib/watir-webdriver/element_collection.rb:96:in `elements'\n     # /Users/jnguyen/.rvm/gems/ruby-2.5.0/gems/watir-webdriver-0.6.4/lib/watir-webdriver/element_collection.rb:86:in `to_a'\n     # /Users/jnguyen/.rvm/gems/ruby-2.5.0/gems/watir-webdriver-0.6.4/lib/watir-webdriver/element_collection.rb:29:in `each'\n     # ./lib/live_editor/assets_le.rb:37:in `take'\n     # ./lib/live_editor/assets_le.rb:37:in `select_assets'\n     # ./spec/smoke/live_editor/standard/asset_add_num_spec.rb:23:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Gemfile.lock</p>\n\n<pre><code>    {...}\n    commonwatir (4.0.0)\n    rake (12.3.2)\n    rspec (3.5.0)\n      rspec-core (~&gt; 3.5.0)\n      rspec-expectations (~&gt; 3.5.0)\n      rspec-mocks (~&gt; 3.5.0)\n    rspec-core (3.5.2)\n      rspec-support (~&gt; 3.5.0)\n    rspec-expectations (3.5.0)\n      diff-lcs (&gt;= 1.2.0, &lt; 2.0)\n      rspec-support (~&gt; 3.5.0)\n    rspec-mocks (3.5.0)\n      diff-lcs (&gt;= 1.2.0, &lt; 2.0)\n      rspec-support (~&gt; 3.5.0)\n    rspec-support (3.5.0)\n    rspec_html_formatter (0.3.1)\n      activesupport (&gt;= 4.1.4)\n      rouge (&gt;= 1.6.1)\n      rspec-core (&gt;= 3.0.3)\n    selenium-webdriver (2.53.4)\n      childprocess (~&gt; 0.5)\n      rubyzip (~&gt; 1.0)\n      websocket (~&gt; 1.0)\n    watir (5.0.0)\n      commonwatir (~&gt; 4)\n      watir-webdriver\n    watir-rspec (2.0.3)\n      rspec (~&gt; 3.0)\n      watir (~&gt; 5.0)\n    watir-scroll (0.1.0)\n      watir-webdriver\n    watir-webdriver (0.6.4)\n      selenium-webdriver (&gt;= 2.18.0)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  {...}\n  rake\n  rspec (= 3.5.0)\n  rspec-core (= 3.5.2)\n  rspec_html_formatter (~&gt; 0.3.1)\n  selenium-webdriver (= 2.53.4)\n  watir (~&gt; 5.0.0)\n  watir-rspec (= 2.0.3)\n  watir-scroll (~&gt; 0.1.0)\n  watir-webdriver (= 0.6.4)\n\nBUNDLED WITH\n   1.17.3\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1552323425, "post_id": 55105482, "comment_id": 96956630, "body": "Why do you have two user types? That sounds like a giant hassle compared to a single model with a <code>role</code> flag that could be set to <code>&quot;employee&quot;</code>."}, {"owner": {"reputation": 764, "user_id": 552941, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HYsSP.jpg?s=128&g=1", "display_name": "Fernando Aureliano", "link": "https://stackoverflow.com/users/552941/fernando-aureliano"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1552404746, "post_id": 55105482, "comment_id": 96992014, "body": "Thanks, but this is not the question and it it&#39;s not an answer."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1552409572, "post_id": 55105482, "comment_id": 96995198, "body": "Just trying to establish if this is an <a href=\"https://en.wikipedia.org/wiki/XY_problem\" rel=\"nofollow noreferrer\">XY Problem</a> or not. If you have two different models you probably need two different forms, or the one form has to try against both authentication methods in turn using a custom session controller."}], "answers": [{"tags": [], "owner": {"reputation": 5019, "user_id": 592795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/913acc75c0777600b8c85ae549b099df?s=128&d=identicon&r=PG", "display_name": "marimaf", "link": "https://stackoverflow.com/users/592795/marimaf"}, "is_accepted": false, "score": 0, "last_activity_date": 1552497986, "creation_date": 1552497986, "answer_id": 55147913, "question_id": 55105482, "link": "https://stackoverflow.com/questions/55105482/rails5-and-devise-login-form-for-multiple-models/55147913#55147913", "title": "Rails5 and Devise: Login form for multiple models", "body": "<p>Devise has a wiki on this. Please check: <a href=\"https://github.com/plataformatec/devise/wiki/How-to-Setup-Multiple-Devise-User-Models\" rel=\"nofollow noreferrer\">How to Setup Multiple Devise User Models</a></p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 764, "user_id": 552941, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HYsSP.jpg?s=128&g=1", "display_name": "Fernando Aureliano", "link": "https://stackoverflow.com/users/552941/fernando-aureliano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552497986, "creation_date": 1552318798, "question_id": 55105482, "link": "https://stackoverflow.com/questions/55105482/rails5-and-devise-login-form-for-multiple-models", "title": "Rails5 and Devise: Login form for multiple models", "body": "<p>I have two models: <strong>user</strong> and <strong>employee_user</strong>, how can I setup a login form to authenticate two models at the same time? I need to login form check in what model he needs to authentiate the user</p>\n\n<p><strong>ApplicationHelper</strong></p>\n\n<pre><code>module ApplicationHelper\n  def resource_name\n    :user\n  end\n\n  def resource\n    @resource ||= User.new\n  end\n\n  def devise_mapping\n    @devise_mapping ||= Devise.mappings[:user]\n  end\nend\n</code></pre>\n\n<p><strong>Form</strong></p>\n\n<pre><code>&lt;%= form_for(:user, :url =&gt; session_path(:user)) do |f| %&gt;\n\n      &lt;%= f.email_field :email, required: true, placeholder: \"Email\" %&gt;\n      &lt;%= f.password_field :password, autocomplete: :off, required: true, placeholder: \"Password\" %&gt;\n\n      &lt;%= f.submit 'ENTER', class: \"btLogin\" %&gt;\n\n      &lt;div class=\"infosLembrar\"&gt;\n        &lt;p&gt;&lt;%= f.check_box :remember_me %&gt; Remember me&lt;/p&gt;\n      &lt;/div&gt;\n\n    &lt;% end %&gt;\n</code></pre>\n\n<p>Someone already did it before? Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "geolocation"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1552318870, "post_id": 55105219, "comment_id": 96953804, "body": "Do you store longitude and latitude as floats or is <code>start_point</code> a string like this <code>&quot;54.678, 45.789&quot;</code>?"}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1552319037, "post_id": 55105219, "comment_id": 96953918, "body": "@spickermann <code>start_point</code> is a string"}], "answers": [{"comments": [{"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1552320563, "post_id": 55105904, "comment_id": 96954938, "body": "<code>99.99, 999.99</code> will be valid with this regex"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1552320929, "post_id": 55105904, "comment_id": 96955194, "body": "I didn&#39;t realise that was supposed to be invalid? Just add in the upper limit for the range as required"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1552320943, "post_id": 55105904, "comment_id": 96955206, "body": "/\\d{1,2}\\.\\d{1,},\\s\\d{1,2}\\.\\d{1,}/ in that case"}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1552321126, "post_id": 55105904, "comment_id": 96955299, "body": "<code>99.99, 56.12</code> will be valid in this case and <code>85.99, 178.81</code> will be invalid"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1552321237, "post_id": 55105904, "comment_id": 96955363, "body": "Are we just going to keep on inventing new rules for me to solve? :)"}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1552321393, "post_id": 55105904, "comment_id": 96955442, "body": "No new rules. These are geocoordinates and your regex is not good."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1552321463, "post_id": 55105904, "comment_id": 96955487, "body": "The requirements were: Coordinates should be i the form 54.678, 45.789 and can take any amount of numbers after the decimal point. Nobody mentioned anything about the size of the numbers before the point."}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1552320226, "creation_date": 1552320226, "answer_id": 55105904, "question_id": 55105219, "link": "https://stackoverflow.com/questions/55105219/how-do-i-validate-coordinates-in-my-rails-model/55105904#55105904", "title": "How do I validate coordinates in my Rails model?", "body": "<p>I can't run it now but try:</p>\n\n<pre><code>  validates :points, format: { with: /\\d{1,}\\.\\d{1,},\\s\\d{1,}\\.\\d{1,}/, message: \"please enter co-ordinates in correct format\"}\n</code></pre>\n\n<p>The logic being:</p>\n\n<p>Match at least 1 number, followed by a decimal, followed by 1 or more numbers, followed by a comma, followed by a space, followed by one or more numbers, followed by a a decimal, followed by one or more numbers</p>\n"}, {"tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": false, "score": 0, "last_activity_date": 1552320377, "creation_date": 1552320377, "answer_id": 55105949, "question_id": 55105219, "link": "https://stackoverflow.com/questions/55105219/how-do-i-validate-coordinates-in-my-rails-model/55105949#55105949", "title": "How do I validate coordinates in my Rails model?", "body": "<p>The latitude must be a number between -90 and 90 and the longitude between -180 and 180.</p>\n\n<p>So in your model:</p>\n\n<pre><code>GEOCOORDINATES_REGEX = /\\A-?(?:90(?:(?:\\.0*)?)|(?:[0-9]|[1-8][0-9])(?:(?:\\.\\d*)?)),\\s-?(?:180(?:(?:\\.0*)?)|(?:[0-9]|[1-9][0-9]|1[0-7][0-9])(?:(?:\\.\\d*)?))\\z/.freeze\n\nvalidates :start_point, format: { with: GEOCOORDINATES_REGEX }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "is_accepted": false, "score": 0, "last_activity_date": 1552323507, "creation_date": 1552323507, "answer_id": 55106835, "question_id": 55105219, "link": "https://stackoverflow.com/questions/55105219/how-do-i-validate-coordinates-in-my-rails-model/55106835#55106835", "title": "How do I validate coordinates in my Rails model?", "body": "<p>First thing should be to separate input validation from model stuff. Use some separate layer, even if it's just a bare class implementing ActiveModel::Validations.</p>\n\n<p>Then, add a stand-alone validator class like:</p>\n\n<pre><code>class GeoPairValidator &lt; ActiveModel::EachValidator\n  RE = /\\A\\d+\\.\\d+, ?\\d+\\.\\d+\\z/\n\n  def validate_each(record, attribute, value)\n    # value should be \"nn.nnnnnnn, nn.nnnnnnn\"\n    record.errors.add(attribute, :invalid, value: value) if value.to_s !~ RE\n\n    # split by comma, convert to float\n    v1, v2 = value.to_s.split(', ').map(&amp;:to_f)\n\n    # check logical bounds\n    record.errors.add(attribute, :invalid, value: value) if v1.abs &gt; 90\n    record.errors.add(attribute, :invalid, value: value) if v2.abs &gt; 180\n  end\nend\n</code></pre>\n\n<p>Finally, use it in your input class:</p>\n\n<pre><code>class YourInput\n  include ActiveModel::Validations\n\n  attr_accessor :start_point\n\n  validates :start_point, geo_point: true\nend\n</code></pre>\n\n<p>Also check <a href=\"https://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validates\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validates</a> for more detailed information.</p>\n"}], "owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1552323507, "creation_date": 1552317937, "last_edit_date": 1552318350, "question_id": 55105219, "link": "https://stackoverflow.com/questions/55105219/how-do-i-validate-coordinates-in-my-rails-model", "title": "How do I validate coordinates in my Rails model?", "body": "<p>I have built a Rails app that uses the HTML5 Geolocation API to get a user's current position. I use the coordinates to populate a field in my form. I want to know how to validate this in my model. Here is what my form input looks like:</p>\n\n<pre><code>&lt;%= f.input :start_point, label: false,  input_html: { id: 'coordinatesStart' } %&gt;\n</code></pre>\n\n<p>Coordinates should be i the form <code>54.678, 45.789</code> and can take any amount of numbers after the decimal point. </p>\n\n<p>Any ideas how I could do this?</p>\n"}, {"tags": ["ruby", "csv", "export-to-csv"], "comments": [{"owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "edited": false, "score": 0, "creation_date": 1552319352, "post_id": 55105134, "comment_id": 96954117, "body": "It would be very useful to say what output you desire and to also show what output you are actually getting."}, {"owner": {"reputation": 3, "user_id": 9759834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e234cf4e554c285bc94c7ed6dfd3fdf?s=128&d=identicon&r=PG&f=1", "display_name": "F7777", "link": "https://stackoverflow.com/users/9759834/f7777"}, "reply_to_user": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "edited": false, "score": 0, "creation_date": 1552320835, "post_id": 55105134, "comment_id": 96955133, "body": "I added the desired/current output, thanks!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1552336751, "post_id": 55105134, "comment_id": 96962883, "body": "Note that two of the solutions to date employ the method <code>Hash#values_at</code>. If it&#39;s not evident, that was used so that no assumption need be made about the order of the hash keys (<code>:price</code> and <code>:brand</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9759834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e234cf4e554c285bc94c7ed6dfd3fdf?s=128&d=identicon&r=PG&f=1", "display_name": "F7777", "link": "https://stackoverflow.com/users/9759834/f7777"}, "edited": false, "score": 0, "creation_date": 1552390818, "post_id": 55105852, "comment_id": 96982657, "body": "Thank you for your solution! Unfortunately, it doesnt work. Here are the terminal outputs: <code>irb(main):170:0&gt; titles = hash.values.map(&amp;:keys).uniq =&gt; [[:price, :brand]]</code> <code>irb(main):171:0&gt; rows = hash.values.map { |data| data.values_at(*titles) } =&gt; [[nil], [nil], [nil], [nil], [nil]]</code> <code>irb(main):172:0&gt; s = CSV.generate do |csv| irb(main):173:1*   csv &lt;&lt; titles irb(main):174:1&gt;   rows.each do |row| irb(main):175:2*     csv &lt;&lt; row irb(main):176:2&gt;   end irb(main):177:1&gt; end =&gt; &quot;\\&quot;[:price, :brand]\\&quot;\\n\\n\\n\\n\\n\\n&quot;</code> The exported csv file then only contains &quot;[:price, :brand]&quot; in one row"}, {"owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "reply_to_user": {"reputation": 3, "user_id": 9759834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e234cf4e554c285bc94c7ed6dfd3fdf?s=128&d=identicon&r=PG&f=1", "display_name": "F7777", "link": "https://stackoverflow.com/users/9759834/f7777"}, "edited": false, "score": 0, "creation_date": 1552474029, "post_id": 55105852, "comment_id": 97020195, "body": "yep I forgot to flatten the titles list. Titles should have been <code>[:price, :brand]</code> and not <code>[[:price, :brand]]</code>."}], "tags": [], "owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "is_accepted": false, "score": 4, "last_activity_date": 1552474081, "last_edit_date": 1552474081, "creation_date": 1552320088, "answer_id": 55105852, "question_id": 55105134, "link": "https://stackoverflow.com/questions/55105134/ruby-how-to-convert-a-nested-hash-into-a-csv-file/55105852#55105852", "title": "(Ruby) How to convert a nested hash into a csv file", "body": "<p>It seems that you are only interested in the values of your nested hash. In that case you can simply do</p>\n\n<pre><code>titles = hash.values.map(&amp;:keys).flatten.uniq\nrows = hash.values.map { |data| data.values_at(*titles) }\n\ns = CSV.generate do |csv|\n  csv &lt;&lt; titles\n  rows.each do |row|\n    csv &lt;&lt; row\n  end\nend\n</code></pre>\n\n<p>(update)</p>\n\n<p>Titles should be flattened to a simple array.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9759834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e234cf4e554c285bc94c7ed6dfd3fdf?s=128&d=identicon&r=PG&f=1", "display_name": "F7777", "link": "https://stackoverflow.com/users/9759834/f7777"}, "edited": false, "score": 0, "creation_date": 1552391292, "post_id": 55105918, "comment_id": 96982955, "body": "Thank you, spickermann! Your solution works fine. Including <code>headers = hash.values[0].keys</code> and <code>csv &lt;&lt; headers</code> from @Grzegorz code adds the headers."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 4, "last_activity_date": 1552320285, "creation_date": 1552320285, "answer_id": 55105918, "question_id": 55105134, "link": "https://stackoverflow.com/questions/55105134/ruby-how-to-convert-a-nested-hash-into-a-csv-file/55105918#55105918", "title": "(Ruby) How to convert a nested hash into a csv file", "body": "<p>I would do something like this:</p>\n\n<pre><code>require 'csv'\n\nCSV.open('the_file.csv', 'w') do |csv|\n  hash.each do |id, attributes|    \n    csv &lt;&lt; [id, *attributes.values_at(:price, :brand)]\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9759834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e234cf4e554c285bc94c7ed6dfd3fdf?s=128&d=identicon&r=PG&f=1", "display_name": "F7777", "link": "https://stackoverflow.com/users/9759834/f7777"}, "edited": false, "score": 0, "creation_date": 1552390404, "post_id": 55105964, "comment_id": 96982437, "body": "Thank you! Your solution returns exactly the desired output, including the headers."}], "tags": [], "owner": {"reputation": 1056, "user_id": 272596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa6e65b91b46f3317c3d3e94e9255f2?s=128&d=identicon&r=PG", "display_name": "Gregory Witek", "link": "https://stackoverflow.com/users/272596/gregory-witek"}, "is_accepted": false, "score": 1, "last_activity_date": 1552320418, "creation_date": 1552320418, "answer_id": 55105964, "question_id": 55105134, "link": "https://stackoverflow.com/questions/55105134/ruby-how-to-convert-a-nested-hash-into-a-csv-file/55105964#55105964", "title": "(Ruby) How to convert a nested hash into a csv file", "body": "<p>CSV format is essentially an array of arrays. Each element of the main array is a single row. A single row is an array of cells. So what you want basically is something like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[\n  [:price, :brand],\n  [\"400\", \"Primark\"],\n  [\"1000\", \"Pull&amp;Bear\"]\n]\n</code></pre>\n\n<p>You can achieve it in a following way:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>headers = hash.values[0].keys # this will return [:price, :brand] and we'll use it as a header\ndata = hash.values.map(&amp;:values)\n\ncsv_output = CSV.generate do |csv|\n  csv &lt;&lt; headers # we need headers only once, we don't need them in every row\n  data.each do |single_row| # iterate over each row\n    csv &lt;&lt; single_row # add the row to csv file\n  end\nend\nFile.write('the_file.csv', csv_output)\n</code></pre>\n\n<p>This code assumes that for every row you'll have all data available (i.e. each row will have a price and brand provided). Code above provided by user rewritten is more flexible.</p>\n"}], "owner": {"reputation": 3, "user_id": 9759834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e234cf4e554c285bc94c7ed6dfd3fdf?s=128&d=identicon&r=PG&f=1", "display_name": "F7777", "link": "https://stackoverflow.com/users/9759834/f7777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "accepted_answer_id": 55105918, "answer_count": 3, "score": 0, "last_activity_date": 1552474081, "creation_date": 1552317703, "last_edit_date": 1552320769, "question_id": 55105134, "link": "https://stackoverflow.com/questions/55105134/ruby-how-to-convert-a-nested-hash-into-a-csv-file", "title": "(Ruby) How to convert a nested hash into a csv file", "body": "<hr>\n\n<p><strong>The Problem:</strong></p>\n\n<p>I have the following hash:</p>\n\n<blockquote>\n  <p>hash = {1=>{:price=>\"400\", :brand=>\"Primark\"}, 2=>{:price=>\"1000\",\n  :brand=>\"pull&amp;bear\"}, 3=>{:price=>\"1700\", :brand=>\"\"},\n  4=>{:price=>\"500\", :brand=>\"H&amp;M\"}, 5=>{:price=>\"500\",\n  :brand=>\"Mango\"}}</p>\n</blockquote>\n\n<p>and I want to convert it into a csv file.</p>\n\n<hr>\n\n<p><strong>Approach so far:</strong></p>\n\n<p>My closest solution <a href=\"https://stackoverflow.com/a/17864876/9759834\">(inspired by)</a> seems to overwrite itself constantly:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'csv'\n\n(1..5).each do |id|\n   column_names = hash[id].keys\n   column_values = hash[id].values\n   s=CSV.generate do |csv|\n      csv &lt;&lt; column_names\n      csv &lt;&lt; column_values\n   end\n   File.write('the_file.csv', s)\nend\n</code></pre>\n\n<p>Current csv file:</p>\n\n<pre><code>+---+------------+-------------+\n|   |     A      |      B      |\n+---+------------+-------------+\n| 1 | price,brand|             |\n| 2 | 500, Mango |             |\n+---+------------+-------------+\n</code></pre>\n\n<p>Desired csv output:</p>\n\n<pre><code>+---+------------+-------------+\n|   |     A      |      B      |\n+---+------------+-------------+\n| 1 | price      | brand       |\n| 2 | 400        | Primark     |\n| 3 | 1000       | pull&amp;bear   |\n| 4 | 1700       |             |\n| 5 | 500        | H&amp;M         |\n| 6 | 500        | mango       |\n+---+------------+-------------+\n</code></pre>\n\n<hr>\n\n<p>There are several questions on here that either deal with the inverse (converting a csv into a nested hash) or only convert simple hashes into csv files, but not with nested hashes. I'm fairly new to Ruby and can't connect the dots here yet. Help would be greatly appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 11003, "user_id": 704832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef1df54852b9874b6902d97969ce0ee?s=128&d=identicon&r=PG", "display_name": "Richard Brown", "link": "https://stackoverflow.com/users/704832/richard-brown"}, "edited": false, "score": 0, "creation_date": 1552317282, "post_id": 55104814, "comment_id": 96952771, "body": "For clarification, parent_ids is an array of parent_ids"}, {"owner": {"reputation": 61, "user_id": 2514714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca26c3ebc548ee72e5db9d00fb9b14f?s=128&d=identicon&r=PG&f=1", "display_name": "bumcode", "link": "https://stackoverflow.com/users/2514714/bumcode"}, "edited": false, "score": 0, "creation_date": 1552321705, "post_id": 55104814, "comment_id": 96955623, "body": "Yes, I&#39;ve gone with a similar solution for now. I was just a little dumbstruck when I saw the above behavior, and couldn&#39;t explain it to myself."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1552317562, "last_edit_date": 1552317562, "creation_date": 1552316668, "answer_id": 55104814, "question_id": 55104559, "link": "https://stackoverflow.com/questions/55104559/iterating-over-merged-associationrelation/55104814#55104814", "title": "Iterating over merged AssociationRelation", "body": "<p>You are not forced to start from parents. What about just</p>\n\n<pre><code>@children = Children.where(parent: parents)\n</code></pre>\n\n<p>in this case parents is an array of <code>Parent</code> objects or an <code>ActiveRecord::Relation</code></p>\n\n<p>or</p>\n\n<pre><code>@children = Children.where(parent_id: parent_ids)\n</code></pre>\n\n<p>in this case parent_ids is an array of integers, ids for <code>Parent</code> model</p>\n"}], "owner": {"reputation": 61, "user_id": 2514714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca26c3ebc548ee72e5db9d00fb9b14f?s=128&d=identicon&r=PG&f=1", "display_name": "bumcode", "link": "https://stackoverflow.com/users/2514714/bumcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552317562, "creation_date": 1552315896, "question_id": 55104559, "link": "https://stackoverflow.com/questions/55104559/iterating-over-merged-associationrelation", "title": "Iterating over merged AssociationRelation", "body": "<p>In my application, <code>Parent</code>s have many <code>Child</code>ren. In <code>ParentsController#show</code>, I'd like for the user to be able to specify more than one parent, so I can show all of their children at once.</p>\n\n<p>In my controller, given an <code>@array</code> which contains three <code>Parent</code>s with the ids 1, 2, and 3, this is what happens:</p>\n\n<pre><code>@array.map(&amp;:children).reduce(&amp;:or).map { |i| i.parent_id }.uniq\n# =&gt; [1, 2, 3]\n</code></pre>\n\n<pre><code>@array.map(&amp;:children).reduce(&amp;:or).map { |i| i.parent }.uniq\n# =&gt; [#&lt;Parent:0x00007faff17164b8&gt;]\n</code></pre>\n\n<p>Why is only one parent returned? Is this some sort of caching in action, and if so, how can it be avoided? Is doing things this way a bad idea altogether?</p>\n"}, {"tags": ["ruby", "yaml", "erb", "chatbot"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552316200, "post_id": 55104522, "comment_id": 96952098, "body": "What error is that <i>exactly</i>? undefined method first name for nil:NilClass?"}, {"owner": {"reputation": 1603, "user_id": 1919319, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/u1f49.jpg?s=128&g=1", "display_name": "MikeHolford", "link": "https://stackoverflow.com/users/1919319/mikeholford"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552316356, "post_id": 55104522, "comment_id": 96952190, "body": "Yup sorry full error: <code>undefined method &#39;first_name&#39; for nil:NilClass</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1603, "user_id": 1919319, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/u1f49.jpg?s=128&g=1", "display_name": "MikeHolford", "link": "https://stackoverflow.com/users/1919319/mikeholford"}, "edited": false, "score": 0, "creation_date": 1552322919, "post_id": 55105766, "comment_id": 96956330, "body": "This is great but ideally I want to pass in a <code>@user</code> variable s oI can call <code>@user.first_name</code> or <code>@user.last_name</code> without defining everything first"}, {"owner": {"reputation": 1603, "user_id": 1919319, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/u1f49.jpg?s=128&g=1", "display_name": "MikeHolford", "link": "https://stackoverflow.com/users/1919319/mikeholford"}, "edited": false, "score": 0, "creation_date": 1552323402, "post_id": 55105766, "comment_id": 96956618, "body": "Figured out a way using <code>binding</code> ... What do you think?"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 3, "last_activity_date": 1581952477, "last_edit_date": 1581952477, "creation_date": 1552319862, "answer_id": 55105766, "question_id": 55104522, "link": "https://stackoverflow.com/questions/55104522/load-a-yaml-file-with-variable-in-ruby/55105766#55105766", "title": "Load a YAML file with variable in Ruby", "body": "<p>I suggest using <a href=\"https://ruby-doc.org/core-2.6.1/String.html#method-i-25\" rel=\"nofollow noreferrer\">format specifications</a> instead of ERB.</p>\n\n<p>This leads to a simpler syntax in the YAML file</p>\n\n<pre><code>- reply_type: text\n  text: \"Welcome %{user_name}\"\n</code></pre>\n\n<p>and a simple read method</p>\n\n<pre><code>@user = User.find(user_id)\nreplies = YAML.load(\n  File.read(\"app/bot/replies/say_hello.yml\") % { user_name: @user.first_name }\n)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1552324184, "post_id": 55106799, "comment_id": 96957046, "body": "That&#39;s another option. Depends on who is managing the YAML files. External translators (non-developers) might mess up ERB because their syntax is a bit more complex. And it might lead to security issues if you cannot trust the editor of the YAML files."}, {"owner": {"reputation": 1303, "user_id": 1669747, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/641cf17f1135ccbc3d35d954942ccde3?s=128&d=identicon&r=PG", "display_name": "AKS", "link": "https://stackoverflow.com/users/1669747/aks"}, "edited": false, "score": 0, "creation_date": 1570969701, "post_id": 55106799, "comment_id": 103078198, "body": "@MikeHolford what is binding here? i am also trying to pass some variable inside .yml.erb file . Can you provide details please?"}], "tags": [], "owner": {"reputation": 1603, "user_id": 1919319, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/u1f49.jpg?s=128&g=1", "display_name": "MikeHolford", "link": "https://stackoverflow.com/users/1919319/mikeholford"}, "is_accepted": false, "score": 1, "last_activity_date": 1552323379, "creation_date": 1552323379, "answer_id": 55106799, "question_id": 55104522, "link": "https://stackoverflow.com/questions/55104522/load-a-yaml-file-with-variable-in-ruby/55106799#55106799", "title": "Load a YAML file with variable in Ruby", "body": "<p>I've figured out a way using <code>binding</code>. YAML load line with the below and it works great:</p>\n\n<pre><code>replies = YAML.load(ERB.new(File.read(\"app/bot/replies/say_hello.yml\")).result(binding))\n</code></pre>\n"}], "owner": {"reputation": 1603, "user_id": 1919319, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/u1f49.jpg?s=128&g=1", "display_name": "MikeHolford", "link": "https://stackoverflow.com/users/1919319/mikeholford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1581952477, "creation_date": 1552315799, "question_id": 55104522, "link": "https://stackoverflow.com/questions/55104522/load-a-yaml-file-with-variable-in-ruby", "title": "Load a YAML file with variable in Ruby", "body": "<p>I'm building a chatbot and storing my 'replies' in a Yaml file below:</p>\n\n<pre><code># say_hello.yml\n\n- reply_type: text\n  text: \"Welcome &lt;%= @user.first_name %&gt;\"\n- reply_type: delay\n  duration: 2\n- reply_type: text\n  text: \"We're here to help you learn more about something or another.\"\n- reply_type: delay\n  duration: 2\n</code></pre>\n\n<p>In order to run the replies I use this method: </p>\n\n<pre><code>def process\n\n  @user = User.find(user_id)\n  replies = YAML.load(ERB.new(File.read(\"app/bot/replies/say_hello.yml\")).result)\n\n  replies.each do |reply|\n    # code for replies...\n  end\n\nend\n</code></pre>\n\n<p>When I run this however I'm getting a 'undefined method' error on <code>first_name</code> for <code>@user</code>. If I run the same code in a console it works. </p>\n\n<p>How can I define a variable like <code>@user</code> and then load the YAML file correctly?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "excel", "csv", "schema"], "comments": [{"owner": {"reputation": 2301, "user_id": 19317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47035e07012da3162b6e83650ee3abe0?s=128&d=identicon&r=PG", "display_name": "aridlehoover", "link": "https://stackoverflow.com/users/19317/aridlehoover"}, "edited": false, "score": 0, "creation_date": 1552540142, "post_id": 55104004, "comment_id": 97050377, "body": "Do you need a programmatic solution? If not, you could use a tool like Postico to run the query <code>select * from information_schema.columns</code>, and then export the results to CSV."}, {"owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "reply_to_user": {"reputation": 2301, "user_id": 19317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47035e07012da3162b6e83650ee3abe0?s=128&d=identicon&r=PG", "display_name": "aridlehoover", "link": "https://stackoverflow.com/users/19317/aridlehoover"}, "edited": false, "score": 0, "creation_date": 1552540490, "post_id": 55104004, "comment_id": 97050475, "body": "@aridlehoover yes I need a programmatic solution. which will show constraints and indexes along with the columns of the table."}, {"owner": {"reputation": 2930, "user_id": 1930295, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/128cc4033ec598b63fa96deb33e26131?s=128&d=identicon&r=PG", "display_name": "danielricecodes", "link": "https://stackoverflow.com/users/1930295/danielricecodes"}, "edited": false, "score": 1, "creation_date": 1552585907, "post_id": 55104004, "comment_id": 97077527, "body": "I&#39;d highly suggest getting familiar with ActiveRecord::SchemaDumper.  <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/schema_dumper.rb\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/master/activerecord/lib/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 6144460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a3cdffe21fd594a0947298f0f4f1f8?s=128&d=identicon&r=PG", "display_name": "periswon", "link": "https://stackoverflow.com/users/6144460/periswon"}, "is_accepted": false, "score": 0, "last_activity_date": 1552861075, "last_edit_date": 1552861075, "creation_date": 1552556725, "answer_id": 55159306, "question_id": 55104004, "link": "https://stackoverflow.com/questions/55104004/how-to-create-csv-excel-of-schema-rb-file/55159306#55159306", "title": "How to create CSV/Excel of schema.rb file", "body": "<p>I don't know if there is a simple \"export_to_csv\" method you can use but if you want to extend your approach collecting all the database information through ActiveRecord than I think in <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/schema_dumper.rb\" rel=\"nofollow noreferrer\">schema_dumper.rb</a> you will find everything you need. Just follow how <code>SchemaDumper#dump</code> collects all the information.</p>\n\n<p>You can get a <code>SchemaDumper</code> object with </p>\n\n<pre><code>connection = ApplicationRecord.connection\ndumper = connection.create_schema_dumper({})\n</code></pre>\n\n<p>A way to get index information for a table seems to be:</p>\n\n<pre><code>table = connection.tables.first\nconnection.indexes(table)\n</code></pre>\n\n<p><code>SchemaDumper.column_spec</code> is probably also useful for your use case:</p>\n\n<pre><code>column = connection.columns(table).first\ndumper.send(:column_spec, column) # =&gt; [:integer, {:null=&gt;\"false\", :auto_increment=&gt;\"true\"}]\n</code></pre>\n"}], "owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1552861075, "creation_date": 1552314144, "last_edit_date": 1552538913, "question_id": 55104004, "link": "https://stackoverflow.com/questions/55104004/how-to-create-csv-excel-of-schema-rb-file", "title": "How to create CSV/Excel of schema.rb file", "body": "<p>I want to create a CSV/Excel file from db/schema.rb file. I am able to dump the table name and their attribute names in a file, but I also want to dump other information like indexes, and constraints on columns etc. </p>\n\n<p>Here is my code</p>\n\n<pre><code>require 'write_xlsx'\nRails.application.eager_load!\n# Create a new Excel workbook\nworkbook = WriteXLSX.new('schema.xlsx')\n\n# Add a worksheet\nworksheet = workbook.add_worksheet\n\n# Add and define a format\nformat = workbook.add_format # Add a format\nformat.set_bold\nformat.set_color('red')\nformat.set_align('center')\n\n# Write a formatted and unformatted string, row and column notation.\ncol = row = 0\nworksheet.write(0, 0, 'Table Name')\nworksheet.write(0, 1, 'Attributes')\nworksheet.write(0, 2, 'Attribute Type')\nworksheet.write(0, 3, 'Attribute constraints')\nworksheet.write(0, 4, 'Comments')\nApplicationRecord.descendants.each_with_index do |model, _index|\n  row += 1\n  worksheet.write(row, 0, model.name)\n  worksheet.write(row, 1, '')\n  model.attribute_types.each_pair do |attribute, attribute_type|\n    row += 1\n    worksheet.write(row, 1, attribute)\n    worksheet.write(row, 2, attribute_type.type)\n    worksheet.write(row, 3, JSON.parse(attribute_type.to_json))\n  end\nend\n\nworkbook.close\n</code></pre>\n\n<p>I also tried this from PG admin but got expected result.</p>\n\n<pre><code>COPY (select * from information_schema.columns) TO '/home/sachin/ruby/profile_service/columns.csv' with delimiter ',' csv header;\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1552311296, "post_id": 55103004, "comment_id": 96948835, "body": "Yes, it&#39;s possible."}], "answers": [{"tags": [], "owner": {"reputation": 1280, "user_id": 8513648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c59086b9318c37cc02acaeb85fef8f6?s=128&d=identicon&r=PG", "display_name": "J-L", "link": "https://stackoverflow.com/users/8513648/j-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1554132931, "creation_date": 1554132931, "answer_id": 55458796, "question_id": 55103004, "link": "https://stackoverflow.com/questions/55103004/how-to-insert-value-from-an-array-into-an-other-array-in-ruby/55458796#55458796", "title": "How to insert value from an array into an other array in Ruby?", "body": "<p>It looks like you want to <code>zip</code> the arrays together.  Doing this:</p>\n\n<pre><code>a = [1, 2, 3, 4]\nb = [111, 222, 333, 444]\nc = a.zip(b)\n</code></pre>\n\n<p>will set <code>c</code> to:</p>\n\n<pre><code>[[1, 111], [2, 222], [3, 333], [4, 444]]\n</code></pre>\n\n<p>which is <em>almost</em> what you want, but you probably don't want the nested arrays.  To get rid of the nested arrays, just call <code>flatten</code>:</p>\n\n<pre><code>c = a.zip(b).flatten()\n</code></pre>\n\n<p>Now <code>c</code> is set to:</p>\n\n<pre><code>[1, 111, 2, 222, 3, 333, 4, 444]\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 5895163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313a66c26f44cd04a91c34690613192a?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/5895163/benjamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 55458796, "answer_count": 1, "score": -1, "last_activity_date": 1554132931, "creation_date": 1552311178, "last_edit_date": 1554132603, "question_id": 55103004, "link": "https://stackoverflow.com/questions/55103004/how-to-insert-value-from-an-array-into-an-other-array-in-ruby", "title": "How to insert value from an array into an other array in Ruby?", "body": "<p>I have two arrays:</p>\n\n<pre><code>a = [a_first_element, a_second_element, a_third_element, a_fourth_element]\nb = [b_first_element, b_second_element, b_third_element, b_fourth_element]\n</code></pre>\n\n<p>I would like to insert in the first array, at even positions, elements of the second array.</p>\n\n<p>So the final array shoud look like :</p>\n\n<pre><code>[a_first_element, b_first_element, a_second_element, b_second_element, a_third_element,b_third_element, etc]\n</code></pre>\n\n<p>The arrays are made of the same number of items (around 30)</p>\n\n<p>How could I do that ?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1552311680, "post_id": 55102857, "comment_id": 96949094, "body": "At first glance I only saw the hash which looked perfectly fine ;-)"}, {"owner": {"reputation": 67, "user_id": 11127396, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FMSsbyWTmLk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVZbUWrz5PMNjt9bA8BxRpUrEOfA/mo/photo.jpg?sz=128", "display_name": "Zubair Maqsood", "link": "https://stackoverflow.com/users/11127396/zubair-maqsood"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1552312206, "post_id": 55102857, "comment_id": 96949467, "body": "the hash is fine, i just don&#39;t know where i am going wrong with my methods"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1552313393, "post_id": 55102857, "comment_id": 96950256, "body": "I will answer this tomorrow but it can be more compact."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1552313473, "post_id": 55102857, "comment_id": 96950311, "body": "Try <code>def get_information(data, required, season=nil, hash= {})</code> &amp; call it like <code>get_information(thebachelor, &#39;name&#39;, &quot;season 29&quot;, status: &#39;winner&#39;)</code>. This will work for all these methods. Later you can calll basic methods like for average &amp; count, add condiions and think how it will work."}, {"owner": {"reputation": 67, "user_id": 11127396, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FMSsbyWTmLk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVZbUWrz5PMNjt9bA8BxRpUrEOfA/mo/photo.jpg?sz=128", "display_name": "Zubair Maqsood", "link": "https://stackoverflow.com/users/11127396/zubair-maqsood"}, "edited": false, "score": 0, "creation_date": 1552314661, "post_id": 55102857, "comment_id": 96951042, "body": "It doesn&#39;t work, if you could explain it in which it includes iterating through, it would be easier to understand"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1552372332, "post_id": 55102857, "comment_id": 96972435, "body": "@ZubairMaqsood You do not need several methods which do same operation over again and again with change of cases/conditions. Check my answer which generalised &amp; optimised for  all your required cases. Little modification you can do as per your need."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 11127396, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FMSsbyWTmLk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVZbUWrz5PMNjt9bA8BxRpUrEOfA/mo/photo.jpg?sz=128", "display_name": "Zubair Maqsood", "link": "https://stackoverflow.com/users/11127396/zubair-maqsood"}, "edited": false, "score": 0, "creation_date": 1552325159, "post_id": 55106937, "comment_id": 96957574, "body": "Dude, thanks man, I have been struggling on this for a couple hours now!"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 67, "user_id": 11127396, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FMSsbyWTmLk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVZbUWrz5PMNjt9bA8BxRpUrEOfA/mo/photo.jpg?sz=128", "display_name": "Zubair Maqsood", "link": "https://stackoverflow.com/users/11127396/zubair-maqsood"}, "edited": false, "score": 0, "creation_date": 1552325646, "post_id": 55106937, "comment_id": 96957841, "body": "You&#39;re welcome @ZubairMaqsood - glad to have helped out! If it&#39;s got you where you need to be, please accept the answer by clicking the tick to its left. Shout if you have any other questions or anything."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1552373649, "post_id": 55106937, "comment_id": 96972928, "body": "@SRack this works with less code &amp; iterations +1, I did (provided in my answer) little different where I preferred single method to do all these operations. It can be used in more than these 4 cases/methods"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 1, "last_activity_date": 1552324396, "last_edit_date": 1552324396, "creation_date": 1552323946, "answer_id": 55106937, "question_id": 55102857, "link": "https://stackoverflow.com/questions/55102857/improvements-in-code-having-iteration-of-nested-hashes-and-arrays-of-input/55106937#55106937", "title": "Improvements in code having iteration of nested hashes and arrays of input", "body": "<p>I think a big problem comes from the data you're passing in. Take for example, a working solution for your final issue.</p>\n\n<p>To get the data for a single season, you can use:</p>\n\n<pre><code>def average_age_for(data, season)\n  contestants = data[season]\n  contestants.sum { |contestant| contestant[:age].to_f } / contestants.count\nend\n\naverage_age_for(thebatchelor, :\"season 30\")\n#=&gt; 26.5\n</code></pre>\n\n<p>Note that you need to pass <code>:\"season 30\"</code>, rather than simply <code>\"season 30\"</code>. That's because your data is is using symbolised strings as keys, rather than just strings.</p>\n\n<p>Replace your data's keys with strings:</p>\n\n<pre><code>thebachelor = { \n  \"season 30\" =&gt; [\n    {\n      \"name\" =&gt;      \"Beth Smalls\",\n      \"age\" =&gt;       \"26\",\n      \"hometown\" =&gt;  \"Great Falls, Virginia\",\n      \"occupation\" =&gt; \"Nanny/Freelance Journalist\",\n      \"status\" =&gt;    \"Winner\"\n    },\n    {\n      \"name\" =&gt;       \"Becca Tilley\",\n      \"age\" =&gt;        \"27\",\n      \"hometown\" =&gt;   \"Shreveport, Louisiana\",\n      \"occupation\" =&gt; \"Chiropractic Assistant\",\n      \"status\" =&gt;     \"Eliminated Week 8\"\n    }\n  ],\n  \"season 29\" =&gt; [\n    {\n      \"name\" =&gt;      \"Ashley Yeats\",\n      \"age\" =&gt;       \"24\",\n      \"hometown\" =&gt;  \"Denver, Colorado\",\n      \"occupation\" =&gt; \"Dental Assitant\",\n      \"status\" =&gt;    \"Winner\"\n    },\n    {\n      \"name\" =&gt;       \"Sam Grover\",\n      \"age\" =&gt;        \"29\",\n      \"hometown\" =&gt;   \"New York, New York\",\n      \"occupation\" =&gt; \"Entertainer\",\n      \"status\" =&gt;     \"Eliminated Week 6\"\n    }\n  ]\n}\n</code></pre>\n\n<p>Then look for a string in the method:</p>\n\n<pre><code>def average_age_for(data, season)\n  contestants = data[season]\n  #                                        vvvvvvv\n  contestants.sum { |contestant| contestant[\"age\"].to_f } / contestants.count\n  #                                        ^^^^^^^\nend\n</code></pre>\n\n<p>And this takes shape.</p>\n\n<hr>\n\n<p>You can then do:</p>\n\n<p>1)</p>\n\n<pre><code>def get_first_name_of_season_winner(data, season)\n  data[season].detect { |contestant| contestant[\"status\"] == \"Winner\" }[\"name\"].split.first\nend\n\nget_first_name_of_season_winner(thebachelor, \"season 29\")\n#=&gt; \"Ashley\"\n</code></pre>\n\n<p>2)</p>\n\n<pre><code>def get_contestant_name(data, occupation)\n  data.values.flatten.detect { |contestant| contestant[\"occupation\"] == occupation }\nend\n\nget_contestant_name(thebachelor, \"Chiropractic Assistant\")\n#=&gt; {\"name\"=&gt;\"Becca Tilley\", \"age\"=&gt;\"27\", \"hometown\"=&gt;\"Shreveport, Louisiana\", \"occupation\"=&gt;\"Chiropractic Assistant\", \"status\"=&gt;\"Eliminated Week 8\"}\n</code></pre>\n\n<p>3)</p>\n\n<pre><code>def count_contestant_by_hometown(data, town)\n  data.values.flatten.select { |contestant| contestant[\"hometown\"] == town }.count\nend\n\ncount_contestant_by_hometown(thebachelor, \"New York, New York\")\n#=&gt; 1\n</code></pre>\n\n<p>4)</p>\n\n<pre><code>def get_occupation(data, hometown)\n  data.values.flatten.detect { |contestant| contestant[\"hometown\"] == hometown }[\"occupation\"]\nend\n\nget_occupation(thebachelor, \"New York, New York\")\n#=&gt; \"Entertainer\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1552325767, "post_id": 55107297, "comment_id": 96957900, "body": "Don&#39;t think <code>symbolize_keys</code> is available in Ruby? No Rails tag here - stopped me from doing something similar. Edit: nice answer btw :)"}, {"owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1552325823, "post_id": 55107297, "comment_id": 96957927, "body": "True but ruby has <code>transform_keys</code>. I will update the answer to use it instead."}, {"owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1552325926, "post_id": 55107297, "comment_id": 96957981, "body": "Actually the original data was already in symbols, but whatever. In the end this is a typical &quot;how do I solve the exercise?&quot;"}, {"owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1552325974, "post_id": 55107297, "comment_id": 96957997, "body": "btw sorry @SRack for almost-duplicating your answer, I was not aware of it while writing mine..."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1552326630, "post_id": 55107297, "comment_id": 96958328, "body": "Not a problem at all - I like the approach, and there&#39;s definitely sufficent difference for it to stand alone. Clarification much appreciated regardless."}], "tags": [], "owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "is_accepted": false, "score": -1, "last_activity_date": 1552325859, "last_edit_date": 1552325859, "creation_date": 1552325220, "answer_id": 55107297, "question_id": 55102857, "link": "https://stackoverflow.com/questions/55102857/improvements-in-code-having-iteration-of-nested-hashes-and-arrays-of-input/55107297#55107297", "title": "Improvements in code having iteration of nested hashes and arrays of input", "body": "<p>First, I would reformat your data so it's easy to select/detect:</p>\n\n<pre><code>data = data.map { |key, value| value.transform_keys(&amp;:to_sym).merge(season: key) }\n</code></pre>\n\n<p>so now it looks like</p>\n\n<pre><code>[{\n  season:    \"season 30\",\n  name:      \"Beth Smalls\",\n  age:       \"26\",\n  hometown:  \"Great Falls, Virginia\",\n  occupation: \"Nanny/Freelance Journalist\",\n  status:    \"Winner\"\n},...\n]\n</code></pre>\n\n<p>Now it's much easier to filter and detect:</p>\n\n<pre><code>def get_first_name_of_season_winner(data, season)\n  p = -&gt;(v) { v[:season] == season &amp;&amp; v[:status] == 'Winner' }\n  data.detect(&amp;p)[:name][/\\w+/]\nend\n\ndef get_contestant_name(data, occupation)\n  p = -&gt;(v) { v[:occupation] == occupation }\n  data.detect(&amp;p)[:name]\nend\n\ndef count_contestant_by_hometown(data, hometown)\n  p = -&gt;(v) { v[:hometown] = hometown }\n  data.select(&amp;p).count\nend\n\ndef get_occupation(data, hometown)\n  p = -&gt;(v) { v[:hometown] = hometown }\n  data.detect(&amp;p)[:occupation]\nend\n\ndef average_age_for_season(data, season)\n  p = -&gt;(v) { v[:season] = season }\n  ages = data.select(&amp;p).map { |datum| datum[:age] }\n  ages.sum.fdiv(ages.count) unless ages.empty?\nend\n</code></pre>\n\n<p>In general, all these problems are of two types:\n1. Given an array of data, find all the items that satisfy a certain condition\n2. Given an array of data, find the first item that satisfies a certain condition</p>\n\n<p>And you always solve them with select/detect and a block/proc.</p>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1552372218, "creation_date": 1552372218, "answer_id": 55115391, "question_id": 55102857, "link": "https://stackoverflow.com/questions/55102857/improvements-in-code-having-iteration-of-nested-hashes-and-arrays-of-input/55115391#55115391", "title": "Improvements in code having iteration of nested hashes and arrays of input", "body": "<p><strong>Generalised &amp;&amp; Optimised Solution</strong>:</p>\n\n<p>Following method will work to get whatever you need from your hash <code>thebachelor</code>,</p>\n\n<pre><code>def get_information(data, required, season, optional, hash= {})\n  data = season.nil? ? data.values.flatten : data[season]\n  selected = data.select { |x| (hash.inject(true) { |m, (k,v)| m &amp;&amp;= (x[k] == v) }) }\n  required_data = selected.map { |x| x[required] }\n  if optional == :average &amp;&amp; required == :age\n    (required_data.map(&amp;:to_i).sum / required_data.count.to_f).round(2)\n  else\n    (optional == :count) ? required_data.count : required_data\n  end\nend\n</code></pre>\n\n<p>Data need to be provided as below,</p>\n\n<ol>\n<li>data -  hash input from which you want to retrieve data</li>\n<li>required - output inner hash attribute you want in output.</li>\n<li>season - If you want to retrieve data season specific, provide season, else nil to get from all season.</li>\n<li>Optional - It can be set nil, unless you want count or average. Otherwise pass <code>:count</code> or <code>:average</code> as optional argument.</li>\n<li>hash - filter option. If you want to filter inner data by attributes like <code>:hometown</code> or <code>:status</code> or <code>:occupation</code>. Just provide it. otherwise it will set empty hash.</li>\n</ol>\n\n<p>See examples below,</p>\n\n<pre><code># Get name of season winner for season 'season 29'\nget_information(thebachelor, :name, :'season 29', nil, status: 'Winner')\n# =&gt; [\"Ashley Yeats\"]\n\n# Get name of all winners irrespective of season\nget_information(thebachelor, :name, nil, nil, status: 'Winner')\n# =&gt; [\"Beth Smalls\", \"Ashley Yeats\"]\n\n# Get contestant name for occupation \"Chiropractic Assistant\"\nget_information(thebachelor, :name, nil, nil, occupation: \"Chiropractic Assistant\")\n# =&gt; [\"Becca Tilley\"]\n\n# Count contestant by home town \"Denver, Colorado\"\nget_information(thebachelor, :name, nil, :count, hometown: \"Denver, Colorado\")\n# =&gt; 1\n\n# Get occupation of contestant who hails from hometown \"Denver, Colorado\"\nget_information(thebachelor, :occupation, nil, nil, hometown: \"Denver, Colorado\")\n# =&gt; [\"Dental Assitant\"]\n\n# Get Average age for season :\"season 29\"\nget_information(thebachelor, :age, :\"season 29\", :average)\n# =&gt; 26.5\n</code></pre>\n\n<p>This method provide moreover than you asked in your question.</p>\n"}], "owner": {"reputation": 67, "user_id": 11127396, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FMSsbyWTmLk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVZbUWrz5PMNjt9bA8BxRpUrEOfA/mo/photo.jpg?sz=128", "display_name": "Zubair Maqsood", "link": "https://stackoverflow.com/users/11127396/zubair-maqsood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 55106937, "answer_count": 3, "score": 1, "last_activity_date": 1552372218, "creation_date": 1552310702, "last_edit_date": 1552372196, "question_id": 55102857, "link": "https://stackoverflow.com/questions/55102857/improvements-in-code-having-iteration-of-nested-hashes-and-arrays-of-input", "title": "Improvements in code having iteration of nested hashes and arrays of input", "body": "<p>I could use any improvements to improve my code. I think most of the method have the same layout but I am not getting the desired output, so any help would be great. If you want to see the exercise online, its called the Bachelor Nested Iteration. I really have no clue why I am not getting my desired output, to me my working out makes sense I guess.</p>\n\n<p>for the <strong>get_first_name_of_season_winner</strong> method, no matter what arguments I pass through when I call it, I always get \"Beth Smalls\" as an output when it shouldn't be the case. If I pass \"Season 29\", the output should be <em>\"Ashley Yeats\"</em></p>\n\n<p>for the <strong>get_contestant_name</strong> method, it's the same thing. It always returns <em>\"Beth Smalls\"</em> no matter what occupation I pass through. For example if I call it like this</p>\n\n<pre><code>get_contestant_name(thebachelor, \"Chiropractic Assistant\" )\n</code></pre>\n\n<p>it should return <em>\"Becca Tilley\"</em> as an output but it doesn't.</p>\n\n<p>for the <strong>count_contestant_by_hometown</strong>, it should return the number of contestants which are from the hometown thats passed in the method, however, no matter which argument I pass, I get the number 4 as an output.</p>\n\n<p>for the <strong>get_occupation</strong>, it should return the name of the person corresponding to the hometown being passed in the method, but I always get <em>\"Beth Smalls\"</em> no matter which hometown I pass through it.</p>\n\n<p>The final method, I have no idea how to do it. It takes in two arguments\u2013\u2013the data hash and a string of a season. Iterate through the hash and return the average age of all of the contestants for that season. </p>\n\n<pre><code>thebachelor = { \n  \"season 30\": [\n    {\n      \"name\":      \"Beth Smalls\",\n      \"age\":       \"26\",\n      \"hometown\":  \"Great Falls, Virginia\",\n      \"occupation\": \"Nanny/Freelance Journalist\",\n      \"status\":    \"Winner\"\n    },\n    {\n      \"name\":       \"Becca Tilley\",\n      \"age\":        \"27\",\n      \"hometown\":   \"Shreveport, Louisiana\",\n      \"occupation\": \"Chiropractic Assistant\",\n      \"status\":     \"Eliminated Week 8\"\n    }\n  ],\n  \"season 29\": [\n    {\n      \"name\":      \"Ashley Yeats\",\n      \"age\":       \"24\",\n      \"hometown\":  \"Denver, Colorado\",\n      \"occupation\": \"Dental Assitant\",\n      \"status\":    \"Winner\"\n    },\n    {\n      \"name\":       \"Sam Grover\",\n      \"age\":        \"29\",\n      \"hometown\":   \"New York, New York\",\n      \"occupation\": \"Entertainer\",\n      \"status\":     \"Eliminated Week 6\"\n    }\n  ]\n}\n</code></pre>\n\n<p>Now the methods. <code>get_first_name_of_season_winner</code> is</p>\n\n<pre><code>def get_first_name_of_season_winner(data, season)\n\n    #this method returns the first name of that seasons winner\n    #pass the season of the show, and then it returns only th FIRST NAME of the winner for that season\n    #iterate through the inital hash to access the season number\n    #then iterate through the array, to access the hash inside\n    #acess the \"status\" to get the output\n  data.each do |season, contestant_Data|\n    contestant_Data.each do |a|\n      a.each do |attribute, value|\n        if value == \"Winner\"\n          return a[:name]\n        end\n      end \n    end\n  end\nend\n\nget_first_name_of_season_winner(thebachelor, \"season 29\") #returns the full name of only \"Beth Smalls\"\n</code></pre>\n\n<p><code>get_contestant_name</code> is:</p>\n\n<pre><code>def get_contestant_name(data, occupation) #this method takes in the data hash and an occupation string and returns the name of the woman who has that occupation\n\n    #iterate through the initial hash to access the seasons\n    #iterate through the seasons to access the arrays inside\n    #access the occupation element of the array\n    #return the person who has the occupation\n\n    data.each do |season, contestant_data|\n        contestant_data.each do |a|\n            a.each do |attribute, value|\n                if attribute == :occupation\n                    return a[:name]\n                end \n            end \n        end \n    end\nend\n\nget_contestant_name(thebachelor, \"Chiropractic Assistant\" ) #returns the full name of only \"Beth Smalls\"\n</code></pre>\n\n<p><code>count_contestant_by_hometown</code> is:</p>\n\n<pre><code>def count_contestant_by_hometown(data, hometown) #this method should return the number of contestants from the hometown passed\n    #include a counter variable\n    #iterate through the hash to access the seasons\n    #access the array \n    #access the hometown key in the hash\n    #keep count\n\n    counter = 0 \n    data.each do |season, contestant_data|\n        contestant_data.each do |a|\n            a.each do |attribute, value|\n                if attribute == :hometown\n                    counter += 1\n                end\n            end \n        end \n    end \n\n    return counter\nend \ncount_contestant_by_hometown(thebachelor, \"Denver, Colorado\") #returns the number 4, I have no idea why\n</code></pre>\n\n<p><code>get_occupation</code> is:     </p>\n\n<pre><code>def get_occupation(data, hometown) #should return the occupation of of the first contestant who hails from the hometown\n\n    data.each do |season, contestant_data|\n        contestant_data.each do |a|\n            a.each do |attribute, value|\n                if attribute == :hometown\n                    return a[:name]\n                end \n            end \n        end \n    end\n\nend \nget_occupation(thebachelor, \"Denver, Colorado\") #returns \"Beth Smalls\" when it should return \"Ashley Yeats\"\n</code></pre>\n\n<p><code>average_age_for_season</code> is:     </p>\n\n<pre><code>def average_age_for_season(data, season) #returns the average age of all contestants for that season\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1552312011, "post_id": 55102576, "comment_id": 96949341, "body": "Not anything I am aware of, but you might <code>File#read</code>, then <code>String#encode</code> with a fallback and then <code>CSV#read</code> this string."}, {"owner": {"reputation": 1118, "user_id": 5313498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46f1c8a8d37e14f7c19a7893d0df03ad?s=128&d=identicon&r=PG&f=1", "display_name": "JL M", "link": "https://stackoverflow.com/users/5313498/jl-m"}, "edited": false, "score": 0, "creation_date": 1560199696, "post_id": 55102576, "comment_id": 99649860, "body": "May be you could find some help with the answer given <a href=\"https://stackoverflow.com/questions/11733076/how-do-i-robustly-parse-malformed-csv/12772298#12772298\">here</a>"}], "owner": {"reputation": 3859, "user_id": 447458, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/3856ab1ebfb234877daa2092ed0525a2?s=128&d=identicon&r=PG", "display_name": "Fernando", "link": "https://stackoverflow.com/users/447458/fernando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1552309790, "creation_date": 1552309790, "question_id": 55102576, "link": "https://stackoverflow.com/questions/55102576/ruby-csv-open-with-encoding-fallback-option", "title": "Ruby: CSV.open with encoding fallback option", "body": "<p>When opening a CSV file in Ruby with CSV.open, is there a way to set encoding fallback similar to how it's set in String.encode?</p>\n\n<p>Example:</p>\n\n<pre><code>CSV.open('file.csv', encoding: 'windows-1252:utf-8')\n</code></pre>\n\n<p>I would like to set something like this:</p>\n\n<pre><code>CSV.open('file.csv', encoding: 'windows-1252:utf-8', fallback: {\n  \"\\u0080\" =&gt; \"\\x80\",\n  \"\\u0081\" =&gt; \"\\x81\"\n})\n</code></pre>\n\n<p>I couldn't find this in the docs, but maybe it's hidden somewhere.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 394, "user_id": 2754650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb1aa8108f6fffc8ab2835e33cb01fa9?s=128&d=identicon&r=PG&f=1", "display_name": "JeanClaudeDaudin", "link": "https://stackoverflow.com/users/2754650/jeanclaudedaudin"}, "edited": false, "score": 0, "creation_date": 1552312408, "post_id": 55103131, "comment_id": 96949606, "body": "I need to iterate on multiple numbers n given in stdin, not on n given as an argument to my script"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 394, "user_id": 2754650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb1aa8108f6fffc8ab2835e33cb01fa9?s=128&d=identicon&r=PG&f=1", "display_name": "JeanClaudeDaudin", "link": "https://stackoverflow.com/users/2754650/jeanclaudedaudin"}, "edited": false, "score": 1, "creation_date": 1552312599, "post_id": 55103131, "comment_id": 96949733, "body": "Alright, then. As I wrote, the code you have does that. Cheers! (Of course, if you&#39;re doing that you may want to memoize the primes for performance, especially if your input has a known upper bound.)"}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 2, "last_activity_date": 1552312090, "last_edit_date": 1552312090, "creation_date": 1552311577, "answer_id": 55103131, "question_id": 55102538, "link": "https://stackoverflow.com/questions/55102538/how-to-get-a-short-nth-prime-number-code-in-ruby/55103131#55103131", "title": "how to get a short nth prime number code in ruby", "body": "<p>There are different (and arguably better) ways to get the n<sup>th</sup> prime in Ruby, but none that are much shorter. In the end there's no way to calculate the n<sup>th</sup> prime without counting the first n\u22121 primes, which I suppose is why Ruby makes you go through the motions. You can see some good solutions on the duplicate question linked above.</p>\n\n<p>As to your other question:</p>\n\n<blockquote>\n  <p>is there a shorter input?</p>\n</blockquote>\n\n<p>That depends on your use case. <code>$&lt;</code> is a special variable in Ruby; it's an alias for <a href=\"https://ruby-doc.org/core-2.6.1/ARGF.html\" rel=\"nofollow noreferrer\"><code>ARGF</code></a>, which does <em>a lot</em>. <code>$&lt;.each</code> will iterate all of the lines in the files given on the command line, so e.g.:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ cat a.txt\n1\n2\n3\n\n$ cat b.txt\n7\n88\n999\n\n$ ruby -r prime -e \"$&lt;.each{|x| p Prime.take(x.to_i).last }\" a.txt b.txt\n2\n3\n5\n17\n457\n7907\n</code></pre>\n\n<p>(If you don't give any file names, <code>ARGF</code> will try to read from STDIN.)</p>\n\n<p>I suspect you're trying to do something simpler, though.</p>\n\n<p>Are you just trying to print a single prime number given a single input? In that case, you could do this:</p>\n\n<pre><code>require \"prime\"\nn = STDIN.each_line.first.to_i\np Prime.take(n).last\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ echo 999 | ruby script.rb\n7907\n</code></pre>\n\n<p>It might be nicer, though, to take input as a command line argument. In that case you can use <code>ARGV</code> (alias <code>$*</code>), which is an array of the command line arguments:</p>\n\n<pre><code>require \"prime\"\nn = ARGV[0].to_i\np Prime.take(n).last\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ ruby script.rb 999\n7907\n</code></pre>\n"}], "owner": {"reputation": 394, "user_id": 2754650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb1aa8108f6fffc8ab2835e33cb01fa9?s=128&d=identicon&r=PG&f=1", "display_name": "JeanClaudeDaudin", "link": "https://stackoverflow.com/users/2754650/jeanclaudedaudin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "closed_date": 1552312138, "answer_count": 1, "score": 0, "last_activity_date": 1552312090, "creation_date": 1552309672, "last_edit_date": 1552309767, "question_id": 55102538, "link": "https://stackoverflow.com/questions/55102538/how-to-get-a-short-nth-prime-number-code-in-ruby", "closed_reason": "Duplicate", "title": "how to get a short nth prime number code in ruby", "body": "<p>I have the following code that runs in ruby:</p>\n\n<pre><code>require'prime'\n$&lt;.each{|x|p Prime.take(x.to_i).last}\n</code></pre>\n\n<p>but I want a shorter code.\nI've tried to use get_nth_prime() but I don't find the right syntax.\nAlso is there a shorter input? </p>\n"}, {"tags": ["arrays", "ruby", "string"], "comments": [{"owner": {"reputation": 1, "user_id": 11184959, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nav9UXEo19o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd6y0qPixUr8QQE1lj0QwymYkG_1w/mo/photo.jpg?sz=128", "display_name": "Xa1n", "link": "https://stackoverflow.com/users/11184959/xa1n"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552309060, "post_id": 55102241, "comment_id": 96947433, "body": "How would I replace the words in &#39;test_tweets&#39; that match &#39;banned_phrases&#39; with &quot;CENSORED&quot;?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552309116, "post_id": 55102241, "comment_id": 96947461, "body": "Do you want to filter, and then replace? Filtering means to remove, which makes replacing not make sense."}, {"owner": {"reputation": 1, "user_id": 11184959, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nav9UXEo19o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd6y0qPixUr8QQE1lj0QwymYkG_1w/mo/photo.jpg?sz=128", "display_name": "Xa1n", "link": "https://stackoverflow.com/users/11184959/xa1n"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552309189, "post_id": 55102241, "comment_id": 96947491, "body": "sorry, I just mean replace"}], "answers": [{"tags": [], "owner": {"reputation": 655, "user_id": 9629768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YocKJ.jpg?s=128&g=1", "display_name": "GBrandt", "link": "https://stackoverflow.com/users/9629768/gbrandt"}, "is_accepted": true, "score": 0, "last_activity_date": 1552309035, "creation_date": 1552309035, "answer_id": 55102341, "question_id": 55102241, "link": "https://stackoverflow.com/questions/55102241/checking-substrings-in-array-and-replacing-them-in-ruby/55102341#55102341", "title": "Checking substrings in array and replacing them in ruby", "body": "<p>Try <code>map</code> + <code>inject</code>:</p>\n\n<pre><code>filtered = test_tweets.map do |tweet|\n  banned_phrases.inject(tweet) do |r, phrase|\n    r.gsub phrase, 'CENSORED'\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": -1, "last_activity_date": 1552309486, "creation_date": 1552309486, "answer_id": 55102486, "question_id": 55102241, "link": "https://stackoverflow.com/questions/55102241/checking-substrings-in-array-and-replacing-them-in-ruby/55102486#55102486", "title": "Checking substrings in array and replacing them in ruby", "body": "<pre><code>re = Regexp.union(banned_phrases)\n# =&gt; /sucks|bad|hate|foolish|danger\\ to\\ society/\ntest_tweets.map{|s| s.gsub(re, \"CENSORED\")}\n</code></pre>\n\n<p>The outputs is:</p>\n\n<pre><code>[\n  \"This politician CENSORED!\",\n  \"I CENSORED this Government!\",\n  \"I can't believe we're living with such a CENSORED politician. We were so CENSORED\",\n  \"Politicianname is a CENSORED. I CENSORED that he's so CENSORED \u2013 it CENSORED.\"\n]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11184959, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nav9UXEo19o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd6y0qPixUr8QQE1lj0QwymYkG_1w/mo/photo.jpg?sz=128", "display_name": "Xa1n", "link": "https://stackoverflow.com/users/11184959/xa1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 55102341, "answer_count": 2, "score": -4, "last_activity_date": 1552309486, "creation_date": 1552308665, "last_edit_date": 1552309216, "question_id": 55102241, "link": "https://stackoverflow.com/questions/55102241/checking-substrings-in-array-and-replacing-them-in-ruby", "title": "Checking substrings in array and replacing them in ruby", "body": "<p>I'm asked to write a program that replaces words in the array <code>test_tweets</code> that match words in the <code>banned_phrases</code> array with <code>\"CENSORED\"</code>.</p>\n\n<pre><code>test_tweets = [\n  \"This politician sucks!\",\n  \"I hate this Government!\",\n  \"I can't believe we're living with such a bad politician. We were so foolish\",\n  \"Politicianname is a danger to society. I hate that he's so bad \u2013 it sucks.\"\n  ]\n\nbanned_phrases = [\"sucks\", \"bad\", \"hate\", \"foolish\", \"danger to society\"]\n</code></pre>\n\n<p>I can't figure out what method achieves this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf", "pdf-generation", "wicked-pdf"], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 7897936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d6574f91a7bbf5dd21db403d38df2a?s=128&d=identicon&r=PG&f=1", "display_name": "joaolell", "link": "https://stackoverflow.com/users/7897936/joaolell"}, "edited": false, "score": 0, "creation_date": 1552310234, "post_id": 55102014, "comment_id": 96948139, "body": "My PDF&#39;s are generated dinamically, will that be a problem when using PDFtk? Since the contents in my PDF change from each user."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 315, "user_id": 7897936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d6574f91a7bbf5dd21db403d38df2a?s=128&d=identicon&r=PG&f=1", "display_name": "joaolell", "link": "https://stackoverflow.com/users/7897936/joaolell"}, "edited": false, "score": 0, "creation_date": 1552310337, "post_id": 55102014, "comment_id": 96948196, "body": "You can apply PDFtk each time."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 315, "user_id": 7897936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d6574f91a7bbf5dd21db403d38df2a?s=128&d=identicon&r=PG&f=1", "display_name": "joaolell", "link": "https://stackoverflow.com/users/7897936/joaolell"}, "edited": false, "score": 0, "creation_date": 1552310510, "post_id": 55102014, "comment_id": 96948297, "body": "Take a look at its syntax and see if you can handle that, it you are interested. It is capable of combining multiple files."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1552307904, "creation_date": 1552307904, "answer_id": 55102014, "question_id": 55101912, "link": "https://stackoverflow.com/questions/55101912/how-can-i-merge-all-pdf-in-one-file-with-wickedpdf/55102014#55102014", "title": "How can I merge all PDF in one file with wickedpdf?", "body": "<p>Try <a href=\"https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/\" rel=\"nofollow noreferrer\">PDFtk</a>. In my opinon, it is the best library for editing PDF files, and there are some gems that wraps it for access from Ruby.</p>\n"}, {"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1552315113, "creation_date": 1552315113, "answer_id": 55104309, "question_id": 55101912, "link": "https://stackoverflow.com/questions/55101912/how-can-i-merge-all-pdf-in-one-file-with-wickedpdf/55104309#55104309", "title": "How can I merge all PDF in one file with wickedpdf?", "body": "<p>I use <a href=\"https://github.com/boazsegev/combine_pdf\" rel=\"nofollow noreferrer\"><code>combine_pdf gem</code></a>. </p>\n\n<blockquote>\n  <p>To combine PDF files:</p>\n</blockquote>\n\n<pre><code>pdf = CombinePDF.new\npdf &lt;&lt; CombinePDF.load(\"file1.pdf\") # one way to combine, very fast.\npdf &lt;&lt; CombinePDF.load(\"file2.pdf\")\npdf.save \"combined.pdf\"\n</code></pre>\n\n<blockquote>\n  <p>You can also parse PDF files from memory. Loading from the memory is\n  especially effective for importing PDF data recieved through the\n  internet or from a different authoring library such as Prawn:</p>\n</blockquote>\n\n<pre><code>pdf_data = prawn_pdf_document.render # Import PDF data from Prawn\npdf = CombinePDF.parse(pdf_data)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1617216173, "post_id": 55111302, "comment_id": 118245578, "body": "hi @Unixmonkey I have a service object rendering a PDF. It basically passes a <code>render_to_string</code> object back to where it is called. I have tried to implement your solution to composite PDFs. Had to replace <code>WickedPdfTempfile</code> by <code>WickedPdf::WickedPdfTempfile</code> for my service object to return something. But it is delivering code in another format. (I just see a massive string instead of the PDF data) Any idea what is wrong ?"}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1617216901, "post_id": 55111302, "comment_id": 118245898, "body": "(Also some PDF to be composited are actually images scanned into PDF format, maybe this is the problem)"}, {"owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "reply_to_user": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 1, "creation_date": 1617223753, "post_id": 55111302, "comment_id": 118248374, "body": "@Maxence It sounds like the massive string is the PDF in String form (it starts with &#39;%PDF&#39; and ends with &#39;%EOF&#39;). To transform it to a real pdf, you need to either send it with a browser with the mime type of <code>application&#47;pdf</code> (which <code>send_data</code> does above), or you need to write the file to disk (or temporary file, or IO string) in binary mode. To not derail this answer, please open a new question and tag me in a comment, or open an issue on the Wicked PDF GitHub page if you need more help."}], "tags": [], "owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "is_accepted": false, "score": 1, "last_activity_date": 1552343031, "creation_date": 1552343031, "answer_id": 55111302, "question_id": 55101912, "link": "https://stackoverflow.com/questions/55101912/how-can-i-merge-all-pdf-in-one-file-with-wickedpdf/55111302#55111302", "title": "How can I merge all PDF in one file with wickedpdf?", "body": "<p>If you want to use some tool like <code>PDFTk</code> or <code>CombinePDF</code>, all you should need to do is prerender your individual PDFs by using something like:</p>\n\n<pre><code>pdf1 = render_to_string(pdf: 'pdf1', template: 'pdf1')\npdf2 = render_to_string(pdf: 'pdf2', template: 'pdf2')\n</code></pre>\n\n<p>or</p>\n\n<pre><code>pdf1 = WickedPdf.new.pdf_from_string(some_html_string)\npdf2 = WickedPdf.new.pdf_from_string(another_html_string)\n</code></pre>\n\n<p>If those tools won't take a PDF as a string, you may need to write them to tempfiles first.</p>\n\n<p>If you don't want to introduce another dependency to merge things, <code>wkhtmltopdf</code> can take multiple pdf files (or urls), and render them all as one pdf with a command similar to this:</p>\n\n<pre><code>wkhtmltopdf tmp/tempfile1.html tmp/tempfile2.html tmp/output.pdf\n</code></pre>\n\n<p>Knowing this, you could prerender your templates, with layouts and everything, out to HTML strings, then pass them into wkhtmltopdf something like this:</p>\n\n<pre><code># app/models/concerns/multipage_pdf_renderer.rb\nrequire 'open3'\nclass MultipagePdfRenderer\n  def self.combine(documents)\n    outfile = WickedPdfTempfile.new('multipage_pdf_renderer.pdf')\n\n    tempfiles = documents.each_with_index.map do |doc, index|\n      file = WickedPdfTempfile.new(\"multipage_pdf_doc_#{index}.html\")\n      file.binmode\n      file.write(doc)\n      file.rewind\n      file\n    end\n\n    filepaths = tempfiles.map{ |tf| tf.path.to_s }\n\n    binary = WickedPdf.new.send(:find_wkhtmltopdf_binary_path)\n\n    command = [binary, '-q']\n    filepaths.each { |fp| command &lt;&lt; fp }\n    command &lt;&lt; outfile.path.to_s\n    err = Open3.popen3(*command) do |stdin, stdout, stderr|\n      stderr.read\n    end\n\n    raise \"Problem generating multipage pdf: #{err}\" if err.present?\n    return outfile.read\n  ensure\n    tempfiles.each(&amp;:close!)\n  end\nend\n</code></pre>\n\n<p>And call in your controller something like this:</p>\n\n<pre><code>def fancy_report\n  respond_to do |format|\n    format.pdf do\n      doc1 = render_to_string(template: 'pages/_page1')\n      doc2 = render_to_string(template: 'pages/_page2')\n      pdf_file = MultipagePdfRenderer.combine([doc1, doc2])\n      send_data pdf_file, type: 'application/pdf', disposition: 'inline'\n    end\n  end\nend\n</code></pre>\n\n<p>However, this only covers the simplest of cases, you'll have to do the work of rendering the headers and footers if you need them, parsing (or adding) any options you might need.</p>\n\n<p>This solution originally came from <a href=\"https://github.com/mileszs/wicked_pdf/issues/339\" rel=\"nofollow noreferrer\">https://github.com/mileszs/wicked_pdf/issues/339</a> so it may be helpful to look there for more details on this strategy.</p>\n"}], "owner": {"reputation": 315, "user_id": 7897936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d6574f91a7bbf5dd21db403d38df2a?s=128&d=identicon&r=PG&f=1", "display_name": "joaolell", "link": "https://stackoverflow.com/users/7897936/joaolell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1656, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1552343075, "creation_date": 1552307500, "last_edit_date": 1552343075, "question_id": 55101912, "link": "https://stackoverflow.com/questions/55101912/how-can-i-merge-all-pdf-in-one-file-with-wickedpdf", "title": "How can I merge all PDF in one file with wickedpdf?", "body": "<p>The way I'm working right now is I'm generating multiple pdf files and sending them all one at a time for the user to download, but the problem is sometimes they end up with too many files.</p>\n\n<p>How can I merge all pdfs in a single file before sending them to the user?  </p>\n"}, {"tags": ["ruby", "parameter-passing"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1552303439, "post_id": 55100724, "comment_id": 96944405, "body": "It tries to concatenate everything with <code>+</code> and for that, it requires the last one (<code>gets</code>) to be evaluated."}, {"owner": {"reputation": 69, "user_id": 9769402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Caleb Hyun", "link": "https://stackoverflow.com/users/9769402/caleb-hyun"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1552304190, "post_id": 55100724, "comment_id": 96944822, "body": "Thanks, Aleksei. So, what you meant was that unless gets is not evaluated, the cmd   would show nothing because it should be a complete statement by adding all three chunks of string. Am I right? just want to re-check."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1552304915, "post_id": 55100724, "comment_id": 96945220, "body": "Yes, that\u2019s correct. You might <code>puts &quot;please ...&quot;; puts &quot;your name is &quot; + gets;</code> to achieve the desired functionality."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1552305338, "post_id": 55100724, "comment_id": 96945425, "body": "No. Not &quot;unless gets is not evaluated&quot;, but &quot;unless gets is evaluated&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1552305216, "creation_date": 1552305216, "answer_id": 55101295, "question_id": 55100724, "link": "https://stackoverflow.com/questions/55100724/puts-method-in-ruby/55101295#55101295", "title": "Puts method in ruby", "body": "<p>Before <code>puts</code> is executed, its argument is evaluated. To do that, the two <code>+</code> methods are executed. In order for the second <code>+</code> to be executed, its argument <code>gets</code> must be evaluated first.</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1552307474, "creation_date": 1552307474, "answer_id": 55101905, "question_id": 55100724, "link": "https://stackoverflow.com/questions/55100724/puts-method-in-ruby/55101905#55101905", "title": "Puts method in ruby", "body": "<p>It becomes more obvious if you extract the parts into variables:</p>\n\n<pre><code>a = \"please enter your name\"\nb = \" your name is \"\nc = gets\n\nputs a + b + c\n</code></pre>\n\n<p>Apparently, <code>gets</code> is called before <code>puts</code>.</p>\n\n<p>To get the desired result, you could use two <code>puts</code> calls and store the input in a variable:</p>\n\n<pre><code>puts \"please enter your name\"\nname = gets.chomp\nputs \"your name is #{name}\"\n</code></pre>\n\n<p>Example session:</p>\n\n<pre><code>please enter your name\nCaleb\nyour name is Caleb\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 9769402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Caleb Hyun", "link": "https://stackoverflow.com/users/9769402/caleb-hyun"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "closed_date": 1552311606, "accepted_answer_id": 55101905, "answer_count": 2, "score": -3, "last_activity_date": 1552307474, "creation_date": 1552303248, "last_edit_date": 1552305386, "question_id": 55100724, "link": "https://stackoverflow.com/questions/55100724/puts-method-in-ruby", "closed_reason": "Not suitable for this site", "title": "Puts method in ruby", "body": "<p>When I executed this,</p>\n\n<pre><code>puts \"please enter your name\" + \" your name is \" + gets\n</code></pre>\n\n<p>the string statements inside of the quotation marks (<code>\"\"</code>) did not appear, but it directly showed the prompt (which is <code>gets</code>).</p>\n\n<p>What happened when I executed the code? I wonder why the string statement did not show up.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1552296122, "post_id": 55098575, "comment_id": 96940283, "body": "Read the message more carefully. It&#39;s about <code>app&#47;views&#47;private&#47;conversations&#47;_conversation.html.erb</code> file, not <code>conversations.html.erb</code>."}, {"owner": {"reputation": 19, "user_id": 10951436, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qHwOq23K94Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNRzX_Dhf4_rZJ_tGARVmX8ETj5JQ/mo/photo.jpg?sz=128", "display_name": "StanDev", "link": "https://stackoverflow.com/users/10951436/standev"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1552296594, "post_id": 55098575, "comment_id": 96940549, "body": "app/views/private/conversations/_conversation.html.erb"}, {"owner": {"reputation": 19, "user_id": 10951436, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qHwOq23K94Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNRzX_Dhf4_rZJ_tGARVmX8ETj5JQ/mo/photo.jpg?sz=128", "display_name": "StanDev", "link": "https://stackoverflow.com/users/10951436/standev"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1552296665, "post_id": 55098575, "comment_id": 96940586, "body": "That is the file that I have posted, the conversations.html.erb does not exist, it is a typo. The right file is _conversation.html.erb."}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 6, "last_activity_date": 1552297174, "creation_date": 1552297174, "answer_id": 55098928, "question_id": 55098575, "link": "https://stackoverflow.com/questions/55098575/syntax-error-unexpected-keyword-ensure-expecting/55098928#55098928", "title": "syntax error, unexpected keyword_ensure, expecting", "body": "<p>You forgot to close the tag</p>\n\n<pre><code> pc&lt;%= conversation.id&gt;\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10951436, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qHwOq23K94Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNRzX_Dhf4_rZJ_tGARVmX8ETj5JQ/mo/photo.jpg?sz=128", "display_name": "StanDev", "link": "https://stackoverflow.com/users/10951436/standev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "closed_date": 1552297649, "accepted_answer_id": 55098928, "answer_count": 1, "score": -2, "last_activity_date": 1552297174, "creation_date": 1552295886, "last_edit_date": 1552296879, "question_id": 55098575, "link": "https://stackoverflow.com/questions/55098575/syntax-error-unexpected-keyword-ensure-expecting", "closed_reason": "Not suitable for this site", "title": "syntax error, unexpected keyword_ensure, expecting", "body": "<p>I am getting this error when trying to send a message on my rails app. \nPlease help me get it right. The conversations.html.erb file does not have any line 36 and 38. Here is the  error:</p>\n\n<blockquote>\n  <p>syntax error, unexpected keyword_end, expecting ')'\n            end\n               ^):    app/views/private/conversations/_conversation.html.erb:36: syntax\n  error, unexpected keyword_ensure, expecting ')'\n  app/views/private/conversations/_conversation.html.erb:38: syntax\n  error, unexpected keyword_end, expecting ')'\n  app/views/private/conversations/_open.js.erb:10:in\n  <code>_app_views_private_conversations__open_js_erb___4089549709349058989_70036360651440'\n  app/views/assignments/show/contact_user/message_form/_success.js.erb:8:in\n  </code>_app_views_assignments_show_contact_user_message_form__success_js_erb__1046129379162570439_70036360658520'\n  app/controllers/private/conversations_controller.rb:18:in <code>block (2\n  levels) in create'\n  app/controllers/private/conversations_controller.rb:16:in</code>create'</p>\n</blockquote>\n\n<p>I have attached the controller and the _conversation.html.erb file.Any help offered shall be highly appreciated. Thank you</p>\n\n<pre><code>class Private::ConversationsController &lt; ApplicationController\n\n  def create\n    recipient_id = Assignment.find(params[:assignment_id]).user.id\n    @conversation = Private::Conversation.new(sender_id: current_user.id,\n      recipient_id: recipient_id)\n\n    if @conversation.save\n      Private::Message.create(user_id: current_user.id,\n        conversation_id: @conversation.id,\n        body: params[:message_body])\n\n      add_to_conversations unless already_added?\n      respond_to do |format|\n        format.js { render partial: 'assignments/show/contact_user/message_form/success'}\n      end\n\n    else\n      respond_to do |format|\n        format.js {render partial: 'assignments/show/contact_user/message_form/fail'}\n      end\n    end\n  end  \n\n  def close\n    @conversation_id = params[:id].to_i\n    session[:private_conversations].delete(@conversation_id)\n\n    respond_to do |format|\n      format.js\n    end\n  end\n\n  private\n\n  def add_to_conversations\n    session[:private_conversations] ||= []\n    session[:private_conversations] &lt;&lt; @conversation.id\n  end\n\n  def already_added?\n    session[:private_conversations].include?(@conversation.id)\n  end\nend\n</code></pre>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;% @recipient = private_conv_recipient(conversation) %&gt;\n&lt;% @is_messanger = false %&gt;\n\n&lt;li class=\"conversation-window\"\n  id=\"pc&lt;%= conversation.id&gt;\"\n  data-pconversation-user-name=\"&lt;%= @recipient.name %&gt;\"\n  data-turbolinks-permanent&gt;\n\n  &lt;div class=\"panel panel-default\" data-pconversation-id =\"&lt;%= conversation.id %&gt;\"&gt;\n    &lt;%= render 'private/conversations/conversation/heading', conversation: conversation %&gt;\n    &lt;!-- Conversation window's content --&gt;\n    &lt;div class=\"panel-body\"&gt;\n     &lt;%= render 'private/conversations/conversation/messages_list', conversation: conversation %&gt;\n     &lt;%= render 'private/conversations/conversation/new_message_form', conversation: conversation, user: user %&gt;\n   &lt;/div&gt;&lt;!-- panel-body --&gt;\n  &lt;/div&gt;\n&lt;/li&gt;&lt;!-- conversation-window --&gt;\n</code></pre>\n"}, {"tags": ["ruby", "literals", "complex-numbers"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1552296119, "post_id": 55097529, "comment_id": 96940280, "body": "BTW, <code>+</code> is actually called 3 times: (1) <code>3 + (0+2i)</code> delegates to Complex, (2) <code>(0+2i) + 3</code> which in turn calls (3) <code>0 + 3</code> to calculate the real part."}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552292733, "post_id": 55097778, "comment_id": 96938637, "body": "But the document <a href=\"https://ruby-doc.org/core-2.6/Complex.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.6/Complex.html</a> says that literals like <code>2+1i</code> can be used. Is this document inaccurate or misleading?"}, {"owner": {"reputation": 285, "user_id": 11016237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIjD9.png?s=128&g=1", "display_name": "Svetlin Simonyan", "link": "https://stackoverflow.com/users/11016237/svetlin-simonyan"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1552293112, "post_id": 55097778, "comment_id": 96938799, "body": "I think it&#39;s just a looser use of the term literal. Basically it does not matter what the intermediate steps Ruby does are if you get the complex value in the end. In any case you can use <code>2+1i</code> and it will behave as expected"}], "tags": [], "owner": {"reputation": 285, "user_id": 11016237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIjD9.png?s=128&g=1", "display_name": "Svetlin Simonyan", "link": "https://stackoverflow.com/users/11016237/svetlin-simonyan"}, "is_accepted": true, "score": 7, "last_activity_date": 1552292625, "creation_date": 1552292625, "answer_id": 55097778, "question_id": 55097529, "link": "https://stackoverflow.com/questions/55097529/complex-number-literal/55097778#55097778", "title": "Complex number literal", "body": "<p>Short answer: it doesn't. The way it works is that the <code>+</code> method of integer receives the imaginary unit and returns a <code>Complex</code>. So in terms of literals you have the usual integer and floating point literals as well as imaginary number literal (e.g. <code>2i</code>) and by combining them you can construct complex values.</p>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1552293567, "post_id": 55097896, "comment_id": 96938990, "body": "I was just doing something similar to confirm what Svetlin Simonyan has written. It looks like he is correct, as well as you. Thanks."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1552294066, "post_id": 55097896, "comment_id": 96939227, "body": "Running <code>ruby --dump=parsetree -e &#39;3+2i&#39;</code> also confirms that it&#39;s actually two literals and a method call."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 3, "last_activity_date": 1552293198, "creation_date": 1552293198, "answer_id": 55097896, "question_id": 55097529, "link": "https://stackoverflow.com/questions/55097529/complex-number-literal/55097896#55097896", "title": "Complex number literal", "body": "<p>I guess the documentation is misleading and what appears to be literal is really method call. I made an experiment that confirms this:</p>\n\n<pre><code>class Integer\n  alias old_plus +\n\n  def +(*args)\n    puts 'called with complex' if args.first.class == Complex\n    old_plus(*args)\n  end\nend\n\n8+3i\n# called with complex\n# =&gt; (8+3i)\n(9+2i)\n# called with complex\n# =&gt; (9+2i)\n</code></pre>\n"}], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 55097778, "answer_count": 2, "score": 4, "last_activity_date": 1552293198, "creation_date": 1552291568, "question_id": 55097529, "link": "https://stackoverflow.com/questions/55097529/complex-number-literal", "title": "Complex number literal", "body": "<p>A complex number can be written as a literal like this:</p>\n\n<pre><code>3 + 2i # =&gt; (3+2i)\n</code></pre>\n\n<p>How is this syntactically distinguished from the case where receiver integer <code>3</code> receives the method <code>+</code> with argument <code>2i</code> (which itself works as a literal for a complex number <code>(0+2i)</code>)?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "is_accepted": false, "score": 1, "last_activity_date": 1552293191, "creation_date": 1552293191, "answer_id": 55097893, "question_id": 55096900, "link": "https://stackoverflow.com/questions/55096900/how-to-define-method-serializer-in-rails-netflix-fast-jsonapi-in-rails/55097893#55097893", "title": "How to define method serializer in Rails netflix fast_jsonapi in Rails?", "body": "<p>From the readme of fast_jsonapi</p>\n\n<pre><code>class MovieSerializer\n  include FastJsonapi::ObjectSerializer\n\n  attributes :name, :year\n\n  attribute :name_with_year do |object|\n    \"#{object.name} (#{object.year})\"\n  end\nend\n</code></pre>\n\n<p>Extending on that you could do something like</p>\n\n<pre><code>class MovieSerializer\n  include FastJsonapi::ObjectSerializer\n\n  attributes :name, :year\n\n  attribute :name_with_year do |object|\n    foo(object)\n  end\n\n  def foo(object)\n    # do something with object\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 1, "creation_date": 1554403985, "post_id": 55523081, "comment_id": 97750387, "body": "This sucks for a couple reasons. My biggest complaint being that memoization is impossible, without hiding stuff on object, (or on params, if you&#39;re passing that in) which feels really hacky."}], "tags": [], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "is_accepted": false, "score": 0, "last_activity_date": 1554403934, "creation_date": 1554403934, "answer_id": 55523081, "question_id": 55096900, "link": "https://stackoverflow.com/questions/55096900/how-to-define-method-serializer-in-rails-netflix-fast-jsonapi-in-rails/55523081#55523081", "title": "How to define method serializer in Rails netflix fast_jsonapi in Rails?", "body": "<p>It's... difficult. This was brought up as an <a href=\"https://github.com/Netflix/fast_jsonapi/issues/71\" rel=\"nofollow noreferrer\">issue</a> a while back, but nothing's come of it yet.</p>\n\n<p>What happens is that the serializers sort of act as singletons, so you're basically forced into using class methods, eg</p>\n\n<pre><code>class MovieSerializer\n  include FastJsonapi::ObjectSerializer\n\n  attributes :name, :year\n\n  attribute :name_with_year do |object|\n    foo(object)\n  end\n\n  def self.foo(object) # will be called\n    # do something with object\n  end\n\n  def foo(object) # will never be called\n    # do something with object\n  end\nend\n</code></pre>\n\n<p>There's weird stuff around scoping in that gem that makes this necessary.</p>\n"}], "owner": {"reputation": 59, "user_id": 7789811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9ba5f35c42bb0746a11dbee82bd7cf7?s=128&d=identicon&r=PG&f=1", "display_name": "alavni shubham", "link": "https://stackoverflow.com/users/7789811/alavni-shubham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1554403934, "creation_date": 1552288914, "last_edit_date": 1552296981, "question_id": 55096900, "link": "https://stackoverflow.com/questions/55096900/how-to-define-method-serializer-in-rails-netflix-fast-jsonapi-in-rails", "title": "How to define method serializer in Rails netflix fast_jsonapi in Rails?", "body": "<p>How to define a function in Serializer using Rails Netflix fast_jsonapi in Rails as like active model serializer?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1552286628, "post_id": 55096243, "comment_id": 96936271, "body": "instead of sending email <code>&lt;a href=&quot;mailto:temp@temp.com&quot;&gt; temp@temp.com&lt;&#47;a&gt;</code> when use click on this link, it will automatically take default email app from system"}, {"owner": {"reputation": 55, "user_id": 8306123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-h_fpr-XOcyE/AAAAAAAAAAI/AAAAAAAAAE8/5RmhwJRBVeM/photo.jpg?sz=128", "display_name": "Alia Tabassum", "link": "https://stackoverflow.com/users/8306123/alia-tabassum"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1552298320, "post_id": 55096243, "comment_id": 96941512, "body": "i am not able to view a link, it is coming as a text including tags. Can u please help"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1552298973, "post_id": 55096243, "comment_id": 96941889, "body": "<code>disabled: &quot;Your account has been disabled due to inactivity. Please contact &lt;a href=&#39;mailto:PaymentsTeamHydra@radial.com&#39;&gt;DL-PaymentsTeamHy&zwnj;&#8203;dra@radial.com&lt;&#47;a&gt; to activate again.&quot; </code>"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1552299001, "post_id": 55096243, "comment_id": 96941906, "body": "Put this cutom link for now"}, {"owner": {"reputation": 55, "user_id": 8306123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-h_fpr-XOcyE/AAAAAAAAAAI/AAAAAAAAAE8/5RmhwJRBVeM/photo.jpg?sz=128", "display_name": "Alia Tabassum", "link": "https://stackoverflow.com/users/8306123/alia-tabassum"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1552299147, "post_id": 55096243, "comment_id": 96941988, "body": "Still i am not getting as a link, instead it is a normal text"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1552299335, "post_id": 55096243, "comment_id": 96942108, "body": "Can you please share html which you received?"}, {"owner": {"reputation": 55, "user_id": 8306123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-h_fpr-XOcyE/AAAAAAAAAAI/AAAAAAAAAE8/5RmhwJRBVeM/photo.jpg?sz=128", "display_name": "Alia Tabassum", "link": "https://stackoverflow.com/users/8306123/alia-tabassum"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1552300524, "post_id": 55096243, "comment_id": 96942791, "body": "I have updated my post with the image, please have a look into this"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1552301164, "post_id": 55096243, "comment_id": 96943160, "body": "Can you please add view of this flash error?"}, {"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1552308344, "post_id": 55096243, "comment_id": 96947024, "body": "Try adding <code>.html_safe</code> to the link."}, {"owner": {"reputation": 55, "user_id": 8306123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-h_fpr-XOcyE/AAAAAAAAAAI/AAAAAAAAAE8/5RmhwJRBVeM/photo.jpg?sz=128", "display_name": "Alia Tabassum", "link": "https://stackoverflow.com/users/8306123/alia-tabassum"}, "edited": false, "score": 0, "creation_date": 1552368169, "post_id": 55096243, "comment_id": 96971162, "body": "i added .html_safe still its not working"}], "owner": {"reputation": 55, "user_id": 8306123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-h_fpr-XOcyE/AAAAAAAAAAI/AAAAAAAAAE8/5RmhwJRBVeM/photo.jpg?sz=128", "display_name": "Alia Tabassum", "link": "https://stackoverflow.com/users/8306123/alia-tabassum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552300496, "creation_date": 1552285465, "last_edit_date": 1552300496, "question_id": 55096243, "link": "https://stackoverflow.com/questions/55096243/how-to-add-link-to-modal-window-in-rails-flash-error-messages-from-controller", "title": "How to add link_to modal window in rails flash error messages from controller?", "body": "<p><a href=\"https://i.stack.imgur.com/AWqPd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AWqPd.png\" alt=\"enter image description here\"></a>I have a login_in page, When inactive users login I need to display a flash error message with a link stating \"contact {email link} to activate again\". On clicking of email link, I need to have a modal window, after which on submit of the modal window, I can send mail to support team. Can someone pleas help me how to proceed this?</p>\n\n<pre><code>def user_active?\n    if (!params[\"user\"].blank?)\n      @user=User.find_by(:email =&gt; params[\"user\"][\"email\"])\n      flag = false;\n      @LastSignInTimestamp = @user[:last_sign_in_at];\n      @CurrentTimestamp = Time.now.utc;\n      if(@LastSignInTimestamp != nil &amp;&amp; @CurrentTimestamp != nil)\n      @DateDifferenceInDays = (@CurrentTimestamp.to_date - @LastSignInTimestamp.to_date).to_i\n      @profiles = Profile.where('name_key in (?) OR name_key LIKE ?', %w(Radial_ReadOnly), 'Portal-Account-Manager%')\n      @profiles.each do |p|\n        @user_profile_id = @user[:profile_id].to_s;\n        @profile_id = p[:id].to_s;\n        if(@profile_id.include?@user_profile_id)\n          flag = true;\n          break;\n        else\n          flag = false;\n        end\n      end\n      end\n      if (!@user.blank?)\n        if(@LastSignInTimestamp != nil &amp;&amp; @CurrentTimestamp != nil &amp;&amp; @DateDifferenceInDays &gt; @@DEFAULT_TIME_GAP &amp;&amp; flag)\n          flash[:error] = I18n.t('devise.failure.disabled').html_safe\n          send_activate_email(@user[:id], @user[:last_sign_in_at])\n        elsif (!@user.active)\n          flash[:error] = I18n.t('devise.failure.inactive')\n        elsif (!@user.email_verification_status)\n          flash[:error] = I18n.t('signup.verification.not_yet_verified')\n        else\n          return true\n        end\n      else\n        flash[:error] = I18n.t('login.errors.invalid')\n      end\n      redirect_to \"/signin\"\n    end\n  end\n</code></pre>\n\n<p><strong>en.yml</strong> file </p>\n\n<pre><code>disabled: \"Your account has been disabled due to inactivity. Please contact &lt;a href&gt;DL-PaymentsTeamHydra@radial.com&lt;/a&gt; to activate again.\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "redmine"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1552285638, "post_id": 55095334, "comment_id": 96935936, "body": "You may have to require <code>%W(#{config.root}&#47;lib&#47;**&#47;*.rb)</code> to get the nested files"}], "answers": [{"tags": [], "owner": {"reputation": 462, "user_id": 8118439, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/55a4f555a3f4961816218f019966c9e6?s=128&d=identicon&r=PG&f=1", "display_name": "stack_user", "link": "https://stackoverflow.com/users/8118439/stack-user"}, "is_accepted": true, "score": 0, "last_activity_date": 1553666736, "creation_date": 1553666736, "answer_id": 55370773, "question_id": 55095334, "link": "https://stackoverflow.com/questions/55095334/uninitialized-constant-occured-when-patch-to-redmine/55370773#55370773", "title": "uninitialized constant occured when patch to Redmine", "body": "<p>In rails5, production environment is not autoloaded by default.\nSo, I add <code>config.enable_dependency_loading = true</code> then works fine.</p>\n"}], "owner": {"reputation": 462, "user_id": 8118439, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/55a4f555a3f4961816218f019966c9e6?s=128&d=identicon&r=PG&f=1", "display_name": "stack_user", "link": "https://stackoverflow.com/users/8118439/stack-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 55370773, "answer_count": 1, "score": 2, "last_activity_date": 1553666736, "creation_date": 1552279324, "last_edit_date": 1552286449, "question_id": 55095334, "link": "https://stackoverflow.com/questions/55095334/uninitialized-constant-occured-when-patch-to-redmine", "title": "uninitialized constant occured when patch to Redmine", "body": "<p>I patch to my Redmine(Ver4.0.0) for <a href=\"http://www.redmine.org/issues/306#note-29\" rel=\"nofollow noreferrer\">this</a> patch file.</p>\n\n<p>then, executed</p>\n\n<pre><code>bundle\nbundle exec rake db:migrate RAILS_ENV=production\n</code></pre>\n\n<p>and restarted redmine.</p>\n\n<p>But following error occurred when I attached file to ticket.</p>\n\n<pre><code>[ActiveJob] [ExtractFulltextJob] [3daafa4a-4d90-43ce-a065-c4257176ca0f] Error performing ExtractFulltextJob (Job ID: 3daafa4a-4d90-43ce-a065-c4257176ca0f) from Async(text_extraction) in 9.77ms: NameError (uninitialized constant Redmine::TextExtractor):\n/home/redmine/redmine/app/jobs/extract_fulltext_job.rb:7:in `perform'\n</code></pre>\n\n<p>I checked redmine/config/application.rb</p>\n\n<pre><code>config.autoload_paths += %W(#{config.root}/lib)\n</code></pre>\n\n<p>and <code>redmine/lib/redmine/text_extractor.rb</code></p>\n\n<pre><code>module Redmine\n  class TextExtractor\n  ....\n</code></pre>\n\n<p>But I could not understand why <code>uninitialized constant</code> error occured.</p>\n\n<p>How to patch <a href=\"http://www.redmine.org/issues/306#note-9\" rel=\"nofollow noreferrer\">this</a> ?</p>\n"}]