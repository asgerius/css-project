[{"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "edited": false, "score": 0, "creation_date": 1456379640, "post_id": 35615362, "comment_id": 58921509, "body": "It&#39;s a bit unclear what you&#39;re asking. Do you want to display the <code>@paper_weight_per_capita</code> somewhere?"}, {"owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "reply_to_user": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "edited": false, "score": 0, "creation_date": 1456411112, "post_id": 35615362, "comment_id": 58941874, "body": "Sorry for the unclear question @JamesKlein :) . I&#180;m trying to find out how I can display the average weight for each paper_type in the f.select. So in the view I&#180;m able to how much the &#39;Skrifstofupapp&#237;r&#39;, &#39;Dagbla&#240;apapp&#237;r&#39; etc weights.  My problem is basically in how I can grab those values and display them separately."}, {"owner": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "edited": false, "score": 0, "creation_date": 1456412847, "post_id": 35615362, "comment_id": 58943418, "body": "Gotcha. Where do these names exist? Here they are hard-coded into the view but are these in fact names of <code>PaperType</code> records in your database that also have an <code>average_weight</code> attribute on them? If not, do you want to hard-code the average weights as well?"}, {"owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "reply_to_user": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "edited": false, "score": 0, "creation_date": 1456413597, "post_id": 35615362, "comment_id": 58944054, "body": "thanks for quick response @James Klein...If the user select for example &#39;Dagbla&#240;apapp&#237;r&#39; in the f. select and then puts in a weight it looks like this in the database: #&lt;Paper id: 1, paper_type: &quot;Dagbla&#240;apapp&#237;r&quot;, paper_weight: #&lt;BigDecimal:7ff54f8396f8,&#39;0.1E3&#39;,9(18)&gt;  The user can add as many instances of different paper_types as he wants. Then I want to be able to show the user in a running total how many Kg the user have for each paper_type. So I need a way to grab the paper_type in this bit current_user.papers.sum(:paper_weight) but not only the the paper_weight as it is now..."}, {"owner": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "edited": false, "score": 0, "creation_date": 1456428867, "post_id": 35615362, "comment_id": 58954758, "body": "Oh okay. So you don&#39;t actually want any changes to the form code that you posted, you instead want a view such as <code>user&#47;show.html.erb</code> that has a table inside of it with all the papers, correct?"}, {"owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "reply_to_user": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "edited": false, "score": 0, "creation_date": 1456437875, "post_id": 35615362, "comment_id": 58960130, "body": "Yes, exactly, exept I want to post it on the index page as running total, like I&#39;m doing with the paper_weight, but instead of showing only the average weight for paper I want the running total to show the running total for each paper_type. Do you know a way to do that?"}, {"owner": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "edited": false, "score": 0, "creation_date": 1456521751, "post_id": 35615362, "comment_id": 59004113, "body": "Yes I do. Final question before answering this, which index page do you want this on? <code>users&#47;index</code> or <code>papers&#47;index</code>?"}, {"owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "reply_to_user": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "edited": false, "score": 0, "creation_date": 1456522219, "post_id": 35615362, "comment_id": 59004332, "body": "Ohhh I&#180;m so grateful , it would be awesome.  Actually I&#180;ll be probably be using it on a partial called _average_user_total.html.erb. to begin with"}], "answers": [{"tags": [], "owner": {"reputation": 4045, "user_id": 1378252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4025b3e5be289ffee5dffbd0a1a7fb5?s=128&d=identicon&r=PG", "display_name": "toddmetheny", "link": "https://stackoverflow.com/users/1378252/toddmetheny"}, "is_accepted": false, "score": 0, "last_activity_date": 1456522194, "creation_date": 1456522194, "answer_id": 35662106, "question_id": 35615362, "link": "https://stackoverflow.com/questions/35615362/grabbing-values-from-f-select-options-for-select-in-rails-app/35662106#35662106", "title": "grabbing values from f.select options_for_select in rails app", "body": "<p>Not positive I understand correctly, but I think what you're trying to do (based on comments) is display the averages of each individual paper type on the index page.</p>\n\n<p>As you're iterating through the different types of paper that belong to the user, you could call a method that performs that calculation. Inside that method you might do something like this:</p>\n\n<pre><code>def paper_weight_by_type(user_id, paper_type)\n  u = User.find(user_id)\n  weight_by_type = Paper.where(user_id: user_id, paper_type: paper_type).pluck(:paper_weight)\n  # then return this\n  weight_by_type.inject(:+)      \nend\n</code></pre>\n\n<p>this is a crude version. This could be an instance method on either user or paper in which case you wouldn't need both arguments. (ie current_user.paper_weight_by_type(paper_type) ...could also make it a class method and just pass both arguments by adding self. in front of def) Also several ways you could probably cut down on the number of queries being run...but this would get the job done. You'd want to call it from the paper loop on the index page however you ended up doing it. I would get it working one way and then improve it from there. Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 4045, "user_id": 1378252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4025b3e5be289ffee5dffbd0a1a7fb5?s=128&d=identicon&r=PG", "display_name": "toddmetheny", "link": "https://stackoverflow.com/users/1378252/toddmetheny"}, "edited": false, "score": 0, "creation_date": 1456531363, "post_id": 35662648, "comment_id": 59007937, "body": "you don&#39;t need to do this: PAPER_TYPES = [[&#39;Skrifstofupapp&#237;r&#39;, &#39;Skrifstofupapp&#237;r&#39;], [&#39;Dagbla&#240;apapp&#237;r&#39;, &#39;Dagbla&#240;apapp&#237;r&#39;], [&#39;Glans_&amp;_t&#237;maritapapp&#237;r&#39;, &#39;Glans_&amp;_t&#237;maritapapp&#237;r&#39;], [&#39;Anna&#240;&#39;, &#39;Anna&#240;&#39;]]  the reason for doing the two dimensional would be because there are different values. for instance, you want to show the user a string but save an id. Like this SODAS = [[&#39;Coke&#39;, 1], [&#39;Pepsi&#39;, 2]]. When just dealing with the string you can just say SODAS = [&#39;Coke&#39;, &#39;Pepsi&#39;] and it will work exactly the same as if you listed them twice in a 2 dimensional array."}, {"owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "edited": false, "score": 0, "creation_date": 1456582995, "post_id": 35662648, "comment_id": 59020905, "body": "Thank you so much @James Klein this works like a charm and I understand what I&#180;m doing, great guidance and professional approach... Thumbs up mate!!!"}, {"owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "edited": false, "score": 0, "creation_date": 1456583078, "post_id": 35662648, "comment_id": 59020924, "body": "I changed the PAPER_TYPES to on line of each string, it works also that way....Thank you both"}, {"owner": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "reply_to_user": {"reputation": 4045, "user_id": 1378252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4025b3e5be289ffee5dffbd0a1a7fb5?s=128&d=identicon&r=PG", "display_name": "toddmetheny", "link": "https://stackoverflow.com/users/1378252/toddmetheny"}, "edited": false, "score": 1, "creation_date": 1456625599, "post_id": 35662648, "comment_id": 59034301, "body": "@karma_police, absolutely. I just wanted to mention the refactor but hadn&#39;t looked at the array itself. Glad I could help"}], "tags": [], "owner": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "is_accepted": true, "score": 1, "last_activity_date": 1456627536, "last_edit_date": 1456627536, "creation_date": 1456524349, "answer_id": 35662648, "question_id": 35615362, "link": "https://stackoverflow.com/questions/35615362/grabbing-values-from-f-select-options-for-select-in-rails-app/35662648#35662648", "title": "grabbing values from f.select options_for_select in rails app", "body": "<p>First a tweak.</p>\n\n<p>In your <code>Paper</code> class is where you want to put the array of acceptable values for the paper type. That way you can validate input from perhaps more than just this form in the future. It also allows you to test that code plus putting an array right in the view like that is just not the best practice.</p>\n\n<pre><code>class Paper\n  PAPER_TYPES = ['Skrifstofupapp\u00edr', 'Dagbla\u00f0apapp\u00edr', 'Glans_&amp;_t\u00edmaritapapp\u00edr', 'Anna\u00f0']\n  ...\n</code></pre>\n\n<p>Then in your view, change to this.</p>\n\n<pre><code>&lt;%= f.select(:paper_type, options_for_select(Paper::PAPER_TYPES)) %&gt;\n</code></pre>\n\n<p>That doesn't answer your question, just a tweak to make your code cleaner and testable.</p>\n\n<p>Then in your <code>User</code> model</p>\n\n<pre><code>def average_paper_types\n  self.papers.group(:paper_type).sum(:paper_weight)\nend\n</code></pre>\n\n<p>And in your partial:</p>\n\n<pre><code>&lt;table&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;% current_user.average_paper_types.each do |pair| %&gt;\n        &lt;th&gt;&lt;%= pair[0] %&gt;&lt;/th&gt;\n      &lt;% end %&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n  &lt;tbody&gt;\n    &lt;tr&gt;\n      &lt;% current_user.average_paper_types.each do |pair| %&gt;\n        &lt;td&gt;&lt;%= pair[1] %&gt;&lt;/td&gt;\n      &lt;% end %&gt;\n    &lt;/tr&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"}], "owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 35662648, "answer_count": 2, "score": 0, "last_activity_date": 1456627536, "creation_date": 1456356700, "question_id": 35615362, "link": "https://stackoverflow.com/questions/35615362/grabbing-values-from-f-select-options-for-select-in-rails-app", "title": "grabbing values from f.select options_for_select in rails app", "body": "<p>Hi in my apps I have a scaffold, were users can select different type of paper and add a paper weight for each type. Then I calculate the running total of paper_weight for each user in the ApplicationController.</p>\n\n<p>I want to be more specific and show the users the average weight of each paper_type they are using.  I\u00b4m a bit lost since I \u00b4m rather new to rails, can anyone here help me??</p>\n\n<p>thanks in advance</p>\n\n<p>below are my views.</p>\n\n<p>in paper/new.html.erb</p>\n\n<pre><code>&lt;div class=\"control-group\"&gt; \n    &lt;%= f.label :paper_type, class: 'control-label' %&gt;&lt;br&gt;\n        &lt;div class=\"controls\"&gt;\n            &lt;%= f.select(:paper_type, options_for_select([['Skrifstofupapp\u00edr', 'Skrifstofupapp\u00edr'], ['Dagbla\u00f0apapp\u00edr', 'Dagbla\u00f0apapp\u00edr'], ['Glans_&amp;_t\u00edmaritapapp\u00edr', 'Glans_&amp;_t\u00edmaritapapp\u00edr'], ['Anna\u00f0', 'Anna\u00f0']])) %&gt;\n      &lt;/div&gt;\n&lt;/div&gt;  \n\n\n&lt;div class=\"control-group\"&gt; \n    &lt;%= f.label :paper_weight, class: 'control-label' %&gt;&lt;br&gt;\n        &lt;div class=\"controls\"&gt;\n            &lt;%= f.number_field :paper_weight %&gt;\n        &lt;/div&gt;\n&lt;/div&gt;  \n</code></pre>\n\n<p>in ApplicationController.rb</p>\n\n<pre><code>@paper_weight_per_capita = current_user.papers.sum(:paper_weight) / (current_user.profile.staff) \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "mysql2"], "answers": [{"tags": [], "owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1458314597, "last_edit_date": 1495541696, "creation_date": 1456388733, "answer_id": 35621966, "question_id": 35615354, "link": "https://stackoverflow.com/questions/35615354/rake-dbmigrate-gem-error/35621966#35621966", "title": "Rake db:migrate Gem Error", "body": "<p>Try to add <code>--force</code>:</p>\n\n<pre><code>mysql_upgrade -u root -p --force\n</code></pre>\n\n<p>and restart your <code>mysql2</code> gem.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/6288103/native-table-performance-schema-has-the-wrong-structure\">This</a> might help you.</p>\n"}], "owner": {"reputation": 1, "user_id": 5977331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/082365f5f3b228e99322a392b7474d48?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsay", "link": "https://stackoverflow.com/users/5977331/lindsay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 0, "closed_date": 1471447635, "answer_count": 1, "score": 0, "last_activity_date": 1458314887, "creation_date": 1456356665, "last_edit_date": 1458314887, "question_id": 35615354, "link": "https://stackoverflow.com/questions/35615354/rake-dbmigrate-gem-error", "closed_reason": "Duplicate", "title": "Rake db:migrate Gem Error", "body": "<p>I am getting the following error when trying to run <code>rake db:migrate</code> with the <code>mysql2</code> gem:</p>\n\n<blockquote>\n  <blockquote>\n    <p>ActiveRecord::StatementInvalid: Mysql2::Error: Native table 'performance_schema'.'session_variables' has the wrong structure: SHOW VARIABLES LIKE 'character_set_database'</p>\n  </blockquote>\n</blockquote>\n\n<p>I have tried <code>sudo mysql_upgrade -u root -p</code>, which upgraded <code>mysql2</code> to <code>0.4.2</code>, but did <em>not</em> solve the problem</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rack", "http-caching"], "comments": [{"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 0, "creation_date": 1456357183, "post_id": 35614982, "comment_id": 58914421, "body": "It seems that you&#39;ve answered your own question (yes, it does... you have evidence of it).  Where the documentation would be is off topic for SO, but is there some other question you want to ask?  For example, do you want to change the value of the header for one (or all) 301 redirects?"}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1456386151, "post_id": 35614982, "comment_id": 58924623, "body": "From a quick glance at the Rails source, I would say that Rails always set no-cache on all dynamic content, and that 301 redirects are not treated special."}, {"owner": {"reputation": 474, "user_id": 145501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfb5975ecda818fc5a0848a73e4736ae?s=128&d=identicon&r=PG", "display_name": "Kazim Zaidi", "link": "https://stackoverflow.com/users/145501/kazim-zaidi"}, "edited": false, "score": 0, "creation_date": 1492429916, "post_id": 35614982, "comment_id": 73957333, "body": "I also noticed this now, and I didn&#39;t expect this. I wanted my 301s to be cached and not hit server again!"}], "owner": {"reputation": 95, "user_id": 3116981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLSRo.png?s=128&g=1", "display_name": "ross", "link": "https://stackoverflow.com/users/3116981/ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 415, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1456354793, "creation_date": 1456354793, "question_id": 35614982, "link": "https://stackoverflow.com/questions/35614982/does-ruby-on-rails-4-automatically-set-the-cache-control-no-cache-http-header-f", "title": "Does Ruby on Rails 4 automatically set the Cache-Control: no-cache HTTP Header for 301 redirects?", "body": "<p>If so, is this documented somewhere?</p>\n\n<p>A little more detail:</p>\n\n<p>My controller action renders a 301 redirect, like so:</p>\n\n<pre><code>def show\n  redirect_to \"/some-url\", status: 301\nend\n</code></pre>\n\n<p>When I inspect network traffic for this request in the browser, it appears that rails automatically sets the Cache-Control: no-cache HTTP header for 301 redirects.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "paperclip"], "comments": [{"owner": {"reputation": 206, "user_id": 3227183, "user_type": "registered", "profile_image": "https://graph.facebook.com/695426280/picture?type=large", "display_name": "lienvdsteen", "link": "https://stackoverflow.com/users/3227183/lienvdsteen"}, "edited": false, "score": 0, "creation_date": 1456356835, "post_id": 35614628, "comment_id": 58914290, "body": "Are you getting an error?   To answer your question, what you can do is add an if check on your validate. <code>if: :image_changed?</code>"}, {"owner": {"reputation": 4750, "user_id": 4367019, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/CnP5z.jpg?s=128&g=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/4367019/felix"}, "reply_to_user": {"reputation": 206, "user_id": 3227183, "user_type": "registered", "profile_image": "https://graph.facebook.com/695426280/picture?type=large", "display_name": "lienvdsteen", "link": "https://stackoverflow.com/users/3227183/lienvdsteen"}, "edited": false, "score": 0, "creation_date": 1456440836, "post_id": 35614628, "comment_id": 58961615, "body": "How should it look like? If I add it i got image_changed? is not a function"}], "owner": {"reputation": 4750, "user_id": 4367019, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/CnP5z.jpg?s=128&g=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/4367019/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456355006, "creation_date": 1456353427, "last_edit_date": 1456355006, "question_id": 35614628, "link": "https://stackoverflow.com/questions/35614628/problems-after-paperclip-adding-a-image-to-controller", "title": "problems after paperclip adding a image to controller", "body": "<p>I've got a problem updating the params of a model after adding a picture to the model. </p>\n\n<p>Model is user, I've added a image to the user model with paperclip.</p>\n\n<p>When I upload a picture with paperclip it is stored correctly in filesystem and in Database, but after that I can't change any other param of the user. </p>\n\n<p>Thats the method how I update the attributes</p>\n\n<pre><code>  def settings\n   @usergroups = User.find(session[:user_id]).user_groups\n   if request.post?\n     if @user.update_attributes(params[:user])\n      flash[:notice] = t(\"flash.saved\")\n    end\n   end\n end\n</code></pre>\n\n<p>Thats the method for uploading the image</p>\n\n<pre><code>  def uploadimage\n    if request.post?\n     @user = User.find(params[:userid])\n     if @user.update_attribute(:image, params[:upload][:image])\n       flash[:notice] = t(\"flash.saved\")\n       redirect_to :action =&gt; :settings\n    end\n  end\nend\n</code></pre>\n\n<p>If the picture is stored in db it looks like this in user table:\n<a href=\"https://i.stack.imgur.com/8x6zs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8x6zs.png\" alt=\"enter image description here\"></a></p>\n\n<p>Model has this:</p>\n\n<pre><code>  has_attached_file :image,\n                :path =&gt; \":rails_root/public/uploads/:id/:filename\",\n                :url =&gt; \"/uploads/:id/:filename\"\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<pre><code>  validates_attachment :image, :content_type =&gt; { :content_type =&gt; \"image/jpg\" }\n</code></pre>\n\n<p>Picture upload form and other attributes form are two different forms.</p>\n\n<p>Does someone have an Idea whats going wrong? </p>\n\n<p>problem comes from:  </p>\n\n<pre><code>validates_attachment :image, :content_type =&gt; { :content_type =&gt; \"image/jpg\" }\n</code></pre>\n\n<p><strong>is there a possibility to only validate if :image attribute is changed?</strong></p>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1456358701, "post_id": 35614647, "comment_id": 58914925, "body": "An alternative is <code>letters.size.times.cycle { |i| ....letters[i].... }</code>. This may be useful if one needs to know the letter offset in the block."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1456380304, "post_id": 35614647, "comment_id": 58921762, "body": "@CarySwoveland or <code>letters.each_with_index.cycle { |l, i| ... }</code> / <code>letters.cycle.with_index { |l, i| ... }</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1456386930, "post_id": 35614647, "comment_id": 58925053, "body": "@Stefan, of possible interest: <code>letters.each_with_index.cycle.first(5) #=&gt; [[&quot;A&quot;, 0], [&quot;B&quot;, 1], [&quot;C&quot;, 2], [&quot;A&quot;, 0], [&quot;B&quot;, 1]]</code>, whereas <code>letters.cycle.with_index.first(5) #=&gt;  [[&quot;A&quot;, 0], [&quot;B&quot;, 1], [&quot;C&quot;, 2], [&quot;A&quot;, 3], [&quot;B&quot;, 4]]</code>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1456387089, "post_id": 35614647, "comment_id": 58925137, "body": "The latter along with <code>divmod</code> is probably most versatile - it gives you loop count, element index and total count."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 6, "last_activity_date": 1456354341, "last_edit_date": 1456354341, "creation_date": 1456353496, "answer_id": 35614647, "question_id": 35614601, "link": "https://stackoverflow.com/questions/35614601/ruby-restart-array-loop/35614647#35614647", "title": "Ruby Restart Array Loop", "body": "<p>Use <code>cycle</code>.</p>\n\n<pre><code>letters.cycle do |letter|\n  ...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 5, "last_activity_date": 1456354127, "creation_date": 1456354127, "answer_id": 35614806, "question_id": 35614601, "link": "https://stackoverflow.com/questions/35614601/ruby-restart-array-loop/35614806#35614806", "title": "Ruby Restart Array Loop", "body": "<p>Just put your <code>each</code> loop into another loop:</p>\n\n<pre><code>loop do\n  letters.each do |letter|\n    puts letter\n    sleep 1\n  end\n  puts \"that was the last letter\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4706, "user_id": 481229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OJflZ.jpg?s=128&g=1", "display_name": "Agush", "link": "https://stackoverflow.com/users/481229/agush"}, "is_accepted": false, "score": 2, "last_activity_date": 1456355361, "creation_date": 1456355361, "answer_id": 35615107, "question_id": 35614601, "link": "https://stackoverflow.com/questions/35614601/ruby-restart-array-loop/35615107#35615107", "title": "Ruby Restart Array Loop", "body": "<p>From Ruby1.9 <code>retry</code> can only be used inside a <code>begin/rescue</code> block</p>\n\n<p>What you are trying to do can be done like this:</p>\n\n<pre><code>letters = [\"A\",\"B\",\"C\"]\nbegin\n  letters.each do |letter|\n    puts letter\n    if letter == letters.last\n      puts \"that was the last letter\"\n      #restart the array from A again (I'd like it to continue looping infinitely)\n      raise\n    end\n  end\nrescue\n  sleep 1\n  retry\nend\n</code></pre>\n\n<p>Take note of the <code>raise</code> keyword after the comment which causes the code to go into <code>rescue</code> and then <code>sleep</code> and <code>retry</code></p>\n\n<p>Another option would be to use <code>cycle</code> which is more clean and elegant</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1456384693, "post_id": 35615770, "comment_id": 58923900, "body": "Starting with Ruby 2.0, you can also write <code>0.step { |i| ... }</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1456386182, "post_id": 35615770, "comment_id": 58924650, "body": "Thanks, @Stefan. Good to know."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1456358869, "creation_date": 1456358869, "answer_id": 35615770, "question_id": 35614601, "link": "https://stackoverflow.com/questions/35614601/ruby-restart-array-loop/35615770#35615770", "title": "Ruby Restart Array Loop", "body": "<pre><code>(0..Float::INFINITY).each do |i|\n  puts letters[i % letters.size] \n  puts \"Whew! That was the last letter, so it's time to start over.\" \\\n    if ((i+1) %letters.size).zero?\nend\n  # A\n  # B\n  # C\n  # Whew! That was the last letter, so it's time to start over.\n  # A\n  # B\n  # C\n  # Whew! That was the last letter, so it's time to start over.\n  # A\n  # B\n  # ...\n</code></pre>\n"}], "owner": {"reputation": 1521, "user_id": 2905222, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon", "link": "https://stackoverflow.com/users/2905222/brandon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 35614647, "answer_count": 4, "score": 1, "last_activity_date": 1456358869, "creation_date": 1456353343, "question_id": 35614601, "link": "https://stackoverflow.com/questions/35614601/ruby-restart-array-loop", "title": "Ruby Restart Array Loop", "body": "<p>I am trying to restart an array loop in ruby once the entire array has been iterated through.</p>\n\n<p>I've found that the <code>retry</code> method will not work for this. Code below:</p>\n\n<pre><code>letters = [\"A\",\"B\",\"C\"]\n\nletters.each do |letter|\n  puts letter\n  if letter == letters.last\n    puts \"that was the last letter\"\n    #restart the array from A again (I'd like it to continue looping infinitely)\n  end\n  sleep 1\nend\n</code></pre>\n\n<p>Any ideas would be greatly appreciated. Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 45, "user_id": 4761362, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036148259745849/picture?type=large", "display_name": "Chintan Vadgama", "link": "https://stackoverflow.com/users/4761362/chintan-vadgama"}, "reply_to_user": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1456353342, "post_id": 35614404, "comment_id": 58912911, "body": "<code>key = curr_line.gsub(&#47;\\s+&#47;,&#39;&#39;).delete(&quot;\\n&quot;).split(&#39;version:&#39;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4761362, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036148259745849/picture?type=large", "display_name": "Chintan Vadgama", "link": "https://stackoverflow.com/users/4761362/chintan-vadgama"}, "edited": false, "score": 0, "creation_date": 1456353017, "post_id": 35614469, "comment_id": 58912750, "body": "I tried this logic &amp; it seems working fine but I have to store these values into array. So when I am pushing these values into array, it stores weird values. Could you please suggest any string manipulation method?"}, {"owner": {"reputation": 2460, "user_id": 3788456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kDXz3.jpg?s=128&g=1", "display_name": "AJ X.", "link": "https://stackoverflow.com/users/3788456/aj-x"}, "reply_to_user": {"reputation": 45, "user_id": 4761362, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036148259745849/picture?type=large", "display_name": "Chintan Vadgama", "link": "https://stackoverflow.com/users/4761362/chintan-vadgama"}, "edited": false, "score": 0, "creation_date": 1456353756, "post_id": 35614469, "comment_id": 58913106, "body": "@ChintanVadgama define &quot;weird&quot; values.  Also -- it would be better to ask your question completely in the question block at the top.  Context related to comments is often lost."}, {"owner": {"reputation": 45, "user_id": 4761362, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036148259745849/picture?type=large", "display_name": "Chintan Vadgama", "link": "https://stackoverflow.com/users/4761362/chintan-vadgama"}, "edited": false, "score": 0, "creation_date": 1456354962, "post_id": 35614469, "comment_id": 58913587, "body": "@Mircea I have revised my question. I will tackle this problem in a different way. Could you pls. help me with the above question ?"}], "tags": [], "owner": {"reputation": 9234, "user_id": 4629810, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh4.googleusercontent.com/-gcabh64Le4c/AAAAAAAAAAI/AAAAAAAAAQ8/GquVsg_lVoA/photo.jpg?sz=128", "display_name": "Mircea", "link": "https://stackoverflow.com/users/4629810/mircea"}, "is_accepted": false, "score": 1, "last_activity_date": 1456353936, "last_edit_date": 1456353936, "creation_date": 1456352781, "answer_id": 35614469, "question_id": 35614404, "link": "https://stackoverflow.com/questions/35614404/how-to-print-the-previous-word-if-the-condition-is-met/35614469#35614469", "title": "How to print the previous word if the condition is met?", "body": "<p>remember the previous line and only output if it matches your criteria.</p>\n\n<pre><code>previous_line = \"\"\nFile.foreach(input_file) do |line|\n   puts previous_line if line.include? 'version:'\n   previous_line = line\nend\n</code></pre>\n\n<p>To store this in an array:</p>\n\n<pre><code>previous_line = \"\"\ndetected_vals = []\nFile.foreach(input_file) do |line|\n   detected_vals &lt;&lt; previous_line if line.include? 'version:'\n   previous_line = line\nend\nputs detected_vals.inspect\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4761362, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036148259745849/picture?type=large", "display_name": "Chintan Vadgama", "link": "https://stackoverflow.com/users/4761362/chintan-vadgama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1456354920, "creation_date": 1456352557, "last_edit_date": 1456354920, "question_id": 35614404, "link": "https://stackoverflow.com/questions/35614404/how-to-print-the-previous-word-if-the-condition-is-met", "title": "How to print the previous word if the condition is met?", "body": "<pre><code>a=[\nhelloworld:\nprodValue:\nversion:7\nclass:[\nratio:\nvalue: \"\"\nstackOverflow:\nversion:3\n]\n#Inspect Output\n\"helloworld:\"\n\"prodValue:\"\n\"version:7\"    \n\"class:[\"\n\"ratio:\"\n\"value: \"\"\"\n\"stackOverflow:\"\n\"version:3\"\n</code></pre>\n\n<p>I want to print the previous word if the next word is version. Is there any ruby method to split the previous word if it detects some string ? I am using the following ruby script</p>\n\n<p><code>a.delete(\"\\n\").delete(\":\").gsub(/\\s+/,'').split('version:',-1)</code></p>\n"}, {"tags": ["ruby", "method-missing"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 2180106, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4101fd5e400d599d60411d75bd200702?s=128&d=identicon&r=PG", "display_name": "Mor Haham", "link": "https://stackoverflow.com/users/2180106/mor-haham"}, "edited": false, "score": 0, "creation_date": 1456352232, "post_id": 35614167, "comment_id": 58912368, "body": "I have a feeling you did not understand me."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1456351676, "creation_date": 1456351676, "answer_id": 35614167, "question_id": 35614023, "link": "https://stackoverflow.com/questions/35614023/how-does-overriding-method-missing-work/35614167#35614167", "title": "How does overriding `method_missing` work?", "body": "<blockquote>\n  <p>how does the new method know that I am calling a missing method</p>\n</blockquote>\n\n<p>If a called method is not defined, it can tell that you are calling a missing method.</p>\n\n<blockquote>\n  <p>how does it print the output of the new method?</p>\n</blockquote>\n\n<p>By executing the new defined method.</p>\n\n<blockquote>\n  <p>How is <code>some_method</code> considered as the <code>m</code> argument?</p>\n</blockquote>\n\n<p>By design.</p>\n"}], "owner": {"reputation": 29, "user_id": 2180106, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4101fd5e400d599d60411d75bd200702?s=128&d=identicon&r=PG", "display_name": "Mor Haham", "link": "https://stackoverflow.com/users/2180106/mor-haham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1490385288, "creation_date": 1456351100, "last_edit_date": 1490385288, "question_id": 35614023, "link": "https://stackoverflow.com/questions/35614023/how-does-overriding-method-missing-work", "title": "How does overriding `method_missing` work?", "body": "<pre><code>o = Object.new\n\ndef o.method_missing(m,*args)\n  puts \"xxxxxxx #{m}\"\nend\n\np o.some_method\n</code></pre>\n\n<p>What is the underlying process of overriding a method?</p>\n"}, {"tags": ["ruby", "mongodb", "mongoid"], "answers": [{"tags": [], "owner": {"reputation": 552, "user_id": 841462, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d205d9fff8fced5303f186b94cc89bb7?s=128&d=identicon&r=PG", "display_name": "tufla", "link": "https://stackoverflow.com/users/841462/tufla"}, "is_accepted": false, "score": 0, "last_activity_date": 1456354201, "creation_date": 1456354201, "answer_id": 35614832, "question_id": 35613197, "link": "https://stackoverflow.com/questions/35613197/how-to-get-new-mongoid-indexes-for-a-model/35614832#35614832", "title": "How to get new mongoid indexes for a model", "body": "<p>Just found it...</p>\n\n<p>We can get the list of all index definitions into the model as follows:</p>\n\n<pre><code>Person.index_specifications\n</code></pre>\n\n<p>This is an array populated when the application is loaded and is used by the \"create_indexes\" method as can be seen here:</p>\n\n<p><a href=\"https://github.com/mongodb/mongoid/blob/master/lib/mongoid/indexable.rb\" rel=\"nofollow\">https://github.com/mongodb/mongoid/blob/master/lib/mongoid/indexable.rb</a></p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 6563996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae18ae9042f323506838086b41aea2ef?s=128&d=identicon&r=PG&f=1", "display_name": "liukgg", "link": "https://stackoverflow.com/users/6563996/liukgg"}, "is_accepted": false, "score": 5, "last_activity_date": 1467967002, "creation_date": 1467967002, "answer_id": 38262308, "question_id": 35613197, "link": "https://stackoverflow.com/questions/35613197/how-to-get-new-mongoid-indexes-for-a-model/38262308#38262308", "title": "How to get new mongoid indexes for a model", "body": "<pre><code>Person.index_specifications \n</code></pre>\n\n<p>shows the indexes defined in the model regardless of its existence in the database.</p>\n\n<p>And </p>\n\n<pre><code>Person.collection.indexes\n</code></pre>\n\n<p>only shows the index that actually exists in the database.</p>\n\n<p>So there is something else that is worth paying attention to:</p>\n\n<pre><code>rake db:mongoid:create_indexes \n</code></pre>\n\n<p>will create the indexes defined in the model in the database, and it uses the method 'index_specifications' in deed. </p>\n\n<p>While this removes all the indexes other than the index of the primary key:</p>\n\n<pre><code>rake db:mongoid:remove_indexes \n</code></pre>\n\n<p>So when you want to only remove the indexes that exists in the database but no longer defined in the database, you should use this:</p>\n\n<pre><code>rake db:mongoid:remove_undefined_indexes\n</code></pre>\n\n<p>which use the method 'undefined_indexes' in deed.</p>\n\n<p>I hope this can be helpful.</p>\n\n<p>The docs are here:</p>\n\n<p><a href=\"https://mongoid.github.io/en/mongoid/docs/indexing.html\" rel=\"noreferrer\">https://mongoid.github.io/en/mongoid/docs/indexing.html</a></p>\n\n<p><a href=\"http://www.rubydoc.info/github/mongoid/mongoid/Mongoid/Tasks/Database#create_indexes-instance_method\" rel=\"noreferrer\">http://www.rubydoc.info/github/mongoid/mongoid/Mongoid/Tasks/Database#create_indexes-instance_method</a></p>\n"}], "owner": {"reputation": 552, "user_id": 841462, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d205d9fff8fced5303f186b94cc89bb7?s=128&d=identicon&r=PG", "display_name": "tufla", "link": "https://stackoverflow.com/users/841462/tufla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3012, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1467967002, "creation_date": 1456348302, "last_edit_date": 1456351139, "question_id": 35613197, "link": "https://stackoverflow.com/questions/35613197/how-to-get-new-mongoid-indexes-for-a-model", "title": "How to get new mongoid indexes for a model", "body": "<p>Let's say I have defined my model Person with a couple of indexes:</p>\n\n<pre><code>class Person\n  include Mongoid::Document\n  field :email\n  field :ssn\n\n  index({ email: 1 }, { unique: true })\n  index({ ssn: 1 }, { unique: true })\nend\n</code></pre>\n\n<p>However, only the email index already exists in the database, so when I call</p>\n\n<pre><code>Person.collection.indexes.each {|i| puts i.inspect}\n</code></pre>\n\n<p>I get the following response:</p>\n\n<pre><code>{\"v\"=&gt;1, \"key\"=&gt;{\"_id\"=&gt;1}, \"name\"=&gt;\"_id_\", \"ns\"=&gt;\"x.person\"}\n{\"v\"=&gt;1, \"unique\"=&gt;true, \"key\"=&gt;{\"email\"=&gt;1}, \"name\"=&gt;\"email_1\", \"ns\"=&gt;\"x.person\"}\n</code></pre>\n\n<p>The question is, how can I get the list of defined indexes in the model, even if they are not already created in mongo ?</p>\n\n<p>In my case, such list should include the definition for the field \"ssn\"</p>\n\n<p>In other words...How to get those indexes that haven't been created yet ?</p>\n"}, {"tags": ["ios", "ruby", "digital-signature", "sha256", "hmac"], "comments": [{"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1456350973, "post_id": 35613059, "comment_id": 58911674, "body": "To get you started, ruby&#39;s default encoding is not ASCII as per your iOS code. Use <code>key.encoding</code> for a clue."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1456353553, "post_id": 35613059, "comment_id": 58913004, "body": "Have you taken a moment to look at the actual value of <code>key</code> in the Ruby code? <code>String#unpack</code> returns an array, and calling <code>to_s</code> on that array returns a string that looks like this, brackets and all: <code>[&quot;e,\\x84P\\xB6R*VR\\xFD,cQ\\xB2\\x86\\xD5\\xC...&quot;]</code>. I have a feeling that&#39;s not the string you actually want to use as your key."}, {"owner": {"reputation": 1, "user_id": 2199955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b034e68b7120a7503e1e592847a27c94?s=128&d=identicon&r=PG", "display_name": "Lugoland", "link": "https://stackoverflow.com/users/2199955/lugoland"}, "edited": false, "score": 0, "creation_date": 1456354937, "post_id": 35613059, "comment_id": 58913577, "body": "Hey Jordan , yes I know how the unpack looks on Ruby, and this is what i want to use for that function , unfortunately i can&#39;t change the ruby code. &quot;e,\\204P\\266R<i>VR&#253;,cQ&#178;&#213;&#201;r&#215;H2\\277\\257!\\274&#231;a^\\220,\\023&quot; is the unpack.to_s from ruby . I tried to decode64 on ios to of the key and im getting something similar but without the octates  &quot;e,P&#182;R</i>VR&#253;,cQ&#178;&#213;&#201;r&#215;H2&#191;&#175;!&#188;&#231;a^,&quot; but when i use that as the key i get a nil cKey and the code breaks..."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2199955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b034e68b7120a7503e1e592847a27c94?s=128&d=identicon&r=PG", "display_name": "Lugoland", "link": "https://stackoverflow.com/users/2199955/lugoland"}, "is_accepted": false, "score": 0, "last_activity_date": 1456411999, "creation_date": 1456411999, "answer_id": 35630679, "question_id": 35613059, "link": "https://stackoverflow.com/questions/35613059/ios-api-key-from-ruby-code/35630679#35630679", "title": "iOS API key From Ruby Code", "body": "<p>This what at the end worked for me. </p>\n\n<pre><code>NSData *saltData = [[NSData alloc] initWithBase64EncodedString:key options:0];\nNSData *paramData = [somdata dataUsingEncoding:NSASCIIStringEncoding];\nNSMutableData* hash = [NSMutableData dataWithLength:CC_SHA256_DIGEST_LENGTH ];\nCCHmac(kCCHmacAlgSHA256, saltData.bytes, saltData.length, paramData.bytes, paramData.length, hash.mutableBytes);\nNSString *base64Hash = [hash base64EncodedStringWithOptions:0];\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2199955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b034e68b7120a7503e1e592847a27c94?s=128&d=identicon&r=PG", "display_name": "Lugoland", "link": "https://stackoverflow.com/users/2199955/lugoland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456411999, "creation_date": 1456347851, "last_edit_date": 1456349632, "question_id": 35613059, "link": "https://stackoverflow.com/questions/35613059/ios-api-key-from-ruby-code", "title": "iOS API key From Ruby Code", "body": "<p>I have this code in Ruby which generates a Digital Signature based on an API KEY and some content, i have try to create some iOS code to replicate this but no success can someone help me out.</p>\n\n<p>Ruby</p>\n\n<pre><code>key = \"ZSyEULZSKlZS/SxjUbKG1cly10gyv68hvOeIYV6QLBM=\".unpack('m*').to_s\nhmac = HMAC::SHA256.new key\ns = \"some\\nrandom\\data\\n\"\nhmac &lt;&lt; s\nds_coded = [hmac.digest].pack('m*')\n</code></pre>\n\n<p>iOS</p>\n\n<pre><code>const char *cKey  = [@\"ZSyEULZSKlZS/SxjUbKG1cly10gyv68hvOeIYV6QLBM=\" cStringUsingEncoding:NSASCIIStringEncoding];\nconst char *cData = [@\"some\\nrandom\\data\\n\" cStringUsingEncoding:NSASCIIStringEncoding];\nunsigned char cHMAC[CC_SHA256_DIGEST_LENGTH];\nCCHmac(kCCHmacAlgSHA256, cKey, strlen(cKey),cData , strlen(cData), cHMAC);\nNSData *HMAC = [[NSData alloc] initWithBytes:cHMAC length:sizeof(cHMAC)];\nNSString *hash = NSString *hash = [HMAC base64EncodedStringWithOptions:0];\n</code></pre>\n\n<p>Both digital signature are always different. What can i change in my iOS code to make it the same as the Ruby code.</p>\n\n<p>thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 238, "user_id": 1550641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12707c89f9273d106ccbf8fd771f9e95?s=128&d=identicon&r=PG", "display_name": "Meer", "link": "https://stackoverflow.com/users/1550641/meer"}, "edited": false, "score": 0, "creation_date": 1456348393, "post_id": 35612876, "comment_id": 58910218, "body": "For any one of the workout_set, the exercise does not exists. you can add the try block to handle exception in such cases. e.g workout_set.exercise.try(:name). Hope this helps."}, {"owner": {"reputation": 238, "user_id": 1550641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12707c89f9273d106ccbf8fd771f9e95?s=128&d=identicon&r=PG", "display_name": "Meer", "link": "https://stackoverflow.com/users/1550641/meer"}, "edited": false, "score": 0, "creation_date": 1456348483, "post_id": 35612876, "comment_id": 58910267, "body": "Also you should take into consideration @Rocco suggestion&#39;s below however they are not the cause of this error."}], "answers": [{"comments": [{"owner": {"reputation": 978, "user_id": 202291, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8EcL5.jpg?s=128&g=1", "display_name": "anger", "link": "https://stackoverflow.com/users/202291/anger"}, "edited": false, "score": 0, "creation_date": 1456348691, "post_id": 35613129, "comment_id": 58910383, "body": "These relationships aren&#39;t required as I do not need to navigate from Exercise to WorkoutSet"}, {"owner": {"reputation": 655, "user_id": 4916648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/cpT8L.png?s=128&g=1", "display_name": "SomeSchmo", "link": "https://stackoverflow.com/users/4916648/someschmo"}, "reply_to_user": {"reputation": 978, "user_id": 202291, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8EcL5.jpg?s=128&g=1", "display_name": "anger", "link": "https://stackoverflow.com/users/202291/anger"}, "edited": false, "score": 0, "creation_date": 1456349074, "post_id": 35613129, "comment_id": 58910599, "body": "It&#39;s still probably a good idea to set that sort of data relationship up early"}, {"owner": {"reputation": 978, "user_id": 202291, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8EcL5.jpg?s=128&g=1", "display_name": "anger", "link": "https://stackoverflow.com/users/202291/anger"}, "edited": false, "score": 0, "creation_date": 1456349214, "post_id": 35613129, "comment_id": 58910684, "body": "I disagree.  If I plan on having hundreds of thousands of WorkoutSets I would never want to load them all from an Exercise."}, {"owner": {"reputation": 655, "user_id": 4916648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/cpT8L.png?s=128&g=1", "display_name": "SomeSchmo", "link": "https://stackoverflow.com/users/4916648/someschmo"}, "reply_to_user": {"reputation": 978, "user_id": 202291, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8EcL5.jpg?s=128&g=1", "display_name": "anger", "link": "https://stackoverflow.com/users/202291/anger"}, "edited": false, "score": 0, "creation_date": 1456349654, "post_id": 35613129, "comment_id": 58910919, "body": "Active Record doesn&#39;t do that. It would load them in a separate query (which where the n+1 query issue often occurs) unless you eager load them (<code>Exercise.first</code> wouldn&#39;t load all its associated WorkoutSets <code>Exercise.includes(:workout_sets).first</code> would)"}, {"owner": {"reputation": 978, "user_id": 202291, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8EcL5.jpg?s=128&g=1", "display_name": "anger", "link": "https://stackoverflow.com/users/202291/anger"}, "edited": false, "score": 0, "creation_date": 1456350279, "post_id": 35613129, "comment_id": 58911296, "body": "I realise it&#39;s not an eager fetch.  My point is that I don&#39;t see the point in adding code that I never would want to call.  Also in response to your point regarding the foreign key, this was generated automatically from the rails migration <code>add_reference :workout_sets, :exercises, index: true, foreign_key: true</code>"}, {"owner": {"reputation": 655, "user_id": 4916648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/cpT8L.png?s=128&g=1", "display_name": "SomeSchmo", "link": "https://stackoverflow.com/users/4916648/someschmo"}, "reply_to_user": {"reputation": 978, "user_id": 202291, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8EcL5.jpg?s=128&g=1", "display_name": "anger", "link": "https://stackoverflow.com/users/202291/anger"}, "edited": false, "score": 0, "creation_date": 1456351922, "post_id": 35613129, "comment_id": 58912193, "body": "Because it paints a better picture of how your data is structured for anyone else who might have to look at the code. As for the foreign keys, it&#39;s pluralizing a singular thing. To each their own though."}, {"owner": {"reputation": 978, "user_id": 202291, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8EcL5.jpg?s=128&g=1", "display_name": "anger", "link": "https://stackoverflow.com/users/202291/anger"}, "reply_to_user": {"reputation": 655, "user_id": 4916648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/cpT8L.png?s=128&g=1", "display_name": "SomeSchmo", "link": "https://stackoverflow.com/users/4916648/someschmo"}, "edited": false, "score": 0, "creation_date": 1456352061, "post_id": 35613129, "comment_id": 58912276, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/104483/discussion-between-anger-and-rocco-basso\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 655, "user_id": 4916648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/cpT8L.png?s=128&g=1", "display_name": "SomeSchmo", "link": "https://stackoverflow.com/users/4916648/someschmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1456348610, "last_edit_date": 1456348610, "creation_date": 1456348108, "answer_id": 35613129, "question_id": 35612876, "link": "https://stackoverflow.com/questions/35612876/rails-activerecord-belongs-to-association-not-loading/35613129#35613129", "title": "Rails ActiveRecord belongs_to association not loading", "body": "<p>You haven't set up the relationship in the Exercise model</p>\n\n<pre><code>class Exercise &lt; ActiveRecord::Base\n  has_many :workout_sets\n  has_many :workouts, through: :workouts_sets #not needed but good to setup\nend\n</code></pre>\n\n<p>or if you're trying to do a 1-to-1 relationship between Exercise and WorkoutSet</p>\n\n<pre><code>class Exercise &lt; ActiveRecord::Base\n  has_one :workout_set\nend\n</code></pre>\n\n<p>Also having an 's' at the end of the foreign keys in your workout_sets table (i.e. 'workouts_id') is somewhat bad form. I'm pretty sure Rails will be smart enough to make it work but if you run into more bugs I'd try changing those to 'workout_id' and 'exercise_id'.</p>\n"}, {"comments": [{"owner": {"reputation": 978, "user_id": 202291, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8EcL5.jpg?s=128&g=1", "display_name": "anger", "link": "https://stackoverflow.com/users/202291/anger"}, "edited": false, "score": 0, "creation_date": 1456348629, "post_id": 35613227, "comment_id": 58910349, "body": "You are correct, I indeed had some old data in there.  Thanks a bunch."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1456349273, "post_id": 35613227, "comment_id": 58910713, "body": "<code>workout_set.exercise.name unless workout_set.exercise.blank?</code> can be simplified to <code>workout_set.exercise.try(:name) || &#39;no exercise for this set&#39;</code>"}, {"owner": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1456349950, "post_id": 35613227, "comment_id": 58911093, "body": "@MrYoshiji thanks. I don&#39;t always remember to use <code>try()</code>"}], "tags": [], "owner": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "is_accepted": true, "score": 2, "last_activity_date": 1456348390, "creation_date": 1456348390, "answer_id": 35613227, "question_id": 35612876, "link": "https://stackoverflow.com/questions/35612876/rails-activerecord-belongs-to-association-not-loading/35613227#35613227", "title": "Rails ActiveRecord belongs_to association not loading", "body": "<p>One of your <code>WorkoutSet</code> does not have an associated <code>Exercise</code>. You can enforce that a <code>WorkoutSet</code> has an exercise <code>Exercise</code> in your <code>WorkoutSet</code> model but there are implications to that. Mainly, you could not create a <code>WorkoutSet</code> without first creating the <code>Exercise</code>. If that's what you want then add the following to the <code>WorkoutSet</code> model.</p>\n\n<pre><code>validates_presence_of :exercise_id\n</code></pre>\n\n<p>More likely though, you just want to handle the page crashing when there is no associated <code>Exercise</code>.</p>\n\n<pre><code>&lt;td&gt;&lt;%= workout_set.exercise.name unless workout_set.exercise.blank?  %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>That will give you a blank cell but you can do something like this to have a placeholder.</p>\n\n<pre><code>&lt;td&gt;&lt;%= workout_set.exercise.blank? ? \"No exercise for this set\" : workout_set.exercise.name %&gt;&lt;/td&gt;\n</code></pre>\n"}], "owner": {"reputation": 978, "user_id": 202291, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8EcL5.jpg?s=128&g=1", "display_name": "anger", "link": "https://stackoverflow.com/users/202291/anger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 35613227, "answer_count": 2, "score": 3, "last_activity_date": 1456348610, "creation_date": 1456347211, "question_id": 35612876, "link": "https://stackoverflow.com/questions/35612876/rails-activerecord-belongs-to-association-not-loading", "title": "Rails ActiveRecord belongs_to association not loading", "body": "<p>I am trying to render a list of Active Records as follows:</p>\n\n<pre><code>&lt;% @workout_sets.each do |workout_set| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= workout_set.reps %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= workout_set.exercise.name %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Show', workout_set %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Edit', edit_workout_set_path(workout_set) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Destroy', workout_set, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My AR setup looks like:</p>\n\n<pre><code>class WorkoutSet &lt; ActiveRecord::Base\n  belongs_to :workout\n  belongs_to :exercise, class_name: 'Exercise', foreign_key: 'exercises_id'\nend\n\nclass Exercise &lt; ActiveRecord::Base\nend\n\nclass Workout &lt; ActiveRecord::Base\n  has_many :workout_set\nend\n</code></pre>\n\n<p>and my schema is</p>\n\n<pre><code>create_table \"exercises\", force: :cascade do |t|\n  t.string   \"name\",       null: false\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n\nadd_index \"exercises\", [\"name\"], name: \"index_exercises_on_name\", unique: true\n\ncreate_table \"workout_sets\", force: :cascade do |t|\n  t.integer  \"reps\",         null: false\n  t.datetime \"created_at\",   null: false\n  t.datetime \"updated_at\",   null: false\n  t.integer  \"exercises_id\"\n t.integer  \"workouts_id\"\nend\n\nadd_index \"workout_sets\", [\"exercises_id\"], name: \"index_workout_sets_on_exercises_id\"\nadd_index \"workout_sets\", [\"workouts_id\"], name: \"index_workout_sets_on_workouts_id\"\n\ncreate_table \"workouts\", force: :cascade do |t|\n  t.string   \"location\",   null: false\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n</code></pre>\n\n<p>In attempting to render the page I get the following error</p>\n\n<blockquote>\n  <p>undefined method `name' for nil:NilClass</p>\n</blockquote>\n\n<p>When I change the path in my template to <code>&lt;%= workout_set.exercise %&gt;</code> it renders each row like <code>444    #&lt;Exercise:0x007fbde9dde998&gt;    Show    Edit    Destroy</code> which is what I expect.  </p>\n\n<p>Why is the the attempted access of the name property causing this error?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 12200, "user_id": 473040, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c2713a4959692f16d27d2553fb06cc4b?s=128&d=identicon&r=PG", "display_name": "equivalent8", "link": "https://stackoverflow.com/users/473040/equivalent8"}, "edited": false, "score": 0, "creation_date": 1456347377, "post_id": 35612847, "comment_id": 58909696, "body": "<code>ActionView::Template::Error (&quot;en_us&quot; is not a valid locale)</code> is the error.  <code>2016-02-24T18:04:47.480802+00:00 app[web.1]:     25:   &lt;dd&gt;&lt;%= number_to_currency(@sailing_class.price, :locale =&gt; &#39;en_us&#39;, :precision =&gt; 0) %&gt;&lt;&#47;dd&gt;</code>   are you sure that you have <code>config&#47;locales&#47;en_us.yml</code> ?"}, {"owner": {"reputation": 12200, "user_id": 473040, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c2713a4959692f16d27d2553fb06cc4b?s=128&d=identicon&r=PG", "display_name": "equivalent8", "link": "https://stackoverflow.com/users/473040/equivalent8"}, "edited": false, "score": 0, "creation_date": 1456347428, "post_id": 35612847, "comment_id": 58909720, "body": "try maybe using <code>locale: &#39;en&#39;</code>  instead of locale: ` &#39;en_us&#39;`"}, {"owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "edited": false, "score": 0, "creation_date": 1456349616, "post_id": 35612847, "comment_id": 58910896, "body": "Any chance you are vendoring gems and including the natively-compiled extensions? I&#39;ve seen this error before and it came from using native extensions compiled on another machine."}, {"owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "edited": false, "score": 0, "creation_date": 1456349936, "post_id": 35612847, "comment_id": 58911087, "body": "Btw if you can&#39;t run <code>bundle install</code> how can you say &quot;it works fine locally&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 729, "user_id": 1113875, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1fd324dc88c50366a49f0510f7c30c76?s=128&d=identicon&r=PG", "display_name": "Scott S.", "link": "https://stackoverflow.com/users/1113875/scott-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1456366805, "last_edit_date": 1495541741, "creation_date": 1456366805, "answer_id": 35617044, "question_id": 35612847, "link": "https://stackoverflow.com/questions/35612847/app-on-heroku-wont-update-items-works-fine-in-development/35617044#35617044", "title": "App on Heroku won&#39;t update items, works fine in development", "body": "<p>Ok, I got it fixed. </p>\n\n<p><a href=\"https://stackoverflow.com/users/473040/equivalent8\">equivalent8</a>, you were right, I needed to change the locale to 'en\". But, then it exposed a problem with therubyracer gem.</p>\n\n<p>To fix that I needed to do what I found in <a href=\"https://stackoverflow.com/questions/19630154/gem-install-therubyracer-v-0-10-2-on-osx-mavericks-not-installing/20145328#20145328\">this post</a>.</p>\n"}], "owner": {"reputation": 729, "user_id": 1113875, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1fd324dc88c50366a49f0510f7c30c76?s=128&d=identicon&r=PG", "display_name": "Scott S.", "link": "https://stackoverflow.com/users/1113875/scott-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456366805, "creation_date": 1456347137, "last_edit_date": 1495542668, "question_id": 35612847, "link": "https://stackoverflow.com/questions/35612847/app-on-heroku-wont-update-items-works-fine-in-development", "title": "App on Heroku won&#39;t update items, works fine in development", "body": "<p>I'm more than a bit confused on this one.</p>\n\n<p>I have an app and it works fine locally. However, if I try to update an item in production on Heroku, it won't update and I get a \"We're sorry, but something went wrong.\" message.</p>\n\n<p>I've looked at several answers to similar questions and I haven't found a solution yet. Things I've tried:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/5385172/heroku-language-locale-not-working\">This one</a> seemed promising but I'm only running english.</li>\n<li>Same with <a href=\"https://stackoverflow.com/questions/7868309/heroku-not-loading-language-file\">this one</a> and <a href=\"https://stackoverflow.com/questions/2782007/heroku-and-i18n-problems\">this one</a></li>\n</ul>\n\n<p>I then started to start checking my gems. I ran bundle update and saw problems with nokigiri which led me down the path of <a href=\"https://stackoverflow.com/questions/17204152/nokogiri-error-when-running-bundle-install\">this</a> and <a href=\"https://stackoverflow.com/questions/29020478/error-installing-nokogiri-on-bundle-install-but-already-installed\">this</a> and <a href=\"https://stackoverflow.com/questions/27496498/failing-to-install-nokogiri-gem\">this</a>. But nothing has worked so far.</p>\n\n<p>I've downloaded and updated the Command Line tools to the most recent version as specified <a href=\"https://stackoverflow.com/questions/17204152/nokogiri-error-when-running-bundle-install\">here</a> too.</p>\n\n<p>Here are my heroku logs:</p>\n\n<pre><code>2016-02-24T18:03:37.639284+00:00 app[web.1]: \n2016-02-24T18:03:37.639347+00:00 app[web.1]:     23:   &lt;dd&gt;&lt;%= @sailing_class.limit %&gt;&lt;/dd&gt;\n2016-02-24T18:03:37.639353+00:00 app[web.1]: \n2016-02-24T18:03:37.639279+00:00 app[web.1]:     26:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:unit) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:03:37.639351+00:00 app[web.1]:   app/views/sailing_classes/show.html.erb:25:in `_app_views_sailing_classes_show_html_erb___4311253642492843941_69812114208320'\n2016-02-24T18:03:37.639347+00:00 app[web.1]:     24:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:price) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:03:37.639281+00:00 app[web.1]:     28:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:link) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:03:37.639353+00:00 app[web.1]: \n2016-02-24T18:03:37.639349+00:00 app[web.1]:     26:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:unit) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:03:37.616956+00:00 app[web.1]:   Parameters: {\"id\"=&gt;\"1\"}\n2016-02-24T18:03:37.639352+00:00 app[web.1]:   app/controllers/sailing_classes_controller.rb:18:in `show'\n2016-02-24T18:03:37.639346+00:00 app[web.1]:     22:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:limit) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:03:37.639348+00:00 app[web.1]:     25:   &lt;dd&gt;&lt;%= number_to_currency(@sailing_class.price, :locale =&gt; 'en_us', :precision =&gt; 0) %&gt;&lt;/dd&gt;\n2016-02-24T18:03:37.639277+00:00 app[web.1]:     23:   &lt;dd&gt;&lt;%= @sailing_class.limit %&gt;&lt;/dd&gt;\n2016-02-24T18:03:37.505267+00:00 heroku[router]: at=info method=POST path=\"/sailing_classes/1\" host=www.clssmi.com request_id=a2b0cdcf-8591-4039-9b5f-d12d09caf37f fwd=\"50.172.246.24\" dyno=web.1 connect=0ms service=138ms status=302 bytes=1153\n2016-02-24T18:03:37.639350+00:00 app[web.1]:     27:   &lt;dd&gt;&lt;%= @sailing_class.unit %&gt;&lt;/dd&gt;\n2016-02-24T18:03:37.608121+00:00 heroku[router]: at=info method=GET path=\"/sailing_classes/1\" host=www.clssmi.com request_id=9fe48739-dc16-41ed-a8ba-668e047543d1 fwd=\"50.172.246.24\" dyno=web.1 connect=1ms service=35ms status=500 bytes=919\n2016-02-24T18:03:37.615055+00:00 app[web.1]: Started GET \"/sailing_classes/1\" for 50.172.246.24 at 2016-02-24 18:03:37 +0000\n2016-02-24T18:03:37.882720+00:00 heroku[router]: at=info method=GET path=\"/favicon.ico\" host=www.clssmi.com request_id=2ea318c8-6a64-409d-aa99-9892af1065f8 fwd=\"50.172.246.24\" dyno=web.1 connect=0ms service=14ms status=304 bytes=133\n2016-02-24T18:03:43.427418+00:00 app[web.1]: Processing by SailingClassesController#index as HTML\n2016-02-24T18:03:43.426514+00:00 app[web.1]: Started GET \"/sailing_classes\" for 50.172.246.24 at 2016-02-24 18:03:43 +0000\n2016-02-24T18:03:43.427414+00:00 app[web.1]: Processing by SailingClassesController#index as HTML\n2016-02-24T18:03:43.453065+00:00 app[web.1]: Completed 200 OK in 26ms (Views: 20.6ms | ActiveRecord: 4.4ms)\n2016-02-24T18:03:43.451359+00:00 app[web.1]:   Rendered sailing_classes/index.html.erb within layouts/application (23.0ms)\n2016-02-24T18:03:43.426518+00:00 app[web.1]: Started GET \"/sailing_classes\" for 50.172.246.24 at 2016-02-24 18:03:43 +0000\n2016-02-24T18:03:43.451365+00:00 app[web.1]:   Rendered sailing_classes/index.html.erb within layouts/application (23.0ms)\n2016-02-24T18:03:43.453070+00:00 app[web.1]: Completed 200 OK in 26ms (Views: 20.6ms | ActiveRecord: 4.4ms)\n2016-02-24T18:03:43.423880+00:00 heroku[router]: at=info method=GET path=\"/sailing_classes\" host=www.clssmi.com request_id=8b816065-1802-4a00-ae19-457f0fd95234 fwd=\"50.172.246.24\" dyno=web.1 connect=0ms service=35ms status=200 bytes=22475\n2016-02-24T18:03:43.555976+00:00 heroku[router]: at=info method=GET path=\"/assets/application-18e331053335285eeca7290a575ccd04.js\" host=www.clssmi.com request_id=efd055c7-1301-41ed-8e37-dbf832b9f720 fwd=\"50.172.246.24\" dyno=web.1 connect=0ms service=4ms status=304 bytes=133\n2016-02-24T18:03:44.048723+00:00 heroku[router]: at=info method=GET path=\"/favicon.ico\" host=www.clssmi.com request_id=2bc7d207-a01c-4a0f-8b97-6ede689acd4d fwd=\"50.172.246.24\" dyno=web.1 connect=1ms service=4ms status=200 bytes=228\n2016-02-24T18:03:43.561012+00:00 heroku[router]: at=info method=GET path=\"/assets/application-4f42f332e5c3dd07dc6c8b9c3e70c386.css\" host=www.clssmi.com request_id=9eb0e376-b2b7-4ffa-a4e5-b1cf0ad609fb fwd=\"50.172.246.24\" dyno=web.1 connect=0ms service=4ms status=304 bytes=133\n2016-02-24T18:04:39.694568+00:00 app[web.1]:   Rendered sailing_classes/_form.html.erb (16.8ms)\n2016-02-24T18:04:39.694819+00:00 app[web.1]:   Rendered sailing_classes/edit.html.erb within layouts/application (17.8ms)\n2016-02-24T18:04:39.671315+00:00 app[web.1]: Started GET \"/sailing_classes/1/edit\" for 50.172.246.24 at 2016-02-24 18:04:39 +0000\n2016-02-24T18:04:39.671562+00:00 app[web.1]: Started GET \"/sailing_classes/1/edit\" for 50.172.246.24 at 2016-02-24 18:04:39 +0000\n2016-02-24T18:04:39.672944+00:00 app[web.1]: Processing by SailingClassesController#edit as HTML\n2016-02-24T18:04:39.673052+00:00 app[web.1]:   Parameters: {\"id\"=&gt;\"1\"}\n2016-02-24T18:04:39.673006+00:00 app[web.1]: Processing by SailingClassesController#edit as HTML\n2016-02-24T18:04:39.673082+00:00 app[web.1]:   Parameters: {\"id\"=&gt;\"1\"}\n2016-02-24T18:04:39.694613+00:00 app[web.1]:   Rendered sailing_classes/_form.html.erb (16.8ms)\n2016-02-24T18:04:39.694854+00:00 app[web.1]:   Rendered sailing_classes/edit.html.erb within layouts/application (17.8ms)\n2016-02-24T18:04:39.699681+00:00 app[web.1]: Completed 200 OK in 26ms (Views: 20.9ms | ActiveRecord: 4.2ms)\n2016-02-24T18:04:39.699750+00:00 app[web.1]: Completed 200 OK in 26ms (Views: 20.9ms | ActiveRecord: 4.2ms)\n2016-02-24T18:04:39.668594+00:00 heroku[router]: at=info method=GET path=\"/sailing_classes/1/edit\" host=www.clssmi.com request_id=ae08f28d-50c3-4916-bc5d-b7aabd06e2d0 fwd=\"50.172.246.24\" dyno=web.1 connect=0ms service=37ms status=200 bytes=16848\n2016-02-24T18:04:39.850919+00:00 heroku[router]: at=info method=GET path=\"/assets/application-4f42f332e5c3dd07dc6c8b9c3e70c386.css\" host=www.clssmi.com request_id=bc003cf8-94a1-423e-9d07-912e01cd15e5 fwd=\"50.172.246.24\" dyno=web.1 connect=0ms service=13ms status=304 bytes=133\n2016-02-24T18:04:47.344532+00:00 app[web.1]: Started PATCH \"/sailing_classes/1\" for 50.172.246.24 at 2016-02-24 18:04:47 +0000\n2016-02-24T18:04:47.344539+00:00 app[web.1]: Started PATCH \"/sailing_classes/1\" for 50.172.246.24 at 2016-02-24 18:04:47 +0000\n2016-02-24T18:04:47.346227+00:00 app[web.1]: Processing by SailingClassesController#update as HTML\n2016-02-24T18:04:47.386299+00:00 app[web.1]: Completed 302 Found in 40ms (ActiveRecord: 25.8ms)\n2016-02-24T18:04:47.480815+00:00 app[web.1]:     26:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:unit) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:04:47.386028+00:00 app[web.1]: Redirected to http://www.clssmi.com/sailing_classes/1\n2016-02-24T18:04:47.386304+00:00 app[web.1]: Completed 302 Found in 40ms (ActiveRecord: 25.8ms)\n2016-02-24T18:04:47.480816+00:00 app[web.1]:     28:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:link) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:04:47.480816+00:00 app[web.1]:   app/views/sailing_classes/show.html.erb:25:in `_app_views_sailing_classes_show_html_erb___4311253642492843941_69812114208320'\n2016-02-24T18:04:47.480815+00:00 app[web.1]:     27:   &lt;dd&gt;&lt;%= @sailing_class.unit %&gt;&lt;/dd&gt;\n2016-02-24T18:04:47.480817+00:00 app[web.1]:   app/controllers/sailing_classes_controller.rb:18:in `show'\n2016-02-24T18:04:47.459326+00:00 app[web.1]: Started GET \"/sailing_classes/1\" for 50.172.246.24 at 2016-02-24 18:04:47 +0000\n2016-02-24T18:04:47.477060+00:00 app[web.1]: Completed 500 Internal Server Error in 17ms\n2016-02-24T18:04:47.459330+00:00 app[web.1]: Started GET \"/sailing_classes/1\" for 50.172.246.24 at 2016-02-24 18:04:47 +0000\n2016-02-24T18:04:47.460391+00:00 app[web.1]: Processing by SailingClassesController#show as HTML\n2016-02-24T18:04:47.385841+00:00 app[web.1]: Redirected to http://www.clssmi.com/sailing_classes/1\n2016-02-24T18:04:47.460394+00:00 app[web.1]:   Parameters: {\"id\"=&gt;\"1\"}\n2016-02-24T18:04:47.480800+00:00 app[web.1]:     23:   &lt;dd&gt;&lt;%= @sailing_class.limit %&gt;&lt;/dd&gt;\n2016-02-24T18:04:47.480817+00:00 app[web.1]: \n2016-02-24T18:04:47.480817+00:00 app[web.1]: \n2016-02-24T18:04:47.476956+00:00 app[web.1]:   Rendered sailing_classes/show.html.erb within layouts/application (4.7ms)\n2016-02-24T18:04:47.346365+00:00 app[web.1]:   Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"kSzhpZMMK53yfJkRpU75csCW3m9MEQnvAxZcCeNpqGk=\", \"sailing_class\"=&gt;{\"name\"=&gt;\"KID LEARN TO SAIL&amp;mdash;LEVEL ONE OPTI\", \"start_date(1i)\"=&gt;\"2016\", \"start_date(2i)\"=&gt;\"6\", \"start_date(3i)\"=&gt;\"20\", \"end_date(1i)\"=&gt;\"2016\", \"end_date(2i)\"=&gt;\"8\", \"end_date(3i)\"=&gt;\"5\", \"classtime\"=&gt;\"10:00 - 12:30\", \"days_of_week\"=&gt;\"Classes run weekly June 22 - August 7, Monday - Friday (rain or shine). \", \"description\"=&gt;\"Our Level One Opti class is designed for younger and more inexperienced sailors.  We teach the basics of sailing and sailboat maneuvering, as well as essential sailing terminology.  The only prerequisite for Level 1 is that the participant be able to swim at least 25 yards, tread water for a minute, and put a life jacket on in the water.\\r\\n\\r\\n\", \"restriction\"=&gt;\"Recommended for kids ages 7 - 11\", \"limit\"=&gt;\"22 students\", \"price\"=&gt;\"150.00\", \"unit\"=&gt;\"per week\", \"sort_order\"=&gt;\"1\", \"link\"=&gt;\"\"}, \"commit\"=&gt;\"Update Sailing class\", \"id\"=&gt;\"1\"}\n2016-02-24T18:04:47.480803+00:00 app[web.1]:     27:   &lt;dd&gt;&lt;%= @sailing_class.unit %&gt;&lt;/dd&gt;\n2016-02-24T18:04:47.480802+00:00 app[web.1]:     25:   &lt;dd&gt;&lt;%= number_to_currency(@sailing_class.price, :locale =&gt; 'en_us', :precision =&gt; 0) %&gt;&lt;/dd&gt;\n2016-02-24T18:04:47.480788+00:00 app[web.1]:     22:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:limit) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:04:47.480805+00:00 app[web.1]:   app/views/sailing_classes/show.html.erb:25:in `_app_views_sailing_classes_show_html_erb___4311253642492843941_69812114208320'\n2016-02-24T18:04:47.346249+00:00 app[web.1]: Processing by SailingClassesController#update as HTML\n2016-02-24T18:04:47.480806+00:00 app[web.1]:   app/controllers/sailing_classes_controller.rb:18:in `show'\n2016-02-24T18:04:47.460393+00:00 app[web.1]:   Parameters: {\"id\"=&gt;\"1\"}\n2016-02-24T18:04:47.346386+00:00 app[web.1]:   Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"kSzhpZMMK53yfJkRpU75csCW3m9MEQnvAxZcCeNpqGk=\", \"sailing_class\"=&gt;{\"name\"=&gt;\"KID LEARN TO SAIL&amp;mdash;LEVEL ONE OPTI\", \"start_date(1i)\"=&gt;\"2016\", \"start_date(2i)\"=&gt;\"6\", \"start_date(3i)\"=&gt;\"20\", \"end_date(1i)\"=&gt;\"2016\", \"end_date(2i)\"=&gt;\"8\", \"end_date(3i)\"=&gt;\"5\", \"classtime\"=&gt;\"10:00 - 12:30\", \"days_of_week\"=&gt;\"Classes run weekly June 22 - August 7, Monday - Friday (rain or shine). \", \"description\"=&gt;\"Our Level One Opti class is designed for younger and more inexperienced sailors.  We teach the basics of sailing and sailboat maneuvering, as well as essential sailing terminology.  The only prerequisite for Level 1 is that the participant be able to swim at least 25 yards, tread water for a minute, and put a life jacket on in the water.\\r\\n\\r\\n\", \"restriction\"=&gt;\"Recommended for kids ages 7 - 11\", \"limit\"=&gt;\"22 students\", \"price\"=&gt;\"150.00\", \"unit\"=&gt;\"per week\", \"sort_order\"=&gt;\"1\", \"link\"=&gt;\"\"}, \"commit\"=&gt;\"Update Sailing class\", \"id\"=&gt;\"1\"}\n2016-02-24T18:04:47.460389+00:00 app[web.1]: Processing by SailingClassesController#show as HTML\n2016-02-24T18:04:47.480812+00:00 app[web.1]: \n2016-02-24T18:04:47.480814+00:00 app[web.1]:     24:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:price) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:04:47.480784+00:00 app[web.1]: \n2016-02-24T18:04:47.476953+00:00 app[web.1]:   Rendered sailing_classes/show.html.erb within layouts/application (4.7ms)\n2016-02-24T18:04:47.480803+00:00 app[web.1]:     26:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:unit) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:04:47.480806+00:00 app[web.1]: \n2016-02-24T18:04:47.480787+00:00 app[web.1]: ActionView::Template::Error (\"en_us\" is not a valid locale):\n2016-02-24T18:04:47.480807+00:00 app[web.1]: \n2016-02-24T18:04:47.477063+00:00 app[web.1]: Completed 500 Internal Server Error in 17ms\n2016-02-24T18:04:47.480812+00:00 app[web.1]: ActionView::Template::Error (\"en_us\" is not a valid locale):\n2016-02-24T18:04:47.480804+00:00 app[web.1]:     28:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:link) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:04:47.480801+00:00 app[web.1]:     24:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:price) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:04:47.480813+00:00 app[web.1]:     23:   &lt;dd&gt;&lt;%= @sailing_class.limit %&gt;&lt;/dd&gt;\n2016-02-24T18:04:47.480813+00:00 app[web.1]:     22:   &lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:limit) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n2016-02-24T18:04:47.480814+00:00 app[web.1]:     25:   &lt;dd&gt;&lt;%= number_to_currency(@sailing_class.price, :locale =&gt; 'en_us', :precision =&gt; 0) %&gt;&lt;/dd&gt;\n2016-02-24T18:04:49.749766+00:00 app[web.1]: Started HEAD \"/\" for 50.112.95.211 at 2016-02-24 18:04:49 +0000\n2016-02-24T18:04:49.751717+00:00 app[web.1]: Processing by PagesController#home as */*\n2016-02-24T18:04:49.751734+00:00 app[web.1]: Processing by PagesController#home as */*\n2016-02-24T18:04:49.753210+00:00 app[web.1]:   Rendered pages/home.html.erb within layouts/application (0.5ms)\n2016-02-24T18:04:49.753265+00:00 app[web.1]:   Rendered pages/home.html.erb within layouts/application (0.5ms)\n2016-02-24T18:04:49.755358+00:00 app[web.1]: Completed 200 OK in 4ms (Views: 3.1ms | ActiveRecord: 0.0ms)\n2016-02-24T18:04:49.755409+00:00 app[web.1]: Completed 200 OK in 4ms (Views: 3.1ms | ActiveRecord: 0.0ms)\n2016-02-24T18:04:49.749744+00:00 app[web.1]: Started HEAD \"/\" for 50.112.95.211 at 2016-02-24 18:04:49 +0000\n2016-02-24T18:04:39.895627+00:00 heroku[router]: at=info method=GET path=\"/assets/application-18e331053335285eeca7290a575ccd04.js\" host=www.clssmi.com request_id=979a64f3-a0bb-4983-acf8-76b3a2a36834 fwd=\"50.172.246.24\" dyno=web.1 connect=0ms service=4ms status=304 bytes=133\n2016-02-24T18:04:40.461637+00:00 heroku[router]: at=info method=GET path=\"/favicon.ico\" host=www.clssmi.com request_id=bbdf6ee8-5395-4f3c-91c1-1af30e4cdfea fwd=\"50.172.246.24\" dyno=web.1 connect=0ms service=4ms status=304 bytes=133\n</code></pre>\n\n<p>Here is the output from running \"bundle install\"</p>\n\n<pre><code>bundle install\nFetching gem metadata from https://rubygems.org/.........\nFetching version metadata from https://rubygems.org/...\nFetching dependency metadata from https://rubygems.org/..\nInstalling rake 10.3.2\nInstalling CFPropertyList 2.3.1\nInstalling i18n 0.7.0\nInstalling minitest 4.7.5\nInstalling multi_json 1.11.0\nInstalling thread_safe 0.3.5\nInstalling tzinfo 0.3.43\nInstalling builder 3.1.4\nInstalling erubis 2.7.0\nInstalling rack 1.5.2\nInstalling mime-types 1.25.1\nInstalling polyglot 0.3.5\nInstalling activerecord-deprecated_finders 1.0.3\nInstalling arel 4.0.2\nInstalling multi_xml 0.5.5\nInstalling bcrypt 3.1.10 with native extensions\nInstalling callsite 0.0.11\nInstalling cancancan 1.8.4\nInstalling json 1.8.2 with native extensions\nInstalling excon 0.45.1\nInstalling formatador 0.2.5\nInstalling net-ssh 2.9.2\nInstalling mini_portile 0.6.2\nInstalling ipaddress 0.8.0\nInstalling inflecto 0.0.2\nInstalling uuidtools 2.1.5\nInstalling hitimes 1.2.2 with native extensions\nInstalling coffee-script-source 1.9.1\nInstalling execjs 2.4.0\nInstalling thor 0.19.1\nInstalling commonjs 0.2.7\nInstalling connection_pool 2.1.3\nInstalling hike 1.2.3\nInstalling kgio 2.9.3 with native extensions\nInstalling libv8 3.16.14.7 with native extensions\nInstalling newrelic_rpm 3.11.1.284\nInstalling pg 0.18.1 with native extensions\nUsing bundler 1.11.2\nInstalling tilt 1.4.1\nInstalling rails_serve_static_assets 0.0.4\nInstalling rails_stdout_logging 0.0.3\nInstalling raindrops 0.13.0 with native extensions\nUsing rdoc 4.2.0\nInstalling redis 3.2.1\nInstalling ref 1.0.5\nInstalling rmagick 2.13.4 with native extensions\nInstalling sass 3.2.19\nInstalling sequel 3.20.0\nInstalling unf_ext 0.0.6 with native extensions\nInstalling fission 0.5.0\nInstalling jmespath 1.0.2\nInstalling fog-json 1.0.0\nInstalling activesupport 4.0.2\nInstalling rack-test 0.6.3\nInstalling rack-contrib 1.2.0\nInstalling sinatra 1.0\nInstalling treetop 1.4.15\nInstalling bcrypt-ruby 3.1.5\nInstalling net-scp 1.2.1\nInstalling nokogiri 1.6.6.2 with native extensions\n\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    /Users/scottsipiora/.rvm/rubies/ruby-2.2.4/bin/ruby -r ./siteconf20160224-55642-1nrqxpm.rb extconf.rb --with-xml2-dir=/usr --with-xslt-dir=/opt/local --with-iconv-dir=/opt/local\nchecking if the C compiler accepts ... yes\nchecking if the C compiler accepts -Wno-error=unused-command-line-argument-hard-error-in-future... no\nBuilding nokogiri using packaged libraries.\n-----\nThe file \"/usr/include/iconv.h\" is missing in your build environment,\nwhich means you haven't installed Xcode Command Line Tools properly.\n\nTo install Command Line Tools, try running `xcode-select --install` on\nterminal and follow the instructions.  If it fails, open Xcode.app,\nselect from the menu \"Xcode\" - \"Open Developer Tool\" - \"More Developer\nTools\" to open the developer site, download the installer for your OS\nversion and run it.\n-----\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/scottsipiora/.rvm/rubies/ruby-2.2.4/bin/$(RUBY_BASE_NAME)\n    --help\n    --clean\n    --use-system-libraries\n    --enable-static\n    --disable-static\n    --with-zlib-dir\n    --without-zlib-dir\n    --with-zlib-include\n    --without-zlib-include=${zlib-dir}/include\n    --with-zlib-lib\n    --without-zlib-lib=${zlib-dir}/lib\n    --enable-cross-build\n    --disable-cross-build\n\nextconf failed, exit code 1\n\nGem files will remain installed in /Users/scottsipiora/.rvm/gems/ruby-2.2.4/gems/nokogiri-1.6.6.2 for inspection.\nResults logged to /Users/scottsipiora/.rvm/gems/ruby-2.2.4/extensions/x86_64-darwin-15/2.2.0/nokogiri-1.6.6.2/gem_make.out\nInstalling timers 4.0.1\nInstalling coffee-script 2.3.0\nInstalling uglifier 2.7.1\nInstalling less 2.6.0\nInstalling sprockets 2.12.3\nInstalling rails_12factor 0.0.3\nInstalling unicorn 4.8.3 with native extensions\nInstalling rest-client 1.6.8\nInstalling redis-namespace 1.5.1\nInstalling therubyracer 0.12.1 with native extensions\n\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    /Users/scottsipiora/.rvm/rubies/ruby-2.2.4/bin/ruby -r ./siteconf20160224-55642-1vhuyaf.rb extconf.rb\nchecking for main() in -lpthread... yes\nchecking for main() in -lobjc... yes\nchecking for v8.h... no\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/scottsipiora/.rvm/rubies/ruby-2.2.4/bin/$(RUBY_BASE_NAME)\n    --with-pthreadlib\n    --without-pthreadlib\n    --with-objclib\n    --without-objclib\n    --enable-debug\n    --disable-debug\n    --with-v8-dir\n    --without-v8-dir\n    --with-v8-include\n    --without-v8-include=${v8-dir}/include\n    --with-v8-lib\n    --without-v8-lib=${v8-dir}/lib\n/Users/scottsipiora/.rvm/gems/ruby-2.2.4/gems/libv8-3.16.14.7/ext/libv8/location.rb:50:in `configure': You have chosen to use the version of V8 found on your system (Libv8::Location::System::NotFoundError)\nand *not* the one that is bundle with the libv8 rubygem. However,\nit could not be located. please make sure you have a version of\nv8 that is compatible with 3.16.14.7 installed. You may\nneed to special --with-v8-dir options if it is in a non-standard\nlocation\n\nthanks,\nThe Mgmt\n\n    from /Users/scottsipiora/.rvm/gems/ruby-2.2.4/gems/libv8-3.16.14.7/lib/libv8.rb:7:in `configure_makefile'\n    from extconf.rb:32:in `&lt;main&gt;'\n\nextconf failed, exit code 1\n\nGem files will remain installed in /Users/scottsipiora/.rvm/gems/ruby-2.2.4/gems/therubyracer-0.12.1 for inspection.\nResults logged to /Users/scottsipiora/.rvm/gems/ruby-2.2.4/extensions/x86_64-darwin-15/2.2.0/therubyracer-0.12.1/gem_make.out\nInstalling unf 0.1.4\nInstalling aws-sdk-core 2.0.33\nInstalling activemodel 4.0.2\nInstalling actionpack 4.0.2\nInstalling mail 2.5.4\nInstalling fog-core 1.29.0\nAn error occurred while installing nokogiri (1.6.6.2), and Bundler cannot continue.\nMake sure that `gem install nokogiri -v '1.6.6.2'` succeeds before bundling.\n</code></pre>\n\n<p>Running Ruby 2.2.4 and Rails 4.0.2.</p>\n\n<p>All help is greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter-bootstrap"], "answers": [{"tags": [], "owner": {"reputation": 1243, "user_id": 2280625, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7906b1cabd358d40f04edf72ce65bae5?s=128&d=identicon&r=PG", "display_name": "kjmagic13", "link": "https://stackoverflow.com/users/2280625/kjmagic13"}, "is_accepted": true, "score": 3, "last_activity_date": 1456346689, "creation_date": 1456346689, "answer_id": 35612707, "question_id": 35612558, "link": "https://stackoverflow.com/questions/35612558/bootstrap-add-space-between-two-buttons-only-if-viewport-is-xs/35612707#35612707", "title": "Bootstrap: Add space between two buttons only if viewport is &#39;xs&#39;", "body": "<p>Wrap the buttons in <code>&lt;p&gt;</code> tags:</p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n    &lt;div class=\" col-sm-offset-3 col-sm-2\"&gt;\n        &lt;p&gt;\n            &lt;%= f.button('Search', class: \"btn btn-default\") %&gt;\n        &lt;/p&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-sm-3\"&gt;\n        &lt;p&gt;\n            &lt;%= link_to('Find All Providers', \"#\", class: \"btn btn-default\") %&gt;\n        &lt;/p&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 35612707, "answer_count": 1, "score": 0, "last_activity_date": 1456346689, "creation_date": 1456346180, "question_id": 35612558, "link": "https://stackoverflow.com/questions/35612558/bootstrap-add-space-between-two-buttons-only-if-viewport-is-xs", "title": "Bootstrap: Add space between two buttons only if viewport is &#39;xs&#39;", "body": "<p>My two submit buttons look good when the viewport is 'sm' or larger as this picture shows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tewtC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tewtC.png\" alt=\"buttons good on &#39;sm&#39; viewport or larger\"></a></p>\n\n<p>However: as this image shows, when the viewport is 'xs', the buttons get squished together:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XLVST.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XLVST.png\" alt=\"&#39;xs&#39; view\"></a></p>\n\n<p>I'd like to add some space in between the two buttons only when the viewport is size 'xs'.  Without a conditional that checks viewport size: Adding two <code>&lt;br&gt;</code> tags would fix the spacing within the mobile view, but would cause problems in all the other viewport sizes since there would then be too much space in those other viewports.  </p>\n\n<p>How can I check on the viewport size?  I am open to other suggestions if there is a better solution. </p>\n\n<p>Code for the buttons:</p>\n\n<pre><code>  &lt;div class=\"form-group\"&gt;\n    &lt;div class=\" col-sm-offset-3 col-sm-2\"&gt;\n      &lt;%= f.button('Search', class: \"btn btn-default\") %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-sm-3\"&gt;\n      &lt;%= link_to('Find All Providers', \"#\", class: \"btn btn-default\") %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "amazon-web-services", "struct", "aws-sdk"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4375750, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bBxDHh8bvB4/AAAAAAAAAAI/AAAAAAAAAMo/JeZ9Ag66clI/photo.jpg?sz=128", "display_name": "Jason", "link": "https://stackoverflow.com/users/4375750/jason"}, "edited": false, "score": 0, "creation_date": 1456356043, "post_id": 35612686, "comment_id": 58913998, "body": "Excellent.  Thank you @nabeel-amjad!  +1 and bonus points for the array of instance tag values."}], "tags": [], "owner": {"reputation": 2172, "user_id": 4412925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7fa1503a3820659b27943c99d463a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel", "link": "https://stackoverflow.com/users/4412925/nabeel"}, "is_accepted": true, "score": 4, "last_activity_date": 1456347263, "last_edit_date": 1456347263, "creation_date": 1456346610, "answer_id": 35612686, "question_id": 35612532, "link": "https://stackoverflow.com/questions/35612532/ruby-array-of-structs/35612686#35612686", "title": "ruby array of structs", "body": "<p>Like so</p>\n\n<pre><code>ec2.instances.limit(10).each do |instance|  \n  instance.tags.each do |tag|       \n    puts tag.value if tag.key == 'Name'\n  end\nend\n</code></pre>\n\n<p>Or you could also use something like this to return an array of instance tag values (which have the key <strong>Name</strong>).</p>\n\n<pre><code>ec2.instances.limit(10).flat_map(&amp;:tags).map{|x| x.value if x.key == 'Name'}.compact\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4375750, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bBxDHh8bvB4/AAAAAAAAAAI/AAAAAAAAAMo/JeZ9Ag66clI/photo.jpg?sz=128", "display_name": "Jason", "link": "https://stackoverflow.com/users/4375750/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "accepted_answer_id": 35612686, "answer_count": 1, "score": 0, "last_activity_date": 1491281596, "creation_date": 1456346093, "last_edit_date": 1491281596, "question_id": 35612532, "link": "https://stackoverflow.com/questions/35612532/ruby-array-of-structs", "title": "ruby array of structs", "body": "<p>I need to extract a tag value from <code>AWS EC2</code> using the <code>AWS ruby-sdk v2</code> to get information about instances.  The tags are manually set for the most part.</p>\n\n<p>When I get tags back from the following code:</p>\n\n<pre><code>ec2 = Aws::EC2::Resource.new(:region =&gt; us-east-1)\nec2.instances.limit(10).each do |instance|  \n  instance.tags.each do |tag|       \n    puts tag   \n  end\nend\n</code></pre>\n\n<p>I see:</p>\n\n<pre><code>#&lt;struct Aws::EC2::Types::Tag key=\"Owner\", value=\"the_owner\"&gt;\n#&lt;struct Aws::EC2::Types::Tag key=\"PurchaseOrder\", value=\"90210\"&gt;\n#&lt;struct Aws::EC2::Types::Tag key=\"Name\", value=\"my_rocking_instance\"&gt;\n#&lt;struct Aws::EC2::Types::Tag key=\"environment\", value=\"staging\"&gt;\n\n#&lt;struct Aws::EC2::Types::Tag key=\"Name\", value=\"another_instance\"&gt;\n#&lt;struct Aws::EC2::Types::Tag key=\"environment\", value=\"prod\"&gt;\n#&lt;struct Aws::EC2::Types::Tag key=\"PurchaseOrder\", value=\"90210\"&gt;\n#&lt;struct Aws::EC2::Types::Tag key=\"Owner\", value=\"the_owner\"&gt;\n</code></pre>\n\n<p>and so on.  I put a space between the two instances for clarity.  I tried a few tricks with arrays, hashes, etc. but this appears to be an array of structs which I haven't worked with yet.</p>\n\n<p>How do I extract only the <code>Name</code> tag value?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1456345951, "post_id": 35612365, "comment_id": 58908899, "body": "At the very least you&#39;d need to run equivalent commands; <code>glob</code> won&#39;t do anything with <code>.</code> directories/files. <code>du</code> may also use block size (or whatever) in its calculations, e.g., no directory total will be under 4K on my system whereas <code>stat</code> will count bytes."}, {"owner": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1456346366, "post_id": 35612365, "comment_id": 58909101, "body": "Suggestions on an &quot;equivalent&quot; command?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1456349012, "post_id": 35612365, "comment_id": 58910572, "body": "Include dot directories and files first and see what the delta is. You&#39;ll have to do something to account for block size. It&#39;s not clear which number you actually <i>want</i>: actual size (<code>stat</code>) or blocks (<code>du</code>)."}, {"owner": {"reputation": 23931, "user_id": 5168, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/46caf38e6cbc74005d6c643fd9186ef7?s=128&d=identicon&r=PG", "display_name": "georgebrock", "link": "https://stackoverflow.com/users/5168/georgebrock"}, "edited": false, "score": 2, "creation_date": 1456369917, "post_id": 35612365, "comment_id": 58918187, "body": "This may help: <a href=\"http://superuser.com/questions/94217/ls-and-du-shows-very-different-size\" title=\"ls and du shows very different size\">superuser.com/questions/94217/&hellip;</a>"}, {"owner": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1456414451, "post_id": 35612365, "comment_id": 58944737, "body": "@DaveNewton Dir.glob(&quot;#{ dir }/**/*&quot;,  File::FNM_DOTMATCH) shows the <code>.</code> directories but is way too high 156mb."}, {"owner": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "reply_to_user": {"reputation": 23931, "user_id": 5168, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/46caf38e6cbc74005d6c643fd9186ef7?s=128&d=identicon&r=PG", "display_name": "georgebrock", "link": "https://stackoverflow.com/users/5168/georgebrock"}, "edited": false, "score": 0, "creation_date": 1456414550, "post_id": 35612365, "comment_id": 58944814, "body": "@georgebrock thanks, didn&#39;t know about sparse files when i run <code>du -hs tmp&#47;cache&#47;assets&#47; --apparent-size</code> i&#39;m getting 48mb which is pretty close to my calculated size in Ruby. All of this helps, however i&#39;ve got more questions than I started with. Thanks for the help so far."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1456417719, "post_id": 35612365, "comment_id": 58947425, "body": "@Schneems\tYou&#39;d also need to check for sym links etc. Bottom line is that unless you get a list of the files being considered you&#39;ll never know why the differences exist. Capture the file names and compare."}], "owner": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456346433, "creation_date": 1456345549, "last_edit_date": 1456346433, "question_id": 35612365, "link": "https://stackoverflow.com/questions/35612365/summed-file-size-not-matching-filesystem-report-in-ruby", "title": "Summed file size not matching filesystem report in Ruby", "body": "<p>I'm trying to sum of all files in a directory and get their total size in Ruby using <code>File.stat().size</code>. You can see below when I do this, the result is much much smaller than the result of <code>du -h</code> any ideas on how to make a better file size summation or what might be causing the discrepancy? </p>\n\n<pre><code>~ $ du -h tmp/cache/assets\n89M tmp/cache/assets\n~ $ irb\nirb(main):001:0&gt; dir  = \"tmp/cache/assets\"\n=&gt; \"tmp/cache/assets\"\nirb(main):002:0&gt; size = Dir.glob(\"#{ dir }/**/*\").inject(0) {|sum, asset| sum += File.stat(asset).size ; sum }\n=&gt; 49904065\nirb(main):003:0&gt;\nirb(main):004:0* puts \"Bytes: #{ size }\"\nBytes: 49904065\n=&gt; nil\nirb(main):005:0&gt; puts \"Mb: #{ size / 1_048_576.0 }\"\nMb: 47.592225074768066\n</code></pre>\n\n<p>Notice that 47mb as reported by Ruby is quite a bit smaller than 89 mb reported by <code>du</code>. How do I get the same result as <code>du -h</code> from Ruby?</p>\n"}, {"tags": ["ruby", "csv"], "answers": [{"tags": [], "owner": {"reputation": 386, "user_id": 2330196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/nblUp.jpg?s=128&g=1", "display_name": "viniciusalvess", "link": "https://stackoverflow.com/users/2330196/viniciusalvess"}, "is_accepted": false, "score": 0, "last_activity_date": 1456446931, "last_edit_date": 1456446931, "creation_date": 1456344653, "answer_id": 35612063, "question_id": 35611916, "link": "https://stackoverflow.com/questions/35611916/how-to-detect-the-last-row-in-csv-ruby/35612063#35612063", "title": "How to detect the last row in CSV (ruby)", "body": "<p>Try this :</p>\n\n<pre><code>f = File.new(\"testfile\")\ndummy = f.readlines\nf.eof   #=&gt; true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2172, "user_id": 4412925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7fa1503a3820659b27943c99d463a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel", "link": "https://stackoverflow.com/users/4412925/nabeel"}, "is_accepted": false, "score": 0, "last_activity_date": 1456344835, "creation_date": 1456344835, "answer_id": 35612118, "question_id": 35611916, "link": "https://stackoverflow.com/questions/35611916/how-to-detect-the-last-row-in-csv-ruby/35612118#35612118", "title": "How to detect the last row in CSV (ruby)", "body": "<p>Not a very elegant solution but something like this perhaps?</p>\n\n<pre><code>data = IO::read(file).scrub(\"\")\nsome_var = IO.readlines(some_file)\n\nCSV.parse(data, {:col_sep =&gt; \"\\t\", :headers =&gt; headers, :quote_char =&gt; '_'}) do |row|\n  p row.join == some_var.last.chomp\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 522, "user_id": 384724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VvF8J.png?s=128&g=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/384724/todd"}, "edited": false, "score": 0, "creation_date": 1456950335, "post_id": 35616608, "comment_id": 59188071, "body": "Won&#39;t the inner block just run until it runs out of lines and thus you&#39;ll be at the end of the file when the that block ends?"}, {"owner": {"reputation": 14578, "user_id": 2229277, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LZg07.jpg?s=128&g=1", "display_name": "newUserNameHere", "link": "https://stackoverflow.com/users/2229277/newusernamehere"}, "reply_to_user": {"reputation": 522, "user_id": 384724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VvF8J.png?s=128&g=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/384724/todd"}, "edited": false, "score": 0, "creation_date": 1456950456, "post_id": 35616608, "comment_id": 59188137, "body": "correct. I was trying to trigger an action when it got to the last line and wanted to fire it within the each_line block."}], "tags": [], "owner": {"reputation": 14578, "user_id": 2229277, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LZg07.jpg?s=128&g=1", "display_name": "newUserNameHere", "link": "https://stackoverflow.com/users/2229277/newusernamehere"}, "is_accepted": true, "score": 1, "last_activity_date": 1456488117, "last_edit_date": 1456488117, "creation_date": 1456363857, "answer_id": 35616608, "question_id": 35611916, "link": "https://stackoverflow.com/questions/35611916/how-to-detect-the-last-row-in-csv-ruby/35616608#35616608", "title": "How to detect the last row in CSV (ruby)", "body": "<pre><code>File.open(file_path) do |file|\n  file.each_line do |line|\n    row = CSV.parse_line(line.scrub(\"\"), col_sep: \"\\t\", headers: headers, quote_char: '_')\n    file.eof?\n  end\nend\n</code></pre>\n\n<p>I went with this solution it does not require loading the entire CSV file prior to looping through which is helpful when dealing with large files.</p>\n\n<p>By using File.open I can call file.eof? (end of file) which lets me know when I hit the last line.</p>\n"}, {"tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1456418782, "creation_date": 1456418782, "answer_id": 35633330, "question_id": 35611916, "link": "https://stackoverflow.com/questions/35611916/how-to-detect-the-last-row-in-csv-ruby/35633330#35633330", "title": "How to detect the last row in CSV (ruby)", "body": "<p>By parsing the data first you can check the length of the resulting array like this. To make this code runnable by itself without reaquireing an external csv file I put the data here at the end of the script in the __DATA__ part after __END__</p>\n\n<pre><code>require \"csv\"\n\ncsv = CSV.parse(DATA, :col_sep =&gt; \",\", :headers =&gt; true)\ncsv.each_with_index do |row, index|\n  puts \"#{row.fields} #{index+1 == csv.length ? '(last)' : ''}\"\nend\n__END__\nnr, Id, Name, URL\n1, Google UK, http://google.co.uk\n2, Yahoo UK, http://yahoo.co.uk\n</code></pre>\n\n<p>Which gives us</p>\n\n<pre><code>[\"1\", \" Google UK\", \" http://google.co.uk\"] \n[\"2\", \" Yahoo UK\", \" http://yahoo.co.uk\"] (last)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10076, "user_id": 4010391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/NgRol.jpg?s=128&g=1", "display_name": "Travis", "link": "https://stackoverflow.com/users/4010391/travis"}, "is_accepted": false, "score": 2, "last_activity_date": 1456518472, "last_edit_date": 1456518472, "creation_date": 1456517033, "answer_id": 35660732, "question_id": 35611916, "link": "https://stackoverflow.com/questions/35611916/how-to-detect-the-last-row-in-csv-ruby/35660732#35660732", "title": "How to detect the last row in CSV (ruby)", "body": "<p>test.csv</p>\n\n<pre><code>first, second, third\n1,2,3\n3,4,5\n7,8,9\n</code></pre>\n\n<p>test.rb</p>\n\n<pre><code>require 'csv'\nheaders    = 'headers'\nfilename   = './test.csv'\nline_count = File.readlines(filename).size\nfile       = File.open(filename, 'r')\ndata       = IO::read(file).scrub(\"\")\nparse_opts = { col_sep: \"\\t\", headers: headers, quote_char: '_'}\n\nCSV.parse(data, parse_opts).to_enum.with_index(1).each do |row, line_num|\n  puts line_num == line_count\nend\n#=&gt; false\n#=&gt; false\n#=&gt; false\n#=&gt; true\n</code></pre>\n\n<p>The <code>line_count</code> is generated in ~8 sec on a 10+ million row CSV, you can alternatively use <code>line_count = %x(wc -l #{filename}).to_i</code> which takes ~1.7 sec on the same file.</p>\n"}, {"tags": [], "owner": {"reputation": 638, "user_id": 1359467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/824c15f10a9c6eb42b7979c1acfd6609?s=128&d=identicon&r=PG", "display_name": "shivams", "link": "https://stackoverflow.com/users/1359467/shivams"}, "is_accepted": false, "score": 1, "last_activity_date": 1472605741, "creation_date": 1472605741, "answer_id": 39239264, "question_id": 35611916, "link": "https://stackoverflow.com/questions/35611916/how-to-detect-the-last-row-in-csv-ruby/39239264#39239264", "title": "How to detect the last row in CSV (ruby)", "body": "<p>Here is a seek-based solution. This is optimized for larger files. No matter what the size of the file, it will take only a jiffy to print the last line of the CSV:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>#!/usr/bin/env ruby\n\nrequire 'csv'\n\nf = File.open('test.csv')\nf.seek(-2, IO::SEEK_END) #pos -1 is newline at end of file\nlast_line = nil\n\nwhile f.pos &gt; 0\n  if f.getc == \"\\n\"\n    last_line = f.read\n    break\n  else\n    f.pos -= 2  #getc advances position by 1\n  end\nend\n\nrow = CSV.parse_line(last_line.scrub(\"\"), col_sep: \"\\t\")\np row\n\nf.close\n</code></pre>\n"}], "owner": {"reputation": 14578, "user_id": 2229277, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LZg07.jpg?s=128&g=1", "display_name": "newUserNameHere", "link": "https://stackoverflow.com/users/2229277/newusernamehere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2740, "favorite_count": 2, "accepted_answer_id": 35616608, "answer_count": 6, "score": 3, "last_activity_date": 1472605741, "creation_date": 1456344101, "last_edit_date": 1456488077, "question_id": 35611916, "link": "https://stackoverflow.com/questions/35611916/how-to-detect-the-last-row-in-csv-ruby", "title": "How to detect the last row in CSV (ruby)", "body": "<pre><code>data = IO::read(file).scrub(\"\")\nCSV.parse(data, {:col_sep =&gt; \"\\t\", :headers =&gt; headers, :quote_char =&gt; '_'}) do |row|\n  # how to detect last line of CSV?\nend\n</code></pre>\n\n<p>I have a giant CSV file that needs to be scrubbed. It has multiple lines that apply to one DB object. In my code I'm collecting all the lines that apply to one object before passing them off to a class that will process them. </p>\n\n<p>It would be very helpful if I could detect the last line in the CSV so I could make sure the last collection gets sent.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 1931, "user_id": 1639657, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f6c37c33188931ef56c5c1ccfe638dd5?s=128&d=identicon&r=PG", "display_name": "sonnyhe2002", "link": "https://stackoverflow.com/users/1639657/sonnyhe2002"}, "edited": false, "score": 0, "creation_date": 1456344391, "post_id": 35611667, "comment_id": 58907945, "body": "Can you give an example, I tried that and it does not work"}, {"owner": {"reputation": 1931, "user_id": 1639657, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f6c37c33188931ef56c5c1ccfe638dd5?s=128&d=identicon&r=PG", "display_name": "sonnyhe2002", "link": "https://stackoverflow.com/users/1639657/sonnyhe2002"}, "edited": false, "score": 0, "creation_date": 1456344431, "post_id": 35611667, "comment_id": 58907974, "body": "I tried config.autoload_paths += %W(#{config.root}/services/gen)"}], "tags": [], "owner": {"reputation": 7832, "user_id": 2497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d33a294d8b03b0eec187cb1dc4d8d7?s=128&d=identicon&r=PG", "display_name": "Srdjan Pejic", "link": "https://stackoverflow.com/users/2497/srdjan-pejic"}, "is_accepted": false, "score": 0, "last_activity_date": 1456343372, "creation_date": 1456343372, "answer_id": 35611667, "question_id": 35611650, "link": "https://stackoverflow.com/questions/35611650/how-to-service-objects-in-subfolders/35611667#35611667", "title": "How to Service Objects in Subfolders", "body": "<p>Yes, you do. In <code>config/application.rb</code>, you can add the subfolders to the <code>config.autoload_paths</code> collection.</p>\n"}, {"comments": [{"owner": {"reputation": 1931, "user_id": 1639657, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f6c37c33188931ef56c5c1ccfe638dd5?s=128&d=identicon&r=PG", "display_name": "sonnyhe2002", "link": "https://stackoverflow.com/users/1639657/sonnyhe2002"}, "edited": false, "score": 0, "creation_date": 1456345761, "post_id": 35612375, "comment_id": 58908773, "body": "Which would be the better approach?"}, {"owner": {"reputation": 5962, "user_id": 115159, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ac02a81e50f368f6d5c7a14b99ce2469?s=128&d=identicon&r=PG", "display_name": "Dharam Gollapudi", "link": "https://stackoverflow.com/users/115159/dharam-gollapudi"}, "reply_to_user": {"reputation": 1931, "user_id": 1639657, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f6c37c33188931ef56c5c1ccfe638dd5?s=128&d=identicon&r=PG", "display_name": "sonnyhe2002", "link": "https://stackoverflow.com/users/1639657/sonnyhe2002"}, "edited": false, "score": 1, "creation_date": 1456345875, "post_id": 35612375, "comment_id": 58908857, "body": "It boils down to personal choice. Most of the time, I have seen 2nd approach is being used more often than 1st approach, as you don&#39;t need to keep updating your classes when the folder structure changes."}, {"owner": {"reputation": 15225, "user_id": 262972, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3c4b3398ce5df0a4a4632d9e83aed863?s=128&d=identicon&r=PG", "display_name": "noli", "link": "https://stackoverflow.com/users/262972/noli"}, "edited": false, "score": 0, "creation_date": 1481116995, "post_id": 35612375, "comment_id": 69244273, "body": "Does this still work for Rails 5?   It doesn&#39;t seem to be working for me"}, {"owner": {"reputation": 3077, "user_id": 1128632, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ek2ZR.jpg?s=128&g=1", "display_name": "Dylan Pierce", "link": "https://stackoverflow.com/users/1128632/dylan-pierce"}, "edited": false, "score": 0, "creation_date": 1510602190, "post_id": 35612375, "comment_id": 81495463, "body": "For those coming from a OOP PHP background, the former is much much like namespacing your classes out. Plus you get the bonus of being able to dynamically grab all of your classes in a module, which is pretty amazing. It really helps &quot;modularize&quot; your code, which in PHP you&#39;d have to do with some kind of registry pattern."}], "tags": [], "owner": {"reputation": 5962, "user_id": 115159, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ac02a81e50f368f6d5c7a14b99ce2469?s=128&d=identicon&r=PG", "display_name": "Dharam Gollapudi", "link": "https://stackoverflow.com/users/115159/dharam-gollapudi"}, "is_accepted": true, "score": 6, "last_activity_date": 1456345575, "creation_date": 1456345575, "answer_id": 35612375, "question_id": 35611650, "link": "https://stackoverflow.com/questions/35611650/how-to-service-objects-in-subfolders/35612375#35612375", "title": "How to Service Objects in Subfolders", "body": "<p>You can do that in two ways.</p>\n\n<p>If you want <code>rails</code> to autoload them without you making any modifications to the <code>config.autoload_paths</code>, define your classes per the folder structure as follows:</p>\n\n<pre><code>module Gen\n  class ServiceA\n  end\nend\n</code></pre>\n\n<p>If you don't want to make any changes to your class definition, then you could add those sub folders to the <code>config.autoload_paths</code> as follows in your <code>config/application.rb</code></p>\n\n<pre><code>module YourApplication\n  class Application &lt; Rails::Application\n    config.autoload_paths += [\n      \"#{Rails.root}/app/services/gen\",\n      \"#{Rails.root}/app/services/prod\"\n    ]\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1931, "user_id": 1639657, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f6c37c33188931ef56c5c1ccfe638dd5?s=128&d=identicon&r=PG", "display_name": "sonnyhe2002", "link": "https://stackoverflow.com/users/1639657/sonnyhe2002"}, "edited": false, "score": 0, "creation_date": 1456430697, "post_id": 35616037, "comment_id": 58955914, "body": "Does this try to add non folders to the path as well?"}, {"owner": {"reputation": 1284, "user_id": 2667545, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/77414e4cbee3c6687d580bbb7876d8c2?s=128&d=identicon&r=PG", "display_name": "Vic", "link": "https://stackoverflow.com/users/2667545/vic"}, "reply_to_user": {"reputation": 1931, "user_id": 1639657, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f6c37c33188931ef56c5c1ccfe638dd5?s=128&d=identicon&r=PG", "display_name": "sonnyhe2002", "link": "https://stackoverflow.com/users/1639657/sonnyhe2002"}, "edited": false, "score": 0, "creation_date": 1456445961, "post_id": 35616037, "comment_id": 58963619, "body": "it adds all files under <code>app&#47;services</code> as well as any files under any subfolders in <code>app&#47;services</code>; <a href=\"http://ruby-doc.org/core-2.2.0/Dir.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.2.0/Dir.html</a>"}], "tags": [], "owner": {"reputation": 1284, "user_id": 2667545, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/77414e4cbee3c6687d580bbb7876d8c2?s=128&d=identicon&r=PG", "display_name": "Vic", "link": "https://stackoverflow.com/users/2667545/vic"}, "is_accepted": false, "score": 3, "last_activity_date": 1456360488, "creation_date": 1456360488, "answer_id": 35616037, "question_id": 35611650, "link": "https://stackoverflow.com/questions/35611650/how-to-service-objects-in-subfolders/35616037#35616037", "title": "How to Service Objects in Subfolders", "body": "<p>for a recursive solution</p>\n\n<pre><code># application.rb\nconfig.autoload_paths += Dir[\"#{config.root}/app/services/**/\"]\n</code></pre>\n"}], "owner": {"reputation": 1931, "user_id": 1639657, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f6c37c33188931ef56c5c1ccfe638dd5?s=128&d=identicon&r=PG", "display_name": "sonnyhe2002", "link": "https://stackoverflow.com/users/1639657/sonnyhe2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1388, "favorite_count": 0, "accepted_answer_id": 35612375, "answer_count": 3, "score": 1, "last_activity_date": 1456360488, "creation_date": 1456343312, "last_edit_date": 1456344779, "question_id": 35611650, "link": "https://stackoverflow.com/questions/35611650/how-to-service-objects-in-subfolders", "title": "How to Service Objects in Subfolders", "body": "<p>I have many service objects in my service folder. I'm using Rails 4:</p>\n\n<pre><code> -&gt;services\n   a_gen.rb\n   b_gen.rb\n   ...\n   a_pro.rb\n   b_pro.rb\n   ...\n</code></pre>\n\n<p>I would like my folder structure to be something like</p>\n\n<pre><code>  -&gt;services\n    -&gt;gen\n       a_gen.rb\n       b_gen.rb\n       ...\n    -&gt;pro\n       a_pro.rb\n       b_pro.rb\n       ...\n</code></pre>\n\n<p>I tried just making the folders and putting the objects there, but Rails complains about not able to find it. Do I have to tell rails to look there?</p>\n\n<p>Update:</p>\n\n<p>I am getting this error:</p>\n\n<p>NameError - uninitialized constant ExampleModelName::APro</p>\n\n<p>Even with the path loaded. Once it is in the subfolder.. Rails is looking into the wrong place.</p>\n"}, {"tags": ["javascript", "python", "ruby", "cassandra"], "comments": [{"owner": {"reputation": 6187, "user_id": 1837823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f80792d86cb08d7a729869f1ed3698c?s=128&d=identicon&r=PG", "display_name": "mikea", "link": "https://stackoverflow.com/users/1837823/mikea"}, "edited": false, "score": 1, "creation_date": 1456414044, "post_id": 35611473, "comment_id": 58944404, "body": "I&#39;m not sure what you are asking here. If you can create users in cqlsh then you can create them in other drivers. They are just cql statements like any other cql statement."}], "answers": [{"tags": [], "owner": {"reputation": 3102, "user_id": 902539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a04f42807f5fe8083d58eb1dcc5259?s=128&d=identicon&r=PG", "display_name": "Gomes", "link": "https://stackoverflow.com/users/902539/gomes"}, "is_accepted": false, "score": 0, "last_activity_date": 1456371641, "creation_date": 1456371641, "answer_id": 35617799, "question_id": 35611473, "link": "https://stackoverflow.com/questions/35611473/programmatically-managing-cassandra-permissions/35617799#35617799", "title": "Programmatically managing Cassandra permissions", "body": "<p>Not sure you tried this approach, add tenant info with all your table keys, this way you write your class method to prepare query with tenant will append to it.</p>\n\n<p>1) \"ClientA:Name\" ....\n2) \"ClientB:Name\"...</p>\n"}], "owner": {"reputation": 4401, "user_id": 1020076, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/530c9a97e692df7a243faa511b209189?s=128&d=identicon&r=PG", "display_name": "Peter Klipfel", "link": "https://stackoverflow.com/users/1020076/peter-klipfel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1544519863, "creation_date": 1456342769, "last_edit_date": 1544519863, "question_id": 35611473, "link": "https://stackoverflow.com/questions/35611473/programmatically-managing-cassandra-permissions", "title": "Programmatically managing Cassandra permissions", "body": "<p>I'm wondering about the best way to manage multitenancy in Cassandra. I have a web app, and I want all users in the web app to have a namespaced area in Cassandra. I can do this via cqlsh (create user with password + grants), but I can't find documentation on it for the ruby, python, or javascript drivers. Any help?</p>\n\n<p>EDIT:</p>\n\n<p>Right now, I'm using the ruby driver and just using <code>session.execute</code> but this seems suboptimal for security reasons.</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "twitter-bootstrap"], "answers": [{"comments": [{"owner": {"reputation": 232, "user_id": 5817240, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6ff1678916582d985fae676bed69f285?s=128&d=identicon&r=PG&f=1", "display_name": "Turk", "link": "https://stackoverflow.com/users/5817240/turk"}, "edited": false, "score": 0, "creation_date": 1456346930, "post_id": 35612524, "comment_id": 58909412, "body": "I see the first line that you posted but not the the second....weird, since it was working before the bootstrap plugin"}, {"owner": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "reply_to_user": {"reputation": 232, "user_id": 5817240, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6ff1678916582d985fae676bed69f285?s=128&d=identicon&r=PG&f=1", "display_name": "Turk", "link": "https://stackoverflow.com/users/5817240/turk"}, "edited": false, "score": 0, "creation_date": 1456347791, "post_id": 35612524, "comment_id": 58909913, "body": "Yeah that&#39;s strange but everything is debuggable. I searched their issues and didn&#39;t find anything on the form methods or problems with <code>delete</code>. Try their suggestions and if no luck, submit a bug. <a href=\"https://github.com/wenzhixin/bootstrap-table/blob/master/CONTRIBUTING.md#bug-reports\" rel=\"nofollow noreferrer\">bootstrap-table debugging</a>"}], "tags": [], "owner": {"reputation": 563, "user_id": 2418828, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b8bbbdbccee9a400610246016d24a15?s=128&d=identicon&r=PG", "display_name": "James Klein", "link": "https://stackoverflow.com/users/2418828/james-klein"}, "is_accepted": false, "score": 1, "last_activity_date": 1456346068, "creation_date": 1456346068, "answer_id": 35612524, "question_id": 35611442, "link": "https://stackoverflow.com/questions/35611442/rails-form-does-post-instead-of-delete-after-adding-in-bootstrap/35612524#35612524", "title": "Rails form does POST instead of DELETE after adding in Bootstrap?", "body": "<p>Can you post the HTML generated form from the page?</p>\n\n<p>According to <a href=\"http://guides.rubyonrails.org/form_helpers.html#how-do-forms-with-patch-put-or-delete-methods-work-questionmark\" rel=\"nofollow\">the docs</a>, you should have the following hidden field. Do you see that field?</p>\n\n<pre><code>&lt;form accept-charset=\"UTF-8\" action=\"/sccm_destroy_multiple\" method=\"post\"&gt;\n  &lt;input name=\"_method\" type=\"hidden\" value=\"delete\" /&gt;\n</code></pre>\n\n<blockquote>\n  <p>The Rails framework encourages RESTful design of your applications, which means you'll be making a lot of \"PATCH\" and \"DELETE\" requests (besides \"GET\" and \"POST\"). However, most browsers don't support methods other than \"GET\" and \"POST\" when it comes to submitting forms.</p>\n  \n  <p>Rails works around this issue by emulating other methods over POST with a hidden input named \"_method\", which is set to reflect the desired method:</p>\n</blockquote>\n"}], "owner": {"reputation": 232, "user_id": 5817240, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6ff1678916582d985fae676bed69f285?s=128&d=identicon&r=PG&f=1", "display_name": "Turk", "link": "https://stackoverflow.com/users/5817240/turk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456346068, "creation_date": 1456342646, "question_id": 35611442, "link": "https://stackoverflow.com/questions/35611442/rails-form-does-post-instead-of-delete-after-adding-in-bootstrap", "title": "Rails form does POST instead of DELETE after adding in Bootstrap?", "body": "<p>I just recently added the functionality to sort table columns with the following lines of code: </p>\n\n<pre><code>&lt;table data-toggle=\"table\" class= \"table\"&gt;\n.  \n.\n.\n&lt;th data-sortable = \"true\"&gt; Some header column &lt;/th&gt;\n.\n.\n&lt;%= form_tag(sccm_destroy_multiple, method: :delete) %&gt;\n .\n .\n .\n &lt;%end%&gt;\n</code></pre>\n\n<p>So after I added in the <code>data-toggle=\"table\"</code> and <code>data-sortable=\"true\"</code> lines (was working fine before I added those), my form started making POST requests instead of DELETE, any ideas as to how to fix this?</p>\n\n<p>Also: </p>\n\n<p><strong>application.js</strong>:</p>\n\n<p><code>//= require bootstrap-table</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1456348178, "post_id": 35611702, "comment_id": 58910103, "body": "Why don&#39;t we have <a href=\"http://api.rubyonrails.org/classes/Hash.html#method-i-except\" rel=\"nofollow noreferrer\">Hash#except</a> in pure-Ruby? Does this have a counterpart <code>include_only</code> (to avoid the need for <code>h.except(*(h.keys-include_keys))</code>)?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1456349548, "post_id": 35611702, "comment_id": 58910869, "body": "Kitesurfing instructor? Decided to go for the big money, eh?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1456394018, "post_id": 35611702, "comment_id": 58929576, "body": "The inverse of <code>Hash#except</code> is <code>Hash#slice</code> which takes a whitelist instead of a blacklist, would be nice to have them in the stdlib. @CarySwoveland"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1456394092, "post_id": 35611702, "comment_id": 58929632, "body": "There are other things to life than money :) @CarySwoveland"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1456344858, "last_edit_date": 1456344858, "creation_date": 1456343478, "answer_id": 35611702, "question_id": 35611373, "link": "https://stackoverflow.com/questions/35611373/ruby-refactoring-converting-array-to-hash/35611702#35611702", "title": "Ruby refactoring: converting array to hash", "body": "<pre><code>d = obj[:raw_data]\nkeys = d.map { |h| h[\"id\"] }\nvalues = d.map { |h| h.except(\"id\") }\nHash[ keys.zip(values) ]\n\n# or as a oneliner\nHash[ d.map { |h| h[\"id\"] }.zip(d.map { |h| h.except(\"id\")) ]\n# =&gt; {\"1\"=&gt;{\"name\"=&gt;\"John Doe\"}, \"2\"=&gt;{\"name\"=&gt;\"Jane Doe\"}}\n</code></pre>\n\n<p>This special <a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-c-5B-5D\" rel=\"nofollow\"><code>Hash[]</code></a> syntax lets you create a hash from a array of keys and an array of values.</p>\n\n<p><code>Hash.except(*args)</code> is an ActiveSupport addition to the hash class which returns a new key without the keys in the blacklist.</p>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1456345121, "post_id": 35611841, "comment_id": 58908387, "body": "You are relying on the order of the array being the same as the id&#39;s which is a faulty assumption. <code>[ { &quot;id&quot; =&gt; 5, &quot;name&quot; =&gt; &quot;John Doe&quot; } , { &quot;id&quot; =&gt; 15, &quot;name&quot; =&gt; &quot;Jane Doe&quot; } ] </code> would give the wrong output."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1456345385, "post_id": 35611841, "comment_id": 58908555, "body": "I think you&#39;ve misunderstood how this code works. The <a href=\"http://ideone.com/qKMZ6c\" rel=\"nofollow noreferrer\">output</a> it gives for that input is <code>{ 5 =&gt; { &quot;name&quot; =&gt; &quot;John Doe&quot; }, 15 =&gt; { &quot;name&quot; =&gt; &quot;Jane Doe&quot; } }</code>. What output do you think it should give?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1456345624, "post_id": 35611841, "comment_id": 58908703, "body": "Ah, you&#39;re correct, missed the <code>[ item.delete(&#39;id&#39;), item ]</code> part. Sorry"}, {"owner": {"reputation": 415, "user_id": 1996570, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/b76c86d25bb725c8d300e987b68ede02?s=128&d=identicon&r=PG", "display_name": "Martin Sojka", "link": "https://stackoverflow.com/users/1996570/martin-sojka"}, "edited": false, "score": 0, "creation_date": 1456436106, "post_id": 35611841, "comment_id": 58959102, "body": "Perfect, thanks Jordan, I used the one with except. Short and sweet :)"}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 2, "last_activity_date": 1456343918, "creation_date": 1456343918, "answer_id": 35611841, "question_id": 35611373, "link": "https://stackoverflow.com/questions/35611373/ruby-refactoring-converting-array-to-hash/35611841#35611841", "title": "Ruby refactoring: converting array to hash", "body": "<p>Here's one way:</p>\n\n<pre><code>obj = {\n  \"raw_data\" =&gt; [\n    { \"id\" =&gt; \"1\", \"name\" =&gt; \"John Doe\" },\n    { \"id\" =&gt; \"2\", \"name\" =&gt; \"Jane Doe\" }\n  ]\n}\n\ndata = obj[\"raw_data\"].map do |item|\n  item = item.dup\n  [ item.delete('id'), item ]\nend\n\nobj2 = { \"data\" =&gt; data.to_h }\n# =&gt; { \"data\" =&gt;\n#      { \"1\" =&gt; { \"name\" =&gt; \"John Doe\" },\n#        \"2\" =&gt; { \"name\" =&gt; \"Jane Doe\" }\n#      }\n#    }\n</code></pre>\n\n<p>If you're using Rails you can use the <a href=\"http://api.rubyonrails.org/classes/Hash.html#method-i-except\" rel=\"nofollow\"><code>Hash#except</code></a> method from ActiveSupport to make it a little more succinct:</p>\n\n<pre><code>data = obj[\"raw_data\"].map {|item| [ item[\"id\"], item.except(\"id\") ] }\nobj2 = { \"data\" =&gt; data.to_h }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1456345323, "post_id": 35611845, "comment_id": 58908522, "body": "This has the undesirable side effect of altering the original hash."}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1456345394, "post_id": 35611845, "comment_id": 58908560, "body": "@max - True to that, up to OP to decide whether this is a fair trade-off for code simplicity in this case."}], "tags": [], "owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "is_accepted": false, "score": 0, "last_activity_date": 1456345520, "last_edit_date": 1456345520, "creation_date": 1456343928, "answer_id": 35611845, "question_id": 35611373, "link": "https://stackoverflow.com/questions/35611373/ruby-refactoring-converting-array-to-hash/35611845#35611845", "title": "Ruby refactoring: converting array to hash", "body": "<p>In rails, you can use <code>index_by</code> method:</p>\n\n<pre><code>obj = {raw_data: [{id: \"1\", name: \"John Doe\"}, {id: \"2\", name: \"Jane Doe\"}]}\n\nobj2 = {\n data: obj[:raw_data].index_by {|h| h[:id]}.each {|_,h| h.delete(:id)}\n} #=&gt; {:data=&gt;{\"1\"=&gt;{:name=&gt;\"John Doe\"}, \"2\"=&gt;{:name=&gt;\"Jane Doe\"}}}\n</code></pre>\n\n<p>One downfall of this is that it will modify the original data by deleting id property. If this is unacceptable, here is modified, safe version:</p>\n\n<pre><code>obj2 = {\n data: obj[:raw_data].map(&amp;:clone).index_by {|h| h[:id]}.each {|_,h| h.delete(:id)}\n} #=&gt; {:data=&gt;{\"1\"=&gt;{:name=&gt;\"John Doe\"}, \"2\"=&gt;{:name=&gt;\"Jane Doe\"}}}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1456346024, "post_id": 35612391, "comment_id": 58908943, "body": "I like it, in rails you might want to use <code>h[g[&#39;id&#39;]] = g.except(:id)</code> as its both succinct and side effect free."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1456348031, "last_edit_date": 1456348031, "creation_date": 1456345632, "answer_id": 35612391, "question_id": 35611373, "link": "https://stackoverflow.com/questions/35611373/ruby-refactoring-converting-array-to-hash/35612391#35612391", "title": "Ruby refactoring: converting array to hash", "body": "<p>I assume you mean <code>obj = {...}</code> and not <code>obj =&gt; {...}</code>, as the latter is not a valid object. If so:</p>\n\n<pre><code>{ \"data\" =&gt; obj[\"raw_data\"].each_with_object({}) { |g,h|\n  h[g[\"id\"]] = g.reject { |k,_| k == \"id\" } } }\n  #=&gt; {\"data\"=&gt;{\"1\"=&gt;{\"name\"=&gt;\"John Doe\"}, \"2\"=&gt;{\"name\"=&gt;\"Jane Doe\"}}}\n</code></pre>\n\n<p>If <code>obj</code> can be mutated, you can simplify a bit:</p>\n\n<pre><code>{ \"data\" =&gt; obj[\"raw_data\"].each_with_object({}) { |g,h| h[g.delete(\"id\")]=g } }\n</code></pre>\n\n<p>As an improved non-mutating solution, @Max suggested a Rails' tweak:</p>\n\n<pre><code>{ \"data\" =&gt; obj[\"raw_data\"].each_with_object({}) { |g,h| h[g[\"id\"]] = g.except(\"id\") } }\n</code></pre>\n\n<p>That looks good to me, but as I don't know rails, I'm taking that advice at face value.</p>\n"}], "owner": {"reputation": 415, "user_id": 1996570, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/b76c86d25bb725c8d300e987b68ede02?s=128&d=identicon&r=PG", "display_name": "Martin Sojka", "link": "https://stackoverflow.com/users/1996570/martin-sojka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 35611841, "answer_count": 4, "score": 0, "last_activity_date": 1456348031, "creation_date": 1456342442, "question_id": 35611373, "link": "https://stackoverflow.com/questions/35611373/ruby-refactoring-converting-array-to-hash", "title": "Ruby refactoring: converting array to hash", "body": "<p>Here's what I get in Rails params:</p>\n\n<pre><code>obj =&gt; {\n    \"raw_data\" =&gt;\n        [\n            { \"id\" =&gt; \"1\", \"name\" =&gt; \"John Doe\" },\n            { \"id\" =&gt; \"2\", \"name\" =&gt; \"Jane Doe\" }\n        ]\n}\n</code></pre>\n\n<p>I have to transform into a following object:</p>\n\n<pre><code>obj =&gt; {\n    \"data\" =&gt;\n        {\n            \"1\" =&gt; { \"name\" =&gt; \"John Doe\" },\n            \"2\" =&gt; { \"name\" =&gt; \"Jane Doe\" }\n        }\n}\n</code></pre>\n\n<p>Here's the code I have working so far:</p>\n\n<pre><code>if obj[:raw_data]\n    obj[:data] = Hash.new\n    obj[:raw_data].each do |raw|\n      obj[:data][raw[:id]] = Hash.new\n      obj[:data][raw[:id]][:name] = raw[:name] if raw[:name].present?\n    end\nend\nobj.delete(:raw_data)\n</code></pre>\n\n<p>Is there a way to refactor it? Maybe using <code>map</code>. Note that data structure has to change from array to hash as well.</p>\n\n<p>Thanks for any tips.</p>\n"}, {"tags": ["ruby", "sinatra", "popen", "puma"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 5838120, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4301716c96dd5bbf43a4529510f4f46f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/5838120/simon"}, "is_accepted": true, "score": 1, "last_activity_date": 1456428129, "last_edit_date": 1456428129, "creation_date": 1456427002, "answer_id": 35636061, "question_id": 35611224, "link": "https://stackoverflow.com/questions/35611224/how-to-cleanup-defunct-zombie-processes-or-close-long-running-popen-with-sinatra/35636061#35636061", "title": "How to cleanup defunct/zombie processes or close long running popen with Sinatra on Puma", "body": "<p>The code above appears to spawn two child processes: one for the tar command that closes correctly; and another that goes defunct.</p>\n\n<p>When the popen is detached in the code below the defunct process does not appear and the tar command remains correctly attached as a child of the server.</p>\n\n<pre><code>get '/:dir_name' do\n    headers['Content-Type']=\"application/octet-stream\"\n    headers[\"Content-Disposition\"]=\"attachment;filename=#{params[:dir_name]}.tar\"\n    io = IO.popen(\"tar -C /home/my/files -cf - #{params[:dir_name]}\")\n    Process.detach(io.pid)\n    return io\nend\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5838120, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4301716c96dd5bbf43a4529510f4f46f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/5838120/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "accepted_answer_id": 35636061, "answer_count": 1, "score": 0, "last_activity_date": 1521100682, "creation_date": 1456341979, "last_edit_date": 1521100682, "question_id": 35611224, "link": "https://stackoverflow.com/questions/35611224/how-to-cleanup-defunct-zombie-processes-or-close-long-running-popen-with-sinatra", "title": "How to cleanup defunct/zombie processes or close long running popen with Sinatra on Puma", "body": "<p>I have the following in my ruby sinatra app to stream large tar files on-the-fly which works nicely but each request leaves behind a defunct/zombie child process. As soon as the browser pops up the save file dialogue the process becomes defunct.</p>\n\n<p>I'm running this on Puma 2.12.2</p>\n\n<p>I've tried a system call and using popen in a block instead but it closes the processes and returns before the tar command finishes, so the client receives an empty file.</p>\n\n<p>Any ideas how I can either automatically cleanup defunct child processes or keep a handle on the io object but still return it so it starts streaming to the client?</p>\n\n<pre><code>get '/:dir_name' do\n    headers['Content-Type']=\"application/octet-stream\"\n    headers[\"Content-Disposition\"]=\"attachment;filename=#{params[:dir_name]}.tar\"\n    IO.popen(\"tar -C /home/my/files -cf - #{params[:dir_name]}\")\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1521, "user_id": 1274846, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/048371ccb94bbd3aae9ac0ca20c0a31c?s=128&d=identicon&r=PG", "display_name": "Trinculo", "link": "https://stackoverflow.com/users/1274846/trinculo"}, "edited": false, "score": 0, "creation_date": 1456341042, "post_id": 35610869, "comment_id": 58905982, "body": "I get an error when I run that statement &quot;RVM is not a function, selecting rubies with &#39;rvm use ...&#39; will not work.&quot;  When I do <code>rvm ls</code>, it lists my current AND default as 2.3.0 though."}, {"owner": {"reputation": 1521, "user_id": 1274846, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/048371ccb94bbd3aae9ac0ca20c0a31c?s=128&d=identicon&r=PG", "display_name": "Trinculo", "link": "https://stackoverflow.com/users/1274846/trinculo"}, "edited": false, "score": 0, "creation_date": 1456341164, "post_id": 35610869, "comment_id": 58906056, "body": "Hmmm.  After closing my terminal and re-opening and doing <code>ruby -v</code>, it now says 2.1.5 (not what it said earlier)...even though <code>rvm ls</code> still shows 2.3.0.  It is like it is not using rvm at all."}, {"owner": {"reputation": 1521, "user_id": 1274846, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/048371ccb94bbd3aae9ac0ca20c0a31c?s=128&d=identicon&r=PG", "display_name": "Trinculo", "link": "https://stackoverflow.com/users/1274846/trinculo"}, "edited": false, "score": 0, "creation_date": 1456341711, "post_id": 35610869, "comment_id": 58906368, "body": "Never mind...got it.  I added this to the bottom of my .bashrc <code>[[ -s &quot;$HOME&#47;.rvm&#47;scripts&#47;rvm&quot; ]] &amp;&amp; source &quot;$HOME&#47;.rvm&#47;scripts&#47;rvm&quot; # Load RVM into a shell session *as a function*</code> and then installed rails from there."}, {"owner": {"reputation": 505, "user_id": 938608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e58284860788b0eddca82a21514a747c?s=128&d=identicon&r=PG", "display_name": "Kirka121", "link": "https://stackoverflow.com/users/938608/kirka121"}, "reply_to_user": {"reputation": 1521, "user_id": 1274846, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/048371ccb94bbd3aae9ac0ca20c0a31c?s=128&d=identicon&r=PG", "display_name": "Trinculo", "link": "https://stackoverflow.com/users/1274846/trinculo"}, "edited": false, "score": 1, "creation_date": 1456343968, "post_id": 35610869, "comment_id": 58907687, "body": "yeah RVM needs to be in path for this to work, and after you have set the default it will automatically switch to that version of ruby. now when you install the rails version you like inside that ruby, you will always have access to it :)"}], "tags": [], "owner": {"reputation": 505, "user_id": 938608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e58284860788b0eddca82a21514a747c?s=128&d=identicon&r=PG", "display_name": "Kirka121", "link": "https://stackoverflow.com/users/938608/kirka121"}, "is_accepted": false, "score": 1, "last_activity_date": 1456370116, "last_edit_date": 1456370116, "creation_date": 1456340777, "answer_id": 35610869, "question_id": 35610760, "link": "https://stackoverflow.com/questions/35610760/ruby-version-is-x-but-gemfile-is-y-mismatch/35610869#35610869", "title": "Ruby version is X, but Gemfile is Y mismatch", "body": "<p>do </p>\n\n<pre><code>rvm --default use 2.3.0\n</code></pre>\n\n<p>to set your default version of ruby. then install rails in that version of ruby.</p>\n"}], "owner": {"reputation": 1521, "user_id": 1274846, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/048371ccb94bbd3aae9ac0ca20c0a31c?s=128&d=identicon&r=PG", "display_name": "Trinculo", "link": "https://stackoverflow.com/users/1274846/trinculo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456370116, "creation_date": 1456340462, "last_edit_date": 1495542780, "question_id": 35610760, "link": "https://stackoverflow.com/questions/35610760/ruby-version-is-x-but-gemfile-is-y-mismatch", "title": "Ruby version is X, but Gemfile is Y mismatch", "body": "<p>Whenever I run a rails command (e.g. <code>rails s</code>), I get a message saying \"Your Ruby version is X, but you Gemfile specified is Y\".  I've searched and searched and all of the <a href=\"https://stackoverflow.com/questions/23039528/your-ruby-version-is-2-0-0-but-your-gemfile-specified-2-1-0\" title=\"answers\">answers</a> either say to update/install bundler (which I have), or obviously that it is using the wrong version (which I am not as you can see from the output).  I'm not even sure where it is getting 2.1.5 from since I am using rvm.  When I do <code>rails new app_name</code>, I am getting an error that says <code>No such file or directory -- /usr/bin/bundle (LoadError)</code>...so that does correspond to something with bundler, but I can't quite figure it out.  I am using Ubuntu 15.10.</p>\n\n<pre><code>12:50 $ rails\nYour Ruby version is 2.1.5, but your Gemfile specified 2.3.0\n12:50 $ ruby -v\nruby 2.3.0p0 (2015-12-25 revision 53290) [x86_64-linux]\n12:50 $ rvm ls\n\nrvm rubies\n\n   ruby-2.2.1 [ x86_64 ]\n=* ruby-2.3.0 [ x86_64 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1004, "user_id": 2091331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ff378547e4b88acd5cd7b4f9b15b956?s=128&d=identicon&r=PG", "display_name": "Jbur43", "link": "https://stackoverflow.com/users/2091331/jbur43"}, "edited": false, "score": 0, "creation_date": 1456341023, "post_id": 35610740, "comment_id": 58905968, "body": "Lets say I had an array that was 20 elements long and wanted to delete index positions 9 and up? That&#39;s more specific to what I am trying to do"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1456341541, "post_id": 35610740, "comment_id": 58906262, "body": "I&#39;m sure @sawa meant <code>n</code> where he wrote <code>1</code>. (s: <code>n</code> needs backticks.)"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 3, "last_activity_date": 1456340413, "creation_date": 1456340413, "answer_id": 35610740, "question_id": 35610620, "link": "https://stackoverflow.com/questions/35610620/delete-array-element-if-index-position-is-greater-than-a-specific-value/35610740#35610740", "title": "Delete array element if index position is greater than a specific value", "body": "<p><code>Array#first</code> gives you the first n elements.</p>\n\n<pre><code>b = a.first(1)\n# =&gt; [\"a\"]\n</code></pre>\n\n<p>If you want to do it in a destructive way, then this will do:</p>\n\n<pre><code>a.pop(a.length - 1)\na # =&gt; [\"a\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "is_accepted": false, "score": 4, "last_activity_date": 1456346331, "last_edit_date": 1456346331, "creation_date": 1456341206, "answer_id": 35611001, "question_id": 35610620, "link": "https://stackoverflow.com/questions/35610620/delete-array-element-if-index-position-is-greater-than-a-specific-value/35611001#35611001", "title": "Delete array element if index position is greater than a specific value", "body": "<p>You can use <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-slice-21\" rel=\"nofollow\"><code>slice!</code></a> and give it a range. It is a destructive method as indicated by the <code>!</code>, so it will mutate your array.</p>\n\n<pre><code>a = [1, 2, 3, 4]\na.slice!(2..-1)\n</code></pre>\n\n<p>a = <code>[1, 2]</code></p>\n"}, {"comments": [{"owner": {"reputation": 1004, "user_id": 2091331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ff378547e4b88acd5cd7b4f9b15b956?s=128&d=identicon&r=PG", "display_name": "Jbur43", "link": "https://stackoverflow.com/users/2091331/jbur43"}, "edited": false, "score": 0, "creation_date": 1456345461, "post_id": 35611290, "comment_id": 58908595, "body": "exactly what I needed. Thank you for the detailed answer."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 7, "last_activity_date": 1498140964, "last_edit_date": 1498140964, "creation_date": 1456342178, "answer_id": 35611290, "question_id": 35610620, "link": "https://stackoverflow.com/questions/35610620/delete-array-element-if-index-position-is-greater-than-a-specific-value/35611290#35611290", "title": "Delete array element if index position is greater than a specific value", "body": "<p>Here are some other ways to return <code>a</code> sans elements at indices >= <code>index</code>, which is probably better expressed as \"returning the first <code>index</code> elements\". All below return <code>[\"a\", \"b\"]</code>).</p>\n\n<pre><code>a = [\"a\", \"b\", \"c\", \"d\", \"e\"]\nindex = 2\n</code></pre>\n\n<p><em>Non-destructive (i.e., <code>a</code> is not altered)</em></p>\n\n<pre><code>a[0,index]\nindex.times.map { |i| a[i] }\n</code></pre>\n\n<p><em>Destructive (<code>a</code> is modified or \"mutated\")</em></p>\n\n<pre><code>a.object_id #=&gt; 70109376954280 \na = a[0,index]\na.object_id #=&gt; 70109377839640\n\na.object_id #=&gt; 70109377699700 \na.replace(a.first(index))\na.object_id #=&gt; 70109377699700 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 2, "last_activity_date": 1456350015, "creation_date": 1456350015, "answer_id": 35613719, "question_id": 35610620, "link": "https://stackoverflow.com/questions/35610620/delete-array-element-if-index-position-is-greater-than-a-specific-value/35613719#35613719", "title": "Delete array element if index position is greater than a specific value", "body": "<p>You can append <a href=\"http://ruby-doc.org/core-2.3.0/Enumerator.html#method-i-with_index\" rel=\"nofollow\"><code>with_index</code></a>:</p>\n\n<pre><code>a = [\"a\", \"b\", \"c\"]\na.delete_if.with_index { |x, i| i &gt; 1 }\na #=&gt; [\"a\", \"b\"]\n</code></pre>\n\n<p>Another example:</p>\n\n<pre><code>a = (\"a\"..\"z\").to_a\na.delete_if.with_index { |x, i| i.odd? }\n#=&gt; [\"a\", \"c\", \"e\", \"g\", \"i\", \"k\", \"m\", \"o\", \"q\", \"s\", \"u\", \"w\", \"y\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 5285531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I3Lu2.jpg?s=128&g=1", "display_name": "MattwalOlaide", "link": "https://stackoverflow.com/users/5285531/mattwalolaide"}, "is_accepted": false, "score": 0, "last_activity_date": 1456415144, "creation_date": 1456415144, "answer_id": 35631946, "question_id": 35610620, "link": "https://stackoverflow.com/questions/35610620/delete-array-element-if-index-position-is-greater-than-a-specific-value/35631946#35631946", "title": "Delete array element if index position is greater than a specific value", "body": "<p>Going by your question, <em>\"How can I delete an array element if it's array position is greater than a certain value?\"</em>.</p>\n\n<p>I assume what you want is that the final array you have should contain only elements before the specified index.</p>\n\n<p>You can just do this:</p>\n\n<pre><code>your_array.select { |element| your_array.index(element) &lt; max_index }\n</code></pre>\n\n<p>E.g</p>\n\n<pre><code>figures = [1,2,3,4,5,6]\nfigures.select{ |fig| figures.index(fig) &lt; 3 }\n# =&gt; [1, 2, 3]\n</code></pre>\n"}], "owner": {"reputation": 1004, "user_id": 2091331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ff378547e4b88acd5cd7b4f9b15b956?s=128&d=identicon&r=PG", "display_name": "Jbur43", "link": "https://stackoverflow.com/users/2091331/jbur43"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2022, "favorite_count": 0, "accepted_answer_id": 35611290, "answer_count": 5, "score": 4, "last_activity_date": 1498140964, "creation_date": 1456340053, "last_edit_date": 1456340750, "question_id": 35610620, "link": "https://stackoverflow.com/questions/35610620/delete-array-element-if-index-position-is-greater-than-a-specific-value", "title": "Delete array element if index position is greater than a specific value", "body": "<p>I am trying to delete elements from an array if its index is greater than a certain value. I am looking to do something like this:</p>\n\n<pre><code>a = [\"a\", \"b\", \"c\"]\nb = a.delete_if {|x| x.index &gt; 1 }\n</code></pre>\n\n<p>I took a look at <code>drop</code>, <code>delete_if</code>, etc. I tried completing this using <code>each_with_index</code> like this:</p>\n\n<pre><code>new_arr = []\na.each_with_index do |obj, index|\n    if index &gt; 1\n        obj.delete\n    end\n    new_arry &lt;&lt; obj\nend\n</code></pre>\n\n<p>How can I delete an array element if it's array position is greater than a certain value?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 0, "last_activity_date": 1456340329, "creation_date": 1456340329, "answer_id": 35610712, "question_id": 35610421, "link": "https://stackoverflow.com/questions/35610421/ruby-class-printing-name-in-another-class/35610712#35610712", "title": "Ruby class printing name in another class", "body": "<p>The <code>@name</code> variable is an <em>instance variable</em> and it can not be seen by methods within a different class. It can only be seen by methods within the same class. Try this instead:</p>\n\n<pre><code>class Greetings\n  def initialize\n    @name=\"Cleetus\"\n  end\n\n  def hello()\n    puts \"Hello #{@name}! How wonderful to see you today.\"\n  end\nend\n\n\ngreet = Greetings.new.hello\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 1, "last_activity_date": 1456342653, "last_edit_date": 1456342653, "creation_date": 1456342315, "answer_id": 35611332, "question_id": 35610421, "link": "https://stackoverflow.com/questions/35610421/ruby-class-printing-name-in-another-class/35611332#35611332", "title": "Ruby class printing name in another class", "body": "<p>It's common to put multiple classes inside the same module (sometimes called \"namespacing\") in Ruby, but it's unusual to have a class inside another class. Even if you do it's still a separate class and does not have access to instance variables in the \"outer\" class.</p>\n\n<p>What you need to do is to make your <code>@name</code> value accessible outside your NameData object. The usual way to do this in Ruby is with an attribute reader:</p>\n\n<pre><code>class NameData\n  attr_reader :name\n\n  def initialize\n    @name = \"Cleetus\"\n  end\nend\n\nname_data = NameData.new\nputs name_data.name\n# =&gt; Cleetus\n</code></pre>\n\n<p>Once you've done that you need to tell your Greetings object about the NameData object, and how to use it. One way to do that is to pass the NameData object as an argument to <code>hello</code>:</p>\n\n<pre><code>class Greetings\n  def hello(name_data)\n    puts \"Hello #{name_data.name}! How wonderful to see you today.\"\n  end\nend\n\ngreet = Greetings.new\ngreet.hello(name_data)\n# =&gt; Hello Cleetus! How wonderful to see you today.\n</code></pre>\n\n<p>Another way is to pass it to the Greetings constructor and save it in an instance variable:</p>\n\n<pre><code>class Greetings\n  def initialize(name_data)\n    @name_data = name_data\n  end\n\n  def hello\n    puts \"Hello #{@name_data.name}! How wonderful to see you today.\"\n  end\nend\n\ngreet = Greetings.new(name_data)\ngreet.hello\n# =&gt; Hello Cleetus! How wonderful to see you today.\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5976312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00af68c97fb587bba5096f36736ef00f?s=128&d=identicon&r=PG", "display_name": "cleetusreddington", "link": "https://stackoverflow.com/users/5976312/cleetusreddington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 35611332, "answer_count": 2, "score": 0, "last_activity_date": 1456342653, "creation_date": 1456339420, "last_edit_date": 1456341643, "question_id": 35610421, "link": "https://stackoverflow.com/questions/35610421/ruby-class-printing-name-in-another-class", "title": "Ruby class printing name in another class", "body": "<pre><code>class NameData\n  def initialize\n    @name=\"Cleetus\"\n  end\n\n  class Greetings\n    def hello()\n      puts \"Hello #{@name}! How wonderful to see you today.\"\n    end\n  end\nend\n\ngreet=Greetings.new\np greet.hello\n</code></pre>\n\n<p>Im a little bit of a beginner, but i'm trying to get my name to be used in the Greetings class so the string will print with my name inside. Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 10921, "user_id": 85125, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5636d7549013d9fc365de56ad90d12bc?s=128&d=identicon&r=PG", "display_name": "Bart Jedrocha", "link": "https://stackoverflow.com/users/85125/bart-jedrocha"}, "edited": false, "score": 0, "creation_date": 1456340032, "post_id": 35610265, "comment_id": 58905408, "body": "Can you provide more information as to where the error is being raised? Is it in one of the <code>before_action</code> methods or somewhere else?"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1456340442, "post_id": 35610265, "comment_id": 58905660, "body": "Could this be occurring because there is no next comment, i.e. you&#39;ve clicked next from the last comment? Or is it happening throughout?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4932805"}, "edited": false, "score": 0, "creation_date": 1456342575, "post_id": 35610265, "comment_id": 58906866, "body": "Please see edit above."}], "answers": [{"tags": [], "owner": {"reputation": 10921, "user_id": 85125, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5636d7549013d9fc365de56ad90d12bc?s=128&d=identicon&r=PG", "display_name": "Bart Jedrocha", "link": "https://stackoverflow.com/users/85125/bart-jedrocha"}, "is_accepted": true, "score": 1, "last_activity_date": 1456345146, "creation_date": 1456345146, "answer_id": 35612240, "question_id": 35610265, "link": "https://stackoverflow.com/questions/35610265/ruby-on-rails-navigation-between-comments/35612240#35612240", "title": "Ruby on Rails: Navigation Between Comments", "body": "<p>The <code>@scope</code> instance variable is undefined (and therefore <code>nil</code>) prior to you using it. Just change it to the following and it should work</p>\n\n<pre><code>def next_comment\n  @next_comment = scope.next(@comment)\nend\n\ndef scope\n  @scope ||= @article.comments\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4932805"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 35612240, "answer_count": 1, "score": 1, "last_activity_date": 1456407564, "creation_date": 1456338923, "last_edit_date": 1456407564, "question_id": 35610265, "link": "https://stackoverflow.com/questions/35610265/ruby-on-rails-navigation-between-comments", "title": "Ruby on Rails: Navigation Between Comments", "body": "<p>I'm attempting to create a button on the <code>show</code> page that will allow users to navigate between different comments.</p>\n\n<p>And for some reason, I keep getting either <code>article :id</code> or <code>comment :id</code> could not be found.</p>\n\n<p>Any idea why that happens? </p>\n\n<pre><code>#comment.rb\n\ndef self.next(comment, key = :id)\n  self.where(\"#{key} &gt; ?\", comment.send(key)).first\nend\n\n\n#comments_controller.rb\nclass CommentsController &lt; ApplicationController\n\n  before_action :find_article\n  before_action :find_comment\n\n  def next_comment \n    @next_comment = @scope.next(@comment)\n  end\n\n  def scope\n    @scope = @article.comments\n  end\nend\n\n#comments/show.html.haml\n= link_to \"Next Comment\", comments_next_comment_path(@next_comment)\n</code></pre>\n\n<p>EDIT: The problem was in my routes, which has now been fixed. \nBut now I get the following error: </p>\n\n<pre><code>undefined method \"next\" for nil:NilClass\n</code></pre>\n\n<p>EDIT 2: </p>\n\n<p>Here's the log--and the URL goes to <code>http://localhost:3000/articles/14/comments/56/next_comment</code></p>\n\n<p>Now it doesn't raise any errors but simply displays a blank page instead of going to the next comment URL which is <code>http://localhost:3000/articles/14/comments/70</code></p>\n\n<pre><code> Parameters: {\"article_id\"=&gt;\"14\", \"id\"=&gt;\"56\"}\n  Article Load (0.2ms)  SELECT  \"articles\".* FROM \"articles\" WHERE \"articles\".\"id\" = ? LIMIT 1  [[\"id\", 14]]\n  Comment Load (0.1ms)  SELECT  \"comments\".* FROM \"comments\" WHERE \"comments\".\"id\" = ? LIMIT 1  [[\"id\", 56]]\n  Rendered comments/next_comments.html.haml within layouts/application (0.2ms)\n</code></pre>\n"}, {"tags": ["ruby", "multithreading"], "comments": [{"owner": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 3, "creation_date": 1456338770, "post_id": 35610200, "comment_id": 58904605, "body": "Im not a ruby coder, but I would expect the &quot;index&quot; to be captured in a closure, and thus, all threads have access to the same index. doing something like:  <code>tmp=index</code> and then <code>puts tmp</code> would solve that if my thoughts are correct"}, {"owner": {"reputation": 167, "user_id": 428057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/64d38b17d3fb6ca3e8d3b2a5d9c54146?s=128&d=identicon&r=PG", "display_name": "Scarlet", "link": "https://stackoverflow.com/users/428057/scarlet"}, "reply_to_user": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 0, "creation_date": 1456338803, "post_id": 35610200, "comment_id": 58904627, "body": "I just realized that myself"}, {"owner": {"reputation": 167, "user_id": 428057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/64d38b17d3fb6ca3e8d3b2a5d9c54146?s=128&d=identicon&r=PG", "display_name": "Scarlet", "link": "https://stackoverflow.com/users/428057/scarlet"}, "reply_to_user": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 0, "creation_date": 1456338887, "post_id": 35610200, "comment_id": 58904687, "body": "@RogerAlsing Thanks for the answer, I was looking at it as a function call, not a piece of code being passed to thread."}], "owner": {"reputation": 167, "user_id": 428057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/64d38b17d3fb6ca3e8d3b2a5d9c54146?s=128&d=identicon&r=PG", "display_name": "Scarlet", "link": "https://stackoverflow.com/users/428057/scarlet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "closed_date": 1456339245, "answer_count": 0, "score": 0, "last_activity_date": 1456338683, "creation_date": 1456338683, "question_id": 35610200, "link": "https://stackoverflow.com/questions/35610200/why-are-not-ruby-threads-working-as-expected", "closed_reason": "Duplicate", "title": "Why are not ruby threads working as expected?", "body": "<p>In this code</p>\n\n<pre><code>threads=[]\nfor index in 1...100\n  threads&lt;&lt;Thread.new {puts index}\nend\nfor thread in threads\n  thread.join\nend\n</code></pre>\n\n<p>I expect all numbers between 1 and 99 to be printed, but when I run it, the output prints out mostly as \"99\" with a few 3s in between (<a href=\"http://paste.ubuntu.com/15189462/\" rel=\"nofollow\">http://paste.ubuntu.com/15189462/</a>).</p>\n\n<p>Why is ruby acting like this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "devise"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 3206627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a21c9c561c6fced2984ccd18740053?s=128&d=identicon&r=PG&f=1", "display_name": "user3206627", "link": "https://stackoverflow.com/users/3206627/user3206627"}, "edited": false, "score": 0, "creation_date": 1456355388, "post_id": 35613983, "comment_id": 58913769, "body": "Ah, good call on just using devise&#39;s helper ;). Unfortunately this didn&#39;t make any difference though :("}, {"owner": {"reputation": 4154, "user_id": 3123370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7856610653d1a0b44bf049c3d20b2a68?s=128&d=identicon&r=PG", "display_name": "MilesStanfield", "link": "https://stackoverflow.com/users/3123370/milesstanfield"}, "reply_to_user": {"reputation": 39, "user_id": 3206627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a21c9c561c6fced2984ccd18740053?s=128&d=identicon&r=PG&f=1", "display_name": "user3206627", "link": "https://stackoverflow.com/users/3206627/user3206627"}, "edited": false, "score": 0, "creation_date": 1456356424, "post_id": 35613983, "comment_id": 58914130, "body": "interesting. try using admin_user instead of user. like this <code>sign_in :admin_user, user</code>"}], "tags": [], "owner": {"reputation": 4154, "user_id": 3123370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7856610653d1a0b44bf049c3d20b2a68?s=128&d=identicon&r=PG", "display_name": "MilesStanfield", "link": "https://stackoverflow.com/users/3123370/milesstanfield"}, "is_accepted": false, "score": 0, "last_activity_date": 1456350957, "creation_date": 1456350957, "answer_id": 35613983, "question_id": 35610161, "link": "https://stackoverflow.com/questions/35610161/controller-specs-when-stubbing-devise-authentication-are-never-invoking-controll/35613983#35613983", "title": "Controller specs when stubbing devise authentication are never invoking controller action", "body": "<p>Don't write your own helper for that. Devise comes with a helper just for this</p>\n\n<p>Include it for your specs like this</p>\n\n<pre><code>#spec/rails_helper.rb\n...\nRSpec.configure do |config|\n  config.include Devise::TestHelpers, type: :controller\nend\n</code></pre>\n\n<p>And then use it. In your case all you need to do is change this</p>\n\n<pre><code>before do\n  sign_in user\nend\n</code></pre>\n\n<p>to this </p>\n\n<pre><code>before do\n  sign_in :user, user\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 3206627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a21c9c561c6fced2984ccd18740053?s=128&d=identicon&r=PG&f=1", "display_name": "user3206627", "link": "https://stackoverflow.com/users/3206627/user3206627"}, "is_accepted": true, "score": 0, "last_activity_date": 1456414083, "creation_date": 1456414083, "answer_id": 35631509, "question_id": 35610161, "link": "https://stackoverflow.com/questions/35610161/controller-specs-when-stubbing-devise-authentication-are-never-invoking-controll/35631509#35631509", "title": "Controller specs when stubbing devise authentication are never invoking controller action", "body": "<p>I figured out the issue and honestly it was pretty stupid and my own fault :P. In my application controller there is a <code>use_user_timezone</code> around filter. The around filter was only added to callbacks if there was a current_user. Earlier on, for some reason, I prevented the code in the around filter from running unless <code>Rails.env.test? == true</code>. Obviously I didn't really have any reason for writing this code.. The problem was that I was not preventing the <em>around_filter</em> from running if it was the test environment, but that I was preventing <em>the code in the filter method</em> from running if it was the test environment. Because of this I was not yielding to any code to execute for the around filter, which was of course causing the issue with the controller action never executing.</p>\n\n<p>The reason that devise was seeming to play an issue in the mix was because the around filter executing was dependent on a <code>current_user</code> being present. Due to this the controller flow was continuing on with no problem when no auth was occurring since there was no <code>current_user</code>.</p>\n\n<p>The wrap this up.. As always it's best to be attentive when making changes like this to a codebase as little bugs like this can cause major headaches later on down the road :).</p>\n"}], "owner": {"reputation": 39, "user_id": 3206627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a21c9c561c6fced2984ccd18740053?s=128&d=identicon&r=PG&f=1", "display_name": "user3206627", "link": "https://stackoverflow.com/users/3206627/user3206627"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 35631509, "answer_count": 2, "score": 0, "last_activity_date": 1456414083, "creation_date": 1456338567, "question_id": 35610161, "link": "https://stackoverflow.com/questions/35610161/controller-specs-when-stubbing-devise-authentication-are-never-invoking-controll", "title": "Controller specs when stubbing devise authentication are never invoking controller action", "body": "<p>So I'm running into a very weird issue when attempting to write some controller specs for a rails application I am working on. Basically at a high level it seems like the spec is never actually invoking the controller action. A couple of things that I've done and found..</p>\n\n<p>&nbsp;</p>\n\n<ol>\n<li><p>After doing some looking around I attempted to see if it was possibly a routing issue and to test this I used <code>controller.index</code> and sure enough the action is invoked and the test passed. That being said this obviously leads to issues when I'm attempting to call actions that require params so I'd like to get <code>#get|#post</code> etc. working. </p></li>\n<li><p>When I run <code>expect(response).to be_successful</code>and write <code>fail 'some message'</code> in the controller action the test still passes, which further proves nothing is occurring surrounding the controller action.</p></li>\n<li><p>I went about preventing devise from authenticating the user by removing <code>before_filter :authenticate_user!</code> from the application_controller and then for whatever reason the spec runs and hits the action correctly and the spec passes. Now, this is occurring even when using <code>#get</code> which works against the theory of this being a routing issue.</p></li>\n</ol>\n\n<p>&nbsp;</p>\n\n<p>Because of the last point I think the problem lies somewhere in how the devise auth is being handled so to touch on that the only thing in this stack that isn't straight out of the box devise-wise is a controller helper for authentication that I use before hitting protected views which is pulled directly from the devise wiki on specs. It can be see here:</p>\n\n<p>&nbsp;</p>\n\n<pre><code>def sign_in(user = double('user'))\n  if user.nil?\n    allow(request.env['warden']).to receive(:authenticate!).and_throw(:warden, {:scope =&gt; :user})\n    allow(controller).to receive(:current_user).and_return(nil)\n  else\n    allow(request.env['warden']).to receive(:authenticate!).and_return(user)\n    allow(controller).to receive(:current_user).and_return(user)\n  end\nend\n</code></pre>\n\n<p>&nbsp;</p>\n\n<p>Now even though I think the issue is in devise it's probably a good idea to give examples of everything else. So let me give you a lay of the land (of course some stuff is scrubbed out and simplified):</p>\n\n<p>&nbsp;</p>\n\n<p>routes.rb:</p>\n\n<pre><code>namespace :api, path: '', constraints: { subdomain: 'api' }, defaults: { format: :json } do\n  namespace :v1 do\n    ..\n    resources :accounts\n  end\nend\n</code></pre>\n\n<p>&nbsp;</p>\n\n<p>alerts_controller.rb:</p>\n\n<pre><code>class AlertsController &lt; ApplicationController\n  respond_to :html\n\n  def index\n    @alerts = Alert.all\n  end\n\nend\n</code></pre>\n\n<p>&nbsp;</p>\n\n<p>alerts_controller_spec.rb:</p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe AlertsController, type: :controller do\n  let(:user){ create :user, :admin }\n  let(:alert){ create :alert }\n\n  before do\n    sign_in user\n  end\n\n  describe 'GET index' do\n    it 'responds successfully' do\n      get :index\n      expect(assigns(:alerts)).to eq [alert]\n    end\n   end\nend\n</code></pre>\n\n<p>&nbsp;</p>\n\n<p><code>rake routes =&gt; GET /v1/alerts(.:format) api/v1/alerts#index {:subdomain=&gt;\"api\"}</code></p>\n\n<p>&nbsp;</p>\n\n<p>Any help would be highly appreciated as I'm seriously stumped.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5976114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EqQ3MYTuBds/AAAAAAAAAAI/AAAAAAAAAD0/hTpvOgHERAc/photo.jpg?sz=128", "display_name": "weredoomed", "link": "https://stackoverflow.com/users/5976114/weredoomed"}, "edited": false, "score": 0, "creation_date": 1456353718, "post_id": 35611641, "comment_id": 58913089, "body": "Sorry for the late reply, I will see if I can get this working. I had something working with arrays but once I try and use the search method for the ransack gem it all broke.."}, {"owner": {"reputation": 1, "user_id": 5976114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EqQ3MYTuBds/AAAAAAAAAAI/AAAAAAAAAD0/hTpvOgHERAc/photo.jpg?sz=128", "display_name": "weredoomed", "link": "https://stackoverflow.com/users/5976114/weredoomed"}, "edited": false, "score": 0, "creation_date": 1456354091, "post_id": 35611641, "comment_id": 58913254, "body": "Also the option of using Postgres is a no for my project unfortunately."}, {"owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "reply_to_user": {"reputation": 1, "user_id": 5976114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EqQ3MYTuBds/AAAAAAAAAAI/AAAAAAAAAD0/hTpvOgHERAc/photo.jpg?sz=128", "display_name": "weredoomed", "link": "https://stackoverflow.com/users/5976114/weredoomed"}, "edited": false, "score": 0, "creation_date": 1456359113, "post_id": 35611641, "comment_id": 58915064, "body": "Sometimes it helps to work out the SQL before translating it into ActiveRecord. Getting the whole Item sounds a lot like this: <a href=\"http://stackoverflow.com/questions/3800551/select-first-row-in-each-group-by-group/25534279\" title=\"select first row in each group by group\">stackoverflow.com/questions/3800551/&hellip;</a> and also see <a href=\"http://illuminatedcomputing.com/posts/2015/02/postgres_lateral_join/\" rel=\"nofollow noreferrer\">illuminatedcomputing.com/posts/2015/02/postgres_lateral_join</a>"}, {"owner": {"reputation": 1, "user_id": 5976114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EqQ3MYTuBds/AAAAAAAAAAI/AAAAAAAAAD0/hTpvOgHERAc/photo.jpg?sz=128", "display_name": "weredoomed", "link": "https://stackoverflow.com/users/5976114/weredoomed"}, "edited": false, "score": 0, "creation_date": 1456418269, "post_id": 35611641, "comment_id": 58947861, "body": "Thank you so much for the help!"}], "tags": [], "owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "is_accepted": false, "score": 0, "last_activity_date": 1456343298, "creation_date": 1456343298, "answer_id": 35611641, "question_id": 35610152, "link": "https://stackoverflow.com/questions/35610152/rails-max-version-with-grouping/35611641#35611641", "title": "Rails - max version with grouping", "body": "<p>I'm not positive, but I think you are asking, \"Give me all this Project's ItemOriginals, and on each one include the version of its highest-versioned Item.\" In that case, this should work:</p>\n\n<pre><code>@items = @project.item_originals.select(\"item_originals.*, (SELECT MAX(version) FROM items i WHERE i.item_original_id = item_originals.id) AS max_version\")\n</code></pre>\n\n<p>Then on each item you can get its <code>max_version</code>:</p>\n\n<pre><code>- @items.each do |item|\n  = item.max_version \n</code></pre>\n\n<p>If you need the <em>whole</em> item and not just the version, you should switch to Postgres and use a <code>LATERAL JOIN</code>. :-)</p>\n"}], "owner": {"reputation": 1, "user_id": 5976114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EqQ3MYTuBds/AAAAAAAAAAI/AAAAAAAAAD0/hTpvOgHERAc/photo.jpg?sz=128", "display_name": "weredoomed", "link": "https://stackoverflow.com/users/5976114/weredoomed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456343298, "creation_date": 1456338545, "question_id": 35610152, "link": "https://stackoverflow.com/questions/35610152/rails-max-version-with-grouping", "title": "Rails - max version with grouping", "body": "<p>Okay, I have searched for an answer but I keep getting stuck on this problem. I am trying to get the max version for a group of items. This is what I have working, and it grabs all the correct items but does not grab the latest version of them.</p>\n\n<pre><code>    def index\n       @project = Project.find(params[:project_id])\n\n       @items = Item.group(:original_id).where(original_id: ItemOriginal.select(\"id\").where(:project_id =&gt; @project.id))\n    end\n</code></pre>\n\n<p>A project has many ItemOriginals and ItemOriginals have many Items.</p>\n\n<p>I anything I try with max version or last created_at only grabs one record and not a record for each ItemOriginal</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1007, "user_id": 5351714, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed8a93ea89809e3812bdfb926389ff96?s=128&d=identicon&r=PG&f=1", "display_name": "lolix", "link": "https://stackoverflow.com/users/5351714/lolix"}, "edited": false, "score": 0, "creation_date": 1456741828, "post_id": 35610143, "comment_id": 59071136, "body": "but I want put this matrix in a view!"}], "tags": [], "owner": {"reputation": 2172, "user_id": 4412925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7fa1503a3820659b27943c99d463a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel", "link": "https://stackoverflow.com/users/4412925/nabeel"}, "is_accepted": false, "score": 1, "last_activity_date": 1456338848, "last_edit_date": 1456338848, "creation_date": 1456338517, "answer_id": 35610143, "question_id": 35610060, "link": "https://stackoverflow.com/questions/35610060/display-array-inside-array-in-a-table-view/35610143#35610143", "title": "display array inside array in a table (view)", "body": "<pre><code>matrix = Array.new(3){Array.new(4){0}}\n\nputs matrix.map {|x| x.join(' ')}\n\n0 0 0 0\n0 0 0 0\n0 0 0 0\n</code></pre>\n"}], "owner": {"reputation": 1007, "user_id": 5351714, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed8a93ea89809e3812bdfb926389ff96?s=128&d=identicon&r=PG&f=1", "display_name": "lolix", "link": "https://stackoverflow.com/users/5351714/lolix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456338848, "creation_date": 1456338244, "question_id": 35610060, "link": "https://stackoverflow.com/questions/35610060/display-array-inside-array-in-a-table-view", "title": "display array inside array in a table (view)", "body": "<p>How can I display an array of array in a table (view) ?</p>\n\n<pre><code>matrix = Array.new(rows){Array.new(cols){0}}\n</code></pre>\n\n<p>like that:</p>\n\n<pre><code>0 0 0 0\n0 0 0 0\n0 0 0 0\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 228271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c465ec8414f2ff014861292a0c6990b7?s=128&d=identicon&r=PG", "display_name": "JP.", "link": "https://stackoverflow.com/users/228271/jp"}, "edited": false, "score": 0, "creation_date": 1456785616, "post_id": 35610386, "comment_id": 59099077, "body": "I created an <code>add_role</code> method as you suggested and it&#39;s working great; no monkey patching required.  Thank you for your help."}], "tags": [], "owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1456339338, "last_edit_date": 1495540783, "creation_date": 1456339338, "answer_id": 35610386, "question_id": 35609931, "link": "https://stackoverflow.com/questions/35609931/can-i-override-create-with-first-or-create/35610386#35610386", "title": "Can I override &quot;create&quot; with &quot;first_or_create&quot;?", "body": "<p><strong>It is possible with <a href=\"http://culttt.com/2015/06/17/what-is-monkey-patching-in-ruby/\" rel=\"nofollow noreferrer\">monkey patching</a> but it's a very bad idea.</strong> You would be asking for major trouble down the road when you or someone else expects the code to behave in a certain default way. What if the requirements change and you remove the validation? You would silently never be able to create multiple records with <code>create</code> because <code>first_or_create</code> would always find the existing one.</p>\n\n<p>The best alternative would be to check if the <code>role</code> already exists in <code>scene.roles</code>. For example:</p>\n\n<pre><code>scene.roles.include?(role) ? false : scene.roles &lt;&lt; role\n# does scene.roles include role? if yes: do nothing, if not: add role\n</code></pre>\n\n<p>Or do something like <a href=\"https://stackoverflow.com/a/4730577/1241782\">this</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 6059, "user_id": 1197246, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1c752a51e48f7574720d80c2468006e7?s=128&d=identicon&r=PG", "display_name": "Tom Prats", "link": "https://stackoverflow.com/users/1197246/tom-prats"}, "is_accepted": false, "score": 0, "last_activity_date": 1456354472, "last_edit_date": 1456354472, "creation_date": 1456352828, "answer_id": 35614479, "question_id": 35609931, "link": "https://stackoverflow.com/questions/35609931/can-i-override-create-with-first-or-create/35614479#35614479", "title": "Can I override &quot;create&quot; with &quot;first_or_create&quot;?", "body": "<p>One way is to add this in a <code>before_validation</code> method that wouldn't actually raise an error, but would remove the previous role if it exists. In this you would be able to handle edge cases.</p>\n\n<pre><code>class SceneRole &lt; ActiveRecord::Base\n  before_validation :single_relation\n\n  def single_relation\n    # Checks new and stored records for duplicate and removes it\n    # Might want to have this on both scene and role instead of here\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 228271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c465ec8414f2ff014861292a0c6990b7?s=128&d=identicon&r=PG", "display_name": "JP.", "link": "https://stackoverflow.com/users/228271/jp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 35610386, "answer_count": 2, "score": 1, "last_activity_date": 1456854465, "creation_date": 1456337815, "last_edit_date": 1456854465, "question_id": 35609931, "link": "https://stackoverflow.com/questions/35609931/can-i-override-create-with-first-or-create", "title": "Can I override &quot;create&quot; with &quot;first_or_create&quot;?", "body": "<p>I currently have <code>Scene</code> and <code>Role</code> models, and a <code>SceneRole</code> association table joining them:</p>\n\n<pre><code>class Scene &lt; ActiveRecord::Base\n  has_many :scene_role\n  has_many :roles, through: :scene_role\nend\n\nclass Role &lt; ActiveRecord::Base\n  has_many :scene_role\n  has_many :scenes, through: :scene_role\nend\n\nclass SceneRole &lt; ActiveRecord::Base\n  belongs_to :scene\n  belongs_to :role\n\n  validates_presence_of :scene_id\n  validates_presence_of :role_id\n\n  validates_uniqueness_of :scene, :scope =&gt; :role\nend\n</code></pre>\n\n<p>I want to ensure that any same scene-role relationship is unique. But I also want to gracefully handle attempts to add a <code>Role</code> to a <code>Scene</code> when the relationship already exists without getting an error:  <code>ActiveRecord::RecordInvalid: Validation failed: Scene has already been taken</code></p>\n\n<p>My test code:</p>\n\n<pre><code>role = Role.new(name: \"Big Bossman\")\nscene = Scene.new(name: \"Arena\")\n\nscene.roles &lt;&lt; role # success\nscene.roles &lt;&lt; role # Exception\n</code></pre>\n\n<p>Is it possible to override <code>create</code> with the behavior of <code>first_or_create</code>?  I believe that would solve my problem. However, if there is a better way to accomplish the same result I'd appreciate any suggestions. Thank you!</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "performance", "postgresql"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1456338224, "post_id": 35609865, "comment_id": 58904281, "body": "Please edit your question to include the code that defines <code>@model_a</code>, <code>@model_b</code>, and <code>@model_c</code>."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1456338836, "post_id": 35609865, "comment_id": 58904648, "body": "Hi Jordan - have done. I&#39;ve also added the way they&#39;re related. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1456396666, "post_id": 35612746, "comment_id": 58931476, "body": "Thanks very much for the input Paul. This makes perfect sense and is exactly the approach I was looking for, <i>but</i> it actually slows the request by about 10 seconds. Unusual right? I&#39;ve benchmarked the two queries and yours is consistently faster as a one off (~ 1.6s v 2.5s). Implementing your methodology cuts down the ActiveRecord load time tenfold (5s - 500ms), though increases the view rendering by about 15s; exactly the opposite of what I&#39;d expected to see. What do you think? Again, thanks again for your help here, I read it and thought &#39;yep, spot on!&#39;."}, {"owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1456405078, "post_id": 35612746, "comment_id": 58937397, "body": "I assume you have indexes already on all foreign key columns? How large are A and B? If B is large, consider paginating. If A is large, see the update I made to the answer. If A is very large, I would find a way not to render all columns every time, but let users choose what they want to see."}, {"owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1456405338, "post_id": 35612746, "comment_id": 58937609, "body": "Also if both A and B are very large, I would consider bypassing ActiveRecord here and just writing a SQL query. As long as you&#39;re using  AR, it&#39;s going to be costly instantiating all those ModelCs. Since you&#39;ll have a variable number of columns (one for each ModelA), this article mibht help: <a href=\"http://illuminatedcomputing.com/posts/2013/03/fun-postgres-puzzle/\" rel=\"nofollow noreferrer\">illuminatedcomputing.com/posts/2013/03/fun-postgres-puzzle</a>"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1456410206, "post_id": 35612746, "comment_id": 58941154, "body": "That&#39;s great, thanks so much for the guidance. I will take your advice and implement as above - I think a SQL query will prove the best approach."}], "tags": [], "owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "is_accepted": true, "score": 1, "last_activity_date": 1456404989, "last_edit_date": 1456404989, "creation_date": 1456346819, "answer_id": 35612746, "question_id": 35609865, "link": "https://stackoverflow.com/questions/35609865/fastest-where-request-involving-three-models-in-rails/35612746#35612746", "title": "Fastest `where` request involving three models in Rails", "body": "<p>In the view, this code will run a new SQL query each table cell:</p>\n\n<pre><code>@model_c.where(model_a_id: a.id, model_b_id: b.id).first\n</code></pre>\n\n<p>So that's probably what's really hurting you. Remember that <code>where</code> is part of ActiveRecord and goes to the database, whereas <code>select</code> operates on enumerables and does everything in memory.</p>\n\n<p>You should load everything with the right relationships upfront. I would start with this:</p>\n\n<pre><code>@model_a = ModelA.all\n@model_b = ModelB.includes(:model_cs)\n</code></pre>\n\n<p>Then do this:</p>\n\n<pre><code>&lt;tbody&gt;\n  &lt;!-- Each row represents a different instance of Model B --&gt;\n  &lt;% @model_b.each do |b| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;\n        &lt;%= b.name %&gt;\n      &lt;/td&gt;\n      &lt;% @model_a.each do |a| %&gt;\n        &lt;td&gt;\n          &lt;!-- The actual table data is from Model C, when it belongs to both Model A and Model B --&gt;\n          &lt;% if c = b.model_cs.select{|x| x.model_a_id = a.id}.first %&gt;\n            &lt;%= c.name %&gt;\n          &lt;% end %&gt;\n        &lt;/td&gt;\n      &lt;% end %&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>That should get you everything in two or three queries.</p>\n\n<p>Note if A is large, the <code>select</code> will still perform poorly because it does a linear search. So you could write a method on your ModelB class like this instead, and use it in the view:</p>\n\n<pre><code>def model_c_for(a)\n  @model_c_by_a ||= Hash[\n    model_cs.map{|c| [c.model_a_id, c]}\n  ]\n  @model_c_by_a[a.id]\nend\n</code></pre>\n"}], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 35612746, "answer_count": 1, "score": 0, "last_activity_date": 1456404989, "creation_date": 1456337620, "last_edit_date": 1456338582, "question_id": 35609865, "link": "https://stackoverflow.com/questions/35609865/fastest-where-request-involving-three-models-in-rails", "title": "Fastest `where` request involving three models in Rails", "body": "<p>I'm having a little trouble with a slow page load in Rails, I'm certain due to the way I'm querying the database (PostgreSQL).</p>\n\n<p>To summarise the situation, I've three models - let's call them <code>Model A</code>, <code>Model B</code> and <code>Model C</code> - that I'm plugging into a table, and am struggling to find an efficient way to query the data.</p>\n\n<p><code>Model A</code> provides the table's header row, <code>Model B</code> each row in the <code>tbody</code>; <code>Model C</code> belongs to both <code>Model A</code> and <code>Model B</code> and provides the table data.</p>\n\n<p>Here's a quick example:</p>\n\n<p>Say the model variables are as follows:</p>\n\n<pre><code>@model_a = ModelA.all\n@model_b = ModelB.all\n@model_c = ModelC.all\n</code></pre>\n\n<p>Related as follows:</p>\n\n<pre><code>class ModelA\n\n  has_many :model_cs\n\nend\n\nclass ModelB\n\n  has_many :model_cs\n\nend\n\nclass ModelC\n\n  belongs_to :model_a\n  belongs_to :model_b\n\nend\n</code></pre>\n\n<p>And in the view:</p>\n\n<pre><code>&lt;table&gt;\n\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th&gt;&lt;/th&gt;\n      &lt;!-- Model A provides the table headers --&gt;\n      &lt;% @model_a.each do |a| %&gt;\n        &lt;th&gt;\n          &lt;%= a.name %&gt;\n        &lt;/th&gt;\n      &lt;% end %&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n\n  &lt;tbody&gt;\n    &lt;!-- Each row represents a different instance of Model B --&gt;\n    &lt;% @model_b.each do |b| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;\n          &lt;%= b.name %&gt;\n        &lt;/td&gt;\n        &lt;% @model_a.each do |a| %&gt;\n          &lt;td&gt;\n            &lt;!-- The actual table data is from Model C, when it belongs to both Model A and Model B --&gt;\n            &lt;% if (c = @model_c.where(model_a_id: a.id, model_b_id: b.id).first).present? %&gt;\n              &lt;%= c.name %&gt;\n            &lt;% end %&gt;\n          &lt;/td&gt;\n        &lt;% end %&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;/tbody&gt;\n\n&lt;/table&gt;\n</code></pre>\n\n<p>Obviously this is really slow and, I'd imagine, rather stinky code. I can cache the fragment, but would much rather speed up the request so it runs smoothly following any changes to the data. Happy to consider different approaches to this - I just can't think of a way to present the data in this manner without iterating through two models to query the third.</p>\n\n<p>I'm sure there's a far, <em>far</em> better way to approach this but have yet to come up with it. Hope you guys can help - thanks in advance, Steve.</p>\n"}, {"tags": ["ruby", "momentjs"], "comments": [{"owner": {"reputation": 2688, "user_id": 164237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5290492d327de6973c0f52e82d9cbf35?s=128&d=identicon&r=PG", "display_name": "bschaeffer", "link": "https://stackoverflow.com/users/164237/bschaeffer"}, "edited": false, "score": 1, "creation_date": 1456336922, "post_id": 35609576, "comment_id": 58903537, "body": "Is there an offset in the timestamp? Looks like your issue is timezone based because the output of <code>format</code> is technically correct."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5734159, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8b35098dc8f74bb910ea36793b345f8b?s=128&d=identicon&r=PG&f=1", "display_name": "WhomWhomWhom", "link": "https://stackoverflow.com/users/5734159/whomwhomwhom"}, "reply_to_user": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "edited": false, "score": 0, "creation_date": 1456765659, "post_id": 35628440, "comment_id": 59087306, "body": "@MattJohnson, thanks for the feedback. Already added my fixed."}], "tags": [], "owner": {"reputation": 49, "user_id": 5734159, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8b35098dc8f74bb910ea36793b345f8b?s=128&d=identicon&r=PG&f=1", "display_name": "WhomWhomWhom", "link": "https://stackoverflow.com/users/5734159/whomwhomwhom"}, "is_accepted": true, "score": 1, "last_activity_date": 1456765635, "last_edit_date": 1495540765, "creation_date": 1456406266, "answer_id": 35628440, "question_id": 35609576, "link": "https://stackoverflow.com/questions/35609576/moment-js-displaying-date-incorrectly/35628440#35628440", "title": "Moment.js displaying date incorrectly", "body": "<p>I found my answer in <a href=\"https://stackoverflow.com/questions/15130735/how-can-i-remove-time-from-my-date-with-moment-js\">this post</a>. Auto-answering in case anybody runs into the same issue. As @bschaeffer said, it was a timezone problem, this fixed it: </p>\n\n<pre><code>moment.utc(date).format('L')\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5734159, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8b35098dc8f74bb910ea36793b345f8b?s=128&d=identicon&r=PG&f=1", "display_name": "WhomWhomWhom", "link": "https://stackoverflow.com/users/5734159/whomwhomwhom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 35628440, "answer_count": 1, "score": 0, "last_activity_date": 1456765635, "creation_date": 1456336724, "question_id": 35609576, "link": "https://stackoverflow.com/questions/35609576/moment-js-displaying-date-incorrectly", "title": "Moment.js displaying date incorrectly", "body": "<p>I have a record which reads : <code>date: \"2016-02-01 00:00:05</code>. However, when I do <code>moment(date).format(\"L\")</code> the view renders <code>01/31/2016</code>. \nAny idea why? This happens which all dates, always one day before</p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "undefined"], "answers": [{"comments": [{"owner": {"reputation": 854, "user_id": 881928, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f7263925ee0d1993df5546e56801b45e?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya1510", "link": "https://stackoverflow.com/users/881928/aditya1510"}, "edited": false, "score": 0, "creation_date": 1456413297, "post_id": 35610402, "comment_id": 58943774, "body": "error is of undefined method.That means isElementPresent is undefined. I need help for this"}, {"owner": {"reputation": 1068, "user_id": 5860267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DP1L7.jpg?s=128&g=1", "display_name": "Prateek", "link": "https://stackoverflow.com/users/5860267/prateek"}, "reply_to_user": {"reputation": 854, "user_id": 881928, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f7263925ee0d1993df5546e56801b45e?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya1510", "link": "https://stackoverflow.com/users/881928/aditya1510"}, "edited": false, "score": 0, "creation_date": 1456422919, "post_id": 35610402, "comment_id": 58951076, "body": "I don&#39;t think you&#39;d need Demo for calling function."}], "tags": [], "owner": {"reputation": 1068, "user_id": 5860267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DP1L7.jpg?s=128&g=1", "display_name": "Prateek", "link": "https://stackoverflow.com/users/5860267/prateek"}, "is_accepted": true, "score": 1, "last_activity_date": 1456422839, "last_edit_date": 1456422839, "creation_date": 1456339380, "answer_id": 35610402, "question_id": 35609334, "link": "https://stackoverflow.com/questions/35609334/undefined-method-error-in-ruby-selenium/35610402#35610402", "title": "undefined method error in ruby selenium", "body": "<p>As per my understanding, Your condition should be: </p>\n\n<pre><code>if (allElements.size&gt;0)\nreturn true\n</code></pre>\n\n<p>As if size is 0. That means no element is present.</p>\n\n<p>Also, in this case your function definition should end before you are calling it.\nTry following code:</p>\n\n<pre><code>$num=1\ndef isElementPresent(xpathExpression)\n  allElements=@driver.find_elements(:xpath,xpathExpression)\n  if (allElements.size&gt;0)\n    return true\n  end\n  else\n    return false\n  end\nend\nwhile isElementPresent(str1+$num.to_s+str2) do\n    text=@driver.find_element(:xpath,str1+$num.to_s+str2).text\n    $num+=1\n    puts \"text is:#{text}\"\n    @driver.find_element(:xpath,str1+$num.to_s+str2).click\n    puts @driver.title\n    @driver.navigate.back\nend\n</code></pre>\n\n<p>Here I have made two changes: First, for the condition I explained about and Second, Ending the definition of function before your loop.</p>\n\n<p>Please let me know if it works as intended.</p>\n"}], "owner": {"reputation": 854, "user_id": 881928, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f7263925ee0d1993df5546e56801b45e?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya1510", "link": "https://stackoverflow.com/users/881928/aditya1510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "accepted_answer_id": 35610402, "answer_count": 1, "score": 0, "last_activity_date": 1456422839, "creation_date": 1456335907, "last_edit_date": 1456343626, "question_id": 35609334, "link": "https://stackoverflow.com/questions/35609334/undefined-method-error-in-ruby-selenium", "title": "undefined method error in ruby selenium", "body": "<p>I am using ruby with selenium and my code is as follows:</p>\n\n<pre><code>$num=1\ndef isElementPresent(xpathExpression)\n  allElements=@driver.find_elements(:xpath,xpathExpression)\n\n  if (allElements.size==0)\n    return true\n    end\n  else\n    return false\n  end\n\n  while Demo.isElementPresent(str1+$num.to_s+str2)\n    text=@driver.find_element(:xpath,str1+$num.to_s+str2).text\n    $num+=1\n    puts \"text is:#{text}\"\n    @driver.find_element(:xpath,str1+$num.to_s+str2).click\n    puts @driver.title\n    @driver.navigate.back\n  end\nend\n</code></pre>\n\n<p>I'm getting an undefined method error for <code>while Demo.isElementPresent(str1+$num.to_s+str2).</code></p>\n\n<p>Any help is appreciated</p>\n"}, {"tags": ["mysql", "ruby", "csv", "split", "row"], "answers": [{"tags": [], "owner": {"reputation": 308, "user_id": 5963316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86a5772242debdf0728675a5a690a373?s=128&d=identicon&r=PG&f=1", "display_name": "EVAL", "link": "https://stackoverflow.com/users/5963316/eval"}, "is_accepted": true, "score": 0, "last_activity_date": 1456850997, "creation_date": 1456850997, "answer_id": 35728668, "question_id": 35609137, "link": "https://stackoverflow.com/questions/35609137/splitting-the-rows-of-a-mysql-query-using-ruby-and-writing-to-a-csv-file/35728668#35728668", "title": "Splitting the Rows of a MySQL Query Using Ruby and Writing to a CSV File", "body": "<p>I constructed the <strong>FULL</strong> code for the following answer based on several assumptions:</p>\n\n<ul>\n<li>No <code>DATE_FORMAT(db.table.end, '%m') = 6</code></li>\n<li>You wish for all the\ncompanies listed to be in the order they are found in (i.e.\n<code>db.table.id</code>)</li>\n<li>Query time isn't a gigantic issue for you</li>\n<li>You wanted but couldn't or forgot to include an array named <code>weekOf</code></li>\n</ul>\n\n<p>You also seem to have the term <code>SELECT</code> too many times in your query.  And even for a query as small as the sample you provided you may want to separate it and avoid keeping it all on one line:</p>\n\n<pre><code>month = mysql.query(\"SELECT DATE_FORMAT(db.table.start, '%m')\n    FROM db.table\n    WHERE db.start.group = 1;\")\n</code></pre>\n\n<p>instead of:</p>\n\n<p><code>month = mysql.query(\"SELECT DATE_FORMAT(db.table.start, '%m') FROM db.table WHERE db.start.group = 1;\")</code></p>\n\n<p>And now for the code itself:</p>\n\n<pre><code>#!/usr/local/bin/ruby\nrequire \"mysql2\"\nrequire \"watir\"\nrequire \"csv\"\n\nputs \"Initializing Report\"\n\nMysql2::Client.default_query_options.merge!(:as =&gt; :array)\n\nmysql = Mysql2::Client.new(:host =&gt; \"1.2.3.4\", :username =&gt; \"user\", :pass =&gt; \"password\", :database =&gt; \"db\")\n\nputs \"Successfully accessed db\"\n\ndate = mysql.query(\"SELECT DATE_FORMAT(db.table.start, '%m'),\n  DATE_FORMAT(db.table.start, '%d')\n  FROM db.table\n  WHERE db.start.group = 1;\")\n\nreport = mysql.query(\"SELECT c, s, e FROM (SELECT * FROM (SELECT db.table.id\n  db.table.client AS c,\n  DATE_FORMAT(db.table.start, '%m/%d/%Y') AS s,\n  DATE_FORMAT(db.table.end, '%m/%d/%Y') AS e\n  FROM db.table\n  WHERE db.start.group = 1\n  UNION ALL\n  SELECT db.table.id\n  db.table.client AS c,\n  DATE_FORMAT(db.table.start, '%m/%d/%Y') AS s,\n  DATE_FORMAT(db.table.end, '%m/%d/%Y') AS e\n  FROM db.table\n  WHERE db.start.group = 1\n  HAVING ((DATE_FORMAT(db.table.start, '%m') = 5) OR (DATE_FORMAT(db.table.start, '%d') &lt;= 4))\n  UNION ALL\n  SELECT db.table.id\n  db.table.client AS c,\n  DATE_FORMAT(db.table.start, '%m/%d/%Y') AS s,\n  DATE_FORMAT(db.table.end, '%m/%d/%Y') AS e\n  FROM db.table\n  WHERE db.start.group = 1\n  HAVING ((DATE_FORMAT(db.table.start, '%m') = 5) OR (DATE_FORMAT(db.table.start, '%d') &lt;= 11))\n  UNION ALL\n  SELECT db.table.id\n  db.table.client AS c,\n  DATE_FORMAT(db.table.start, '%m/%d/%Y') AS s,\n  DATE_FORMAT(db.table.end, '%m/%d/%Y') AS e\n  FROM db.table\n  WHERE db.start.group = 1\n  HAVING ((DATE_FORMAT(db.table.start, '%m') = 5) OR (DATE_FORMAT(db.table.start, '%d') &lt;= 18))) AS alias\n  ORDER BY db.table.id) AS alias2;\")\n\nweekOf = []\n\ndate.each do |mon, day|\n  if mon === 5\n    weekOf &lt;&lt; \"06/04/2014\"\n    weekOf &lt;&lt; \"06/11/2014\"\n    weekOf &lt;&lt; \"06/18/2014\"\n    weekOf &lt;&lt; \"06/25/2014\"\n  elsif mon === 6\n    if (day.to_i &lt;= 4)\n      weekOf &lt;&lt; \"06/04/2014\"\n      weekOf &lt;&lt; \"06/11/2014\"\n      weekOf &lt;&lt; \"06/18/2014\"\n      weekOf &lt;&lt; \"06/25/2014\"\n    elsif ((day.to_i &gt;= 11) &amp;&amp; (day.to_i &lt;= 17))\n      weekOf &lt;&lt; \"06/11/2014\"\n      weekOf &lt;&lt; \"06/18/2014\"\n      weekOf &lt;&lt; \"06/25/2014\"\n    elsif ((day.to_i &gt;= 18) &amp;&amp; (day.to_i &lt;= 24))\n      weekOf &lt;&lt; \"06/18/2014\"\n      weekOf &lt;&lt; \"06/25/2014\"\n    else\n      weekOf &lt;&lt; \"06/25/2014\"\n    end\n  else\n    puts \"Error: #{mon} is before May\"\n  end\nend\n\nCSV.open(\"Report.csv\", \"wb\") do |csv|\n  csv &lt;&lt; [\"Week of\", \"Client\", \"Start Date\", \"End Date\"]\n  weekOf.zip(report).each {|row| csv &lt;&lt; row.flatten}\nend\n\nputs \"Results can be found in Report.csv\"\n</code></pre>\n\n<p>The explanation:</p>\n\n<p>I took the assumption that query time wasn't a big issue for you seeing that your sample query is rather small and contains no <code>JOIN</code>.  If you find that your query is becoming larger than ten or so <code>INNER JOIN</code> (for, say, tables with hundreds of thousands of entries each) then this might no longer be the best solution for you.</p>\n\n<p>This solution has <strong>two</strong> parts.</p>\n\n<p>The <strong>first</strong> is the duplication of rows from the database itself using <code>UNION ALL</code>.  This means repeating the entire query and adding criteria below to specify when this duplication happens.</p>\n\n<p>That's where the <code>HAVING</code> clause comes in.  When using <code>UNION ALL</code>, <code>HAVING</code> must be used in this fashion instead of <code>WHERE</code>; as the latter will result in an error for MySQL.</p>\n\n<p>Also be sure to keep in mind that every MySQL table created as a result of a subquery must have an alias: <code>alias</code> and <code>alias2</code>.  I used not one but two nested queries in order to <code>ORDER BY db.table.id</code> (going off one of my assumptions) and to then select only the columns we need for the next part.</p>\n\n<p>Finally, I combined the two separate <code>month</code> and <code>day</code> and instead turned them into one <code>date</code>: which will return a two dimensional array when iterated over.</p>\n\n<p><strong>Second</strong>: I created that <code>weekOf</code> array that you probably meant to but forgot to include.</p>\n\n<p>I then iterated over <code>date</code> in order to push the right <code>\"06/#{day}/2014\"</code> into the <code>weekOf</code> array.</p>\n\n<p>And that's it!  I hope this helps.</p>\n"}], "owner": {"reputation": 308, "user_id": 5963316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86a5772242debdf0728675a5a690a373?s=128&d=identicon&r=PG&f=1", "display_name": "EVAL", "link": "https://stackoverflow.com/users/5963316/eval"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 35728668, "answer_count": 1, "score": 0, "last_activity_date": 1456850997, "creation_date": 1456335320, "last_edit_date": 1456422156, "question_id": 35609137, "link": "https://stackoverflow.com/questions/35609137/splitting-the-rows-of-a-mysql-query-using-ruby-and-writing-to-a-csv-file", "title": "Splitting the Rows of a MySQL Query Using Ruby and Writing to a CSV File", "body": "<p>Using Ruby to automate MySQL queries from a remote database, I wish to split rows based on the value of the <code>month</code> query found below.</p>\n\n<p>This is to generate a week-by-week (Wednesday to the following Tueday) report for the month of June back in 2014 for all clients based off of the start date.  While nothing else in the report will change, the duplication of rows is based off of that start date (explained in the <code>case</code> statement below).</p>\n\n<p>Note the use of the <code>mysql2</code>, <code>watir</code> and <code>csv</code> gems here.</p>\n\n<p>Simplified code:</p>\n\n<pre><code>#!/usr/local/bin/ruby\nrequire \"mysql2\"\nrequire \"watir\"\nrequire \"csv\"\n\nputs \"Initializing Report\"\n\nMysql2::Client.default_query_options.merge!(:as =&gt; :array)\n\nmysql = Mysql2::Client.new(:host =&gt; \"1.2.3.4\", :username =&gt; \"user\", :pass =&gt; \"password\", :database =&gt; \"db\")\n\nputs \"Successfully accessed db\"\n\nmonth = mysql.query(\"SELECT DATE_FORMAT(db.table.start, '%m') FROM db.table WHERE db.start.group = 1;\")\n\nday = mysql.query(\"SELECT DATE_FORMAT(db.table.start, '%d') FROM db.table WHERE db.start.group = 1;\")\n\nreport = mysql.query(\"SELECT db.table.client, SELECT DATE_FORMAT(db.table.start, '%m/%d/%Y'), SELECT DATE_FORMAT(db.table.end, '%m/%d/%Y') FROM db.table WHERE db.start.group = 1;\")\n\ncase month\nwhen 5\n  # code splitting one row into four\nwhen 6\n  if day &lt;= 4\n    # code splitting one row into four using weekOf\n  elsif day &gt;= 11 and day &lt;= 17\n    # code splitting one row into three using weekOf\n  elsif day &gt;= 18 and day &lt;= 24\n    # code splitting one row into two using weekOf\n  else\n    # no splitting; only one row using weekOf\n  end\nend\n\nCSV.open(\"Report.csv\", \"wb\") do |csv|\n  csv &lt;&lt; [\"Week of\", \"Client\", \"Start Date\", \"End Date\"]\n  weekOf.zip(report).each {|row| csv &lt;&lt; row.flatten}\nend\n\nputs \"Results can be found in Report.csv\"\n</code></pre>\n\n<p>Current output (if I were to comment out that <code>case</code> statement, remove the <code>\"Week of\",</code> in the CSV header and only write the <code>report</code> query to the CSV):</p>\n\n<pre><code>Client, Start Date, End Date\ncompanyrecordlabel, 05/20/2014, 07/09/2015\nbeeUrself, 05/27/2014, 02/01/2016\noverflowStack, 06/04/2014, 12/11/2015\nchapoChaps, 06/11/2014, 01/16/2016\nMeds4U, 06/18/2014, NULL\n  .\n  .\n  .\n</code></pre>\n\n<p>And I would desire the following output:</p>\n\n<pre><code>Week of, Client, Start Date, End Date\n06/04/2014, companyrecordlabel, 05/20/2014, 07/09/2015\n06/11/2014, companyrecordlabel, 05/20/2014, 07/09/2015\n06/18/2014, companyrecordlabel, 05/20/2014, 07/09/2015\n06/25/2014, companyrecordlabel, 05/20/2014, 07/09/2015\n06/04/2014, beeUrself, 05/27/2014, 02/01/2016\n06/11/2014, beeUrself, 05/27/2014, 02/01/2016\n06/18/2014, beeUrself, 05/27/2014, 02/01/2016\n06/25/2014, beeUrself, 05/27/2014, 02/01/2016\n06/04/2014, overflowStack, 06/04/2014, 12/11/2015\n06/11/2014, overflowStack, 06/04/2014, 12/11/2015\n06/18/2014, overflowStack, 06/04/2014, 12/11/2015\n06/25/2014, overflowStack, 06/04/2014, 12/11/2015\n06/11/2014, chapoChaps, 06/11/2014, 01/16/2016\n06/18/2014, chapoChaps, 06/11/2014, 01/16/2016\n06/25/2014, chapoChaps, 06/11/2014, 01/16/2016\n06/18/2014, Meds4U, 06/18/2014, NULL\n06/25/2014, Meds4U, 06/18/2014, NULL\n  .\n  .\n  .\n</code></pre>\n\n<p>For clarity: the <code>\"Client\"</code> as <code>companyrecordlabel</code> has four rows because its <code>\"Start Date\"</code> is in May while the <code>\"Client\"</code> <code>Meds4U</code> was only split into two rows because its <code>\"Start Date\"</code> was on the 18th of June.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "inheritance", "devise"], "owner": {"reputation": 897, "user_id": 4645227, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/50d116f701889e0977127909fc1ce8d5?s=128&d=identicon&r=PG&f=1", "display_name": "Prezes \u0141ukasz", "link": "https://stackoverflow.com/users/4645227/prezes-%c5%81ukasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1456334757, "creation_date": 1456334757, "question_id": 35608959, "link": "https://stackoverflow.com/questions/35608959/using-devise-with-class-type-inheritance", "title": "Using Devise with class type inheritance", "body": "<p>How properly implement devise gem in multiple models, when I use CTI(class type inheritance)? I have 3 classes: Person(abstract class), Client and Employee that inherit. To design CTI, I add <a href=\"https://github.com/mvdamme/dbview_cti\" rel=\"nofollow\">dbview_cti</a> gem. I want have register view for each inherited classes and shared rest function e.g. sign in. All tutorials describe implementation only for STI. I will be very grateful for detailed instructions.</p>\n\n<p>Model Person</p>\n\n<pre><code>class Person &lt; ActiveRecord::Base\n self.abstract_class = true\n self.table_name = 'people'\n cti_base_class\nend\n</code></pre>\n\n<p>Model Client</p>\n\n<pre><code>class Client &lt; Person\n  cti_derived_class\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "json"], "comments": [{"owner": {"reputation": 1296, "user_id": 659661, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3WUJk.jpg?s=128&g=1", "display_name": "kjprice", "link": "https://stackoverflow.com/users/659661/kjprice"}, "edited": false, "score": 0, "creation_date": 1456334799, "post_id": 35608889, "comment_id": 58902145, "body": "Are <code>@all_things</code> and <code>@all_feed_cards</code> the same thing?"}, {"owner": {"reputation": 3094, "user_id": 3312595, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Xhpeq.jpg?s=128&g=1", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/3312595/rorschach"}, "reply_to_user": {"reputation": 1296, "user_id": 659661, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3WUJk.jpg?s=128&g=1", "display_name": "kjprice", "link": "https://stackoverflow.com/users/659661/kjprice"}, "edited": false, "score": 0, "creation_date": 1456334887, "post_id": 35608889, "comment_id": 58902214, "body": "@kjprice yes, sorry fixed it (code still doesn&#39;t work though)"}], "answers": [{"comments": [{"owner": {"reputation": 3094, "user_id": 3312595, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Xhpeq.jpg?s=128&g=1", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/3312595/rorschach"}, "edited": false, "score": 0, "creation_date": 1456335133, "post_id": 35609010, "comment_id": 58902385, "body": "Each of these lines returns a <code>!! #&lt;NoMethodError: undefined method ``updated_at&#39; for #&lt;Hash:0xb80af74&gt;&gt;</code> for me"}, {"owner": {"reputation": 1296, "user_id": 659661, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3WUJk.jpg?s=128&g=1", "display_name": "kjprice", "link": "https://stackoverflow.com/users/659661/kjprice"}, "reply_to_user": {"reputation": 3094, "user_id": 3312595, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Xhpeq.jpg?s=128&g=1", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/3312595/rorschach"}, "edited": false, "score": 0, "creation_date": 1456335317, "post_id": 35609010, "comment_id": 58902505, "body": "Hmm, it wasn&#39;t clear to me if you were sorting ActiveRecord objects or the JSON. Updated my answer for JSON."}, {"owner": {"reputation": 3094, "user_id": 3312595, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Xhpeq.jpg?s=128&g=1", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/3312595/rorschach"}, "edited": false, "score": 0, "creation_date": 1456336671, "post_id": 35609010, "comment_id": 58903387, "body": "I have tried your answer but it seems to have no effect on the ouput. See edit 1"}], "tags": [], "owner": {"reputation": 1296, "user_id": 659661, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3WUJk.jpg?s=128&g=1", "display_name": "kjprice", "link": "https://stackoverflow.com/users/659661/kjprice"}, "is_accepted": false, "score": 0, "last_activity_date": 1456340248, "last_edit_date": 1456340248, "creation_date": 1456334912, "answer_id": 35609010, "question_id": 35608889, "link": "https://stackoverflow.com/questions/35608889/ordering-rails-array-of-jsons-by-the-key-updated-at-s-value/35609010#35609010", "title": "Ordering Rails Array of Json&#39;s by the key &quot;updated_at&quot; &#39;s value", "body": "<p>I think you're just calling <code>#sort_by</code> incorrectly:</p>\n\n<pre><code> @all_things.sort_by { |thing| thing[\"updated_at\"] }\n</code></pre>\n\n<p>Since you're sorting by datetime strings, you can parse them into DateTime objects:</p>\n\n<pre><code> @all_things.sort_by { |thing| DateTime.httpdate(thing[\"updated_at\"]) }\n</code></pre>\n\n<p>I'd like to suggest as well, that this might be a design problem. For this specific problem of union'ing two classes, you could consider single-table inheritance.</p>\n"}, {"comments": [{"owner": {"reputation": 3094, "user_id": 3312595, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Xhpeq.jpg?s=128&g=1", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/3312595/rorschach"}, "edited": false, "score": 0, "creation_date": 1456336627, "post_id": 35609082, "comment_id": 58903357, "body": "That returns a &#39;!! #&lt;NoMethodError: undefined method ``updated_at&#39; for #&lt;Hash:0xb80af74&gt;&gt;&#39; for me"}], "tags": [], "owner": {"reputation": 2683, "user_id": 5226835, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ae0a35e74a44eb63b7cb68b63547d03?s=128&d=identicon&r=PG", "display_name": "rakwaht", "link": "https://stackoverflow.com/users/5226835/rakwaht"}, "is_accepted": false, "score": 0, "last_activity_date": 1456335145, "creation_date": 1456335145, "answer_id": 35609082, "question_id": 35608889, "link": "https://stackoverflow.com/questions/35608889/ordering-rails-array-of-jsons-by-the-key-updated-at-s-value/35609082#35609082", "title": "Ordering Rails Array of Json&#39;s by the key &quot;updated_at&quot; &#39;s value", "body": "<p>You are using the sort in the worng way. Try with that:</p>\n\n<blockquote>\n  <p>@all_things.sort_by { |a| a[:updated_at] }</p>\n</blockquote>\n"}], "owner": {"reputation": 3094, "user_id": 3312595, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Xhpeq.jpg?s=128&g=1", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/3312595/rorschach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 887, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456340248, "creation_date": 1456334591, "last_edit_date": 1456336224, "question_id": 35608889, "link": "https://stackoverflow.com/questions/35608889/ordering-rails-array-of-jsons-by-the-key-updated-at-s-value", "title": "Ordering Rails Array of Json&#39;s by the key &quot;updated_at&quot; &#39;s value", "body": "<p>I am trying to order an array of jsons by a value.</p>\n\n<p>I cannot just query the database with <code>.order('created_at DESC')</code> because my array is filled with information from 2 different tables.</p>\n\n<p>Here is the code that I  have so far:</p>\n\n<pre><code>@user_items = UserItem.where(user_id: @friends.to_a).order('created_at DESC')\n@user_pics = Pic.where(user_id: @friends.to_a).order('created_at DESC')\n@all_things = @user_pics + @user_items\n@all_things.sort_by{\"updated_at\"}\n</code></pre>\n\n<p>This does not error but when I run the code the first things in the list are always all the pictures followed by all the items. So, it seems the list line of code is doing nothing.</p>\n\n<p>Here is a sample of what <code>user_pics[0]</code> looks like:</p>\n\n<p><code>{\"id\"=&gt;15, \"user_id\"=&gt;2, \"name\"=&gt;\"New titles\", \"creator\"=&gt;nil, \"size\"=&gt;nil, \"created_at\"=&gt;Sun, 14 Feb 2016 02:41:12 UTC +00:00, \"updated_at\"=&gt;Sun, 14 Feb 2016 02:41:12 UTC +00:00 ...}</code></p>\n\n<p>EDIT 1</p>\n\n<p>Sadly, the suggested answer does not seem to be working. Below are a few different outputs. Firstly, a pic that was updated Feb 14, then items that were updated Feb 24 and Feb 13 respectively. It seems the array is still ordered with all pictures first then all items.</p>\n\n<blockquote>\n  <blockquote>\n    <p>@all_things.sort_by { |a| a[:updated_at] } [0]\n    => {\"id\"=>15, \"user_id\"=>2, \"name\"=>\"New titles\", \"creator\"=>nil, \"size\"=>nil, \"mark_count\"=>nil, \"created_at\"=>Sun, 14 Feb 2016 02:41:12 UTC +00:00, \"updated_at\"=>Sun, 14 Feb 2016 02:41:12 UTC +00:00 ... }</p>\n    \n    <p>@all_things.sort_by { |a| a[:updated_at] } [4]\n    => {\"id\"=>846, \"item_id\"=>669, \"user_id\"=>2, \"created_at\"=>Wed, 24 Feb 2016 16:43:54 UTC +00:00, \"updated_at\"=>Wed, 24 Feb 2016 16:43:54 UTC +00:00, ...}</p>\n    \n    <p>@all_things.sort_by { |a| a[:updated_at] } [50]\n    => {\"id\"=>797, \"item_id\"=>623, \"user_id\"=>2, \"created_at\"=>Sat, 13 Feb 2016 03:58:29 UTC +00:00, \"updated_at\"=>Sat, 13 Feb 2016 03:58:29 UTC +00:00, ...}</p>\n  </blockquote>\n</blockquote>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 2962305, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333b818a87472bbf51f2050c0957a03a?s=128&d=identicon&r=PG&f=1", "display_name": "Barhum", "link": "https://stackoverflow.com/users/2962305/barhum"}, "edited": false, "score": 0, "creation_date": 1456334843, "post_id": 35608826, "comment_id": 58902177, "body": "not sure if this would work, as :array_param is nested inside :name"}, {"owner": {"reputation": 205, "user_id": 2962305, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333b818a87472bbf51f2050c0957a03a?s=128&d=identicon&r=PG&f=1", "display_name": "Barhum", "link": "https://stackoverflow.com/users/2962305/barhum"}, "edited": false, "score": 0, "creation_date": 1456335720, "post_id": 35608826, "comment_id": 58902768, "body": "this worked permitted[:name][:array_param] = params[:name].require(:array_param)"}, {"owner": {"reputation": 205, "user_id": 2962305, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333b818a87472bbf51f2050c0957a03a?s=128&d=identicon&r=PG&f=1", "display_name": "Barhum", "link": "https://stackoverflow.com/users/2962305/barhum"}, "edited": false, "score": 0, "creation_date": 1456337060, "post_id": 35608826, "comment_id": 58903632, "body": "Thank you, worked great! In the if statement I did check for params[:name][:array_param].present?"}], "tags": [], "owner": {"reputation": 18593, "user_id": 4304188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5695b0e5c30d4464163e3f3412fe5f1?s=128&d=identicon&r=PG", "display_name": "Mihai Dinculescu", "link": "https://stackoverflow.com/users/4304188/mihai-dinculescu"}, "is_accepted": true, "score": 1, "last_activity_date": 1456338626, "last_edit_date": 1456338626, "creation_date": 1456334415, "answer_id": 35608826, "question_id": 35608603, "link": "https://stackoverflow.com/questions/35608603/multi-dimensional-array-in-strong-params/35608826#35608826", "title": "Multi-dimensional array in strong_params", "body": "<p>You need to take the long route and do it like this</p>\n\n<pre><code>def permitted_params\n  permitted = params.require(:name)\n\n  if params[:name][:array_param].present?\n    permitted[:name][:array_param] = params[:name].require(:array_param)\n  end\n\n  permitted\nend\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 2962305, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333b818a87472bbf51f2050c0957a03a?s=128&d=identicon&r=PG&f=1", "display_name": "Barhum", "link": "https://stackoverflow.com/users/2962305/barhum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 35608826, "answer_count": 1, "score": 1, "last_activity_date": 1456338626, "creation_date": 1456333824, "question_id": 35608603, "link": "https://stackoverflow.com/questions/35608603/multi-dimensional-array-in-strong-params", "title": "Multi-dimensional array in strong_params", "body": "<p>I am trying to accept a multi-dimensional array using strong_params.</p>\n\n<p>I was using: </p>\n\n<pre><code>params.require(:name).permit(array_param: []) \n</code></pre>\n\n<p>and it was working fine for regular arrays.</p>\n\n<p>Now I got a multi-dimensional array format I have to deal with. The previous solution is not working for the following case.</p>\n\n<pre><code>[[1],[2],[2,1]]\n</code></pre>\n\n<p>I would gladly appreciate some guidance.  Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1456332943, "post_id": 35608196, "comment_id": 58900776, "body": "Update your question with the <code>cabs&#47;index.html.erb</code> code."}, {"owner": {"reputation": 6388, "user_id": 45254, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8126f7b02a2fb9038f05158320fbace?s=128&d=identicon&r=PG", "display_name": "Krule", "link": "https://stackoverflow.com/users/45254/krule"}, "edited": false, "score": 0, "creation_date": 1456332987, "post_id": 35608196, "comment_id": 58900819, "body": "Your request path route should look like <code>&#47;cabs&#47;:cab_id&#47;bookings&#47;new</code>. Is it?"}, {"owner": {"reputation": 3, "user_id": 5475586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a88d6218c117e813eab8611677bf14c?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Acharya", "link": "https://stackoverflow.com/users/5475586/abhishek-acharya"}, "reply_to_user": {"reputation": 6388, "user_id": 45254, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8126f7b02a2fb9038f05158320fbace?s=128&d=identicon&r=PG", "display_name": "Krule", "link": "https://stackoverflow.com/users/45254/krule"}, "edited": false, "score": 0, "creation_date": 1456333053, "post_id": 35608196, "comment_id": 58900866, "body": "yes thats the path @Krule"}], "answers": [{"tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1456333295, "creation_date": 1456333295, "answer_id": 35608443, "question_id": 35608196, "link": "https://stackoverflow.com/questions/35608196/how-to-access-child-new-form-from-parent-index-page-in-rails/35608443#35608443", "title": "how to access child new form from parent index page in rails?", "body": "<blockquote>\n  <p>No route matches {:action=>\"new\", :cab_id=>nil,\n  :controller=>\"bookings\"} missing required keys: [:cab_id]</p>\n</blockquote>\n\n<p>The problem is with this line</p>\n\n<pre><code>&lt;%= link_to \"Book Now\", new_cab_booking_path(@cab, @booking) %&gt;\n</code></pre>\n\n<p>which should be</p>\n\n<pre><code>&lt;%= link_to \"Book Now\", new_cab_booking_path(cab) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5475586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a88d6218c117e813eab8611677bf14c?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Acharya", "link": "https://stackoverflow.com/users/5475586/abhishek-acharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 35608443, "answer_count": 1, "score": 0, "last_activity_date": 1456333295, "creation_date": 1456332683, "last_edit_date": 1456333214, "question_id": 35608196, "link": "https://stackoverflow.com/questions/35608196/how-to-access-child-new-form-from-parent-index-page-in-rails", "title": "how to access child new form from parent index page in rails?", "body": "<p>I am trying to fetch booking controller's new form, from the cab index page. how can i fetch it? how can access the new form from cab index page where i have shown all the cabs which are added..</p>\n\n<h1>cab controller</h1>\n\n<pre><code>    class CabsController &lt; ApplicationController\n\n\nbefore_action :find_cab, only: [:show, :edit, :update, :destroy]\n\ndef index\n    @cabs = Cab.all.order(\"created_at DESC\")\nend\n\ndef new\n    @cab = Cab.new\nend\n\ndef show\n    @reviews = Review.where(cab_id: @cab.id).order(\"created_at DESC\")\n\n    if @reviews.blank?\n      @avg_review=0\n    else\n      @avg_review=@reviews.average(:rating).round(2)\n    end\nend\n\ndef edit\nend\n\ndef create\n    @cab = Cab.new(cab_params)\n    if @cab.save\n        redirect_to @cab\n    else\n        render 'new' \n    end\nend\n\ndef update\n    if @cab.update(cab_params)\n        redirect_to @cab\n    else\n        render 'edit'\n    end\nend\n\ndef destroy\n    @cab.destroy\n\n    redirect_to root_path\nend\n\nprivate\n\ndef find_cab\n    @cab = Cab.find(params[:id])\nend\n\n\ndef cab_params\n    params.require(:cab).permit(:name, :number_plate, :seat, :image)\nend \nend\n</code></pre>\n\n<h1>booking controller</h1>\n\n<pre><code>    class BookingsController &lt; ApplicationController\n\nbefore_action :find_booking, only: [:show, :edit, :update, :destroy]\nbefore_action :find_cab\n\ndef index\n @bookings = Booking.where(cab_id: @cab.id).order(\"created_at DESC\")\nend\n\ndef new\n @booking = Booking.new\nend\n\ndef show\nend\n\ndef edit\nend\n\ndef create\n  @booking = Booking.new(booking_params)\n  @booking.user_id = current_user.id\n  @booking.cab_id = @cab.id\n\n  if @booking.save\n   redirect_to cab_booking_path(@cab, @booking)\n else\n   render 'new'\n end\nend\n\ndef update\nend\n\ndef destroy\nend\n\nprivate\n\ndef find_booking\n  @booking = Booking.find(params[:id])\nend\n\ndef find_cab\n  @cab = Cab.find(params[:cab_id])\nend\n\ndef booking_params\n  params.require(:booking).permit(:date, :address, :start_destination, :destination, :start_date, :end_date, :contact_no)\nend\n\nend\n</code></pre>\n\n<h1>routes</h1>\n\n<pre><code>     resources :cabs  do\n       resources :bookings\n     end\n</code></pre>\n\n<h1>cab/index.html.erb</h1>\n\n<pre><code>    &lt;div class=\"container\"&gt;\n&lt;h2&gt;All Cabs&lt;/h2&gt;\n&lt;div class=\"row\"&gt;\n\n\n    &lt;% @cabs.each do |cab| %&gt;\n        &lt;div class=\"col-sm-6 col-md-3\"&gt;\n            &lt;div class=\"thumbnail\"&gt;\n                &lt;%= link_to image_tag(cab.image.url(:medium), class: 'image'), cab %&gt;&lt;br&gt;\n                Cab Name : &lt;h4&gt;&lt;%= cab.name %&gt;&lt;/h4&gt;\n                &lt;%= link_to \"Book Now\", new_cab_booking_path(@cab, @booking) %&gt; # i wanted to create this link\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;% end %&gt;\n&lt;/div&gt;\n&lt;%= link_to \"Add Cab\", new_cab_path, class: 'btn btn-default' %&gt;\n</code></pre>\n\n<p></p>\n\n<h1>the error i am getting is</h1>\n\n<pre><code>    No route matches {:action=&gt;\"new\", :cab_id=&gt;nil, :controller=&gt;\"bookings\"} missing required keys: [:cab_id]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "enums"], "comments": [{"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 4, "creation_date": 1456331550, "post_id": 35607624, "comment_id": 58899664, "body": "My guess is: your status column is to be integer, not string."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1456331677, "post_id": 35607624, "comment_id": 58899771, "body": "Are you trying to compare a string (value set was <code>&#39;archived&#39;</code>) to an array of symbols? There might be a type mismatch here, leading to a wrong validation"}, {"owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "edited": false, "score": 0, "creation_date": 1456332248, "post_id": 35607624, "comment_id": 58900225, "body": "That was exactly it. I had to change the database column to integer not string. Thanks for pointing that out."}], "answers": [{"tags": [], "owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "is_accepted": true, "score": 2, "last_activity_date": 1456333544, "creation_date": 1456333544, "answer_id": 35608515, "question_id": 35607624, "link": "https://stackoverflow.com/questions/35607624/can-someone-point-out-to-me-why-activerecordenum-is-not-working-as-expected-in/35608515#35608515", "title": "Can someone point out to me why ActiveRecord::Enum is not working as expected in this simple example?", "body": "<p>The issue is caused by your <code>status</code> column being string column, not the integer. Change it to integer and everything will work as expected.</p>\n"}], "owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "accepted_answer_id": 35608515, "answer_count": 1, "score": 1, "last_activity_date": 1456333544, "creation_date": 1456331267, "last_edit_date": 1456331587, "question_id": 35607624, "link": "https://stackoverflow.com/questions/35607624/can-someone-point-out-to-me-why-activerecordenum-is-not-working-as-expected-in", "title": "Can someone point out to me why ActiveRecord::Enum is not working as expected in this simple example?", "body": "<p>I am implementing some code refactoring and for my purposes, I've determined that ActiveRecord::Enum would be a perfect fit. For those who have not used or heard of ActiveRecord::Enum here is the documentation link\n<a href=\"http://edgeapi.rubyonrails.org/classes/ActiveRecord/Enum.html\" rel=\"nofollow\">ActiveRecord::Enum</a>.</p>\n\n<p>Here is code taken from the docs that I am having a problem with.</p>\n\n<pre><code>class Conversation &lt; ActiveRecord::Base\n enum status: [ :active, :archived ]\nend\n\n# conversation.update! status: 0\nconversation.active!\nconversation.active? # =&gt; true\nconversation.status  # =&gt; \"active\"\n\n# conversation.update! status: 1\nconversation.archived!\nconversation.archived? # =&gt; true\nconversation.status    # =&gt; \"archived\"\n\n# conversation.status = 1\nconversation.status = \"archived\"\n\nconversation.status = nil\nconversation.status.nil? # =&gt; true\nconversation.status      # =&gt; nil\n</code></pre>\n\n<p>Here is my example code which tries to mimic this behavior:</p>\n\n<pre><code>class ReverificationTracer &lt; ActiveRecord::Base\n    enum status: [ :verified, :unverified ]\nend\n\nrev = ReverificationTracker.create\n\nrev.verified! ==&gt; true\nrev.unverified? ==&gt; false\nrev.status ==&gt; nil\n\nrev.unverified! ==&gt; true\nrev.unverified? ==&gt; false\nrev.status ==&gt; nil\n</code></pre>\n\n<p>When I inspect the <code>rev</code> variable, I do see that the status has shifted to <code>'0'</code></p>\n\n<pre><code>rev\n\nid: 1,\naccount_id: nil,\nstatus: \"0\",\ncreated_at: Wed, 24 Feb 2016 16:24:55 UTC +00:00,\nupdated_at: Wed, 24 Feb 2016 16:25:21 UTC +00:00&gt;\n</code></pre>\n\n<p>When it is archived I see the status increment to 1.</p>\n\n<p>Why is this not working as I would expect from the documentation?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 2, "creation_date": 1456331009, "post_id": 35607313, "comment_id": 58899206, "body": "This is a common XY-problem asked repeatedly. You should use an array to keep all the values."}, {"owner": {"reputation": 141, "user_id": 3950314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f452817dbb732a622ea3609a357c18e?s=128&d=identicon&r=PG&f=1", "display_name": "John Nikolaou", "link": "https://stackoverflow.com/users/3950314/john-nikolaou"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1456331184, "post_id": 35607313, "comment_id": 58899361, "body": "Variables are used by external software, it doesn&#39;t take in array elements. I mean I wrote this above as well, its a limitation I can&#39;t overcome, its not my own unwillingness to work with arrays...."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1456331285, "post_id": 35607313, "comment_id": 58899449, "body": "But you seem to have freedom with variable naming (local or instance). It is a strange situation that you nevertheless do not have freedom of using an array. Your situation is not clear."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1456331630, "post_id": 35607313, "comment_id": 58899737, "body": "By the way, how does it make sense to have a variable name restricted to certain a format by an external software? Especially, local variables&#39; scope is the method body or a block. I can&#39;t imagine a situation where you are calling an external software from Ruby, and the (local) variable name matters."}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 1, "creation_date": 1456331692, "post_id": 35607313, "comment_id": 58899781, "body": "Can I ask why you want to have a set of variables containing a counter instead of just an array? Why is @variable_0 better than @variables[0]?"}, {"owner": {"reputation": 141, "user_id": 3950314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f452817dbb732a622ea3609a357c18e?s=128&d=identicon&r=PG&f=1", "display_name": "John Nikolaou", "link": "https://stackoverflow.com/users/3950314/john-nikolaou"}, "edited": false, "score": 0, "creation_date": 1456332030, "post_id": 35607313, "comment_id": 58900037, "body": "Variable is passed to an external ruby function which then calls java. Attempting to pass an element of an array to the functions produces an error."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1456332165, "post_id": 35607313, "comment_id": 58900157, "body": "@JohnNikolaou that doesn&#39;t make much sense. You are passing the object that is assigned to the variable, not the variable itself. Therefore, it is irrelevant if the object is assigned to a variable or element of an array."}], "answers": [{"comments": [{"owner": {"reputation": 5747, "user_id": 1052504, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d24c555de0ab090f0b822155f31affe4?s=128&d=identicon&r=PG", "display_name": "jturolla", "link": "https://stackoverflow.com/users/1052504/jturolla"}, "edited": false, "score": 1, "creation_date": 1456331283, "post_id": 35607546, "comment_id": 58899442, "body": "This is a terrible pattern, you should have answered something that would help the OP to do better code, like creating an array of values and operation on them."}, {"owner": {"reputation": 6388, "user_id": 45254, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8126f7b02a2fb9038f05158320fbace?s=128&d=identicon&r=PG", "display_name": "Krule", "link": "https://stackoverflow.com/users/45254/krule"}, "reply_to_user": {"reputation": 5747, "user_id": 1052504, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d24c555de0ab090f0b822155f31affe4?s=128&d=identicon&r=PG", "display_name": "jturolla", "link": "https://stackoverflow.com/users/1052504/jturolla"}, "edited": false, "score": 0, "creation_date": 1456331365, "post_id": 35607546, "comment_id": 58899518, "body": "True that. But poster has expressed that <code>Array</code> can&#39;t be used. Who am I to judge?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1456331386, "post_id": 35607546, "comment_id": 58899536, "body": "You don&#39;t need the colon in <code>:&quot;@variable_#{i}&quot;</code>. The method accepts strings as well as symbols."}, {"owner": {"reputation": 6388, "user_id": 45254, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8126f7b02a2fb9038f05158320fbace?s=128&d=identicon&r=PG", "display_name": "Krule", "link": "https://stackoverflow.com/users/45254/krule"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1456331444, "post_id": 35607546, "comment_id": 58899583, "body": "Thank you @sawa, corrected."}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "reply_to_user": {"reputation": 5747, "user_id": 1052504, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d24c555de0ab090f0b822155f31affe4?s=128&d=identicon&r=PG", "display_name": "jturolla", "link": "https://stackoverflow.com/users/1052504/jturolla"}, "edited": false, "score": 0, "creation_date": 1456331514, "post_id": 35607546, "comment_id": 58899639, "body": "@jturolla Yes, this is terrible pattern, but he ask a question and this is correct answer. Ofc, better way is to use <code>Hash</code> or <code>Array</code>."}, {"owner": {"reputation": 141, "user_id": 3950314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f452817dbb732a622ea3609a357c18e?s=128&d=identicon&r=PG&f=1", "display_name": "John Nikolaou", "link": "https://stackoverflow.com/users/3950314/john-nikolaou"}, "edited": false, "score": 0, "creation_date": 1456331570, "post_id": 35607546, "comment_id": 58899687, "body": "This works for me, thanks, I do try to write as good code as possible and to improve, but when you&#39;re given a very strict external non-modifiable framework, you try to survive"}], "tags": [], "owner": {"reputation": 6388, "user_id": 45254, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8126f7b02a2fb9038f05158320fbace?s=128&d=identicon&r=PG", "display_name": "Krule", "link": "https://stackoverflow.com/users/45254/krule"}, "is_accepted": false, "score": 2, "last_activity_date": 1456331419, "last_edit_date": 1456331419, "creation_date": 1456331112, "answer_id": 35607546, "question_id": 35607313, "link": "https://stackoverflow.com/questions/35607313/using-loop-counter-as-part-of-a-variables-name-in-ruby/35607546#35607546", "title": "Using loop counter as part of a variable&#39;s name in Ruby", "body": "<p>Your second example is almost valid. You forgot <code>@</code> for instance variable name and you passed a symbol as value instead the value itself.</p>\n\n<pre><code>for i in 0..15 do\n  index_val = \"some value #{i}\"\n  instance_variable_set(\"@variable_#{i}\", index_val)\nend\n\nputs @variable_4 # \"some value\"\n</code></pre>\n\n<p><a href=\"https://repl.it/BnLO/6\" rel=\"nofollow\">https://repl.it/BnLO/6</a></p>\n"}, {"comments": [{"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1456331713, "post_id": 35607759, "comment_id": 58899799, "body": "correct answer but not the &quot;nice&quot; one. I rly dont like use <code>eval</code> this way. but +1"}, {"owner": {"reputation": 2172, "user_id": 4412925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7fa1503a3820659b27943c99d463a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel", "link": "https://stackoverflow.com/users/4412925/nabeel"}, "reply_to_user": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1456331774, "post_id": 35607759, "comment_id": 58899835, "body": "Agreed eval always seems <i>evil</i>, however this is the way as described by ruby docs (<a href=\"http://ruby-doc.org/core-2.3.0/Binding.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.3.0/Binding.html</a>)"}, {"owner": {"reputation": 2172, "user_id": 4412925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7fa1503a3820659b27943c99d463a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel", "link": "https://stackoverflow.com/users/4412925/nabeel"}, "reply_to_user": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 1, "creation_date": 1456331994, "post_id": 35607759, "comment_id": 58900001, "body": "I&#39;ve updated it without eval as well, seems it was possible after all!"}], "tags": [], "owner": {"reputation": 2172, "user_id": 4412925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7fa1503a3820659b27943c99d463a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel", "link": "https://stackoverflow.com/users/4412925/nabeel"}, "is_accepted": true, "score": 3, "last_activity_date": 1456333471, "last_edit_date": 1456333471, "creation_date": 1456331581, "answer_id": 35607759, "question_id": 35607313, "link": "https://stackoverflow.com/questions/35607313/using-loop-counter-as-part-of-a-variables-name-in-ruby/35607759#35607759", "title": "Using loop counter as part of a variable&#39;s name in Ruby", "body": "<p>As others have pointed out it is not possible to create local variables dynamically in Ruby, you could set up a binding as well if you're looking for another method of achieving this.</p>\n\n<p>With <strong>eval</strong></p>\n\n<pre><code>b = binding\n10.times do |i|\n  eval(\"var#{i} = 'foo'\", b)\nend\n\n&gt; eval(\"var1\", b)\n=&gt; \"foo\"\n\n&gt; eval(\"local_variables\", b)\n=&gt; [:var9, :var8, :var7, :var6, :var5, :var4, :var3, :var2, :var1, :var0, :b, :_]\n</code></pre>\n\n<p>Without <strong>eval</strong></p>\n\n<pre><code>b = binding\n10.times do |i|\n  b.local_variable_set(\"var#{i}\", 'foo')\nend\n\n&gt; b.local_variable_get('var1')\n=&gt; \"foo\"\n\n&gt; b.local_variables\n=&gt; [:var9, :var8, :var7, :var6, :var5, :var4, :var3, :var2, :var1, :var0, :b, :_]\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 3950314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f452817dbb732a622ea3609a357c18e?s=128&d=identicon&r=PG&f=1", "display_name": "John Nikolaou", "link": "https://stackoverflow.com/users/3950314/john-nikolaou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2849, "favorite_count": 0, "closed_date": 1456332255, "accepted_answer_id": 35607759, "answer_count": 2, "score": 1, "last_activity_date": 1456333471, "creation_date": 1456330565, "question_id": 35607313, "link": "https://stackoverflow.com/questions/35607313/using-loop-counter-as-part-of-a-variables-name-in-ruby", "closed_reason": "Duplicate", "title": "Using loop counter as part of a variable&#39;s name in Ruby", "body": "<p>I'm trying to generate a bunch of variables that will be operated on. Started with 2 variables, 4, 8,16 and its about time I put the variable generation in a loop. </p>\n\n<p>The variable is acting as a storage for the index of an array. </p>\n\n<p>So a thread wakes up, picks up a variable and says \"variable_0\" is the first index, and stores location 24 inside of it. </p>\n\n<p>This is usually done like so. This variable goes on and is used multiple times later on. </p>\n\n<p>variable_0 = get_index(threadid)</p>\n\n<p>Once I have 16 of such variables, its a pain and ugly to see that line repeated more than once. So I thought I'd put in a loop and tried it with 2 methods. </p>\n\n<p><strong>1. EVAL</strong> </p>\n\n<pre><code>for i in 0..15 do \n    eval(\"variable_#{i} = get_index(threadid)\")\nend\n</code></pre>\n\n<p>Does not work at all. </p>\n\n<p><strong>2. instance_variable_set</strong></p>\n\n<pre><code>for i in 0..15 do\n    index_name = \"variable_#{i}\"\n    index_val = get_index(threadid)\n    instance_variable_set(\"#{index_name}\", :index_val)\nend\n</code></pre>\n\n<p>This doesn't work either, since a later statement prints \"variable not found \" pretty much. </p>\n\n<p>Is there a good way to go about doing this? </p>\n\n<p>Due to restrictions later down the line, I cannot use an array for this, each variable has to be constructed as a single variable, so no arrays or anything like that would work</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "syntax"], "answers": [{"tags": [], "owner": {"reputation": 12694, "user_id": 1174001, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b27f05489e2cebe5948277c2ca561a93?s=128&d=identicon&r=PG", "display_name": "CDub", "link": "https://stackoverflow.com/users/1174001/cdub"}, "is_accepted": true, "score": 1, "last_activity_date": 1456330324, "creation_date": 1456330324, "answer_id": 35607218, "question_id": 35607173, "link": "https://stackoverflow.com/questions/35607173/ruby-when-to-use-or-for-opening/35607218#35607218", "title": "Ruby when to use &lt;% or &lt;%= for opening", "body": "<p>You'll use <code>&lt;%=</code> when you want the ERB to actually render code as a string in the browser, and <code>&lt;%</code> when you simply want to execute Ruby code (e.g. performing an iteration, setting a variable, etc.)</p>\n\n<p>In your examples:</p>\n\n<pre><code>&lt;% flash.each do |key, value| %&gt;\n&lt;%= content_tag :div, value, class: \"alert alert-#{key}\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><code>&lt;%</code> is used on <code>flash.each</code> to iterate over the <code>flash</code> variable, and then <code>&lt;%=</code> is used to actually render a <code>content_tag</code> containing the values set when piping in <code>key</code> and <code>value</code> into the block.</p>\n"}, {"tags": [], "owner": {"reputation": 178, "user_id": 2479976, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5344e45cbf0049d0405e7fe48bca84ec?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/2479976/scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1456330514, "creation_date": 1456330514, "answer_id": 35607292, "question_id": 35607173, "link": "https://stackoverflow.com/questions/35607173/ruby-when-to-use-or-for-opening/35607292#35607292", "title": "Ruby when to use &lt;% or &lt;%= for opening", "body": "<p>Are you using erb?</p>\n\n<p>&lt;%> will execute the ruby code inside the brackets</p>\n\n<p>&lt;%=> will actually render some code in your view</p>\n"}], "owner": {"reputation": 88, "user_id": 2506027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4572766056b652e4d0cb08565787ddac?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Smith", "link": "https://stackoverflow.com/users/2506027/ryan-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1456330528, "accepted_answer_id": 35607218, "answer_count": 2, "score": 0, "last_activity_date": 1456330514, "creation_date": 1456330184, "question_id": 35607173, "link": "https://stackoverflow.com/questions/35607173/ruby-when-to-use-or-for-opening", "closed_reason": "Duplicate", "title": "Ruby when to use &lt;% or &lt;%= for opening", "body": "<p>Sorry I'm very new to Ruby and this is probably a simple question and I am just searching wrong for it.\nFor example: </p>\n\n<pre><code>&lt;% flash.each do |key, value| %&gt;\n&lt;%= content_tag :div, value, class: \"alert alert-#{key}\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Why do we only use &lt;% %> at the beginning and end of the loop, but &lt;%= is used in the loop?</p>\n\n<p>Another example, no loop involved:</p>\n\n<pre><code>&lt;li&gt;&lt;%= link_to \"Contact Us\", new_contact_path %&gt;&lt;/li&gt;\n</code></pre>\n\n<p>Why am I using &lt;%= instead of &lt;% here?\nThanks for helping me with this newb question</p>\n"}, {"tags": ["mysql", "arrays", "ruby", "csv"], "answers": [{"comments": [{"owner": {"reputation": 308, "user_id": 5963316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86a5772242debdf0728675a5a690a373?s=128&d=identicon&r=PG&f=1", "display_name": "EVAL", "link": "https://stackoverflow.com/users/5963316/eval"}, "edited": false, "score": 0, "creation_date": 1456328608, "post_id": 35606366, "comment_id": 58897319, "body": "You did it; and just with one method too.  You absolute madman.  I probably should have been looking <a href=\"http://ruby-doc.org/core-2.2.2/Array.html#method-i-flatten\" rel=\"nofollow noreferrer\">here</a> instead of <a href=\"http://ruby-doc.org/core-2.2.2/Array.html#method-i-zip\" rel=\"nofollow noreferrer\">here</a>."}], "tags": [], "owner": {"reputation": 967, "user_id": 3721985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aa381fb6c99cb7b84fdb25e6f6aafb4?s=128&d=identicon&r=PG", "display_name": "Rohit Jangid", "link": "https://stackoverflow.com/users/3721985/rohit-jangid"}, "is_accepted": true, "score": 1, "last_activity_date": 1456328204, "creation_date": 1456328204, "answer_id": 35606366, "question_id": 35606153, "link": "https://stackoverflow.com/questions/35606153/creating-csv-using-multiple-ruby-queries-across-all-columns/35606366#35606366", "title": "Creating CSV Using Multiple Ruby Queries Across All Columns", "body": "<p>You might want to use following code</p>\n\n<pre><code>month.zip(report).each {|row| csv &lt;&lt; row.flatten}\n</code></pre>\n"}], "owner": {"reputation": 308, "user_id": 5963316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86a5772242debdf0728675a5a690a373?s=128&d=identicon&r=PG&f=1", "display_name": "EVAL", "link": "https://stackoverflow.com/users/5963316/eval"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 35606366, "answer_count": 1, "score": 0, "last_activity_date": 1456335297, "creation_date": 1456327681, "last_edit_date": 1495542224, "question_id": 35606153, "link": "https://stackoverflow.com/questions/35606153/creating-csv-using-multiple-ruby-queries-across-all-columns", "title": "Creating CSV Using Multiple Ruby Queries Across All Columns", "body": "<p>I am using Ruby to automate reporting from a remote MySQL database.  I am using multiple queries (and not joining them into one) as I eventually wish to split rows based off a given value in one or several columns.  It also gives me the option to work across different databases or even different hosts.</p>\n\n<p>I am using the <code>mysql2</code>, <code>watir</code> and <code>csv</code> Ruby gems.</p>\n\n<p>My code:</p>\n\n<pre><code>#!/usr/local/bin/ruby\nrequire \"mysql2\"\nrequire \"watir\"\nrequire \"csv\"\n\nputs \"Initializing Report\"\n\nMysql2::Client.default_query_options.merge!(:as =&gt; :array)\n\nmysql = Mysql2::Client.new(:host =&gt; \"1.2.3.4\", :username =&gt; \"user\", :pass =&gt; \"password\", :database =&gt; \"db\")\n\nputs \"Successfully accessed db\"\n\nmonth = mysql.query(\"SELECT DATE_FORMAT(db.table.start, '%m') FROM db.table WHERE db.start.group = 1;\")\n\nreport = mysql.query(\"SELECT db.table.name, db.table.company, db.table.type FROM db.table WHERE db.start.group = 1;\")\n\nCSV.open(\"Report.csv\", \"wb\") do |csv|\n  csv &lt;&lt; [\"Month\", \"Name\", \"Company\", \"Type\"]\n  month.zip(report).each {|row| csv &lt;&lt; row}\nend\n\nputs \"Results can be found in Report.csv\"\n</code></pre>\n\n<p>Now that <code>report</code> query is much bigger, spanning several dozen columns and several thousand rows made from almost a dozen <code>INNER JOIN</code>s and <code>WHERE</code> criteria.  It has been simplified for this question.</p>\n\n<p>The output the above code gives me, in a CSV file, is:</p>\n\n<pre><code>Month, Name, Company, Type\n[\"1\"], [\"Adam\", \"companyrecordlabel\", \"Ficticious\"]\n[\"1\"], [\"Alana\", \"beeUrself\", \"Made-up\"]\n  .                   .\n  .                   .\n  .                   .\n[\"12\"], [\"Zed\", \"Meds4U\", \"Fake\"]\n</code></pre>\n\n<p>and the output I desire:</p>\n\n<pre><code>Month, Name, Company, Type\n1, Adam, companyrecordlabel, Ficticious\n1, Alana, beeUrself, Made-up\n.             .\n.             .\n.             .\n12, Zed, Meds4U, Fake\n</code></pre>\n\n<p>I have been struggling with this for hours and I cannot seem to get the output I want.</p>\n\n<p>I have read CSV files, outputted multiple (and multi-dimensional) arrays to a .txt file and written a single (large) query to a CSV file without the brackets or quotation marks; but I cannot seem to achieve this.</p>\n\n<p>Thank you for any and all help in advance.</p>\n\n<p>Edit: I was using help from <a href=\"https://stackoverflow.com/questions/35588482/adding-columns-sql-queries-to-a-csv-file-in-ruby\">this</a> question.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "google-api", "google-shopping"], "owner": {"reputation": 41, "user_id": 5975203, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--d5zCo5jsT0/AAAAAAAAAAI/AAAAAAAABOs/5GHak4QH5YQ/photo.jpg?sz=128", "display_name": "Eduardo Carneiro", "link": "https://stackoverflow.com/users/5975203/eduardo-carneiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1456329592, "creation_date": 1456326073, "last_edit_date": 1456327278, "question_id": 35605635, "link": "https://stackoverflow.com/questions/35605635/google-shopping-api-ruby", "title": "Google Shopping API - Ruby", "body": "<p>I'm doing an integration with Google Api in Ruby.</p>\n\n<p>I'm using google-api-client gem, but I have some problems with the authorization request.</p>\n\n<p>My Code:</p>\n\n<pre><code>client_secrets = Google::APIClient::ClientSecrets.load('client_secret_xxxx-.apps.googleusercontent.com.json')\n\nauth_client = client_secrets.to_authorization\n\nauth_client.update!(:scope =&gt; 'https://www.googleapis.com/auth/content')  #its possible pass a url to redirect and we can fetch do token\n\nauth_uri = auth_client.authorization_uri.to_s\n\np auth_uri\n</code></pre>\n\n<p>This code returns me the url to the authorization to google shopping api.</p>\n\n<p>After I give permissions, I copy the token for here:</p>\n\n<pre><code>token = 'token'\nmerchant_id = 'xxx'\nlist_products_url = \"https://www.googleapis.com/content/v2/#{merchant_id}/products?key=#{token}\"\nresponse = HTTParty.get(list_products_url)\n</code></pre>\n\n<p>This returns me a Error message like this:</p>\n\n<pre><code>#&lt;HTTParty::Response:0x7fde5c37b8f0 parsed_response={\"error\"=&gt;{\"errors\"=&gt;[{\"domain\"=&gt;\"global\", \"reason\"=&gt;\"required\", \"message\"=&gt;\"Login Required\", \"locationType\"=&gt;\"header\", \"location\"=&gt;\"Authorization\"}], \"code\"=&gt;401, \"message\"=&gt;\"Login Required\"}}, @response=#&lt;Net::HTTPUnauthorized 401 Unauthorized readbody=true&gt;, @headers={\"vary\"=&gt;[\"Origin\", \"X-Origin\"], \"www-authenticate\"=&gt;[\"Bearer realm=\\\"https://accounts.google.com/\\\"\"], \"content-type\"=&gt;[\"application/json; charset=UTF-8\"], \"date\"=&gt;[\"Wed, 24 Feb 2016 14:58:17 GMT\"], \"expires\"=&gt;[\"Wed, 24 Feb 2016 14:58:17 GMT\"], \"cache-control\"=&gt;[\"private, max-age=0\"], \"x-content-type-options\"=&gt;[\"nosniff\"], \"x-frame-options\"=&gt;[\"SAMEORIGIN\"], \"x-xss-protection\"=&gt;[\"1; mode=block\"], \"server\"=&gt;[\"GSE\"], \"alternate-protocol\"=&gt;[\"443:quic,p=1\"], \"alt-svc\"=&gt;[\"quic=\\\":443\\\"; ma=2592000; v=\\\"30,29,28,27,26,25\\\"\"], \"connection\"=&gt;[\"close\"], \"transfer-encoding\"=&gt;[\"chunked\"]}&gt;\n</code></pre>\n\n<p>I do not know what I'm doing wrong..</p>\n\n<p>I trying to implement this simple example..</p>\n\n<p><a href=\"https://developers.google.com/shopping-content/v2/reference/v2/products/list#try-it\" rel=\"nofollow\">https://developers.google.com/shopping-content/v2/reference/v2/products/list#try-it</a></p>\n\n<p>Best Regards</p>\n"}, {"tags": ["ruby", "csv", "encoding"], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1456336098, "post_id": 35607889, "comment_id": 58903017, "body": "Another thing to be aware of is that if any fields contain a newline (which is valid in a quoted field), this will fail."}, {"owner": {"reputation": 53, "user_id": 5075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6373154a7a7ce5e547077d4237d6879?s=128&d=identicon&r=PG", "display_name": "Andres M", "link": "https://stackoverflow.com/users/5075282/andres-m"}, "edited": false, "score": 0, "creation_date": 1457476217, "post_id": 35607889, "comment_id": 59421963, "body": "This solution works. I find Jordan&#39;s one more complete. Thanks."}], "tags": [], "owner": {"reputation": 31, "user_id": 5969211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ea7e18cebc3360b74d053a9690c3dee?s=128&d=identicon&r=PG&f=1", "display_name": "KMoschcau", "link": "https://stackoverflow.com/users/5969211/kmoschcau"}, "is_accepted": false, "score": 1, "last_activity_date": 1456333017, "last_edit_date": 1456333017, "creation_date": 1456331922, "answer_id": 35607889, "question_id": 35605495, "link": "https://stackoverflow.com/questions/35605495/how-to-use-replace-invalid-and-undef-args-for-encoding-using-csv-read/35607889#35607889", "title": "How to use :replace, :invalid and :undef args for encoding using CSV.read?", "body": "<p>If you want to use the replace behavior of String#encode, you will either have to encode the whole file content with it or do it line by line. <strong>You will lose information with this.</strong>  </p>\n\n<p>This is one way of doing it though:</p>\n\n<pre><code>file = File.open('path/to/file.csv')\nfile.each do |line|\n  # keep in mind that the first parameter here is the destination encoding,\n  # the second is the source encoding\n  sanitized_line = line.encode('UTF-8', 'windows-1252', invalid: :replace, undef: :replace, replace: '')\n  fields_array = CSV.parse_line(sanitized_line)\n  # do whatever you want with the fields you extracted\nend\n</code></pre>\n\n<p>If your conversion from one encoding to another is pretty much guaranteed to not loose information (iso-8859-1 to utf-8 for example) I would really recommend to simply convert the file on reading.  </p>\n\n<p>Another thing to keep in mind is, that ruby does not try to figure out the encoding of a file you are reading on it's own. If you omit the parameter it only uses the default encoding for it's external and internal encoding. So you have to specify the encoding the file is in yourself. Ruby has no really reliable way of doing this, so in my case I ended up doing this (on a Ubuntu system):</p>\n\n<pre><code>encoding = `file --mime-encoding #{path_to_file} | awk '{print $2}'`.strip\narr_of_arrs = CSV.read(path_to_file, encoding: \"#{encoding}:utf-8\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 5075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6373154a7a7ce5e547077d4237d6879?s=128&d=identicon&r=PG", "display_name": "Andres M", "link": "https://stackoverflow.com/users/5075282/andres-m"}, "edited": false, "score": 0, "creation_date": 1457476137, "post_id": 35609386, "comment_id": 59421937, "body": "KMoschcau solution also works. I opt for this one becouse I find more complete to define a converter as a proc."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 6, "last_activity_date": 1456336445, "last_edit_date": 1456336445, "creation_date": 1456336044, "answer_id": 35609386, "question_id": 35605495, "link": "https://stackoverflow.com/questions/35605495/how-to-use-replace-invalid-and-undef-args-for-encoding-using-csv-read/35609386#35609386", "title": "How to use :replace, :invalid and :undef args for encoding using CSV.read?", "body": "<p>There is, indeed, a way. The trick is to define a custom converter that does the conversion you want using <code>String#encode</code>. Converters are run before CSV tries to do its automatic conversion to UTF-8. We pass the custom converter to <code>CSV.read</code> as the <code>:converters</code> option, along with the original <code>:encoding</code>:</p>\n\n<pre><code>UTF8_CONVERTER = -&gt;(field) { field.encode('utf-8', invalid: :replace, undef: :replace, replace: \"\") }\n\nCSV.read('foo.csv', encoding: 'windows-1252', converters: UTF8_CONVERTER)\n</code></pre>\n\n<p>Since there aren't any characters in Windows-1252 that aren't also in UTF-8, I'll demonstrate the other way around. Suppose you have this UTF-8 CSV file:</p>\n\n<pre class=\"lang-csv prettyprint-override\"><code>foo,bar\nyes\ud83d\udc4d,no\ud83d\udca9\n</code></pre>\n\n<p>And suppose I want to convert it to ASCII-8BIT (because reasons?). This gives me an error:</p>\n\n<pre><code>CSV.read('emoji.csv', encoding: 'utf-8:ascii-8bit')\n# =&gt; Encoding::UndefinedConversionError: U+1F44D from UTF-8 to ASCII-8BIT\n</code></pre>\n\n<p>But if I define a custom converter that replaces those undefined characters, it works perfectly:</p>\n\n<pre><code>ASCII_CONVERTER = -&gt;(field) { field.encode('ascii-8bit', replace: \"@\") }\n\nCSV.read('emoji.csv', encoding: 'utf-8', converters: ASCII_CONVERTER)\n# =&gt; [ [ \"foo\",  \"bar\"   ],\n#      [ \"yes@\", \"no@\"] ]\n</code></pre>\n\n<p>(Note that <code>encoding: 'utf-8'</code> isn't strictly necessary here, since UTF-8 is the default, but it will be necessary if your file has a different encoding.)</p>\n"}], "owner": {"reputation": 53, "user_id": 5075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6373154a7a7ce5e547077d4237d6879?s=128&d=identicon&r=PG", "display_name": "Andres M", "link": "https://stackoverflow.com/users/5075282/andres-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2421, "favorite_count": 1, "accepted_answer_id": 35609386, "answer_count": 2, "score": 5, "last_activity_date": 1456336445, "creation_date": 1456325701, "last_edit_date": 1456327613, "question_id": 35605495, "link": "https://stackoverflow.com/questions/35605495/how-to-use-replace-invalid-and-undef-args-for-encoding-using-csv-read", "title": "How to use :replace, :invalid and :undef args for encoding using CSV.read?", "body": "<p>Since ruby 1.9, CSV uses a parser that can perform encoding, if you use methods like:\n<code>::foreach, ::open, ::read, and ::readlines</code>.</p>\n\n<p>For example: <code>CSV.read('path/to/file', encoding: \"windows-1252:UTF-8\")</code> tries to read a file in windows-1252 and returns an array with utf-8 encoded strings.</p>\n\n<p>If the encode conversion between charsets has undefined characters it gives an <code>Encoding::UndefinedConversionError</code>.</p>\n\n<p>The String.encode method has some nice args to deal with this undefined characters:</p>\n\n<p><code>str = str.encode('UTF-8', invalid: :replace, undef: :replace, replace: \"\" )</code></p>\n\n<p>Is there a way to use this kind of replace rules for undefined conversions between charsets with CSV parser?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "jruby"], "comments": [{"owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1456325235, "post_id": 35605211, "comment_id": 58895052, "body": "Missing <code>user_id</code> in <code>posts</code>?"}, {"owner": {"reputation": 19, "user_id": 5975050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3201d0f7b9be3bc1e919963e8791a0d?s=128&d=identicon&r=PG", "display_name": "Jou", "link": "https://stackoverflow.com/users/5975050/jou"}, "reply_to_user": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1456325404, "post_id": 35605211, "comment_id": 58895195, "body": "column user_id is created in posts table... it is just missing foreign key"}, {"owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1456325497, "post_id": 35605211, "comment_id": 58895269, "body": "btw, column <code>id</code> of <code>users</code> and <code>posts</code> exists?"}, {"owner": {"reputation": 19, "user_id": 5975050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3201d0f7b9be3bc1e919963e8791a0d?s=128&d=identicon&r=PG", "display_name": "Jou", "link": "https://stackoverflow.com/users/5975050/jou"}, "edited": false, "score": 0, "creation_date": 1456326198, "post_id": 35605211, "comment_id": 58895823, "body": "yes db support it, MySQL 5.5"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1456330025, "post_id": 35605211, "comment_id": 58898445, "body": "Do you use the <code>MyISAM</code> or <code>InnoDB</code> database engine? What do you mean by <i>missing foreign key</i>? Is there not <code>FOREIGN KEY CONSTRAINT</code> on that table in the database or do you only miss it in the <code>schema.rb</code>?"}, {"owner": {"reputation": 19, "user_id": 5975050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3201d0f7b9be3bc1e919963e8791a0d?s=128&d=identicon&r=PG", "display_name": "Jou", "link": "https://stackoverflow.com/users/5975050/jou"}, "edited": false, "score": 1, "creation_date": 1456332084, "post_id": 35605211, "comment_id": 58900084, "body": "there is no foreign key constraint in schema.rb"}], "owner": {"reputation": 19, "user_id": 5975050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3201d0f7b9be3bc1e919963e8791a0d?s=128&d=identicon&r=PG", "display_name": "Jou", "link": "https://stackoverflow.com/users/5975050/jou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1507150281, "creation_date": 1456325031, "last_edit_date": 1507150281, "question_id": 35605211, "link": "https://stackoverflow.com/questions/35605211/rails-4-foreign-key-is-not-working-with-belongs-to", "title": "Rails 4 foreign_key is not working with belongs_to", "body": "<p>I am using rails 4.2.4 and I want to add a foreign key.</p>\n\n<p>User:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n   has_many :posts\n   validates :name, presence: true\nend\n</code></pre>\n\n<p>Post:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n   belongs_to :user\n   validates :user, presence: true\nend\n</code></pre>\n\n<p>Migration:</p>\n\n<pre><code>class AddForeignKeysToTables &lt; ActiveRecord::Migration\n   def change\n      create_table :users do |t|\n         t.string   :name\n      end\n\n      create_table :posts do |t|\n         t.belongs_to :user\n      end\n\n     add_foreign_key :posts, :users\n   end\nend\n</code></pre>\n\n<p>Migration report:</p>\n\n<pre><code> == 20160224131802 AddForeignKeysToRfmAnalyticsTables: migrating ===============\n    -- create_table(:users)\n       -&gt; 0.0150s\n       -&gt; 0 rows\n    -- create_table(:posts)\n       -&gt; 0.0150s\n       -&gt; 0 rows\n    -- add_foreign_key(:posts, :users)\n       -&gt; 0.0000s\n    == 20160224131802 AddForeignKeysToTables: migrated (0.0300s) ======\n</code></pre>\n\n<p>And adding foreign_key in MySQL database is not working without errors. And not one foreign key is created. Do you have any ideas how to create foreign key in this example?</p>\n\n<p>But I want to keep belongs_to in migration, because this is like from old migration, and add_foreign_key has to be a new one migration.</p>\n\n<p>Maybe related gems:</p>\n\n<pre><code>jruby_version = '1.7.22'\n\ngem 'rails', '4.2.4'\ngem 'activerecord-jdbcmysql-adapter' \n</code></pre>\n\n<p>Also script from schema.rb:</p>\n\n<pre><code>create_table \"posts\", force: :cascade do |t|\n   t.integer \"user_id\", limit: 11\nend\n\ncreate_table \"users\", force: :cascade do |t|\n   t.string \"name\", limit: 255\nend\n</code></pre>\n\n<p>And also if I am using gems like 'foreigner' or 'foreign_keys', then foreign keys are created, but these gem seems to be incompatible.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4932805"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1456519930, "post_id": 35604932, "comment_id": 59003206, "body": "Obviously--the error."}], "answers": [{"tags": [], "owner": {"reputation": 18774, "user_id": 1763929, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jLvbN.jpg?s=128&g=1", "display_name": "Vucko", "link": "https://stackoverflow.com/users/1763929/vucko"}, "is_accepted": true, "score": 2, "last_activity_date": 1456324858, "last_edit_date": 1456324858, "creation_date": 1456324537, "answer_id": 35605026, "question_id": 35604932, "link": "https://stackoverflow.com/questions/35604932/routing-error-ruby-on-rails-voting-system/35605026#35605026", "title": "Routing Error Ruby on Rails -- Voting system", "body": "<p>If you use <code>rake routes | grep like</code> (to fatch that route), you'll get:</p>\n\n<pre><code>like_article_comment PUT    /articles/:article_id/comments/:id/like(.:format)  comments#upvote\n</code></pre>\n\n<p>So you're missing the first parametar - <code>:article_id</code> in your link. Should be:</p>\n\n<pre><code>= link_to like_article_comment_path(@article, @comment), method: :put do\n  = @comment.get_upvotes.size\n</code></pre>\n\n<p>Also add the <code>@article</code> logic in your <code>upvote</code> method.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4932805"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 35605026, "answer_count": 1, "score": -1, "last_activity_date": 1456324858, "creation_date": 1456324263, "question_id": 35604932, "link": "https://stackoverflow.com/questions/35604932/routing-error-ruby-on-rails-voting-system", "title": "Routing Error Ruby on Rails -- Voting system", "body": "<p>I'm implementing a voting system to my blog's comments, using the <code>acts_as_votable</code> gem.</p>\n\n<p>However, I'm getting a routing error: <code>no route matches. missing required keys: [:id]</code></p>\n\n<pre><code>  #routes.rb\n  resources :articles do\n     resources :comments do\n        member do\n            put \"like\", to: \"comments#upvote\"\n        end\n    end\n  end\n\n# comments controller\ndef upvote\n    @comment.upvote\n    redirect_to :back\nend\n\n# comments/show.html.haml\n= link_to like_article_comment_path(@comment), method: :put do\n   = @comment.get_upvotes.size\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 299, "user_id": 4478755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v9tHd.jpg?s=128&g=1", "display_name": "Sander de Jong", "link": "https://stackoverflow.com/users/4478755/sander-de-jong"}, "is_accepted": false, "score": 0, "last_activity_date": 1456324276, "last_edit_date": 1456324276, "creation_date": 1456324235, "answer_id": 35604920, "question_id": 35604797, "link": "https://stackoverflow.com/questions/35604797/is-there-a-better-way-to-map-an-integer-to-a-range-of-numbers/35604920#35604920", "title": "Is there a better way to map an integer to a range of numbers?", "body": "<p>The result of the method should be:</p>\n\n<pre><code>(i - 1) % 7 + 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1456331004, "post_id": 35607283, "comment_id": 58899199, "body": "Ruby uses <code>%</code> to <a href=\"https://github.com/ruby/ruby/blob/ruby_2_3/array.c#L2264-L2268\" rel=\"nofollow noreferrer\">calculate the rotation</a>"}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1456331174, "post_id": 35607283, "comment_id": 58899354, "body": "@Stefan  Thanks for the info. That must be it - as my benchmark test did not vary much with varying values of <code>i</code>"}], "tags": [], "owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "is_accepted": false, "score": 2, "last_activity_date": 1456330491, "creation_date": 1456330491, "answer_id": 35607283, "question_id": 35604797, "link": "https://stackoverflow.com/questions/35604797/is-there-a-better-way-to-map-an-integer-to-a-range-of-numbers/35607283#35607283", "title": "Is there a better way to map an integer to a range of numbers?", "body": "<p>Here is one more way to do this:</p>\n\n<pre><code>(1..7).to_a.rotate(i).last\n</code></pre>\n\n<p>Sample program given below:</p>\n\n<pre><code>def int_map i\n    [1,2,3,4,5,6,7].rotate(i).last\nend\n\nint_map(1)\n#=&gt; 1\nint_map(7)\n#=&gt; 7\nint_map(8)\n#=&gt; 1\nint_map(14)\n#=&gt; 7\nint_map(15)\n#=&gt; 1\n</code></pre>\n\n<p>PS: May be bit inefficient as the value of <code>i</code> grows larger, but my tests did not indicate that.  May be Ruby implementation is smart and handles multiple rotations in efficient manner.</p>\n"}, {"tags": [], "owner": {"reputation": 10280, "user_id": 874283, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/8bbcdae54d8cd930405e57162e1522d3?s=128&d=identicon&r=PG&f=1", "display_name": "Zack Xu", "link": "https://stackoverflow.com/users/874283/zack-xu"}, "is_accepted": false, "score": 0, "last_activity_date": 1456333780, "last_edit_date": 1456333780, "creation_date": 1456331894, "answer_id": 35607873, "question_id": 35604797, "link": "https://stackoverflow.com/questions/35604797/is-there-a-better-way-to-map-an-integer-to-a-range-of-numbers/35607873#35607873", "title": "Is there a better way to map an integer to a range of numbers?", "body": "<p>Here's another solution, without using modulo.  The downside is that all this math makes confusing code.</p>\n\n<pre><code>i - (i - 1) / 7 * 7\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10280, "user_id": 874283, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/8bbcdae54d8cd930405e57162e1522d3?s=128&d=identicon&r=PG&f=1", "display_name": "Zack Xu", "link": "https://stackoverflow.com/users/874283/zack-xu"}, "is_accepted": false, "score": 0, "last_activity_date": 1456336309, "last_edit_date": 1456336309, "creation_date": 1456332710, "answer_id": 35608213, "question_id": 35604797, "link": "https://stackoverflow.com/questions/35604797/is-there-a-better-way-to-map-an-integer-to-a-range-of-numbers/35608213#35608213", "title": "Is there a better way to map an integer to a range of numbers?", "body": "<p>Her's another solution.  Quite easy to understand.</p>\n\n<pre><code>[7,1,2,3,4,5,6][i % 7]\n</code></pre>\n\n<p>Without specifying the array in full, you can do</p>\n\n<pre><code>(1..7).to_a.rotate(-1)[i % 7]\n</code></pre>\n"}], "owner": {"reputation": 10280, "user_id": 874283, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/8bbcdae54d8cd930405e57162e1522d3?s=128&d=identicon&r=PG&f=1", "display_name": "Zack Xu", "link": "https://stackoverflow.com/users/874283/zack-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1456336309, "creation_date": 1456323935, "last_edit_date": 1456324698, "question_id": 35604797, "link": "https://stackoverflow.com/questions/35604797/is-there-a-better-way-to-map-an-integer-to-a-range-of-numbers", "title": "Is there a better way to map an integer to a range of numbers?", "body": "<p>I'm trying to map integers to numbers within range <code>(1..7)</code>. <code>1</code> through <code>7</code> would be mapped to themselves, <code>8</code> to <code>1</code>, <code>14</code> to <code>7</code>, and so on.</p>\n\n<p>The obvious candidate to do this is the modulo method <code>%</code>. However, <code>7 % 7</code> gives <code>0</code>, which I do not want.</p>\n\n<p>One can write the following method:</p>\n\n<pre><code>def int_map i\n  (x = i % 7) == 0 ? 7 : x\nend\n</code></pre>\n\n<p>I feel that there should be a better, more succinct way to do this. Is there? And how?</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "activerecord", "sqlanywhere"], "comments": [{"owner": {"reputation": 463, "user_id": 2855197, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f7039b21437ebb0dd4139d186d14b168?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/2855197/dave"}, "edited": false, "score": 0, "creation_date": 1468263119, "post_id": 35604725, "comment_id": 64044710, "body": "Did you ever get past this Allen?"}, {"owner": {"reputation": 55, "user_id": 4903337, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf52f16cf6d51847ad2580efcf87896b?s=128&d=identicon&r=PG&f=1", "display_name": "Allen", "link": "https://stackoverflow.com/users/4903337/allen"}, "reply_to_user": {"reputation": 463, "user_id": 2855197, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f7039b21437ebb0dd4139d186d14b168?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/2855197/dave"}, "edited": false, "score": 0, "creation_date": 1468352180, "post_id": 35604725, "comment_id": 64089156, "body": "Unfortunately not! It seems there&#39;s not much support for SQL Anywhere &amp; Rails, despite there being a gem for SQL Anywhere. Another member of my team is working on this particular issue now (extracting data from legacy software using SQL Anywhere) and he is going at it in a PHP environment."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 1872727, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5010d337c197f7216ccfc838b78f6a7f?s=128&d=identicon&r=PG", "display_name": "MarcosCunhaLima", "link": "https://stackoverflow.com/users/1872727/marcoscunhalima"}, "is_accepted": false, "score": 1, "last_activity_date": 1483381387, "creation_date": 1483381387, "answer_id": 41431608, "question_id": 35604725, "link": "https://stackoverflow.com/questions/35604725/how-to-query-a-remote-sqlanywhere16-db-using-rails/41431608#41431608", "title": "How to query a remote SQLAnywhere16 db using Rails?", "body": "<p>I use SQLAnywhere for a production server and it works fine using the very same gem you're using. I use a Mac for development and my database is running in Windows (or Linux).\nIn order to get rid of this error, try the command (on your Mac):</p>\n\n<pre><code># adjust SQLAnywhere to your version -&gt; 16\nsource /Applications/SQLAnywhere12/System/bin64/sa_config.sh\n</code></pre>\n\n<p>I'm using Rails 4 and SQLAnywhere 12 (but tested with 16 and it works too).</p>\n\n<p>After that, try to load console (rails c) and do some tests there.</p>\n"}], "owner": {"reputation": 55, "user_id": 4903337, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf52f16cf6d51847ad2580efcf87896b?s=128&d=identicon&r=PG&f=1", "display_name": "Allen", "link": "https://stackoverflow.com/users/4903337/allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483381387, "creation_date": 1456323760, "last_edit_date": 1456324632, "question_id": 35604725, "link": "https://stackoverflow.com/questions/35604725/how-to-query-a-remote-sqlanywhere16-db-using-rails", "title": "How to query a remote SQLAnywhere16 db using Rails?", "body": "<p>I am trying to set up a Rails app to query a remotely hosted SQLAnywhere 16 db and to display some query information as HTML. I'm using current versions of Ruby and Rails on Mac El Capitan. The remote server is running Windows. The server is located in my building and I am on the same LAN, so if there's a simpler solution that involves accessing the box itself physically I'm open to that. </p>\n\n<p>On my Windows machine I am able to connect to the server and do queries on the db using a SQL client. </p>\n\n<p>I have <code>sqlanywhere</code> and <code>activerecord-sqlanywhere-adapter</code> gems installed. I also have the SQL Anywhere 16 client installed on my (Mac) machine. The remote db set up in my <code>database.yml</code> file as another db: </p>\n\n<pre><code>my_external_database:\n  adapter: sqlanywhere\n  encoding: utf-8\n  username: (username)\n  password: (password)\n  server: (name of server)\n  database: (db name)\n  host: (IP of server)\n</code></pre>\n\n<p>I'm calling it like so: </p>\n\n<pre><code>class MyExternalModel &lt; ActiveRecord::Base\n    establish_connection(:my_external_database)\n    self.table_name = '&lt;a particular table in the db&gt;'\n    self.primary_key = 'primarykey'\nend\n</code></pre>\n\n<p>When I go into the rails console and do <code>MyExternalModel.first</code> to test the connection, I get: </p>\n\n<p><code>LoadError: Could not load SQLAnywhere DBCAPI library</code></p>\n\n<p>After doing some googling, this seems to be a problem with configuring SQLAnywhere. However, I believe I configured it properly (in bash using bin64 config), like so: </p>\n\n<pre><code>. /Applications/SQLAnywhere16/samples/sample_config64.sh\nEnter destination directory for copy of the samples [/Users/(user)/sa16_samples]: \nCopying samples...\nDone\n\nSetting up data sources... \n\nSQL Anywhere Data Source Utility Version 16.0.0.2041\nConfiguration \"SQL Anywhere 16 Demo\" written to file /Users/(user)/.odbc.ini\nSQL Anywhere Data Source Utility Version 16.0.0.2041\nConfiguration \"SQL Anywhere 16 CustDB\" written to file /Users/(user)/.odbc.ini\nDone\n\nSetting up sample_env script... \nDone\n</code></pre>\n\n<p>This is as far as I'm able to get. Any recommendations are greatly appreciated! </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456324350, "post_id": 35604577, "comment_id": 58894362, "body": "Please take a look at your JS console. It surely has some errors : <code>var xhttp =ew XMLHttpRequest();</code>"}, {"owner": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456324721, "post_id": 35604577, "comment_id": 58894656, "body": "Is there any specific reason you tagged this post with <code>jQuery</code>? You don&#39;t seem to be using it at all in your example code."}, {"owner": {"reputation": 409, "user_id": 5617584, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/888909587882951/picture?type=large", "display_name": "H\u01b0ng H&#237;p", "link": "https://stackoverflow.com/users/5617584/h%c6%b0ng-h%c3%adp"}, "reply_to_user": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456324932, "post_id": 35604577, "comment_id": 58894813, "body": "I&#39;m sorry.I fixed it"}, {"owner": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456324962, "post_id": 35604577, "comment_id": 58894845, "body": "Are there any additional javascript errors on your page? Are you certain that your <code>loadDoc</code> function is being called?"}, {"owner": {"reputation": 409, "user_id": 5617584, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/888909587882951/picture?type=large", "display_name": "H\u01b0ng H&#237;p", "link": "https://stackoverflow.com/users/5617584/h%c6%b0ng-h%c3%adp"}, "reply_to_user": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456325111, "post_id": 35604577, "comment_id": 58894965, "body": "I dont know how to see the javascript errors.Can you tell me what should I do ?"}, {"owner": {"reputation": 409, "user_id": 5617584, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/888909587882951/picture?type=large", "display_name": "H\u01b0ng H&#237;p", "link": "https://stackoverflow.com/users/5617584/h%c6%b0ng-h%c3%adp"}, "reply_to_user": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456325246, "post_id": 35604577, "comment_id": 58895060, "body": "So how can I fix the JS errors ?"}, {"owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1456325387, "post_id": 35604577, "comment_id": 58895182, "body": "@H\u01b0ngH&#237;p: Inspect by your browser, then check the network console!"}, {"owner": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456325542, "post_id": 35604577, "comment_id": 58895314, "body": "@H\u01b0ngH&#237;p - (in chrome) On windows you can hit <code>F12</code>, on Mac it&#39;s <code>Cmd+Alt+i</code>. Then go to the console tab."}, {"owner": {"reputation": 409, "user_id": 5617584, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/888909587882951/picture?type=large", "display_name": "H\u01b0ng H&#237;p", "link": "https://stackoverflow.com/users/5617584/h%c6%b0ng-h%c3%adp"}, "reply_to_user": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1456325553, "post_id": 35604577, "comment_id": 58895320, "body": "@HieuPham Anh c&#243; th\u1ec3 ch\u1ec9 em c\u1ee5 th\u1ec3 \u0111\u01b0\u1ee3c kh&#244;ng ?"}, {"owner": {"reputation": 409, "user_id": 5617584, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/888909587882951/picture?type=large", "display_name": "H\u01b0ng H&#237;p", "link": "https://stackoverflow.com/users/5617584/h%c6%b0ng-h%c3%adp"}, "reply_to_user": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456325681, "post_id": 35604577, "comment_id": 58895414, "body": "@Lix It shows that : GET <a href=\"http://localhost:3000/demo.txt\" rel=\"nofollow noreferrer\">localhost:3000/demo.txt</a> 404 Not Found"}, {"owner": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 1, "creation_date": 1456325769, "post_id": 35604577, "comment_id": 58895477, "body": "@H\u01b0ngH&#237;p - Great! Now we are getting closer to the problem! We now know that the AJAX request is being made but the server can not find your <code>demo.txt</code> file - that is why the server is returning a <code>404</code> error. The next question is: where did you place that file? Is it in the <code>public</code> folder of your rails application?"}, {"owner": {"reputation": 409, "user_id": 5617584, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/888909587882951/picture?type=large", "display_name": "H\u01b0ng H&#237;p", "link": "https://stackoverflow.com/users/5617584/h%c6%b0ng-h%c3%adp"}, "reply_to_user": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456325858, "post_id": 35604577, "comment_id": 58895549, "body": "@Lix The file demo.txt in Vendor"}, {"owner": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456325901, "post_id": 35604577, "comment_id": 58895582, "body": "@H\u01b0ngH&#237;p - try placing it into the <code>public</code> folder in the root of your rails project."}, {"owner": {"reputation": 409, "user_id": 5617584, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/888909587882951/picture?type=large", "display_name": "H\u01b0ng H&#237;p", "link": "https://stackoverflow.com/users/5617584/h%c6%b0ng-h%c3%adp"}, "reply_to_user": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456326001, "post_id": 35604577, "comment_id": 58895653, "body": "@Lix Thank you! It worked.I placed it to the public folder"}, {"owner": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456326075, "post_id": 35604577, "comment_id": 58895712, "body": "@H\u01b0ngH&#237;p - Great! Happy that it worked in the end! Take a look at the answer below - it actually does mention that public folder. You might want to recognise that answer as the most helpful."}, {"owner": {"reputation": 409, "user_id": 5617584, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/888909587882951/picture?type=large", "display_name": "H\u01b0ng H&#237;p", "link": "https://stackoverflow.com/users/5617584/h%c6%b0ng-h%c3%adp"}, "reply_to_user": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456326341, "post_id": 35604577, "comment_id": 58895926, "body": "@Lix Sorry I want to ask more question.In the Index file,I write a link to new action,I use remote: true hash.It worked but in the console shows that 304 Not Modified.So is it wrong ?"}, {"owner": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456327049, "post_id": 35604577, "comment_id": 58896217, "body": "@H\u01b0ngH&#237;p - you might want to open a new post for that question since your original question has been answered already."}], "answers": [{"comments": [{"owner": {"reputation": 45041, "user_id": 558021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24664dac7e1f5ef8bf7931d416f876cd?s=128&d=identicon&r=PG", "display_name": "Lix", "link": "https://stackoverflow.com/users/558021/lix"}, "edited": false, "score": 0, "creation_date": 1456324532, "post_id": 35604988, "comment_id": 58894510, "body": "Without the URL protocol it would be resolved as a relative path and it would simply look for the file (as you said) in the public folder. This <i>should</i> work - I believe the issue is actually JS error and the request is never actually being made..."}, {"owner": {"reputation": 409, "user_id": 5617584, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/888909587882951/picture?type=large", "display_name": "H\u01b0ng H&#237;p", "link": "https://stackoverflow.com/users/5617584/h%c6%b0ng-h%c3%adp"}, "edited": false, "score": 0, "creation_date": 1456324810, "post_id": 35604988, "comment_id": 58894731, "body": "I changed my code xhttp.open(&quot;GET&quot;,&quot;localhost:3000/demo.txt&quot;, true);.But it still doesn&#39;t show anything"}], "tags": [], "owner": {"reputation": 3160, "user_id": 1266795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7855792dbc5f3b4c365344314e2b1ad6?s=128&d=identicon&r=PG", "display_name": "AndyV", "link": "https://stackoverflow.com/users/1266795/andyv"}, "is_accepted": false, "score": 1, "last_activity_date": 1456324414, "creation_date": 1456324414, "answer_id": 35604988, "question_id": 35604577, "link": "https://stackoverflow.com/questions/35604577/why-i-cant-use-ajax-in-rails/35604988#35604988", "title": "Why I cant use Ajax in Rails?", "body": "<p>The second parameter of the xhttp.open(...) call should be a URL, not simple a file name.  If you are running the Rails application with \"rails s\" then your url might look something like \"<a href=\"http://localhost:3000/demo.txt\" rel=\"nofollow\">http://localhost:3000/demo.txt</a>\" if the file demo.txt is in your public folder.  Without a URL in that second parameter, I suspect that the request is never finding your rails application.</p>\n\n<p>You might also want to dig into jquery (since you tagged it) to understand how to use that library to issue the request.  The interface is much simpler than the low-level js.</p>\n"}], "owner": {"reputation": 409, "user_id": 5617584, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/888909587882951/picture?type=large", "display_name": "H\u01b0ng H&#237;p", "link": "https://stackoverflow.com/users/5617584/h%c6%b0ng-h%c3%adp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456325028, "creation_date": 1456323380, "last_edit_date": 1456325028, "question_id": 35604577, "link": "https://stackoverflow.com/questions/35604577/why-i-cant-use-ajax-in-rails", "title": "Why I cant use Ajax in Rails?", "body": "<p>I started learning Rails 3 months ago.And now I'm trying to add Ajax in my Rails app.</p>\n\n<p>So it have some problems.</p>\n\n<p>In my Index.html.erb file:</p>\n\n<pre><code>&lt;script&gt;\n    function loadDoc() {\n      var xhttp = new XMLHttpRequest();\n      xhttp.onreadystatechange = function() {\n        if (xhttp.readyState == 4 &amp;&amp; xhttp.status == 200) {\n          document.getElementById(\"demo\").innerHTML = xhttp.responseText;\n        }\n      };\n      xhttp.open(\"GET\",\"demo.txt\", true);\n      xhttp.send();\n    }\n&lt;/script&gt;\n\n&lt;button type=\"button\" onclick=\"loadDoc()\"&gt;click&lt;/button&gt;\n\n&lt;p id=\"demo\"&gt;&lt;/p&gt;\n</code></pre>\n\n<p>And I created a file that demo.txt.I try to show content in demo.txt when I click the button.But it shows nothing.</p>\n\n<p>So have any tut for me.</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1456322917, "post_id": 35604281, "comment_id": 58893260, "body": "<a href=\"http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/collection_check_boxes\" rel=\"nofollow noreferrer\">apidock.com/rails/ActionView/Helpers/FormOptionsHelper/&hellip;</a> \u21d2 the collection itself goes as a third argument. I guess it should be <code>&lt;%= f.collection_check_boxes :project, :payment, Project::PAYMENT_TYPE do |t| %&gt;</code>."}, {"owner": {"reputation": 1324, "user_id": 4959480, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/86a1d21d6a5ebbeca06d94ba55dbd487?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Hansch", "link": "https://stackoverflow.com/users/4959480/stefan-hansch"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1456323820, "post_id": 35604281, "comment_id": 58893939, "body": "wrong number of arguments (given 3, expected 4..6)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1456323893, "post_id": 35604281, "comment_id": 58893983, "body": "Well, have you taken a look at the docs I linked? <code>&lt;%= f.collection_check_boxes :project, :payment, Project::PAYMENT_TYPE, :itself do |t| %&gt;</code> then. (Or <code>:to_s</code> instead of <code>:itself</code> if you are using not the modern ruby version.)"}, {"owner": {"reputation": 1324, "user_id": 4959480, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/86a1d21d6a5ebbeca06d94ba55dbd487?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Hansch", "link": "https://stackoverflow.com/users/4959480/stefan-hansch"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1456324596, "post_id": 35604281, "comment_id": 58894542, "body": "with this code display error: undefined method `map&#39; for :payment:Symbol Did you mean?  tap"}, {"owner": {"reputation": 3160, "user_id": 1266795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7855792dbc5f3b4c365344314e2b1ad6?s=128&d=identicon&r=PG", "display_name": "AndyV", "link": "https://stackoverflow.com/users/1266795/andyv"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1456325043, "post_id": 35604281, "comment_id": 58894914, "body": "@mudasobwa: the form shown in the OP is correct when the call is nested inside a form_for in this way.  The object is inferred from the form_for block.  I suspect that problem with the collection_check_boxes call is that it does not have enough information to know what value to use for &#39;value&#39; and &#39;label&#39;.  The API allows you to specify a method to call on the items in the collection.  If you&#39;re using ruby 2.2.x you might use :itself; otherwise :to_s would work since you&#39;re dealing with strings.  f.collection_check_boxes :payment, Project::PAYMENT_TYPE, :itself, :itself"}, {"owner": {"reputation": 1324, "user_id": 4959480, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/86a1d21d6a5ebbeca06d94ba55dbd487?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Hansch", "link": "https://stackoverflow.com/users/4959480/stefan-hansch"}, "edited": false, "score": 0, "creation_date": 1456325629, "post_id": 35604281, "comment_id": 58895384, "body": "big, big, big thank you!!!"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1456332995, "post_id": 35604281, "comment_id": 58900825, "body": "All that model referencing in the view makes my eyes hurt. You&#39;ve got very tight coupling between the view and your models. Why not have your controller (or better yet, a PORO service object) generate a hash for use by your views? The format/content of the hash is essentially a contract between the view and whatever object is creating the hash. That way, you can make changes to your controller, service object, or models and (as long as the contract is honored) have no problems in your view. FWIW."}, {"owner": {"reputation": 1324, "user_id": 4959480, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/86a1d21d6a5ebbeca06d94ba55dbd487?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Hansch", "link": "https://stackoverflow.com/users/4959480/stefan-hansch"}, "edited": false, "score": 0, "creation_date": 1456688931, "post_id": 35604281, "comment_id": 59052346, "body": "Thanks, jvillian. Can you more explain, wht you mean have controller, what will generate metodhs in this controller? Mayebe can you show me more examples?"}], "owner": {"reputation": 1324, "user_id": 4959480, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/86a1d21d6a5ebbeca06d94ba55dbd487?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Hansch", "link": "https://stackoverflow.com/users/4959480/stefan-hansch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1610399319, "creation_date": 1456322588, "last_edit_date": 1610399319, "question_id": 35604281, "link": "https://stackoverflow.com/questions/35604281/how-to-display-value-from-array-in-checkbox", "title": "How to display value from array in Checkbox", "body": "<p>I have the following array in model project:</p>\n<pre><code>PAYMENT_TYPE = ['in bar', 'bargeldlose Zahlung', 'E-Geld']\n</code></pre>\n<p>I have view new.html.erb</p>\n<pre><code>&lt;%= form_for @project, url: {action: 'create'} do |f| %&gt;\n&lt;p&gt;\n  &lt;%= f.label 'Titel' %&gt;\n  &lt;%= f.text_field :title %&gt;\n&lt;/p&gt;\n&lt;P&gt;\n  &lt;%= f.label 'Budget' %&gt;\n  &lt;%= f.text_field :price %&gt;\n  \n  f\u00fcr\n  \n  &lt;%= f.select :price_category, Project::PRICE_CATEGORIES %&gt;\n&lt;/P&gt;\n&lt;p&gt;\n  &lt;%= f.label 'Beschreibung' %&gt;\n  &lt;%= f.text_area :description %&gt;\n&lt;/p&gt;\n&lt;p&gt;\n  &lt;%= f.label 'Kategorie' %&gt;\n  &lt;%= f.collection_select :category_id, Category.all, :id, :name %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;%= f.label 'Professionelle Freelancer Kenntnisse' %&gt;\n  &lt;%= f.text_field :skill %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;%= f.label 'Ort' %&gt;\n  &lt;%= f.text_field :location %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;%= f.label 'M\u00f6glichkeit der Zahlung' %&gt;\n  &lt;%= f.collection_check_boxes :payment, Project::PAYMENT_TYPE do |t| %&gt; \n    &lt;%= t.check_box %&gt;\n    &lt;%= t.label %&gt;\n  &lt;% end %&gt;\n&lt;/p&gt;\n\n&lt;P&gt;\n  &lt;%= f.submit 'erstellen' %&gt;    \n&lt;/P&gt;\n\n&lt;% end %&gt;\n</code></pre>\n<p>I use <code>&lt;%= f.collection_check_boxes :payment, Project::PAYMENT_TYPE do |t| %&gt;</code></p>\n<p>But this code does not work. Which attribute do I need add in this helper method?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1456322718, "post_id": 35604053, "comment_id": 58893096, "body": "<code>--default</code> is not a command. What exactly have you tried?"}, {"owner": {"reputation": 33, "user_id": 4724179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af29fe7fe669e34f1550f8d6966d7f3?s=128&d=identicon&r=PG&f=1", "display_name": "DJ Garu", "link": "https://stackoverflow.com/users/4724179/dj-garu"}, "edited": false, "score": 0, "creation_date": 1456323994, "post_id": 35604053, "comment_id": 58894065, "body": "sorry for not being precise... i was pertaining to this command. <code>rvm gemset use mygemset --default</code>"}, {"owner": {"reputation": 33, "user_id": 4724179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af29fe7fe669e34f1550f8d6966d7f3?s=128&d=identicon&r=PG&f=1", "display_name": "DJ Garu", "link": "https://stackoverflow.com/users/4724179/dj-garu"}, "reply_to_user": {"reputation": 31711, "user_id": 634576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/48891dab622b535f3c2b4ec1c8765bed?s=128&d=identicon&r=PG", "display_name": "Dave Schweisguth", "link": "https://stackoverflow.com/users/634576/dave-schweisguth"}, "edited": false, "score": 0, "creation_date": 1456324023, "post_id": 35604053, "comment_id": 58894093, "body": "@DaveSchweisguth yes i am using rvm"}], "owner": {"reputation": 33, "user_id": 4724179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af29fe7fe669e34f1550f8d6966d7f3?s=128&d=identicon&r=PG&f=1", "display_name": "DJ Garu", "link": "https://stackoverflow.com/users/4724179/dj-garu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456328240, "creation_date": 1456321888, "last_edit_date": 1456328240, "question_id": 35604053, "link": "https://stackoverflow.com/questions/35604053/changing-working-directory-changes-the-default-gemset", "title": "changing working directory changes the default gemset", "body": "<p>I have this gemset that I use to develop my rails app, but currently it is not the default gemset everytime I open up a terminal window. I tried using the <code>rvm gemset use mygemset --default</code> command but no luck in making it work.</p>\n\n<p>How can I set the default gemset automatically?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "edited": false, "score": 3, "creation_date": 1456321716, "post_id": 35603965, "comment_id": 58892381, "body": "Have you tried <code>&#39;9&#39; * 6</code>?"}, {"owner": {"reputation": 2172, "user_id": 4412925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7fa1503a3820659b27943c99d463a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel", "link": "https://stackoverflow.com/users/4412925/nabeel"}, "edited": false, "score": 0, "creation_date": 1456321957, "post_id": 35603965, "comment_id": 58892537, "body": "This is not a rails question, title is slightly misleading."}], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 4, "last_activity_date": 1456321890, "creation_date": 1456321890, "answer_id": 35604054, "question_id": 35603965, "link": "https://stackoverflow.com/questions/35603965/ruby-what-is-one-line-code-to-generate-x-repeated-characters/35604054#35604054", "title": "Ruby: What is one-line code to generate x repeated characters?", "body": "<pre><code>def generate_repeated_str(n, char)\n  char * n\nend\n</code></pre>\n\n<p>or just</p>\n\n<pre><code>n = 6\n'9' * n\n=&gt; '999999'\n</code></pre>\n"}], "owner": {"reputation": 1022, "user_id": 1241108, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/R81Jx.jpg?s=128&g=1", "display_name": "Junji Zhi", "link": "https://stackoverflow.com/users/1241108/junji-zhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 35604054, "answer_count": 1, "score": -2, "last_activity_date": 1456324364, "creation_date": 1456321658, "last_edit_date": 1456324364, "question_id": 35603965, "link": "https://stackoverflow.com/questions/35603965/ruby-what-is-one-line-code-to-generate-x-repeated-characters", "title": "Ruby: What is one-line code to generate x repeated characters?", "body": "<p>I want a function that generates a number of repeated characters and puts in a string. For example, </p>\n\n<pre><code>&gt; n = 6\n&gt; generate_repeated_str(n,'9')\n\"999999\"\n</code></pre>\n\n<p>How do I write a one-line code to do that in Ruby? </p>\n\n<p>EDIT:\nSince this is not a rails question, the title was updated and 'Rails' was removed. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "edited": false, "score": 2, "creation_date": 1456320606, "post_id": 35603532, "comment_id": 58891596, "body": "Try <code>number.gsub(&#47;\\D&#47;, &#39;&#39;)</code> to remove all non-digits."}, {"owner": {"reputation": 78237, "user_id": 2025923, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zYYVM.png?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/2025923/tushar"}, "edited": false, "score": 0, "creation_date": 1456320631, "post_id": 35603532, "comment_id": 58891618, "body": "<a href=\"https://regex101.com/r/uD1eU7/1\" rel=\"nofollow noreferrer\"><code>number.gsub(&#47;\\D+&#47;, &#39;&#39;)</code></a>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1456320833, "post_id": 35603532, "comment_id": 58891752, "body": "By tagging your question with regex or writing gsub in the title, you are limiting the answers."}], "answers": [{"tags": [], "owner": {"reputation": 14407, "user_id": 3035830, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14809f2ad7f14e2867798697ab8f8006?s=128&d=identicon&r=PG", "display_name": "shivam", "link": "https://stackoverflow.com/users/3035830/shivam"}, "is_accepted": false, "score": 2, "last_activity_date": 1456320598, "creation_date": 1456320598, "answer_id": 35603593, "question_id": 35603532, "link": "https://stackoverflow.com/questions/35603532/how-to-remove-all-non-digits-from-a-string-in-ruby/35603593#35603593", "title": "How to remove all non-digits from a string in ruby?", "body": "<p>Instead of removing special characters, you can looks for all digits. Something like:</p>\n\n<pre><code>str = \"1-800-432-4567\"\nstr.scan(/\\d/).join\n#=&gt; \"18004324567\"\n\nstr = \"(800)432.4567\"\nstr.scan(/\\d/).join\n#=&gt; \"8004324567\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 20, "creation_date": 1456330026, "post_id": 35603648, "comment_id": 58898446, "body": "or <code>str.delete(&#39;^0-9&#39;)</code>"}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": true, "score": 48, "last_activity_date": 1456320778, "creation_date": 1456320778, "answer_id": 35603648, "question_id": 35603532, "link": "https://stackoverflow.com/questions/35603532/how-to-remove-all-non-digits-from-a-string-in-ruby/35603648#35603648", "title": "How to remove all non-digits from a string in ruby?", "body": "<p>If the first argument of the <code>tr</code> method of String starts with <code>^</code>, then it denotes all characters except those listed.</p>\n\n<pre><code>def canonical_form str\n  str.tr('^0-9', '')   \nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1717, "user_id": 1034924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecedc78563223e4f7742bbfc66992905?s=128&d=identicon&r=PG", "display_name": "nzajt", "link": "https://stackoverflow.com/users/1034924/nzajt"}, "edited": false, "score": 1, "creation_date": 1531407638, "post_id": 50753455, "comment_id": 89594381, "body": "I know this is a little late but thanks for doing this."}, {"owner": {"reputation": 680, "user_id": 257195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e3d8ebb0811dfdf750edfaac6f4957f?s=128&d=identicon&r=PG", "display_name": "Merovex", "link": "https://stackoverflow.com/users/257195/merovex"}, "edited": false, "score": 0, "creation_date": 1610905403, "post_id": 50753455, "comment_id": 116274325, "body": "It&#39;s 2021...thanks for this."}], "tags": [], "owner": {"reputation": 510, "user_id": 6154259, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156693331560542/picture?type=large", "display_name": "Matt H", "link": "https://stackoverflow.com/users/6154259/matt-h"}, "is_accepted": false, "score": 38, "last_activity_date": 1528432718, "creation_date": 1528432718, "answer_id": 50753455, "question_id": 35603532, "link": "https://stackoverflow.com/questions/35603532/how-to-remove-all-non-digits-from-a-string-in-ruby/50753455#50753455", "title": "How to remove all non-digits from a string in ruby?", "body": "<p>Several solutions above - I benchmarked a few in case anyone is interested: </p>\n\n<pre><code>str = \"1-800-432-4567\"\nBenchmark.ms { 10000.times{str.scan(/\\d/).join} }\n#=&gt; 69.4419999490492 \n\nBenchmark.ms { 10000.times{str.delete('^0-9')} }\n#=&gt; 7.574999995995313 \n\nBenchmark.ms { 10000.times{str.tr('^0-9', '')} }\n#=&gt; 7.642999989911914\n\nBenchmark.ms { 10000.times{str.gsub(/\\D+/, '')} }\n#=&gt; 28.084999998100102\n</code></pre>\n"}], "owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12541, "favorite_count": 0, "accepted_answer_id": 35603648, "answer_count": 3, "score": 26, "last_activity_date": 1528432718, "creation_date": 1456320435, "last_edit_date": 1456330176, "question_id": 35603532, "link": "https://stackoverflow.com/questions/35603532/how-to-remove-all-non-digits-from-a-string-in-ruby", "title": "How to remove all non-digits from a string in ruby?", "body": "<p>Users input numbers in the following forms:</p>\n\n<pre><code>1-800-432-4567\n800-432-4567\n800.432.4566\n(800)432.4567\n+1(800)-432-4567\n800 432 4567\n</code></pre>\n\n<p>I want all of these to be turned into a stripped version without the special characters like <code>18004324567</code>. The data come in the form of a <code>String</code>, so string checking isn't required.</p>\n\n<p>My method is as below:</p>\n\n<pre><code>def canonical_form number\n  a = remove_whitespaces number #to clear all whitespaces in between\n  a.gsub(/[()-+.]/,'')     \nend\n\ndef remove_whitespaces number\n  number.gsub(/\\s+/,'')  #removes all whitespaces\nend\n</code></pre>\n\n<p>Is there a better way to do this? Can the white space check with the regular expression in <code>canonical_form</code> method be performed without having an extra method for white spaces? How can this be refactored or done in a neater way?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1456320747, "post_id": 35603346, "comment_id": 58891695, "body": "Have you considered having a <code>subscribe.js.erb</code> file which does the alert?"}, {"owner": {"reputation": 495, "user_id": 3314051, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4b9930fb3f7129dc91e0a7cde4262a26?s=128&d=identicon&r=PG&f=1", "display_name": "Difender", "link": "https://stackoverflow.com/users/3314051/difender"}, "reply_to_user": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1456320847, "post_id": 35603346, "comment_id": 58891757, "body": "Like rendering the <code>subscribe.js.erb</code> ? But if I do this it will redirect and I&#39;d like to stay on the same page but just print out an alert. Is that posible?"}, {"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1456321695, "post_id": 35603346, "comment_id": 58892372, "body": "Why would it redirect?"}, {"owner": {"reputation": 495, "user_id": 3314051, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4b9930fb3f7129dc91e0a7cde4262a26?s=128&d=identicon&r=PG&f=1", "display_name": "Difender", "link": "https://stackoverflow.com/users/3314051/difender"}, "reply_to_user": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1456321809, "post_id": 35603346, "comment_id": 58892439, "body": "It will render a new page, am I wrong about that ?"}, {"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1456322063, "post_id": 35603346, "comment_id": 58892607, "body": "Yes, it will only redirect if you tell it to."}, {"owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1456326321, "post_id": 35603346, "comment_id": 58895911, "body": "Hey, look at your posted error, it is just a warning! any other clue?"}, {"owner": {"reputation": 495, "user_id": 3314051, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4b9930fb3f7129dc91e0a7cde4262a26?s=128&d=identicon&r=PG&f=1", "display_name": "Difender", "link": "https://stackoverflow.com/users/3314051/difender"}, "edited": false, "score": 0, "creation_date": 1456327417, "post_id": 35603346, "comment_id": 58896482, "body": "No, I really don&#39;t know. I&#39;m just starting rails so I have no clues :("}], "answers": [{"comments": [{"owner": {"reputation": 495, "user_id": 3314051, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4b9930fb3f7129dc91e0a7cde4262a26?s=128&d=identicon&r=PG&f=1", "display_name": "Difender", "link": "https://stackoverflow.com/users/3314051/difender"}, "edited": false, "score": 0, "creation_date": 1456321742, "post_id": 35603746, "comment_id": 58892398, "body": "Thanks, Rails already set this up when I did <code>new rails ... </code> So it&#39;s already here :)"}, {"owner": {"reputation": 495, "user_id": 3314051, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4b9930fb3f7129dc91e0a7cde4262a26?s=128&d=identicon&r=PG&f=1", "display_name": "Difender", "link": "https://stackoverflow.com/users/3314051/difender"}, "edited": false, "score": 0, "creation_date": 1456328760, "post_id": 35603746, "comment_id": 58897419, "body": "Now it works! I just added <code>skip_before_action :verify_authenticity_token</code> but now it&#39;s redirecting to a blank page with just <code>alert(&#39;...&#39;)</code> written in it x.x"}], "tags": [], "owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "is_accepted": true, "score": 1, "last_activity_date": 1456321615, "last_edit_date": 1456321615, "creation_date": 1456321038, "answer_id": 35603746, "question_id": 35603346, "link": "https://stackoverflow.com/questions/35603346/rails-rendering-a-js-alert/35603746#35603746", "title": "Rails: Rendering a JS alert", "body": "<p>You are missing <code>data-remote</code> attribute in your form, just add it:</p>\n\n<pre><code>&lt;form action=\"/welcome/subscribe\" date-remote=\"true\"&gt;\n    &lt;div&gt;\n        &lt;div id=\"bottomm\"&gt;\n            &lt;input id=\"bottom\" type=\"text\" name=\"email\" placeholder=\"Adresse mail\" /&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;input type=\"submit\" value=\"Ok\"/&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<h1>Update</h1>\n\n<p>Btw, from the given error, you may add <code>protect_from_forgery</code> to your application controller:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  # Prevent CSRF attacks by raising an exception.\n  protect_from_forgery with: :exception\n\n  # Other code\nend\n</code></pre>\n\n<p>For more detail, please read <a href=\"http://guides.rubyonrails.org/security.html#cross-site-request-forgery-csrf\" rel=\"nofollow\">this documentation</a></p>\n"}, {"tags": [], "owner": {"reputation": 4711, "user_id": 83729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5071d40db06ac987180c40e675b7193b?s=128&d=identicon&r=PG", "display_name": "msergeant", "link": "https://stackoverflow.com/users/83729/msergeant"}, "is_accepted": false, "score": 0, "last_activity_date": 1456321143, "creation_date": 1456321143, "answer_id": 35603779, "question_id": 35603346, "link": "https://stackoverflow.com/questions/35603346/rails-rendering-a-js-alert/35603779#35603779", "title": "Rails: Rendering a JS alert", "body": "<p>You need to specify that your form will be submitted asynchronously (IE without a full page refresh). When using <code>form_for</code> to generate your form, you would include <code>:remote =&gt; true</code>. Since you are typing out your full form you need to do this:</p>\n\n<pre><code>&lt;form action=\"/welcome/subscribe\" date-remote=\"true\"&gt;\n#...\n</code></pre>\n"}], "owner": {"reputation": 495, "user_id": 3314051, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4b9930fb3f7129dc91e0a7cde4262a26?s=128&d=identicon&r=PG&f=1", "display_name": "Difender", "link": "https://stackoverflow.com/users/3314051/difender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1844, "favorite_count": 2, "accepted_answer_id": 35603746, "answer_count": 2, "score": 4, "last_activity_date": 1456330858, "creation_date": 1456319938, "last_edit_date": 1456330858, "question_id": 35603346, "link": "https://stackoverflow.com/questions/35603346/rails-rendering-a-js-alert", "title": "Rails: Rendering a JS alert", "body": "<p>I'm trying to render a js alert directly after a user clicks on a submit.</p>\n\n<p>Here's what I have and what I've tried:</p>\n\n<p>That's my erb file.</p>\n\n<pre><code>&lt;form action=\"/welcome/subscribe\"&gt;\n    &lt;div&gt;\n        &lt;div id=\"bottomm\"&gt;\n            &lt;input id=\"bottom\" type=\"text\" name=\"email\" placeholder=\"Adresse mail\" /&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;input type=\"submit\" value=\"Ok\"/&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Here's the subscribe method in my controller:</p>\n\n<pre><code>def subscribe\n  @test = Test.new\n  @test.email = params['email']\n  @test.save\n  binding.pry\n  render js: \"alert('test)\";\nend\n</code></pre>\n\n<p>But I get this error:</p>\n\n<p><code>Security warning: an embedded &lt;script&gt; tag on another site requested protected JavaScript. If you know what you're doing, go ahead and disable forgery protection on this action to permit cross-origin JavaScript embedding.</code></p>\n\n<p>Any idea? :/</p>\n\n<p>edit:</p>\n\n<p>By adding theses 2 lines I can now avoid the warning:</p>\n\n<pre><code>protect_from_forgery with: :exception\nskip_before_action :verify_authenticity_token\n</code></pre>\n\n<p>But now it's redirecting me on a blank page with just written on it:</p>\n\n<pre><code>alert('test')\n</code></pre>\n"}, {"tags": ["ruby", "cucumber", "capybara"], "comments": [{"owner": {"reputation": 31711, "user_id": 634576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/48891dab622b535f3c2b4ec1c8765bed?s=128&d=identicon&r=PG", "display_name": "Dave Schweisguth", "link": "https://stackoverflow.com/users/634576/dave-schweisguth"}, "edited": false, "score": 2, "creation_date": 1456318754, "post_id": 35602526, "comment_id": 58890249, "body": "You&#39;ll have to provide much more information for anyone to be able to help you."}, {"owner": {"reputation": 4018, "user_id": 135673, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42ee5885ec2ae8f7834b716a3a2b57c2?s=128&d=identicon&r=PG", "display_name": "froderik", "link": "https://stackoverflow.com/users/135673/froderik"}, "edited": false, "score": 0, "creation_date": 1456320306, "post_id": 35602526, "comment_id": 58891392, "body": "I agree with Dave! If your Ruby file is not being called at all it is probably not on the load path so you need to look into that."}], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 5851371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45b365e8d351bd92b59f5e868baba42?s=128&d=identicon&r=PG&f=1", "display_name": "Sanchita", "link": "https://stackoverflow.com/users/5851371/sanchita"}, "is_accepted": false, "score": 0, "last_activity_date": 1456379714, "creation_date": 1456379714, "answer_id": 35619456, "question_id": 35602526, "link": "https://stackoverflow.com/questions/35602526/integration-of-feature-file-steps-rb-and-env-rb-through-cucumber/35619456#35619456", "title": "Integration of feature file, steps.rb and env.rb through cucumber", "body": "<p>You can use the '-r' switch to run your tests eg. cucumber -r features/....</p>\n\n<p>This will force cucumber to load the step definitions which are present in your support and step definition directories which are under the 'features' root directory.</p>\n\n<p>You can alternatively set \"-r features\" in the config/cucumber.yml file at the end of your profile (std_opts)</p>\n"}], "owner": {"reputation": 1, "user_id": 5638399, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/34e3cfd87d7dc8601f44fc94a4ab7ecf?s=128&d=identicon&r=PG&f=1", "display_name": "BMR", "link": "https://stackoverflow.com/users/5638399/bmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456379714, "creation_date": 1456317737, "question_id": 35602526, "link": "https://stackoverflow.com/questions/35602526/integration-of-feature-file-steps-rb-and-env-rb-through-cucumber", "title": "Integration of feature file, steps.rb and env.rb through cucumber", "body": "<p>i have created a feature file to run in cucumber and i have the steps definition file in ruby extension but whenever i run the feature file the ruby file is not called into action. The env.rb file too is present. Provide solutions.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rails-activerecord"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1456333616, "post_id": 35602120, "comment_id": 58901312, "body": "Out of curiosity, where did <code>items</code> come from? If from a single model (something like <code>Item</code>), then I&#39;m wondering if you couldn&#39;t do <code>Item.sum(:field)</code>. You might be able to use <code>.sum(:field)</code> even if <code>items</code> is coming from different models, but that would take a little more work."}], "answers": [{"tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 5, "last_activity_date": 1456316711, "creation_date": 1456316711, "answer_id": 35602172, "question_id": 35602120, "link": "https://stackoverflow.com/questions/35602120/using-variable-in-map/35602172#35602172", "title": "Using variable in .map()", "body": "<p>You should simply manually write block passed to <code>map</code> method:</p>\n\n<pre><code>items.map { |item| item.public_send(field) }.sum(&amp;:to_i)\n</code></pre>\n\n<p>Blocks are closures in Ruby, so if there is <code>field</code> local variable in this scope, it will also be accessible inside of block.</p>\n"}, {"tags": [], "owner": {"reputation": 967, "user_id": 3721985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aa381fb6c99cb7b84fdb25e6f6aafb4?s=128&d=identicon&r=PG", "display_name": "Rohit Jangid", "link": "https://stackoverflow.com/users/3721985/rohit-jangid"}, "is_accepted": true, "score": 6, "last_activity_date": 1456317442, "creation_date": 1456317442, "answer_id": 35602415, "question_id": 35602120, "link": "https://stackoverflow.com/questions/35602120/using-variable-in-map/35602415#35602415", "title": "Using variable in .map()", "body": "<p>You could go ahead using following code</p>\n\n<pre><code>items.map(&amp;field).sum(&amp;:to_i)\n</code></pre>\n\n<p>Note that i have just removed the \"<strong>:</strong>\" symbol. Here <strong>field</strong> is your variable</p>\n"}], "owner": {"reputation": 2321, "user_id": 2540204, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/61eRS.jpg?s=128&g=1", "display_name": "neanderslob", "link": "https://stackoverflow.com/users/2540204/neanderslob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1353, "favorite_count": 2, "accepted_answer_id": 35602415, "answer_count": 2, "score": 2, "last_activity_date": 1456317442, "creation_date": 1456316573, "last_edit_date": 1495535294, "question_id": 35602120, "link": "https://stackoverflow.com/questions/35602120/using-variable-in-map", "title": "Using variable in .map()", "body": "<p>I'm attempting to write a helper that sums using nil values as zeros.  Taking advantage of the following method from <a href=\"https://stackoverflow.com/a/15277430/2540204\">this answer.</a></p>\n\n<pre><code>items.map(&amp;:some_field).sum(&amp;:to_i)\n</code></pre>\n\n<p>The issue is that since I'm writing a helper, <code>:some_field</code> will need to be passed in as a variable.  How do I then use that variable in .map?  Something like the following:</p>\n\n<pre><code>items.map(&amp;:send(field)).sum(&amp;:to_i)\n</code></pre>\n\n<p>Any tips would be appreciated</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "strong-parameters"], "comments": [{"owner": {"reputation": 8378, "user_id": 2076787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfe965ab5ef94a0568bc61c36b46d4c?s=128&d=identicon&r=PG", "display_name": "D-side", "link": "https://stackoverflow.com/users/2076787/d-side"}, "edited": false, "score": 0, "creation_date": 1456315443, "post_id": 35601619, "comment_id": 58887882, "body": "Your code effectively writes them into the model. So typical attribute access applies. But I&#39;m getting the feeling you want something else, try providing an example of how you&#39;d expect that to look like."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "reply_to_user": {"reputation": 8378, "user_id": 2076787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfe965ab5ef94a0568bc61c36b46d4c?s=128&d=identicon&r=PG", "display_name": "D-side", "link": "https://stackoverflow.com/users/2076787/d-side"}, "edited": false, "score": 0, "creation_date": 1456316240, "post_id": 35601619, "comment_id": 58888445, "body": "I have updated my question, I think it is more clear now"}, {"owner": {"reputation": 8378, "user_id": 2076787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfe965ab5ef94a0568bc61c36b46d4c?s=128&d=identicon&r=PG", "display_name": "D-side", "link": "https://stackoverflow.com/users/2076787/d-side"}, "edited": false, "score": 0, "creation_date": 1456316301, "post_id": 35601619, "comment_id": 58888486, "body": "Ah. So you want a list of <b>allowed attribute names</b>. Well... it&#39;s complicated. Where do you expect to get it from? Just write a whitelist somewhere? Infer from the table? Or what?"}], "answers": [{"tags": [], "owner": {"reputation": 32547, "user_id": 276959, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/mSp5G.jpg?s=128&g=1", "display_name": "Mohamad", "link": "https://stackoverflow.com/users/276959/mohamad"}, "is_accepted": false, "score": 3, "last_activity_date": 1456316559, "creation_date": 1456316559, "answer_id": 35602111, "question_id": 35601619, "link": "https://stackoverflow.com/questions/35601619/how-to-access-strong-parameters-from-model-in-rails-4/35602111#35602111", "title": "How to access Strong parameters from Model in Rails 4", "body": "<p>Your question is unusual. Allowed attributes don't usually belong in the model. They are a controller concern, hence why Rails removed <code>attr_accessible</code> in favour of <code>strong_parameters</code>. If you need to protect attributes, ActiveRecord has <a href=\"http://apidock.com/rails/ActiveRecord/ReadonlyAttributes/ClassMethods/attr_readonly\" rel=\"nofollow\"><code>attr_read_only</code></a>.</p>\n\n<p>If you want a central place to keep them, just add a constant in your model.</p>\n\n<pre><code>class Customer\n  ALLOWED_ATTRIBUTES = [:name, :role]\n\n  def allowed_attributes\n    ALLOWED_ATTRIBUTES\n  end\nend\n</code></pre>\n\n<p>Now you can do <code>User.allowed_attributes</code> from anywhere.</p>\n\n<pre><code>private\n\ndef customer_params\n  params.require(:customer).permit(*User.allowed_attributes)\nend\n</code></pre>\n\n<p>But this is not desirable in my opinion because allowed attributes should set in some context, like a user role, or an access level, etc...</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 800, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1456316729, "creation_date": 1456315250, "last_edit_date": 1456316729, "question_id": 35601619, "link": "https://stackoverflow.com/questions/35601619/how-to-access-strong-parameters-from-model-in-rails-4", "title": "How to access Strong parameters from Model in Rails 4", "body": "<p>Let's suppose I have a customer controller with <code>strong_parameters</code> as follows:</p>\n\n<pre><code>def update\n  @customer.update_attributes(customer_params)\nend\n\nprivate\n\ndef customer_params\n  params.require(:customer).permit(:name, :age)\nend\n</code></pre>\n\n<p>Now I want to access permitted parameters (name and age) from the <code>Customer</code> model. For example:</p>\n\n<pre><code>class Customer &lt; ActiveRecord::Base\n  def self.some_method\n    allowed_parameters = customer_params\n  end\nend  \n</code></pre>\n\n<p>How can I access those parameters? How can I get <code>allowed_parameters = customer_params</code> from the Customer model?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1456315605, "post_id": 35601649, "comment_id": 58887998, "body": "With out creating new arrays <code>doc_counts, keys = [],[]</code> is it possible to do??"}, {"owner": {"reputation": 1982, "user_id": 1957674, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b9fa3c9e811e22d933f19f24e8a6797d?s=128&d=identicon&r=PG", "display_name": "BinaryMee", "link": "https://stackoverflow.com/users/1957674/binarymee"}, "reply_to_user": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1456315851, "post_id": 35601649, "comment_id": 58888180, "body": "Evidently, you need two new arrays as a result. You could also use <code>map!</code> to change your input array itself. But again you need to create another array to accommodate other set of values."}], "tags": [], "owner": {"reputation": 1982, "user_id": 1957674, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b9fa3c9e811e22d933f19f24e8a6797d?s=128&d=identicon&r=PG", "display_name": "BinaryMee", "link": "https://stackoverflow.com/users/1957674/binarymee"}, "is_accepted": false, "score": 0, "last_activity_date": 1456315730, "last_edit_date": 1456315730, "creation_date": 1456315318, "answer_id": 35601649, "question_id": 35601508, "link": "https://stackoverflow.com/questions/35601508/split-values-into-separate-arrays-based-on-keys-in-a-hash/35601649#35601649", "title": "Split values into separate Arrays based on keys in a Hash?", "body": "<p>You could iterate and assign it to new arrays <code>doc_counts</code> and <code>keys</code>.</p>\n\n<pre><code>array = [{\"key\"=&gt;\"55ffee8b6a617960010e0000\", \"doc_count\"=&gt;1}, {\"key\"=&gt;\"55fff0376a61794e190f0000\", \"doc_count\"=&gt;1}, {\"key\"=&gt;\"55fff0dd6a61794e191f0000\", \"doc_count\"=&gt;1}]\ndoc_counts, keys = [],[]\narray.each do |a|\n    doc_counts &lt;&lt; a[\"doc_count\"]\n    keys &lt;&lt; a[\"key\"]\nend\n</code></pre>\n\n<p>Result</p>\n\n<pre><code>&gt;&gt; doc_counts\n=&gt; [1, 1, 1]\n&gt;&gt; keys\n=&gt; [\"55ffee8b6a617960010e0000\", \"55fff0376a61794e190f0000\", \"55fff0dd6a61794e191f0000\"]\n</code></pre>\n\n<p><strong>Or</strong></p>\n\n<pre><code>doc_counts = []\nkeys = array.map do |a|\n    doc_counts &lt;&lt; a[\"doc_count\"]\n    a[\"key\"]\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "is_accepted": false, "score": 2, "last_activity_date": 1456315672, "creation_date": 1456315672, "answer_id": 35601779, "question_id": 35601508, "link": "https://stackoverflow.com/questions/35601508/split-values-into-separate-arrays-based-on-keys-in-a-hash/35601779#35601779", "title": "Split values into separate Arrays based on keys in a Hash?", "body": "<p>You can use some of these</p>\n\n<pre><code>a = [\n  {\n    \"key\" =&gt; \"55ffee8b6a617960010e0000\",\n    \"doc_count\" =&gt; 1\n  },\n  {\n    \"key\" =&gt; \"55fff0376a61794e190f0000\",\n    \"doc_count\" =&gt; 1\n  },\n  {\n    \"key\" =&gt; \"55fff0dd6a61794e191f0000\",\n    \"doc_count\" =&gt; 1\n  }\n]\n</code></pre>\n\n<p>1.</p>\n\n<pre><code>hash = Hash[a.map { |h| [h[\"key\"], h[\"doc_count\"]] }]\nhash.keys\nhash.values\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>exp = Hash.new { |k, v| k[v] = [] }\na.map { |h| h.each { |k, v| exp[k] &lt;&lt; v } }\n</code></pre>\n\n<p>3.</p>\n\n<pre><code>hash = a.each_with_object({}) { |arr_h, h| h[arr_h[\"key\"]] = arr_h[\"doc_count\"] }\nhash.keys\nhash.values\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8378, "user_id": 2076787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfe965ab5ef94a0568bc61c36b46d4c?s=128&d=identicon&r=PG", "display_name": "D-side", "link": "https://stackoverflow.com/users/2076787/d-side"}, "edited": false, "score": 0, "creation_date": 1456320010, "post_id": 35601936, "comment_id": 58891149, "body": "Be mindful though that it relies on the order of keys inside the hash. If, say, lines 3-4 were swapped the result would be different."}], "tags": [], "owner": {"reputation": 19398, "user_id": 435471, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WvUmQ.jpg?s=128&g=1", "display_name": "Kyle Decot", "link": "https://stackoverflow.com/users/435471/kyle-decot"}, "is_accepted": true, "score": 6, "last_activity_date": 1460460915, "last_edit_date": 1460460915, "creation_date": 1456316059, "answer_id": 35601936, "question_id": 35601508, "link": "https://stackoverflow.com/questions/35601508/split-values-into-separate-arrays-based-on-keys-in-a-hash/35601936#35601936", "title": "Split values into separate Arrays based on keys in a Hash?", "body": "<p>You can use <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-transpose\" rel=\"nofollow\">transpose</a> here:</p>\n\n<pre><code>keys, doc_counts = array_of_hashes.map(&amp;:values).transpose\n</code></pre>\n\n<p>As <code>D-side</code> points out this relies on the ordering of the keys being the same for each hash. If you cannot ensure this (for instance your data is being created via an API) you would have to perform the additional step of sorting the hash's keys. That would look something like:</p>\n\n<pre><code>keys, doc_counts = array_of_hashes.map{|h| Hash[h.sort].values }.transpose\n</code></pre>\n\n<p>In either case you'll end up with something like:</p>\n\n<pre><code>keys # =&gt; [\"55ffee8b6a617960010e0000\", \"55fff0376a61794e190f0000\", \"55fff0dd6a61794e191f0000\"]\ndoc_counts # =&gt; [1, 1, 1]\n</code></pre>\n"}], "owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 2, "accepted_answer_id": 35601936, "answer_count": 3, "score": -1, "last_activity_date": 1460460915, "creation_date": 1456314939, "last_edit_date": 1456318486, "question_id": 35601508, "link": "https://stackoverflow.com/questions/35601508/split-values-into-separate-arrays-based-on-keys-in-a-hash", "title": "Split values into separate Arrays based on keys in a Hash?", "body": "<p>I have some thing like this</p>\n\n<pre><code>[\n  {\n    \"key\": \"55ffee8b6a617960010e0000\",\n    \"doc_count\": 1\n   },\n    {\n     \"key\": \"55fff0376a61794e190f0000\",\n     \"doc_count\": 1\n    },\n    {\n     \"key\": \"55fff0dd6a61794e191f0000\",\n     \"doc_count\": 1\n    }\n]\n</code></pre>\n\n<p>i want to separate <code>:key</code> values and <code>:doc_count</code> values into separate arrays like</p>\n\n<pre><code>[\"55ffee8b6a617960010e0000\", \"55fff0376a61794e190f0000\", \"55fff0dd6a61794e191f0000\"]\n</code></pre>\n\n<p>and like <code>[1,1,1]</code>. How to achieve this?</p>\n"}, {"tags": ["ruby", "node.js", "gruntjs", "premailer"], "comments": [{"owner": {"reputation": 8378, "user_id": 2076787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfe965ab5ef94a0568bc61c36b46d4c?s=128&d=identicon&r=PG", "display_name": "D-side", "link": "https://stackoverflow.com/users/2076787/d-side"}, "edited": false, "score": 0, "creation_date": 1456319783, "post_id": 35601017, "comment_id": 58890994, "body": "<code>grunt-premailer</code> -&gt; <a href=\"https://github.com/dwightjack/grunt-premailer#requirements\" rel=\"nofollow noreferrer\">&quot;Requirements&quot; -&gt; &quot;Ruby &gt;= 1.9.3&quot;</a>. Did you install Ruby?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6358125"}, "is_accepted": false, "score": 0, "last_activity_date": 1534424343, "last_edit_date": 1534424343, "creation_date": 1525978446, "answer_id": 50279714, "question_id": 35601017, "link": "https://stackoverflow.com/questions/35601017/node-js-not-found-ruby-exe/50279714#50279714", "title": "Node js: not found ruby.exe", "body": "<p>This error seems to be related to premailer required dependencie.</p>\n\n<ol>\n<li>Download <a href=\"https://github.com/oneclick/rubyinstaller2/releases/download/rubyinstaller-2.4.4-1/rubyinstaller-devkit-2.4.4-1-x64.exe\" rel=\"nofollow noreferrer\">Ruby</a></li>\n<li>Install</li>\n<li>Restart your command line</li>\n<li>Have fun!</li>\n</ol>\n"}], "owner": {"reputation": 167, "user_id": 3970665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be2ad54d4e2eaca792abb895036b0aac?s=128&d=identicon&r=PG&f=1", "display_name": "noe m", "link": "https://stackoverflow.com/users/3970665/noe-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1534424343, "creation_date": 1456313547, "question_id": 35601017, "link": "https://stackoverflow.com/questions/35601017/node-js-not-found-ruby-exe", "title": "Node js: not found ruby.exe", "body": "<p>iam new to node js, ruby grunt etc. And i want to use premailer for my e-mail templates. So i installed node js, ruby, grunt and premailer but when i try to grunt it i get this error message:</p>\n\n<pre><code>    C:\\Users\\Noeel\\Desktop\\mail&gt;grunt\n    Running \"premailer:main\" (premailer) task\n    Fatal error: Error: not found: ruby.exe\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/JNOXc.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/JNOXc.jpg</a>\nI followed several guides and searched the problem on google but no luck.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1456313775, "post_id": 35600980, "comment_id": 58886691, "body": "What is in the migration file?"}, {"owner": {"reputation": 18593, "user_id": 4304188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5695b0e5c30d4464163e3f3412fe5f1?s=128&d=identicon&r=PG", "display_name": "Mihai Dinculescu", "link": "https://stackoverflow.com/users/4304188/mihai-dinculescu"}, "edited": false, "score": 2, "creation_date": 1456313815, "post_id": 35600980, "comment_id": 58886718, "body": "As the command implies, <code>rails generate migration</code> generates the migration. It does not run it. Open the generated migration, check to see if it looks good, then run it using <code>rake db:migrate</code>."}, {"owner": {"reputation": 677, "user_id": 5306420, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/fdf6d0a7c2a4d6a5e4d1b772175da542?s=128&d=identicon&r=PG&f=1", "display_name": "punitcse", "link": "https://stackoverflow.com/users/5306420/punitcse"}, "edited": false, "score": 0, "creation_date": 1456314053, "post_id": 35600980, "comment_id": 58886900, "body": "has your migration successfully run?"}], "answers": [{"tags": [], "owner": {"reputation": 971, "user_id": 2597718, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/451afe490759d58b0f61b2dd5b47ff8a?s=128&d=identicon&r=PG", "display_name": "Shouichi", "link": "https://stackoverflow.com/users/2597718/shouichi"}, "is_accepted": false, "score": 5, "last_activity_date": 1456313794, "creation_date": 1456313794, "answer_id": 35601097, "question_id": 35600980, "link": "https://stackoverflow.com/questions/35600980/rails-migration-is-not-reflecting-while-migration-is-successful/35601097#35601097", "title": "rails migration is not reflecting while migration is successful", "body": "<p>You only generated a migration file (<code>rails generate migration add_product_id_to_categories product_id:integer</code>). You have to run the migration with <code>rake db:migrate</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 378, "user_id": 5973821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32563022cae4a19e6640b6b3ce822e40?s=128&d=identicon&r=PG", "display_name": "Dawcars", "link": "https://stackoverflow.com/users/5973821/dawcars"}, "is_accepted": false, "score": 1, "last_activity_date": 1456314042, "creation_date": 1456314042, "answer_id": 35601193, "question_id": 35600980, "link": "https://stackoverflow.com/questions/35600980/rails-migration-is-not-reflecting-while-migration-is-successful/35601193#35601193", "title": "rails migration is not reflecting while migration is successful", "body": "<p>Have you tried <code>rails generate migration AddProductIdToCategories product_id:integer</code>? </p>\n\n<p>When you have created the migration if you look inside the migration file you can see if any code has been generated in the change method before you run the migration. If it has not generated any content you can manually add it:</p>\n\n<pre><code>def change\n    add_column :categories, :product_id, :integer\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16234, "user_id": 2202702, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lTGWe.jpg?s=128&g=1", "display_name": "Arslan Ali", "link": "https://stackoverflow.com/users/2202702/arslan-ali"}, "is_accepted": false, "score": 2, "last_activity_date": 1456316252, "creation_date": 1456316252, "answer_id": 35602009, "question_id": 35600980, "link": "https://stackoverflow.com/questions/35600980/rails-migration-is-not-reflecting-while-migration-is-successful/35602009#35602009", "title": "rails migration is not reflecting while migration is successful", "body": "<p>Generating a migration is a different thing than actually running it. You just generated it, and in order to execute what you have written, you need to run it, and you can do so by invoking the following command:</p>\n\n<pre><code>rake db:migrate\n</code></pre>\n\n<p>Not sure that either you have run the migration or not, run the following command, and it will tell you the statues of all the migrations. If the status is <code>up</code>, the migration has been run, and for <code>down</code>, a migration couldn't be run.</p>\n\n<pre><code>rake db:migrate:status\n</code></pre>\n\n<p>When you run a migration, and you would like to get notified in terminal that it has been successfully run, you can add a <code>puts</code> statement in there like following:</p>\n\n<pre><code>class AddColumnToCategories &lt; ActiveRecord::Migration\n  def change\n    add_column :categories, :product_id, :integer, index: true\n    puts \"product_id column has been added into categories.\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 3025901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c2e80acf5f2ddd06c4123b12c7dc1d?s=128&d=identicon&r=PG&f=1", "display_name": "Jitendra sharma", "link": "https://stackoverflow.com/users/3025901/jitendra-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1456316286, "creation_date": 1456313466, "last_edit_date": 1456316286, "question_id": 35600980, "link": "https://stackoverflow.com/questions/35600980/rails-migration-is-not-reflecting-while-migration-is-successful", "title": "rails migration is not reflecting while migration is successful", "body": "<p>I have created 2 tables (<code>categories</code> and <code>products</code>) and I did <code>has_many</code> association like <code>Category has_many :products</code> and <code>Product belongs_to :category</code>.</p>\n\n<p>When I do a migration like: </p>\n\n<pre><code>rails generate migration add_product_id_to_categories product_id:integer \n</code></pre>\n\n<p>then migration is running but not seeing <code>product_id</code> in <code>Category</code>.</p>\n\n<p>I've tried multiple ways like </p>\n\n<pre><code>add_product_id_to_category product_id:integer \n</code></pre>\n\n<p>but still facing the same problem.</p>\n"}, {"tags": ["ruby", "curl", "wsdl", "savon"], "answers": [{"tags": [], "owner": {"reputation": 1671, "user_id": 2156436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cd0e887ba1e6bd815a0345f300779e1?s=128&d=identicon&r=PG", "display_name": "Yuri Golobokov", "link": "https://stackoverflow.com/users/2156436/yuri-golobokov"}, "is_accepted": false, "score": 0, "last_activity_date": 1457200091, "creation_date": 1457200091, "answer_id": 35817559, "question_id": 35600517, "link": "https://stackoverflow.com/questions/35600517/wsdl-operations-not-being-updated/35817559#35817559", "title": "WSDL Operations not being updated", "body": "<p>Since version 1 of Savon:</p>\n\n<blockquote>\n  <p>Your service probably uses (lower)CamelCase names for actions and params, but Savon maps those to snake_case Symbols for you.</p>\n</blockquote>\n\n<p>I assume, Savon mapped your new camel case actions to snake case. So if you had updated your tests - you shouldn't.</p>\n"}], "owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457200091, "creation_date": 1456312287, "last_edit_date": 1456313729, "question_id": 35600517, "link": "https://stackoverflow.com/questions/35600517/wsdl-operations-not-being-updated", "title": "WSDL Operations not being updated", "body": "<p>I'm a bit stumped as to why our new operations are not being picked up when using the Savon gem but are when using a simple curl command.</p>\n\n<p>For example when using Savon</p>\n\n<pre><code>@client = Savon.client(wsdl: \"#url-here\", basic_auth: %w(username password))\n@client.operations\n:operation_name\n# At this point i expect the operation to be OperationName\n</code></pre>\n\n<p>When I then run a curl request</p>\n\n<pre><code>curl #url-here --user username:password\n</code></pre>\n\n<p>Within the XML response is</p>\n\n<pre><code>&lt;operation name=\"OperationName\"&gt;\n</code></pre>\n\n<p>We recently changed the naming convention of our operations to camel case (previously using snake case) so the tests used to pass but now they fail as not picking up the new operations (When using Savon)</p>\n\n<p>Would there be any reason for this ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongoid"], "comments": [{"owner": {"reputation": 14407, "user_id": 3035830, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14809f2ad7f14e2867798697ab8f8006?s=128&d=identicon&r=PG", "display_name": "shivam", "link": "https://stackoverflow.com/users/3035830/shivam"}, "edited": false, "score": 0, "creation_date": 1456312175, "post_id": 35600163, "comment_id": 58885514, "body": "how are you getting your response?"}, {"owner": {"reputation": 194, "user_id": 1716412, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4CsHP.jpg?s=128&g=1", "display_name": "Ayrton Werck", "link": "https://stackoverflow.com/users/1716412/ayrton-werck"}, "reply_to_user": {"reputation": 14407, "user_id": 3035830, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14809f2ad7f14e2867798697ab8f8006?s=128&d=identicon&r=PG", "display_name": "shivam", "link": "https://stackoverflow.com/users/3035830/shivam"}, "edited": false, "score": 0, "creation_date": 1456312270, "post_id": 35600163, "comment_id": 58885599, "body": "I am using a get on /api/v1/users and returning User.first"}], "answers": [{"tags": [], "owner": {"reputation": 1982, "user_id": 1957674, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b9fa3c9e811e22d933f19f24e8a6797d?s=128&d=identicon&r=PG", "display_name": "BinaryMee", "link": "https://stackoverflow.com/users/1957674/binarymee"}, "is_accepted": false, "score": 2, "last_activity_date": 1456314908, "last_edit_date": 1456314908, "creation_date": 1456313225, "answer_id": 35600885, "question_id": 35600163, "link": "https://stackoverflow.com/questions/35600163/how-to-include-sub-object-in-json-response/35600885#35600885", "title": "How to include sub-object in json response", "body": "<p>You'll get the JSON that represents User alone if you don't include the Role as well. You can do something like below</p>\n\n<pre><code>def index\n  @user = User.first\n  respond_with(@user, :include =&gt; :role)\nend\n</code></pre>\n\n<p>Old school way would be,</p>\n\n<pre><code>def index\n  @user = User.first\n  respond_to do |format|\n    format.json { render :json =&gt; @user.to_json(:include =&gt; :role) }\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 148, "user_id": 5940546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2519c9b2300f3f7b7af535a188f4bbf3?s=128&d=identicon&r=PG&f=1", "display_name": "Rndomcoder", "link": "https://stackoverflow.com/users/5940546/rndomcoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1456313424, "creation_date": 1456313424, "answer_id": 35600959, "question_id": 35600163, "link": "https://stackoverflow.com/questions/35600163/how-to-include-sub-object-in-json-response/35600959#35600959", "title": "How to include sub-object in json response", "body": "<p>Add gem 'active_model_serializers' to your gemfile if you are not already using it . Then generate an user serializer using</p>\n\n<pre><code>rails generate serializer user\n</code></pre>\n\n<p>Then add following to app/serializers/user_serializer.rb file.</p>\n\n<pre><code>class UserSerializer &lt; ActiveModel::Serializer\n  attributes :id, :email,:name, :password_digest, :promotion_ids, :api_key\n  has_many :roles\nend\n</code></pre>\n"}], "owner": {"reputation": 194, "user_id": 1716412, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4CsHP.jpg?s=128&g=1", "display_name": "Ayrton Werck", "link": "https://stackoverflow.com/users/1716412/ayrton-werck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 35600959, "answer_count": 2, "score": 0, "last_activity_date": 1456314908, "creation_date": 1456311420, "last_edit_date": 1456312397, "question_id": 35600163, "link": "https://stackoverflow.com/questions/35600163/how-to-include-sub-object-in-json-response", "title": "How to include sub-object in json response", "body": "<p>Hi I am trying to include the roles of a user when rendering json doing User.all\nI am using ruby on rails and Mongoid</p>\n\n<p>I only get the role_id in my response...</p>\n\n<pre><code>role_id\":\"56cb596bc226cb5c04efd1cb\n</code></pre>\n\n<p>User model:</p>\n\n<pre><code>class User\n  include Mongoid::Document\n  include ActiveModel::SecurePassword\n\n  has_many :role\n  belongs_to :store\n  has_many :orders\n</code></pre>\n\n<p>Role model:</p>\n\n<pre><code>class Role\n  include Mongoid::Document\n\n  belongs_to :user\n\n  field :name, type: String\n  field :active, type: Mongoid::Boolean\n</code></pre>\n\n<p>the response I get:</p>\n\n<pre><code>    {\"_id\":\"...\",\"api_key\":\"...\",\"email\":\"jesus@drinkz.io\",\"name\":\"... Garcia\",\"password_digest\":\"...\",\"promotion_ids\":[],\n\"role_id\":\"56cb596bc226cb5c04efd1cb\"}\n</code></pre>\n\n<p>How I get the response: GET /api/v1/users</p>\n\n<pre><code>def index\n    @user = User.first\n    respond_with @user\n  end\n</code></pre>\n\n<p>How can I embed roles in the response ?</p>\n"}, {"tags": ["ruby", "hash", "replace"], "answers": [{"comments": [{"owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "edited": false, "score": 1, "creation_date": 1456311284, "post_id": 35599986, "comment_id": 58884818, "body": "That is exactly what I was looking for! thank you so much. I want to name this question better. I feel that people will want to at some stage do this. how could I improve it? I was going to use replace hash key with another hash value. but there is a replace method that will do terrible things."}, {"owner": {"reputation": 8771, "user_id": 2050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2d1e9a607c47a89730352dd7b9dacaab?s=128&d=identicon&r=PG", "display_name": "Eric Platon", "link": "https://stackoverflow.com/users/2050/eric-platon"}, "edited": false, "score": 0, "creation_date": 1456313779, "post_id": 35599986, "comment_id": 58886693, "body": "Note that <code>Array#to_h</code> is available from Ruby 2.1."}], "tags": [], "owner": {"reputation": 60090, "user_id": 188031, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/p2YIF.jpg?s=128&g=1", "display_name": "tokland", "link": "https://stackoverflow.com/users/188031/tokland"}, "is_accepted": true, "score": 2, "last_activity_date": 1456311246, "last_edit_date": 1456311246, "creation_date": 1456310925, "answer_id": 35599986, "question_id": 35599830, "link": "https://stackoverflow.com/questions/35599830/ruby-swap-out-hash-key-with-matching-value-from-other-hash/35599986#35599986", "title": "Ruby: Swap out hash key with matching value from other hash", "body": "<p>First, an \"array-comprehension\" with the pattern <code>enumerable.map { expr if condition }.compact</code> and finally an <code>Array#to_h</code>.</p>\n\n<pre><code>h = other_hash.map { |k, v| [v, hash[k]] if hash.has_key?(k) }.compact.to_h\n#=&gt; {\"dave\"=&gt;\"popcorn\", \"linda\"=&gt;\"soda\"}\n</code></pre>\n\n<p>Also:</p>\n\n<pre><code>h = other_hash.select { |k, v| hash.has_key?(k) }.map { |k, v| [v, hash[k]] }.to_h\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "is_accepted": false, "score": 3, "last_activity_date": 1456311594, "creation_date": 1456311594, "answer_id": 35600227, "question_id": 35599830, "link": "https://stackoverflow.com/questions/35599830/ruby-swap-out-hash-key-with-matching-value-from-other-hash/35600227#35600227", "title": "Ruby: Swap out hash key with matching value from other hash", "body": "<p>You can easly use this <code>each_with_object</code> method on \"primary\" hash with names.</p>\n\n<pre><code>other_hash.each_with_object({}) { |(id, name), h| h[name] = hash[id] if hash.key?(id) }\n# =&gt; {\"dave\"=&gt;\"popcorn\", \"linda\"=&gt;\"soda\"}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1456311935, "post_id": 35600282, "comment_id": 58885320, "body": "In lower ruby versions use <code>Hash[hash.map{|k, v| [other_hash[k], v]}]</code>"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1456311728, "creation_date": 1456311728, "answer_id": 35600282, "question_id": 35599830, "link": "https://stackoverflow.com/questions/35599830/ruby-swap-out-hash-key-with-matching-value-from-other-hash/35600282#35600282", "title": "Ruby: Swap out hash key with matching value from other hash", "body": "<pre><code>hash.map{|k, v| [other_hash[k], v]}.to_h\n# =&gt; {\"dave\"=&gt;\"popcorn\", \"linda\"=&gt;\"soda\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 3, "last_activity_date": 1456311813, "creation_date": 1456311813, "answer_id": 35600325, "question_id": 35599830, "link": "https://stackoverflow.com/questions/35599830/ruby-swap-out-hash-key-with-matching-value-from-other-hash/35600325#35600325", "title": "Ruby: Swap out hash key with matching value from other hash", "body": "<pre><code>hash.each_with_object({}){|(k,v), res| res[other_hash[k]] = v}\n# =&gt; {\"dave\"=&gt;\"popcorn\", \"linda\"=&gt;\"soda\"}\n</code></pre>\n"}], "owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 35599986, "answer_count": 4, "score": 2, "last_activity_date": 1456312466, "creation_date": 1456310545, "last_edit_date": 1456312466, "question_id": 35599830, "link": "https://stackoverflow.com/questions/35599830/ruby-swap-out-hash-key-with-matching-value-from-other-hash", "title": "Ruby: Swap out hash key with matching value from other hash", "body": "<p>I have these hashes: </p>\n\n<pre><code>hash  = {1 =&gt; \"popcorn\", 2 =&gt; \"soda\"}\nother_hash = {1 =&gt; \"dave\", 2 =&gt; \"linda\", 3 =&gt; \"bobby_third_wheel\"}\n</code></pre>\n\n<p>I would like to replace the id reference with the name associated to the id in the second hash, if there is a record in <code>other_hash</code> that has nothing to match, it should just be dropped in the resulting hash. Like this:</p>\n\n<pre><code>the_one_hash_to_rule_them_all = {\"dave\" =&gt; \"popcorn\", \"linda\" =&gt; \"soda\"}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "postgresql", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 3033, "user_id": 2919292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mgIC.jpg?s=128&g=1", "display_name": "AlexM", "link": "https://stackoverflow.com/users/2919292/alexm"}, "edited": false, "score": 0, "creation_date": 1456309108, "post_id": 35599143, "comment_id": 58883282, "body": "I am not familiar with RoR, but in SQL I believe you have to join <code>codes</code>  table three times. Please, correct me if I am wrong."}, {"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "reply_to_user": {"reputation": 3033, "user_id": 2919292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mgIC.jpg?s=128&g=1", "display_name": "AlexM", "link": "https://stackoverflow.com/users/2919292/alexm"}, "edited": false, "score": 0, "creation_date": 1456309608, "post_id": 35599143, "comment_id": 58883647, "body": "@pumbo you are, you can do one join and specify the condition of the codes n_code being 2, 3 or 5."}, {"owner": {"reputation": 3033, "user_id": 2919292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mgIC.jpg?s=128&g=1", "display_name": "AlexM", "link": "https://stackoverflow.com/users/2919292/alexm"}, "reply_to_user": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1456309740, "post_id": 35599143, "comment_id": 58883756, "body": "@j-dexx give me an example in plain SQL, please"}, {"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "reply_to_user": {"reputation": 3033, "user_id": 2919292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mgIC.jpg?s=128&g=1", "display_name": "AlexM", "link": "https://stackoverflow.com/users/2919292/alexm"}, "edited": false, "score": 0, "creation_date": 1456309851, "post_id": 35599143, "comment_id": 58883836, "body": "@pumbo I see what you meant now.  I thought you meant active records <code>.join</code> because of rails associations rails is smart enough to automatically to perform the join on company codes and then codes for you."}, {"owner": {"reputation": 22670, "user_id": 1818688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4101971078c6b3e99b86cd67492319df?s=128&d=identicon&r=PG", "display_name": "Igor Romanchenko", "link": "https://stackoverflow.com/users/1818688/igor-romanchenko"}, "edited": false, "score": 0, "creation_date": 1456326190, "post_id": 35599143, "comment_id": 58895814, "body": "you can use <code>array_agg</code> to gel a list of codes for every company and then filter for arrays that contain <code>[2,3,5]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "edited": false, "score": 0, "creation_date": 1456310858, "post_id": 35599583, "comment_id": 58884536, "body": "I want companies that have code [2,3,5] not only 2. Your answer will give me companies with code 2."}, {"owner": {"reputation": 5014, "user_id": 3640770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HJBjs.jpg?s=128&g=1", "display_name": "IngoAlbers", "link": "https://stackoverflow.com/users/3640770/ingoalbers"}, "reply_to_user": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "edited": false, "score": 0, "creation_date": 1456311066, "post_id": 35599583, "comment_id": 58884669, "body": "This should not be the case. Did you test the code and read the whole explanation?"}, {"owner": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "edited": false, "score": 0, "creation_date": 1456311244, "post_id": 35599583, "comment_id": 58884793, "body": ".having(&#39;count(*) = ?&#39;, required_codes.count) - please explain these. I have read your explanation. but your code doesn&#39;t give me any result."}, {"owner": {"reputation": 5014, "user_id": 3640770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HJBjs.jpg?s=128&g=1", "display_name": "IngoAlbers", "link": "https://stackoverflow.com/users/3640770/ingoalbers"}, "reply_to_user": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "edited": false, "score": 0, "creation_date": 1456311312, "post_id": 35599583, "comment_id": 58884836, "body": "In your case it means that the group should have the same count as the required_codes array, which is 3."}, {"owner": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "edited": false, "score": 0, "creation_date": 1456311435, "post_id": 35599583, "comment_id": 58884936, "body": "Company.joins(:codes)        .where(codes: { n_code: required_codes }) -&gt; this result 56 companies . but after group by company id with code count = 3 . it results none. But company is available that have 3 codes."}, {"owner": {"reputation": 5014, "user_id": 3640770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HJBjs.jpg?s=128&g=1", "display_name": "IngoAlbers", "link": "https://stackoverflow.com/users/3640770/ingoalbers"}, "reply_to_user": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "edited": false, "score": 0, "creation_date": 1456311570, "post_id": 35599583, "comment_id": 58885049, "body": "What does it return if you just do the group without the having?"}, {"owner": {"reputation": 5014, "user_id": 3640770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HJBjs.jpg?s=128&g=1", "display_name": "IngoAlbers", "link": "https://stackoverflow.com/users/3640770/ingoalbers"}, "reply_to_user": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "edited": false, "score": 0, "creation_date": 1456311961, "post_id": 35599583, "comment_id": 58885344, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/104395/discussion-between-ingoalbers-and-shefalee-chaudhary\">continue this discussion in chat</a>."}, {"owner": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "edited": false, "score": 0, "creation_date": 1456311978, "post_id": 35599583, "comment_id": 58885359, "body": "It returns same result as Company.joins(:codes) .where(codes: { n_code: required_codes })  this query"}], "tags": [], "owner": {"reputation": 5014, "user_id": 3640770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HJBjs.jpg?s=128&g=1", "display_name": "IngoAlbers", "link": "https://stackoverflow.com/users/3640770/ingoalbers"}, "is_accepted": false, "score": 1, "last_activity_date": 1456309865, "creation_date": 1456309865, "answer_id": 35599583, "question_id": 35599143, "link": "https://stackoverflow.com/questions/35599143/postgres-database-query-to-filter-active-record-result/35599583#35599583", "title": "Postgres database query to filter active record result", "body": "<p>You could do something like this:</p>\n\n<pre><code>required_codes = [2, 3, 5]\n\nCompany.joins(:codes)\n       .where(codes: { n_code: required_codes })\n       .group('companies.id')\n       .having('count(*) = ?', required_codes.count)\n</code></pre>\n\n<p>Maybe your group clause has to look a bit different depending on your table and field naming.</p>\n\n<p>What it does is:</p>\n\n<ul>\n<li>Get all companies that have codes</li>\n<li>which contain one of the required codes</li>\n<li>Group them, so that we have for example a group of 3 when the article has the codes 2, 3, 5, or just a group of 2 when the article has the tags 2, 3 and 6.</li>\n<li>Then only take those groups with as many members as specified in our required codes array.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "is_accepted": false, "score": 0, "last_activity_date": 1456323443, "creation_date": 1456323443, "answer_id": 35604599, "question_id": 35599143, "link": "https://stackoverflow.com/questions/35599143/postgres-database-query-to-filter-active-record-result/35604599#35604599", "title": "Postgres database query to filter active record result", "body": "<p>Let do the query like this:</p>\n\n<pre><code>required_codes = [2, 3, 5]\n\nsub_query = %Q{\n  SELECT company_codes.company_id\n  FROM company_codes\n  JOIN codes\n  ON codes.id = company_codes.code_id\n  WHERE codes.n_code IN (#{required_codes.join(',')})\n  GROUP BY company_codes.company_id\n  HAVING COUNT(DISTINCT codes.n_code) = #{required_codes.size}\n}\n\nCompany.where(\"id IN (#{sub_query})\"\n</code></pre>\n\n<p>Explanation:</p>\n\n<ul>\n<li>The <code>sub_query</code> just gets the <code>company_id</code> which has all <code>required_codes</code> and the distinct codes after grouping must equal the <code>required_codes</code></li>\n<li>After having <code>company_id</code>, we can easily query <code>Company</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 3033, "user_id": 2919292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mgIC.jpg?s=128&g=1", "display_name": "AlexM", "link": "https://stackoverflow.com/users/2919292/alexm"}, "is_accepted": true, "score": 2, "last_activity_date": 1456394181, "creation_date": 1456394181, "answer_id": 35623884, "question_id": 35599143, "link": "https://stackoverflow.com/questions/35599143/postgres-database-query-to-filter-active-record-result/35623884#35623884", "title": "Postgres database query to filter active record result", "body": "<p>None of the previous answers is accurate. If you need to get records that have all specified values, but not only some of the values, you don't need to use <code>WHERE n_code IN (2,3,5)</code> condition, because it will get all records that have at least one of the values, but not all of them at the same time. Also, additional condition <code>HAVING count(codes.n_code) = 3</code>, as suggested earlier, is not a solution, as it does not guarantee that these 3 values are actually 2, 3 and 5.</p>\n\n<p>I am not good at Ruby, so I will give you an example in plain SQL how you can get records that have all of the values:</p>\n\n<pre><code>SELECT company_codes.company_id\nFROM company_codes\nJOIN codes ON codes.id = company_codes.code_id\nGROUP BY company_codes.company_id\nHAVING array_agg(codes.n_code) @&gt; ARRAY[2, 3, 5]\n</code></pre>\n\n<p>How it works: in <code>HAVING</code> section you aggregate all <code>n_code</code> values for a company into an array (note that the query is grouped by a company) and check that it contains the array on the right (contains all of its values).</p>\n"}], "owner": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "accepted_answer_id": 35623884, "answer_count": 3, "score": 2, "last_activity_date": 1456394181, "creation_date": 1456308745, "last_edit_date": 1456308859, "question_id": 35599143, "link": "https://stackoverflow.com/questions/35599143/postgres-database-query-to-filter-active-record-result", "title": "Postgres database query to filter active record result", "body": "<p>I have three tables</p>\n\n<ol>\n<li>Company</li>\n<li>Code</li>\n<li>CompanyCode [join table] - to store company codes</li>\n</ol>\n\n<p>Now, I want to find records for companies who have code 2,3 and 5 only.</p>\n\n<p>I am trying with </p>\n\n<pre><code>Comapny.joins(:codes).where('codes.n_code' IN ? , [2,3,5])\n</code></pre>\n\n<p>but it will result all companies with only <code>n_code = 2</code> or <code>n_code = 3</code> or <code>n_code = 5</code>.</p>\n\n<p>I want companies with <code>n_code</code> <code>2</code>,<code>3</code> and <code>5</code> with all these three values.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "hash"], "comments": [{"owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "edited": false, "score": 0, "creation_date": 1456332979, "post_id": 35599032, "comment_id": 58900812, "body": "If the engine table is in the same database as the main app you should still be able to join to it. Just because the models are defined in an engine, doesn&#39;t mean you can&#39;t access them and their data."}, {"owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "reply_to_user": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "edited": false, "score": 0, "creation_date": 1456386289, "post_id": 35599032, "comment_id": 58924719, "body": "Yeah the only problem with building it like that is when we eventually separate this engine to a micro-service it will be tightly coupled to the main application. I guess if the data is so tightly coupled I should talk to everyone about pulling this into the main application."}], "owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1456309433, "creation_date": 1456308444, "last_edit_date": 1456309433, "question_id": 35599032, "link": "https://stackoverflow.com/questions/35599032/ruby-comparing-hashes-built-from-non-associated-models", "title": "Ruby comparing hashes built from non-associated models", "body": "<p>I am trying to compare hashes, they reference a complex set of associations. Payments are managed by an engine within the app so there is no <code>belongs_to:</code> / <code>has_many:</code> relationships between it and users(which is on the main application). However i can pull user from the main app using a service.</p>\n\n<p>I have a Payments table - in engine</p>\n\n<pre><code># Table name: payments\n#\n#  id                      :integer          not null, primary key\n#  account_id              :integer\n#  currency                :string(255)\n....\n</code></pre>\n\n<p>The Account table just maps users to accounts - in engine</p>\n\n<pre><code># Table name: account\n#\n#  id                      :integer          not null, primary key\n#  user_id                 :integer\n....\n</code></pre>\n\n<p>The User table also has a column for currency, this is to mark what currency he opted to pay in during the sign-up phase.</p>\n\n<pre><code># Table name: user\n#\n#  id                      :integer          not null, primary key\n#  currency                :string(255)\n....\n</code></pre>\n\n<p>We have an issue where sometimes users pay in different currencies, I would like to build a hash where <code>:payment_id =&gt; true/false</code>(where this would be user.currency == payment.currency), something where i can count the offences I was thinking of saving the payment_id just incase they wanted detailed error data.</p>\n\n<p>What I ended up doing was.</p>\n\n<ol>\n<li>Building a <code>payments Hash</code> with <code>account_id: currency</code></li>\n<li>Building a <code>accounts Hash</code> using only account_ids found in step 1 <code>id: user_id</code></li>\n<li>Rebuilding the payments hash by replacing account_id: with user_id:</li>\n<li>Building a <code>users Hash</code> with <code>users_id: currency</code></li>\n<li>Iterating through each user_id and ticking a counter when payment_hash[user_id] != user_hash[user_id]</li>\n</ol>\n\n<p>looks something like this</p>\n\n<pre><code>def inconsistancy_count(payments)\n  #list of account ids involved with the payments made\n  matching_account_ids = Recon::Account.where(account_id: payments).map(&amp;:id)\n\n  # list of users that are attached to those accounts above\n  user_ids = Recon:Account.where(account_id: matching_account_ids).map(&amp;:user_id)\n\n  # Payment hash mapping account_id and currency\n  payment_currency_hash = Recon::Payment.where(account_id: matching_account_ids).reduce({}) {|hash, payment| hash.merge(payment.account_id =&gt; payment.currency)}\n\n  #build a hash using the user service.\n  main_app_user_currency_hash = Recon.user_service.get_user_info_from_ids(user_ids)\n\n  inconsistancy_count = 0\n  matching_user_ids.each do |user|\n    inconsistancy_count += 1 if main_app_user_currency_hash[user] != payment_currency_hash[user]\n  end\n  inconsistancy_count\nend\n</code></pre>\n\n<p>The above won't work because the payments hash is still based off account_id and not user_id.</p>\n\n<p>I feel my route is very round about it seems as if this method has a ton of things it should do. Is there a better way of accomplishing this </p>\n"}, {"tags": ["ruby", "linux", "command-line", "terminal"], "comments": [{"owner": {"reputation": 437, "user_id": 1645408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c4a0b3d480fc14181f6818568fe32f?s=128&d=identicon&r=PG", "display_name": "abookyun", "link": "https://stackoverflow.com/users/1645408/abookyun"}, "edited": false, "score": 0, "creation_date": 1456307983, "post_id": 35598580, "comment_id": 58882421, "body": "I use gem pry-rails and the results just as you wanted, isn&#39;t it?"}, {"owner": {"reputation": 14407, "user_id": 3035830, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14809f2ad7f14e2867798697ab8f8006?s=128&d=identicon&r=PG", "display_name": "shivam", "link": "https://stackoverflow.com/users/3035830/shivam"}, "edited": false, "score": 0, "creation_date": 1456308428, "post_id": 35598580, "comment_id": 58882749, "body": "@vinibol12 did you try my solution?&quot;"}, {"owner": {"reputation": 426, "user_id": 3584767, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/c6aSe.jpg?s=128&g=1", "display_name": "vinibol12", "link": "https://stackoverflow.com/users/3584767/vinibol12"}, "reply_to_user": {"reputation": 437, "user_id": 1645408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c4a0b3d480fc14181f6818568fe32f?s=128&d=identicon&r=PG", "display_name": "abookyun", "link": "https://stackoverflow.com/users/1645408/abookyun"}, "edited": false, "score": 0, "creation_date": 1456308649, "post_id": 35598580, "comment_id": 58882933, "body": "@abookyun I haven&#39;t yet. I am working on a project and I didn&#39;t want to install a gem only for this. Say I don&#39;t want to keep afterwards can I remove the gem and leave no trace of it if I do it before committing?  It&#39;s my first job and I don&#39;t want to mess up with the repository."}], "answers": [{"comments": [{"owner": {"reputation": 426, "user_id": 3584767, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/c6aSe.jpg?s=128&g=1", "display_name": "vinibol12", "link": "https://stackoverflow.com/users/3584767/vinibol12"}, "edited": false, "score": 0, "creation_date": 1456308166, "post_id": 35598789, "comment_id": 58882547, "body": "should it run fine from the Rails console? It still returns the object all on the same line. See added code in the question"}], "tags": [], "owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "is_accepted": false, "score": 0, "last_activity_date": 1456310070, "last_edit_date": 1456310070, "creation_date": 1456307859, "answer_id": 35598789, "question_id": 35598580, "link": "https://stackoverflow.com/questions/35598580/how-to-display-each-objects-attribute-in-a-different-line-for-readability-in-th/35598789#35598789", "title": "How to display each object&#39;s attribute in a different line for readability in the Command Line using Ruby language?", "body": "<p>You can use the <a href=\"http://ruby-doc.org/stdlib-2.3.0/libdoc/pp/rdoc/PP.html\" rel=\"nofollow\">PrettyPrint</a> standard library included in Ruby.</p>\n\n<pre><code>require 'pp'\n\nh = {mula: 'khao', alu: 'khamu na', lorem: 'You can use the PrettyPrint standard library included in Ruby.'}\n\npp h\n#=&gt; {:mula=&gt;\"khao\",\n# :alu=&gt;\"khamu na\",\n# :lorem=&gt;\"You can use the PrettyPrint standard library included in Ruby.\"}\n</code></pre>\n\n<p>Or if you want more control, like color, indent etc, you can try <a href=\"https://github.com/michaeldv/awesome_print\" rel=\"nofollow\">awesome print</a> gem.</p>\n\n<p>Update, with <code>Struct</code>:</p>\n\n<pre><code>[1] pry(main)&gt; Customer = Struct.new(:mula, :alu, :lorem)\n=&gt; Customer\n[2] pry(main)&gt; a = Customer.new('khao', 'khamu na', 'You can use the PrettyPrint standard library included in Ruby.')\n=&gt; #&lt;struct Customer mula=\"khao\", alu=\"khamu na\", lorem=\"You can use the PrettyPrint standard library included in Ruby.\"&gt;\n[3] pry(main)&gt; pp a\n#&lt;struct Customer\n mula=\"khao\",\n alu=\"khamu na\",\n lorem=\"You can use the PrettyPrint standard library included in Ruby.\"&gt;\n=&gt; #&lt;struct Customer mula=\"khao\", alu=\"khamu na\", lorem=\"You can use the PrettyPrint standard library included in Ruby.\"&gt;\n[4] pry(main)&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14407, "user_id": 3035830, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14809f2ad7f14e2867798697ab8f8006?s=128&d=identicon&r=PG", "display_name": "shivam", "link": "https://stackoverflow.com/users/3035830/shivam"}, "is_accepted": false, "score": 0, "last_activity_date": 1456308519, "last_edit_date": 1456308519, "creation_date": 1456307963, "answer_id": 35598829, "question_id": 35598580, "link": "https://stackoverflow.com/questions/35598580/how-to-display-each-objects-attribute-in-a-different-line-for-readability-in-th/35598829#35598829", "title": "How to display each object&#39;s attribute in a different line for readability in the Command Line using Ruby language?", "body": "<p>If you are on Rails pretty print object <a href=\"http://apidock.com/rails/ActiveRecord/Base/attributes%3D\" rel=\"nofollow\"><code>attributes</code></a>:</p>\n\n<pre><code>pp job.subscription.attributes\n</code></pre>\n\n<p>or similarly:</p>\n\n<pre><code>pp job.attributes\n</code></pre>\n\n<p>otherwise you can convert the object to Hash and pretty print it using <code>pp</code>.</p>\n"}], "owner": {"reputation": 426, "user_id": 3584767, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/c6aSe.jpg?s=128&g=1", "display_name": "vinibol12", "link": "https://stackoverflow.com/users/3584767/vinibol12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456310070, "creation_date": 1456307294, "last_edit_date": 1456308280, "question_id": 35598580, "link": "https://stackoverflow.com/questions/35598580/how-to-display-each-objects-attribute-in-a-different-line-for-readability-in-th", "title": "How to display each object&#39;s attribute in a different line for readability in the Command Line using Ruby language?", "body": "<p>Is there a method or command that I could call to make an object more readable in the command line? \nSomething where I could display this: </p>\n\n<pre><code>[6] pry(main)&gt; job.subscription\n=&gt; #&lt;Subscription id: 21, frequency: 0, user_id: 88, created_at: \"2016-02-24 09:34:46\", updated_at: \"2016-02-24 09:34:47\", customer_note_security: \"I generally just leave the door wide open\", customer_note_cleaning: \"Please clean the cat too\", merchant_id: nil, deleted_at: nil, repeat_reminder_sent_at: nil, store_id: nil, next_job_date: nil, subscription_application_id: nil, hourly_price: nil&gt;\n</code></pre>\n\n<p>like this</p>\n\n<pre><code>[6] pry(main)&gt; job.subscription\n=&gt; #&lt;Subscription id: 21,\nfrequency: 0, \nuser_id: 88,\ncreated_at: \"2016-02-24 09:34:46\", \nupdated_at: \"2016-02-24 09:34:47\", \ncustomer_note_security: \"I generally just leave the door wide open\", \ncustomer_note_cleaning: \"Please clean the cat too\", \nmerchant_id: nil, \ndeleted_at: nil, \nrepeat_reminder_sent_at: nil, \nstore_id: nil, \nnext_job_date: nil,\nsubscription_application_id: nil,\nhourly_price: nil&gt;\n</code></pre>\n\n<p>Using pp </p>\n\n<pre><code>[36] pry(main)&gt; pp job\n#&lt;Job id: 23, subtotal: #&lt;BigDecimal:7fbf644986c8,'0.0',9(18)&gt;, hours: #&lt;BigDecimal:7fbf644989c0,'0.0',9(18)&gt;, subscription_id: 22, address_id: 37, state: \"unpaid\", date: \"2016-02-27\", time_preferences: \"MyString\", type: nil, region: \"auckland\", items: [], options: {}, created_at: \"2016-02-24 09:59:52\", updated_at: \"2016-02-24 09:59:52\", merchant_id: nil, notes: nil, deleted_at: nil, merchant_rate: nil, canceled: false, start_time: nil, end_time: nil, grand_total: #&lt;BigDecimal:7fbf64498538,'0.0',9(18)&gt;, redemption_code_id: nil, discount_total: #&lt;BigDecimal:7fbf64498010,'0.0',9(27)&gt;, payment_notification_sent_at: nil, last_payment_attempt_at: nil, store_id: nil, merchant_received_notification_at: nil, customer_balance: #&lt;BigDecimal:7fbf5af0b3a8,'0.0',9(18)&gt;, promotional_credit_applied: #&lt;BigDecimal:7fbf64438278,'0.0',9(18)&gt;, spawned_by_cron: false, initial_assignment_notification_received_at: nil&gt;\n=&gt; #&lt;Job id: 23, subtotal: #&lt;BigDecimal:7fbf644986c8,'0.0',9(18)&gt;, hours: #&lt;BigDecimal:7fbf644989c0,'0.0',9(18)&gt;, subscription_id: 22, address_id: 37, state: \"unpaid\", date: \"2016-02-27\", time_preferences: \"MyString\", type: nil, region: \"auckland\", items: [], options: {}, created_at: \"2016-02-24 09:59:52\", updated_at: \"2016-02-24 09:59:52\", merchant_id: nil, notes: nil, deleted_at: nil, merchant_rate: nil, canceled: false, start_time: nil, end_time: nil, grand_total: #&lt;BigDecimal:7fbf64498538,'0.0',9(18)&gt;, redemption_code_id: nil, discount_total: #&lt;BigDecimal:7fbf64498010,'0.0',9(27)&gt;, payment_notification_sent_at: nil, last_payment_attempt_at: nil, store_id: nil, merchant_received_notification_at: nil, customer_balance: #&lt;BigDecimal:7fbf5af0b3a8,'0.0',9(18)&gt;, promotional_credit_applied: #&lt;BigDecimal:7fbf64438278,'0.0',9(18)&gt;, spawned_by_cron: false, initial_assignment_notification_received_at: nil&gt;\n[37] pry(main)&gt; \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "simple-form", "simple-form-for"], "answers": [{"comments": [{"owner": {"reputation": 436, "user_id": 5757634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d29af3df3533eee17e2fcae9fb452fe6?s=128&d=identicon&r=PG&f=1", "display_name": "Rubioli", "link": "https://stackoverflow.com/users/5757634/rubioli"}, "edited": false, "score": 0, "creation_date": 1456307956, "post_id": 35598678, "comment_id": 58882404, "body": "I am not familier how to make the hidden_field encrypted. But in simple_form_for, how can i make the checkbox uncheck and check?"}, {"owner": {"reputation": 16234, "user_id": 2202702, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lTGWe.jpg?s=128&g=1", "display_name": "Arslan Ali", "link": "https://stackoverflow.com/users/2202702/arslan-ali"}, "reply_to_user": {"reputation": 436, "user_id": 5757634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d29af3df3533eee17e2fcae9fb452fe6?s=128&d=identicon&r=PG&f=1", "display_name": "Rubioli", "link": "https://stackoverflow.com/users/5757634/rubioli"}, "edited": false, "score": 0, "creation_date": 1456308157, "post_id": 35598678, "comment_id": 58882541, "body": "What do you mean by <b>how can i make the checkbox uncheck and check?</b>"}, {"owner": {"reputation": 436, "user_id": 5757634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d29af3df3533eee17e2fcae9fb452fe6?s=128&d=identicon&r=PG&f=1", "display_name": "Rubioli", "link": "https://stackoverflow.com/users/5757634/rubioli"}, "edited": false, "score": 0, "creation_date": 1456308330, "post_id": 35598678, "comment_id": 58882671, "body": "I want to use use hidden:field now and the <b>:status</b>  filed is already <b>true</b> and I want it to be <b>false</b> and <b>: successful_ad</b> is <b>null</b> and I want it to be <b>true</b>, I have tried <code>checked: true</code> &amp; <code>checked: false</code>, but no luck..."}, {"owner": {"reputation": 16234, "user_id": 2202702, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lTGWe.jpg?s=128&g=1", "display_name": "Arslan Ali", "link": "https://stackoverflow.com/users/2202702/arslan-ali"}, "reply_to_user": {"reputation": 436, "user_id": 5757634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d29af3df3533eee17e2fcae9fb452fe6?s=128&d=identicon&r=PG&f=1", "display_name": "Rubioli", "link": "https://stackoverflow.com/users/5757634/rubioli"}, "edited": false, "score": 0, "creation_date": 1456309807, "post_id": 35598678, "comment_id": 58883806, "body": "Please show me your code by editing your question, and putting it there."}], "tags": [], "owner": {"reputation": 16234, "user_id": 2202702, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lTGWe.jpg?s=128&g=1", "display_name": "Arslan Ali", "link": "https://stackoverflow.com/users/2202702/arslan-ali"}, "is_accepted": true, "score": 0, "last_activity_date": 1456310256, "last_edit_date": 1456310256, "creation_date": 1456307565, "answer_id": 35598678, "question_id": 35598557, "link": "https://stackoverflow.com/questions/35598557/ruby-on-rails-4-passing-params-in-simple-form-for-when-clicking-submit-button/35598678#35598678", "title": "Ruby on Rails 4- Passing params in Simple_form_for when clicking submit button", "body": "<p>Sure, the safest way to always use server side code for it. But you need to know when it has to happen, and this is something that comes from client end.</p>\n\n<p>You can use <code>after_save</code> or <code>after_update</code>, and can do the work there. But not every <code>save</code> or <code>update</code> action would need this; only a few may need this. So you need to have a hidden field in your form, and but you can encrypt the content of that, and then, on server side, you can do the certain task in your callback if you received that encrypted key.</p>\n\n<p>An end user would always have the power to change the contents of hidden field, so now it's up to you to use an encrypted key, and a column name that a user wouldn't be able to break through.</p>\n\n<p>Edit: for what you asked, you can do following:</p>\n\n<pre><code>= f.input :status, :input_html =&gt; { :checked =&gt; false, value: 'Your desired value'}\n</code></pre>\n"}], "owner": {"reputation": 436, "user_id": 5757634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d29af3df3533eee17e2fcae9fb452fe6?s=128&d=identicon&r=PG&f=1", "display_name": "Rubioli", "link": "https://stackoverflow.com/users/5757634/rubioli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 35598678, "answer_count": 1, "score": 1, "last_activity_date": 1456310256, "creation_date": 1456307224, "last_edit_date": 1456309916, "question_id": 35598557, "link": "https://stackoverflow.com/questions/35598557/ruby-on-rails-4-passing-params-in-simple-form-for-when-clicking-submit-button", "title": "Ruby on Rails 4- Passing params in Simple_form_for when clicking submit button", "body": "<p>I have a <code>simple_form_for</code> <em>(I can also use <code>simple_form</code> if easiest)</em> that I want to pass/update 3 params. 1 of them is \"user-generated\", while 2 others needs to be insert/update in db \"automatically\".</p>\n\n<p>Here is my current form:</p>\n\n<pre><code>= simple_form_for @request do |f|\n  = f.collection_select :partner_id, @partners, :id, :full_name,  {prompt: \"Select a user\"}\n  = f.input :successful_ad, checked: true, value: true\n  = f.input :status, checked: false, value: 0\n  = f.submit \"I have excepted\"\n</code></pre>\n\n<p>What I am looking for is user can choose a <code>:partner_id</code> from <code>collection_select</code>, while I need to insert/update <code>:successful_ad =&gt; true</code> and <code>:status =&gt; false</code>.</p>\n\n<p>I don't want to use <strong>hidden_field</strong> since it can be manipulated and safest way is to process them in background.</p>\n\n<p><em>PS: reason I can't pass these params in edit/update actions is since I have this form in show action and is separated.</em></p>\n"}, {"tags": ["arrays", "ruby", "hashmap"], "comments": [{"owner": {"reputation": 2634, "user_id": 1210949, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vAL35.jpg?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/1210949/albin"}, "edited": false, "score": 0, "creation_date": 1456307121, "post_id": 35598461, "comment_id": 58881852, "body": "Break it up into smaller methods that is easier to relate to."}, {"owner": {"reputation": 6363, "user_id": 2837813, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/5Xggf.png?s=128&g=1", "display_name": "ProGM", "link": "https://stackoverflow.com/users/2837813/progm"}, "reply_to_user": {"reputation": 2634, "user_id": 1210949, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vAL35.jpg?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/1210949/albin"}, "edited": false, "score": 0, "creation_date": 1456307521, "post_id": 35598461, "comment_id": 58882108, "body": "@Albin ok, wait editing..."}, {"owner": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "edited": false, "score": 1, "creation_date": 1456308206, "post_id": 35598461, "comment_id": 58882585, "body": "Break it up into smaller methods. Like <code>merge_hash_with_hash</code>, <code>merge_hash_with_array</code> and so on."}, {"owner": {"reputation": 6363, "user_id": 2837813, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/5Xggf.png?s=128&g=1", "display_name": "ProGM", "link": "https://stackoverflow.com/users/2837813/progm"}, "reply_to_user": {"reputation": 2634, "user_id": 1210949, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vAL35.jpg?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/1210949/albin"}, "edited": false, "score": 0, "creation_date": 1456308213, "post_id": 35598461, "comment_id": 58882588, "body": "Why this question is unclear? I just want to deep merge a multi-tree structure, why should it be closed? @Albin I improved a bit the code"}, {"owner": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "edited": false, "score": 0, "creation_date": 1456308310, "post_id": 35598461, "comment_id": 58882661, "body": "I think the problem is that your question is to high level. It&#39;s more of a &quot;fix my code&quot;-kind of problem which SO people don&#39;t really like. You&#39;ve to point us to a specific problem."}, {"owner": {"reputation": 6363, "user_id": 2837813, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/5Xggf.png?s=128&g=1", "display_name": "ProGM", "link": "https://stackoverflow.com/users/2837813/progm"}, "reply_to_user": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "edited": false, "score": 0, "creation_date": 1456308497, "post_id": 35598461, "comment_id": 58882801, "body": "@Oleander The problem is that I can&#39;t conclude my code at all, since my code is becoming very complex. My question is more like: <code>Is there a better way to merge this kind of data structure?</code> than <code>Please make my horrible code work</code>"}, {"owner": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "edited": false, "score": 0, "creation_date": 1456308539, "post_id": 35598461, "comment_id": 58882833, "body": "Shouldn&#39;t <code>merge_array_hash</code> raise an error? I mean, how can you merge <code>[1,2,3]</code> with <code>{a: b, c: d}</code>? Could you maybe add some examples above each merge method?"}, {"owner": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "reply_to_user": {"reputation": 6363, "user_id": 2837813, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/5Xggf.png?s=128&g=1", "display_name": "ProGM", "link": "https://stackoverflow.com/users/2837813/progm"}, "edited": false, "score": 0, "creation_date": 1456308670, "post_id": 35598461, "comment_id": 58882949, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/104387/discussion-between-oleander-and-progm\">continue this discussion in chat</a>."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "edited": false, "score": 0, "creation_date": 1456308729, "post_id": 35598461, "comment_id": 58883001, "body": "@Oleander No, that is not the problem. The OP invited the problem by themselves."}, {"owner": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1456308887, "post_id": 35598461, "comment_id": 58883130, "body": "@sawa I was taking about the problem is general. How would such a merge look?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "edited": false, "score": 0, "creation_date": 1456308942, "post_id": 35598461, "comment_id": 58883173, "body": "@Oleander I am mentioning your earlier comment."}, {"owner": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "edited": false, "score": 0, "creation_date": 1456309125, "post_id": 35598461, "comment_id": 58883292, "body": "@ProGM Sorry for being such a nitpicker, but simplify your examples. You only need to show how to merge <code>[c]</code> with <code>{a: b}</code> and <code>{a: b}</code> with <code>[c]</code> and so forth."}, {"owner": {"reputation": 6363, "user_id": 2837813, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/5Xggf.png?s=128&g=1", "display_name": "ProGM", "link": "https://stackoverflow.com/users/2837813/progm"}, "edited": false, "score": 0, "creation_date": 1456309523, "post_id": 35598461, "comment_id": 58883587, "body": "<code>{ a: :b }</code> merged with <code>[:c]</code> is: <code>[:c, {a: :b}]</code>"}, {"owner": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "edited": false, "score": 0, "creation_date": 1468837330, "post_id": 35598461, "comment_id": 64273916, "body": "Did you found a way to do it ?!"}, {"owner": {"reputation": 6363, "user_id": 2837813, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/5Xggf.png?s=128&g=1", "display_name": "ProGM", "link": "https://stackoverflow.com/users/2837813/progm"}, "reply_to_user": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "edited": false, "score": 0, "creation_date": 1468837523, "post_id": 35598461, "comment_id": 64274056, "body": "@PandaCool yep: <a href=\"https://gist.github.com/ProGM/79e72876dbbcbbd79a2beec893c4f6e8\" rel=\"nofollow noreferrer\">gist.github.com/ProGM/79e72876dbbcbbd79a2beec893c4f6e8</a>"}], "owner": {"reputation": 6363, "user_id": 2837813, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/5Xggf.png?s=128&g=1", "display_name": "ProGM", "link": "https://stackoverflow.com/users/2837813/progm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1456309766, "creation_date": 1456306935, "last_edit_date": 1456309766, "question_id": 35598461, "link": "https://stackoverflow.com/questions/35598461/how-to-deep-merge-two-multi-root-tree-structure-made-of-array-and-hashes", "title": "How to deep merge two multi-root tree structure made of array and hashes", "body": "<p>I have a nested structure made of <code>Hash</code>es and <code>Array</code>s that we can call multi-root nth-ary Tree.</p>\n\n<p>I'm representing this structure</p>\n\n<p>Here's an example:</p>\n\n<pre><code>[:o, {\n  a: :b,\n  c: [:d, :e, { f: { h: :i, l: [:m, :n] } }]\n}]\n</code></pre>\n\n<p>That represents can be represented with this schema:</p>\n\n<pre><code>o        a          c\n        /          /|\\\n       b          d e f\n                      /\\\n                     h  l\n                    /  / \\\n                   i  m   n\n</code></pre>\n\n<p>I want to deep merge it with another similar structure. Here's an example:</p>\n\n<pre><code>[:z, {\n  o: :s,\n  c: [:f, { d: :w }]\n}]\n\nz      o      c\n       |     / \\\n       s    f   d\n                 \\\n                  w\n</code></pre>\n\n<p>The resulting tree should be something like this:</p>\n\n<pre><code>[:z, {\n    a: :b,\n    c: [:e, { f: { h: :i, l: [:m, :n] }, d: :w }],\n    o: :s\n }]\n\n\nz       a           c           o\n        |          /|\\          |\n        b         e f d         s\n                   /|  \\\n                  h l   w\n                  | |\\\n                  i m n\n</code></pre>\n\n<p>How can I do this?</p>\n\n<p>I started with this, but I got struck:</p>\n\n<pre><code>def deep_merge(a, b)\n  case a\n  when Hash\n    case b\n    when Hash\n      merge_hashes(a, b)\n    when Array\n      merge_array_hash(b, a)\n    else\n      [b, a]\n    end\n  when Array\n    case b\n    when Array\n      merge_arrays(a, b)\n    when Hash\n      merge_array_hash(a, b)\n    else\n      [b] + a\n    end\n  else\n    case b\n    when Hash\n      [a, b]\n    when Array\n      [a] + b\n    else\n      a == b ? a : [a, b]\n    end\n  end\nend\n\n# EXAMPLES:\n# merge_array_hash([:a, :b], { f: :w })\n# =&gt; [:a, :b, { f: :w }]\n# merge_array_hash([:a, :b, { c: :d }], { f: :w })\n# =&gt; [:a, :b, { c: :d, f: :w }]\ndef merge_array_hash(a, b)\n  if a.last.is_a? Hash\n    a[0...-1] + [merge_hashes(a.last, b)]\n  else\n    a + [b]\n  end\nend\n\n# EXAMPLES:\n# merge_hashes({ a: :b }, { c: :d })\n# =&gt; { a: :b, c: :d }\n# merge_hashes({ a: :b }, { d: e, a: :f })\n# =&gt; { a: [:b, :f], d: :e }\ndef merge_hashes(a, b)\n  a.deep_merge(b) do |_, this_val, other_val|\n    deep_merge(this_val, other_val)\n  end\nend\n\n# EXAMPLES:\n# merge_arrays([:a, :b], [:c])\n# =&gt; [:a, :b, :c]\n# merge_arrays([:a, :b { c: :d }], [:f, { c: :e }])\n# =&gt; [:a, :b, :f, { c: [:d, :e] }]\n# merge_arrays([:a, :b { c: :d }], [:f, { c: :e }])\n# =&gt; [:a, :b, :f, { c: [:d, :e] }]\ndef merge_arrays(a, b)\n  keys = merge_array_keys(a, b)\n  hashes = merge_hashes(a.last.is_a?(Hash) ? a.last : {}, b.last.is_a?(Hash) ? a.last : {})\n  hashes.empty? keys : (keys + [hashes])\nend\n\n# EXAMPLES:\n# merge_array_keys([:a, :b], [:f])\n# =&gt; [:a, :b, :f]\n# merge_array_keys([:a, :b { c: :d }], [:f, { c: :e }])\n# =&gt; [:a, :b, :f]\ndef merge_array_keys(a, b)\n  a.reject { |e| e.is_a?(Hash) } + b.reject { |e| e.is_a?(Hash) }\nend\n</code></pre>\n\n<p>As you can see, my solution was a little bit too complex, I think there's a more intelligent way, but I can't find it. Any ideas?</p>\n\n<p>NB: the key order doesn't metter</p>\n\n<p>NB: If there is an Array that contains an Hash, the hash must be the last item of the array</p>\n\n<p>NB: I'm not interested in performances, it could be also very slow for big trees</p>\n\n<p>NB: If you have better ideas to represent this structure in a more intelligent way, for me is ok!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "delayed-job"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 4677664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/RXseX.jpg?s=128&g=1", "display_name": "Jourdan Bul-lalayao", "link": "https://stackoverflow.com/users/4677664/jourdan-bul-lalayao"}, "edited": false, "score": 0, "creation_date": 1456300695, "post_id": 35596227, "comment_id": 58877759, "body": "Thanks, I tried this and then tried to run delayed_job again, but with another permission error:      /opt/rubies/ruby-2.2.3/lib/ruby/gems/2.2.0/gems/daemons-1.2.&zwnj;&#8203;3/lib/daemons/pidfil&zwnj;&#8203;e.rb:92:in &#39;initialize&#39;: Permission denied @ rb_sysopen - /var/app/current/tmp/pids/delayed_job.pid (Errno::EACCES)   Any idea what I can do here, or could you explain how I can use <code>chown</code> to solve this? Not much of a command line guy yet!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 69, "user_id": 4677664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/RXseX.jpg?s=128&g=1", "display_name": "Jourdan Bul-lalayao", "link": "https://stackoverflow.com/users/4677664/jourdan-bul-lalayao"}, "edited": false, "score": 0, "creation_date": 1456301305, "post_id": 35596227, "comment_id": 58878071, "body": "You do not need to <code>chown</code> in this case. It seems you already have pid files there. Try to run <code>sudo rm -rf &#47;var&#47;app&#47;current&#47;tmp&#47;pids&#47;*</code> and restart <code>delayed_job</code>. It should help."}, {"owner": {"reputation": 69, "user_id": 4677664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/RXseX.jpg?s=128&g=1", "display_name": "Jourdan Bul-lalayao", "link": "https://stackoverflow.com/users/4677664/jourdan-bul-lalayao"}, "edited": false, "score": 0, "creation_date": 1456334156, "post_id": 35596227, "comment_id": 58901665, "body": "I did your first mkdir command, and then the chown afterwards, and that&#39;s what made it work. Thanks so much!"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1456300330, "creation_date": 1456300330, "answer_id": 35596227, "question_id": 35596189, "link": "https://stackoverflow.com/questions/35596189/how-to-run-delayed-job-in-production/35596227#35596227", "title": "How to run delayed_job in production?", "body": "<p>This is rather a missing folder, than a permission issue. You should logon to remote using <code>ssh</code> and run there:</p>\n\n<pre><code>sudo mkdir -p /var/app/current/tmp/pids\nsudo chmod +xw /var/app/current/tmp/pids\n</code></pre>\n\n<p>In case of feeding the paranoia, one might also <code>chown</code> to the user, that actually runs ruby code there, but in this case it is not necessary, since it\u2019s all about storing PIDs.</p>\n"}, {"tags": [], "owner": {"reputation": 148, "user_id": 5085641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SJPL6XX9KuA/AAAAAAAAAAI/AAAAAAAAADI/9WBZFhVYrxw/photo.jpg?sz=128", "display_name": "Basten Gao", "link": "https://stackoverflow.com/users/5085641/basten-gao"}, "is_accepted": false, "score": 2, "last_activity_date": 1456301079, "creation_date": 1456301079, "answer_id": 35596465, "question_id": 35596189, "link": "https://stackoverflow.com/questions/35596189/how-to-run-delayed-job-in-production/35596465#35596465", "title": "How to run delayed_job in production?", "body": "<ol>\n<li>check which user delay_job start with</li>\n<li>check <code>/var/app/current/tmp/pids</code> permission, the permission must be fit for the user.</li>\n<li>if <code>pids</code> not exists, check <code>/var/app/current/tmp</code> permission</li>\n</ol>\n"}], "owner": {"reputation": 69, "user_id": 4677664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/RXseX.jpg?s=128&g=1", "display_name": "Jourdan Bul-lalayao", "link": "https://stackoverflow.com/users/4677664/jourdan-bul-lalayao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 35596227, "answer_count": 2, "score": 0, "last_activity_date": 1456301079, "creation_date": 1456300135, "last_edit_date": 1456300346, "question_id": 35596189, "link": "https://stackoverflow.com/questions/35596189/how-to-run-delayed-job-in-production", "title": "How to run delayed_job in production?", "body": "<p>I'm trying to run delayed job in production (Elastic Beanstalk, AWS) using <code>$ RAILS_ENV=production bin/delayed_job start</code>, however I get the following permission error:</p>\n\n<pre><code>/opt/rubies/ruby-2.2.3/lib/ruby/gems/2.2.0/gems/delayed_job-4.1.1/lib/delayed/command.rb:85:in `mkdir': Permission denied @ dir_s_mkdir - /var/app/current/tmp/pids (Errno::EACCES)\n    from /opt/rubies/ruby-2.2.3/lib/ruby/gems/2.2.0/gems/delayed_job-4.1.1/lib/delayed/command.rb:85:in `daemonize'\n    from bin/delayed_job:5:in `&lt;main&gt;'\n</code></pre>\n\n<p>This probably isn't an issue with Delayed Job, but I couldn't really find an answer anywhere to this permission issue and I'm hoping someone might have a clue on what I can do to make it work in production. </p>\n\n<p>Any help is greatly appreciated! Thanks!</p>\n"}, {"tags": ["ruby", "memoization"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1456297061, "post_id": 35595047, "comment_id": 58876003, "body": "In what way does it not work? Be specific."}, {"owner": {"reputation": 1927, "user_id": 1499713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e359668f2369fe1b576ce4d25014d9?s=128&d=identicon&r=PG", "display_name": "Eratosthenes", "link": "https://stackoverflow.com/users/1499713/eratosthenes"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1456298816, "post_id": 35595047, "comment_id": 58876821, "body": "@Jordan: The function is not being memoized. If you ran the code this would be obvious."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1456331825, "post_id": 35595047, "comment_id": 58899878, "body": "Maybe so, but if you instead describe your problem clearly and explicitly to begin with, people won&#39;t have to run your code in order to figure out whether or not they can help you. I suggest reading <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1927, "user_id": 1499713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e359668f2369fe1b576ce4d25014d9?s=128&d=identicon&r=PG", "display_name": "Eratosthenes", "link": "https://stackoverflow.com/users/1499713/eratosthenes"}, "edited": false, "score": 0, "creation_date": 1456298761, "post_id": 35595717, "comment_id": 58876788, "body": "I&#39;m not trying to override the original function, though. I want to pass the original function into another function that memoizes it."}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "reply_to_user": {"reputation": 1927, "user_id": 1499713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e359668f2369fe1b576ce4d25014d9?s=128&d=identicon&r=PG", "display_name": "Eratosthenes", "link": "https://stackoverflow.com/users/1499713/eratosthenes"}, "edited": false, "score": 0, "creation_date": 1456298963, "post_id": 35595717, "comment_id": 58876897, "body": "The python code of <code>memoize</code> just returns a lambda (an anonymous function), and later it&#39;s assigned to the variable <code>fib</code>. The result is that the original <code>fib</code> is overridden."}, {"owner": {"reputation": 1927, "user_id": 1499713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e359668f2369fe1b576ce4d25014d9?s=128&d=identicon&r=PG", "display_name": "Eratosthenes", "link": "https://stackoverflow.com/users/1499713/eratosthenes"}, "edited": false, "score": 0, "creation_date": 1456299160, "post_id": 35595717, "comment_id": 58877000, "body": "True, but if I try something like <code>new_fib = memoize{|x| fib(x)}; puts new_fib(50)</code> I still have the same issue with the function not being memoized"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 1927, "user_id": 1499713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e359668f2369fe1b576ce4d25014d9?s=128&d=identicon&r=PG", "display_name": "Eratosthenes", "link": "https://stackoverflow.com/users/1499713/eratosthenes"}, "edited": false, "score": 0, "creation_date": 1456299513, "post_id": 35595717, "comment_id": 58877175, "body": "@Eratosthenes: this is because you have <code>f.call(arg)</code> there. This transfers the control into the original <code>fib</code> method and it never returns to your memoization logic, because <code>fib</code> calls itself recursively. You <i>have</i> to overwrite <code>fib</code> for this to work."}, {"owner": {"reputation": 1927, "user_id": 1499713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e359668f2369fe1b576ce4d25014d9?s=128&d=identicon&r=PG", "display_name": "Eratosthenes", "link": "https://stackoverflow.com/users/1499713/eratosthenes"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1456299686, "post_id": 35595717, "comment_id": 58877264, "body": "@SergioTulentsev if you know how to do this, can you please show me your code?"}], "tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": false, "score": 0, "last_activity_date": 1456298796, "last_edit_date": 1456298796, "creation_date": 1456298482, "answer_id": 35595717, "question_id": 35595047, "link": "https://stackoverflow.com/questions/35595047/how-to-generically-memoize-any-function-in-ruby/35595717#35595717", "title": "How to generically memoize any function in Ruby?", "body": "<p>In python, functions are callable objects, and their names are just the names of the variables which store those objects, so you can just assign a new value to that variable to make the function functions totally different.</p>\n\n<p>But in ruby, methods are not objects, their names are not variable names either. To override the original, you have to <code>def</code> it again.</p>\n\n<p>Here is my solution:</p>\n\n<pre><code>def fib(n)\n  return n if n&lt;2\n  fib(n-1) + fib(n-2)\nend\n\nalias _fib fib\n\ndef fib(n)\n  $memo ||= {}\n  $memo[n] ||= _fib(n)\nend\n\nfib(50)  #=&gt; 12586269025\n</code></pre>\n\n<p>I used the old ruby trick: make an alias and override the original. It's nasty (because there is an extra <code>_fib</code> after the overriding), but it's the easiest way doing this.</p>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 6, "last_activity_date": 1456301461, "creation_date": 1456301461, "answer_id": 35596579, "question_id": 35595047, "link": "https://stackoverflow.com/questions/35595047/how-to-generically-memoize-any-function-in-ruby/35596579#35596579", "title": "How to generically memoize any function in Ruby?", "body": "<p><code>fib</code> calls itself recursively and, by doing this, bypasses your memoization logic completely. Whatever approach you choose, you must overwrite the original definition of <code>fib</code>, to wrap memoization around it. </p>\n\n<p>@Aetherus gave a working answer. Here is a more dynamic solution:</p>\n\n<pre><code>def fib(n)\n  return n if n&lt;2\n  fib(n-1) + fib(n-2)\nend\n\ndef memoize(method_name)\n  memo = {}\n  old_fib = method(method_name)\n  define_method(method_name) do |arg|\n    return memo[arg] if memo[arg] \n    memo[arg] = old_fib.call(arg)\n    memo[arg]\n  end\nend\n\nmemoize(:fib)\n\nputs fib(50)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "is_accepted": false, "score": 1, "last_activity_date": 1456301559, "creation_date": 1456301559, "answer_id": 35596619, "question_id": 35595047, "link": "https://stackoverflow.com/questions/35595047/how-to-generically-memoize-any-function-in-ruby/35596619#35596619", "title": "How to generically memoize any function in Ruby?", "body": "<p>You could use a method decorator pattern, <a href=\"https://github.com/michaelfairley/method_decorators\" rel=\"nofollow\">here</a> is a sample implementation you can use as a library:</p>\n\n<blockquote>\n<pre><code>require \"method_decorators/memoize\"\n\nclass MyMath\n  extend MethodDecorators\n\n  +MethodDecorators::Memoize\n  def self.fib(n)\n    if n &lt;= 1\n      1\n    else\n      fib(n - 1) * fib(n - 2)\n    end\n  end\nend\n\nputs MyMath.fib(200)\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 1927, "user_id": 1499713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e359668f2369fe1b576ce4d25014d9?s=128&d=identicon&r=PG", "display_name": "Eratosthenes", "link": "https://stackoverflow.com/users/1499713/eratosthenes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 35596579, "answer_count": 3, "score": 2, "last_activity_date": 1456301559, "creation_date": 1456296126, "last_edit_date": 1456298448, "question_id": 35595047, "link": "https://stackoverflow.com/questions/35595047/how-to-generically-memoize-any-function-in-ruby", "title": "How to generically memoize any function in Ruby?", "body": "<p>I am trying to write a function to generically memoize any function in Ruby (as described in page 6 of this paper, which does the same thing in Python: <a href=\"http://courses.csail.mit.edu/6.01/spring07/lectures/lecture4.pdf\" rel=\"nofollow\">http://courses.csail.mit.edu/6.01/spring07/lectures/lecture4.pdf</a>), but I am getting stuck. Here is my code, which doesn't work (the function is evaluated correctly, but not memoized). Can anyone tell me where I'm going wrong? </p>\n\n<pre><code>def fib(n)\n  return n if n&lt;2\n  fib(n-1) + fib(n-2)\nend\n\ndef memoize(&amp;f)\n  memo = {}\n  doit = -&gt;(arg) do\n    return memo[arg] if memo[arg] \n    memo[arg] = f.call(arg)\n    memo[arg]\n  end\n  doit\nend\n\nfib = memoize{|x| fib(x)}\nputs fib.call(50)\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1456295963, "post_id": 35594980, "comment_id": 58875486, "body": "What is your question?"}, {"owner": {"reputation": 1, "user_id": 5970283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c1a6b4b3365be491e00c40dc9fd0be?s=128&d=identicon&r=PG&f=1", "display_name": "vmarqs", "link": "https://stackoverflow.com/users/5970283/vmarqs"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1456296291, "post_id": 35594980, "comment_id": 58875624, "body": "How do I downcase every other word?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1456296523, "post_id": 35594980, "comment_id": 58875734, "body": "You have <code>capitalize</code> in the title, <code>upcase</code> in the code snippet and now you mention <code>downcase</code>. Please restate your question so that we could understand what do you need."}, {"owner": {"reputation": 1, "user_id": 5970283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c1a6b4b3365be491e00c40dc9fd0be?s=128&d=identicon&r=PG&f=1", "display_name": "vmarqs", "link": "https://stackoverflow.com/users/5970283/vmarqs"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1456297212, "post_id": 35594980, "comment_id": 58876069, "body": "yes, in the snippet I used .upcase but should I use that to capitalize every other word in the array?"}, {"owner": {"reputation": 1, "user_id": 5970283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c1a6b4b3365be491e00c40dc9fd0be?s=128&d=identicon&r=PG&f=1", "display_name": "vmarqs", "link": "https://stackoverflow.com/users/5970283/vmarqs"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1456297301, "post_id": 35594980, "comment_id": 58876116, "body": "I want the output to display 5 words, sorted alphabetically and every other word capitalized."}, {"owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "edited": false, "score": 0, "creation_date": 1456298941, "post_id": 35594980, "comment_id": 58876887, "body": "While I agree that the question needs editing, the downvotes are only deserved for failing to post a corpus and desired output, not for the question itself which is actually pretty reasonable. People should not be downvoting because the question seems basic, or because it&#39;s homework. In addition, there is a useful question here, and I disagree with the close votes."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1456299297, "post_id": 35594980, "comment_id": 58877067, "body": "@vmarqs: <code>words.map(&amp;:downcase)</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1456299377, "post_id": 35594980, "comment_id": 58877115, "body": "vmarqs, when you are asked for clarification you need to edit the question, not respond in comments (which some readers may miss)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1456299650, "post_id": 35594980, "comment_id": 58877239, "body": "You may wish to look at <a href=\"http://stackoverflow.com/questions/35443273/alternate-between-uppercase-and-downcase/35443386#comment58589370_35443386\">this question</a>. btw, do you mean I should start that video at 6:00am tomorrow? That&#39;s pretty early for me."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1456300057, "post_id": 35594980, "comment_id": 58877422, "body": "@CarySwoveland It\u2019s CET :)"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1456297972, "post_id": 35595532, "comment_id": 58876435, "body": "There was a request to sort elements in OP."}, {"owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1456298283, "post_id": 35595532, "comment_id": 58876561, "body": "@mudasobwa So? This isn&#39;t a homework writing service. The OP clearly already knows how to #sort an array; that wasn&#39;t the real problem. I chose to address the X in this X/Y problem, but you are certainly free to post alternative answers."}, {"owner": {"reputation": 1, "user_id": 5970283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c1a6b4b3365be491e00c40dc9fd0be?s=128&d=identicon&r=PG&f=1", "display_name": "vmarqs", "link": "https://stackoverflow.com/users/5970283/vmarqs"}, "edited": false, "score": 0, "creation_date": 1456298296, "post_id": 35595532, "comment_id": 58876565, "body": "what if it is upcasing every other word?"}, {"owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "reply_to_user": {"reputation": 1, "user_id": 5970283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c1a6b4b3365be491e00c40dc9fd0be?s=128&d=identicon&r=PG&f=1", "display_name": "vmarqs", "link": "https://stackoverflow.com/users/5970283/vmarqs"}, "edited": false, "score": 1, "creation_date": 1456298358, "post_id": 35595532, "comment_id": 58876597, "body": "@vmarqs Then call #upcase instead of #capitalize. In future, make sure your questions include <b>your desired output</b> if you want to avoid downvotes."}], "tags": [], "owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "is_accepted": false, "score": 0, "last_activity_date": 1456297865, "creation_date": 1456297865, "answer_id": 35595532, "question_id": 35594980, "link": "https://stackoverflow.com/questions/35594980/using-ruby-i-want-to-ask-user-for-a-word-5x-then-sort-the-list-and-capitalize-e/35595532#35595532", "title": "Using Ruby, I want to ask user for a word 5x then sort the list and capitalize every other word", "body": "<h2>Capitalizing and Uppercasing Are Not Synonyms</h2>\n\n<p>Capitalizing and uppercasing are two different things. Since your question asked about capitalizing (e.g. title-casing), you can construct your code around the following examples.</p>\n\n<p>One example uses features from the latest MRI Ruby, while the other uses ActiveSupport from Rails. More complex solutions are possible by indexing into strings, but why do it the hard way?</p>\n\n<h3>Ruby 2.3.0+</h3>\n\n<p>Use the new <a href=\"http://ruby-doc.org/core-2.3.0/String.html#method-i-capitalize\" rel=\"nofollow\">String#capitalize</a> method. For example:</p>\n\n<pre><code>words = %w[foo bar baz quux wibble]\nwords.each_with_index.map { |word, idx| idx.even? ? word.capitalize : word }\n#=&gt; [\"Foo\", \"bar\", \"Baz\", \"quux\", \"Wibble\"]\n</code></pre>\n\n<p>This will capitalize ever other word in the list. Use <a href=\"http://ruby-doc.org/core-2.3.0/Integer.html#method-i-odd-3F\" rel=\"nofollow\">Integer#odd?</a> instead of <a href=\"http://ruby-doc.org/core-2.3.0/Integer.html#method-i-even-3F\" rel=\"nofollow\">Integer#even?</a> to check the <em>idx</em> variable if you prefer.</p>\n\n<h3>Use Rails Extensions</h3>\n\n<p>If you have an older Ruby, you can use methods from <a href=\"https://github.com/rubyworks/facets\" rel=\"nofollow\">the facets gem</a> or <a href=\"http://guides.rubyonrails.org/active_support_core_extensions.html#inflections\" rel=\"nofollow\">the \"inflections\" string extension from Rails</a> to do the same thing. For example, with ActiveSupport:</p>\n\n<pre><code>require 'active_support/core_ext/string/inflections'\n\nwords = %w[foo bar baz quux wibble]\nwords.each_with_index.map { |word, idx| idx.even? ? word.titlecase : word }\n#=&gt; [\"Foo\", \"bar\", \"Baz\", \"quux\", \"Wibble\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1456297881, "creation_date": 1456297881, "answer_id": 35595545, "question_id": 35594980, "link": "https://stackoverflow.com/questions/35594980/using-ruby-i-want-to-ask-user-for-a-word-5x-then-sort-the-list-and-capitalize-e/35595545#35595545", "title": "Using Ruby, I want to ask user for a word 5x then sort the list and capitalize every other word", "body": "<pre><code>words = []\n5.times do\n  puts \"Please enter a word:\"\n  words &lt;&lt; gets.chomp   # no .upcase here, upcase converts all letters\nend\n\nresult = words.sort.map.with_index do |w, i| \n           w[0] = w[0].upcase if i.odd?\n         end\nputs \"Here are your words:\" \nputs result\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5970283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c1a6b4b3365be491e00c40dc9fd0be?s=128&d=identicon&r=PG&f=1", "display_name": "vmarqs", "link": "https://stackoverflow.com/users/5970283/vmarqs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1457085629, "answer_count": 2, "score": -4, "last_activity_date": 1456297881, "creation_date": 1456295841, "last_edit_date": 1456295940, "question_id": 35594980, "link": "https://stackoverflow.com/questions/35594980/using-ruby-i-want-to-ask-user-for-a-word-5x-then-sort-the-list-and-capitalize-e", "closed_reason": "Needs details or clarity", "title": "Using Ruby, I want to ask user for a word 5x then sort the list and capitalize every other word", "body": "<p>yes , this is a study question. I've been banging my head on a wall over this. what I have so far...</p>\n\n<pre><code>words = []\n5.times do\n  puts \"Please enter a word:\"\n  words &lt;&lt; gets.chomp.upcase\nend\n\nputs \"Here are your words:\" \nputs words.sort\n</code></pre>\n\n<p>start this video at 6:00\nmore info: <a href=\"https://vimeo.com/125941774\" rel=\"nofollow\">https://vimeo.com/125941774</a></p>\n"}, {"tags": ["ruby", "file-upload", "upload", "sinatra"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1456296620, "post_id": 35594869, "comment_id": 58875783, "body": "Are you doing that <code>File.open</code> on a Windows box?"}, {"owner": {"reputation": 13167, "user_id": 399457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6a6ed435a024926ffb41d1ad84b3b1f5?s=128&d=identicon&r=PG", "display_name": "Mentiflectax", "link": "https://stackoverflow.com/users/399457/mentiflectax"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1456296631, "post_id": 35594869, "comment_id": 58875788, "body": "@muistooshort Yes, Windows 7."}], "answers": [{"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 3, "last_activity_date": 1552584222, "last_edit_date": 1552584222, "creation_date": 1456296976, "answer_id": 35595274, "question_id": 35594869, "link": "https://stackoverflow.com/questions/35594869/why-does-this-file-upload-code-corrupt-my-mp3-files/35595274#35595274", "title": "Why does this file upload code corrupt my MP3 files?", "body": "<p>You're opening the file in text mode (the default):</p>\n\n<pre><code>File.open('uploads/' + params['song'][:filename], \"w\")\n</code></pre>\n\n<p>but you're writing binary data (an MP3). You need to open the target file in <a href=\"https://ruby-doc.org/core/IO.html#method-c-new-label-IO+Open+Mode\" rel=\"nofollow noreferrer\">binary mode</a>:</p>\n\n<pre><code>\"b\"  Binary file mode\n     Suppresses EOL &lt;-&gt; CRLF conversion on Windows. And\n     sets external encoding to ASCII-8BIT unless explicitly\n     specified.\n</code></pre>\n\n<p>or the IO libraries will try to convert EOLs to Windows-style CR-LF pairs:</p>\n\n<pre><code>File.open('uploads/' + params['song'][:filename], \"wb\")\n# --------------------------------------------------^\n</code></pre>\n\n<p>Also, you shouldn't use a user-supplied name (<code>params['song'][:filename]</code>) as a filename without thoroughly scrubbing it; or better, don't use their name at all, store their name in a database somewhere and use the table's <code>id</code> as the filename.</p>\n"}], "owner": {"reputation": 13167, "user_id": 399457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6a6ed435a024926ffb41d1ad84b3b1f5?s=128&d=identicon&r=PG", "display_name": "Mentiflectax", "link": "https://stackoverflow.com/users/399457/mentiflectax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 35595274, "answer_count": 1, "score": 1, "last_activity_date": 1552584222, "creation_date": 1456295425, "question_id": 35594869, "link": "https://stackoverflow.com/questions/35594869/why-does-this-file-upload-code-corrupt-my-mp3-files", "title": "Why does this file upload code corrupt my MP3 files?", "body": "<p>I have a Sinatra-based project with a <a href=\"https://github.com/dpisarenko/50web/blob/songcontest2/views/songcontest/upload.erb\" rel=\"nofollow\">page</a>, where the user can upload MP3 file.</p>\n\n<pre><code>&lt;h2&gt;&lt;%= I18n.t(:home_title) %&gt;&lt;/h2&gt;\n&lt;%= I18n.t(:upload_body_text) %&gt;\n&lt;form action=\"/&lt;%= I18n.locale %&gt;/upload\" method=\"post\" enctype=\"multipart/form-data\"&gt;\n&lt;p&gt;\n&lt;input type=\"file\" name=\"song\" size=\"40\"&gt;\n&lt;/p&gt;\n&lt;div&gt;\n&lt;input type=\"submit\" value=\"&lt;%= I18n.t(:home_submit) %&gt;\"&gt;\n&lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>The upload is handled by this <a href=\"https://github.com/dpisarenko/50web/blob/songcontest2/routes/songcontest.rb\" rel=\"nofollow\">route</a>:</p>\n\n<pre><code>post \"/upload\" do \n  File.open('uploads/' + params['song'][:filename], \"w\") do |f|\n    f.write(params['song'][:tempfile].read)\n  end\n  erb :main\nend\n</code></pre>\n\n<p>When the file is uploaded, it's corrupted:</p>\n\n<ol>\n<li>The image of the MP3 file in Windows Media Player is distorted.</li>\n<li>The sound is corrupted (sounds wrong).</li>\n</ol>\n\n<p>How can I fix it?</p>\n"}, {"tags": ["ruby", "tomcat", "jruby"], "answers": [{"tags": [], "owner": {"reputation": 3888, "user_id": 1294585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gkE1G.jpg?s=128&g=1", "display_name": "shrikant1712", "link": "https://stackoverflow.com/users/1294585/shrikant1712"}, "is_accepted": true, "score": 0, "last_activity_date": 1456296748, "creation_date": 1456296748, "answer_id": 35595209, "question_id": 35594758, "link": "https://stackoverflow.com/questions/35594758/error-while-deploying-jruby-app-using-apache-tomcat/35595209#35595209", "title": "Error While deploying JRuby app using apache tomcat", "body": "<p>As per the given error, you have installed Ruby 1.9.3 on your system but you have mentioned ruby 2.2.3 in the Gemfile.</p>\n\n<p>So Install the required ruby version. If you are using RVM try following command</p>\n\n<pre><code>rvm install 2.2.3\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5972638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c035fa9fd98804403fa5ce339286bdcc?s=128&d=identicon&r=PG&f=1", "display_name": "Atul Nikhade", "link": "https://stackoverflow.com/users/5972638/atul-nikhade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 35595209, "answer_count": 1, "score": 0, "last_activity_date": 1456296748, "creation_date": 1456295060, "last_edit_date": 1456296331, "question_id": 35594758, "link": "https://stackoverflow.com/questions/35594758/error-while-deploying-jruby-app-using-apache-tomcat", "title": "Error While deploying JRuby app using apache tomcat", "body": "<p>I have deployed WAR file in apache tomcat . WAR file is made in JRuby using Ruby 2.2.3 in ubuntu. </p>\n\n<p>But when I ran the tomcat, I am getting following error. How can I resolve this error? \n<a href=\"https://i.stack.imgur.com/IxeE5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IxeE5.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 3773, "user_id": 991903, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J12Hi.jpg?s=128&g=1", "display_name": "Meier", "link": "https://stackoverflow.com/users/991903/meier"}, "edited": false, "score": 1, "creation_date": 1456304084, "post_id": 35596463, "comment_id": 58879697, "body": "There is a security problem when your args are not hardcoded, but somehow given by a user. Use <code>Shellwords.escape(args)</code> to prevent execution of dangerous commands."}], "tags": [], "owner": {"reputation": 1757, "user_id": 5766404, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Scz0L.png?s=128&g=1", "display_name": "bogl", "link": "https://stackoverflow.com/users/5766404/bogl"}, "is_accepted": false, "score": 0, "last_activity_date": 1456306307, "last_edit_date": 1456306307, "creation_date": 1456301077, "answer_id": 35596463, "question_id": 35594556, "link": "https://stackoverflow.com/questions/35594556/run-a-remote-ruby-script-pass-parameters-as-well-using-ssh/35596463#35596463", "title": "run a remote ruby script (pass parameters as well) using ssh", "body": "<ul>\n<li><p>the name of the connection variable must be consistent (ssh \u2260 conn).</p></li>\n<li><p>You need to send the content of <em>args</em> instead of the string <code>\"args\"</code>:</p></li>\n<li><p>Double quotes are needed for the <code>#{...}</code> syntax to work. Or use <code>'ruby runfile.rb ' + args</code> if you prefer.</p></li>\n<li><p>Use <code>#</code> instead of <code>//</code> to comment Ruby code.</p></li>\n<li><p>Use <code>.shellescape</code> to harden against unwanted (accidental or malicious) effects in the remote shell.</p></li>\n</ul>\n\n<p>This code does work:</p>\n\n<pre><code>require 'net/ssh'\nrequire 'shellwords'\n\nssh = Net::SSH.start(host, user)\nargs = \"some argument\".shellescape #can be any data type, list, string, anything\nresults = ssh.exec!(\"ruby runfile.rb #{args}\")\nputs results\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2851669"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456306307, "creation_date": 1456294230, "question_id": 35594556, "link": "https://stackoverflow.com/questions/35594556/run-a-remote-ruby-script-pass-parameters-as-well-using-ssh", "title": "run a remote ruby script (pass parameters as well) using ssh", "body": "<p>I want to connect to a remote host and run a ruby script on the remote host. Following is the code that I am using - </p>\n\n<pre><code>ssh = Net::SSH.start(host, user)\nargs = \"some argument\" //can be any data type, list, string, anything\nresults = conn.exec!('ruby runfile.rb args')\n</code></pre>\n\n<p>It's not passing args to the file in this  case. I have also tried using double quotes instead of single quotes. How do I send the parameters as well?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 3721172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x4Lzs.png?s=128&g=1", "display_name": "Ar Aui", "link": "https://stackoverflow.com/users/3721172/ar-aui"}, "edited": false, "score": 0, "creation_date": 1456295226, "post_id": 35594687, "comment_id": 58875161, "body": "Thank you! It&#39;s work. But I wonder that if there is a way to change the field name from sql side? just like select u.id, &quot;u.foo + u.bar&quot; as name from user u"}, {"owner": {"reputation": 5962, "user_id": 115159, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ac02a81e50f368f6d5c7a14b99ce2469?s=128&d=identicon&r=PG", "display_name": "Dharam Gollapudi", "link": "https://stackoverflow.com/users/115159/dharam-gollapudi"}, "reply_to_user": {"reputation": 384, "user_id": 3721172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x4Lzs.png?s=128&g=1", "display_name": "Ar Aui", "link": "https://stackoverflow.com/users/3721172/ar-aui"}, "edited": false, "score": 1, "creation_date": 1456295742, "post_id": 35594687, "comment_id": 58875383, "body": "You could, using <code>find_by_sql</code>, but would loose the benefits of <code>active_record</code>."}], "tags": [], "owner": {"reputation": 5962, "user_id": 115159, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ac02a81e50f368f6d5c7a14b99ce2469?s=128&d=identicon&r=PG", "display_name": "Dharam Gollapudi", "link": "https://stackoverflow.com/users/115159/dharam-gollapudi"}, "is_accepted": true, "score": 1, "last_activity_date": 1456294770, "creation_date": 1456294770, "answer_id": 35594687, "question_id": 35594495, "link": "https://stackoverflow.com/questions/35594495/concatenate-field-names-in-ruby/35594687#35594687", "title": "concatenate field names in ruby", "body": "<p>You can define a method in the <code>user</code> model as follows:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  def name\n    self.foo + ' ' + self.bar\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1456298539, "post_id": 35594903, "comment_id": 58876686, "body": "what is <code>foo</code> is nil?"}, {"owner": {"reputation": 4509, "user_id": 2936491, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BIeeI.jpg?s=128&g=1", "display_name": "techdreams", "link": "https://stackoverflow.com/users/2936491/techdreams"}, "reply_to_user": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1456299120, "post_id": 35594903, "comment_id": 58876973, "body": "It will print only <code>bar</code>"}, {"owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1456307929, "post_id": 35594903, "comment_id": 58882388, "body": "Yeah, I see, but the name will have an unexpected space!"}], "tags": [], "owner": {"reputation": 4509, "user_id": 2936491, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BIeeI.jpg?s=128&g=1", "display_name": "techdreams", "link": "https://stackoverflow.com/users/2936491/techdreams"}, "is_accepted": false, "score": 1, "last_activity_date": 1456295564, "creation_date": 1456295564, "answer_id": 35594903, "question_id": 35594495, "link": "https://stackoverflow.com/questions/35594495/concatenate-field-names-in-ruby/35594903#35594903", "title": "concatenate field names in ruby", "body": "<p>You need to use <code>#</code> when joining two field with different datatypes.</p>\n\n<p>For example, adding one integer and string with <code>+</code> will give an error.</p>\n\n<p>So better use it this way.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  def name\n    \"#{foo} #{bar}\"\n  end\nend\n</code></pre>\n\n<p>Hope the detail helps.</p>\n"}], "owner": {"reputation": 384, "user_id": 3721172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x4Lzs.png?s=128&g=1", "display_name": "Ar Aui", "link": "https://stackoverflow.com/users/3721172/ar-aui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 35594687, "answer_count": 2, "score": 2, "last_activity_date": 1581314283, "creation_date": 1456293975, "last_edit_date": 1581314283, "question_id": 35594495, "link": "https://stackoverflow.com/questions/35594495/concatenate-field-names-in-ruby", "title": "concatenate field names in ruby", "body": "<p>Could you please tell me how to change field name?</p>\n\n<p>First, I query some data like this:</p>\n\n<pre><code>u = User.find_by_id(111)\n</code></pre>\n\n<p>It will provide a data like this:</p>\n\n<pre><code>u.id,u.foo,u.bar\n</code></pre>\n\n<p>But, I want to change a result to the below: (\"name\" is concatenation of u.foo+ u.bar)</p>\n\n<pre><code>u.id,u.name\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 2, "last_activity_date": 1456476288, "last_edit_date": 1456476288, "creation_date": 1456290451, "answer_id": 35593697, "question_id": 35593660, "link": "https://stackoverflow.com/questions/35593660/how-do-i-split-a-very-long-w-line-in-ruby/35593697#35593697", "title": "How do I split a very long %w line in ruby", "body": "<p>Change lines at certain points.</p>\n\n<pre><code>names = %w(\n  FOO BAR BAZZ HELLO WORLD\n  FOO BAR BAZZ HELLO WORLD\n  FOO BAR BAZZ HELLO WORLD\n  FOO BAR BAZZ HELLO WORLD\n  FOO BAR BAZZ HELLO WORLD\n  ...\n)\n</code></pre>\n"}], "owner": {"reputation": 678, "user_id": 1549119, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/eLRaE.png?s=128&g=1", "display_name": "smc", "link": "https://stackoverflow.com/users/1549119/smc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 35593697, "answer_count": 1, "score": 2, "last_activity_date": 1456476288, "creation_date": 1456290255, "question_id": 35593660, "link": "https://stackoverflow.com/questions/35593660/how-do-i-split-a-very-long-w-line-in-ruby", "title": "How do I split a very long %w line in ruby", "body": "<p>I have a very long string array that I wrote using %w</p>\n\n<pre><code>names = %w(FOO BAR BAZZ HELLO WORLD.....)\n</code></pre>\n\n<p>It is around 500+ char long line.\nI want to split(a.k.a read as WRAP) for readability.</p>\n\n<p>What is a recommended way?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "is_accepted": true, "score": 3, "last_activity_date": 1456290235, "creation_date": 1456290235, "answer_id": 35593656, "question_id": 35593612, "link": "https://stackoverflow.com/questions/35593612/link-to-with-embedded-ruby-in-the-data-toggle/35593656#35593656", "title": "link_to with embedded ruby in the data-toggle", "body": "<p>You have to write it like this:</p>\n\n<pre><code>&lt;%= link_to \"Edit\", edit_post_path(post.id), :class =&gt; \"btn\", :remote =&gt; true, \"data-toggle\" =&gt; \"modal\", \"data-target\" =&gt; \"#{post.id}-my-modal\" %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 888782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cee9dd780723c5fa0f06a242338e57c?s=128&d=identicon&r=PG", "display_name": "Douglas A. Seifert", "link": "https://stackoverflow.com/users/888782/douglas-a-seifert"}, "is_accepted": false, "score": 1, "last_activity_date": 1456290380, "creation_date": 1456290380, "answer_id": 35593684, "question_id": 35593612, "link": "https://stackoverflow.com/questions/35593612/link-to-with-embedded-ruby-in-the-data-toggle/35593684#35593684", "title": "link_to with embedded ruby in the data-toggle", "body": "<p>Once you open a &lt;% ... %> tag, you are writing ruby code. What this means is that you can't nest &lt;% ... %> tags inside another &lt;% ... %> tag because these tags aren't ruby syntax.</p>\n\n<p>Inside the tag, to do string interpolation, use normal ruby methods:</p>\n\n<pre><code>&lt;%= link_to \"Edit\", edit_post_path(post.id), :class =&gt; \"btn\", :remote =&gt; true, \"data-toggle\" =&gt; \"modal\", \"data-target\" =&gt; \"#{post.id}-my-modal\" %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1456302753, "creation_date": 1456302753, "answer_id": 35596986, "question_id": 35593612, "link": "https://stackoverflow.com/questions/35593612/link-to-with-embedded-ruby-in-the-data-toggle/35596986#35596986", "title": "link_to with embedded ruby in the data-toggle", "body": "<p>Only mistake is putting another (ruby) tag &lt;% %> inside the same tag.</p>\n\n<p>In <strong>erb</strong> (embedded ruby) one <strong>&lt;%= %> tag</strong> cannot have another tag inside.</p>\n\n<p>This code result a syntax error.</p>\n\n<pre><code>&lt;%= link_to \"Edit\", .... \"data-target\" =&gt; \"&lt;%= post.id %&gt;-my-modal\" %&gt;\n</code></pre>\n\n<p>If you plan to <strong>output/render</strong> data inside the tag and quoted as string,\nused <strong><em>#{put_data_hare}</em></strong></p>\n\n<p>Output like:</p>\n\n<pre><code>&lt;%= link_to \"Edit\", .... \"data-target\" =&gt; \"#{post.id}-my-modal\" %&gt;\n</code></pre>\n\n<p>In other case, you can do like:</p>\n\n<pre><code>post.id.to_s + \"-my-modal\"\n</code></pre>\n"}], "owner": {"reputation": 297, "user_id": 2884789, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/36346aaf89465b719c39c918e2c0b8aa?s=128&d=identicon&r=PG&f=1", "display_name": "user2884789", "link": "https://stackoverflow.com/users/2884789/user2884789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 35593656, "answer_count": 3, "score": 0, "last_activity_date": 1456302753, "creation_date": 1456290046, "last_edit_date": 1495539900, "question_id": 35593612, "link": "https://stackoverflow.com/questions/35593612/link-to-with-embedded-ruby-in-the-data-toggle", "title": "link_to with embedded ruby in the data-toggle", "body": "<p>I'm following <a href=\"https://stackoverflow.com/questions/15152486/how-to-add-bootstrap-modal-with-link-to-so-the-link-content-open-in-modal\">this</a> SE question to put a form in a bootstrap modal with rails. \nThe person who answered the question states: \"Make sure that you have a unique id or class for every modal body.\".  So I am trying to put a unique id number in my link_to:</p>\n\n<pre><code>&lt;%= link_to \"Edit\", edit_post_path(post.id), :class =&gt; \"btn\", :remote =&gt; true, \"data-toggle\" =&gt; \"modal\", \"data-target\" =&gt; \"&lt;%= post.id %&gt;-my-modal\" %&gt;\n</code></pre>\n\n<p>But this is causing an error.  If I take out &lt;%= post.id %> I do not have an error, but the modal behavior does not work. </p>\n\n<p>How can I add the post.id with embedded ruby to the link to? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "rubygems", "md5"], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1456290000, "creation_date": 1456290000, "answer_id": 35593605, "question_id": 35593581, "link": "https://stackoverflow.com/questions/35593581/ruby-on-rails-calculating-md5-of-image-with-command-line/35593605#35593605", "title": "Ruby on Rails Calculating md5 of image with command line ``", "body": "<p>Pure Ruby:</p>\n\n<pre><code>require 'digest/md5'\n# ...\nself.md5 = Digest::MD5.hexdigest(File.binread(test_image.image.path))\n</code></pre>\n\n<p>EDIT: Simpler:</p>\n\n<pre><code>self.md5 = Digest::MD5.file(test_image.image.path).hexdigest\n</code></pre>\n"}], "owner": {"reputation": 1348, "user_id": 2337967, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d99b9f9fecef213745ac58a511ab4845?s=128&d=identicon&r=PG", "display_name": "Scott B", "link": "https://stackoverflow.com/users/2337967/scott-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 35593605, "answer_count": 1, "score": 0, "last_activity_date": 1456290000, "creation_date": 1456289865, "question_id": 35593581, "link": "https://stackoverflow.com/questions/35593581/ruby-on-rails-calculating-md5-of-image-with-command-line", "title": "Ruby on Rails Calculating md5 of image with command line ``", "body": "<p>I am trying to generate a md5 hash of images in both a ruby script and on a ruby on rails server. </p>\n\n<p>In the script (which is run locally on a mac) I am doing:</p>\n\n<pre><code>`md5 -q path-to-file`\n</code></pre>\n\n<p>Which works perfectly fine and generates something like <code>Added new md5: efe99a09e6e1b192314891b960018bd4</code> When I run the same command on the server (running in production on a linux machine), it comes up as an empty string</p>\n\n<pre><code>def add_md5_if_empty(test_image)\n  if md5.nil?\n    self.md5 = `md5 -q #{test_image.image.path}`\n    logger.info \"Added new md5: #{self.md5} for image at path: #{test_image.image.path}\"\n    test_image.save\n  end\nend\n\n\nI, [2016-02-24T03:48:36.879648 #42]  INFO -- : Added new md5:  for image at path: /app/public/system/test_images/images/000/209/309/original/filename.png\n</code></pre>\n\n<p>My guess is that the ruby on rails server (linux machine) doesn't have the md5 command. Also my project is using Docker so maybe there is some dependency I am missing. Any help would be greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "nginx"], "comments": [{"owner": {"reputation": 137816, "user_id": 13070, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/pio3A.jpg?s=128&g=1", "display_name": "Mark B", "link": "https://stackoverflow.com/users/13070/mark-b"}, "edited": false, "score": 0, "creation_date": 1456331950, "post_id": 35593475, "comment_id": 58899975, "body": "Is your SSL certificate installed on the Elastic Load Balancer or on your Nginx server?"}], "answers": [{"comments": [{"owner": {"reputation": 479, "user_id": 4582293, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d7ayP.jpg?s=128&g=1", "display_name": "Akshath Kumar", "link": "https://stackoverflow.com/users/4582293/akshath-kumar"}, "reply_to_user": {"reputation": 2032, "user_id": 1471938, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/0HGZz.jpg?s=128&g=1", "display_name": "d3bug3r", "link": "https://stackoverflow.com/users/1471938/d3bug3r"}, "edited": false, "score": 0, "creation_date": 1456291807, "post_id": 35593784, "comment_id": 58873782, "body": "In aws you can use Elastic load balancer for ssl redirection. Same issue i have found in my nginx server. I have used ssl inside load balancer intead of using back end server. Back end server only listen 80 port instead of 443."}, {"owner": {"reputation": 2032, "user_id": 1471938, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/0HGZz.jpg?s=128&g=1", "display_name": "d3bug3r", "link": "https://stackoverflow.com/users/1471938/d3bug3r"}, "edited": false, "score": 0, "creation_date": 1456292917, "post_id": 35593784, "comment_id": 58874215, "body": "Yup, I already setup a load balancer, but the problem i need to redirect <code>https:&#47;&#47;travelog.com</code> to <code>https:&#47;&#47;www.travelog.com</code>"}, {"owner": {"reputation": 479, "user_id": 4582293, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d7ayP.jpg?s=128&g=1", "display_name": "Akshath Kumar", "link": "https://stackoverflow.com/users/4582293/akshath-kumar"}, "reply_to_user": {"reputation": 2032, "user_id": 1471938, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/0HGZz.jpg?s=128&g=1", "display_name": "d3bug3r", "link": "https://stackoverflow.com/users/1471938/d3bug3r"}, "edited": false, "score": 0, "creation_date": 1456293703, "post_id": 35593784, "comment_id": 58874545, "body": "@d3bug3r.. Then why you listening 443 port .In load balancer you should listen 80 port of your instance for https . Then you can configure the redirection by listening 80 port instead of 443 in your nginx server...By using all these procedure i had fixed my redirection problem from non-www to www"}, {"owner": {"reputation": 2032, "user_id": 1471938, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/0HGZz.jpg?s=128&g=1", "display_name": "d3bug3r", "link": "https://stackoverflow.com/users/1471938/d3bug3r"}, "edited": false, "score": 0, "creation_date": 1456294703, "post_id": 35593784, "comment_id": 58874942, "body": "Check the edit, That&#39;s is my load balancer config. Is this config valid?"}, {"owner": {"reputation": 2032, "user_id": 1471938, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/0HGZz.jpg?s=128&g=1", "display_name": "d3bug3r", "link": "https://stackoverflow.com/users/1471938/d3bug3r"}, "edited": false, "score": 0, "creation_date": 1456296130, "post_id": 35593784, "comment_id": 58875552, "body": "So your config above still valid for config of my load balancer?"}], "tags": [], "owner": {"reputation": 479, "user_id": 4582293, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d7ayP.jpg?s=128&g=1", "display_name": "Akshath Kumar", "link": "https://stackoverflow.com/users/4582293/akshath-kumar"}, "is_accepted": false, "score": 3, "last_activity_date": 1456301972, "last_edit_date": 1456301972, "creation_date": 1456290906, "answer_id": 35593784, "question_id": 35593475, "link": "https://stackoverflow.com/questions/35593475/redirect-https-from-non-www-to-www/35593784#35593784", "title": "Redirect https from non www to www", "body": "<p>Please use the below config in your nginx.conf file. Its working fine for me.</p>\n\n<pre><code>server {\n       listen         80;\n       server_name    www.example.com example.com;\n\n       location / {\n            index       index.html;\n            root        /usr/share/nginx/html;  #the location of your app folder\n       }\n\n\n        if ($http_x_forwarded_proto = 'http') {\n            return 301 https://www.example.com$request_uri;\n        }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": false, "score": 0, "last_activity_date": 1456290953, "creation_date": 1456290953, "answer_id": 35593793, "question_id": 35593475, "link": "https://stackoverflow.com/questions/35593475/redirect-https-from-non-www-to-www/35593793#35593793", "title": "Redirect https from non www to www", "body": "<p>If you just want to redirect GET requests and throw a 405 (Method not allowed) for non-GET requests:</p>\n\n<pre><code>server {\n  listen 443 ssl;\n  server_name example.com;\n  if ($request_method = GET) {\n    return 301 https://www.example.com$request_uri;\n  }\n  return 405;\n}\n\nserver {\n  listen 443 ssl;\n  server_name www.example.com;\n\n  # locations\n}\n</code></pre>\n\n<p>If you want all requests (GET, POST, ...) to be redirected, which is not possible, I suggest that you should try Akshath's method.</p>\n"}], "owner": {"reputation": 2032, "user_id": 1471938, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/0HGZz.jpg?s=128&g=1", "display_name": "d3bug3r", "link": "https://stackoverflow.com/users/1471938/d3bug3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456301972, "creation_date": 1456289286, "last_edit_date": 1456294663, "question_id": 35593475, "link": "https://stackoverflow.com/questions/35593475/redirect-https-from-non-www-to-www", "title": "Redirect https from non www to www", "body": "<p>Following were my Nginx server config (not work). I need to redirect https non www to www. So when I visit a  site <code>https://example.com</code>, it should redirect me to <code>https://www.example.com</code>.</p>\n\n<pre><code>server {\n    listen 443 ssl\n    server_name example.com;\n    return 301 https://www.example.com$request_uri;\n}\n</code></pre>\n\n<p>EDIT:\nmy load balancer:\n<a href=\"https://i.stack.imgur.com/vizGZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vizGZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am using AMI Linux running Ruby on Rails app in AWS. Thanks!!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 739, "user_id": 5264622, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8c530c5bb784322a20d4146cf82afd5?s=128&d=identicon&r=PG", "display_name": "Harfangk", "link": "https://stackoverflow.com/users/5264622/harfangk"}, "edited": false, "score": 2, "creation_date": 1456288395, "post_id": 35593261, "comment_id": 58872679, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18089562/how-do-i-keep-the-delimiters-when-splitting-a-ruby-string\">How do I keep the delimiters when splitting a Ruby string?</a>"}, {"owner": {"reputation": 4592, "user_id": 2821954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KAcfF.png?s=128&g=1", "display_name": "Andrew T.", "link": "https://stackoverflow.com/users/2821954/andrew-t"}, "edited": false, "score": 0, "creation_date": 1457676147, "post_id": 35593261, "comment_id": 59523628, "body": "Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>. Take note that we now have <a href=\"https://ja.stackoverflow.com\">\u30b9\u30bf\u30c3\u30af\u30fb\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc</a> (Stack Overflow\u306e\u65e5\u672c\u8a9e\u7248)."}], "answers": [{"tags": [], "owner": {"reputation": 13635, "user_id": 4494, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5981dd7d253ecf61590502eeb183ee7b?s=128&d=identicon&r=PG", "display_name": "Matthias Winkelmann", "link": "https://stackoverflow.com/users/4494/matthias-winkelmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1456396427, "last_edit_date": 1456396427, "creation_date": 1456289125, "answer_id": 35593446, "question_id": 35593261, "link": "https://stackoverflow.com/questions/35593261/rails-split-text-including-dollar-end-euro/35593446#35593446", "title": "Rails: Split text including dollar end euro", "body": "<p>It needs a regular expression. This works: </p>\n\n<pre><code>\"$100,000\u00a3230,000$40,000$9,000$600$800,000\".scan(/([^\\d][0-9,]+)/)\n\n    =&gt; [[\"$100,000\"], \n[\"\u00a3230,000\"], \n[\"$40,000\"], \n[\"$9,000\"], \n[\"$600\"], \n[\"$800,000\"]]\n</code></pre>\n\n<p>The regex contains these parts:</p>\n\n<ul>\n<li><code>[^\\d]</code>: A character class matching a single non-digit. This will match the currency symbol.</li>\n<li>`[0-9,]+': Another character class, this time repeating (the '+'). It matches the numeric part (0-9) plus the thousand's separator.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1328, "user_id": 542995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fPDiC.jpg?s=128&g=1", "display_name": "zdk", "link": "https://stackoverflow.com/users/542995/zdk"}, "is_accepted": true, "score": 2, "last_activity_date": 1456289210, "creation_date": 1456289210, "answer_id": 35593462, "question_id": 35593261, "link": "https://stackoverflow.com/questions/35593261/rails-split-text-including-dollar-end-euro/35593462#35593462", "title": "Rails: Split text including dollar end euro", "body": "<p>you're almost there,\njust use the positive lookahead :)</p>\n\n<pre><code>irb(main):005:0&gt; \"$100,000\u00a3230,000$40,000$9,000\u20ac600$800,000\".split(/(?=[$\u00a3\u20ac])/)\n=&gt; [\"$100,000\", \"\u00a3230,000\", \"$40,000\", \"$9,000\", \"\u20ac600\", \"$800,000\"]\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5971867, "user_type": "registered", "profile_image": "https://graph.facebook.com/997990456948194/picture?type=large", "display_name": "Kosaburo Kaneko", "link": "https://stackoverflow.com/users/5971867/kosaburo-kaneko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 35593462, "answer_count": 2, "score": 1, "last_activity_date": 1456398311, "creation_date": 1456288022, "last_edit_date": 1456398311, "question_id": 35593261, "link": "https://stackoverflow.com/questions/35593261/rails-split-text-including-dollar-end-euro", "title": "Rails: Split text including dollar end euro", "body": "<p>I'm using Rails and Nokogiri and I'm trying to parse some website.<br>\nThis is where I'm stuck:</p>\n\n<pre><code>doc.css('#example &gt; li:nth-child(1)').each do |node|\n    money = node.xpath('//*ul/li/div/span').text\nend\n</code></pre>\n\n<p>It returns something like:</p>\n\n<pre><code>$100,000\u00a3230,000$40,000$9,000\u20ac600$800,000\n</code></pre>\n\n<p>I want to split those items, save them to the database and finally hand them to the view.</p>\n\n<p>So, in the view, I want it to appear like:<br></p>\n\n<p>(1)$100,000<br>\n(2)\u00a3230,000<br>\n(3)$40,000<br>\n(4)$9,000<br>\n(5)\u20ac600<br>\n(6)$800,000<br></p>\n\n<p>I tried to split those items by this code below.<br></p>\n\n<pre><code>money = node.xpath('//*ul/li/div/span').text.split(/[$\u20ac\u00a3]/)\n</code></pre>\n\n<p>but the result looks like this:<br></p>\n\n<pre><code>[\"\", \"100,000\", \"230,000\", \"40,000\", \"9,000\", \"600\", \"800,000\"]\n</code></pre>\n\n<p>And I don't know which item is in Dollar, Euro, or Pond.<br>\nIs there any good way to solve this problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "stripe-payments"], "comments": [{"owner": {"reputation": 11857, "user_id": 2193439, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/0FtsF.jpg?s=128&g=1", "display_name": "Abrar Jahin", "link": "https://stackoverflow.com/users/2193439/abrar-jahin"}, "edited": false, "score": 0, "creation_date": 1456289882, "post_id": 35593203, "comment_id": 58873117, "body": "Can u please specify what error u are getting?  Any screen shot?"}, {"owner": {"reputation": 71, "user_id": 5860635, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/413d0e38bbde79bae7b2c395f798b3a2?s=128&d=identicon&r=PG&f=1", "display_name": "hujihuji", "link": "https://stackoverflow.com/users/5860635/hujihuji"}, "reply_to_user": {"reputation": 11857, "user_id": 2193439, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/0FtsF.jpg?s=128&g=1", "display_name": "Abrar Jahin", "link": "https://stackoverflow.com/users/2193439/abrar-jahin"}, "edited": false, "score": 0, "creation_date": 1456290455, "post_id": 35593203, "comment_id": 58873306, "body": "Stripe::InvalidRequestError in ChargesController#create"}, {"owner": {"reputation": 71, "user_id": 5860635, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/413d0e38bbde79bae7b2c395f798b3a2?s=128&d=identicon&r=PG&f=1", "display_name": "hujihuji", "link": "https://stackoverflow.com/users/5860635/hujihuji"}, "reply_to_user": {"reputation": 11857, "user_id": 2193439, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/0FtsF.jpg?s=128&g=1", "display_name": "Abrar Jahin", "link": "https://stackoverflow.com/users/2193439/abrar-jahin"}, "edited": false, "score": 0, "creation_date": 1456290468, "post_id": 35593203, "comment_id": 58873314, "body": "You cannot use a Stripe token more than once"}, {"owner": {"reputation": 71, "user_id": 5860635, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/413d0e38bbde79bae7b2c395f798b3a2?s=128&d=identicon&r=PG&f=1", "display_name": "hujihuji", "link": "https://stackoverflow.com/users/5860635/hujihuji"}, "reply_to_user": {"reputation": 11857, "user_id": 2193439, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/0FtsF.jpg?s=128&g=1", "display_name": "Abrar Jahin", "link": "https://stackoverflow.com/users/2193439/abrar-jahin"}, "edited": false, "score": 0, "creation_date": 1456291113, "post_id": 35593203, "comment_id": 58873547, "body": "How am I supposed to change the codes above??"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5860635, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/413d0e38bbde79bae7b2c395f798b3a2?s=128&d=identicon&r=PG&f=1", "display_name": "hujihuji", "link": "https://stackoverflow.com/users/5860635/hujihuji"}, "edited": false, "score": 0, "creation_date": 1456378246, "post_id": 35600853, "comment_id": 58920899, "body": "Ok. Thank you Ywain. So Could you give some specific examples about what the code should look like?"}], "tags": [], "owner": {"reputation": 14821, "user_id": 5307473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oHbg3.jpg?s=128&g=1", "display_name": "Ywain", "link": "https://stackoverflow.com/users/5307473/ywain"}, "is_accepted": false, "score": 2, "last_activity_date": 1456313133, "creation_date": 1456313133, "answer_id": 35600853, "question_id": 35593203, "link": "https://stackoverflow.com/questions/35593203/i-get-error-that-you-cannot-use-a-stripe-token-more-than-once/35600853#35600853", "title": "I get error that You cannot use a Stripe token more than once", "body": "<p>Your code is correct. However, this error message means that the card token you're trying to use in your customer creation request (in the <code>params[:stripeToken]</code> variable) has already been used.</p>\n\n<p>Stripe tokens can only be used in a single request. Afterwards, the token is consumed and cannot be used again.</p>\n\n<p>You'd have to create a new card token, using <a href=\"https://stripe.com/docs/checkout\" rel=\"nofollow\">Checkout</a> or <a href=\"https://stripe.com/docs/stripe.js\" rel=\"nofollow\">Stripe.js</a>, or directly by using the <a href=\"https://stripe.com/docs/api#create_card_token\" rel=\"nofollow\">create token</a> API endpoint.</p>\n"}], "owner": {"reputation": 71, "user_id": 5860635, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/413d0e38bbde79bae7b2c395f798b3a2?s=128&d=identicon&r=PG&f=1", "display_name": "hujihuji", "link": "https://stackoverflow.com/users/5860635/hujihuji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3852, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456313133, "creation_date": 1456287646, "question_id": 35593203, "link": "https://stackoverflow.com/questions/35593203/i-get-error-that-you-cannot-use-a-stripe-token-more-than-once", "title": "I get error that You cannot use a Stripe token more than once", "body": "<p>I run my local server using stripe and I got error when I submitted my payment form. </p>\n\n<pre><code>class ChargesController &lt; ApplicationController\n\n  def create\n   //below is the reason I got error for \n    customer = Stripe::Customer.create(\n      :email =&gt; params[:stripeEmail],\n      :source  =&gt; params[:stripeToken]\n    )\n\n    charge = Stripe::Charge.create(\n      :customer    =&gt; customer.id,\n      :amount      =&gt; params[:amount],\n      :description =&gt; 'Growth Hacking Crash Course',\n      :currency    =&gt; 'jpy'\n    )\n\n    purchase = Purchase.create(email: params[:stripeEmail], card: params[:stripeToken], amount: params[:amount], description: charge.description, currency: charge.currency, customer_id: customer.id, product_id: 1, uuid: SecureRandom.uuid)\n\n    redirect_to purchase\n\n  rescue Stripe::CardError =&gt; e\n    flash[:error] = e.message\n    redirect_to new_charge_path\n  end\n\n\nend\n</code></pre>\n\n<p>I don't know why I get that error. I need your help!!!</p>\n"}, {"tags": ["html", "css", "ruby", "web-applications"], "comments": [{"owner": {"reputation": 1166, "user_id": 2458437, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/100001230751686/picture?type=large", "display_name": "S.E. Chahine", "link": "https://stackoverflow.com/users/2458437/s-e-chahine"}, "edited": false, "score": 0, "creation_date": 1456289792, "post_id": 35593189, "comment_id": 58873086, "body": "You&#39;re not gonna get any help if you don&#39;t post any code. What do you have so far?"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1456296968, "post_id": 35593189, "comment_id": 58875943, "body": "Are you using any web framework like Rails, Sinatra, Hanami, ?"}, {"owner": {"reputation": 25, "user_id": 5536502, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/17d45b2c51edbdc24b7c715b242d29c7?s=128&d=identicon&r=PG", "display_name": "Sarthak", "link": "https://stackoverflow.com/users/5536502/sarthak"}, "edited": false, "score": 0, "creation_date": 1456309405, "post_id": 35593189, "comment_id": 58883493, "body": "No I am not using any of the frame work"}], "answers": [{"tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1456307505, "last_edit_date": 1495540768, "creation_date": 1456307505, "answer_id": 35598657, "question_id": 35593189, "link": "https://stackoverflow.com/questions/35593189/retrieve-data-that-has-been-entered-on-a-page-to-a-program/35598657#35598657", "title": "Retrieve data that has been entered on a page to a program", "body": "<p>Just guessing what you want, if not correct please provide more info and the meanigfull parts of what you tried in code.</p>\n\n<p>Take a look at the accepted answer for my question at <a href=\"http://use-browser-as-gui-in-ruby\" rel=\"nofollow noreferrer\">https://stackoverflow.com/questions/11724201/use-browser-as-gui-in-ruby</a></p>\n\n<p>Here part of what  <a href=\"https://stackoverflow.com/users/1200545/justin-ko\">Justin Ko</a> answered</p>\n\n<pre><code>require 'watir'\n\nb = Watir::IE.new\nbegin\n    b.goto('file:///C:/Documents%20and%20Settings/Setup/Desktop/test.htm')\n    begin\n        sleep(5)\n    end until b.button(:id, 'submit').value != \"OK\"\n    name = b.text_field.value\nensure\n    b.close\nend\nputs name\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5536502, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/17d45b2c51edbdc24b7c715b242d29c7?s=128&d=identicon&r=PG", "display_name": "Sarthak", "link": "https://stackoverflow.com/users/5536502/sarthak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1456307505, "creation_date": 1456287570, "question_id": 35593189, "link": "https://stackoverflow.com/questions/35593189/retrieve-data-that-has-been-entered-on-a-page-to-a-program", "title": "Retrieve data that has been entered on a page to a program", "body": "<p>I want to retrieve information from a form I have created using HTML and CSS to my Ruby program and apply some operation and redirect to another page accordingly. Since I am a beginner so I don't have much knowledge about web development so if please anyone could help!!!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "devise"], "comments": [{"owner": {"reputation": 1, "user_id": 7769846, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c76ca4b5367a358621ed98353dbce526?s=128&d=identicon&r=PG", "display_name": "Jia Jing", "link": "https://stackoverflow.com/users/7769846/jia-jing"}, "edited": false, "score": 0, "creation_date": 1490539562, "post_id": 35593160, "comment_id": 73146032, "body": "Please refer to this <a href=\"http://stackoverflow.com/questions/27953848/devise-rendering-default-views-from-gem-instead-of-generated-ones\" title=\"devise rendering default views from gem instead of generated ones\">stackoverflow.com/questions/27953848/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1456303310, "creation_date": 1456303310, "answer_id": 35597165, "question_id": 35593160, "link": "https://stackoverflow.com/questions/35593160/gem-devise-dont-working-render-view-in-folder-project/35597165#35597165", "title": "gem Devise don&#39;t working render view in folder project", "body": "<p>Try to update the codes in</p>\n\n<p><code>app/views/devise/registrations/new.html.erb</code></p>\n\n<p>that is the default sign_up page when using <strong>Devise</strong>.</p>\n\n<p>If you plan to use different page, you need to update the <strong>Routes</strong>.</p>\n\n<p>It's a little more work than, changing the file as mentioned above.\nBecause it has functions in controller as well.</p>\n"}], "owner": {"reputation": 73, "user_id": 4799237, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/beeff7737c90568ecd99e85ffc560c2f?s=128&d=identicon&r=PG&f=1", "display_name": "b&#225;ch tr\u1ea7n nguy&#234;n", "link": "https://stackoverflow.com/users/4799237/b%c3%a1ch-tr%e1%ba%a7n-nguy%c3%aan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456303310, "creation_date": 1456287439, "question_id": 35593160, "link": "https://stackoverflow.com/questions/35593160/gem-devise-dont-working-render-view-in-folder-project", "title": "gem Devise don&#39;t working render view in folder project", "body": "<p>i want to custom view sign_up use deveise\n i use: </p>\n\n<pre><code>rails generate devise:views groups/brokers/buyer -v registrations confirmationsbuyer\n</code></pre>\n\n<p>and i custom code in file</p>\n\n<pre><code>  app/views/groups/brokers/buyer/registrations/new.html\n</code></pre>\n\n<p>but when i run this, it render to view html file in gem folder</p>\n\n<pre><code>Started GET \"/buyers/sign_up\" for 127.0.0.1 at 2016-02-24 11:10:00 +0700\nProcessing by Devise::RegistrationsController#new as HTML\nRendered /home/.../.rvm/gems/ruby-2.1.4@rails3.2.2/gems/devise-3.5.6/app/views/devise/shared/_links.html.erb (0.3ms)\nRendered /home/.../.rvm/gems/ruby-2.1.4@rails3.2.2/gems/devise-3.5.6/app/views/devise/registrations/new.html.erb within layouts/application (5.1ms)\n</code></pre>\n\n<p>i want to render to file new.html in app/view..\nhow to fix this???</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 1418703, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/086b3169fb1ba803945a292b75e1d4e4?s=128&d=identicon&r=PG", "display_name": "sandovalg", "link": "https://stackoverflow.com/users/1418703/sandovalg"}, "edited": false, "score": 0, "creation_date": 1456349988, "post_id": 35593254, "comment_id": 58911123, "body": "This worked well, thank you for a prompt response reading more on the routes differences."}], "tags": [], "owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "is_accepted": true, "score": 1, "last_activity_date": 1456287994, "creation_date": 1456287994, "answer_id": 35593254, "question_id": 35593058, "link": "https://stackoverflow.com/questions/35593058/rails4-custom-view-routing-with-id-query/35593254#35593254", "title": "Rails4 custom view routing with ID query", "body": "<p><code>collection</code> is for index views without an :id.  Use <code>member</code> if you need to show a specific record:</p>\n\n<pre><code>resources :samples do\n  member do\n    get :custom_show_view\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 1418703, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/086b3169fb1ba803945a292b75e1d4e4?s=128&d=identicon&r=PG", "display_name": "sandovalg", "link": "https://stackoverflow.com/users/1418703/sandovalg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 1, "accepted_answer_id": 35593254, "answer_count": 1, "score": 0, "last_activity_date": 1456287994, "creation_date": 1456286874, "question_id": 35593058, "link": "https://stackoverflow.com/questions/35593058/rails4-custom-view-routing-with-id-query", "title": "Rails4 custom view routing with ID query", "body": "<p>I am attempting to create a second \"show\" view in my controller. I have added the following to my controller for the initial show view:</p>\n\n<pre><code>def show\n  Sample.find(:id)\nend \n</code></pre>\n\n<p>This works just fine in fact it can also work as:</p>\n\n<pre><code>def show\nend\n</code></pre>\n\n<p>Now I am attempting to create a new view which we can call 'custom_show_view.html.erb'</p>\n\n<p>I add it to the controller as:</p>\n\n<pre><code>def custom_show_view\n  Sample.find(:id)\nend\n</code></pre>\n\n<p>However when I try to call it I acquire an error with the URI (<a href=\"http://localhost/samples/custom_show_view/4\" rel=\"nofollow\">http://localhost/samples/custom_show_view/4</a>) where <code>4</code> is the query for the active record id.</p>\n\n<p>In my routes I added:</p>\n\n<pre><code>resources :samples do\n  collection do\n    get :custom_show_view\n  end\nend\n</code></pre>\n\n<p>But it only allows for a get of the page without the ID variable. Please advise. </p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1456287494, "post_id": 35592739, "comment_id": 58872407, "body": "When you give an example, please assign variables to all input objects. For example, <code>arr = [[[&quot;val1&quot;,..]]]</code>. That way readers can refer to <code>arr</code> in comments and answers without having to define it."}, {"owner": {"reputation": 11718, "user_id": 1827631, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/I24JN.png?s=128&g=1", "display_name": "hirolau", "link": "https://stackoverflow.com/users/1827631/hirolau"}, "edited": false, "score": 0, "creation_date": 1456305863, "post_id": 35592739, "comment_id": 58880896, "body": "I have seen your questions here a few times now. Just a tip, maybe you should not use array of arrays. Maybe a Hash would be a better data structure for you data?"}], "answers": [{"tags": [], "owner": {"reputation": 3566, "user_id": 5026139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fbf86a3072e85746a0dde45665322890?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/5026139/damon"}, "is_accepted": false, "score": 2, "last_activity_date": 1456289059, "last_edit_date": 1456289059, "creation_date": 1456285444, "answer_id": 35592834, "question_id": 35592739, "link": "https://stackoverflow.com/questions/35592739/arrayjoin-on-nested-arrays-only/35592834#35592834", "title": "`Array#join` on nested arrays only", "body": "<p>Do the following to your <code>array</code></p>\n\n<pre><code>array.map {|el| el.flatten}\n</code></pre>\n\n<p><strong>Edit</strong> : Per your update, you can accomplish joining the deeply nested arrays as follows:</p>\n\n<pre><code>array.map {|x| x.map {|y| y.is_a?(Array) ? y.join(', ') : y}}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1675, "user_id": 3234020, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/82171ee5bc1b2139a9834c92ce52b4c7?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3234020/rob"}, "edited": false, "score": 0, "creation_date": 1456286220, "post_id": 35592835, "comment_id": 58872032, "body": "Problem with flatten is that I need to have the array values in one string seperated by a comma. Thats why I went with <code>.join</code>"}], "tags": [], "owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "is_accepted": false, "score": 0, "last_activity_date": 1456285452, "creation_date": 1456285452, "answer_id": 35592835, "question_id": 35592739, "link": "https://stackoverflow.com/questions/35592739/arrayjoin-on-nested-arrays-only/35592835#35592835", "title": "`Array#join` on nested arrays only", "body": "<p>You can do it by concatenating it inside a loop.</p>\n\n<pre><code>arr = [[\"val1\", [\"The cat\", \"3\"]], [\"val2\", [\"Big\", \"Another\", \"6\"]], [\"val3\", [\"343\"]]\n\narr.map{|a| [a.first] + a.last}\n#=&gt; [[\"val1\", \"The cat\", \"3\"], [\"val2\", \"Big\", \"Another\", \"6\"], [\"val3\", \"343\"]]\n</code></pre>\n\n<p>Or simply <code>flatten</code> in inner arrays:</p>\n\n<pre><code>arr.map(&amp;:flatten)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14642, "user_id": 7919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800078ddbf84f5b7232e6fcb460ecceb?s=128&d=identicon&r=PG", "display_name": "glenn mcdonald", "link": "https://stackoverflow.com/users/7919/glenn-mcdonald"}, "is_accepted": false, "score": 1, "last_activity_date": 1456285722, "creation_date": 1456285722, "answer_id": 35592879, "question_id": 35592739, "link": "https://stackoverflow.com/questions/35592739/arrayjoin-on-nested-arrays-only/35592879#35592879", "title": "`Array#join` on nested arrays only", "body": "<p>map and flatten are your friends!</p>\n\n<pre><code>a.map(&amp;:flatten)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1675, "user_id": 3234020, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/82171ee5bc1b2139a9834c92ce52b4c7?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3234020/rob"}, "edited": false, "score": 2, "creation_date": 1456288455, "post_id": 35593284, "comment_id": 58872701, "body": "Well @sawa its defiantly time I look into <code>map</code> you keep answering my questions with it. :)"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 2, "last_activity_date": 1456288164, "creation_date": 1456288164, "answer_id": 35593284, "question_id": 35592739, "link": "https://stackoverflow.com/questions/35592739/arrayjoin-on-nested-arrays-only/35593284#35593284", "title": "`Array#join` on nested arrays only", "body": "<pre><code>arr.map{|e, a| [e, a.join(\", \")]}\n# =&gt; [[\"val1\", \"The cat, 3\"], [\"val2\", \"Big, Another, 6\"], [\"val3\", \"343\"]]\n</code></pre>\n"}], "owner": {"reputation": 1675, "user_id": 3234020, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/82171ee5bc1b2139a9834c92ce52b4c7?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3234020/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 985, "favorite_count": 0, "accepted_answer_id": 35593284, "answer_count": 4, "score": 1, "last_activity_date": 1456289059, "creation_date": 1456284879, "last_edit_date": 1456288581, "question_id": 35592739, "link": "https://stackoverflow.com/questions/35592739/arrayjoin-on-nested-arrays-only", "title": "`Array#join` on nested arrays only", "body": "<p>I have an array of arrays. The second element of each subarray is further an array:</p>\n\n<pre><code>arr = [\n  [\"val1\", [\"The cat\", \"3\"]],\n  [\"val2\", [\"Big\", \"Another\", \"6\"]],\n  [\"val3\", [\"343\"]]\n]\n</code></pre>\n\n<p>I would like to convert the array so that the arrays at the third nested level are each joined into one string separated by a space and comma like this:</p>\n\n<pre><code>[[\"val1\", \"The cat, 3\"], [\"val2\", \"Big, Another, 6\"], [\"val3\", \"343\"]]\n</code></pre>\n\n<p>How do I call <code>join</code> on just the nested arrays?</p>\n"}, {"tags": ["ruby", "inheritance", "super"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1456282605, "post_id": 35592371, "comment_id": 58871027, "body": "What is <code>Combining Enclosing Square</code>?"}, {"owner": {"reputation": 281, "user_id": 4543383, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0f73a3cfe4be7fe228efb7a5a0b189e0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Byrd", "link": "https://stackoverflow.com/users/4543383/christopher-byrd"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1456282648, "post_id": 35592371, "comment_id": 58871039, "body": "It&#39;s a Unicode character."}, {"owner": {"reputation": 2212, "user_id": 4803039, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh3.googleusercontent.com/-MmbDSCFLpd8/AAAAAAAAAAI/AAAAAAAAADg/2jruEOH8FM0/photo.jpg?sz=128", "display_name": "philip yoo", "link": "https://stackoverflow.com/users/4803039/philip-yoo"}, "edited": false, "score": 0, "creation_date": 1456283434, "post_id": 35592371, "comment_id": 58871284, "body": "I&#39;m going a little off-topic here, but this seems a little funny to me: <code>@piece = &quot;#{@piece}\\u20DE&quot;</code>. It looks like <code>Piece</code> is the superclass, and you&#39;re initializing <code>@piece</code> using <code>@piece</code> + some unicode. But <code>@piece</code> isn&#39;t defined until that line, so wouldn&#39;t it always just be the unicode <code>\\u20DE</code>?"}, {"owner": {"reputation": 281, "user_id": 4543383, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0f73a3cfe4be7fe228efb7a5a0b189e0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Byrd", "link": "https://stackoverflow.com/users/4543383/christopher-byrd"}, "edited": false, "score": 0, "creation_date": 1456283698, "post_id": 35592371, "comment_id": 58871352, "body": "I think it&#39;s a poor choice of naming on my part. @piece is defined in the attr_accessor method in the Piece superclass, I think. I should probably change that to something else to make it less confusing."}], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1456295346, "post_id": 35592486, "comment_id": 58875206, "body": "You&#39;re defining a <code>piece=</code> setter but you never use it. Do you mean to do <code>self.piece = ...</code> instead of <code>@piece = ...</code>? The latter sets the instance variable directly and doesn&#39;t invoke the setter."}], "tags": [], "owner": {"reputation": 13635, "user_id": 4494, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5981dd7d253ecf61590502eeb183ee7b?s=128&d=identicon&r=PG", "display_name": "Matthias Winkelmann", "link": "https://stackoverflow.com/users/4494/matthias-winkelmann"}, "is_accepted": false, "score": 2, "last_activity_date": 1456295809, "last_edit_date": 1456295809, "creation_date": 1456283244, "answer_id": 35592486, "question_id": 35592371, "link": "https://stackoverflow.com/questions/35592371/ruby-class-inheritance-and-how-to-avoid-calling-super-twice/35592486#35592486", "title": "Ruby class inheritance and how to avoid calling super twice", "body": "<p>I'd define a setter. It's cleaner anyway.</p>\n\n<pre><code> class Piece\n  attr_accessor :color, :piece\n\n  def initialize(color)\n    @color = color\n    @piece = \"#{@piece}\\u20DE\"\n  end\n  def piece=(piece)\n    @piece = \"#{piece}\\u20DE\"\n  end\nend\n\nclass King &lt; Piece\n  def initialize(color)\n    super\n    self.piece = \"\u2654\" if @color == \"white\"\n    self.piece = \"\u265a\" if @color == \"black\"\n  end\nend\n\nk =  King.new('white')\nputs k.piece\nw = King.new('black')\nputs w.piece\n</code></pre>\n\n<p>Result: </p>\n\n<pre><code>$ ruby chess.rb\n\u2654\u20de\n\u265a\u20de\n</code></pre>\n\n<p>Two more things:</p>\n\n<ul>\n<li>Having a class Piece with an attribute @piece is confusing. </li>\n<li>Use attr_reader if you don't expect to modify @piece. (I'd say a pawn promotion is a new piece, not a pawn changing into a queen).</li>\n<li>Skip the setter, just define to_s, which adds some semantic value.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 2, "last_activity_date": 1456296690, "last_edit_date": 1456296690, "creation_date": 1456296206, "answer_id": 35595066, "question_id": 35592371, "link": "https://stackoverflow.com/questions/35592371/ruby-class-inheritance-and-how-to-avoid-calling-super-twice/35595066#35595066", "title": "Ruby class inheritance and how to avoid calling super twice", "body": "<p>Personally, I would move this logic out of the constructor entirely:</p>\n\n<pre><code>class Piece\n  attr_reader :color\n\n  def initialize(color)\n    @color = color\n  end\n\n  def piece\n    @piece ||= \"#{base_piece}\\u20DE\"\n  end\n  alias :to_s :piece\n\n  private\n  def base_piece\n    self.class.const_get(color.upcase)\n  end\nend\n\nclass King &lt; Piece\n  WHITE = \"\u2654\"\n  BLACK = \"\u265a\"\nend\n\nputs King.new(:black), King.new(:white)\n# =&gt; \u265a\u20de\n#    \u2654\u20de\n</code></pre>\n"}], "owner": {"reputation": 281, "user_id": 4543383, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0f73a3cfe4be7fe228efb7a5a0b189e0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Byrd", "link": "https://stackoverflow.com/users/4543383/christopher-byrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 35595066, "answer_count": 2, "score": 2, "last_activity_date": 1456296690, "creation_date": 1456282434, "last_edit_date": 1456282768, "question_id": 35592371, "link": "https://stackoverflow.com/questions/35592371/ruby-class-inheritance-and-how-to-avoid-calling-super-twice", "title": "Ruby class inheritance and how to avoid calling super twice", "body": "<p>I'm constructing a chess game. I'm trying to generate each chess piece with a Combining Enclosing Square, and while I can manually type it into each class, I'd like to do it through inheritance. I can't avoid calling <code>super</code> twice per subclass. I'd appreciate any help.</p>\n\n<p>Code: </p>\n\n<pre><code>class Piece\n  attr_accessor :color, :piece\n\n  def initialize(color)\n    @color = color\n    @piece = \"#{@piece}\\u20DE\"\n  end\nend\n\nclass King &lt; Piece\n  def initialize(color)\n    super\n    @piece = \"\u2654\" if @color == \"white\"\n    @piece = \"\u265a\" if @color == \"black\"\n    super\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "answers": [{"tags": [], "owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1456281758, "creation_date": 1456281758, "answer_id": 35592278, "question_id": 35592132, "link": "https://stackoverflow.com/questions/35592132/copy-contents-of-a-remote-location-to-a-local-file-in-ruby-script/35592278#35592278", "title": "copy contents of a remote location to a local file in ruby script", "body": "<p>Use <code>Net::SCP</code> (which requires Net::SSH) to transfer files:</p>\n\n<pre><code>Net::SCP.download!(\"remote.host.com\", \"username\",\n  \"/remote/path\", \"/local/path\",\n  :password =&gt; password)\n</code></pre>\n\n<p>More info here: <a href=\"https://rubygems.org/gems/net-scp\" rel=\"nofollow\">https://rubygems.org/gems/net-scp</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2851669"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 0, "accepted_answer_id": 35592278, "answer_count": 1, "score": 0, "last_activity_date": 1456281758, "creation_date": 1456280756, "question_id": 35592132, "link": "https://stackoverflow.com/questions/35592132/copy-contents-of-a-remote-location-to-a-local-file-in-ruby-script", "title": "copy contents of a remote location to a local file in ruby script", "body": "<p>I want to copy the contents of a remote location file to some local file after an ssh connection has been made.</p>\n\n<pre><code> begin\n    ssh = Net::SSH.start(\"localhost\", \"user\")\n    logger.info \"conn successful!\"\n    results = conn.exec!('ruby somefile \"#{arguments}\"')\n    #code to copy the contents of a.txt in remote location to local file\n    #IO.copy_stream (localfile, remotefile)\n rescue\n    logger.info \"error - cannot connect to host\"\n end\n</code></pre>\n\n<p>I tried using IO.copy_stream but that doesn't work. How do I go about this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "aasm"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 5971859, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gRQ7zdIVVGM/AAAAAAAAAAI/AAAAAAAAAKE/Y9rUeF8mxNA/photo.jpg?sz=128", "display_name": "Mateus Barbosa", "link": "https://stackoverflow.com/users/5971859/mateus-barbosa"}, "is_accepted": true, "score": 1, "last_activity_date": 1457759127, "creation_date": 1457759127, "answer_id": 35954009, "question_id": 35592118, "link": "https://stackoverflow.com/questions/35592118/is-there-a-way-using-aasm-with-states-and-transitions-configured-by-user/35954009#35954009", "title": "Is there a way using AASM with states and transitions configured by user?", "body": "<p>here is the final module file, it works like how I planned:</p>\n\n<pre><code>module WorkflowModule \n    def self.included(base)\n        base.send(:include, AASM)\n        base.send(:aasm, column: 'aasm_state', no_direct_assignment: false) do  \n            start_aasm(base)\n        end\n    end\n\n    def start_aasm(base)\n        State.where(entity: base.name.downcase).each_with_index do |state_database, index|\n            if index == 0\n                state state_database.name.to_sym, :initial =&gt; true\n            else\n                state state_database.name.to_sym\n            end\n        end\n        Transition\n            .joins(:workflow)\n            .where(workflows: { entity: base.name.downcase})\n            .each do |transition_database|\n                event transition_database.name.to_sym do\n                    transitions :from =&gt; State.where(state_from_id: transition_database.state_from_id).name.to_sym,\n                                :to =&gt; State.where(state_to_id: transition_database.state_to_id).name.to_sym\n                end\n        end\n    end\nend\n</code></pre>\n\n<p>here is my full example:\n<a href=\"https://github.com/mtsbarbosa/base_web_rails_app\" rel=\"nofollow\">https://github.com/mtsbarbosa/base_web_rails_app</a></p>\n"}], "owner": {"reputation": 41, "user_id": 5971859, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gRQ7zdIVVGM/AAAAAAAAAAI/AAAAAAAAAKE/Y9rUeF8mxNA/photo.jpg?sz=128", "display_name": "Mateus Barbosa", "link": "https://stackoverflow.com/users/5971859/mateus-barbosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 35954009, "answer_count": 1, "score": 1, "last_activity_date": 1457759127, "creation_date": 1456280665, "last_edit_date": 1457758830, "question_id": 35592118, "link": "https://stackoverflow.com/questions/35592118/is-there-a-way-using-aasm-with-states-and-transitions-configured-by-user", "title": "Is there a way using AASM with states and transitions configured by user?", "body": "<p>I am using AASM with rails and I have been searching around for a solution for my problem, i need to make a state machine system configured by user.</p>\n\n<p>Imagine this scenario: </p>\n\n<ol>\n<li>the user visit the States CRUD page</li>\n<li>the user creates a new state X and a new state Y for Project model</li>\n<li>the user creates a transition from state X to state Y for Project model</li>\n<li>the user visits Project show page</li>\n<li>the user can switch between the states he created for Project model</li>\n</ol>\n\n<p>Is there an easy way to implement these cases using AASM?</p>\n\n<p>I imagined something like this:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  include AASM\n\n  aasm do\n         State.where(model_name: 'Project').each do |database_state|\n           state database_state[:name], database_state[:initial]\n         end\n\n         Event.where(model_name: 'Project').each do |database_event|\n           ...\n         end\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "associations", "simple-form", "cocoon-gem"], "comments": [{"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1456475017, "post_id": 35591751, "comment_id": 58973881, "body": "Do you know which address is giving you the error? (e.g. the patient or the doctor). Because I suspect the <code>init</code> in <code>Doctor</code> might be responsible for this."}, {"owner": {"reputation": 3859, "user_id": 898378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ac0ee98f620ebb852ce092da0c5f32e0?s=128&d=identicon&r=PG", "display_name": "hook38", "link": "https://stackoverflow.com/users/898378/hook38"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1456720605, "post_id": 35591751, "comment_id": 59061473, "body": "It was the doctor. Any suggestion on how to fix this?"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1456740392, "post_id": 35591751, "comment_id": 59070160, "body": "Do not overrule the <code>init</code> method ;) afaik the preferred way is to define the special method <code>after_init</code> but even that is very dangerous, because your code might overrule existing associations (as you notice now too). I would just initialise an empty address in the controller for the doctor as you do for patient too."}, {"owner": {"reputation": 3859, "user_id": 898378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ac0ee98f620ebb852ce092da0c5f32e0?s=128&d=identicon&r=PG", "display_name": "hook38", "link": "https://stackoverflow.com/users/898378/hook38"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1456787908, "post_id": 35591751, "comment_id": 59100119, "body": "The thing is initialization using cacoon does not go through the controller... which means dynamically initialized doctors has no address..."}], "answers": [{"comments": [{"owner": {"reputation": 3859, "user_id": 898378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ac0ee98f620ebb852ce092da0c5f32e0?s=128&d=identicon&r=PG", "display_name": "hook38", "link": "https://stackoverflow.com/users/898378/hook38"}, "edited": false, "score": 0, "creation_date": 1456807054, "post_id": 35711837, "comment_id": 59105876, "body": "Another question, if the form failed validation but address fields were all empty, address will disappear on view. How should I prevent that while allowing_destroy on success submit of empty address fields?"}], "tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": true, "score": 2, "last_activity_date": 1456788529, "creation_date": 1456788529, "answer_id": 35711837, "question_id": 35591751, "link": "https://stackoverflow.com/questions/35591751/ruby-on-rails-4-dynamically-create-nested-association-inside-a-nested-associati/35711837#35711837", "title": "Ruby On Rails 4, dynamically create nested association inside a nested association", "body": "<p>You should not use the <code>init</code> method to initialise the address. Instead, you should use the <code>:wrap_object</code> option cocoon provides (<a href=\"https://github.com/nathanvda/cocoon#wrap_object\" rel=\"nofollow\">documentation</a>).</p>\n\n<p>For instance, in your case that would become something like</p>\n\n<pre><code>link_to_add_association 'add doctor', f, :doctors, wrap_object: Proc.new {|doctor| doctor.build_address; doctor }\n</code></pre>\n"}], "owner": {"reputation": 3859, "user_id": 898378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ac0ee98f620ebb852ce092da0c5f32e0?s=128&d=identicon&r=PG", "display_name": "hook38", "link": "https://stackoverflow.com/users/898378/hook38"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 35711837, "answer_count": 1, "score": 0, "last_activity_date": 1456788529, "creation_date": 1456278199, "last_edit_date": 1456366413, "question_id": 35591751, "link": "https://stackoverflow.com/questions/35591751/ruby-on-rails-4-dynamically-create-nested-association-inside-a-nested-associati", "title": "Ruby On Rails 4, dynamically create nested association inside a nested association", "body": "<p>I have 3 models</p>\n\n<pre><code>class Patient &lt; ActiveRecord::Base\n  has_one :address, as: :person\n  has_many :doctors\n  accepts_nested_attributes_for :address, :reject_if =&gt; :all_blank, :allow_destroy =&gt; true\n  validates_associated :address\n  accepts_nested_attributes_for :doctors, :reject_if =&gt; :all_blank, :allow_destroy =&gt; true\n  validates_associated :doctors\nend\n\nclass Doctor &lt; ActiveRecord::Base\n  after_initialize :init, unless: :persisted?\n  has_one :address, as: :person\n  belongs_to :patient\n  accepts_nested_attributes_for :address, :reject_if =&gt; :all_blank, :allow_destroy =&gt; true\n  validates_associated :address\n\n  def init\n    self.address ||= build_address\n  end\nend\n\nclass Address &lt; ActiveRecord::Base\n  belongs_to :person, polymorphic: true\nend\n</code></pre>\n\n<p>I am using simple_form and cacoon to handle my UI. \nI had to ask Specialist initialize address on Model level, other wise address of specialist does not get initialized for cacoon.</p>\n\n<p>in my controller, I initiate my Doctor and Address with </p>\n\n<pre><code>@patient.doctor.build\n@patient.address ||= Address.new\n</code></pre>\n\n<p>However, I got an error message if every inputs were blank for specialist's address.</p>\n\n<blockquote>\n  <p>SQLite3::ConstraintException: NOT NULL constraint failed: addresses.line_1: INSERT INTO \"addresses\" (\"person_type\", \"person_id\", \"created_at\", \"updated_at\") VALUES (?, ?, ?, ?)</p>\n</blockquote>\n\n<p>Does this mean it automatically generate address during save even though </p>\n\n<blockquote>\n  <p>accepts_nested_attributes_for :address, :reject_if => :all_blank, :allow_destroy => true </p>\n</blockquote>\n\n<p>was set?</p>\n\n<p>Is there any way to solve this? or is there a better way to achieve what I want?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oop", "object", "model"], "answers": [{"tags": [], "owner": {"reputation": 3807, "user_id": 733721, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/29kzY.jpg?s=128&g=1", "display_name": "Ryan K", "link": "https://stackoverflow.com/users/733721/ryan-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1456281320, "creation_date": 1456281320, "answer_id": 35592213, "question_id": 35591677, "link": "https://stackoverflow.com/questions/35591677/how-to-call-a-parent-class-and-instead-create-one-of-its-children/35592213#35592213", "title": "How to call a parent class and instead create one of it&#39;s children?", "body": "<p>You can use the <a href=\"http://apidock.com/rails/ActiveSupport/Inflector/constantize\" rel=\"nofollow\">constantize</a> or the <a href=\"http://apidock.com/rails/ActiveSupport/Inflector/safe_constantize\" rel=\"nofollow\">safe_constantize</a> methods to do that. What they do is take a string and try to return the class the string refers to. For instance:</p>\n\n<pre><code>\"BaseAlert\".safe_constantize\n=&gt; BaseAlert\n</code></pre>\n\n<p>or</p>\n\n<pre><code>def method_name(alert_type)\n  alert_type.safe_constantize.create()\nend\n</code></pre>\n\n<p>The difference between the two is <code>constantize</code> will throw an error if there isn't a match for the string, while <code>safe_constantize</code> will just return <code>nil</code>. Remember, if you pass in a underscored string (say <code>panic_alert</code>) then you would have to <a href=\"http://apidock.com/rails/String/camelize\" rel=\"nofollow\">camelize</a> it.</p>\n"}, {"tags": [], "owner": {"reputation": 3160, "user_id": 1266795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7855792dbc5f3b4c365344314e2b1ad6?s=128&d=identicon&r=PG", "display_name": "AndyV", "link": "https://stackoverflow.com/users/1266795/andyv"}, "is_accepted": false, "score": 0, "last_activity_date": 1456287983, "creation_date": 1456287983, "answer_id": 35593252, "question_id": 35591677, "link": "https://stackoverflow.com/questions/35591677/how-to-call-a-parent-class-and-instead-create-one-of-its-children/35593252#35593252", "title": "How to call a parent class and instead create one of it&#39;s children?", "body": "<p>What seems like a lifetime ago I created <a href=\"https://github.com/arvanasse/sti_factory\" rel=\"nofollow\">StiFactory</a> for this.  That said, I don't find much use for STI these days (hence the lack of maintenance).</p>\n"}, {"comments": [{"owner": {"reputation": 1743, "user_id": 1821450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/553ce41bacded4ae27ee3586a0f3c770?s=128&d=identicon&r=PG", "display_name": "mutant_city", "link": "https://stackoverflow.com/users/1821450/mutant-city"}, "edited": false, "score": 0, "creation_date": 1456868945, "post_id": 35594257, "comment_id": 59142822, "body": "This is the architecture I was looking for."}], "tags": [], "owner": {"reputation": 5962, "user_id": 115159, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ac02a81e50f368f6d5c7a14b99ce2469?s=128&d=identicon&r=PG", "display_name": "Dharam Gollapudi", "link": "https://stackoverflow.com/users/115159/dharam-gollapudi"}, "is_accepted": true, "score": 1, "last_activity_date": 1456292982, "creation_date": 1456292982, "answer_id": 35594257, "question_id": 35591677, "link": "https://stackoverflow.com/questions/35591677/how-to-call-a-parent-class-and-instead-create-one-of-its-children/35594257#35594257", "title": "How to call a parent class and instead create one of it&#39;s children?", "body": "<p>By making few changes to the class definitions, like subclassing the <code>Alert</code> from <code>ActiveRecord::Base</code> rather than <code>BaseAlert</code>, you could achieve what you are trying to accomplish.</p>\n\n<p>Following are the updated classes:</p>\n\n<pre><code># app/models/alert.rb\nclass Alert &lt; ActiveRecord::Base\n\nend\n\n# app/models/alerts/base_alert.rb\nmodule Alerts\n  class BaseAlert &lt; ::Alert\n\n  end\nend\n\n# app/models/alerts/panic_alert.rb\nmodule Alerts\n  class PanicAlert &lt; BaseAlert\n\n  end  \nend\n\n# app/models/alerts/hardware_alert.rb\nmodule Alerts\n  class HardwareAlert &lt; BaseAlert\n\n  end\nend \n</code></pre>\n\n<p>Following are few ways to create the subclasses from the base class:</p>\n\n<pre><code>@panic_alert = Alert.create!(\n  type: 'Alerts::PanicAlert', #this has to be string\n  #other attributes\n) \n\n@alert = Alert.new\n@alert.type = 'Alerts::PanicAlert' #this has to be string\n# assign other attributes, if necessary\n@alert.save \n\n@alert = Alert.new\n@panic_alert = @alert.becomes(Alerts::PanicAlert) #this has to be class\n# assign other attributes, if necessary\n@panic_alert.save\n</code></pre>\n"}], "owner": {"reputation": 1743, "user_id": 1821450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/553ce41bacded4ae27ee3586a0f3c770?s=128&d=identicon&r=PG", "display_name": "mutant_city", "link": "https://stackoverflow.com/users/1821450/mutant-city"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 35594257, "answer_count": 3, "score": 1, "last_activity_date": 1456292982, "creation_date": 1456277683, "question_id": 35591677, "link": "https://stackoverflow.com/questions/35591677/how-to-call-a-parent-class-and-instead-create-one-of-its-children", "title": "How to call a parent class and instead create one of it&#39;s children?", "body": "<p>I have a model directory structure like this:  </p>\n\n<pre><code>/alerts\n   base_alert.rb\n   panic_alert.rb\n   hardware_alert.rb\n\nalert.rb\n</code></pre>\n\n<p>With the /alerts/x_alert.rb models setup like this:</p>\n\n<pre><code>class base_alert &lt; ActiveRecord::Base\n    ...\nend\n\nclass panic_alert &lt; base_alert\n    ...\nend\n\nclass hardware_alert &lt; base_alert\n    ...\nend\n\netc.\n</code></pre>\n\n<p>Is there any way to call create on alert.rb in the top directory, and, based on a parameter passed, it would create one of the children instead of alert.rb.</p>\n\n<p>I.E.    Alert.create({type:\"panic_alert\"})</p>\n\n<p>And it would create and return one of the panic_alert types of alerts?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4.2"], "answers": [{"comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1456307063, "post_id": 35597674, "comment_id": 58881808, "body": "What if the user is using zsh? Or fish? Or tcsh? Or another shell? Also, this has no relation to the asked question."}], "tags": [], "owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1456304849, "creation_date": 1456304849, "answer_id": 35597674, "question_id": 35591543, "link": "https://stackoverflow.com/questions/35591543/error-installing-ruby-2-3-0-via-rvm/35597674#35597674", "title": "Error installing Ruby 2.3.0 via RVM", "body": "<p>First, check your <strong>rvm</strong>, if not found try to use:</p>\n\n<pre><code>echo \"source $HOME/.rvm/scripts/rvm\" &gt;&gt; ~/.bash_profile\n</code></pre>\n\n<p>or</p>\n\n<pre><code>echo \"source $HOME/.rvm/scripts/rvm\" &gt;&gt; ~/.bashrc\n</code></pre>\n\n<p>To load the RVM.</p>\n\n<p>Finally, you can use the suggested installation of @MattW.</p>\n"}], "owner": {"reputation": 907, "user_id": 4263980, "user_type": "registered", "accept_rate": 84, "profile_image": "https://lh6.googleusercontent.com/-06NEWHk2pGU/AAAAAAAAAAI/AAAAAAAAAGs/nz9TeWW82Hk/photo.jpg?sz=128", "display_name": "manshu", "link": "https://stackoverflow.com/users/4263980/manshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "accepted_answer_id": 35597674, "answer_count": 1, "score": 0, "last_activity_date": 1456306614, "creation_date": 1456276828, "question_id": 35591543, "link": "https://stackoverflow.com/questions/35591543/error-installing-ruby-2-3-0-via-rvm", "title": "Error installing Ruby 2.3.0 via RVM", "body": "<pre><code>    root@bubbling-brook:/# gem update --system\n/usr/local/rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/psych.rb:370:in `parse': (&lt;unknown&gt;): mapping values are not allowed in this context at line 11 column 52 (Psych::SyntaxError)\n    from /usr/local/rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/psych.rb:370:in `parse_stream'\n    from /usr/local/rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/psych.rb:318:in `parse'\n    from /usr/local/rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/psych.rb:245:in `load'\n    from /usr/local/rvm/rubies/ruby-2.2.2/lib/ruby/site_ruby/2.2.0/rubygems/config_file.rb:333:in `load_file'\n    from /usr/local/rvm/rubies/ruby-2.2.2/lib/ruby/site_ruby/2.2.0/rubygems/config_file.rb:198:in `initialize'\n    from /usr/local/rvm/rubies/ruby-2.2.2/lib/ruby/site_ruby/2.2.0/rubygems/gem_runner.rb:74:in `new'\n    from /usr/local/rvm/rubies/ruby-2.2.2/lib/ruby/site_ruby/2.2.0/rubygems/gem_runner.rb:74:in `do_configuration'\n    from /usr/local/rvm/rubies/ruby-2.2.2/lib/ruby/site_ruby/2.2.0/rubygems/gem_runner.rb:39:in `run'\n    from /usr/local/rvm/rubies/ruby-2.2.2/bin/gem:21:in `&lt;main&gt;'\n</code></pre>\n\n<p>Can anyone help me with this error. I am trying to install this on the remote server and bumping my head with this error. I have installed ruby successfully but rails is giving me issue. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 6671, "user_id": 5129131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j5HkF.jpg?s=128&g=1", "display_name": "Sergio Tapia", "link": "https://stackoverflow.com/users/5129131/sergio-tapia"}, "edited": false, "score": 0, "creation_date": 1456275094, "post_id": 35591241, "comment_id": 58868657, "body": "Right, but that means that for every <code>@product</code> I&#39;ll hit the database for every top review, correct? I&#39;m trying to avoid that altogether."}, {"owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "reply_to_user": {"reputation": 6671, "user_id": 5129131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j5HkF.jpg?s=128&g=1", "display_name": "Sergio Tapia", "link": "https://stackoverflow.com/users/5129131/sergio-tapia"}, "edited": false, "score": 0, "creation_date": 1456350219, "post_id": 35591241, "comment_id": 58911252, "body": "Yeah, for every product you&#39;ll make a query to find the top three reviews. The best you could do is 2 queries. I don&#39;t know if AR can take a modified association in the <code>includes</code> to pull just the top three and easily or not :/"}], "tags": [], "owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1456274945, "creation_date": 1456274945, "answer_id": 35591241, "question_id": 35591184, "link": "https://stackoverflow.com/questions/35591184/rails-model-scope-to-grab-top-3-records-ordered-by-a-field/35591241#35591241", "title": "Rails model scope to grab top 3 records ordered by a field", "body": "<p>I would suggest creating a dedicated scope for <code>top_reviews</code>.</p>\n\n<pre><code>class Product &lt;&lt; AR::Base\n  has_many :top_reviews, -&gt; {order(score: :desc).limit(3)}\nend\n\n...\n\n@product = Product.find(1)\n@product.top_reviews.each do |x|\n  puts x.title\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1456305555, "creation_date": 1456305555, "answer_id": 35597935, "question_id": 35591184, "link": "https://stackoverflow.com/questions/35591184/rails-model-scope-to-grab-top-3-records-ordered-by-a-field/35597935#35597935", "title": "Rails model scope to grab top 3 records ordered by a field", "body": "<p>What about like this,</p>\n\n<pre><code>@product.reviews.order(\"score DESC\").limit(3).each do |x|\n  puts x.title\nend \n</code></pre>\n"}], "owner": {"reputation": 6671, "user_id": 5129131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j5HkF.jpg?s=128&g=1", "display_name": "Sergio Tapia", "link": "https://stackoverflow.com/users/5129131/sergio-tapia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456305555, "creation_date": 1456274601, "question_id": 35591184, "link": "https://stackoverflow.com/questions/35591184/rails-model-scope-to-grab-top-3-records-ordered-by-a-field", "title": "Rails model scope to grab top 3 records ordered by a field", "body": "<p>I have a simple model association:</p>\n\n<pre><code>Product has_many Review\n</code></pre>\n\n<p>I iterated through the reviews for a product in my view, however, I only want to grab the top 3 reviews for a product, ordered by it's <code>score</code> integer field.</p>\n\n<p>I would like to do something like:</p>\n\n<pre><code>@product = Product.find(1).includes(:testimonials, :stores, :top_three_reasons)\n</code></pre>\n\n<p>Then just iterate through:</p>\n\n<pre><code>@product.reviews.each do |x|\n  puts x.title\nend \n</code></pre>\n\n<hr>\n\n<p>How can I accomplish this? Currently for every product, we include every single review, and it's really slow. We'd just like to include the top three reviews, to avoid repeat queries.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "sequel"], "comments": [{"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 1, "creation_date": 1456273055, "post_id": 35590821, "comment_id": 58868018, "body": "Why does it matter if the id column is not the 1st one?"}, {"owner": {"reputation": 183, "user_id": 150406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/YPJXJ.jpg?s=128&g=1", "display_name": "Ran Halprin", "link": "https://stackoverflow.com/users/150406/ran-halprin"}, "reply_to_user": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1456273189, "post_id": 35590821, "comment_id": 58868054, "body": "Not critical that it is the 1st one, but if possible it would be nice. The auto-increment is critical. Also would like to backfill existing rows."}, {"owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 0, "creation_date": 1456274191, "post_id": 35590821, "comment_id": 58868386, "body": "Shouldn&#39;t that be <code>add_primary_key</code> instead of <code>add_column</code>?"}, {"owner": {"reputation": 183, "user_id": 150406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/YPJXJ.jpg?s=128&g=1", "display_name": "Ran Halprin", "link": "https://stackoverflow.com/users/150406/ran-halprin"}, "edited": false, "score": 0, "creation_date": 1456274605, "post_id": 35590821, "comment_id": 58868511, "body": "add_primary_key makes an existing column a primary_key. I would like to add a new column that doesn&#39;t exist."}], "answers": [{"tags": [], "owner": {"reputation": 11331, "user_id": 132053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f183bcc4176b308c9edabe79299e448f?s=128&d=identicon&r=PG", "display_name": "Jeremy Evans", "link": "https://stackoverflow.com/users/132053/jeremy-evans"}, "is_accepted": true, "score": 2, "last_activity_date": 1468891148, "last_edit_date": 1468891148, "creation_date": 1456329839, "answer_id": 35607049, "question_id": 35590821, "link": "https://stackoverflow.com/questions/35590821/how-to-add-unique-auto-increment-first-id-column/35607049#35607049", "title": "How to add UNIQUE AUTO_INCREMENT FIRST id column", "body": "<p>This should work:</p>\n\n<pre><code>DB.add_column :myTable, :id, Bignum, null: false, unique: true, :auto_increment=&gt;true \n</code></pre>\n\n<p>Note that that doesn't give you <code>FIRST</code>. If you want <code>FIRST</code>, you'll have to use raw SQL:</p>\n\n<pre><code>DB.run \"ALTER TABLE `myTable` ADD COLUMN `id` INT AUTO_INCREMENT UNIQUE FIRST\"\n</code></pre>\n\n<p>The other difference is your SQL doesn't specify <code>NOT NULL</code>, but your Sequel code does.</p>\n"}], "owner": {"reputation": 183, "user_id": 150406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/YPJXJ.jpg?s=128&g=1", "display_name": "Ran Halprin", "link": "https://stackoverflow.com/users/150406/ran-halprin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 0, "accepted_answer_id": 35607049, "answer_count": 1, "score": 1, "last_activity_date": 1468891148, "creation_date": 1456272496, "last_edit_date": 1468891080, "question_id": 35590821, "link": "https://stackoverflow.com/questions/35590821/how-to-add-unique-auto-increment-first-id-column", "title": "How to add UNIQUE AUTO_INCREMENT FIRST id column", "body": "<p>I would like a database migration that is basically the following SQL:</p>\n\n<pre><code>ALTER TABLE `myTable` ADD COLUMN `id` INT AUTO_INCREMENT UNIQUE FIRST;\n</code></pre>\n\n<p>Is there a Sequel migration that does exactly this? I have gotten pretty close with the following, but it doesn't seem to be exactly what I want:</p>\n\n<pre><code>Sequel.migration do\n  change do\n    alter_table :my_table do\n      add_column :id, Bignum, null: false, unique: true\n    end\n  end\nend\n</code></pre>\n\n<p>Specifically, it seems to be missing auto-increment and won't be the first column.</p>\n"}, {"tags": ["ruby", "binary", "pack", "unpack"], "comments": [{"owner": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 1, "creation_date": 1456272302, "post_id": 35590730, "comment_id": 58867756, "body": "appears that #unpack actually returns/creates an array: <a href=\"http://ruby-doc.org/core-2.3.0/String.html#method-i-unpack\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.3.0/String.html#method-i-unpack</a>"}, {"owner": {"reputation": 23, "user_id": 5369827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d08a9f399c7dc2b43a630d444befeb0?s=128&d=identicon&r=PG&f=1", "display_name": "Kathyz", "link": "https://stackoverflow.com/users/5369827/kathyz"}, "reply_to_user": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 0, "creation_date": 1456273168, "post_id": 35590730, "comment_id": 58868047, "body": "Did you mean that I didn&#39;t create the binary file in the right way? So is there anything like &quot;binwrite&quot; to create the real binary file?"}, {"owner": {"reputation": 23, "user_id": 5369827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d08a9f399c7dc2b43a630d444befeb0?s=128&d=identicon&r=PG&f=1", "display_name": "Kathyz", "link": "https://stackoverflow.com/users/5369827/kathyz"}, "reply_to_user": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 0, "creation_date": 1456274087, "post_id": 35590730, "comment_id": 58868347, "body": "Thanks! I got it. I don&#39;t think I need to pack or unpack if I use binwrite and binread."}, {"owner": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 1, "creation_date": 1456291531, "post_id": 35590730, "comment_id": 58873690, "body": "Feel free to post your code with a working solution as an &quot;answer your own question&quot; answer..."}], "owner": {"reputation": 23, "user_id": 5369827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d08a9f399c7dc2b43a630d444befeb0?s=128&d=identicon&r=PG&f=1", "display_name": "Kathyz", "link": "https://stackoverflow.com/users/5369827/kathyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 807, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456272246, "creation_date": 1456271973, "last_edit_date": 1456272246, "question_id": 35590730, "link": "https://stackoverflow.com/questions/35590730/ruby-write-and-read-into-binary-file-using-pack-and-unpack", "title": "Ruby write and read into binary file using pack and unpack", "body": "<p>I'm working on the basic Ruby read/write for binary files. </p>\n\n<p>Here is my code</p>\n\n<pre><code>afile = File.new(\"test.bin\",'wb')\n\ntest = \"abc\"\na = test.unpack(\"B*\")\n\nFile.open(\"test.bin\", 'wb' ) do |output|\n  output.write a\nend\n\nprint (\"write #{a}\\n\") #Output \"write [\"011000010110001001100011\"]\n\nb = a.pack(\"B*\")\nprint (\"b is #{b}\\n\") #Output \"b is abc\"\n</code></pre>\n\n<p>So far everything looks good. Then I tried to read from the file and turn it back to the ASCII form.</p>\n\n<pre><code>s = File.binread(\"test.bin\")\nbits = s.pack(\"B*\")\n\nprint (\"s is #{s}\\n\") #Output is \"s is [\"011000010110001001100011\"]\"\nprint (\"bits is #{bits}\\n\")\n</code></pre>\n\n<p>Then there's an error. </p>\n\n<p>\" extract.ruby:23:in <code>&lt;main&gt;': undefined method</code>pack' for \"[\\\"011000010110001001100011\\\"]\":String (NoMethodError) \"</p>\n\n<p>Could anyone help me to explain this? Thanks a lot!</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 643, "user_id": 4906941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CL1pN.png?s=128&g=1", "display_name": "Jeremy Rajan", "link": "https://stackoverflow.com/users/4906941/jeremy-rajan"}, "edited": false, "score": 0, "creation_date": 1456281920, "post_id": 35590675, "comment_id": 58870802, "body": "What are using to run MySQL server, is it WAMP or something similar?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5971512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f683c2bad548714fe3228d4b5d5e32?s=128&d=identicon&r=PG&f=1", "display_name": "Maikelele", "link": "https://stackoverflow.com/users/5971512/maikelele"}, "edited": false, "score": 0, "creation_date": 1456280083, "post_id": 35590762, "comment_id": 58870241, "body": "No I am using windows 10."}, {"owner": {"reputation": 83, "user_id": 4032470, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "David T", "link": "https://stackoverflow.com/users/4032470/david-t"}, "reply_to_user": {"reputation": 45, "user_id": 5971512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f683c2bad548714fe3228d4b5d5e32?s=128&d=identicon&r=PG&f=1", "display_name": "Maikelele", "link": "https://stackoverflow.com/users/5971512/maikelele"}, "edited": false, "score": 0, "creation_date": 1456284233, "post_id": 35590762, "comment_id": 58871501, "body": "How did you install Ruby on Rails? Have you installed MySQL Server on your development machine?"}, {"owner": {"reputation": 45, "user_id": 5971512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f683c2bad548714fe3228d4b5d5e32?s=128&d=identicon&r=PG&f=1", "display_name": "Maikelele", "link": "https://stackoverflow.com/users/5971512/maikelele"}, "edited": false, "score": 0, "creation_date": 1456289469, "post_id": 35590762, "comment_id": 58872991, "body": "I used the installer from <a href=\"http://rubyinstaller.org/\" rel=\"nofollow noreferrer\">rubyinstaller.org</a> I thought it already came with the MySQL Server. I also have xampp installed if that means anything."}, {"owner": {"reputation": 83, "user_id": 4032470, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "David T", "link": "https://stackoverflow.com/users/4032470/david-t"}, "reply_to_user": {"reputation": 45, "user_id": 5971512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f683c2bad548714fe3228d4b5d5e32?s=128&d=identicon&r=PG&f=1", "display_name": "Maikelele", "link": "https://stackoverflow.com/users/5971512/maikelele"}, "edited": false, "score": 0, "creation_date": 1456351886, "post_id": 35590762, "comment_id": 58912171, "body": "You actually want <a href=\"http://railsinstaller.org/en\" rel=\"nofollow noreferrer\">RailsInstaller</a> instead. Ruby is just one part to Ruby on Rails. Check out <a href=\"http://installrails.com/\" rel=\"nofollow noreferrer\">InstallRails</a> for some step-by-step guides that will get you up and running!"}, {"owner": {"reputation": 45, "user_id": 5971512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f683c2bad548714fe3228d4b5d5e32?s=128&d=identicon&r=PG&f=1", "display_name": "Maikelele", "link": "https://stackoverflow.com/users/5971512/maikelele"}, "edited": false, "score": 0, "creation_date": 1456360386, "post_id": 35590762, "comment_id": 58915478, "body": "My mistake I meant RailsInstaller. I just realized however I forgot to add the socket and point it to xampp&#39;s mysql. The server seems to be working now that I have the socket added."}], "tags": [], "owner": {"reputation": 83, "user_id": 4032470, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "David T", "link": "https://stackoverflow.com/users/4032470/david-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1456272186, "creation_date": 1456272186, "answer_id": 35590762, "question_id": 35590675, "link": "https://stackoverflow.com/questions/35590675/ruby-on-rails-mysql2error-cant-connect-to-mysql-server-on-localhost-100/35590762#35590762", "title": "Ruby on Rails - Mysql2::Error: Can&#39;t connect to MySQL server on &#39;localhost&#39; (10061)", "body": "<p>Assuming you're running Linux, try the following command to see if MySQL is running:</p>\n\n<p><code>/etc/init.d/mysql status</code></p>\n\n<p>Make sure you're specifying a <code>database</code> name to connect to as well, but that would likely give you a different error code than the one you're seeing.</p>\n"}], "owner": {"reputation": 45, "user_id": 5971512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f683c2bad548714fe3228d4b5d5e32?s=128&d=identicon&r=PG&f=1", "display_name": "Maikelele", "link": "https://stackoverflow.com/users/5971512/maikelele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2007, "favorite_count": 0, "accepted_answer_id": 35590762, "answer_count": 1, "score": 1, "last_activity_date": 1456280129, "creation_date": 1456271684, "last_edit_date": 1456280129, "question_id": 35590675, "link": "https://stackoverflow.com/questions/35590675/ruby-on-rails-mysql2error-cant-connect-to-mysql-server-on-localhost-100", "title": "Ruby on Rails - Mysql2::Error: Can&#39;t connect to MySQL server on &#39;localhost&#39; (10061)", "body": "<p>Hey I'm just getting started with Ruby on Rails and need some help. I installed Ruby on Rails and then created a project with MySQL but I am unable to connect to the MySQL server to create a database. Side note I am using Windows 10.</p>\n\n<p>After running the command (rake db:create) I get this error.<br>\n<code>#&lt;Mysql2::Error: Can't connect to MySQL server on 'localhost' (10061)&gt;</code></p>\n\n<p>Here is my database.yml file<br></p>\n\n<pre><code>default: &amp;default\n  adapter: mysql2\n  encoding: utf8\n  pool: 5\n  username: root\n  password: 1234\n  host: localhost\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "pundit", "cancancan"], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 4032470, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "David T", "link": "https://stackoverflow.com/users/4032470/david-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1456272392, "creation_date": 1456272392, "answer_id": 35590801, "question_id": 35590573, "link": "https://stackoverflow.com/questions/35590573/admin-user-approving-sql-changes-from-a-user/35590801#35590801", "title": "Admin user approving SQL changes from a user", "body": "<p>By statement, do you mean that your users are actually writing the SQL themselves? </p>\n\n<p>If not, I'd setup a second model identical to your first that acts like a queue of some sort that holds the proposed changes/additions. This way, you'll be able to compare the old and new statements if necessary, and, when approved, you'll be able to perform the <code>create</code>/<code>update</code> magic on your original model.</p>\n\n<p>Hope this gives you some ideas!</p>\n"}], "owner": {"reputation": 65, "user_id": 2159428, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/pBNCM.gif?s=128&g=1", "display_name": "jimps", "link": "https://stackoverflow.com/users/2159428/jimps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456272392, "creation_date": 1456271270, "question_id": 35590573, "link": "https://stackoverflow.com/questions/35590573/admin-user-approving-sql-changes-from-a-user", "title": "Admin user approving SQL changes from a user", "body": "<p>I've read into Cancan and Pundit (also Devise) for managing users in a Rails App. But I wanted to know if something was possible. </p>\n\n<p>Basically, I want to have users change/add lines in a table (using SQLite at the moment, but will be moving to SQL in the future - call them entries). But before it gets added to the actual table, it gets sent to the admin for approval. Then the admin can just hit 'approve' and the statement gets run.</p>\n\n<p>I'm just confused about how to hold the statement and then when approved, the statement runs. Any information would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mixins", "activesupport", "activesupport-concern"], "comments": [{"owner": {"reputation": 12784, "user_id": 1373987, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bca7defe7b8087d8e261d32b29cf425e?s=128&d=identicon&r=PG", "display_name": "joshua.paling", "link": "https://stackoverflow.com/users/1373987/joshua-paling"}, "edited": false, "score": 3, "creation_date": 1456270102, "post_id": 35590323, "comment_id": 58866924, "body": "It calls &#39;create&#39; on whatever is returned by &#39;model&#39;. You need to figure out where the &#39;model&#39; method is defined, and see what it returns."}, {"owner": {"reputation": 1743, "user_id": 1821450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/553ce41bacded4ae27ee3586a0f3c770?s=128&d=identicon&r=PG", "display_name": "mutant_city", "link": "https://stackoverflow.com/users/1821450/mutant-city"}, "reply_to_user": {"reputation": 12784, "user_id": 1373987, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bca7defe7b8087d8e261d32b29cf425e?s=128&d=identicon&r=PG", "display_name": "joshua.paling", "link": "https://stackoverflow.com/users/1373987/joshua-paling"}, "edited": false, "score": 0, "creation_date": 1456271261, "post_id": 35590323, "comment_id": 58867360, "body": "The problem I&#39;m having is that the model variable can&#39;t be defined anywhere else that I know if.  Because the class extends active concern and has no mixins.  So I was thinking it was either rails magic or something Im not aware of."}], "answers": [{"comments": [{"owner": {"reputation": 1743, "user_id": 1821450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/553ce41bacded4ae27ee3586a0f3c770?s=128&d=identicon&r=PG", "display_name": "mutant_city", "link": "https://stackoverflow.com/users/1821450/mutant-city"}, "edited": false, "score": 0, "creation_date": 1456277005, "post_id": 35590611, "comment_id": 58869229, "body": "You sir were amazingly correct.   I didn&#39;t think to look in the calling class.   You were even right about the model method chomping the controller off the end."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1456271405, "creation_date": 1456271405, "answer_id": 35590611, "question_id": 35590323, "link": "https://stackoverflow.com/questions/35590323/what-does-model-create-mean-when-used-in-a-rails-controller-concern/35590611#35590611", "title": "What does model.create! mean when used in a Rails controller concern?", "body": "<p>In this case <code>model</code> has nothing to do with <code>ActiveSupport::Concern</code> which is just syntactic sugar around common ruby idioms such as:</p>\n\n<pre><code>module SomeMixin\n  def self.included(base)\n    base.extend ClassMethods\n    base.class_eval do\n      def foo\n      end\n    end\n  end\n\n  module ClassMethods\n    def bar\n    end\n  end\nend\n</code></pre>\n\n<p>In this specific case<code>model</code> would be resolved to <code>self.model</code> in the class which includes or is extended by the module. If <code>self.model</code> cannot be resolved there it goes up the class tree.</p>\n\n<p>I'm guessing its something along these lines:</p>\n\n<pre><code>def model\n  self.class_name.chomp(\"Controller\").singularize.constantize\nend\n</code></pre>\n\n<p>However, you might want to to a look at <a href=\"http://api.rubyonrails.org/classes/ActionController/Responder.html\" rel=\"nofollow\">ActionController::Responder</a> and the <a href=\"https://github.com/plataformatec/responders\" rel=\"nofollow\">responders gem</a> before you go reinventing the wheel.</p>\n"}], "owner": {"reputation": 1743, "user_id": 1821450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/553ce41bacded4ae27ee3586a0f3c770?s=128&d=identicon&r=PG", "display_name": "mutant_city", "link": "https://stackoverflow.com/users/1821450/mutant-city"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 35590611, "answer_count": 1, "score": 1, "last_activity_date": 1456273990, "creation_date": 1456270000, "last_edit_date": 1456270360, "question_id": 35590323, "link": "https://stackoverflow.com/questions/35590323/what-does-model-create-mean-when-used-in-a-rails-controller-concern", "title": "What does model.create! mean when used in a Rails controller concern?", "body": "<p>What does the <code>model.create!</code> expression mean:</p>\n\n<pre><code>module StandardCreateAction\n  extend ActiveSupport::Concern\n\n  def create\n   model.create!(attributes)\n   render text: 'SUCCESS', status: self.class::SUCCESS_STATUS\n  end\nend\n</code></pre>\n\n<p>I'm guessing it calls a same name model in the controller that uses this mixin?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "activerecord", "single-table-inheritance"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1456269192, "post_id": 35590035, "comment_id": 58866532, "body": "try <code>self::ADDRESS_FIELDS</code> instead of <code>self.class::ADDRESS_FIELDS</code>. I think <code>self.class::ADDRESS_FIELDS</code> may resolve to <code>Object</code>"}, {"owner": {"reputation": 1308, "user_id": 2487496, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wKtv2.jpg?s=128&g=1", "display_name": "barnett", "link": "https://stackoverflow.com/users/2487496/barnett"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1456271000, "post_id": 35590035, "comment_id": 58867262, "body": "@jvillian when I use <code>self::ADDRESS_FIELDS</code> it tries to call it on the parent class, instead of the child: <code>[1] pry(main)&gt; WireTransfer.new =&gt; NameError: uninitialized constant PaymentType::ADDRESS_FIELDS</code>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1456271412, "post_id": 35590035, "comment_id": 58867402, "body": "The problem is probably that you need to use different calls when you&#39;re in the <code>Class</code> context (e.g., during <code>validate</code>) vs. when you&#39;re in the <code>Instance</code> context (e.g., during <code>initialize</code>). Simply <code>ADDRESS_FIELDS</code> for the former and <code>self.class::ADDRESS_FIELDS</code> for the latter?"}, {"owner": {"reputation": 1308, "user_id": 2487496, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wKtv2.jpg?s=128&g=1", "display_name": "barnett", "link": "https://stackoverflow.com/users/2487496/barnett"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1456271633, "post_id": 35590035, "comment_id": 58867492, "body": "@jvillian using just the constant (<code>ADDRESS_FIELDS</code>) brings up the same error as using <code>self::ADDRESS_FIELDS</code>."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1456271914, "post_id": 35590035, "comment_id": 58867606, "body": "LMK if you want to chat: <a href=\"http://chat.stackoverflow.com/rooms/info/104347/using-a-childs-constant-within-a-parents-validation?tab=general\">chat.stackoverflow.com/rooms/info/104347/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1456269517, "post_id": 35590092, "comment_id": 58866669, "body": "I&#39;m thinking that <code>ADDRESS_FIELDS</code> in the context of <code>PaymentType</code> will expect the constant to be defined in <code>PaymentType</code>, no?"}, {"owner": {"reputation": 1308, "user_id": 2487496, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wKtv2.jpg?s=128&g=1", "display_name": "barnett", "link": "https://stackoverflow.com/users/2487496/barnett"}, "edited": false, "score": 0, "creation_date": 1456270606, "post_id": 35590092, "comment_id": 58867119, "body": "Just added to the answer, but there are other children of <code>PaymentType</code> that also have <code>ADDRESS_FIELDS</code> defined, so want it to dynamically check the appropriate <code>ADDRESS_FIELDS</code> for the corresponding child."}], "tags": [], "owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "is_accepted": false, "score": 1, "last_activity_date": 1456269040, "creation_date": 1456269040, "answer_id": 35590092, "question_id": 35590035, "link": "https://stackoverflow.com/questions/35590035/using-a-childs-constant-within-a-parents-validation/35590092#35590092", "title": "Using a Child&#39;s constant within a Parent&#39;s Validation", "body": "<p>Simply refer to it everywhere by its full name:</p>\n\n<pre><code>WireTransfer::ADDRESS_FIELDS\n</code></pre>\n\n<p>Or from within a child model, you can simply use:</p>\n\n<pre><code>ADDRESS_FIELDS\n</code></pre>\n\n<p>There's no need to prepend <code>self.class</code> </p>\n"}, {"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 0, "last_activity_date": 1456328518, "last_edit_date": 1610973356, "creation_date": 1456327624, "answer_id": 35606124, "question_id": 35590035, "link": "https://stackoverflow.com/questions/35590035/using-a-childs-constant-within-a-parents-validation/35606124#35606124", "title": "Using a Child&#39;s constant within a Parent&#39;s Validation", "body": "<p>Nice <a href=\"https://chat.stackoverflow.com/rooms/104347/using-a-childs-constant-within-a-parents-validation\">chatting</a> with you yesterday. To recap, your motivation for putting the <code>validates</code> call in <code>PaymentType</code> is DRYing up your code (because it's identical in all children of <code>PaymentType</code>).</p>\n<p>The problem is that Ruby loads <code>PaymentType</code> before it loads <code>WireTransfer</code> (due to inheritance, I believe) so <code>validates</code> can't find <code>ADDRESS_FIELDS</code> (because it's defined on <code>WireTransfer</code>, which hasn't been loaded yet). That's the first test in the RSpec test, below.</p>\n<pre><code>rspec 'spec/stack_overflow/child_constant_parent_validation_spec.rb' -fd\n\nUsing a Child's Constant within a Parent's Validation\n  when 'validates' in parent\n    raises error\n</code></pre>\n<p>Now, you could just put <code>validates</code> in each child. But, that kinda sucks because you have to define it in every child - yet it's the same across all children. So, you're not as DRY as you'd like to be. That's the second test, below.</p>\n<pre><code>rspec 'spec/stack_overflow/child_constant_parent_validation_spec.rb' -fd\n\nUsing a Child's Constant within a Parent's Validation\n  when 'validates' in parent\n    raises error\n  when 'validates' in child\n    doesn't raise an error\n    has the correct class methods\n    has the correct instance methods\n    kinda sucks because 'validates' has to be defined in every child.\n</code></pre>\n<p>So, are you doomed to sogginess? Not necessarily. You could put your <code>validates</code> in a module so that you can define it once and use it everywhere. You would then include the module in your children classes. The trick is (1) using the <code>included</code> hook and accessing <code>base::ADDRESS_FIELDS</code>, and (2) making sure that you <code>include</code> the module AFTER you have set <code>ADDRESS_FIELDS</code> in the child. That's the third test, below.</p>\n<pre><code>rspec 'spec/stack_overflow/child_constant_parent_validation_spec.rb' -fd\n\nUsing a Child's Constant within a Parent's Validation\n  when 'validates' in parent\n    raises error\n  when 'validates' in child\n    doesn't raise an error\n    has the correct class methods\n    has the correct instance methods\n    kinda sucks because 'validates' has to be defined in every child.\n  when 'validates' in module\n    doesn't raise an error\n    has the correct class methods\n    has the correct instance methods\n    is a little better because you can define 'validates' once and use in all children\n\nFinished in 0.00811 seconds (files took 0.1319 seconds to load)\n9 examples, 0 failures\n</code></pre>\n<p>Of course, you still have to remember to include the module in every child, but that shouldn't be too bad. And better than defining <code>validates</code> everywhere.</p>\n<p>After everything, your classes might look something like:</p>\n<pre><code>class PaymentType\n  class &lt;&lt; self\n    def a_useful_class_method_from_payment_base; end\n  end\n  def a_useful_instance_method_from_payment_base; end\nend\n\nmodule PaymentTypeValidations\n  def self.included(base)\n    validates :address, hash_key: { presence: base::ADDRESS_FIELDS }\n  end\nend\n\nclass WireTransfer &lt; PaymentType\n  ADDRESS_FIELDS = %i(first_name last_name bank_name routing_number account_number)\n  include PaymentTypeValidations\nend\n\nclass Bitcoin &lt; PaymentType\n  ADDRESS_FIELDS = %i(wallet_address)\n  include PaymentTypeValidations\nend\n</code></pre>\n<p>I've put the entire RSpec test below in case you want to run it yourself.</p>\n<pre><code>RSpec.describe &quot;Using a Child's Constant within a Parent's Validation &quot; do\n\n  before(:all) do\n\n    module Validations\n      def validates(field, options={}) \n        define_method(&quot;valid?&quot;) do\n        end\n        define_method(&quot;valid_#{field}?&quot;) do\n        end\n      end\n    end\n\n    module PaymentType\n      class Base\n        extend Validations\n        class &lt;&lt; self\n          def a_useful_class_method_from_payment_base; end\n        end\n        def a_useful_instance_method_from_payment_base; end\n      end\n    end\n\n    module WireTransfer\n    end\n\n  end\n\n  context &quot;when 'validates' in parent&quot; do\n    it &quot;raises error&quot; do\n\n      expect{\n\n        class PaymentType::WithValidates &lt; PaymentType::Base\n          validates :address, hash_key: { presence: self::ADDRESS_FIELDS }\n        end\n\n        class WireTransfer::Base &lt; PaymentType::WithValidation\n          ADDRESS_FIELDS = %i(first_name last_name bank_name routing_number account_number)\n        end\n\n      }.to raise_error(NameError)\n\n    end\n  end\n\n  context &quot;when 'validates' in child&quot; do\n    it &quot;doesn't raise an error&quot; do\n\n      expect{\n\n        class PaymentType::WithoutValidates &lt; PaymentType::Base\n        end\n\n        class WireTransfer::WithValidates &lt; PaymentType::WithoutValidates\n          ADDRESS_FIELDS = %i(first_name last_name bank_name routing_number account_number)\n          validates :address, hash_key: { presence: self::ADDRESS_FIELDS }\n        end\n\n      }.to_not raise_error\n    end\n    it &quot;has the correct class methods&quot; do\n      expect(WireTransfer::WithValidates).to respond_to(&quot;a_useful_class_method_from_payment_base&quot;)\n    end\n    it &quot;has the correct instance methods&quot; do\n      wire_transfer = WireTransfer::WithValidates.new\n      [&quot;valid?&quot;,&quot;valid_address?&quot;,&quot;a_useful_instance_method_from_payment_base&quot;].each do |method|\n        expect(wire_transfer).to respond_to(method)\n      end\n    end\n    it &quot;kinda sucks because 'validates' has to be defined in every child.&quot; do\n      module Bitcoin\n        class Base &lt; PaymentType::WithoutValidates\n        end\n      end\n      bitcoin = Bitcoin::Base.new\n      [&quot;valid?&quot;,&quot;valid_address?&quot;].each do |method|\n        expect(bitcoin).to_not respond_to(method)\n      end\n    end\n  end\n  \n  context &quot;when 'validates' in module&quot; do\n    it &quot;doesn't raise an error&quot; do\n      expect{\n\n        module PaymentTypeValidations\n          extend Validations\n          def self.included(base)\n            validates :address, hash_key: { presence: base::ADDRESS_FIELDS }\n          end\n        end\n\n        class WireTransfer::IncludingValidationsModule &lt; PaymentType::WithoutValidates\n          ADDRESS_FIELDS = %i(first_name last_name bank_name routing_number account_number)\n          include PaymentTypeValidations\n        end\n\n      }.to_not raise_error\n\n    end\n\n    it &quot;has the correct class methods&quot; do\n      expect(WireTransfer::IncludingValidationsModule).to respond_to(&quot;a_useful_class_method_from_payment_base&quot;)\n    end\n\n    it &quot;has the correct instance methods&quot; do\n      wire_transfer = WireTransfer::IncludingValidationsModule.new\n      [&quot;valid?&quot;,&quot;valid_address?&quot;,&quot;a_useful_instance_method_from_payment_base&quot;].each do |method|\n        expect(wire_transfer).to respond_to(method)\n      end\n    end\n\n    it &quot;is a little better because you can define 'validates' once and use in all children&quot; do\n      class Bitcoin::IncludingValidationsModule &lt; PaymentType::WithoutValidates\n        ADDRESS_FIELDS = %i(wallet_address)\n        include PaymentTypeValidations\n      end\n\n      bitcoin = Bitcoin::IncludingValidationsModule.new\n      [&quot;valid?&quot;,&quot;valid_address?&quot;,&quot;a_useful_instance_method_from_payment_base&quot;].each do |method|\n        expect(bitcoin).to respond_to(method)\n      end\n\n    end\n\n\n  end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 1308, "user_id": 2487496, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wKtv2.jpg?s=128&g=1", "display_name": "barnett", "link": "https://stackoverflow.com/users/2487496/barnett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 0, "accepted_answer_id": 35606124, "answer_count": 2, "score": 2, "last_activity_date": 1456328518, "creation_date": 1456268827, "last_edit_date": 1456275764, "question_id": 35590035, "link": "https://stackoverflow.com/questions/35590035/using-a-childs-constant-within-a-parents-validation", "title": "Using a Child&#39;s constant within a Parent&#39;s Validation", "body": "<p>With the below code I am able to access the child's constant (<code>ADDRESS_FIELDS</code>) no problem within the <code>initialize</code> method (by using <code>self.class::ADDRESS_FIELDS</code>) but am unable to access it within the validation (getting <code>NameError: uninitialized constant Class::ADDRESS_FIELDS</code>). Any ideas on how to use the child's constant within the parent validation?  There are other children of <code>PaymentType</code> with their own values of <code>ADDRESS_FIELDS</code>.</p>\n\n<pre><code>class PaymentType &lt; ActiveRecord::Base\n  attr_accessible :address\n\n  validates :address, hash_key: { presence: self.class::ADDRESS_FIELDS }\n\n  def initialize(attributes = {}, options = {})\n    super\n    return self if address.present?\n\n    address = {}\n    self.class::ADDRESS_FIELDS.each do |field|\n      address[field] = nil\n    end\n    self.address = address\n  end\nend\n\nclass WireTransfer &lt; PaymentType\n  ADDRESS_FIELDS = %i(first_name last_name bank_name routing_number account_number)\nend\n</code></pre>\n"}, {"tags": ["javascript", "ruby", "selenium"], "comments": [{"owner": {"reputation": 4487, "user_id": 2329061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89e7e5642e4f608893b279c8438329a3?s=128&d=identicon&r=PG", "display_name": "Buaban", "link": "https://stackoverflow.com/users/2329061/buaban"}, "edited": false, "score": 0, "creation_date": 1456273354, "post_id": 35589940, "comment_id": 58868104, "body": "You have to try/catch when switching to Alert window."}], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 5851371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45b365e8d351bd92b59f5e868baba42?s=128&d=identicon&r=PG&f=1", "display_name": "Sanchita", "link": "https://stackoverflow.com/users/5851371/sanchita"}, "is_accepted": false, "score": 0, "last_activity_date": 1456294041, "creation_date": 1456294041, "answer_id": 35594507, "question_id": 35589940, "link": "https://stackoverflow.com/questions/35589940/how-to-detect-if-there-any-javascript-alert-box-is-opened-on-browser-if-yes-ho/35594507#35594507", "title": "How to detect if there any javascript alert box is opened on browser? if yes, How to close it using ruby and selenium", "body": "<pre><code>wait = Selenium::WebDriver::Wait.new\nalert = wait.until { page.driver.browser.switch_to.alert }\nalert.accept # to accept alert\nalert.dismiss # to dismiss alert\n</code></pre>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 65, "user_id": 5517808, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8bdad426c026f17740a0e2e724282159?s=128&d=identicon&r=PG&f=1", "display_name": "Prince H", "link": "https://stackoverflow.com/users/5517808/prince-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 426, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456294041, "creation_date": 1456268331, "question_id": 35589940, "link": "https://stackoverflow.com/questions/35589940/how-to-detect-if-there-any-javascript-alert-box-is-opened-on-browser-if-yes-ho", "title": "How to detect if there any javascript alert box is opened on browser? if yes, How to close it using ruby and selenium", "body": "<p>While navigating from one page to another using selenium function, sometimes confirm box appears with ok and cancel option. So How to detect the box and dismiss that.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rbenv"], "answers": [{"comments": [{"owner": {"reputation": 389, "user_id": 3821813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd45e06cd14b895db1d49235a38dacae?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Sultana", "link": "https://stackoverflow.com/users/3821813/ankit-sultana"}, "edited": false, "score": 0, "creation_date": 1456288629, "post_id": 35589999, "comment_id": 58872744, "body": "So I put the downloaded file into <code>~&#47;.rbenv&#47;cache&#47;very_long_file_name</code>, then tried running <code>rbenv install</code> but it gave me Usage instructions, as if I am not using the command properly. I also tried setting the <code>RUBY_BUILD_CACHE_PATH</code> to <code>&#47;Users&#47;username&#47;.rbenv&#47;cache</code>. It&#39;s still not working. Am I missing something here?"}, {"owner": {"reputation": 389, "user_id": 3821813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd45e06cd14b895db1d49235a38dacae?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Sultana", "link": "https://stackoverflow.com/users/3821813/ankit-sultana"}, "edited": false, "score": 0, "creation_date": 1456288874, "post_id": 35589999, "comment_id": 58872814, "body": "Edit: I realized that <code>rbenv install</code> was downloading a <code>tar.gz</code> file, so I renamed the downloaded file to <code>ruby-2.0.0-p645.tar.gz</code> and then &quot;uncompressed&quot; it (Just clicked on it, I am using OS X). Now I have a folder in <code>~&#47;.rbenv&#47;cache</code> with the name <code>ruby-2.0.0-p645</code>. The contents of the folder seem fine as well, since I opened a few files like <code>debug.c</code> etc."}, {"owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "reply_to_user": {"reputation": 389, "user_id": 3821813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd45e06cd14b895db1d49235a38dacae?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Sultana", "link": "https://stackoverflow.com/users/3821813/ankit-sultana"}, "edited": false, "score": 0, "creation_date": 1456300674, "post_id": 35589999, "comment_id": 58877750, "body": "Sorry, I didn&#39;t mean <code>rvm install</code> with no arguments, but the same as you have above: <code>rvm install 2.0.0-p645</code>. Also you should leave the file with its original filename."}, {"owner": {"reputation": 389, "user_id": 3821813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd45e06cd14b895db1d49235a38dacae?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Sultana", "link": "https://stackoverflow.com/users/3821813/ankit-sultana"}, "edited": false, "score": 0, "creation_date": 1456304033, "post_id": 35589999, "comment_id": 58879661, "body": "Thanks, you mean <code>rbenv install 2.0.0-p645</code>. And that did the trick!"}, {"owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "reply_to_user": {"reputation": 389, "user_id": 3821813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd45e06cd14b895db1d49235a38dacae?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Sultana", "link": "https://stackoverflow.com/users/3821813/ankit-sultana"}, "edited": false, "score": 0, "creation_date": 1456304212, "post_id": 35589999, "comment_id": 58879769, "body": "Re your edit to my answer: I&#39;m pretty sure you must put the <i>original</i> file into <code>cache</code>, without extracting/renaming. But you&#39;re the one who just did it. Are you sure that&#39;s right though??"}, {"owner": {"reputation": 389, "user_id": 3821813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd45e06cd14b895db1d49235a38dacae?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Sultana", "link": "https://stackoverflow.com/users/3821813/ankit-sultana"}, "edited": false, "score": 1, "creation_date": 1456308721, "post_id": 35589999, "comment_id": 58882996, "body": "Yeah. I had tried running <code>rbenv install 2.0.0-p645</code> before renaming, but <code>rbenv</code> was downloading from cloudfront again in that case. After I renamed it like I said, it worked fine. The issue was, the file I got after downloading from cloudfront had no extension, but I knew it&#39;s correct name was supposed to be  <code>ruby-2.0.0-p645.tar.gz</code> since rbenv showed it like <a href=\"https://youtu.be/YAzAzU_Y6qo?t=4m30s\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "reply_to_user": {"reputation": 389, "user_id": 3821813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd45e06cd14b895db1d49235a38dacae?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Sultana", "link": "https://stackoverflow.com/users/3821813/ankit-sultana"}, "edited": false, "score": 0, "creation_date": 1456330438, "post_id": 35589999, "comment_id": 58898759, "body": "Yes ending in <code>.tar.gz</code> sounds right. Weird it started out with no extension."}], "tags": [], "owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "is_accepted": true, "score": 5, "last_activity_date": 1456304197, "last_edit_date": 1456304197, "creation_date": 1456268646, "answer_id": 35589999, "question_id": 35589469, "link": "https://stackoverflow.com/questions/35589469/install-ruby-using-rbenvs-downloaded-file/35589999#35589999", "title": "Install ruby using rbenv&#39;s downloaded file", "body": "<p>Yes. Put the downloaded file into <code>~/.rbenv/cache</code>. You might need to create the directory first. Then run your <code>rbenv install</code> command again. Here is the link to the documentation for this: <a href=\"https://github.com/rbenv/ruby-build#package-download-caching\" rel=\"nofollow\">https://github.com/rbenv/ruby-build#package-download-caching</a></p>\n\n<hr>\n\n<p>To summarize, for future reference:</p>\n\n<ol>\n<li>Download the file using <code>wget</code></li>\n<li>Create a <code>cache</code> folder in <code>~/.rbenv/</code> if it doesn't exist already.</li>\n<li>Rename the downloaded file to <code>ruby-x.y.z-pabc.tar.gz</code>. Extract it and move it to <code>~/.rbenv/cache/</code></li>\n<li>Run <code>rbenv install x.y.z-pabc</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1903, "user_id": 2578693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a7a908dd876ba5168b5ba618ccae256?s=128&d=identicon&r=PG&f=1", "display_name": "Engr. Hasanuzzaman Sumon", "link": "https://stackoverflow.com/users/2578693/engr-hasanuzzaman-sumon"}, "is_accepted": false, "score": 0, "last_activity_date": 1592364837, "creation_date": 1592364837, "answer_id": 62421065, "question_id": 35589469, "link": "https://stackoverflow.com/questions/35589469/install-ruby-using-rbenvs-downloaded-file/62421065#62421065", "title": "Install ruby using rbenv&#39;s downloaded file", "body": "<p>For me, the following steps work.</p>\n\n<pre><code>1 Download the file using `wget/curl or any other way`\n2. Create a `cache` folder in `~/.rbenv/` if it doesn't exist already.\n3. Move the downloaded file to `~/.rbenv/cache/`\n4. Run `rbenv install x.y.z` (ex. rbenv install 2.7.1`)\n</code></pre>\n\n<p>The difference from the above answer was,</p>\n\n<pre><code>- do not need to change file name \n- do not need to extract \n- if file rename to something random (ex. x.y.z-pabc) it show ruby-build: definition not found: x.y.z-pabc\n</code></pre>\n\n<p>Hope this can help someone.</p>\n"}], "owner": {"reputation": 389, "user_id": 3821813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd45e06cd14b895db1d49235a38dacae?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Sultana", "link": "https://stackoverflow.com/users/3821813/ankit-sultana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1444, "favorite_count": 1, "accepted_answer_id": 35589999, "answer_count": 2, "score": 4, "last_activity_date": 1592364837, "creation_date": 1456266270, "question_id": 35589469, "link": "https://stackoverflow.com/questions/35589469/install-ruby-using-rbenvs-downloaded-file", "title": "Install ruby using rbenv&#39;s downloaded file", "body": "<p>I need to install <code>ruby 2.0.0-p645</code> and I use <code>rbenv</code>. I tried downloading it by running</p>\n\n<pre><code>rbenv install 2.0.0-p645\n</code></pre>\n\n<p>But the internet in my college keeps dropping every few minutes, so the transfer was always closing with some 11MB remaining.</p>\n\n<p>To counter that, I saw the url from where <code>rbenv</code> was downloading, and used <code>wget</code> to download the source file that <code>rbenv</code> was downloading. (using <code>wget -c</code> for resuming every time the connection closed).</p>\n\n<p>Now I have the file, is there a way to install that ruby version now?</p>\n\n<p>The file's <a href=\"http://dqw8nmjcqpjn7.cloudfront.net/5e9f8effffe97cba5ef0015feec6e1e5f3bacf6ace78cd1cdf72708cd71cf4ab\" rel=\"nofollow\">link on cloudfront</a> that I have on my machine.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "heroku"], "comments": [{"owner": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "edited": false, "score": 0, "creation_date": 1456266349, "post_id": 35589420, "comment_id": 58865253, "body": "Is Heroku&#39;s Postgres using the same version as yours? Do you have all the same extensions enabled?"}, {"owner": {"reputation": 107, "user_id": 5968007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10209198006855893/picture?type=large", "display_name": "William Ye", "link": "https://stackoverflow.com/users/5968007/william-ye"}, "reply_to_user": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "edited": false, "score": 0, "creation_date": 1456267882, "post_id": 35589420, "comment_id": 58865966, "body": "I just checked Heroku&#39;s Postgres is running an earlier version than mine. How would I check the other extensions installed?"}, {"owner": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "edited": false, "score": 0, "creation_date": 1456268745, "post_id": 35589420, "comment_id": 58866338, "body": "I think it might be the version that&#39;s at fault, then. Can you please post the part of your code that uses <code>strftime</code>? It doesn&#39;t seem to be widely supported in Postgres, but it may be a very recent addition; and it might be an idea to see if you can refactor it on your end instead."}, {"owner": {"reputation": 107, "user_id": 5968007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10209198006855893/picture?type=large", "display_name": "William Ye", "link": "https://stackoverflow.com/users/5968007/william-ye"}, "reply_to_user": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "edited": false, "score": 0, "creation_date": 1456268853, "post_id": 35589420, "comment_id": 58866398, "body": "I use it in multiple places. But an example of that is like this.   <code>@bets_by_month = @bets_by_year.where(&quot;strftime(&#39;%m&#39;, created_at) = ?&quot;, params[:month])</code>"}, {"owner": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "edited": false, "score": 0, "creation_date": 1456269541, "post_id": 35589420, "comment_id": 58866681, "body": "In that particular case, you may want to use <code>.where(&quot;EXTRACT(MONTH FROM created_at) = ?&quot;, params[:month])</code>. <code>EXTRACT</code> goes back at least as far as 9.0. See <a href=\"http://www.postgresql.org/docs/9.0/static/functions-datetime.html#FUNCTIONS-DATETIME-EXTRACT\" rel=\"nofollow noreferrer\">the Postgres docs</a>. Or <code>date_part</code> is equivalent."}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 2659387, "user_type": "registered", "profile_image": "https://graph.facebook.com/1077134521/picture?type=large", "display_name": "Aleksandr Larionov", "link": "https://stackoverflow.com/users/2659387/aleksandr-larionov"}, "is_accepted": false, "score": 1, "last_activity_date": 1456268692, "creation_date": 1456268692, "answer_id": 35590012, "question_id": 35589420, "link": "https://stackoverflow.com/questions/35589420/heroku-deploy-failed-due-to-postgresql-error/35590012#35590012", "title": "Heroku Deploy failed due to Postgresql Error", "body": "<p>maybe you forgot to run migration on heroku. just do\n<code>heroku run rake db:migrate</code></p>\n"}], "owner": {"reputation": 107, "user_id": 5968007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10209198006855893/picture?type=large", "display_name": "William Ye", "link": "https://stackoverflow.com/users/5968007/william-ye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456268692, "creation_date": 1456266082, "question_id": 35589420, "link": "https://stackoverflow.com/questions/35589420/heroku-deploy-failed-due-to-postgresql-error", "title": "Heroku Deploy failed due to Postgresql Error", "body": "<p>I'm having a problem with my Archives built on Ruby on Rails when I deploy to Heroku. Everything is working fine on my Local servers however when I run the app on Heroku there are problems when i load the page. </p>\n\n<p>The Heroku logs showed this</p>\n\n<pre><code>PG::UndefinedFunction: ERROR:  function strftime(unknown, timestamp without time zone) does not exist\n</code></pre>\n"}]