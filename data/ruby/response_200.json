[{"tags": ["ruby", "rspec", "ruby-on-rails-5", "actioncable"], "comments": [{"owner": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "edited": false, "score": 0, "creation_date": 1541634460, "post_id": 53199606, "comment_id": 93287746, "body": "I found <a href=\"https://stackoverflow.com/questions/50549428/how-to-test-actioncable-along-with-devise-using-rspec\">this question</a>, which links to <a href=\"https://github.com/palkan/action-cable-testing/issues/26#issuecomment-392481619\" rel=\"nofollow noreferrer\">this GitHub issue comment</a> showing a potential technique. However, I&#39;m not sure whether that&#39;s a sane pattern I want to use in my own code."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1541635655, "post_id": 53199606, "comment_id": 93288000, "body": "What is &quot;not sane&quot; about it?"}, {"owner": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1541650882, "post_id": 53199606, "comment_id": 93291402, "body": "@lacostenycoder The test is set up as <code>type: :channel</code>. I&#39;m nervous that&#39;s using some RSpec/Rails magic meant to make <code>Channel</code> tests more easier to write but isn&#39;t helpful specifically for working with a <code>Connection</code>."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1541658750, "post_id": 53199606, "comment_id": 93293307, "body": "I guess without seeing what exactly it is you&#39;re testing for, I can&#39;t comment further on this."}], "answers": [{"tags": [], "owner": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "is_accepted": true, "score": 2, "last_activity_date": 1541710233, "creation_date": 1541710233, "answer_id": 53215925, "question_id": 53199606, "link": "https://stackoverflow.com/questions/53199606/how-do-i-test-an-actioncable-connection/53215925#53215925", "title": "How do I test an ActionCable connection?", "body": "<p>The <a href=\"https://github.com/palkan/action-cable-testing\" rel=\"nofollow noreferrer\">action-cable-testing gem</a> includes support for testing <code>Connection</code>s. Here's the documentation: <a href=\"https://github.com/palkan/action-cable-testing#rspec-usage\" rel=\"nofollow noreferrer\">https://github.com/palkan/action-cable-testing#rspec-usage</a></p>\n\n<p>And here's the RSpec example given in the documentation:</p>\n\n<pre><code>require \"rails_helper\"\n\nRSpec.describe ApplicationCable::Connection, type: :channel do\n  it \"successfully connects\" do\n    connect \"/cable\", headers: { \"X-USER-ID\" =&gt; \"325\" }\n    expect(connection.user_id).to eq \"325\"\n  end\n\n  it \"rejects connection\" do\n    expect { connect \"/cable\" }.to have_rejected_connection\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "accepted_answer_id": 53215925, "answer_count": 1, "score": 1, "last_activity_date": 1541710233, "creation_date": 1541634381, "question_id": 53199606, "link": "https://stackoverflow.com/questions/53199606/how-do-i-test-an-actioncable-connection", "title": "How do I test an ActionCable connection?", "body": "<p>How do I write a test for an ActionCable <code>Connection</code> in RSpec? I've found <a href=\"https://relishapp.com/palkan/action-cable-testing/docs\" rel=\"nofollow noreferrer\">documentation</a> and <a href=\"https://stackoverflow.com/questions/35227773/how-can-i-test-actioncable-channels-using-rspec\">other</a> <a href=\"https://stackoverflow.com/questions/49293150/how-can-i-test-actioncable-using-rspec\">questions</a> about testing <code>Channel</code>s, but I'm having a hard time finding information about testing <code>Connection</code>s.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "rails-activestorage"], "answers": [{"comments": [{"owner": {"reputation": 581, "user_id": 579664, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2ee4a88c90f073f84e6610470f7b822d?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/579664/ryan"}, "edited": false, "score": 0, "creation_date": 1541647372, "post_id": 53199694, "comment_id": 93290661, "body": "This is closer (in that it gives fewer results), but it&#39;s still returning results where I do <code>check.image.attached?</code> and get <code>false</code>.  It may be because an image was previously attached and now isn&#39;t?  Though can&#39;t confirm that...just ideating."}, {"owner": {"reputation": 1370, "user_id": 3452582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AjfDl.jpg?s=128&g=1", "display_name": "Zoran Majstorovic", "link": "https://stackoverflow.com/users/3452582/zoran-majstorovic"}, "reply_to_user": {"reputation": 581, "user_id": 579664, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2ee4a88c90f073f84e6610470f7b822d?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/579664/ryan"}, "edited": false, "score": 0, "creation_date": 1541669437, "post_id": 53199694, "comment_id": 93297787, "body": "@Ryan how do you delete image attachment? Do you use <code>#purge</code> method like this: <code>check.image_attachment.purge</code> ?"}, {"owner": {"reputation": 581, "user_id": 579664, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2ee4a88c90f073f84e6610470f7b822d?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/579664/ryan"}, "edited": false, "score": 0, "creation_date": 1541700085, "post_id": 53199694, "comment_id": 93314807, "body": "Not sure what was happening, but now can&#39;t reproduce.  Looks like this worked well.  Thanks @Zoran Majstorovic!"}, {"owner": {"reputation": 10050, "user_id": 431874, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/IJ6HK.png?s=128&g=1", "display_name": "Tom Rossi", "link": "https://stackoverflow.com/users/431874/tom-rossi"}, "edited": false, "score": 1, "creation_date": 1559845733, "post_id": 53199694, "comment_id": 99556694, "body": "I don&#39;t think you need the join on the blob as well, just the attachment."}, {"owner": {"reputation": 459, "user_id": 3330207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0285bccce032918e31c7f51090eaa5c?s=128&d=identicon&r=PG&f=1", "display_name": "AFOC", "link": "https://stackoverflow.com/users/3330207/afoc"}, "reply_to_user": {"reputation": 10050, "user_id": 431874, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/IJ6HK.png?s=128&g=1", "display_name": "Tom Rossi", "link": "https://stackoverflow.com/users/431874/tom-rossi"}, "edited": false, "score": 0, "creation_date": 1615232490, "post_id": 53199694, "comment_id": 117622859, "body": "@TomRossi is correct, <code>joins(:image_attachment)</code> is sufficient. It queries the <code>active_storage_attachments</code> table, which is a join table between the model&#39;s table &amp; the <code>active_storage_blobs</code> table. Joining the blob table is redundant &amp; just adds another table (and time) to the query."}, {"owner": {"reputation": 1370, "user_id": 3452582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AjfDl.jpg?s=128&g=1", "display_name": "Zoran Majstorovic", "link": "https://stackoverflow.com/users/3452582/zoran-majstorovic"}, "reply_to_user": {"reputation": 10050, "user_id": 431874, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/IJ6HK.png?s=128&g=1", "display_name": "Tom Rossi", "link": "https://stackoverflow.com/users/431874/tom-rossi"}, "edited": false, "score": 1, "creation_date": 1615297263, "post_id": 53199694, "comment_id": 117642910, "body": "The answer is updated to reflect new findings, thanks to @TomRossi"}], "tags": [], "owner": {"reputation": 1370, "user_id": 3452582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AjfDl.jpg?s=128&g=1", "display_name": "Zoran Majstorovic", "link": "https://stackoverflow.com/users/3452582/zoran-majstorovic"}, "is_accepted": true, "score": 9, "last_activity_date": 1615297174, "last_edit_date": 1615297174, "creation_date": 1541635204, "answer_id": 53199694, "question_id": 53199420, "link": "https://stackoverflow.com/questions/53199420/rails-activestorage-scope-for-when-file-is-attached/53199694#53199694", "title": "Rails ActiveStorage scope for when file is attached", "body": "<p>Main purpose of the scope <code>with_attached_image</code> is to avoid N+1 queries (to include the attached blobs in your query).</p>\n<p>To return only records where there is an existing attached image, you can create a scope in the <code>Check</code> model like this:</p>\n<p><code>scope :has_attached_image, -&gt; { joins(image_attachment: :blob) }</code></p>\n<p>Update from comments:</p>\n<p><code>scope :has_attached_image, -&gt; { joins(:image_attachment) }</code></p>\n"}, {"tags": [], "owner": {"reputation": 4321, "user_id": 454246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bbddaa50ab78479b10ff632869e6a6c?s=128&d=identicon&r=PG", "display_name": "jpgeek", "link": "https://stackoverflow.com/users/454246/jpgeek"}, "is_accepted": false, "score": 0, "last_activity_date": 1619230904, "creation_date": 1619230904, "answer_id": 67238779, "question_id": 53199420, "link": "https://stackoverflow.com/questions/53199420/rails-activestorage-scope-for-when-file-is-attached/67238779#67238779", "title": "Rails ActiveStorage scope for when file is attached", "body": "<p>Rails has a built-in scope for this:</p>\n<pre><code>Check.with_attached_image.all\n</code></pre>\n<p>Will return only records with images.  FWIW, it is a bit trickier to get those without attachments:</p>\n<pre><code>Thing.joins(:image_attachment).where.not(active_storage_attachments: { record_id: nil })\n</code></pre>\n<p>Great post on it <a href=\"https://jasoncharnes.com/eager-loading-querying-against-activestorage-attachments/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 581, "user_id": 579664, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2ee4a88c90f073f84e6610470f7b822d?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/579664/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1654, "favorite_count": 1, "accepted_answer_id": 53199694, "answer_count": 2, "score": 7, "last_activity_date": 1619230904, "creation_date": 1541633091, "last_edit_date": 1541634903, "question_id": 53199420, "link": "https://stackoverflow.com/questions/53199420/rails-activestorage-scope-for-when-file-is-attached", "title": "Rails ActiveStorage scope for when file is attached", "body": "<p>When using ActiveStorage, how do you create a scope for when files are attached.</p>\n\n<p>For example:</p>\n\n<pre><code>class Check &lt; ActiveRecord::Base\n  has_one_attached :image\nend\n</code></pre>\n\n<p>I want something like <code>Check.has_attached_image</code> to return only records where there is an existing attached image.</p>\n\n<p>I know that <code>ActiveStorage</code> provides a <code>with_attached_image</code> scope.  But that doesn't seem to be working:</p>\n\n<p><code>\nirb(main):009:0&gt; Check.with_attached_image.to_sql\n=&gt; \"SELECT \\\"checks\\\".* FROM \\\"checks\\\"\"\n</code></p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "rubygems", "bundle"], "comments": [{"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1541632554, "post_id": 53199274, "comment_id": 93287241, "body": "Does <code>&#47;usr&#47;local&#47;bin&#47;mysql_config</code> exist? Do you have permission to execute it? Make sure you can connect to the server using <code>mysql</code> client before installing gem."}, {"owner": {"reputation": 1, "user_id": 9849135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bf748dce5fb99b847f7affdc089d614?s=128&d=identicon&r=PG&f=1", "display_name": "CSalazar", "link": "https://stackoverflow.com/users/9849135/csalazar"}, "reply_to_user": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1541633494, "post_id": 53199274, "comment_id": 93287477, "body": "Yup, it definitely exists. I&#39;ve opened it up before and I have permissions to rwx."}], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 1630875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/YxXAS.jpg?s=128&g=1", "display_name": "awsmsce", "link": "https://stackoverflow.com/users/1630875/awsmsce"}, "is_accepted": false, "score": 0, "last_activity_date": 1541659346, "last_edit_date": 1541659346, "creation_date": 1541659019, "answer_id": 53202584, "question_id": 53199274, "link": "https://stackoverflow.com/questions/53199274/cannot-execute-mysql-config-at-usr-local-bin-mysql-config/53202584#53202584", "title": "Cannot execute mysql_config at /usr/local/bin/mysql_config", "body": "<p>I have dealt with this non-sense probably at every job I've been at. Sometimes, depending on how you set up your system, you could just have multiple version in your path or perhaps the wrong one showing up by default. Either wa, this usually means there is a lib or bin path issue.</p>\n\n<p>Try installing it with this first (without sudo, if that fails, then sudo), then run bundle. It could actually be failing because the gem doesn't have permissions to install the extensions.</p>\n\n<p><code>sudo gem install mysql -- \u2014\u2013with-mysql-config=/usr/local/bin/mysql_config</code></p>\n\n<p>from <a href=\"https://stackoverflow.com/questions/2167598/mysql-install-error-failed-to-build-gem-native-extension\">this other post</a></p>\n\n<p>If that still fails, then can you post these:</p>\n\n<p><code>echo $PATH</code> and <code>echo $DYLD_LIBRARY_PATH</code></p>\n\n<p>(edit: I think I had the wrong mysql path, but please make sure you don't have multiple paths. Could you verify that /usr/local/mysql/bin/mysql_config doesn't also exist? )</p>\n"}], "owner": {"reputation": 1, "user_id": 9849135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bf748dce5fb99b847f7affdc089d614?s=128&d=identicon&r=PG&f=1", "display_name": "CSalazar", "link": "https://stackoverflow.com/users/9849135/csalazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541659346, "creation_date": 1541632138, "question_id": 53199274, "link": "https://stackoverflow.com/questions/53199274/cannot-execute-mysql-config-at-usr-local-bin-mysql-config", "title": "Cannot execute mysql_config at /usr/local/bin/mysql_config", "body": "<p>On running bundle install, coming up with the following error. So it's not an issue of finding the config file - it knows where it is...just not executing it. I do have xcode installed. I've checked on multiple questions and a lot of it is pointing me to being explicit on where the config file is, but that's not my issue per se. Any ideas?</p>\n\n<pre><code>Installing mysql2 0.3.21 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    current directory: /private/var/folders/sx/dm2qzym54v1c2_1kvkt1c_t80000gn/T/bundler20181107-70107-16xf5wjmysql2-0.3.21/gems/mysql2-0.3.21/ext/mysql2\n/Users/cecillesalazar/.rbenv/versions/2.1.4/bin/ruby -r ./siteconf20181107-70107-13kana8.rb extconf.rb\nchecking for ruby/thread.h... yes\nchecking for rb_thread_call_without_gvl() in ruby/thread.h... yes\nchecking for rb_thread_blocking_region()... yes\nchecking for rb_wait_for_single_fd()... yes\nchecking for rb_hash_dup()... yes\nchecking for rb_intern3()... yes\n-----\nCannot execute mysql_config at /usr/local/bin/mysql_config\n-----\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/cecillesalazar/.rbenv/versions/2.1.4/bin/ruby\n    --with-mysql-dir\n    --without-mysql-dir\n    --with-mysql-include\n    --without-mysql-include=${mysql-dir}/include\n    --with-mysql-lib\n    --without-mysql-lib=${mysql-dir}/lib\n    --with-mysql-config\n    --without-mysql-config\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /var/folders/sx/dm2qzym54v1c2_1kvkt1c_t80000gn/T/bundler20181107-70107-16xf5wjmysql2-0.3.21/extensions/x86_64-darwin-18/2.1.0-static/mysql2-0.3.21/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /var/folders/sx/dm2qzym54v1c2_1kvkt1c_t80000gn/T/bundler20181107-70107-16xf5wjmysql2-0.3.21/gems/mysql2-0.3.21 for inspection.\nResults logged to /var/folders/sx/dm2qzym54v1c2_1kvkt1c_t80000gn/T/bundler20181107-70107-16xf5wjmysql2-0.3.21/extensions/x86_64-darwin-18/2.1.0-static/mysql2-0.3.21/gem_make.out\n\nAn error occurred while installing mysql2 (0.3.21), and Bundler cannot continue.\nMake sure that `gem install mysql2 -v '0.3.21'` succeeds before bundling.\n\nIn Gemfile:\n  mysql2\n</code></pre>\n"}, {"tags": ["ruby", "bash"], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 1630875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/YxXAS.jpg?s=128&g=1", "display_name": "awsmsce", "link": "https://stackoverflow.com/users/1630875/awsmsce"}, "edited": false, "score": 1, "creation_date": 1541731171, "post_id": 53199837, "comment_id": 93325525, "body": "yeah, got to agree with @lacostenycoder, this makes much more sense if you just do this in ruby. Did you know that from a ruby script you can use the Open3 library to execute bash commands like &quot;bundle&quot; or &quot;gem install&quot; and then get the results of stdout? It&#39;s really useful."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1541636824, "last_edit_date": 1541636824, "creation_date": 1541636275, "answer_id": 53199837, "question_id": 53198807, "link": "https://stackoverflow.com/questions/53198807/accessing-a-ruby-property-in-bash-shell/53199837#53199837", "title": "Accessing a ruby property in bash shell", "body": "<p>This won't work because</p>\n\n<pre><code>result=\"$(schema_comparator compare \"$NEW_SCHEMA\" \"$CURRENT_LIVE_SCHEMA\")\"\n</code></pre>\n\n<p>If you are running this as a shell script <code>result</code> will only be a string in your shell with whatever your method call outputs to STDOUT.  It is not a ruby object and so no ruby commands can be called on it.  All you can do with the shell variable is whatever shell will support if you access it in shell with <code>$result</code>.</p>\n\n<p>Why do you even want to do this?  Why not just use ruby directly?</p>\n"}], "owner": {"reputation": 15000, "user_id": 350374, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e0ce885f088382a470752238295f142d?s=128&d=identicon&r=PG", "display_name": "Baz1nga", "link": "https://stackoverflow.com/users/350374/baz1nga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1541636824, "creation_date": 1541629494, "last_edit_date": 1541631606, "question_id": 53198807, "link": "https://stackoverflow.com/questions/53198807/accessing-a-ruby-property-in-bash-shell", "title": "Accessing a ruby property in bash shell", "body": "<p>I am trying to install and execute a ruby gem in my bash shell and I want to look at certain properties of the result in my shell script. How do I do this? </p>\n\n<pre><code>#!/bin/bash -l\nsource \"/usr/local/rvm/scripts/rvm\"\nrvm use 2.4.0\ngem install graphql-schema_comparator\nresult=\"$(schema_comparator compare \"$NEW_SCHEMA\" \"$CURRENT_LIVE_SCHEMA\")\"\n</code></pre>\n\n<p>Here is the ruby gem: <a href=\"https://github.com/xuorig/graphql-schema_comparator\" rel=\"nofollow noreferrer\">https://github.com/xuorig/graphql-schema_comparator</a></p>\n\n<p>I want to be able now access the result of the comparison and perform some actions based on it?</p>\n\n<pre><code>a=\"$(result?.foo)\"\nb=\"$(result.bar)\"\n</code></pre>\n\n<p>Both these are failing with the error </p>\n\n<pre><code>result?.foo: command not found\nresult.bar: command not found\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 3, "last_activity_date": 1541629796, "last_edit_date": 1541629796, "creation_date": 1541629419, "answer_id": 53198792, "question_id": 53198580, "link": "https://stackoverflow.com/questions/53198580/rspec-id-exists-in-list-of-ids/53198792#53198792", "title": "Rspec: id exists in list of id&#39;s", "body": "<p><code>response['products'][0]['ids'][0]['product_id']</code> is a <strong><code>String</code></strong>: <code>\"123\"</code>.</p>\n\n<p><a href=\"https://ruby-doc.org/core/String.html#method-i-include-3F\" rel=\"nofollow noreferrer\"><code>String#include?</code></a> will return <code>true</code> here, for the following inputs: <code>\"\"</code>, <code>\"1\"</code>, <code>\"2\"</code>, <code>\"3\"</code>, <code>\"12\"</code>, <code>\"23\"</code>, and <code>\"123\"</code> -- but that's clearly not what you're trying to test!</p>\n\n<p>You wanted to check that this <code>product_id</code> is <strong>in</strong> that list; not that it <strong>includes</strong> the list.</p>\n\n<hr>\n\n<p>This is a slightly unusual test to run, since your expectation is somewhat fuzzy.</p>\n\n<p>If this is a <code>rails</code> application (i.e. you're using <code>ActiveSupport</code>), then you can make use of <a href=\"https://apidock.com/rails/Object/in%3F\" rel=\"nofollow noreferrer\"><code>Object#in?</code></a> to write the test as follows:</p>\n\n<pre><code>expect(response['products'][0]['ids'][0]['product_id'])\n  .to be_in(product_1.id, product_2.id, product_3.id)\n</code></pre>\n\n<p>Or if we're just using vanilla ruby then perhaps use <code>rspec</code>'s <a href=\"https://relishapp.com/rspec/rspec-expectations/docs/built-in-matchers/satisfy-matcher\" rel=\"nofollow noreferrer\"><code>satisfy</code> matcher</a>:</p>\n\n<pre><code>expect(response['products'][0]['ids'][0]['product_id'])\n  .to satisfy { |product_id| [product_1.id, product_2.id, product_3.id].include?(product_id) }\n</code></pre>\n\n<p>You may also be tempted to simply reverse the order of the arguments -- which technically works, but is a little confusing since the code seems like you're running assertions on the wrong object:</p>\n\n<pre><code>expect([product_1.id, product_2.id, product_3.id])\n  .to include(response['products'][0]['ids'][0]['product_id'])\n</code></pre>\n\n<hr>\n\n<p>But back to the point of this being an \"unusual test\".</p>\n\n<p>Presumably, you've written it this way because you're not certain which order the <code>id</code>s will be listed in - i.e. which product will actually be <code>response['products'][0]</code>.</p>\n\n<p>The test would be even better if you either:</p>\n\n<ul>\n<li><em>Made the order known</em> (but I cannot really advise how without seeing more detail), so that you don't need a fuzzy matcher in the first place, or</li>\n<li>Only have 1 <code>product</code> returned by the response in this test, or</li>\n<li>Change the test to read <em>all three</em> <code>product_id</code>s from the response, and then use the <code>match_array</code> matcher.</li>\n</ul>\n"}], "owner": {"reputation": 1695, "user_id": 427354, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8b1da0d743d87175b7cc0ef93c8fcad7?s=128&d=identicon&r=PG", "display_name": "User7354632781", "link": "https://stackoverflow.com/users/427354/user7354632781"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 53198792, "answer_count": 1, "score": -1, "last_activity_date": 1541629796, "creation_date": 1541628320, "question_id": 53198580, "link": "https://stackoverflow.com/questions/53198580/rspec-id-exists-in-list-of-ids", "title": "Rspec: id exists in list of id&#39;s", "body": "<p>I am trying to write a test case where an id exists in the list of id's</p>\n\n<p>I tried following but it doesnt work.</p>\n\n<pre><code>expect(response['products'][0]['ids'][0]['product_id'])\n              .to include(product_1.id, product_2.id, product_3.id)\n</code></pre>\n\n<p>It fails everytime with error the expected id doesnt exist. \ne.g expected '123' to include '343' and '543'</p>\n\n<p>but when i step through the code all id's are there so dont get why its looking in only in two <code>ids</code>.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 2, "creation_date": 1541628707, "post_id": 53198347, "comment_id": 93285874, "body": "jsonb will be best. plus you can index and search on it too <a href=\"https://blog.codeship.com/unleash-the-power-of-storing-json-in-postgres/\" rel=\"nofollow noreferrer\">blog.codeship.com/unleash-the-power-of-storing-json-in-postg&zwnj;&#8203;res</a> also remember &quot;...premature optimization is the root of all evil&quot; ~ Knuth"}], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 2, "last_activity_date": 1541688959, "last_edit_date": 1592644375, "creation_date": 1541688959, "answer_id": 53210282, "question_id": 53198347, "link": "https://stackoverflow.com/questions/53198347/how-to-serialize-stored-json-serialization-in-ruby-rails/53210282#53210282", "title": "How to serialize stored JSON serialization (in Ruby/Rails)?", "body": "<h2>Don't worry so much.</h2>\n<p>When you use JSON/JSONB columns in Rails the driver handles serializing/unserializing the JSON. All you have to do is declare the column as JSON/JSONB.</p>\n<p>Storing JSON/YAML any other format in a text/varchar column is unlikely to give any noticeable performance gains BUT will not allow you to query the column properly. Thats what we did back in the dark days before we had native JSON/JSONB/HStore columns.</p>\n<p>It also places the burden of marshalling/unmarshalling in your models - bloating them and forgoing the use of more optimized driver code.</p>\n"}], "owner": {"reputation": 11, "user_id": 10620715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b946d44d7a7ec0cae52cf68079df9dc0?s=128&d=identicon&r=PG&f=1", "display_name": "zino", "link": "https://stackoverflow.com/users/10620715/zino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541688959, "creation_date": 1541627261, "question_id": 53198347, "link": "https://stackoverflow.com/questions/53198347/how-to-serialize-stored-json-serialization-in-ruby-rails", "title": "How to serialize stored JSON serialization (in Ruby/Rails)?", "body": "<p>I'd like to store a JSON blob in my table (Postgres). The table needs to be read frequently. After my application reads the table, it returns a JSON serialization of this blob along with other attributes of this table to the client. </p>\n\n<pre><code># To illustrate, imagine an object like this\n{\n  name: 'foo',\n  blob: {...} # this is blob that needs to be stored\n}\n</code></pre>\n\n<p>and when a client requests for it, I'd like to return a JSON response like</p>\n\n<pre><code>{\"name\": \"foo\", \"blob\": [...]}\n</code></pre>\n\n<p>Given a Postgres database, the obvious choice is to store blob in a json/jsonb column. But what about a text column? Assuming blob is not used by the application, storing a serialized string in a text column means server doesn't need to deserialize the blob then serialize back to JSON whenever the client sends a request. In other words, the server can simply treat the blob as a string. Sounds more efficient, right?</p>\n\n<p>However, because blob is now treated as a string, the serialization I get becomes</p>\n\n<pre><code>{\"name\": \"foo\", \"blob\": \"[...]\"} # note the extra \" around the array brackets\n</code></pre>\n\n<p>This leads to incorrect parsing in the client application since now blob is parsed as a string instead of an array. </p>\n\n<p>So my question is </p>\n\n<p>a. Am I correct in assuming that a text column will be more efficient than jsonb (assuming this problem is solved)?</p>\n\n<p>b. if so, whether there's a way to return an already serialized JSON object without treating it as a string? If not, what's the best way to avoid this type of deserialize-then-immediately-serialize waste?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1541626672, "post_id": 53198151, "comment_id": 93285052, "body": "Seems kind of hard to say anything helpful without seeing the data structure. Also, that <code>for i in @@pois</code> is pretty non-Ruby. Something like <code>@@pois.each do |poi|</code> would be more idiomatic. TBH, I&#39;m not even sure if that&#39;s valid syntax. (It might be.) That may well be your problem."}, {"owner": {"reputation": 107, "user_id": 9137672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde6b2d94c98ca7a5225998dae26b864?s=128&d=identicon&r=PG", "display_name": "danner.tech", "link": "https://stackoverflow.com/users/9137672/danner-tech"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1541628207, "post_id": 53198151, "comment_id": 93285689, "body": "@jvillian you might be onto something. I tried to use what I have learned thus far but the syntax may be completely off"}, {"owner": {"reputation": 2256, "user_id": 4906586, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wSTXo.jpg?s=128&g=1", "display_name": "Al-un", "link": "https://stackoverflow.com/users/4906586/al-un"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1541630978, "post_id": 53198151, "comment_id": 93286710, "body": "Your error reminds the problem of accessing nested hashes: <a href=\"https://stackoverflow.com/q/5544858/4906586\">stackoverflow.com/q/5544858/4906586</a>. Following @jvillian comment, a <code>@@pois.each do |poi| ... end</code> would be more Ruby-ish and less prone to error."}], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 1, "last_activity_date": 1541631033, "creation_date": 1541631033, "answer_id": 53199106, "question_id": 53198151, "link": "https://stackoverflow.com/questions/53198151/cant-loop-through-json-data-because-of-the-error-no-implicit-conversion-of-has/53199106#53199106", "title": "Can&#39;t loop through JSON data because of the error &quot;no implicit conversion of hash into integer&quot;", "body": "<p>Why don't you give this a try:</p>\n\n<pre><code>class ChargingStations\n  include HTTParty\n\n  @@latitude = ''\n\n  base_uri 'https://api.openchargemap.io/v2'\n\n  class &lt;&lt; self\n\n    def pois\n      @@pois \n    end\n\n    def puts_latitude\n      puts @@latitude\n    end\n\n    def put_value\n      puts @@latitude\n    end\n\n    def state_or_provinces\n      @state_or_provinces ||= @@pois.map do |poi|\n        poi.try(:[],'AddressInfo').try(:[],'StateOrProvince')\n      end.uniq\n    end\n\n    def find_sites(state_or_province=nil)\n      @state_or_province = state_or_province\n      @state_or_province ||= 'New York'\n      @@pois.select do |poi|\n        poi.try(:[],'AddressInfo').try(:[],'StateOrProvince') == @state_or_province\n      end\n    end\n\n    def generate\n      response = get('/poi')\n      if response.success?\n        @@pois = response.parsed_response\n        @@latitude = @@pois\n        return true\n      else\n        puts \"failure\"\n        raise response.response\n      end\n    end\n\n  end # Class methods\n\nend\n</code></pre>\n\n<p>Then, in console, I get:</p>\n\n<pre><code>ChargingStations.generate\n =&gt; true\n\nChargingStations.find_sites.count\n =&gt; 2\n\nChargingStations.find_sites.first\n =&gt; {\"ID\"=&gt;112491, \"UUID\"=&gt;\"5EA5B030-AFEF-4CFA-88DF-3A9F6CFFDAB5\", \"ParentChargePointID\"=&gt;nil, \"DataProviderID\"=&gt;1, \"DataProvider\"=&gt;{\"WebsiteURL\"=&gt;\"http://openchargemap.org\", \"Comments\"=&gt;nil, \"DataProviderStatusType\"=&gt;{\"IsProviderEnabled\"=&gt;true, \"ID\"=&gt;1, \"Title\"=&gt;\"Manual Data Entry\"}, \"IsRestrictedEdit\"=&gt;false, \"IsOpenDataLicensed\"=&gt;true, \"IsApprovedImport\"=&gt;true, \"License\"=&gt;\"Licensed under Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)\", \"DateLastImported\"=&gt;nil, \"ID\"=&gt;1, \"Title\"=&gt;\"Open Charge Map Contributors\"}, \"DataProvidersReference\"=&gt;nil, \"OperatorID\"=&gt;5, \"OperatorInfo\"=&gt;{\"WebsiteURL\"=&gt;\"http://www.chargepoint.net/\", \"Comments\"=&gt;nil, \"PhonePrimaryContact\"=&gt;\"1-888-758-4389\", \"PhoneSecondaryContact\"=&gt;nil, \"IsPrivateIndividual\"=&gt;false, \"AddressInfo\"=&gt;nil, \"BookingURL\"=&gt;nil, \"ContactEmail\"=&gt;\"support@coulombtech.com\", \"FaultReportEmail\"=&gt;\"support@coulombtech.com\", \"IsRestrictedEdit\"=&gt;nil, \"ID\"=&gt;5, \"Title\"=&gt;\"ChargePoint (Coulomb Technologies)\"}, \"OperatorsReference\"=&gt;nil, \"UsageTypeID\"=&gt;1, \"UsageType\"=&gt;{\"IsPayAtLocation\"=&gt;nil, \"IsMembershipRequired\"=&gt;nil, \"IsAccessKeyRequired\"=&gt;nil, \"ID\"=&gt;1, \"Title\"=&gt;\"Public\"}, \"UsageCost\"=&gt;\"free\", \"AddressInfo\"=&gt;{\"ID\"=&gt;112837, \"Title\"=&gt;\"1 Locks Plaza\", \"AddressLine1\"=&gt;\"1 Locks Plaza\", \"AddressLine2\"=&gt;nil, \"Town\"=&gt;\"Lockport\", \"StateOrProvince\"=&gt;\"New York\", \"Postcode\"=&gt;\"14094\", \"CountryID\"=&gt;2, \"Country\"=&gt;{\"ISOCode\"=&gt;\"US\", \"ContinentCode\"=&gt;\"NA\", \"ID\"=&gt;2, \"Title\"=&gt;\"United States\"}, \"Latitude\"=&gt;43.169316400362, \"Longitude\"=&gt;-78.6954369797903, \"ContactTelephone1\"=&gt;nil, \"ContactTelephone2\"=&gt;nil, \"ContactEmail\"=&gt;nil, \"AccessComments\"=&gt;\"Located at the Lockport Municipal building, \\\"The Big Bridge\\\" and the \\\"Flight of Five\\\" locks 34 and 35 on the Erie Canal.\", \"RelatedURL\"=&gt;nil, \"Distance\"=&gt;nil, \"DistanceUnit\"=&gt;0}, \"NumberOfPoints\"=&gt;1, \"GeneralComments\"=&gt;\"Located at the \\\"Big Bridge\\\" and \\\"Flight of Five\\\" locks 34 and 35 and the Lockport Municipal building\", \"DatePlanned\"=&gt;nil, \"DateLastConfirmed\"=&gt;nil, \"StatusTypeID\"=&gt;50, \"StatusType\"=&gt;{\"IsOperational\"=&gt;true, \"IsUserSelectable\"=&gt;true, \"ID\"=&gt;50, \"Title\"=&gt;\"Operational\"}, \"DateLastStatusUpdate\"=&gt;\"2018-11-04T12:56:00Z\", \"DataQualityLevel\"=&gt;1, \"DateCreated\"=&gt;\"2018-11-04T05:18:00Z\", \"SubmissionStatusTypeID\"=&gt;200, \"SubmissionStatus\"=&gt;{\"IsLive\"=&gt;true, \"ID\"=&gt;200, \"Title\"=&gt;\"Submission Published\"}, \"UserComments\"=&gt;[{\"ID\"=&gt;20389, \"ChargePointID\"=&gt;112491, \"CommentTypeID\"=&gt;10, \"CommentType\"=&gt;{\"ID\"=&gt;10, \"Title\"=&gt;\"General Comment\"}, \"UserName\"=&gt;\"Robert Seemueller\", \"Comment\"=&gt;\"Located next to the Erie Canal's \\\"Flight of Five\\\" locks, downtown shops and restaurants.\", \"Rating\"=&gt;5, \"RelatedURL\"=&gt;nil, \"DateCreated\"=&gt;\"2018-11-04T05:22:02.4Z\", \"User\"=&gt;{\"ID\"=&gt;19108, \"IdentityProvider\"=&gt;nil, \"Identifier\"=&gt;nil, \"CurrentSessionToken\"=&gt;nil, \"Username\"=&gt;\"Robert Seemueller\", \"Profile\"=&gt;nil, \"Location\"=&gt;nil, \"WebsiteURL\"=&gt;nil, \"ReputationPoints\"=&gt;289, \"Permissions\"=&gt;nil, \"PermissionsRequested\"=&gt;nil, \"DateCreated\"=&gt;nil, \"DateLastLogin\"=&gt;nil, \"IsProfilePublic\"=&gt;nil, \"IsEmergencyChargingProvider\"=&gt;nil, \"IsPublicChargingProvider\"=&gt;nil, \"Latitude\"=&gt;nil, \"Longitude\"=&gt;nil, \"EmailAddress\"=&gt;nil, \"EmailHash\"=&gt;nil, \"ProfileImageURL\"=&gt;\"https://www.gravatar.com/avatar/d8475a6af1852aa7fb2e1263c4ae5fac?s=80&amp;d=mm\", \"IsCurrentSessionTokenValid\"=&gt;nil, \"APIKey\"=&gt;nil, \"SyncedSettings\"=&gt;nil}, \"CheckinStatusTypeID\"=&gt;10, \"CheckinStatusType\"=&gt;{\"IsPositive\"=&gt;true, \"IsAutomatedCheckin\"=&gt;false, \"ID\"=&gt;10, \"Title\"=&gt;\"Charged Successfully\"}}], \"PercentageSimilarity\"=&gt;nil, \"Connections\"=&gt;[{\"ID\"=&gt;158246, \"ConnectionTypeID\"=&gt;1, \"ConnectionType\"=&gt;{\"FormalName\"=&gt;\"SAE J1772-2009\", \"IsDiscontinued\"=&gt;nil, \"IsObsolete\"=&gt;nil, \"ID\"=&gt;1, \"Title\"=&gt;\"J1772\"}, \"Reference\"=&gt;nil, \"StatusTypeID\"=&gt;50, \"StatusType\"=&gt;{\"IsOperational\"=&gt;true, \"IsUserSelectable\"=&gt;true, \"ID\"=&gt;50, \"Title\"=&gt;\"Operational\"}, \"LevelID\"=&gt;2, \"Level\"=&gt;{\"Comments\"=&gt;\"Over 2 kW, usually non-domestic socket type\", \"IsFastChargeCapable\"=&gt;false, \"ID\"=&gt;2, \"Title\"=&gt;\"Level 2 : Medium (Over 2kW)\"}, \"Amps\"=&gt;nil, \"Voltage\"=&gt;nil, \"PowerKW\"=&gt;nil, \"CurrentTypeID\"=&gt;nil, \"CurrentType\"=&gt;nil, \"Quantity\"=&gt;2, \"Comments\"=&gt;nil}], \"MediaItems\"=&gt;[{\"ID\"=&gt;16951, \"ChargePointID\"=&gt;112491, \"ItemURL\"=&gt;\"https://s3-ap-southeast-2.amazonaws.com/openchargemap/images/US/OCM112491/OCM-112491.orig.2018110405191125.jpg\", \"ItemThumbnailURL\"=&gt;\"https://s3-ap-southeast-2.amazonaws.com/openchargemap/images/US/OCM112491/OCM-112491.thmb.2018110405191125.jpg\", \"Comment\"=&gt;\"\", \"IsEnabled\"=&gt;true, \"IsVideo\"=&gt;false, \"IsFeaturedItem\"=&gt;false, \"IsExternalResource\"=&gt;false, \"MetadataValue\"=&gt;nil, \"User\"=&gt;{\"ID\"=&gt;19108, \"IdentityProvider\"=&gt;nil, \"Identifier\"=&gt;nil, \"CurrentSessionToken\"=&gt;nil, \"Username\"=&gt;\"Robert Seemueller\", \"Profile\"=&gt;nil, \"Location\"=&gt;nil, \"WebsiteURL\"=&gt;nil, \"ReputationPoints\"=&gt;289, \"Permissions\"=&gt;nil, \"PermissionsRequested\"=&gt;nil, \"DateCreated\"=&gt;nil, \"DateLastLogin\"=&gt;nil, \"IsProfilePublic\"=&gt;nil, \"IsEmergencyChargingProvider\"=&gt;nil, \"IsPublicChargingProvider\"=&gt;nil, \"Latitude\"=&gt;nil, \"Longitude\"=&gt;nil, \"EmailAddress\"=&gt;nil, \"EmailHash\"=&gt;nil, \"ProfileImageURL\"=&gt;\"https://www.gravatar.com/avatar/d8475a6af1852aa7fb2e1263c4ae5fac?s=80&amp;d=mm\", \"IsCurrentSessionTokenValid\"=&gt;nil, \"APIKey\"=&gt;nil, \"SyncedSettings\"=&gt;nil}, \"DateCreated\"=&gt;\"2018-11-04T05:19:00Z\"}, {\"ID\"=&gt;16952, \"ChargePointID\"=&gt;112491, \"ItemURL\"=&gt;\"https://s3-ap-southeast-2.amazonaws.com/openchargemap/images/US/OCM112491/OCM-112491.orig.2018110405224211.jpg\", \"ItemThumbnailURL\"=&gt;\"https://s3-ap-southeast-2.amazonaws.com/openchargemap/images/US/OCM112491/OCM-112491.thmb.2018110405224211.jpg\", \"Comment\"=&gt;\"\", \"IsEnabled\"=&gt;true, \"IsVideo\"=&gt;false, \"IsFeaturedItem\"=&gt;false, \"IsExternalResource\"=&gt;false, \"MetadataValue\"=&gt;nil, \"User\"=&gt;{\"ID\"=&gt;19108, \"IdentityProvider\"=&gt;nil, \"Identifier\"=&gt;nil, \"CurrentSessionToken\"=&gt;nil, \"Username\"=&gt;\"Robert Seemueller\", \"Profile\"=&gt;nil, \"Location\"=&gt;nil, \"WebsiteURL\"=&gt;nil, \"ReputationPoints\"=&gt;289, \"Permissions\"=&gt;nil, \"PermissionsRequested\"=&gt;nil, \"DateCreated\"=&gt;nil, \"DateLastLogin\"=&gt;nil, \"IsProfilePublic\"=&gt;nil, \"IsEmergencyChargingProvider\"=&gt;nil, \"IsPublicChargingProvider\"=&gt;nil, \"Latitude\"=&gt;nil, \"Longitude\"=&gt;nil, \"EmailAddress\"=&gt;nil, \"EmailHash\"=&gt;nil, \"ProfileImageURL\"=&gt;\"https://www.gravatar.com/avatar/d8475a6af1852aa7fb2e1263c4ae5fac?s=80&amp;d=mm\", \"IsCurrentSessionTokenValid\"=&gt;nil, \"APIKey\"=&gt;nil, \"SyncedSettings\"=&gt;nil}, \"DateCreated\"=&gt;\"2018-11-04T05:23:00Z\"}, {\"ID\"=&gt;16953, \"ChargePointID\"=&gt;112491, \"ItemURL\"=&gt;\"https://s3-ap-southeast-2.amazonaws.com/openchargemap/images/US/OCM112491/OCM-112491.orig.2018110405240797.jpg\", \"ItemThumbnailURL\"=&gt;\"https://s3-ap-southeast-2.amazonaws.com/openchargemap/images/US/OCM112491/OCM-112491.thmb.2018110405240797.jpg\", \"Comment\"=&gt;\"\", \"IsEnabled\"=&gt;true, \"IsVideo\"=&gt;false, \"IsFeaturedItem\"=&gt;false, \"IsExternalResource\"=&gt;false, \"MetadataValue\"=&gt;nil, \"User\"=&gt;{\"ID\"=&gt;19108, \"IdentityProvider\"=&gt;nil, \"Identifier\"=&gt;nil, \"CurrentSessionToken\"=&gt;nil, \"Username\"=&gt;\"Robert Seemueller\", \"Profile\"=&gt;nil, \"Location\"=&gt;nil, \"WebsiteURL\"=&gt;nil, \"ReputationPoints\"=&gt;289, \"Permissions\"=&gt;nil, \"PermissionsRequested\"=&gt;nil, \"DateCreated\"=&gt;nil, \"DateLastLogin\"=&gt;nil, \"IsProfilePublic\"=&gt;nil, \"IsEmergencyChargingProvider\"=&gt;nil, \"IsPublicChargingProvider\"=&gt;nil, \"Latitude\"=&gt;nil, \"Longitude\"=&gt;nil, \"EmailAddress\"=&gt;nil, \"EmailHash\"=&gt;nil, \"ProfileImageURL\"=&gt;\"https://www.gravatar.com/avatar/d8475a6af1852aa7fb2e1263c4ae5fac?s=80&amp;d=mm\", \"IsCurrentSessionTokenValid\"=&gt;nil, \"APIKey\"=&gt;nil, \"SyncedSettings\"=&gt;nil}, \"DateCreated\"=&gt;\"2018-11-04T05:24:00Z\"}], \"MetadataValues\"=&gt;nil, \"IsRecentlyVerified\"=&gt;true, \"DateLastVerified\"=&gt;\"2018-11-04T05:22:02.4Z\"}\n\nChargingStations.find_sites('WA').count\n =&gt; 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 316, "user_id": 2327320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9b4f11a5fdc3da09fafff0e8570db3?s=128&d=identicon&r=PG", "display_name": "camilo.forero", "link": "https://stackoverflow.com/users/2327320/camilo-forero"}, "is_accepted": false, "score": 0, "last_activity_date": 1541633066, "last_edit_date": 1541633066, "creation_date": 1541632365, "answer_id": 53199313, "question_id": 53198151, "link": "https://stackoverflow.com/questions/53198151/cant-loop-through-json-data-because-of-the-error-no-implicit-conversion-of-has/53199313#53199313", "title": "Can&#39;t loop through JSON data because of the error &quot;no implicit conversion of hash into integer&quot;", "body": "<p>In general, when you use the construct <code>for foo in fooArray</code> to iterate over a Array, the <code>foo</code> is not the index but the actual item located in that position. So if you wanted your algorithm to work with minimal modifications, the \"right\" way would look like:</p>\n\n<pre><code>@@pois.each_index do |i|\n  puts @@pois[i]\n  // rest of the algorithm ommited\nend\n</code></pre>\n\n<p>In your case, assuming that the structure of your JSON data is something like <code>[{lat: 10, lng: 10},{lat:5, lng:8}, {lat: 9, lng: -3]</code>, you are basically trying to do <code>@@pois[{lat: 10, lng: 5}]]</code>, which will give you the exact \"no implicit conversion\" error that you're getting. You could just use i directly like <code>puts i</code> or <code>i[\"AddressInfo\"][\"StateOrProvince\"]</code> and get the right answer.</p>\n\n<p>However, as it has been mentioned in the comments, a more idiomatic approach would be <code>@@pois.each do |poi|</code>. And an even <strong>more</strong> idiomatic approach would be to rename that ugly-looking \"pois\" everywhere and make it </p>\n\n<pre><code>@@positions.each do |position|\n  puts position\n  if position[\"AddressInfo\"][\"StateOrProvince\"] == \"New York\"\n    puts position\n  end\nend\n</code></pre>\n\n<p>Explicit variable names is the Ruby thing to do :)</p>\n\n<p>And assuming the first <code>puts</code> is just a general test to see it's working and you actually want to only print the ones that are in New York...</p>\n\n<pre><code>@@positions.each do |position|\n  puts position if position[\"AddressInfo\"][\"StateOrProvince\"] == \"New York\"\nend\n</code></pre>\n\n<p>And if you want to make that a one liner:</p>\n\n<pre><code>@@positions.each { |pos| puts pos if pos[\"AddressInfo\"][\"StateOrProvince\"] == \"New York\" }\n</code></pre>\n\n<p>(yeah, I know I just talked about explicit variable names but there is no need to be too rigid about it)</p>\n"}], "owner": {"reputation": 107, "user_id": 9137672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde6b2d94c98ca7a5225998dae26b864?s=128&d=identicon&r=PG", "display_name": "danner.tech", "link": "https://stackoverflow.com/users/9137672/danner-tech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541633066, "creation_date": 1541626349, "last_edit_date": 1541626452, "question_id": 53198151, "link": "https://stackoverflow.com/questions/53198151/cant-loop-through-json-data-because-of-the-error-no-implicit-conversion-of-has", "title": "Can&#39;t loop through JSON data because of the error &quot;no implicit conversion of hash into integer&quot;", "body": "<p>Hello and good afternoon all!</p>\n\n<p>I am getting an error in my console that states \"TypeError: No implicit conversion of hash into integer\" and I know that it is referring to my loop in my Ruby class document.</p>\n\n<p>Here is my Ruby file:</p>\n\n<pre><code>require 'HTTParty'\nrequire 'pp'\nrequire 'pry'\n\n=begin\nfind a way to access the latitude and longitude of the nearest charging station globally\nfind a way to access the latitude and longitude of the user\ncreate a function that finds the nearest station based on accepting both sets of coordinates and finds the difference\n=end\n\nclass ChargingStations\n    include HTTParty\n    attr_accessor :pois\n    puts \"loading\"\n    @@latitude = ''\n\n    base_uri 'https://api.openchargemap.io/v2'\n\n    def self.puts_latitude\n        puts @@latitude\n    end\n\n    def initialize(pois)\n        @@pois = pois\n        @@latitude = @@pois\n        puts @@pois\n    end\n\n    def self.put_value\n      puts @@latitude\n    end\n\n    def self.find_sites\n      for i in @@pois do\n          puts @@pois[i]\n          if @@pois[i][\"AddressInfo\"][\"StateOrProvince\"] == \"New York\"\n              puts @@pois[i]\n              end\n          end\n      end\n\n    def self.generate\n        response = get('/poi')\n        puts \"got here\"\n\n        if response.success?\n            puts \"success\"\n            self.new(response)\n\n\n        else\n            puts \"failure\"\n            raise response.response\n        end\n    end\nend\n\nbinding.pry\n</code></pre>\n\n<p>If you are able to answer the question, please explain why my loop does not work for myself and future developers.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rest", "api", "shopify"], "answers": [{"tags": [], "owner": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "is_accepted": false, "score": 0, "last_activity_date": 1541627328, "creation_date": 1541627328, "answer_id": 53198364, "question_id": 53197960, "link": "https://stackoverflow.com/questions/53197960/shopify-support-for-installment-payments/53198364#53198364", "title": "Shopify support for installment payments", "body": "<p>You cannot make a Shopify App that is an external payment gateway. You cannot get this to be part of checkout, so you cannot add field for the customer to select 3,6,9 or 12 months. </p>\n\n<p>Shopify, being a hosted platform, offers payment gateways themselves, you cannot add your own.</p>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 9456547, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8RTr05pw9TU/AAAAAAAAAAI/AAAAAAAAABI/8b_M9-81FtE/photo.jpg?sz=128", "display_name": "Thi&#234;n Duy", "link": "https://stackoverflow.com/users/9456547/thi%c3%aan-duy"}, "is_accepted": false, "score": 0, "last_activity_date": 1541661337, "creation_date": 1541661337, "answer_id": 53202981, "question_id": 53197960, "link": "https://stackoverflow.com/questions/53197960/shopify-support-for-installment-payments/53202981#53202981", "title": "Shopify support for installment payments", "body": "<p>You can use add the Script in /admin/online_store/preferences at Google Analytics card like this\n<a href=\"https://i.stack.imgur.com/iBm0T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iBm0T.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 213, "user_id": 442008, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/d6ff846a79ee3dbf5c815150537fe573?s=128&d=identicon&r=PG", "display_name": "Sanx", "link": "https://stackoverflow.com/users/442008/sanx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541661337, "creation_date": 1541625503, "question_id": 53197960, "link": "https://stackoverflow.com/questions/53197960/shopify-support-for-installment-payments", "title": "Shopify support for installment payments", "body": "<p>I am developing an app with the payment gateway Conekta.</p>\n\n<p>Conekta today supports installment payments.\nHow can I set the installment payment option so that customers can make their purchases by selecting payments at 3, 6, 9 and 12 months</p>\n\n<p>How can I put that option to be shown on the \"checkout\" screen?</p>\n\n<p>Has Shopify support for this requirement?</p>\n\n<p>In what part of the Shopify API documentation, can I check this?</p>\n"}, {"tags": ["json", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 10095385, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQNUq2AuhX0/AAAAAAAAAAI/AAAAAAAACeM/W_ToTsU2GKw/photo.jpg?sz=128", "display_name": "Sachin", "link": "https://stackoverflow.com/users/10095385/sachin"}, "edited": false, "score": 0, "creation_date": 1541627330, "post_id": 53198011, "comment_id": 93285300, "body": "How do we add a class to resize the image?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 177, "user_id": 10095385, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQNUq2AuhX0/AAAAAAAAAAI/AAAAAAAACeM/W_ToTsU2GKw/photo.jpg?sz=128", "display_name": "Sachin", "link": "https://stackoverflow.com/users/10095385/sachin"}, "edited": false, "score": 0, "creation_date": 1541627491, "post_id": 53198011, "comment_id": 93285375, "body": "@Sohel did you follow the link provided? it is fairly explanatory on this subject."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 1, "last_activity_date": 1541625709, "creation_date": 1541625709, "answer_id": 53198011, "question_id": 53197840, "link": "https://stackoverflow.com/questions/53197840/turn-image-url-into-the-image-after-parsing-json-using-rails/53198011#53198011", "title": "Turn image URL into the image after parsing JSon using Rails", "body": "<p>What you are looking for is the <a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-image_tag\" rel=\"nofollow noreferrer\"><code>image_tag</code></a> helper</p>\n\n<p>So in your case: </p>\n\n<pre><code>&lt;td&gt;&lt;%= image_tag(roster['image_url']) %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>Should do the trick</p>\n"}], "owner": {"reputation": 177, "user_id": 10095385, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQNUq2AuhX0/AAAAAAAAAAI/AAAAAAAACeM/W_ToTsU2GKw/photo.jpg?sz=128", "display_name": "Sachin", "link": "https://stackoverflow.com/users/10095385/sachin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 53198011, "answer_count": 1, "score": 0, "last_activity_date": 1541625709, "creation_date": 1541624898, "last_edit_date": 1541625239, "question_id": 53197840, "link": "https://stackoverflow.com/questions/53197840/turn-image-url-into-the-image-after-parsing-json-using-rails", "title": "Turn image URL into the image after parsing JSon using Rails", "body": "<p>My question is how do I render the image itself instead of the image url when I am parsing a JSON using HTTParty on Rails.  I am able to render the image_url as it comes through but would like the image there instead?  For example, instead of seeing:\n\"image_url\":\"<a href=\"https://d2eyrv63e6x6lp.cloudfront.net/wp-content/uploads/2015/02/20141833/John-Smith.jpg\" rel=\"nofollow noreferrer\">https://d2eyrv63e6x6lp.cloudfront.net/wp-content/uploads/2015/02/20141833/John-Smith.jpg</a>\"</p>\n\n<p>I would like to see the actual image that this represents.</p>\n\n<p>I'm using HTTParty to parse the JSon on Ruby on Rails 5.</p>\n\n<p>Here is my current view:</p>\n\n<pre><code>&lt;table&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Name&lt;/th&gt;\n      &lt;th&gt;Image&lt;/th&gt;\n      &lt;th&gt;Title&lt;/th&gt;\n      &lt;th&gt;Bio&lt;/th&gt;\n      &lt;th&gt;Vote&lt;/th&gt;\n      &lt;th colspan=\"3\"&gt;&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n\n  &lt;tbody&gt;\n    &lt;% @rosters.each do |roster| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= roster['name'] %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= roster['image_url'] %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= roster['title'] %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= roster['bio'] %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= roster['vote'] %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>Current Controller:</p>\n\n<pre><code>def index\n    @rosters = HTTParty.get('https://api.example', :headers =&gt;{'Content_Type' =&gt; 'application/json'})\nend\n</code></pre>\n\n<p>Current Model:</p>\n\n<pre><code>class Roster &lt; ApplicationRecord\n\ninclude HTTParty\nend\n</code></pre>\n"}, {"tags": ["html", "ruby", "xml", "xpath"], "answers": [{"comments": [{"owner": {"reputation": 7274, "user_id": 2065796, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/myEf4.jpg?s=128&g=1", "display_name": "Sasha Shpota", "link": "https://stackoverflow.com/users/2065796/sasha-shpota"}, "edited": false, "score": 1, "creation_date": 1541662248, "post_id": 53200569, "comment_id": 93294441, "body": "Thank you. It turns out the the XPath I mentioned in the question worked, I had an error in different place. But your code also works."}], "tags": [], "owner": {"reputation": 665, "user_id": 10306509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEjY3.jpg?s=128&g=1", "display_name": "Ivan Olshansky", "link": "https://stackoverflow.com/users/10306509/ivan-olshansky"}, "is_accepted": true, "score": 1, "last_activity_date": 1541643013, "creation_date": 1541643013, "answer_id": 53200569, "question_id": 53197257, "link": "https://stackoverflow.com/questions/53197257/xpath-find-a-node-within-a-text-node/53200569#53200569", "title": "XPath: Find a node within a text node", "body": "<p>Seems like You forget about iterator...<br>\nTry:<br></p>\n\n<pre><code>html = Nokogiri::HTML(File.read(htmlFile))\nhtml.search('//code').each{|htm| htm.remove}\n</code></pre>\n"}], "owner": {"reputation": 7274, "user_id": 2065796, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/myEf4.jpg?s=128&g=1", "display_name": "Sasha Shpota", "link": "https://stackoverflow.com/users/2065796/sasha-shpota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 53200569, "answer_count": 1, "score": 1, "last_activity_date": 1541662164, "creation_date": 1541622201, "last_edit_date": 1541662164, "question_id": 53197257, "link": "https://stackoverflow.com/questions/53197257/xpath-find-a-node-within-a-text-node", "title": "XPath: Find a node within a text node", "body": "<p>I have the following html:</p>\n\n<pre><code>&lt;code&gt;The first code block&lt;/code&gt;\n&lt;p&gt;Some text and &lt;code&gt;the second code block&lt;/code&gt; followed by other text&lt;/p&gt;\n</code></pre>\n\n<p>I need to find and remove all <code>code</code> blocks from it. I use the following XPath <code>'//code'</code>, but it finds only the first code block while the second remains.</p>\n\n<p><strong>Question:</strong> Why <code>'//code'</code> is not able to catch the second code block? How to fix it?</p>\n\n<p><strong>Details:</strong> I'm doing it in Ruby using <code>Nokagiry</code>. My code looks like this:</p>\n\n<pre><code>html = Nokogiri::HTML(File.read(htmlFile))\nhtml.search('//code').remove\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>The XPath worked in fact. I just made a mistake in different place.</p>\n"}, {"tags": ["java", "ruby-on-rails", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 460, "user_id": 6336045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/dWWGM.png?s=128&g=1", "display_name": "xSlok", "link": "https://stackoverflow.com/users/6336045/xslok"}, "edited": false, "score": 0, "creation_date": 1541655499, "post_id": 53197435, "comment_id": 93292456, "body": "What gem are you talking  about? Postgresql driver? If so, that wouldn&#39;t really help, considering I&#39;m connecting using a JDBC connection on a non jruby project. As for the jar file for the driver, I&#39;m loading it using Rjb.add_jar and Rjb.include"}], "tags": [], "owner": {"reputation": 1, "user_id": 10620516, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3871df85f95b09acca9ced4da77295df?s=128&d=identicon&r=PG", "display_name": "user10620516", "link": "https://stackoverflow.com/users/10620516/user10620516"}, "is_accepted": false, "score": 0, "last_activity_date": 1541623642, "last_edit_date": 1541623642, "creation_date": 1541623030, "answer_id": 53197435, "question_id": 53197148, "link": "https://stackoverflow.com/questions/53197148/ruby-java-bridge-jdbc-connection-rails/53197435#53197435", "title": "Ruby-Java bridge JDBC Connection Rails", "body": "<p>Have you installed the gem? Meaning have you ran the command that installs the gem on the gemfile you're working on. </p>\n"}], "owner": {"reputation": 460, "user_id": 6336045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/dWWGM.png?s=128&g=1", "display_name": "xSlok", "link": "https://stackoverflow.com/users/6336045/xslok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541623642, "creation_date": 1541621703, "question_id": 53197148, "link": "https://stackoverflow.com/questions/53197148/ruby-java-bridge-jdbc-connection-rails", "title": "Ruby-Java bridge JDBC Connection Rails", "body": "<p>I'm trying to create a connection with postgresql using a gem called RJB (Ruby-Java bridge) by importing the \"Class\" class and the \"DriverManager\" class, and running the following code: </p>\n\n<pre><code>Class.forName(\"org.postgresql.Driver\")\nurl = \"jdbc:postgresql://localhost:5432/database\"\ncon = DriverManager.getConnection(url, 'root', '123')\n</code></pre>\n\n<p>but I get the following error: \nSQLException: No suitable driver found for <code>jdbc:postgresql://localhost:5432/database</code>\nis there a way to make it work?\nThanks!</p>\n"}, {"tags": ["ruby", "shopify", "fulfillment"], "comments": [{"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1541639225, "post_id": 53195509, "comment_id": 93288883, "body": "Quick side note, if you&#39;re using Ruby on Rails, or at least ActiveSupport, then you can change <code>order[0].id != &quot;&quot; and !order[0].id.to_s.empty? </code> to <code>order[0].id.present?</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "is_accepted": true, "score": 2, "last_activity_date": 1541627430, "creation_date": 1541627430, "answer_id": 53198383, "question_id": 53195509, "link": "https://stackoverflow.com/questions/53195509/shopify-api-ruby-gem-not-creating-fulfillment/53198383#53198383", "title": "Shopify_api Ruby Gem not creating fulfillment", "body": "<p>Fulfillments are now requiring you to specify a location where the item is being fulfilled from. Check out the documentation concerning Locations and Inventory Items.</p>\n\n<p>Once you have a location ID, you can create a fulfillment for an item from an order.</p>\n"}], "owner": {"reputation": 59, "user_id": 2402551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8c2e6316c1228ff0a1018c7e41979cb?s=128&d=identicon&r=PG", "display_name": "Ian Brown", "link": "https://stackoverflow.com/users/2402551/ian-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 53198383, "answer_count": 1, "score": 1, "last_activity_date": 1541627430, "creation_date": 1541614901, "last_edit_date": 1541624923, "question_id": 53195509, "link": "https://stackoverflow.com/questions/53195509/shopify-api-ruby-gem-not-creating-fulfillment", "title": "Shopify_api Ruby Gem not creating fulfillment", "body": "<p>I have a csv that we upload to an app and I want that csv with Order Number and Tracking Number to then go in and mark the order as fulfilled and put in a tracking number on each order. When coding this, my Intellisense is not picking up the ShopifyAPI::Fulfillment so I am not 100% sure if that is how I should do it. I don't get an error in the code but I also don't get the order fulfilled... am I doing something wrong?</p>\n\n<pre><code>order = ShopifyAPI::Order.find(:all, params: { name: o_id, status: \"any\" }) \nif order[0].id != \"\" and !order[0].id.to_s.empty? \n  items = Array.new order[0].line_items.each do |item| \n    items.push({\"id\": item.id}) \n  end \n  fulfill = ShopifyAPI::Fulfillment.new(order_id: order[0].id, line_items: items) \n  fulfill.tracking_numbers = [track.to_s] \n  puts fulfill \n  fulfill.save \n  order[0].save \nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "navicat"], "answers": [{"comments": [{"owner": {"reputation": 6067, "user_id": 181902, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/04b9238a7f9d2c25e22913f0126da1c4?s=128&d=identicon&r=PG", "display_name": "thornomad", "link": "https://stackoverflow.com/users/181902/thornomad"}, "edited": false, "score": 1, "creation_date": 1541622414, "post_id": 53196922, "comment_id": 93283089, "body": "Thanks for that information.  Unless I am really confused, however: <code>2018-11-06 08:00:00-08</code> <i>is</i> 16 hours ahead of <code>2018-11-06 00:00:00+00</code>.  I added a photo to the post showing how <code>moment()</code> would interpret those two timestamped values.  PS - the <code>SET TIME ZONE</code> did the trick though I think.  Thanks."}, {"owner": {"reputation": 930, "user_id": 3577922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eURpm.jpg?s=128&g=1", "display_name": "Masa Sakano", "link": "https://stackoverflow.com/users/3577922/masa-sakano"}, "reply_to_user": {"reputation": 6067, "user_id": 181902, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/04b9238a7f9d2c25e22913f0126da1c4?s=128&d=identicon&r=PG", "display_name": "thornomad", "link": "https://stackoverflow.com/users/181902/thornomad"}, "edited": false, "score": 0, "creation_date": 1541623000, "post_id": 53196922, "comment_id": 93283337, "body": "I see, I&#39;m with you. &quot;08:00:00-08&quot; is 8 am at the time zone of -8hours, and so it is equivalent to 4pm at UTC. Sorry, I too was confused\u2026"}], "tags": [], "owner": {"reputation": 930, "user_id": 3577922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eURpm.jpg?s=128&g=1", "display_name": "Masa Sakano", "link": "https://stackoverflow.com/users/3577922/masa-sakano"}, "is_accepted": true, "score": 2, "last_activity_date": 1541623804, "last_edit_date": 1541623804, "creation_date": 1541620780, "answer_id": 53196922, "question_id": 53195407, "link": "https://stackoverflow.com/questions/53195407/replicating-rails-timezone-magic-in-postgres/53196922#53196922", "title": "Replicating Rails timezone &quot;magic&quot; in Postgres", "body": "<p>In my understanding, it is not a Rails magic, but Rails simply uses the UTC as the default.  And that is why Rails can and does use <code>timezone</code> as opposed to <code>timezonetz</code> or something for the default database type for <code>created_at</code> etc.</p>\n\n<p>You can modify the Rails default timezone as follows if you like (see the <a href=\"https://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html\" rel=\"nofollow noreferrer\">official reference</a>):</p>\n\n<pre><code># application.rb:\nclass Application &lt; Rails::Application\n  config.time_zone = 'Eastern Time (US &amp; Canada)'\nend\n</code></pre>\n\n<p>As for PostgreSQL, <strike>your result is <strong>not</strong> ahead;</strike> it seems your default time zone is somewhere in the American continent (8 hours behind the UTC).  You can check it as follows:</p>\n\n<pre><code>postgres=&gt; SET TIME ZONE 'America/New_York';\npostgres=&gt; select ('2018-11-06' at time zone 'UTC')::timestamptz;\n        timezone        \n------------------------\n 2018-11-06 05:00:00-05\n(1 row)\n</code></pre>\n\n<p>I don't know what <code>Navicat</code> does.  But maybe check out your <code>postgresql.conf</code>.  You may reset your <code>timezone</code> to the UTC if you want (and restart the postgreSQL server).\nSee <a href=\"https://stackoverflow.com/questions/6663765/postgres-default-timezone/11443155#11443155\">this answer to \"postgres default timezone\"</a> for further detail.</p>\n"}], "owner": {"reputation": 6067, "user_id": 181902, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/04b9238a7f9d2c25e22913f0126da1c4?s=128&d=identicon&r=PG", "display_name": "thornomad", "link": "https://stackoverflow.com/users/181902/thornomad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53196922, "answer_count": 1, "score": 0, "last_activity_date": 1541623804, "creation_date": 1541614514, "last_edit_date": 1541622354, "question_id": 53195407, "link": "https://stackoverflow.com/questions/53195407/replicating-rails-timezone-magic-in-postgres", "title": "Replicating Rails timezone &quot;magic&quot; in Postgres", "body": "<p>Is there a way I can have Postgres (I use Navicat but will demonstrate via the command line tool) behave in the same way that Rails does when it comes to timezones and UTC?</p>\n\n<p>Rails seems to do some magic that makes Postgres behave in a UTC-fashion; whereas via the command line (or Navicat) it is using my system timezone.  This is confusing because results vary based on whether I am executing the query in Ruby/Rails or in the console.</p>\n\n<p>I still struggle with timezones in Postgres but having Rails and the console exihibit different behavior is maddening.  Can I remedy this?</p>\n\n<h3>Here is one example (different output values):</h3>\n\n<pre><code>-- in postgress:\n# select ('2018-11-06' at time zone 'utc')::timestamptz;\n        timezone\n------------------------\n 2018-11-06 08:00:00-08\n(1 row)\n\n-- in rails console\n&gt; ApplicationRecord.execute(\"select ('2018-11-06' at time zone 'utc')::timestamptz\").first\n   (0.5ms)  select ('2018-11-06' at time zone 'utc')::timestamptz\n=&gt; #&lt;OpenStruct timezone=\"2018-11-06 00:00:00+00\"&gt;\n</code></pre>\n\n<p>They are both formatted differently (<code>-00</code> vs <code>-08</code>) and, even more confusing, they return actual different times.  </p>\n\n<p><em>The Postgres example is returning a result 16 hours ahead of the Rails one!</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/UGOJg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UGOJg.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1541614381, "post_id": 53195316, "comment_id": 93279366, "body": "Do you mean sqlite or mysql? You said, and tagged, sqlite; but things like &quot;ENGINE=InnoDB&quot; suggests MySQL. ...though the data types look like sqlite... are you going from sqlite to mysql (not postgres)?"}, {"owner": {"reputation": 61, "user_id": 10502004, "user_type": "registered", "profile_image": "https://graph.facebook.com/2245378312363818/picture?type=large", "display_name": "Cedric Miraflor", "link": "https://stackoverflow.com/users/10502004/cedric-miraflor"}, "reply_to_user": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1541615151, "post_id": 53195316, "comment_id": 93279704, "body": "im sorry  i meant mysql2 to postgresql.. ill edit it out"}], "answers": [{"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 0, "last_activity_date": 1541619426, "creation_date": 1541619426, "answer_id": 53196584, "question_id": 53195316, "link": "https://stackoverflow.com/questions/53195316/how-do-i-migrate-mysql-to-postgresql-in-rails/53196584#53196584", "title": "How do I migrate MySQL to PostgreSQL in Rails", "body": "<p>Your <code>:options</code> for your <code>create_table</code> call are MySQL-specific so you can just drop them:</p>\n\n<pre><code>create_table :versions do |t|\n  #...\nend\n</code></pre>\n\n<p>There are a couple other things you might want to change as well:</p>\n\n<ol>\n<li><code>t.string</code> without a <code>:limit</code> is equivalent to <code>t.text</code> with PostgreSQL. You might want to add a <code>:limit</code> to those if you're assuming that MySQL's default size limit on <code>varchar</code> columns (if any) will be applied. Or you could change it to <code>t.text</code> to be more explicit that you want an arbitrarily sized column.</li>\n<li>There is no <code>:limit</code> option for <code>t.text</code> in PostgreSQL so you should drop that to avoid confusion.</li>\n<li>Depending what your <code>object</code> column really is, you might want to migrate that to <code>jsonb</code>. For example, if you're using <code>serialize :object</code> in your model then it would be better off as <code>jsonb</code> without serializing it to YAML like <code>serialize</code> does.</li>\n<li><code>t.string</code> with a <code>:limit</code> (i.e. <code>varchar(n)</code> in the database) is actually slightly more expensive than <code>t.string</code> without a <code>:limit</code> (which is really just <code>t.text</code> with a different name). If you don't have a strict need for that <code>limit: 191</code> then you might want to drop it and let <code>item_type</code> without a strict size limit. You don't have to drop the <code>:limit</code> but it doesn't serve much purpose with PostgreSQL.</li>\n</ol>\n"}], "owner": {"reputation": 61, "user_id": 10502004, "user_type": "registered", "profile_image": "https://graph.facebook.com/2245378312363818/picture?type=large", "display_name": "Cedric Miraflor", "link": "https://stackoverflow.com/users/10502004/cedric-miraflor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 53196584, "answer_count": 1, "score": -1, "last_activity_date": 1541619426, "creation_date": 1541614192, "last_edit_date": 1541616906, "question_id": 53195316, "link": "https://stackoverflow.com/questions/53195316/how-do-i-migrate-mysql-to-postgresql-in-rails", "title": "How do I migrate MySQL to PostgreSQL in Rails", "body": "<p>I tried to migrate my database from MySQL to PostgreSQL.\nWhenever I migrated I got this error, I'm new to PostgreSQL, I wish somebody have an idea</p>\n\n<p><a href=\"https://i.stack.imgur.com/KW9rp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KW9rp.png\" alt=\"errror message\"></a>\n<a href=\"https://i.stack.imgur.com/omunI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/omunI.png\" alt=\"this is my schema\"></a></p>\n"}, {"tags": ["ruby", "watir"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10557906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rMSQ09z-Mhc/AAAAAAAAAAI/AAAAAAAAIic/s5djuJPYp4A/photo.jpg?sz=128", "display_name": "J P", "link": "https://stackoverflow.com/users/10557906/j-p"}, "edited": false, "score": 0, "creation_date": 1541609821, "post_id": 53194196, "comment_id": 93277122, "body": "I follow you, how to I address this?"}, {"owner": {"reputation": 3, "user_id": 10557906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rMSQ09z-Mhc/AAAAAAAAAAI/AAAAAAAAIic/s5djuJPYp4A/photo.jpg?sz=128", "display_name": "J P", "link": "https://stackoverflow.com/users/10557906/j-p"}, "edited": false, "score": 0, "creation_date": 1541610701, "post_id": 53194196, "comment_id": 93277592, "body": "Thank you for explaining that so well, it made sense immediately and is working."}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "reply_to_user": {"reputation": 3, "user_id": 10557906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rMSQ09z-Mhc/AAAAAAAAAAI/AAAAAAAAIic/s5djuJPYp4A/photo.jpg?sz=128", "display_name": "J P", "link": "https://stackoverflow.com/users/10557906/j-p"}, "edited": false, "score": 0, "creation_date": 1541610842, "post_id": 53194196, "comment_id": 93277673, "body": "@JP, happy to help! :)"}], "tags": [], "owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "is_accepted": true, "score": 2, "last_activity_date": 1541610219, "last_edit_date": 1541610219, "creation_date": 1541609709, "answer_id": 53194196, "question_id": 53194009, "link": "https://stackoverflow.com/questions/53194009/ruby-no-implicit-conversion-of-array-into-string/53194196#53194196", "title": "Ruby - no implicit conversion of Array into String", "body": "<p>Your <code>sic_code</code> method returns subtables array, that's why you have this error. It doesn't matter that the method puts something, every method in ruby implicitly returns result of its last line, in your case it is <code>subtables.each do ... end</code>, so you have an array.</p>\n\n<p>You need to explicitly return needed value. Not sure if I correctly understood what are you doing in your code, but try something like this:</p>\n\n<pre><code>def sic_code\n  subtables = @b.table(:class =&gt; 'industry-codes').tables(:class =&gt; 'industry-code-table')\n  result = [] # you need to collect result somewhere to return it later\n  subtables.each do |subtable|\n    if subtable.tbody.h4.text == \"US SIC 1987:\"\n      subtable.tr.next_siblings.each do |tr|\n        codes = tr.cell\n        result &lt;&lt; codes.text.to_s\n      end\n    end\n  end\n  result.join(', ') \nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10557906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rMSQ09z-Mhc/AAAAAAAAAAI/AAAAAAAAIic/s5djuJPYp4A/photo.jpg?sz=128", "display_name": "J P", "link": "https://stackoverflow.com/users/10557906/j-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6239, "favorite_count": 0, "accepted_answer_id": 53194196, "answer_count": 1, "score": 0, "last_activity_date": 1541610219, "creation_date": 1541609019, "last_edit_date": 1541609600, "question_id": 53194009, "link": "https://stackoverflow.com/questions/53194009/ruby-no-implicit-conversion-of-array-into-string", "title": "Ruby - no implicit conversion of Array into String", "body": "<p>I am getting an error when executing my test.</p>\n\n<pre><code> Failure/Error: expect(industry_sic_code).to include page.sic_code\n\n TypeError:\n   no implicit conversion of Array into String\n # ./spec/os/bal/company/company_filter_clean_harbors_industries_stub.rb:62:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>The Method: </p>\n\n<pre><code>def sic_code\n  subtables = @b.table(:class =&gt; 'industry-codes').tables(:class =&gt; 'industry-code-table')\n  subtables.each do |subtable|\n    if subtable.tbody.h4.text == \"US SIC 1987:\"\n      subtable.tr.next_siblings.each do |tr|\n       codes = tr.cell\n       puts codes.text.to_s\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>The Test:</p>\n\n<pre><code>  it 'Given I search for a random Clean Harbors Industry' do\n\n  #Pick a random clean industry from the file\n    data = CSV.foreach(file_path, headers: true).map{ |row| row.to_h }\n    random = data.sample\n\n    random_industry = random[\"Class\"]\n    industry_sic_code = random[\"SIC Code\"]\n  end\n\n  it 'Then the result has the expected SIC code' do\n    page = DetailPage.new(@b)\n    page.view\n\n    expect(industry_sic_code).to include page.sic_code\n  end\n</code></pre>\n\n<p>I have tried to implicitly change each variable to a string but it still complain about the array issue.  </p>\n\n<p>When I include some puts statments, I get some really wonky responses.  The method itself returns the expected result.</p>\n\n<p>When I used the method in the test I end up with the code gibberish below.</p>\n\n<pre><code>here are the sic codes from the method\n5511\n\nHere are the codes from the test\n#&lt;Watir::Table:0x00007fa3cb23f020&gt;\n#&lt;Watir::Table:0x00007fa3cb23ee40&gt;\n#&lt;Watir::Table:0x00007fa3cb23ec88&gt;\n#&lt;Watir::Table:0x00007fa3cb23ead0&gt;\n#&lt;Watir::Table:0x00007fa3cb23e918&gt;\n#&lt;Watir::Table:0x00007fa3cb23e738&gt;\n#&lt;Watir::Table:0x00007fa3cb23e580&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1541608146, "post_id": 53193404, "comment_id": 93276203, "body": "you can&#39;t replace <code>(numbers)</code> with actual numbers becausse that&#39;s the list of arguments. The only place you can supply actual numbers is when you <i>call</i> the function (not when you define it)"}, {"owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1541609007, "post_id": 53193404, "comment_id": 93276672, "body": "Thanks, I&#39;ve just tried calling the function. Now it sees a single number or array as 0 arguments, but more than 1 as too many. I can only get 0 or 2+."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1541616887, "post_id": 53193404, "comment_id": 93280494, "body": "You&#39;re going to like Ruby. Here you can write <code>[5, 8, 12, 18, 22].min(2).sum #=&gt; 13</code>. See <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-min\" rel=\"nofollow noreferrer\">Array#min</a> and <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-sum\" rel=\"nofollow noreferrer\">Array#sum</a>."}, {"owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "edited": false, "score": 0, "creation_date": 1541722703, "post_id": 53193404, "comment_id": 93323805, "body": "That&#39;s such an elegant solution, and here&#39;s me reprogramming the wheel! I&#39;m liking it already."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "edited": false, "score": 0, "creation_date": 1541609581, "post_id": 53194045, "comment_id": 93277004, "body": "That&#39;s done it! Many thanks for the clear explanation."}], "tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": true, "score": 1, "last_activity_date": 1541609117, "creation_date": 1541609117, "answer_id": 53194045, "question_id": 53193404, "link": "https://stackoverflow.com/questions/53193404/argumenterror-wrong-number-of-arguments-given-0-expected-1/53194045#53194045", "title": "ArgumentError wrong number of arguments (given 0, expected 1)", "body": "<p>You're recursively calling <code>sum_two_smallest_numbers</code> with no arguments., and it requires an argument. Each time you write <code>sum_two_smallest_numbers</code>, that's a method invocation. When you write <code>sum_two_smallest_numbers[0]</code>, that's a method invocation with no arguments, the <code>[0]</code> would access the 0'th element of the returned value, if the invocation succeeded.</p>\n\n<p>It seems like you might have wanted <code>numbers[0]</code>, <code>sum_two_smallest_numbers[0]</code>.</p>\n"}], "owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "accepted_answer_id": 53194045, "answer_count": 1, "score": 1, "last_activity_date": 1541660622, "creation_date": 1541607088, "last_edit_date": 1541660622, "question_id": 53193404, "link": "https://stackoverflow.com/questions/53193404/argumenterror-wrong-number-of-arguments-given-0-expected-1", "title": "ArgumentError wrong number of arguments (given 0, expected 1)", "body": "<p>I have written a program for codewars that finds the lowest two integers and returns the sum of them:</p>\n\n<pre><code>def sum_two_smallest_numbers(numbers)\n  array_lowest = [0, 0]\n  main_iterate = 2\n  array_lowest[0] = sum_two_smallest_numbers[0]\n  array_lowest[1] = sum_two_smallest_numbers[1]\n  until main_iterate == sum_two_smallest_numbers.length - 1 #maybe -2, or 0\n    if sum_two_smallest_numbers[main_iterate] &lt; array_lowest[0]\n      array_lowest[0] = sum_two_smallest_numbers[main_iterate]\n      main_iterate += 1\n    elsif sum_two_smallest_numbers[main_iterate] &lt; array_lowest[1]\n      array_lowest[1] = sum_two_smallest_numbers[main_iterate]\n      main_iterate += 1\n    else\n      main_iterate += 1\n    end\n  end\n  return array_lowest[0] + array_lowest[1]\nend\n</code></pre>\n\n<p>to fulfill tests as follows:</p>\n\n<pre><code>Test.assert_equals(sum_two_smallest_numbers([5, 8, 12, 18, 22]), 13) \nTest.assert_equals(sum_two_smallest_numbers([7, 15, 12, 18, 22]), 19) \nTest.assert_equals(sum_two_smallest_numbers([25, 42, 12, 18, 22]), 30) \n</code></pre>\n\n<p>It complains about my first line (this was provided along with an <code>end</code>), and if I replace <code>numbers</code> with any actual numbers, as in the test cases, it throws this:</p>\n\n<pre><code>syntax error, unexpected tINTEGER, expecting ')'\n</code></pre>\n\n<p>How can I solve this?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "prawn"], "answers": [{"tags": [], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "is_accepted": false, "score": 0, "last_activity_date": 1541619105, "creation_date": 1541619105, "answer_id": 53196514, "question_id": 53193228, "link": "https://stackoverflow.com/questions/53193228/prawn-image-is-cropped-full-image-not-render/53196514#53196514", "title": "Prawn - image is cropped &amp; full image not render", "body": "<p>This answer is based on my preference since I realized there are many ways to go about this. For me personally this is the most lean and flexible solution.</p>\n\n<pre><code>      pdf_prawn = Prawn::Document.new(page_size: 'LETTER')\n      pdf_prawn.image format_image, fit: [610, 790],\n                                    position: :center,\n                                    position: :center\n</code></pre>\n\n<p>So you set <code>page_size</code> to <code>LETTER</code> and then you get the dimensions of letter and pass those as the arguments to <code>fit:</code> taking into consideration the <code>.5</code> margin on the page. You can also use <code>scale:</code> for the resizing of the image but I found it lacking precision. More information regarding this can be found in the <a href=\"http://prawnpdf.org/manual.pdf\" rel=\"nofollow noreferrer\">Prawn</a> manual</p>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 5111301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2304e14c4015250e200cb34f74fa0bca?s=128&d=identicon&r=PG&f=1", "display_name": "bonsai", "link": "https://stackoverflow.com/users/5111301/bonsai"}, "is_accepted": false, "score": 0, "last_activity_date": 1541690655, "creation_date": 1541690655, "answer_id": 53210857, "question_id": 53193228, "link": "https://stackoverflow.com/questions/53193228/prawn-image-is-cropped-full-image-not-render/53210857#53210857", "title": "Prawn - image is cropped &amp; full image not render", "body": "<p>You can get the page dimensions by using:</p>\n\n<pre><code>pdf_prawn.bounds.width\npdf_prawn.bounds.height\n</code></pre>\n\n<p>You can pass those to fit.</p>\n"}], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541690655, "creation_date": 1541606535, "question_id": 53193228, "link": "https://stackoverflow.com/questions/53193228/prawn-image-is-cropped-full-image-not-render", "title": "Prawn - image is cropped &amp; full image not render", "body": "<p>I'm currently working on a Ruby on Rails 5.2 application using Prawn and CombinePDF. I make a request to get a file to the Box api. The file I get from box I then convert to string using <code>StringIO.new(image)</code> which I then add to a prawn document as shown.</p>\n\n<pre><code>attach_docs_from_submission(user_data).each do |file|\n      image = client.download_file(file)\n      format_image = StringIO.new(image)\n      pdf_prawn = Prawn::Document.new\n      pdf_prawn.image format_image\n      pdf_data = pdf_prawn.render\n      pdf &lt;&lt; CombinePDF.parse(pdf_data)\n    end\n</code></pre>\n\n<p>However, when I check the PDF is not the full image. <a href=\"https://i.stack.imgur.com/ZxaM6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZxaM6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there a way to fit full size of image? is the issue coming from Prawn or CombinePDF?</p>\n"}, {"tags": ["ruby", "logstash"], "answers": [{"tags": [], "owner": {"reputation": 758, "user_id": 1971056, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/LnK2w.png?s=128&g=1", "display_name": "TheFiddlerWins", "link": "https://stackoverflow.com/users/1971056/thefiddlerwins"}, "is_accepted": false, "score": 0, "last_activity_date": 1541615534, "creation_date": 1541615534, "answer_id": 53195648, "question_id": 53193122, "link": "https://stackoverflow.com/questions/53193122/remove-last-string-in-logstash-list/53195648#53195648", "title": "Remove last string in logstash list", "body": "<p>You're probably going to need a ruby snippet, read the payload in as an array and then delete the last item in the array. Even if the data was clean JSON you'd need some sort of logic in there so you could determine which line was last.</p>\n\n<p>Alternatively you could do something with gsub &amp; regex depending on how unique the last line of your data is (i.e. look for the data after \"login\": and \"password\":</p>\n\n<p>The kv filter may help.</p>\n\n<p>I am assuming you do not actually have end lines in there &amp; the format above is from rubydebug? </p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1541620004, "creation_date": 1541620004, "answer_id": 53196721, "question_id": 53193122, "link": "https://stackoverflow.com/questions/53193122/remove-last-string-in-logstash-list/53196721#53196721", "title": "Remove last string in logstash list", "body": "<p>If your log is a hash you could simply do <code>log[\"deviceCustomString3\"] = log[\"deviceCustomString3\"][0..-2]</code> to delete the last element of the array.</p>\n\n<p>Se the example below, I cut off the hash to keep it short. </p>\n\n<pre><code>log = {\n        \"deviceCustomString3\" =&gt; \n          [\n            \"Connection: keep-alive\",\n            \"X-Forwarded-For: x.x.x.x\",\n            \"\",\n            \"{\\\"login\\\":\\\"xxxx \\\",\\\"password\\\":\\\"xxxx\\\"}\"\n          ]\n}\n\nlog[\"deviceCustomString3\"] = log[\"deviceCustomString3\"][0..-2]\n\nlog #=&gt; {\"deviceCustomString3\"=&gt;[\"Connection: keep-alive\", \"X-Forwarded-For: x.x.x.x\", \"\"]}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10619274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e57eeeebc43072c8ddcd0b1969d5374b?s=128&d=identicon&r=PG&f=1", "display_name": "Akkyn", "link": "https://stackoverflow.com/users/10619274/akkyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1541620004, "creation_date": 1541606272, "last_edit_date": 1541607536, "question_id": 53193122, "link": "https://stackoverflow.com/questions/53193122/remove-last-string-in-logstash-list", "title": "Remove last string in logstash list", "body": "<p>Here is my logstash configuration file : </p>\n\n<pre><code> input {\n    file {\n            path           =&gt; \"/usr/share/logstash/logs\"\n            codec           =&gt; \"cef\"\n            start_position =&gt; \"beginning\"\n            sincedb_path =&gt; \"/dev/null\"\n    }\n}\n\n filter {\n    mutate {\n            split =&gt; { \"deviceCustomString3\" =&gt; \"\\r\\n\" }\n    }\n }\n\n\noutput {\n    stdout{}\n }\n</code></pre>\n\n<p>And an log extract :</p>\n\n<pre><code>{\n     \"deviceCustomString4Label\" =&gt; \"attack_type\",\n     \"deviceCustomString2Label\" =&gt; \"http_class_name\",\n          \"deviceCustomString4\" =&gt; \"Buffer Overflow\",\n                   \"sourcePort\" =&gt; \"39651\",\n                   \"requestUrl\" =&gt; \"/api/v1/auth/login\",\n                \"sourceAddress\" =&gt; \"x.x.x.x\",\n          \"deviceCustomString2\" =&gt; \"/Common/xxxxx\",\n                         \"name\" =&gt; \"Illegal URL length\",\n            \"devicePostReferer\" =&gt; \"Referer: https://xxxxx\",\n                     \"@version\" =&gt; \"1\",\n                         \"path\" =&gt; \"/usr/share/logstash/logs\",\n          \"devicePostUserAgent\" =&gt; \"Accept: application/json, text/plain, */*\",\n          \"deviceCustomNumber1\" =&gt; \"201\",\n     \"deviceCustomString5Label\" =&gt; \"x_forwarded_for_header_value\",\n                \"deviceVersion\" =&gt; \"x.x.x\",\n                \"deviceProduct\" =&gt; \"xxx\",\n                   \"cefVersion\" =&gt; \"xxx:xxx:0\",\n                \"deviceAddress\" =&gt; \"x.x.x.x\",\n          \"deviceCustomString1\" =&gt; \"/Common/TEMPLATE\",\n          \"deviceCustomString6\" =&gt; \"FR\",\n     \"deviceCustomIPv6Address2\" =&gt; \"\",\n\"deviceCustomIPv6Address4Label\" =&gt; \"ip_address_intelligence\",\n            \"deviceReceiptTime\" =&gt; \"Nov 07 2018 03:51:11\",\n               \"sourceUserName\" =&gt; \"N/A\",\n          \"deviceCustomNumber2\" =&gt; \"3\",\n           \"destinationAddress\" =&gt; \"x.x.x.x\",\n     \"deviceCustomString6Label\" =&gt; \"geo_location\",\n            \"deviceCustomDate1\" =&gt; \"Nov 06 2018 16:58:52\",\n\"deviceCustomIPv6Address3Label\" =&gt; \"destination_address\",\n     \"deviceCustomIPv6Address4\" =&gt; \"N/A\",\n     \"deviceCustomNumber2Label\" =&gt; \"violation_rating\",\n           \"deviceEventClassId\" =&gt; \"Illegal URL length\",\n                 \"sourceUserId\" =&gt; \"7f4f66179a45f7ca\",\n                         \"host\" =&gt; \"xxxxx\",\n                \"requestMethod\" =&gt; \"POST\",\n                   \"@timestamp\" =&gt; 2018-11-07T15:23:12.590Z,\n          \"deviceCustomNumber3\" =&gt; \"0\",\n               \"devicePostHost\" =&gt; \"User-Agent: Mozilla/5.0 (Android 7.0; Mobile; rv:62.0) Gecko/62.0 Firefox/62.0\",\n     \"deviceCustomNumber1Label\" =&gt; \"response_code\",\n                 \"deviceAction\" =&gt; \"alerted\",\n             \"deviceExternalId\" =&gt; \"2\",\n     \"deviceCustomIPv6Address1\" =&gt; \"\",\n     \"deviceCustomString1Label\" =&gt; \"policy_name\",\n       \"deviceCustomDate1Label\" =&gt; \"policy_apply_date\",\n                      \"message\" =&gt; \"N/A\",\n                         \"type\" =&gt; \"xxx\",\n     \"deviceCustomString3Label\" =&gt; \"full_request\",\n\"deviceCustomIPv6Address1Label\" =&gt; \"device_address\",\n                     \"severity\" =&gt; \"4\",\n          \"applicationProtocol\" =&gt; \"HTTPS\",\n          \"deviceCustomString3\" =&gt; [\n    [ 0] \"POST /api/v1/auth/login HTTP/1.1\",\n    [ 1] \"Host: xxxx\",\n    [ 2] \"User-Agent: Mozilla/5.0 (Android 7.0; Mobile; rv:62.0) Gecko/62.0 Firefox/62.0\",\n    [ 3] \"Accept: application/json, text/plain, */*\",\n    [ 4] \"Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.5,en;q=0.3\",\n    [ 5] \"Accept-Encoding: gzip, deflate, br\",\n    [ 6] \"Content-Type: text/plain\",\n    [ 7] \"Referer: xxxxx\",\n    [ 8] \"Content-Length: 61\",\n    [ 9] \"Cookie: xxxxxxxxx,\n    [10] \"DNT: 1\",\n    [11] \"Connection: keep-alive\",\n    [12] \"X-Forwarded-For: x.x.x.x\",\n    [13] \"\",\n    [14] \"{\\\"login\\\":\\\"xxxx \\\",\\\"password\\\":\\\"xxxx\\\"}\"\n],\n</code></pre>\n\n<p>For the field <code>deviceCustomString3</code> there are many fields (0 to 14), but the length can change. I would like to add a filter to delete just the last field (the login and password one).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1541605081, "post_id": 53192611, "comment_id": 93274433, "body": "You can write your method as <code>[*members, owner]</code> by using splat operator (<code>*</code>). It would be best to have a relation that will return all members with one query though."}, {"owner": {"reputation": 178, "user_id": 4939752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-1Jy6OjqDLWQ/AAAAAAAAAAI/AAAAAAAABRo/f20bd9F7XZQ/photo.jpg?sz=128", "display_name": "Paul Harker", "link": "https://stackoverflow.com/users/4939752/paul-harker"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1541605477, "post_id": 53192611, "comment_id": 93274656, "body": "hey, that worked! I think that might be the smallest change ever required on Stack Overflow"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1541605764, "post_id": 53192611, "comment_id": 93274832, "body": "It still does 2 selects, which I&#39;d aim to optimize. If you add your relations between <code>organisation_users</code> and <code>members</code> to the question, you should be able to get an acceptable answer."}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1541628276, "post_id": 53192611, "comment_id": 93285713, "body": "concat (&lt;&lt;) permanently alters an object try using + instead"}], "answers": [{"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 1, "last_activity_date": 1541618844, "last_edit_date": 1541618844, "creation_date": 1541618227, "answer_id": 53196302, "question_id": 53192611, "link": "https://stackoverflow.com/questions/53192611/merging-two-relations-in-rails/53196302#53196302", "title": "merging two relations in Rails", "body": "<p>If the order is not necessarily important then we can get this into a single query like so: </p>\n\n<p>If Rails 5 </p>\n\n<pre><code>def all_members\n  # not sure if you could just do \n  # owner.or(members) since they are both User \n  # but it seems unlikely due to the join table \n  User.where(id: self.owner_id).or(\n    User.where(id: organisation_users.select(:user_id))\n  )\nend \n</code></pre>\n\n<p>All versions of Rails (less than and including Rails 5) we can use <code>Arel</code> to build the more complex query</p>\n\n<pre><code>def all_members\n  user_table = User.arel_table   \n  User.where(\n    users_table[:id].eq(self.owner_id).or(\n       users_table[:id].in(\n         organisation_users.select(:user_id).arel\n       )\n    )\n  ) \nend \n</code></pre>\n\n<p>these will both result in the following SQL </p>\n\n<pre><code>SELECT users.* \nFROM users \nWHERE \n  (users.id = [YOUR_OWNER_ID] OR \n   users.id IN (\n     SELECT organisations_users.user_id \n     FROM organisations_users\n     WHERE organisations_users.organisation_id = [YOUR_ORGANISATION_ID]\n  ))\n</code></pre>\n\n<p>the end result will be an <code>ActiveRecord::Relation</code> of <code>User</code> objects.</p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1541626095, "post_id": 53197250, "comment_id": 93284788, "body": "The second case should be <code>User.where</code> not just <code>where</code> and while I haven&#39;t tested this theory I might assume that this should be <code>[owner.id] + members.ids</code> which would now result in 3 queries (fetch owner, fetch member ids, fetch Users where.)"}, {"owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1541715793, "post_id": 53197250, "comment_id": 93321771, "body": "Correct, it will result in 3 queries. Reason why I mentioned it&#39;s not extremely efficient."}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 1, "last_activity_date": 1541715775, "last_edit_date": 1541715775, "creation_date": 1541622181, "answer_id": 53197250, "question_id": 53192611, "link": "https://stackoverflow.com/questions/53192611/merging-two-relations-in-rails/53197250#53197250", "title": "merging two relations in Rails", "body": "<p>If getting an Array back is sufficient, then you can simply use:</p>\n\n<pre><code>def all_members\n  [owner] + members\nend\n</code></pre>\n\n<p>If you need a relation, then the simplest (but not most efficient) approach would be:</p>\n\n<pre><code>def all_members\n  User.where(id: [owner] + members.ids)\nend\n</code></pre>\n\n<p>It's not the most efficient as the SQL that gets generated may include a fairly large <code>IN</code> statement that cannot be efficiently cached by the database parser. Still, if the numbers are in the range of a few dozens, it would be enough even that relation trick.</p>\n"}], "owner": {"reputation": 178, "user_id": 4939752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-1Jy6OjqDLWQ/AAAAAAAAAAI/AAAAAAAABRo/f20bd9F7XZQ/photo.jpg?sz=128", "display_name": "Paul Harker", "link": "https://stackoverflow.com/users/4939752/paul-harker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53196302, "answer_count": 2, "score": 0, "last_activity_date": 1541715775, "creation_date": 1541604634, "question_id": 53192611, "link": "https://stackoverflow.com/questions/53192611/merging-two-relations-in-rails", "title": "merging two relations in Rails", "body": "<p>This should be easy I think...</p>\n\n<p>A Organisation has an Owner and Members - both are Users.</p>\n\n<p>This is setup by the organisation using class_name: \"User\", like so:</p>\n\n<pre><code>class Organisation &lt; ApplicationRecord\n   belongs_to :owner, class_name: \"User\", foreign_key: \"owner_id\"\n   has_many :organisations_users\n   has_many :members, class_name: \"User\", through: :organisations_users, source: :user\nend\n</code></pre>\n\n<p>This works but I need an all_members function (or scope) so I can get back both owner and members in one array (or ActiveRecord object). I thought this would be trivial but it's actually not.</p>\n\n<p>I've tried:</p>\n\n<pre><code>def all_members\n   members &lt;&lt; owner\nend\n</code></pre>\n\n<p>this of course is not what I want at all... this adds the owner to the staff every time I call it.</p>\n\n<pre><code>def all_members\n   [owner, members]\nend\n</code></pre>\n\n<p>this sort of works but returns a nested array which is hard to access properly.</p>\n\n<pre><code>  scope :all_members, joins(:members).merge(:owner)\n</code></pre>\n\n<p>this doesn't work at all. Probably nonsense.</p>\n\n<pre><code>  def all_members\n     members_array = members.dup\n     members_array &lt;&lt; owner\n  end\n</code></pre>\n\n<p>This still permanently alters the members to include the owner?!!</p>\n\n<p>Help! (Thanks)</p>\n"}, {"tags": ["ruby", "openssl", "ecdh"], "comments": [{"owner": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "edited": false, "score": 0, "creation_date": 1541604835, "post_id": 53192227, "comment_id": 93274254, "body": "In my experience, these routines will want to see the <i>entire</i> public-key file including all of its header and trailer lines.  Furthermore, I specifically suggest that the key information <i>should</i> be stored as a standard <code>.crt</code> file, and that you should either read the file verbatim or, better, tell the library where the file is located.  I recommend against embedding the key into the source-code of the program where it would be unduly difficult to change.  (Good security practice calls for public keys to have expiry dates and to be replaced periodically.  Make this trivial to do.)"}, {"owner": {"reputation": 7429, "user_id": 197302, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/cb3f8a2021f4528c6e96896f6b217e82?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/197302/toby"}, "reply_to_user": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "edited": false, "score": 0, "creation_date": 1541605172, "post_id": 53192227, "comment_id": 93274481, "body": "Thanks @MikeRobinson - unfortunately that part of the file is the only thing I have access to, it is required to generate a shared secret (the other keys for which are handled correctly)"}], "answers": [{"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 1, "last_activity_date": 1541641367, "last_edit_date": 1541641367, "creation_date": 1541612326, "answer_id": 53194851, "question_id": 53192227, "link": "https://stackoverflow.com/questions/53192227/setting-up-ruby-openssl-with-a-known-public-key/53194851#53194851", "title": "Setting up Ruby OpenSSL with a known public key", "body": "<p>There\u2019s a couple of things wrong here. First, this is an elliptic curve  key, so trying to create an RSA key isn\u2019t going to work. You need to create an <a href=\"https://ruby-doc.org/stdlib-2.5.3/libdoc/openssl/rdoc/OpenSSL/PKey/EC.html#method-c-new\" rel=\"nofollow noreferrer\">EC key</a>.</p>\n\n<p>The EC key initializer accepts a number of ways to pass in the key. Unfortunately none of them match exactly what you have here. You can pass in the PEM form or the DER form though. The PEM form is just what you have with the <code>BEGIN PUBLIC KEY</code> and <code>END PUBLIC KEY</code> lines added, so this will work (similiar to what you\u2019ve tried, only using the correct key type):</p>\n\n<pre><code>key = OpenSSL::PKey::EC.new \"-----BEGIN PUBLIC KEY-----\\n#{public_key}\\n-----END PUBLIC KEY-----\\n\"\n</code></pre>\n\n<p>The DER form is what you have but base 64 decoded, so this will also work and might be more convenient:</p>\n\n<pre><code>key = OpenSSL::PKey::EC.new(Base64.decode64(public_key))\n</code></pre>\n\n<p>When you\u2019ve done that you can call <code>key.group.curve_name</code> and you will see the second problem. This is a prime256v1 key, <em>not</em> a secp128r2 key. It doesn\u2019t represent a point on the secp128r2 curve and so is causing the <code>incompatible objects</code> error you are getting. Make sure you\u2019re using matching key types.</p>\n"}], "owner": {"reputation": 7429, "user_id": 197302, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/cb3f8a2021f4528c6e96896f6b217e82?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/197302/toby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 53194851, "answer_count": 1, "score": 0, "last_activity_date": 1541641367, "creation_date": 1541603369, "last_edit_date": 1541604381, "question_id": 53192227, "link": "https://stackoverflow.com/questions/53192227/setting-up-ruby-openssl-with-a-known-public-key", "title": "Setting up Ruby OpenSSL with a known public key", "body": "<p>I have the content of a public key which I'm getting passed as an input to my system:</p>\n\n<pre><code>public_key = 'MDkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDIgAC/Bu9nyAtG1DQe7t7jszLb+dZ1GbXoR8G0rIXoak67NM='\n</code></pre>\n\n<p>I need to feed this into <code>OpenSSL</code> so it can take part in some ECDH decryption.</p>\n\n<p>I can't seem to find a way to make OpenSSL accept the above input.</p>\n\n<p>I've tried the following:</p>\n\n<ul>\n<li><code>OpenSSL::PKey::RSA.new public_key</code></li>\n<li><code>OpenSSL::PKey::RSA.new \"-----BEGIN PUBLIC KEY-----\\n#{public_key}\\n-----END PUBLIC KEY-----\\n\"</code></li>\n</ul>\n\n<p>Both of these return:</p>\n\n<pre><code>OpenSSL::PKey::RSAError: Neither PUB key nor PRIV key: nested asn1 error\n</code></pre>\n\n<p>I can do:</p>\n\n<ul>\n<li><code>OpenSSL::PKey.read \"-----BEGIN PUBLIC KEY-----\\n#{public_key}\\n-----END PUBLIC KEY-----\\n\"</code></li>\n</ul>\n\n<p>This doesn't return an error, however I can't then see a way to set the group as secp128r2 without throwing an error.</p>\n\n<p>Doing <code>c = OpenSSL::PKey::EC.new(\"secp128r2\")</code> and trying to set the key after with <code>c.public_key = OpenSSL::PKey.read(\"-----BEGIN PUBLIC KEY-----\\n#{public_key}\\n-----END PUBLIC KEY-----\\n\").public_key</code> throws the error:</p>\n\n<pre><code>OpenSSL::PKey::ECError: EC_KEY_set_public_key: incompatible objects\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9442270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXhJClc106I/AAAAAAAAAAI/AAAAAAAAAAc/pzkjKoEn6Zw/photo.jpg?sz=128", "display_name": "thesimpledev", "link": "https://stackoverflow.com/users/9442270/thesimpledev"}, "edited": false, "score": 0, "creation_date": 1541605538, "post_id": 53191999, "comment_id": 93274689, "body": "Is there any way to get around this? I understand that&#39;s what class instance variables do, but I want each spec to run in isolation, as if no other code was ran before."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 39, "user_id": 9442270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXhJClc106I/AAAAAAAAAAI/AAAAAAAAAAc/pzkjKoEn6Zw/photo.jpg?sz=128", "display_name": "thesimpledev", "link": "https://stackoverflow.com/users/9442270/thesimpledev"}, "edited": false, "score": 1, "creation_date": 1541606153, "post_id": 53191999, "comment_id": 93275068, "body": "@thesimpledev Well, no isolation for you, but you can reset that class-level cache in a <code>before :each</code> block"}, {"owner": {"reputation": 39, "user_id": 9442270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXhJClc106I/AAAAAAAAAAI/AAAAAAAAAAc/pzkjKoEn6Zw/photo.jpg?sz=128", "display_name": "thesimpledev", "link": "https://stackoverflow.com/users/9442270/thesimpledev"}, "edited": false, "score": 0, "creation_date": 1541612426, "post_id": 53191999, "comment_id": 93278468, "body": "How exactly do you do that?"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 4, "last_activity_date": 1541602625, "creation_date": 1541602625, "answer_id": 53191999, "question_id": 53191947, "link": "https://stackoverflow.com/questions/53191947/why-are-class-instance-variables-persisting-across-specs/53191999#53191999", "title": "Why are class instance variables persisting across specs?", "body": "<p>That's what class instance variables <strong>do</strong>. They are state of the class itself, which normally persists through the lifetime of the app (or test suite run, in your case).</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1541606418, "post_id": 53192971, "comment_id": 93275202, "body": "It&#39;s a solution, alright. But is it a good one? This is debatable. If it works for you, I&#39;m all for it. But I&#39;d hesitate to use this in my code. Looks like sweeping the problem under the rug. &#175;\\_(\u30c4)_/&#175;"}, {"owner": {"reputation": 39, "user_id": 9442270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXhJClc106I/AAAAAAAAAAI/AAAAAAAAAAc/pzkjKoEn6Zw/photo.jpg?sz=128", "display_name": "thesimpledev", "link": "https://stackoverflow.com/users/9442270/thesimpledev"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1541611796, "post_id": 53192971, "comment_id": 93278160, "body": "So what would you consider a better solution? I would love to hear it!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1541611911, "post_id": 53192971, "comment_id": 93278213, "body": "Without knowing anything about the problem you&#39;re trying to solve, I&#39;d go with clearing/resetting state in a before block (as mentioned in the other comment)"}], "tags": [], "owner": {"reputation": 39, "user_id": 9442270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXhJClc106I/AAAAAAAAAAI/AAAAAAAAAAc/pzkjKoEn6Zw/photo.jpg?sz=128", "display_name": "thesimpledev", "link": "https://stackoverflow.com/users/9442270/thesimpledev"}, "is_accepted": true, "score": 0, "last_activity_date": 1541612464, "last_edit_date": 1541612464, "creation_date": 1541605824, "answer_id": 53192971, "question_id": 53191947, "link": "https://stackoverflow.com/questions/53191947/why-are-class-instance-variables-persisting-across-specs/53192971#53192971", "title": "Why are class instance variables persisting across specs?", "body": "<p>I found a solution!</p>\n\n<pre><code>before do\n  @Mock = Class.new.include(IDable)\nend\n</code></pre>\n\n<p>Then each time @Mock is used, it will have fresh class instance variables!</p>\n"}], "owner": {"reputation": 39, "user_id": 9442270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXhJClc106I/AAAAAAAAAAI/AAAAAAAAAAc/pzkjKoEn6Zw/photo.jpg?sz=128", "display_name": "thesimpledev", "link": "https://stackoverflow.com/users/9442270/thesimpledev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 53192971, "answer_count": 2, "score": 0, "last_activity_date": 1541612464, "creation_date": 1541602475, "question_id": 53191947, "link": "https://stackoverflow.com/questions/53191947/why-are-class-instance-variables-persisting-across-specs", "title": "Why are class instance variables persisting across specs?", "body": "<p>I'm using <em>class instance variables</em> to keep track of @instances. When I run each spec individually, they pass. But when I run all of the together, there is unexpected behavior.</p>\n\n<pre><code>it \"returns 1\" do\n  mock = Mock.new\n  expect(Mock.count).to eq(1)\nend\n\nit \"returns 2\" do\n  mock = Mock.new\n  mock = Mock.new\n  expect(Mock.count).to eq(2)\nend\n</code></pre>\n\n<p>When I run either individually, all specs are green. But when I run both, the second spec returns a count of 3. So I see that Mock is somehow persisting across specs. I'm using plain ruby, no DB or rails or anything.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "devise"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1541609673, "post_id": 53191307, "comment_id": 93277044, "body": "There&#39;s only one line of code before it where it could have been defined. It is easy to verify that it isn&#39;t defined there, so it cannot possibly be a variable, it must be a method call."}, {"owner": {"reputation": 630, "user_id": 3177947, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3118afa1a930820d977b6fa36b23fb66?s=128&d=identicon&r=PG&f=1", "display_name": "ZombieTfk", "link": "https://stackoverflow.com/users/3177947/zombietfk"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1541610005, "post_id": 53191307, "comment_id": 93277233, "body": "@J&#246;rgWMittag if you look at the source code linked, the class this method belongs to extends the class Warden::Strategies::Base, in which it declares and defines the value inside the initialize method - I simply didn&#39;t search the Warden repo source thoroughly enough to see this definition"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1541600586, "creation_date": 1541600586, "answer_id": 53191356, "question_id": 53191307, "link": "https://stackoverflow.com/questions/53191307/where-is-the-scope-variable-declared-in-this-source-code/53191356#53191356", "title": "Where is the scope variable declared in this source code?", "body": "<p>It's <code>warden</code> stuff. Check this out</p>\n\n<p><a href=\"https://github.com/wardencommunity/warden/blob/master/lib/warden/strategies/base.rb\" rel=\"nofollow noreferrer\">https://github.com/wardencommunity/warden/blob/master/lib/warden/strategies/base.rb</a></p>\n\n<p>this line</p>\n\n<pre><code>class Base &lt; ::Warden::Strategies::Base\n</code></pre>\n\n<p>should have given you an hint :)</p>\n"}], "owner": {"reputation": 630, "user_id": 3177947, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3118afa1a930820d977b6fa36b23fb66?s=128&d=identicon&r=PG&f=1", "display_name": "ZombieTfk", "link": "https://stackoverflow.com/users/3177947/zombietfk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 53191356, "answer_count": 1, "score": 0, "last_activity_date": 1541600586, "creation_date": 1541600413, "question_id": 53191307, "link": "https://stackoverflow.com/questions/53191307/where-is-the-scope-variable-declared-in-this-source-code", "title": "Where is the scope variable declared in this source code?", "body": "<p>I've been looking through the source code for devise, for the life of me can't figure out how the below code block works <a href=\"https://github.com/plataformatec/devise/blob/master/lib/devise/strategies/base.rb\" rel=\"nofollow noreferrer\">(full source here)</a></p>\n\n<pre><code>def mapping\n    @mapping ||= begin\n        mapping = Devise.mappings[scope]\n        raise \"Could not find mapping for #{scope}\" unless mapping\n        mapping\n    end\nend\n</code></pre>\n\n<p>I think understand most parts of this code, but cannot find where the scope variable is declared/defined. I have searched to repository (and the repository this inherits from), and looked at the tests available to try and get a better idea of what's going on here, but can not find any mention of a <code>scope</code> variable anywhere. I'm still learning ruby, so am I missing something obvious/a language construct that I'm unaware of at work here?</p>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1541599702, "post_id": 53191086, "comment_id": 93270944, "body": "That&#39;s not the problem. Arrays are different, yes, but they point to all the same squares."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1541599777, "post_id": 53191086, "comment_id": 93270984, "body": "@SergioTulentsev ...but the squares aren&#39;t being changed here. The array itself is being mutated."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1541599820, "post_id": 53191086, "comment_id": 93271005, "body": "&quot;The array itself is being mutated&quot; - It is, but it&#39;s the error. The intent was to mutate squares. Or that&#39;s how I read it."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1541599966, "post_id": 53191086, "comment_id": 93271079, "body": "&quot;but the squares aren&#39;t being changed here&quot; - but they are :) That&#39;s what the whole question is <i>about</i>."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1541599624, "creation_date": 1541599624, "answer_id": 53191086, "question_id": 53190805, "link": "https://stackoverflow.com/questions/53190805/objects-inside-of-transposed-array-dont-reflect-changes/53191086#53191086", "title": "Objects inside of transposed array don&#39;t reflect changes", "body": "<p>The problem is here:</p>\n\n<pre><code>@grid_columns = @grid_strings.transpose\n</code></pre>\n\n<p><code>@grid_columns</code> and <code>@grid_strings</code> are <strong>different objects</strong>. Changing one will not change the other.</p>\n\n<p>A possible alternative approach would be to define <code>grid_columns</code> as a <strong>method</strong>, which references the same object:</p>\n\n<pre><code>def grid_columns\n  @grid_strings.transpose\nend\n</code></pre>\n\n<p>There are other approaches you could also potentially use, but without knowing how you actually <em>use</em> the <code>grid_columns</code> it's hard to advise further.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9950201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b511b9576b2b501e3b040e005c2a66d?s=128&d=identicon&r=PG&f=1", "display_name": "Anikeev Gennadiy", "link": "https://stackoverflow.com/users/9950201/anikeev-gennadiy"}, "edited": false, "score": 0, "creation_date": 1541600705, "post_id": 53191097, "comment_id": 93271510, "body": "But <code>column</code> variable is just a copy of my original column, isn&#39;t it?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 3, "user_id": 9950201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b511b9576b2b501e3b040e005c2a66d?s=128&d=identicon&r=PG&f=1", "display_name": "Anikeev Gennadiy", "link": "https://stackoverflow.com/users/9950201/anikeev-gennadiy"}, "edited": false, "score": 0, "creation_date": 1541600840, "post_id": 53191097, "comment_id": 93271584, "body": "@AnikeevGennadiy No, it isn&#39;t. It&#39;s a different reference for the same array object. If it was, indeed, a full copy, it&#39;s not clear why you would expect the changes to be reflected in another array&#39;s elements."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1541599672, "creation_date": 1541599672, "answer_id": 53191097, "question_id": 53190805, "link": "https://stackoverflow.com/questions/53190805/objects-inside-of-transposed-array-dont-reflect-changes/53191097#53191097", "title": "Objects inside of transposed array don&#39;t reflect changes", "body": "<blockquote>\n  <p>I can't find the place where I made a mistake and hope you can help.</p>\n</blockquote>\n\n<p>Here it is</p>\n\n<pre><code>  square = column.pop\n</code></pre>\n\n<p>You're <strong>removing</strong> cells from a column. Look closely, you'll see the affected column become smaller. Also, the cell being removed is the one being modified, so that's why you never see the changes in the columns array.</p>\n"}], "owner": {"reputation": 3, "user_id": 9950201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b511b9576b2b501e3b040e005c2a66d?s=128&d=identicon&r=PG&f=1", "display_name": "Anikeev Gennadiy", "link": "https://stackoverflow.com/users/9950201/anikeev-gennadiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 53191097, "answer_count": 2, "score": 0, "last_activity_date": 1541599672, "creation_date": 1541598611, "question_id": 53190805, "link": "https://stackoverflow.com/questions/53190805/objects-inside-of-transposed-array-dont-reflect-changes", "title": "Objects inside of transposed array don&#39;t reflect changes", "body": "<p>I am making a <code>Grid</code> class for \"Connect Four\": I create strings array from <code>Square</code> objects, and then create columns array by calling <code>transpose</code> method on strings array:</p>\n\n<pre><code>class Grid\n  Square = Struct.new(:state)\n\n  def initialize\n    @grid_strings = Array.new(6) { Array.new(7) {Square.new} }\n    @grid_columns = @grid_strings.transpose\n  end\n</code></pre>\n\n<p>And I have a method that puts a symbol to the end of chosen column by changing the <code>state</code> attribute of proper <code>Square</code> instance:</p>\n\n<pre><code>  def put_to_column(column_index, symbol)\n    column = @grid_columns[column_index - 1]\n    loop do\n      square = column.pop\n      raise \"Full column\" if square.nil?\n      if square.state.nil?\n        square.state = symbol\n        break\n      end\n    end\n  end\n</code></pre>\n\n<p>The problem is: when I call <code>put_to_column</code> several times, it changes the <code>square</code> objects correctly, but only in the <code>@grid_strings</code> array. If I check the <code>@grid_columns</code> array, all <code>square</code> objects still have the <code>state</code> attribute assigned to nil.\nI can't find the place where I made a mistake and hope you can help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1541596872, "post_id": 53189507, "comment_id": 93269364, "body": "What do you mean by &quot;how can I make sure&quot;? What have you tried so far, if anything? (And if so, what behaviour do you get?) What behaviour do you want? As others pointed out, <i>Rails won&#39;t let you</i> set the status to something not on the list - so I&#39;m not entirely clear what your question is."}, {"owner": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 0, "creation_date": 1541596942, "post_id": 53189507, "comment_id": 93269401, "body": "It&#39;s worth noting that enforcing enums in the model doesn&#39;t, in fact, enforce them on a database level. And can lead to some precarious situations when migrating data in the future. Here be dragons."}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 1, "last_activity_date": 1541594014, "creation_date": 1541594014, "answer_id": 53189571, "question_id": 53189507, "link": "https://stackoverflow.com/questions/53189507/checking-if-a-string-belongs-to-enum-as-a-value/53189571#53189571", "title": "Checking if a string belongs to enum as a value", "body": "<p>That's exactly how it works by default. If you try to assign something else an exception is raised</p>\n\n<pre><code>ArgumentError: &lt;value&gt; is not a valid &lt;your_enum&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 330, "user_id": 5466412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UijsH.jpg?s=128&g=1", "display_name": "aqwan", "link": "https://stackoverflow.com/users/5466412/aqwan"}, "edited": false, "score": 1, "creation_date": 1573812987, "post_id": 53192127, "comment_id": 104017339, "body": "For me under Rails 5.2.3 keys seem to be strings not symbols so    <code>ModelName.statuses.keys.include?(some_status.to_s)</code>"}], "tags": [], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "is_accepted": false, "score": 3, "last_activity_date": 1541603053, "creation_date": 1541603053, "answer_id": 53192127, "question_id": 53189507, "link": "https://stackoverflow.com/questions/53189507/checking-if-a-string-belongs-to-enum-as-a-value/53192127#53192127", "title": "Checking if a string belongs to enum as a value", "body": "<p>You can create a method like Marek's to check that the key is valid before updating:</p>\n\n<pre><code>def self.validate_status(some_status)\n  ModelName.statuses.keys.include?(some_status.to_sym)\nend\n</code></pre>\n\n<p>or you can rescue <code>ArgumentError</code> from your <code>ApiController</code> (if you're doing an API) with something like:</p>\n\n<pre><code>rescue_from ArgumentError, with: :render_status_error\n\ndef render_status_error(exception)\n  logger.info(exception)\n  render json: { error: 'Invalid status' }, status: :bad_request\nend\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10600867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe88b47a243c64d0f126ceef8db6e887?s=128&d=identicon&r=PG&f=1", "display_name": "Joaadani", "link": "https://stackoverflow.com/users/10600867/joaadani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1242, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1601499861, "creation_date": 1541593773, "last_edit_date": 1601499861, "question_id": 53189507, "link": "https://stackoverflow.com/questions/53189507/checking-if-a-string-belongs-to-enum-as-a-value", "title": "Checking if a string belongs to enum as a value", "body": "<p>I have a Rails 5 model where there's </p>\n\n<pre><code>enum status: [:st1, :st2, :st3]\n</code></pre>\n\n<p>I want to set its status by using a <strong>string or symbol.</strong> How can I make sure that a string belongs to the list of values that <code>status</code> can have?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actionmailer", "rails-activejob"], "answers": [{"comments": [{"owner": {"reputation": 2131, "user_id": 1250436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/15b35dff00e725e20deb75c8612ea08d?s=128&d=identicon&r=PG", "display_name": "ohcibi", "link": "https://stackoverflow.com/users/1250436/ohcibi"}, "edited": false, "score": 0, "creation_date": 1541944863, "post_id": 53190326, "comment_id": 93383780, "body": "Whats the point in adding the identifier to the mail headers? Is it simply to map the  actual mail a person has received with the entry in the database?"}, {"owner": {"reputation": 2131, "user_id": 1250436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/15b35dff00e725e20deb75c8612ea08d?s=128&d=identicon&r=PG", "display_name": "ohcibi", "link": "https://stackoverflow.com/users/1250436/ohcibi"}, "edited": false, "score": 0, "creation_date": 1541957298, "post_id": 53190326, "comment_id": 93387341, "body": "This creates 2 entries in the database for each email as the callback is apparently called twice. A database log is nice and stuff but what I want is a boolean that tells me wether or not that mail (by &quot;that&quot; I mean the mail object I have stored in memory before) was successfully sent or not and thats it. It seems super hard to do this for no reason with actionmailer/actionjob unless I&#39;m missing something."}, {"owner": {"reputation": 1746, "user_id": 3543371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41VUZ.jpg?s=128&g=1", "display_name": "jbielick", "link": "https://stackoverflow.com/users/3543371/jbielick"}, "reply_to_user": {"reputation": 2131, "user_id": 1250436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/15b35dff00e725e20deb75c8612ea08d?s=128&d=identicon&r=PG", "display_name": "ohcibi", "link": "https://stackoverflow.com/users/1250436/ohcibi"}, "edited": false, "score": 0, "creation_date": 1542064888, "post_id": 53190326, "comment_id": 93426521, "body": "I mean <code>delivered_email</code> is the hook for an observer trying to tell if &quot;mail was successfully sent or not&quot;, but once you tell a background job to do that (<code>deliver_later</code>) you&#39;ve got to store that unit of &quot;work&quot; in a distributed fashion. Depending on your Email Service Provider, you can usually also receive webhooks from your ESP when mail was delivered. I don&#39;t think Amazon SES does this. Otherwise your background job that&#39;s sending the email has to be the one to write &quot;successfully sent&quot; to a distributed store somewhere."}, {"owner": {"reputation": 2131, "user_id": 1250436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/15b35dff00e725e20deb75c8612ea08d?s=128&d=identicon&r=PG", "display_name": "ohcibi", "link": "https://stackoverflow.com/users/1250436/ohcibi"}, "edited": false, "score": 0, "creation_date": 1542102784, "post_id": 53190326, "comment_id": 93438421, "body": "See the problem is ActionMailer creates 2 different Mail objects which leads to two delivery-ids stored in the databases where only one will get \u201esent\u201c as the other was never meant to be sent. As the header gets deleted when the new mail object is created the second time there\u2019s no way to tell which of the dB records refers to the same message of that second mail object. So your approach does not work at all regarding identifying sent mails. It\u2019s only good to tell wether or not emails where sent but not to check if a certain email that was called delivered_later on got send."}, {"owner": {"reputation": 2131, "user_id": 1250436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/15b35dff00e725e20deb75c8612ea08d?s=128&d=identicon&r=PG", "display_name": "ohcibi", "link": "https://stackoverflow.com/users/1250436/ohcibi"}, "edited": false, "score": 0, "creation_date": 1542118018, "post_id": 53190326, "comment_id": 93447232, "body": "besides that ,the solution is somewhat overengineered. i can see a &quot;Job ID&quot; . which is generated by activejob in the logs. I can see &quot;performing&quot; . as well as &quot;performed&quot; log-messages which matching &quot;Job ID&quot;s. it must be possible to craft some simple in-memory observer for this instead of relying on a database."}, {"owner": {"reputation": 1746, "user_id": 3543371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41VUZ.jpg?s=128&g=1", "display_name": "jbielick", "link": "https://stackoverflow.com/users/3543371/jbielick"}, "reply_to_user": {"reputation": 2131, "user_id": 1250436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/15b35dff00e725e20deb75c8612ea08d?s=128&d=identicon&r=PG", "display_name": "ohcibi", "link": "https://stackoverflow.com/users/1250436/ohcibi"}, "edited": false, "score": 0, "creation_date": 1542200091, "post_id": 53190326, "comment_id": 93481940, "body": "Good luck. Sounds like you know what to do."}, {"owner": {"reputation": 2131, "user_id": 1250436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/15b35dff00e725e20deb75c8612ea08d?s=128&d=identicon&r=PG", "display_name": "ohcibi", "link": "https://stackoverflow.com/users/1250436/ohcibi"}, "edited": false, "score": 0, "creation_date": 1542200526, "post_id": 53190326, "comment_id": 93482189, "body": "The id must be passed as a parameter to the call to the action mailer method e.g. <code>ActionMailer.with(delivery_id: SecureRandom.uuid)</code>. This way every subsequently created <code>Mail</code> object will get the same id passed as a param. With that the message can be delivered in <code>delivered_mail</code>. If messing around with the mail object otherwise several IDs will be generated without having a way to tell which one of those is refering to a duplicated object."}, {"owner": {"reputation": 1594, "user_id": 1812321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27aa7afb2a89ee319028048b41db126a?s=128&d=identicon&r=PG", "display_name": "Nickolay Kondratenko", "link": "https://stackoverflow.com/users/1812321/nickolay-kondratenko"}, "edited": false, "score": 0, "creation_date": 1604675104, "post_id": 53190326, "comment_id": 114427428, "body": "&gt; This creates 2 entries in the database for each email.  I have moved creating the AR record to the interceptor and this fixed the issue with 2 records"}], "tags": [], "owner": {"reputation": 1746, "user_id": 3543371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41VUZ.jpg?s=128&g=1", "display_name": "jbielick", "link": "https://stackoverflow.com/users/3543371/jbielick"}, "is_accepted": false, "score": 3, "last_activity_date": 1541596906, "creation_date": 1541596906, "answer_id": 53190326, "question_id": 53188962, "link": "https://stackoverflow.com/questions/53188962/how-to-monitor-status-of-actionmailer-deliver-later/53190326#53190326", "title": "How to monitor status of actionmailer deliver_later", "body": "<p>There is no datastore (aside from your background job system of choice) that stores information about the completeness or status of your async delivery. However, you can observe the delivery of mail with the Rails Observer pattern. If you'd like to track attempts and status of mail deliveries, I would add a table to your database for each delivery. </p>\n\n<h3>Tracking that a mailer method was called to create a delivery:</h3>\n\n<p>You could add an <code>before_action</code> to your mailer that writes a database record for the mail message that was called. Give your message a UUID here so you can find it later in the database. The UUID could be added to your message headers.</p>\n\n<h3>Tracking that a mailer delivered a message (later):</h3>\n\n<p>You can add an observer to your mailer (or all mailers) with <code>register_observer</code>. The Observer class must implement <code>self.delivered_email(message)</code> and that method will be called after an email has been delivered. At that point you could find your database record and write a timestamp on it to mark it as \"sent\".</p>\n\n<p>Here's an example of what that might look like:</p>\n\n<p><strong>This is untested code, it may not work exactly as written</strong></p>\n\n<pre><code># your mailer class\nclass NotifierMailer &lt; ApplicationMailer\n  after_action :record_delivery\n\n  private\n\n  def record_delivery\n    # create an identifier for this mail message and add it \n    # to the headers of the mail message\n    headers['X-Delivery-Id'] = SecureRandom.uuid\n    # write a database record to track that this email is to be sent\n    MailDelivery.create(uuid: headers['X-Delivery-Id'])\n  end\nend\n\n# an observer class\nclass MailDeliveryObserver\n  def self.delivered_email(message)\n    delivery = MailDelivery.find_by(uuid: message.headers['X-Delivery-Id'])\n    delivery&amp;.touch(:sent_at)\n  end\nend\n\n# in application.rb\n# NotifierMailer can be any mailer\nNotifierMailer.register_observer(MailDeliveryObserver)\n</code></pre>\n\n<p><a href=\"https://www.leighhalliday.com/mail-interceptors-and-observers\" rel=\"nofollow noreferrer\">Here's an article that explains a little more about observers</a></p>\n\n<p><a href=\"https://api.rubyonrails.org/v5.2.1/classes/ActionMailer/Base.html#class-ActionMailer::Base-label-Observing+and+Intercepting+Mails\" rel=\"nofollow noreferrer\">And some current Rails docs on observers</a></p>\n"}], "owner": {"reputation": 2131, "user_id": 1250436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/15b35dff00e725e20deb75c8612ea08d?s=128&d=identicon&r=PG", "display_name": "ohcibi", "link": "https://stackoverflow.com/users/1250436/ohcibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1034, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1541596906, "creation_date": 1541591683, "question_id": 53188962, "link": "https://stackoverflow.com/questions/53188962/how-to-monitor-status-of-actionmailer-deliver-later", "title": "How to monitor status of actionmailer deliver_later", "body": "<h1>TL;DR</h1>\n\n<p>How to keep track of queued mails which are enqueued by <code>deliver_later</code>, along with their delivery state?</p>\n\n<h1>Details</h1>\n\n<p>I want to send a bunch of emails async using <code>deliver_later</code> from action mailer. It works so far as in mails are sent async and <code>wait:</code> works as expected. So far so good.</p>\n\n<p>I now want to provide some status info about the status of the sent mails. I.e. a simple string like <code>x/y mails sent</code> which I can query via http or whatever later on (which is <strong>not</strong> a concern of this question!). My expectation was that I can easily access a job queue or something like that where I can then register a callback like in <code>after_action</code> but apparently there is no such thing and it looks like I need to handcraft that using said callbacks but I cannot find a single resource even mentioning the topic 'delivery state'. It appears as if nobody in the world is interested if and when <code>deliver_later</code>ed mails are actually sent oO? The closest thing I could found was how to check for this for the purpose of unit tests, but this is definitely not what I want.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1541592834, "post_id": 53188693, "comment_id": 93267401, "body": "This should &quot;never happen&quot;. Which means something weird went on here. Is that the <b>full</b> <code>Gemfile</code> that you&#39;re showing us? Was the <code>Gemfile.lock</code> valid previously, or was there a dependency incompatibility? The &quot;fix&quot; you&#39;ve shown shouldn&#39;t have changed anything!"}, {"owner": {"reputation": 572, "user_id": 5100555, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6de1f19624f27e2e059e2b511ef4bfe6?s=128&d=identicon&r=PG", "display_name": "tfantina", "link": "https://stackoverflow.com/users/5100555/tfantina"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1541677793, "post_id": 53188693, "comment_id": 93302314, "body": "That&#39;s the whole Gemfile...  And previously there was no dependency incompatibility that I know of."}], "owner": {"reputation": 572, "user_id": 5100555, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6de1f19624f27e2e059e2b511ef4bfe6?s=128&d=identicon&r=PG", "display_name": "tfantina", "link": "https://stackoverflow.com/users/5100555/tfantina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541590532, "creation_date": 1541590532, "question_id": 53188693, "link": "https://stackoverflow.com/questions/53188693/bundle-update-downgrades-several-gems-in-a-gem", "title": "Bundle Update downgrades several gems in a gem", "body": "<p>Disclaimer before reading: I have resolved this issue but I am asking because I still don't know the reasons behind it.</p>\n\n<p>I'm working on an old gem that pulls assets into the asset pipeline.  I'm not positive how the gem was originally created I imagine it was with <code>rails plugin new static_assets</code>.\nSince it is a gem the Gemfile is not overly complex (I haven't made any changes to it):</p>\n\n<pre><code>source \"http://rubygems.org\"\n\ngemspec\n\n# jquery-rails is used by the dummy application\ngem \"jquery-rails\"\n</code></pre>\n\n<p>But the Gemfile.lock has dozens of gems and dependencies showing up.  For the most part, the gems seem up to date.</p>\n\n<p>When I run a <code>bundle update</code> several of the gems go back to much older versions; like Rails 5 to Rails 3.</p>\n\n<p>I believe I solved this by updating the Gemfile to \n<code>gem 'jquery-rails', '~&gt; 4.3', '&gt;= 4.3.3'</code>\nbut I want to know why this was happening.  </p>\n\n<p>I'm not overly familiar with how Gemfile.lock gets created and updated but I was under the impression that it was based on the Gemfile, pulling all gems and their dependencies from the Gemfile.  If all the gems in Gemfile.lock are dependant on <code>jquery-rails</code> why was it automatically downgrading them so unilaterally and by so much?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1541589593, "post_id": 53188437, "comment_id": 93265929, "body": "No, not possible. You&#39;ll have to use the full block form"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1541590059, "post_id": 53188437, "comment_id": 93266134, "body": "Ok thanks @SergioTulentsev ! I&#39;m going to merge my <code>suspicious_content?</code> and <code>tiny_description?</code> methods, but I wanted to know if it&#39;s possible, in case I will have to do something like this in the future"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1541591883, "post_id": 53188437, "comment_id": 93266963, "body": "It doesn&#39;t make sense. Block is not an object. You cannot do logic with blocks."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1541591953, "post_id": 53188437, "comment_id": 93267001, "body": "Your title does not seem to match what you wrote in the text."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1541595174, "post_id": 53188437, "comment_id": 93268516, "body": "@sawa makes sense if they don&#39;t know that these are blocks."}], "answers": [{"comments": [{"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1541601685, "post_id": 53191261, "comment_id": 93272074, "body": "Thank you. It was a question by curiosity, I known that I could do it by this way but I was wondering if there was anything planned to do that with <code>&amp;:</code>. Also, please excuse my english if it&#39;s not perfect and if I used the wrong word, english is not my first langage"}, {"owner": {"reputation": 930, "user_id": 3577922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eURpm.jpg?s=128&g=1", "display_name": "Masa Sakano", "link": "https://stackoverflow.com/users/3577922/masa-sakano"}, "reply_to_user": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1541607346, "post_id": 53191261, "comment_id": 93275765, "body": "@escanxr I have edited an answer to add another way."}], "tags": [], "owner": {"reputation": 930, "user_id": 3577922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eURpm.jpg?s=128&g=1", "display_name": "Masa Sakano", "link": "https://stackoverflow.com/users/3577922/masa-sakano"}, "is_accepted": false, "score": 2, "last_activity_date": 1541607288, "last_edit_date": 1541607288, "creation_date": 1541600236, "answer_id": 53191261, "question_id": 53188437, "link": "https://stackoverflow.com/questions/53188437/is-it-possible-to-have-any-method-with-two-blocks/53191261#53191261", "title": "is it possible to have .any? method with two blocks?", "body": "<p>\"merge\" does not make sense as the comments for your question have pointed out.  But you can achieve practically the same thing as your latter case like this:</p>\n\n<pre><code>projects.any?{ |i| i.suspicious_content? || i.tiny_description? }\n</code></pre>\n\n<p>Or, if you want to use a block multiple times, you can do as follows:</p>\n\n<pre><code>b = lambda{ |i| i.suspicious_content? || i.tiny_description? }\nprojects.any? &amp;b\n</code></pre>\n"}], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541607288, "creation_date": 1541589528, "last_edit_date": 1541602239, "question_id": 53188437, "link": "https://stackoverflow.com/questions/53188437/is-it-possible-to-have-any-method-with-two-blocks", "title": "is it possible to have .any? method with two blocks?", "body": "<p>I have this code to determinate the class returned:</p>\n\n<pre><code>def level_class(projects)\n  return 'badge-danger' if projects.any?(&amp;:suspicious_content?) || projects.any?(&amp;:tiny_description?)\n  'badge-info'\nend\n</code></pre>\n\n<p>Is it possible to 'merge' <code>&amp;:suspicious_content?</code> and <code>&amp;:tiny_description?</code>?</p>\n\n<p>That doesn't work but something like <code>projects.any?(&amp;:suspicious_content? || &amp;:tiny_description?)</code> would pretty cool!</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 1, "last_activity_date": 1541585929, "last_edit_date": 1541585929, "creation_date": 1541585616, "answer_id": 53187375, "question_id": 53187340, "link": "https://stackoverflow.com/questions/53187340/what-are-forms-of-ruby-methods/53187375#53187375", "title": "What are forms of Ruby methods?", "body": "<p>These are three examples of usage put in the documentation:</p>\n\n<pre><code>a.fill(\"x\")              #=&gt; [\"x\", \"x\", \"x\", \"x\"]\na.fill(\"z\", 2, 2)        #=&gt; [\"x\", \"x\", \"z\", \"z\"]\na.fill(\"y\", 0..1)        #=&gt; [\"y\", \"y\", \"z\", \"z\"]\n</code></pre>\n\n<p>Where the behavior of this method differs from the following two examples, where block is given:</p>\n\n<pre><code>a.fill {|i| i*i}         #=&gt; [0, 1, 4, 9]\na.fill(-2) {|i| i*i*i}   #=&gt; [0, 1, 8, 27]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1541595920, "post_id": 53187450, "comment_id": 93268896, "body": "Ah, now that I think about it, I never found apidock useful. Not once. Mostly for their non-informative deprecation warnings, but now this too? I should find a way to exclude it from search results :)"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 3, "last_activity_date": 1541593301, "last_edit_date": 1541593301, "creation_date": 1541585887, "answer_id": 53187450, "question_id": 53187340, "link": "https://stackoverflow.com/questions/53187340/what-are-forms-of-ruby-methods/53187450#53187450", "title": "What are forms of Ruby methods?", "body": "<p>That is an unofficial and incomplete copy from <a href=\"https://ruby-doc.org/core-1.9.3/Array.html#method-i-fill\" rel=\"nofollow noreferrer\">the (nearly) official document</a>, which has the description in more complete form:</p>\n\n<pre><code>fill(obj) \u2192 ary\nfill(obj, start [, length]) \u2192 ary\nfill(obj, range ) \u2192 ary\nfill {|index| block } \u2192 ary\nfill(start [, length] ) {|index| block } \u2192 ary\nfill(range) {|index| block } \u2192 ary\n</code></pre>\n\n<blockquote>\n  <p>The first three forms set the selected elements of self (which may be the entire array) to obj. A start of nil is equivalent to zero. A length of nil is equivalent to self.length. The last three forms fill the array with the value of the block. The block is passed the absolute index of each element to be filled. Negative values of start count from the end of the array.</p>\n</blockquote>\n\n<p>So \"the first three forms\" refer to:</p>\n\n<pre><code>fill(obj) \u2192 ary\nfill(obj, start [, length]) \u2192 ary\nfill(obj, range ) \u2192 ary\n</code></pre>\n\n<p>By the way, v1_9_3_392 is so old. Why not use a newer version of Ruby?</p>\n"}], "owner": {"reputation": 2774, "user_id": 3668967, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/tcSwe.png?s=128&g=1", "display_name": "Karol Selak", "link": "https://stackoverflow.com/users/3668967/karol-selak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 53187450, "answer_count": 2, "score": 0, "last_activity_date": 1541593301, "creation_date": 1541585484, "last_edit_date": 1541585585, "question_id": 53187340, "link": "https://stackoverflow.com/questions/53187340/what-are-forms-of-ruby-methods", "title": "What are forms of Ruby methods?", "body": "<p>We can find <a href=\"https://apidock.com/ruby/v1_9_3_392/Array/fill\" rel=\"nofollow noreferrer\">a definition</a> of Ruby <code>Array#fill</code> method:</p>\n\n<blockquote>\n  <p>The first three forms set the selected elements of self (which may be\n  the entire array) to obj. A start of nil is equivalent to zero. A\n  length of nil is equivalent to self.length. The last three forms fill\n  the array with the value of the block. The block is passed the\n  absolute index of each element to be filled. Negative values of start\n  count from the end of the array.</p>\n</blockquote>\n\n<p>What does it mean that the first three forms do something? What are these forms?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "algorithm", "combinations", "probability"], "answers": [{"tags": [], "owner": {"reputation": 1543, "user_id": 5801853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1b0fbad41fb9e1ee84161ebff1ddbbc?s=128&d=identicon&r=PG", "display_name": "yzalavin", "link": "https://stackoverflow.com/users/5801853/yzalavin"}, "is_accepted": false, "score": 1, "last_activity_date": 1541585539, "creation_date": 1541585539, "answer_id": 53187353, "question_id": 53186930, "link": "https://stackoverflow.com/questions/53186930/what-are-the-chances-of-getting-a-duplicate-when-using-securerandom-hex/53187353#53187353", "title": "What are the chances of getting a duplicate when using SecureRandom.hex?", "body": "<p>Since it is a base 16 numeral system there are <code>16 ** SecureRandom.hex.length</code> possible variations which is quite a lot.</p>\n\n<p>Better use loop with an exit condition if you do not want to overflow your stack when the quantity of users will increase.</p>\n\n\n\n<pre><code>MAX_ATTEMPTS = 3 # For you to choose.\n\ndef key\n  MAX_ATTEMPTS.times do\n    hex = SecureRandom.hex\n    return hex unless Model.where(key: hex).exists?\n  end\n\n  fail 'No attempts to generate a key left.'\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1541598473, "post_id": 53187837, "comment_id": 93270245, "body": "See the birthday paradox. The square root of the number of possible values is a better estimate of the expected number of samples before a duplicate. It&#39;s still unlikely but not as unlikely as you suggest."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 4, "last_activity_date": 1541587688, "last_edit_date": 1541587688, "creation_date": 1541587277, "answer_id": 53187837, "question_id": 53186930, "link": "https://stackoverflow.com/questions/53186930/what-are-the-chances-of-getting-a-duplicate-when-using-securerandom-hex/53187837#53187837", "title": "What are the chances of getting a duplicate when using SecureRandom.hex?", "body": "<p>In your example (when using <code>SecureRandom.hex</code> with the default length of 32) there are </p>\n\n<pre><code>16**32 = 340282366920938463463374607431768211456\n</code></pre>\n\n<p>different hex values possible. That means there is a chance of <code>1:340282366920938463463374607431768211456</code> to create a duplicate. This chance is extremely low and IMHO it doesn't make much sense to worry too much about it.</p>\n\n<p>When you are going to store that key in the database then I would suggest adding a unique index to that database column to ensure - on the database level - that it is impossible to store any duplicates.</p>\n\n<p>Furthermore, you asked if your example code is enough to avoid duplicates. The answer is <em>No</em>. It is highly theoretical because of the low probability, but you might run into race conditions in which two jobs generating the same keys at the same time, checking both that there isn't such a key in the database and that both jobs store the same value into the table.</p>\n\n<p>tl;dr Chance of duplicates are extremely low. Only a unique index on the <code>key</code> column in the database ensures that there will never be any duplicates (because of race conditions or keys generated bypassing this method).</p>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1541587279, "creation_date": 1541587279, "answer_id": 53187838, "question_id": 53186930, "link": "https://stackoverflow.com/questions/53186930/what-are-the-chances-of-getting-a-duplicate-when-using-securerandom-hex/53187838#53187838", "title": "What are the chances of getting a duplicate when using SecureRandom.hex?", "body": "<p>The length of the keys seem to be 32 in your setting.</p>\n\n<ul>\n<li><p>The chances of not getting duplicates in three executions is:</p>\n\n<pre><code>((16**32 - 1)/16**32) * ((16**32 - 2)/16**32)\n</code></pre>\n\n<p>So the chances of getting (at least a pair of) duplicates somewhere in three executions is:</p>\n\n<pre><code>1 - ((16**32 - 1)/16**32) * ((16**32 - 2)/16**32)\n= 8.8162076e-39\n</code></pre></li>\n<li><p>There are:</p>\n\n<pre><code>16**32 = 3.4028237e+38\n</code></pre>\n\n<p>different strings.</p></li>\n<li><p>Your method can avoid duplicates when it works as intended, but it also has an unimaginablly slim chance of falling into perpetuality and never terminating.</p></li>\n</ul>\n"}], "owner": {"reputation": 1221, "user_id": 9375533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a08c00e9e6694fe8222c6918801dcc0?s=128&d=identicon&r=PG&f=1", "display_name": "dcangulo", "link": "https://stackoverflow.com/users/9375533/dcangulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1025, "favorite_count": 1, "accepted_answer_id": 53187837, "answer_count": 3, "score": 0, "last_activity_date": 1541587688, "creation_date": 1541583964, "question_id": 53186930, "link": "https://stackoverflow.com/questions/53186930/what-are-the-chances-of-getting-a-duplicate-when-using-securerandom-hex", "title": "What are the chances of getting a duplicate when using SecureRandom.hex?", "body": "<p>I am planning to use <code>SecureRandom.hex</code> to generate API keys for my users. </p>\n\n<p>So far here is the output in 3 executions:</p>\n\n<pre><code>Loading development environment (Rails 5.2.1)\n2.3.5 :001 &gt; SecureRandom.hex\n =&gt; \"0369e9b7c6ffa07bd8d0a263f7b4cfa6\" \n2.3.5 :002 &gt; SecureRandom.hex\n =&gt; \"1a8a168d7f70676451e3d59353e22693\" \n2.3.5 :003 &gt; SecureRandom.hex\n =&gt; \"94cc188e9e5c3abfe587510fa79993ce\"\n</code></pre>\n\n<p>What are the chances of me getting a duplicate result?</p>\n\n<p>And will this method that I created will really avoid producing duplicate content?</p>\n\n<pre><code>def generate_string\n  string = SecureRandom.hex\n\n  generate_string if Model.where(:key =&gt; string).count &gt; 0\n\n  string\nend\n\nunique_string = generate_string\n</code></pre>\n\n<p>I am using recursion that if the string is already stored in the database, it will just produce another.</p>\n\n<p>And also, since I am not getting a duplicate, how many strings can I produce with <code>SecureRandom.hex</code> before it rans out of combinations to produce?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10617460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ldAIvVBNpTU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDxFhZZZ0h-VEdY_vRJLhZvy_6BHA/mo/photo.jpg?sz=128", "display_name": "AlmostToast", "link": "https://stackoverflow.com/users/10617460/almosttoast"}, "edited": false, "score": 0, "creation_date": 1541598702, "post_id": 53188516, "comment_id": 93270384, "body": "Thanks for pointing me towards an answer... although i needed something extra in my controller        <code>if (params[:email][:profile_ids] rescue false)         params[:email][:profile_ids].delete_if(&amp;:blank?)       end</code>  and now I can get the first selection, or second etc  <code>@email.profiles.first.profiled.email</code> # returns &quot;person@place.com&quot; <code>@email.profiles.second.profiled.email</code> # returns &quot;person2@place.com&quot;"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 0, "last_activity_date": 1541589768, "creation_date": 1541589768, "answer_id": 53188516, "question_id": 53186673, "link": "https://stackoverflow.com/questions/53186673/how-to-get-f-select-options-for-select-data-when-form-is-submitted/53188516#53188516", "title": "How to get f.select/options_for_select data when form is submitted", "body": "<p>The selected values will be available as <code>params[:email][:profiles]</code> in your respected <code>controller#action</code>. Use it to construct a query which will fetch the users data with the respected ids, save those into an instance variable and use that instance variable to display the data.</p>\n"}], "owner": {"reputation": 3, "user_id": 10617460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ldAIvVBNpTU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDxFhZZZ0h-VEdY_vRJLhZvy_6BHA/mo/photo.jpg?sz=128", "display_name": "AlmostToast", "link": "https://stackoverflow.com/users/10617460/almosttoast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 53188516, "answer_count": 1, "score": 0, "last_activity_date": 1541589768, "creation_date": 1541583050, "question_id": 53186673, "link": "https://stackoverflow.com/questions/53186673/how-to-get-f-select-options-for-select-data-when-form-is-submitted", "title": "How to get f.select/options_for_select data when form is submitted", "body": "<p>I have a form where user's can select multiple contacts from a dropdown list.</p>\n\n<p><strong>/emails/_form.html.slim</strong></p>\n\n<pre><code>= f.select :profiles, options_for_select(@project.contacts.map { |c| [\"#{c.profile.name} (#{c.email})\", c.profile.id] }), {}, multiple: :multiple, class: 'selectable form-control'\n</code></pre>\n\n<p>How do I pull the selected user(s) data into the controller, in order to display it in the /emails/show view?</p>\n\n<p>Email to:\na@ex.com, b@ex.com, c@ex.com</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "edited": false, "score": 0, "creation_date": 1541587428, "post_id": 53186645, "comment_id": 93264961, "body": "<code>.where(&quot;created_at &lt;&gt; updated_at&quot;)</code>?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "edited": false, "score": 0, "creation_date": 1541629411, "post_id": 53186645, "comment_id": 93286123, "body": "thanks.. to clarify, in the controller try this?"}, {"owner": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "edited": false, "score": 0, "creation_date": 1541629646, "post_id": 53186645, "comment_id": 93286217, "body": "Yes - I didn&#39;t have the time to make a complete example earlier though."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "edited": false, "score": 0, "creation_date": 1541629769, "post_id": 53186645, "comment_id": 93286255, "body": "Yeah can you show me an example, I&#39;m a bit mixed on exactly what to do? like this? @ orders_a = Order.all.where(seller: current_user).where(&quot;created_at &lt;&gt; updated_at&quot;) or @ orders_a = Order.all.where(seller: current_user &amp;&amp; created_at &lt;&gt; updated_at) ? something along those lines or .. something else?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "edited": false, "score": 0, "creation_date": 1541634029, "post_id": 53186645, "comment_id": 93287631, "body": "okay it works but i realized its not how i expected, well, how i want it.  is there a way to do it primarily through the views loop? Because i want the table to display total orders and response time of orders with created &lt;&gt; updated but if i do it through the controller then the total orders only display orders of ones with differences in created and updated times.."}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541582907, "creation_date": 1541582907, "question_id": 53186645, "link": "https://stackoverflow.com/questions/53186645/how-to-show-loop-data-from-orders-only-having-created-at-updated-at", "title": "How to show loop data from orders only having created_at != updated_at?", "body": "<p>I want to show the response time, which I have set up but it currently shows the response time with all orders into account, so it's not accurate.</p>\n\n<p>For example, there are 3 orders by buyers and a seller takes 2 days to respond to 1 of those orders, i want it to say 2 days.  Instead of taking all 3 orders into account and saying .66 days.</p>\n\n<p>Here's the controller for the page its displayed on:</p>\n\n<pre><code>    @orders = Order.all.where(seller: current_user).paginate(:page =&gt; params[:page], :per_page =&gt; 15) || @orders = Order.all.where(seller: current_buyer).paginate(:page =&gt; params[:page], :per_page =&gt; 15)\n\n    @orders_a = Order.all.where(seller: current_user) || @orders = Order.all.where(seller: current_buyer)\n    @orders_month = @orders_a.all.group_by { |mon|  mon.created_at.beginning_of_month }\n    @orders_day = @orders_a.all.group_by { |day|  day.created_at.beginning_of_day }\n\n\n    @order = Order.new\n</code></pre>\n\n<p>The @orders_month and @orders_day are the ones displaying the information.  (It is both charted and graphed in a table)</p>\n\n<p>Here's the view:</p>\n\n<pre><code>  &lt;% @orders_month.each do |month, orders| %&gt;\n       &lt;tbody&gt;\n          &lt;tr&gt;\n             &lt;td&gt;&lt;%= month.strftime(\"%B\") %&gt;&lt;/td&gt;\n             &lt;td class=\"center\"&gt;&lt;%= orders.count %&gt;&lt;/td&gt;\n             &lt;td class=\"center\"&gt;&lt;%= (orders.sum { |order| order.updated_at.day - order.created_at.day } / orders.count ) %&gt; Days&lt;/td&gt;\n             &lt;/td&gt;\n   &lt;% end %&gt;\n</code></pre>\n\n<p>I have tried adding attempts like and similar to the following with no avail:\nif order.updated_at != order.created_at</p>\n"}, {"tags": ["mysql", "sql", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 561, "user_id": 1495691, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/koVLw.jpg?s=128&g=1", "display_name": "minus1", "link": "https://stackoverflow.com/users/1495691/minus1"}, "edited": false, "score": 0, "creation_date": 1541589420, "post_id": 53186181, "comment_id": 93265855, "body": "Updated my question with mysql tag. Didn&#39;t thought about loop solution, though it&#39;s less efficient but much simpler and think it&#39;s reliable enough. I will implement it and see where it goes. Thank you for the answer!"}], "tags": [], "owner": {"reputation": 46070, "user_id": 1410664, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/vGygm.gif?s=128&g=1", "display_name": "Caius Jard", "link": "https://stackoverflow.com/users/1410664/caius-jard"}, "is_accepted": true, "score": 1, "last_activity_date": 1541581742, "last_edit_date": 1541581742, "creation_date": 1541581052, "answer_id": 53186181, "question_id": 53185969, "link": "https://stackoverflow.com/questions/53185969/prevent-queries-overwriting-each-other/53186181#53186181", "title": "Prevent queries overwriting each other", "body": "<p>You don't say what database is in use but most major DBs these days have a way to perform an update and return data from the row that was updated</p>\n\n<p>For example, in oracle:</p>\n\n<pre><code>update car\nset in_use = 1\nwhere in_use = 0 and id = (select min(id) from car where in_use = 0)\nreturning id into car_id_that_was_set_in_use \n</code></pre>\n\n<p>The parameter car_id_that_was_set_in_use will contain the id of the car that was booked</p>\n\n<p>As a single operation that establishes locks and doesn't hold a transaction open for a long time it shouldn't cause any contention</p>\n\n<p>MySQL seems to be a notable exception to this - I don't find any indication that MySQL supports anything like <code>UPDATE..RETURNING</code> but there are other workarounds, such as innodb supporting <code>SELECT..FOR UPDATE</code> to allow you to lock the record you want to update, and hacks involving variables that might look something like:</p>\n\n<pre><code> UPDATE car SET\n     in_use = 1, id = @affectedid := id\n WHERE in_use = 0 AND id=(SELECT MIN(id) FROM car WHERE in_use = 0);\n SELECT @affectedid;\n</code></pre>\n\n<p>Test it though; I've never used this and adapted it from an SO answer</p>\n\n<hr>\n\n<p>You can alternatively code your front end app to round-robin it, though it's less efficient. This is pseudocode, cos I don't do ruby:</p>\n\n<pre><code>int rowsupdated = 0\nint potentialId = -1\nwhile(rowsupdated = 0 and potentialId is not null) {\n  potentialId = sql_scalar(\"SELECT MIN(id) FROM car WHERE in_use = 0\")\n  rowsupdated = sql_nonquery(\"UPDATE car SET in_use = 1 WHERE in_use = 0 and id = \" + potentialId)\n}\nif(potentialId is null)\n  //there was no car to book, we tried them all - potentialId would only be null if there were no more cars\nelse\n  //potentialId now contains the id of the car we booked\n</code></pre>\n\n<p>The while loop will keep going until it books a car. It's naive and inefficient but it raises an important point, applicable to the previous query also</p>\n\n<p><em>The update query must reference the same value of in_use that we're still expecting</em> </p>\n\n<p>You can't select an id, and just go ahead and set in_use = 1, without considering whether someone else has set in_use=1 while we were idle. This is called optimistic concurrency - you HOPE that noone else changed the data on the row you want to edit, but you include all the data you know about the row, so that if someone else DID change the row, the update fails and returns 0 records updated. The update fails if someone else set in_use = 1 while we were idle, and we make it a condition of the update that in_use still be 0 in order for the update to succeed.\nIf 0 is returned by the update, we can assume someone else changed the row before we did. Then, knowing we didn't get that row, we try for another one (or make a decision to overwrite/merge/accept the other person's changes)</p>\n"}, {"comments": [{"owner": {"reputation": 561, "user_id": 1495691, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/koVLw.jpg?s=128&g=1", "display_name": "minus1", "link": "https://stackoverflow.com/users/1495691/minus1"}, "edited": false, "score": 0, "creation_date": 1541603635, "post_id": 53190451, "comment_id": 93273452, "body": "Interesting, will look into it, thanks! What I currently done is: <code>Car.where(id: potential_car_id, status: &#39;available&#39;).limit(1).update_all(status: &#39;in_use&#39;)</code>. I fetch random potential_car_id from Car with status available and then try to update all records containing what ID and status &#39;available&#39; in this case if another request reserved car with potential_car_id it will not be overwritten because condition status = &#39;available&#39; would not be met. Like in answer was suggested."}], "tags": [], "owner": {"reputation": 111, "user_id": 4275302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b495db33ec776c3e6a7dfd347f80a4ae?s=128&d=identicon&r=PG&f=1", "display_name": "A_rayB", "link": "https://stackoverflow.com/users/4275302/a-rayb"}, "is_accepted": false, "score": 1, "last_activity_date": 1541597422, "creation_date": 1541597422, "answer_id": 53190451, "question_id": 53185969, "link": "https://stackoverflow.com/questions/53185969/prevent-queries-overwriting-each-other/53190451#53190451", "title": "Prevent queries overwriting each other", "body": "<p>If you are using Rails with active record you should be able to lock the car record once you've found it to prevent it being retrieved by another request. \nSomething like:</p>\n\n<pre><code>def reserve_car(user_id)\n  car = Car.find_by(status: 'available')\n  car.with_lock do\n    car.update_columns(user_id: user_id, status: 'in_use')\n  end\n\n  car\nend\n</code></pre>\n\n<p>You will probably need to tweak that according to the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Locking/Pessimistic.html\" rel=\"nofollow noreferrer\">ActiveRecord locking docs</a></p>\n"}], "owner": {"reputation": 561, "user_id": 1495691, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/koVLw.jpg?s=128&g=1", "display_name": "minus1", "link": "https://stackoverflow.com/users/1495691/minus1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 53186181, "answer_count": 2, "score": 0, "last_activity_date": 1541597422, "creation_date": 1541580152, "last_edit_date": 1541589163, "question_id": 53185969, "link": "https://stackoverflow.com/questions/53185969/prevent-queries-overwriting-each-other", "title": "Prevent queries overwriting each other", "body": "<p>I have application which receives car reservation requests, and on reservation car status in <code>cars</code> table should be set to <code>in_use</code>.</p>\n\n<p>Normally something like this would be done:</p>\n\n<pre><code>def reserve_car(user_id)\n  car = Car.find_by(status: 'available')\n  car.update_columns(user_id: user_id, status: 'in_use')\n\n  car\nend\n</code></pre>\n\n<p>But this solution creates a gap between selecting available car and updating it's state and then dilemma occurs when app have to process relative large number of request so in same time few requests tries to reserve same car.</p>\n\n<p>To reduce that risk I find and update available car in the same SQL query. Also I randomize available cars list order to reduce it even more. For randomizing the result I don't use <code>ORDER BY RAND() LIMIT 1</code> because AFAIK it generates random id for every record, sorts it and only when limits result to specified number - 1. Which isn't efficient because cars table expected to have large number of records in the future (100k+).</p>\n\n<p>So I come up with this solution:</p>\n\n<pre><code>def reserve_car(user_id)\n  sql = &lt;&lt;-SQL\n    UPDATE\n      cars AS r0,\n      (\n        SELECT\n          r1.id\n        FROM\n          cars AS r1\n          JOIN (\n            SELECT\n              (\n                RAND() * (\n                  SELECT\n                    MAX(id)\n                  FROM\n                    cars\n                )\n              ) AS id\n          ) AS r2\n        WHERE\n          r1.status = 'available'\n          AND r1.id &gt;= r2.id\n        LIMIT\n          1\n      ) AS r3\n    SET\n      r0.status = 'in_use',\n      r0.user_id = #{ActiveRecord::Base.connection.quote(user_id)}\n    WHERE\n      r0.id = r3.id\n  SQL\n\n  updates = ActiveRecord::Base.connection.exec_update(sql)\n\n  car = Car.find_by(user_id: user_id, status: 'in_use')\n\n  if car.present?\n    car\n  else\n    raise \"Failed to reserve car. Updates: #{updates}\"\n  end\nend\n</code></pre>\n\n<p>But often enough I receive exception \"Failed to reserve car. Updates 0\" although for a fact I know there is plenty of available cars.</p>\n\n<p>What could be wrong? Maybe someone could suggest a better solution?</p>\n\n<p>Thank you \ud83d\ude4f</p>\n"}, {"tags": ["ruby", "google-api-client", "fastlane", "ruby-2.5"], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 5456879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QaEAORgWbEs/AAAAAAAAAAI/AAAAAAAABWg/V3B_ochT9oQ/photo.jpg?sz=128", "display_name": "Wanda B.", "link": "https://stackoverflow.com/users/5456879/wanda-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1541617751, "creation_date": 1541617751, "answer_id": 53196201, "question_id": 53182351, "link": "https://stackoverflow.com/questions/53182351/fastlane-google-drive-api-file-not-found-for-google-sheet/53196201#53196201", "title": "Fastlane + Google Drive API - File not found for Google Sheet", "body": "<p>The issue was that I was reading the doc id in from a file which had been created using Vim (which puts <a href=\"https://stackoverflow.com/questions/1050640/vim-disable-automatic-newline-at-end-of-file\">newline at end of file automatically</a>); this newline was what caused issues.</p>\n"}], "owner": {"reputation": 111, "user_id": 5456879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QaEAORgWbEs/AAAAAAAAAAI/AAAAAAAABWg/V3B_ochT9oQ/photo.jpg?sz=128", "display_name": "Wanda B.", "link": "https://stackoverflow.com/users/5456879/wanda-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 53196201, "answer_count": 1, "score": 2, "last_activity_date": 1541617751, "creation_date": 1541552723, "last_edit_date": 1541614312, "question_id": 53182351, "link": "https://stackoverflow.com/questions/53182351/fastlane-google-drive-api-file-not-found-for-google-sheet", "title": "Fastlane + Google Drive API - File not found for Google Sheet", "body": "<p>I created an OAuth key which should enable me to view and fetch content from a Google sheet (i.e. CLI access to a sheet which gives read/write to all kabaminc.com people) by following the <a href=\"https://github.com/gimite/google-drive-ruby/blob/master/doc/authorization.md\" rel=\"nofollow noreferrer\">google-drive-ruby library docs</a>, but I get a <strong>File Not Found</strong> error for a Google sheet that is at the root of my Google Drive with Share permissions being \"Anyone at  can find and view\" when I try to fetch based on doc id from within a Fastlane action:</p>\n\n<pre><code>/&lt;path&gt;/.rvm/gems/ruby-2.5.1/gems/google-api-client-0.21.2/lib/google/apis/core/http_command.rb:218:in `check_status': [!] notFound: File not found: &lt;doc_id&gt; (Google::Apis::ClientError)\n</code></pre>\n\n<p>I did check the key and ensured the <a href=\"https://stackoverflow.com/questions/29606803/file-not-found-error-google-drive-api\">scope was correct</a>:</p>\n\n<pre><code>  \"scope\": [\n     \"https://www.googleapis.com/auth/drive\",\n     \"https://spreadsheets.google.com/feeds/\"\n  ],\n</code></pre>\n\n<p>As a bit of supplementary information which might or might not be pertinent, my organization uses Okta synced to Active Directory; therefore, to connect to G Suite, I use my Okta credentials.</p>\n\n<p>Using Ruby 2.5.1 with the following pertinent Gems:</p>\n\n<ul>\n<li>google-api-client (0.24.3, 0.21.2)</li>\n<li>google_drive (2.1.12)</li>\n<li>googleauth (0.7.1, 0.6.7)</li>\n<li>fastlane (2.107.0)</li>\n</ul>\n\n<p>From the Gemfile.lock:</p>\n\n<pre><code>fastlane (2.107.0)\n  CFPropertyList (&gt;= 2.3, &lt; 4.0.0)\n  addressable (&gt;= 2.3, &lt; 3.0.0)\n  babosa (&gt;= 1.0.2, &lt; 2.0.0)\n  bundler (&gt;= 1.12.0, &lt; 2.0.0)\n  colored\n  commander-fastlane (&gt;= 4.4.6, &lt; 5.0.0)\n  dotenv (&gt;= 2.1.1, &lt; 3.0.0)\n  emoji_regex (~&gt; 0.1)\n  excon (&gt;= 0.45.0, &lt; 1.0.0)\n  faraday (~&gt; 0.9)\n  faraday-cookie_jar (~&gt; 0.0.6)\n  faraday_middleware (~&gt; 0.9)\n  fastimage (&gt;= 2.1.0, &lt; 3.0.0)\n  gh_inspector (&gt;= 1.1.2, &lt; 2.0.0)\n  google-api-client (&gt;= 0.21.2, &lt; 0.24.0)\n  highline (&gt;= 1.7.2, &lt; 2.0.0)\n  json (&lt; 3.0.0)\n  mini_magick (~&gt; 4.5.1)\n  multi_json\n  multi_xml (~&gt; 0.5)\n  multipart-post (~&gt; 2.0.0)\n  plist (&gt;= 3.1.0, &lt; 4.0.0)\n  public_suffix (~&gt; 2.0.0)\n  rubyzip (&gt;= 1.2.2, &lt; 2.0.0)\n  security (= 0.1.3)\n  simctl (~&gt; 1.6.3)\n  slack-notifier (&gt;= 2.0.0, &lt; 3.0.0)\n  terminal-notifier (&gt;= 1.6.2, &lt; 2.0.0)\n  terminal-table (&gt;= 1.4.5, &lt; 2.0.0)\n  tty-screen (&gt;= 0.6.3, &lt; 1.0.0)\n  tty-spinner (&gt;= 0.8.0, &lt; 1.0.0)\n  word_wrap (~&gt; 1.0.0)\n  xcodeproj (&gt;= 1.6.0, &lt; 2.0.0)\n  xcpretty (~&gt; 0.3.0)\n  xcpretty-travis-formatter (&gt;= 0.0.3)\ngoogle-api-client (0.21.2)\n  addressable (~&gt; 2.5, &gt;= 2.5.1)\n  googleauth (&gt;= 0.5, &lt; 0.7.0)\n  httpclient (&gt;= 2.8.1, &lt; 3.0)\n  mime-types (~&gt; 3.0)\n  representable (~&gt; 3.0)\n  retriable (&gt;= 2.0, &lt; 4.0)\ngoogle_drive (2.1.12)\n  google-api-client (&gt;= 0.11.0, &lt; 0.22.0)\n  googleauth (&gt;= 0.5.0, &lt; 1.0.0)\n  nokogiri (&gt;= 1.5.3, &lt; 2.0.0)\ngoogleauth (0.6.7)\n  faraday (~&gt; 0.12)\n  jwt (&gt;= 1.4, &lt; 3.0)\n  memoist (~&gt; 0.16)\n  multi_json (~&gt; 1.11)\n  os (&gt;= 0.9, &lt; 2.0)\n  signet (~&gt; 0.7)\n</code></pre>\n\n<p>Thanks for reading and for your help, folks! I've been tearing my hair out over this one...</p>\n\n<p><em>EDIT</em>: The sheet is in My Drive, not in a Team Drive, so this <a href=\"https://github.com/gimite/google-drive-ruby/issues/259\" rel=\"nofollow noreferrer\">Team Drive Support</a> issue might not be relevant, but might help others!</p>\n"}, {"tags": ["ruby", "oauth", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1541548831, "creation_date": 1541548831, "answer_id": 53181879, "question_id": 53181721, "link": "https://stackoverflow.com/questions/53181721/where-are-gem-installs-coming-from/53181879#53181879", "title": "Where are gem installs coming from?", "body": "<p>By default <code>gem</code> pulls from <a href=\"https://rubygems.org\" rel=\"nofollow noreferrer\">Rubygems</a>, the main gem repository, but you can install from anywhere if you give it a URL or use the <code>--source</code> option to specify an alternate source. Some prefer to use private gem hosting for their dependencies.</p>\n\n<p>Why not use a <a href=\"https://bundler.io\" rel=\"nofollow noreferrer\"><code>Gemfile</code></a> to manage your dependencies? It makes it a lot more clear:</p>\n\n<pre><code>source 'https://rubygems.org/'\n\ngem 'oauth2'\n</code></pre>\n\n<p>Then you install:</p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>Then you can see where it got installed:</p>\n\n<pre><code>bundle show oauth2\n</code></pre>\n\n<p>From there you can look at the source. You can also look at the <a href=\"https://rubygems.org/gems/oauth2\" rel=\"nofollow noreferrer\">gem listing page for <code>oauth2</code></a> where links to documentation and source are provided.</p>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1541551056, "creation_date": 1541551056, "answer_id": 53182138, "question_id": 53181721, "link": "https://stackoverflow.com/questions/53181721/where-are-gem-installs-coming-from/53182138#53182138", "title": "Where are gem installs coming from?", "body": "<p>There are a few useful options for looking at source code for ruby gems.\nAs @tadman has mentioned you generally can expect the default gem source to be hosted at <a href=\"https://rubygems.org\" rel=\"nofollow noreferrer\">https://rubygems.org</a> and using <a href=\"https://bundler.io/\" rel=\"nofollow noreferrer\">Bundler</a> is also highly recommended.</p>\n\n<p>In many cases the open source code will be hosted on <a href=\"https://github.com\" rel=\"nofollow noreferrer\">https://github.com</a>. I tend to prefer to fork the gem source and download my fork locally where I can analyze it in my editor without fear of accidentally breaking anything since your forked repo will contain the full git history/repo etc.</p>\n\n<p>If you're new to ruby, I would highly recommend you use a ruby version manager, i.e. <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">RVM</a>  or perhaps <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">RBENV</a>, although I tend to find RVM a bit simpler and less problematic. </p>\n\n<p>My other personal favorite ruby code hacking/inspecting tool is <a href=\"https://github.com/pry/pry\" rel=\"nofollow noreferrer\">PRY</a> </p>\n"}], "owner": {"reputation": 509, "user_id": 906397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/be3bb9aa8db8052b8683cbd5774b5449?s=128&d=identicon&r=PG", "display_name": "Colbs", "link": "https://stackoverflow.com/users/906397/colbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 53181879, "answer_count": 2, "score": 3, "last_activity_date": 1541565975, "creation_date": 1541547594, "last_edit_date": 1541565975, "question_id": 53181721, "link": "https://stackoverflow.com/questions/53181721/where-are-gem-installs-coming-from", "title": "Where are gem installs coming from?", "body": "<p>I am wondering, while I'm sifting through samples, how I locate the source library when installing gems. For example, I have</p>\n\n<pre><code>require 'oauth2'\n</code></pre>\n\n<p>and to install, I run</p>\n\n<pre><code>gem install oauth2\n</code></pre>\n\n<p>What repository is pulled from for gem installs? I want to use reflection to reverse engineer some of the calls in the samples.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "activeadmin", "formtastic"], "answers": [{"comments": [{"owner": {"reputation": 50, "user_id": 4780761, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fKBof-K7IWw/AAAAAAAAAAI/AAAAAAAAAaU/MbThUrIht3k/photo.jpg?sz=128", "display_name": "C.J. Coffey", "link": "https://stackoverflow.com/users/4780761/c-j-coffey"}, "edited": false, "score": 0, "creation_date": 1542130813, "post_id": 53190254, "comment_id": 93455402, "body": "From what I&#39;m seeing there, the best option is to add a link and have the controller handle code generation. I&#39;m still a little lost as to how I can return the code to form for the user to interact with, but I think I&#39;m getting there."}], "tags": [], "owner": {"reputation": 2560, "user_id": 153279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783f796db3d628f7c268326fb3323de8?s=128&d=identicon&r=PG", "display_name": "Piers C", "link": "https://stackoverflow.com/users/153279/piers-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1541596626, "creation_date": 1541596626, "answer_id": 53190254, "question_id": 53180924, "link": "https://stackoverflow.com/questions/53180924/passthrough-temporary-variables-in-activeadmin/53190254#53190254", "title": "Passthrough/Temporary Variables in ActiveAdmin", "body": "<p>Take a look at the <a href=\"https://activeadmin.info/10-custom-pages.html\" rel=\"nofollow noreferrer\">documentation for custom pages</a>  The <a href=\"https://activeadmin.info/documentation.html\" rel=\"nofollow noreferrer\">official documentation</a> and <a href=\"https://github.com/activeadmin/activeadmin/wiki\" rel=\"nofollow noreferrer\">wiki</a> have a lot of useful material.</p>\n"}], "owner": {"reputation": 50, "user_id": 4780761, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fKBof-K7IWw/AAAAAAAAAAI/AAAAAAAAAaU/MbThUrIht3k/photo.jpg?sz=128", "display_name": "C.J. Coffey", "link": "https://stackoverflow.com/users/4780761/c-j-coffey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541596626, "creation_date": 1541542601, "question_id": 53180924, "link": "https://stackoverflow.com/questions/53180924/passthrough-temporary-variables-in-activeadmin", "title": "Passthrough/Temporary Variables in ActiveAdmin", "body": "<p>I'm updating an ActiveAdmin page to keep up with a new feature I'm adding to my app, namely Google Sheets Integration. I need a way to capture user input (the auth code from google, copied and pasted from their site) so that I can use it do generate oAuth credentials for the account. I don't store the code in my database, only the credentials it generates. </p>\n\n<p>How can I get this kind of input via ActiveAdmin? I have only ever seen it used to change database fields. </p>\n"}, {"tags": ["ruby", "xml", "xpath", "namespaces", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 8496955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130af836e960f2242a04e7fa5cbef5a8?s=128&d=identicon&r=PG&f=1", "display_name": "lumos", "link": "https://stackoverflow.com/users/8496955/lumos"}, "edited": false, "score": 0, "creation_date": 1541553933, "post_id": 53180868, "comment_id": 93255037, "body": "This works perfectly, thank you so much. I do have support for <code>&amp;.</code> What exactly does that do/signify?"}, {"owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "reply_to_user": {"reputation": 131, "user_id": 8496955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130af836e960f2242a04e7fa5cbef5a8?s=128&d=identicon&r=PG&f=1", "display_name": "lumos", "link": "https://stackoverflow.com/users/8496955/lumos"}, "edited": false, "score": 1, "creation_date": 1541554042, "post_id": 53180868, "comment_id": 93255055, "body": "It will call the method only if the object is non-nil. Makes it safe to chain deep into calls without checking for nil."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1541578432, "post_id": 53180868, "comment_id": 93260655, "body": "Note that the first <code>&amp;.</code> there is not needed, since <code>node.attributes.each</code> should never yield <code>nil</code>. Thus, <code>val.namespace&amp;.prefix</code> should work as well."}], "tags": [], "owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "is_accepted": true, "score": 1, "last_activity_date": 1541542389, "creation_date": 1541542389, "answer_id": 53180868, "question_id": 53180114, "link": "https://stackoverflow.com/questions/53180114/remove-nokogiri-attribute-based-on-namespace-prefix/53180868#53180868", "title": "Remove nokogiri attribute based on namespace prefix", "body": "<p>Node objects have a <code>remove</code> method that drops them from the tree, so you can write something like this:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc  = Nokogiri::XML(DATA)\nputs '--- Before'\nputs doc.to_s\n\ndoc.traverse do |node|\n  next unless node.respond_to? :attributes\n  node.attributes.each do |key, val|\n    val.remove if val&amp;.namespace&amp;.prefix == 'opf'\n  end\nend\n\nputs\nputs '--- After'\nputs doc.to_s\n\n__END__\n&lt;metadata xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:opf=\"http://www.idpf.org/2007/opf\"&gt;\n    &lt;dc:identifier id=\"iden\" opf:scheme=\"ISBN\"&gt;xxxx&lt;/dc:identifier&gt;\n    &lt;dc:creator opf:role=\"aut\" opf:file-as=\"Name\"&gt;xxxx&lt;/dc:creator&gt;\n    &lt;dc:date opf:event=\"publication\"&gt;xxxx&lt;/dc:date&gt;\n    &lt;dc:publisher&gt;xxxx&lt;/dc:publisher&gt;\n    &lt;meta name=\"cover\" content=\"x\"/&gt;\n&lt;/metadata&gt;\n</code></pre>\n\n<p>And see the following output:</p>\n\n<pre><code>\u279c  ~ ruby test.rb\n--- Before\n&lt;?xml version=\"1.0\"?&gt;\n&lt;metadata xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:opf=\"http://www.idpf.org/2007/opf\"&gt;\n    &lt;dc:identifier id=\"iden\" opf:scheme=\"ISBN\"&gt;xxxx&lt;/dc:identifier&gt;\n    &lt;dc:creator opf:role=\"aut\" opf:file-as=\"Name\"&gt;xxxx&lt;/dc:creator&gt;\n    &lt;dc:date opf:event=\"publication\"&gt;xxxx&lt;/dc:date&gt;\n    &lt;dc:publisher&gt;xxxx&lt;/dc:publisher&gt;\n    &lt;meta name=\"cover\" content=\"x\"/&gt;\n&lt;/metadata&gt;\n\n--- After\n&lt;?xml version=\"1.0\"?&gt;\n&lt;metadata xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:opf=\"http://www.idpf.org/2007/opf\"&gt;\n    &lt;dc:identifier id=\"iden\"&gt;xxxx&lt;/dc:identifier&gt;\n    &lt;dc:creator&gt;xxxx&lt;/dc:creator&gt;\n    &lt;dc:date&gt;xxxx&lt;/dc:date&gt;\n    &lt;dc:publisher&gt;xxxx&lt;/dc:publisher&gt;\n    &lt;meta name=\"cover\" content=\"x\"/&gt;\n&lt;/metadata&gt;\n</code></pre>\n\n<p><strong>Note</strong> If the Ruby version you are using doesn't support <code>&amp;.</code> you'll need to handle the namespace being potentially <code>nil</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1541578073, "creation_date": 1541578073, "answer_id": 53185555, "question_id": 53180114, "link": "https://stackoverflow.com/questions/53180114/remove-nokogiri-attribute-based-on-namespace-prefix/53185555#53185555", "title": "Remove nokogiri attribute based on namespace prefix", "body": "<p>I believe this is much simpler:</p>\n\n<pre><code>doc.xpath('//@opf:*', { opf: \"http://www.idpf.org/2007/opf\" }).each(&amp;:remove)\n</code></pre>\n\n<p><code>//</code> searches any descendant node, <code>@</code> indicates it has to be an attribute node, <code>opf:</code> in conjunction with the namespace definition (<code>{ opf: \"http://www.idpf.org/2007/opf\" }</code>) says what namespace it has to belong to, and <code>*</code> matches any name.</p>\n\n<hr>\n\n<p>Note that <code>opf:</code> by itself doesn't mean anything; <code>\"http://www.idpf.org/2007/opf\"</code> does, and <code>opf</code> is just a shorthand in its scope. <code>.xpath('//@foobar:*', { foobar: \"http://www.idpf.org/2007/opf\" })</code> would work just as well for your case.</p>\n\n<p>Since you have the namespace definition on the root, and it doesn't change within the document, you can simplify to</p>\n\n<pre><code>doc.xpath('//@opf:*', doc.namespaces).each(&amp;:remove)\n</code></pre>\n\n<p>but note that this is not generally safe (e.g. the namespace could be defined on a subnode). <code>doc.collect_namespaces</code> is a bit safer instead, but even then you are not completely safe (e.g. if the same prefix is used for two different URIs in different parts of the document). I'd go with the first one (explicit URI) unless I actually saw the XML with my eyes and know where and how the prefix is defined and used.</p>\n\n<p>tl;dr: Prefixes mean nothing, refer to the associated URI instead.</p>\n"}], "owner": {"reputation": 131, "user_id": 8496955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130af836e960f2242a04e7fa5cbef5a8?s=128&d=identicon&r=PG&f=1", "display_name": "lumos", "link": "https://stackoverflow.com/users/8496955/lumos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 53180868, "answer_count": 2, "score": 2, "last_activity_date": 1541578073, "creation_date": 1541538934, "last_edit_date": 1541540533, "question_id": 53180114, "link": "https://stackoverflow.com/questions/53180114/remove-nokogiri-attribute-based-on-namespace-prefix", "title": "Remove nokogiri attribute based on namespace prefix", "body": "<p>I'm using nokogiri to parse an XML file. Some of the nodes in the file have attributes specific to namespaces:</p>\n\n<pre><code>&lt;metadata xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:opf=\"http://www.idpf.org/2007/opf\"&gt;\n    &lt;dc:identifier id=\"iden\" opf:scheme=\"ISBN\"&gt;xxxx&lt;/dc:identifier&gt;\n    &lt;dc:creator opf:role=\"aut\" opf:file-as=\"Name\"&gt;xxxx&lt;/dc:creator&gt;\n    &lt;dc:date opf:event=\"publication\"&gt;xxxx&lt;/dc:date&gt;\n    &lt;dc:publisher&gt;xxxx&lt;/dc:publisher&gt;\n    &lt;meta name=\"cover\" content=\"x\"/&gt;\n&lt;/metadata&gt;\n</code></pre>\n\n<p>I'm trying to remove any attribute with the \"opf\" prefix. I've come across xpath solutions in finding an attribute <em>value</em> based on a partial match, but what about when it's a partial match of the attribute name itself? I tried a lot of things that haven't worked. I did a simple thing just to try to extract the attribute names at least, but if I do:</p>\n\n<pre><code>elements = @doc.at_xpath('//xmlns:metadata').children\nelements.each { |el|\n    el.attributes.each { |attribute|\n        if attribute[1].namespace_scopes[1].prefix == \"opf\"\n            puts attribute[0]\n        end\n    }   \n}\n</code></pre>\n\n<p>I end up getting:</p>\n\n<pre><code>id\nscheme\nrole\nfile-as\nevent\nname\ncontent\n</code></pre>\n\n<p>but I only want the ones with the \"opf\" prefix (\"opf:scheme\", \"opf:role, \"opf:file-as\", \"opf:event\") so that they can be removed, without touching any of the other attributes. I even tried to force it by hard-coding the attributes I knew existed:</p>\n\n<pre><code>opf_attributes = [\"opf:file-as\",\"opf:scheme\",\"opf:role\",\"opf:event\"]\nelements.each  { |el|\n    opf_attributes.each { |x|\n        el.remove_attribute(x) if el[x] != nil\n    }\n} \n</code></pre>\n\n<p>which is not the smartest way to go about this, but this still didn't work. Nothing happens to the nodes, and the attributes remain as they were. (I don't know if it's worth noting, but if I use the <code>remove_attr(x)</code> method instead, I get this error: <code>undefined method 'remove_attr' for #&lt;Nokogiri::XML::Element:0x...&gt;</code></p>\n\n<p>So, my question is:<br>\nIs there a clearer way to </p>\n\n<ol>\n<li>find attributes based on a partial match and/or the namespace prefix, then </li>\n<li>remove those attributes from the nodes that contain them?</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1541541083, "post_id": 53180080, "comment_id": 93251271, "body": "Looks good but tests are failed. When the survey has questions with answers 3 it should eq to <code>[&#39;dont_know&#39;]</code> but got 0. The same if there are no answers, <code>should eq to 3</code> but <code>got 0</code>. Additionally I think <code>statement = Hash.new(0)</code> is not necessary."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 2, "creation_date": 1541543631, "post_id": 53180080, "comment_id": 93252262, "body": "@wichru If you don&#39;t initialize <code>statement</code> with something you won&#39;t get a proper tabulation hash. Leticia&#39;s <code>Hash.new(0)</code> is the Ruby way of creating one of those."}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1541626094, "post_id": 53180080, "comment_id": 93284786, "body": "@tadman you are right, my tests were wrong that&#39;s why they didn&#39;t worked. Sorry for that, Leticia&#39;s solution is briliant! Thank you very much!"}], "tags": [], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "is_accepted": true, "score": 2, "last_activity_date": 1541538762, "creation_date": 1541538762, "answer_id": 53180080, "question_id": 53179793, "link": "https://stackoverflow.com/questions/53179793/how-to-manage-survey-model-with-3-options-for-chose/53180080#53180080", "title": "How to manage survey model with 3 options for chose", "body": "<p>I think you'll like: </p>\n\n<pre><code>statement = Hash.new(0)\n@survey.questions.each do |question|\n  answer = question.answer&amp;.value\n  statement[answer] += 1 if answer\nend\n</code></pre>\n\n<p>Initializing with <code>Hash.new(0)</code> makes that when evaluating <code>statement[answer]</code> is not defined yet, it adds the answer key to the hash with the value 0 so the <code>+1</code> after doesn't fail. </p>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 53180080, "answer_count": 1, "score": 1, "last_activity_date": 1541538762, "creation_date": 1541537299, "question_id": 53179793, "link": "https://stackoverflow.com/questions/53179793/how-to-manage-survey-model-with-3-options-for-chose", "title": "How to manage survey model with 3 options for chose", "body": "<p>In my survey app one of the method in a model should count and group all the answers given to the survey's questions. Returned hash should have a following format - { \"survey_name\": { \"yes\": 3, \"no\": 2, \"dont_know\": 1 }}</p>\n\n<p>Right now I've got working solution but well it doesn't seem very SOLID.</p>\n\n<pre><code>def report\nstatement = {\n  'yes' =&gt; 0,\n  'no' =&gt; 0,\n  'dont_know' =&gt; 0\n}\n@survey.questions.each do |question|\n  if question.answer&amp;.value == 'yes'\n    statement['yes'] += 1\n  elsif question.answer&amp;.value == 'no'\n    statement['no'] += 1\n  else\n    statement['dont_know'] += 1\n  end\nend\n{\n  @survey.name =&gt; statement\n}\nend\n</code></pre>\n\n<p>Could you please advise how it should be done in more elegant way?</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1541536785, "post_id": 53179668, "comment_id": 93249417, "body": "Can you add what you have tried so far?"}, {"owner": {"reputation": 43, "user_id": 5777540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a58b58795e6c3d8316245d506a1566?s=128&d=identicon&r=PG&f=1", "display_name": "Jinx", "link": "https://stackoverflow.com/users/5777540/jinx"}, "reply_to_user": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1541536911, "post_id": 53179668, "comment_id": 93249488, "body": "I used array.all? {|x| x == b[0]} to check for identical values but need to return the specific index. I am quite new to ruby so not sure which loop and method to go for"}, {"owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1541537086, "post_id": 53179668, "comment_id": 93249571, "body": "Not sure how &#39;efficient&#39; this is for a big array but <code>array_1.each_with_index.map{|v,i| array_2.include?(v) ? nil : i }.compact</code>"}, {"owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1541537147, "post_id": 53179668, "comment_id": 93249601, "body": "You could do <code>array_2[i] == v</code> instead of  <code>array_2.include(v)</code> if you want it to match exactly rather than it being anywhere in the array"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 4, "creation_date": 1541566223, "post_id": 53179668, "comment_id": 93257238, "body": "The question does not make sense at all. If you have array elements that are not identical to one another, which ones are supposed to be the &quot;mismatched&quot; ones, and which are the &quot;matching&quot; ones?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 2, "creation_date": 1541578685, "post_id": 53179668, "comment_id": 93260750, "body": "As @sawa says. The question reminds me of that old joke &quot;What is the difference between a duck?&quot;"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1541579185, "post_id": 53179668, "comment_id": 93260956, "body": "@Jinx do you want just the first index or all indices? It would help if you could add one or mores example arrays and the expected results."}, {"owner": {"reputation": 43, "user_id": 5777540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a58b58795e6c3d8316245d506a1566?s=128&d=identicon&r=PG&f=1", "display_name": "Jinx", "link": "https://stackoverflow.com/users/5777540/jinx"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1541610905, "post_id": 53179668, "comment_id": 93277705, "body": "@sawa Array B is consisting the status success which will be identical for all values, In case if one of the status fails I wanted to check where the mismatch happens. Does it makes a sense"}, {"owner": {"reputation": 43, "user_id": 5777540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a58b58795e6c3d8316245d506a1566?s=128&d=identicon&r=PG&f=1", "display_name": "Jinx", "link": "https://stackoverflow.com/users/5777540/jinx"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1541610999, "post_id": 53179668, "comment_id": 93277751, "body": "@Stefan: I am having two arrays A[] and B[] b is having all status values which is success e.g. B[success, success, success] In case if any of the status value is different than success I just wanted to figure out the index so that I can point that index to A to identify the service."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1541663472, "post_id": 53179668, "comment_id": 93294984, "body": "@Jinx thanks for the clarification, but that doesn&#39;t answer my question: do you just want the index of the <i>first</i> &quot;different&quot; element or the indices of <i>all</i> &quot;different&quot; elements?"}, {"owner": {"reputation": 43, "user_id": 5777540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a58b58795e6c3d8316245d506a1566?s=128&d=identicon&r=PG&f=1", "display_name": "Jinx", "link": "https://stackoverflow.com/users/5777540/jinx"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1541692006, "post_id": 53179668, "comment_id": 93310390, "body": "@Stefan sorry for missing it,  I want indices of all the different elements."}, {"owner": {"reputation": 43, "user_id": 5777540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a58b58795e6c3d8316245d506a1566?s=128&d=identicon&r=PG&f=1", "display_name": "Jinx", "link": "https://stackoverflow.com/users/5777540/jinx"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1541692359, "post_id": 53179668, "comment_id": 93310630, "body": "@Stefan Edited the question to reflect it correctly. Thanks for your patience to understand it properly."}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1541566490, "post_id": 53179771, "comment_id": 93257288, "body": "Why is the answer not <code>[0, 1, 2, 5]</code> (the ones not matching <code>3</code>) or <code>[0, 1, 2, 3, 4]</code> (the ones not matching <code>4</code>), or <code>[0, 1, 2, 3, 4, 5]</code> (the ones not matching some other element)?"}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1541599263, "post_id": 53179771, "comment_id": 93270671, "body": "It compares against the first element, I thought it had to behave like that judging by his attempt"}, {"owner": {"reputation": 43, "user_id": 5777540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a58b58795e6c3d8316245d506a1566?s=128&d=identicon&r=PG&f=1", "display_name": "Jinx", "link": "https://stackoverflow.com/users/5777540/jinx"}, "edited": false, "score": 1, "creation_date": 1541611095, "post_id": 53179771, "comment_id": 93277797, "body": "@LeticiaEsperon Thanks a lot above solution worked for me."}], "tags": [], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "is_accepted": true, "score": 2, "last_activity_date": 1541537210, "creation_date": 1541537210, "answer_id": 53179771, "question_id": 53179668, "link": "https://stackoverflow.com/questions/53179668/return-the-array-indices-where-values-are-not-identical/53179771#53179771", "title": "Return the array indices where values are not identical", "body": "<p>How about:</p>\n\n<pre><code>my_array = [1, 1, 1, 3, 1, 4]\nindexes = []\nmy_array.each_with_index do |item, index| indexes &lt;&lt; index unless item == my_array[0] end\n\nindexes # [3, 5]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1541566483, "post_id": 53180718, "comment_id": 93257285, "body": "Why is the answer not <code>[0, 1, 2, 5]</code> (the ones not matching <code>3</code>) or <code>[0, 1, 2, 3, 4]</code> (the ones not matching <code>4</code>), or <code>[0, 1, 2, 3, 4, 5]</code> (the ones not matching some other element)?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1541580805, "post_id": 53180718, "comment_id": 93261613, "body": "Good pint, @sawa. I changed my interpretation of the question as indicated. That was in part becaure return the OP asks for <i>\u201cthe index...</i>\u201d` rather than <code>the indices</code>. (I just noticed the title refers to <code>\u201dindices\u201d</code>. Oh, well.)  At least the question is unambiguous with my new interpretation."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1541585772, "post_id": 53180718, "comment_id": 93264142, "body": "@CarySwoveland If you need to have &quot;your interpretation&quot;, it&#39;s hardly unambiguous :D"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1541603003, "post_id": 53180718, "comment_id": 93272998, "body": "@Amadan, you got me."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1541663609, "post_id": 53180718, "comment_id": 93295040, "body": "Or <code>arr.find_index { |e| e != arr.first }</code> (and you don&#39;t need the <code>any?</code> check)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1541691874, "post_id": 53180718, "comment_id": 93310302, "body": "Thanks, @Stefan. I made the change."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1541706937, "last_edit_date": 1541706937, "creation_date": 1541541684, "answer_id": 53180718, "question_id": 53179668, "link": "https://stackoverflow.com/questions/53179668/return-the-array-indices-where-values-are-not-identical/53180718#53180718", "title": "Return the array indices where values are not identical", "body": "<p>Given an array <code>arr</code>, I assume the objective is to return the smallest index <code>i &gt; 0</code> for which <code>arr[i] != arr[i-1]</code>.</p>\n\n<pre><code>arr = [1, 1, 1, 3, 1, 4]\n\nfirst = arr.first    \narr.index { |i| arr[i] != first }\n  #=&gt; 3\n</code></pre>\n\n<p><code>nil</code> is returned if the array is empty or all elements of the array are equal.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1541572926, "creation_date": 1541572926, "answer_id": 53184658, "question_id": 53179668, "link": "https://stackoverflow.com/questions/53179668/return-the-array-indices-where-values-are-not-identical/53184658#53184658", "title": "Return the array indices where values are not identical", "body": "<p>Given the array <code>ary = [1, 1, 1, 3, 3, 3, 3, 3, 3, 1, 4, 4, 4]</code> it is not possible to tell which integer leads, but you can find the index of discontinuity:</p>\n\n<pre><code>ary.each.with_index.with_object([]){ |(x, idx), o| o &lt;&lt; idx + 1 if x != ary[idx + 1] }\n#=&gt; [3, 9, 10, 13]\n</code></pre>\n\n<p>Or this where also the first element is considered as a discontinuity:</p>\n\n<pre><code>ary.chunk_while { |a,b| a == b }.map(&amp;:count).inject([0]) { |x, y| x + [x.last + y] }\n#=&gt; [0, 3, 9, 10, 13]\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5777540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a58b58795e6c3d8316245d506a1566?s=128&d=identicon&r=PG&f=1", "display_name": "Jinx", "link": "https://stackoverflow.com/users/5777540/jinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 53179771, "answer_count": 3, "score": -1, "last_activity_date": 1541706937, "creation_date": 1541536721, "last_edit_date": 1541692295, "question_id": 53179668, "link": "https://stackoverflow.com/questions/53179668/return-the-array-indices-where-values-are-not-identical", "title": "Return the array indices where values are not identical", "body": "<p>I have two arrays A[] and B[]. e.g. A[network, HTTP, SMTP] and B[Success, Success, Success]. </p>\n\n<p>A consist of all service names and b is there status. </p>\n\n<p>To check for identical values I used:</p>\n\n<pre><code>B.all? { |x| x == B[0] }\n</code></pre>\n\n<p>As first value is always be the success.</p>\n\n<p>I need to check whether array <code>B</code>'s values are all identical, and if not, then return the indices where it mismatches.</p>\n\n<p>I need to know an efficient way to do this.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 1, "creation_date": 1541537572, "post_id": 53179635, "comment_id": 93249799, "body": "I&#39;m not sure I understand what you want to do. Could you put an example with input / output?"}, {"owner": {"reputation": 21, "user_id": 10364550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0f8aeafbad2485927832513d5b0edc?s=128&d=identicon&r=PG&f=1", "display_name": "ruuddevil", "link": "https://stackoverflow.com/users/10364550/ruuddevil"}, "reply_to_user": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1541539160, "post_id": 53179635, "comment_id": 93250467, "body": "Sorry, that&#39;s all the instruction I was given. Match the claims data to the appropriate customer. Each array has more than one customer/claim. I used 1 for each in the example just to show a claim that should be matched to a customer."}], "answers": [{"tags": [], "owner": {"reputation": 334, "user_id": 2606111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FUdFG.jpg?s=128&g=1", "display_name": "Mahys116", "link": "https://stackoverflow.com/users/2606111/mahys116"}, "is_accepted": false, "score": 0, "last_activity_date": 1541540251, "creation_date": 1541540251, "answer_id": 53180431, "question_id": 53179635, "link": "https://stackoverflow.com/questions/53179635/matching-objects-from-two-separate-arrays-based-on-a-key-value/53180431#53180431", "title": "Matching objects from two separate arrays based on a key value", "body": "<p>You need to do something like this:</p>\n\n<pre><code>customer = [{\"Last Name\" =&gt; \"lastname\", \"First Name\" =&gt; \"firstname\", \"ID\" =&gt; \"6583142\"}]\nclaim = [{\"ID\"=&gt;\"6583142\", \"number\"=&gt;\"123214\", \"start_date\"=&gt;\"2018-10-03\"}]\n\n# Get all uniq ids\nids = (claim + customer).map {|object| object['ID']}.uniq\n\n# Find claims and customers for every id\nmerged_data = ids.map do |id| \n    {\n        id: id, \n        claims: claim.select{|claim| claim['ID'] == id}, \n        customers: customer.select{|customer| customer['ID'] == id}\n    }\nend\n</code></pre>\n\n<p>result will be:</p>\n\n<pre><code>[{\n  :id=&gt;\"6583142\", \n  :claims=&gt;[{\"ID\"=&gt;\"6583142\", \"number\"=&gt;\"123214\", \"start_date\"=&gt;\"2018-10-03\"}], \n  :customers=&gt;[{\"Last Name\"=&gt;\"lastname\", \"First Name\"=&gt;\"firstname\", \"ID\"=&gt;\"6583142\"}]\n}]\n</code></pre>\n\n<p>Also, if for every ID you have only one claim and only one Customer you can just merge it:</p>\n\n<pre><code>ids.map do |id|\n    claim_hash = claim.select{|claim| claim['ID'] == id}.first\n    customer_hash = customer.select{|customer| customer['ID'] == id}.first\n    claim_hash.merge customer_hash\nend\n[{\"ID\"=&gt;\"6583142\", \"number\"=&gt;\"123214\", \"start_date\"=&gt;\"2018-10-03\", \"Last Name\"=&gt;\"lastname\", \"First Name\"=&gt;\"firstname\"}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1541568428, "post_id": 53180778, "comment_id": 93257638, "body": "Good point about the possibility of one customer having multiple claims."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1541541991, "creation_date": 1541541991, "answer_id": 53180778, "question_id": 53179635, "link": "https://stackoverflow.com/questions/53179635/matching-objects-from-two-separate-arrays-based-on-a-key-value/53180778#53180778", "title": "Matching objects from two separate arrays based on a key value", "body": "<p>If what you are looking for is a <em>pseudo database like search</em>.</p>\n\n<p>I'm using plural for collections:</p>\n\n<pre><code>customers = [{\"Last Name\": \"lastname\", \"First Name\": \"firstname\", \"ID\": \"6583142\"}]\nclaims = [{\"ID\"=&gt;\"6583142\", \"number\"=&gt;\"123214\", \"start_date\"=&gt;\"2018-10-03\"}]\n</code></pre>\n\n<p>Claim has one customer, so first look for the claim by claim number, then look for its customer:</p>\n\n<pre><code>claim_number = \"123214\"\nclaim = claims.detect { |h| h[\"number\"] == claim_number }\ncustomer = customers.detect { |h| h[:\"ID\"] == claim[\"ID\"] }\n#=&gt; {:\"Last Name\"=&gt;\"lastname\", :\"First Name\"=&gt;\"firstname\", :ID=&gt;\"6583142\"}\n</code></pre>\n\n<p>Customer has many claims, so, given the customer id, find all claims:</p>\n\n<pre><code>customer_id = \"6583142\"\np all_claim_by_customer = claims.select { |h| h[\"ID\"] == customer_id }\n#=&gt; [{\"ID\"=&gt;\"6583142\", \"number\"=&gt;\"123214\", \"start_date\"=&gt;\"2018-10-03\"}]\n</code></pre>\n\n<p>I suggest to use symbols as keys for hashes.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1541544371, "creation_date": 1541544371, "answer_id": 53181242, "question_id": 53179635, "link": "https://stackoverflow.com/questions/53179635/matching-objects-from-two-separate-arrays-based-on-a-key-value/53181242#53181242", "title": "Matching objects from two separate arrays based on a key value", "body": "<pre><code>customers = [{ \"Last Name\":\"Hardplace\",  \"First Name\":\"Rockina\", \"ID\":\"6583142\" },\n             { \"Last Name\":\"Bebblebrox\", \"First Name\":\"Zaphod\",  \"ID\":\"6583143\" }]\n\nclaims =    [{ \"ID\"=&gt;\"6583143\", \"number\"=&gt;\"123215\", \"start_date\"=&gt;\"2018-10-04\" },\n             { \"ID\"=&gt;\"6583142\", \"number\"=&gt;\"123214\", \"start_date\"=&gt;\"2018-10-03\" }]\n\ndef by_id(arr)\n  arr.each_with_object({}) { |g,h| h[g[:ID]] = g }\nend\n\ncustomers_by_id = by_id(customers)\n  #=&gt; {\"6583142\"=&gt;{:\"Last Name\"=&gt;\"Hardplace\", :\"First Name\"=&gt;\"Rockina\", :ID=&gt;\"6583142\"},\n  #    \"6583143\"=&gt;{:\"Last Name\"=&gt;\"Bebblebrox\", :\"First Name\"=&gt;\"Zaphod\", :ID=&gt;\"6583143\"}}\nadj_claims = claims.map { |h| h.transform_keys { |k| k == \"ID\" ? :ID : k } }\n  #=&gt; [{:ID=&gt;\"6583143\", \"number\"=&gt;\"123215\", \"start_date\"=&gt;\"2018-10-04\"},\n  #    {:ID=&gt;\"6583142\", \"number\"=&gt;\"123214\", \"start_date\"=&gt;\"2018-10-03\"}]\nclaims_by_id = by_id(adj_claims)\n  #=&gt; {\"6583143\"=&gt;{:ID=&gt;\"6583143\", \"number\"=&gt;\"123215\", \"start_date\"=&gt;\"2018-10-04\"},\n  #    \"6583142\"=&gt;{:ID=&gt;\"6583142\", \"number\"=&gt;\"123214\", \"start_date\"=&gt;\"2018-10-03\"}}\n</code></pre>\n\n<p>Given a claim id, say <code>\"6583142\"</code>, the customer and claims information are contained in the  hashes:</p>\n\n<pre><code>customers_by_id[\"6583142\"]\n  #=&gt; {:\"Last Name\"=&gt;\"Hardplace\", :\"First Name\"=&gt;\"Rockina\", :ID=&gt;\"6583142\"}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>claims_by_id[\"6583142\"]\n  #=&gt; {:ID=&gt;\"6583142\", \"number\"=&gt;\"123214\", \"start_date\"=&gt;\"2018-10-03\"}\n</code></pre>\n\n<p>If desired, the pairs hashes having the same <code>ID</code> could be merged, but it is not really necessary.</p>\n\n<pre><code>customers_by_id.keys.each_with_object({}) { |k,h|\n  h[k] = customers_by_id[k].merge(claims_by_id[k]) }\n  #=&gt; {\"6583142\"=&gt;{:\"Last Name\"=&gt;\"Hardplace\", :\"First Name\"=&gt;\"Rockina\",\n  #                :ID=&gt;\"6583142\", \"number\"=&gt;\"123214\", \"start_date\"=&gt;\"2018-10-03\"},\n  #    \"6583143\"=&gt;{:\"Last Name\"=&gt;\"Bebblebrox\", :\"First Name\"=&gt;\"Zaphod\",\n  #                :ID=&gt;\"6583143\", \"number\"=&gt;\"123215\", \"start_date\"=&gt;\"2018-10-04\"}}\n</code></pre>\n\n<p>The calculation of <code>adj_claims</code> is needed because the ID is represented by a symbol in <code>customers</code> and by a string in <code>claims</code>. See <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-transform_keys\" rel=\"nofollow noreferrer\">Hash#transform_keys</a>. It is a symbol in <code>adj_claims</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 10364550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0f8aeafbad2485927832513d5b0edc?s=128&d=identicon&r=PG&f=1", "display_name": "ruuddevil", "link": "https://stackoverflow.com/users/10364550/ruuddevil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1541544371, "creation_date": 1541536622, "last_edit_date": 1541541327, "question_id": 53179635, "link": "https://stackoverflow.com/questions/53179635/matching-objects-from-two-separate-arrays-based-on-a-key-value", "title": "Matching objects from two separate arrays based on a key value", "body": "<p>I have two arrays. One is filled with objects of customer information and the other is objects of insurance claims. </p>\n\n<pre><code>customer = [{\"Last Name\":\"lastname\", \"First Name\":\"firstname\", \"ID\":\"6583142\"}]\n\nclaim = [{\"ID\"=&gt;\"6583142\", \"number\"=&gt;\"123214\", \"start_date\"=&gt;\"2018-10-03\"}]\n</code></pre>\n\n<p>The goal is to match each claim to a customer. I understand how to see if an ID from one exists in the other, but how would I associate the two? I don't believe putting the matched claims somewhere else makes sense because in the next part each claim needs to be accepted or declined whether they are matched or not.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "ruby-on-rails-5", "font-awesome"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10614966, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-R7o9Qavj0Do/AAAAAAAAAAI/AAAAAAAAAAc/uF5fpHB2GNU/photo.jpg?sz=128", "display_name": "StartsAtZero", "link": "https://stackoverflow.com/users/10614966/startsatzero"}, "edited": false, "score": 0, "creation_date": 1541563016, "post_id": 53180423, "comment_id": 93256709, "body": "This worked for me! I deleted the version number and it installed successfully. Thanks!"}], "tags": [], "owner": {"reputation": 114, "user_id": 2864020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517490e1eca158d687aa5a46e803b8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Fran&#231;ois F", "link": "https://stackoverflow.com/users/2864020/fran%c3%a7ois-f"}, "is_accepted": true, "score": 0, "last_activity_date": 1541540231, "creation_date": 1541540231, "answer_id": 53180423, "question_id": 53178651, "link": "https://stackoverflow.com/questions/53178651/bundle-install-issues-after-adding-gem-font-awesome-rails/53180423#53180423", "title": "Bundle Install Issues after adding gem &quot;font-awesome-rails&quot;", "body": "<p>The problem is the following constraint:</p>\n\n<pre><code>gem \"font-awesome-rails\", '4.2.0'\n</code></pre>\n\n<p>As the following part explains: </p>\n\n<pre><code>font-awesome-rails (= 4.2.0) was resolved to 4.2.0.0, which depends on\n  railties (&lt; 5.0, &gt;= 3.2)\n</code></pre>\n\n<p>the version 4.2 of <code>font-awesome-rails</code> requires Rails &lt; 5.0, but you are using Rails 5.2.0, so bundler does not know what to do (you can't have several versions of a given gem). </p>\n\n<p>The solution is to us a versionless gem declaration:</p>\n\n<pre><code>gem \"font-awesome-rails\"\n</code></pre>\n\n<p>Don't worry about the version of that gem, bundler is smart enough to give you the latest compatible version!</p>\n\n<p>Note : You could also use <a href=\"https://robots.thoughtbot.com/rubys-pessimistic-operator\" rel=\"nofollow noreferrer\">the pessimistic operator</a>, as in : </p>\n\n<pre><code>gem \"font-awesome-rails\", '~&gt; 4.2'\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10614966, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-R7o9Qavj0Do/AAAAAAAAAAI/AAAAAAAAAAc/uF5fpHB2GNU/photo.jpg?sz=128", "display_name": "StartsAtZero", "link": "https://stackoverflow.com/users/10614966/startsatzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 53180423, "answer_count": 1, "score": 0, "last_activity_date": 1541540231, "creation_date": 1541532227, "last_edit_date": 1541532851, "question_id": 53178651, "link": "https://stackoverflow.com/questions/53178651/bundle-install-issues-after-adding-gem-font-awesome-rails", "title": "Bundle Install Issues after adding gem &quot;font-awesome-rails&quot;", "body": "<p>I am using a tutorial from Udemy to create a web app and I am using the cloud9 IDE.  Everything was working fine until adding font-awesome.  When trying bundle install after adding the font-awesome gem, I am getting the following errors:</p>\n\n<pre><code>Bundler could not find compatible versions for gem \"activemodel\":\n  In Gemfile:\n    rails (~&gt; 5.2.0) was resolved to 5.2.1.rc1, which depends on\n      activemodel (= 5.2.1.rc1)\n\n    web-console (&gt;= 3.3.0) was resolved to 3.3.0, which depends on\n      activemodel (&gt;= 4.2)\n\nBundler could not find compatible versions for gem \"activesupport\":\n  In Gemfile:\n    jbuilder (~&gt; 2.5) was resolved to 2.8.0, which depends on\n      activesupport (&gt;= 4.2.0)\n\n    rails (~&gt; 5.2.0) was resolved to 5.2.1.rc1, which depends on\n      activesupport (= 5.2.1.rc1)\n\n    spring was resolved to 2.0.2, which depends on\n      activesupport (&gt;= 4.2)\n\nBundler could not find compatible versions for gem \"railties\":\n  In Gemfile:\n    coffee-rails (~&gt; 4.2) was resolved to 4.2.2, which depends on\n      railties (&gt;= 4.0.0)\n\n    font-awesome-rails (= 4.2.0) was resolved to 4.2.0.0, which depends on\n      railties (&lt; 5.0, &gt;= 3.2)\n\n    jquery-rails was resolved to 4.3.3, which depends on\n      railties (&gt;= 4.2.0)\n\n    rails (~&gt; 5.2.0) was resolved to 5.2.1.rc1, which depends on\n      railties (= 5.2.1.rc1)\n\n    sass-rails (~&gt; 5.0) was resolved to 5.0.7, which depends on\n      railties (&lt; 6, &gt;= 4.0.0)\n\n    web-console (&gt;= 3.3.0) was resolved to 3.3.0, which depends on\n      railties (&gt;= 4.2)\n</code></pre>\n\n<p><strong>Here are my current gem files:</strong></p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.4.1'\n\ngem 'rails', '~&gt; 5.2.0'\n\ngem 'sqlite3', group: [:development, :test]\n\n\ngem 'bootstrap-sass', '~&gt; 3.3.7'\n\ngem \"font-awesome-rails\", '4.2.0'\n\n\ngem 'jquery-rails'\n\ngroup :production do\n  gem 'pg'\n  gem 'rails_12factor'\n\nend\n\n\ngem 'puma', '~&gt; 3.11'\n\ngem 'sass-rails', '~&gt; 5.0'\n\ngem 'uglifier', '&gt;= 1.3.0'\n\ngem 'coffee-rails', '~&gt; 4.2'\n\ngem 'turbolinks', '~&gt; 5'\n\ngem 'jbuilder', '~&gt; 2.5'\n\ngem 'bootsnap', '&gt;= 1.1.0', require: false\n\ngroup :development, :test do\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\nend\n\ngroup :development do\n  gem 'web-console', '&gt;= 3.3.0'\n\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n\n  gem 'spring'\n\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\ngroup :test do\n\n  gem 'capybara', '&gt;= 2.15', '&lt; 4.0'\n\n  gem 'selenium-webdriver'\n\n  gem 'chromedriver-helper'\nend\n\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>So after searching similar issues, I have tried deleting my gemlock file and running bundle update, but it hasn't worked.  Attempting to run my server just gives me an error that 'font-awesome-rails' bundle needs to be installed first.</p>\n\n<p>Also apologies for formatting, it's my first question here. Any help is appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "actionmailer", "mailer"], "comments": [{"owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 0, "creation_date": 1541532407, "post_id": 53178436, "comment_id": 93247395, "body": "You can override the default configuration at run time:  <a href=\"https://guides.rubyonrails.org/action_mailer_basics.html#sending-emails-with-dynamic-delivery-options\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 10558615, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CuvibfwRxOE/AAAAAAAAAAI/AAAAAAAAABo/knT0DDDHzsk/photo.jpg?sz=128", "display_name": "Anand Joel", "link": "https://stackoverflow.com/users/10558615/anand-joel"}, "reply_to_user": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 0, "creation_date": 1541534866, "post_id": 53178436, "comment_id": 93248526, "body": "I need both the smtp details at run time. Because when the one fails it should delivery from other smtp settings."}], "owner": {"reputation": 1, "user_id": 10558615, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CuvibfwRxOE/AAAAAAAAAAI/AAAAAAAAABo/knT0DDDHzsk/photo.jpg?sz=128", "display_name": "Anand Joel", "link": "https://stackoverflow.com/users/10558615/anand-joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541531327, "creation_date": 1541531327, "question_id": 53178436, "link": "https://stackoverflow.com/questions/53178436/add-actionmailer-with-multiple-smtp-servers-in-rails-application", "title": "Add ActionMailer with multiple SMTP servers in rails application", "body": "<p>I have a need to use two different smtp servers in a Rails application. It appears that the way ActionMailer is constructed, it is not possible to have different smtp_settings for a subclass. Does anyone have a solution/plugin for something like this?</p>\n\n<p>Ideally I would like to have</p>\n\n<p>If the user entered smtp details has some error with password then other default smtp should be used in the application to send the mail to the customer.</p>\n\n<p>Can anyone suggest me?</p>\n"}, {"tags": ["ruby", "graphql", "graphql-ruby"], "answers": [{"comments": [{"owner": {"reputation": 847, "user_id": 165148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f34456a3185482f40099b7380f085b90?s=128&d=identicon&r=PG", "display_name": "RMK", "link": "https://stackoverflow.com/users/165148/rmk"}, "edited": false, "score": 0, "creation_date": 1542081275, "post_id": 53252850, "comment_id": 93429937, "body": "I like your solution better than the one I ended up with.  I would rather not have the conversion logic in the type definition."}], "tags": [], "owner": {"reputation": 139, "user_id": 2807555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Fn1So.png?s=128&g=1", "display_name": "wintheday", "link": "https://stackoverflow.com/users/2807555/wintheday"}, "is_accepted": true, "score": 2, "last_activity_date": 1541967603, "creation_date": 1541967603, "answer_id": 53252850, "question_id": 53177364, "link": "https://stackoverflow.com/questions/53177364/how-do-i-use-arguments-that-are-passed-to-a-graphql-ruby-field-to-transform-the/53252850#53252850", "title": "How do I use arguments that are passed to a Graphql ruby field to transform the result?", "body": "<p>When you define a resolving method inside of your type definition Graphql Ruby assumes that that method will resolve the value. So at the time your current method <code>def height(unit: nil)</code> is ran it doesn't know what the current height value is because it is expecting you to define it. </p>\n\n<p>Instead what you would want to do is move the resolving method to the model / object returned for the <code>Human</code> type.  For example, in rails you might do this: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/graphql/types/human_type.rb\nclass Types::Human &lt; Types::BaseObject\n\n  field :id, ID, null: false\n  field :height, Int, null: true do\n    argument :unit, String, required: false\n  end\n\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/models/human.rb\nclass Human &lt; ApplicationRecord\n\n  def height(unit: nil)\n    # access to height with self[:height]. \n    # You must use self[:height] so as to access the height property\n    # and not call the method you defined.  Note: This overrides the\n    # getter for height.\n  end\nend\n</code></pre>\n\n<p>GraphQL Ruby will then call <code>.height</code> on the instance of human that is passed to it. </p>\n"}, {"tags": [], "owner": {"reputation": 847, "user_id": 165148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f34456a3185482f40099b7380f085b90?s=128&d=identicon&r=PG", "display_name": "RMK", "link": "https://stackoverflow.com/users/165148/rmk"}, "is_accepted": false, "score": 0, "last_activity_date": 1542081157, "creation_date": 1542081157, "answer_id": 53273528, "question_id": 53177364, "link": "https://stackoverflow.com/questions/53177364/how-do-i-use-arguments-that-are-passed-to-a-graphql-ruby-field-to-transform-the/53273528#53273528", "title": "How do I use arguments that are passed to a Graphql ruby field to transform the result?", "body": "<p>I found that the object being queried is available in resolve method itself</p>\n\n<pre><code>def height(unit: nil)\n  # do some conversion here and return the value you want.\n  self.object.height\nend\n</code></pre>\n"}], "owner": {"reputation": 847, "user_id": 165148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f34456a3185482f40099b7380f085b90?s=128&d=identicon&r=PG", "display_name": "RMK", "link": "https://stackoverflow.com/users/165148/rmk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1833, "favorite_count": 0, "accepted_answer_id": 53252850, "answer_count": 2, "score": 2, "last_activity_date": 1542081157, "creation_date": 1541526896, "question_id": 53177364, "link": "https://stackoverflow.com/questions/53177364/how-do-i-use-arguments-that-are-passed-to-a-graphql-ruby-field-to-transform-the", "title": "How do I use arguments that are passed to a Graphql ruby field to transform the result?", "body": "<p>I am looking to do something similar to what is done in the graphql tutorial: <a href=\"https://graphql.org/learn/queries/#arguments\" rel=\"nofollow noreferrer\">https://graphql.org/learn/queries/#arguments</a></p>\n\n<p>I want to pass feet/meters to a scaler field to transform the result that is returned.  </p>\n\n<pre><code>{\n  human(id: \"1000\") {\n    name\n    height(unit: FOOT)\n  }\n}\n</code></pre>\n\n<p>I can't figure out how to do that in ruby using graphql-ruby.</p>\n\n<p>I currently have a type that looks like:</p>\n\n<pre><code>class Types::Human &lt; Types::BaseObject\n\n  field :id, ID, null: false\n  field :height, Int, null: true do\n     argument :unit, String, required: false\n  end\n\n  def height(unit: nil)\n\n  #what do I do here to access the current value of height so I can use unit to transform the result?\n\n  end\nend\n</code></pre>\n\n<p>I have found that the resolver method (height) is called for every instance that is returned... but I don't know how to access the current value.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1541530874, "post_id": 53177162, "comment_id": 93246670, "body": "I am not great with JS but in your js view, there is an error. You use <code>forum_post.id</code> instead of <code>@forum_post.id</code>. otherwise in your <code>format.js</code> you can explicitly pass a view to render. This is in case your structure is unusual and the default <code>create.js.erb</code> is not automatically found."}, {"owner": {"reputation": 2492, "user_id": 5085788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bWlXI.jpg?s=128&g=1", "display_name": "luisenrike", "link": "https://stackoverflow.com/users/5085788/luisenrike"}, "edited": false, "score": 0, "creation_date": 1541531018, "post_id": 53177162, "comment_id": 93246729, "body": "What does your console show when you click the link? It should say something like <code>Processing by LikesController#create as JS</code>"}, {"owner": {"reputation": 320, "user_id": 6501234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e980b8b7894381f8d85eb060b7b0cbf?s=128&d=identicon&r=PG", "display_name": "Corey Gibson", "link": "https://stackoverflow.com/users/6501234/corey-gibson"}, "edited": false, "score": 0, "creation_date": 1541531197, "post_id": 53177162, "comment_id": 93246803, "body": "How can I define the location?"}, {"owner": {"reputation": 320, "user_id": 6501234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e980b8b7894381f8d85eb060b7b0cbf?s=128&d=identicon&r=PG", "display_name": "Corey Gibson", "link": "https://stackoverflow.com/users/6501234/corey-gibson"}, "edited": false, "score": 0, "creation_date": 1541531234, "post_id": 53177162, "comment_id": 93246818, "body": "No template found for ForumThreads::ForumPosts::LikesController#create, head :no_content . is what the console shows, everything else is normal"}, {"owner": {"reputation": 320, "user_id": 6501234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e980b8b7894381f8d85eb060b7b0cbf?s=128&d=identicon&r=PG", "display_name": "Corey Gibson", "link": "https://stackoverflow.com/users/6501234/corey-gibson"}, "edited": false, "score": 0, "creation_date": 1541532536, "post_id": 53177162, "comment_id": 93247456, "body": "I was able to get most of the way through the problem by passing format.js { render &#39;path/to/file&#39; } now my pages js isn&#39;t updating but i see the correct retun in the dev console"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1541545413, "post_id": 53177162, "comment_id": 93252962, "body": "@CoreyGibson What do you mean by &quot;normal&quot;? Your question is more clear if you can &quot;demonstrate&quot; that it&#39;s normal, rather than telling us on faith. Do your controllers do anything unusual with <a href=\"https://apidock.com/rails/ActionController/Base/append_view_path/class\" rel=\"nofollow noreferrer\"><code>append_view_path</code></a>? What is the value of <a href=\"https://apidock.com/rails/ActionController/Base/view_paths\" rel=\"nofollow noreferrer\"><code>view_paths</code></a> in that controller?"}], "owner": {"reputation": 320, "user_id": 6501234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e980b8b7894381f8d85eb060b7b0cbf?s=128&d=identicon&r=PG", "display_name": "Corey Gibson", "link": "https://stackoverflow.com/users/6501234/corey-gibson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 908, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541525979, "creation_date": 1541525979, "question_id": 53177162, "link": "https://stackoverflow.com/questions/53177162/no-template-found-for-somecontrollercreate-rendering-head-no-content", "title": "No template found for SomeController#create rendering head :no_content", "body": "<p>I am building a rails app that creates a like(create) or unlike(destroy), on a link click with a remote: true ajax request</p>\n\n<p>The Post goes through and the transaction is committed but the the js response is not going through and I receive a Error in the server console</p>\n\n<pre><code>No template found for ForumThreads::ForumPosts::LikesController#create, head :no_content\n</code></pre>\n\n<p>the view structure is</p>\n\n<pre><code>forum_threds/show.html.haml\n....\n  = render @forum_thread.forum_posts\n....\n</code></pre>\n\n<p>to render a view of every post that is in the thread\nthan</p>\n\n<pre><code>forum_posts/_forum_post.html.haml\n....\n  %div{id: \"fourm_post_#{forum_post.id}\" }\n  = render partial: \"forum_posts/likes\", locals: { post: forum_post }\n....\n</code></pre>\n\n<p>which is rendering </p>\n\n<pre><code>forum_posts/_likes.html.haml\n- if user_signed_in? &amp;&amp; current_user.likes?(post)\n  = link_to \"UnLike\", forum_post_likes_path(post), method: :delete, \n    remote: true\n- else\n  = link_to \"Like\", forum_post_likes_path(post), method: :post, remote: \n    true\n</code></pre>\n\n<p>and my controller is </p>\n\n<pre><code>class ForumThreads::ForumPosts::LikesController &lt; ApplicationController\n  before_action :authenticate_user!\n  before_action :set_forum_post\n  before_action :set_forum_thread\n\n  def create\n    @forum_post.likes.where(user_id: current_user.id).first_or_create\n\n    respond_to do |format|\n      format.js\n      format.html { redirect_to @forum_thread}\n    end\n  end\n\n  def destroy\n    @forum_post.likes.where(user_id: current_user.id).destroy_all\n\n    respond_to do |format|\n      format.js\n      format.html { redirect_to @forum_thread}\n    end\n  end\n\n  private\n\n  def set_forum_thread\n    @forum_thread = ForumThread.find(@forum_post.forum_thread_id)\n  end\n\n  def set_forum_post\n    @forum_post = ForumPost.find(params[:forum_post_id])\n  end\nend\n</code></pre>\n\n<p>With remote: false this works as expected with the page reload but when i put remote: true I receive the no template error</p>\n\n<p>my file structure for the views</p>\n\n<ul>\n<li>forum_threads/\n\n<ul>\n<li>show.html.haml</li>\n<li>forum_posts/\n\n<ul>\n<li>show.html.haml</li>\n<li>_likes.html.haml</li>\n<li>likes/\n\n<ul>\n<li>create.js.erb</li>\n<li>destroy.js.erb</li>\n</ul></li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>and the create.js.erb and destroy.js.erb </p>\n\n<pre><code>$(\"#forum_post_&lt;%= forum_post.id %&gt;\").html(&lt;%= j render \n  'forum_posts/likes' %&gt;);\n</code></pre>\n\n<p>but i know that this file isn't even being called</p>\n\n<p>is there a way from the format.js that i may be able to call the file i need directly? or something?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "edited": false, "score": 0, "creation_date": 1541526108, "post_id": 53177183, "comment_id": 93244326, "body": "Had to change it to this (but then it works great!)   <code>snapshot_json[&quot;shareholders&quot;].sum { |x| x[&quot;ownership_percentage&quot;].to_f }</code>  Thank you!"}, {"owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "edited": false, "score": 0, "creation_date": 1541526145, "post_id": 53177183, "comment_id": 93244348, "body": "Not 100% sure on what it does - will search for that syntax and read up in the Ruby docs. Edit: saw your update now, will read up on that thanks again!"}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 1, "last_activity_date": 1541526220, "last_edit_date": 1541526220, "creation_date": 1541526036, "answer_id": 53177183, "question_id": 53177055, "link": "https://stackoverflow.com/questions/53177055/summarise-all-values-for-a-particular-key-in-json-in-ruby/53177183#53177183", "title": "Summarise all values for a particular key in JSON in Ruby", "body": "<p>You'll have to pass a block to <a href=\"https://ruby-doc.org/core-2.5.1/Array.html#method-i-sum\" rel=\"nofollow noreferrer\">Array#sum</a> on your <code>shareholders</code> array</p>\n\n<pre><code>snapshot_json[\"shareholders\"].sum { |x| x[\"ownership_percentage\"].to_f }\n</code></pre>\n"}], "owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 53177183, "answer_count": 1, "score": 0, "last_activity_date": 1541526220, "creation_date": 1541525522, "last_edit_date": 1541526034, "question_id": 53177055, "link": "https://stackoverflow.com/questions/53177055/summarise-all-values-for-a-particular-key-in-json-in-ruby", "title": "Summarise all values for a particular key in JSON in Ruby", "body": "<p>I have the following json stored in a column in my database. I'm using this JSON to populate a table in one of my views which works great. What I'm now trying to do is <strong>calculate a sum</strong> of all of the values for a particular key --> sum of every (\"<code>ownership_percentage</code>\") for each \"<code>shareholder</code>\".</p>\n\n<pre><code>{\n   \"captable\":{\n      \"id\":28,\n      \"version\":1,\n      \"name\":\"CapTable\",\n      \"company_id\":22,\n      \"created_at\":\"2018-10-31T18:56:03.965Z\",\n      \"updated_at\":\"2018-10-31T18:57:30.626Z\",\n      \"total_stocks_in_company\":\"400.0\"\n   },\n   \"event\":{\n      \"status_locked\":null,\n      \"id\":51,\n      \"price_per_share\":\"1000.0\",\n      \"total_company_stocks_after_event\":\"400.0\",\n      \"name\":\"2nd event \",\n      \"date\":\"2018-10-31\",\n      \"currency\":\"SEK\",\n      \"valuation\":\"400000.0\",\n      \"created_at\":\"2018-10-31T18:57:17.282Z\",\n      \"updated_at\":\"2018-10-31T18:57:30.676Z\",\n      \"captable_id\":28,\n      \"company_id\":22,\n      \"snapshot\":\"{\\\"captable\\\":{\\\"id\\\":28,\\\"total_stocks_in_company\\\":\\\"400.0\\\",\\\"version\\\":1,\\\"name\\\":\\\"CapTable\\\",\\\"company_id\\\":22,\\\"created_at\\\":\\\"2018-10-31T18:56:03.965Z\\\",\\\"updated_at\\\":\\\"2018-10-31T18:57:30.626Z\\\"},\\\"event\\\":{\\\"status_locked\\\":null,\\\"id\\\":51,\\\"price_per_share\\\":\\\"1000.0\\\",\\\"total_company_stocks_after_event\\\":\\\"400.0\\\",\\\"name\\\":\\\"2nd event \\\",\\\"date\\\":\\\"2018-10-31\\\",\\\"currency\\\":\\\"SEK\\\",\\\"valuation\\\":\\\"400000.0\\\",\\\"created_at\\\":\\\"2018-10-31T18:57:17.282Z\\\",\\\"updated_at\\\":\\\"2018-10-31T18:57:30.665Z\\\",\\\"captable_id\\\":28,\\\"company_id\\\":22,\\\"snapshot\\\":null},\\\"shareholders\\\":[{\\\"id\\\":52,\\\"shareholder\\\":\\\"Peter\\\",\\\"name\\\":\\\"Peter\\\",\\\"number_of_stocks\\\":\\\"100.0\\\",\\\"company_id\\\":22,\\\"created_at\\\":\\\"2018-10-31T18:55:42.730Z\\\",\\\"updated_at\\\":\\\"2018-10-31T18:57:30.637Z\\\",\\\"ownership_percentage\\\":\\\"0.25\\\",\\\"email\\\":\\\"\\\",\\\"telephone\\\":\\\"\\\"},{\\\"id\\\":53,\\\"shareholder\\\":\\\"Jane\\\",\\\"name\\\":\\\"Jane\\\",\\\"number_of_stocks\\\":\\\"100.0\\\",\\\"company_id\\\":22,\\\"created_at\\\":\\\"2018-10-31T18:55:49.490Z\\\",\\\"updated_at\\\":\\\"2018-10-31T18:57:30.644Z\\\",\\\"ownership_percentage\\\":\\\"0.25\\\",\\\"email\\\":\\\"\\\",\\\"telephone\\\":\\\"\\\"},{\\\"id\\\":54,\\\"shareholder\\\":\\\"Sally\\\",\\\"name\\\":\\\"Sally \\\",\\\"number_of_stocks\\\":\\\"200.0\\\",\\\"company_id\\\":22,\\\"created_at\\\":\\\"2018-10-31T18:55:56.192Z\\\",\\\"updated_at\\\":\\\"2018-10-31T18:57:30.651Z\\\",\\\"ownership_percentage\\\":\\\"0.5\\\",\\\"email\\\":\\\"\\\",\\\"telephone\\\":\\\"\\\"}]}\"\n   },\n   \"shareholders\":[\n      {\n         \"id\":52,\n         \"shareholder\":\"Peter\",\n         \"name\":\"Peter\",\n         \"number_of_stocks\":\"50.0\",\n         \"company_id\":22,\n         \"created_at\":\"2018-10-31T18:55:42.730Z\",\n         \"updated_at\":\"2018-10-31T18:58:31.406Z\",\n         \"ownership_percentage\":\"0.125\",\n         \"email\":\"\",\n         \"telephone\":\"\"\n      },\n      {\n         \"id\":53,\n         \"shareholder\":\"Jane\",\n         \"name\":\"Jane\",\n         \"number_of_stocks\":\"150.0\",\n         \"company_id\":22,\n         \"created_at\":\"2018-10-31T18:55:49.490Z\",\n         \"updated_at\":\"2018-10-31T18:58:31.410Z\",\n         \"ownership_percentage\":\"0.375\",\n         \"email\":\"\",\n         \"telephone\":\"\"\n      },\n      {\n         \"id\":54,\n         \"shareholder\":\"Sally\",\n         \"name\":\"Sally \",\n         \"number_of_stocks\":\"200.0\",\n         \"company_id\":22,\n         \"created_at\":\"2018-10-31T18:55:56.192Z\",\n         \"updated_at\":\"2018-10-31T18:57:30.651Z\",\n         \"ownership_percentage\":\"0.5\",\n         \"email\":\"\",\n         \"telephone\":\"\"\n      }\n   ]\n}\n</code></pre>\n\n<p>Just to add another layer - the ownership_percentage is a string, so that need to be converted into either a decimal/float before performing the sum so that one liner is getting a bit long :) </p>\n\n<p>What I'd like to achieve is the following (pseudocode) but I'm having trouble finding a one liner that works well for me. Would love a push in the right direction here!</p>\n\n<pre><code>&lt;td&gt; &lt;%= snapshot_json[\"shareholders\"][\"ownership_percentage\"].to_f.sum %&gt; &lt;/td&gt;\n</code></pre>\n\n<p><em>Note: The ownership_percentage in this example should summarise up to 1.0 (i.e. 100%).</em>  </p>\n"}, {"tags": ["ruby", "performance", "sqlite"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1541520858, "post_id": 53175594, "comment_id": 93241418, "body": "The biggest thing is using transactions that encompass multiple inserts. Some good reading: <a href=\"https://stackoverflow.com/questions/1711631/improve-insert-per-second-performance-of-sqlite\" title=\"improve insert per second performance of sqlite\">stackoverflow.com/questions/1711631/&hellip;</a> (just ignore the C API specific bits or figure out how they map to Ruby&#39;s bindings)."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 4, "creation_date": 1541522265, "post_id": 53175594, "comment_id": 93242246, "body": "I would argue that SQLite might not be the best choice when it comes to SQL database engines for production load. Did you consider PostgreSQL or MySQL for your production environment?"}, {"owner": {"reputation": 37, "user_id": 3797760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09980727fe7eff2c124db82cb36c5838?s=128&d=identicon&r=PG&f=1", "display_name": "user3797760", "link": "https://stackoverflow.com/users/3797760/user3797760"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1541583250, "post_id": 53175594, "comment_id": 93262862, "body": "@Shawn you killing me.. 50k inserts in 6 milliseconds. Thank you for that awesome guide!"}], "owner": {"reputation": 37, "user_id": 3797760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09980727fe7eff2c124db82cb36c5838?s=128&d=identicon&r=PG&f=1", "display_name": "user3797760", "link": "https://stackoverflow.com/users/3797760/user3797760"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541520251, "creation_date": 1541520251, "question_id": 53175594, "link": "https://stackoverflow.com/questions/53175594/ruby-writing-big-files-into-sqlite-database-needs-more-speed", "title": "Ruby - Writing big files into SQLITE Database needs more speed", "body": "<p>My companie has lots of very big files. \nTextfiles, CVS tables and so forth.\nI want to write a programm that reads all the contents from the file, line by line and write it into a SQLite Database.</p>\n\n<p>The Program works exactly like it should.\nBut it is too slow.\nIt writes 50.000 Entries in almost 2 Minutes.\nBut the files it have to deal with, if I will use it in production, have over 10.000.000 entries. Some of them twice as much.</p>\n\n<p>Wich means I need to speed things up. \nHere is the program:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>require 'sqlite3'\nrequire 'benchmark'\nsystem(\"clear\")\n\n\n    db = SQLite3::Database.open \"./database/BenchmarkBase.db\"\n    counter = 0\n      bench = Benchmark.measure {\n\n\n          theFile = File.open(\"/root/Downloads/test/cellphoneNumbers.txt\", 'r').each do |line|\n            begin\n              db.execute \"INSERT INTO PhoneN(cellPhone) VALUES ('#{line}')\"\n              print \"Entry: \"\n              print counter += 1\n              print \" .. has been written into database.\" + \"\\r\"\n\n\n            rescue SQLite3::Exception =&gt; e\n\n              puts \"Exception occurred\"\n              puts e\n\n            end\n          end\n\n      }\n    puts \"time consumption: #{bench.real}\"\n    db.close if db\n</code></pre>\n\n<p>Forking this process have litteraly no performance boost. (or mybe I did it wrong.)\nso if anyone has a good idea how I can make the progress faster, please dont hesitate to tell me.</p>\n\n<p>Thank you in advance, VB</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "plugins", "discourse"], "comments": [{"owner": {"reputation": 646, "user_id": 6695861, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/845e32a9576a6670db748fb456c089e8?s=128&d=identicon&r=PG&f=1", "display_name": "P. Boro", "link": "https://stackoverflow.com/users/6695861/p-boro"}, "edited": false, "score": 0, "creation_date": 1541515470, "post_id": 53173668, "comment_id": 93238128, "body": "Please provide some code or more info. What is this plugin? How do you integrate it with discourse?"}, {"owner": {"reputation": 591, "user_id": 4967624, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/826fe02512bf70b2dd35757873c8321a?s=128&d=identicon&r=PG", "display_name": "JuliSmz", "link": "https://stackoverflow.com/users/4967624/julismz"}, "reply_to_user": {"reputation": 646, "user_id": 6695861, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/845e32a9576a6670db748fb456c089e8?s=128&d=identicon&r=PG&f=1", "display_name": "P. Boro", "link": "https://stackoverflow.com/users/6695861/p-boro"}, "edited": false, "score": 0, "creation_date": 1541516036, "post_id": 53173668, "comment_id": 93238487, "body": "Thanks, I just edited the message."}], "answers": [{"comments": [{"owner": {"reputation": 591, "user_id": 4967624, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/826fe02512bf70b2dd35757873c8321a?s=128&d=identicon&r=PG", "display_name": "JuliSmz", "link": "https://stackoverflow.com/users/4967624/julismz"}, "edited": false, "score": 0, "creation_date": 1541530527, "post_id": 53174498, "comment_id": 93246482, "body": "Thanks! That help a lot!"}], "tags": [], "owner": {"reputation": 646, "user_id": 6695861, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/845e32a9576a6670db748fb456c089e8?s=128&d=identicon&r=PG&f=1", "display_name": "P. Boro", "link": "https://stackoverflow.com/users/6695861/p-boro"}, "is_accepted": true, "score": 3, "last_activity_date": 1541516494, "creation_date": 1541516494, "answer_id": 53174498, "question_id": 53173668, "link": "https://stackoverflow.com/questions/53173668/debug-execute-discourse-plugin-from-command-line/53174498#53174498", "title": "Debug / Execute Discourse plugin from command line", "body": "<p>I have never used discourse but it looks like a rails app so you should be able to start rails console via rails c. Then you should be able to run your code like 'WatchCategory.watch_category!'</p>\n"}, {"tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 1, "last_activity_date": 1541519881, "creation_date": 1541519881, "answer_id": 53175487, "question_id": 53173668, "link": "https://stackoverflow.com/questions/53173668/debug-execute-discourse-plugin-from-command-line/53175487#53175487", "title": "Debug / Execute Discourse plugin from command line", "body": "<p>One thing you could do is dial it back to a minute for testing purposes and drop a <code>puts 'Hello World'</code> statement in there.</p>\n\n<p>Then all you need to do is start a Rails console and do: <code>::WatchCategory.watch_category!</code></p>\n\n<p>You should see the <code>Hello World</code> every minute (or however long you dial it back to)</p>\n"}], "owner": {"reputation": 591, "user_id": 4967624, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/826fe02512bf70b2dd35757873c8321a?s=128&d=identicon&r=PG", "display_name": "JuliSmz", "link": "https://stackoverflow.com/users/4967624/julismz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 53174498, "answer_count": 2, "score": 2, "last_activity_date": 1541519881, "creation_date": 1541513641, "last_edit_date": 1541516018, "question_id": 53173668, "link": "https://stackoverflow.com/questions/53173668/debug-execute-discourse-plugin-from-command-line", "title": "Debug / Execute Discourse plugin from command line", "body": "<p>I'm programming a new plugin in discourse and need to output some information to know if I'm in the right way.</p>\n\n<p>There is some way (With rake or something) to manually run the plugin and see what happen?</p>\n\n<p>Sidekiq don't show any output...</p>\n\n<p>Thanks!</p>\n\n<p><strong>Edit 1</strong>\nThe plugin force some users to watch categories... And run each 1 hour. I can see it in Sidekiq.</p>\n\n<pre><code>module ::WatchCategory\n\n  def self.watch_category!\n    //The logic, foreach, etc...\n  end\nend\n\nafter_initialize do\n  module ::WatchCategory\n    class WatchCategoryJob &lt; ::Jobs::Scheduled\n      every 1.hours\n\n      def execute(args)\n        WatchCategory.watch_category!\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["json", "ruby", "rest", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 2072, "user_id": 853065, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aa14452cb8fbbc5b22c10c567ce710d8?s=128&d=identicon&r=PG", "display_name": "yoones", "link": "https://stackoverflow.com/users/853065/yoones"}, "is_accepted": true, "score": 1, "last_activity_date": 1541513375, "last_edit_date": 1541513375, "creation_date": 1541512795, "answer_id": 53173423, "question_id": 53173006, "link": "https://stackoverflow.com/questions/53173006/rails-rest-api-generate-permitted-fields-for-json-input-based-on-models-neste/53173423#53173423", "title": "Rails REST API - Generate permitted fields for json input based on model&#39;s nested associations without hardcoding attributes", "body": "<p>Here's one way to collect nested attribute names:</p>\n\n<pre><code>mod = Restaurant\n\nnested_attributes = mod.nested_attributes_options.keys.each_with_object({}) do |association, hash|\n  hash[:\"#{association}_attributes\"] = association.\n                                       to_s.\n                                       classify.\n                                       constantize.\n                                       send(:attribute_names).\n                                       map(&amp;:to_sym)\nend\nparams.permit(:restaurant).permit(nested_attributes)\n</code></pre>\n\n<p>This code is kinda generic, do not hesitate to adapt it to your specific use-case.</p>\n"}, {"tags": [], "owner": {"reputation": 1125, "user_id": 4619810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0eb263448877b4ea7817dd17fd7523?s=128&d=identicon&r=PG&f=1", "display_name": "houdinisparks", "link": "https://stackoverflow.com/users/4619810/houdinisparks"}, "is_accepted": false, "score": 0, "last_activity_date": 1543762332, "creation_date": 1543762332, "answer_id": 53581384, "question_id": 53173006, "link": "https://stackoverflow.com/questions/53173006/rails-rest-api-generate-permitted-fields-for-json-input-based-on-models-neste/53581384#53581384", "title": "Rails REST API - Generate permitted fields for json input based on model&#39;s nested associations without hardcoding attributes", "body": "<p>To improve on yoones answer, here is a way to collect all deeply nested attribute names recursively using reflections :</p>\n\n<pre><code>  def get_nested_attributes(model, _attributes = [])\n\n    # base case\n    if model.nested_attributes_options.empty?\n      nil\n\n    # recurse deeper\n    else\n      associations_list = model.reflect_on_all_associations(:has_one)\n      associations_list = associations_list.push(model.reflect_on_all_associations(:has_many)).flatten\n\n      nested_attributes = associations_list.each_with_object({}) do |association , hash|\n\n        association_model = association.klass.nil? ? association.name.to_s.classify.constantize : association.klass\n\n        # include attributes of association model\n        # { _attributes =&gt; [attributes_1, attribute_2] }\n        attribute_name = :\"#{association.name.to_s}_attributes\"\n        hash[attribute_name] = association_model\n                               .send(:attribute_names)\n                               .map(&amp;:to_sym)\n\n        # recurse deeper into tree, get the result and append\n        # { _attributes =&gt; [attributes_1, attribute_2, { } ] }\n        result = get_nested_attributes(association_model, hash[attribute_name])\n        if !result.nil?\n          hash[attribute_name].push(result)\n        end\n      end\n      nested_attributes\n    end\n  end\n\nmodel = Restaurant\nnested_attributes = get_nested_attributes(model)\nparams.permit(nested_attributes)\n</code></pre>\n"}], "owner": {"reputation": 1125, "user_id": 4619810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0eb263448877b4ea7817dd17fd7523?s=128&d=identicon&r=PG&f=1", "display_name": "houdinisparks", "link": "https://stackoverflow.com/users/4619810/houdinisparks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 53173423, "answer_count": 2, "score": 0, "last_activity_date": 1543762332, "creation_date": 1541511240, "question_id": 53173006, "link": "https://stackoverflow.com/questions/53173006/rails-rest-api-generate-permitted-fields-for-json-input-based-on-models-neste", "title": "Rails REST API - Generate permitted fields for json input based on model&#39;s nested associations without hardcoding attributes", "body": "<p>I'm developing a REST Api for an app's factory generators to allow model instances to be also be created using REST, and I'm wondering how can I permit the nested attributes of the model without hardcoding the attributes.</p>\n\n<p>Suppose I have a model called Restaurant</p>\n\n<pre><code>class Restaurant &lt; ApplicationRecord\n  has_one :cost, dependent: :destroy, inverse_of: :grant\n  has_one :address, dependent: :destroy, inverse_of: :grant\n  has_one :owner, dependent: :destroy, inverse_of: :grant\n\n  accepts_nested_attributes_for :cost, :address, :owner\n  ...\n</code></pre>\n\n<p>where its associations also have its own model attributes, and a factory</p>\n\n<pre><code>FactoryGirl.define do factory :restaurant, class Restaurant do\n\n  after(:create) do |restaurant|\n    restaurant.cost = assign_attributes(attributse_for(:cost_factory))\n    restuarnat.address = assign_attributes(attributes_for(:address_factory))\n    restaurant.owner = assign_attributes(attributes_for(:owner_factory))\n  end\n ...\nend\n</code></pre>\n\n<p>where its nested associations also have its own factory. I am passing a json body through REST api in this format</p>\n\n<pre><code>{\n  \"restaurant\": {\n    \"cost_attributes\": {\n     \"staff\": 123\n     \"tables\": 123\n    }\n}\n</code></pre>\n\n<p>I know I can permit the attributes these way</p>\n\n<pre><code>params.permit(:restaurant)\n      .permit(cost_attributes: [:staff, :tables],\n              address_attributes: [:address_attr_1],\n              owner_attributes: [:owner_attr_1]]\n</code></pre>\n\n<p>but the actual model I'm working on has many associations. It will be painful to hardcode everything. <strong>Is there a way i can permit the parameters coming through instead of hardcoding in my controller?</strong> Currently this is what im thinking</p>\n\n<pre><code>params.permit(Restaurant.nested_attributes_options.keys)\n</code></pre>\n\n<p>but obviously this does not work out.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "activerecord"], "comments": [{"owner": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "edited": false, "score": 0, "creation_date": 1541507928, "post_id": 53171427, "comment_id": 93233748, "body": "Please elaborate why you do not want to do what you did in the bottom. What`s wrong with that?"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "edited": false, "score": 0, "creation_date": 1541509140, "post_id": 53171427, "comment_id": 93234391, "body": "I agree with @UmeshMalhotra you have a conditional so that must live somewhere.  You can either combine them into a single validation, keep like it is, or more it to an external service object but any of those methods will have a conditional."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1541510474, "post_id": 53171427, "comment_id": 93235184, "body": "For what it&#39;s worth, you can implement that specific validation in a single line of code - thus negating the problem of adding additional checks: <code>validates :name, presence: true, length: { is: 10 }, format: { with: &#47;\\Aabc&#47; }</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1541510751, "post_id": 53171427, "comment_id": 93235366, "body": "Also, my advice would be to not think of the above as &quot;re-validating on the same condition&quot;. That&#39;s not what you&#39;re doing. You&#39;re adding a guard clause to the validation. <code>return if name.nil?</code> is a small, perfectly reasonable guard clause - and it does not duplicate the &quot;present and length 10&quot; check made earlier. If you find that the validations are far more convoluted than this, then perhaps there&#39;s a bigger issue with your application design - but I cannot really advise without more details."}], "answers": [{"comments": [{"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "edited": false, "score": 0, "creation_date": 1541506297, "post_id": 53171584, "comment_id": 93232903, "body": "Try <code>p = Product.new</code> and <code>p.valid?</code>. It will trigger a <code>NoMethodError</code>."}], "tags": [], "owner": {"reputation": 1651, "user_id": 7499455, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pALqkvJ9LpE/AAAAAAAAAAI/AAAAAAAAATE/gXYryXAigJg/photo.jpg?sz=128", "display_name": "Ashik Salman", "link": "https://stackoverflow.com/users/7499455/ashik-salman"}, "is_accepted": false, "score": 0, "last_activity_date": 1541506950, "last_edit_date": 1541506950, "creation_date": 1541506038, "answer_id": 53171584, "question_id": 53171427, "link": "https://stackoverflow.com/questions/53171427/how-to-handle-dependant-validations-on-rails/53171584#53171584", "title": "How to handle dependant validations on Rails?", "body": "<pre><code>class Product &lt; ApplicationRecord\n  validates :name, presence: true, length: { is: 10 }\n  validate :name_must_start_with_abc, unless: Proc.new { name.nil? }\n\n  private\n\n  def name_must_start_with_abc\n    unless name.start_with?('abc')\n      self.errors['name'] &lt;&lt; 'must start with \"abc\"'\n    end\n  end\nend\n</code></pre>\n\n<p>Please check <a href=\"https://guides.rubyonrails.org/active_record_validations.html#allow-blank\" rel=\"nofollow noreferrer\">allow_blank</a>, <a href=\"https://guides.rubyonrails.org/active_record_validations.html#allow-nil\" rel=\"nofollow noreferrer\">:allow_nil</a> and <a href=\"https://guides.rubyonrails.org/active_record_validations.html#conditional-validation\" rel=\"nofollow noreferrer\">conditional validation</a> as well for more options.</p>\n"}, {"tags": [], "owner": {"reputation": 646, "user_id": 6695861, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/845e32a9576a6670db748fb456c089e8?s=128&d=identicon&r=PG&f=1", "display_name": "P. Boro", "link": "https://stackoverflow.com/users/6695861/p-boro"}, "is_accepted": false, "score": 1, "last_activity_date": 1541516618, "last_edit_date": 1541516618, "creation_date": 1541516083, "answer_id": 53174378, "question_id": 53171427, "link": "https://stackoverflow.com/questions/53171427/how-to-handle-dependant-validations-on-rails/53174378#53174378", "title": "How to handle dependant validations on Rails?", "body": "<p>I think there is no perfect solution unless you write all your validations as custom methods. Approach I use often:</p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  validates :name, presence: true, length: { is: 10 }\n  validate :name_custom_validator\n\n  private\n\n  def name_custom_validator\n    return if errors.include?(:name)\n\n    # validation code\n  end\nend\n</code></pre>\n\n<p>This way you can add as many validations to <code>:name</code> and if any of them fails your custom validator won't execute. But the problem with this code is that your custom validation method must be last.</p>\n"}], "owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541516618, "creation_date": 1541505397, "question_id": 53171427, "link": "https://stackoverflow.com/questions/53171427/how-to-handle-dependant-validations-on-rails", "title": "How to handle dependant validations on Rails?", "body": "<p>I've some Active Record validations on my model:</p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  validates :name, presence: true, length: { is: 10 }\nend\n</code></pre>\n\n<p>That seems fine. It validates that the field <code>name</code> is not <code>nil</code>, <code>\"\"</code> and that it must have exactly 10 characters. Now, if I want to add a <a href=\"https://guides.rubyonrails.org/active_record_validations.html#custom-validators\" rel=\"nofollow noreferrer\">custom validation</a>, I'd add the <code>validate</code> call:</p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  validates :name, presence: true, length: { is: 10 }\n  validate :name_must_start_with_abc\n\n  private\n\n  def name_must_start_with_abc\n    unless name.start_with?('abc')\n      self.errors['name'] &lt;&lt; 'must start with \"abc\"'\n    end\n  end\nend\n</code></pre>\n\n<p>The problem is: when the <code>name</code> field is <code>nil</code>, the <code>presence_of</code> validation will catch it, but won't stop it from validating using the custom method, <code>name_must_start_with_abc</code>, raising a <code>NoMethodError</code>, as <code>name</code> is <code>nil</code>.</p>\n\n<p>To overcome that, I'd have to add a nil-check on the <code>name_must_start_with_abc</code> method.</p>\n\n<pre><code>def name_must_start_with_abc\n  return if name.nil?\n\n  unless name.start_with?('abc')\n    self.errors['name'] &lt;&lt; 'must start with \"abc\"'\n  end\nend\n</code></pre>\n\n<p>That's what I don't wan't to do, because if I add more \"dependant\" validations, I'd have to re-validate it on each custom validation method.</p>\n\n<p>How to handle dependant validations on Rails? Is there a way to prevent a custom validation to be called if the other validations haven't passed?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "nokogiri", "html-entities"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1541502127, "post_id": 53170531, "comment_id": 93230830, "body": "What is wrong with it? Aren&#39;t they rendered with the same result?"}, {"owner": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1541502302, "post_id": 53170531, "comment_id": 93230914, "body": "No in the file, &amp;#x20B9; is written instead of \u20b9, and I need the xml to transfer data to some other software."}], "answers": [{"tags": [], "owner": {"reputation": 426, "user_id": 8287207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PZ5Cf.jpg?s=128&g=1", "display_name": "Alexey Strizhak", "link": "https://stackoverflow.com/users/8287207/alexey-strizhak"}, "is_accepted": true, "score": 1, "last_activity_date": 1541509290, "creation_date": 1541509290, "answer_id": 53172443, "question_id": 53170531, "link": "https://stackoverflow.com/questions/53170531/how-to-write-html-entities-using-rails-nokogiri-gem/53172443#53172443", "title": "How to write HTML entities using Rails Nokogiri gem?", "body": "<p>use encoding as argument for <code>to_xml</code> method:</p>\n\n<pre><code>irb(main):013:0&gt; Nokogiri::XML::Builder.new { |xml|xml.CURRENCYNAME \"\u20b9\" }.to_xml(encoding: 'UTF-8')\n\n=&gt; \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\\n&lt;CURRENCYNAME&gt;\u20b9&lt;/CURRENCYNAME&gt;\\n\"\n</code></pre>\n"}], "owner": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53172443, "answer_count": 1, "score": 0, "last_activity_date": 1571442985, "creation_date": 1541501951, "last_edit_date": 1571442985, "question_id": 53170531, "link": "https://stackoverflow.com/questions/53170531/how-to-write-html-entities-using-rails-nokogiri-gem", "title": "How to write HTML entities using Rails Nokogiri gem?", "body": "<p>I was using Nokogiri gem to write some xml data.\nI need a tag like this:-</p>\n\n<pre><code>&lt;CURRENCYNAME&gt;\u20b9&lt;/CURRENCYNAME&gt;\n</code></pre>\n\n<p>The problem is that Nokogiri writes symbol code (&#x20B9;) instead of \u20b9. Below is a snippet from my code:-</p>\n\n<pre><code>  data = Nokogiri::XML::Builder.new do |xml|\n          xml.CURRENCYNAME \"\u20b9\"\n         end\n  response.headers[\"file_name\"] = \"Master.xml\"\n  send_data data.to_xml, filename: \"Master.xml\", type: \"application/xml\"\n</code></pre>\n\n<p>Result that I get in my Master.xml file:-</p>\n\n<pre><code>&lt;CURRENCYNAME&gt;&amp;#x20B9;&lt;/CURRENCYNAME&gt;\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "grouping", "nmatrix"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1541500055, "post_id": 53169907, "comment_id": 93229746, "body": "Explain what you mean by &quot;times are sequential&quot;. It is not clear."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1541503726, "post_id": 53169907, "comment_id": 93231629, "body": "Does &quot;sequential&quot; mean they are <i>exactly</i> 1 second apart?"}, {"owner": {"reputation": 1416, "user_id": 8656126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a097761015b0c2b723f22eb4d239b3e6?s=128&d=identicon&r=PG&f=1", "display_name": "richflow", "link": "https://stackoverflow.com/users/8656126/richflow"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1541554122, "post_id": 53169907, "comment_id": 93255072, "body": "@sawa, stefan Sorry, yes, sequential means times are 1 second apart."}, {"owner": {"reputation": 1416, "user_id": 8656126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a097761015b0c2b723f22eb4d239b3e6?s=128&d=identicon&r=PG&f=1", "display_name": "richflow", "link": "https://stackoverflow.com/users/8656126/richflow"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1541554985, "post_id": 53169907, "comment_id": 93255251, "body": "@Stefan edited to defined &#39;sequential&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1541503999, "post_id": 53170242, "comment_id": 93231781, "body": "1) the indices <code>i</code> and <code>j</code> from <code>each_with_index</code> are never used, 2) you shouldn&#39;t use <code>and</code> as a substitute for <code>&amp;&amp;</code>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1541504705, "post_id": 53170242, "comment_id": 93232109, "body": "@Stefan I know I could use <code>_</code>, but I used <code>i</code>, <code>j</code> for clarity. You can easily see that they are indices. That helps later when reading <code>chunk.first[1], chunk.last[1]</code>. It tells what <code>[1]</code> means. And there is nothing wrong with using <code>and</code>. People tend to want to distinguish control sequences from things that return values, but that idea does not make sense in Ruby. Every expression in Ruby has a return value. And using ordinary words like <code>and</code> is easier to read in contexts like this."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 2, "last_activity_date": 1541500865, "creation_date": 1541500865, "answer_id": 53170242, "question_id": 53169907, "link": "https://stackoverflow.com/questions/53169907/ruby-group-non-zero-numbers-and-sequential-times/53170242#53170242", "title": "Ruby group non-zero numbers and sequential times", "body": "<pre><code>t = Time.now\na = [\n  [t + 0, 1],\n  [t + 1, 1],\n  [t + 2, 1],\n  [t + 3, 0],\n  [t + 4, 1],\n  [t + 5, 1],\n  [t + 16, 1],\n  [t + 17, 1],\n]\n\na\n.each_with_index\n.chunk_while{\n  |(x, i), (y, j)|\n  x[1].positive? and\n  y[1].positive? and\n  x[0].to_i.next == y[0].to_i\n}\n.select{|chunk| chunk.length &gt;= 3}\n.map{|chunk| [chunk.first[1], chunk.last[1]]}\n# =&gt; [[0, 2]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1416, "user_id": 8656126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a097761015b0c2b723f22eb4d239b3e6?s=128&d=identicon&r=PG&f=1", "display_name": "richflow", "link": "https://stackoverflow.com/users/8656126/richflow"}, "edited": false, "score": 0, "creation_date": 1541555482, "post_id": 53180241, "comment_id": 93255335, "body": "Thanks for the clear explanation and covering different ruby versions!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1541585281, "last_edit_date": 1541585281, "creation_date": 1541539457, "answer_id": 53180241, "question_id": 53169907, "link": "https://stackoverflow.com/questions/53169907/ruby-group-non-zero-numbers-and-sequential-times/53180241#53180241", "title": "Ruby group non-zero numbers and sequential times", "body": "<pre><code>t = Time.now\narr = [[t+ 0, 1], [t+ 1, 1], [t+ 2, 1], [t+ 3, 0], [t+ 4, 1], [t+ 5, 1], [t+16, 1],\n       [t+18, 1], [t+19, 1], [t+20, 1], [t+21, 1], [t+30, 1]]\n  #=&gt; [[2018-11-06 10:11:52 -0800, 1], [2018-11-06 10:11:53 -0800, 1],...,\n  #    [2018-11-06 10:12:22 -0800, 1]]\n\narr.each_index.\n    slice_when { |i,j| arr[i].last.zero? || arr[i-1].last.zero? ||\n      (arr[i].first - arr[i-1].first &gt; 1) }.\n    each_with_object([]) { |a,b| b &lt;&lt; [a.first, a.last] if a.last-a.first &gt;= 2 }\n  #=&gt; [[0, 2], [7, 10]]\n</code></pre>\n\n<p><a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-slice_when\" rel=\"nofollow noreferrer\">Emumerable#slice_when</a> (new in MRI v2.2) is closely related to <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-chunk_while\" rel=\"nofollow noreferrer\">Enumerable#chunk_while</a> (new in MRI v2.3), which @sawa used in his answer. Generally, if one can be used, the other is an alternative.</p>\n\n<p>To support earlier versions of Ruby one could use <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-slice_before\" rel=\"nofollow noreferrer\">Enumerable#slice_before</a> (new in MRI v1.9.2). </p>\n\n<pre><code>arr.each_index.\n    slice_before { |i| i &gt; 0 &amp;&amp;\n      (arr[i].last.zero? || arr[i-1].last.zero? || (arr[i].first - arr[i-1].first &gt; 1)) }.\n    each_with_object([]) { |a,b| b &lt;&lt; [a.first, a.last] if a.last-a.first &gt;= 2 }\n</code></pre>\n\n<p>Note the intermediate calculation:</p>\n\n<pre><code>enum = arr.each_index.slice_before {|i| i &gt; 0 &amp;&amp;\n  (arr[i].last.zero? || arr[i-1].last.zero? || (arr[i].first - arr[i-1].first &gt; 1)) }\n  #=&gt; =&gt; #&lt;Enumerator: #&lt;Enumerator::Generator:0x0000000001948d50&gt;:each&gt;\nenum.to_a\n  #=&gt; [[0, 1, 2], [3], [4, 5], [6], [7, 8, 9, 10], [11]]\n</code></pre>\n\n<p>(The return value is the same when using <code>slice_when</code>.) If preferred, the clause</p>\n\n<pre><code>each_with_object([]) { |a,b| b &lt;&lt; [a.first, a.last] if a.last-a.first &gt;= 2 }\n</code></pre>\n\n<p>could be replaced with a two-pass alternative:</p>\n\n<pre><code>select { |a| a.last - a.first &gt;= 2 }.map { |a| [a.first, a.last] }\n</code></pre>\n"}], "owner": {"reputation": 1416, "user_id": 8656126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a097761015b0c2b723f22eb4d239b3e6?s=128&d=identicon&r=PG&f=1", "display_name": "richflow", "link": "https://stackoverflow.com/users/8656126/richflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53170242, "answer_count": 2, "score": -1, "last_activity_date": 1541585281, "creation_date": 1541499662, "last_edit_date": 1541554939, "question_id": 53169907, "link": "https://stackoverflow.com/questions/53169907/ruby-group-non-zero-numbers-and-sequential-times", "title": "Ruby group non-zero numbers and sequential times", "body": "<p>I have an array of items like so: <code>[DateTime, value]</code>. I want to group the items which satisfy the following conditions:</p>\n\n<ul>\n<li>A sequence of 3 or more items </li>\n<li>Items contain values which are > 0</li>\n<li>times are sequential (increasing by 1 second)</li>\n</ul>\n\n<p>I want to get the indices of the start and end of the sequences that meet those conditions.</p>\n\n<p>E.g.</p>\n\n<pre><code>[ \n[today 10:00:00, 1],\n[today 10:00:01, 1],\n[today 10:00:02, 1],\n[today 10:00:03, 0],\n[today 10:00:04, 1],\n[today 10:00:05, 1],\n[today 10:00:16, 1],\n[today 10:00:17, 1],\n]\n</code></pre>\n\n<p>Should return:</p>\n\n<pre><code>[ [0,2] ]\n</code></pre>\n\n<p>I had a look at <a href=\"https://github.com/SciRuby/daru\" rel=\"nofollow noreferrer\">Daru</a> and <a href=\"http://sciruby.com/nmatrix/docs/NMatrix.html\" rel=\"nofollow noreferrer\">NMatrix</a> but I couldn't figure out how to do sequential comparisons to do what I want. </p>\n\n<p>Now I've just got a big loop that does a lot of comparisons - is there a better way to do it?</p>\n"}, {"tags": ["ruby", "memory-management", "rest-client"], "comments": [{"owner": {"reputation": 1734, "user_id": 996000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95be255e1690445d23f68ae734af371c?s=128&d=identicon&r=PG", "display_name": "mtrolle", "link": "https://stackoverflow.com/users/996000/mtrolle"}, "edited": false, "score": 0, "creation_date": 1541499125, "post_id": 53169751, "comment_id": 93229233, "body": "This is my example code: <a href=\"https://gist.github.com/mtrolle/96f55822122ecabd3cc46190a6dc18a5\" rel=\"nofollow noreferrer\">gist.github.com/mtrolle/96f55822122ecabd3cc46190a6dc18a5</a>"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1541516899, "post_id": 53169751, "comment_id": 93239000, "body": "when you say &#39;one job&#39; what are you refering to? rake task? active job?"}, {"owner": {"reputation": 1734, "user_id": 996000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95be255e1690445d23f68ae734af371c?s=128&d=identicon&r=PG", "display_name": "mtrolle", "link": "https://stackoverflow.com/users/996000/mtrolle"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1541528428, "post_id": 53169751, "comment_id": 93245469, "body": "It&#39;s actually one run. Normally I would execute this via Rails&#39; ActiveJob, but I&#39;m reproducing the memory issue in the standalone file linked above. As mentioned this is when retrieving just 1 out of 15 days of data with memory consumption raising exponential for each extra day I parse."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1541557629, "post_id": 53169751, "comment_id": 93255706, "body": "You haven&#39;t specified the Ruby version, the host operating system, or the resource being parsed. Additionally, you haven&#39;t provided your full code. (unless you&#39;re downloading the images to memory and then discarding them without any further processing) So the only advice I can give is: don&#39;t use RestClient, which hasn&#39;t been updated in over a year. Use something more commonly used, like <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">httparty</a>."}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1541600536, "post_id": 53169751, "comment_id": 93271412, "body": "I don&#39;t think we&#39;ve proven RestClient is the issue here but I agree, versions and platform would be helpful."}, {"owner": {"reputation": 1734, "user_id": 996000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95be255e1690445d23f68ae734af371c?s=128&d=identicon&r=PG", "display_name": "mtrolle", "link": "https://stackoverflow.com/users/996000/mtrolle"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1541602028, "post_id": 53169751, "comment_id": 93272282, "body": "Sorry - should have added version info, that&#39;s been added now. @anothermh I don&#39;t agree I haven&#39;t provided full code. This works fully and create the memory issue. In reality I do save downloaded image files and store additional meta data using ActiveRecord, but my testing shows it doesn&#39;t add much to the memory consumption, so this test script I created still makes we wonder why Garbage Collection isn&#39;t run."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1541719540, "post_id": 53169751, "comment_id": 93323041, "body": "It\u2019s not going to be possible to help without access to the resource being parsed."}, {"owner": {"reputation": 1734, "user_id": 996000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95be255e1690445d23f68ae734af371c?s=128&d=identicon&r=PG", "display_name": "mtrolle", "link": "https://stackoverflow.com/users/996000/mtrolle"}, "edited": false, "score": 0, "creation_date": 1542204150, "post_id": 53169751, "comment_id": 93484575, "body": "I&#39;ve updated my gist with URL&#39;s so it&#39;s now possible to execute it: <a href=\"https://gist.github.com/mtrolle/96f55822122ecabd3cc46190a6dc18a5\" rel=\"nofollow noreferrer\">gist.github.com/mtrolle/96f55822122ecabd3cc46190a6dc18a5</a> I&#39;ve also tried myself with Ruby 2.5.1 with same high memory consumption results as well as tried on macOS with same result. I&#39;ve also created a HTTParty version here <a href=\"https://gist.github.com/mtrolle/dbd2cdf70f77a83b4178971aa79b6292\" rel=\"nofollow noreferrer\">gist.github.com/mtrolle/dbd2cdf70f77a83b4178971aa79b6292</a> which is actually having a higher memory consumption than RestClient in my tests."}], "answers": [{"comments": [{"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "edited": false, "score": 1, "creation_date": 1543732146, "post_id": 53574813, "comment_id": 94019683, "body": "Nice one Wasif bhai!"}, {"owner": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "edited": false, "score": 0, "creation_date": 1543943712, "post_id": 53574813, "comment_id": 94096801, "body": "you&#39;re most welcome! glad to spread about these awesome gems :)"}], "tags": [], "owner": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "is_accepted": true, "score": 3, "last_activity_date": 1543696979, "last_edit_date": 1543696979, "creation_date": 1543696435, "answer_id": 53574813, "question_id": 53169751, "link": "https://stackoverflow.com/questions/53169751/ruby-memory-usage-gone-wild/53574813#53574813", "title": "Ruby Memory Usage gone wild", "body": "<p>I believe it's all about the http client you are using: <code>Rest-Client</code>. Unfortunately it has some bad reputation of being memory-hungry. You should definitely look for some awesome gem that is both <strong>memory/time efficient</strong>.</p>\n\n<p>I would highly recommend <a href=\"https://github.com/httprb/http\" rel=\"nofollow noreferrer\">HTTP.rb</a> or its http/2 successor <a href=\"https://gitlab.com/honeyryderchuck/httpx\" rel=\"nofollow noreferrer\">HTTPX</a></p>\n\n<p>For a good benchmark, please have a look at this awesome article by the author of another awesome gem <a href=\"https://github.com/shrinerb/shrine\" rel=\"nofollow noreferrer\">Shrine</a>: <a href=\"https://twin.github.io/httprb-is-great/\" rel=\"nofollow noreferrer\">https://twin.github.io/httprb-is-great/</a></p>\n\n<h2>Here is what I found after replacing Rest-Client with HTTP.rb on my local machine:</h2>\n\n<p>Versions: <strong>Ruby: 2.5.3p105, HTTP.rb: 4.0.0, OS: Ubuntu 16.04</strong></p>\n\n<p><strong>Total download size: 96.92Mb</strong> through 118 unique requests. </p>\n\n<p>Memory consumption:</p>\n\n<pre><code>Total allocated: 7107283 bytes (83437 objects)\nTotal retained:  44221 bytes (385 objects)\n</code></pre>\n\n<p>So it allocated only <strong>7Mb</strong> while downloading <strong>96.92Mb</strong> compared to roughly 1Gb using Rest-Client.</p>\n\n<p>Here is the snippet: <a href=\"https://gist.github.com/mtrolle/96f55822122ecabd3cc46190a6dc18a5#gistcomment-2774405\" rel=\"nofollow noreferrer\">https://gist.github.com/mtrolle/96f55822122ecabd3cc46190a6dc18a5#gistcomment-2774405</a></p>\n"}], "owner": {"reputation": 1734, "user_id": 996000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95be255e1690445d23f68ae734af371c?s=128&d=identicon&r=PG", "display_name": "mtrolle", "link": "https://stackoverflow.com/users/996000/mtrolle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 53574813, "answer_count": 1, "score": 4, "last_activity_date": 1543696979, "creation_date": 1541499019, "last_edit_date": 1542204282, "question_id": 53169751, "link": "https://stackoverflow.com/questions/53169751/ruby-memory-usage-gone-wild", "title": "Ruby Memory Usage gone wild", "body": "<p>From a data supplier I download roughly 75 images + 40 pages of details in one job using RestClient.</p>\n\n<p>Goes like this:</p>\n\n<ol>\n<li>Authenticate to suppliers service and set cookie jar in variable</li>\n<li>Download XML</li>\n<li>XML contains roughly 40 assets.</li>\n<li>For each asset download list of images. (Spans from 0-10 images per asset).</li>\n<li>Download images.</li>\n</ol>\n\n<p>My total download size is 148.14Mb in 37.58 seconds through 115 unique requests. My memory consumption is: </p>\n\n<pre><code>Total allocated: 1165532095 bytes (295682 objects)\nTotal retained:  43483 bytes (212 objects)\n</code></pre>\n\n<p>measured with <code>memory_profiler</code> gem. That's just above 1gb of memory to download ~150mb of data?</p>\n\n<p>My big concern is, that I need to download even more data - this is just 1 out of 15 days of data. When I run 2 days of data I double the download size and memory size. When running 3 days of data I triple etc. It even looks like the memory consumption raises exponential until I run out of memory and my server crashes.</p>\n\n<p>Why is Garbage Collection not kicking in here? I've tried running <code>GC.start</code> between each day of data I download, that tricks <code>memory_profiler</code>, but my server still ends up crashing when I add too many days of data.</p>\n\n<p><strong>So my question is:</strong></p>\n\n<ol>\n<li>Why is the memory consumption so high compared to the data I'm actually downloading.</li>\n<li>As I'm overwriting the variables holding the downloaded data between each download, should Garbage Collection then not clear the memory of the former data download?</li>\n<li>Any tips and tricks to keep memory consumption down?</li>\n</ol>\n\n<p><strong>Versions:</strong> Ruby: <em>2.4.4p296</em>, RestClient: <em>2.0.2</em>, OS: <em>Ubuntu 16.04</em></p>\n\n<p>Example code:</p>\n\n<p>Using RestClient: <a href=\"https://gist.github.com/mtrolle/96f55822122ecabd3cc46190a6dc18a5\" rel=\"nofollow noreferrer\">https://gist.github.com/mtrolle/96f55822122ecabd3cc46190a6dc18a5</a></p>\n\n<p>Using HTTParty: <a href=\"https://gist.github.com/mtrolle/dbd2cdf70f77a83b4178971aa79b6292\" rel=\"nofollow noreferrer\">https://gist.github.com/mtrolle/dbd2cdf70f77a83b4178971aa79b6292</a></p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "api", "rendering"], "comments": [{"owner": {"reputation": 1173, "user_id": 9418609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o0aMF.jpg?s=128&g=1", "display_name": "uday", "link": "https://stackoverflow.com/users/9418609/uday"}, "edited": false, "score": 0, "creation_date": 1541498638, "post_id": 53169565, "comment_id": 93228932, "body": "user is unique to all costs or different to each cost?"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 1173, "user_id": 9418609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o0aMF.jpg?s=128&g=1", "display_name": "uday", "link": "https://stackoverflow.com/users/9418609/uday"}, "edited": false, "score": 0, "creation_date": 1541499266, "post_id": 53169565, "comment_id": 93229321, "body": "@UdAY Yea, it looks so."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541499552, "post_id": 53169565, "comment_id": 93229469, "body": "What is association between cost and user ?"}, {"owner": {"reputation": 1173, "user_id": 9418609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o0aMF.jpg?s=128&g=1", "display_name": "uday", "link": "https://stackoverflow.com/users/9418609/uday"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1541499645, "post_id": 53169565, "comment_id": 93229504, "body": "@ray with the data provided it looks so. What if user varies with cost?"}], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 1, "last_activity_date": 1541499240, "creation_date": 1541499240, "answer_id": 53169816, "question_id": 53169565, "link": "https://stackoverflow.com/questions/53169565/how-to-add-item-to-json-object-ruby-on-rails/53169816#53169816", "title": "How to add item to json object ruby on rails?", "body": "<p>Supposing User has_many Costs,</p>\n\n<p>What you provided,</p>\n\n<pre><code>hash =  {\"costs\"=&gt;[{\"id\"=&gt;2, \"cost_name\"=&gt;\"rent office\", \"user_id\"=&gt;2, \"fix\"=&gt;true, \"amount\"=&gt;300300, \"created_at\"=&gt;\"2018-11-05T18:36:19.108+06:00\", \"updated_at\"=&gt;\"2018-11-05T18:36:19.108+06:00\"}, {\"id\"=&gt;3, \"cost_name\"=&gt;\"new computer\", \"user_id\"=&gt;2, \"fix\"=&gt;false, \"amount\"=&gt;350000, \"created_at\"=&gt;\"2018-11-06T14:44:49.805+06:00\", \"updated_at\"=&gt;\"2018-11-06T14:44:49.805+06:00\"}], \"users\"=&gt;[[\"Vi_Ok\", 2]]}\n</code></pre>\n\n<p>Proceed,</p>\n\n<pre><code>costs, users = hash['costs'], hash['users']\ncosts.each { |c| c['user_name'] = users.detect { |u| u[1] == c['user_id'] }[0] }\n</code></pre>\n\n<p>Above will add <code>user_name</code> in each cost hash.</p>\n"}, {"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1541504726, "post_id": 53170608, "comment_id": 93232122, "body": "It is proper approach"}, {"owner": {"reputation": 21, "user_id": 10346578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8a147de453b462608a4762769cfc4b?s=128&d=identicon&r=PG&f=1", "display_name": "Arkhatinho", "link": "https://stackoverflow.com/users/10346578/arkhatinho"}, "edited": false, "score": 0, "creation_date": 1541506342, "post_id": 53170608, "comment_id": 93232919, "body": "After changing: {costs: Cost.cost_list }    to     {costs: Cost.list_cost }   and changing:  cost_info[:user_name] = cost.user.name    to  st_info[:user_name] = User.find(cost.user_id).name all start to work thank you for help!"}], "tags": [], "owner": {"reputation": 1173, "user_id": 9418609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o0aMF.jpg?s=128&g=1", "display_name": "uday", "link": "https://stackoverflow.com/users/9418609/uday"}, "is_accepted": true, "score": 2, "last_activity_date": 1541502292, "creation_date": 1541502292, "answer_id": 53170608, "question_id": 53169565, "link": "https://stackoverflow.com/questions/53169565/how-to-add-item-to-json-object-ruby-on-rails/53170608#53170608", "title": "How to add item to json object ruby on rails?", "body": "<p>You can write a custom method in your model and call it in index action, which returns all the costs with the username like below:  </p>\n\n<pre><code>def self.list_costs\n  cost_list = []\n  costs = Cost.all\n  costs.each do |cost|\n    cost_info = cost.attributes\n    cost_info[:user_name] = cost.user.name\n    cost_list &lt;&lt; cost_info\n  end\n  cost_list\nend  \n\nclass CostsController &lt; ApplicationController\n  def index\n    render json: {costs: Cost.cost_list }\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10346578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8a147de453b462608a4762769cfc4b?s=128&d=identicon&r=PG&f=1", "display_name": "Arkhatinho", "link": "https://stackoverflow.com/users/10346578/arkhatinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "accepted_answer_id": 53170608, "answer_count": 2, "score": 1, "last_activity_date": 1541502292, "creation_date": 1541498373, "question_id": 53169565, "link": "https://stackoverflow.com/questions/53169565/how-to-add-item-to-json-object-ruby-on-rails", "title": "How to add item to json object ruby on rails?", "body": "<p>I want to join items from 2 tables. There output:</p>\n\n<pre><code> \"costs\":[  \n  {  \n     \"id\":2,\n     \"cost_name\":\"rent office\",\n     \"user_id\":2,\n     \"fix\":true,\n     \"amount\":300300,\n     \"created_at\":\"2018-11-05T18:36:19.108+06:00\",\n     \"updated_at\":\"2018-11-05T18:36:19.108+06:00\"\n  },\n  {  \n     \"id\":3,\n     \"cost_name\":\"new computer\",\n     \"user_id\":2,\n     \"fix\":false,\n     \"amount\":350000,\n     \"created_at\":\"2018-11-06T14:44:49.805+06:00\",\n     \"updated_at\":\"2018-11-06T14:44:49.805+06:00\"\n  }\n\n\n ],\n   \"users\":[  \n      [  \n         \"Vi_Ok\",\n         2\n      ]\n   ]\n}\n</code></pre>\n\n<p>I want to add parameter of users (user name which is \"Vi_Ok\") add to every cost. How you noticed there in both table exist userId. Now code looks: </p>\n\n<pre><code>def index\n@costs = Cost.all \n@user_name = @costs.pluck(:user_id)\n@user_name = User.find(@user_name).pluck(:name, :id)\n# @costs.push(\"name\" =&gt; @user_name.pluck(:name) this one just try to add \nrender json: {costs: @costs, name: @user_name}\n</code></pre>\n\n<p>end</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1541496749, "post_id": 53168667, "comment_id": 93227893, "body": "Your problem is in your update / create method. Could you paste the full controller code including any finder methods here please."}, {"owner": {"reputation": 1256, "user_id": 4060732, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a62feb573aed36e5657c6495954ba514?s=128&d=identicon&r=PG", "display_name": "Sajjad Murtaza", "link": "https://stackoverflow.com/users/4060732/sajjad-murtaza"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1541497038, "post_id": 53168667, "comment_id": 93228033, "body": "@Mark I have updated"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 1, "creation_date": 1541497239, "post_id": 53168667, "comment_id": 93228133, "body": "Glad to see that my comment with <code>association_foreign_key</code> has helped to you."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1541497362, "post_id": 53168667, "comment_id": 93228192, "body": "You&#39;re method set_metric_director is what is throwing the error, it is being called every time you hit the update action and it can not find a Metric:MetricDirector with an ID of the param you&#39;re sending through"}, {"owner": {"reputation": 1256, "user_id": 4060732, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a62feb573aed36e5657c6495954ba514?s=128&d=identicon&r=PG", "display_name": "Sajjad Murtaza", "link": "https://stackoverflow.com/users/4060732/sajjad-murtaza"}, "edited": false, "score": 0, "creation_date": 1541497562, "post_id": 53168667, "comment_id": 93228291, "body": "Then what i suppose to do? Could you please bit explain"}], "owner": {"reputation": 1256, "user_id": 4060732, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a62feb573aed36e5657c6495954ba514?s=128&d=identicon&r=PG", "display_name": "Sajjad Murtaza", "link": "https://stackoverflow.com/users/4060732/sajjad-murtaza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541497014, "creation_date": 1541494936, "last_edit_date": 1541497014, "question_id": 53168667, "link": "https://stackoverflow.com/questions/53168667/activerecordrecordnotfound-couldnt-find-model-with-id-62-for-model-with-id-2", "title": "ActiveRecord::RecordNotFound: Couldn&#39;t find Model with ID=62 for Model with ID=2", "body": "<blockquote>\n  <p>Couldn't find MetricLocationHelper with ID=62 for Metric::MetricDirector with ID=2</p>\n</blockquote>\n\n<p>I have <code>has_and_belongs_to_many</code> association and my models are</p>\n\n<pre><code>class MetricLocationHelper &lt; ActiveRecord::Base\n     has_and_belongs_to_many :metric_metric_directors, class_name: \"Metric::MetricDirector\", association_foreign_key: \"metric_metric_director_id\"\nend\n</code></pre>\n\n<p>and </p>\n\n<pre><code>class Metric::MetricDirector &lt; ActiveRecord::Base\n   has_and_belongs_to_many :metric_location_helpers, foreign_key: 'metric_metric_director_id'\n\n   accepts_nested_attributes_for :metric_location_helpers, reject_if: :all_blank, allow_destroy: true\nend\n</code></pre>\n\n<p>My third table columns are</p>\n\n<ul>\n<li>metric_metric_director_id</li>\n<li>metric_location_helper_id</li>\n</ul>\n\n<p>And in controller</p>\n\n<pre><code> def metric_director_params\n   params.require(:metric_metric_director).permit(:name, :username, :region, metric_location_helpers_attributes: [:id, :_destroy])\nend\n</code></pre>\n\n<p>I am facing an issue while updating and creating a record. </p>\n\n<blockquote>\n  <p>ActiveRecord::RecordNotFound in Metric::MetricDirectorsController#update</p>\n  \n  <p>Couldn't find MetricLocationHelper with ID=62 for Metric::MetricDirector with ID=2</p>\n</blockquote>\n\n<p>Updated Code</p>\n\n<pre><code>class Metric::MetricDirectorsController &lt; ApplicationController\n  before_action :set_metric_director, only: [:show, :edit, :update, :destroy]\n\ndef new\n  @metric_director = Metric::MetricDirector.new\n  @locations = @metric_director.metric_location_helpers.build\nend\n\ndef edit\n  @locations = @metric_director.metric_location_helpers\nend\n\ndef create\n  @metric_director = Metric::MetricDirector.new(metric_director_params)\n\n  if @metric_director.save\n    redirect_to metric_metric_directors_path, notice: 'Director was successfully created.'\n  else\n    render :new\n  end\nend\n\ndef update  \n  if @metric_director.update(metric_director_params)\n  redirect_to metric_metric_directors_path, notice: 'Director was successfully updated.'\n  else\n    render :edit\n  end\nend\n\n\nprivate\n\n  def set_metric_director\n    @metric_director = Metric::MetricDirector.find(params[:id])\n  end\n\n\ndef metric_director_params\n   params.require(:metric_metric_director).permit(:name, :username, :region, metric_location_helpers_attributes: [:id, :_destroy])\n\nend\n</code></pre>\n\n<p>your help is greatly appreciated</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 373, "user_id": 10481402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bf7fb58c76b77f15fa297bf523dca4?s=128&d=identicon&r=PG", "display_name": "Jaye Hernandez", "link": "https://stackoverflow.com/users/10481402/jaye-hernandez"}, "edited": false, "score": 1, "creation_date": 1541495408, "post_id": 53168726, "comment_id": 93227281, "body": "Thank you! This is what I was looking for :)"}], "tags": [], "owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "is_accepted": true, "score": 5, "last_activity_date": 1541495168, "creation_date": 1541495168, "answer_id": 53168726, "question_id": 53168654, "link": "https://stackoverflow.com/questions/53168654/rails-uninitialized-constant-inside-controller/53168726#53168726", "title": "Rails: Uninitialized Constant inside Controller", "body": "<p>Try <code>::Test::Dummy::Something</code></p>\n\n<p><code>Test</code> in this context will always refer to <code>A::B::Test</code> so you need to say explicitly that you need <code>Test</code> from the global namespace, which is exactly what <code>::Test</code> does</p>\n"}], "owner": {"reputation": 373, "user_id": 10481402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bf7fb58c76b77f15fa297bf523dca4?s=128&d=identicon&r=PG", "display_name": "Jaye Hernandez", "link": "https://stackoverflow.com/users/10481402/jaye-hernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 53168726, "answer_count": 1, "score": 3, "last_activity_date": 1541495168, "creation_date": 1541494892, "question_id": 53168654, "link": "https://stackoverflow.com/questions/53168654/rails-uninitialized-constant-inside-controller", "title": "Rails: Uninitialized Constant inside Controller", "body": "<p>I have a namespaced route and here's how I created the controller:</p>\n\n<pre><code>module A\n  module B\n    module Test\n      class DummyController &lt; ApplicationController\n\n        def quantify_stocks\n          something = Test::Dummy::Something.new(params)\n\n          # more code here\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I am trying to access the class <code>Test::Dummy::Something</code> but it autoloads the constant Test with A and B (<code>A::B::Test</code>)? </p>\n\n<p>The error I get is:</p>\n\n<pre><code>NameError (uninitialized constant A::B::Test::Dummy)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 784, "user_id": 7970365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ea30f5ef13a4593ad0eafd20304601?s=128&d=identicon&r=PG", "display_name": "D1ceWard", "link": "https://stackoverflow.com/users/7970365/d1ceward"}, "edited": false, "score": 0, "creation_date": 1541500344, "post_id": 53168625, "comment_id": 93229914, "body": "Hello, it&#39;s a nodejs issue (not ruby/ror), you have an old dependencies <code>upath@1.0.4</code> which is execpt nodejs version between 4 and 9 but you have nodejs 11.0.0. (rails throw an error because it check integrity of node_modules), can you share package.json for more help ?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1541557747, "post_id": 53168625, "comment_id": 93255716, "body": "Change your installed version of node from v11 to v9, for example using <a href=\"https://github.com/creationix/nvm\" rel=\"nofollow noreferrer\">nvm</a>, then retry."}, {"owner": {"reputation": 73, "user_id": 9529030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ay9Ps.png?s=128&g=1", "display_name": "RobertEagle", "link": "https://stackoverflow.com/users/9529030/roberteagle"}, "edited": false, "score": 0, "creation_date": 1542638765, "post_id": 53168625, "comment_id": 93629697, "body": "Thanks I found the solution!"}], "owner": {"reputation": 73, "user_id": 9529030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ay9Ps.png?s=128&g=1", "display_name": "RobertEagle", "link": "https://stackoverflow.com/users/9529030/roberteagle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1038, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541494799, "creation_date": 1541494799, "question_id": 53168625, "link": "https://stackoverflow.com/questions/53168625/cannot-run-rails-server-with-rapid-rails-themes-gem", "title": "Cannot run rails server with Rapid Rails Themes gem", "body": "<p>Willing to go fast on the front-end and only work thoroughly on the back end, I am willing to use a theme from <a href=\"http://gems.rapidrailsthemes.com/\" rel=\"nofollow noreferrer\">http://gems.rapidrailsthemes.com/</a>. </p>\n\n<p>When I want to launch my local server through rails s, I am notified that my yarn packages are out of date. I then launch yarn install, and receive the following error message: </p>\n\n<pre><code>\u279c  casimodo_app git:(master) \u2717 rails s\n=&gt; Booting Puma\n=&gt; Rails 5.1.5 application starting in development \n=&gt; Run `rails server -h` for more startup options\n\n\n========================================\n  Your Yarn packages are out of date!\n  Please run `yarn install` to update.\n========================================\n\n\nTo disable this check, please add `config.webpacker.check_yarn_integrity = false`\nto your Rails development config file (config/environments/development.rb).\n\n\nyarn check v1.12.1\nerror Couldn't find an integrity file\nerror Found 1 errors.\ninfo Visit https://yarnpkg.com/en/docs/cli/check for documentation about this command.\n\n\nExiting\n\u279c  casimodo_app git:(master) \u2717 yarn install\nyarn install v1.12.1\n[1/4] \ud83d\udd0d  Resolving packages...\n[2/4] \ud83d\ude9a  Fetching packages...\nerror upath@1.0.4: The engine \"node\" is incompatible with this module. Expected version \"&gt;=4 &lt;=9\". Got \"11.0.0\"\nerror Found incompatible module\ninfo Visit https://yarnpkg.com/en/docs/cli/install for documentation about this command.\n</code></pre>\n\n<p>Anyone could help about this one?</p>\n\n<p>Thanks in advance for your help! </p>\n\n<p>Have a nice day,</p>\n\n<p>Max</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3797760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09980727fe7eff2c124db82cb36c5838?s=128&d=identicon&r=PG&f=1", "display_name": "user3797760", "link": "https://stackoverflow.com/users/3797760/user3797760"}, "edited": false, "score": 0, "creation_date": 1541497022, "post_id": 53168008, "comment_id": 93228024, "body": "you made my day. Thanks for that!"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 0, "last_activity_date": 1541492237, "last_edit_date": 1541492237, "creation_date": 1541491825, "answer_id": 53168008, "question_id": 53167809, "link": "https://stackoverflow.com/questions/53167809/load-or-write-settings-on-program-start/53168008#53168008", "title": "Load or write settings on program start", "body": "<p>If you don't want to pass configs everywhere, then you need to make it global. There's several ways of doing this. </p>\n\n<p>For example, just replace all <code>configData</code> with <code>$configData</code>. Boom, it's done. But this may be frowned upon.</p>\n\n<p>Or, a more \"professional\" approach is to use some kind of global singleton config object.</p>\n\n<p>Something like this:</p>\n\n<pre><code>class ConfigData\n  class &lt;&lt; self\n    attr_accessor :multi_threading, :system_cores\n  end\nend\n</code></pre>\n\n<p>Then</p>\n\n<pre><code># write at startup\nConfigData.system_cores = options['systemCores']\n\n# read in another place\nConfigData.system_cores\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3797760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09980727fe7eff2c124db82cb36c5838?s=128&d=identicon&r=PG&f=1", "display_name": "user3797760", "link": "https://stackoverflow.com/users/3797760/user3797760"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 53168008, "answer_count": 1, "score": -1, "last_activity_date": 1541492237, "creation_date": 1541490922, "last_edit_date": 1541491939, "question_id": 53167809, "link": "https://stackoverflow.com/questions/53167809/load-or-write-settings-on-program-start", "title": "Load or write settings on program start", "body": "<p>Data is generated this way:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def checkConfigurationsFile\n    if File.exist?(\"./prefs/settings.conf\") == true\n      configFile = File.read(\"./prefs/settings.conf\")\n      options = JSON.parse(configFile)\n      configData = {:multithreading =&gt; options['multithreading'],\n                    :systemCores =&gt; options['systemCores']}\n      mainmenu()\n\n      elsif File.exist?(\"./prefs/settings.conf\") == false\n        configData = {:multithreading =&gt; false,\n                      :systemCores =&gt; 1}\n\n        configFile = File.open(\"./prefs/settings.conf\",\"w\")\n        configFile.write(JSON.pretty_generate(configData))\n        configFile.close\n        checkConfigurationsFile()\n      else\n        puts \"Something went terribly wrong!\"\n    end\nend\n</code></pre>\n\n<p>This is a settings menu:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>    def openPreferences\n    puts &lt;&lt;-PREFERENCES\n        ####################################################\n        #|                                                |#\n        #|  Preferences                                   |#\n        #|  ------------------                            |#\n        #|   1. Using Multithreading? (Currently #{configData[multithreading]})                                             |#\n        #|  2. Adjust Multithreading (Currently #{configData[systemCores]} are used)|#\n        #|                                                |#\n        ####################################################\n    PREFERENCES\n      print \"Enter a number to change settings: \"\n      choice = gets.i \n\n      if blablabla\n      ...\n</code></pre>\n\n<p>If the user decides to alter his configurations, he needs to be able to do. But it seems like I couldn't use the data generated in the <code>checkConfigurationsFile</code> method because they are private (and it makes no sense to pass them via arguments all around the program).</p>\n\n<p>It produces this error message:</p>\n\n<pre class=\"lang-bash prettyprint-override\"><code>Traceback (most recent call last):\n        3: from dbaser.rb:214:in `&lt;main&gt;'\n        2: from dbaser.rb:10:in `checkConfigurationsFile'\n        1: from dbaser.rb:54:in `mainmenu'\ndbaser.rb:205:in `openPreferences': undefined local variable or method `configData' for main:Object (NameError)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "design-patterns", "crud"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1541491933, "post_id": 53167606, "comment_id": 93225799, "body": "Yes, using AJAX you can do it, but it is bad practice to provide all CRUD in single view page"}, {"owner": {"reputation": 191, "user_id": 8968449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mwG6A.jpg?s=128&g=1", "display_name": "Nicol&#225;s Nisoria", "link": "https://stackoverflow.com/users/8968449/nicol%c3%a1s-nisoria"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1541492947, "post_id": 53167606, "comment_id": 93226269, "body": "Mmm okay, but what if i want to provide an administration view where the admin can create some stuff?"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1541497169, "post_id": 53167606, "comment_id": 93228096, "body": "Just keep button for different actions, all actions will be JS requests, call ajax for providing form and new object these forms will be appended inside any corner of your view, render partial by js.erb"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1541497205, "post_id": 53167606, "comment_id": 93228112, "body": "Single view for many CRUD actions will be complex view. If possible try to change approach."}, {"owner": {"reputation": 191, "user_id": 8968449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mwG6A.jpg?s=128&g=1", "display_name": "Nicol&#225;s Nisoria", "link": "https://stackoverflow.com/users/8968449/nicol%c3%a1s-nisoria"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1541498573, "post_id": 53167606, "comment_id": 93228886, "body": "Thanks, since i&#39;ve implemented all without using javascript i would like an approach that avoid js and ajax, just to don&#39;t lose all the work i&#39;ve done yet."}], "owner": {"reputation": 191, "user_id": 8968449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mwG6A.jpg?s=128&g=1", "display_name": "Nicol&#225;s Nisoria", "link": "https://stackoverflow.com/users/8968449/nicol%c3%a1s-nisoria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541490005, "creation_date": 1541490005, "question_id": 53167606, "link": "https://stackoverflow.com/questions/53167606/what-is-the-best-way-to-do-many-cruds-in-one-view-without-using-ajax", "title": "What is the best way to do many CRUDs in one view (without using ajax)?", "body": "<p>I have 3 forms in a view called 'home' each form submit different model, each form redirect to a create action in the respective controller. After create each controller redirect to the administration view which also index each model and provide edit and delete links.</p>\n\n<p>I don't know if this approach is a good practice since i have to instance all in the administrators_controller, also i have to instance each model in their respective controllers again.</p>\n\n<p><strong>administrators_controller.rb</strong></p>\n\n<pre><code>def home\n    @user = Employee.new(role: :emp)\n    @market = Market.find(params[:market_id])\n\n    #INDEX EMPLOYEE:\n    @employees = @market.users.where(role: :emp)\n\n    #INDEX SERVERS:\n    @server = Server.new(market_id: @market.id)\n    @servers = @market.servers\n\n    #INDEX TRAMITES:\n    @task = Task.new(market_id: @market.id)\n    @tasks = @market.tasks\n end\n</code></pre>\n\n<p><strong>users_controller.rb</strong></p>\n\n<pre><code>def edit\n    @user = User.find(params[:id])\nend\n\n  def update\n    @user = User.find(params[:id])\n    if @user.update_attribute(:email, params[:user][:email])\n      flash[:success] = \"User updated\"\n      redirect_to market_admin_path(current_user.market_id)\n    else\n      render 'edit'\n    end\n  end\n</code></pre>\n\n<p><strong>home.html.erb</strong></p>\n\n<pre><code>&lt;% provide(:button_text, 'create') %&gt;\n&lt;%= render 'users/form', url: market_employees_path %&gt;\n\n&lt;h1&gt; Empleados: &lt;/h1&gt;\n&lt;% @employees.each do |employee| %&gt;\n  &lt;ul&gt;\n    &lt;li&gt;&lt;%= employee.email%&gt; &lt;%= link_to 'edit', edit_user_path(employee) %&gt;&lt;/li&gt;\n  &lt;/ul&gt;\n&lt;% end %&gt;\n\n&lt;br&gt;\n\n&lt;h1&gt; Servers: &lt;/h1&gt;\n&lt;table style=\"width:100%\"&gt;\n&lt;tr&gt;\n    &lt;th&gt;ID&lt;/th&gt;\n    &lt;th&gt;Descripcion&lt;/th&gt;\n  &lt;/tr&gt;\n &lt;%= render 'servers/form', url: market_servers_path %&gt;\n\n  &lt;% @servers.each do |serv| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= serv.id%&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= serv.description%&gt;  &lt;%= link_to 'edit', edit_server_path(serv) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n&lt;h1&gt; Tramites: &lt;/h1&gt;\n\n&lt;%= render 'tasks/form', url: market_tasks_path %&gt;\n\n\n&lt;table style=\"width:100%\"&gt;\n  &lt;tr&gt;\n    &lt;th&gt;ID&lt;/th&gt;\n    &lt;th&gt;Descripcion&lt;/th&gt;\n    &lt;th&gt;Duracion&lt;/th&gt;\n  &lt;/tr&gt;\n\n  &lt;% @tasks.each do |task| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= task.id%&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= task.name%&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= task.duration%&gt; &lt;%= link_to 'edit', edit_task_path(task) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n\n&lt;/table&gt;\n</code></pre>\n\n<p><strong>users/_form.html.erb</strong></p>\n\n<pre><code>&lt;%= form_for(@user, url: local_assigns[:url]) do |f| %&gt;\n\n  &lt;%= render 'shared/flash_type', type: 'employee'%&gt;\n\n  &lt;%= f.hidden_field :role %&gt;\n\n  &lt;%= f.email_field :email, class: 'form-control' %&gt;\n\n  &lt;%= f.submit yield(:button_text), class: \"btn btn-primary\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>resources :markets, only: [], shallow: true do\n    resources :employees, only: [:create]\n    resources :users, only: [:edit, :update]\n    resources :tasks, only: [:create, :edit, :update]\n    resources :servers, only: [:create, :edit, :update]\n    get '/administration', :to =&gt; 'administrators#home', :as =&gt; :admin\nend\n</code></pre>\n\n<p>It actually works but i would like to know if there is a better way to do this. </p>\n\n<p>Note: 'employee' class was created to use form objects pattern</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "webpack"], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 7824640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ImUAfD7p5hw/AAAAAAAAAAI/AAAAAAAABNo/YB8fbLxMUhY/photo.jpg?sz=128", "display_name": "Hidehiro NAGAOKA", "link": "https://stackoverflow.com/users/7824640/hidehiro-nagaoka"}, "edited": false, "score": 0, "creation_date": 1541490508, "post_id": 53167417, "comment_id": 93225150, "body": "Thank you for your the answer! So why did compiling <code>packs&#47;foo.js</code> alonely fail?"}, {"owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "reply_to_user": {"reputation": 401, "user_id": 7824640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ImUAfD7p5hw/AAAAAAAAAAI/AAAAAAAABNo/YB8fbLxMUhY/photo.jpg?sz=128", "display_name": "Hidehiro NAGAOKA", "link": "https://stackoverflow.com/users/7824640/hidehiro-nagaoka"}, "edited": false, "score": 1, "creation_date": 1541490672, "post_id": 53167417, "comment_id": 93225245, "body": "I don&#39;t know precisely, you did not give the error message, but there could be many reason, like your library being made accessible by some other code in application.js so the import works in this case but not if you&#39;re trying to compile foo.js alone"}], "tags": [], "owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "is_accepted": true, "score": 1, "last_activity_date": 1541489044, "creation_date": 1541489044, "answer_id": 53167417, "question_id": 53167255, "link": "https://stackoverflow.com/questions/53167255/error-when-deployed-the-rails-app-with-webpack-in-the-heroku/53167417#53167417", "title": "Error when deployed the rails app with webpack in the Heroku", "body": "<p>Webpack will try to create a \"pack\" for every javascript or similar file found inside <code>app/javascript/packs</code>, i.e. files you could require using <code>javascript_pack_tag</code>.</p>\n\n<p>So in this context, <code>app/javascript/packs/foo.js</code> is compiled alone and will have to resolve <code>import somelibrary;</code> by itself, whereas <code>app/javascript/components/foo.js</code> is compiled as part of <code>app/javascript/packs/application.js</code> (where it's required) and somehow has a way of loading your library.</p>\n\n<p>You could try manually building the assets to see all the packs generated by webpack, and detect compilation errors before deploying, or simply put all your components and other source files in another folder than <code>app/javascript/packs</code>.</p>\n"}], "owner": {"reputation": 401, "user_id": 7824640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ImUAfD7p5hw/AAAAAAAAAAI/AAAAAAAABNo/YB8fbLxMUhY/photo.jpg?sz=128", "display_name": "Hidehiro NAGAOKA", "link": "https://stackoverflow.com/users/7824640/hidehiro-nagaoka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 53167417, "answer_count": 1, "score": 0, "last_activity_date": 1541489044, "creation_date": 1541488283, "question_id": 53167255, "link": "https://stackoverflow.com/questions/53167255/error-when-deployed-the-rails-app-with-webpack-in-the-heroku", "title": "Error when deployed the rails app with webpack in the Heroku", "body": "<p>I don't really understand the webpack assets loading order.</p>\n\n<p>I created JavaScript files like this.</p>\n\n<pre><code>// app/javascript/packs/foo.js\nimport somelibrary;\nfunction someFunction() {\n    // ...\n}\n\n&lt;!-- app/views/layouts/application.html.erb --&gt;\n&lt;%= javascript_pack_tag 'foo' %&gt;\n</code></pre>\n\n<p>This works fine in localhost, but when I deployed it to the Heroku, this caused the compile error which said that <code>Could not find somelibrary</code> (sorry, I lost the precise error message).</p>\n\n<p>And I tried this instead of above one, it works both in local host and Heroku.</p>\n\n<pre><code>// app/javascript/components/foo.js\nimport somelibrary;\nfunction someFunction() {\n    // ...\n}\nexport { someFunction };\n\n// app/javascript/packs/application.js\nimport { someFunction } from '../components/foo.js';\nsomeFunction();\n\n&lt;!-- app/views/layouts/application.html.erb --&gt;\n&lt;%= javascript_pack_tag 'application' %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "is_accepted": false, "score": 0, "last_activity_date": 1541489535, "creation_date": 1541489535, "answer_id": 53167519, "question_id": 53167093, "link": "https://stackoverflow.com/questions/53167093/ruby-on-rails-nested-models-not-updating-with-form-for-but-no-error-on-update/53167519#53167519", "title": "Ruby on Rails Nested Models not Updating with form_for, but no error on update", "body": "<p>When you write the following line, you're trying to <code>find</code> a <code>DrNote</code> using the <code>dr_id</code>:</p>\n\n<pre><code>@dr_note = @patient.treatment.dr_notes.find(params[:dr_id])\n</code></pre>\n\n<p>Whereas the <code>dr_notes</code> relation on <code>Treatment</code> does not seem to define any particular behavior, and this is your problem.</p>\n\n<p>You'll need to <code>find_by</code> doctor's id (or <code>dr_id</code> in your code) and thus first define the relation on <code>DrNote</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1541490970, "creation_date": 1541490970, "answer_id": 53167824, "question_id": 53167093, "link": "https://stackoverflow.com/questions/53167093/ruby-on-rails-nested-models-not-updating-with-form-for-but-no-error-on-update/53167824#53167824", "title": "Ruby on Rails Nested Models not Updating with form_for, but no error on update", "body": "<p>You are mixing two approaches(<strong>the nested resources</strong> and <strong>the nested attributes</strong>). Use one to serve your purpose.</p>\n\n<p><strong>With the nested resources:</strong></p>\n\n<pre><code>&lt;%= form_for [:pages, @patient, @treatment, @dr_note], url: update_dr_note_path do |dr_note| %&gt;\n  Name: &lt;%= dr_note.text_field :name %&gt;\n  Message: &lt;%= dr_note.text_field :message %&gt;\n  &lt;p&gt;\n    &lt;%= dr_note.submit %&gt;\n  &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The routes would be</p>\n\n<pre><code>get '/pages/:patient_id/treatment/:treatment_id/edit_dr_note/:dr_id', to: 'pages#edit_dr_note', as: :edit_dr_note\nmatch \"pages/:patient_id/treatment/:treatment_id/update_dr_note/:dr_id\" =&gt; \"pages#update_dr_note\", as: :update_dr_note, via: [:patch, :post]\n</code></pre>\n\n<p>Edit the <code>edit_dr_note</code> to define <code>@treatment</code></p>\n\n<pre><code>def edit_dr_note\n  @patient = Patient.find(params[:patient_id])\n  @treatment = @patient.treatment\n  @dr_note = @patient.treatment.dr_notes.find(params[:dr_id])\n  @dr_note.update if @dr_note.nil?\nend\n</code></pre>\n\n<p>And finally remove <code>accepts_nested_attribute_for</code> from the models, you don't need it in this approach.</p>\n\n<p><strong>With the nested attributes:</strong></p>\n\n<p>Keep the <code>accepts_nested_attributes_for</code> in the models. And change the routes and form like below</p>\n\n<pre><code>get '/edit_dr_note/:dr_id', to: 'pages#edit_dr_note', as: :edit_dr_note\nmatch \"/update_dr_note/:dr_id\" =&gt; \"pages#update_dr_note\", as: :update_dr_note, via: [:patch, :post]\n</code></pre>\n\n<p>And the <code>form_for</code></p>\n\n<pre><code>&lt;%= form_for @patient, url: update_dr_note_path do |patient| %&gt;\n  &lt;%= patient.fields_for :treatment do |t| %&gt;\n    &lt;%= t.fields_for :dr_notes, @dr_note do |dr_note| %&gt;\n      Name: &lt;%= dr_note.text_field :name %&gt;\n      Message: &lt;%= dr_notetext_field :message %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n  &lt;p&gt;\n    &lt;%= patient.submit %&gt;\n  &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And change the <code>dr_note_params</code> method as below</p>\n\n<pre><code>def dr_note_params\n  params.require(:patient).permit(:id, treatment_attributes: [:id, dr_notes_attributes: [:id, :name, :message])\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10611567, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--eQhjqLkUPU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCUhfwX2ZDa3HrsEb90TtZ-l2R2cA/mo/photo.jpg?sz=128", "display_name": "Quanrocks11", "link": "https://stackoverflow.com/users/10611567/quanrocks11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 53167824, "answer_count": 2, "score": 3, "last_activity_date": 1541490970, "creation_date": 1541487550, "question_id": 53167093, "link": "https://stackoverflow.com/questions/53167093/ruby-on-rails-nested-models-not-updating-with-form-for-but-no-error-on-update", "title": "Ruby on Rails Nested Models not Updating with form_for, but no error on update", "body": "<p>So in my rails project, I have a Patient class, which has one Treatment class. This treatment class then has many DrNotes inside of it. I am still fairly new to rails, and I am aware that nesting this deeply is not recommended in Rails, but I am proceeding with this method.</p>\n\n<p>My problem is with the editing of DrNotes. Since there are many doctor notes within treatment, I am trying to only edit one specific note. I am using Form_for to pass parameters to the doctor's note. When I submit the form, it redirects me to the page that should be shown only when the update function has succeeded. However, none of the notes are actually updated, and no errors are thrown when I try to perform the update.</p>\n\n<p>Here are the models in question:</p>\n\n<p>patient.rb</p>\n\n<pre><code>class Patient &lt; ApplicationRecord\n    has_one :treatment, dependent: :destroy\n\n    accepts_nested_attributes_for :treatment, update_only: true\n\nend\n</code></pre>\n\n<p>treatment.rb</p>\n\n<pre><code>class Treatment &lt; ApplicationRecord\n    belongs_to :patient\n\n    has_many :dr_notes, class_name: \"DrNote\",\n        foreign_key: \"treatment_id\", dependent: :destroy\n\n    accepts_nested_attributes_for :dr_notes\nend\n</code></pre>\n\n<p>dr_note.rb</p>\n\n<pre><code>class DrNote &lt; ApplicationRecord\n    belongs_to :treatment\nend\n</code></pre>\n\n<p>In my controller I have:</p>\n\n<p>Doctor Note Edit Function</p>\n\n<pre><code>def edit_dr_note\n    @patient = Patient.find(params[:patient_id])\n    @dr_note = @patient.treatment.dr_notes.find(params[:dr_id])\n    @dr_note.update if @dr_note.nil?\nend\n</code></pre>\n\n<p>Doctor Note Update Function</p>\n\n<pre><code>def update_dr_note\n    @patient = Patient.find(params[:patient_id])\n    @dr_note = @patient.treatment.dr_notes.find(params[:dr_id])\n    if @dr_note.update(dr_note_params)\n        redirect_to page_path(@patient)\n    else\n        flash.now[:error] = \"Cannot update Doctor's notes\"\n        render 'edit_dr_note'\n    end\nend\n</code></pre>\n\n<p>Doctor Note Params</p>\n\n<pre><code>def dr_note_params\n    params.require(:dr_note).permit(:id, :name, :message)\nend\n</code></pre>\n\n<p>I have :id in the params.permit because from researching, I heard that you need to include it when updating models, but i'm not sure if it is needed here.</p>\n\n<p>I have the following code in the routes.rb</p>\n\n<pre><code>get '/pages/:patient_id/treatment/edit/edit_dr_note/:dr_id', to: 'pages#edit_dr_note', as: :edit_dr_note\nmatch \"pages/:patient_id/treatment/update/update_dr_note/:dr_id\" =&gt; \"pages#update_dr_note\", as: :update_dr_note, via: [:patch, :post]\n</code></pre>\n\n<p>And in the edit_dr_note.html.erb</p>\n\n<pre><code>&lt;%= form_for @patient.treatment.dr_notes.find(params[:dr_id]), url: update_dr_note_path do |patient_form| %&gt;\n\n    &lt;% @patient.treatment.dr_notes.each do |doctor| %&gt;\n    &lt;% if doctor.id == @dr_note.id %&gt;   #Only displays the fields for the desired note\n        &lt;%= patient_form.fields_for :dr_note, doctor do |doctor_fields| %&gt;\n            Name: &lt;%= doctor_fields.text_field :name %&gt;\n            Message: &lt;%= doctor_fields.text_field :message %&gt;\n        &lt;% end %&gt;\n        &lt;p&gt;\n            &lt;%= patient_form.submit %&gt;\n        &lt;/p&gt;\n        &lt;% end %&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Any help would be greatly appreciated. Thanks!</p>\n"}, {"tags": ["ruby", "file"], "comments": [{"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1541480352, "post_id": 53165942, "comment_id": 93221878, "body": "<code>File.open</code> accepts a block where file object passed as an argument."}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1541480357, "post_id": 53165942, "comment_id": 93221880, "body": "<code>File.open(&quot;&quot;).each</code> - each accepts a block where every line passed as an argument,block executed for every line."}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1541480473, "post_id": 53165942, "comment_id": 93221909, "body": "<code>File.open(&quot;&quot;) {|file| print file.readlines}</code> where <code>readlines</code> returns an array of lines"}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1541480662, "post_id": 53165942, "comment_id": 93221961, "body": "@Fabio I thought this, but could not explain #3.  <code>readlines</code> should execute similarly to <code>.each</code>, no?"}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1541483165, "post_id": 53165942, "comment_id": 93222571, "body": "no - because <code>print file.readlines</code> will be execute once for the whole file, and <code>readlines</code> returns array of string, that why you see <code>[.., ..., ...]</code>. Where <code>.each</code> will execute <code>print line</code> for every line in the file."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1541483541, "post_id": 53165942, "comment_id": 93222673, "body": "Think of it this way: if you borrow (and read) The Fellowship of the Ring from the library, then The Two Towers, and finally The Return of the King, you will have read three books. When you buy (and read) The Lord of the Rings boxed set, you will have read the same content; but the boxed set is not the same thing as three books (for one thing, there&#39;s the box); for another, checking out and having your own is different. Yes? <code>.each</code> yields a single line in each pass, and you don&#39;t have it once <code>.each</code> block is finished, unless you save it somewhere. <code>.readlines</code> gives you the array for keeps."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1541512535, "post_id": 53165942, "comment_id": 93236409, "body": "As an aside <code>File.open(...).each</code> would be better written as <code>File.foreach</code> the reason being is that <code>File.open</code> without a block will hold the file in an open state and since you are not capturing it in a variable you will have to wait for GC to get around to closing it; however <code>File.foreach</code> will yeild each line to the block and close the file again when the block terminates leaving this file available for future code as needed."}], "owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541493370, "creation_date": 1541480145, "last_edit_date": 1541493370, "question_id": 53165942, "link": "https://stackoverflow.com/questions/53165942/differences-in-ruby-block-hash-outputs", "title": "Differences in ruby block hash outputs", "body": "<p>I have an input hash. The following codes result in different outputs:</p>\n\n<p>1.</p>\n\n<pre><code>read_file = File.open(\"data_file.txt\")\nread_file.each{|r| print r}\n# =&gt; {a =&gt; b, c =&gt; d}\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>File.open(\"data_reader.txt\").each {|d| print d}\n# =&gt; {a =&gt; b, c =&gt; d}\n</code></pre>\n\n<p>3.</p>\n\n<pre><code>File.open(\"data_reader.txt\") {|d| print d.readlines}\n# =&gt; [\"{a =&gt; b, c =&gt; d}\"]\n</code></pre>\n\n<p>4.</p>\n\n<pre><code>File.open(\"data_reader.txt\") {|d| print d}\n# =&gt; #&lt;File: object in mem&gt;\n</code></pre>\n\n<p>I'm looking for reasons why they are different. Particularly, I'm trying to understand why #3 outputs a list, and #4 stored the object in memory.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1541479413, "post_id": 53165618, "comment_id": 93221707, "body": "what i don&#39;t understand, is if you are hitting /login which routes to <code>login#show</code>, where is it attempting to render the index template?"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1541480368, "post_id": 53165618, "comment_id": 93221883, "body": "Are using API routes?"}, {"owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1541481000, "post_id": 53165618, "comment_id": 93222037, "body": "@max pleaner, inside the rescue."}, {"owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1541481129, "post_id": 53165618, "comment_id": 93222067, "body": "@Pavan, this is more or less a rails api with a react front end. However, I&#39;m not sure the routes are different between rails api and non api. If they are what are those differences?"}], "answers": [{"comments": [{"owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "edited": false, "score": 0, "creation_date": 1541510445, "post_id": 53166107, "comment_id": 93235166, "body": "Cool. I&#39;ll try this and let you know!"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": false, "score": 1, "last_activity_date": 1541481410, "creation_date": 1541481410, "answer_id": 53166107, "question_id": 53165618, "link": "https://stackoverflow.com/questions/53165618/actionviewmissingtemplate-even-though-template-exists/53166107#53166107", "title": "ActionView::MissingTemplate even though template exists", "body": "<blockquote>\n  <p>ActionView::MissingTemplate (Missing template login/index,\n  application/index with {:locale=>[:en], :formats=>[:json],\n  :variants=>[], :handlers=>[:raw, :erb, :html, :builder, :ruby,\n  :coffee, :jbuilder]}. Searched in: *\n  \"C:/Shelf/myGroceryList/app/views\"</p>\n</blockquote>\n\n<p>The error says it can't find the file with the name <strong>index</strong> and with the format <strong>json</strong>. As are you having an <strong>API</strong>, probably the <strong>request/response</strong> would be in the format <strong>json</strong> not <strong>html</strong>. That said you need to <strong>create</strong> a <code>index.json.erb</code> inside <code>app/views/login</code> to resolve the error.</p>\n"}], "owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541481410, "creation_date": 1541477424, "question_id": 53165618, "link": "https://stackoverflow.com/questions/53165618/actionviewmissingtemplate-even-though-template-exists", "title": "ActionView::MissingTemplate even though template exists", "body": "<p>I'm building a simple login screen. I'd like to return an <code>:internal_server_error</code> to my client if there isn't a matching user or if the password is incorrect. However, I'm getting the following missing template error:</p>\n\n<blockquote>\n  <p>ActionView::MissingTemplate (Missing template login/index,\n  application/index with {:locale=>[:en], :formats=>[:json],\n  :variants=>[], :handlers=>[:raw, :erb, :html, :builder, :ruby,\n  :coffee, :jbuilder]}. Searched in:   *\n  \"C:/Shelf/myGroceryList/app/views\"</p>\n</blockquote>\n\n<p>What has me confused is that I have an <code>index.html.erb</code> template in <code>views/login</code>. Thoughts?</p>\n\n<p>Route:</p>\n\n<pre><code>  post '/login', to: 'login#show'\n</code></pre>\n\n<p>Controller(login_controller.rb):</p>\n\n<pre><code>class LoginController &lt; ApplicationController\n  protect_from_forgery with: :null_session\n\n  def index\n\n  end\n\n  def show\n    username = params.values.last[\"email\"]\n    password = params.values.last[\"password\"]\n    loginType = params.values.last[\"loginType\"]\n\n    if loginType == \"Login\"\n      login(username, password)\n    else\n      createNewUser(username, password)\n    end\n  end\n\n  def login(username, password)\n    begin\n      user = User.find_by(username: username)\n      raise(StandardError) if user.password != password\n    rescue\n      render 'index', :status =&gt; :internal_server_error\n    end\n  end\n\n  def createNewUser(username, password)\n    User.new(username: username, password: password)\n  end\nend\n</code></pre>\n\n<p>View(index.html.erb):</p>\n\n<pre><code>&lt;body&gt;&lt;%= javascript_pack_tag 'login' %&gt;&lt;/body&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "heroku", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 2, "creation_date": 1541479310, "post_id": 53165521, "comment_id": 93221684, "body": "can you please show what error you are getting?"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1541490448, "post_id": 53165521, "comment_id": 93225123, "body": "Instead of deleting old migrations just create new blank file with combination of this <code>20181023015412</code> ? and then add nothing in that file, just add <code>def change end</code>"}, {"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 0, "creation_date": 1541567397, "post_id": 53165521, "comment_id": 93257452, "body": "Here is the error I am getting when I am trying to save an image that I uploaded. <code>NoMethodError </code>(undefined method <code>main_image_will_change!&#39; for #&lt;Movie:0x00559789911998&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 1, "creation_date": 1543370777, "post_id": 53168131, "comment_id": 93891721, "body": "I ended up deleting my database in Heroku and it was removed. It was all sample data anyways. Thank you."}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 0, "last_activity_date": 1541492406, "creation_date": 1541492406, "answer_id": 53168131, "question_id": 53165521, "link": "https://stackoverflow.com/questions/53165521/deleting-old-migrations-pushed-to-heroku/53168131#53168131", "title": "Deleting old migrations pushed to Heroku", "body": "<p>You have run down for last two migrations as per your provided data. So I think those two versions are removed from SchemaMigration table. </p>\n\n<p>now you just need to pass commit in which you need to delete those migration files. It will work fine for later migration. Please confirm before following this.</p>\n\n<p><strong>Note</strong> In Fact, If you getting errors,please post errors </p>\n"}], "owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 53168131, "answer_count": 1, "score": 0, "last_activity_date": 1558054558, "creation_date": 1541476415, "last_edit_date": 1558054558, "question_id": 53165521, "link": "https://stackoverflow.com/questions/53165521/deleting-old-migrations-pushed-to-heroku", "title": "Deleting old migrations pushed to Heroku", "body": "<pre><code> Status   Migration ID    Migration Name\n--------------------------------------------------\nD, [2018-11-06T03:46:52.337306 #4] DEBUG -- :  (1.7ms)  `SELECT \"schema_migrations\".\"version\" FROM \"schema_migrations\" ORDER BY \"schema_migrations\".\"version\" ASC\n   up     20180903011647  Create movies\n   up     20180903012838  Add fields to movies\n   up     20180922012345  Add more fields to movies\n   up     20181023010527  Create reviews\n   up     20181023015412  ********** NO FILE **********\n   up     20181102193810  ********** NO FILE **********\n  down    20181105211502  Add extra image fields to movies\n  down    20181106003841  Add main image to movies\n</code></pre>\n\n<p>How can I delete old migrations in heroku? . These old tables seem to be causing errors when I am trying to run <code>heroku run rake db:migrate</code> with the last two migrations. </p>\n\n<p>I want to delete <code>20181023015412</code> and <code>20181102193810</code>. Any help is greatly appreciated.</p>\n"}, {"tags": ["ruby", "range"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1541479645, "post_id": 53165254, "comment_id": 93221755, "body": "they are certainly two ways of representing the same thing, for example if you wanted to iterate n times you might use <code>(0...n).each</code> instead of <code>(0..n-1).each</code>. But, then again, you could always use <code>n.times do</code> in that case. Basically, I would advise keeping in mind that it exists should a need arise, but know that it&#39;s never really necessary."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1541486313, "post_id": 53165254, "comment_id": 93223592, "body": "I would say it&#39;s <i>never</i> (or almost never) a good idea to use an exclusive (three-dot) range. Consider <code>(1...n).include?(x)</code> versus <code>(1..n-1).include?(x)</code>, when the intent is to test <code>1 &lt;= x &lt;= n-1</code>. As @Tadman points out, they are not the same when <code>n</code> is a <code>Float</code>. If <code>n</code> is an integer, yes, the two expressions are equivalent, but what if it is decided to change <code>n</code> to a <code>Float</code> some time in the future? The second form protects against that. Another consideration is that it&#39;s very easy--too easy, imo--to mistake 3 dots for 2. And what is the advantage of 3 dots here? To save 1 character?..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1541486319, "post_id": 53165254, "comment_id": 93223594, "body": "...Months after you&#39;ve written the code, you (or someone who has taken over responsibility for it) could easily miss a one dot difference. Now suppose you wish to test <code>1 &lt;= x &lt; n</code> where <code>x</code> is a float. <code>1...n.include?(x)</code> does what you want, but there still is an argument for the more verbose <code>x &gt;= 1 &amp;&amp; x &lt; n</code>,  because <code>1...n</code> could inadvertently be written or read as <code>1..n</code> and also for general readability. For these reasons I always use 2-dot ranges."}], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 6, "last_activity_date": 1541483955, "last_edit_date": 1541483955, "creation_date": 1541482216, "answer_id": 53166235, "question_id": 53165254, "link": "https://stackoverflow.com/questions/53165254/when-is-it-good-to-use-inclusive-vs-exclusive-ranges/53166235#53166235", "title": "When is it good to use inclusive vs exclusive ranges?", "body": "<p>They are <em>not</em> the same thing.</p>\n\n<pre><code>(1..10).include?(10.5)\n# =&gt; false\n(1...11).include?(10.5)\n# =&gt; true\n\n(1..10).step(0.2).to_a\n# =&gt; [1.0, 1.2, 1.4, ... 10.0]\n(1...11).step(0.2).to_a\n# =&gt; [1.0, 1.2, 1.4, ... 10.0, 10.2, 10.4, 10.6, 10.8] # (rounded for space)\n</code></pre>\n\n<p>And if you expect this to run 50% of the time, you are committing a (very tiny) error:</p>\n\n<pre><code>if (0..0.5).include?(rand())\n</code></pre>\n\n<p>which is equivalent to</p>\n\n<pre><code>if rand() &lt;= 0.5\n</code></pre>\n\n<p>whereas these are true 50%:</p>\n\n<pre><code>if (0...0.5).include?(rand())\nif rand() &lt; 0.5\n</code></pre>\n\n<p>As Cary Swoveland notes, the two-dot literal creates a range that describes <code>start &lt;= x &lt;= finish</code>, while the three-dot literal creates a range with <code>exclude_end</code> set to <code>true</code>, which describes <code>start &lt;= x &lt; finish</code>.</p>\n"}], "owner": {"reputation": 3047, "user_id": 10388629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/My8T3.png?s=128&g=1", "display_name": "Pika the Master of the Whales", "link": "https://stackoverflow.com/users/10388629/pika-the-master-of-the-whales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 53166235, "answer_count": 1, "score": -2, "last_activity_date": 1541483955, "creation_date": 1541473830, "question_id": 53165254, "link": "https://stackoverflow.com/questions/53165254/when-is-it-good-to-use-inclusive-vs-exclusive-ranges", "title": "When is it good to use inclusive vs exclusive ranges?", "body": "<p>Is there a reason to use an inclusive range instead of exclusive range or vice versa? Is it better to use this:</p>\n\n<pre><code>for i in 1..10\n    puts i\nend\n</code></pre>\n\n<p>or this:</p>\n\n<pre><code>for i in 1...11\n    puts i\nend\n</code></pre>\n\n<p>or are they just two ways of representing the exact same thing?</p>\n"}, {"tags": ["ruby-on-rails", "node.js", "ruby", "webserver", "puma"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10144855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a8d7030c029b09f14484f8fb370b4b?s=128&d=identicon&r=PG&f=1", "display_name": "NoName", "link": "https://stackoverflow.com/users/10144855/noname"}, "edited": false, "score": 0, "creation_date": 1541464944, "post_id": 53164125, "comment_id": 93219009, "body": "Do you think this will have any negative effect on other rails dependencies?"}, {"owner": {"reputation": 1746, "user_id": 3543371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41VUZ.jpg?s=128&g=1", "display_name": "jbielick", "link": "https://stackoverflow.com/users/3543371/jbielick"}, "reply_to_user": {"reputation": 11, "user_id": 10144855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a8d7030c029b09f14484f8fb370b4b?s=128&d=identicon&r=PG&f=1", "display_name": "NoName", "link": "https://stackoverflow.com/users/10144855/noname"}, "edited": false, "score": 0, "creation_date": 1541521135, "post_id": 53164125, "comment_id": 93241580, "body": "Does your application compile sass?"}], "tags": [], "owner": {"reputation": 1746, "user_id": 3543371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41VUZ.jpg?s=128&g=1", "display_name": "jbielick", "link": "https://stackoverflow.com/users/3543371/jbielick"}, "is_accepted": false, "score": 0, "last_activity_date": 1541463321, "creation_date": 1541463321, "answer_id": 53164125, "question_id": 53163836, "link": "https://stackoverflow.com/questions/53163836/how-can-i-bypass-rails-servers-restriction-in-regards-to-js-runtimes/53164125#53164125", "title": "How can I bypass rails server&#39;s restriction in regards to js runtimes?", "body": "<p>You may have to turn off the asset pipeline in rails. Try adding this to your <code>config/application.rb</code>:</p>\n\n<pre><code>config.assets.enabled = false\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10144855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a8d7030c029b09f14484f8fb370b4b?s=128&d=identicon&r=PG&f=1", "display_name": "NoName", "link": "https://stackoverflow.com/users/10144855/noname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541463321, "creation_date": 1541460803, "question_id": 53163836, "link": "https://stackoverflow.com/questions/53163836/how-can-i-bypass-rails-servers-restriction-in-regards-to-js-runtimes", "title": "How can I bypass rails server&#39;s restriction in regards to js runtimes?", "body": "<p>I am making a fairly large Rails webapp that will not be using any javascript in any form. Therefore, I didn't see the need to use nodejs/a js runtime (especially since I wish to be as security conscious as i can be- nodejs has some documented security issues). However, rails will not let me start the server unless I have a runtime installed. How can I bypass/get by this restriction? </p>\n"}, {"tags": ["ruby", "parsing", "http-1.1", "parslet"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1541483671, "post_id": 53163596, "comment_id": 93222707, "body": "does this implementation not provide what you need?  <a href=\"https://github.com/postmodern/net-http-server/blob/master/lib/net/http/server/parser.rb\" rel=\"nofollow noreferrer\">github.com/postmodern/net-http-server/blob/master/lib/net/ht&zwnj;&#8203;tp/&hellip;</a>"}, {"owner": {"reputation": 5040, "user_id": 1396395, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fe769223c305b9945f8b295d1f60f8d5?s=128&d=identicon&r=PG", "display_name": "ChuckE", "link": "https://stackoverflow.com/users/1396395/chucke"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1541493104, "post_id": 53163596, "comment_id": 93226349, "body": "No, and I&#39;ve seen this parser. If the header frame is chunked into different parts, it will trigger a parsing error, exactly because it doesn&#39;t buffer."}], "answers": [{"tags": [], "owner": {"reputation": 19268, "user_id": 23963, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9a5280831aec1b4b614eb1e5bf40baf?s=128&d=identicon&r=PG", "display_name": "Nigel Thorne", "link": "https://stackoverflow.com/users/23963/nigel-thorne"}, "is_accepted": false, "score": 0, "last_activity_date": 1543965170, "creation_date": 1543965170, "answer_id": 53622805, "question_id": 53163596, "link": "https://stackoverflow.com/questions/53163596/parslet-how-to-buffer-parse-incrementally-data/53622805#53622805", "title": "Parslet: How to Buffer/parse incrementally data", "body": "<p>Parslet matches a grammer against a whole document. </p>\n\n<p>If you want to allow it to parse a partial document you need to define your grammar such that the missing parts are optional. </p>\n\n<p>One approach may be to define a grammar that would match any one elements from the header, and define a 'the_rest' capture group that matches 'any.repeat' </p>\n\n<p>Then you could recursively call the parser each time you get more document... with \"the rest\" plus anything more you have read in. </p>\n\n<p>Each time you call it you would get one part of the header returned. </p>\n"}], "owner": {"reputation": 5040, "user_id": 1396395, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fe769223c305b9945f8b295d1f60f8d5?s=128&d=identicon&r=PG", "display_name": "ChuckE", "link": "https://stackoverflow.com/users/1396395/chucke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543965170, "creation_date": 1541459218, "question_id": 53163596, "link": "https://stackoverflow.com/questions/53163596/parslet-how-to-buffer-parse-incrementally-data", "title": "Parslet: How to Buffer/parse incrementally data", "body": "<p>I'm writing an HTTP/1 response parser with parslet. It works, but only when I send the full payload.</p>\n\n<p>I have smth like this:</p>\n\n<pre><code>rule(:response) {\n   response_line &gt;&gt; crlf &gt;&gt;\n   header.repeat.as(:headers) &gt;&gt; crlf &gt;&gt;\n   data.as(:data)\n}\nroot :response\n</code></pre>\n\n<p>But if I pass an incomplete payload, I get:</p>\n\n<pre><code>parser.parse(\"HTTP/1.1 200 OK\\r\\n\")\n#=&gt; Parslet::ParseFailed: Failed to match sequence (RESPONSE_LINE CRLF headers:(HEADER{0, }) CRLF data:DATA) at line 1 char 16.\n</code></pre>\n\n<p>I'd like to be able to feed bytes to the parser without failing, at least if they don't break the expectations. Is there a way to somehow \"buffer\" until some rule is broken, or all expectations are met?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1541473002, "last_edit_date": 1541473002, "creation_date": 1541463592, "answer_id": 53164154, "question_id": 53163579, "link": "https://stackoverflow.com/questions/53163579/group-by-an-array-of-hashes/53164154#53164154", "title": "Group By an Array of Hashes", "body": "<p>This is one way it would commonly be done.</p>\n\n<pre><code> array.each_with_object({}) {|g,h| h.update(g[:name]=&gt;g) {|_,o,n|\n   o.merge(count: o[:count] + n[:count]) } }.values\n  #=&gt; [{:id=&gt;1, :name=&gt;\"name\", :count=&gt;1},\n  #    {:id=&gt;1, :name=&gt;\"new name\", :count=&gt;1}]\n</code></pre>\n\n<p>This uses the form of <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-update\" rel=\"nofollow noreferrer\">Hash#update</a> (aka <code>merge!</code>) that employs a block to determine the values of keys that are present in both hashes being merged. \nSee the doc for definitions of the the three block variables, <code>_</code>, <code>o</code> and <code>n</code>. The first of these holds the the common key. It's common practice to use <code>_</code> for block variables that are not used in the block calculation.</p>\n\n<p>Note that the receiver of <code>values</code> is as follows.</p>\n\n<pre><code>array.each_with_object({}) {|g,h| h.update(g[:name]=&gt;g) {|_,o,n|\n  o.merge(count: o[:count] + n[:count]) } }\n  #=&gt; {\"name\"=&gt;{:id=&gt;1, :name=&gt;\"name\", :count=&gt;2},\n  #    \"new name\"=&gt;{:id=&gt;1, :name=&gt;\"new name\", :count=&gt;1}}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1642, "user_id": 688791, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91e966a93e5fdc80a1e6781e3e80ecde?s=128&d=identicon&r=PG", "display_name": "vladiim", "link": "https://stackoverflow.com/users/688791/vladiim"}, "edited": false, "score": 1, "creation_date": 1541471089, "post_id": 53164157, "comment_id": 93220195, "body": "<code>v.length</code> won&#39;t work as the counts need to be summed - I&#39;ve updated the question to make that clear."}], "tags": [], "owner": {"reputation": 1543, "user_id": 5801853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1b0fbad41fb9e1ee84161ebff1ddbbc?s=128&d=identicon&r=PG", "display_name": "yzalavin", "link": "https://stackoverflow.com/users/5801853/yzalavin"}, "is_accepted": false, "score": 2, "last_activity_date": 1541463625, "creation_date": 1541463625, "answer_id": 53164157, "question_id": 53163579, "link": "https://stackoverflow.com/questions/53163579/group-by-an-array-of-hashes/53164157#53164157", "title": "Group By an Array of Hashes", "body": "<p>You can group and map:</p>\n\n\n\n<pre><code>array\n  .group_by { |el| [el[:id], el[:name]] }\n  .map { |k,v| v.first.merge(count: v.length) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 2, "last_activity_date": 1541465220, "last_edit_date": 1541465220, "creation_date": 1541464909, "answer_id": 53164297, "question_id": 53163579, "link": "https://stackoverflow.com/questions/53163579/group-by-an-array-of-hashes/53164297#53164297", "title": "Group By an Array of Hashes", "body": "<p>Here's a slightly different take, which as a bonus produces the expected result if the <code>count</code> attribute for any element is greater than 1:</p>\n\n<pre><code>&gt; array.group_by { |e| [e[:id], e[:name]] }.values\n    .map { |group| group.first.merge(count: group.sum { |e| e[:count] }) }\n#&gt; [{:id=&gt;1, :name=&gt;\"name\", :count=&gt;2}, {:id=&gt;1, :name=&gt;\"new name\", :count=&gt;1}]\n\n&gt; array = [{:id=&gt;1, :name=&gt;\"name\", :count=&gt;2}, \n           {:id=&gt;1, :name=&gt;\"name\", :count=&gt;3}, \n           {:id=&gt;1, :name=&gt;\"new name\", :count=&gt;1}]\n&gt; array.group_by { |e| [e[:id], e[:name]] }.values\n    .map { |group| group.first.merge(count: group.sum { |e| e[:count] }) }\n#&gt; [{:id=&gt;1, :name=&gt;\"name\", :count=&gt;5}, {:id=&gt;1, :name=&gt;\"new name\", :count=&gt;1}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1541492224, "creation_date": 1541492224, "answer_id": 53168092, "question_id": 53163579, "link": "https://stackoverflow.com/questions/53163579/group-by-an-array-of-hashes/53168092#53168092", "title": "Group By an Array of Hashes", "body": "<p>Another option, where you initialise the hash in map_with_object:</p>\n\n<pre><code>array\n  .group_by { |h| h[:name] }.values\n  .map{ |e| e.map.with_object({name: e[0][:name], id: e[0][:id], count: 0}){ |h, nh| nh[:count] += h[:count] } }\n#=&gt; [{:name=&gt;\"name\", :id=&gt;1, :count=&gt;3}, {:name=&gt;\"new name\", :id=&gt;1, :count=&gt;1}]\n</code></pre>\n"}], "owner": {"reputation": 1642, "user_id": 688791, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91e966a93e5fdc80a1e6781e3e80ecde?s=128&d=identicon&r=PG", "display_name": "vladiim", "link": "https://stackoverflow.com/users/688791/vladiim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1541492224, "creation_date": 1541459112, "last_edit_date": 1541471106, "question_id": 53163579, "link": "https://stackoverflow.com/questions/53163579/group-by-an-array-of-hashes", "title": "Group By an Array of Hashes", "body": "<p>For the array of hashes:</p>\n\n<pre><code>array = [{id: 1, name: 'name', count: 2},\n         {id: 1, name: 'name', count: 1},\n         {id: 1, name: 'new name', count: 1}]\n</code></pre>\n\n<p>I'd like the result:</p>\n\n<pre><code>[{id: 1, name: 'name', count: 3},\n {id: 1, name: 'new name', count: 1}]\n</code></pre>\n\n<p>I've achieved this with:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>grouped_data = array.each_with_object(Hash.new(0)) do |row, sum|\n  sum[\"#{row.fetch(:id)} #{row.fetch(:name)}\"] += row.fetch(:count).to_i\nend\n\nresult = array.uniq.each do |row|\n  row[:count] = grouped_data[\"#{row.fetch(:id)} #{row.fetch(:name)}\"]\n  row\nend\n</code></pre>\n\n<p>Is there a more elegant way to achieve the desired result?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 1, "creation_date": 1541447737, "post_id": 53161215, "comment_id": 93212945, "body": "Pretty much a duplicate: <a href=\"https://stackoverflow.com/q/4130364/1531971\">stackoverflow.com/q/4130364/1531971</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1541447996, "post_id": 53161215, "comment_id": 93213061, "body": "The indentation here is extremely chaotic and it&#39;s making the code hard to follow. Remember to clean up your code, especially when asking on Stack Overflow. It helps us establish intent."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1541449599, "post_id": 53161215, "comment_id": 93213750, "body": "Try changing <code>include?</code> to <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-start_with-3F\" rel=\"nofollow noreferrer\">String#start_with?</a>."}, {"owner": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 0, "creation_date": 1541452373, "post_id": 53161215, "comment_id": 93214963, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4130364/does-ruby-have-a-string-startswithabc-built-in-method\">Does Ruby have a string.startswith(&quot;abc&quot;) built in method?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1541457761, "post_id": 53161368, "comment_id": 93217123, "body": "@moveson As Carey pointed out, the request was actually for &quot;search from the beginning of the string&quot; so it needs the <code>\\A</code> anchor."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 3, "last_activity_date": 1541450441, "last_edit_date": 1541450441, "creation_date": 1541448071, "answer_id": 53161368, "question_id": 53161215, "link": "https://stackoverflow.com/questions/53161215/searching-for-a-string-using-user-input/53161368#53161368", "title": "Searching for a string using user input", "body": "<p>There's a really easy way of doing this with <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-grep\" rel=\"nofollow noreferrer\"><code>grep</code></a>:</p>\n\n<pre><code>matches = list.grep(search_artist)\n\nif (matches.empty?)\n  puts \"none found\"\nend\n</code></pre>\n\n<p>To count the number of matches you can just <code>matches.length</code>.</p>\n\n<p>If you want a <em>case insensitive</em> match, then you want this:</p>\n\n<pre><code>matches = list.grep(Regexp.new(search_artist, Regexp::IGNORECASE))\n</code></pre>\n\n<p>Where that flag creates a case-insensitive regular expression to match more broadly.</p>\n\n<p><strong>Edit</strong>: To anchor this search to the beginning of the string:</p>\n\n<pre><code>matches = list.grep(Regexp.new('\\A' + Regexp.escape(search_artist), Regexp::IGNORECASE))\n</code></pre>\n\n<p>Where <code>\\A</code> anchors to the beginning of the string.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1541453230, "creation_date": 1541453230, "answer_id": 53162493, "question_id": 53161215, "link": "https://stackoverflow.com/questions/53161215/searching-for-a-string-using-user-input/53162493#53162493", "title": "Searching for a string using user input", "body": "<p>Other option, just if the search is limited to the first letter, case insensitive:</p>\n\n<pre><code>found = list.select { |x| [search_artist.downcase, search_artist.upcase].include? x[0] }\nfound.each { |e| puts e }\nputs \"Found #{found.size} records\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 0, "last_activity_date": 1541457768, "creation_date": 1541457768, "answer_id": 53163339, "question_id": 53161215, "link": "https://stackoverflow.com/questions/53161215/searching-for-a-string-using-user-input/53163339#53163339", "title": "Searching for a string using user input", "body": "<p>Without Regular expressions:</p>\n\n<pre><code>puts \"Enter Artist(all or partial name):\"   \nsearch_artist = gets.chomp\n\nputs list.select do |x|\n  x.artist.start_with?(search_artist)\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10609698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6806d10458b442effba924eccc4758c?s=128&d=identicon&r=PG&f=1", "display_name": "cooljoe182", "link": "https://stackoverflow.com/users/10609698/cooljoe182"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1541457768, "creation_date": 1541447378, "question_id": 53161215, "link": "https://stackoverflow.com/questions/53161215/searching-for-a-string-using-user-input", "title": "Searching for a string using user input", "body": "<p>My goal is to have the user enter a string to find a string in an array. Im using strings include? function to search but its returning the wrong data.</p>\n\n<pre><code> puts \"Enter Artist(all or partial name):\"   \n search_artist = gets.chomp\n list.each do |x|\n     if x.artist.include? (search_artist)\n       num += 1\n       x.to_s\n     else\n       puts \"none found\"\n     end   end\n</code></pre>\n\n<p>search_artist = 'a' (because im looking for AARON...)</p>\n\n<p>returns:</p>\n\n<pre><code>AARON KDL NOT VALID 2\nZAC CHICKEN ROCK 1289\n2 records found\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>AARON KDL NOT VALID 2     \n1 record found`\n</code></pre>\n\n<p>The problem is that both strings include 'a' somewhere in the string. \nHow do I search from the beginning of the string?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "exception"], "comments": [{"owner": {"reputation": 163, "user_id": 9079713, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gy1e73fCpeI/AAAAAAAAAAI/AAAAAAAAE8Q/AlIvicFBMpw/photo.jpg?sz=128", "display_name": "Yann PRONO", "link": "https://stackoverflow.com/users/9079713/yann-prono"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1541447524, "post_id": 53160928, "comment_id": 93212856, "body": "According to the documentation, all subdirectories of app in the application and engines present at boot time. For example, app/controllers. They do not need to be the default ones, any custom directories like app/workers belong automatically to autoload_paths. So in my case, my module is autoloaded. So I should be able to use the exception"}], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1541455280, "post_id": 53161352, "comment_id": 93216164, "body": "I guess you mean *snake_case"}], "tags": [], "owner": {"reputation": 163, "user_id": 9079713, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gy1e73fCpeI/AAAAAAAAAAI/AAAAAAAAE8Q/AlIvicFBMpw/photo.jpg?sz=128", "display_name": "Yann PRONO", "link": "https://stackoverflow.com/users/9079713/yann-prono"}, "is_accepted": false, "score": 2, "last_activity_date": 1541530628, "last_edit_date": 1541530628, "creation_date": 1541447966, "answer_id": 53161352, "question_id": 53160928, "link": "https://stackoverflow.com/questions/53160928/cannot-raise-custom-exception-in-rails-5-2/53161352#53161352", "title": "Cannot raise custom exception in Rails 5.2", "body": "<p>My bad, I wrote the file name in CamelCase, not in snake_case...</p>\n"}], "owner": {"reputation": 163, "user_id": 9079713, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gy1e73fCpeI/AAAAAAAAAAI/AAAAAAAAE8Q/AlIvicFBMpw/photo.jpg?sz=128", "display_name": "Yann PRONO", "link": "https://stackoverflow.com/users/9079713/yann-prono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541530628, "creation_date": 1541446093, "last_edit_date": 1541447979, "question_id": 53160928, "link": "https://stackoverflow.com/questions/53160928/cannot-raise-custom-exception-in-rails-5-2", "title": "Cannot raise custom exception in Rails 5.2", "body": "<p>I am developing a RoR application. I need to use a custom exception I implemented. It looks like this:\n</p>\n\n<pre><code># app/exceptions/JobError.rb\nmodule Exceptions\n   class JobError &lt; StandardError\n      # ... \n   end\nend\n</code></pre>\n\n<p>However, I got a <code>uninitialized constant JobError</code> when I raise the exception. I tried different namespaces but none of them work:\n</p>\n\n<pre><code>raise JobError.new()\nraise Exceptions::JobError.new()\nraise ::Exceptions::JobError.new()\n</code></pre>\n\n<p>Any idea?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "tdd", "minitest"], "comments": [{"owner": {"reputation": 1543, "user_id": 5801853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1b0fbad41fb9e1ee84161ebff1ddbbc?s=128&d=identicon&r=PG", "display_name": "yzalavin", "link": "https://stackoverflow.com/users/5801853/yzalavin"}, "edited": false, "score": 0, "creation_date": 1541464124, "post_id": 53160909, "comment_id": 93218854, "body": "You do not need to test Devise since it is already tested a lot. Your example has nothing in common with Devise because you test your custom attributes. You need to write validations in your User model."}, {"owner": {"reputation": 1543, "user_id": 5801853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1b0fbad41fb9e1ee84161ebff1ddbbc?s=128&d=identicon&r=PG", "display_name": "yzalavin", "link": "https://stackoverflow.com/users/5801853/yzalavin"}, "edited": false, "score": 0, "creation_date": 1541464174, "post_id": 53160909, "comment_id": 93218860, "body": "To test validation better replace <code>User.create</code> with <code>User.new</code> to avoid redundant database request."}], "owner": {"reputation": 1, "user_id": 10609558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nodDG.jpg?s=128&g=1", "display_name": "Nikita Vasilev", "link": "https://stackoverflow.com/users/10609558/nikita-vasilev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541446036, "creation_date": 1541446036, "question_id": 53160909, "link": "https://stackoverflow.com/questions/53160909/rails-model-testing-with-minitest-and-devise-gem", "title": "Rails - Model Testing with MiniTest and Devise gem", "body": "<p>I'm trying to test the User Model, which I've got Devise authentication.\nBut I've got a failure:</p>\n\n<blockquote>\n  <p>Failure:\n  UserTest#test_should_be_valid [/home/nikki/Documents/TheHackingProject/week06/monday/the_private_club/test/models/user_test.rb:12]:\n  Expected false to be truthy.</p>\n</blockquote>\n\n<p>This is my user_test.rb file:</p>\n\n<pre><code>require 'test_helper'\n\nclass UserTest &lt; ActiveSupport::TestCase\n  def setup\n    @user = User.create(\n      first_name: 'Marge',\n      last_name: 'Simpson',\n      email: 'marge@simpson.com'\n      )\n  end\n\n  test 'should be valid' do\n    assert @user.valid?\n  end\n\n  test 'first name cant be blank' do\n    @user.first_name = \"\"\n    assert_not @user.valid?\n  end\n\n  test 'last name cant be blank' do\n    @user.last_name = \"\"\n    assert_not @user.valid?\n  end\nend\n</code></pre>\n\n<p>And this my schema.rb file:</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 2018_11_05_115404) do\n\n  # These are extensions that must be enabled in order to support this database\n  enable_extension \"plpgsql\"\n\n  create_table \"users\", force: :cascade do |t|\n    t.string \"email\", default: \"\", null: false\n    t.string \"encrypted_password\", default: \"\", null: false\n    t.string \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.string \"first_name\"\n    t.string \"last_name\"\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n    t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n  end\n\nend\n</code></pre>\n\n<p>Also, I don't understand how can I test the password which is encrypted?</p>\n"}, {"tags": ["ruby", "file", "io", "menu"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1541445118, "post_id": 53160211, "comment_id": 93211795, "body": "1) <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-ljust\" rel=\"nofollow noreferrer\"><code>String#ljust</code></a> 2 and 3) the extra 2 are <code>.</code> (current directory) and <code>..</code> (parent directory) as show in <code>Dir#foreach</code> maybe use <code>Dir.glob(&#39;.&#47;database&#47;*)</code> instead"}], "answers": [{"comments": [{"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1541447285, "post_id": 53160912, "comment_id": 93212763, "body": "For the last question you could save all file names in an array (i.e. <code>files = Dir[&quot;.&#47;database&#47;*.*&quot;]</code>) and then find the selected file name within that array."}, {"owner": {"reputation": 37, "user_id": 3797760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09980727fe7eff2c124db82cb36c5838?s=128&d=identicon&r=PG&f=1", "display_name": "user3797760", "link": "https://stackoverflow.com/users/3797760/user3797760"}, "edited": false, "score": 0, "creation_date": 1541490200, "post_id": 53160912, "comment_id": 93225022, "body": "You guys are awesome! I made It working nice with your suggestions! Thank you very much."}], "tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": true, "score": 0, "last_activity_date": 1541446047, "creation_date": 1541446047, "answer_id": 53160912, "question_id": 53160211, "link": "https://stackoverflow.com/questions/53160211/ruby-several-problems-while-displaying-files/53160912#53160912", "title": "Ruby - Several problems while displaying files", "body": "<blockquote>\n  <p>The most obvious question is: Is it possible to write content in the layout without destroying it? I mean, if a filename is too long, it's normal that the design breaks. But even if it would fit perfectly the design is breaking.</p>\n</blockquote>\n\n<p>The code does exactly what you wrote. <code>puts</code> command prints spaces, hashbang, vertical line, then spaces, filename and given number of spaces again. To fix its result you need to adjust the length of filename to some limit, by adding spaces to the end. You could use <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-ljust\" rel=\"nofollow noreferrer\">ljust</a> method for this purpose:</p>\n\n<pre><code>puts  \"    #|   #{files}. #{entry.to_s.ljust(35)} |#\"\n</code></pre>\n\n<p>With this code the filename will be padded with spaces to the length of 35 chars.</p>\n\n<blockquote>\n  <p>next question: There are just 3 files in the directory. But I got 5 results.. why? What are these dots and how can I get rid of them?</p>\n</blockquote>\n\n<p>These are special hidden files. <code>.</code> is for the directory itself, <code>..</code> is for its parent directory. See <a href=\"https://en.wikipedia.org/wiki/Hidden_file_and_hidden_directory\" rel=\"nofollow noreferrer\">here</a> for more details. You could skip them like this, for example:</p>\n\n<pre><code>Dir.entries(\"./database/\").select { |entry| !%w[. ..].include?(entry) }.each do |entry|\n  ...\n</code></pre>\n\n<p>The other option is to use <a href=\"http://ruby-doc.org/core-2.5.3/Dir.html#method-c-children\" rel=\"nofollow noreferrer\">children</a> method:</p>\n\n<pre><code>Dir.children(\"./database/\").each do |entry|\n  ...\n</code></pre>\n\n<blockquote>\n  <p>last question: if I ask the user which file he wants to delete. how can I assure to pick the right one, because 1-3 is just generated by file += 1 so I cannot know what is the users 1 or 2.</p>\n</blockquote>\n\n<p>Hm. I don't think it's a good idea actually. In multiprocess systems another process could delete the file in the directory after you printed its content but before the user makes a selection. As a result, an incorrect file is selected.</p>\n"}], "owner": {"reputation": 37, "user_id": 3797760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09980727fe7eff2c124db82cb36c5838?s=128&d=identicon&r=PG&f=1", "display_name": "user3797760", "link": "https://stackoverflow.com/users/3797760/user3797760"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 53160912, "answer_count": 1, "score": 0, "last_activity_date": 1541446047, "creation_date": 1541443027, "question_id": 53160211, "link": "https://stackoverflow.com/questions/53160211/ruby-several-problems-while-displaying-files", "title": "Ruby - Several problems while displaying files", "body": "<p>G'day, </p>\n\n<p>I am writing a little tool. But discovered several problems in the same code chunk. So because of not knowing what to do, I ask here now.</p>\n\n<p>the Code:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def deleteExistingDatabase\n  puts &lt;&lt;-DELETEDATABASE\n    ####################################################\n    #|                                                |#\n    #|  Delete a existing Database                    |#\n    #|  ------------------                            |#\n    #|                                                |#\n    #|  Which one do you want to delete?              |#\n    #|  ------                                        |#\n  DELETEDATABASE\n  files = 0\n  Dir.foreach(\"./database/\") do |entry|\n    files += 1\n    puts  \"    #|   #{files}. #{entry}                                     |#\"\n  end\n\nend\n</code></pre>\n\n<p>and this is the result:</p>\n\n<pre class=\"lang-bash prettyprint-override\"><code>    ####################################################\n    #|                                                |#\n    #|  Delete a existing Database                    |#\n    #|  ------------------                            |#\n    #|                                                |#\n    #|  Which one do you want to delete?              |#\n    #|  ------                                        |#\n    #|   1. aFileWithAVeryLongNameIsInHere.db                                     |#\n    #|   2. middlelenghts.db                                     |#\n    #|   3. ..                                     |#\n    #|   4. short.db                                     |#\n    #|   5. .                                     |#\n</code></pre>\n\n<p>The most obvious question is: Is it possible to write content in the layout without destroying it? I mean, if a filename is too long, its normal that the design breaks. But even if it would fit perfectly the design is breaking.</p>\n\n<p>next question: There are just 3 files in the directory. But I got 5 results.. why? What are these dots and how can I get rid of them?</p>\n\n<p>last question: if I ask the user which file he wants to delete. how can I assure to pick the right one, because 1-3 is just generated by file += 1 so I cannot know what is the users 1 or 2.</p>\n\n<p>I hope you guys know how to help me, because I am totaly lost.\nThanks in advance, VB </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree"], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 6065378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65b46ccbd90a8e32741a79e7e4ec953f?s=128&d=identicon&r=PG", "display_name": "Damian Legawiec", "link": "https://stackoverflow.com/users/6065378/damian-legawiec"}, "is_accepted": false, "score": 0, "last_activity_date": 1541943906, "creation_date": 1541943906, "answer_id": 53249362, "question_id": 53158839, "link": "https://stackoverflow.com/questions/53158839/spree-api-authentication-extension-not-working/53249362#53249362", "title": "Spree API Authentication extension not working", "body": "<p>You need to add the routes in v1 namespace in <code>config/routes.rb</code>:</p>\n\n<pre><code>namespace :api do\n  namespace :v1 do\n    resource :users do\n      member do\n        post :sign_in\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8020641, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xSX5loPkHog/AAAAAAAAAAI/AAAAAAAAABM/cLTVF9kaSzE/photo.jpg?sz=128", "display_name": "Hector Toro", "link": "https://stackoverflow.com/users/8020641/hector-toro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541943906, "creation_date": 1541436957, "question_id": 53158839, "link": "https://stackoverflow.com/questions/53158839/spree-api-authentication-extension-not-working", "title": "Spree API Authentication extension not working", "body": "<p>I'm working on an extension to authenticate users over the Spree API. I have search a lot but almost no information exits on this topic, and the few extensions I have found doesn't work.</p>\n\n<p>I created a extension based on the ones I have found and I'm getting the following error:</p>\n\n<p>AbstractController::ActionNotFound (The action 'sign_in' could not be found for Spree::UsersController)</p>\n\n<pre><code>module Spree\n  module Api\n\n      #class UsersController &lt; Spree::Api::V1::UsersController \n      Spree::Api::V1::UsersController.class_eval do\n        before_action :authenticate_user, :except =&gt; [:sign_up, :sign_in]\n\n        def sign_up\n\n          @user = Spree::User.find_by_email(params[:user][:email])\n\n          if @user.present?\n            render \"spree/api/users/user_exists\", :status =&gt; 401 and return\n          end\n\n          @user = Spree::User.new(user_params)\n          if !@user.save\n            unauthorized\n            return\n          end\n          @user.generate_spree_api_key!\n        end\n\n        def sign_in\n          puts(\"hola controller\")\n          @user = Spree::User.find_by_email(params[:user][:email])\n          if !@user.present? || !@user.valid_password?(params[:user][:password])\n            unauthorized\n            return\n          end\n          @user.generate_spree_api_key! if @user.spree_api_key.blank?\n        end\n\n\n        def user_params\n          params.require(:user).permit(:email, :password, :password_confirmation)\n        end\n\n\n    #end\n    end\n  end\nend\n</code></pre>\n\n<p>My routes.rb</p>\n\n<pre><code>Spree::Core::Engine.add_routes do\n  # Add your extension routes here\n  namespace :api, defaults: {format: 'json'} do\n    resource :users do\n        #resource :v1 do\n        member do\n          #post :sign_up\n          post :sign_in\n        end\n    #end\n    end\n  end\nend\n</code></pre>\n\n<p>Can you please help me figuring out what am I missing?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1541434367, "post_id": 53157628, "comment_id": 93206788, "body": "look up the builder pattern, that&#39;s better than doing dynamic methods here."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 3, "last_activity_date": 1541438753, "creation_date": 1541438753, "answer_id": 53159272, "question_id": 53157628, "link": "https://stackoverflow.com/questions/53157628/ruby-define-method-with-args/53159272#53159272", "title": "Ruby: define method with args", "body": "<p><code>case (type)</code> is often a strong sign you need to create subclasses instead of having an omniclass that just pretends to be different classes.</p>\n\n<p>For example:</p>\n\n<pre><code>class Radio &lt; BaseClass\n  def call(id, _file_name)\n    # ...\n  end\nend\n\nclass Pan &lt; BaseClass\n  def call(id, _file_name)\n    # ...\n  end\nend\n</code></pre>\n\n<p>Then you just instantiate the right class and the right method gets called.</p>\n\n<p>This is one of the principles of object-oriented design where you specialize classes where appropriate instead of having an unespecialized class that does many different, often contradictory things.</p>\n\n<p>You could do some trickery with <code>method_missing</code> or by calling <code>define_method</code> but that's a lot of work compared to defining a subclass in this case.</p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 7082648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6161177576ed098ad9f9cbb56d5eea6?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/7082648/ravi"}, "is_accepted": true, "score": 0, "last_activity_date": 1547572857, "creation_date": 1547572857, "answer_id": 54203885, "question_id": 53157628, "link": "https://stackoverflow.com/questions/53157628/ruby-define-method-with-args/54203885#54203885", "title": "Ruby: define method with args", "body": "<p>I think eval is the better choice to write less code</p>\n\n<pre><code>def construct_payload(id, file_name, type)\n  eval(\"base(id).merge(#{type}(file_name))\")\nend\n\ndef base(_id)\n    {\n      \"id\": _id,\n    }\n  end\n\n def radio(file)\n   { \n      \"mode\": \"ds\",\n      \"file\": file\n    }\n end\n\n def pan(file)\n   { \n      \"mode\": \"pr\",\n      \"file\": file\n    }\n end\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 7082648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6161177576ed098ad9f9cbb56d5eea6?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/7082648/ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 2, "accepted_answer_id": 54203885, "answer_count": 2, "score": 0, "last_activity_date": 1547572857, "creation_date": 1541432765, "last_edit_date": 1541433566, "question_id": 53157628, "link": "https://stackoverflow.com/questions/53157628/ruby-define-method-with-args", "title": "Ruby: define method with args", "body": "<p>I'm trying to refactor the code by defining the method dynamically with args. I've tried to use  Define_method but it's throwing an error and I've been forced to define define_singleton_method.</p>\n\n<p>Here is my code, I want to remove all the methods with call_* prefix.</p>\n\n<pre><code>def construct_payload(id, file_name, type)\n    case type\n    when 'Radio' then call_radio(id, file_name)\n    when 'Pan' then call_pan(id, file_name)\n    end\n  end\n\n\n  def call_radio(_id, _file_name)\n    base(_id).merge(radio(_file_name))\n  end\n\n  def call_pan(_id, _file_name)\n    base(_id).merge(pan(_file_name))\n  end\n\n  def base(_id)\n    {\n      \"id\": _id,\n    }\n  end\n\n def radio(file)\n   { \n      \"mode\": \"ds\",\n      \"file\": file\n    }\n end\n\n def pan(file)\n   { \n      \"mode\": \"pr\",\n      \"file\": file\n    }\n end\n\n#enter code here\n</code></pre>\n\n<p>Is there a way I can define <code>call_radio</code> and <code>call_pan</code> methods dynamically?</p>\n"}, {"tags": ["ruby", "prometheus"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1541486098, "post_id": 53156877, "comment_id": 93223527, "body": "A queue of what? your question is vague.  Please see <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1541487139, "creation_date": 1541487139, "answer_id": 53166997, "question_id": 53156877, "link": "https://stackoverflow.com/questions/53156877/report-queue-size-using-prometheus-client-ruby-client/53166997#53166997", "title": "Report queue size using prometheus client_ruby client", "body": "<p>The short answer to your vague question would be probably yes. A look at the <a href=\"https://prometheus.io/docs/introduction/overview/#features\" rel=\"nofollow noreferrer\">documentation</a> shows:</p>\n\n<h3>Overview</h3>\n\n<ul>\n<li>a multi-dimensional data model with time series data identified by metric name and key/value pairs</li>\n<li>a flexible query language to leverage this dimensionality</li>\n<li>no reliance on distributed storage; single server nodes are autonomous</li>\n<li>time series collection happens via a pull model over HTTP</li>\n<li>pushing time series is supported via an intermediary gateway</li>\n<li>targets are discovered via service discovery or static configuration</li>\n<li>multiple modes of graphing and dashboarding support</li>\n</ul>\n\n<h3>Data Model</h3>\n\n<blockquote>\n  <p>Prometheus fundamentally stores all data as time series: streams of\n  timestamped values belonging to the same metric and the same set of\n  labeled dimensions. Besides stored time series, Prometheus may\n  generate temporary derived time series as the result of queries.</p>\n</blockquote>\n"}], "owner": {"reputation": 129, "user_id": 678853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/77192b7b33034a25d30ca2810fcf836a?s=128&d=identicon&r=PG", "display_name": "rgoncalves", "link": "https://stackoverflow.com/users/678853/rgoncalves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541487139, "creation_date": 1541429941, "question_id": 53156877, "link": "https://stackoverflow.com/questions/53156877/report-queue-size-using-prometheus-client-ruby-client", "title": "Report queue size using prometheus client_ruby client", "body": "<p>I'm trying to export the size of an internal queue. I don't want to maintain  a gauge counter, using incr/decr. What I need is to retrieve the actual queue size at the scrap moment. Is that possible using the prometheus ruby client?</p>\n"}, {"tags": ["ruby", "xml", "rexml"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7945585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f21d3ae1002bf19ab65b0ca12b02aa?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/7945585/morris"}, "edited": false, "score": 0, "creation_date": 1541536912, "post_id": 53164182, "comment_id": 93249490, "body": "In your solution last element refers to nil, I have modified it as <code>if i.next_element.attributes[&quot;ref&quot;] != nil</code> and now it works perfectly. Thanks!"}], "tags": [], "owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "is_accepted": true, "score": 0, "last_activity_date": 1541463837, "creation_date": 1541463837, "answer_id": 53164182, "question_id": 53156687, "link": "https://stackoverflow.com/questions/53156687/rexml-ruby-next-element/53164182#53164182", "title": "REXML ruby next element", "body": "<p>I think you want to use <code>next_element</code> instead. This produces the desired output:</p>\n\n<pre><code>require \"rexml/document\"\ninclude REXML\ninputFileName = ARGV[0]\nfile = File.new(inputFileName)\ndoc = Document.new(file)\n\ndoc.elements.each(\"way/nd\") do |i|\n  next unless i.next_element\n  puts \"#{i.attributes[\"ref\"]} -&gt; #{i.next_element.attributes['ref']}\"\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7945585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f21d3ae1002bf19ab65b0ca12b02aa?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/7945585/morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 53164182, "answer_count": 1, "score": 0, "last_activity_date": 1541463837, "creation_date": 1541429218, "question_id": 53156687, "link": "https://stackoverflow.com/questions/53156687/rexml-ruby-next-element", "title": "REXML ruby next element", "body": "<p>I'm trying to get element and next element from XML</p>\n\n<pre><code>&lt;way&gt;\n &lt;nd ref=\"4979923479\"/&gt;\n &lt;nd ref=\"4979923478\"/&gt;\n &lt;nd ref=\"5721236634\"/&gt;\n &lt;nd ref=\"5721236635\"/&gt;\n &lt;nd ref=\"5721236636\"/&gt;\n &lt;nd ref=\"5721236637\"/&gt;\n &lt;nd ref=\"4979923477\"/&gt;\n &lt;nd ref=\"5721236638\"/&gt;\n &lt;nd ref=\"5721236639\"/&gt;\n&lt;/way&gt;\n</code></pre>\n\n<p>Here what I have tried to do, but instead of \"puts i.attributes[\"ref\"]\" I need something like \"puts \"#{i.attributes[\"ref\"]} -> i.next (i+1).attributes[\"ref\"]</p>\n\n<pre><code>require \"rexml/document\"\ninclude REXML\ninputFileName = ARGV[0]\nfile = File.new(inputFileName)\ndoc = Document.new(file)\n\ndoc.elements.each(\"way/nd\") do |i|\n    if i.next != nil\n        puts i.attributes[\"ref\"]\n    end\nend\n</code></pre>\n\n<p>Actual output is just list of all nd's</p>\n\n<pre><code>4979923479\n4979923478\n5721236634\n5721236635\n5721236636\n5721236637\n4979923477\n5721236638\n5721236639\n</code></pre>\n\n<p>Desired output is:</p>\n\n<pre><code>4979923479 -&gt; 4979923478\n4979923478 -&gt; 5721236634\n5721236634 -&gt; 5721236635\n5721236635 -&gt; 5721236636\n5721236636 -&gt; 5721236637\n5721236637 -&gt; 4979923477\n4979923477 -&gt; 5721236638\n5721236638 -&gt; 5721236639\n</code></pre>\n"}, {"tags": ["ruby", "database", "entity-relationship"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1541427113, "post_id": 53155936, "comment_id": 93202419, "body": "Assuming this is rails (based on the information provided) the <a href=\"https://github.com/voormedia/rails-erd\" rel=\"nofollow noreferrer\"><code>rails-erd</code></a> gem does a decent job by leveraging the ORM relationships defined in the models"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1541429246, "post_id": 53155936, "comment_id": 93203707, "body": "What he said ^^ --- but to emphasise, this uses information from the <b>models</b>  (e.g. <code>belongs_to :user</code>) and not the <code>schema.rb</code> file. In order to only use <code>schema.rb</code>, you really need to have set up correct foreign key constrains everywhere, which rails doesn&#39;t do by default (you need to explicitly define them in migrations)."}], "owner": {"reputation": 1, "user_id": 3820350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf765c443d971aab16bb8d7903462e2?s=128&d=identicon&r=PG&f=1", "display_name": "user3820350", "link": "https://stackoverflow.com/users/3820350/user3820350"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541426547, "creation_date": 1541426547, "question_id": 53155936, "link": "https://stackoverflow.com/questions/53155936/how-can-i-convert-rb-file-to-an-entity-relationship-diagram", "title": "How can I convert .rb file to an entity relationship diagram?", "body": "<p>I would like to convert schema.rb file to an entity relationship diagram, in order to create a visual graph of my backend model. </p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 3, "creation_date": 1541425046, "post_id": 53155485, "comment_id": 93201261, "body": "It&#39;s keyword param: <a href=\"https://robots.thoughtbot.com/ruby-2-keyword-arguments\" rel=\"nofollow noreferrer\">robots.thoughtbot.com/ruby-2-keyword-arguments</a>"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1541453552, "post_id": 53155485, "comment_id": 93215428, "body": "FYI the name of that symbol is &quot;colon&quot;. Google for &quot;ruby argument colon&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1541436242, "creation_date": 1541436242, "answer_id": 53158634, "question_id": 53155485, "link": "https://stackoverflow.com/questions/53155485/initialize-ruby-class-with-symbol-with-two-points-after-menu/53158634#53158634", "title": "Initialize Ruby class with symbol with two points after (menu:)", "body": "<p>This is a feature introduced in Ruby 2.0 called \"keyword arguments\" which if you've used Python or Objective-C are probably a lot more familiar. A standard argument list looks like:</p>\n\n<pre><code>def f(x)   # Example: f(1)\ndef f(x,y) # Example: f(1,2)\n</code></pre>\n\n<p>Now where defaults are involved:</p>\n\n<pre><code>def f(x=1, y=2) # Example: f(0) or f(0, 3)\n</code></pre>\n\n<p>Note here you can't call <code>f(,3)</code> if you wanted <code>x</code> to use its default value.</p>\n\n<p>The Ruby 2.0 <em>keyword-argument</em> version fixes this problem:</p>\n\n<pre><code>def f(x:)       # Example: f(x: 1)\ndef f(x:1, y:2) # Example: f(y: 3)\n</code></pre>\n\n<p>The <code>x:</code> with no value following means it a named argument with no default and so is <em>required</em>. Calling the method without it produces an error.</p>\n"}], "owner": {"reputation": 859, "user_id": 7227222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec1eb8473ab73ded224fbbdc2414005?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertMunichMar", "link": "https://stackoverflow.com/users/7227222/albertmunichmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 53158634, "answer_count": 1, "score": 1, "last_activity_date": 1541436242, "creation_date": 1541424957, "question_id": 53155485, "link": "https://stackoverflow.com/questions/53155485/initialize-ruby-class-with-symbol-with-two-points-after-menu", "title": "Initialize Ruby class with symbol with two points after (menu:)", "body": "<p>I have following class:</p>\n\n<pre><code>class Takeaway\n  def initialize(menu:)\n    @menu = menu\n  end\n\n  def print_menu\n    menu.print\n  end\n\n  private\n\n  attr_reader :menu\nend\n</code></pre>\n\n<p>This class passes my test in RSpec:</p>\n\n<pre><code>require \"takeaway\"\n\nRSpec.describe Takeaway do\n\n  subject(:takeaway) { described_class.new(menu: menu) }\n\n  let(:menu) { double(:menu, print: printed_menu) }\n  let(:printed_menu) { \"Chicken: \u20ac3.5\" }\n\n  it \"shows the menu with the dishes and prices\" do\n    expect(takeaway.print_menu).to eq(printed_menu)\n  end\n\nend\n</code></pre>\n\n<p>I don't understand the line: <code>def initialize(menu:)</code></p>\n\n<p>If I get rid of the two points in menu, test does not pass. What is this object? A symbol?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oracle", "activerecord"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1541428344, "post_id": 53155095, "comment_id": 93203152, "body": "Yes, this syntax is almost certainly from the adapter you&#39;re using.  I&#39;d check that project for log help"}], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541423420, "creation_date": 1541423420, "question_id": 53155095, "link": "https://stackoverflow.com/questions/53155095/activerecord-logging-sql-format", "title": "Activerecord logging sql format", "body": "<p>I use Sinatra as webserver with activerecord as ORM.\nMy adapter is oracle_enhanced.\nI activate logging like this</p>\n\n<pre><code>LOG = Logger.new( \"./logs/#{File.basename(__FILE__)}_log.txt\", 'daily' )\nActiveRecord::Base.logger = LOG\nActiveSupport::LogSubscriber.colorize_logging = false\n</code></pre>\n\n<p>Everything is ok except when I update the model it is logged in this form</p>\n\n<pre><code>D, [2018-11-05T09:38:11.426185 #5540] DEBUG -- :   SQL (0.0ms)  UPDATE \"MYTABLE\" \nSET \"DESCRIPTION\" = :a1 WHERE \"MYTABLE\".\"ID\" = 10121  [[\"description\", \"some text\"]]\n</code></pre>\n\n<p>and worse, if this results in an error the sql is only partial, the parameter part is lost..</p>\n\n<p>Is there a way to get the logging the following way, so that I can execute the sql in eg Sql*Plus or SqlDeveloper ?</p>\n\n<pre><code>UPDATE \"MYTABLE\" SET \"DESCRIPTION\" = \"some text\" WHERE \"MYTABLE\".\"ID\" = 10121\n</code></pre>\n\n<p>I also wonder which SQL is effectively executed, in Sql*Plus or SqlDeveloper the logged syntax doesn't work.</p>\n\n<p>Don't know if this is in Oracle/oracle_enhanced adapter alone or this is also the case with other adapters.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "debugging", "rubymine", "puma"], "comments": [{"owner": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "edited": false, "score": 1, "creation_date": 1541426313, "post_id": 53155045, "comment_id": 93201965, "body": "Have you tried <code>Attach to process...</code> yet? It can be found under the <code>Run</code> menu, or via the <code>Find action</code> dialog, and let&#39;s you connect a debugger session to a running Ruby process."}, {"owner": {"reputation": 55, "user_id": 10563496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bfc6aaeb256549f547f46735ad176d?s=128&d=identicon&r=PG&f=1", "display_name": "Joachim_42he", "link": "https://stackoverflow.com/users/10563496/joachim-42he"}, "reply_to_user": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "edited": false, "score": 0, "creation_date": 1541514209, "post_id": 53155045, "comment_id": 93237393, "body": "I hadn&#39;t. Unfortunately, it does not list the puma-dev-process. But thank you anyway for the suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 10563496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bfc6aaeb256549f547f46735ad176d?s=128&d=identicon&r=PG&f=1", "display_name": "Joachim_42he", "link": "https://stackoverflow.com/users/10563496/joachim-42he"}, "edited": false, "score": 2, "creation_date": 1547306805, "post_id": 54138675, "comment_id": 95151760, "body": "This works beautifully! I was sure this should work but did not know how to do it. Thank you!"}, {"owner": {"reputation": 544, "user_id": 2938360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ea31572fddb28e3c2ae5e461f623ea3f?s=128&d=identicon&r=PG", "display_name": "Kamuela Franco", "link": "https://stackoverflow.com/users/2938360/kamuela-franco"}, "edited": false, "score": 0, "creation_date": 1549056816, "post_id": 54138675, "comment_id": 95781455, "body": "Can you embellish the answer with the specific paths of the environment files to create and where to add the initializer in the project?"}, {"owner": {"reputation": 426, "user_id": 693353, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a095c1664bc2594bf96a7073911d3281?s=128&d=identicon&r=PG", "display_name": "existentialmutt", "link": "https://stackoverflow.com/users/693353/existentialmutt"}, "edited": false, "score": 0, "creation_date": 1567604702, "post_id": 54138675, "comment_id": 102012737, "body": "Works great with VS Code too!"}], "tags": [], "owner": {"reputation": 580, "user_id": 1293749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08497221017521ae126ca4fa7134ce8e?s=128&d=identicon&r=PG", "display_name": "Jim Ryan", "link": "https://stackoverflow.com/users/1293749/jim-ryan"}, "is_accepted": true, "score": 7, "last_activity_date": 1547165071, "creation_date": 1547165071, "answer_id": 54138675, "question_id": 53155045, "link": "https://stackoverflow.com/questions/53155045/rubymine-debugging-using-installed-puma-dev/54138675#54138675", "title": "Rubymine: debugging using installed Puma-dev?", "body": "<p>This is possible with <a href=\"https://www.jetbrains.com/help/ruby/debugging-code.html#9c9bdbd4\" rel=\"noreferrer\">remote debugging</a>.  To configure, you have to make some changes to your app:</p>\n\n<ol>\n<li><p>Add <code>export RUBY_DEBUG_PORT=1234</code> to <code>.env</code> or <code>.powenv</code> or any file puma-dev <a href=\"https://github.com/puma/puma-dev#configuration\" rel=\"noreferrer\">will load an environment variable from</a>.  Feel free to use whatever port you'd like, although RubyMine uses 1234 by default.</p></li>\n<li><p>Add the <code>ruby-debug-ide</code> and <code>debase</code> gems to your project's Gemfile.</p></li>\n<li><p>Add an initializer to your project to initialize remote debugging, like so:</p>\n\n<pre><code>if Rails.env.development? &amp;&amp; ENV['RUBY_DEBUG_PORT']\n  Debugger.start_server nil, ENV['RUBY_DEBUG_PORT'].to_i\nend\n</code></pre></li>\n<li>Restart puma-dev.</li>\n<li>Go to Edit Configurations in RubyMine and add a \"Ruby remote debug\" config. Name it whatever you'd like. Change the port to the port you set via <code>RUBY_DEBUG_PORT</code>. Set your local and remote root folders to your project root. </li>\n<li>Select your newly created configuration and click the Debug button.  It should connect to the debugger running in your puma-dev process.</li>\n</ol>\n"}], "owner": {"reputation": 55, "user_id": 10563496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bfc6aaeb256549f547f46735ad176d?s=128&d=identicon&r=PG&f=1", "display_name": "Joachim_42he", "link": "https://stackoverflow.com/users/10563496/joachim-42he"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1111, "favorite_count": 4, "accepted_answer_id": 54138675, "answer_count": 1, "score": 3, "last_activity_date": 1547165071, "creation_date": 1541423208, "last_edit_date": 1541673298, "question_id": 53155045, "link": "https://stackoverflow.com/questions/53155045/rubymine-debugging-using-installed-puma-dev", "title": "Rubymine: debugging using installed Puma-dev?", "body": "<p>Is it possbile to have Rubymine connect to (and restart) an installed/running instance of Puma-dev for the debugging session?</p>\n\n<p>I use Puma-dev to test my Rails app on \"Appname\".test, yet if I need to debug something in the app and want to use Rubymine's built-in debugger, I can only let it start an additional instance of Puma on Port 3000 (or whatever Port I choose) but not the already running Puma-dev on port 80/443.</p>\n\n<p>Is it at all possible?</p>\n"}, {"tags": ["ruby", "conditional", "operators"], "answers": [{"comments": [{"owner": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 0, "creation_date": 1541419280, "post_id": 53153947, "comment_id": 93198326, "body": "Could you please elaborate on that why short circuit evaluation is obvious here?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 1, "creation_date": 1541419371, "post_id": 53153947, "comment_id": 93198370, "body": "Well, treat <code>Rx_inst2 &amp;&amp; !&#47;dom\\.&#47;</code> as a separate expression (which it is). How does it evaluate?  BTW in Ruby, all these operators: <code>&amp;&amp;, ||, and, or</code> use short-circuit evaluation."}, {"owner": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 0, "creation_date": 1541419572, "post_id": 53153947, "comment_id": 93198482, "body": "both return <code>true</code> separately, so as a whole shouldn&#39;t it be <code>true</code> when both elements are <code>true</code>?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 0, "creation_date": 1541419756, "post_id": 53153947, "comment_id": 93198575, "body": "No, first of all, in Ruby binary logical operators don&#39;t return only boolean values.  I edited my answer to provide a little bit hacky alternative way of doing what you want to do."}, {"owner": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 0, "creation_date": 1541420056, "post_id": 53153947, "comment_id": 93198734, "body": "I&#39;ve just tried it your way and the result is the same as before. I can guarantee my RegEx was matching fine until I tried adding a second condition."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 0, "creation_date": 1541420557, "post_id": 53153947, "comment_id": 93198965, "body": "@MrVocabulary I don&#39;t doubt it, this doesn&#39;t seem to be a problem in your case. So what happened after you applied my little bit hacky way?"}, {"owner": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 0, "creation_date": 1541420782, "post_id": 53153947, "comment_id": 93199063, "body": "it just didn&#39;t match those strings I wanted it to match, just as in any permutation I tried before."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 1, "creation_date": 1541421025, "post_id": 53153947, "comment_id": 93199195, "body": "@MrVocabulary oh, sorry, I made a mistake in my hacky solution code, fixed it, now it should work as you want and is a little bit more readable."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 1, "last_activity_date": 1541425345, "last_edit_date": 1541425345, "creation_date": 1541418971, "answer_id": 53153947, "question_id": 53153876, "link": "https://stackoverflow.com/questions/53153876/ruby-why-this-when-statement-doesnt-work-with-two-conditions/53153947#53153947", "title": "Ruby: why this WHEN-statement doesn&#39;t work with two conditions?", "body": "<p>It's pretty obvious, <code>Rx_inst2 &amp;&amp; !/dom\\./</code> returns (due to short circuit evaluation) value of the second operand, which is <code>!/dom\\/</code> (provided <code>Rx_inst2</code> is indeed a <code>Regexp</code> and thus truthy). You probably need to modify this regexp in <code>Rx_inst2</code>, there's no short answer. </p>\n\n<p>Alternatively, you could change all this <code>case</code> expression a little bit, like this:</p>\n\n<pre><code>case\nwhen inst =~ Rx_inst1\n  # (some function)\nwhen inst =~ Rx_inst2 &amp;&amp; !(inst =~ /dom\\./)\n  # (some other function)\nend\n</code></pre>\n\n<p>but it isn't expecially elegant form, in my opinion.</p>\n"}, {"comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1541420596, "post_id": 53154356, "comment_id": 93198980, "body": "Don&#39;t use <code>and</code>, it&#39;s confusing, use <code>&amp;&amp;</code> instead. Plus it&#39;s even more hacky than my way (it relies on <code>=== false</code> comparison under the hood), so if you indeed apply this solution, I somewhat sympathize with the developer who might see this code later."}, {"owner": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1541420671, "post_id": 53154356, "comment_id": 93199014, "body": "@Marek Lipka to me it&#39;s more readable. Apart from precedence in operations, like for <code>!</code> and <code>not</code>, does it really change anything?"}, {"owner": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1541421046, "post_id": 53154356, "comment_id": 93199208, "body": "@Marek Lipka probably no other person will see that code, plus it&#39;s dealing with a narrow scope of cases. I&#39;ll keep it unless shows me a one-liner to do the same thing with better practice involved. Thanks for the suggestions, though, lead me to some interesting lecture about operators :)"}], "tags": [], "owner": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "is_accepted": false, "score": 0, "last_activity_date": 1541420552, "creation_date": 1541420552, "answer_id": 53154356, "question_id": 53153876, "link": "https://stackoverflow.com/questions/53153876/ruby-why-this-when-statement-doesnt-work-with-two-conditions/53154356#53154356", "title": "Ruby: why this WHEN-statement doesn&#39;t work with two conditions?", "body": "<p>Okay, so it turned out I made it work like that:</p>\n\n<p><code>when (!inst.include?('dom.') and Rx_inst2)</code></p>\n\n<p>I still don't understand why I had to do all these three following things, though:</p>\n\n<ol>\n<li>change the order of operations</li>\n<li>bracket the entire expression</li>\n<li>call first one explicitly, and the second one implicitly</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 0, "creation_date": 1541423621, "post_id": 53155055, "comment_id": 93200485, "body": "oh, so RegEx returning a nil is does not itself equal nil? Interesting. Why did my final solution, the one in my answer, work then? Is it because it first evaluates the expression as true/false and then tries matching RegEx as match or null-match?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 2, "creation_date": 1541424872, "post_id": 53155055, "comment_id": 93201175, "body": "@MrVocabulary no, it&#39;s because <code>!inst.include?(&#39;dom.&#39;)</code> either returns <code>true</code> or <code>false</code>. If <code>false</code>, all this <code>&amp;&amp;</code> expression returns <code>false</code> and <code>false === inst</code> also returns <code>false</code> (unless <code>inst</code> is <code>false</code> itself, but it can&#39;t happen here, because it would crash earlier). If <code>true</code>, <code>&amp;&amp;</code> expression returns the second operand, which is <code>Rx_inst2</code> and the <code>Rx_inst2 === inst</code> comparison takes place, which returns correct result."}], "tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1541425180, "last_edit_date": 1541425180, "creation_date": 1541423252, "answer_id": 53155055, "question_id": 53153876, "link": "https://stackoverflow.com/questions/53153876/ruby-why-this-when-statement-doesnt-work-with-two-conditions/53155055#53155055", "title": "Ruby: why this WHEN-statement doesn&#39;t work with two conditions?", "body": "<pre><code>case inst\nwhen Rx_inst1\n  (some function)\nwhen Rx_inst2 &amp;&amp; !/dom\\./\n  (some other function)\nend\n</code></pre>\n\n<p>case translates into bunch of if/elsif/else statements with .=== operator\nso your code is equvalent to</p>\n\n<pre><code>if Rx_inst1 === inst\n  (some function)\nelsif (Rx_inst2 &amp;&amp; !/dom\\./) === inst\n  (some other function)\nend\n</code></pre>\n\n<p>and <code>(Rx_inst2 &amp;&amp; !/dom\\./) === inst</code> works like this:</p>\n\n<ol>\n<li><code>(Rx_inst2 &amp;&amp; !/dom\\./)</code> part evaluates to <code>!/dom\\./</code> (Rx_inst2 is a RegEx and is not nil or false)</li>\n<li><code>!/dom\\./ === inst</code> gives you the result </li>\n</ol>\n\n<p>so\n<code>when Rx_inst2 &amp;&amp; !/dom\\./</code> matches whenever <code>!/dom\\./ === inst</code> matches</p>\n"}, {"comments": [{"owner": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 0, "creation_date": 1541611719, "post_id": 53194670, "comment_id": 93278126, "body": "Thanks for those. I&#39;m trying to learn producing more compact code, hence avoid nesting too many ifs. Plus the lookahead won&#39;t work as the substring is inside the matched string, which I haven&#39;t stated explicitly, but was my intention all along ;-)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 0, "creation_date": 1541611794, "post_id": 53194670, "comment_id": 93278159, "body": "Please elaborate the last sentence of your comment (and correct &quot;started&quot;)."}, {"owner": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "edited": false, "score": 0, "creation_date": 1541612019, "post_id": 53194670, "comment_id": 93278261, "body": "Stated*. I first check if the string conforms to my regex - it&#39;s a big one, and the unwanted &quot;dom.&quot; can be almost anywhere. Inserting lookahead/lookbehinds would be ungainly and straining CPU a lot. Using include inserted of modifying the  regex makes much more sense in my case."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1541611486, "creation_date": 1541611486, "answer_id": 53194670, "question_id": 53153876, "link": "https://stackoverflow.com/questions/53153876/ruby-why-this-when-statement-doesnt-work-with-two-conditions/53194670#53194670", "title": "Ruby: why this WHEN-statement doesn&#39;t work with two conditions?", "body": "<p>@Darigazz has nicely explained how <code>case</code> works and why your code is faulty. Here are a couple ways you might write your case statement.</p>\n\n<p><strong>#1</strong></p>\n\n<pre><code>case inst\nwhen Rx_inst1\n  m1  \nwhen Rx_inst2\n  m2 if inst.match? /dom\\./\nend\n</code></pre>\n\n<p><code>nil</code> is returned if <code>inst.match? /dom\\./ #=&gt; false</code> in <code>m2 if inst.match? /dom\\./</code>. Depending on requirements, <code>if</code> might be replaced by <code>unless</code>.</p>\n\n<p><strong>#2</strong></p>\n\n<pre><code>case inst\nwhen Rx_inst1\n  m1  \nwhen /(?=.*dom\\.)#{Rx_inst2}/\n  m2\nend\n</code></pre>\n\n<p>where <code>(?=.*dom\\.)</code> is a <em>positive lookahead</em>. For example,</p>\n\n<pre><code>Rx_inst2 = /Bubba|Trixie/\n/(?=.*dom\\.)#{Rx_inst2}/\n   #=&gt; /(?=.*dom\\.)(?-mix:Bubba|Trixie)/\n</code></pre>\n\n<p>Depending on requirements, <code>(?=.*dom\\.)</code> might be replaced by the <em>negative lookahead</em> <code>(?!.*dom\\.)</code>.</p>\n"}], "owner": {"reputation": 515, "user_id": 3918419, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/7H5jV.jpg?s=128&g=1", "display_name": "MrVocabulary", "link": "https://stackoverflow.com/users/3918419/mrvocabulary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "accepted_answer_id": 53155055, "answer_count": 4, "score": 0, "last_activity_date": 1541611486, "creation_date": 1541418700, "question_id": 53153876, "link": "https://stackoverflow.com/questions/53153876/ruby-why-this-when-statement-doesnt-work-with-two-conditions", "title": "Ruby: why this WHEN-statement doesn&#39;t work with two conditions?", "body": "<p>I have a <code>case</code> in my Ruby code that basically tries to match string in a couple of ways and do different things to it accordingly, kind of like that:</p>\n\n<pre><code>case inst\nwhen Rx_inst1\n  (some function)\nwhen Rx_inst2\n  (some other function)\nend\n</code></pre>\n\n<p>This works beautifully (I'm not posting the RegEx as it's very, very long and works well). However, when I tried implementing the following modification, so that even when the RegEx matches a string, the condition is not executed if it contains a substring:</p>\n\n<pre><code>case inst\nwhen Rx_inst1\n  (some function)\nwhen Rx_inst2 &amp;&amp; !/dom\\./\n  (some other function)\nend\n</code></pre>\n\n<p>it <code>Rx_inst2</code> stopped matching <code>inst</code> when it was equal <code>Nm. Friese = Fryzyjczyk, ko\u0144 fryzyjski</code> or any other kind of string it matched before.</p>\n\n<p>I got the exact same result with <code>&amp;&amp; /dom\\./</code> and <code>&amp;&amp; inst.include?('dom.')</code> which, according to other answers, are proper syntax. What am I doing wrong?</p>\n"}, {"tags": ["ruby", "continuous-integration", "travis-ci", "macos-mojave", "travis-ci-cli"], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 7973850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FCM7S.jpg?s=128&g=1", "display_name": "Ravi Soni", "link": "https://stackoverflow.com/users/7973850/ravi-soni"}, "is_accepted": true, "score": 0, "last_activity_date": 1541457334, "last_edit_date": 1541457334, "creation_date": 1541456184, "answer_id": 53163028, "question_id": 53153162, "link": "https://stackoverflow.com/questions/53153162/travis-cli-installation-fails-on-mac/53163028#53163028", "title": "Travis cli installation fails on mac", "body": "<p>I wasn't able to install travis using ruby that comes builtin with xcode command line developer tools but installing ruby using <code>brew install ruby</code> followed by <code>sudo gem install travis -v 1.8.9 --no-rdoc --no-ri</code> resulted in a successful travis installation.</p>\n\n<p>NOTE: You may need to add travis gem to your system path. </p>\n"}, {"tags": [], "owner": {"reputation": 283, "user_id": 8439403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb3e01bc8e2d496c5a143eb249f3c410?s=128&d=identicon&r=PG&f=1", "display_name": "c. wait", "link": "https://stackoverflow.com/users/8439403/c-wait"}, "is_accepted": false, "score": 14, "last_activity_date": 1565729502, "creation_date": 1565729502, "answer_id": 57485158, "question_id": 53153162, "link": "https://stackoverflow.com/questions/53153162/travis-cli-installation-fails-on-mac/57485158#57485158", "title": "Travis cli installation fails on mac", "body": "<p><code>brew install travis</code> worked for me. I found it <a href=\"https://github.com/travis-ci/travis-ci/issues/2055#issuecomment-459869338\" rel=\"noreferrer\">here</a></p>\n"}], "owner": {"reputation": 111, "user_id": 7973850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FCM7S.jpg?s=128&g=1", "display_name": "Ravi Soni", "link": "https://stackoverflow.com/users/7973850/ravi-soni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2708, "favorite_count": 0, "accepted_answer_id": 53163028, "answer_count": 2, "score": 0, "last_activity_date": 1565729502, "creation_date": 1541415992, "question_id": 53153162, "link": "https://stackoverflow.com/questions/53153162/travis-cli-installation-fails-on-mac", "title": "Travis cli installation fails on mac", "body": "<p>Attempt to install travis cli using <code>sudo gem install travis -v 1.8.9 --no-rdoc --no-ri</code> generates the following error logs:</p>\n\n<pre><code>\"pkg-config --exists libffi\"\npackage configuration for libffi is not found\n\"xcrun clang -o conftest -I/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/include/ruby-2.3.0/universal-darwin18 -I/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/include/ruby-2.3.0/ruby/backward -I/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/include/ruby-2.3.0 -I. -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE -D_DARWIN_UNLIMITED_SELECT -D_REENTRANT    -g -Os -pipe -DHAVE_GCC_ATOMIC_BUILTINS conftest.c  -L. -L/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib -L.     -lruby.2.3.0  -lpthread -ldl -lobjc \"\nIn file included from conftest.c:1:\nIn file included from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/include/ruby-2.3.0/ruby.h:33:\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/include/ruby-2.3.0/ruby/ruby.h:24:10: fatal error: 'ruby/config.h' file not found\n#include \"ruby/config.h\"\n        ^~~~~~~~~~~~~~~\n1 error generated.\nchecked program was:\n/* begin */\n1: #include \"ruby.h\"\n2:\n3: int main(int argc, char **argv)\n4: {\n5:   return 0;\n6: }\n/* end */\n</code></pre>\n\n<p>It seems few of the dependencies are missing. How do I install them correctly? I am currently using macos mojave 10.14</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "validation"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9366127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2FrlG.jpg?s=128&g=1", "display_name": "Israt jahan Fateha", "link": "https://stackoverflow.com/users/9366127/israt-jahan-fateha"}, "edited": false, "score": 0, "creation_date": 1541414108, "post_id": 53152578, "comment_id": 93195642, "body": "but I don&#39;t want to change my form in this way <code>&lt;%= form_with url: sign_up_path do |form| %&gt;   &lt;%= form.label :email %&gt;   &lt;%= form.text_field :email %&gt;   ...   &lt;%= form.submit %&gt;</code> what to do then in my controller file?"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1541415871, "post_id": 53152578, "comment_id": 93196598, "body": "Why don&#39;t you want to change your form?"}, {"owner": {"reputation": 647, "user_id": 660942, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/eEMKd.jpg?s=128&g=1", "display_name": "Adri&#224; Carro", "link": "https://stackoverflow.com/users/660942/adri%c3%a0-carro"}, "edited": false, "score": 0, "creation_date": 1541420499, "post_id": 53152578, "comment_id": 93198932, "body": "You can leave original form and only add validations into your model."}], "tags": [], "owner": {"reputation": 647, "user_id": 660942, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/eEMKd.jpg?s=128&g=1", "display_name": "Adri&#224; Carro", "link": "https://stackoverflow.com/users/660942/adri%c3%a0-carro"}, "is_accepted": false, "score": 1, "last_activity_date": 1541413872, "creation_date": 1541413872, "answer_id": 53152578, "question_id": 53152323, "link": "https://stackoverflow.com/questions/53152323/form-validation-in-ruby-on-rails/53152578#53152578", "title": "Form validation in ruby on rails", "body": "<p>First, use Rails helpers in your views and write your form as documented <a href=\"https://guides.rubyonrails.org/form_helpers.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>&lt;%= form_with url: sign_up_path do |form| %&gt;\n  &lt;%= form.label :email %&gt;\n  &lt;%= form.text_field :email %&gt;\n  ...\n  &lt;%= form.submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Second, use validations in your Subscriber model as documented <a href=\"https://guides.rubyonrails.org/active_record_validations.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>validates :email, presence: true, uniqueness: true\n...\n</code></pre>\n\n<p>Hope it helps ;)</p>\n"}, {"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 1, "last_activity_date": 1541415845, "creation_date": 1541415845, "answer_id": 53153122, "question_id": 53152323, "link": "https://stackoverflow.com/questions/53152323/form-validation-in-ruby-on-rails/53153122#53153122", "title": "Form validation in ruby on rails", "body": "<p>Rails is an framework with an strong opinion how to do things. You are doing things not the Rails way and this will make it more complicated.</p>\n\n<p>If you really do not want to change your form (which is strongly advice against)</p>\n\n<p>Add validations, check the return value of <code>save</code> and send back some error message </p>\n\n<p>In your model:</p>\n\n<p><code>\nvalidates :email, presence: true, uniqueness: true\n</code></p>\n\n<p>In your controller:</p>\n\n<p><code>\nif subscriber.save\n  render json: {status: \"ok\", message: \"success\"}\nelse \n  render json: {status: \"nok\", message: \"something went wrong\"}\nend\n</code></p>\n\n<p>Probably you should get rid of the <code>status</code> property and use the HTTP status code for this (sending back 201 (created) and 422 (unprocessble entity) responses instead)</p>\n\n<p>Some other recommendatations to make your code more readable:</p>\n\n<ul>\n<li>Follow the Rails conventions (use a form builder, it simplifies the assignment of form params to the model</li>\n<li><p>Use Ruby naming conventions:</p>\n\n<p>subscriberNew</p></li>\n</ul>\n\n<p>should be</p>\n\n<pre><code>subscriber_new\n</code></pre>\n\n<p>since Ruby uses <code>camel_case</code>\nbut actually there is no need for the <code>new</code> suffix, so <code>subscriber</code> is enough</p>\n\n<ul>\n<li>Use two spaces for identation</li>\n<li>Don't abbreviate variables (<code>cus_username</code>, ...) and don't prefix when there is no need</li>\n</ul>\n"}], "owner": {"reputation": 45, "user_id": 9366127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2FrlG.jpg?s=128&g=1", "display_name": "Israt jahan Fateha", "link": "https://stackoverflow.com/users/9366127/israt-jahan-fateha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541416359, "creation_date": 1541412973, "last_edit_date": 1541416359, "question_id": 53152323, "link": "https://stackoverflow.com/questions/53152323/form-validation-in-ruby-on-rails", "title": "Form validation in ruby on rails", "body": "<p>I have built a sign up page in ruby on rails. I want to validate this sign up form. For example - if user left any section blank, the form will show an error message. It will also check whether the given email is unique. How can I do this by not changing my form?</p>\n\n<pre><code>#This my logins_controller.rb file\nclass LoginsController &lt; ApplicationController\nskip_before_action :verify_authenticity_token\ndef index\n    @subscriber=Subscriber.new()\nend\n\ndef sign_up    \n    subscriberNew = Subscriber.new\n    subscriberNew.name = params[:name]\n    subscriberNew.cus_user_name = params[:user_name]\n    subscriberNew.cus_password = params[:password]\n    subscriberNew.cus_email = params[:email]\n    result = subscriberNew.save\n    respond_to do |format|\n        msg = { :status =&gt; \"ok\", :message =&gt; \"Success!\" }\n        format.json  { render :json =&gt; msg }\n    end\nend\n\n\n\n\n\ndef validate_signup\n    #what should i write here?\nend\n\nend\n</code></pre>\n\n<p>and this is my sign up form</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n&lt;div class=\"shadow-lg p-3 mb-5 bg-white rounded view-card\"&gt;\n    &lt;h4 class=\"card-title\"&gt;\n    &lt;a href=\"/product_types\"&gt;\n    &lt;i class=\"material-icons\"&gt;\n      arrow_back_ios\n    &lt;/i&gt;&lt;/a&gt;&lt;/h4&gt;\n    &lt;form id=\"signup_form\" method=\"post\" action=\"/sign-up\"&gt;\n            &lt;p class=\"h4 mb-4\"&gt;Register to Binimoy&lt;/p&gt;\n            &lt;label for=\"name\"&gt;Name&lt;/label&gt;\n            &lt;input type=\"text\" name=\"name\" id=\"name\" class=\"form-control mb-4\" placeholder=\"Name\"&gt;\n\n            &lt;label for=\"email\"&gt;Email&lt;/label&gt;\n            &lt;input type=\"email\" name=\"email\" id=\"email\" class=\"form-control mb-4\" placeholder=\"Email\"&gt;\n\n            &lt;label for=\"phone\"&gt;Phone&lt;/label&gt;\n            &lt;input type=\"text\" name=\"phone\" id=\"phone\" class=\"form-control mb-4\" placeholder=\"Phone\"&gt;\n\n            &lt;label for=\"name\"&gt;Password&lt;/label&gt;\n            &lt;input type=\"password\" name=\"password\" id=\"password\" class=\"form-control mb-4\" placeholder=\"Password\"&gt;\n\n            &lt;div class=\"form-row mb-4\"&gt;\n                &lt;div class=\"col\"&gt;\n                    &lt;button class=\"btn btn-default my-4 btn-block\" type=\"reset\"&gt;Reset&lt;/button&gt;\n                &lt;/div&gt;\n                &lt;div class=\"col\"&gt;\n                &lt;button type=\"button\" class=\"btn btn-info my-4 btn-block\" id=\"submitAnchor\"&gt;Submit&lt;/button&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;                \n    &lt;/form&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1541409325, "post_id": 53151342, "comment_id": 93193041, "body": "What are <code>COUNTER_SUM</code>, <code>lehr_in</code>, <code>feeder</code>?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1541409348, "post_id": 53151342, "comment_id": 93193054, "body": "Where is the regular expression?"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 1, "creation_date": 1541409662, "post_id": 53151342, "comment_id": 93193191, "body": "Did you mean COUNTER_SUM(lehr_in) / COUNTER_SUM(feeder) * 100 is string? Like so: <code>&quot;COUNTER_SUM(lehr_in) &#47; COUNTER_SUM(feeder) * 100&quot;</code> ? And you&#39;d want to catch string between paranthesis?"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 1, "creation_date": 1541409796, "post_id": 53151342, "comment_id": 93193248, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6208367/regex-to-match-stuff-between-parentheses\">RegEx to match stuff between parentheses</a>"}, {"owner": {"reputation": 3429, "user_id": 1414327, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xcgRQ.jpg?s=128&g=1", "display_name": "Asnad Atta", "link": "https://stackoverflow.com/users/1414327/asnad-atta"}, "reply_to_user": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1541424040, "post_id": 53151342, "comment_id": 93200709, "body": "yes @Surya &quot;COUNTER_SUM(lehr_in) / COUNTER_SUM(feeder) * 100&quot; is a string and I want you guys to help me to write out the regular expression in ruby so that I can get array of substrings from expression with in the parenthesis. Example is given"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 6553807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe2b32fd2fa30bb0bc08c8c659fe3ac?s=128&d=identicon&r=PG", "display_name": "DjPadz", "link": "https://stackoverflow.com/users/6553807/djpadz"}, "is_accepted": true, "score": 1, "last_activity_date": 1542835351, "last_edit_date": 1542835351, "creation_date": 1542835036, "answer_id": 53420591, "question_id": 53151342, "link": "https://stackoverflow.com/questions/53151342/get-array-of-matching-strings/53420591#53420591", "title": "Get array of matching strings", "body": "<p>There's probably a better way to do this using regexes, but here's what I came up with:</p>\n\n<pre><code>a.split(/[^(]*\\(([^)]+)\\)[^(]*/).reject(&amp;:empty?)\n</code></pre>\n"}], "owner": {"reputation": 3429, "user_id": 1414327, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xcgRQ.jpg?s=128&g=1", "display_name": "Asnad Atta", "link": "https://stackoverflow.com/users/1414327/asnad-atta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 53420591, "answer_count": 1, "score": -6, "last_activity_date": 1542835351, "creation_date": 1541409209, "last_edit_date": 1541424622, "question_id": 53151342, "link": "https://stackoverflow.com/questions/53151342/get-array-of-matching-strings", "title": "Get array of matching strings", "body": "<p>From a given string I want an array of all the substrings within the parenthesis of given string for example I have a string</p>\n\n<pre><code>COUNTER_SUM(lehr_in) / COUNTER_SUM(feeder) * 100    \n</code></pre>\n\n<p>Here I have two substrings within the parenthises \"lehr_in\" and \"feeder\" so my result should be</p>\n\n<pre><code>[\"lehr_in\", \"feeder\"]\n</code></pre>\n"}, {"tags": ["ruby", "unicode", "encoding", "utf-8", "yaml"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1541407576, "post_id": 53150850, "comment_id": 93192191, "body": "What do you mean by <i>&quot;unicode stored as string literals&quot;</i>? Does the file contain the characters <code>\\</code>, <code>x</code>, <code>C</code> and <code>3</code>?"}, {"owner": {"reputation": 3, "user_id": 5468458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7436a5a2132073a784af28e33c0957?s=128&d=identicon&r=PG&f=1", "display_name": "Donatello Tallfeather", "link": "https://stackoverflow.com/users/5468458/donatello-tallfeather"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1541407848, "post_id": 53150850, "comment_id": 93192306, "body": "The row in the DB literally contains the text <code>&quot;\\\\xc3\\\\xb6&quot;</code> EDIT: When I pull it out the DB, that&#39;s what it looks like in Ruby"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1541408587, "post_id": 53150850, "comment_id": 93192710, "body": "Are that 8 characters? <code>\\</code>, <code>x</code>, <code>C</code>, <code>3</code>, <code>\\</code>, <code>x</code>, <code>B</code>, <code>6</code>"}, {"owner": {"reputation": 3, "user_id": 5468458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7436a5a2132073a784af28e33c0957?s=128&d=identicon&r=PG&f=1", "display_name": "Donatello Tallfeather", "link": "https://stackoverflow.com/users/5468458/donatello-tallfeather"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1541408925, "post_id": 53150850, "comment_id": 93192869, "body": "That is correct @Stefan"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5468458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7436a5a2132073a784af28e33c0957?s=128&d=identicon&r=PG&f=1", "display_name": "Donatello Tallfeather", "link": "https://stackoverflow.com/users/5468458/donatello-tallfeather"}, "edited": false, "score": 0, "creation_date": 1541410905, "post_id": 53151495, "comment_id": 93193810, "body": "Awesome. Thanks."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 3, "user_id": 5468458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7436a5a2132073a784af28e33c0957?s=128&d=identicon&r=PG&f=1", "display_name": "Donatello Tallfeather", "link": "https://stackoverflow.com/users/5468458/donatello-tallfeather"}, "edited": false, "score": 0, "creation_date": 1541411105, "post_id": 53151495, "comment_id": 93193929, "body": "@DonatelloTallfeather if you&#39;re uncomfortable with <code>pack</code>, you can also use <code>$1.to_i(16).chr</code> for the conversion."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 0, "last_activity_date": 1541409799, "creation_date": 1541409799, "answer_id": 53151495, "question_id": 53150850, "link": "https://stackoverflow.com/questions/53150850/string-coming-from-db-as-xc3-xb6-but-i-need-the-actual-character-%c3%b6-to-write/53151495#53151495", "title": "String coming from DB as \\\\xC3\\\\xB6 but I need the actual character &quot;&#246;&quot; to write to CSV", "body": "<p>The database apparently contains malformed strings. Since you can't fix the bug at its source (i.e. within the database), you could use <code>gsub</code> to replace each hex escape sequence with its actual value:</p>\n\n<pre><code>str = \"\\\\xc3\\\\xb6\"\n#=&gt; \"\\\\xc3\\\\xb6\"\nstr.length\n#=&gt; 8\n\nstr.gsub!(/\\\\x(\\h{2})/) { [$1].pack('H2') }\n#=&gt; \"\\xC3\\xB6\"\nstr.length\n#=&gt; 2\n</code></pre>\n\n<p>You can then tell Ruby to interpret the string's bytes as UTF-8:</p>\n\n<pre><code>str.force_encoding('UTF-8')\n#=&gt; \"\u00f6\"\nstr.length\n#=&gt; 1\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5468458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7436a5a2132073a784af28e33c0957?s=128&d=identicon&r=PG&f=1", "display_name": "Donatello Tallfeather", "link": "https://stackoverflow.com/users/5468458/donatello-tallfeather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 53151495, "answer_count": 1, "score": -2, "last_activity_date": 1541409799, "creation_date": 1541406986, "last_edit_date": 1541407378, "question_id": 53150850, "link": "https://stackoverflow.com/questions/53150850/string-coming-from-db-as-xc3-xb6-but-i-need-the-actual-character-%c3%b6-to-write", "title": "String coming from DB as \\\\xC3\\\\xB6 but I need the actual character &quot;&#246;&quot; to write to CSV", "body": "<p>I'm reading a YAML string from a database I have no control over which has unicode stored as string literals. </p>\n\n<p>I'd like to output the actual character <code>\u00f6</code> in a csv file but it's still putting out <code>\\\\xC3\\\\xB6</code></p>\n\n<p>Help.</p>\n"}, {"tags": ["ruby", "homebrew", "rvm"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1541407807, "post_id": 53150703, "comment_id": 93192290, "body": "Try <code>rvm reset</code> or <code>rvm set system</code> - I think RVM should see Homebrewed Ruby as the system one."}, {"owner": {"reputation": 1, "user_id": 3881911, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002755938721/picture?type=large", "display_name": "Pragnya Aitha", "link": "https://stackoverflow.com/users/3881911/pragnya-aitha"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1541410650, "post_id": 53150703, "comment_id": 93193672, "body": "@Amadan No Luck, rvm reset and rvm set system are taking the system ruby version not the homebrew ruby version"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1541410947, "post_id": 53150703, "comment_id": 93193842, "body": "Then possibly <code>__rvm_unload</code> will work (as RVM is clearly interfering with your ability to access the Homebrewed Ruby). Although, I&#39;d suggest <code>brew remove --force ruby</code> followed by <code>rvm get stable</code> and <code>rvm install ruby-2.5</code> would be preferable."}, {"owner": {"reputation": 1, "user_id": 3881911, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002755938721/picture?type=large", "display_name": "Pragnya Aitha", "link": "https://stackoverflow.com/users/3881911/pragnya-aitha"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1541411414, "post_id": 53150703, "comment_id": 93194101, "body": "@Amadan Thanks for the reply, was planning to do it the second way without removing homebrew ruby, will it be a problem to have two copies of the same version?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1541411483, "post_id": 53150703, "comment_id": 93194146, "body": "Shouldn\u2019t be, except possibly you might get confused about which gems you installed in which installation and which one you\u2019re running."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1541411729, "post_id": 53150703, "comment_id": 93194258, "body": "Actually, wait, <a href=\"https://stackoverflow.com/questions/12169283/how-do-i-associate-a-new-rvm-install-with-existing-ruby-versions\">How do I associate a new rvm install with existing ruby versions?</a> might have a solution (<code>rvm mount $(brew --prefix ruby)</code>) - read <code>rvm help mount</code> for details."}, {"owner": {"reputation": 1, "user_id": 3881911, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002755938721/picture?type=large", "display_name": "Pragnya Aitha", "link": "https://stackoverflow.com/users/3881911/pragnya-aitha"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1541413183, "post_id": 53150703, "comment_id": 93195071, "body": "@Amadan This worked, Thanks :)"}], "owner": {"reputation": 1, "user_id": 3881911, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002755938721/picture?type=large", "display_name": "Pragnya Aitha", "link": "https://stackoverflow.com/users/3881911/pragnya-aitha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1541413260, "answer_count": 0, "score": 0, "last_activity_date": 1541407409, "creation_date": 1541406313, "last_edit_date": 1541407409, "question_id": 53150703, "link": "https://stackoverflow.com/questions/53150703/is-it-possible-to-switch-ruby-versions-between-homebrew-and-rvm-on-mac-os", "closed_reason": "Duplicate", "title": "Is it possible to switch ruby versions between homebrew and rvm on mac os?", "body": "<p>Is it possible to switch ruby versions between homebrew and rvm on mac os?</p>\n\n<p>I have ruby version 2.5 installed through homebrew and version 2.2 installed through rvm, which is the default. I want to switch to version 2.5, and I don't know how to do it.</p>\n"}, {"tags": ["asp.net", "ruby", "encryption", "openssl", "aes"], "comments": [{"owner": {"reputation": 2504, "user_id": 3729369, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FYV4M.png?s=128&g=1", "display_name": "simonwo", "link": "https://stackoverflow.com/users/3729369/simonwo"}, "edited": false, "score": 2, "creation_date": 1541407082, "post_id": 53150381, "comment_id": 93191974, "body": "Don\u2019t you need <code>cipher.key=</code> instead of just <code>key=</code>?"}, {"owner": {"reputation": 1280, "user_id": 3554338, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c022fa34c942d95cc255e80cd73f9753?s=128&d=identicon&r=PG&f=1", "display_name": "Aparichith", "link": "https://stackoverflow.com/users/3554338/aparichith"}, "reply_to_user": {"reputation": 2504, "user_id": 3729369, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FYV4M.png?s=128&g=1", "display_name": "simonwo", "link": "https://stackoverflow.com/users/3729369/simonwo"}, "edited": false, "score": 0, "creation_date": 1541407914, "post_id": 53150381, "comment_id": 93192345, "body": "@simonwo Oops!!. I missed that. I missed the second part in documentation. Thank you. I&#39;m not a <code>.net</code> guy. Any other issues you have found in <code>ruby</code> implementation?"}, {"owner": {"reputation": 2504, "user_id": 3729369, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FYV4M.png?s=128&g=1", "display_name": "simonwo", "link": "https://stackoverflow.com/users/3729369/simonwo"}, "edited": false, "score": 0, "creation_date": 1541509620, "post_id": 53150381, "comment_id": 93234679, "body": "Many, too numerous to list here \ud83d\ude09 If you find any more, do open another question!"}], "owner": {"reputation": 1280, "user_id": 3554338, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c022fa34c942d95cc255e80cd73f9753?s=128&d=identicon&r=PG&f=1", "display_name": "Aparichith", "link": "https://stackoverflow.com/users/3554338/aparichith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541404749, "creation_date": 1541404749, "question_id": 53150381, "link": "https://stackoverflow.com/questions/53150381/ruby-opensslcipherciphererror-key-not-set", "title": "Ruby OpenSSL::Cipher::CipherError (key not set)", "body": "<p>I am trying to port an existing <code>.net</code> encryption code to <code>ruby</code>. But stuck with the <code>key not set</code> error. </p>\n\n<p>Bellow is the <code>.net</code> code to encrypt a string.</p>\n\n<pre><code>private static string Encrypt(string strToEncrypt, string saltValue, string password)\n        {\n\n            using (var csp = new AesCryptoServiceProvider())\n            {\n                ICryptoTransform e = GetCryptoTransform(csp, true, saltValue, password);\n                byte[] inputBuffer = Encoding.UTF8.GetBytes(strToEncrypt);\n                byte[] output = e.TransformFinalBlock(inputBuffer, 0, inputBuffer.Length);\n\n                string encrypted = Convert.ToBase64String(output);\n\n                return encrypted;\n            }\n        }\n\nprivate static ICryptoTransform GetCryptoTransform(AesCryptoServiceProvider csp, bool encrypting, string saltValue, string password)\n        {          \n\n            csp.Mode = CipherMode.CBC;\n            csp.Padding = PaddingMode.PKCS7;\n            var passWord = password;\n\n            var salt = saltValue;\n\n            //a random Init. Vector. just for testing\n            String iv = \"e675f725e675f123\";\n\n            var spec = new Rfc2898DeriveBytes(Encoding.UTF8.GetBytes(passWord), Encoding.UTF8.GetBytes(salt), 1000);\n            byte[] key = spec.GetBytes(16);\n\n\n            csp.IV = Encoding.UTF8.GetBytes(iv);\n            csp.Key = key;         \n\n\n            if (encrypting)\n            {\n                return csp.CreateEncryptor();\n            }\n            return csp.CreateDecryptor();\n        }\n</code></pre>\n\n<p>I have used Ruby's <code>OpenSSL::PKCS5</code> library to generate key and <code>OpenSSL::Cipher</code> to encrypt using <code>AES</code> algorithm like bellow.</p>\n\n<pre><code>  def aes_encrypt(input_string)\n    cipher = OpenSSL::Cipher.new('AES-128-CBC')\n    cipher.encrypt\n    key = encryption_key\n    iv  = cipher.random_iv\n\n    cipher.update(input_string) + cipher.final\n  end\n\n  def encryption_key\n    OpenSSL::PKCS5.pbkdf2_hmac_sha1(PASSWORD, SALT, 1000, 16)\n  end\n</code></pre>\n\n<p>Can anyone let know where I am missing? (Padding ?)</p>\n"}, {"tags": ["css", "ruby", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1541395774, "post_id": 53148020, "comment_id": 93188139, "body": "You can also test whether a node has a class using <code>tr.matches?(&#39;.favoured&#39;)</code>, if you need more complex conditional processing; but if you just want to &quot;identify <code>tr</code> tags with class <code>favoured</code>&quot;, sawa&#39;s is a much better choice."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1541389337, "creation_date": 1541389337, "answer_id": 53148020, "question_id": 53147376, "link": "https://stackoverflow.com/questions/53147376/does-tr-contrain-specific-class-ruby-nokogiri/53148020#53148020", "title": "Does tr contrain specific class Ruby Nokogiri", "body": "<p>Your <code>tr</code> is the same node that has class <code>favoured</code>, whereas your use of the selectors is valid when you want to match a descendant of <code>tr</code> that has class <code>favoured</code>. You should do:</p>\n\n<pre><code>tableSpread.search('tr.favoured').each do |tr|\n  ...\nend\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4495961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8e224fad6bc6db735cdc93148a6339c?s=128&d=identicon&r=PG&f=1", "display_name": "Salim Chorfi", "link": "https://stackoverflow.com/users/4495961/salim-chorfi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541389554, "creation_date": 1541383246, "last_edit_date": 1541389554, "question_id": 53147376, "link": "https://stackoverflow.com/questions/53147376/does-tr-contrain-specific-class-ruby-nokogiri", "title": "Does tr contrain specific class Ruby Nokogiri", "body": "<p>I'm trying to identify <code>tr</code> tags with class <code>favoured</code> such as:</p>\n\n<pre><code>&lt;tr class=\"home favoured \"&gt;\n</code></pre>\n\n<p>I have this:</p>\n\n<pre><code>tableSpread = doc.css('.consensus-table').first\ntableSpread.search('tr').each do |tr|\n    tr.at_css('.favoured')\nend\n</code></pre>\n\n<p>I'm having no success identifying the class; I'm getting <code>nil</code> for every iteration of the loop.</p>\n"}, {"tags": ["ruby", "winapi"], "comments": [{"owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "edited": false, "score": 3, "creation_date": 1541381639, "post_id": 53147136, "comment_id": 93185578, "body": "So your code means that call <code>MessageBox</code> method which has argment type of <code>(Long,Pointer,Pointer,Long)</code> and returns <code>Integer</code>.  You can confirm that this matches <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-messagebox\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/api/winuser/&hellip;</a>"}, {"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 1, "creation_date": 1541417494, "post_id": 53147136, "comment_id": 93197417, "body": "<a href=\"http://phrogz.net/programmingruby/lib_windows.html#Win32API\" rel=\"nofollow noreferrer\">phrogz.net/programmingruby/lib_windows.html#Win32API</a>"}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 1, "creation_date": 1541428036, "post_id": 53147136, "comment_id": 93202949, "body": "On another note, <code>Win32API</code> is quite deprecated, and you should be using <code>Fiddle</code> if your Ruby version &gt; 2.0, as Win32API is simply translated into it anyways."}], "owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "closed_date": 1541390155, "answer_count": 0, "score": 1, "last_activity_date": 1541389706, "creation_date": 1541380707, "last_edit_date": 1541389706, "question_id": 53147136, "link": "https://stackoverflow.com/questions/53147136/what-do-the-letters-mean-as-win32api-arguments", "closed_reason": "Duplicate", "title": "What do the letters mean as Win32api arguments?", "body": "<p>I'm using the <code>Win32api</code> module. I want to know what the <code>L's</code> and <code>P's</code> mean in the following line:</p>\n\n<pre><code>function = Win32API.new('user32', 'MessageBox', ['L', 'P', 'P', 'L'], 'I')\n</code></pre>\n\n<p>I know that <code>user32</code> is the dll from which the <code>MessageBox</code> function is called from, but what do the <code>L's</code>, <code>P's</code>, and the <code>I</code> do, more specifically what do they stand for?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 308, "user_id": 6023124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7718cf4e9d16e02962fd942988ccc9b1?s=128&d=identicon&r=PG&f=1", "display_name": "rcrews", "link": "https://stackoverflow.com/users/6023124/rcrews"}, "is_accepted": false, "score": 1, "last_activity_date": 1541383080, "last_edit_date": 1541383080, "creation_date": 1541381887, "answer_id": 53147251, "question_id": 53146470, "link": "https://stackoverflow.com/questions/53146470/battlefield-game-in-ruby/53147251#53147251", "title": "Battlefield game in ruby", "body": "<p>The main problem is in your board set-up. You have</p>\n\n<pre><code>for i in 0..4\n  board1.append(\"O\")\nend\n</code></pre>\n\n<p>But that only creates one dimension. Try this:</p>\n\n<pre><code>for i in 0..4\n  board1[i] = []\n  (0..4).each do\n    board1[i].append(\"O\")\n  end\nend\n</code></pre>\n\n<p>A secondary problem is the subroutine print_board. First, you only need one definition of the subroutine, then second, the map needs to apply to \"row\" not \"board\", like this:</p>\n\n<pre><code>def print_board(board)\n  for row in board\n    puts row.map { |k| \"#{k}\" }.join(\" \")\n  end\nend\n</code></pre>\n\n<p>There are many other problems with your code. I assume you are learning Ruby and this is an exercise to learn the Array API. In such case, it will be best for you continue the exercise yourself, learning as you go.</p>\n\n<p>However, one additional hint: Learn about rubocop and run it on your code. Doing this consistently will teach you about good Ruby style while also improving your code. To be specific: Install the rubocop gem, then run rubocop against your code like this:</p>\n\n<pre><code>rubocop -SEa battleship.rb\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10605177, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gpU96_AuinI/AAAAAAAAAAI/AAAAAAAAAN8/Nt-m02CkAmY/photo.jpg?sz=128", "display_name": "Gulnar Necefova", "link": "https://stackoverflow.com/users/10605177/gulnar-necefova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "closed_date": 1541423877, "answer_count": 1, "score": -3, "last_activity_date": 1541389843, "creation_date": 1541373681, "last_edit_date": 1541389843, "question_id": 53146470, "link": "https://stackoverflow.com/questions/53146470/battlefield-game-in-ruby", "closed_reason": "Needs details or clarity", "title": "Battlefield game in ruby", "body": "<p>This is a classic battleship game for two players:</p>\n\n<pre><code>#board1 and board2 arrays are boards that players see only dots (not bumped yet), O (not ship part) and X (bumped ship part) \nboard1 = []\nboard2 = []\n\n#Create the board that players can see through with terminal\nfor i in 0..4\n    board1.append(\"O\")\n end\n\n for i in 0..4\n    board2.append(\"O\")\n end\n\n def print_board(board1)\n    for row in board1\n        puts board1.map { |k| \"#{k}\" }.join(\"  \")\n    end\nend\n\ndef print_board(board2)\n    for row in board2\n        puts board2.map { |k| \"#{k}\" }.join(\"  \")\n    end\nend\n\n\nprint_board(board1)\nputs \"\\n\"\nprint_board(board2)\n\n#array1 and array2 are obvious boards of player1 and player2 respectly \narray1 = [ [0, 1, 1, 1, 0], [1, 0, 0, 0, 0], [1, 0, 1, 0, 0], [0, 0, 1, 0, 1], [0, 0, 0, 0, 0] ]\narray2 = [ [1, 0, 1, 1, 0], [0, 0, 0, 0, 1], [0, 1, 0, 0, 1], [0, 1, 0, 0, 1], [0, 0, 0, 0, 0] ]\n\n#Starting of the game and the printing the board \nwhile true do\n    puts \"Welcome to the game!!!\"\n    puts \"Do you want to start? (start/reset):\"\n    a = gets.chomp\n    if a == 'start'\n\n        for i in 0..100\n            puts \"Turn - Player1: \"\n            puts \"Enter row: \" \n            q = gets.chomp\n            p1_row = q.to_i \n            puts \"Enter coloumn: \" \n            w = gets.chomp\n            p1_col= w.to_i\n            if array2[p1_row][p1_col] == 1\n                array2[p1_row][p1_col] =\"X\"\n                board2[p1_row][p1_col] =\"X\"\n            elsif array2[p1_row][p1_col] == 0\n                array2[p1_row][p1_col] =\"-\"\n                board2[p1_row][p1_col] =\"-\"\n            elsif array2[p1_row][p1_col] ==\"X\" or array2[p1_row][p1_col] ==\"-\"\n                next\n            end\n            print_board(board2)\n\n            puts \"Turn - Player2: \"\n            puts \"Enter row: \" \n            e = gets.chomp\n            p2_row = e.to_i \n            puts \"Enter coloumn: \" \n            r = gets.chomp\n            p2_col= r.to_i\n            if array1[p2_row][p2_col] == 1\n                array1[p2_row][p2_col] =\"X\"\n                board1[p2_row][p2_col] =\"X\"\n            elsif array1[p2_row][p2_col] == 0\n                array1[p2_row][p2_col] =\"-\"\n                board1[p2_row][p2_col] =\"-\"\n            elsif array1[p2_row][p2_col] ==\"X\" or array1[p2_row][p2_col] ==\"-\"\n                next\n            end\n            print_board(board1)\n\n         end\n\n     elsif a == 'reset'\n        puts \"You are off the game\"\n        break\n     else\n        puts \"\\n\"\n        puts \"Answer can be only {start} or {reset}\"\n     end\nend\n</code></pre>\n\n<p>I have two problems with this code. When I entered index 4 for player 2, I get \"index 4 out of string (IndexError)\", but I did not find why. The other problem is that, when <code>if</code> statement finds 1 or 0, it changes all columns, and does not change only the element of the array.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 151, "user_id": 5220160, "user_type": "registered", "profile_image": "https://graph.facebook.com/1715063795/picture?type=large", "display_name": "siax", "link": "https://stackoverflow.com/users/5220160/siax"}, "edited": false, "score": 0, "creation_date": 1541363705, "post_id": 53145182, "comment_id": 93181627, "body": "Try with &quot;uniq&quot; <a href=\"https://ruby-doc.org/core-2.5.3/Array.html#method-i-uniq\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.3/Array.html#method-i-uniq</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1541427423, "post_id": 53145624, "comment_id": 93202588, "body": "note your second example is invalid as <code>name</code> would raise an <code>NoMethodError</code> since <code>Hash#name</code> is not the appropriate way to access the key <code>name</code>"}, {"owner": {"reputation": 268, "user_id": 3351209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cFFQH.jpg?s=128&g=1", "display_name": "Amanze", "link": "https://stackoverflow.com/users/3351209/amanze"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1541497295, "post_id": 53145624, "comment_id": 93228156, "body": "Oh! that&#39;s true. I&#39;ve changed <code>name</code> to <code>fname</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1541555438, "post_id": 53145624, "comment_id": 93255322, "body": "Not exactly my point. If you run your code you will note the <code>NoMethodError</code> because <code>obj.name</code> should be <code>obj[:name]</code> or I guess, <code>obj[:fame]</code> now, because <code>obj</code> is a <code>Hash</code> and that class does not define <code>name</code> or <code>fname</code> as an instance method."}, {"owner": {"reputation": 268, "user_id": 3351209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cFFQH.jpg?s=128&g=1", "display_name": "Amanze", "link": "https://stackoverflow.com/users/3351209/amanze"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1541587621, "post_id": 53145624, "comment_id": 93265045, "body": "@engineersmnky Got you. Too much JS in my system."}], "tags": [], "owner": {"reputation": 268, "user_id": 3351209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cFFQH.jpg?s=128&g=1", "display_name": "Amanze", "link": "https://stackoverflow.com/users/3351209/amanze"}, "is_accepted": true, "score": 6, "last_activity_date": 1541587543, "last_edit_date": 1541587543, "creation_date": 1541366711, "answer_id": 53145624, "question_id": 53145182, "link": "https://stackoverflow.com/questions/53145182/delete-duplicate-entries-in-ruby/53145624#53145624", "title": "Delete duplicate entries in Ruby", "body": "<p>If you want an array of unique values of <code>my_array = [1, 2, 3, 3, 4]</code>, then do this:</p>\n\n<pre><code>my_array.uniq\n# =&gt; [1, 2, 3, 4]\n</code></pre>\n\n<p>If your array contains objects with some field that you want to be unique, for example, <code>:fname</code> in:</p>\n\n<pre><code>my_array = [\n  {fname: \"amanze\", age: 28}, \n  {fname: \"ben\", age: 13}, \n  {fname: \"ben\", age: 4}\n]\n</code></pre>\n\n<p>then you need to do this:</p>\n\n<pre><code>my_array.uniq { |obj| obj[:fname] }\n# =&gt;\n# [\n#   {fname: \"amanze\", age: 28}, \n#   {fname: \"ben\", age: 13}\n# ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 3, "last_activity_date": 1541402826, "last_edit_date": 1541402826, "creation_date": 1541394204, "answer_id": 53148611, "question_id": 53145182, "link": "https://stackoverflow.com/questions/53145182/delete-duplicate-entries-in-ruby/53148611#53148611", "title": "Delete duplicate entries in Ruby", "body": "<p><a href=\"https://apidock.com/ruby/Array/uniq\" rel=\"nofollow noreferrer\"><code>Array#uniq</code></a> is the best way to find out the uniq records, but as an alternate, you can use <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-26\" rel=\"nofollow noreferrer\"><code>Array#&amp;</code></a>, which returns a new array containing the elements common to the two arrays, excluding any <strong>duplicates</strong>.</p>\n\n<pre><code>a = [1, 2, 3, 4, 5, 2, 2, 3, 4]\nb = a &amp; a\nb #=&gt; [1, 2, 3, 4, 5]\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10604920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d06c411fc28d15591c76c43ef63970?s=128&d=identicon&r=PG&f=1", "display_name": "metronome", "link": "https://stackoverflow.com/users/10604920/metronome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 53145624, "answer_count": 2, "score": 0, "last_activity_date": 1541587543, "creation_date": 1541363579, "last_edit_date": 1541390030, "question_id": 53145182, "link": "https://stackoverflow.com/questions/53145182/delete-duplicate-entries-in-ruby", "title": "Delete duplicate entries in Ruby", "body": "<p>What is the command for deleting duplicate elements in an array? This is my best try:</p>\n\n<pre><code>my_array.reject.with_string{s.clone}\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1159, "user_id": 4537254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6OpD.jpg?s=128&g=1", "display_name": "Andr&#233; Guimar&#227;es Sakata", "link": "https://stackoverflow.com/users/4537254/andr%c3%a9-guimar%c3%a3es-sakata"}, "edited": false, "score": 0, "creation_date": 1541362351, "post_id": 53144833, "comment_id": 93181253, "body": "<a href=\"https://stackoverflow.com/a/10693010/4537254\">This answer</a> describes what you are looking for."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1541365113, "post_id": 53144833, "comment_id": 93182041, "body": "The construct you are looking for is &quot;inheritance&quot;."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1541394110, "post_id": 53144833, "comment_id": 93187736, "body": "It does not seem to make sense. Where do you expect <code>&quot;world&quot;</code> to come from?"}], "answers": [{"comments": [{"owner": {"reputation": 1299, "user_id": 1130176, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/3618314d500643b06b1b88c8671eb840?s=128&d=identicon&r=PG", "display_name": "user1130176", "link": "https://stackoverflow.com/users/1130176/user1130176"}, "edited": false, "score": 1, "creation_date": 1541364673, "post_id": 53145027, "comment_id": 93181914, "body": "This is almost right, def foo instead of def self.foo is what extends the class, please confirm"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1541412270, "post_id": 53145027, "comment_id": 93194569, "body": "You can just <code>extend SomeModule</code> instead of <code>include SomeModule</code> and remove the <code>included</code> callback."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1541427626, "post_id": 53145027, "comment_id": 93202708, "body": "What @Stefan said because right now <code>foo</code> is added as an instance method and again as a class instance method. e.g. <code>SomeClass.foo == SomeClass.new.foo</code> in this case I guess that works but in most real world cases extend and include serve very different purposes"}], "tags": [], "owner": {"reputation": 1159, "user_id": 4537254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6OpD.jpg?s=128&g=1", "display_name": "Andr&#233; Guimar&#227;es Sakata", "link": "https://stackoverflow.com/users/4537254/andr%c3%a9-guimar%c3%a3es-sakata"}, "is_accepted": true, "score": 3, "last_activity_date": 1541432765, "last_edit_date": 1541432765, "creation_date": 1541362551, "answer_id": 53145027, "question_id": 53144833, "link": "https://stackoverflow.com/questions/53144833/a-function-that-injects-a-class-level-function/53145027#53145027", "title": "A function that injects a class level function", "body": "<p>You can extend the methods like this:</p>\n\n<pre><code>module SomeModule\n  def foo\n    true\n  end\nend\n\nclass SomeClass\n  extend SomeModule\nend\n\nSomeClass.foo\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1541363814, "creation_date": 1541363814, "answer_id": 53145212, "question_id": 53144833, "link": "https://stackoverflow.com/questions/53144833/a-function-that-injects-a-class-level-function/53145212#53145212", "title": "A function that injects a class level function", "body": "<p>You cann package individual methods into their own modules and extend them:</p>\n\n<pre><code>module MyModule\n  module NewFunc\n    def new_func\n      puts \"hello\"\n    end\n  end\nend\n\nclass A\n  extend MyModule::NewFunc\nend\n\nA.new_func\n</code></pre>\n\n<p>With some metaprogramming / monkeypatching you could make a way to extend only certain methods of a module, but I think the approach I have shown works good enough.</p>\n\n<p>If you wanted to make it so individual methods can be imported, or you can import all of them, you can do it like so:</p>\n\n<pre><code>module MyModule\n  module NewFunc\n    def new_func\n      puts \"hello\"\n    end\n  end\n\n  module NewFunc2\n    def new_func2\n      puts \"hello2\"\n    end\n  end\n\n  include NewFunc, NewFunc2 # this adds them to MyModule directly\nend\n\nclass A\n  extend MyModule\nend\n\nA.new_func\nA.new_func2\n</code></pre>\n"}], "owner": {"reputation": 1299, "user_id": 1130176, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/3618314d500643b06b1b88c8671eb840?s=128&d=identicon&r=PG", "display_name": "user1130176", "link": "https://stackoverflow.com/users/1130176/user1130176"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 53145027, "answer_count": 2, "score": 0, "last_activity_date": 1541432765, "creation_date": 1541361333, "last_edit_date": 1541394057, "question_id": 53144833, "link": "https://stackoverflow.com/questions/53144833/a-function-that-injects-a-class-level-function", "title": "A function that injects a class level function", "body": "<p>I write the same function repeatedly in my classes. Is there a way to declare a function once, and just reference the function declaration in each relevant class to have it become part of the class? I want to do something like:</p>\n\n<pre><code>def add_func\n  expand self.new_func\n    puts \"hello\"\n  end\nend\n\nclass A\n  import \"add_func\"\nend\n\nA.new_func\n# &gt;&gt; hello world\n</code></pre>\n\n<p>I'm looking to make a class method, not an instance method, but I'd be interested in knowing how to do both. What is the Ruby construct I am looking for?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "activerecord", "nomethoderror"], "comments": [{"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1541360495, "post_id": 53144437, "comment_id": 93180728, "body": "Can you include more of the backtrace? Something is calling <code>has_one_attached</code>."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1541362334, "post_id": 53144437, "comment_id": 93181250, "body": "<code>has_one_attached</code> is an active_storage helper, I&#39;ll start diggin there (try gem install active_storage on the server to see if there&#39;s some error). I&#39;m not sure why you posted the group test of your gems, it&#39;s not used for deploys."}, {"owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "edited": false, "score": 1, "creation_date": 1541365361, "post_id": 53144437, "comment_id": 93182116, "body": "I believe you might find a solution <a href=\"https://stackoverflow.com/questions/49813214/disable-active-storage-in-rails-5-2\">disable active storage</a>"}], "owner": {"reputation": 1, "user_id": 10604686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392ecb59b3f49082a0f96421b38bacb4?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/10604686/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541366042, "creation_date": 1541358883, "last_edit_date": 1541366042, "question_id": 53144437, "link": "https://stackoverflow.com/questions/53144437/issues-deploying-rails-app-to-heroku-active-record-nomethoderror", "title": "Issues deploying rails app to heroku - Active Record NoMethodError", "body": "<p>I've been having trouble deploying a rails app to Heroku - and it's working locally. </p>\n\n<p>Receiving the following error from rails console: </p>\n\n<blockquote>\n  <p>1: from /app/vendor/bundle/ruby/2.5.0/gems/activestorage-5.2.1/app/models/active_storage/blob/representable.rb:7:in <code>block in &lt;module:Representable&gt;'\n  /app/vendor/bundle/ruby/2.5.0/gems/activerecord-5.2.1/lib/active_record/dynamic_matchers.rb:22:in</code>method_missing': undefined method `has_one_attached' for # (NoMethodError)</p>\n</blockquote>\n\n<p>I'm not utilizing a db in this project, I moved sqlite3 here - </p>\n\n<pre><code>group :test do\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '&gt;= 2.15'\n  gem 'selenium-webdriver'\n  gem 'sqlite3'\n  # Easy installation and use of chromedriver to run system tests with Chrome\n  gem 'chromedriver-helper'\nend\n</code></pre>\n"}, {"tags": ["ruby", "minitest"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1541357646, "post_id": 53144035, "comment_id": 93179878, "body": "Can you post an example of such a test and the method it tests?"}, {"owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1541358189, "post_id": 53144035, "comment_id": 93180048, "body": "@spickermann updated the question"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1541363268, "post_id": 53144035, "comment_id": 93181525, "body": "This sounds like a xy question to me. Why do you try to hack a work around instead of investigating why the test are flacky and fix the tests?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1541363376, "post_id": 53144035, "comment_id": 93181553, "body": "@yegor256 Can you please provide some more meaningful context in the example? <i>What</i> are you testing, that takes 5 seconds? Perhaps there is a better way to investigate/fix what&#39;s running so slowly, instead of auto-failing all tests that take too long."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1541363508, "post_id": 53144035, "comment_id": 93181582, "body": "If the issue is that you &quot;can&#39;t figure out which test is freezing&quot;, then perhaps we should focus on that? There are various strategies you could employ to track down the root of the problem (without a global <code>Timeout</code> wrapper, which may not even work)."}, {"owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1541394188, "post_id": 53144035, "comment_id": 93187764, "body": "@TomLord appreciate your willingness to help, but I do need a generic solution, to timeout <b>any</b> test that is slower than 5 seconds."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1541410324, "post_id": 53144035, "comment_id": 93193495, "body": "@yegor256 Have you tried using <a href=\"https://github.com/splattael/minitest-around\" rel=\"nofollow noreferrer\">github.com/splattael/minitest-around</a> or <a href=\"https://github.com/jeremyevans/minitest-hooks\" rel=\"nofollow noreferrer\">github.com/jeremyevans/minitest-hooks</a>? Or perhaps a better way to diagnose this would be with <a href=\"https://github.com/nmeans/minitest-profile\" rel=\"nofollow noreferrer\">github.com/nmeans/minitest-profile</a>?"}, {"owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1541415463, "post_id": 53144035, "comment_id": 93196374, "body": "@TomLord minitest-hooks was exactly what I was looking for. If you make it an answer, I will choose it."}], "answers": [{"tags": [], "owner": {"reputation": 24970, "user_id": 73673, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/H81Fx.jpg?s=128&g=1", "display_name": "berkes", "link": "https://stackoverflow.com/users/73673/berkes"}, "is_accepted": false, "score": 0, "last_activity_date": 1543413217, "creation_date": 1543413217, "answer_id": 53521038, "question_id": 53144035, "link": "https://stackoverflow.com/questions/53144035/how-to-make-sure-each-minitest-unit-test-is-fast-enough/53521038#53521038", "title": "How to make sure each Minitest unit test is fast enough?", "body": "<p>You can use the Minitest PLugin loader to load a plugin. This is, by far, the cleanest solution. The plugin system is not very well documented, though. </p>\n\n<p>Luckily, Adam Sanderson wrote <a href=\"http://www.monkeyandcrow.com/blog/reading_ruby_minitest_plugin_system/\" rel=\"nofollow noreferrer\">an article on the plugin system</a>.</p>\n\n<p>The best news is that this article explains the plugin system by writing a sample plugin that <em>reports</em> slow tests. Try out <a href=\"https://github.com/adamsanderson/minitest-snail\" rel=\"nofollow noreferrer\">minitest-snail</a>, it is probably almost what you want.</p>\n\n<p>With a little modification we can use the <code>Reporter</code> to mark a test as failed if it is too slow, like so (untested):</p>\n\n<p>File <code>minitest/snail_reporter.rb</code>: </p>\n\n<pre><code>module Minitest\n  class SnailReporter &lt; Reporter\n    attr_reader :max_duration\n\n    def self.options\n      @default_options ||= {\n        :max_duration =&gt; 2\n      }\n    end\n\n    def self.enable!(options = {})\n      @enabled = true\n      self.options.merge!(options)\n    end\n\n    def self.enabled?\n      @enabled ||= false\n    end\n\n    def initialize(io = STDOUT, options = self.class.options)\n      super\n      @max_duration = options.fetch(:max_duration)\n    end\n\n    def record result\n      @passed = result.time &lt; max_duration\n      slow_tests &lt;&lt; result if !@passed\n    end\n\n    def passed?\n      @passed\n    end\n\n    def report\n      return if slow_tests.empty?\n\n      slow_tests.sort_by!{|r| -r.time}\n\n      io.puts\n      io.puts \"#{slow_tests.length} slow tests.\"\n      slow_tests.each_with_index do |result, i|\n        io.puts \"%3d) %s: %.2f s\" % [i+1, result.location, result.time]\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>File <code>minitest/snail_plugin.rb</code>:</p>\n\n<pre><code>require_relative './snail_reporter'\n\nmodule Minitest\n  def self.plugin_snail_options(opts, options)\n    opts.on \"--max-duration TIME\", \"Report tests that take longer than TIME seconds.\" do |max_duration|\n      SnailReporter.enable! :max_duration =&gt; max_duration.to_f\n    end\n  end\n\n  def self.plugin_snail_init(options)\n    if SnailReporter.enabled?\n      io = options[:io]\n      Minitest.reporter.reporters &lt;&lt; SnailReporter.new(io)\n    end\n  end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543413217, "creation_date": 1541356164, "last_edit_date": 1541358163, "question_id": 53144035, "link": "https://stackoverflow.com/questions/53144035/how-to-make-sure-each-minitest-unit-test-is-fast-enough", "title": "How to make sure each Minitest unit test is fast enough?", "body": "<p>I have a large amount of Minitest unit tests (methods), over 300. They all take some time, from a few milliseconds to a few seconds. Some of them hang up, sporadically. I can't understand which one and when.</p>\n\n<p>I want to apply <code>Timeout</code> to each of them, to make sure anyone fails if it takes longer than, say, 5 seconds. Is it achievable?</p>\n\n<p>For example:</p>\n\n<pre><code>class FooTest &lt; Minitest::Test\n  def test_calculates_something\n    # Something potentially too slow\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "module", "sinatra", "stub", "ruby-mocha"], "answers": [{"tags": [], "owner": {"reputation": 172, "user_id": 8650655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QiKYLvAUDlo/AAAAAAAAAAI/AAAAAAAAmTU/8s3HQesCniw/photo.jpg?sz=128", "display_name": "Matheus Richard", "link": "https://stackoverflow.com/users/8650655/matheus-richard"}, "is_accepted": true, "score": 3, "last_activity_date": 1541379407, "last_edit_date": 1541379407, "creation_date": 1541378911, "answer_id": 53146962, "question_id": 53142786, "link": "https://stackoverflow.com/questions/53142786/how-to-stub-a-module-method-inside-a-controller-with-mocha/53146962#53146962", "title": "How to stub a module method inside a controller with Mocha", "body": "<p>I've found out two different ways to achieve this.</p>\n\n<p><strong>1) Using <a href=\"https://github.com/codeodor/minitest-stub_any_instance\" rel=\"nofollow noreferrer\">stub any instance gem</a>.</strong></p>\n\n<p>With this gem I could stub any instace of <code>Sinatra::Application</code>. So the solution looks like this:</p>\n\n<pre><code>def test_my_method\n  Sinatra::Application.stub_any_instance(:my_method, \"stubbed\") do\n    get \"/my_module\"\n    # =&gt; stubbed\n  end\nend\n</code></pre>\n\n<p><strong>2) Using <code>mocha</code>'s <a href=\"https://gofreerange.com/mocha/docs/Mocha/ClassMethods.html#any_instance-instance_method\" rel=\"nofollow noreferrer\">any_instance</a>.</strong></p>\n\n<p>This solution follows the same principle. Just using <code>mocha</code>s methods.</p>\n\n<pre><code>def test_my_method\n  Sinatra::Application.any_instance.stubs(:my_method).returns(\"stubbed\")\n  get \"/my_module\"\n  # =&gt; stubbed\nend\n</code></pre>\n"}], "owner": {"reputation": 172, "user_id": 8650655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QiKYLvAUDlo/AAAAAAAAAAI/AAAAAAAAmTU/8s3HQesCniw/photo.jpg?sz=128", "display_name": "Matheus Richard", "link": "https://stackoverflow.com/users/8650655/matheus-richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 931, "favorite_count": 0, "accepted_answer_id": 53146962, "answer_count": 1, "score": 2, "last_activity_date": 1610403385, "creation_date": 1541348251, "last_edit_date": 1610403385, "question_id": 53142786, "link": "https://stackoverflow.com/questions/53142786/how-to-stub-a-module-method-inside-a-controller-with-mocha", "title": "How to stub a module method inside a controller with Mocha", "body": "<p>I have a Sinatra app like this:</p>\n\n<p>my_module.rb</p>\n\n<pre><code>module MyModule\n  def my_method\n    \"yay\"\n  end\nend\n</code></pre>\n\n<p>app.rb</p>\n\n<pre><code>get \"/my_module\" do \n  puts my_method\nend\n</code></pre>\n\n<p>I'm trying to stub <code>my_method</code> on a test with <code>Minitest</code> and <code>mocha</code>.</p>\n\n<pre><code>def test_my_method\n  MyModule.stubs(:my_method).returns(\"stubbed\")\n  get \"/my_module\"\nend\n</code></pre>\n\n<p>But this don't seems to work, because the original method is still called. Any thoughts on how to do this? Thanks!</p>\n"}, {"tags": ["arrays", "ruby", "algorithm", "depth-first-search", "connected-components"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "edited": false, "score": 0, "creation_date": 1541342084, "post_id": 53141872, "comment_id": 93175392, "body": "Oh! Yh your right! Thanks for noticing that. I did the change, but now the output is this: <code>805 184 80 7 305</code>"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "edited": false, "score": 0, "creation_date": 1541342975, "post_id": 53141872, "comment_id": 93175627, "body": "I don&#39;t know your algorithm, but perhaps matrix can not be empty, at least it should be [[1,1]]. See the edit."}, {"owner": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "edited": false, "score": 0, "creation_date": 1541343190, "post_id": 53141872, "comment_id": 93175675, "body": "Well, technically my algorithm should also deal with the empty matrix though. As per hackerrank test cases"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "edited": false, "score": 0, "creation_date": 1541343803, "post_id": 53141872, "comment_id": 93175840, "body": "Se last edit, to deal with empty matrix adding a line to dfs method."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 1, "last_activity_date": 1541343756, "last_edit_date": 1541343756, "creation_date": 1541341818, "answer_id": 53141872, "question_id": 53141726, "link": "https://stackoverflow.com/questions/53141726/how-to-find-connected-components-in-an-array/53141872#53141872", "title": "How to find connected components in an array", "body": "<p>Just print this line:</p>\n\n<pre><code>p roads_and_libraries n_city, c_lib, c_road, query[:matrix]\n</code></pre>\n\n<p>Not this</p>\n\n<pre><code>p (c_road * (no_cities - count)) + (c_lib * count)\n</code></pre>\n\n<p>Because there is a return in the method:</p>\n\n<pre><code>return c_lib * no_cities if c_lib &lt;= c_road\n</code></pre>\n\n<p>I don't know the algorithm, but it seems that the matrix can not be empty <code>[]</code>, at least it has to be <code>[[1,1]]</code> to get the required output:</p>\n\n<pre><code>roads_and_libraries 1, 5, 3, [[1,1]] #=&gt; 5\nroads_and_libraries 2, 102, 1, [[1,1]] #=&gt; 204\n</code></pre>\n\n<p>So, to deal with empty matrix, one way is to just add this as first line in <code>dfs</code> method:</p>\n\n<pre><code>matrix = [[1,1]] if matrix.empty?\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 53141872, "answer_count": 1, "score": 0, "last_activity_date": 1541403555, "creation_date": 1541340703, "last_edit_date": 1541403555, "question_id": 53141726, "link": "https://stackoverflow.com/questions/53141726/how-to-find-connected-components-in-an-array", "title": "How to find connected components in an array", "body": "<p>I'm attempting an algorithm problem in hackerrank, <a href=\"https://www.hackerrank.com/challenges/torque-and-development/problem\" rel=\"nofollow noreferrer\">Roads and Libraries</a>. The idea behind the problem is to use DFS to find connected components (CC) using an array.</p>\n\n<p>Here is the test case:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>queries = [\n  {\n    n_cities_roads: [9,2],\n    c_lib_road: [91, 84],\n    matrix: [\n      [8, 2], [2, 9]\n    ]\n  },\n  {\n    n_cities_roads: [5,9],\n    c_lib_road: [92, 23],\n    matrix: [\n      [2,1], [5, 3], [5,1], \n      [3,4], [3,1],  [5, 4], \n      [4,1], [5,2],  [4,2]\n    ]\n  },\n  {\n    n_cities_roads: [8,3],\n    c_lib_road: [10, 55],\n    matrix: [\n      [6,4], [3,2], [7,1]\n    ]\n  },\n  {\n    n_cities_roads: [1, 0],\n    c_lib_road: [5, 3],\n    matrix: []\n  },\n\n  {\n    n_cities_roads: [2, 0],\n    c_lib_road: [102, 1],\n    matrix: []\n  }\n]\n\nqueries.each do |query|\n  (n_city, n_road), (c_lib, c_road) = [*query[:n_cities_roads]], [*query[:c_lib_road]]\n  roads_and_libraries n_city, c_lib, c_road, query[:matrix]\nend\n</code></pre>\n\n<p>The output should be:</p>\n\n<pre><code>805\n184\n80\n5\n204\n</code></pre>\n\n<p>My current solution below can get CC for some cases, but not for all.</p>\n\n<pre><code>def dfs(i, visited, matrix)\n  visited[i] = true\n  unless matrix[i].nil?\n    matrix[i].each do |j|\n      unless visited[j]\n        dfs j, visited, matrix\n      end\n    end\n  end\nend\n\ndef roads_and_libraries(no_cities, c_lib, c_road, cities)\n  return c_lib * no_cities if c_lib &lt;= c_road\n  visited, count = Array.new(no_cities, false), 0\n\n  (0..no_cities).each do |i|\n    unless visited[i]\n      count += 1\n      dfs i, visited, cities\n    end\n  end\n  p (c_road * (no_cities - count)) + (c_lib * count)\nend\n</code></pre>\n\n<p>The output of the test with my code above is:</p>\n\n<pre><code>805\n184\n7\n305\n</code></pre>\n\n<p>I'm struggling to understand how to use DFS correctly to find connected components. Not sure where I'm going wrong.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium", "watir"], "comments": [{"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1541338364, "post_id": 53141101, "comment_id": 93174373, "body": "Have you tried logging in using watir? Find the inputs, fill them, find the submit button and click it. Maybe it works."}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 1, "creation_date": 1541347263, "post_id": 53141101, "comment_id": 93176770, "body": "You can set the user-data-dir value (<a href=\"https://sites.google.com/a/chromium.org/chromedriver/capabilities#TOC-chromeOptions-object\" rel=\"nofollow noreferrer\">sites.google.com/a/chromium.org/chromedriver/&hellip;</a>). You can see examples of using Options with Watir here: <a href=\"http://watir.com/guides/chrome/\" rel=\"nofollow noreferrer\">watir.com/guides/chrome</a>"}], "owner": {"reputation": 587, "user_id": 4297122, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/100000722742064/picture?type=large", "display_name": "Jais Anasrulloh Ja&#39;fari", "link": "https://stackoverflow.com/users/4297122/jais-anasrulloh-jafari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541336548, "creation_date": 1541336548, "question_id": 53141101, "link": "https://stackoverflow.com/questions/53141101/how-to-load-existing-chrome-profile-using-watir", "title": "How to load existing chrome profile using watir?", "body": "<p>i am trying to load existing chrome browser using watir. As you know, in my current chrome, i've login on facebook and another social media. But when i try to load facebook using chrome which is run by watir, facebook page still asking me to login. Here is my code:</p>\n\n<pre><code> def test\n    prefs = {\n        download: {\n          prompt_for_download: false,\n          default_directory: '/Users/jaisanasrulloh/Downloads'\n        }\n      }\n    args = ['user-data-dir=~/Library/Application\\ Support/Google/Chrome']\n    browser = Watir::Browser.new :chrome,options: {prefs: prefs, args: args}\n    browser.goto 'https://www.facebook.com/'\n    sleep 10\n    puts browser.title\n    browser.close\nend\n</code></pre>\n\n<p>anyone here knows how to load current caches in my current chrome into new chrome run by watir ?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 3, "creation_date": 1541304565, "post_id": 53137516, "comment_id": 93168150, "body": "Are you looking for <a href=\"http://ruby-doc.org/core/Kernel.html#method-i-caller\" rel=\"nofollow noreferrer\"><code>caller</code></a>?"}, {"owner": {"reputation": 512, "user_id": 2875733, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/632666023/picture?type=large", "display_name": "Gavin Yap", "link": "https://stackoverflow.com/users/2875733/gavin-yap"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1541308227, "post_id": 53137516, "comment_id": 93168522, "body": "Are yes. That&#39;s what I&#39;m looking for. Thanks."}], "owner": {"reputation": 512, "user_id": 2875733, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/632666023/picture?type=large", "display_name": "Gavin Yap", "link": "https://stackoverflow.com/users/2875733/gavin-yap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541390385, "creation_date": 1541302258, "last_edit_date": 1541390385, "question_id": 53137516, "link": "https://stackoverflow.com/questions/53137516/is-there-a-way-to-get-self-where-method-is-executed", "title": "Is there a way to get `self` where method is executed?", "body": "<p>I have this code:</p>\n\n<pre><code>class Foo\n  def run(scope:)\n     p scope\n  end\nend\n\nmodule Bar\n  Foo.run(scope: self) # &gt;&gt; Bar\nend\n\nFoo.run(scope: self) # &gt;&gt; main\n</code></pre>\n\n<p>I want to do something like:</p>\n\n<pre><code>module Bar\n  Foo.run\nend\n\nFoo.run\n</code></pre>\n\n<p>with the same results. Is there a way to get the <code>self</code> of where the method is called without explicitly mentioning it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite", "sqlite3-ruby"], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 4685144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sd21Y.png?s=128&g=1", "display_name": "Aurelien", "link": "https://stackoverflow.com/users/4685144/aurelien"}, "is_accepted": false, "score": 0, "last_activity_date": 1541339381, "creation_date": 1541339381, "answer_id": 53141522, "question_id": 53137382, "link": "https://stackoverflow.com/questions/53137382/ruby-failing-to-run-after-upgrading-sqlite3-native-loaderror-sqlite3-not-upgr/53141522#53141522", "title": "Ruby failing to run after upgrading (sqlite3_native LoadError); sqlite3 not upgrading properly", "body": "<p>As explained in this answer <a href=\"https://stackoverflow.com/a/49736971/4685144\">https://stackoverflow.com/a/49736971/4685144</a>, you should now be able to install sqlite3 using git:</p>\n\n<p><code>gem 'sqlite3', git: 'https://github.com/sparklemotion/sqlite3-ruby'</code></p>\n\n<p>Then <code>bundle install</code></p>\n"}], "owner": {"reputation": 11, "user_id": 10602307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4ae93e2c49b92dafbbcb2f973b0eaf?s=128&d=identicon&r=PG&f=1", "display_name": "A. Verma", "link": "https://stackoverflow.com/users/10602307/a-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1541339381, "creation_date": 1541300349, "last_edit_date": 1541300751, "question_id": 53137382, "link": "https://stackoverflow.com/questions/53137382/ruby-failing-to-run-after-upgrading-sqlite3-native-loaderror-sqlite3-not-upgr", "title": "Ruby failing to run after upgrading (sqlite3_native LoadError); sqlite3 not upgrading properly", "body": "<p>I have upgraded to ruby 2.5.0 but I am having conflicts everywhere. I have checked previous posts on stack overflow such as:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/17350837/ruby-on-rails-add-gem-sqlite3-to-your-gemfile\">Ruby on Rails - &quot;Add &#39;gem sqlite3&#39;&#39; to your Gemfile&quot;</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/49552181/cannot-load-such-file-sqlite3-sqlite3-native\">cannot load such file \u2014 sqlite3/sqlite3_native</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/17643897/cannot-load-such-file-sqlite3-sqlite3-native-loaderror-on-ruby-on-rails\">cannot load such file -- sqlite3/sqlite3_native (LoadError) on ruby on rails</a></p>\n\n<p><a href=\"https://github.com/sparklemotion/sqlite3-ruby/issues/137\" rel=\"nofollow noreferrer\">https://github.com/sparklemotion/sqlite3-ruby/issues/137</a></p>\n\n<p>But none of them are working for me. My issue is similar to these posts in that after I run rails server after a long error message the last few lines read:</p>\n\n<p><code>1: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in 'block in require'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:32:in 'require': cannot load such file -- sqlite3/sqlite3_native (LoadError)</code></p>\n\n<p>I have tried creating a new project, reinstalling sqlite3 through gem and minigw itself, reinstalling rails and ruby. I have tried most of the instructions in the previous questions but nothing works. SQLite3 version 3.25.2, Ruby 2.5.3, rails 5.2.1</p>\n\n<p>Sorry, this might be a simple fix but I am a complete beginner to ruby and I have been trying different things for a few hours now. Any help is appreciated.</p>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1541322064, "post_id": 53137554, "comment_id": 93170514, "body": "I would say it is exactly the same as with pointers in e.g. C. If you assign a variable in C to the value at a particular address, this variable will also not change if the value at that particular address changes. See <a href=\"https://ideone.com/ACpxcv\" rel=\"nofollow noreferrer\">ideone.com/ACpxcv</a> for a rough C translation of the OP&#39;s code that gives the exact same result."}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1541336105, "post_id": 53137554, "comment_id": 93173827, "body": "@J&#246;rgWMittag Good point. I&#39;ve updated my answer to not mention Pointers, since I don&#39;t have enough C knowledge to actually be helpful comparing the two, and added more Ruby examples."}, {"owner": {"reputation": 1, "user_id": 10602299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2CyZ05PhEGE/AAAAAAAAAAI/AAAAAAAAAAk/09CtQ0AZjNw/photo.jpg?sz=128", "display_name": "Seth Modu", "link": "https://stackoverflow.com/users/10602299/seth-modu"}, "edited": false, "score": 0, "creation_date": 1541365406, "post_id": 53137554, "comment_id": 93182132, "body": "@Nate  Thank you for you explanation!"}, {"owner": {"reputation": 1, "user_id": 10602299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2CyZ05PhEGE/AAAAAAAAAAI/AAAAAAAAAAk/09CtQ0AZjNw/photo.jpg?sz=128", "display_name": "Seth Modu", "link": "https://stackoverflow.com/users/10602299/seth-modu"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1541365936, "post_id": 53137554, "comment_id": 93182282, "body": "@Jorg   Sorry I wasn&#39;t clear enough,  I realize in C you declare pointer with a  *, like &quot;int *first&quot;."}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "reply_to_user": {"reputation": 1, "user_id": 10602299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2CyZ05PhEGE/AAAAAAAAAAI/AAAAAAAAAAk/09CtQ0AZjNw/photo.jpg?sz=128", "display_name": "Seth Modu", "link": "https://stackoverflow.com/users/10602299/seth-modu"}, "edited": false, "score": 0, "creation_date": 1541366224, "post_id": 53137554, "comment_id": 93182383, "body": "@SethModu, @J&#246;rgWMittag\u2019s comment was in response to a previous version of my answer, which I\u2019ve since changed to reduce confusion, since I don\u2019t know enough C and was trying to make comparisons to C incorrectly."}], "tags": [], "owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "is_accepted": false, "score": 1, "last_activity_date": 1541336408, "last_edit_date": 1541336408, "creation_date": 1541302688, "answer_id": 53137554, "question_id": 53137340, "link": "https://stackoverflow.com/questions/53137340/referencing-array-index-in-ruby/53137554#53137554", "title": "Referencing array index in Ruby", "body": "<p>You assigned the variable <code>first</code> to whatever the first element was at the time. Since <code>ar[0]</code> was 1 at the time, it was exactly the same as just saying <code>first = 1</code>.</p>\n\n<p>It\u2019s not the same as calling <code>ar.first</code>, which always points to the first element (synonymous with <code>ar[0]</code>).</p>\n\n<p>Ruby uses what it calls an <code>object_id</code> to keep track of each object instance. When you say <code>first = ar[0]</code>, Ruby assigns <code>first</code> to the same object that's in <code>ar[0]</code>. These two objects will remain in sync, and any mutations that you perform to them will stay in sync, since it's exactly the same object in memory. If you re-assign either variable (<code>ar[0]</code> or <code>first</code>) to a different object, you'll lose your sync.</p>\n\n<pre><code>irb(main):001:0&gt; ar = ['a','b','c']\n=&gt; [\"a\", \"b\", \"c\"]\nirb(main):002:0&gt; first = ar[0]\n=&gt; \"a\"\nirb(main):003:0&gt; ar[0] &lt;&lt; ' testing!'\n=&gt; \"a testing!\"\nirb(main):004:0&gt; first\n=&gt; \"a testing!\"\nirb(main):005:0&gt; ar[0].replace('this is a test')\n=&gt; \"this is a test\"\nirb(main):006:0&gt; ar\n=&gt; [\"this is a test\", \"b\", \"c\"]\nirb(main):007:0&gt; first\n=&gt; \"this is a test\"\nirb(main):008:0&gt; ar[0].object_id\n=&gt; 70159033810680\nirb(main):009:0&gt; first.object_id\n=&gt; 70159033810680\nirb(main):010:0&gt; ar[0] = 'different string instance'\n=&gt; \"different string instance\"\nirb(main):011:0&gt; ar\n=&gt; [\"different string instance\", \"b\", \"c\"]\nirb(main):012:0&gt; first\n=&gt; \"this is a test\"\nirb(main):013:0&gt; ar[0].object_id\n=&gt; 70159033712320\n</code></pre>\n\n<p>The <code>&lt;&lt;</code> method and <code>replace</code> methods mutate the string object. If you're using Rails and familiar with ActiveRecord, it'd be like doing:</p>\n\n<pre><code>user1 = User.new(first_name: 'Bob')\nuser2 = User.new(first_name: 'Joe')\nuser3 = User.new(first_name: 'Dave')\n\nar = [user1, user2, user3]\nfirst = ar[0]\n</code></pre>\n\n<p>In the end, all you did was <code>first = user1</code></p>\n\n<p>If you do <code>user1.first_name = 'Jim'</code>, you'll now see that <code>ar[0]</code>, <code>user1</code>, and <code>first</code> all had the <code>first_name</code> changed, because you mutated the ActiveRecord object.</p>\n\n<p>Numbers are immutable. You cannot change the object that's in memory. You cannot change a <code>1</code> to be a <code>5</code>. All you can do is update your variable to use a different object instance.</p>\n\n<pre><code>irb(main):014:0&gt; testing = 1 + 5\n=&gt; 6\nirb(main):015:0&gt; testing.object_id\n=&gt; 13\nirb(main):016:0&gt; 6.object_id\n=&gt; 13\n</code></pre>\n\n<p><code>6</code> is basically a constant. You can't change 1, you can't change 5, but you can add them together to get 6.</p>\n\n<p>Quick side note about <code>object_id</code>. Some of the Ruby core object ids are pretty constant, but just pretend they aren't predictable. They're meant for you to be able to compare two objects easily. Some functions in Ruby user the object_id to determine equality, because if the object_id of two different variables are the same, then they are definitely equal, since they point to the same memory location.</p>\n\n<p>Any time you create write string literal, you create a new object in memory.</p>\n\n<pre><code>irb(main):017:0&gt; a = 'testing'\n=&gt; \"testing\"\nirb(main):018:0&gt; b = 'testing'\n=&gt; \"testing\"\nirb(main):019:0&gt; a.object_id\n=&gt; 70159025508120\nirb(main):020:0&gt; b.object_id\n=&gt; 70159029161840\n</code></pre>\n\n<p>If you mutate <code>a</code>, then <code>b</code> does not change because they are different objects. If you're passing a string variable around, it's important to know whether the action you're calling is mutative or not, and whether or not you actually want mutation.</p>\n\n<p>For example, you may at some point in life create an array.</p>\n\n<pre><code>ar = ['a','b','c']\n=&gt; [\"a\", \"b\", \"c\"]\n</code></pre>\n\n<p>And then decide you want to use pass that first element of the array into a function argument, or store it in a variable.</p>\n\n<pre><code>first = ar[0]\n=&gt; \"a\"\n</code></pre>\n\n<p>This is fine as long as you don't mutate. Well, maybe you're wanting to change your <code>first</code> variable for some reason. Perhaps you're building a list of HTML classes.</p>\n\n<pre><code>first &lt;&lt; ' some cool text'\n=&gt; \"a some cool text\"\n\nfirst\n=&gt; \"a some cool text\"\n</code></pre>\n\n<p>All seems fine, right?</p>\n\n<p>But, look what that did to your array.</p>\n\n<pre><code>ar\n=&gt; [\"a some cool text\", \"b\", \"c\"]\n</code></pre>\n\n<p>If you see a time when you want to mutate a variable that was passed in, one thing you can do is assign your variable to a copy of it.</p>\n\n<pre><code>first = ar[0].dup\n</code></pre>\n\n<p>Now, <code>first</code> is the same string value as <code>ar[0]</code>, but a new string instance. You can safely mutate <code>first</code> or <code>ar[0]</code> without changing the other one.</p>\n\n<p>Mutation isn't always bad. It can be very helpful. But, unexpected mutations can be really confusing if you don't know they're happening. Especially if you're mutating an argument to a function, because the original value was defined elsewhere and now it's changed.</p>\n\n<p>Ruby tends to end method names with <code>!</code> if there's a mutable version of it. Like <code>sub</code> vs <code>sub!</code> in a string. <code>sub</code> returns a new string with your substitutions applied, leaving the original string alone. <code>sub!</code> modifies (aka mutates) the string you call it on.</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1541452718, "last_edit_date": 1541452718, "creation_date": 1541441264, "answer_id": 53159864, "question_id": 53137340, "link": "https://stackoverflow.com/questions/53137340/referencing-array-index-in-ruby/53159864#53159864", "title": "Referencing array index in Ruby", "body": "<blockquote>\n  <p>What is the Ruby way to let first equal to the current value of ar[0]?</p>\n</blockquote>\n\n<p>If you really wanted to you could make <code>first</code> a method rather than a local variable such as </p>\n\n<pre><code>ar = [1, 2, 3, 4]\ndefine_method(:first, &amp;ar.method(:first))\nfirst #=&gt; 1\nar.shift # =&gt; 1\nar # =&gt; [2, 3, 4]\nfirst # =&gt; 2\n</code></pre>\n\n<p><strong>Note:</strong> While this answers your question I am not endorsing this as a viable concept since a subsequent definition of first e.g. (<code>first = 12</code>) will result in <code>first #=&gt; 12</code> (local variable) and <code>first() #=&gt; 2</code> (method call)</p>\n"}], "owner": {"reputation": 1, "user_id": 10602299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2CyZ05PhEGE/AAAAAAAAAAI/AAAAAAAAAAk/09CtQ0AZjNw/photo.jpg?sz=128", "display_name": "Seth Modu", "link": "https://stackoverflow.com/users/10602299/seth-modu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1541452718, "creation_date": 1541299798, "last_edit_date": 1541394395, "question_id": 53137340, "link": "https://stackoverflow.com/questions/53137340/referencing-array-index-in-ruby", "title": "Referencing array index in Ruby", "body": "<p>I was under impression that references in Ruby are equivalent to pointers in C.  But I'm confused by this:</p>\n\n<pre><code>ar = [1, 2, 3, 4]\nfirst = ar[0] # =&gt; 1\nar.shift # =&gt; 1\nar # =&gt; [2, 3, 4]\nfirst # =&gt; 1\n</code></pre>\n\n<p>Shouldn't <code>first</code> point to the memory address of <code>ar[0]</code>,  which holds the value <code>2</code>? Why does it still hold to the expired value?</p>\n\n<p>What is the Ruby way to let <code>first</code> equal to the current value of <code>ar[0]</code>?</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 1, "creation_date": 1541300482, "post_id": 53137264, "comment_id": 93167714, "body": "Side note, if you don\u2019t actually need the match data but just a boolean about whether the reflex matches or not, use <code>match?</code>. It\u2019s more efficient as it doesn\u2019t make a MatchData object or build backrefs ($1, $2, $3, etc)."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1541428108, "post_id": 53137288, "comment_id": 93202998, "body": "<code>\\A</code> (start of string) and <code>\\z</code> (end of string) are probably better anchors since yours will match <code>&quot;http:&#47;&#47;somewhere.com&#47;\\n589ab375c3c6416310171b5b\\n?review&quot;</code>"}], "tags": [], "owner": {"reputation": 19, "user_id": 5042054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0c31615b6f1bb250f0a5afd347ec31?s=128&d=identicon&r=PG&f=1", "display_name": "SEGV4DAYZ", "link": "https://stackoverflow.com/users/5042054/segv4dayz"}, "is_accepted": false, "score": 1, "last_activity_date": 1541298953, "creation_date": 1541298953, "answer_id": 53137288, "question_id": 53137264, "link": "https://stackoverflow.com/questions/53137264/ruby-regex-test-for-exact-match-of-string/53137288#53137288", "title": "ruby regex test for exact match of string", "body": "<p>You can use <code>^</code> and <code>$</code> to match exactly a whole string. <code>^</code> matches the start of a line, and <code>$</code> matches the end. So:</p>\n\n<pre><code>/^[a-z,0-9]{24}$/\n</code></pre>\n\n<p>will match a string containing only the 24 characters of a Mongo ID.</p>\n"}, {"tags": [], "owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "is_accepted": false, "score": 2, "last_activity_date": 1541331212, "last_edit_date": 1541331212, "creation_date": 1541329616, "answer_id": 53140155, "question_id": 53137264, "link": "https://stackoverflow.com/questions/53137264/ruby-regex-test-for-exact-match-of-string/53140155#53140155", "title": "ruby regex test for exact match of string", "body": "<p>For your example data your could use <a href=\"http://www.rexegg.com/regex-anchors.html\" rel=\"nofollow noreferrer\">anchors</a> <code>\\A</code> and <code>\\z</code>. The data does not contain a comma so you can omit that from the <a href=\"https://www.regular-expressions.info/charclass.html\" rel=\"nofollow noreferrer\">character class</a>.</p>\n\n<p>For example:</p>\n\n<p><code>pattern = /\\A[a-f0-9]{24}\\z/</code></p>\n\n<p><a href=\"https://ideone.com/3ADRmZ\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 1299, "user_id": 1130176, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/3618314d500643b06b1b88c8671eb840?s=128&d=identicon&r=PG", "display_name": "user1130176", "link": "https://stackoverflow.com/users/1130176/user1130176"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541331212, "creation_date": 1541298593, "question_id": 53137264, "link": "https://stackoverflow.com/questions/53137264/ruby-regex-test-for-exact-match-of-string", "title": "ruby regex test for exact match of string", "body": "<p>I am trying to write a regex to exactly match if a string is a mongo id, not if a string contains a mongo id.  My regex for a mongo id is</p>\n\n<pre><code>/[a-z,0-9]{24}/\n</code></pre>\n\n<p>which works great, but I can't figure out how to write a regex that rejects a URL that contains a mongo id, for example.  So, I get this, which is not what I want:</p>\n\n<pre><code>pattern = /[a-z,0-9]{24}/\nstr1 = \"589ab375c3c6416310171b5b\"\nstr2 = \"http://somewhere.com/589ab375c3c6416310171b5b?review\"\nstr1.match pattern\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>#&lt;MatchData \"589ab375c3c6416310171b5b\"&gt;\n</code></pre>\n\n<p>And the second string</p>\n\n<pre><code>str2.match pattern\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>#&lt;MatchData \"589ab375c3c6416310171b5b\"&gt;\n</code></pre>\n\n<p>I want the first to match but the second to not.</p>\n\n<p>Thanks for any help,\nkevin </p>\n"}, {"tags": ["arrays", "ruby", "string"], "answers": [{"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 0, "last_activity_date": 1541312877, "last_edit_date": 1541312877, "creation_date": 1541312190, "answer_id": 53138259, "question_id": 53137164, "link": "https://stackoverflow.com/questions/53137164/when-printing-arrays-with-variables-it-prints-individual-answers-not-all/53138259#53138259", "title": "When printing arrays with variables, it prints individual answers, not all", "body": "<p>You should change one of you line to, so you can access array elements by index (but don't use capitals for variable names):</p>\n\n<pre><code>puts \"Apellido es \" + A[m].to_s + \" tengo \" + E[m].to_s + \" a\u00f1os. \"\n</code></pre>\n\n<p>But I suggest to make your code more \"Rubyish\", like so:</p>\n\n<pre><code>people = Array.new() # initializa an array\n10.times do |n|\n  person = {} # initialize a hash\n  # puts \"\u00bfC\u00faal es tu edad?\"\n  person[:edad] = 20 + n # stores into the hash, here use gets for user input instead of 20 + n\n  # puts \"\u00bfC\u00faal es tu apellido?\"\n  person[:apellido] = 'Pedro' + n.to_s # stores into the hash, here use gets for user input instead of 'Pedro' + n.to_s\n  people &lt;&lt; person # insert the person into people\nend\npeople.each do |person|\n  puts \"Apellido es #{person[:apellido]} tengo #{person[:edad]} a\u00f1os.\" # string interpolation\nend\n</code></pre>\n\n<ul>\n<li>Looping by <code>.times do</code>: <a href=\"https://ruby-doc.org/core-2.5.3/Integer.html#method-i-times\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.5.3/Integer.html#method-i-times</a></li>\n<li>Storing people data using hashes: <a href=\"https://ruby-doc.org/core-2.5.1/Hash.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.5.1/Hash.html</a></li>\n<li>Iterating over array by: <a href=\"https://ruby-doc.org/core-2.5.0/Enumerator.html#method-i-each\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.5.0/Enumerator.html#method-i-each</a></li>\n<li>Using string interpolation: <a href=\"https://docs.ruby-lang.org/en/2.5.0/syntax/literals_rdoc.html#label-Strings\" rel=\"nofollow noreferrer\">https://docs.ruby-lang.org/en/2.5.0/syntax/literals_rdoc.html#label-Strings</a></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 10602226, "user_type": "registered", "profile_image": "https://graph.facebook.com/702629303445481/picture?type=large", "display_name": "Tejon", "link": "https://stackoverflow.com/users/10602226/tejon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 53138259, "answer_count": 1, "score": 0, "last_activity_date": 1541396761, "creation_date": 1541297224, "last_edit_date": 1541395406, "question_id": 53137164, "link": "https://stackoverflow.com/questions/53137164/when-printing-arrays-with-variables-it-prints-individual-answers-not-all", "title": "When printing arrays with variables, it prints individual answers, not all", "body": "<p>This is a program to save the age and the last name of a person:</p>\n\n<pre><code>E = Array.new(10)\nA = Array.new(10)\nfor i in(0..9)\n  puts \"\u00bfC\u00faal es tu edad?\"\n  edad = gets.chomp\n  E[i] = edad\n  puts \"\u00bfC\u00faal es tu apellido?\"\n  apellido = gets.chomp\n  A[i] = apellido\nend\n gets\nfor m in(0..9)\n  puts \"Apellido es \" + A.to_s + \" tengo \" + E.to_s + \" a\u00f1os. \"\nend\ngets\n</code></pre>\n\n<p>It prints:</p>\n\n<pre><code>Apellido es [\"primero\", \"segundo\", \"tercero\", \"cuarto\", \"quinto\", \"sexto\", \"septimo\", \"octavo\", \"noveno\", \"decimo\"] tengo [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"] a\u00f1os.\nApellido es [\"primero\", \"segundo\", \"tercero\", \"cuarto\", \"quinto\", \"sexto\", \"septimo\", \"octavo\", \"noveno\", \"decimo\"] tengo [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"] a\u00f1os.\nApellido es [\"primero\", \"segundo\", \"tercero\", \"cuarto\", \"quinto\", \"sexto\", \"septimo\", \"octavo\", \"noveno\", \"decimo\"] tengo [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"] a\u00f1os.\nApellido es [\"primero\", \"segundo\", \"tercero\", \"cuarto\", \"quinto\", \"sexto\", \"septimo\", \"octavo\", \"noveno\", \"decimo\"] tengo [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"] a\u00f1os.\nApellido es [\"primero\", \"segundo\", \"tercero\", \"cuarto\", \"quinto\", \"sexto\", \"septimo\", \"octavo\", \"noveno\", \"decimo\"] tengo [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"] a\u00f1os.\nApellido es [\"primero\", \"segundo\", \"tercero\", \"cuarto\", \"quinto\", \"sexto\", \"septimo\", \"octavo\", \"noveno\", \"decimo\"] tengo [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"] a\u00f1os.\nApellido es [\"primero\", \"segundo\", \"tercero\", \"cuarto\", \"quinto\", \"sexto\", \"septimo\", \"octavo\", \"noveno\", \"decimo\"] tengo [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"] a\u00f1os.\nApellido es [\"primero\", \"segundo\", \"tercero\", \"cuarto\", \"quinto\", \"sexto\", \"septimo\", \"octavo\", \"noveno\", \"decimo\"] tengo [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"] a\u00f1os.\nApellido es [\"primero\", \"segundo\", \"tercero\", \"cuarto\", \"quinto\", \"sexto\", \"septimo\", \"octavo\", \"noveno\", \"decimo\"] tengo [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"] a\u00f1os.\nApellido es [\"primero\", \"segundo\", \"tercero\", \"cuarto\", \"quinto\", \"sexto\", \"septimo\", \"octavo\", \"noveno\", \"decimo\"] tengo [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"] a\u00f1os.\n</code></pre>\n\n<p>When I introduce 10 and 10 variables, and print them, it prints all information, not 1 and 1. It makes all of them at the same time.</p>\n"}]